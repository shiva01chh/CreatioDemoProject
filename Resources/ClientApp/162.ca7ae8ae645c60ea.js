"use strict";(self.webpackChunkapp_studio_enterprise_system_designer=self.webpackChunkapp_studio_enterprise_system_designer||[]).push([[162],{81162:(Ht,ke,c)=>{c.r(ke),c.d(ke,{BaseChannelDialogPageComponent:()=>M,BaseChannelFieldComponent:()=>F,BaseChannelLanguageComponent:()=>O,BaseChannelNameComponent:()=>ne,BaseChannelQueueComponent:()=>q,BaseChannelTitleComponent:()=>w,BaseClickableCellComponent:()=>W,Channel:()=>Le,ChannelDetailComponent:()=>re,ChannelEntityConverter:()=>J,ChannelNameCellComponent:()=>z,ChannelPage:()=>Vt,ChannelService:()=>S,ChannelTitle:()=>Jt,ChatAction:()=>qe,ChatActionEntityConverter:()=>B,ChatActionNameCellComponent:()=>te,ChatActionPageComponent:()=>L,ChatActionService:()=>Z,ChatActionsDetailComponent:()=>ce,ChatQueue:()=>Fe,ChatQueueEntityConverter:()=>E,ChatQueueOperator:()=>wt,ChatQueueOperatorEntityConverter:()=>G,ChatQueueOperatorService:()=>Q,ChatQueuePageComponent:()=>A,ChatQueueService:()=>N,ChatSettingsModule:()=>he,ChatSettingsPageComponent:()=>ee,ChatSettingsRoutingModule:()=>V,ExpansionDetailComponent:()=>x,FacebookChannelDialogPageComponent:()=>D,FacebookChannelErrorDialogComponent:()=>se,FacebookRegistrationService:()=>Y,OperatorsDetailComponent:()=>ue,QueueDetailComponent:()=>le,RegisterTelegramResponse:()=>Ot,RegisterWhatsAppResponse:()=>Ee,TelegramChannelDialogPageComponent:()=>K,TelegramRegistrationService:()=>j,WhatsAppChannelDialogPageComponent:()=>X,WhatsAppRegistrationService:()=>H});var f=c(88692),s=c(20092),Se=c(17914),_e=c(25237),ae=c(83331),P=c(79510),I=c(15756),ge=c(95411),d=c(37697),h=c(95236),k=c(74817),me=c(72990),Ne=c(93254),be=c(62549),Ze=c(97355),Qe=c(55799),Me=c(18849),p=c(56707),T=c(26522),De=c(47910),C=c(80542),de=c(7976),l=c(75378),Re=c(33177),g=c(36619),e=c(64537);const ye=new e.OlP("ChannelChangeBroadcastService"),Ae=new e.OlP("ChatQueueChangeBroadcastService"),Pe=new e.OlP("ChatActionChangeBroadcastService");var v;(function(o){o.FacebookMessenger="50491c6c-d82b-4b86-b38c-99262d11a5ac",o.Telegram="645170ab-c67a-4dcc-9def-c0e5236bdfe0",o.WhatsApp="1398dc73-b428-4e21-b97a-c1bb6b4bc621"})(v||(v={}));class Le{get type(){switch(this.typeId){case v.FacebookMessenger:return v.FacebookMessenger;case v.Telegram:return v.Telegram;default:throw new Error(`Type with id ${this.typeId} not found`)}}}var R=c(69403),y=c(27969);class J{_createChannel(t){const n=t.Provider,a=t.ChatQueue,i=t.Language;return{id:t.Id,name:t.Name,typeId:n.value,typeName:n.displayValue,msgSettingsId:t.MsgSettingsId,queueId:a.value,queueName:a.displayValue,source:t.Source,isActive:t.IsActive,languageId:i.value,languageName:i.displayValue}}getEntity(t){return this._createChannel(t)}getEntityColumns(t){return[new g._H7("Id",t.id,l.DataValueType.Guid),new g._H7("Name",t.name,l.DataValueType.Text),new g._H7("Provider",t.typeId,l.DataValueType.Lookup),new g._H7("MsgSettingsId",t.msgSettingsId,l.DataValueType.Guid),new g._H7("ChatQueue",t.queueId,l.DataValueType.Lookup),new g._H7("Source",t.source,l.DataValueType.Text),new g._H7("IsActive",t.isActive,l.DataValueType.Boolean),new g._H7("Language",t.languageId,l.DataValueType.Lookup)]}}J.\u0275fac=function(t){return new(t||J)},J.\u0275prov=e.Yz7({token:J,factory:J.\u0275fac});class S extends R.UE{constructor(t,n,a){super(t,n,a),this.entitySchemaName="Channel"}_createNewChannel(t){const n=new Le;return n.id=(0,l.generateGuid)(),n.typeId=t,n}getLookupValues(t){const n=new l.EntitySchemaQuery(t);return n.addSchemaColumn("Id"),n.addSchemaColumn("Name").withOrdering(l.OrderDirection.Asc,0),this.queryExecutor.executeSelectQuery(n).pipe((0,y.U)(a=>a.map(i=>({value:i.Id,displayValue:i.Name}))))}getChannelTypeItems(){const t=new l.EntitySchemaQuery("ChannelProvider");return t.addSchemaColumn("Id"),t.addSchemaColumn("Name").withOrdering(l.OrderDirection.Asc,0),t.addSchemaColumn("PageUrl"),this.queryExecutor.executeSelectQuery(t).pipe((0,y.U)(n=>n.map(a=>({value:a.Id,displayValue:a.Name,pageUrl:a.PageUrl}))))}getChannelQueueItems(){const t=new l.EntitySchemaQuery("ChatQueue");return t.addSchemaColumn("Id"),t.addSchemaColumn("Name").withOrdering(l.OrderDirection.Asc,0),t.addSchemaColumn("[ChatQueueOperator:ChatQueue].Id","Operator"),this.queryExecutor.executeSelectQuery(t).pipe((0,y.U)(n=>{const a=n.filter(r=>Boolean(r.Operator));return a.filter((r,u)=>a.findIndex(m=>m.Id===r.Id)===u).map(r=>({value:r.Id,displayValue:r.Name}))}))}getActiveLanguages(){const t=new l.EntitySchemaQuery("SysLanguage");return t.addSchemaColumn("Id"),t.addSchemaColumn("Name").withOrdering(l.OrderDirection.Asc,0),t.filters.addSchemaColumnFilterWithParameter(l.ComparisonType.Equal,"IsUsed",1),this.queryExecutor.executeSelectQuery(t).pipe((0,y.U)(n=>n.map(a=>({value:a.Id,displayValue:a.Name}))))}generateNewChannelResponse(t){return{success:!0,result:[this._createNewChannel(t)]}}checkCanSaveChannel(t,n){const a=new l.EntitySchemaQuery("Channel");a.filters.addSchemaColumnFilterWithParameter(l.ComparisonType.Equal,"Source",t),this.queryExecutor.executeSelectQuery(a).subscribe(i=>{n(!(i&&i[0]))})}}S.\u0275fac=function(t){return new(t||S)(e.LFG(R.oq),e.LFG(p.sK),e.LFG(J))},S.\u0275prov=e.Yz7({token:S,factory:S.\u0275fac});class Fe{}var fe=c(33569);class E{_createChatQueue(t){return{id:t.Id,name:t.Name,routingRule:t.OperatorRoutingRule,simultaneous:t.SimultaneousChats,chatTimeout:t.ChatTimeout,timeToWaitInQueue:t.TimeToWaitInQueue}}getEntity(t){return this._createChatQueue(t)}getEntityColumns(t){return[new g._H7("Id",t.id,l.DataValueType.Guid),new g._H7("Name",t.name,l.DataValueType.Text),new g._H7("OperatorRoutingRule",t.hasOwnProperty("routingRule")&&!(0,fe.Z)(t.routingRule)?t.routingRule.value:void 0,l.DataValueType.Lookup),new g._H7("SimultaneousChats",t.simultaneous,l.DataValueType.Integer),new g._H7("TimeToWaitInQueue",t.timeToWaitInQueue,l.DataValueType.Integer),new g._H7("ChatTimeout",t.chatTimeout,l.DataValueType.Integer)]}}E.\u0275fac=function(t){return new(t||E)},E.\u0275prov=e.Yz7({token:E,factory:E.\u0275fac});class N extends R.UE{_createNewChatQueue(){const t=new Fe;return t.id=(0,l.generateGuid)(),t}getLookupValues(t){const n=new l.EntitySchemaQuery(t);return n.addSchemaColumn("Id"),n.addSchemaColumn("Name").withOrdering(l.OrderDirection.Asc,0),this.queryExecutor.executeSelectQuery(n).pipe((0,y.U)(a=>a.map(i=>({value:i.Id,displayValue:i.Name}))))}constructor(t,n,a){super(t,n,a),this.entitySchemaName="ChatQueue"}generateNewChatQueueResponse(){return{success:!0,result:[this._createNewChatQueue()]}}getRoutingRuleItems(){return this.getLookupValues("OperatorRoutingRules")}}N.\u0275fac=function(t){return new(t||N)(e.LFG(R.oq),e.LFG(p.sK),e.LFG(E))},N.\u0275prov=e.Yz7({token:N,factory:N.\u0275fac,providedIn:"root"});class qe{}class B{_createChatAction(t){return{id:t.Id,process:{value:t.ProcessSchemaId,displayValue:t["[VwProcessLib:Id:ProcessSchemaId].Caption"]},queue:t.ChatQueue,caption:t.Caption}}getEntity(t){return this._createChatAction(t)}getEntityColumns(t){return[new g._H7("Id",t.id,l.DataValueType.Guid),new g._H7("Caption",t.caption,l.DataValueType.Text),new g._H7("ProcessSchemaId",t.hasOwnProperty("process")&&!(0,fe.Z)(t.process)?t.process.value:void 0,l.DataValueType.Lookup),new g._H7("ChatQueue",t.hasOwnProperty("queue")&&!(0,fe.Z)(t.queue)?t.queue.value:void 0,l.DataValueType.Lookup)]}}B.\u0275fac=function(t){return new(t||B)},B.\u0275prov=e.Yz7({token:B,factory:B.\u0275fac});class Z extends R.UE{_createNewChatAction(){const t=new qe;return t.id=(0,l.generateGuid)(),t}getLookupValues(t,n){const a=new l.EntitySchemaQuery(t);return a.addSchemaColumn("Id"),a.addSchemaColumn(n).withOrdering(l.OrderDirection.Asc,0),this.queryExecutor.executeSelectQuery(a).pipe((0,y.U)(i=>i.map(r=>({value:r.Id,displayValue:r[n]}))))}addProcessCaptionColumn(t){t.addSchemaColumn("[VwProcessLib:Id:ProcessSchemaId].Caption")}createGetAllItemsEsq(){const t=super.createGetAllItemsEsq();return this.addProcessCaptionColumn(t),t}getItemByIdEsq(t){const n=super.getItemByIdEsq(t);return this.addProcessCaptionColumn(n),n}constructor(t,n,a){super(t,n,a),this.entitySchemaName="OmniChatAction"}generateNewChatActionResponse(){return{success:!0,result:[this._createNewChatAction()]}}getChatQueueItems(){return this.getLookupValues("ChatQueue","Name")}getProcessItems(){return this.getLookupValues("VwProcessLib","Caption")}}Z.\u0275fac=function(t){return new(t||Z)(e.LFG(R.oq),e.LFG(p.sK),e.LFG(B))},Z.\u0275prov=e.Yz7({token:Z,factory:Z.\u0275fac,providedIn:"root"});var Je=c(33568);class G{_createChatQueueOperator(t){return{id:t.Id,operator:t.Operator,chatQueue:t.ChatQueue}}getValueFromLookup(t,n){return t.hasOwnProperty(n)&&!(0,fe.Z)(t[n])?t[n].value:void 0}getEntity(t){return this._createChatQueueOperator(t)}getEntityColumns(t){return[new g._H7("Id",t.id,l.DataValueType.Guid),new g._H7("Operator",this.getValueFromLookup(t,"operator"),l.DataValueType.Lookup),new g._H7("ChatQueue",this.getValueFromLookup(t,"chatQueue"),l.DataValueType.Lookup)]}}G.\u0275fac=function(t){return new(t||G)},G.\u0275prov=e.Yz7({token:G,factory:G.\u0275fac});class Q extends R.UE{constructor(t,n,a){super(t,n,a),this.entitySchemaName="ChatQueueOperator"}mapSysAdminUnit(t){return{id:t.Id,name:t.Name,parentRoleId:t.ParentRole&&t.ParentRole.value,sysAdminUnitTypeValue:t.SysAdminUnitTypeValue}}addSysAdminUnitQueryFilters(t){const n=new l.FilterGroup;n.logicalOperation=l.LogicalOperatorType.Or,n.addSchemaColumnFilterWithParameter(l.ComparisonType.Not_equal,"SysAdminUnitTypeValue",4),n.addSchemaColumnFilterWithParameter(l.ComparisonType.Equal,"Active",1),t.filters.addSchemaColumnFilterWithParameter(l.ComparisonType.Equal,"ConnectionType",0),t.filters.add(n)}getSysAdminUnitQuery(){const t=new l.EntitySchemaQuery("SysAdminUnit");return t.addSchemaColumn("Id"),t.addSchemaColumn("Name"),t.addSchemaColumn("ParentRole"),t.addSchemaColumn("SysAdminUnitTypeValue"),t.addSchemaColumn("ConnectionType"),t.addSchemaColumn("Active"),this.addSysAdminUnitQueryFilters(t),t}getItemsByChatQueueId(t){const n=this.createGetAllItemsEsq();return n.filters.addSchemaColumnFilterWithParameter(l.ComparisonType.Equal,"ChatQueue",t),this.queryExecutor.executeSelectQuery(n).pipe((0,y.U)(a=>({success:!0,errorInfo:null,result:a.map(i=>this.entityConverter.getEntity(i))})),(0,Je.K)(a=>this.getBaseErrorResponse(a)))}getSysAdminUnitList(){const t=this.getSysAdminUnitQuery();return this.queryExecutor.executeSelectQuery(t).pipe((0,y.U)(n=>({success:!0,errorInfo:null,sysAdminUnits:n.map(a=>this.mapSysAdminUnit(a))})))}}Q.\u0275fac=function(t){return new(t||Q)(e.LFG(R.oq),e.LFG(p.sK),e.LFG(G))},Q.\u0275prov=e.Yz7({token:Q,factory:Q.\u0275fac,providedIn:"root"});var U=c(35732);class Y{constructor(t){this.httpClient=t,this._serviceUrl="/rest/FacebookOmnichannelMessagingService/"}registerFacebookChannel(t,n){const a=new U.WM().set("Content-Type","application/json; charset=utf-8"),i=this._serviceUrl+"Register";return this.httpClient.post(i,{token:t,source:n},{headers:a})}removeFacebookChannel(t){const n=new U.WM().set("Content-Type","application/json; charset=utf-8"),a=this._serviceUrl+"RemoveChannel";return this.httpClient.post(a,{facebookId:t},{headers:n})}}Y.\u0275fac=function(t){return new(t||Y)(e.LFG(U.eN))},Y.\u0275prov=e.Yz7({token:Y,factory:Y.\u0275fac,providedIn:"root"});class j{constructor(t){this.httpClient=t,this._serviceUrl="/rest/TelegramOmnichannelMessagingService/"}registerTelegramChannel(t){const n=this._serviceUrl+"RegisterChannel";return this.httpClient.post(n,{token:t})}getTelegramUserName(t){const n=this._serviceUrl+"GetUserName";return this.httpClient.post(n,{settingsId:t})}removeTelegramChannel(t){const n=new U.WM().set("Content-Type","application/json; charset=utf-8"),a=this._serviceUrl+"RemoveChannel";return this.httpClient.post(a,{telegramId:t},{headers:n})}}j.\u0275fac=function(t){return new(t||j)(e.LFG(U.eN))},j.\u0275prov=e.Yz7({token:j,factory:j.\u0275fac,providedIn:"root"});class H{wrapPhoneNumber(t){return`+${t}`}getRequestData(t,n,a,i){return{token:t,appId:n,integrationPhoneNumber:this.wrapPhoneNumber(a),channelPhoneNumber:this.wrapPhoneNumber(i)}}constructor(t){this.httpClient=t,this._serviceUrl="/rest/WhatsAppOmnichannelMessagingService/"}tryConnect(t,n,a,i){const r=this._serviceUrl+"Validate";return this.httpClient.post(r,this.getRequestData(t,n,a,i))}register(t,n,a,i){const r=this._serviceUrl+"RegisterChannel";return this.httpClient.post(r,this.getRequestData(t,n,a,i))}removeWhatsAppChannel(t){const n=new U.WM().set("Content-Type","application/json; charset=utf-8"),a=this._serviceUrl+"RemoveChannel";return this.httpClient.post(a,{whatsAppId:t},{headers:n})}}H.\u0275fac=function(t){return new(t||H)(e.LFG(U.eN))},H.\u0275prov=e.Yz7({token:H,factory:H.\u0275fac,providedIn:"root"});class Ee{}var Be=c(75349),Ce=c(87241),we=c(11465),Ge=c(14069);class oe{constructor(t,n){this.httpClient=t,this.sysSettingsService=n,this._serviceUrl="/rest/FacebookOmnichannelMessagingService/",this._settingsCodes=["IdentityServerUrl"],this._sysSettingsValues={},this.sysSettingsService.getByCodes(this._settingsCodes).subscribe(a=>{const i=a&&a.success&&a.values&&(0,Ge.Z)(a.values||{},r=>r.value);i&&(this._sysSettingsValues=i)})}getApplicationId(){return this.httpClient.get(this._serviceUrl+"GetCurrentFacebookAppId")}getApiVersion(){return"v8.0"}getIdentityServerUrl(){return this._sysSettingsValues.IdentityServerUrl}}oe.\u0275fac=function(t){return new(t||oe)(e.LFG(U.eN),e.LFG(we.lI))},oe.\u0275prov=e.Yz7({token:oe,factory:oe.\u0275fac});class ie{constructor(t,n){this._settingsService=t,this._window=n,this._permissions="pages_show_list,pages_messaging,pages_manage_metadata",this._toSubscribeFields="messages,messaging_postbacks,message_echoes,standby,messaging_handovers",this._sdkUrl="//connect.facebook.net/en_US/sdk.js"}_loadScript(t,n,a=null){const i=document.createElement("script");i.async=!0,i.src=t,i.onload=n,a||(a=document.head),a.appendChild(i)}_innerLogin(t=!1){const n={scope:this._permissions,return_scopes:!0};return t&&(n.auth_type="rerequest"),new Ce.y(a=>{FB.login(i=>{i.authResponse?a.next(!0):a.next(!1)},n)})}_getSubscribed(t,n){FB.api(`/me/subscribed_apps?access_token=${t}`,"GET",{},a=>{var i,r;n(((r=(i=a?.data)===null||i===void 0?void 0:i[0])===null||r===void 0?void 0:r.subscribed_fields)||[])})}isLoggedIn(){return new Ce.y(t=>{FB.getLoginStatus(n=>{n.status==="connected"?t.next(!0):t.next(!1)})})}login(){return this._innerLogin()}reLogin(){return this._innerLogin(!0)}getPages(){return new Ce.y(t=>{FB.api("me/accounts",n=>{t.next(n)})})}initialize(){return new Ce.y(t=>{this._loadScript(this._sdkUrl,()=>{this._settingsService.getApplicationId().subscribe(n=>{const a=n.replace(/\D+/g,"").trim();FB.init({appId:a,autoLogAppEvents:!0,cookie:!0,xfbml:!0,version:this._settingsService.getApiVersion()}),this.isInitialized=!0,t.next(!0)})})})}attachPage(t){return new Ce.y(n=>{this._getSubscribed(t,a=>{const i=(0,Be.Z)(a,this._toSubscribeFields.split(",")).join(",");FB.api(`/me/subscribed_apps?subscribed_fields=${i}&access_token=${t}`,"POST",{},r=>{n.next(r)})})})}isFacebookSettingValid(){return this._settingsService.getIdentityServerUrl()&&this._window.location.protocol==="https:"}}ie.\u0275fac=function(t){return new(t||ie)(e.LFG(oe),e.LFG("Window"))},ie.\u0275prov=e.Yz7({token:ie,factory:ie.\u0275fac});class W extends C.vau{constructor(){super(...arguments),this.getRegisteredEvents=()=>[{name:"actionClick",dataType:String}]}onActionClick(){this.fireEvent("actionClick","edit")}}W.\u0275fac=function(){let o;return function(n){return(o||(o=e.n5z(W)))(n||W)}}(),W.\u0275dir=e.lG2({type:W,features:[e.qOj]});function Ue(o,t){if(o&1){const n=e.EpF();e.ynx(0),e.TgZ(1,"a",1),e.NdJ("click",function(i){e.CHM(n);const r=e.oxw();return e.KtG(r.onActionClick(i))}),e._uU(2),e.qZA(),e.BQk()}if(o&2){const n=e.oxw();e.xp6(2),e.Oqu(n.record.name)}}class z extends W{}z.\u0275fac=function(){let o;return function(n){return(o||(o=e.n5z(z)))(n||z)}}(),z.\u0275cmp=e.Xpm({type:z,selectors:[["ts-channel-name-cell"]],features:[e.qOj],decls:1,vars:1,consts:[[4,"ngIf"],[3,"href","click"]],template:function(t,n){t&1&&e.YNc(0,Ue,3,1,"ng-container",0),t&2&&e.Q6J("ngIf",!n.isEmpty())},dependencies:[f.O5]});var $=c(84945),ve=c(5490);class M extends C.neP{constructor(t,n,a,i,r,u){super(t),this.dialogRef=n,this.dialogService=a,this.channelService=i,this.formBuilder=r,this.isExpanded=!0,this.getGtmSchemaName=()=>"ChannelPage",this.data=u}_getSuccessResponse(){return(0,$.of)({success:!0,errorInfo:null,result:[]})}setChannelId(){var t,n;const a=(n=(t=this.data)===null||t===void 0?void 0:t.channel)===null||n===void 0?void 0:n.id;a&&(this.model.id=a)}_buildForm(){this.channelForm=this.formBuilder.group(this.getFormGroup())}_getErrorMessageByErrorKey(t,n){const a=t[n];if(typeof a=="string")return a;let i=n;switch(n){case"validateLookup":case"required":i="ChatSettings.ChannelPage.ValidationMessage.required";break;default:i="ChatSettings.ChannelPage.ValidationMessage.wrongValue"}return this.translateInstant(i)}savePageData(t){return this.isChanged?this.isNew?this.channelService.insertItem(t):(this.showBodyMask(),this.channelService.updateItem(t)):this._getSuccessResponse()}requestPageData(){return this.isNew?(this.setIsChanged(),(0,$.of)(this.channelService.generateNewChannelResponse(this.channelTypeId))):this.channelService.getItem(this.model.id)}getModelFromLoadResponse(t){return t.result[0]}preProcessLoadedPageModel(t){return t=super.preProcessLoadedPageModel(t),this.initPageTitle(t),t}initPageTitle(t){this.pageTitle=t.name}onModelSet(t){this.channelForm.patchValue({channelNameGroup:{name:t.name},channelLanguageGroup:{language:t.languageId},channelQueueGroup:{queue:t.queueId,isActive:t.isActive},token:this.token,queue:t.queueId,isActive:t.isActive})}createChangeBroadcastService(){return this.injector.get(ye)}getFormGroup(){return{channelNameGroup:new s.cw({name:new s.p4(null)}),channelLanguageGroup:new s.cw({language:new s.p4(null)}),channelQueueGroup:new s.cw({status:new s.p4(null),queue:new s.p4(null),isActive:new s.p4({value:!1})}),token:new s.p4({value:""})}}isModelValid(){return this.model.isActive&&!this.model.queueId?!1:super.isModelValid()&&!this.channelForm.invalid}saveChannel(){this.showBodyMask(),this.model.isActive?(this.save(),this.hideBodyMask(),this.dialogRef.close()):this.dialogService.openConfirmationDialog(this.translateInstant("ChatSettings.ChannelPage.InactiveChannelMessage")).pipe((0,ve.x)(()=>this.hideBodyMask())).subscribe(t=>{t===T.Zz.result&&(this.save(),this.dialogRef.close())})}saveButtonVisible(){return super.saveButtonVisible()&&this.isModelValid()}ngOnInit(){this._buildForm(),this.setChannelId(),super.ngOnInit()}channelChanged(){this.setIsChanged()}getChannelPageData(){return{isNew:this.isNew}}isInvalid(t){return this.channelForm.get(t).invalid}getValidationMessage(t,n,a){const i=this.channelForm.get(t);if(!i||!i.errors)return"";const r=i.errors,u=Object.keys(i.errors)[0];return n&&n===u?this.translateInstant(a):this._getErrorMessageByErrorKey(r,u)}}M.\u0275fac=function(t){return new(t||M)(e.Y36(e.zs3),e.Y36(d.hV),e.Y36(T.xA),e.Y36(S),e.Y36(s.qu),e.Y36(d.eJ))},M.\u0275cmp=e.Xpm({type:M,selectors:[["ts-base-channel-dialog-page"]],features:[e.qOj],decls:0,vars:0,template:function(t,n){},styles:[".channel-mini-page[_ngcontent-%COMP%]   .mat-form-field[_ngcontent-%COMP%]{width:100%}.channel-mini-page[_ngcontent-%COMP%]   .mat-form-field[_ngcontent-%COMP%]   .mat-form-field-prefix[_ngcontent-%COMP%]{margin-left:-10px}.channel-mini-page[_ngcontent-%COMP%]   .channel-page-title[_ngcontent-%COMP%]{font-size:21px;color:#006ce0}.channel-mini-page[_ngcontent-%COMP%]   .channel-page-title-container[_ngcontent-%COMP%]{margin-bottom:14px}.channel-mini-page[_ngcontent-%COMP%]   .mat-dialog-actions.channel-buttons-container[_ngcontent-%COMP%]{float:right;margin-top:35px}.channel-mini-page[_ngcontent-%COMP%]   .save-channel-button[_ngcontent-%COMP%]{margin-right:20px}.channel-mini-page[_ngcontent-%COMP%]   .channel-toggle[_ngcontent-%COMP%]{margin-top:17px}.channel-mini-page[_ngcontent-%COMP%]   .close-channel-page-button[_ngcontent-%COMP%]{color:#006ce0;background-color:#fff;font-size:15px}.channel-mini-page[_ngcontent-%COMP%]   .underline-divider[_ngcontent-%COMP%]{background:none;border-bottom:1px dotted var(--field-underline);bottom:.25em;margin-top:5px}.channel-mini-page[_ngcontent-%COMP%]   span.locked[_ngcontent-%COMP%]{background-image:url(data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxNiIgaGVpZ2h0PSIxNiIgdmlld0JveD0iMCAwIDE2IDE2Ij48ZGVmcz48c3R5bGU+LmEsLmJ7ZmlsbDpyZ2JhKDAsMCwwLDApO30uYntzdHJva2U6I2I1YjViNTtzdHJva2UtbWl0ZXJsaW1pdDoxMDt9LmN7ZmlsbDojYjViNWI1O308L3N0eWxlPjwvZGVmcz48cmVjdCBjbGFzcz0iYSIgd2lkdGg9IjE2IiBoZWlnaHQ9IjE2Ii8+PHJlY3QgY2xhc3M9ImIiIHdpZHRoPSIxMSIgaGVpZ2h0PSI5IiByeD0iMiIgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoMi41IDUuNSkiLz48cGF0aCBjbGFzcz0iYyIgZD0iTTksOUg3djJIOVY5WiIvPjxwYXRoIGNsYXNzPSJiIiBkPSJNNjI2LjUtMTM2LjV2LTJhMiwyLDAsMCwxLDItMmgxYTIsMiwwLDAsMSwyLDJ2MiIgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoLTYyMSAxNDIpIi8+PC9zdmc+);width:16px;height:16px;vertical-align:sub;float:right}.channel-mini-page[_ngcontent-%COMP%]   .field-title[_ngcontent-%COMP%]{color:#999;font-size:13px}.channel-mini-page[_ngcontent-%COMP%]   .channel-page-link-label[_ngcontent-%COMP%]{display:block}.channel-mini-page[_ngcontent-%COMP%]   .mat-form-field-infix[_ngcontent-%COMP%]   .tooltip[_ngcontent-%COMP%]{margin-top:-20px}.channel-mini-page[_ngcontent-%COMP%]   .tooltip[_ngcontent-%COMP%]{width:7px;margin-right:-7px;z-index:1;display:inline-block;margin-top:-5px;vertical-align:top}.channel-mini-page[_ngcontent-%COMP%]   .tooltip[_ngcontent-%COMP%]   .mat-icon[_ngcontent-%COMP%]{background:linear-gradient(130deg,#94de35 6px,transparent 0px) 0% 0%;margin-left:-7px}.channel-mini-page[_ngcontent-%COMP%]   .tooltip[_ngcontent-%COMP%]   .mat-icon[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{display:none}"]});function Ye(o,t){if(o&1){const n=e.EpF();e.TgZ(0,"button",11),e.NdJ("click",function(){e.CHM(n);const i=e.oxw();return e.KtG(i.saveChannel())}),e._uU(1),e.ALo(2,"translate"),e.qZA()}o&2&&(e.xp6(1),e.Oqu(e.lcZ(2,1,"BasePageComponent.Apply")))}const je=function(o,t,n){return{channelLinkUrl:o,channelLinkCaption:t,channelPageCaption:n}};class D extends M{initPageTitle(t){super.initPageTitle(t),this.facebookLinkPageName=t.name}onModelSet(t){super.onModelSet(t),this.channelForm.patchValue({facebookLinkPageName:t.name})}getFormGroup(){const t=super.getFormGroup();return t.facebookLink=new s.p4({value:""}),t}getFacebookLink(){var t;let n="#";return!((t=this.model)===null||t===void 0)&&t.source&&(n=`https://facebook.com/${this.model.source}`),n}}D.\u0275fac=function(){let o;return function(n){return(o||(o=e.n5z(D)))(n||D)}}(),D.\u0275cmp=e.Xpm({type:D,selectors:[["ts-facebook-channel-dialog-page"]],features:[e.qOj],decls:15,vars:20,consts:[[1,"channel-mini-page"],[3,"formGroup"],[1,"channel-page-title-container"],[1,"channel-page-title"],[3,"pageData","channelNameGroup","model","onChannelChanged"],[3,"channelTitle"],[3,"model","channelQueueGroup","onChannelChanged"],[3,"channelLanguageGroup","model","onChannelChanged"],["mat-dialog-actions","",1,"channel-buttons-container"],["class","action-button","mat-flat-button","","color","primary",3,"click",4,"ngIf"],["mat-flat-button","",1,"close-channel-page-button",3,"mat-dialog-close"],["mat-flat-button","","color","primary",1,"action-button",3,"click"]],template:function(t,n){t&1&&(e.TgZ(0,"div",0)(1,"form",1)(2,"div",2)(3,"mat-label",3),e._uU(4),e.qZA()(),e.TgZ(5,"ts-base-channel-name",4),e.NdJ("onChannelChanged",function(){return n.channelChanged()}),e.qZA(),e._UZ(6,"ts-base-channel-title",5),e.ALo(7,"translate"),e.TgZ(8,"ts-base-channel-queue",6),e.NdJ("onChannelChanged",function(){return n.channelChanged()}),e.qZA(),e.TgZ(9,"ts-base-channel-language",7),e.NdJ("onChannelChanged",function(){return n.channelChanged()}),e.qZA(),e.TgZ(10,"div",8),e.YNc(11,Ye,3,3,"button",9),e.TgZ(12,"button",10),e._uU(13),e.ALo(14,"translate"),e.qZA()()()()),t&2&&(e.xp6(1),e.Q6J("formGroup",n.channelForm),e.xp6(3),e.Oqu(n.pageTitle),e.xp6(1),e.Q6J("pageData",n.getChannelPageData())("channelNameGroup",n.channelForm.get("channelNameGroup"))("model",n.model),e.xp6(1),e.Q6J("channelTitle",e.kEZ(16,je,n.getFacebookLink(),n.facebookLinkPageName,e.lcZ(7,12,"ChatSettings.ChannelPage.FacebookPageLinkCaption"))),e.xp6(2),e.Q6J("model",n.model)("channelQueueGroup",n.channelForm.get("channelQueueGroup")),e.xp6(1),e.Q6J("channelLanguageGroup",n.channelForm.get("channelLanguageGroup"))("model",n.model),e.xp6(2),e.Q6J("ngIf",n.saveButtonVisible()),e.xp6(2),e.hij(" ",e.lcZ(14,14,"BasePageComponent.Cancel")," "))}});class se{constructor(t){this.data=t}ngOnInit(){}}se.\u0275fac=function(t){return new(t||se)(e.Y36(d.eJ))},se.\u0275cmp=e.Xpm({type:se,selectors:[["ts-facebook-channel-error-dialog"]],decls:12,vars:12,consts:[["mat-dialog-content",""],[1,"message"],["target","_blank",3,"href"],["mat-dialog-actions",""],["mat-flat-button","","color","primary","cdkFocusInitial","",1,"action-button",3,"mat-dialog-close"]],template:function(t,n){t&1&&(e.TgZ(0,"div",0)(1,"span",1),e._uU(2),e.ALo(3,"translate"),e.TgZ(4,"a",2),e.ALo(5,"translate"),e._uU(6),e.ALo(7,"translate"),e.qZA()()(),e.TgZ(8,"div",3)(9,"button",4),e._uU(10),e.ALo(11,"translate"),e.qZA()()),t&2&&(e.xp6(2),e.hij(" ",e.lcZ(3,4,"ChatSettings.ChannelDetail.FacebookSettings.InvalidSettings.Message")," "),e.xp6(2),e.s9C("href",e.lcZ(5,6,"ChatSettings.ChannelDetail.FacebookSettings.InvalidSettings.Link.Url"),e.LSH),e.xp6(2),e.hij(" ",e.lcZ(7,8,"ChatSettings.ChannelDetail.FacebookSettings.InvalidSettings.Link.Text")," "),e.xp6(4),e.Oqu(e.lcZ(11,10,"InfoDialog.OK")))},dependencies:[I.eB,d.aO,d.Rb,d.ev,p.X$],styles:["[mat-dialog-content][_ngcontent-%COMP%]{max-height:450px;overflow-y:auto!important}[mat-dialog-content][_ngcontent-%COMP%]   .message[_ngcontent-%COMP%]{white-space:pre-line;word-break:break-word}[mat-dialog-actions][_ngcontent-%COMP%]{margin:27px 0 0!important}"]});function He(o,t){o&1&&e._UZ(0,"ts-mask",11)}function We(o,t){if(o&1){const n=e.EpF();e.TgZ(0,"mat-form-field")(1,"mat-label",12),e._uU(2),e.ALo(3,"translate"),e.qZA(),e.TgZ(4,"input",13),e.NdJ("input",function(i){e.CHM(n);const r=e.oxw();return e.KtG(r.onTokenChange(i.target.value))})("ngModelChange",function(i){e.CHM(n);const r=e.oxw();return e.KtG(r.telegramToken=i)}),e.qZA()()}if(o&2){const n=e.oxw();e.xp6(2),e.Oqu(e.lcZ(3,2,"ChatSettings.ChannelPage.Token")),e.xp6(2),e.Q6J("ngModel",n.telegramToken)}}const ze=function(o,t,n){return{channelLinkUrl:o,channelLinkCaption:t,channelPageCaption:n}};function $e(o,t){if(o&1){const n=e.EpF();e.ynx(0),e.TgZ(1,"ts-base-channel-name",14),e.NdJ("onChannelChanged",function(){e.CHM(n);const i=e.oxw();return e.KtG(i.channelChanged())}),e.qZA(),e._UZ(2,"ts-base-channel-title",15),e.ALo(3,"translate"),e.BQk()}if(o&2){const n=e.oxw();e.xp6(1),e.Q6J("pageData",n.getChannelPageData())("channelNameGroup",n.channelForm.get("channelNameGroup"))("model",n.model),e.xp6(1),e.Q6J("channelTitle",e.kEZ(6,ze,n.getTelegramLink(),n.telegramLinkCaption,e.lcZ(3,4,"ChatSettings.ChannelPage.Telegram.TelegramPageLinkCaption")))}}function Ke(o,t){if(o&1){const n=e.EpF();e.TgZ(0,"button",16),e.NdJ("click",function(){e.CHM(n);const i=e.oxw();return e.KtG(i.saveTelegramChannel())}),e._uU(1),e.ALo(2,"translate"),e.qZA()}o&2&&(e.xp6(1),e.Oqu(e.lcZ(2,1,"BasePageComponent.Apply")))}class K extends M{constructor(t,n,a,i,r,u,m){super(t,n,a,i,r,u),this.dialogRef=n,this.dialogService=a,this.channelService=i,this.formBuilder=r,this.telegramService=m}getFormGroup(){const t=super.getFormGroup();return t.telegramToken=new s.p4({value:""}),t}initPageTitle(t){this.isNew||this.telegramService.getTelegramUserName(this.data.channel.msgSettingsId).subscribe(n=>{this.telegramUserName=n}),this.telegramLinkCaption=t.name,super.initPageTitle(t)}handleTelegramChannelSave(t){t.IsTokenValid?t.IsTokenExist?this.dialogService.openInfoDialog(this.translateInstant("ChatSettings.ChannelPage.Telegram.TelegramTokenAlreadyExists")):(this.model.msgSettingsId=t.SettingsId,this.model.name=t.ChannelName,this.model.source=t.TelegramId,this.model.typeId=this.data.channel.typeId,this.model.typeName=this.data.channel.typeName,this.saveChannel()):this.dialogService.openInfoDialog(this.translateInstant("ChatSettings.ChannelPage.Telegram.InvalidTelegramToken"))}onTokenChange(t){this.telegramToken=t,this.setIsChanged()}saveTelegramChannel(){this.showBodyMask(),this.isNew?this.telegramService.registerTelegramChannel(this.telegramToken).pipe((0,ve.x)(()=>this.hideBodyMask())).subscribe(t=>this.handleTelegramChannelSave(t)):this.saveChannel()}getTelegramLink(){let t="#";return this.telegramUserName&&(t=`https://t.me/${this.telegramUserName}`),t}ngOnInit(){var t,n;this.isNew=this.data.isNew,this.channelTypeId=(n=(t=this.data)===null||t===void 0?void 0:t.channel)===null||n===void 0?void 0:n.typeId,super.ngOnInit()}}K.\u0275fac=function(t){return new(t||K)(e.Y36(e.zs3),e.Y36(d.hV),e.Y36(T.xA),e.Y36(S),e.Y36(s.qu),e.Y36(d.eJ),e.Y36(j))},K.\u0275cmp=e.Xpm({type:K,selectors:[["ts-telegram-channel-dialog-page"]],features:[e.qOj],decls:15,vars:13,consts:[["class","component-mask",4,"ngIf"],[1,"channel-mini-page"],[3,"formGroup"],[1,"channel-page-title-container"],[1,"channel-page-title"],[4,"ngIf"],[3,"model","channelQueueGroup","onChannelChanged"],[3,"channelLanguageGroup","model","onChannelChanged"],["mat-dialog-actions","",1,"channel-buttons-container","telegram-channel-buttons-container"],["class","action-button telegram-action-button","mat-flat-button","","color","primary",3,"click",4,"ngIf"],["mat-flat-button","",1,"close-channel-page-button",3,"mat-dialog-close"],[1,"component-mask"],[1,"field-title"],["matInput","","type","text","formControlName","telegramToken","required","","data-qa","telegramToken",3,"ngModel","input","ngModelChange"],[3,"pageData","channelNameGroup","model","onChannelChanged"],[3,"channelTitle"],["mat-flat-button","","color","primary",1,"action-button","telegram-action-button",3,"click"]],template:function(t,n){t&1&&(e.YNc(0,He,1,0,"ts-mask",0),e.TgZ(1,"div",1)(2,"form",2)(3,"div",3)(4,"mat-label",4),e._uU(5),e.qZA()(),e.YNc(6,We,5,4,"mat-form-field",5),e.YNc(7,$e,4,10,"ng-container",5),e.TgZ(8,"ts-base-channel-queue",6),e.NdJ("onChannelChanged",function(){return n.channelChanged()}),e.qZA(),e.TgZ(9,"ts-base-channel-language",7),e.NdJ("onChannelChanged",function(){return n.channelChanged()}),e.qZA(),e.TgZ(10,"div",8),e.YNc(11,Ke,3,3,"button",9),e.TgZ(12,"button",10),e._uU(13),e.ALo(14,"translate"),e.qZA()()()()),t&2&&(e.Q6J("ngIf",n.isLoading),e.xp6(2),e.Q6J("formGroup",n.channelForm),e.xp6(3),e.Oqu(n.pageTitle),e.xp6(1),e.Q6J("ngIf",n.isNew),e.xp6(1),e.Q6J("ngIf",!n.isNew),e.xp6(1),e.Q6J("model",n.model)("channelQueueGroup",n.channelForm.get("channelQueueGroup")),e.xp6(1),e.Q6J("channelLanguageGroup",n.channelForm.get("channelLanguageGroup"))("model",n.model),e.xp6(2),e.Q6J("ngIf",n.saveButtonVisible()),e.xp6(2),e.hij(" ",e.lcZ(14,11,"BasePageComponent.Cancel")," "))}});function Xe(o,t){o&1&&e._UZ(0,"ts-mask",11)}function et(o,t){if(o&1&&(e.TgZ(0,"mat-error"),e._uU(1),e.qZA()),o&2){const n=e.oxw(2);e.xp6(1),e.hij(" ",n.getValidationMessage("integrationForm.channelPhoneNumber","pattern","ChatSettings.ChannelPage.WhatsApp.InvalidPhoneNumber")," ")}}function tt(o,t){if(o&1&&(e.TgZ(0,"mat-error"),e._uU(1),e.qZA()),o&2){const n=e.oxw(2);e.xp6(1),e.hij(" ",n.getValidationMessage("integrationForm.integrationPhoneNumber","pattern","ChatSettings.ChannelPage.WhatsApp.InvalidPhoneNumber")," ")}}function nt(o,t){if(o&1&&(e.TgZ(0,"mat-error"),e._uU(1),e.qZA()),o&2){const n=e.oxw(2);e.xp6(1),e.hij(" ",n.getValidationMessage("integrationForm.applicationId")," ")}}function at(o,t){if(o&1&&(e.TgZ(0,"mat-error"),e._uU(1),e.qZA()),o&2){const n=e.oxw(2);e.xp6(1),e.hij(" ",n.getValidationMessage("integrationForm.token")," ")}}function ot(o,t){if(o&1){const n=e.EpF();e.ynx(0,2),e.TgZ(1,"mat-form-field",12)(2,"mat-label",13),e._uU(3),e.ALo(4,"translate"),e.qZA(),e.TgZ(5,"span",14),e._uU(6,"+\xA0"),e.qZA(),e.TgZ(7,"input",15),e.NdJ("ngModelChange",function(i){e.CHM(n);const r=e.oxw();return e.KtG(r.channelPhoneNumber=i)}),e.qZA(),e.YNc(8,et,2,1,"mat-error",6),e.qZA(),e.TgZ(9,"mat-form-field",12),e._UZ(10,"ts-info-tooltip-icon",16),e.ALo(11,"translate"),e.TgZ(12,"mat-label",13),e._uU(13),e.ALo(14,"translate"),e.qZA(),e.TgZ(15,"span",14),e._uU(16,"+\xA0"),e.qZA(),e.TgZ(17,"input",17),e.NdJ("ngModelChange",function(i){e.CHM(n);const r=e.oxw();return e.KtG(r.integrationPhoneNumber=i)}),e.qZA(),e.YNc(18,tt,2,1,"mat-error",6),e.qZA(),e.TgZ(19,"mat-form-field",12),e._UZ(20,"ts-info-tooltip-icon",16),e.ALo(21,"translate"),e.TgZ(22,"mat-label",13),e._uU(23),e.ALo(24,"translate"),e.qZA(),e.TgZ(25,"input",18),e.NdJ("ngModelChange",function(i){e.CHM(n);const r=e.oxw();return e.KtG(r.applicationId=i)}),e.qZA(),e.YNc(26,nt,2,1,"mat-error",6),e.qZA(),e.TgZ(27,"mat-form-field",12),e._UZ(28,"ts-info-tooltip-icon",16),e.ALo(29,"translate"),e.TgZ(30,"mat-label",13),e._uU(31),e.ALo(32,"translate"),e.qZA(),e.TgZ(33,"input",19),e.NdJ("ngModelChange",function(i){e.CHM(n);const r=e.oxw();return e.KtG(r.token=i)}),e.qZA(),e.YNc(34,at,2,1,"mat-error",6),e.qZA(),e.BQk()}if(o&2){const n=e.oxw();e.Q6J("formGroup",n.channelForm.get("integrationForm")),e.xp6(3),e.Oqu(e.lcZ(4,16,"ChatSettings.ChannelPage.WhatsApp.ChannelPhoneNumber")),e.xp6(4),e.Q6J("ngModel",n.channelPhoneNumber),e.xp6(1),e.Q6J("ngIf",n.isInvalid("integrationForm.channelPhoneNumber")),e.xp6(2),e.Q6J("message",e.lcZ(11,18,"ChatSettings.ChannelPage.Tips.WhatsAppTestPhoneNumber")),e.xp6(3),e.Oqu(e.lcZ(14,20,"ChatSettings.ChannelPage.WhatsApp.IntegrationPhoneNumber")),e.xp6(4),e.Q6J("ngModel",n.integrationPhoneNumber),e.xp6(1),e.Q6J("ngIf",n.isInvalid("integrationForm.integrationPhoneNumber")),e.xp6(2),e.Q6J("message",e.lcZ(21,22,"ChatSettings.ChannelPage.Tips.WhatsAppId")),e.xp6(3),e.Oqu(e.lcZ(24,24,"ChatSettings.ChannelPage.WhatsApp.ApplicationId")),e.xp6(2),e.Q6J("ngModel",n.applicationId),e.xp6(1),e.Q6J("ngIf",n.isInvalid("integrationForm.applicationId")),e.xp6(2),e.Q6J("message",e.lcZ(29,26,"ChatSettings.ChannelPage.Tips.WhatsAppToken")),e.xp6(3),e.Oqu(e.lcZ(32,28,"ChatSettings.ChannelPage.Token")),e.xp6(2),e.Q6J("ngModel",n.token),e.xp6(1),e.Q6J("ngIf",n.isInvalid("integrationForm.token"))}}const it=function(o,t,n){return{channelLinkUrl:o,channelLinkCaption:t,channelPageCaption:n}};function st(o,t){if(o&1){const n=e.EpF();e.ynx(0),e._UZ(1,"ts-base-channel-title",20),e.ALo(2,"translate"),e.TgZ(3,"ts-base-channel-queue",21),e.NdJ("onChannelChanged",function(){e.CHM(n);const i=e.oxw();return e.KtG(i.channelChanged())}),e.qZA(),e.TgZ(4,"ts-base-channel-language",22),e.NdJ("onChannelChanged",function(){e.CHM(n);const i=e.oxw();return e.KtG(i.channelChanged())}),e.qZA(),e.BQk()}if(o&2){const n=e.oxw();e.xp6(1),e.Q6J("channelTitle",e.kEZ(7,it,n.getLink(),n.whatsAppLinkPageName,e.lcZ(2,5,"ChatSettings.ChannelPage.WhatsApp.PageLinkCaption"))),e.xp6(2),e.Q6J("model",n.model)("channelQueueGroup",n.channelForm.get("channelQueueGroup")),e.xp6(1),e.Q6J("channelLanguageGroup",n.channelForm.get("channelLanguageGroup"))("model",n.model)}}function rt(o,t){if(o&1){const n=e.EpF();e.TgZ(0,"button",23),e.NdJ("click",function(){e.CHM(n);const i=e.oxw();return e.KtG(i.saveChannel())}),e._uU(1),e.ALo(2,"translate"),e.qZA()}o&2&&(e.xp6(1),e.hij(" ",e.lcZ(2,1,"BasePageComponent.Apply")," "))}function lt(o,t){if(o&1){const n=e.EpF();e.TgZ(0,"button",24),e.NdJ("click",function(){e.CHM(n);const i=e.oxw();return e.KtG(i.validateIntegration())}),e._uU(1),e.ALo(2,"translate"),e.qZA()}o&2&&(e.xp6(1),e.hij(" ",e.lcZ(2,1,"ChatSettings.ChannelPage.WhatsApp.Connect")," "))}class X extends M{constructor(t,n,a,i,r,u,m){super(t,n,a,i,r,u),this.dialogRef=n,this.dialogService=a,this.channelService=i,this.formBuilder=r,this.whatsappService=m,this._numberValidationRegex="^\\d+$",this.integrationFormValidator=_=>_.get("channelPhoneNumber").errors||_.get("integrationPhoneNumber").errors||_.get("applicationId").errors||_.get("token").errors?{integrationFormInvalid:!0}:null}_getPhoneValidators(){return[s.kI.required,s.kI.minLength(8),s.kI.maxLength(15),s.kI.pattern(this._numberValidationRegex)]}loadInitialPageData(){if(this.isNew)this.channelForm.patchValue({channelQueueGroup:{isActive:!1}}),this.isLoading=!1;else return super.loadInitialPageData()}getFormGroup(){const t=super.getFormGroup();if(this.isChannelValidated)return t;const n=new s.cw({link:new s.p4(""),channelPhoneNumber:new s.p4("",this._getPhoneValidators()),integrationPhoneNumber:new s.p4("",this._getPhoneValidators()),applicationId:new s.p4("",[s.kI.required]),token:new s.p4("",[s.kI.required])},{validators:this.integrationFormValidator.bind(this)});return n.valueChanges.subscribe(()=>{this.channelChanged()}),t.integrationForm=n,t}initPageTitle(t){super.initPageTitle(t),this.whatsAppLinkPageName=t.name||t.source}getLink(){var t;let n="#";return!((t=this.model)===null||t===void 0)&&t.name&&(n=`https://wa.me/${this.model.name}`),n}handleRegisterResponse(t){this.model.msgSettingsId=t.SettingsId,this.model.typeId=this.channelTypeId,this.model.source=this.channelPhoneNumber,super.saveChannel()}handleValidationResponse(t){var n;if(t?.IsConnectionSuccess)this.isChannelValidated=t?.IsConnectionSuccess,this.model.name=`+${this.channelPhoneNumber}`,this.whatsAppLinkPageName=this.model.name;else if(!((n=t?.errorInfo)===null||n===void 0)&&n.errorCode){const a=t.errorInfo.errorCode;let i;["InvalidAppSidException","InvalidAccountPhoneNumberException","AuthenticateException"].indexOf(a)>-1?i=this.translateInstant(`ChatSettings.ChannelPage.WhatsApp.ErrorMessages.${a}`):i=t.errorInfo.message,this.dialogService.openInfoDialog(i)}}validateIntegration(){this.showBodyMask(),this.channelService.checkCanSaveChannel(this.channelPhoneNumber,t=>{t?this.whatsappService.tryConnect(this.token,this.applicationId,this.integrationPhoneNumber,this.channelPhoneNumber).pipe((0,ve.x)(()=>this.hideBodyMask())).subscribe(n=>this.handleValidationResponse(n)):(this.hideBodyMask(),this.dialogService.openInfoDialog(this.translateInstant("ChatSettings.ChannelPage.WhatsApp.ChannelDuplicatedErrorMessage")))})}saveChannel(){this.showBodyMask(),this.isNew?this.whatsappService.register(this.token,this.applicationId,this.integrationPhoneNumber,this.channelPhoneNumber).pipe((0,ve.x)(()=>this.hideBodyMask())).subscribe(t=>this.handleRegisterResponse(t)):super.saveChannel()}shouldShowConnectButton(){var t;return!(!((t=this.channelForm.get("integrationForm"))===null||t===void 0)&&t.errors)&&!this.isChannelValidated}ngOnInit(){var t,n,a;this.isNew=this.data.isNew,this.isChannelValidated=(t=this.isChannelValidated)!==null&&t!==void 0?t:!this.data.isNew,this.channelTypeId=(a=(n=this.data)===null||n===void 0?void 0:n.channel)===null||a===void 0?void 0:a.typeId,super.ngOnInit()}}X.\u0275fac=function(t){return new(t||X)(e.Y36(e.zs3),e.Y36(d.hV),e.Y36(T.xA),e.Y36(S),e.Y36(s.qu),e.Y36(d.eJ),e.Y36(H))},X.\u0275cmp=e.Xpm({type:X,selectors:[["ts-whatsapp-channel-dialog-page"]],features:[e.qOj],decls:14,vars:10,consts:[["class","component-mask",4,"ngIf"],[1,"channel-mini-page"],[3,"formGroup"],[1,"channel-page-title-container"],[1,"channel-page-title"],[3,"formGroup",4,"ngIf"],[4,"ngIf"],["mat-dialog-actions","",1,"channel-buttons-container"],["class","action-button","data-qa","apply","mat-flat-button","","color","primary",3,"click",4,"ngIf"],["class","action-button","data-qa","connect","mat-flat-button","","color","primary",3,"click",4,"ngIf"],["data-qa","cancel","mat-flat-button","",1,"close-channel-page-button",3,"mat-dialog-close"],[1,"component-mask"],["floatLabel","always"],[1,"field-title"],["matPrefix",""],["matInput","","type","tel","maxlength","15","formControlName","channelPhoneNumber","required","","data-qa","channelPhoneNumber",3,"ngModel","ngModelChange"],[1,"tooltip",3,"message"],["matInput","","type","tel","maxlength","15","formControlName","integrationPhoneNumber","required","","data-qa","integrationPhoneNumber",3,"ngModel","ngModelChange"],["matInput","","type","text","formControlName","applicationId","required","","data-qa","applicationId",3,"ngModel","ngModelChange"],["matInput","","type","text","formControlName","token","required","","data-qa","token",3,"ngModel","ngModelChange"],[3,"channelTitle"],[3,"model","channelQueueGroup","onChannelChanged"],[3,"channelLanguageGroup","model","onChannelChanged"],["data-qa","apply","mat-flat-button","","color","primary",1,"action-button",3,"click"],["data-qa","connect","mat-flat-button","","color","primary",1,"action-button",3,"click"]],template:function(t,n){t&1&&(e.YNc(0,Xe,1,0,"ts-mask",0),e.TgZ(1,"div",1)(2,"form",2)(3,"div",3)(4,"mat-label",4),e._uU(5),e.qZA()(),e.YNc(6,ot,35,30,"ng-container",5),e.YNc(7,st,5,11,"ng-container",6),e.TgZ(8,"div",7),e.YNc(9,rt,3,3,"button",8),e.YNc(10,lt,3,3,"button",9),e.TgZ(11,"button",10),e._uU(12),e.ALo(13,"translate"),e.qZA()()()()),t&2&&(e.Q6J("ngIf",n.isLoading),e.xp6(2),e.Q6J("formGroup",n.channelForm),e.xp6(3),e.Oqu(n.pageTitle),e.xp6(1),e.Q6J("ngIf",n.isNew&&!n.isChannelValidated),e.xp6(1),e.Q6J("ngIf",n.isChannelValidated),e.xp6(2),e.Q6J("ngIf",n.saveButtonVisible()&&n.isChannelValidated),e.xp6(1),e.Q6J("ngIf",n.shouldShowConnectButton()),e.xp6(2),e.hij(" ",e.lcZ(13,8,"BasePageComponent.Cancel")," "))}});var ct=c(41867);function ut(o,t){if(o&1){const n=e.EpF();e.TgZ(0,"mat-icon",12),e.NdJ("click",function(){e.CHM(n);const i=e.oxw();return e.KtG(i.addRecord())}),e.qZA()}}function ht(o,t){if(o&1){const n=e.EpF();e.TgZ(0,"mat-icon",12),e.NdJ("click",function(){e.CHM(n);const i=e.oxw(2);return e.KtG(i.addRecord(i.recordTypes[0]))}),e.qZA()}}function pt(o,t){if(o&1){const n=e.EpF();e.ynx(0),e.TgZ(1,"button",16),e.NdJ("click",function(){const r=e.CHM(n).$implicit,u=e.oxw(3);return e.KtG(u.addRecord(r))}),e._uU(2),e.qZA(),e.BQk()}if(o&2){const n=t.$implicit;e.xp6(2),e.Oqu(n.displayValue)}}function gt(o,t){if(o&1&&(e._UZ(0,"mat-icon",14),e.TgZ(1,"mat-menu",null,15),e.YNc(3,pt,3,1,"ng-container",8),e.qZA()),o&2){const n=e.MAs(2),a=e.oxw(2);e.Q6J("matMenuTriggerFor",n),e.xp6(3),e.Q6J("ngForOf",a.recordTypes)}}function dt(o,t){if(o&1&&(e.YNc(0,ht,1,0,"ng-template",4),e.YNc(1,gt,4,2,"ng-template",null,13,e.W1O)),o&2){const n=e.MAs(2),a=e.oxw();e.Q6J("ngIf",a.recordTypes.length===1)("ngIfElse",n)}}function mt(o,t){if(o&1&&e._UZ(0,"span",17),o&2){e.oxw();const n=e.MAs(10);e.Q6J("matMenuTriggerFor",n)}}function Ct(o,t){if(o&1){const n=e.EpF();e.ynx(0),e.TgZ(1,"button",18),e.NdJ("click",function(){const r=e.CHM(n).$implicit,u=e.oxw();return e.KtG(r.click(u.selectedRecord))}),e._uU(2),e.qZA(),e.BQk()}if(o&2){const n=t.$implicit,a=e.oxw();e.xp6(1),e.Q6J("disabled",!a.selectedRecord),e.xp6(1),e.Oqu(n.caption)}}class x{constructor(){this.isExpanded=!0,this.addRecordHandle=new e.vpe,this.selectMode="none"}addRecord(t){this.addRecordHandle.emit(t)}toggleExpansionViewModel(){this.isExpanded=!this.isExpanded}onSelectRecord(t){!t||(this.selectedRecord=t[0])}}x.\u0275fac=function(t){return new(t||x)},x.\u0275cmp=e.Xpm({type:x,selectors:[["ts-expansion-detail"]],inputs:{header:"header",isExpanded:"isExpanded",dataSource:"dataSource",dataSchema:"dataSchema",tableEventHandlers:"tableEventHandlers",recordTypes:"recordTypes",actionHandlers:"actionHandlers",selectMode:"selectMode"},outputs:{addRecordHandle:"addRecordHandle"},decls:15,vars:14,consts:[[1,"header-wrapper"],[1,"expander",3,"click"],[3,"svgIcon"],[1,"title"],[3,"ngIf","ngIfElse"],["hasRecordTypes",""],["class","menu-trigger-icon",3,"matMenuTriggerFor",4,"ngIf"],["detailActionType","matMenu"],[4,"ngFor","ngForOf"],[3,"hideToggle","expanded","opened","closed"],[1,"page-tab"],["headerSticky","true",3,"selectMode","dataSchema","dataSource","eventHandlers","selectedChange"],["svgIcon","add-button",1,"add-button",3,"click"],["hasManyRecordTypes",""],["svgIcon","add-button",1,"add-button",3,"matMenuTriggerFor"],["recordType","matMenu"],["mat-menu-item","",3,"click"],[1,"menu-trigger-icon",3,"matMenuTriggerFor"],["mat-menu-item","",3,"disabled","click"]],template:function(t,n){if(t&1&&(e.TgZ(0,"div",0)(1,"div",1),e.NdJ("click",function(){return n.toggleExpansionViewModel()}),e._UZ(2,"mat-icon",2),e.TgZ(3,"span",3),e._uU(4),e.qZA()(),e.YNc(5,ut,1,0,"ng-template",4),e.YNc(6,dt,3,2,"ng-template",null,5,e.W1O),e.YNc(8,mt,1,1,"span",6),e.TgZ(9,"mat-menu",null,7),e.YNc(11,Ct,3,2,"ng-container",8),e.qZA()(),e.TgZ(12,"mat-expansion-panel",9),e.NdJ("opened",function(){return n.isExpanded=!0})("closed",function(){return n.isExpanded=!1}),e.TgZ(13,"div",10)(14,"ts-table",11),e.NdJ("selectedChange",function(i){return n.onSelectRecord(i)}),e.qZA()()()),t&2){const a=e.MAs(7);e.Tol("detail-"+(n.isExpanded?"open":"closed")),e.xp6(2),e.Q6J("svgIcon","detail-"+(n.isExpanded?"open":"closed")),e.xp6(2),e.hij(" ",n.header," "),e.xp6(1),e.Q6J("ngIf",!n.recordTypes)("ngIfElse",a),e.xp6(3),e.Q6J("ngIf",n.actionHandlers),e.xp6(3),e.Q6J("ngForOf",n.actionHandlers),e.xp6(1),e.Q6J("hideToggle",!0)("expanded",n.isExpanded),e.xp6(2),e.Q6J("selectMode",n.selectMode)("dataSchema",n.dataSchema)("dataSource",n.dataSource)("eventHandlers",n.tableEventHandlers)}},dependencies:[f.sg,f.O5,ct.a,Se.ib,ae.Hw,me.W0,me.tN,me.D8],styles:[".header-wrapper[_ngcontent-%COMP%]{display:flex;flex-direction:row;align-items:baseline}.header-wrapper[_ngcontent-%COMP%]   .expander[_ngcontent-%COMP%]{display:flex;flex-direction:row;align-items:center;cursor:pointer}.header-wrapper[_ngcontent-%COMP%]   .expander[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]{color:#4e7bd8;margin-left:5px;margin-right:5px;font-size:15px}.header-wrapper[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{cursor:pointer;height:16px!important;width:16px!important;margin-left:10px;margin-right:10px}.header-wrapper[_ngcontent-%COMP%]   mat-icon.add-button[_ngcontent-%COMP%]{width:13px!important}.header-wrapper.detail-closed[_ngcontent-%COMP%]   mat-icon.add-button[_ngcontent-%COMP%]{display:none}mat-expansion-panel[_ngcontent-%COMP%]{box-shadow:none!important}ts-table[_ngcontent-%COMP%]{max-height:300px;overflow-y:auto}.menu-trigger-icon[_ngcontent-%COMP%]{background:url(data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxNiIgaGVpZ2h0PSIxNiIgdmlld0JveD0iMCAwIDE2IDE2Ij48ZGVmcz48c3R5bGU+LmF7ZmlsbDojODA5NWIzO30uYntmaWxsOm5vbmU7fTwvc3R5bGU+PC9kZWZzPjxnIHRyYW5zZm9ybT0idHJhbnNsYXRlKDE0My45NDEgLTQwNi4wNTEpIj48cmVjdCBjbGFzcz0iYSIgd2lkdGg9IjIiIGhlaWdodD0iMiIgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoLTEzNi45NDEgNDA4LjA1MSkiLz48cmVjdCBjbGFzcz0iYSIgd2lkdGg9IjIiIGhlaWdodD0iMiIgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoLTEzNi45NDEgNDEzLjA1MSkiLz48cmVjdCBjbGFzcz0iYSIgd2lkdGg9IjIiIGhlaWdodD0iMiIgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoLTEzNi45NDEgNDE4LjA1MSkiLz48L2c+PHJlY3QgY2xhc3M9ImIiIHdpZHRoPSIxNiIgaGVpZ2h0PSIxNiIvPjwvc3ZnPg==) no-repeat;width:16px;height:16px;cursor:pointer}"],changeDetection:0});const _t=function(o){return{actionClick:o}},ft=function(o){return{name:o}};class re extends C.POq{constructor(t,n,a,i,r,u,m,_,Te,Gt,Ut,Yt,jt){super(),this.router=t,this.translateService=n,this.channelService=a,this.injector=i,this.changeBroadcastService=r,this.facebookProvider=u,this._facebookService=m,this._whatsAppService=_,this._telegramService=Te,this.dialogService=Gt,this.ref=Ut,this.zone=Yt,this.window=jt,this.detailActions=[{click:this.removeRecord.bind(this),caption:this.translateService.instant("ChatSettings.ChannelDetail.DeleteAction")}],this.dataSchema={columns:[{name:"provider",caption:this.translateService.instant("ChatSettings.ChannelDetail.Columns.Provider"),valueType:l.DataValueType.Text,formatter:(b,pe)=>pe.typeName,sortingDataAccessor:b=>b.typeName},{name:"name",caption:this.translateService.instant("ChatSettings.ChannelDetail.Columns.Name"),valueType:l.DataValueType.Text,cellComponentClass:z},{name:"status",caption:this.translateService.instant("ChatSettings.ChannelDetail.Columns.Status.Caption"),valueType:l.DataValueType.Boolean,formatter:(b,pe)=>pe.isActive,sortingDataAccessor:b=>b.isActive},{name:"queue",caption:this.translateService.instant("ChatSettings.ChannelDetail.Columns.Queue"),valueType:l.DataValueType.Text,formatter:(b,pe)=>pe.queueName,sortingDataAccessor:b=>b.queueName}]},this.changeBroadcastService.subscribe(b=>{this.onRecordChanged(b)}),this.tableDataSource.sortingDataAccessor=(b,pe)=>b[pe].toLocaleLowerCase()}requestTableDataHandler(t){t.success&&(this.data=t.result)}getDefaultDialogConfig(){return{height:"auto",width:"400px"}}_trimSlashes(t){return t.replace(/(^([/\\])+)|(([/\\])+$)/,"")}_joinPath(...t){return t.map(n=>this._trimSlashes(n)).join("/")}createChangeBroadcastService(){return this.injector.get(C.Pnv)}onRecordChanged(t){if(this.data.find(i=>i===t))return;const a=this.data.findIndex(i=>i.id===t.id);a!==-1?(this.data[a]=t,this.data=[...this.data]):this.insertRecord(t),this.ref.detectChanges()}insertRecord(t){this.data=this.data.concat(t)}initFacebookPages(t){this.facebookProvider.reLogin().subscribe(n=>{n&&this.facebookProvider.getPages().subscribe(a=>{const i=[];a.data&&a.data.forEach(r=>{i.push({id:r.id,name:r.name,token:r.access_token})}),t.call(this,i)})})}addTelegramChannel(t){const n={id:(0,l.generateGuid)(),typeId:t.value,typeName:t.displayValue,isActive:!1};this.openChannelDialogService(n,{...this.getDefaultDialogConfig(),data:{channel:n,isNew:!0}})}addWhatsAppChannel(t){this.addTelegramChannel(t)}addFacebookChannels(t){if(!this.facebookProvider.isFacebookSettingValid()){this.dialogService.open(se,{...this.getDefaultDialogConfig()});return}this.initFacebookPages(n=>{n.forEach(a=>{this.facebookProvider.attachPage(a.token).subscribe(()=>{const i={id:(0,l.generateGuid)(),name:a.name,typeId:t.value,source:a.id,isActive:!1};this._facebookService.registerFacebookChannel(a.token,a.id).subscribe(r=>{var u;r?.success?(i.msgSettingsId=r.SettingsId,this.channelService.insertItem(i).subscribe(m=>{if(m.success&&(this.data.push(i),this.data=[...this.data],this.ref.detectChanges(),n.length===1)){const _=this.getDefaultDialogConfig();this.openChannelDialogService(i,{..._,data:{channel:i}})}})):this.dialogService.openInfoDialog(((u=r?.errorInfo)===null||u===void 0?void 0:u.message)||"An unknown error occurred during the operation.")})})})})}removeFacebookChannel(t){this._facebookService.removeFacebookChannel(t.msgSettingsId).subscribe()}removeWhatsAppChannel(t){this._whatsAppService.removeWhatsAppChannel(t.msgSettingsId).subscribe()}removeTelegramChannel(t){this._telegramService.removeTelegramChannel(t.msgSettingsId).subscribe()}getCustomChannelPage(t){const n=this.channelTypes.filter(a=>a.value===t.typeId)[0];return n&&n.pageUrl}addRecord(t){if(!!t)switch(t.value){case v.FacebookMessenger:this.addFacebookChannels(t);break;case v.Telegram:this.addTelegramChannel(t);break;case v.WhatsApp:this.addWhatsAppChannel(t);break;default:if(t.pageUrl){const n=this._joinPath((0,g.MAR)(),t.pageUrl);this.window.open(n,"_self")}break}}removeChannel(t){if(!!t)switch(t.typeId){case v.FacebookMessenger:this.removeFacebookChannel(t);break;case v.WhatsApp:this.removeWhatsAppChannel(t);break;case v.Telegram:this.removeTelegramChannel(t);break}}removeRecord(t){this.channelService.deleteById(t.id).subscribe(n=>{if(n.success)this.data=this.data.filter(a=>a.id!==t.id),this.removeChannel(t);else{const a=this.translateService.instant("ChatSettings.ChannelDetail.DeleteRecordErrorMessage");this.dialogService.openInfoDialog(a)}})}ngOnInit(){this.facebookProvider.initialize().subscribe(),this.channelService.getChannelTypeItems().subscribe(t=>this.channelTypes=t),this.channelService.getItems().subscribe(this.requestTableDataHandler.bind(this))}openChannelDialogService(t,n){this.zone.run(()=>{switch(t.typeId){case v.FacebookMessenger:this.dialogService.open(D,n).subscribe();break;case v.Telegram:this.dialogService.open(K,n).subscribe();break;case v.WhatsApp:this.dialogService.open(X,n).subscribe();break;default:console.error("invalid channel type")}})}onItemAction(t,n){const a=this.getDefaultDialogConfig(),i=this.getCustomChannelPage(t);switch(n){case"edit":if(i){const r=this._joinPath((0,g.MAR)(),i,t.id);this.window.open(r,"_self")}else this.openChannelDialogService(t,{...a,data:{channel:t}});break;default:console.error("invalid action")}}}re.\u0275fac=function(t){return new(t||re)(e.Y36(de.F0),e.Y36(p.sK),e.Y36(S),e.Y36(e.zs3),e.Y36(ye),e.Y36(ie),e.Y36(Y),e.Y36(H),e.Y36(j),e.Y36(T.xA),e.Y36(e.sBO),e.Y36(e.R0b),e.Y36(Re.WINDOW_TOKEN))},re.\u0275cmp=e.Xpm({type:re,selectors:[["ts-channel-detail"]],features:[e.qOj],decls:2,vars:12,consts:[["selectMode","single",3,"actionHandlers","dataSource","dataSchema","recordTypes","tableEventHandlers","header","addRecordHandle"]],template:function(t,n){t&1&&(e.TgZ(0,"ts-expansion-detail",0),e.NdJ("addRecordHandle",function(i){return n.addRecord(i)}),e.ALo(1,"translate"),e.qZA()),t&2&&e.Q6J("actionHandlers",n.detailActions)("dataSource",n.tableDataSource)("dataSchema",n.dataSchema)("recordTypes",n.channelTypes)("tableEventHandlers",e.VKq(10,ft,e.VKq(8,_t,n.onItemAction.bind(n))))("header",e.lcZ(1,6,"ChatSettings.ChannelDetail.Title"))},dependencies:[x,p.X$]});class ee{}ee.\u0275fac=function(t){return new(t||ee)},ee.\u0275cmp=e.Xpm({type:ee,selectors:[["ts-chat-settings-page"]],decls:11,vars:3,consts:[[1,"base-page-wrap"],[1,"header"],[1,"pane"],[3,"title"],[1,"detail-channel"],[1,"detail-queue"],[1,"detail-actions"]],template:function(t,n){t&1&&(e.TgZ(0,"div",0)(1,"div",1)(2,"div",2),e._UZ(3,"ts-header",3),e.ALo(4,"translate"),e.qZA()(),e.TgZ(5,"div",4),e._UZ(6,"ts-channel-detail"),e.qZA(),e.TgZ(7,"div",5),e._UZ(8,"ts-chat-queue-detail"),e.qZA(),e.TgZ(9,"div",6),e._UZ(10,"ts-chat-actions-detail"),e.qZA()()),t&2&&(e.xp6(3),e.Q6J("title",e.lcZ(4,1,"ChatSettings.ChatSettingsPageHeader")))},styles:[".detail-channel[_ngcontent-%COMP%]{padding-top:80px;background-color:#fff}.base-page-wrap[_ngcontent-%COMP%]{background-color:#fff}.base-page-wrap[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]{height:80px}.base-page-wrap[_ngcontent-%COMP%]     .header-wrapper{margin:15px 15px 0}"]});class le extends C.POq{constructor(t,n,a,i,r){super(),this.router=t,this.translateService=n,this.chatQueueService=a,this.injector=i,this.changeBroadcastService=r,this.dataSchema={columns:[{name:"name",caption:this.translateService.instant("ChatSettings.ChatQueueDetail.Columns.Name"),valueType:l.DataValueType.Text,linkGenerator:this._queueLinkGenerator},{name:"routingRule",caption:this.translateService.instant("ChatSettings.ChatQueueDetail.Columns.Routing.Caption"),valueType:l.DataValueType.Text,formatter:(u,m)=>m.routingRule&&m.routingRule.displayValue,sortingDataAccessor:u=>u.routingRule&&u.routingRule.displayValue},{name:"chatTimeout",caption:this.translateService.instant("ChatSettings.ChatQueueDetail.Columns.Timeout"),valueType:l.DataValueType.Integer}]},this.changeBroadcastService.subscribe(u=>{this.onRecordChanged(u)}),this.tableDataSource.sortingDataAccessor=(u,m)=>u[m].toLocaleLowerCase()}get _queueLinkGenerator(){return t=>`/ChatSettings/chat-queue/${t.id}`}createChangeBroadcastService(){return this.injector.get(C.Pnv)}onRecordChanged(t){if(this.data.find(i=>i===t))return;const a=this.data.findIndex(i=>i.id===t.id);a!==-1?(this.data[a]=t,this.data=[...this.data]):this.insertRecord(t)}insertRecord(t){this.data=this.data.concat(t)}ngOnInit(){this.chatQueueService.getItems().subscribe(t=>{t.success&&(this.data=t.result)})}addRecord(){this.router.navigate(["ChatSettings/chat-queue/new"])}}le.\u0275fac=function(t){return new(t||le)(e.Y36(de.F0),e.Y36(p.sK),e.Y36(N),e.Y36(e.zs3),e.Y36(Ae))},le.\u0275cmp=e.Xpm({type:le,selectors:[["ts-chat-queue-detail"]],features:[e.qOj],decls:2,vars:5,consts:[[3,"dataSource","dataSchema","header","addRecordHandle"]],template:function(t,n){t&1&&(e.TgZ(0,"ts-expansion-detail",0),e.NdJ("addRecordHandle",function(){return n.addRecord()}),e.ALo(1,"translate"),e.qZA()),t&2&&e.Q6J("dataSource",n.tableDataSource)("dataSchema",n.dataSchema)("header",e.lcZ(1,3,"ChatSettings.ChatQueueDetail.Title"))},dependencies:[x,p.X$]});var vt=c(11770);function Tt(o,t){if(o&1){const n=e.EpF();e.ynx(0),e.TgZ(1,"a",1),e.NdJ("click",function(i){e.CHM(n);const r=e.oxw();return e.KtG(r.onActionClick(i))}),e._uU(2),e.qZA(),e.BQk()}if(o&2){const n=e.oxw();e.xp6(2),e.Oqu(n.record.caption)}}class te extends W{}te.\u0275fac=function(){let o;return function(n){return(o||(o=e.n5z(te)))(n||te)}}(),te.\u0275cmp=e.Xpm({type:te,selectors:[["ts-chat-action-name-cell"]],features:[e.qOj],decls:1,vars:1,consts:[[4,"ngIf"],[3,"href","click"]],template:function(t,n){t&1&&e.YNc(0,Tt,3,1,"ng-container",0),t&2&&e.Q6J("ngIf",!n.isEmpty())},dependencies:[f.O5]});var St=c(51927);function bt(o,t){if(o&1&&(e.TgZ(0,"mat-error"),e._uU(1),e.qZA()),o&2){const n=e.oxw();e.xp6(1),e.hij(" ",n.getValidationMessage("caption")," ")}}function yt(o,t){if(o&1&&(e.TgZ(0,"mat-error"),e._uU(1),e.qZA()),o&2){const n=e.oxw();e.xp6(1),e.hij(" ",n.getValidationMessage("chatQueue")," ")}}function At(o,t){if(o&1&&(e.TgZ(0,"mat-option",24),e._uU(1),e.qZA()),o&2){const n=t.$implicit;e.Q6J("value",n),e.xp6(1),e.hij(" ",n.displayValue," ")}}function Pt(o,t){if(o&1&&(e.TgZ(0,"mat-error"),e._uU(1),e.qZA()),o&2){const n=e.oxw();e.xp6(1),e.hij(" ",n.getValidationMessage("actionProcess")," ")}}function It(o,t){if(o&1&&(e.TgZ(0,"mat-option",24),e._uU(1),e.qZA()),o&2){const n=t.$implicit;e.Q6J("value",n),e.xp6(1),e.hij(" ",n.displayValue," ")}}function xt(o,t){if(o&1){const n=e.EpF();e.TgZ(0,"button",25),e.NdJ("click",function(){e.CHM(n);const i=e.oxw();return e.KtG(i.save())}),e._uU(1),e.ALo(2,"translate"),e.qZA()}o&2&&(e.xp6(1),e.hij(" ",e.lcZ(2,1,"BasePageComponent.Apply")," "))}class L extends C.neP{constructor(t,n,a,i,r){super(t),this.dialogRef=n,this._chatActionService=a,this._formBuilder=i,this.notEmptyStringValidationRegex=/.*\S+.*/,this.getGtmSchemaName=()=>"ChatActionPage",this.isChanged=!1,this._data=r}get chatQueue(){return this.model.queue}set chatQueue(t){const n=t&&t.value||null;(this.model.queue&&this.model.queue.value||null)!==n&&(this.model.queue=t,this.chatActionForm.patchValue({queue:t}),this.setIsChanged())}get actionProcess(){return this.model.process}set actionProcess(t){const n=t&&t.value||null;(this.model.process&&this.model.process.value||null)!==n&&(this.model.process=t,this.chatActionForm.patchValue({actionProcess:t}),this.setIsChanged())}static _getSuccessResponse(){return(0,$.of)({success:!0,errorInfo:null,result:[]})}_initPageTitle(t){this.pageTitle=t.caption||this.translateInstant("ChatSettings.ChatActionPage.Title")}_buildForm(){this.chatActionForm=this._formBuilder.group({caption:new s.p4({value:""},[s.kI.required,s.kI.pattern(this.notEmptyStringValidationRegex)]),chatQueue:new s.p4({value:""},[this.validateLookupNotEmpty]),actionProcess:new s.p4({value:""},[this.validateLookupNotEmpty])})}_processOpenPageParams(){const t=this._data.id;t?this.model.id=t:this.isNew=!0}_validate(){return this.chatActionForm.updateValueAndValidity(),{success:this.chatActionForm.valid,errorMessage:this._getFormValidationErrors()}}_getFormValidationErrors(){const t=[];return Object.keys(this.chatActionForm.controls).forEach(n=>{const a=this.chatActionForm.get(n).errors;if(a!=null){const i=this._getCaptionByControlKey(n),u=Object.keys(a).map(m=>`${i}: ${this._getErrorMessageByErrorKey(a,m)}`);t.push(...u)}}),t.join(`
`)}_getErrorMessageByErrorKey(t,n){const a=t[n];if(typeof a=="string")return a;let i=n;switch(n){case"validateLookup":case"required":i="ChatSettings.ChatActionPage.ValidationMessage.required";break;default:return a}return this.translateInstant(i)}_getCaptionByControlKey(t){switch(t){case"caption":return this.translateInstant("ChatSettings.ChatActionPage.Caption");case"chatQueue":return this.translateInstant("ChatSettings.ChatActionPage.ChatQueue");case"actionProcess":return this.translateInstant("ChatSettings.ChatActionPage.Process")}return t}_getFakeSuccessResponse(){return(0,$.of)({success:!0,errorInfo:null,result:[]})}_initControls(){this._chatActionService.getProcessItems().subscribe(t=>{this._processList$=t,this.processList$=this.setAutocompleteFilter("actionProcess",this._processList$)}),this._chatActionService.getChatQueueItems().subscribe(t=>{this._chatQueueList$=t,this.chatQueueList$=this.setAutocompleteFilter("chatQueue",this._chatQueueList$)})}_filter(t,n){if(typeof t!="string")return n;const a=t.toLowerCase();return n.filter(i=>this.selectDisplayValue(i).toLowerCase().includes(a))}savePageData(t){return this.isChanged?this.isNew?this._chatActionService.insertItem(t):this._chatActionService.updateItem(t):L._getSuccessResponse()}requestPageData(){return this.isNew?(this.setIsChanged(),(0,$.of)(this._chatActionService.generateNewChatActionResponse())):this._chatActionService.getItem(this.model.id)}getModelFromLoadResponse(t){return t.result[0]}preProcessLoadedPageModel(t){return t=super.preProcessLoadedPageModel(t),this._initPageTitle(t),t}onModelSet(t){this.chatActionForm.patchValue({caption:t.caption,chatQueue:t.queue,actionProcess:t.process})}createChangeBroadcastService(){return this.injector.get(Pe)}isModelValid(){return super.isModelValid()&&!this.chatActionForm.invalid}closeAfterSave(){this.dialogRef.close()}setAutocompleteFilter(t,n){return this.chatActionForm.get(t).valueChanges.pipe((0,St.O)(""),(0,y.U)(i=>this._filter(i,n)))}selectDisplayValue(t){return t&&t.displayValue||""}onCaptionChange(t){this.model.caption=t,this.setIsChanged()}onQueueSelected(t){const n=t.option.value;this.chatQueue!==n&&(this.chatQueue=n)}onProcessSelected(t){const n=t.option.value;this.actionProcess!==n&&(this.actionProcess=n)}save(){const{success:t,errorMessage:n}=this._validate();return t?super.save():(this.openInfoDialog(n).subscribe(),this._getFakeSuccessResponse())}saveButtonVisible(){return super.saveButtonVisible()&&this.isModelValid()}validateLookupNotEmpty(t){const n=t.value&&t.value.value;return!n||n===""?{required:!0}:null}isInvalid(t){return this.chatActionForm.get(t).invalid}getValidationMessage(t){const n=this.chatActionForm.get(t);if(!n||!n.errors)return"";const a=n.errors,i=Object.keys(n.errors)[0];return this._getErrorMessageByErrorKey(a,i)}ngOnInit(){this._buildForm(),this._processOpenPageParams(),super.ngOnInit(),this._initControls()}ngAfterContentChecked(){this.shouldSave=this.saveButtonVisible()||this.isChanged}}L.\u0275fac=function(t){return new(t||L)(e.Y36(e.zs3),e.Y36(d.hV),e.Y36(Z),e.Y36(s.qu),e.Y36(d.eJ))},L.\u0275cmp=e.Xpm({type:L,selectors:[["ts-chat-action-page"]],features:[e.qOj],decls:44,vars:34,consts:[[1,"chat-action-page"],[1,"page-title-container"],[1,"page-title"],[1,"page-content-wrapper"],[1,"main-content","pane"],[3,"formGroup"],[1,"chat-actions-pane","pane"],["floatLabel","always"],["matInput","","type","text","formControlName","caption","required","","data-qa","caption",3,"pattern","ngModel","change","focus","ngModelChange"],[4,"ngIf"],["floatLabel","always",1,"combobox-edit"],[1,"field-title"],["matInput","","type","text","required","","spellcheck","false","formControlName","chatQueue","data-qa","chat-queue",3,"matAutocomplete","value","ngModel","focus","ngModelChange"],[3,"displayWith","optionSelected"],["queueAuto","matAutocomplete"],[3,"value",4,"ngFor","ngForOf"],["matSuffix","","mat-icon-button","",1,"lookup-button"],["svgIcon","arrow-down",1,"lookup-button-icon"],["matInput","","type","text","required","","spellcheck","false","formControlName","actionProcess","data-qa","action-process",3,"matAutocomplete","value","ngModel","focus","ngModelChange"],["processAuto","matAutocomplete"],[1,"footer"],[1,"pane"],["class","action-button","mat-flat-button","","color","primary",3,"click",4,"ngIf"],["mat-flat-button","",1,"close-page-button",3,"mat-dialog-close"],[3,"value"],["mat-flat-button","","color","primary",1,"action-button",3,"click"]],template:function(t,n){if(t&1&&(e.TgZ(0,"div",0)(1,"div",1)(2,"mat-label",2),e._uU(3),e.qZA()(),e.TgZ(4,"div",3)(5,"div",4)(6,"form",5)(7,"div",6)(8,"mat-form-field",7)(9,"mat-label"),e._uU(10),e.ALo(11,"translate"),e.qZA(),e.TgZ(12,"input",8),e.NdJ("change",function(i){return n.onCaptionChange(i.target.value)})("focus",function(){return n.setIsChanged()})("ngModelChange",function(i){return n.model.caption=i}),e.qZA(),e.YNc(13,bt,2,1,"mat-error",9),e.qZA(),e.TgZ(14,"mat-form-field",10)(15,"mat-label",11),e._uU(16),e.ALo(17,"translate"),e.qZA(),e.TgZ(18,"input",12),e.NdJ("focus",function(){return n.setIsChanged()})("ngModelChange",function(i){return n.model.queue=i}),e.qZA(),e.YNc(19,yt,2,1,"mat-error",9),e.TgZ(20,"mat-autocomplete",13,14),e.NdJ("optionSelected",function(i){return n.onQueueSelected(i)}),e.YNc(22,At,2,2,"mat-option",15),e.ALo(23,"async"),e.qZA(),e.TgZ(24,"button",16),e._UZ(25,"mat-icon",17),e.qZA()(),e.TgZ(26,"mat-form-field",10)(27,"mat-label",11),e._uU(28),e.ALo(29,"translate"),e.qZA(),e.TgZ(30,"input",18),e.NdJ("focus",function(){return n.setIsChanged()})("ngModelChange",function(i){return n.model.process=i}),e.qZA(),e.YNc(31,Pt,2,1,"mat-error",9),e.TgZ(32,"mat-autocomplete",13,19),e.NdJ("optionSelected",function(i){return n.onProcessSelected(i)}),e.YNc(34,It,2,2,"mat-option",15),e.ALo(35,"async"),e.qZA(),e.TgZ(36,"button",16),e._UZ(37,"mat-icon",17),e.qZA()()()()()(),e.TgZ(38,"div",20)(39,"div",21),e.YNc(40,xt,3,3,"button",22),e.TgZ(41,"button",23),e._uU(42),e.ALo(43,"translate"),e.qZA()()()()),t&2){const a=e.MAs(21),i=e.MAs(33);e.xp6(3),e.Oqu(n.pageTitle),e.xp6(3),e.Q6J("formGroup",n.chatActionForm),e.xp6(4),e.Oqu(e.lcZ(11,22,"ChatSettings.ChatActionPage.Caption")),e.xp6(2),e.Q6J("pattern",n.notEmptyStringValidationRegex)("ngModel",n.model.caption),e.xp6(1),e.Q6J("ngIf",n.isInvalid("caption")),e.xp6(3),e.hij("",e.lcZ(17,24,"ChatSettings.ChatActionPage.ChatQueue")," "),e.xp6(2),e.Q6J("matAutocomplete",a)("value",n.selectDisplayValue(n.chatQueue))("ngModel",n.model.queue),e.xp6(1),e.Q6J("ngIf",n.isInvalid("chatQueue")),e.xp6(1),e.Q6J("displayWith",n.selectDisplayValue),e.xp6(2),e.Q6J("ngForOf",e.lcZ(23,26,n.chatQueueList$)),e.xp6(6),e.hij("",e.lcZ(29,28,"ChatSettings.ChatActionPage.Process")," "),e.xp6(2),e.Q6J("matAutocomplete",i)("value",n.selectDisplayValue(n.actionProcess))("ngModel",n.model.process),e.xp6(1),e.Q6J("ngIf",n.isInvalid("actionProcess")),e.xp6(1),e.Q6J("displayWith",n.selectDisplayValue),e.xp6(2),e.Q6J("ngForOf",e.lcZ(35,30,n.processList$)),e.xp6(6),e.Q6J("ngIf",n.saveButtonVisible()),e.xp6(2),e.hij(" ",e.lcZ(43,32,"BasePageComponent.Cancel")," ")}},dependencies:[f.sg,f.O5,ae.Hw,h.nI,h.v_,h.$V,h.nX,k.k0,P.VN,P.QJ,ge.CK,I.eB,s._Y,s.Fj,s.JJ,s.JL,s.Q7,s.c5,s.sg,s.u,d.aO,f.Ov,p.X$],styles:[".chat-action-page[_ngcontent-%COMP%]   .page-title-container[_ngcontent-%COMP%]{padding-bottom:1em}.chat-action-page[_ngcontent-%COMP%]   .page-title[_ngcontent-%COMP%]{font-size:21px;color:#006ce0}.chat-action-page[_ngcontent-%COMP%]   .chat-actions-pane[_ngcontent-%COMP%]{display:inline-flex;flex-direction:column;width:100%}.chat-action-page[_ngcontent-%COMP%]   .footer[_ngcontent-%COMP%]{display:flex;flex-direction:row-reverse}.chat-action-page[_ngcontent-%COMP%]   .footer[_ngcontent-%COMP%]   .close-page-button[_ngcontent-%COMP%]{color:#006ce0;background-color:#fff;font-size:15px}"]});const kt=function(o){return{actionClick:o}},Nt=function(o){return{caption:o}};class ce extends C.POq{constructor(t,n,a,i,r,u,m){super(),this.translateService=t,this.chatActionService=n,this.dialogService=a,this.injector=i,this.changeBroadcastService=r,this._appInfoService=u,this.zone=m,this._processSchemaType=6,this.dataSchema={columns:[{name:"caption",caption:this.translateService.instant("ChatSettings.ChatActionsDetail.Columns.Caption"),valueType:l.DataValueType.Text,cellComponentClass:te},{name:"process",caption:this.translateService.instant("ChatSettings.ChatActionsDetail.Columns.Process"),valueType:l.DataValueType.Lookup,sortingDataAccessor:_=>_.process&&_.process.displayValue,linkGenerator:this._processLinkGenerator},{name:"queue",caption:this.translateService.instant("ChatSettings.ChatActionsDetail.Columns.Queue"),valueType:l.DataValueType.Lookup,sortingDataAccessor:_=>_.queue&&_.queue.displayValue}]},this.detailActions=[{click:this.removeRecord.bind(this),caption:this.translateService.instant("ChatSettings.ChatActionsDetail.Actions.Delete")}],this.changeBroadcastService.subscribe(_=>{this.onRecordChanged(_)}),this.tableDataSource.sortingDataAccessor=(_,Te)=>_[Te].toLocaleLowerCase()}get _processLinkGenerator(){return t=>({url:vt.Ld.Format(this._processDesignerTpl,t.process.value),target:"_blank",useRouterLink:!1})}_openDialogRecord(t){this.zone.run(()=>{this.dialogService.open(L,{height:"300px",width:"400px",data:t}).subscribe(()=>console.log("ChatActionPageComponent was opened"))})}_initProcessDesignerLink(){this._appInfoService.getAppsInfo().subscribe(t=>{if(t.success){const a=t.appsInfo.find(i=>i.itemTypes.includes(this._processSchemaType));this._processDesignerTpl=a.openTemplate}})}createChangeBroadcastService(){return this.injector.get(C.Pnv)}onRecordChanged(t){if(this.data.find(i=>i===t))return;const a=this.data.findIndex(i=>i.id===t.id);a!==-1?(this.data[a]=t,this.data=[...this.data]):this.insertRecord(t)}insertRecord(t){this.data=this.data.concat(t)}removeRecord(t){this.chatActionService.deleteById(t.id).subscribe(n=>{if(n.success)this.data=this.data.filter(a=>a.id!==t.id);else{const a=this.translateService.instant("ChatSettings.ChannelDetail.DeleteRecordErrorMessage");this.dialogService.openInfoDialog(a)}})}ngOnInit(){this._initProcessDesignerLink(),this.chatActionService.getItems().subscribe(t=>{t.success&&(this.data=t.result)})}addRecord(){this._openDialogRecord({})}onItemAction(t,n){switch(n){case"edit":this._openDialogRecord({id:t.id});break;default:console.error("invalid action")}}}ce.\u0275fac=function(t){return new(t||ce)(e.Y36(p.sK),e.Y36(Z),e.Y36(T.xA),e.Y36(e.zs3),e.Y36(Pe),e.Y36(we.zz),e.Y36(e.R0b))},ce.\u0275cmp=e.Xpm({type:ce,selectors:[["ts-chat-actions-detail"]],features:[e.qOj],decls:2,vars:11,consts:[["selectMode","single",3,"dataSource","dataSchema","actionHandlers","header","tableEventHandlers","addRecordHandle"]],template:function(t,n){t&1&&(e.TgZ(0,"ts-expansion-detail",0),e.NdJ("addRecordHandle",function(){return n.addRecord()}),e.ALo(1,"translate"),e.qZA()),t&2&&e.Q6J("dataSource",n.tableDataSource)("dataSchema",n.dataSchema)("actionHandlers",n.detailActions)("header",e.lcZ(1,5,"ChatSettings.ChatActionsDetail.Title"))("tableEventHandlers",e.VKq(9,Nt,e.VKq(7,kt,n.onItemAction.bind(n))))},dependencies:[x,p.X$]});var Ie=c(26903);function Zt(o,t){if(o&1){const n=e.EpF();e.TgZ(0,"button",27),e.NdJ("click",function(){e.CHM(n);const i=e.oxw();return e.KtG(i.save())}),e._uU(1),e.ALo(2,"translate"),e.qZA()}o&2&&(e.xp6(1),e.hij(" ",e.lcZ(2,1,"BasePageComponent.Apply")," "))}function Qt(o,t){if(o&1){const n=e.EpF();e.TgZ(0,"button",28),e.NdJ("click",function(){e.CHM(n);const i=e.oxw();return e.KtG(i.cancel())}),e._uU(1),e.ALo(2,"translate"),e.qZA()}o&2&&(e.xp6(1),e.hij(" ",e.lcZ(2,1,"BasePageComponent.Cancel")," "))}function Mt(o,t){if(o&1){const n=e.EpF();e.TgZ(0,"button",28),e.NdJ("click",function(){e.CHM(n);const i=e.oxw();return e.KtG(i.close())}),e._uU(1),e.ALo(2,"translate"),e.qZA()}o&2&&(e.xp6(1),e.hij(" ",e.lcZ(2,1,"BasePageComponent.Close")," "))}function Dt(o,t){if(o&1&&(e.TgZ(0,"mat-error"),e._uU(1),e.qZA()),o&2){const n=e.oxw();e.xp6(1),e.hij(" ",n.getValidationMessage("name")," ")}}function Lt(o,t){if(o&1&&(e.TgZ(0,"mat-error"),e._uU(1),e.qZA()),o&2){const n=e.oxw();e.xp6(1),e.hij(" ",n.getValidationMessage("operatorRoutingRule")," ")}}function Ft(o,t){if(o&1&&(e.TgZ(0,"mat-option",29),e._uU(1),e.qZA()),o&2){const n=t.$implicit;e.Q6J("value",n),e.xp6(1),e.hij(" ",n.displayValue," ")}}function qt(o,t){if(o&1&&(e.TgZ(0,"mat-error"),e._uU(1),e.qZA()),o&2){const n=e.oxw();e.xp6(1),e.hij(" ",n.getValidationMessage("chatTimeout")," ")}}class A extends C.neP{constructor(t,n,a){super(t),this._chatQueueService=n,this._formBuilder=a,this.notEmptyStringValidationRegex=/.*\S+.*/,this.isChanged=!1}get operatorRoutingRule(){return this.model.routingRule}set operatorRoutingRule(t){const n=t&&t.value||null;(this.model.routingRule&&this.model.routingRule.value||null)!==n&&(this.model.routingRule=t,this.chatQueueForm.patchValue({operatorRoutingRule:t}),this.setIsChanged())}get routeRuleList$(){return this._routeRuleList$||(this._routeRuleList$=this._chatQueueService.getRoutingRuleItems().pipe((0,Ie.B)())),this._routeRuleList$}static _getSuccessResponse(){return(0,$.of)({success:!0,errorInfo:null,result:[]})}_initPageTitle(t){this.pageTitle=t.name||this.translateInstant("ChatSettings.ChatQueuePage.Title")}_buildForm(){this.chatQueueForm=this._formBuilder.group({name:new s.p4({value:""},[s.kI.required,s.kI.pattern(this.notEmptyStringValidationRegex)]),operatorRoutingRule:new s.p4({value:""},[this.validateLookupNotEmpty]),chatTimeout:new s.p4({value:0},[s.kI.pattern(/\d*/)])})}_processRoutingParams(){this.activateRoute.paramMap.subscribe(t=>{const n=t.get("id");n?this.model.id=n:this.isNew=!0})}_validate(){return this.chatQueueForm.updateValueAndValidity(),{success:this.chatQueueForm.valid,errorMessage:this._getFormValidationErrors()}}_getFormValidationErrors(){const t=[];return Object.keys(this.chatQueueForm.controls).forEach(n=>{const a=this.chatQueueForm.get(n).errors;if(a!=null){const i=this._getCaptionByControlKey(n),u=Object.keys(a).map(m=>`${i}: ${this._getErrorMessageByErrorKey(a,m)}`);t.push(...u)}}),t.join(`
`)}_getErrorMessageByErrorKey(t,n){const a=t[n];if(typeof a=="string")return a;let i=n;switch(n){case"pattern":if(a.requiredPattern==="^\\d*$"){isNaN(a.actualValue)?i="ChatSettings.ChatQueuePage.ValidationMessage.nonNumericValue":parseFloat(a.actualValue)<0?i="ChatSettings.ChatQueuePage.ValidationMessage.nonNegativeValue":i="ChatSettings.ChatQueuePage.ValidationMessage.wrongValue";break}i="ChatSettings.ChatQueuePage.ValidationMessage.wrongValue";break;case"validateLookup":case"required":i="ChatSettings.ChatQueuePage.ValidationMessage.required";break;default:return a}return this.translateInstant(i)}_getCaptionByControlKey(t){switch(t){case"name":return this.translateInstant("ChatSettings.ChatQueuePage.Name");case"chatTimeout":return this.translateInstant("ChatSettings.ChatQueuePage.Timeout");case"operatorRoutingRule":return this.translateInstant("ChatSettings.ChatQueuePage.OperatorRoutingRule")}return t}getFakeSuccessResponse(){return(0,$.of)({success:!0,errorInfo:null,result:[]})}savePageData(t){return this.isChanged?this.isNew?this._chatQueueService.insertItem(t):this._chatQueueService.updateItem(t):A._getSuccessResponse()}requestPageData(){return this.isNew?(this.setIsChanged(),(0,$.of)(this._chatQueueService.generateNewChatQueueResponse())):this._chatQueueService.getItem(this.model.id)}getModelFromLoadResponse(t){return t.result[0]}getGtmSchemaName(){return"ChatQueuePage"}preProcessLoadedPageModel(t){return t=super.preProcessLoadedPageModel(t),this._initPageTitle(t),t}onModelSet(t){this.chatQueueForm.patchValue({name:t.name,operatorRoutingRule:t.routingRule,chatTimeout:t.chatTimeout})}createChangeBroadcastService(){return this.injector.get(Ae)}isModelValid(){return super.isModelValid()&&!this.chatQueueForm.invalid}selectDisplayValue(t){return t&&t.displayValue||""}onNameChange(t){this.model.name=t,this.setIsChanged()}onTimeoutChange(t){this.model.chatTimeout=t||0,this.setIsChanged()}onRuleSelected(t){const n=t.option.value;this.operatorRoutingRule!==n&&(this.operatorRoutingRule=n)}save(){const{success:t,errorMessage:n}=this._validate();return t?super.save():(this.openInfoDialog(n).subscribe(),this.getFakeSuccessResponse())}saveButtonVisible(){return super.saveButtonVisible()&&this.isModelValid()}validateLookupNotEmpty(t){const n=t.value&&t.value.value;return!n||n===""?{required:!0}:null}isInvalid(t){return this.chatQueueForm.get(t).invalid}getValidationMessage(t){const n=this.chatQueueForm.get(t);if(!n||!n.errors)return"";const a=n.errors,i=Object.keys(n.errors)[0];return this._getErrorMessageByErrorKey(a,i)}saveWithoutClose(){this.closePageAfterSave=!1,this.save().subscribe(t=>{this.closePageAfterSave=!0,this.shouldSave=!1})}ngOnInit(){this._buildForm(),this._processRoutingParams(),super.ngOnInit()}ngAfterContentChecked(){this.shouldSave=this.saveButtonVisible()||this.isChanged}}A.\u0275fac=function(t){return new(t||A)(e.Y36(e.zs3),e.Y36(N),e.Y36(s.qu))},A.\u0275cmp=e.Xpm({type:A,selectors:[["ts-chat-queue-page"]],features:[e.qOj],decls:43,vars:33,consts:[[1,"base-page-wrap","chat-queue-page"],[1,"header"],[1,"pane"],[3,"title"],["class","action-button","mat-flat-button","","color","primary",3,"click",4,"ngIf"],["class","action-button default","mat-button","",3,"click",4,"ngIf"],[1,"page-content-wrapper"],[1,"main-content","pane"],[3,"formGroup"],[1,"chat-queue-pane","pane"],["cols","2","rowHeight","45px","gutterSize","10px"],[3,"colspan"],["floatLabel","always"],["matInput","","type","text","formControlName","name","required","","data-qa","name",3,"pattern","ngModel","change","focus","ngModelChange"],[4,"ngIf"],["floatLabel","always",1,"combobox-edit"],[1,"field-title"],["matInput","","type","text","required","","spellcheck","false","formControlName","operatorRoutingRule","data-qa","operator-routing-rule",3,"matAutocomplete","value","ngModel","focus","ngModelChange"],[3,"displayWith","optionSelected"],["auto","matAutocomplete"],[3,"value",4,"ngFor","ngForOf"],["matSuffix","","mat-icon-button","",1,"lookup-button"],["svgIcon","arrow-down",1,"lookup-button-icon"],[1,"tooltip",3,"message"],["matInput","","type","number","min","0","formControlName","chatTimeout","data-qa","chatTimeout","pattern","\\d*",3,"ngModel","change","focus","ngModelChange"],[1,"detail-operators"],[3,"chatQueueId","pageNeedToSave","pageNeedToSaveChange","savePage"],["mat-flat-button","","color","primary",1,"action-button",3,"click"],["mat-button","",1,"action-button","default",3,"click"],[3,"value"]],template:function(t,n){if(t&1&&(e.TgZ(0,"div",0)(1,"div",1)(2,"div",2)(3,"ts-header",3),e.YNc(4,Zt,3,3,"button",4),e.YNc(5,Qt,3,3,"button",5),e.YNc(6,Mt,3,3,"button",5),e.qZA()()(),e.TgZ(7,"div",6)(8,"div",7)(9,"form",8)(10,"div",9)(11,"mat-grid-list",10)(12,"mat-grid-tile",11)(13,"mat-form-field",12)(14,"mat-label"),e._uU(15),e.ALo(16,"translate"),e.qZA(),e.TgZ(17,"input",13),e.NdJ("change",function(i){return n.onNameChange(i.target.value)})("focus",function(){return n.setIsChanged()})("ngModelChange",function(i){return n.model.name=i}),e.qZA(),e.YNc(18,Dt,2,1,"mat-error",14),e.qZA()(),e.TgZ(19,"mat-grid-tile")(20,"mat-form-field",15)(21,"mat-label",16),e._uU(22),e.ALo(23,"translate"),e.qZA(),e.TgZ(24,"input",17),e.NdJ("focus",function(){return n.setIsChanged()})("ngModelChange",function(i){return n.model.routingRule=i}),e.qZA(),e.YNc(25,Lt,2,1,"mat-error",14),e.TgZ(26,"mat-autocomplete",18,19),e.NdJ("optionSelected",function(i){return n.onRuleSelected(i)}),e.YNc(28,Ft,2,2,"mat-option",20),e.ALo(29,"async"),e.qZA(),e.TgZ(30,"button",21),e._UZ(31,"mat-icon",22),e.qZA()()(),e.TgZ(32,"mat-grid-tile"),e._UZ(33,"ts-info-tooltip-icon",23),e.ALo(34,"translate"),e.TgZ(35,"mat-form-field",12)(36,"mat-label"),e._uU(37),e.ALo(38,"translate"),e.qZA(),e.TgZ(39,"input",24),e.NdJ("change",function(i){return n.onTimeoutChange(i.target.value)})("focus",function(){return n.setIsChanged()})("ngModelChange",function(i){return n.model.chatTimeout=i}),e.qZA(),e.YNc(40,qt,2,1,"mat-error",14),e.qZA()()()()(),e.TgZ(41,"div",25)(42,"ts-operators-detail",26),e.NdJ("pageNeedToSaveChange",function(i){return n.shouldSave=i})("savePage",function(){return n.saveWithoutClose()}),e.qZA()()()()()),t&2){const a=e.MAs(27);e.xp6(3),e.Q6J("title",n.pageTitle),e.xp6(1),e.Q6J("ngIf",n.saveButtonVisible()),e.xp6(1),e.Q6J("ngIf",n.cancelButtonVisible()),e.xp6(1),e.Q6J("ngIf",n.closeButtonVisible()),e.xp6(3),e.Q6J("formGroup",n.chatQueueForm),e.xp6(3),e.Q6J("colspan",2),e.xp6(3),e.Oqu(e.lcZ(16,23,"ChatSettings.ChatQueuePage.Name")),e.xp6(2),e.Q6J("pattern",n.notEmptyStringValidationRegex)("ngModel",n.model.name),e.xp6(1),e.Q6J("ngIf",n.isInvalid("name")),e.xp6(4),e.hij("",e.lcZ(23,25,"ChatSettings.ChatQueuePage.OperatorRoutingRule")," "),e.xp6(2),e.Q6J("matAutocomplete",a)("value",n.selectDisplayValue(n.operatorRoutingRule))("ngModel",n.model.routingRule),e.xp6(1),e.Q6J("ngIf",n.isInvalid("operatorRoutingRule")),e.xp6(1),e.Q6J("displayWith",n.selectDisplayValue),e.xp6(2),e.Q6J("ngForOf",e.lcZ(29,27,n.routeRuleList$)),e.xp6(5),e.Q6J("message",e.lcZ(34,29,"ChatSettings.ChatQueuePage.Tips.Timeout")),e.xp6(4),e.Oqu(e.lcZ(38,31,"ChatSettings.ChatQueuePage.Timeout")),e.xp6(2),e.Q6J("ngModel",n.model.chatTimeout),e.xp6(1),e.Q6J("ngIf",n.isInvalid("chatTimeout")),e.xp6(2),e.Q6J("chatQueueId",n.model.id)("pageNeedToSave",n.shouldSave)}}});class ue extends C.POq{constructor(t,n,a){super(),this.dialogService=t,this.translateService=n,this.entityService=a,this.canShowDialog=!1,this.savePage=new e.vpe,this.detailActions=[{click:this.removeRecord.bind(this),caption:this.translateService.instant("ChatSettings.ChannelDetail.DeleteAction")}],this.dataSchema={columns:[{name:"operator",caption:this.translateService.instant("ChatSettings.ChatQueueOperatorDetail.Columns.Operator.Caption"),valueType:l.DataValueType.Text,formatter:(i,r)=>{var u;return(u=r.operator)===null||u===void 0?void 0:u.displayValue},sortingDataAccessor:i=>{var r;return(r=i.operator)===null||r===void 0?void 0:r.displayValue}}]}}_createDuplicationsValidator(){return t=>({success:this.data.filter(a=>a.operator.value===t.id).length===0,message:this.translateService.instant("ChatSettings.ChatQueueOperatorDetail.DuplicationMessage")})}_addRecord(){this.canShowDialog&&this.openAddOperatorsDialog()}ngOnInit(){this.entityService.getItemsByChatQueueId(this.chatQueueId).subscribe(t=>{t.success&&(this.data=t.result)})}openAddOperatorsDialog(){if(this.canShowDialog=!0,this.pageNeedToSave){this.savePage.emit(null);return}this.canShowDialog=!1,this.dialogService.open(De.SelectSysAdminUnitDialogComponent,{data:{validator:this._createDuplicationsValidator()}}).subscribe(t=>{if(t){const n={id:(0,l.generateGuid)(),operator:{value:t.id,displayValue:t.name},chatQueue:{value:this.chatQueueId}};this.entityService.insertItem(n).subscribe(a=>{a.success&&this.onAddRow(n)})}})}removeRecord(t){this.entityService.deleteById(t.id).subscribe(n=>{if(n.success)this.data=this.data.filter(a=>a.id!==t.id);else{const a=this.translateService.instant("ChatSettings.ChannelDetail.DeleteRecordErrorMessage");this.dialogService.openInfoDialog(a)}})}ngOnChanges(t){const n=t.pageNeedToSave;n&&!n.isFirstChange()&&n.currentValue===!1&&this._addRecord()}}ue.\u0275fac=function(t){return new(t||ue)(e.Y36(T.xA),e.Y36(p.sK),e.Y36(Q))},ue.\u0275cmp=e.Xpm({type:ue,selectors:[["ts-operators-detail"]],inputs:{chatQueueId:"chatQueueId",pageNeedToSave:"pageNeedToSave"},outputs:{savePage:"savePage"},features:[e.qOj,e.TTD],decls:2,vars:6,consts:[["selectMode","single",3,"dataSource","dataSchema","actionHandlers","header","addRecordHandle"]],template:function(t,n){t&1&&(e.TgZ(0,"ts-expansion-detail",0),e.NdJ("addRecordHandle",function(){return n.openAddOperatorsDialog()}),e.ALo(1,"translate"),e.qZA()),t&2&&e.Q6J("dataSource",n.tableDataSource)("dataSchema",n.dataSchema)("actionHandlers",n.detailActions)("header",e.lcZ(1,4,"ChatSettings.ChatQueueOperatorDetail.Title"))},dependencies:[x,p.X$]});class wt{}class Ot{}class Vt{}class F{_filterList(t,n){this.filteredLookupList=t.filter(a=>a.displayValue.toLowerCase().indexOf(n.toLowerCase())>=0)}constructor(){this.onChannelChanged=new e.vpe,this.filteredLookupList=[]}channelChanged(){this.onChannelChanged.emit()}search(t,n){this._filterList(t,n)}onLookupFieldFocus(t){this.filteredLookupList=t}selectDisplayValue(t){return t&&t.displayValue||""}}F.\u0275fac=function(t){return new(t||F)},F.\u0275cmp=e.Xpm({type:F,selectors:[["ts-base-channel-field"]],inputs:{model:"model",pageData:"pageData"},outputs:{onChannelChanged:"onChannelChanged"},decls:0,vars:0,template:function(t,n){}});class ne extends F{constructor(){super()}onNameChange(t){this.model.name=t,this.channelNameGroup.patchValue({name:t}),this.channelChanged()}}ne.\u0275fac=function(t){return new(t||ne)},ne.\u0275cmp=e.Xpm({type:ne,selectors:[["ts-base-channel-name"]],inputs:{channelNameGroup:"channelNameGroup"},features:[e.qOj],decls:6,vars:5,consts:[[3,"formGroup"],[1,"field-title"],["matInput","","type","text","formControlName","name","data-qa","name",3,"required","input"]],template:function(t,n){t&1&&(e.TgZ(0,"div",0)(1,"mat-form-field")(2,"mat-label",1),e._uU(3),e.ALo(4,"translate"),e.qZA(),e.TgZ(5,"input",2),e.NdJ("input",function(i){return n.onNameChange(i.target.value)}),e.qZA()()()),t&2&&(e.Q6J("formGroup",n.channelNameGroup),e.xp6(3),e.Oqu(e.lcZ(4,3,"ChatSettings.ChannelPage.Name")),e.xp6(2),e.Q6J("required",!n.pageData.isNew))},dependencies:[h.v_,h.$V,k.k0,s.Fj,s.JJ,s.JL,s.Q7,s.sg,s.u,p.X$]});function Rt(o,t){if(o&1&&(e.TgZ(0,"mat-option",14),e._uU(1),e.qZA()),o&2){const n=t.$implicit;e.Q6J("value",n),e.xp6(1),e.hij(" ",n.displayValue," ")}}class q extends F{constructor(t){super(),this.channelService=t,this.queuesList=[]}get queue(){return{value:this.model.queueId,displayValue:this.model.queueName}}set queue(t){const{value:n,displayValue:a}=t||{value:null,displayValue:""};this.model.queueId!==n&&(this.model.queueId=n,this.model.queueName=a,this.channelChanged())}get queueList$(){return this._queueList$||(this._queueList$=this.channelService.getChannelQueueItems().pipe((0,Ie.B)())),this._queueList$}ngOnInit(){this.queueList$.pipe((0,y.U)(t=>this.queuesList=t)).subscribe()}onQueueSelected(t){const n=t.option.value;this.queue!==n&&(this.queue=n),this.channelQueueGroup.patchValue({queue:n})}onStatusChangeClick(){this.channelQueueGroup.get("isActive").valueChanges.subscribe(t=>{this.model.isActive=t,this.channelChanged()})}}q.\u0275fac=function(t){return new(t||q)(e.Y36(S))},q.\u0275cmp=e.Xpm({type:q,selectors:[["ts-base-channel-queue"]],inputs:{channelQueueGroup:"channelQueueGroup"},features:[e.qOj],decls:19,vars:15,consts:[[3,"formGroup"],[1,"toggle","active-channel-toggle"],[1,"field-title","active-channel-toggle-title"],["matInput","","hidden",""],["checked","model.isActive","formControlName","isActive",1,"channel-toggle","slide-wrapper",3,"click"],[1,"channel-queue","channel-queue-container"],["floatLabel","always",1,"combobox-edit"],[1,"field-title","channel-queue-title"],["matInput","","type","text","spellcheck","false","data-qa","channel-queue-input",3,"matAutocomplete","value","required","input","focus"],[3,"displayWith","optionSelected"],["autoQueue","matAutocomplete"],[3,"value",4,"ngFor","ngForOf"],["matSuffix","","mat-icon-button","",1,"lookup-button"],["svgIcon","arrow-down",1,"lookup-button-icon"],[3,"value"]],template:function(t,n){if(t&1&&(e.TgZ(0,"div",0)(1,"mat-form-field",1)(2,"mat-label",2),e._uU(3),e.ALo(4,"translate"),e.qZA(),e._UZ(5,"textarea",3),e.TgZ(6,"mat-slide-toggle",4),e.NdJ("click",function(){return n.onStatusChangeClick()}),e.qZA()(),e.TgZ(7,"div",5),e.ALo(8,"translate"),e.TgZ(9,"mat-form-field",6)(10,"mat-label",7),e._uU(11),e.ALo(12,"translate"),e.qZA(),e.TgZ(13,"input",8),e.NdJ("input",function(i){return n.search(n.queuesList,i.target.value)})("focus",function(){return n.onLookupFieldFocus(n.queuesList)}),e.qZA(),e.TgZ(14,"mat-autocomplete",9,10),e.NdJ("optionSelected",function(i){return n.onQueueSelected(i)}),e.YNc(16,Rt,2,2,"mat-option",11),e.qZA(),e.TgZ(17,"button",12),e._UZ(18,"mat-icon",13),e.qZA()()()()),t&2){const a=e.MAs(15);e.Q6J("formGroup",n.channelQueueGroup),e.xp6(3),e.Oqu(e.lcZ(4,9,"ChatSettings.ChannelPage.ActiveChannelCaption")),e.xp6(4),e.uIk("data-item-marker",e.lcZ(8,11,"ChatSettings.ChannelPage.Queue")),e.xp6(4),e.hij("",e.lcZ(12,13,"ChatSettings.ChannelPage.Queue")," "),e.xp6(2),e.Q6J("matAutocomplete",a)("value",n.selectDisplayValue(n.queue))("required",n.model.isActive),e.xp6(1),e.Q6J("displayWith",n.selectDisplayValue),e.xp6(2),e.Q6J("ngForOf",n.filteredLookupList)}},dependencies:[f.sg,ae.Hw,h.v_,h.$V,h.nX,k.k0,P.VN,P.QJ,ge.CK,I.eB,s.JJ,s.JL,s.sg,s.u,be.iZ,p.X$]});class Jt{}class w{constructor(){}}w.\u0275fac=function(t){return new(t||w)},w.\u0275cmp=e.Xpm({type:w,selectors:[["ts-base-channel-title"]],inputs:{channelTitle:"channelTitle"},decls:7,vars:3,consts:[[1,"channel-page-link-label","field-title"],["target","_blank",3,"href"],[1,"locked"],[1,"underline-divider"]],template:function(t,n){t&1&&(e.TgZ(0,"mat-label",0),e._uU(1),e.qZA(),e.TgZ(2,"mat-label")(3,"a",1),e._uU(4),e.qZA()(),e._UZ(5,"span",2)(6,"div",3)),t&2&&(e.xp6(1),e.Oqu(n.channelTitle.channelPageCaption),e.xp6(2),e.Q6J("href",n.channelTitle.channelLinkUrl,e.LSH),e.xp6(1),e.Oqu(n.channelTitle.channelLinkCaption))},dependencies:[h.$V]});var xe=c(25833);function Et(o,t){if(o&1&&(e.TgZ(0,"mat-option",10),e._uU(1),e.qZA()),o&2){const n=t.$implicit;e.Q6J("value",n),e.xp6(1),e.hij(" ",n.displayValue," ")}}class O extends F{constructor(t){super(),this.channelService=t,this.languagesList=[]}get language(){return{value:this.model.languageId,displayValue:this.model.languageName}}set language(t){const{value:n,displayValue:a}=t||{value:null,displayValue:""};this.model.languageId!==n&&(this.model.languageId=n,this.model.languageName=a,this.channelChanged())}get languageList$(){return this._languageList$||(this._languageList$=this.channelService.getActiveLanguages().pipe((0,Ie.B)())),this._languageList$}onLanguageSelected(t){const n=t.option.value;this.language!==n&&(this.language=n),this.channelLanguageGroup.patchValue({language:n})}ngOnInit(){this.languageList$.pipe((0,y.U)(t=>this.languagesList=t)).subscribe()}}O.\u0275fac=function(t){return new(t||O)(e.Y36(S))},O.\u0275cmp=e.Xpm({type:O,selectors:[["ts-base-channel-language"]],inputs:{channelLanguageGroup:"channelLanguageGroup"},features:[e.qOj],decls:14,vars:14,consts:[[1,"channel-language",3,"formGroup"],[1,"tooltip",3,"message"],["floatLabel","always",1,"combobox-edit"],[1,"field-title"],["matInput","","type","text","spellcheck","false","data-qa","channel-language-input",3,"matAutocomplete","value","input","focus"],[3,"displayWith","optionSelected"],["autoLanguage","matAutocomplete"],[3,"value",4,"ngFor","ngForOf"],["matSuffix","","mat-icon-button","",1,"lookup-button"],["svgIcon","arrow-down",1,"lookup-button-icon"],[3,"value"]],template:function(t,n){if(t&1&&(e.TgZ(0,"div",0),e.ALo(1,"translate"),e._UZ(2,"ts-info-tooltip-icon",1),e.ALo(3,"translate"),e.TgZ(4,"mat-form-field",2)(5,"mat-label",3),e._uU(6),e.ALo(7,"translate"),e.qZA(),e.TgZ(8,"input",4),e.NdJ("input",function(i){return n.search(n.languagesList,i.target.value)})("focus",function(){return n.onLookupFieldFocus(n.languagesList)}),e.qZA(),e.TgZ(9,"mat-autocomplete",5,6),e.NdJ("optionSelected",function(i){return n.onLanguageSelected(i)}),e.YNc(11,Et,2,2,"mat-option",7),e.qZA(),e.TgZ(12,"button",8),e._UZ(13,"mat-icon",9),e.qZA()()()),t&2){const a=e.MAs(10);e.Q6J("formGroup",n.channelLanguageGroup),e.uIk("data-item-marker",e.lcZ(1,8,"ChatSettings.ChannelPage.Language")),e.xp6(2),e.Q6J("message",e.lcZ(3,10,"ChatSettings.ChannelPage.Tips.Language")),e.xp6(4),e.hij("",e.lcZ(7,12,"ChatSettings.ChannelPage.Language")," "),e.xp6(2),e.Q6J("matAutocomplete",a)("value",n.selectDisplayValue(n.language)),e.xp6(1),e.Q6J("displayWith",n.selectDisplayValue),e.xp6(2),e.Q6J("ngForOf",n.filteredLookupList)}},dependencies:[f.sg,xe.B,ae.Hw,h.v_,h.$V,h.nX,k.k0,P.VN,P.QJ,ge.CK,I.eB,s.JL,s.sg,p.X$]});const Bt=[{path:"",component:ee,data:{shouldReuse:!0}},{path:"chat-queue/new",component:A},{path:"chat-queue/:id",component:A}];class V{}V.\u0275fac=function(t){return new(t||V)},V.\u0275mod=e.oAB({type:V}),V.\u0275inj=e.cJS({imports:[de.Bz.forChild(Bt),de.Bz]}),function(){(typeof ngJitMode>"u"||ngJitMode)&&e.kYT(V,{imports:[de.Bz],exports:[de.Bz]})}();var Oe=c(60527),Ve=c(78464);class he{}he.\u0275fac=function(t){return new(t||he)},he.\u0275mod=e.oAB({type:he}),he.\u0275inj=e.cJS({providers:[S,J,N,E,B,Q,Z,G,C.Pnv,Y,ie,oe,{provide:ye,useFactory:()=>new C.Pnv},{provide:Ae,useFactory:()=>new C.Pnv},{provide:Pe,useFactory:()=>new C.Pnv},{provide:De.RightManagementService,useClass:Q},{provide:C.thQ,useValue:"ChatSettingsModule"}],imports:[V,f.ez,C.kLW,p.aw,T.z8,Qe.AA,Se.To,ae.Ps,Ze.Nn,me.jT,h.wp,k.x4,P.D8,ge.Uc,I.yu,s.u5,s.UX,T.Su,_e.N6,d.yj,be.Wd,Ne.uw,T._M,Me.dp]}),function(){(typeof ngJitMode>"u"||ngJitMode)&&e.kYT(he,{declarations:[ee,re,x,le,ce,A,L,ue,z,te,M,D,K,se,ne,F,O,q,w,X],imports:[V,f.ez,C.kLW,p.aw,T.z8,Qe.AA,Se.To,ae.Ps,Ze.Nn,me.jT,h.wp,k.x4,P.D8,ge.Uc,I.yu,s.u5,s.UX,T.Su,_e.N6,d.yj,be.Wd,Ne.uw,T._M,Me.dp]})}(),e.B6R(ee,[Oe.G,re,le,ce],[p.X$]),e.B6R(A,[f.sg,f.O5,Oe.G,xe.B,ae.Hw,h.nI,h.v_,h.$V,h.nX,k.k0,P.VN,P.QJ,ge.CK,I.eB,s._Y,s.Fj,s.wV,s.JJ,s.JL,s.Q7,s.c5,s.qQ,s.sg,s.u,_e.Il,_e.DX,ue],[f.Ov,p.X$]),e.B6R(D,[f.O5,h.$V,I.eB,s._Y,s.JL,s.sg,d.aO,d.ev,ne,O,q,w],[p.X$]),e.B6R(K,[f.O5,h.v_,h.$V,k.k0,I.eB,s._Y,s.Fj,s.JJ,s.JL,s.Q7,s.sg,s.u,d.aO,d.ev,Ve.g,ne,O,q,w],[p.X$]),e.B6R(X,[f.O5,xe.B,h.nI,h.v_,h.$V,h.g4,k.k0,I.eB,s._Y,s.Fj,s.JJ,s.JL,s.Q7,s.nD,s.sg,s.u,d.aO,d.ev,Ve.g,O,q,w],[p.X$])}}]);
