"use strict";(self.webpackChunkapp_studio_enterprise_system_designer=self.webpackChunkapp_studio_enterprise_system_designer||[]).push([[640],{74640:(Lt,ee,i)=>{i.r(ee),i.d(ee,{ChangeLogModule:()=>v,ChangeLogObjectsMock:()=>ft,getObjectChangeLogMock:()=>Tt,getRecordChangeLogMock:()=>bt});var m=i(88692),T=i(20092),M=i(83704),V=i(83331),J=i(79510),L=i(15756),te=i(49460),C=i(37697),B=i(95236),H=i(74817),_=i(72990),R=i(19126),$=i(62549),r=i(73514),F=i(97355),q=i(55799),Q=i(56558),h=i(56707),f=i(26522),Y=i(73715),se=i(76170),p=i(80542),Z=i(7976),s=i(75378),K=i(11465),d=i(36619),E=i(7206),W=i(26903),ne=i(11770),ge=i(87472),e=i(64537);class re{}class O{constructor(t,n,o){this.dialogService=t,this.processEngineService=n,this.translateService=o}executeCleaning(t=new re){let n={};t.entitySchemaUId&&(n=Object.assign(n,{EntitySchemaUId:t.entitySchemaUId})),t.endDate&&(n=Object.assign(n,{EndDate:(0,s.toLocalISOString)(t.endDate)}));const o=this.processEngineService.executeProcessByName("ClearObjectChangeLogProcess",n).pipe((0,W.B)());return o.subscribe(c=>{if(!c)throw new ge.K;let l;!c.success&&c.message&&(l=c.message),c.success&&(l=this.translateService.instant("ChangeLogCleanerService.SuccessLaunch")),l&&this.dialogService.openInfoDialog(l)}),o}}O.\u0275fac=function(t){return new(t||O)(e.LFG(f.xA),e.LFG(K.zV),e.LFG(h.sK))},O.\u0275prov=e.Yz7({token:O,factory:O.\u0275fac});var ae=i(27969),de=i(35732);class u{constructor(t){this.httpClient=t,this.serviceEndpoint="ServiceModel/ChangeLogService.svc/"}_mapResponseChangeLogRecords(t){const n=c=>(0,d.UYv)(c,{oldValue:c.dataValueType,newValue:c.dataValueType}),o=(0,d.Z3u)(t,{changeTrackedOn:s.DataValueType.DateTime});return o.forEach(c=>{const l=c.changedColumns||[];c.changedColumns=l.filter(g=>g&&g.name).map(n)}),o}getObjectChangeLog(t,n,o){const c=this.serviceEndpoint+"GetObjectChangeLog";return this.httpClient.post(c,{schemaUId:t,pagingOptions:n,filters:{searchValue:o.searchValue,startDate:o.dateRange&&o.dateRange.startDate?(0,s.toLocalISOString)(o.dateRange.startDate):"",endDate:o.dateRange&&o.dateRange.endDate?(0,s.toLocalISOString)(o.dateRange.endDate):""}}).pipe((0,ae.U)(l=>({success:l.success,errorInfo:l.errorInfo,changeLog:this._mapResponseChangeLogRecords(l.changeLog||[])})))}getRecordChangeLog(t,n){const o=this.serviceEndpoint+"GetRecordChangeLog";return this.httpClient.post(o,{schemaUId:t,recordId:n}).pipe((0,ae.U)(c=>({success:c.success,errorInfo:c.errorInfo,recordTitle:c.recordTitle,changeLog:this._mapResponseChangeLogRecords(c.changeLog||[])})))}getObjectChangeLogSettings(t){const n=this.serviceEndpoint+"GetObjectChangeLogSettings";return this.httpClient.post(n,{schemaUId:t})}saveObjectChangeLogSettings(t){const n=this.serviceEndpoint+"SaveObjectChangeLogSettings";return this.httpClient.post(n,{changeLogSettings:t})}getChangeLogObjects(t){let n;switch(t){case p.JUd.Section:n="GetSectionObjects";break;case p.JUd.Lookup:n="GetLookupObjects";break;case p.JUd.All:default:n="GetAllObjects";break}const o=this.serviceEndpoint+n;return this.httpClient.post(o,null)}getLoggedObjects(){const t=this.serviceEndpoint+"GetLoggedObjects";return this.httpClient.post(t,null)}}u.\u0275fac=function(t){return new(t||u)(e.LFG(de.eN))},u.\u0275prov=e.Yz7({token:u,factory:u.\u0275fac});var oe=i(16738),G=i(78464),me=i(95411);function pe(a,t){a&1&&e._UZ(0,"ts-mask")}function he(a,t){if(a&1&&(e.TgZ(0,"mat-option",15),e._uU(1),e.qZA()),a&2){const n=t.$implicit;e.Q6J("value",n),e.xp6(1),e.hij(" ",n.displayValue," ")}}var S;(function(a){a[a.ByObject=0]="ByObject",a[a.All=1]="All"})(S||(S={}));var I;(function(a){a[a.All=0]="All",a[a.ToDate=1]="ToDate"})(I||(I={}));class k{constructor(t,n,o,c,l){this.data=t,this.dialogRef=n,this.changeLogCleanerService=o,this.changeLogService=c,this.googleTagManagerService=l,this.isLoading=!1,this.periodType=I.ToDate,this.objectType=S.ByObject;const g=new Date;this.endDate=oe(new Date(g.getFullYear()-1,g.getMonth(),g.getDate()))}_prepareLoggedObjectsResponse(t){this.loggedObjects=t.loggedObjects;const n=this.data;if(n&&n.entitySchemaUId){const o=this.loggedObjects.find(c=>c.value===n.entitySchemaUId);o?this.selectedObject=o:this.objectType=S.All}this.isLoading=!1}sendGtmAction(t){const n=this.data.gtmData;t&&n&&n.moduleName&&n.schemaName&&this.googleTagManagerService.track((0,E.Z)(n,t))}ngOnInit(){this.isLoading=!0,this.changeLogService.getLoggedObjects().subscribe(this._prepareLoggedObjectsResponse.bind(this))}search(t){if(!t){this.filteredLoggedObjects=this.loggedObjects,this.selectedObject=null;return}t=t.toLowerCase(),this.filteredLoggedObjects=this.loggedObjects.filter(n=>n.displayValue.toLowerCase().indexOf(t)!==-1)}onFilteredLoggedObjectSelected(t){const n=t.option.value;this.selectedObject=n}getObjectCaption(t){return t.displayValue}onClearButtonClick(){this.isLoading=!0;const t=this.objectType===S.ByObject?this.selectedObject.value:null,n={objectToClear:t||"<All objects>",keepDataFor:this.periodType===I.ToDate?oe().diff(this.endDate,"day"):0};this.changeLogCleanerService.executeCleaning({entitySchemaUId:t,endDate:this.periodType===I.ToDate?(0,d.iXC)(this.endDate.toDate()):null}).subscribe({complete:()=>{this.isLoading=!1,this.sendGtmAction({action:"ClearChangeLog",description:n}),this.dialogRef.close()},error:()=>{this.isLoading=!1,this.sendGtmAction({action:"ClearChangeLogError",description:n})}})}getClearButtonDisabled(){return this.objectType===S.ByObject&&!this.selectedObject||this.periodType===I.ToDate&&!this.endDate}}k.\u0275fac=function(t){return new(t||k)(e.Y36(C.eJ),e.Y36(C.hV),e.Y36(O),e.Y36(u),e.Y36(K.kK))},k.\u0275cmp=e.Xpm({type:k,selectors:[["ts-clear-change-log-settings-dialog"]],decls:56,vars:48,consts:[[4,"ngIf"],["mat-dialog-title",""],["mat-dialog-content",""],[1,"radio-group-title"],[3,"ngModel","ngModelChange"],["disableRipple","true",3,"value"],[1,"logged-object-wrapper"],[1,"object-title"],["floatLabel","never",1,"logged-object"],["type","text","matInput","",3,"placeholder","matAutocomplete","value","input","focus"],["matSuffix","",1,"mat-select-arrow-wrapper"],[1,"mat-select-arrow"],[3,"displayWith","optionSelected"],["auto","matAutocomplete"],[3,"value",4,"ngFor","ngForOf"],[3,"value"],[1,"choose-date-radio-button-label-wrapper"],["floatLabel","never",1,"date-picker","end-date-picker"],["matInput","",3,"matDatepicker","placeholder","ngModel","ngModelChange"],["matSuffix","",3,"for"],["svgIcon","select-date","matDatepickerToggleIcon","",1,"date-picker-icon"],["picker",""],["mat-dialog-actions",""],["mat-button","","cdkFocusInitial","",3,"mat-dialog-close"],["mat-flat-button","","color","primary",3,"disabled","click"]],template:function(t,n){if(t&1&&(e.YNc(0,pe,1,0,"ts-mask",0),e.TgZ(1,"div",1)(2,"span"),e._uU(3),e.ALo(4,"translate"),e.qZA()(),e.TgZ(5,"div",2)(6,"div")(7,"div",3),e._uU(8),e.ALo(9,"translate"),e.qZA(),e.TgZ(10,"mat-radio-group",4),e.NdJ("ngModelChange",function(c){return n.objectType=c}),e.TgZ(11,"mat-radio-button",5)(12,"span",6)(13,"span",7),e._uU(14),e.ALo(15,"translate"),e.qZA(),e.TgZ(16,"mat-form-field",8)(17,"input",9),e.NdJ("input",function(c){return n.search(c.target.value)})("focus",function(){return n.filteredLoggedObjects=n.loggedObjects}),e.ALo(18,"translate"),e.qZA(),e.TgZ(19,"div",10),e._UZ(20,"div",11),e.qZA()(),e.TgZ(21,"mat-autocomplete",12,13),e.NdJ("optionSelected",function(c){return n.onFilteredLoggedObjectSelected(c)}),e.YNc(23,he,2,2,"mat-option",14),e.qZA()()(),e.TgZ(24,"mat-radio-button",5)(25,"span"),e._uU(26),e.ALo(27,"translate"),e.qZA()()()(),e.TgZ(28,"div")(29,"div",3),e._uU(30),e.ALo(31,"translate"),e.qZA(),e.TgZ(32,"mat-radio-group",4),e.NdJ("ngModelChange",function(c){return n.periodType=c}),e.TgZ(33,"mat-radio-button",15)(34,"span"),e._uU(35),e.ALo(36,"translate"),e.qZA()(),e.TgZ(37,"mat-radio-button",15)(38,"div",16)(39,"span"),e._uU(40),e.ALo(41,"translate"),e.qZA(),e.TgZ(42,"mat-form-field",17)(43,"input",18),e.NdJ("ngModelChange",function(c){return n.endDate=c}),e.ALo(44,"translate"),e.qZA(),e.TgZ(45,"mat-datepicker-toggle",19),e._UZ(46,"mat-icon",20),e.qZA(),e._UZ(47,"mat-datepicker",null,21),e.qZA()()()()()(),e.TgZ(49,"div",22)(50,"button",23),e._uU(51),e.ALo(52,"translate"),e.qZA(),e.TgZ(53,"button",24),e.NdJ("click",function(){return n.onClearButtonClick()}),e._uU(54),e.ALo(55,"translate"),e.qZA()()),t&2){const o=e.MAs(22),c=e.MAs(48);e.Q6J("ngIf",n.isLoading),e.xp6(3),e.Oqu(e.lcZ(4,26,"ClearChangeLogSettingsDialog.Title")),e.xp6(5),e.Oqu(e.lcZ(9,28,"ClearChangeLogSettingsDialog.ObjectSettingsTitle")),e.xp6(2),e.Q6J("ngModel",n.objectType),e.xp6(1),e.Q6J("value",0),e.xp6(3),e.Oqu(e.lcZ(15,30,"ClearChangeLogSettingsDialog.OnlySelectedObject")),e.xp6(3),e.Q6J("placeholder",e.lcZ(18,32,"ClearChangeLogSettingsDialog.ChooseObject"))("matAutocomplete",o)("value",n.selectedObject==null?null:n.selectedObject.displayValue),e.xp6(4),e.Q6J("displayWith",n.getObjectCaption),e.xp6(2),e.Q6J("ngForOf",n.filteredLoggedObjects),e.xp6(1),e.Q6J("value",1),e.xp6(2),e.Oqu(e.lcZ(27,34,"ClearChangeLogSettingsDialog.AllObjects")),e.xp6(4),e.Oqu(e.lcZ(31,36,"ClearChangeLogSettingsDialog.PeriodSettingsTitle")),e.xp6(2),e.Q6J("ngModel",n.periodType),e.xp6(1),e.Q6J("value",0),e.xp6(2),e.Oqu(e.lcZ(36,38,"ClearChangeLogSettingsDialog.AllPeriod")),e.xp6(2),e.Q6J("value",1),e.xp6(3),e.Oqu(e.lcZ(41,40,"ClearChangeLogSettingsDialog.ToDatePeriod")),e.xp6(3),e.s9C("placeholder",e.lcZ(44,42,"ClearChangeLogSettingsDialog.ChooseDate")),e.Q6J("matDatepicker",c)("ngModel",n.endDate),e.xp6(2),e.Q6J("for",c),e.xp6(6),e.hij(" ",e.lcZ(52,44,"ClearChangeLogSettingsDialog.Cancel")," "),e.xp6(2),e.Q6J("disabled",n.getClearButtonDisabled()),e.xp6(1),e.hij(" ",e.lcZ(55,46,"ClearChangeLogSettingsDialog.Clear")," ")}},dependencies:[m.sg,m.O5,T.Fj,T.JJ,T.On,G.g,J.VN,J.QJ,me.CK,L.eB,M.Mq,M.hl,M.nW,M.Q0,C.aO,C.YS,C.Rb,C.ev,B.v_,B.nX,H.k0,V.Hw,R.OY,R.vy,h.X$],styles:[`ts-clear-change-log-settings-dialog{padding:0;margin:0;min-width:484px}ts-clear-change-log-settings-dialog .date-picker-icon{width:20px!important;height:20px!important;padding-bottom:10px}ts-clear-change-log-settings-dialog .date-picker-icon svg{width:20px;height:20px}ts-clear-change-log-settings-dialog .mat-dialog-actions{float:right;margin:16px 2px 0 0!important}ts-clear-change-log-settings-dialog .mat-form-field{margin-left:10px;overflow:hidden}ts-clear-change-log-settings-dialog .mat-form-field .mat-form-field-wrapper{margin-bottom:-1.25em}ts-clear-change-log-settings-dialog .logged-object-wrapper{display:flex;align-items:center}ts-clear-change-log-settings-dialog .logged-object-wrapper .logged-object{width:270px}ts-clear-change-log-settings-dialog .end-date-picker{width:150px}ts-clear-change-log-settings-dialog .radio-group-title{color:#999;font-size:13px;font-family:Bpmonline Open Sans,sans-serif;line-height:18px;margin-bottom:12px}ts-clear-change-log-settings-dialog mat-radio-group{margin-bottom:21px}ts-clear-change-log-settings-dialog mat-radio-group mat-radio-button{line-height:28px;height:28px;max-height:28px}ts-clear-change-log-settings-dialog mat-radio-group mat-radio-button .choose-date-radio-button-label-wrapper{display:flex;align-items:center}
`],encapsulation:2});var ce=i(44113),X=i(60527),le=i(58143),D=i(14091),ue=i(38023),Ce=i(83151),y;(function(a){a.Inserted="Inserted",a.Updated="Updated",a.Deleted="Deleted",a.Custom="Custom"})(y||(y={}));class Ot{}function _e(a,t){a&1&&e._UZ(0,"tr",26)}function fe(a,t){a&1&&e._UZ(0,"tr",27)}function be(a,t){if(a&1&&(e.TgZ(0,"th",28)(1,"label"),e._uU(2),e.ALo(3,"translate"),e.qZA()()),a&2){const n=e.oxw(2);e.Q6J("disabled",n.objectChangeLogMode),e.xp6(2),e.Oqu(e.lcZ(3,2,"ChangeLogComponent.ChangeTrackedOn"))}}const Te=function(a,t,n){return{"inserted-icon":a,"updated-icon":t,"deleted-icon":n}};function Le(a,t){if(a&1&&e._UZ(0,"span",33),a&2){const n=t.$implicit,o=e.oxw(3);e.Q6J("ngClass",e.kEZ(2,Te,n===o.changeTypeCodeEnum.Inserted,n===o.changeTypeCodeEnum.Updated,n===o.changeTypeCodeEnum.Deleted))("matTooltip",o.getChangeTypeTooltip(n))}}function Oe(a,t){if(a&1&&(e.TgZ(0,"td",29)(1,"div",30),e.YNc(2,Le,1,6,"span",31),e.TgZ(3,"span",32),e._uU(4),e.qZA()()()),a&2){const n=t.$implicit,o=e.oxw(2);e.xp6(2),e.Q6J("ngIf",n.changeTypeCode),e.xp6(2),e.Oqu(n.changeTrackedOn?n.changeTrackedOn.toLocaleString(o.userCulture):"")}}function ke(a,t){a&1&&(e.TgZ(0,"th",34)(1,"label"),e._uU(2),e.ALo(3,"translate"),e.qZA()()),a&2&&(e.xp6(2),e.Oqu(e.lcZ(3,1,"ChangeLogComponent.ChangeTrackedBy")))}function De(a,t){if(a&1&&(e.TgZ(0,"td",35)(1,"span",36),e._uU(2),e.qZA()()),a&2){const n=t.$implicit;e.xp6(2),e.Oqu((n.changeTrackedBy==null?null:n.changeTrackedBy.displayValue)||"")}}function ye(a,t){a&1&&(e.TgZ(0,"th",37)(1,"label"),e._uU(2),e.ALo(3,"translate"),e.qZA()()),a&2&&(e.xp6(2),e.Oqu(e.lcZ(3,1,"ChangeLogComponent.ChangeTracked")))}function xe(a,t){if(a&1&&(e.TgZ(0,"a",42),e._uU(1),e.qZA()),a&2){const n=e.oxw().$implicit,o=e.oxw().$implicit,c=e.oxw(2);e.hYB("routerLink","/ChangeLog/",c.schemaUId,"/",o.changeTracked==null?null:o.changeTracked.value,""),e.xp6(1),e.Oqu(n)}}function ve(a,t){if(a&1&&(e.TgZ(0,"span",36),e._uU(1),e.qZA()),a&2){const n=e.oxw().$implicit;e.xp6(1),e.Oqu(n)}}function we(a,t){if(a&1&&(e.ynx(0),e.YNc(1,xe,2,3,"a",40),e.YNc(2,ve,2,1,"ng-template",null,41,e.W1O),e.BQk()),a&2){const n=e.MAs(3),o=e.oxw().$implicit,c=e.oxw(2);e.xp6(1),e.Q6J("ngIf",c.objectChangeLogMode&&(o.changeTracked==null?null:o.changeTracked.value))("ngIfElse",n)}}function Pe(a,t){if(a&1&&(e.TgZ(0,"td",38),e.YNc(1,we,4,2,"ng-container",39),e.qZA()),a&2){const n=t.$implicit;e.xp6(1),e.Q6J("ngIf",(n.changeTracked==null?null:n.changeTracked.displayValue)||(n.changeTracked==null?null:n.changeTracked.value))}}function Me(a,t){a&1&&(e.TgZ(0,"th",43)(1,"label"),e._uU(2),e.ALo(3,"translate"),e.qZA()()),a&2&&(e.xp6(2),e.Oqu(e.lcZ(3,1,"ChangeLogComponent.ColumnName")))}function Ze(a,t){if(a&1&&(e.TgZ(0,"div",48)(1,"span"),e._uU(2),e.qZA()()),a&2){const n=t.$implicit,o=t.index,c=e.oxw().$implicit,l=e.oxw(2);e.Q6J("@expand",l.isChangedColumnVisible(c,o)?"expanded":"collapsed"),e.xp6(2),e.Oqu(n.name)}}function Se(a,t){a&1&&(e.ynx(0),e._UZ(1,"span",51),e.TgZ(2,"span"),e._uU(3),e.ALo(4,"translate"),e.qZA(),e.BQk()),a&2&&(e.xp6(3),e.Oqu(e.lcZ(4,1,"ChangeLogComponent.ShowMore")))}function Ie(a,t){a&1&&(e._UZ(0,"span",52),e.TgZ(1,"span"),e._uU(2),e.ALo(3,"translate"),e.qZA()),a&2&&(e.xp6(2),e.Oqu(e.lcZ(3,1,"ChangeLogComponent.ShowLess")))}function Ae(a,t){if(a&1){const n=e.EpF();e.TgZ(0,"a",49),e.NdJ("click",function(){e.CHM(n);const c=e.oxw().$implicit,l=e.oxw(2);return e.KtG(l.onShowMoreLessClick(c))}),e.YNc(1,Se,5,3,"ng-container",50),e.YNc(2,Ie,4,3,"ng-template",null,41,e.W1O),e.qZA()}if(a&2){const n=e.MAs(3),o=e.oxw().$implicit,c=e.oxw(2);e.xp6(1),e.Q6J("ngIf",!c.areChangeLogRecordColumnsExpanded(o))("ngIfElse",n)}}function Ne(a,t){if(a&1&&(e.TgZ(0,"td",44)(1,"div",45),e.YNc(2,Ze,3,2,"ng-template",46),e.qZA(),e.YNc(3,Ae,4,2,"a",47),e.qZA()),a&2){const n=t.$implicit,o=e.oxw(2);e.xp6(2),e.Q6J("ngForOf",n.changedColumns),e.xp6(1),e.Q6J("ngIf",o.isShowMoreLessButtonVisible(n))}}function je(a,t){a&1&&(e.TgZ(0,"th",53)(1,"label"),e._uU(2),e.ALo(3,"translate"),e.qZA()()),a&2&&(e.xp6(2),e.Oqu(e.lcZ(3,1,"ChangeLogComponent.ColumnOldValue")))}function Ue(a,t){if(a&1&&(e.ynx(0),e.TgZ(1,"span"),e._uU(2),e.qZA(),e.BQk()),a&2){const n=t.$implicit;e.xp6(2),e.Oqu(n)}}function Ve(a,t){if(a&1&&(e.TgZ(0,"div",48),e.YNc(1,Ue,3,1,"ng-container",39),e.qZA()),a&2){const n=t.$implicit,o=t.index,c=e.oxw().$implicit,l=e.oxw(2);e.Q6J("@expand",l.isChangedColumnVisible(c,o)?"expanded":"collapsed"),e.xp6(1),e.Q6J("ngIf",l.formatColumnValue(n.oldValue,n.dataValueType))}}function Je(a,t){if(a&1&&(e.TgZ(0,"td",54),e.YNc(1,Ve,2,2,"ng-template",46),e.qZA()),a&2){const n=t.$implicit;e.xp6(1),e.Q6J("ngForOf",n.changedColumns)}}function Be(a,t){a&1&&(e.TgZ(0,"th",55)(1,"label"),e._uU(2),e.ALo(3,"translate"),e.qZA()()),a&2&&(e.xp6(2),e.Oqu(e.lcZ(3,1,"ChangeLogComponent.ColumnNewValue")))}function Re(a,t){if(a&1&&(e.ynx(0),e.TgZ(1,"span"),e._uU(2),e.qZA(),e.BQk()),a&2){const n=t.$implicit;e.xp6(2),e.Oqu(n)}}function Fe(a,t){if(a&1&&(e.TgZ(0,"div",48),e.YNc(1,Re,3,1,"ng-container",39),e.qZA()),a&2){const n=t.$implicit,o=t.index,c=e.oxw().$implicit,l=e.oxw(2);e.Q6J("@expand",l.isChangedColumnVisible(c,o)?"expanded":"collapsed"),e.xp6(1),e.Q6J("ngIf",l.formatColumnValue(n.newValue,n.dataValueType))}}function qe(a,t){if(a&1&&(e.TgZ(0,"td",56),e.YNc(1,Fe,2,2,"ng-template",46),e.qZA()),a&2){const n=t.$implicit;e.xp6(1),e.Q6J("ngForOf",n.changedColumns)}}const Qe=function(a){return{"object-change-log-mode":a}};function Ye(a,t){if(a&1&&(e.TgZ(0,"table",5),e.YNc(1,_e,1,0,"tr",6),e.YNc(2,fe,1,0,"tr",7),e.ynx(3,8),e.YNc(4,be,4,4,"th",9),e.YNc(5,Oe,5,2,"td",10),e.BQk(),e.ynx(6,11),e.YNc(7,ke,4,3,"th",12),e.YNc(8,De,3,1,"td",13),e.BQk(),e.ynx(9,14),e.YNc(10,ye,4,3,"th",15),e.YNc(11,Pe,2,1,"td",16),e.BQk(),e.ynx(12,17),e.YNc(13,Me,4,3,"th",18),e.YNc(14,Ne,4,2,"td",19),e.BQk(),e.ynx(15,20),e.YNc(16,je,4,3,"th",21),e.YNc(17,Je,2,1,"td",22),e.BQk(),e.ynx(18,23),e.YNc(19,Be,4,3,"th",24),e.YNc(20,qe,2,1,"td",25),e.BQk(),e.qZA()),a&2){const n=e.oxw();e.Q6J("dataSource",n.tableDataSource)("ngClass",e.VKq(5,Qe,n.objectChangeLogMode)),e.xp6(1),e.Q6J("matHeaderRowDef",n.displayedColumns)("matHeaderRowDefSticky",!0),e.xp6(1),e.Q6J("matRowDefColumns",n.displayedColumns)}}function Ee(a,t){a&1&&(e.TgZ(0,"div",57)(1,"span"),e._uU(2),e.ALo(3,"translate"),e.qZA()()),a&2&&(e.xp6(2),e.Oqu(e.lcZ(3,1,"ChangeLogComponent.Blankslate")))}class x extends p.AFp{set objectChangeLogMode(t){this._objectChangeLogMode=t,this._initDisplayedColumns(),this._fireDynamicTitlesProcessing()}get objectChangeLogMode(){return this._objectChangeLogMode}constructor(t,n,o){super(),this._userInfo=t,this._translateService=n,this._scrollToBottomObserverFactory=o,this._recordsWithExpandedColumns=[],this._changeTypesTooltipKeys={Inserted:"InsertedTooltip",Updated:"UpdatedTooltip",Deleted:"DeletedTooltip"},this._maxDisplayedChangedColumnsCount=3,this.processDynamicTitlesSubject=new ue.x,this._objectChangeLogMode=!1,this.displayedColumns=[],this.changeTypeCodeEnum=y,this.scrolledToBottom=new e.vpe,this._initUserCulture(),this._initDisplayedColumns(),this._subscribeDynamicTitlesProcessing()}_initUserCulture(){this.userCulture=this._userInfo.cultureInfo.sysCultureName}_subscribeDynamicTitlesProcessing(){function t(){const c=document.querySelectorAll(".dynamic-title");for(let l=0;l<c.length;l++){const g=c[l];if(!g)continue;const P=g.getBoundingClientRect();g.scrollWidth-P.width>1||g.scrollHeight-P.height>1?g.setAttribute("title",g.textContent):g.removeAttribute("title")}}const n=this.processDynamicTitlesSubject.asObservable(),o=500;n.pipe((0,Ce.b)(o)).subscribe(()=>t())}_fireDynamicTitlesProcessing(){this.processDynamicTitlesSubject.next()}_initDisplayedColumns(){const t=["changeTrackedOn","changeTrackedBy","changeTracked"];this.displayedColumns=this.objectChangeLogMode?t:t.concat(["columnName","columnOldValue","columnNewValue"])}onDataSourceSet(t){super.onDataSourceSet(t),this._fireDynamicTitlesProcessing()}areChangeLogRecordColumnsExpanded(t){return this._recordsWithExpandedColumns.indexOf(t)!==-1}isShowMoreLessButtonVisible(t){const n=t.changedColumns;return n&&n.length>this._maxDisplayedChangedColumnsCount}isChangedColumnVisible(t,n){return n<this._maxDisplayedChangedColumnsCount||this.areChangeLogRecordColumnsExpanded(t)}onShowMoreLessClick(t){const n=this._recordsWithExpandedColumns.indexOf(t);return n===-1?this._recordsWithExpandedColumns.push(t):this._recordsWithExpandedColumns.splice(n,1),this._fireDynamicTitlesProcessing(),!1}formatColumnValue(t,n){if(t==null)return"";switch(n){case s.DataValueType.DateTime:return t.toLocaleString(this.userCulture);case s.DataValueType.Date:return t.toLocaleDateString(this.userCulture);case s.DataValueType.Time:return t.toLocaleTimeString(this.userCulture);case s.DataValueType.Boolean:const o=t?"ChangeLogComponent.Yes":"ChangeLogComponent.No";return this._translateService.instant(o);case s.DataValueType.Integer:case s.DataValueType.Float:return t.toLocaleString(this.userCulture,{maximumFractionDigits:9});default:return t.toString()||""}}getChangeTypeTooltip(t){const n="ChangeLogComponent."+this._changeTypesTooltipKeys[t];return this._translateService.instant(n)}onResize(){this._fireDynamicTitlesProcessing()}ngAfterViewInit(){const t=this.detailTableWrapper.nativeElement;t&&(this._scrollToBottomObserver=this._scrollToBottomObserverFactory.createObserver(t,()=>this.scrolledToBottom.next()))}ngOnDestroy(){this._scrollToBottomObserver.destroy()}}x.\u0275fac=function(t){return new(t||x)(e.Y36(d.aoG),e.Y36(h.sK),e.Y36(d.OZI))},x.\u0275cmp=e.Xpm({type:x,selectors:[["ts-change-log"]],hostBindings:function(t,n){t&1&&e.NdJ("resize",function(){return n.onResize()},!1,e.Jf7)},inputs:{isLoading:"isLoading",schemaUId:"schemaUId",objectChangeLogMode:"objectChangeLogMode"},outputs:{scrolledToBottom:"scrolledToBottom"},features:[e.qOj],decls:5,vars:2,consts:[[1,"detail-wrapper"],[1,"detail-table-wrapper"],["detailTableWrapper",""],["mat-table","","matSort","","matSortActive","changeTrackedOn","matSortDirection","desc","matSortDisableClear","",3,"dataSource","ngClass",4,"ngIf"],["class","detail-blank-slate",4,"ngIf"],["mat-table","","matSort","","matSortActive","changeTrackedOn","matSortDirection","desc","matSortDisableClear","",3,"dataSource","ngClass"],["mat-header-row","",4,"matHeaderRowDef","matHeaderRowDefSticky"],["mat-row","",4,"matRowDef","matRowDefColumns"],["matColumnDef","changeTrackedOn"],["mat-header-cell","","class","column-changeTrackedOn","mat-sort-header","",3,"disabled",4,"matHeaderCellDef"],["mat-cell","","class","column-changeTrackedOn",4,"matCellDef"],["matColumnDef","changeTrackedBy"],["mat-header-cell","","class","column-changeTrackedBy",4,"matHeaderCellDef"],["mat-cell","","class","column-changeTrackedBy",4,"matCellDef"],["matColumnDef","changeTracked"],["mat-header-cell","","class","column-changeTracked",4,"matHeaderCellDef"],["mat-cell","","class","column-changeTracked",4,"matCellDef"],["matColumnDef","columnName"],["mat-header-cell","","class","column-columnName",4,"matHeaderCellDef"],["mat-cell","","class","column-columnName",4,"matCellDef"],["matColumnDef","columnOldValue"],["mat-header-cell","","class","column-columnOldValue",4,"matHeaderCellDef"],["mat-cell","","class","column-columnOldValue",4,"matCellDef"],["matColumnDef","columnNewValue"],["mat-header-cell","","class","column-columnNewValue",4,"matHeaderCellDef"],["mat-cell","","class","column-columnNewValue",4,"matCellDef"],["mat-header-row",""],["mat-row",""],["mat-header-cell","","mat-sort-header","",1,"column-changeTrackedOn",3,"disabled"],["mat-cell","",1,"column-changeTrackedOn"],[1,"change-tracked-on-content-wrapper"],["class","change-type-icon",3,"ngClass","matTooltip",4,"ngIf"],[1,"text-break-word","dynamic-title","change-tracked-on-value"],[1,"change-type-icon",3,"ngClass","matTooltip"],["mat-header-cell","",1,"column-changeTrackedBy"],["mat-cell","",1,"column-changeTrackedBy"],[1,"text-break-word","dynamic-title"],["mat-header-cell","",1,"column-changeTracked"],["mat-cell","",1,"column-changeTracked"],[4,"ngIf"],["class","text-break-word dynamic-title",3,"routerLink",4,"ngIf","ngIfElse"],["elseBlock",""],[1,"text-break-word","dynamic-title",3,"routerLink"],["mat-header-cell","",1,"column-columnName"],["mat-cell","",1,"column-columnName"],[1,"column-names-wrapper"],["ngFor","",3,"ngForOf"],["class","show-more-less-link",3,"click",4,"ngIf"],[1,"column-wrapper","dynamic-title"],[1,"show-more-less-link",3,"click"],[4,"ngIf","ngIfElse"],[1,"show-more-less-icon","show-more-icon"],[1,"show-more-less-icon","show-less-icon"],["mat-header-cell","",1,"column-columnOldValue"],["mat-cell","",1,"column-columnOldValue"],["mat-header-cell","",1,"column-columnNewValue"],["mat-cell","",1,"column-columnNewValue"],[1,"detail-blank-slate"]],template:function(t,n){t&1&&(e.TgZ(0,"div",0)(1,"div",1,2),e.YNc(3,Ye,21,7,"table",3),e.YNc(4,Ee,4,3,"div",4),e.qZA()()),t&2&&(e.xp6(3),e.Q6J("ngIf",!n.isEmpty()),e.xp6(1),e.Q6J("ngIf",!n.isLoading&&n.isEmpty()))},dependencies:[Z.rH,m.mk,m.sg,m.O5,Q.YE,Q.nU,r.ty,r.wO,r.S4,r.t3,r.R3,r.Al,r.L7,r.ML,r.fg,r.Zw,q.Kd,h.X$],styles:[".detail-table-wrapper[_ngcontent-%COMP%]{max-height:initial!important;overflow:initial!important}.detail-table-wrapper[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]:first-of-type, .detail-table-wrapper[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]:first-of-type{padding-left:0!important}.detail-table-wrapper[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]:not(:first-of-type):not(:last-of-type), .detail-table-wrapper[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]:not(:first-of-type):not(:last-of-type){padding-left:5px;padding-right:5px}.detail-table-wrapper[_ngcontent-%COMP%]   td.column-changeTrackedOn[_ngcontent-%COMP%], .detail-table-wrapper[_ngcontent-%COMP%]   th.column-changeTrackedOn[_ngcontent-%COMP%]{width:15%;max-width:0}.detail-table-wrapper[_ngcontent-%COMP%]   td.column-changeTrackedBy[_ngcontent-%COMP%], .detail-table-wrapper[_ngcontent-%COMP%]   td.column-changeTracked[_ngcontent-%COMP%], .detail-table-wrapper[_ngcontent-%COMP%]   th.column-changeTrackedBy[_ngcontent-%COMP%], .detail-table-wrapper[_ngcontent-%COMP%]   th.column-changeTracked[_ngcontent-%COMP%]{max-width:0}.detail-table-wrapper[_ngcontent-%COMP%]   td.column-columnName[_ngcontent-%COMP%], .detail-table-wrapper[_ngcontent-%COMP%]   th.column-columnName[_ngcontent-%COMP%]{padding-left:0!important;padding-right:0!important}.detail-table-wrapper[_ngcontent-%COMP%]   td.column-columnName[_ngcontent-%COMP%]   .column-wrapper[_ngcontent-%COMP%]   span[_ngcontent-%COMP%], .detail-table-wrapper[_ngcontent-%COMP%]   td.column-columnName[_ngcontent-%COMP%]   label[_ngcontent-%COMP%], .detail-table-wrapper[_ngcontent-%COMP%]   th.column-columnName[_ngcontent-%COMP%]   .column-wrapper[_ngcontent-%COMP%]   span[_ngcontent-%COMP%], .detail-table-wrapper[_ngcontent-%COMP%]   th.column-columnName[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{padding-left:5px;padding-right:5px}.detail-table-wrapper[_ngcontent-%COMP%]   td.column-columnOldValue[_ngcontent-%COMP%], .detail-table-wrapper[_ngcontent-%COMP%]   td.column-columnNewValue[_ngcontent-%COMP%], .detail-table-wrapper[_ngcontent-%COMP%]   th.column-columnOldValue[_ngcontent-%COMP%], .detail-table-wrapper[_ngcontent-%COMP%]   th.column-columnNewValue[_ngcontent-%COMP%]{max-width:0;padding-left:0!important;padding-right:0!important}.detail-table-wrapper[_ngcontent-%COMP%]   td.column-columnOldValue[_ngcontent-%COMP%]   .column-wrapper[_ngcontent-%COMP%]   span[_ngcontent-%COMP%], .detail-table-wrapper[_ngcontent-%COMP%]   td.column-columnOldValue[_ngcontent-%COMP%]   label[_ngcontent-%COMP%], .detail-table-wrapper[_ngcontent-%COMP%]   td.column-columnNewValue[_ngcontent-%COMP%]   .column-wrapper[_ngcontent-%COMP%]   span[_ngcontent-%COMP%], .detail-table-wrapper[_ngcontent-%COMP%]   td.column-columnNewValue[_ngcontent-%COMP%]   label[_ngcontent-%COMP%], .detail-table-wrapper[_ngcontent-%COMP%]   th.column-columnOldValue[_ngcontent-%COMP%]   .column-wrapper[_ngcontent-%COMP%]   span[_ngcontent-%COMP%], .detail-table-wrapper[_ngcontent-%COMP%]   th.column-columnOldValue[_ngcontent-%COMP%]   label[_ngcontent-%COMP%], .detail-table-wrapper[_ngcontent-%COMP%]   th.column-columnNewValue[_ngcontent-%COMP%]   .column-wrapper[_ngcontent-%COMP%]   span[_ngcontent-%COMP%], .detail-table-wrapper[_ngcontent-%COMP%]   th.column-columnNewValue[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{padding-left:5px;padding-right:5px}.detail-table-wrapper[_ngcontent-%COMP%]   td.column-columnName[_ngcontent-%COMP%], .detail-table-wrapper[_ngcontent-%COMP%]   td.column-columnOldValue[_ngcontent-%COMP%], .detail-table-wrapper[_ngcontent-%COMP%]   td.column-columnNewValue[_ngcontent-%COMP%], .detail-table-wrapper[_ngcontent-%COMP%]   th.column-columnName[_ngcontent-%COMP%], .detail-table-wrapper[_ngcontent-%COMP%]   th.column-columnOldValue[_ngcontent-%COMP%], .detail-table-wrapper[_ngcontent-%COMP%]   th.column-columnNewValue[_ngcontent-%COMP%]{max-width:0;width:19%}.detail-table-wrapper[_ngcontent-%COMP%]   table.object-change-log-mode[_ngcontent-%COMP%]   td.column-changeTrackedOn[_ngcontent-%COMP%], .detail-table-wrapper[_ngcontent-%COMP%]   table.object-change-log-mode[_ngcontent-%COMP%]   th.column-changeTrackedOn[_ngcontent-%COMP%]{width:25%}.detail-table-wrapper[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{vertical-align:top;padding-top:14px!important;padding-bottom:14px!important;overflow:visible}.detail-table-wrapper[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]   span[_ngcontent-%COMP%], .detail-table-wrapper[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{line-height:32px;height:32px}.detail-table-wrapper[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]   span.text-break-word[_ngcontent-%COMP%], .detail-table-wrapper[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]   a.text-break-word[_ngcontent-%COMP%]{word-break:break-word;word-wrap:break-word;height:auto;overflow:hidden;text-overflow:ellipsis;display:block;display:-webkit-box;-webkit-box-orient:vertical;-webkit-line-clamp:3;line-height:32px;max-height:96px}.detail-table-wrapper[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]   .change-tracked-on-content-wrapper[_ngcontent-%COMP%]{display:flex;flex-direction:row;align-items:center;flex-wrap:wrap}.detail-table-wrapper[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]   .change-tracked-on-content-wrapper[_ngcontent-%COMP%]   .change-type-icon[_ngcontent-%COMP%]{width:24px;min-width:24px;height:32px;background-repeat:no-repeat;background-position-y:center;display:inline-block;margin-right:8px}.detail-table-wrapper[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]   .change-tracked-on-content-wrapper[_ngcontent-%COMP%]   .change-type-icon.inserted-icon[_ngcontent-%COMP%]{background-image:url(inserted_icon.7b6131e7ce17ad65.svg)}.detail-table-wrapper[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]   .change-tracked-on-content-wrapper[_ngcontent-%COMP%]   .change-type-icon.updated-icon[_ngcontent-%COMP%]{background-image:url(updated_icon.9794233c3a8525bc.svg)}.detail-table-wrapper[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]   .change-tracked-on-content-wrapper[_ngcontent-%COMP%]   .change-type-icon.deleted-icon[_ngcontent-%COMP%]{background-image:url(deleted_icon.67ca51930344e7b5.svg)}.detail-table-wrapper[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]   .change-tracked-on-content-wrapper[_ngcontent-%COMP%]   .change-tracked-on-value.text-break-word[_ngcontent-%COMP%]{-webkit-line-clamp:2;max-height:64px}.detail-table-wrapper[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]   .column-wrapper[_ngcontent-%COMP%]{height:32px;display:block;white-space:nowrap;text-overflow:ellipsis;overflow:hidden}.detail-table-wrapper[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]   .show-more-less-link[_ngcontent-%COMP%]{display:inline-flex;flex-direction:row;align-items:center;white-space:nowrap}.detail-table-wrapper[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]   .show-more-less-link[_ngcontent-%COMP%]   .show-more-less-icon[_ngcontent-%COMP%]{width:16px;min-width:16px;height:16px;background-repeat:no-repeat;display:inline-block;margin-right:4px}.detail-table-wrapper[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]   .show-more-less-link[_ngcontent-%COMP%]   .show-more-less-icon.show-more-icon[_ngcontent-%COMP%]{background-image:url(show_more_icon.accb9ffdc567a599.svg)}.detail-table-wrapper[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]   .show-more-less-link[_ngcontent-%COMP%]   .show-more-less-icon.show-less-icon[_ngcontent-%COMP%]{background-image:url(show_less_icon.8c21f9075b0fc052.svg)}"],data:{animation:[(0,D.X$)("expand",[(0,D.SB)("collapsed",(0,D.oB)({height:"0px",minHeight:"0"})),(0,D.SB)("expanded",(0,D.oB)({height:"*"})),(0,D.eR)("expanded <=> collapsed",(0,D.jt)("200ms ease-in-out"))])]}});var Ge=i(538),He=i(25833);function $e(a,t){a&1&&e._UZ(0,"tr",18)}const Ke=function(a){return{"even-row":a}};function We(a,t){if(a&1&&e._UZ(0,"tr",19),a&2){const n=t.even;e.Q6J("ngClass",e.VKq(1,Ke,!n))}}function Xe(a,t){a&1&&(e.TgZ(0,"th",20)(1,"label"),e._uU(2),e.ALo(3,"translate"),e.qZA()()),a&2&&(e.xp6(2),e.Oqu(e.lcZ(3,1,"TrackedColumns.CaptionColumn")))}function ze(a,t){if(a&1&&(e.TgZ(0,"td",21)(1,"span"),e._uU(2),e.qZA()()),a&2){const n=t.$implicit;e.xp6(2),e.Oqu(n.caption)}}function et(a,t){a&1&&(e.TgZ(0,"th",20)(1,"label"),e._uU(2),e.ALo(3,"translate"),e.qZA()()),a&2&&(e.xp6(2),e.Oqu(e.lcZ(3,1,"TrackedColumns.NameColumn")))}function tt(a,t){if(a&1&&(e.TgZ(0,"td",21)(1,"span"),e._uU(2),e.qZA()()),a&2){const n=t.$implicit;e.xp6(2),e.Oqu(n.name)}}function nt(a,t){a&1&&e._UZ(0,"th",20)}function at(a,t){if(a&1){const n=e.EpF();e.TgZ(0,"td",22)(1,"button",23),e.NdJ("click",function(){const l=e.CHM(n).$implicit,g=e.oxw(2);return e.KtG(g.onDeleteRow(l))}),e.ALo(2,"translate"),e._UZ(3,"mat-icon",24),e.qZA()()}a&2&&(e.xp6(1),e.Q6J("matTooltip",e.lcZ(2,1,"TrackedColumns.Remove")))}function ot(a,t){if(a&1&&(e.TgZ(0,"table",9),e.YNc(1,$e,1,0,"tr",10),e.YNc(2,We,1,3,"tr",11),e.ynx(3,12),e.YNc(4,Xe,4,3,"th",13),e.YNc(5,ze,3,1,"td",14),e.BQk(),e.ynx(6,15),e.YNc(7,et,4,3,"th",13),e.YNc(8,tt,3,1,"td",14),e.BQk(),e.ynx(9,16),e.YNc(10,nt,1,0,"th",13),e.YNc(11,at,4,3,"td",17),e.BQk(),e.qZA()),a&2){const n=e.oxw();e.Q6J("dataSource",n.tableDataSource),e.xp6(1),e.Q6J("matHeaderRowDef",n.displayedColumns)("matHeaderRowDefSticky",!0),e.xp6(1),e.Q6J("matRowDefColumns",n.displayedColumns)}}function ct(a,t){a&1&&(e.TgZ(0,"div",25)(1,"span"),e._uU(2),e.ALo(3,"translate"),e.qZA()()),a&2&&(e.xp6(2),e.Oqu(e.lcZ(3,1,"TrackedColumns.Blankslate")))}class A extends p.AFp{constructor(t,n,o){super(),this._structureExplorerService=t,this.dialogService=n,this.translateService=o,this.displayedColumns=["caption","name","delete"]}createExcludeColumnFilter(){return t=>!this.data.find(n=>n.uId===t.uId)}addColumns(){const n={providers:[{name:Ge.p.Providers.ENTITY_SCHEMA,options:{entitySchemaUId:this.entitySchemaUId,firstColumnsOnly:!0,displayId:!0,enableBlobDataValueType:!0,excludedItems:this.data.map(o=>o.uId)}}],enableMultiSelection:!0};this._structureExplorerService.show(n).subscribe(o=>{!o||this.onAddRows(...o.map(c=>{const l=c.data;return{caption:l.caption,uId:l.uId,name:l.name}}))})}}A.\u0275fac=function(t){return new(t||A)(e.Y36(Y.vR),e.Y36(f.xA),e.Y36(h.sK))},A.\u0275cmp=e.Xpm({type:A,selectors:[["ts-tracked-columns"]],inputs:{entitySchemaUId:"entitySchemaUId"},features:[e.qOj],decls:16,vars:11,consts:[[1,"detail-wrapper"],[1,"detail-title"],[1,"detail-title-icon",3,"message"],[1,"detail-table-wrapper"],["mat-table","","class","tracked-columns-detail-table",3,"dataSource",4,"ngIf"],["class","detail-blank-slate",4,"ngIf"],[1,"detail-bottom-action"],["mat-button","",1,"default",3,"click"],["svgIcon","add-button"],["mat-table","",1,"tracked-columns-detail-table",3,"dataSource"],["mat-header-row","",4,"matHeaderRowDef","matHeaderRowDefSticky"],["mat-row","",3,"ngClass",4,"matRowDef","matRowDefColumns"],["matColumnDef","caption"],["mat-header-cell","",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["matColumnDef","name"],["matColumnDef","delete"],["mat-cell","","class","delete-column",4,"matCellDef"],["mat-header-row",""],["mat-row","",3,"ngClass"],["mat-header-cell",""],["mat-cell",""],["mat-cell","",1,"delete-column"],["mat-icon-button","",1,"trash-icon",3,"matTooltip","click"],["svgIcon","trash"],[1,"detail-blank-slate"]],template:function(t,n){t&1&&(e.TgZ(0,"div",0)(1,"div",1)(2,"span"),e._uU(3),e.ALo(4,"translate"),e.qZA(),e._UZ(5,"ts-info-tooltip-icon",2),e.ALo(6,"translate"),e.qZA(),e.TgZ(7,"div",3),e.YNc(8,ot,12,4,"table",4),e.YNc(9,ct,4,3,"div",5),e.qZA(),e.TgZ(10,"div",6)(11,"button",7),e.NdJ("click",function(){return n.addColumns()}),e._UZ(12,"mat-icon",8),e.TgZ(13,"span"),e._uU(14),e.ALo(15,"translate"),e.qZA()()()()),t&2&&(e.xp6(3),e.Oqu(e.lcZ(4,5,"TrackedColumns.Title")),e.xp6(2),e.Q6J("message",e.lcZ(6,7,"TrackedColumns.TitleTooltip")),e.xp6(3),e.Q6J("ngIf",!n.isEmpty()),e.xp6(1),e.Q6J("ngIf",n.isEmpty()),e.xp6(5),e.Oqu(e.lcZ(15,9,"TrackedColumns.Add")))},dependencies:[m.mk,m.O5,L.eB,V.Hw,r.ty,r.wO,r.S4,r.t3,r.R3,r.Al,r.L7,r.ML,r.fg,r.Zw,q.Kd,He.B,h.X$],styles:[".detail-wrapper[_ngcontent-%COMP%]{margin:20px 0 0}.detail-wrapper[_ngcontent-%COMP%]   .tracked-columns-detail-table[_ngcontent-%COMP%]   .mat-column-caption[_ngcontent-%COMP%]{width:60%}"]});function lt(a,t){a&1&&e._UZ(0,"ts-mask")}function it(a,t){if(a&1){const n=e.EpF();e.TgZ(0,"button",20),e.NdJ("click",function(){e.CHM(n);const c=e.oxw();return e.KtG(c.save())}),e._uU(1),e.ALo(2,"translate"),e.qZA()}a&2&&(e.xp6(1),e.hij(" ",e.lcZ(2,1,"BasePageComponent.Apply")," "))}function st(a,t){if(a&1){const n=e.EpF();e.TgZ(0,"button",21),e.NdJ("click",function(){e.CHM(n);const c=e.oxw();return e.KtG(c.cancel())}),e._uU(1),e.ALo(2,"translate"),e.qZA()}a&2&&(e.xp6(1),e.hij(" ",e.lcZ(2,1,"BasePageComponent.Cancel")," "))}function gt(a,t){if(a&1){const n=e.EpF();e.TgZ(0,"button",21),e.NdJ("click",function(){e.CHM(n);const c=e.oxw();return e.KtG(c.close())}),e._uU(1),e.ALo(2,"translate"),e.qZA()}a&2&&(e.xp6(1),e.hij(" ",e.lcZ(2,1,"BasePageComponent.Close")," "))}function rt(a,t){if(a&1){const n=e.EpF();e.TgZ(0,"div")(1,"div",22)(2,"ts-date-range",23),e.NdJ("valueChange",function(c){e.CHM(n);const l=e.oxw(2);return e.KtG(l.changeLogFilters.dateRange=c)})("valueChange",function(){e.CHM(n);const c=e.oxw(2);return e.KtG(c.applyFilters())}),e.qZA(),e.TgZ(3,"ts-search-input",24),e.NdJ("valueChange",function(c){e.CHM(n);const l=e.oxw(2);return e.KtG(l.changeLogFilters.searchValue=c)})("valueChange",function(){e.CHM(n);const c=e.oxw(2);return e.KtG(c.applyFilters())}),e.qZA()(),e.TgZ(4,"div",25)(5,"ts-change-log",26),e.NdJ("scrolledToBottom",function(){e.CHM(n);const c=e.oxw(2);return e.KtG(c.onScrollChangeLogToBottom())}),e.qZA()()()}if(a&2){const n=e.oxw(2);e.xp6(2),e.Q6J("value",n.changeLogFilters.dateRange)("maxDate",n.maxDate)("startDateRequired",!0)("endDateRequired",!0),e.xp6(1),e.Q6J("value",n.changeLogFilters.searchValue),e.xp6(2),e.Q6J("data",n.changeLog)("isLoading",n.isLoading)("schemaUId",n.schemaUId)("objectChangeLogMode",!0)}}function dt(a,t){if(a&1&&(e.TgZ(0,"mat-tab",15),e.ALo(1,"translate"),e.YNc(2,rt,6,9,"div",0),e.qZA()),a&2){const n=e.oxw();e.Q6J("label",e.lcZ(1,2,"ObjectChangeLogPage.ViewChangeLogTabCaption")),e.xp6(2),e.Q6J("ngIf",n.changeLog)}}class kt extends null{}class N extends p.neP{constructor(t,n,o){super(t),this.changeLogService=n,this.userProfileService=o,this._isEntireChangeLogLoaded=!1,this.changeLogUserProfileKeyPrefix="ObjectChangeLog_",this.changeLogTabIndex=1,this.changeLogPagingOptions={lastRecordDate:null,orderDirection:s.OrderDirection.Desc,rowCount:20},this.changeLogFilters={searchValue:"",dateRange:{startDate:(0,d.b7Q)(),endDate:(0,d.iXC)()}},this.maxDate=new Date,this.getGtmSchemaName=()=>"ObjectChangeLogPageComponent",this.schemaUId=this.activateRoute.snapshot.params.uId}_processLoadedChangeLog(t,n){t?this.changeLog=n:this.changeLog=this.changeLog.concat(n),n.length<this.changeLogPagingOptions.rowCount&&(this._isEntireChangeLogLoaded=!0)}_loadChangeLog(t){if(t)this._isEntireChangeLogLoaded=!1,this.changeLogPagingOptions.lastRecordDate=null;else{const n=this.changeLog[this.changeLog.length-1].changeTrackedOn;this.changeLogPagingOptions.lastRecordDate=(0,s.toLocalISOString)(n)}this.isLoading=!0,this.changeLogService.getObjectChangeLog(this.schemaUId,this.changeLogPagingOptions,this.changeLogFilters).subscribe(n=>{if(this.isLoading=!1,!n||!n.success){this.changeLog=[],n&&n.errorInfo&&this.openInfoDialog(n.errorInfo.message);return}this._processLoadedChangeLog(t,n.changeLog)})}_getChangeLogProfileKey(){return this.changeLogUserProfileKeyPrefix+this.model.schemaName}_applyChangeLogProfileData(t){t.filters&&(this.changeLogFilters.searchValue=t.filters.searchValue,this.changeLogFilters.dateRange={startDate:(0,d.sGo)(t.filters.startDate),endDate:(0,d.sGo)(t.filters.endDate)})}_loadChangeLogProfileData(){const t=this.userProfileService.getProfile(this._getChangeLogProfileKey()).pipe((0,W.B)());return t.subscribe(n=>{n&&this._applyChangeLogProfileData(n)}),t}_getChangeLogProfileData(){return{filters:{searchValue:this.changeLogFilters.searchValue,startDate:(0,s.toLocalISOString)(this.changeLogFilters.dateRange.startDate),endDate:(0,s.toLocalISOString)(this.changeLogFilters.dateRange.endDate)}}}_saveChangeLogProfileData(){const t=this._getChangeLogProfileData(),n=this.userProfileService.saveProfile(this._getChangeLogProfileKey(),t).pipe((0,W.B)());return n.subscribe(),n}_initPageTitle(t){const n=this.translateInstant("ObjectChangeLogPage.TitleFormat");this.pageTitle=ne.Ld.Format(n,t)}requestPageData(){return this.changeLogService.getObjectChangeLogSettings(this.schemaUId)}getModelFromLoadResponse(t){return t.changeLogSettings}preProcessLoadedPageModel(t){return t=super.preProcessLoadedPageModel(t),this._initPageTitle(t.schemaCaption),t}savePageData(t){return this.changeLogService.saveObjectChangeLogSettings(t)}getDefaultGtmData(){return(0,E.Z)(super.getDefaultGtmData(),{description:{objectName:this.model.schemaName||this.schemaUId}})}getDefaultSaveGtmData(){return(0,E.Z)(super.getDefaultSaveGtmData(),{description:{loggingEnabled:this.model.isTrackChangesInDb?1:0,loggedColumnsNumber:this.model.trackedColumns?this.model.trackedColumns.length:0}})}onTrackingStatusClick(){this.setIsChanged()}onTabChanged(t){t.index===this.changeLogTabIndex&&!this.changeLog&&this._loadChangeLogProfileData().subscribe(()=>{this._loadChangeLog(!0)})}applyFilters(){this._saveChangeLogProfileData(),this._loadChangeLog(!0)}openClearChangeLogSettings(){this.openDialog(k,{data:{entitySchemaUId:this.schemaUId}})}viewChangeLogTabVisible(){var t;return(t=this.modelSnap)===null||t===void 0?void 0:t.isTrackChangesInDb}onScrollChangeLogToBottom(){!this._isEntireChangeLogLoaded&&!this.isLoading&&this._loadChangeLog(!this.changeLog||this.changeLog.length===0)}}N.\u0275fac=function(t){return new(t||N)(e.Y36(e.zs3),e.Y36(u),e.Y36(K.iw))},N.\u0275cmp=e.Xpm({type:N,selectors:[["ts-object-change-log-page"]],features:[e.qOj],decls:30,vars:23,consts:[[4,"ngIf"],[1,"base-page-wrap"],[1,"header"],[1,"pane"],[3,"title"],["class","action-button","mat-flat-button","","color","accent",3,"click",4,"ngIf"],["class","action-button","mat-flat-button","","color","primary",3,"click",4,"ngIf"],["mat-button","",1,"action-button",3,"matMenuTriggerFor"],[1,"mat-select-arrow-wrapper"],[1,"mat-select-arrow"],["menu","matMenu"],["mat-menu-item","",3,"click"],[1,"page-content-wrapper"],[1,"main-content","pane"],["animationDuration","0ms","disableRipple","true",3,"selectedTabChange"],[3,"label"],[1,"is-tracking-toggle",3,"ngModel","click","ngModelChange"],[1,"is-tracking-toggle-text"],[3,"entitySchemaUId","data","isLoading","dataChange"],[3,"label",4,"ngIf"],["mat-flat-button","","color","accent",1,"action-button",3,"click"],["mat-flat-button","","color","primary",1,"action-button",3,"click"],[1,"change-log-filters"],[3,"value","maxDate","startDateRequired","endDateRequired","valueChange"],[3,"value","valueChange"],[1,"change-log"],[3,"data","isLoading","schemaUId","objectChangeLogMode","scrolledToBottom"]],template:function(t,n){if(t&1&&(e.YNc(0,lt,1,0,"ts-mask",0),e.TgZ(1,"div",1)(2,"div",2)(3,"div",3)(4,"ts-header",4),e.YNc(5,it,3,3,"button",5),e.YNc(6,st,3,3,"button",6),e.YNc(7,gt,3,3,"button",6),e.TgZ(8,"button",7)(9,"div"),e._uU(10),e.ALo(11,"translate"),e.qZA(),e.TgZ(12,"div",8),e._UZ(13,"div",9),e.qZA()(),e.TgZ(14,"mat-menu",null,10)(16,"button",11),e.NdJ("click",function(){return n.openClearChangeLogSettings()}),e._uU(17),e.ALo(18,"translate"),e.qZA()()()()(),e.TgZ(19,"div",12)(20,"div",13)(21,"mat-tab-group",14),e.NdJ("selectedTabChange",function(c){return n.onTabChanged(c)}),e.TgZ(22,"mat-tab",15),e.ALo(23,"translate"),e.TgZ(24,"mat-slide-toggle",16),e.NdJ("click",function(){return n.onTrackingStatusClick()})("ngModelChange",function(c){return n.model.isTrackChangesInDb=c}),e.TgZ(25,"span",17),e._uU(26),e.ALo(27,"translate"),e.qZA()(),e.TgZ(28,"ts-tracked-columns",18),e.NdJ("dataChange",function(){return n.setIsChanged()}),e.qZA()(),e.YNc(29,dt,3,4,"mat-tab",19),e.qZA()()()()),t&2){const o=e.MAs(15);e.Q6J("ngIf",n.isLoading),e.xp6(4),e.Q6J("title",n.pageTitle),e.xp6(1),e.Q6J("ngIf",n.saveButtonVisible()),e.xp6(1),e.Q6J("ngIf",n.cancelButtonVisible()),e.xp6(1),e.Q6J("ngIf",n.closeButtonVisible()),e.xp6(1),e.Q6J("matMenuTriggerFor",o),e.xp6(2),e.Oqu(e.lcZ(11,15,"BasePageComponent.Actions")),e.xp6(7),e.hij(" ",e.lcZ(18,17,"ChangeLogSection.ClearChangeLog")," "),e.xp6(5),e.Q6J("label",e.lcZ(23,19,"ObjectChangeLogPage.SettingsTabCaption")),e.xp6(2),e.Q6J("ngModel",n.model.isTrackChangesInDb),e.xp6(2),e.Oqu(e.lcZ(27,21,"ObjectChangeLogPage.EnableObjectTracking")),e.xp6(2),e.Q6J("entitySchemaUId",n.model.schemaUId)("data",n.model.trackedColumns)("isLoading",n.isLoading),e.xp6(1),e.Q6J("ngIf",n.viewChangeLogTabVisible())}},dependencies:[ce.S,X.G,le.J,m.O5,T.JJ,T.On,G.g,L.eB,_.W0,_.tN,_.D8,$.iZ,F.SK,F.R7,x,A,h.X$],styles:[`ts-object-change-log-page .header{position:static!important;height:auto!important}ts-object-change-log-page .page-content-wrapper{margin-top:6px!important}ts-object-change-log-page .page-content-wrapper .is-tracking-toggle{height:32px;margin:14px 0 0}ts-object-change-log-page .page-content-wrapper .is-tracking-toggle .is-tracking-toggle-text{font-size:22px;line-height:normal;font-family:Bpmonline Open Sans Light,serif}ts-object-change-log-page .page-content-wrapper ts-tracked-columns .detail-table-wrapper{max-height:initial!important}ts-object-change-log-page .page-content-wrapper .change-log-filters{height:32px;margin-top:20px;display:flex;flex-direction:row;align-items:center}ts-object-change-log-page .page-content-wrapper .change-log-filters>*:not(:first-child){margin-left:30px}ts-object-change-log-page .page-content-wrapper ts-change-log{display:block}ts-object-change-log-page .page-content-wrapper ts-change-log .detail-table-wrapper{height:calc(100vh - 259px);overflow-y:auto!important}
`],encapsulation:2});function mt(a,t){a&1&&e._UZ(0,"ts-mask")}class j extends p.yhn{constructor(t,n,o,c){super(t),this.activateRoute=n,this.changeLogService=o,this.location=c,this._schemaName="",this.maxDate=new Date,this.changeLogFilters={dateRange:{startDate:(0,d.b7Q)(),endDate:(0,d.iXC)()}},this.getGtmSchemaName=()=>"RecordChangeLogPageComponent",this.schemaUId=n.snapshot.params.uId,this.recordId=n.snapshot.params.recordId}initPageTitle(t){const n=this.translateInstant("ChangeLogPage.TitleFormat");this.pageTitle=ne.Ld.Format(n,t||this.recordId)}createEmptyModel(){return[]}requestPageData(){return this.changeLogService.getRecordChangeLog(this.schemaUId,this.recordId)}preProcessPageLoadingResponse(t){return this._schemaName=t.schemaName||"",this.initPageTitle(t.recordTitle),t}getModelFromLoadResponse(t){return t.changeLog}getDefaultGtmData(){return(0,E.Z)(super.getDefaultGtmData(),{description:{objectName:this._schemaName||this.schemaUId}})}onModelSet(t){super.onModelSet(t),this.applyFilters()}close(){this.window.history.length>1?this.location.back():this.window.close()}applyFilters(){const t=this.changeLogFilters;this.filteredRecords=this.model.filter(n=>n.changeTrackedOn>=t.dateRange.startDate&&n.changeTrackedOn<=t.dateRange.endDate)}}j.\u0275fac=function(t){return new(t||j)(e.Y36(e.zs3),e.Y36(Z.gz),e.Y36(u),e.Y36(m.Ye))},j.\u0275cmp=e.Xpm({type:j,selectors:[["ts-record-change-log-page"]],features:[e.qOj],decls:13,vars:12,consts:[[4,"ngIf"],[1,"base-page-wrap"],[1,"header"],[1,"pane"],[3,"title"],["mat-flat-button","","color","primary",1,"action-button",3,"click"],[1,"page-content-wrapper"],[1,"main-content","pane"],[1,"change-log-filters"],[3,"value","maxDate","startDateRequired","endDateRequired","valueChange"],[3,"data","isLoading","schemaUId"]],template:function(t,n){t&1&&(e.YNc(0,mt,1,0,"ts-mask",0),e.TgZ(1,"div",1)(2,"div",2)(3,"div",3)(4,"ts-header",4)(5,"button",5),e.NdJ("click",function(){return n.close()}),e._uU(6),e.ALo(7,"translate"),e.qZA()()()(),e.TgZ(8,"div",6)(9,"div",7)(10,"div",8)(11,"ts-date-range",9),e.NdJ("valueChange",function(c){return n.changeLogFilters.dateRange=c})("valueChange",function(){return n.applyFilters()}),e.qZA()(),e._UZ(12,"ts-change-log",10),e.qZA()()()),t&2&&(e.Q6J("ngIf",n.isLoading),e.xp6(4),e.Q6J("title",n.pageTitle),e.xp6(2),e.Oqu(e.lcZ(7,10,"ChangeLogPage.Close")),e.xp6(5),e.Q6J("value",n.changeLogFilters.dateRange)("maxDate",n.maxDate)("startDateRequired",!0)("endDateRequired",!0),e.xp6(1),e.Q6J("data",n.filteredRecords)("isLoading",n.isLoading)("schemaUId",n.schemaUId))},dependencies:[ce.S,X.G,m.O5,G.g,L.eB,x,h.X$]});var pt=i(45257),ht=i(41867);function ut(a,t){a&1&&e._UZ(0,"ts-mask")}function Ct(a,t){a&1&&(e.TgZ(0,"div",16),e._UZ(1,"mat-icon",17),e.TgZ(2,"div",18)(3,"span"),e._uU(4),e.ALo(5,"translate"),e.qZA()(),e.TgZ(6,"div",19)(7,"span"),e._uU(8),e.ALo(9,"translate"),e.qZA()()()),a&2&&(e.xp6(4),e.Oqu(e.lcZ(5,2,"BaseSection.BlankslateTitleWithFilters")),e.xp6(4),e.Oqu(e.lcZ(9,4,"BaseSection.BlankslateDescriptionWithFilters")))}class Dt extends null{}class U extends p.bMH{get _linkGenerator(){return t=>`/ChangeLog/${t.schemaUId}`}constructor(t,n){super(t),this.changeLogService=n,this.typeFilter=p.JUd.Section,this.getStaticSearchColumns=()=>["schemaName","schemaCaption"],this.getProfileDataKey=()=>"ChangeLogSection",this.getGtmSchemaName=()=>"ChangeLogSectionComponent"}createEqualityPredicate(){return(t,n)=>t.schemaUId===n.schemaUId}requestPageData(){return this.changeLogService.getChangeLogObjects(this.typeFilter)}getModelFromLoadResponse(t){return t.objectsChangeLogSettings}getProfileData(){const t=super.getProfileData();return t.typeFilter=this.typeFilter,t}applyProfileData(t){super.applyProfileData(t),t.typeFilter&&(this.typeFilter=t.typeFilter)}getDefaultSelectMode(){return"none"}getDefaultDataSchema(){return{columns:[{name:"schemaCaption",caption:this.translateInstant("ChangeLogSection.TitleColumn"),valueType:s.DataValueType.Text,linkGenerator:this._linkGenerator},{name:"schemaName",caption:this.translateInstant("ChangeLogSection.NameColumn"),valueType:s.DataValueType.Text,linkGenerator:this._linkGenerator},{name:"isTrackChangesInDb",caption:this.translateInstant("ChangeLogSection.LoggingEnabledColumn"),valueType:s.DataValueType.Boolean}]}}onTypeFilterChanged(){this.saveUserProfileData(),this.reloadPageData()}openClearChangeLogSettings(){this.openDialog(k)}}U.\u0275fac=function(t){return new(t||U)(e.Y36(e.zs3),e.Y36(u))},U.\u0275cmp=e.Xpm({type:U,selectors:[["ts-change-log-section"]],features:[e.qOj],decls:27,vars:17,consts:[[4,"ngIf"],[1,"base-section-wrap"],[1,"header"],[1,"pane"],[3,"title"],["mat-flat-button","","color","primary",1,"action-button",3,"click"],["mat-button","",1,"action-button",3,"matMenuTriggerFor"],[1,"mat-select-arrow-wrapper"],[1,"mat-select-arrow"],["menu","matMenu"],["mat-menu-item","",3,"click"],[1,"filters"],[3,"value","valueChange"],[1,"table-wrapper"],["sortColumn","schemaCaption"],["class","blank-slate-wrapper",4,"ngIf"],[1,"blank-slate-wrapper"],["svgIcon","table-filter-blank-slate"],[1,"blank-slate-title"],[1,"blank-slate-description"]],template:function(t,n){if(t&1&&(e.YNc(0,ut,1,0,"ts-mask",0),e.TgZ(1,"div",1)(2,"div",2)(3,"div",3)(4,"ts-header",4),e.ALo(5,"translate"),e.TgZ(6,"button",5),e.NdJ("click",function(){return n.close()}),e._uU(7),e.ALo(8,"translate"),e.qZA(),e.TgZ(9,"button",6)(10,"div"),e._uU(11),e.ALo(12,"translate"),e.qZA(),e.TgZ(13,"div",7),e._UZ(14,"div",8),e.qZA()(),e.TgZ(15,"mat-menu",null,9)(17,"button",10),e.NdJ("click",function(){return n.openClearChangeLogSettings()}),e._uU(18),e.ALo(19,"translate"),e.qZA()()(),e.TgZ(20,"div",11)(21,"ts-object-type-filter",12),e.NdJ("valueChange",function(c){return n.typeFilter=c})("valueChange",function(){return n.onTypeFilterChanged()}),e.qZA(),e.TgZ(22,"ts-search-input",12),e.NdJ("valueChange",function(c){return n.searchKey=c}),e.qZA()()()(),e.TgZ(23,"div",13)(24,"div",3),e._UZ(25,"ts-table",14),e.YNc(26,Ct,10,6,"div",15),e.qZA()()()),t&2){const o=e.MAs(16);e.Q6J("ngIf",n.isLoading),e.xp6(4),e.Q6J("title",e.lcZ(5,9,"ChangeLogSection.Title")),e.xp6(3),e.hij(" ",e.lcZ(8,11,"BasePageComponent.Close")," "),e.xp6(2),e.Q6J("matMenuTriggerFor",o),e.xp6(2),e.Oqu(e.lcZ(12,13,"BasePageComponent.Actions")),e.xp6(7),e.hij(" ",e.lcZ(19,15,"ChangeLogSection.ClearChangeLog")," "),e.xp6(3),e.Q6J("value",n.typeFilter),e.xp6(1),e.Q6J("value",n.searchKey),e.xp6(4),e.Q6J("ngIf",n.isEmpty())}},dependencies:[X.G,pt.C,le.J,ht.a,m.O5,G.g,L.eB,V.Hw,_.W0,_.tN,_.D8,h.X$]});const _t=[{path:"",component:U,data:{shouldReuse:!0}},{path:":uId",component:N,data:{shouldReuse:!0}},{path:":uId/:recordId",component:j}];class b{}b.\u0275fac=function(t){return new(t||b)},b.\u0275mod=e.oAB({type:b}),b.\u0275inj=e.cJS({imports:[Z.Bz.forChild(_t),Z.Bz]}),function(){(typeof ngJitMode>"u"||ngJitMode)&&e.kYT(b,{imports:[Z.Bz],exports:[Z.Bz]})}();class v{}v.\u0275fac=function(t){return new(t||v)},v.\u0275mod=e.oAB({type:v}),v.\u0275inj=e.cJS({providers:[O,u,p.Pnv,{provide:p.thQ,useValue:"ChangeLogModule"},Y.vR,Y.Nq,{provide:Y.$A,useClass:se.T,multi:!0}],imports:[b,p.kLW,m.ez,f.Su,T.u5,f._M,J.D8,L.yu,te.Zh,M.FA,C.yj,B.wp,H.x4,V.Ps,_.jT,R.Xo,$.Wd,Q.JX,r.U5,F.Nn,q.AA,f.z8,h.aw]}),function(){(typeof ngJitMode>"u"||ngJitMode)&&e.kYT(v,{declarations:[k,U,x,N,j,A],imports:[b,p.kLW,m.ez,f.Su,T.u5,f._M,J.D8,L.yu,te.Zh,M.FA,C.yj,B.wp,H.x4,V.Ps,_.jT,R.Xo,$.Wd,Q.JX,r.U5,F.Nn,q.AA,f.z8,h.aw]})}();var z=i(31177);const w=new Date,ft=[{schemaUId:"id-1",schemaName:"Account",schemaCaption:"Account",isTrackChangesInDb:!0,trackedColumns:[{caption:"test caption 1",name:"test1",uId:(0,s.generateGuid)()},{caption:"test caption 2",name:"test2",uId:(0,s.generateGuid)()},{caption:"test caption 3",name:"test3",uId:(0,s.generateGuid)()}]},{schemaUId:"id-2",schemaName:"Contact",schemaCaption:"Contact",isTrackChangesInDb:!0,trackedColumns:[{caption:"test caption 11",name:"test11",uId:(0,s.generateGuid)()}]},{schemaUId:"id-3",schemaName:"Lead",schemaCaption:"Lead",isTrackChangesInDb:!0,trackedColumns:[]},{schemaUId:"id-4",schemaName:"BankAccount",schemaCaption:"BankAccount",isTrackChangesInDb:!0,trackedColumns:[]},{schemaUId:"id-5",schemaName:"Contract",schemaCaption:"Contract",isTrackChangesInDb:!1,trackedColumns:[]},{schemaUId:"id-6",schemaName:"Document",schemaCaption:"Document",isTrackChangesInDb:!1,trackedColumns:[]},{schemaUId:"id-7",schemaName:"Case",schemaCaption:"Case",isTrackChangesInDb:!1,trackedColumns:[]},{schemaUId:"id-8",schemaName:"Opportunity",schemaCaption:"Opportunity",isTrackChangesInDb:!1,trackedColumns:[]},{schemaUId:"id-9",schemaName:"BulkEmail",schemaCaption:"BulkEmail",isTrackChangesInDb:!1,trackedColumns:[]},{schemaUId:"id-10",schemaName:"Activity",schemaCaption:"Activity",isTrackChangesInDb:!1,trackedColumns:[]},{schemaUId:"id-11",schemaName:"Account2",schemaCaption:"Account 2",isTrackChangesInDb:!0,trackedColumns:[{caption:"test caption 123",name:"test1",uId:(0,s.generateGuid)()},{caption:"test caption 234",name:"test2",uId:(0,s.generateGuid)()},{caption:"test caption 345",name:"test3",uId:(0,s.generateGuid)()}]},{schemaUId:"id-12",schemaName:"Contact2",schemaCaption:"Contact 2",isTrackChangesInDb:!0,trackedColumns:[]},{schemaUId:"id-13",schemaName:"Lead2",schemaCaption:"Lead 2",isTrackChangesInDb:!0,trackedColumns:[]},{schemaUId:"id-14",schemaName:"BankAccount2",schemaCaption:"BankAccount 2",isTrackChangesInDb:!0,trackedColumns:[]},{schemaUId:"id-15",schemaName:"Contract2",schemaCaption:"Contract 2",isTrackChangesInDb:!1,trackedColumns:[]},{schemaUId:"id-16",schemaName:"Document2",schemaCaption:"Document 2",isTrackChangesInDb:!1,trackedColumns:[]},{schemaUId:"id-17",schemaName:"Case2",schemaCaption:"Case 2",isTrackChangesInDb:!1,trackedColumns:[]},{schemaUId:"id-18",schemaName:"Opportunity2",schemaCaption:"Opportunity 2",isTrackChangesInDb:!1,trackedColumns:[]},{schemaUId:"id-19",schemaName:"BulkEmail2",schemaCaption:"BulkEmail 2",isTrackChangesInDb:!1,trackedColumns:[]},{schemaUId:"id-110",schemaName:"Activity2",schemaCaption:"Activity 2",isTrackChangesInDb:!1,trackedColumns:[]},{schemaUId:"id-21",schemaName:"Account3",schemaCaption:"Account 3",isTrackChangesInDb:!1,trackedColumns:[]},{schemaUId:"id-22",schemaName:"Contact3",schemaCaption:"Contact 3",isTrackChangesInDb:!0,trackedColumns:[]},{schemaUId:"id-23",schemaName:"Lead3",schemaCaption:"Lead 3",isTrackChangesInDb:!0,trackedColumns:[]},{schemaUId:"id-24",schemaName:"BankAccount3",schemaCaption:"BankAccount 3",isTrackChangesInDb:!0,trackedColumns:[]},{schemaUId:"id-25",schemaName:"Contract3",schemaCaption:"Contract 3",isTrackChangesInDb:!1,trackedColumns:[]},{schemaUId:"id-26",schemaName:"Document3",schemaCaption:"Document 3",isTrackChangesInDb:!1,trackedColumns:[]},{schemaUId:"id-27",schemaName:"Case3",schemaCaption:"Case 3",isTrackChangesInDb:!1,trackedColumns:[]},{schemaUId:"id-28",schemaName:"Opportunity3",schemaCaption:"Opportunity 3",isTrackChangesInDb:!1,trackedColumns:[]},{schemaUId:"id-29",schemaName:"BulkEmail3",schemaCaption:"BulkEmail 3",isTrackChangesInDb:!1,trackedColumns:[]},{schemaUId:"id-120",schemaName:"Activity3",schemaCaption:"Activity 3",isTrackChangesInDb:!1,trackedColumns:[]}],ie=[{changeTypeCode:y.Inserted,changeTrackedOn:(0,s.toLocalISOString)(w),changeTrackedBy:{displayValue:"Contact with loooooooo oooooooooooooo ooooooong name"},changeTracked:{displayValue:"Some inserted record",value:"Some-inserted-record-Id"},changedColumns:[{name:"Column 1 with loooooooooooooooooooooo ooooooong name",oldValue:"C1 old value",newValue:"C1 new value",dataValueType:s.DataValueType.Text},{name:"Column 2",oldValue:!0,newValue:!1,dataValueType:s.DataValueType.Boolean},{name:"Column 3",dataValueType:s.DataValueType.DateTime},{name:"Column 4",oldValue:"Old 4",newValue:"Column 4 loooooooo oooooooooooo ooooooooooooooooooooooong new value"},{name:"Column 5",oldValue:"2018-01-12T11:12:37.735",newValue:"2017-02-17T11:12:37.735",dataValueType:s.DataValueType.Date},{name:"Column 6",oldValue:123456789,newValue:98765432109,dataValueType:s.DataValueType.Integer},{name:"Column 7",oldValue:"2018-01-12T11:12:37.735",newValue:"2017-02-17T11:12:37.735",dataValueType:s.DataValueType.DateTime}]},{changeTracked:{displayValue:"Some deleted record without change date and author",value:"Some-deleted-record-without-change-date-and-author-Id"},changeTrackedOn:(0,s.toLocalISOString)((0,d.iXC)()),changeTypeCode:y.Deleted,changedColumns:[{name:"Column A",oldValue:new Date().toJSON(),newValue:new Date().toJSON(),dataValueType:s.DataValueType.Time}]},{changeTypeCode:y.Updated,changeTrackedOn:(0,s.toLocalISOString)(new Date(w.getFullYear(),w.getMonth(),w.getDate(),22,33,44)),changeTrackedBy:{displayValue:"Supervisor 3"},changeTracked:{displayValue:"Some updated record with loooooooooooooooooooooo ooooooong name"},changedColumns:[{name:"Column A",oldValue:!1,newValue:!0,dataValueType:s.DataValueType.Boolean},{name:"Column B",oldValue:"Column B old value",newValue:"Column B new looooooo oooooooooooooooooooooong value"},{name:"Column C",oldValue:3.1415926,newValue:.00031415927,dataValueType:s.DataValueType.Float}]},{changeTracked:{value:"Some-deleted-record-Id"},changeTrackedOn:(0,s.toLocalISOString)(new Date(w.getFullYear(),w.getMonth(),w.getDate()-1)),changeTrackedBy:{displayValue:"Supervisor 4"},changeTypeCode:y.Deleted,changedColumns:[null]}];function bt(a){let t=a==="0"?[]:ie;return t.length>3&&(t=t.concat(Array.from(new Array(20),()=>(0,z.Z)(t[2])))),t}function Tt(a,t,n){let o=a==="0"?[]:(0,z.Z)(ie);if(o.length!==0&&n&&(n.searchValue&&(o=o.filter(l=>l.changeTracked&&l.changeTracked.displayValue&&l.changeTracked.displayValue.indexOf(n.searchValue)!==-1)),n.startDate&&(o=o.filter(l=>(0,d.sGo)(l.changeTrackedOn)>=(0,d.sGo)(n.startDate))),n.endDate&&(o=o.filter(l=>(0,d.sGo)(l.changeTrackedOn)<=(0,d.sGo)(n.endDate)))),t.rowCount&&o.length!==0){const l=t.rowCount-o.length;if(l>0){const g=o.length>1?o[2]:o[0];o=o.concat(Array.from(new Array(l),()=>(0,z.Z)(g)))}}o.sort((l,g)=>{const P=Date.parse(g.changeTrackedOn)-Date.parse(l.changeTrackedOn);return t.orderDirection===s.OrderDirection.Asc?-P:P});const c=Date.parse(t.lastRecordDate);if(c&&o.length>0){const l=Date.parse(o[0].changeTrackedOn)-c;o.forEach(g=>{const P=new Date(Date.parse(g.changeTrackedOn)-l-36e5);g.changeTrackedOn=P.toJSON()})}return o}}}]);
