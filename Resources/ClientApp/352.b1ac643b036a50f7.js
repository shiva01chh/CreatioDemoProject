"use strict";(self.webpackChunkapp_studio_enterprise_system_designer=self.webpackChunkapp_studio_enterprise_system_designer||[]).push([[352],{47352:(L,y,s)=>{s.r(y),s.d(y,{SCHEMA_META_DATA:()=>U,SchemaMetaDataDesignerModule:()=>l});var I=s(55211),C=s(88692),T=s(20092),P=s(17914),k=s(25237),E=s(83331),A=s(15756),J=s(95236),G=s(74817),V=s(7392),z=s(93254),R=s(42094),Y=s(56707),g=s(26522),i=s(65149),m=s(80542),D=s(28262),h=s(55953);class S extends i.iL{constructor(e){super(e),e&&(this.items=e.items.clone(),this.schemaMetaData=e.schemaMetaData,this.readableSchemaMetaData=e.readableSchemaMetaData,this.schemaMetaDataDifferencePackage=e.schemaMetaDataDifferencePackage)}get DefaultName(){return""}findChildrenItem(e){return this.items.findItem(e)}findGroup(e){return e===this.items.uId?this.items:null}isSchemaMetaDataDifference(e){return e.name==="schemaMetaDataDifferencePackage"}getEditableItem(){return this.items.find(e=>e.isEditable)}equal(e){return super.equal(e)&&this.items.equal(e.items)&&this.schemaMetaData===e.schemaMetaData&&this.readableSchemaMetaData===e.readableSchemaMetaData&&this.schemaMetaDataDifferencePackage===e.schemaMetaDataDifferencePackage}clone(){return new S(this)}}var t=s(64537);class d extends i.wY{constructor(e){super(e),this.getSchemaMethodName="GetSchemaMetaData",this.saveSchemaMethodName="SavePackageDifference"}saveSchema(e){const n=this.converter.convertToDto(e);return super.saveSchema(n)}}d.\u0275fac=function(e){return new(e||d)(t.LFG(t.zs3))},d.\u0275prov=t.Yz7({token:d,factory:d.\u0275fac});class u extends D.ml{constructor(e){super(e),this._propertyInfoMap=new Map([["schemaMetaData",{icon:"metadata-structure-icon.svg",translateKey:"MetaDataCaption"}],["readableSchemaMetaData",{icon:"human-readable-metadata-structure-icon.svg",translateKey:"HumanReadableMetaDataCaption"}],["schemaMetaDataDifferencePackage",{icon:"package-difference-metadata-structure-icon.svg",translateKey:"PackageDifferenceMetaDataCaption"}]])}get translationPrefix(){return"SchemaDesigners.MetaDataSchemaDesigner"}_createStructureElement(e,a){const n=this._propertyInfoMap.get(e.name);return super.createSchemaStructureElement({uId:e.uId,caption:this.getTranslation(n.translateKey),icon:n.icon,canSelected:!0,selected:a===0})}getModelStructureData(e){return[...e.items.map((n,f)=>this._createStructureElement(n,f))]}}u.\u0275fac=function(e){return new(e||u)(t.LFG(t.zs3))},u.\u0275prov=t.Yz7({token:u,factory:u.\u0275fac});var x=s(31177);class v extends i.y1{constructor(e){super(e),e&&(this.itemValue=e.itemValue||"",this.isEditable=e.isEditable)}equal(e){return super.equal(e)&&this.itemValue===e.itemValue&&this.isEditable===e.isEditable}clone(){return new v(this)}}class r extends i.gX{constructor(){super(S)}static _convertProperty(e,a,n){return new v({name:a,itemValue:e[a],isEditable:n})}convertToSchema(e){const a=super.createSchema(e),n=[r._convertProperty(e,"schemaMetaData",!1),r._convertProperty(e,"readableSchemaMetaData",!1),r._convertProperty(e,"schemaMetaDataDifferencePackage",!e.isReadOnly)];return a.items=new i.Ts(n),delete a.schemaMetaData,delete a.readableSchemaMetaData,delete a.schemaMetaDataDifferencePackage,a}convertToDto(e){const a=(0,x.Z)(e),n=e.getEditableItem();return a[n.name]=n.itemValue,delete a.items,a}}r.\u0275fac=function(e){return new(e||r)},r.\u0275prov=t.Yz7({token:r,factory:r.\u0275fac});var N=s(40508),b=s(15748),B=s(65304);class p extends D.jn{constructor(e,a,n){super(e),this._apiService=a,this._structureService=n,this._schemaTypeImageMapper=new Map([[h.yG.ProcessUserTaskSchema,"user-task-caption-icon.svg"],[h.yG.SourceCodeSchema,"entity-schema-sourcecode-icon.svg"],[h.yG.ClientUnitSchema,"client-unit-description-icon.svg"],[h.yG.EntitySchema,"entity-schema-caption-icon.svg"],[h.yG.ProcessSchema,"process-schema-icon.svg"],[h.yG.DcmSchema,"dcm-schema-icon.svg"],[h.yG.CampaignSchema,"campaign-schema-icon.svg"]])}get apiDataService(){return this._apiService}get designerStructureService(){return this._structureService}get modelType(){return S}get isDisabledItem(){var e;return!(!((e=this._currentMetaDataItem)===null||e===void 0)&&e.isEditable)}_showMetaDataItem(e){const a=this.model.findChildrenItem(e);this._currentMetaDataItem=a,this.language=this.model.isSchemaMetaDataDifference(a)?null:m.YpL.Json,this.metaDataItemValue=a.itemValue}getGtmSchemaName(){return"SchemaMetaDataDesignerPageComponent"}getSchemaRequestData(){return{schemaUId:super.getSchemaRequestData().schemaUId,packageUId:this._routeParameters.packageUId,schemaType:this._routeParameters.schemaType}}onModelSet(e){if(super.onModelSet(e),!this.isModelLoaded)return;const a=this.model.items.find(n=>n.uId);a&&this._showMetaDataItem(a.uId)}processRouting(){super.processRouting(),this.activateRoute.params.subscribe(e=>{this._routeParameters={schemaType:+e.schemaType,packageUId:e.packageUId}})}onCodeChanged(e){!this._currentMetaDataItem.isEditable||(this._currentMetaDataItem.itemValue=e,this.setIsChanged())}onStructureItemClick(e){this._showMetaDataItem(e.item.uId)}getSchemaTypeImageName(){const e=this.model.schemaType;return this._schemaTypeImageMapper.has(e)?this._schemaTypeImageMapper.get(e):""}}p.\u0275fac=function(e){return new(e||p)(t.Y36(t.zs3),t.Y36(d),t.Y36(u))},p.\u0275cmp=t.Xpm({type:p,selectors:[["ts-schema-meta-data-designer-page"]],features:[t.qOj],decls:9,vars:9,consts:[[1,"base-section-wrap"],[3,"saveButtonVisible","saveClick","cancelClick","closeClick"],[1,"schema-designer-page"],[1,"schema-designer-structure-wrapper","pane"],[3,"dataSource","caption","hideSchemaDescriptorActions","isSearchEnabled","designerTypeCaptionImage","itemClick"],[1,"schema-designer-page-main-content"],[1,"pane"],[1,"schema-designer-page-code-editor-wrapper"],[3,"text","language","readOnly","textChange"]],template:function(e,a){e&1&&(t.TgZ(0,"div",0)(1,"ts-schema-designer-page-header",1),t.NdJ("saveClick",function(){return a.save()})("cancelClick",function(){return a.cancel()})("closeClick",function(){return a.close()}),t.qZA(),t.TgZ(2,"div",2)(3,"div",3)(4,"ts-schema-designer-structure",4),t.NdJ("itemClick",function(f){return a.onStructureItemClick(f)}),t.qZA()(),t.TgZ(5,"div",5)(6,"div",6)(7,"div",7)(8,"ts-code-editor",8),t.NdJ("textChange",function(f){return a.onCodeChanged(f)}),t.qZA()()()()()()),e&2&&(t.xp6(1),t.Q6J("saveButtonVisible",a.saveButtonVisible()),t.xp6(3),t.Q6J("dataSource",a.schemaStructure)("caption",a.model.name)("hideSchemaDescriptorActions",!0)("isSearchEnabled",!1)("designerTypeCaptionImage",a.getSchemaTypeImageName()),t.xp6(4),t.Q6J("text",a.metaDataItemValue)("language",a.language)("readOnly",a.isDisabledItem))},dependencies:[N.w,b.h,B.a],encapsulation:2});var M=s(7976);const F=[{path:":uId/:schemaType/:packageUId",component:p}];class o{}o.\u0275fac=function(e){return new(e||o)},o.\u0275mod=t.oAB({type:o}),o.\u0275inj=t.cJS({imports:[M.Bz.forChild(F),M.Bz]}),function(){(typeof ngJitMode>"u"||ngJitMode)&&t.kYT(o,{imports:[M.Bz],exports:[M.Bz]})}();class l{}l.\u0275fac=function(e){return new(e||l)},l.\u0275mod=t.oAB({type:l}),l.\u0275inj=t.cJS({providers:[m.Pnv,g.xA,{provide:m.thQ,useValue:"SchemaMetaDataDesignerModule"},d,u,(0,i.Ap)("SchemaMetaDataService.svc"),{provide:i.Jk,useClass:r},g.Bm,{provide:D.ZS,useFactory:()=>null}],imports:[m.kLW,Y.aw,m.Y05,g._M,A.yu,E.Ps,J.wp,G.x4,z.uw,P.To,V.gR,k.N6,R.SJ,g.Su,T.u5,D.Z_,C.ez,o,I.nZ,i.JI]}),function(){(typeof ngJitMode>"u"||ngJitMode)&&t.kYT(l,{declarations:[p],imports:[m.kLW,Y.aw,m.Y05,g._M,A.yu,E.Ps,J.wp,G.x4,z.uw,P.To,V.gR,k.N6,R.SJ,g.Su,T.u5,D.Z_,C.ez,o,I.nZ,i.JI]})}();var Z=s(75378);const U={body:"",uId:(0,Z.generateGuid)(),name:"TestSchema",isReadOnly:!1,schemaMetaData:"schemaMetaData",readableSchemaMetaData:"readableSchemaMetaData",schemaMetaDataDifferencePackage:"schemaMetaDataDifferencePackage",isPackageForeign:!1,package:{isChanged:!1,isLocked:!1,name:"TestPackageName",uId:(0,Z.generateGuid)()}}}}]);
