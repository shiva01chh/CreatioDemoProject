"use strict";(self.webpackChunkapp_studio_enterprise_system_designer=self.webpackChunkapp_studio_enterprise_system_designer||[]).push([[94],{78094:(wt,_e,l)=>{l.r(_e),l.d(_e,{PingResponseMock:()=>Zt,ProjectSectionMock:()=>Dt,TenantInfoResponseMock:()=>Et,TracingRoutingModule:()=>v,TrackingGoalMock:()=>St,TrackingModule:()=>G,TrackingResourceMock:()=>At});var g=l(88692),e=l(64537);/**
 * @license
 * Copyright Google LLC All Rights Reserved.
 *
 * Use of this source code is governed by an MIT-style license that can be
 * found in the LICENSE file at https://angular.io/license
 */class Ae{constructor(t,n){this._document=n;const i=this._textarea=this._document.createElement("textarea"),r=i.style;r.position="fixed",r.top=r.opacity="0",r.left="-999em",i.setAttribute("aria-hidden","true"),i.value=t,i.readOnly=!0,this._document.body.appendChild(i)}copy(){const t=this._textarea;let n=!1;try{if(t){const i=this._document.activeElement;t.select(),t.setSelectionRange(0,t.value.length),n=this._document.execCommand("copy"),i&&i.focus()}}catch{}return n}destroy(){const t=this._textarea;t&&(t.remove(),this._textarea=void 0)}}/**
 * @license
 * Copyright Google LLC All Rights Reserved.
 *
 * Use of this source code is governed by an MIT-style license that can be
 * found in the LICENSE file at https://angular.io/license
 */class P{constructor(t){this._document=t}copy(t){const n=this.beginCopy(t),i=n.copy();return n.destroy(),i}beginCopy(t){return new Ae(t,this._document)}}P.\u0275fac=function(t){return new(t||P)(e.LFG(g.K0))},P.\u0275prov=e.Yz7({token:P,factory:P.\u0275fac,providedIn:"root"}),function(){(typeof ngDevMode>"u"||ngDevMode)&&e.zlt(P,[{type:e.GSi,args:[{providedIn:"root"}]}],function(){return[{type:void 0,decorators:[{type:e.tBr,args:[g.K0]}]}]},null)}();/**
 * @license
 * Copyright Google LLC All Rights Reserved.
 *
 * Use of this source code is governed by an MIT-style license that can be
 * found in the LICENSE file at https://angular.io/license
 */const Ce=new e.OlP("CDK_COPY_TO_CLIPBOARD_CONFIG");class O{constructor(t,n,i){this._clipboard=t,this._ngZone=n,this.text="",this.attempts=1,this.copied=new e.vpe,this._pending=new Set,i&&i.attempts!=null&&(this.attempts=i.attempts)}copy(t=this.attempts){if(t>1){let n=t;const i=this._clipboard.beginCopy(this.text);this._pending.add(i);const r=()=>{const c=i.copy();!c&&--n&&!this._destroyed?this._currentTimeout=this._ngZone.runOutsideAngular(()=>setTimeout(r,1)):(this._currentTimeout=null,this._pending.delete(i),i.destroy(),this.copied.emit(c))};r()}else this.copied.emit(this._clipboard.copy(this.text))}ngOnDestroy(){this._currentTimeout&&clearTimeout(this._currentTimeout),this._pending.forEach(t=>t.destroy()),this._pending.clear(),this._destroyed=!0}}O.\u0275fac=function(t){return new(t||O)(e.Y36(P),e.Y36(e.R0b),e.Y36(Ce,8))},O.\u0275dir=e.lG2({type:O,selectors:[["","cdkCopyToClipboard",""]],hostBindings:function(t,n){t&1&&e.NdJ("click",function(){return n.copy()})},inputs:{text:["cdkCopyToClipboard","text"],attempts:["cdkCopyToClipboardAttempts","attempts"]},outputs:{copied:"cdkCopyToClipboardCopied"}}),function(){(typeof ngDevMode>"u"||ngDevMode)&&e.zlt(O,[{type:e.Xek,args:[{selector:"[cdkCopyToClipboard]",host:{"(click)":"copy()"}}]}],function(){return[{type:P},{type:e.R0b},{type:void 0,decorators:[{type:e.FiY},{type:e.tBr,args:[Ce]}]}]},{text:[{type:e.IIB,args:["cdkCopyToClipboard"]}],attempts:[{type:e.IIB,args:["cdkCopyToClipboardAttempts"]}],copied:[{type:e.r_U,args:["cdkCopyToClipboardCopied"]}]})}();/**
 * @license
 * Copyright Google LLC All Rights Reserved.
 *
 * Use of this source code is governed by an MIT-style license that can be
 * found in the LICENSE file at https://angular.io/license
 */class y{}y.\u0275fac=function(t){return new(t||y)},y.\u0275mod=e.oAB({type:y}),y.\u0275inj=e.cJS({}),function(){(typeof ngDevMode>"u"||ngDevMode)&&e.zlt(y,[{type:e.LVF,args:[{declarations:[O],exports:[O]}]}],null,null)}();/**
 * @license
 * Copyright Google LLC All Rights Reserved.
 *
 * Use of this source code is governed by an MIT-style license that can be
 * found in the LICENSE file at https://angular.io/license
 *//**
 * @license
 * Copyright Google LLC All Rights Reserved.
 *
 * Use of this source code is governed by an MIT-style license that can be
 * found in the LICENSE file at https://angular.io/license
 */var o=l(20092),ve=l(46438),pe=l(17914),B=l(83331),re=l(79510),D=l(15756),J=l(74817),Te=l(72990),se=l(93254),le=l(62549),Pe=l(73514),ce=l(97355),Oe=l(55799),ye=l(56558),p=l(56707),u=l(26522),be=l(11465),_=l(69403),f=l(80542),xe=l(41867);class A{constructor(){this.isExpanded=!0,this.addClicked=new e.vpe}onAddClick(t){this.addClicked.emit(t)}toggleExpansionViewModel(){this.isExpanded=!this.isExpanded}}A.\u0275fac=function(t){return new(t||A)},A.\u0275cmp=e.Xpm({type:A,selectors:[["ts-base-detail"]],inputs:{header:"header",isExpanded:"isExpanded",tableEventHandlers:"tableEventHandlers",dataSource:"dataSource",dataSchema:"dataSchema"},outputs:{addClicked:"addClicked"},decls:9,vars:7,consts:[[1,"header-wrapper"],[1,"expander",3,"click"],[3,"svgIcon"],[1,"header"],["svgIcon","add-button",1,"add-button",3,"click"],[3,"hideToggle","expanded","opened","closed"],[1,"page-tab"],[3,"dataSchema","dataSource","eventHandlers"]],template:function(t,n){t&1&&(e.TgZ(0,"div",0)(1,"div",1),e.NdJ("click",function(){return n.toggleExpansionViewModel()}),e._UZ(2,"mat-icon",2),e.TgZ(3,"span",3),e._uU(4),e.qZA()(),e.TgZ(5,"mat-icon",4),e.NdJ("click",function(r){return n.onAddClick(r)}),e.qZA()(),e.TgZ(6,"mat-expansion-panel",5),e.NdJ("opened",function(){return n.isExpanded=!0})("closed",function(){return n.isExpanded=!1}),e.TgZ(7,"div",6),e._UZ(8,"ts-table",7),e.qZA()()),t&2&&(e.xp6(2),e.Q6J("svgIcon","detail-"+(n.isExpanded?"open":"closed")),e.xp6(2),e.hij(" ",n.header," "),e.xp6(2),e.Q6J("hideToggle",!0)("expanded",n.isExpanded),e.xp6(2),e.Q6J("dataSchema",n.dataSchema)("dataSource",n.dataSource)("eventHandlers",n.tableEventHandlers))},dependencies:[B.Hw,pe.ib,xe.a],styles:[".header-wrapper[_ngcontent-%COMP%]{display:flex;flex-direction:row;align-items:center;margin:15px 15px 0}.header-wrapper[_ngcontent-%COMP%]   .expander[_ngcontent-%COMP%]{display:flex;flex-direction:row;align-items:center;cursor:pointer}.header-wrapper[_ngcontent-%COMP%]   .expander[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]{color:#4e7bd8;margin-left:5px;margin-right:5px}.header-wrapper[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{cursor:pointer;height:16px!important;width:16px!important;margin-left:10px;margin-right:10px}mat-expansion-panel[_ngcontent-%COMP%]{box-shadow:none!important}"],changeDetection:0});var Se=l(51101);class b extends f.vau{constructor(t){super(),this._translateService=t,this._baseActionItems=[{caption:this._translateService.instant("Tracking.BaseItemMenuComponent.Edit"),code:"edit"},{caption:this._translateService.instant("Tracking.BaseItemMenuComponent.Delete"),code:"delete"}],this.getRegisteredEvents=()=>[{name:"actionClick",dataType:String}]}onActionClick(t){this.fireEvent("actionClick",t)}getActions(){return this._baseActionItems}}b.\u0275fac=function(t){return new(t||b)(e.Y36(p.sK))},b.\u0275cmp=e.Xpm({type:b,selectors:[["ts-base-item-menu"]],features:[e.qOj],decls:2,vars:1,consts:[[1,"actions-container"],[3,"menuItems","menuItemClick"]],template:function(t,n){t&1&&(e.TgZ(0,"div",0)(1,"ts-compact-actions-menu",1),e.NdJ("menuItemClick",function(r){return n.onActionClick(r)}),e.qZA()()),t&2&&(e.xp6(1),e.Q6J("menuItems",n.getActions()))},dependencies:[Se.H],encapsulation:2});var C=l(14091);function Ee(a,t){if(a&1){const n=e.EpF();e.TgZ(0,"span",5),e.NdJ("@successTextAnimation.done",function(){e.CHM(n);const r=e.oxw();return e.KtG(r.hideMessage())}),e._uU(1),e.ALo(2,"translate"),e.qZA()}a&2&&(e.Q6J("@successTextAnimation",void 0),e.xp6(1),e.hij(" ",e.lcZ(2,2,"Tracking.CodePane.OnCopiedToClipboard")," "))}class S{showMessage(){this.isSuccessMessageVisible=!0}hideMessage(){this.isSuccessMessageVisible=!1}}S.\u0275fac=function(t){return new(t||S)},S.\u0275cmp=e.Xpm({type:S,selectors:[["ts-code-pane"]],inputs:{scriptMessage:"scriptMessage"},decls:8,vars:6,consts:[[1,"script-pane"],[1,"script-text-block"],[1,"action-button-block"],["tsCopyClipboard","","mat-flat-button","","color","primary",1,"action-button",3,"cdkCopyToClipboard","cdkCopyToClipboardCopied"],["class","success-text",4,"ngIf"],[1,"success-text"]],template:function(t,n){t&1&&(e.TgZ(0,"div",0)(1,"div",1),e._uU(2),e.qZA(),e.TgZ(3,"div",2)(4,"button",3),e.NdJ("cdkCopyToClipboardCopied",function(){return n.showMessage()}),e._uU(5),e.ALo(6,"translate"),e.qZA(),e.YNc(7,Ee,3,4,"span",4),e.qZA()()),t&2&&(e.xp6(2),e.hij(" ",n.scriptMessage," "),e.xp6(2),e.Q6J("cdkCopyToClipboard",n.scriptMessage),e.xp6(1),e.hij(" ",e.lcZ(6,4,"Tracking.CodePane.CopyToClipboard")," "),e.xp6(2),e.Q6J("ngIf",n.isSuccessMessageVisible))},dependencies:[g.O5,D.eB,O,p.X$],styles:[".script-pane[_ngcontent-%COMP%]   .script-text-block[_ngcontent-%COMP%]{padding:1rem;border:1px solid #999;display:block;height:150px;overflow:auto}.script-pane[_ngcontent-%COMP%]   .action-button-block[_ngcontent-%COMP%]{margin-top:.5rem}.script-pane[_ngcontent-%COMP%]   .action-button-block[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{margin-left:1rem;color:#22ac14}"],data:{animation:[(0,C.X$)("successTextAnimation",[(0,C.eR)(":enter",[(0,C.oB)({opacity:0}),(0,C.jt)("0.3s ease-in",(0,C.oB)({opacity:1}))]),(0,C.eR)(":leave",[(0,C.oB)({opacity:1}),(0,C.jt)("0.4s 2s ease-in",(0,C.oB)({opacity:0}))])])]}});var s=l(75378),d=l(36619),m=l(33569);class ue{}class ne{}class de extends ue{constructor(){super(),this.owner=new ne}delete(){this.isDeleted=!0}}class me extends ue{constructor(t){super(),Object.assign(this,t)}delete(){this.isDeleted=!0}}class Ie extends ue{constructor(){super(),this.resource=new me}delete(){this.isDeleted=!0}}var Y;(function(a){a[a.SAVE=0]="SAVE",a[a.CANCEL=1]="CANCEL"})(Y||(Y={}));var E;(function(a){a[a.EDIT=0]="EDIT",a[a.ADD=1]="ADD"})(E||(E={}));class ge{constructor(t){Object.assign(this,t)}}class Q{constructor(t){Object.assign(this,t)}static fromObject(t){return new Q(t)}static fromString(t){return(0,m.Z)(t)?new Q:new Q(JSON.parse(t))}toString(){return JSON.stringify(this)}}class w{createEntity(){return new ne}getEntity(t){const n=t.Contact,i=this.createEntity();return i.id=n.value,i.name=n.displayValue,i}getEntityColumns(t){return[new d._H7("Id",t.id,s.DataValueType.Guid),new d._H7("Name",t.name,s.DataValueType.Text),new d._H7("Contact",t.name,s.DataValueType.Lookup)]}}w.\u0275fac=function(t){return new(t||w)},w.\u0275prov=e.Yz7({token:w,factory:w.\u0275fac});class F{createEntity(){return new Ie}getEntity(t){const n=this.createEntity();return n.id=t.Id,n.name=t.Name,(0,m.Z)(t.Resource)||(n.resource.id=t.Resource.value,n.resource.name=t.Resource.displayValue),n.isActive=t.IsActive,n.isDeleted=t.IsDeleted,n.cost=t.Cost,n.useEventCost=t.UseEventCost,n.settings=Q.fromString(t.Settings),n.createdOn=t.CreatedOn,n.modifiedOn=t.ModifiedOn,n.useEventCost===!0&&(n.cost=null),n}getEntityColumns(t){return[new d._H7("Id",t.id,s.DataValueType.Guid),new d._H7("Name",t.name,s.DataValueType.Text),new d._H7("Resource",t.hasOwnProperty("resource")&&!(0,m.Z)(t.resource)?t.resource.id:void 0,s.DataValueType.Lookup),new d._H7("IsActive",t.isActive,s.DataValueType.Boolean),new d._H7("IsDeleted",t.isDeleted,s.DataValueType.Boolean),new d._H7("Cost",t.cost,s.DataValueType.Float),new d._H7("UseEventCost",t.useEventCost,s.DataValueType.Boolean),new d._H7("Settings",t.hasOwnProperty("settings")&&!(0,m.Z)(t.settings)?t.settings.toString():void 0,s.DataValueType.Text),new d._H7("CreatedOn",t.createdOn,s.DataValueType.DateTime),new d._H7("ModifiedOn",t.modifiedOn,s.DataValueType.DateTime)]}}F.\u0275fac=function(t){return new(t||F)},F.\u0275prov=e.Yz7({token:F,factory:F.\u0275fac});class V{createEntity(){return new de}getEntity(t){const n=this.createEntity();return n.id=t.Id,n.name=t.Name,(0,m.Z)(t.Owner)||(n.owner.id=t.Owner.value,n.owner.name=t.Owner.displayValue),n.description=t.Description,n.isDeleted=t.IsDeleted,n.createdOn=t.CreatedOn,n.modifiedOn=t.ModifiedOn,n}getEntityColumns(t){return[new d._H7("Id",t.id,s.DataValueType.Guid),new d._H7("Name",t.name,s.DataValueType.Text),new d._H7("Description",t.description,s.DataValueType.Text),new d._H7("Owner",t.hasOwnProperty("owner")&&!(0,m.Z)(t.owner)?t.owner.id:void 0,s.DataValueType.Lookup),new d._H7("IsDeleted",t.isDeleted,s.DataValueType.Boolean),new d._H7("CreatedOn",t.createdOn,s.DataValueType.DateTime),new d._H7("ModifiedOn",t.modifiedOn,s.DataValueType.DateTime)]}}V.\u0275fac=function(t){return new(t||V)},V.\u0275prov=e.Yz7({token:V,factory:V.\u0275fac});class N{createEntity(){return new me}getEntity(t){const n=this.createEntity();return n.id=t.Id,n.name=t.Name,n.project=new de,!(0,m.Z)(t.Project)&&!(0,m.Z)(t.Project.value)&&(n.project.id=t.Project.value,n.project.name=t.Project.displayValue),n.isActive=t.IsActive,n.isDeleted=t.IsDeleted,n.source=t.Source,n.createdOn=t.CreatedOn,n.modifiedOn=t.ModifiedOn,n}getEntityColumns(t){return[new d._H7("Id",t.id,s.DataValueType.Guid),new d._H7("Name",t.name,s.DataValueType.Text),new d._H7("Project",t.hasOwnProperty("project")&&!(0,m.Z)(t.project)?t.project.id:void 0,s.DataValueType.Lookup),new d._H7("IsActive",t.isActive,s.DataValueType.Boolean),new d._H7("IsDeleted",t.isDeleted,s.DataValueType.Boolean),new d._H7("Source",t.source,s.DataValueType.Text),new d._H7("CreatedOn",t.createdOn,s.DataValueType.DateTime),new d._H7("ModifiedOn",t.modifiedOn,s.DataValueType.DateTime)]}}N.\u0275fac=function(t){return new(t||N)},N.\u0275prov=e.Yz7({token:N,factory:N.\u0275fac});class x extends _.UE{constructor(t,n,i){super(t,n,i),this.isDeletedColumn="IsDeleted",this.excludedColumnsFromUpdate=["CreatedOn","ModifiedOn"],this.entitySchemaName="TrackingProject"}_filterColumns(t,n){return t.filter(i=>n.indexOf(i.path)===-1)}getUpdateQuery(t){const n=this.entityConverter.getEntityColumns(t),i=this._filterColumns(n,this.excludedColumnsFromUpdate),r=new s.UpdateQuery(this.entitySchemaName);return i.forEach(c=>{r.addColumn(c.path,c.value,c.type)}),r.filters.addSchemaColumnFilterWithParameter(s.ComparisonType.Equal,"Id",t.id),r}createGetAllItemsEsq(){const t=super.createGetAllItemsEsq();return t.filters.addSchemaColumnFilterWithParameter(s.ComparisonType.Equal,this.isDeletedColumn,!1),t}deleteItem(t){return t.delete(),this.updateItem(t)}}x.\u0275fac=function(t){return new(t||x)(e.LFG(_.oq),e.LFG(p.sK),e.LFG(V))},x.\u0275prov=e.Yz7({token:x,factory:x.\u0275fac});var we=l(35732);class Ft{}class Vt{}class I{constructor(t){this._httpClient=t,this._appInstallerServiceUrl="rest/TrackingTenantService/"}pingTenantLiveness(){return this._httpClient.post(this._appInstallerServiceUrl+"PingTenant",{})}getTenantInfo(){return this._httpClient.post(this._appInstallerServiceUrl+"GetInfo",{})}}I.\u0275fac=function(t){return new(t||I)(e.LFG(we.eN))},I.\u0275prov=e.Yz7({token:I,factory:I.\u0275fac});class q{get tanantLivenessDescription(){return this._getStatusLczKey(this.tenantLivenessStatus)}constructor(t){this._trackingTenantService=t,this._statusMap={},this.tenantLivenessStatus=u.nk.CHECKING,this._statusMap[u.nk.CHECKING]="Checking",this._statusMap[u.nk.CONNECTED]="Connected",this._statusMap[u.nk.DISCONNECTED]="Disconnected",this._statusMap[u.nk.WARNING]="Warning"}_getStatusLczKey(t){const n="Tracking.ConnectionDescription.",i=this._statusMap[t];if(i===void 0)throw new Error("Invalid indicator status");return n+i}checkTenantLiveness(){this._trackingTenantService.pingTenantLiveness().subscribe(t=>{this.tenantLivenessStatus=t.PingTenantResult.Status;const n=t.PingTenantResult.ErrorMessage;n!==""&&n!==null&&n!==void 0&&console.log(t.PingTenantResult.ErrorMessage)},t=>{this.tenantLivenessStatus=u.nk.DISCONNECTED,console.log(t.message)})}}q.\u0275fac=function(t){return new(t||q)(e.LFG(I))},q.\u0275prov=e.Yz7({token:q,factory:q.\u0275fac});var j=l(7976),he=l(60527),Fe=l(93534);function Ve(a,t){a&1&&(e.TgZ(0,"div",12),e._UZ(1,"mat-icon",13),e.TgZ(2,"div",14)(3,"span",15),e._uU(4),e.ALo(5,"translate"),e.qZA()(),e.TgZ(6,"div",16)(7,"span",17),e._uU(8),e.ALo(9,"translate"),e.qZA()()()),a&2&&(e.xp6(4),e.hij(" ",e.lcZ(5,2,"Tracking.ProjectsSection.BlankSlate.Title")," "),e.xp6(4),e.hij(" ",e.lcZ(9,4,"Tracking.ProjectsSection.BlankSlate.Description")," "))}const Ne=function(a){return{actionClick:a}},qe=function(a){return{itemActions:a}};class H extends f.bMH{get _projectLinkGenerator(){return t=>`project/${t.id}`}constructor(t,n,i,r,c){super(t),this.injector=t,this.userInfo=n,this.projectSectionService=i,this.livenessService=r,this.router=c,this.getStaticSearchColumns=()=>["name","owner","description","createdOn","modifiedOn"],this.getProfileDataKey=()=>"ProjectsSettingsProfile",this.getGtmSchemaName=()=>"ProjectSetupSection"}_initUserCulture(){this.userCulture=this.userInfo.cultureInfo.sysCultureName}_formatDate(t){return(0,m.Z)(t)?"":new Date(t).toLocaleString(this.userCulture)}_getOwnerName(t){return(0,m.Z)(t)?"":t.name}_deleteProject(t){this.projectSectionService.deleteItem(t).subscribe(n=>{n.success?this.reloadPageData():this.dialogService.openInfoDialog(n.errorInfo.message).subscribe()})}_deleteProjectConfirmation(t){const n=this.translateInstant("BaseSection.DeleteRecordConfirmation");this.dialogService.openConfirmationDialog(n).subscribe(i=>{i===u.Zz.result&&this._deleteProject(t)})}requestPageData(){return this.projectSectionService.getItems()}getModelFromLoadResponse(t){return t.result}getDefaultSelectMode(){return"none"}getDefaultDataSchema(){return{columns:[{name:"name",caption:this.translateInstant("Tracking.ProjectsSection.Columns.Name"),valueType:s.DataValueType.Text,linkGenerator:this._projectLinkGenerator},{name:"owner",caption:this.translateInstant("Tracking.ProjectsSection.Columns.Owner"),valueType:s.DataValueType.Text,formatter:this._getOwnerName.bind(this),sortingDataAccessor:t=>this._getOwnerName(t.owner)},{name:"description",caption:this.translateInstant("Tracking.ProjectsSection.Columns.Description"),valueType:s.DataValueType.Text},{name:"createdOn",caption:this.translateInstant("Tracking.ProjectsSection.Columns.CreatedOn"),valueType:s.DataValueType.DateTime,formatter:this._formatDate.bind(this)},{name:"modifiedOn",caption:this.translateInstant("Tracking.ProjectsSection.Columns.ModifiedOn"),valueType:s.DataValueType.DateTime,formatter:this._formatDate.bind(this)},{name:"itemActions",cellComponentClass:b}]}}addProjectPage(){this.router.navigate(["Tracking/project/new"])}ngOnInit(){this._initUserCulture(),super.ngOnInit(),this.livenessService.checkTenantLiveness()}onItemAction(t,n){switch(n){case"delete":this._deleteProjectConfirmation(t);break;case"edit":this.router.navigate(["Tracking/project/"+t.id]);break;default:console.error("invalid action")}}}H.\u0275fac=function(t){return new(t||H)(e.Y36(e.zs3),e.Y36(d.aoG),e.Y36(x),e.Y36(q),e.Y36(j.F0))},H.\u0275cmp=e.Xpm({type:H,selectors:[["ts-project-section"]],features:[e.qOj],decls:17,vars:16,consts:[[1,"base-section-wrap"],[1,"header"],[1,"pane"],[3,"title"],[1,"header-button-wrapper"],["mat-button","","mat-flat-button","","color","accent",1,"action-button",3,"click"],[1,"header-indicator-wrapper"],[3,"status","description"],[1,"flex-wrapper"],[1,"table-wrapper"],["sortColumn","name","headerSticky","true",3,"eventHandlers"],["class","blank-slate-wrapper","data-qa","project-blank-slate-wrapper",4,"ngIf"],["data-qa","project-blank-slate-wrapper",1,"blank-slate-wrapper"],["svgIcon","empty-info"],[1,"blank-slate-title"],["data-qa","project-blank-slate-title"],[1,"blank-slate-description"],["data-qa","project-blank-slate-description"]],template:function(t,n){t&1&&(e.TgZ(0,"div",0)(1,"div",1)(2,"div",2)(3,"ts-header",3),e.ALo(4,"translate"),e.TgZ(5,"div",4)(6,"button",5),e.NdJ("click",function(){return n.addProjectPage()}),e._uU(7),e.ALo(8,"translate"),e.qZA()(),e.TgZ(9,"div",6),e._UZ(10,"ts-connection-indicator",7),e.ALo(11,"translate"),e.qZA()()()(),e.TgZ(12,"div",8)(13,"div",9)(14,"div",2),e._UZ(15,"ts-table",10),e.YNc(16,Ve,10,6,"div",11),e.qZA()()()()),t&2&&(e.xp6(3),e.Q6J("title",e.lcZ(4,6,"Tracking.ProjectsSection.Title")),e.xp6(4),e.hij(" ",e.lcZ(8,8,"Tracking.ProjectsSection.Add")," "),e.xp6(3),e.Q6J("status",n.livenessService.tenantLivenessStatus)("description",e.lcZ(11,10,n.livenessService.tanantLivenessDescription)),e.xp6(5),e.Q6J("eventHandlers",e.VKq(14,qe,e.VKq(12,Ne,n.onItemAction.bind(n)))),e.xp6(1),e.Q6J("ngIf",n.isEmpty()))},dependencies:[g.O5,D.eB,B.Hw,he.G,xe.a,Fe.x,p.X$],styles:[".header[_ngcontent-%COMP%]   ts-header[_ngcontent-%COMP%]   .header-indicator-wrapper[_ngcontent-%COMP%]{margin-top:14px}.header[_ngcontent-%COMP%]   ts-header[_ngcontent-%COMP%]     .content-wrapper{flex-direction:column!important}  .mat-column-description{width:40%!important}  .mat-icon-button{width:36px}  .mat-icon-button *{visibility:hidden}  .mat-icon-button:hover *{visibility:visible}  .mat-icon-button .mat-icon{width:16px;height:16px}"]});var ae=l(31177),je=l(51927),ie=l(27969);class L extends _.UE{constructor(t,n,i){super(t,n,i),this.entitySchemaName="SysAdminUnit"}createGetAllItemsEsq(){const t=super.createGetAllItemsEsq();return t.filters.addSchemaColumnFilterWithParameter(s.ComparisonType.Equal,"SysAdminUnitTypeValue",d.EiC.User),t.filters.addSchemaColumnFilterWithParameter(s.ComparisonType.Equal,"Active",1),t.filters.addSchemaColumnFilterWithParameter(s.ComparisonType.Equal,"ConnectionType",0),t}}L.\u0275fac=function(t){return new(t||L)(e.LFG(_.oq),e.LFG(p.sK),e.LFG(w))},L.\u0275prov=e.Yz7({token:L,factory:L.\u0275fac});var Me=l(33568);class R extends _.UE{constructor(t,n,i){super(t,n,i),this.resourceIdColumn="Resource",this.isDeletedColumn="IsDeleted",this.excludedColumnsFromUpdate=["CreatedOn","ModifiedOn"],this.entitySchemaName="TrackingGoal"}_getItemsByResourceIdEsq(t){const n=this.createGetAllItemsEsq();return n.filters.addSchemaColumnFilterWithParameter(s.ComparisonType.Equal,this.resourceIdColumn,t),n}_filterColumns(t,n){return t.filter(i=>n.indexOf(i.path)===-1)}getUpdateQuery(t){const n=this.entityConverter.getEntityColumns(t),i=this._filterColumns(n,this.excludedColumnsFromUpdate),r=new s.UpdateQuery(this.entitySchemaName);return i.forEach(c=>{r.addColumn(c.path,c.value,c.type)}),r.filters.addSchemaColumnFilterWithParameter(s.ComparisonType.Equal,"Id",t.id),r}createGetAllItemsEsq(){const t=super.createGetAllItemsEsq();return t.filters.addSchemaColumnFilterWithParameter(s.ComparisonType.Equal,this.isDeletedColumn,!1),t}deleteItem(t){return t.delete(),this.updateItem(t)}getItemsByResourceId(t){const n=this._getItemsByResourceIdEsq(t);return this.queryExecutor.executeSelectQuery(n).pipe((0,ie.U)(i=>({success:!0,errorInfo:null,result:i.map(r=>this.entityConverter.getEntity(r))})),(0,Me.K)(i=>this.getBaseErrorResponse(i)))}}R.\u0275fac=function(t){return new(t||R)(e.LFG(_.oq),e.LFG(p.sK),e.LFG(F))},R.\u0275prov=e.Yz7({token:R,factory:R.\u0275fac});class M extends _.UE{constructor(t,n,i){super(t,n,i),this.projectIdColumn="Project",this.isDeletedColumn="IsDeleted",this.excludedColumnsFromUpdate=["CreatedOn","ModifiedOn"],this.entitySchemaName="TrackingResource"}_filterColumns(t,n){return t.filter(i=>n.indexOf(i.path)===-1)}_getItemsByProjectIdEsq(t){const n=this.createGetAllItemsEsq();return n.filters.addSchemaColumnFilterWithParameter(s.ComparisonType.Equal,this.projectIdColumn,t),n}getUpdateQuery(t){const n=this.entityConverter.getEntityColumns(t),i=this._filterColumns(n,this.excludedColumnsFromUpdate),r=new s.UpdateQuery(this.entitySchemaName);return i.forEach(c=>{r.addColumn(c.path,c.value,c.type)}),r.filters.addSchemaColumnFilterWithParameter(s.ComparisonType.Equal,"Id",t.id),r}createGetAllItemsEsq(){const t=super.createGetAllItemsEsq();return t.filters.addSchemaColumnFilterWithParameter(s.ComparisonType.Equal,this.isDeletedColumn,!1),t}deleteItem(t){return t.delete(),this.updateItem(t)}getItemsByProjectId(t){const n=this._getItemsByProjectIdEsq(t);return this.queryExecutor.executeSelectQuery(n).pipe((0,ie.U)(i=>({success:!0,errorInfo:null,result:i.map(r=>this.entityConverter.getEntity(r))})),(0,Me.K)(i=>this.getBaseErrorResponse(i)))}}M.\u0275fac=function(t){return new(t||M)(e.LFG(_.oq),e.LFG(p.sK),e.LFG(N))},M.\u0275prov=e.Yz7({token:M,factory:M.\u0275fac});const Le=[{name:"Equal",code:"EQUAL"},{name:"Contains",code:"CONTAINS"},{name:"BeginWith",code:"BEGINWITH"},{name:"EndWith",code:"ENDWITH"}],Re=[{name:"Equal",code:"EQUAL"},{name:"LessOrEqual",code:"LESSOREQUAL"},{name:"MoreOrEqual",code:"MOREOREQUAL"}],Ue=[{name:"click",code:"CLICK"},{name:"send_form",code:"SEND_FORM"},{name:"fill_field",code:"FILL_FIELD"},{name:"change_field",code:"CHANGE_FIELD"},{name:"focus",code:"FOCUS"},{name:"view_item",code:"VIEW_ITEM"},{name:"view_item_list",code:"VIEW_ITEM_LIST"},{name:"out_link",code:"OUT_LINK"},{name:"download_file",code:"DOWNLOAD_FILE"},{name:"search",code:"SEARCH"},{name:"add_to_cart",code:"ADD_TO_CART"},{name:"remove_from_cart",code:"REMOVE_FROM_CART"},{name:"add_to_wishlist",code:"ADD_TO_WISHLIST"},{name:"start_checkout",code:"START_CHECKOUT"},{name:"add_payment_info",code:"ADD_PAYMENT_INFO"},{name:"lead",code:"LEAD"},{name:"login",code:"LOGIN"},{name:"select_content",code:"SELECT_CONTENT"},{name:"complete_registration",code:"COMPLETE_REGISTRATION"},{name:"set_checkout_option",code:"SET_CHECKOUT_OPTION"},{name:"share",code:"SHARE"},{name:"visit_place",code:"VISIT_PLACE"},{name:"define_gps_location",code:"DEFINE_GPS_LOCATION"}],Ge=`creatioTracking.registerEvent('@TYPE@', {
	name: '@NAME@',
	value: '@VALUE@',
	cost: @COST@
});`,Be=`
( function (w, d, s, t, r) {
var root = (w['creatioTracking'] = w['creatioTracking'] || {}), v = (root['v'] = root['v'] || {});
v['hst'] = s; v['tnt'] = t; v['res'] = r; var se = d.createElement('script'), he = d.getElementsByTagName('head')[0], m = (d.cookie.indexOf('CRTTRKG_DBG=1') === -1), tc = 'creatio-tracking-engine' + (m ? '.min' : '') + '.js';
se.async = true; se.src = "https://webtracking-v01.bpmonline.com/JS/" + tc; he.appendChild(se); }
)(window, document, '@RECEIVER_HOST@', '@TENANT_ID@', '@RESOURCE_ID@');`;class k{getStringFilterTypes(){return Le.map(t=>new ge(t))}getNumberFilterTypes(){return Re.map(t=>new ge(t))}getEventTypeFilterTypes(){return Ue.map(t=>new ge(t))}}k.\u0275fac=function(t){return new(t||k)},k.\u0275prov=e.Yz7({token:k,factory:k.\u0275fac});var Je=l(84967);class Z{constructor(t,n){this.tenantService=t,this.sysSettingsService=n,this._receiverSysSettingCode="TrackingReceiverUrl"}_buildCode(t,n,i){return Be.replace("@RECEIVER_HOST@",t).replace("@TENANT_ID@",n).replace("@RESOURCE_ID@",i)}getTrackingCode(t){const n=this.tenantService.getTenantInfo(),i=this.sysSettingsService.getByCodes([this._receiverSysSettingCode]);return(0,Je.D)([n,i]).pipe((0,ie.U)(r=>{const c=r[0].GetInfoResult.TenantId,T=r[1].values[this._receiverSysSettingCode].value;return this._buildCode(T,c,t)}))}getEventCode(t){return Ge.replace("@TYPE@",t.eventType).replace("@NAME@",t.name).replace("@VALUE@",t.value).replace("@COST@",t.cost)}}Z.\u0275fac=function(t){return new(t||Z)(e.LFG(I),e.LFG(be.lI))},Z.\u0275prov=e.Yz7({token:Z,factory:Z.\u0275fac});var fe=l(95411),h=l(95236),ke=l(78464);const Ye=function(a){return{actionClick:a}},Qe=function(a){return{itemActions:a}};class K{get _resourceLinkGenerator(){return t=>`/Tracking/resource/${t.id}`}get _isNewProject(){return this.projectId!=="new"&&!(0,m.Z)(this.projectId)}constructor(t,n,i,r,c){this.resourceService=t,this.translateService=n,this.userInfo=i,this.router=r,this.dialogService=c,this.tableDataSource=new f.o6y,this.dataSchema={columns:[{name:"name",caption:this.translateService.instant("Tracking.ProjectPage.ResourceDetail.Columns.Name"),valueType:s.DataValueType.Text,linkGenerator:this._resourceLinkGenerator},{name:"source",caption:this.translateService.instant("Tracking.ProjectPage.ResourceDetail.Columns.Source"),valueType:s.DataValueType.Text},{name:"isActive",caption:this.translateService.instant("Tracking.ProjectPage.ResourceDetail.Columns.Status.Caption"),valueType:s.DataValueType.Text,formatter:this._getStatus.bind(this),sortingDataAccessor:T=>this._getStatus(T.isActive)},{name:"createdOn",caption:this.translateService.instant("Tracking.ProjectPage.ResourceDetail.Columns.CreatedOn"),valueType:s.DataValueType.DateTime,formatter:this._formatDate.bind(this)},{name:"modifiedOn",caption:this.translateService.instant("Tracking.ProjectPage.ResourceDetail.Columns.ModifiedOn"),valueType:s.DataValueType.DateTime,formatter:this._formatDate.bind(this)},{name:"itemActions",cellComponentClass:b}]},this.projectId="new"}_loadPageData(){this.resourceService.getItemsByProjectId(this.projectId).subscribe(t=>{this.tableDataSource.data=t.result})}_getStatus(t){return this.translateService.instant("Tracking.ProjectPage.ResourceDetail.Columns.Status."+(t?"Active":"Inactive"))}_initUserCulture(){this.userCulture=this.userInfo.cultureInfo.sysCultureName}_formatDate(t){return(0,m.Z)(t)?"":new Date(t).toLocaleString(this.userCulture)}_initPageData(){this._isNewProject&&this._loadPageData()}_deleteResource(t){this.resourceService.deleteItem(t).subscribe(()=>{this._loadPageData()})}_deleteResourceConfirmation(t){const n=this.translateService.instant("BaseSection.DeleteRecordConfirmation");this.dialogService.openConfirmationDialog(n).subscribe(i=>{i===u.Zz.result&&this._deleteResource(t)})}ngOnInit(){this._initUserCulture(),this._initPageData()}onAddClicked(){this._isNewProject&&this.router.navigate(["Tracking/resource/new"],{queryParams:{project:this.projectId}})}onItemAction(t,n){switch(n){case"delete":this._deleteResourceConfirmation(t);break;case"edit":this.router.navigate(["Tracking/resource/"+t.id]);break;default:console.error("invalid action")}}}K.\u0275fac=function(t){return new(t||K)(e.Y36(M),e.Y36(p.sK),e.Y36(d.aoG),e.Y36(j.F0),e.Y36(u.xA))},K.\u0275cmp=e.Xpm({type:K,selectors:[["ts-resource-detail"]],inputs:{projectId:"projectId"},decls:2,vars:10,consts:[[3,"dataSource","dataSchema","tableEventHandlers","header","addClicked"]],template:function(t,n){t&1&&(e.TgZ(0,"ts-base-detail",0),e.NdJ("addClicked",function(){return n.onAddClicked()}),e.ALo(1,"translate"),e.qZA()),t&2&&e.Q6J("dataSource",n.tableDataSource)("dataSchema",n.dataSchema)("tableEventHandlers",e.VKq(8,Qe,e.VKq(6,Ye,n.onItemAction.bind(n))))("header",e.lcZ(1,4,"Tracking.ProjectPage.ResourceDetail.Header"))},dependencies:[A,p.X$],encapsulation:2});function He(a,t){a&1&&e._UZ(0,"ts-mask")}function Ke(a,t){if(a&1){const n=e.EpF();e.TgZ(0,"button",23),e.NdJ("click",function(){e.CHM(n);const r=e.oxw();return e.KtG(r.save())}),e._uU(1),e.ALo(2,"translate"),e.qZA()}a&2&&(e.xp6(1),e.hij(" ",e.lcZ(2,1,"BasePageComponent.Apply")," "))}function ze(a,t){if(a&1){const n=e.EpF();e.TgZ(0,"button",24),e.NdJ("click",function(){e.CHM(n);const r=e.oxw();return e.KtG(r.cancel())}),e._uU(1),e.ALo(2,"translate"),e.qZA()}a&2&&(e.xp6(1),e.hij(" ",e.lcZ(2,1,"BasePageComponent.Cancel")," "))}function We(a,t){if(a&1){const n=e.EpF();e.TgZ(0,"button",24),e.NdJ("click",function(){e.CHM(n);const r=e.oxw();return e.KtG(r.close())}),e._uU(1),e.ALo(2,"translate"),e.qZA()}a&2&&(e.xp6(1),e.hij(" ",e.lcZ(2,1,"BasePageComponent.Close")," "))}function Xe(a,t){if(a&1&&(e.TgZ(0,"mat-error"),e._uU(1),e.qZA()),a&2){const n=e.oxw();e.xp6(1),e.hij(" ",n.getElementValidationMessage("name")," ")}}function $e(a,t){if(a&1&&(e.TgZ(0,"mat-error"),e._uU(1),e.qZA()),a&2){const n=e.oxw();e.xp6(1),e.hij(" ",n.getElementValidationMessage("description")," ")}}function et(a,t){if(a&1&&(e.TgZ(0,"mat-option",25),e._uU(1),e.qZA()),a&2){const n=t.$implicit;e.Q6J("value",n),e.xp6(1),e.hij(" ",n===void 0?"":n.name," ")}}function tt(a,t){if(a&1&&(e.TgZ(0,"mat-error"),e._uU(1),e.qZA()),a&2){const n=e.oxw();e.xp6(1),e.hij(" ",n.getElementValidationMessage("owner")," ")}}function nt(a,t){a&1&&(e.TgZ(0,"div",26)(1,"mat-form-field",11)(2,"mat-label"),e._uU(3),e.ALo(4,"translate"),e.qZA(),e._UZ(5,"input",27),e.qZA(),e.TgZ(6,"mat-form-field",11)(7,"mat-label"),e._uU(8),e.ALo(9,"translate"),e.qZA(),e._UZ(10,"input",28),e.qZA(),e.TgZ(11,"div",29)(12,"p",30),e._uU(13),e.ALo(14,"translate"),e.qZA(),e.TgZ(15,"p",31),e._uU(16,"--"),e.qZA()(),e.TgZ(17,"div",29)(18,"p",30),e._uU(19),e.ALo(20,"translate"),e.qZA(),e.TgZ(21,"p",31),e._uU(22,"--"),e.qZA()()()),a&2&&(e.xp6(3),e.Oqu(e.lcZ(4,4,"Tracking.ProjectPage.Detail.CreatedOn")),e.xp6(5),e.Oqu(e.lcZ(9,6,"Tracking.ProjectPage.Detail.ModifiedOn")),e.xp6(5),e.hij(" ",e.lcZ(14,8,"Tracking.ProjectPage.Detail.TotalEvents")," "),e.xp6(6),e.hij(" ",e.lcZ(20,10,"Tracking.ProjectPage.Detail.ConversionRate")," "))}class z extends f.neP{constructor(t,n,i,r,c){super(t),this.projectSectionService=n,this.sysAdminUnitService=i,this.userInfo=r,this._formBuilder=c,this._owners=[],this._noWhitespacesValidationRegex="^.*\\S+.*$",this.getGtmSchemaName=()=>"ProjectSetupPage"}_setProjectId(){this.id=this.activateRoute.snapshot.params.id,this.isNew=this.id==="new"}_initUserCulture(){this._userCulture=this.userInfo.cultureInfo.sysCultureName}_convertDateTimeToLocal(t){return t===null||t===""||t===void 0?"":new Date(t).toLocaleString(this._userCulture)}_getComboboxRawValue(t){let n="";const i=t.value;return i instanceof ne?n=i.name:i instanceof Object?n=i.value:typeof i=="string"&&(n=i),n}_validateOwnerComboboxValue(t){let n=!0,i=null;const r=this.model,c=this._getComboboxRawValue(t);return"owner"in r&&!(0,m.Z)(r.owner)&&(i=r.owner),!(0,m.Z)(i)&&i.name!==c&&(n=!1),(0,m.Z)(i)&&!(0,m.Z)(c)&&(n=!1),n?null:{invalidValue:!0}}_validateOwnerComboboxValueAsync(t){return new Promise(i=>{setTimeout(()=>{i(this._validateOwnerComboboxValue(t))},150)})}_bildForm(){this.projectForm=this._formBuilder.group({name:new o.p4({value:""},[o.kI.required,o.kI.maxLength(255),o.kI.pattern(this._noWhitespacesValidationRegex)]),description:new o.p4({value:""},[o.kI.maxLength(255),o.kI.pattern(this._noWhitespacesValidationRegex)]),owner:new o.p4({value:""},null,this._validateOwnerComboboxValueAsync.bind(this)),createdOn:new o.p4({value:"",disabled:!0}),modifiedOn:new o.p4({value:"",disabled:!0})})}_subscribeOnValueChange(t,n){const i=function(r){this.model[t]=r,this.setIsChanged()};n===void 0?this.projectForm.get(t).valueChanges.subscribe(i.bind(this)):this.projectForm.get(t).valueChanges.subscribe(n.bind(this))}_onFormValueChange(){this._subscribeOnValueChange("name",t=>{this.model.name=t,this.pageTitle=t,this.setIsChanged()}),this._subscribeOnValueChange("description"),this._subscribeOnValueChange("owner",t=>{t instanceof ne?this.model.owner=t:this.model.owner=null,this.setIsChanged()}),this._subscribeOnValueChange("createdOn"),this._subscribeOnValueChange("modifiedOn")}_onContacsLoaded(t){this._owners=t.result,this._setOwnerFilter()}_filterContacts(t){const n=t.toLowerCase();return this._owners.filter(i=>i.name.toLowerCase().indexOf(n)===0)}_setOwnerFilter(){this.filteredOwners=this.projectForm.controls.owner.valueChanges.pipe((0,je.O)(""),(0,ie.U)(t=>typeof t=="string"?t:t.name),(0,ie.U)(t=>t?this._filterContacts(t):this._owners.slice()))}_createDefaultProject(){const t=new de;return t.name=this.translateInstant("Tracking.ProjectPage.Detail.DefaultValues.Name"),t.description=this.translateInstant("Tracking.ProjectPage.Detail.DefaultValues.Description"),t}_applyModelData(t){this.projectForm.patchValue({name:t.name,description:t.description,owner:t.owner,createdOn:t.createdOn,modifiedOn:t.modifiedOn}),this.pageTitle=t.name,this.modelSnap=(0,ae.Z)(t),this._onFormValueChange()}_setDefaultData(){const t=this._createDefaultProject();this.model=(0,ae.Z)(t),this.isLoading=!1,this.setIsChanged()}_initPageData(){this.isNew?this._setDefaultData():super.loadInitialPageData()}getModelFromLoadResponse(t){const n=t.result[0];return n.createdOn=this._convertDateTimeToLocal(n.createdOn),n.modifiedOn=this._convertDateTimeToLocal(n.modifiedOn),n}savePageData(t){return this.isNew?this.projectSectionService.insertItem(t):this.projectSectionService.updateItem(t)}requestPageData(){return this.projectSectionService.getItem(this.id)}onModelSet(t){this._applyModelData(t)}getElementValidationMessage(t){const n=this.projectForm.get(t);let i="";return n.errors.required||n.errors.pattern?i=this.translateInstant("Tracking.ValidationMessage.RequiredFieldValue"):n.errors.maxlength?i=this.translateInstant("Tracking.ValidationMessage.LongFieldValue"):n.errors.invalidValue&&(i=this.translateInstant("Tracking.ValidationMessage.InvalidValue")),i}isInvalidElement(t){return!!this.projectForm.get(t).invalid}save(){return this.projectForm.updateValueAndValidity(),this.projectForm.valid?super.save():null}displayContact(t){return t instanceof ne?t.name:""}ngOnInit(){this._bildForm(),this._setProjectId(),this._initUserCulture(),this._initPageData(),this.sysAdminUnitService.getItems().subscribe(t=>this._onContacsLoaded(t))}}z.\u0275fac=function(t){return new(t||z)(e.Y36(e.zs3),e.Y36(x),e.Y36(L),e.Y36(d.aoG),e.Y36(o.qu))},z.\u0275cmp=e.Xpm({type:z,selectors:[["ts-project-page"]],features:[e.qOj],decls:39,vars:25,consts:[[4,"ngIf"],[1,"base-page-wrap"],[1,"header"],[1,"pane"],[3,"title"],["class","action-button","mat-flat-button","","color","accent",3,"click",4,"ngIf"],["class","action-button","mat-flat-button","","color","primary",3,"click",4,"ngIf"],[1,"page-content-wrapper"],[3,"formGroup"],[1,"left-bar"],[1,"project-pane","pane"],["floatLabel","always"],["matInput","","type","text","formControlName","name","required","","data-qa","name",3,"keypress"],["matInput","","type","text","data-qa","description","formControlName","description",3,"keypress"],["type","text","matInput","","formControlName","owner",3,"matAutocomplete"],["matSuffix","",1,"mat-select-arrow-wrapper"],[1,"mat-select-arrow"],[3,"displayWith"],["auto","matAutocomplete"],[3,"value",4,"ngFor","ngForOf"],["class","statistic-project",4,"ngIf"],[1,"main-content","pane"],[3,"projectId"],["mat-flat-button","","color","accent",1,"action-button",3,"click"],["mat-flat-button","","color","primary",1,"action-button",3,"click"],[3,"value"],[1,"statistic-project"],["matInput","","type","text","data-qa","createdOn","formControlName","createdOn"],["matInput","","type","text","data-qa","modifiedOn","formControlName","modifiedOn"],[1,"statistic-field"],[1,"statistic-field-label"],[1,"statistic-field-value"]],template:function(t,n){if(t&1&&(e.YNc(0,He,1,0,"ts-mask",0),e.TgZ(1,"div",1)(2,"div",2)(3,"div",3)(4,"ts-header",4),e.YNc(5,Ke,3,3,"button",5),e.YNc(6,ze,3,3,"button",6),e.YNc(7,We,3,3,"button",6),e.qZA()()(),e.TgZ(8,"div",7)(9,"form",8)(10,"div",9)(11,"div",10)(12,"mat-form-field",11)(13,"mat-label"),e._uU(14),e.ALo(15,"translate"),e.qZA(),e.TgZ(16,"input",12),e.NdJ("keypress",function(){return n.setIsChanged()}),e.qZA(),e.YNc(17,Xe,2,1,"mat-error",0),e.qZA(),e.TgZ(18,"mat-form-field",11)(19,"mat-label"),e._uU(20),e.ALo(21,"translate"),e.qZA(),e.TgZ(22,"input",13),e.NdJ("keypress",function(){return n.setIsChanged()}),e.qZA(),e.YNc(23,$e,2,1,"mat-error",0),e.qZA(),e.TgZ(24,"mat-form-field",11)(25,"mat-label"),e._uU(26),e.ALo(27,"translate"),e.qZA(),e._UZ(28,"input",14),e.TgZ(29,"div",15),e._UZ(30,"div",16),e.qZA(),e.TgZ(31,"mat-autocomplete",17,18),e.YNc(33,et,2,2,"mat-option",19),e.ALo(34,"async"),e.qZA(),e.YNc(35,tt,2,1,"mat-error",0),e.qZA(),e.YNc(36,nt,23,12,"div",20),e.qZA()()(),e.TgZ(37,"div",21),e._UZ(38,"ts-resource-detail",22),e.qZA()()()),t&2){const i=e.MAs(32);e.Q6J("ngIf",n.isLoading),e.xp6(4),e.Q6J("title",n.pageTitle),e.xp6(1),e.Q6J("ngIf",n.saveButtonVisible()),e.xp6(1),e.Q6J("ngIf",n.cancelButtonVisible()),e.xp6(1),e.Q6J("ngIf",n.closeButtonVisible()),e.xp6(2),e.Q6J("formGroup",n.projectForm),e.xp6(5),e.Oqu(e.lcZ(15,17,"Tracking.ProjectPage.Detail.Name")),e.xp6(3),e.Q6J("ngIf",n.isInvalidElement("name")),e.xp6(3),e.Oqu(e.lcZ(21,19,"Tracking.ProjectPage.Detail.Description")),e.xp6(3),e.Q6J("ngIf",n.isInvalidElement("description")),e.xp6(3),e.Oqu(e.lcZ(27,21,"Tracking.ProjectPage.Detail.Owner")),e.xp6(2),e.Q6J("matAutocomplete",i),e.xp6(3),e.Q6J("displayWith",n.displayContact),e.xp6(2),e.Q6J("ngForOf",e.lcZ(34,23,n.filteredOwners)),e.xp6(2),e.Q6J("ngIf",n.isInvalidElement("owner")),e.xp6(1),e.Q6J("ngIf",!n.isNew),e.xp6(2),e.Q6J("projectId",n.id)}},dependencies:[o._Y,o.Fj,o.JJ,o.JL,o.Q7,o.sg,o.u,g.sg,g.O5,re.VN,re.QJ,fe.CK,D.eB,h.nI,h.v_,h.$V,h.nX,J.k0,he.G,ke.g,K,g.Ov,p.X$],styles:["[_nghost-%COMP%]{display:flex;flex-direction:column;width:100%;min-height:100vh}.header[_ngcontent-%COMP%]{position:fixed;top:0;left:0;width:100%;z-index:800;height:109px;background-color:#ebeeef}.header[_ngcontent-%COMP%]   .pane[_ngcontent-%COMP%]{margin:6px 6px 0;overflow:hidden;border-bottom-left-radius:0;border-bottom-right-radius:0}.header[_ngcontent-%COMP%]   ts-header[_ngcontent-%COMP%]{padding-bottom:21px}.header[_ngcontent-%COMP%]   ts-header[_ngcontent-%COMP%]   .action-button[_ngcontent-%COMP%]:not(:first-child){margin-left:10px}.page-content-wrapper[_ngcontent-%COMP%]{flex-grow:1;display:flex;flex-direction:row;height:calc(100% - 12px);margin:120px 6px 6px}.page-content-wrapper[_ngcontent-%COMP%]   .left-bar[_ngcontent-%COMP%]{width:298px;height:100%;display:flex}.page-content-wrapper[_ngcontent-%COMP%]   .left-bar[_ngcontent-%COMP%]   .pane[_ngcontent-%COMP%]{padding:21px 21px 6px;width:100%}.page-content-wrapper[_ngcontent-%COMP%]   .left-bar[_ngcontent-%COMP%]   .pane[_ngcontent-%COMP%]:not(:last-child){margin-bottom:6px}.page-content-wrapper[_ngcontent-%COMP%]   .left-bar[_ngcontent-%COMP%]   .pane.project-pane[_ngcontent-%COMP%]   mat-form-field[_ngcontent-%COMP%]{width:100%}.page-content-wrapper[_ngcontent-%COMP%]   .left-bar[_ngcontent-%COMP%]   .pane.project-pane[_ngcontent-%COMP%]   mat-form-field[_ngcontent-%COMP%]:not(:first-child){margin-top:11px}.page-content-wrapper[_ngcontent-%COMP%]   .left-bar[_ngcontent-%COMP%]   .pane[_ngcontent-%COMP%]   .statistic-project[_ngcontent-%COMP%]{margin-top:14px}.page-content-wrapper[_ngcontent-%COMP%]   .left-bar[_ngcontent-%COMP%]   .pane[_ngcontent-%COMP%]   .statistic-project[_ngcontent-%COMP%]:not(:first-child){margin-top:11px}.page-content-wrapper[_ngcontent-%COMP%]   .left-bar[_ngcontent-%COMP%]   .pane[_ngcontent-%COMP%]   .statistic-project[_ngcontent-%COMP%]   .statistic-field[_ngcontent-%COMP%]{display:none}.page-content-wrapper[_ngcontent-%COMP%]   .left-bar[_ngcontent-%COMP%]   .pane[_ngcontent-%COMP%]   .statistic-project[_ngcontent-%COMP%]   .statistic-field[_ngcontent-%COMP%]   .statistic-field-label[_ngcontent-%COMP%]{color:#999;margin-block-end:0}.page-content-wrapper[_ngcontent-%COMP%]   .left-bar[_ngcontent-%COMP%]   .pane[_ngcontent-%COMP%]   .statistic-project[_ngcontent-%COMP%]   .statistic-field[_ngcontent-%COMP%]   .statistic-field-value[_ngcontent-%COMP%]{margin-block-start:0;margin-block-end:0}.page-content-wrapper[_ngcontent-%COMP%]   .main-content[_ngcontent-%COMP%]{margin-left:6px;padding:5px;width:calc(100% - 298px)}"]});function at(a,t){if(a&1&&(e.TgZ(0,"div",6)(1,"a",7),e._uU(2),e.qZA()()),a&2){const n=e.oxw();e.xp6(1),e.s9C("href",n.link,e.LSH),e.xp6(1),e.Oqu(n.linkText)}}class W{}W.\u0275fac=function(t){return new(t||W)},W.\u0275cmp=e.Xpm({type:W,selectors:[["ts-pane-info"]],inputs:{title:"title",content:"content",linkText:"linkText",link:"link",showLink:"showLink"},decls:9,vars:3,consts:[[1,"pane-info"],[1,"title"],["svgIcon","important-info",1,"icon"],[1,"text"],[1,"content"],["class","link",4,"ngIf"],[1,"link"],[3,"href"]],template:function(t,n){t&1&&(e.TgZ(0,"div",0)(1,"div",1),e._UZ(2,"mat-icon",2),e.TgZ(3,"span",3),e._uU(4),e.qZA()(),e.TgZ(5,"div",4)(6,"p"),e._uU(7),e.qZA()(),e.YNc(8,at,3,2,"div",5),e.qZA()),t&2&&(e.xp6(4),e.Oqu(n.title),e.xp6(3),e.Oqu(n.content),e.xp6(1),e.Q6J("ngIf",n.showLink))},dependencies:[g.O5,B.Hw],styles:[".pane-info[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]{display:flex;align-items:center}.pane-info[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{height:2rem;width:2rem}.pane-info[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]   .text[_ngcontent-%COMP%]{margin-left:.5rem;color:#22ac14;font-weight:400;font-size:large}"]});function it(a,t){if(a&1&&(e.TgZ(0,"mat-option",14),e._uU(1),e.qZA()),a&2){const n=t.$implicit;e.Q6J("value",n.name),e.xp6(1),e.hij(" ",n.name," ")}}function ot(a,t){if(a&1&&(e.TgZ(0,"mat-error"),e._uU(1),e.qZA()),a&2){const n=e.oxw();e.xp6(1),e.hij(" ",n.getElementValidationMessage("eventType")," ")}}function rt(a,t){if(a&1&&(e.TgZ(0,"mat-error"),e._uU(1),e.qZA()),a&2){const n=e.oxw();e.xp6(1),e.hij(" ",n.getElementValidationMessage("name")," ")}}function st(a,t){if(a&1&&(e.TgZ(0,"mat-error"),e._uU(1),e.qZA()),a&2){const n=e.oxw();e.xp6(1),e.hij(" ",n.getElementValidationMessage("value")," ")}}function lt(a,t){if(a&1&&(e.TgZ(0,"mat-error"),e._uU(1),e.qZA()),a&2){const n=e.oxw();e.xp6(1),e.hij(" ",n.getElementValidationMessage("cost")," ")}}class X{constructor(t,n,i,r){this.formBuilder=t,this.filterTypeService=n,this.translateService=i,this.trackingCodeBuilderService=r,this._numberValidationRegex="^[+-]?\\d+(\\.\\d+)?$",this.eventTypes=[],this.scriptMessage=this.translateService.instant("Tracking.EventCodeGenerator.FormValidators.EmptyForm")}_bildForm(){this.eventCodePropertiesForm=this.formBuilder.group({eventType:new o.p4({value:""},[o.kI.required,o.kI.maxLength(255)]),name:new o.p4({value:""},[o.kI.maxLength(255)]),value:new o.p4({value:""},[o.kI.maxLength(255)]),cost:new o.p4({value:""},[o.kI.pattern(this._numberValidationRegex),o.kI.maxLength(255)])}),this.eventCodePropertiesForm.patchValue({eventType:null,name:null,value:null,cost:null}),this._onFormValueChange()}_getElementvalue(t){return this.eventCodePropertiesForm.get(t).value}_subscribeOnValueChange(t){const n=function(i){setTimeout(()=>{if(!this.eventCodePropertiesForm.valid){this.scriptMessage=this.translateService.instant("Tracking.EventCodeGenerator.FormValidators.InvalidForm");return}const r={eventType:this._getElementvalue("eventType"),name:this._getElementvalue("name"),value:this._getElementvalue("value"),cost:this._getElementvalue("cost")},c=this.trackingCodeBuilderService.getEventCode(r);this.scriptMessage=c},100)};this.eventCodePropertiesForm.get(t).valueChanges.subscribe(n.bind(this))}_onFormValueChange(){this._subscribeOnValueChange("eventType"),this._subscribeOnValueChange("name"),this._subscribeOnValueChange("cost"),this._subscribeOnValueChange("value")}_loadInitialData(){this.eventTypes=this.filterTypeService.getEventTypeFilterTypes()}isInvalidElement(t){return!!this.eventCodePropertiesForm.get(t).invalid}getElementValidationMessage(t){const n=this.eventCodePropertiesForm.get(t),i=n.errors.pattern;let r="";return n.errors.required?r=this.translateService.instant("Tracking.ValidationMessage.RequiredFieldValue"):n.errors.maxlength?r=this.translateService.instant("Tracking.ValidationMessage.LongFieldValue"):i&&this._numberValidationRegex===i.requiredPattern&&(r=this.translateService.instant("Tracking.ValidationMessage.InvalidNumberValue")),r}ngOnInit(){this._bildForm(),this._loadInitialData()}}X.\u0275fac=function(t){return new(t||X)(e.Y36(o.qu),e.Y36(k),e.Y36(p.sK),e.Y36(Z))},X.\u0275cmp=e.Xpm({type:X,selectors:[["ts-event-code-generator"]],decls:34,vars:22,consts:[[1,"header"],[1,"panel-container"],[1,"left-panel"],[3,"formGroup"],["floatLabel","always",1,"select"],["formControlName","eventType","required","","disableOptionCentering",""],[3,"value",4,"ngFor","ngForOf"],[4,"ngIf"],["floatLabel","always"],["matInput","","type","text","formControlName","name"],["matInput","","type","text","formControlName","value"],["matInput","","type","text","formControlName","cost"],[1,"right-panel"],[3,"scriptMessage"],[3,"value"]],template:function(t,n){t&1&&(e.TgZ(0,"div",0)(1,"h2"),e._uU(2),e.ALo(3,"translate"),e.qZA()(),e.TgZ(4,"div",1)(5,"div",2)(6,"form",3)(7,"mat-form-field",4)(8,"mat-label"),e._uU(9),e.ALo(10,"translate"),e.qZA(),e.TgZ(11,"mat-select",5),e.YNc(12,it,2,2,"mat-option",6),e.qZA(),e.YNc(13,ot,2,1,"mat-error",7),e.qZA(),e.TgZ(14,"mat-form-field",8)(15,"mat-label"),e._uU(16),e.ALo(17,"translate"),e.qZA(),e._UZ(18,"input",9),e.YNc(19,rt,2,1,"mat-error",7),e.qZA(),e.TgZ(20,"mat-form-field",8)(21,"mat-label"),e._uU(22),e.ALo(23,"translate"),e.qZA(),e._UZ(24,"input",10),e.YNc(25,st,2,1,"mat-error",7),e.qZA(),e.TgZ(26,"mat-form-field",8)(27,"mat-label"),e._uU(28),e.ALo(29,"translate"),e.qZA(),e._UZ(30,"input",11),e.YNc(31,lt,2,1,"mat-error",7),e.qZA()()(),e.TgZ(32,"div",12),e._UZ(33,"ts-code-pane",13),e.qZA()()),t&2&&(e.xp6(2),e.Oqu(e.lcZ(3,12,"Tracking.EventCodeGenerator.Header")),e.xp6(4),e.Q6J("formGroup",n.eventCodePropertiesForm),e.xp6(3),e.Oqu(e.lcZ(10,14,"Tracking.EventCodeGenerator.Form.EventType")),e.xp6(3),e.Q6J("ngForOf",n.eventTypes),e.xp6(1),e.Q6J("ngIf",n.isInvalidElement("eventType")),e.xp6(3),e.Oqu(e.lcZ(17,16,"Tracking.EventCodeGenerator.Form.EventName")),e.xp6(3),e.Q6J("ngIf",n.isInvalidElement("name")),e.xp6(3),e.Oqu(e.lcZ(23,18,"Tracking.EventCodeGenerator.Form.EventValue")),e.xp6(3),e.Q6J("ngIf",n.isInvalidElement("value")),e.xp6(3),e.Oqu(e.lcZ(29,20,"Tracking.EventCodeGenerator.Form.EventCost")),e.xp6(3),e.Q6J("ngIf",n.isInvalidElement("cost")),e.xp6(2),e.Q6J("scriptMessage",n.scriptMessage))},dependencies:[o._Y,o.Fj,o.JJ,o.JL,o.Q7,o.sg,o.u,g.sg,g.O5,fe.CK,h.nI,h.v_,h.$V,J.k0,se.x8,S,p.X$],styles:[".header[_ngcontent-%COMP%]{padding-left:21px}.header[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{color:#6ba9eb;font-weight:400}  .mat-select-panel{max-height:200px!important}.panel-container[_ngcontent-%COMP%]{display:flex;flex-direction:row;height:300px}.panel-container[_ngcontent-%COMP%]   .left-panel[_ngcontent-%COMP%]{display:flex;flex-direction:column;width:298px;min-width:298px;height:100%;padding:21px;box-sizing:border-box}.panel-container[_ngcontent-%COMP%]   .left-panel[_ngcontent-%COMP%]   mat-form-field[_ngcontent-%COMP%]{width:100%}.panel-container[_ngcontent-%COMP%]   .left-panel[_ngcontent-%COMP%]   mat-form-field[_ngcontent-%COMP%]:not(:first-child){margin-top:8px}.panel-container[_ngcontent-%COMP%]   .right-panel[_ngcontent-%COMP%]{padding:21px;box-sizing:border-box;flex-grow:1;max-width:900px}.panel-container[_ngcontent-%COMP%]   .right-panel[_ngcontent-%COMP%]     .script-text-block{height:200px}"]});class ${constructor(t,n){this._trackingCodeBuilderService=t,this.translateService=n,this.scriptMessage="Loading..."}_loadBaseTrackingCode(){this.scriptMessage=this.translateService.instant("Tracking.BaseTrackingCode.Loading"),this.resourceId==="new"||(0,m.Z)(this.resourceId)?this.scriptMessage=this.translateService.instant("Tracking.BaseTrackingCode.NotReady"):this._trackingCodeBuilderService.getTrackingCode(this.resourceId).subscribe(t=>{this.scriptMessage=t})}ngOnInit(){this._loadBaseTrackingCode()}}$.\u0275fac=function(t){return new(t||$)(e.Y36(Z),e.Y36(p.sK))},$.\u0275cmp=e.Xpm({type:$,selectors:[["ts-base-tracking-code"]],inputs:{resourceId:"resourceId"},decls:13,vars:14,consts:[[1,"header"],[1,"panel-container"],[1,"left-panel"],[1,"info-pane"],[3,"title","content","linkText","showLink"],[1,"right-panel"],[3,"scriptMessage"]],template:function(t,n){t&1&&(e.TgZ(0,"div",0)(1,"h2"),e._uU(2),e.ALo(3,"translate"),e.qZA()(),e.TgZ(4,"div",1)(5,"div",2)(6,"div",3),e._UZ(7,"ts-pane-info",4),e.ALo(8,"translate"),e.ALo(9,"translate"),e.ALo(10,"translate"),e.qZA()(),e.TgZ(11,"div",5),e._UZ(12,"ts-code-pane",6),e.qZA()()),t&2&&(e.xp6(2),e.Oqu(e.lcZ(3,6,"Tracking.BaseTrackingCode.Header")),e.xp6(5),e.s9C("title",e.lcZ(8,8,"Tracking.BaseTrackingCode.InfoBlock.Title")),e.s9C("content",e.lcZ(9,10,"Tracking.BaseTrackingCode.InfoBlock.Content")),e.s9C("linkText",e.lcZ(10,12,"Tracking.BaseTrackingCode.InfoBlock.LinkText")),e.Q6J("showLink",!1),e.xp6(5),e.Q6J("scriptMessage",n.scriptMessage))},dependencies:[W,S,p.X$],styles:[".header[_ngcontent-%COMP%]{padding-left:21px}.header[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{color:#6ba9eb;font-weight:400}.panel-container[_ngcontent-%COMP%]{display:flex;flex-direction:row;height:300px}.panel-container[_ngcontent-%COMP%]   .left-panel[_ngcontent-%COMP%]{display:flex;flex-direction:column;width:298px;min-width:298px;height:100%;padding:21px;box-sizing:border-box}.panel-container[_ngcontent-%COMP%]   .right-panel[_ngcontent-%COMP%]{padding:21px;box-sizing:border-box;flex-grow:1;max-width:900px}.panel-container[_ngcontent-%COMP%]   .right-panel[_ngcontent-%COMP%]     .script-text-block{height:200px}"]});function ct(a,t){a&1&&e._UZ(0,"ts-mask")}function dt(a,t){if(a&1){const n=e.EpF();e.TgZ(0,"button",22),e.NdJ("click",function(){e.CHM(n);const r=e.oxw();return e.KtG(r.save())}),e._uU(1),e.ALo(2,"translate"),e.qZA()}a&2&&(e.xp6(1),e.hij(" ",e.lcZ(2,1,"BasePageComponent.Apply")," "))}function pt(a,t){if(a&1){const n=e.EpF();e.TgZ(0,"button",23),e.NdJ("click",function(){e.CHM(n);const r=e.oxw();return e.KtG(r.cancel())}),e._uU(1),e.ALo(2,"translate"),e.qZA()}a&2&&(e.xp6(1),e.hij(" ",e.lcZ(2,1,"BasePageComponent.Cancel")," "))}function ut(a,t){if(a&1){const n=e.EpF();e.TgZ(0,"button",23),e.NdJ("click",function(){e.CHM(n);const r=e.oxw();return e.KtG(r.close())}),e._uU(1),e.ALo(2,"translate"),e.qZA()}a&2&&(e.xp6(1),e.hij(" ",e.lcZ(2,1,"BasePageComponent.Close")," "))}function mt(a,t){if(a&1&&(e.TgZ(0,"mat-error"),e._uU(1),e.qZA()),a&2){const n=e.oxw();e.xp6(1),e.hij(" ",n.getElementValidationMessage("name")," ")}}function gt(a,t){if(a&1&&(e.TgZ(0,"mat-error"),e._uU(1),e.qZA()),a&2){const n=e.oxw();e.xp6(1),e.hij(" ",n.getElementValidationMessage("source")," ")}}function ht(a,t){a&1&&(e.TgZ(0,"div",24)(1,"mat-form-field",11)(2,"mat-label"),e._uU(3),e.ALo(4,"translate"),e.qZA(),e._UZ(5,"input",25),e.qZA(),e.TgZ(6,"mat-form-field",11)(7,"mat-label"),e._uU(8),e.ALo(9,"translate"),e.qZA(),e._UZ(10,"input",26),e.qZA()()),a&2&&(e.xp6(3),e.Oqu(e.lcZ(4,2,"Tracking.ResourcePage.CreatedOn")),e.xp6(5),e.Oqu(e.lcZ(9,4,"Tracking.ResourcePage.ModifiedOn")))}class ee extends f.neP{constructor(t,n,i,r){super(i),this.resourceService=t,this._formBuilder=n,this.injector=i,this.userInfo=r,this._noWhitespacesValidationRegex="^.*\\S+.*$",this.getGtmSchemaName=()=>"TrackingResourcePage"}_setResourceId(){this.id=this.activateRoute.snapshot.params.id,this.isNew=this.id==="new"}_initUserCulture(){this.userCulture=this.userInfo.cultureInfo.sysCultureName}_convertDateTimeToLocal(t){return t===null||t===""||t===void 0?"":new Date(t).toLocaleString(this.userCulture)}_bildForm(){this.resourceForm=this._formBuilder.group({name:new o.p4({value:""},[o.kI.required,o.kI.maxLength(255),o.kI.pattern(this._noWhitespacesValidationRegex)]),source:new o.p4({value:""},[o.kI.maxLength(255),o.kI.pattern(this._noWhitespacesValidationRegex)]),isActive:new o.p4({value:!1}),createdOn:new o.p4({value:"",disabled:!0}),modifiedOn:new o.p4({value:"",disabled:!0})})}_subscribeOnValueChange(t,n){const i=function(r){this.model[t]=r,this.setIsChanged()};n===void 0?this.resourceForm.get(t).valueChanges.subscribe(i.bind(this)):this.resourceForm.get(t).valueChanges.subscribe(n.bind(this))}_onFormValueChange(){this._subscribeOnValueChange("name",t=>{this.model.name=t,this.pageTitle=t,this.setIsChanged()}),this._subscribeOnValueChange("isActive"),this._subscribeOnValueChange("source"),this._subscribeOnValueChange("createdOn"),this._subscribeOnValueChange("modifiedOn")}_createDefaultResource(){const t=new me;return t.name=this.translateInstant("Tracking.ResourcePage.DefaultName"),t.source=this.translateInstant("Tracking.ResourcePage.DefaultSource"),t}_applyModelData(t){this.resourceForm.patchValue({name:t.name,source:t.source,isActive:t.isActive,createdOn:t.createdOn,modifiedOn:t.modifiedOn}),this.pageTitle=t.name,this.modelSnap=(0,ae.Z)(t),this._onFormValueChange()}_setDefaultData(){const t=this._createDefaultResource();this.model=(0,ae.Z)(t),this.isLoading=!1,this.setIsChanged()}_initPageData(){this.isNew?this._setDefaultData():super.loadInitialPageData()}_createProjectByQueryParams(){const t=this.activateRoute.snapshot.queryParams.project,n=new de;return n.id=t,n}getModelFromLoadResponse(t){const n=t.result[0];return n.createdOn=this._convertDateTimeToLocal(n.createdOn),n.modifiedOn=this._convertDateTimeToLocal(n.modifiedOn),n}savePageData(t){return this.isNew?this.resourceService.insertItem(t):this.resourceService.updateItem(t)}requestPageData(){return this.resourceService.getItem(this.id)}onModelSet(t){this._applyModelData(t)}preProcessModelForSave(t){return this.isNew&&(t.project=this._createProjectByQueryParams()),t}getElementValidationMessage(t){const n=this.resourceForm.get(t);let i="";return n.errors.required||n.errors.pattern?i=this.translateInstant("Tracking.ValidationMessage.RequiredFieldValue"):n.errors.maxlength&&(i=this.translateInstant("Tracking.ValidationMessage.LongFieldValue")),i}isInvalidElement(t){return!!this.resourceForm.get(t).invalid}save(){return this.resourceForm.updateValueAndValidity(),this.resourceForm.valid?super.save():null}ngOnInit(){this._bildForm(),this._setResourceId(),this._initUserCulture(),this._initPageData()}}ee.\u0275fac=function(t){return new(t||ee)(e.Y36(M),e.Y36(o.qu),e.Y36(e.zs3),e.Y36(d.aoG))},ee.\u0275cmp=e.Xpm({type:ee,selectors:[["ts-resource-page"]],features:[e.qOj],decls:37,vars:22,consts:[[4,"ngIf"],[1,"base-page-wrap"],[1,"header"],[1,"pane"],[3,"title"],["class","action-button","mat-flat-button","","color","accent",3,"click",4,"ngIf"],["class","action-button","mat-flat-button","","color","primary",3,"click",4,"ngIf"],[1,"page-content-wrapper"],[3,"formGroup"],[1,"left-bar"],[1,"resource-pane","pane"],["floatLabel","always"],["matInput","","type","text","formControlName","name","required","","data-qa","name",3,"keypress"],["matInput","","type","text","data-qa","source","formControlName","source",3,"keypress"],[1,"toggle"],["matInput","","hidden",""],["data-qa","is-active","checked","model.isActive","formControlName","isActive"],["class","statistic-resource",4,"ngIf"],[1,"main-content","pane"],["disableRipple","true"],[1,"tracking-code-tab",3,"label"],[3,"resourceId"],["mat-flat-button","","color","accent",1,"action-button",3,"click"],["mat-flat-button","","color","primary",1,"action-button",3,"click"],[1,"statistic-resource"],["matInput","","type","text","data-qa","createdOn","formControlName","createdOn"],["matInput","","type","text","data-qa","modifiedOn","formControlName","modifiedOn"]],template:function(t,n){t&1&&(e.YNc(0,ct,1,0,"ts-mask",0),e.TgZ(1,"div",1)(2,"div",2)(3,"div",3)(4,"ts-header",4),e.YNc(5,dt,3,3,"button",5),e.YNc(6,pt,3,3,"button",6),e.YNc(7,ut,3,3,"button",6),e.qZA()()(),e.TgZ(8,"div",7)(9,"form",8)(10,"div",9)(11,"div",10)(12,"mat-form-field",11)(13,"mat-label"),e._uU(14),e.ALo(15,"translate"),e.qZA(),e.TgZ(16,"input",12),e.NdJ("keypress",function(){return n.setIsChanged()}),e.qZA(),e.YNc(17,mt,2,1,"mat-error",0),e.qZA(),e.TgZ(18,"mat-form-field",11)(19,"mat-label"),e._uU(20),e.ALo(21,"translate"),e.qZA(),e.TgZ(22,"input",13),e.NdJ("keypress",function(){return n.setIsChanged()}),e.qZA(),e.YNc(23,gt,2,1,"mat-error",0),e.qZA(),e.TgZ(24,"mat-form-field",14)(25,"mat-label"),e._uU(26),e.ALo(27,"translate"),e.qZA(),e._UZ(28,"textarea",15)(29,"mat-slide-toggle",16),e.qZA(),e.YNc(30,ht,11,6,"div",17),e.qZA()()(),e.TgZ(31,"div",18)(32,"mat-tab-group",19)(33,"mat-tab",20),e.ALo(34,"translate"),e._UZ(35,"ts-base-tracking-code",21)(36,"ts-event-code-generator"),e.qZA()()()()()),t&2&&(e.Q6J("ngIf",n.isLoading),e.xp6(4),e.Q6J("title",n.pageTitle),e.xp6(1),e.Q6J("ngIf",n.saveButtonVisible()),e.xp6(1),e.Q6J("ngIf",n.cancelButtonVisible()),e.xp6(1),e.Q6J("ngIf",n.closeButtonVisible()),e.xp6(2),e.Q6J("formGroup",n.resourceForm),e.xp6(5),e.Oqu(e.lcZ(15,14,"Tracking.ResourcePage.Name")),e.xp6(3),e.Q6J("ngIf",n.isInvalidElement("name")),e.xp6(3),e.Oqu(e.lcZ(21,16,"Tracking.ResourcePage.Source")),e.xp6(3),e.Q6J("ngIf",n.isInvalidElement("source")),e.xp6(3),e.Oqu(e.lcZ(27,18,"Tracking.ResourcePage.Active")),e.xp6(4),e.Q6J("ngIf",!n.isNew),e.xp6(3),e.s9C("label",e.lcZ(34,20,"Tracking.ResourcePage.Tabs.TrackingCode")),e.xp6(2),e.Q6J("resourceId",n.id))},dependencies:[o._Y,o.Fj,o.JJ,o.JL,o.Q7,o.sg,o.u,g.O5,D.eB,h.nI,h.v_,h.$V,J.k0,ce.SK,ce.R7,he.G,le.iZ,ke.g,X,$,p.X$],styles:["[_nghost-%COMP%]{display:flex;flex-direction:column;width:100%;min-height:100vh}[_nghost-%COMP%]     mat-form-field.toggle label{top:0}.header[_ngcontent-%COMP%]{position:fixed;top:0;left:0;width:100%;z-index:800;height:109px;background-color:#ebeeef}.header[_ngcontent-%COMP%]   .pane[_ngcontent-%COMP%]{margin:6px 6px 0;overflow:hidden;border-bottom-left-radius:0;border-bottom-right-radius:0}.header[_ngcontent-%COMP%]   ts-header[_ngcontent-%COMP%]{padding-bottom:21px}.header[_ngcontent-%COMP%]   ts-header[_ngcontent-%COMP%]   .action-button[_ngcontent-%COMP%]:not(:first-child){margin-left:10px}.page-content-wrapper[_ngcontent-%COMP%]{flex-grow:1;display:flex;flex-direction:row;height:calc(100% - 12px);margin:120px 6px 6px}.page-content-wrapper[_ngcontent-%COMP%]   .left-bar[_ngcontent-%COMP%]{width:298px;height:100%;display:flex}.page-content-wrapper[_ngcontent-%COMP%]   .left-bar[_ngcontent-%COMP%]   .pane[_ngcontent-%COMP%]{padding:21px 21px 6px;width:100%}.page-content-wrapper[_ngcontent-%COMP%]   .left-bar[_ngcontent-%COMP%]   .pane[_ngcontent-%COMP%]:not(:last-child){margin-bottom:6px}.page-content-wrapper[_ngcontent-%COMP%]   .left-bar[_ngcontent-%COMP%]   .pane.resource-pane[_ngcontent-%COMP%]   mat-form-field[_ngcontent-%COMP%]{width:100%}.page-content-wrapper[_ngcontent-%COMP%]   .left-bar[_ngcontent-%COMP%]   .pane.resource-pane[_ngcontent-%COMP%]   mat-form-field[_ngcontent-%COMP%]:not(:first-child){margin-top:11px}.page-content-wrapper[_ngcontent-%COMP%]   .left-bar[_ngcontent-%COMP%]   .pane[_ngcontent-%COMP%]   .statistic-resource[_ngcontent-%COMP%]{margin-top:14px}.page-content-wrapper[_ngcontent-%COMP%]   .left-bar[_ngcontent-%COMP%]   .pane[_ngcontent-%COMP%]   .statistic-resource[_ngcontent-%COMP%]:not(:first-child){margin-top:11px}.page-content-wrapper[_ngcontent-%COMP%]   .left-bar[_ngcontent-%COMP%]   .pane[_ngcontent-%COMP%]   .statistic-resource[_ngcontent-%COMP%]   .statistic-field[_ngcontent-%COMP%]   .statistic-field-label[_ngcontent-%COMP%]{color:#999;margin-block-end:0}.page-content-wrapper[_ngcontent-%COMP%]   .left-bar[_ngcontent-%COMP%]   .pane[_ngcontent-%COMP%]   .statistic-resource[_ngcontent-%COMP%]   .statistic-field[_ngcontent-%COMP%]   .statistic-field-value[_ngcontent-%COMP%]{margin-block-start:0;margin-block-end:0}.page-content-wrapper[_ngcontent-%COMP%]   .main-content.pane[_ngcontent-%COMP%]{overflow:auto}.page-content-wrapper[_ngcontent-%COMP%]   .main-content[_ngcontent-%COMP%]{margin-left:6px;padding:5px;width:calc(100% - 298px)}"]});var Ze=l(37697);function ft(a,t){if(a&1&&(e.TgZ(0,"mat-error"),e._uU(1),e.qZA()),a&2){const n=e.oxw();e.xp6(1),e.hij(" ",n.getElementValidationMessage("name")," ")}}function _t(a,t){if(a&1&&(e.TgZ(0,"mat-error"),e._uU(1),e.qZA()),a&2){const n=e.oxw();e.xp6(1),e.hij(" ",n.getElementValidationMessage("cost")," ")}}function Ct(a,t){if(a&1&&(e.TgZ(0,"mat-option",36),e._uU(1),e.qZA()),a&2){const n=t.$implicit;e.Q6J("value",n.code),e.xp6(1),e.hij(" ",n.name," ")}}function vt(a,t){if(a&1&&(e.TgZ(0,"mat-error"),e._uU(1),e.qZA()),a&2){const n=e.oxw();e.xp6(1),e.hij(" ",n.getElementValidationMessage("eventTypeFilter")," ")}}function Tt(a,t){if(a&1&&(e.TgZ(0,"mat-option",36),e._uU(1),e.ALo(2,"translate"),e.qZA()),a&2){const n=t.$implicit;e.Q6J("value",n.code),e.xp6(1),e.hij(" ",e.lcZ(2,2,"Tracking.ResourcePage.GoalEditiDialog.StringCondition."+n.name)," ")}}function Pt(a,t){if(a&1&&(e.TgZ(0,"mat-error"),e._uU(1),e.qZA()),a&2){const n=e.oxw();e.xp6(1),e.hij(" ",n.getElementValidationMessage("eventNameFilterData")," ")}}function Ot(a,t){if(a&1&&(e.TgZ(0,"mat-option",36),e._uU(1),e.ALo(2,"translate"),e.qZA()),a&2){const n=t.$implicit;e.Q6J("value",n.code),e.xp6(1),e.hij(" ",e.lcZ(2,2,"Tracking.ResourcePage.GoalEditiDialog.StringCondition."+n.name)," ")}}function yt(a,t){if(a&1&&(e.TgZ(0,"mat-error"),e._uU(1),e.qZA()),a&2){const n=e.oxw();e.xp6(1),e.hij(" ",n.getElementValidationMessage("eventValueFilterData")," ")}}function bt(a,t){if(a&1&&(e.TgZ(0,"mat-option",36),e._uU(1),e.ALo(2,"translate"),e.qZA()),a&2){const n=t.$implicit;e.Q6J("value",n.code),e.xp6(1),e.hij(" ",e.lcZ(2,2,"Tracking.ResourcePage.GoalEditiDialog.NumberCondition."+n.name)," ")}}function xt(a,t){if(a&1&&(e.TgZ(0,"mat-error"),e._uU(1),e.qZA()),a&2){const n=e.oxw();e.xp6(1),e.hij(" ",n.getElementValidationMessage("eventCostFilterData")," ")}}class te{get status(){return this._isNew===!0?"enabled":"disabled"}constructor(t,n,i,r,c,T){this.dialogService=t,this.dialogRef=n,this.data=i,this.formBuilder=r,this.filterTypeService=c,this.translateService=T,this._noWhitespacesValidationRegex="^.*\\S+.*$",this._numberValidationRegex="^[+-]?\\d+(\\.\\d+)?$",this.eventTypeFilterTypes=[],this.stringFilterTypes=[],this.numberFilterTypes=[]}_beforeClose(t){(!t||t.action===Y.CANCEL)&&this._loadModelFromSnap()}_close(t,n){this.dialogRef.close({action:n,goal:t})}_loadModelFromSnap(){this.model=(0,ae.Z)(this._modelSnap)}_bildForm(){this.goalForm=this.formBuilder.group({name:new o.p4({value:""},[o.kI.required,o.kI.maxLength(255),o.kI.pattern(this._noWhitespacesValidationRegex)]),cost:new o.p4({value:""},[o.kI.maxLength(255),o.kI.pattern(this._numberValidationRegex)]),useEventCost:new o.p4({value:!1}),isActive:new o.p4({value:!1}),eventTypeFilter:new o.p4({value:""},[o.kI.required]),eventNameFilterType:new o.p4({value:""}),eventNameFilterData:new o.p4({value:""},[o.kI.maxLength(255)]),eventValueFilterType:new o.p4({value:""}),eventValueFilterData:new o.p4({value:""},[o.kI.maxLength(255)]),eventCostFilterType:new o.p4({value:""}),eventCostFilterData:new o.p4({value:""},[o.kI.maxLength(255),o.kI.pattern(this._numberValidationRegex)])})}_subscribeOnValueChange(t,n){const i=function(r){this.model[t]=r};n===void 0?this.goalForm.get(t).valueChanges.subscribe(i.bind(this)):this.goalForm.get(t).valueChanges.subscribe(n.bind(this))}_getFormElementValue(t){return this.goalForm.controls[t].value}_buildSettings(){return Q.fromObject({eventTypeFilter:this._getFormElementValue("eventTypeFilter"),eventNameFilterType:this._getFormElementValue("eventNameFilterType"),eventNameFilterData:this._getFormElementValue("eventNameFilterData"),eventValueFilterType:this._getFormElementValue("eventValueFilterType"),eventValueFilterData:this._getFormElementValue("eventValueFilterData"),eventCostFilterType:this._getFormElementValue("eventCostFilterType"),eventCostFilterData:this._getFormElementValue("eventCostFilterData")})}_getSettingsValue(t,n){return t?t[n]:null}_useEventCostLogic(){if(!this._isNew)return;const t=this.goalForm.get("useEventCost"),n=this.goalForm.get("cost");t.value===!0?n.disable():n.enable(),this.model.useEventCost=t.value}_onFormValueChange(){const t=function(){this.model.settings=this._buildSettings()},n=function(){this._useEventCostLogic()};this._subscribeOnValueChange("name"),this._subscribeOnValueChange("cost"),this._subscribeOnValueChange("useEventCost",n),this._subscribeOnValueChange("isActive"),this._subscribeOnValueChange("eventTypeFilter",t),this._subscribeOnValueChange("eventNameFilterType",t),this._subscribeOnValueChange("eventNameFilterData",t),this._subscribeOnValueChange("eventValueFilterType",t),this._subscribeOnValueChange("eventValueFilterData",t),this._subscribeOnValueChange("eventCostFilterType",t),this._subscribeOnValueChange("eventCostFilterData",t)}_loadInitialData(){this.eventTypeFilterTypes=this.filterTypeService.getEventTypeFilterTypes(),this.stringFilterTypes=this.filterTypeService.getStringFilterTypes(),this.numberFilterTypes=this.filterTypeService.getNumberFilterTypes()}_setInitialData(){this._isNew=this.data.mode===E.ADD,this._modelSnap=this.data.goal,this._loadModelFromSnap()}_disableFormElements(t){for(const n of t)this.goalForm.get(n).disable()}_applyModelData(){this.goalForm.patchValue({resource:this.model.resource.id,name:this.model.name,cost:this.model.cost,useEventCost:this.model.useEventCost,isActive:this.model.isActive,eventTypeFilter:this._getSettingsValue(this.model.settings,"eventTypeFilter"),eventNameFilterType:this._getSettingsValue(this.model.settings,"eventNameFilterType"),eventNameFilterData:this._getSettingsValue(this.model.settings,"eventNameFilterData"),eventValueFilterType:this._getSettingsValue(this.model.settings,"eventValueFilterType"),eventValueFilterData:this._getSettingsValue(this.model.settings,"eventValueFilterData"),eventCostFilterType:this._getSettingsValue(this.model.settings,"eventCostFilterType"),eventCostFilterData:this._getSettingsValue(this.model.settings,"eventCostFilterData")}),this._isNew||this._disableFormElements(["cost","useEventCost","eventTypeFilter","eventNameFilterType","eventNameFilterData","eventValueFilterType","eventValueFilterData","eventCostFilterType","eventCostFilterData"]),this._useEventCostLogic(),this._onFormValueChange()}isInvalidElement(t){return!!this.goalForm.get(t).invalid}getElementValidationMessage(t){const n=this.goalForm.get(t),i=n.errors.pattern;let r="";return n.errors.required||i&&this._noWhitespacesValidationRegex===i.requiredPattern?r=this.translateService.instant("Tracking.ValidationMessage.RequiredFieldValue"):n.errors.maxlength?r=this.translateService.instant("Tracking.ValidationMessage.LongFieldValue"):i&&this._numberValidationRegex===i.requiredPattern&&(r=this.translateService.instant("Tracking.ValidationMessage.InvalidNumberValue")),r}onCancelButtonClick(){this._close(null,Y.CANCEL)}onSaveButtonClick(){this.goalForm.valid&&this._close(this.model,Y.SAVE)}ngOnInit(){this._bildForm(),this._loadInitialData(),this._setInitialData(),this._applyModelData(),this.dialogRef.beforeClosed().subscribe(t=>this._beforeClose(t))}}te.\u0275fac=function(t){return new(t||te)(e.Y36(u.xA),e.Y36(Ze.hV),e.Y36(Ze.eJ),e.Y36(o.qu),e.Y36(k),e.Y36(p.sK))},te.\u0275cmp=e.Xpm({type:te,selectors:[["ts-goal-edit-dialog"]],decls:96,vars:48,consts:[["mat-dialog-title",""],[1,"header"],["mat-dialog-content",""],[3,"formGroup"],[1,"goal-pane","pane"],["floatLabel","always"],["matInput","","type","text","formControlName","name","required",""],[4,"ngIf"],[1,"toggle"],["matInput","","hidden",""],["checked","model.isActive","formControlName","isActive"],[1,"binary-field"],[1,"fields-wrapper"],[1,"toggle","two-line-label"],[3,"ngClass"],["checked","model.useEventCost","formControlName","useEventCost"],[1,"delimiter"],[1,"error-mat-form-field-wrapper"],["matInput","","type","text","formControlName","cost"],[1,"settings-header-wrapper"],[1,"settings-header"],["svgIcon","important-info"],["floatLabel","always",1,"select"],["formControlName","eventTypeFilter","required",""],[3,"value",4,"ngFor","ngForOf"],[1,"label-wrapper"],[1,"select"],["formControlName","eventNameFilterType"],["matInput","","type","text","formControlName","eventNameFilterData"],["formControlName","eventValueFilterType"],["matInput","","type","text","formControlName","eventValueFilterData"],["formControlName","eventCostFilterType"],["matInput","","type","text","formControlName","eventCostFilterData"],["mat-dialog-actions",""],["mat-flat-button","","color","primary",1,"action-button",3,"click"],["mat-button","","cdkFocusInitial","",3,"click"],[3,"value"]],template:function(t,n){t&1&&(e.TgZ(0,"div",0)(1,"span",1),e._uU(2),e.ALo(3,"translate"),e.qZA()(),e.TgZ(4,"div",2)(5,"form",3)(6,"div",4)(7,"mat-form-field",5)(8,"mat-label"),e._uU(9),e.ALo(10,"translate"),e.qZA(),e._UZ(11,"input",6),e.YNc(12,ft,2,1,"mat-error",7),e.qZA(),e.TgZ(13,"mat-form-field",8)(14,"mat-label"),e._uU(15),e.ALo(16,"translate"),e.qZA(),e._UZ(17,"textarea",9)(18,"mat-slide-toggle",10),e.qZA(),e.TgZ(19,"div",11)(20,"div",12)(21,"mat-form-field",13)(22,"mat-label",14),e._uU(23),e.ALo(24,"translate"),e.qZA(),e._UZ(25,"textarea",9)(26,"mat-slide-toggle",15),e.qZA(),e._UZ(27,"div",16),e.TgZ(28,"div",17)(29,"mat-form-field",5)(30,"mat-label"),e._uU(31),e.ALo(32,"translate"),e.qZA(),e._UZ(33,"input",18),e.YNc(34,_t,2,1,"mat-error",7),e.qZA()()()(),e.TgZ(35,"div",19)(36,"span",20),e._uU(37),e.ALo(38,"translate"),e.qZA(),e._UZ(39,"mat-icon",21),e.qZA(),e.TgZ(40,"mat-form-field",22)(41,"mat-label"),e._uU(42),e.ALo(43,"translate"),e.qZA(),e.TgZ(44,"mat-select",23),e.YNc(45,Ct,2,2,"mat-option",24),e.qZA(),e.YNc(46,vt,2,1,"mat-error",7),e.qZA(),e.TgZ(47,"div",11)(48,"div",25)(49,"mat-label"),e._uU(50),e.ALo(51,"translate"),e.qZA()(),e.TgZ(52,"div",12)(53,"mat-form-field",26)(54,"mat-select",27),e.YNc(55,Tt,3,4,"mat-option",24),e.qZA()(),e._UZ(56,"div",16),e.TgZ(57,"div",17)(58,"mat-form-field"),e._UZ(59,"input",28),e.YNc(60,Pt,2,1,"mat-error",7),e.qZA()()()(),e.TgZ(61,"div",11)(62,"div",25)(63,"mat-label"),e._uU(64),e.ALo(65,"translate"),e.qZA()(),e.TgZ(66,"div",12)(67,"mat-form-field",26)(68,"mat-select",29),e.YNc(69,Ot,3,4,"mat-option",24),e.qZA()(),e._UZ(70,"div",16),e.TgZ(71,"div",17)(72,"mat-form-field"),e._UZ(73,"input",30),e.YNc(74,yt,2,1,"mat-error",7),e.qZA()()()(),e.TgZ(75,"div",11)(76,"div",25)(77,"mat-label"),e._uU(78),e.ALo(79,"translate"),e.qZA()(),e.TgZ(80,"div",12)(81,"mat-form-field",26)(82,"mat-select",31),e.YNc(83,bt,3,4,"mat-option",24),e.qZA()(),e._UZ(84,"div",16),e.TgZ(85,"div",17)(86,"mat-form-field"),e._UZ(87,"input",32),e.YNc(88,xt,2,1,"mat-error",7),e.qZA()()()()()()(),e.TgZ(89,"div",33)(90,"button",34),e.NdJ("click",function(){return n.onSaveButtonClick()}),e._uU(91),e.ALo(92,"translate"),e.qZA(),e.TgZ(93,"button",35),e.NdJ("click",function(){return n.onCancelButtonClick()}),e._uU(94),e.ALo(95,"translate"),e.qZA()()),t&2&&(e.xp6(2),e.Oqu(e.lcZ(3,24,"Tracking.ResourcePage.GoalEditiDialog.Header")),e.xp6(3),e.Q6J("formGroup",n.goalForm),e.xp6(4),e.Oqu(e.lcZ(10,26,"Tracking.ResourcePage.GoalEditiDialog.Name")),e.xp6(3),e.Q6J("ngIf",n.isInvalidElement("name")),e.xp6(3),e.Oqu(e.lcZ(16,28,"Tracking.ResourcePage.GoalEditiDialog.Active")),e.xp6(7),e.Q6J("ngClass",n.status),e.xp6(1),e.Oqu(e.lcZ(24,30,"Tracking.ResourcePage.GoalEditiDialog.UseEventCost")),e.xp6(8),e.Oqu(e.lcZ(32,32,"Tracking.ResourcePage.GoalEditiDialog.Cost")),e.xp6(3),e.Q6J("ngIf",n.isInvalidElement("cost")),e.xp6(3),e.Oqu(e.lcZ(38,34,"Tracking.ResourcePage.GoalEditiDialog.FilterSettings")),e.xp6(5),e.Oqu(e.lcZ(43,36,"Tracking.ResourcePage.GoalEditiDialog.EventTypeFilter")),e.xp6(3),e.Q6J("ngForOf",n.eventTypeFilterTypes),e.xp6(1),e.Q6J("ngIf",n.isInvalidElement("eventTypeFilter")),e.xp6(4),e.Oqu(e.lcZ(51,38,"Tracking.ResourcePage.GoalEditiDialog.EventNameFilter")),e.xp6(5),e.Q6J("ngForOf",n.stringFilterTypes),e.xp6(5),e.Q6J("ngIf",n.isInvalidElement("eventNameFilterData")),e.xp6(4),e.hij("",e.lcZ(65,40,"Tracking.ResourcePage.GoalEditiDialog.EventValueFilter")," "),e.xp6(5),e.Q6J("ngForOf",n.stringFilterTypes),e.xp6(5),e.Q6J("ngIf",n.isInvalidElement("eventValueFilterData")),e.xp6(4),e.Oqu(e.lcZ(79,42,"Tracking.ResourcePage.GoalEditiDialog.EventCostFilter")),e.xp6(5),e.Q6J("ngForOf",n.numberFilterTypes),e.xp6(5),e.Q6J("ngIf",n.isInvalidElement("eventCostFilterData")),e.xp6(3),e.Oqu(e.lcZ(92,44,"Tracking.ResourcePage.GoalEditiDialog.Actions.Save")),e.xp6(3),e.Oqu(e.lcZ(95,46,"Tracking.ResourcePage.GoalEditiDialog.Actions.Cancel")))},dependencies:[o._Y,o.Fj,o.JJ,o.JL,o.Q7,o.sg,o.u,g.mk,g.sg,g.O5,fe.CK,D.eB,B.Hw,h.nI,h.v_,h.$V,J.k0,se.x8,le.iZ,p.X$],styles:["[mat-dialog-content][_ngcontent-%COMP%]   .goal-pane[_ngcontent-%COMP%]{display:flex;flex-direction:column;margin-bottom:5px}[mat-dialog-content][_ngcontent-%COMP%]   .goal-pane[_ngcontent-%COMP%]   mat-form-field[_ngcontent-%COMP%]:not(:first-child){margin-top:10px}[mat-dialog-content][_ngcontent-%COMP%]   .goal-pane[_ngcontent-%COMP%]   mat-form-field[_ngcontent-%COMP%]   input[disabled][_ngcontent-%COMP%]{color:#999}[mat-dialog-content][_ngcontent-%COMP%]   .goal-pane[_ngcontent-%COMP%]   mat-form-field[_ngcontent-%COMP%]   mat-select.mat-select-disabled[_ngcontent-%COMP%]     .mat-select-value{color:#999}[mat-dialog-content][_ngcontent-%COMP%]   .goal-pane[_ngcontent-%COMP%]   mat-form-field.toggle[_ngcontent-%COMP%]   mat-label[_ngcontent-%COMP%]{line-height:20px;height:40px;margin-left:35px;display:flex;align-items:center;color:#444}[mat-dialog-content][_ngcontent-%COMP%]   .goal-pane[_ngcontent-%COMP%]   mat-form-field.toggle[_ngcontent-%COMP%]   mat-label.disabled[_ngcontent-%COMP%]{color:#999}[mat-dialog-content][_ngcontent-%COMP%]   .goal-pane[_ngcontent-%COMP%]   mat-form-field.toggle[_ngcontent-%COMP%]     .mat-form-field-underline{border-bottom:none;bottom:none}[mat-dialog-content][_ngcontent-%COMP%]   .goal-pane[_ngcontent-%COMP%]   mat-form-field.toggle[_ngcontent-%COMP%]     .mat-slide-toggle{padding-top:6px}[mat-dialog-content][_ngcontent-%COMP%]   .goal-pane[_ngcontent-%COMP%]   mat-form-field.toggle[_ngcontent-%COMP%]     .mat-form-field-label-wrapper{height:70px;padding-top:0}[mat-dialog-content][_ngcontent-%COMP%]   .goal-pane[_ngcontent-%COMP%]   mat-form-field.toggle[_ngcontent-%COMP%]     .mat-form-field-label-wrapper .mat-form-field-label{white-space:normal;text-overflow:clip;text-align:left;line-height:20px;margin-left:8px;display:flex;font-size:14px}[mat-dialog-content][_ngcontent-%COMP%]   .goal-pane[_ngcontent-%COMP%]   .binary-field[_ngcontent-%COMP%]{margin-top:10px}[mat-dialog-content][_ngcontent-%COMP%]   .goal-pane[_ngcontent-%COMP%]   .binary-field[_ngcontent-%COMP%]   .label-wrapper[_ngcontent-%COMP%]   mat-label[_ngcontent-%COMP%]{color:#999;font-size:13px;line-height:15px}[mat-dialog-content][_ngcontent-%COMP%]   .goal-pane[_ngcontent-%COMP%]   .binary-field[_ngcontent-%COMP%]   .fields-wrapper[_ngcontent-%COMP%]{display:flex;flex-direction:row;justify-content:stretch}[mat-dialog-content][_ngcontent-%COMP%]   .goal-pane[_ngcontent-%COMP%]   .binary-field[_ngcontent-%COMP%]   .fields-wrapper[_ngcontent-%COMP%]   mat-form-field[_ngcontent-%COMP%]{flex-grow:1;margin-top:0}[mat-dialog-content][_ngcontent-%COMP%]   .goal-pane[_ngcontent-%COMP%]   .binary-field[_ngcontent-%COMP%]   .delimiter[_ngcontent-%COMP%]{width:20px}[mat-dialog-content][_ngcontent-%COMP%]   .goal-pane[_ngcontent-%COMP%]   .settings-header-wrapper[_ngcontent-%COMP%]{display:flex;flex-direction:row;align-items:center;margin-top:10px}[mat-dialog-content][_ngcontent-%COMP%]   .goal-pane[_ngcontent-%COMP%]   .settings-header-wrapper[_ngcontent-%COMP%]   mat-label[_ngcontent-%COMP%]{line-height:24px;margin-left:35px;color:#000000de}[mat-dialog-content][_ngcontent-%COMP%]   .goal-pane[_ngcontent-%COMP%]   .settings-header-wrapper[_ngcontent-%COMP%]   .settings-header[_ngcontent-%COMP%]{font-family:Bpmonline Open Sans Light,sans-serif;font-size:21px;line-height:32px;color:#006ce0;text-align:left;margin-right:15px}[mat-dialog-content][_ngcontent-%COMP%]   .goal-pane[_ngcontent-%COMP%]   .settings-header-wrapper[_ngcontent-%COMP%] + mat-form-field[_ngcontent-%COMP%]{margin-top:15px}[mat-dialog-actions][_ngcontent-%COMP%]{display:flex;flex-direction:row-reverse}[mat-dialog-actions] button[_ngcontent-%COMP%]{margin-left:10px}"]});function It(a,t){if(a&1){const n=e.EpF();e.ynx(0),e.TgZ(1,"a",1),e.NdJ("click",function(r){e.CHM(n);const c=e.oxw();return e.KtG(c.onActionClick(r))}),e._uU(2),e.qZA(),e.BQk()}if(a&2){const n=e.oxw();e.xp6(2),e.Oqu(n.record.name)}}class U extends f.vau{constructor(){super(...arguments),this.getRegisteredEvents=()=>[{name:"actionClick",dataType:String}]}onActionClick(){this.fireEvent("actionClick","edit")}}U.\u0275fac=function(){let a;return function(n){return(a||(a=e.n5z(U)))(n||U)}}(),U.\u0275cmp=e.Xpm({type:U,selectors:[["ts-goal-name-cell"]],features:[e.qOj],decls:1,vars:1,consts:[[4,"ngIf"],[3,"href","click"]],template:function(t,n){t&1&&e.YNc(0,It,3,1,"ng-container",0),t&2&&e.Q6J("ngIf",!n.isEmpty())},dependencies:[g.O5],encapsulation:2});const De=function(a){return{actionClick:a}},Mt=function(a,t){return{itemActions:a,name:t}};class oe{get _isNewResource(){return this.resourceId==="new"&&!(0,m.Z)(this.resourceId)}constructor(t,n,i,r,c){this.goalService=t,this.translateService=n,this.userInfo=i,this.router=r,this.dialogService=c,this.tableDataSource=new f.o6y,this.dataSchema={columns:[{name:"name",caption:this.translateService.instant("Tracking.ResourcePage.GoalDetail.Columns.Name"),valueType:s.DataValueType.Text,cellComponentClass:U},{name:"settings",caption:this.translateService.instant("Tracking.ResourcePage.GoalDetail.Columns.EventTypeFilter"),valueType:s.DataValueType.Text,formatter:this._getEventTypeFilterName.bind(this),sortingDataAccessor:T=>this._getEventTypeFilterName(T.settings)},{name:"isActive",caption:this.translateService.instant("Tracking.ResourcePage.GoalDetail.Columns.Status.Caption"),valueType:s.DataValueType.Text,formatter:this._getStatus.bind(this),sortingDataAccessor:T=>this._getStatus(T.isActive)},{name:"cost",caption:this.translateService.instant("Tracking.ResourcePage.GoalDetail.Columns.Cost"),valueType:s.DataValueType.Text},{name:"itemActions",cellComponentClass:b}]},this.resourceId="new"}_getEventTypeFilterName(t){var n;return(n=t?.eventTypeFilter)===null||n===void 0?void 0:n.toLowerCase()}_getStatus(t){return this.translateService.instant("Tracking.ResourcePage.GoalDetail.Columns.Status."+(t?"Active":"Inactive"))}_loadPageData(){this.goalService.getItemsByResourceId(this.resourceId).subscribe(t=>{this.tableDataSource.data=t.result})}_initPageData(){this._isNewResource||this._loadPageData()}_deleteGoal(t){this.goalService.deleteItem(t).subscribe(()=>{this._loadPageData()})}_deleteGoalConfirmation(t){const n=this.translateService.instant("BaseSection.DeleteRecordConfirmation");this.dialogService.openConfirmationDialog(n).subscribe(i=>{i===u.Zz.result&&this._deleteGoal(t)})}_onDialogClosed(t,n){if((0,m.Z)(t)||t.action===Y.CANCEL)return;const i=r=>{let c="";!r.success&&r.errorInfo&&(c=r.errorInfo.message),c?this.dialogService.openInfoDialog(c):this._loadPageData()};switch(n){case E.ADD:this.goalService.insertItem(t.goal).subscribe(i);break;case E.EDIT:this.goalService.updateItem(t.goal).subscribe(i);break;default:throw new Error("invalid view mode")}}_openEditGoalDialog(t,n){const i={width:"450px",height:"710px",data:{mode:n,goal:t}};this.dialogService.open(te,i).subscribe(r=>this._onDialogClosed(r,n))}ngOnInit(){this._initPageData()}onAddClicked(){if(!this._isNewResource){const t=new Ie;t.resource.id=this.resourceId,this._openEditGoalDialog(t,E.ADD)}}onItemAction(t,n){switch(n){case"delete":this._deleteGoalConfirmation(t);break;case"edit":this._openEditGoalDialog(t,E.EDIT);break;default:console.error("invalid action")}}}oe.\u0275fac=function(t){return new(t||oe)(e.Y36(R),e.Y36(p.sK),e.Y36(d.aoG),e.Y36(j.F0),e.Y36(u.xA))},oe.\u0275cmp=e.Xpm({type:oe,selectors:[["ts-goal-detail"]],inputs:{resourceId:"resourceId"},decls:2,vars:13,consts:[[3,"dataSource","dataSchema","tableEventHandlers","header","addClicked"]],template:function(t,n){t&1&&(e.TgZ(0,"ts-base-detail",0),e.NdJ("addClicked",function(){return n.onAddClicked()}),e.ALo(1,"translate"),e.qZA()),t&2&&e.Q6J("dataSource",n.tableDataSource)("dataSchema",n.dataSchema)("tableEventHandlers",e.WLB(10,Mt,e.VKq(6,De,n.onItemAction.bind(n)),e.VKq(8,De,n.onItemAction.bind(n))))("header",e.lcZ(1,4,"Tracking.ResourcePage.GoalDetail.Header"))},dependencies:[A,p.X$],encapsulation:2});const kt=[{path:"",component:H},{path:"project/:id",component:z},{path:"resource/:id",component:ee}];class v{}v.\u0275fac=function(t){return new(t||v)},v.\u0275mod=e.oAB({type:v}),v.\u0275inj=e.cJS({imports:[j.Bz.forChild(kt),j.Bz]}),function(){(typeof ngJitMode>"u"||ngJitMode)&&e.kYT(v,{imports:[j.Bz],exports:[j.Bz]})}();class G{}G.\u0275fac=function(t){return new(t||G)},G.\u0275mod=e.oAB({type:G}),G.\u0275inj=e.cJS({providers:[f.Pnv,{provide:f.thQ,useValue:"TrackingModule"},k,I,q,x,V,L,w,M,N,R,F,Z,be.lI],imports:[o.u5,o.UX,g.ez,u.z8,re.D8,Oe.AA,Pe.U5,D.yu,B.Ps,J.x4,Te.jT,se.uw,ye.JX,ve.t,pe.To,ce.Nn,u.Su,v,p.aw,f.kLW,u.eR,o.u5,le.Wd,u._M,y,_.nD]}),function(){(typeof ngJitMode>"u"||ngJitMode)&&e.kYT(G,{declarations:[H,b,z,W,A,K,oe,S,X,$,ee,te,U],imports:[o.u5,o.UX,g.ez,u.z8,re.D8,Oe.AA,Pe.U5,D.yu,B.Ps,J.x4,Te.jT,se.uw,ye.JX,ve.t,pe.To,ce.Nn,u.Su,v,p.aw,f.kLW,u.eR,o.u5,le.Wd,u._M,y,_.nD]})}();const Zt={PingTenantResult:{ErrorMessage:"",Status:1}},Dt=[{Id:(0,s.generateGuid)(),Name:"Cinema network",Owner:{value:"c4ed336c-3e9b-40fe-8b82-5632476472b4",displayValue:"Peter Adams",primaryImageValue:""},Description:"10 cinemas + 1 site + 1 app",CreatedOn:"2020-03-27T13:52:21.930",ModifiedOn:""},{Id:(0,s.generateGuid)(),Name:"Pizza service",Owner:{value:"c4ed336c-3e9b-40fe-8b82-5632476472b1",displayValue:"Stan Smith",primaryImageValue:""},Description:"1 site + 1 app",CreatedOn:"2020-03-27T13:52:21.930",ModifiedOn:""},{Id:(0,s.generateGuid)(),Name:"Omnichannel reteil",Owner:{value:"c4ed336c-3e9b-40fe-8b82-5632476472b4",displayValue:"Peter Adams",primaryImageValue:""},Description:"25 stores + 2 apps + site",CreatedOn:"2020-03-27T13:52:21.930",ModifiedOn:""},{Id:(0,s.generateGuid)(),Name:"Lawer firm",Owner:{value:"c4ed336c-3e9b-40fe-8b82-5632476472b4",displayValue:"Peter Adams",primaryImageValue:""},Description:"1 site",CreatedOn:"2020-03-27T13:52:21.930",ModifiedOn:""},{Id:(0,s.generateGuid)(),Name:"Bank",Owner:{value:"c4ed336c-3e9b-40fe-8b82-5632476472b4",displayValue:"Peter Adams",primaryImageValue:""},Description:"1 site + 1 app",CreatedOn:"2020-03-27T13:52:21.930",ModifiedOn:""}],At=[{Id:(0,s.generateGuid)(),CreatedOn:"2019-03-27T13:52:21.930",ModifiedOn:"2020-03-27T13:52:21.930",Name:"First resource",Project:{value:"c4ed336c-3e9b-40fe-8b82-5632476472b4",displayValue:"Main project",primaryImageValue:""},IsActive:!0,IsDeleted:!1,Source:"https://first.com"},{Id:(0,s.generateGuid)(),CreatedOn:"2019-03-27T13:52:21.930",ModifiedOn:"2020-03-27T13:52:21.930",Name:"Second resource",Project:{value:"c4ed336c-3e9b-40fe-8b82-5632476472b4",displayValue:"Main project",primaryImageValue:""},IsActive:!1,IsDeleted:!0,Source:"https://second.com"}],St=[{Id:(0,s.generateGuid)(),Name:"Poster already downloaded (UseEventCost true)",Resource:{value:"c4ed336c-3e9b-40fe-8b82-5632476472b1",displayValue:"test resource",primaryImageValue:""},IsActive:!0,IsDeleted:!1,Cost:0,UseEventCost:!0,Settings:`{
			"eventTypeFilter": "CLICK",
			"eventNameFilterType": "EQUAL",
			"eventNameFilterData": "1",
			"eventValueFilterType": "EQUAL",
			"eventValueFilterData": "1",
			"eventCostFilterType": "EQUAL",
			"eventCostFilterData":"1"
		}`,CreaatedOn:"2020-03-27T13:52:21.930",ModifiedOn:""},{Id:(0,s.generateGuid)(),Name:"Poster already downloaded 2 (UseEventCost false)",Resource:{value:"c4ed336c-3e9b-40fe-8b82-5632476472b1",displayValue:"test resource",primaryImageValue:""},IsActive:!0,IsDeleted:!1,Cost:10,UseEventCost:!1,Settings:"{}",CreaatedOn:"2020-03-27T13:52:21.930",ModifiedOn:""}],Et={GetInfoResult:{ErrorMessage:"",Status:1,TenantId:(0,s.generateGuid)()}}}}]);
