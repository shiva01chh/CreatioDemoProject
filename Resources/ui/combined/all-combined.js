!function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var c="function"==typeof require&&require;if(!u&&c)return c(o,!0);if(i)return i(o,!0);var a=new Error("Cannot find module '"+o+"'");throw a.code="MODULE_NOT_FOUND",a}var f=n[o]={exports:{}};t[o][0].call(f.exports,function(n){var r=t[o][1][n];return s(r||n)},f,f.exports,e,t,n,r)}return n[o].exports}for(var i="function"==typeof require&&require,o=0;o<r.length;o++)s(r[o]);return s}({1:[function(t,n,r){(function(n){"use strict";function define(t,n,e){t[n]||Object[r](t,n,{writable:!0,configurable:!0,value:e})}if(t(327),t(328),t(2),n._babelPolyfill)throw new Error("only one instance of babel-polyfill is allowed");n._babelPolyfill=!0;var r="defineProperty";define(String.prototype,"padLeft","".padStart),define(String.prototype,"padRight","".padEnd),"pop,reverse,shift,keys,values,entries,indexOf,every,some,forEach,map,filter,find,findIndex,includes,join,slice,concat,push,splice,unshift,sort,lastIndexOf,reduce,reduceRight,copyWithin,fill".split(",").forEach(function(t){[][t]&&define(Array,t,Function.call.bind([][t]))})}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{2:2,327:327,328:328}],2:[function(t,n,r){t(130),n.exports=t(23).RegExp.escape},{130:130,23:23}],3:[function(t,n,r){n.exports=function(t){if("function"!=typeof t)throw TypeError(t+" is not a function!");return t}},{}],4:[function(t,n,r){var e=t(18);n.exports=function(t,n){if("number"!=typeof t&&"Number"!=e(t))throw TypeError(n);return+t}},{18:18}],5:[function(t,n,r){var e=t(128)("unscopables"),i=Array.prototype;void 0==i[e]&&t(42)(i,e,{}),n.exports=function(t){i[e][t]=!0}},{128:128,42:42}],6:[function(t,n,r){n.exports=function(t,n,r,e){if(!(t instanceof n)||void 0!==e&&e in t)throw TypeError(r+": incorrect invocation!");return t}},{}],7:[function(t,n,r){var e=t(51);n.exports=function(t){if(!e(t))throw TypeError(t+" is not an object!");return t}},{51:51}],8:[function(t,n,r){"use strict";var e=t(119),i=t(114),o=t(118);n.exports=[].copyWithin||function copyWithin(t,n){var r=e(this),u=o(r.length),c=i(t,u),a=i(n,u),f=arguments.length>2?arguments[2]:void 0,s=Math.min((void 0===f?u:i(f,u))-a,u-c),l=1;for(a<c&&c<a+s&&(l=-1,a+=s-1,c+=s-1);s-- >0;)a in r?r[c]=r[a]:delete r[c],c+=l,a+=l;return r}},{114:114,118:118,119:119}],9:[function(t,n,r){"use strict";var e=t(119),i=t(114),o=t(118);n.exports=function fill(t){for(var n=e(this),r=o(n.length),u=arguments.length,c=i(u>1?arguments[1]:void 0,r),a=u>2?arguments[2]:void 0,f=void 0===a?r:i(a,r);f>c;)n[c++]=t;return n}},{114:114,118:118,119:119}],10:[function(t,n,r){var e=t(39);n.exports=function(t,n){var r=[];return e(t,!1,r.push,r,n),r}},{39:39}],11:[function(t,n,r){var e=t(117),i=t(118),o=t(114);n.exports=function(t){return function(n,r,u){var c,a=e(n),f=i(a.length),s=o(u,f);if(t&&r!=r){for(;f>s;)if((c=a[s++])!=c)return!0}else for(;f>s;s++)if((t||s in a)&&a[s]===r)return t||s||0;return!t&&-1}}},{114:114,117:117,118:118}],12:[function(t,n,r){var e=t(25),i=t(47),o=t(119),u=t(118),c=t(15);n.exports=function(t,n){var r=1==t,a=2==t,f=3==t,s=4==t,l=6==t,h=5==t||l,v=n||c;return function(n,c,p){for(var d,y,g=o(n),m=i(g),b=e(c,p,3),x=u(m.length),S=0,w=r?v(n,x):a?v(n,0):void 0;x>S;S++)if((h||S in m)&&(d=m[S],y=b(d,S,g),t))if(r)w[S]=y;else if(y)switch(t){case 3:return!0;case 5:return d;case 6:return S;case 2:w.push(d)}else if(s)return!1;return l?-1:f||s?s:w}}},{118:118,119:119,15:15,25:25,47:47}],13:[function(t,n,r){var e=t(3),i=t(119),o=t(47),u=t(118);n.exports=function(t,n,r,c,a){e(n);var f=i(t),s=o(f),l=u(f.length),h=a?l-1:0,v=a?-1:1;if(r<2)for(;;){if(h in s){c=s[h],h+=v;break}if(h+=v,a?h<0:l<=h)throw TypeError("Reduce of empty array with no initial value")}for(;a?h>=0:l>h;h+=v)h in s&&(c=n(c,s[h],h,f));return c}},{118:118,119:119,3:3,47:47}],14:[function(t,n,r){var e=t(51),i=t(49),o=t(128)("species");n.exports=function(t){var n;return i(t)&&(n=t.constructor,"function"!=typeof n||n!==Array&&!i(n.prototype)||(n=void 0),e(n)&&null===(n=n[o])&&(n=void 0)),void 0===n?Array:n}},{128:128,49:49,51:51}],15:[function(t,n,r){var e=t(14);n.exports=function(t,n){return new(e(t))(n)}},{14:14}],16:[function(t,n,r){"use strict";var e=t(3),i=t(51),o=t(46),u=[].slice,c={},a=function(t,n,r){if(!(n in c)){for(var e=[],i=0;i<n;i++)e[i]="a["+i+"]";c[n]=Function("F,a","return new F("+e.join(",")+")")}return c[n](t,r)};n.exports=Function.bind||function bind(t){var n=e(this),r=u.call(arguments,1),c=function(){var e=r.concat(u.call(arguments));return this instanceof c?a(n,e.length,e):o(n,e,t)};return i(n.prototype)&&(c.prototype=n.prototype),c}},{3:3,46:46,51:51}],17:[function(t,n,r){var e=t(18),i=t(128)("toStringTag"),o="Arguments"==e(function(){return arguments}()),u=function(t,n){try{return t[n]}catch(t){}};n.exports=function(t){var n,r,c;return void 0===t?"Undefined":null===t?"Null":"string"==typeof(r=u(n=Object(t),i))?r:o?e(n):"Object"==(c=e(n))&&"function"==typeof n.callee?"Arguments":c}},{128:128,18:18}],18:[function(t,n,r){var e={}.toString;n.exports=function(t){return e.call(t).slice(8,-1)}},{}],19:[function(t,n,r){"use strict";var e=t(72).f,i=t(71),o=t(93),u=t(25),c=t(6),a=t(39),f=t(55),s=t(57),l=t(100),h=t(29),v=t(66).fastKey,p=t(125),d=h?"_s":"size",y=function(t,n){var r,e=v(n);if("F"!==e)return t._i[e];for(r=t._f;r;r=r.n)if(r.k==n)return r};n.exports={getConstructor:function(t,n,r,f){var s=t(function(t,e){c(t,s,n,"_i"),t._t=n,t._i=i(null),t._f=void 0,t._l=void 0,t[d]=0,void 0!=e&&a(e,r,t[f],t)});return o(s.prototype,{clear:function clear(){for(var t=p(this,n),r=t._i,e=t._f;e;e=e.n)e.r=!0,e.p&&(e.p=e.p.n=void 0),delete r[e.i];t._f=t._l=void 0,t[d]=0},delete:function(t){var r=p(this,n),e=y(r,t);if(e){var i=e.n,o=e.p;delete r._i[e.i],e.r=!0,o&&(o.n=i),i&&(i.p=o),r._f==e&&(r._f=i),r._l==e&&(r._l=o),r[d]--}return!!e},forEach:function forEach(t){p(this,n);for(var r,e=u(t,arguments.length>1?arguments[1]:void 0,3);r=r?r.n:this._f;)for(e(r.v,r.k,this);r&&r.r;)r=r.p},has:function has(t){return!!y(p(this,n),t)}}),h&&e(s.prototype,"size",{get:function(){return p(this,n)[d]}}),s},def:function(t,n,r){var e,i,o=y(t,n);return o?o.v=r:(t._l=o={i:i=v(n,!0),k:n,v:r,p:e=t._l,n:void 0,r:!1},t._f||(t._f=o),e&&(e.n=o),t[d]++,"F"!==i&&(t._i[i]=o)),t},getEntry:y,setStrong:function(t,n,r){f(t,n,function(t,r){this._t=p(t,n),this._k=r,this._l=void 0},function(){for(var t=this,n=t._k,r=t._l;r&&r.r;)r=r.p;return t._t&&(t._l=r=r?r.n:t._t._f)?"keys"==n?s(0,r.k):"values"==n?s(0,r.v):s(0,[r.k,r.v]):(t._t=void 0,s(1))},r?"entries":"values",!r,!0),l(n)}}},{100:100,125:125,25:25,29:29,39:39,55:55,57:57,6:6,66:66,71:71,72:72,93:93}],20:[function(t,n,r){var e=t(17),i=t(10);n.exports=function(t){return function toJSON(){if(e(this)!=t)throw TypeError(t+"#toJSON isn't generic");return i(this)}}},{10:10,17:17}],21:[function(t,n,r){"use strict";var e=t(93),i=t(66).getWeak,o=t(7),u=t(51),c=t(6),a=t(39),f=t(12),s=t(41),l=t(125),h=f(5),v=f(6),p=0,d=function(t){return t._l||(t._l=new y)},y=function(){this.a=[]},g=function(t,n){return h(t.a,function(t){return t[0]===n})};y.prototype={get:function(t){var n=g(this,t);if(n)return n[1]},has:function(t){return!!g(this,t)},set:function(t,n){var r=g(this,t);r?r[1]=n:this.a.push([t,n])},delete:function(t){var n=v(this.a,function(n){return n[0]===t});return~n&&this.a.splice(n,1),!!~n}},n.exports={getConstructor:function(t,n,r,o){var f=t(function(t,e){c(t,f,n,"_i"),t._t=n,t._i=p++,t._l=void 0,void 0!=e&&a(e,r,t[o],t)});return e(f.prototype,{delete:function(t){if(!u(t))return!1;var r=i(t);return!0===r?d(l(this,n)).delete(t):r&&s(r,this._i)&&delete r[this._i]},has:function has(t){if(!u(t))return!1;var r=i(t);return!0===r?d(l(this,n)).has(t):r&&s(r,this._i)}}),f},def:function(t,n,r){var e=i(o(n),!0);return!0===e?d(t).set(n,r):e[t._i]=r,t},ufstore:d}},{12:12,125:125,39:39,41:41,51:51,6:6,66:66,7:7,93:93}],22:[function(t,n,r){"use strict";var e=t(40),i=t(33),o=t(94),u=t(93),c=t(66),a=t(39),f=t(6),s=t(51),l=t(35),h=t(56),v=t(101),p=t(45);n.exports=function(t,n,r,d,y,g){var m=e[t],b=m,x=y?"set":"add",S=b&&b.prototype,w={},_=function(t){var n=S[t];o(S,t,"delete"==t?function(t){return!(g&&!s(t))&&n.call(this,0===t?0:t)}:"has"==t?function has(t){return!(g&&!s(t))&&n.call(this,0===t?0:t)}:"get"==t?function get(t){return g&&!s(t)?void 0:n.call(this,0===t?0:t)}:"add"==t?function add(t){return n.call(this,0===t?0:t),this}:function set(t,r){return n.call(this,0===t?0:t,r),this})};if("function"==typeof b&&(g||S.forEach&&!l(function(){(new b).entries().next()}))){var E=new b,O=E[x](g?{}:-0,1)!=E,P=l(function(){E.has(1)}),M=h(function(t){new b(t)}),F=!g&&l(function(){for(var t=new b,n=5;n--;)t[x](n,n);return!t.has(-0)});M||(b=n(function(n,r){f(n,b,t);var e=p(new m,n,b);return void 0!=r&&a(r,y,e[x],e),e}),b.prototype=S,S.constructor=b),(P||F)&&(_("delete"),_("has"),y&&_("get")),(F||O)&&_(x),g&&S.clear&&delete S.clear}else b=d.getConstructor(n,t,y,x),u(b.prototype,r),c.NEED=!0;return v(b,t),w[t]=b,i(i.G+i.W+i.F*(b!=m),w),g||d.setStrong(b,t,y),b}},{101:101,33:33,35:35,39:39,40:40,45:45,51:51,56:56,6:6,66:66,93:93,94:94}],23:[function(t,n,r){var e=n.exports={version:"2.5.0"};"number"==typeof __e&&(__e=e)},{}],24:[function(t,n,r){"use strict";var e=t(72),i=t(92);n.exports=function(t,n,r){n in t?e.f(t,n,i(0,r)):t[n]=r}},{72:72,92:92}],25:[function(t,n,r){var e=t(3);n.exports=function(t,n,r){if(e(t),void 0===n)return t;switch(r){case 1:return function(r){return t.call(n,r)};case 2:return function(r,e){return t.call(n,r,e)};case 3:return function(r,e,i){return t.call(n,r,e,i)}}return function(){return t.apply(n,arguments)}}},{3:3}],26:[function(t,n,r){"use strict";var e=t(35),i=Date.prototype.getTime,o=Date.prototype.toISOString,u=function(t){return t>9?t:"0"+t};n.exports=e(function(){return"0385-07-25T07:06:39.999Z"!=o.call(new Date(-5e13-1))})||!e(function(){o.call(new Date(NaN))})?function toISOString(){if(!isFinite(i.call(this)))throw RangeError("Invalid time value");var t=this,n=t.getUTCFullYear(),r=t.getUTCMilliseconds(),e=n<0?"-":n>9999?"+":"";return e+("00000"+Math.abs(n)).slice(e?-6:-4)+"-"+u(t.getUTCMonth()+1)+"-"+u(t.getUTCDate())+"T"+u(t.getUTCHours())+":"+u(t.getUTCMinutes())+":"+u(t.getUTCSeconds())+"."+(r>99?r:"0"+u(r))+"Z"}:o},{35:35}],27:[function(t,n,r){"use strict";var e=t(7),i=t(120);n.exports=function(t){if("string"!==t&&"number"!==t&&"default"!==t)throw TypeError("Incorrect hint");return i(e(this),"number"!=t)}},{120:120,7:7}],28:[function(t,n,r){n.exports=function(t){if(void 0==t)throw TypeError("Can't call method on  "+t);return t}},{}],29:[function(t,n,r){n.exports=!t(35)(function(){return 7!=Object.defineProperty({},"a",{get:function(){return 7}}).a})},{35:35}],30:[function(t,n,r){var e=t(51),i=t(40).document,o=e(i)&&e(i.createElement);n.exports=function(t){return o?i.createElement(t):{}}},{40:40,51:51}],31:[function(t,n,r){n.exports="constructor,hasOwnProperty,isPrototypeOf,propertyIsEnumerable,toLocaleString,toString,valueOf".split(",")},{}],32:[function(t,n,r){var e=t(81),i=t(78),o=t(82);n.exports=function(t){var n=e(t),r=i.f;if(r)for(var u,c=r(t),a=o.f,f=0;c.length>f;)a.call(t,u=c[f++])&&n.push(u);return n}},{78:78,81:81,82:82}],33:[function(t,n,r){var e=t(40),i=t(23),o=t(42),u=t(94),c=t(25),a=function(t,n,r){var f,s,l,h,v=t&a.F,p=t&a.G,d=t&a.S,y=t&a.P,g=t&a.B,m=p?e:d?e[n]||(e[n]={}):(e[n]||{}).prototype,b=p?i:i[n]||(i[n]={}),x=b.prototype||(b.prototype={});p&&(r=n);for(f in r)s=!v&&m&&void 0!==m[f],l=(s?m:r)[f],h=g&&s?c(l,e):y&&"function"==typeof l?c(Function.call,l):l,m&&u(m,f,l,t&a.U),b[f]!=l&&o(b,f,h),y&&x[f]!=l&&(x[f]=l)};e.core=i,a.F=1,a.G=2,a.S=4,a.P=8,a.B=16,a.W=32,a.U=64,a.R=128,n.exports=a},{23:23,25:25,40:40,42:42,94:94}],34:[function(t,n,r){var e=t(128)("match");n.exports=function(t){var n=/./;try{"/./"[t](n)}catch(r){try{return n[e]=!1,!"/./"[t](n)}catch(t){}}return!0}},{128:128}],35:[function(t,n,r){n.exports=function(t){try{return!!t()}catch(t){return!0}}},{}],36:[function(t,n,r){"use strict";var e=t(42),i=t(94),o=t(35),u=t(28),c=t(128);n.exports=function(t,n,r){var a=c(t),f=r(u,a,""[t]),s=f[0],l=f[1];o(function(){var n={};return n[a]=function(){return 7},7!=""[t](n)})&&(i(String.prototype,t,s),e(RegExp.prototype,a,2==n?function(t,n){return l.call(t,this,n)}:function(t){return l.call(t,this)}))}},{128:128,28:28,35:35,42:42,94:94}],37:[function(t,n,r){"use strict";var e=t(7);n.exports=function(){var t=e(this),n="";return t.global&&(n+="g"),t.ignoreCase&&(n+="i"),t.multiline&&(n+="m"),t.unicode&&(n+="u"),t.sticky&&(n+="y"),n}},{7:7}],38:[function(t,n,r){"use strict";function flattenIntoArray(t,n,r,a,f,s,l,h){for(var v,p,d=f,y=0,g=!!l&&u(l,h,3);y<a;){if(y in r){if(v=g?g(r[y],y,n):r[y],p=!1,i(v)&&(p=v[c],p=void 0!==p?!!p:e(v)),p&&s>0)d=flattenIntoArray(t,n,v,o(v.length),d,s-1)-1;else{if(d>=9007199254740991)throw TypeError();t[d]=v}d++}y++}return d}var e=t(49),i=t(51),o=t(118),u=t(25),c=t(128)("isConcatSpreadable");n.exports=flattenIntoArray},{118:118,128:128,25:25,49:49,51:51}],39:[function(t,n,r){var e=t(25),i=t(53),o=t(48),u=t(7),c=t(118),a=t(129),f={},s={},r=n.exports=function(t,n,r,l,h){var v,p,d,y,g=h?function(){return t}:a(t),m=e(r,l,n?2:1),b=0;if("function"!=typeof g)throw TypeError(t+" is not iterable!");if(o(g)){for(v=c(t.length);v>b;b++)if((y=n?m(u(p=t[b])[0],p[1]):m(t[b]))===f||y===s)return y}else for(d=g.call(t);!(p=d.next()).done;)if((y=i(d,m,p.value,n))===f||y===s)return y};r.BREAK=f,r.RETURN=s},{118:118,129:129,25:25,48:48,53:53,7:7}],40:[function(t,n,r){var e=n.exports="undefined"!=typeof window&&window.Math==Math?window:"undefined"!=typeof self&&self.Math==Math?self:Function("return this")();"number"==typeof __g&&(__g=e)},{}],41:[function(t,n,r){var e={}.hasOwnProperty;n.exports=function(t,n){return e.call(t,n)}},{}],42:[function(t,n,r){var e=t(72),i=t(92);n.exports=t(29)?function(t,n,r){return e.f(t,n,i(1,r))}:function(t,n,r){return t[n]=r,t}},{29:29,72:72,92:92}],43:[function(t,n,r){var e=t(40).document;n.exports=e&&e.documentElement},{40:40}],44:[function(t,n,r){n.exports=!t(29)&&!t(35)(function(){return 7!=Object.defineProperty(t(30)("div"),"a",{get:function(){return 7}}).a})},{29:29,30:30,35:35}],45:[function(t,n,r){var e=t(51),i=t(99).set;n.exports=function(t,n,r){var o,u=n.constructor;return u!==r&&"function"==typeof u&&(o=u.prototype)!==r.prototype&&e(o)&&i&&i(t,o),t}},{51:51,99:99}],46:[function(t,n,r){n.exports=function(t,n,r){var e=void 0===r;switch(n.length){case 0:return e?t():t.call(r);case 1:return e?t(n[0]):t.call(r,n[0]);case 2:return e?t(n[0],n[1]):t.call(r,n[0],n[1]);case 3:return e?t(n[0],n[1],n[2]):t.call(r,n[0],n[1],n[2]);case 4:return e?t(n[0],n[1],n[2],n[3]):t.call(r,n[0],n[1],n[2],n[3])}return t.apply(r,n)}},{}],47:[function(t,n,r){var e=t(18);n.exports=Object("z").propertyIsEnumerable(0)?Object:function(t){return"String"==e(t)?t.split(""):Object(t)}},{18:18}],48:[function(t,n,r){var e=t(58),i=t(128)("iterator"),o=Array.prototype;n.exports=function(t){return void 0!==t&&(e.Array===t||o[i]===t)}},{128:128,58:58}],49:[function(t,n,r){var e=t(18);n.exports=Array.isArray||function isArray(t){return"Array"==e(t)}},{18:18}],50:[function(t,n,r){var e=t(51),i=Math.floor;n.exports=function isInteger(t){return!e(t)&&isFinite(t)&&i(t)===t}},{51:51}],51:[function(t,n,r){n.exports=function(t){return"object"==typeof t?null!==t:"function"==typeof t}},{}],52:[function(t,n,r){var e=t(51),i=t(18),o=t(128)("match");n.exports=function(t){var n;return e(t)&&(void 0!==(n=t[o])?!!n:"RegExp"==i(t))}},{128:128,18:18,51:51}],53:[function(t,n,r){var e=t(7);n.exports=function(t,n,r,i){try{return i?n(e(r)[0],r[1]):n(r)}catch(n){var o=t.return;throw void 0!==o&&e(o.call(t)),n}}},{7:7}],54:[function(t,n,r){"use strict";var e=t(71),i=t(92),o=t(101),u={};t(42)(u,t(128)("iterator"),function(){return this}),n.exports=function(t,n,r){t.prototype=e(u,{next:i(1,r)}),o(t,n+" Iterator")}},{101:101,128:128,42:42,71:71,92:92}],55:[function(t,n,r){"use strict";var e=t(60),i=t(33),o=t(94),u=t(42),c=t(41),a=t(58),f=t(54),s=t(101),l=t(79),h=t(128)("iterator"),v=!([].keys&&"next"in[].keys()),p=function(){return this};n.exports=function(t,n,r,d,y,g,m){f(r,n,d);var b,x,S,w=function(t){if(!v&&t in P)return P[t];switch(t){case"keys":return function keys(){return new r(this,t)};case"values":return function values(){return new r(this,t)}}return function entries(){return new r(this,t)}},_=n+" Iterator",E="values"==y,O=!1,P=t.prototype,M=P[h]||P["@@iterator"]||y&&P[y],F=M||w(y),I=y?E?w("entries"):F:void 0,A="Array"==n?P.entries||M:M;if(A&&(S=l(A.call(new t)))!==Object.prototype&&S.next&&(s(S,_,!0),e||c(S,h)||u(S,h,p)),E&&M&&"values"!==M.name&&(O=!0,F=function values(){return M.call(this)}),e&&!m||!v&&!O&&P[h]||u(P,h,F),a[n]=F,a[_]=p,y)if(b={values:E?F:w("values"),keys:g?F:w("keys"),entries:I},m)for(x in b)x in P||o(P,x,b[x]);else i(i.P+i.F*(v||O),n,b);return b}},{101:101,128:128,33:33,41:41,42:42,54:54,58:58,60:60,79:79,94:94}],56:[function(t,n,r){var e=t(128)("iterator"),i=!1;try{var o=[7][e]();o.return=function(){i=!0},Array.from(o,function(){throw 2})}catch(t){}n.exports=function(t,n){if(!n&&!i)return!1;var r=!1;try{var o=[7],u=o[e]();u.next=function(){return{done:r=!0}},o[e]=function(){return u},t(o)}catch(t){}return r}},{128:128}],57:[function(t,n,r){n.exports=function(t,n){return{value:n,done:!!t}}},{}],58:[function(t,n,r){n.exports={}},{}],59:[function(t,n,r){var e=t(81),i=t(117);n.exports=function(t,n){for(var r,o=i(t),u=e(o),c=u.length,a=0;c>a;)if(o[r=u[a++]]===n)return r}},{117:117,81:81}],60:[function(t,n,r){n.exports=!1},{}],61:[function(t,n,r){var e=Math.expm1;n.exports=!e||e(10)>22025.465794806718||e(10)<22025.465794806718||-2e-17!=e(-2e-17)?function expm1(t){return 0==(t=+t)?t:t>-1e-6&&t<1e-6?t+t*t/2:Math.exp(t)-1}:e},{}],62:[function(t,n,r){var e=t(65),i=Math.pow,o=i(2,-52),u=i(2,-23),c=i(2,127)*(2-u),a=i(2,-126),f=function(t){return t+1/o-1/o};n.exports=Math.fround||function fround(t){var n,r,i=Math.abs(t),s=e(t);return i<a?s*f(i/a/u)*a*u:(n=(1+u/o)*i,r=n-(n-i),r>c||r!=r?s*(1/0):s*r)}},{65:65}],63:[function(t,n,r){n.exports=Math.log1p||function log1p(t){return(t=+t)>-1e-8&&t<1e-8?t-t*t/2:Math.log(1+t)}},{}],64:[function(t,n,r){n.exports=Math.scale||function scale(t,n,r,e,i){return 0===arguments.length||t!=t||n!=n||r!=r||e!=e||i!=i?NaN:t===1/0||t===-1/0?t:(t-n)*(i-e)/(r-n)+e}},{}],65:[function(t,n,r){n.exports=Math.sign||function sign(t){return 0==(t=+t)||t!=t?t:t<0?-1:1}},{}],66:[function(t,n,r){var e=t(124)("meta"),i=t(51),o=t(41),u=t(72).f,c=0,a=Object.isExtensible||function(){return!0},f=!t(35)(function(){return a(Object.preventExtensions({}))}),s=function(t){u(t,e,{value:{i:"O"+ ++c,w:{}}})},l=function(t,n){if(!i(t))return"symbol"==typeof t?t:("string"==typeof t?"S":"P")+t;if(!o(t,e)){if(!a(t))return"F";if(!n)return"E";s(t)}return t[e].i},h=function(t,n){if(!o(t,e)){if(!a(t))return!0;if(!n)return!1;s(t)}return t[e].w},v=function(t){return f&&p.NEED&&a(t)&&!o(t,e)&&s(t),t},p=n.exports={KEY:e,NEED:!1,fastKey:l,getWeak:h,onFreeze:v}},{124:124,35:35,41:41,51:51,72:72}],67:[function(t,n,r){var e=t(160),i=t(33),o=t(103)("metadata"),u=o.store||(o.store=new(t(266))),c=function(t,n,r){var i=u.get(t);if(!i){if(!r)return;u.set(t,i=new e)}var o=i.get(n);if(!o){if(!r)return;i.set(n,o=new e)}return o},a=function(t,n,r){var e=c(n,r,!1);return void 0!==e&&e.has(t)},f=function(t,n,r){var e=c(n,r,!1);return void 0===e?void 0:e.get(t)},s=function(t,n,r,e){c(r,e,!0).set(t,n)},l=function(t,n){var r=c(t,n,!1),e=[];return r&&r.forEach(function(t,n){e.push(n)}),e},h=function(t){return void 0===t||"symbol"==typeof t?t:String(t)},v=function(t){i(i.S,"Reflect",t)};n.exports={store:u,map:c,has:a,get:f,set:s,keys:l,key:h,exp:v}},{103:103,160:160,266:266,33:33}],68:[function(t,n,r){var e=t(40),i=t(113).set,o=e.MutationObserver||e.WebKitMutationObserver,u=e.process,c=e.Promise,a="process"==t(18)(u);n.exports=function(){var t,n,r,f=function(){var e,i;for(a&&(e=u.domain)&&e.exit();t;){i=t.fn,t=t.next;try{i()}catch(e){throw t?r():n=void 0,e}}n=void 0,e&&e.enter()};if(a)r=function(){u.nextTick(f)};else if(o){var s=!0,l=document.createTextNode("");new o(f).observe(l,{characterData:!0}),r=function(){l.data=s=!s}}else if(c&&c.resolve){var h=c.resolve();r=function(){h.then(f)}}else r=function(){i.call(e,f)};return function(e){var i={fn:e,next:void 0};n&&(n.next=i),t||(t=i,r()),n=i}}},{113:113,18:18,40:40}],69:[function(t,n,r){"use strict";function PromiseCapability(t){var n,r;this.promise=new t(function(t,e){if(void 0!==n||void 0!==r)throw TypeError("Bad Promise constructor");n=t,r=e}),this.resolve=e(n),this.reject=e(r)}var e=t(3);n.exports.f=function(t){return new PromiseCapability(t)}},{3:3}],70:[function(t,n,r){"use strict";var e=t(81),i=t(78),o=t(82),u=t(119),c=t(47),a=Object.assign;n.exports=!a||t(35)(function(){var t={},n={},r=Symbol(),e="abcdefghijklmnopqrst";return t[r]=7,e.split("").forEach(function(t){n[t]=t}),7!=a({},t)[r]||Object.keys(a({},n)).join("")!=e})?function assign(t,n){for(var r=u(t),a=arguments.length,f=1,s=i.f,l=o.f;a>f;)for(var h,v=c(arguments[f++]),p=s?e(v).concat(s(v)):e(v),d=p.length,y=0;d>y;)l.call(v,h=p[y++])&&(r[h]=v[h]);return r}:a},{119:119,35:35,47:47,78:78,81:81,82:82}],71:[function(t,n,r){var e=t(7),i=t(73),o=t(31),u=t(102)("IE_PROTO"),c=function(){},a=function(){var n,r=t(30)("iframe"),e=o.length;for(r.style.display="none",t(43).appendChild(r),r.src="javascript:",n=r.contentWindow.document,n.open(),n.write("<script>document.F=Object<\/script>"),n.close(),a=n.F;e--;)delete a.prototype[o[e]];return a()};n.exports=Object.create||function create(t,n){var r;return null!==t?(c.prototype=e(t),r=new c,c.prototype=null,r[u]=t):r=a(),void 0===n?r:i(r,n)}},{102:102,30:30,31:31,43:43,7:7,73:73}],72:[function(t,n,r){var e=t(7),i=t(44),o=t(120),u=Object.defineProperty;r.f=t(29)?Object.defineProperty:function defineProperty(t,n,r){if(e(t),n=o(n,!0),e(r),i)try{return u(t,n,r)}catch(t){}if("get"in r||"set"in r)throw TypeError("Accessors not supported!");return"value"in r&&(t[n]=r.value),t}},{120:120,29:29,44:44,7:7}],73:[function(t,n,r){var e=t(72),i=t(7),o=t(81);n.exports=t(29)?Object.defineProperties:function defineProperties(t,n){i(t);for(var r,u=o(n),c=u.length,a=0;c>a;)e.f(t,r=u[a++],n[r]);return t}},{29:29,7:7,72:72,81:81}],74:[function(t,n,r){"use strict";n.exports=t(60)||!t(35)(function(){var n=Math.random();__defineSetter__.call(null,n,function(){}),delete t(40)[n]})},{35:35,40:40,60:60}],75:[function(t,n,r){var e=t(82),i=t(92),o=t(117),u=t(120),c=t(41),a=t(44),f=Object.getOwnPropertyDescriptor;r.f=t(29)?f:function getOwnPropertyDescriptor(t,n){if(t=o(t),n=u(n,!0),a)try{return f(t,n)}catch(t){}if(c(t,n))return i(!e.f.call(t,n),t[n])}},{117:117,120:120,29:29,41:41,44:44,82:82,92:92}],76:[function(t,n,r){var e=t(117),i=t(77).f,o={}.toString,u="object"==typeof window&&window&&Object.getOwnPropertyNames?Object.getOwnPropertyNames(window):[],c=function(t){try{return i(t)}catch(t){return u.slice()}};n.exports.f=function getOwnPropertyNames(t){return u&&"[object Window]"==o.call(t)?c(t):i(e(t))}},{117:117,77:77}],77:[function(t,n,r){var e=t(80),i=t(31).concat("length","prototype");r.f=Object.getOwnPropertyNames||function getOwnPropertyNames(t){return e(t,i)}},{31:31,80:80}],78:[function(t,n,r){r.f=Object.getOwnPropertySymbols},{}],79:[function(t,n,r){var e=t(41),i=t(119),o=t(102)("IE_PROTO"),u=Object.prototype;n.exports=Object.getPrototypeOf||function(t){return t=i(t),e(t,o)?t[o]:"function"==typeof t.constructor&&t instanceof t.constructor?t.constructor.prototype:t instanceof Object?u:null}},{102:102,119:119,41:41}],80:[function(t,n,r){var e=t(41),i=t(117),o=t(11)(!1),u=t(102)("IE_PROTO");n.exports=function(t,n){var r,c=i(t),a=0,f=[];for(r in c)r!=u&&e(c,r)&&f.push(r);for(;n.length>a;)e(c,r=n[a++])&&(~o(f,r)||f.push(r));return f}},{102:102,11:11,117:117,41:41}],81:[function(t,n,r){var e=t(80),i=t(31);n.exports=Object.keys||function keys(t){return e(t,i)}},{31:31,80:80}],82:[function(t,n,r){r.f={}.propertyIsEnumerable},{}],83:[function(t,n,r){var e=t(33),i=t(23),o=t(35);n.exports=function(t,n){var r=(i.Object||{})[t]||Object[t],u={};u[t]=n(r),e(e.S+e.F*o(function(){r(1)}),"Object",u)}},{23:23,33:33,35:35}],84:[function(t,n,r){var e=t(81),i=t(117),o=t(82).f;n.exports=function(t){return function(n){for(var r,u=i(n),c=e(u),a=c.length,f=0,s=[];a>f;)o.call(u,r=c[f++])&&s.push(t?[r,u[r]]:u[r]);return s}}},{117:117,81:81,82:82}],85:[function(t,n,r){var e=t(77),i=t(78),o=t(7),u=t(40).Reflect;n.exports=u&&u.ownKeys||function ownKeys(t){var n=e.f(o(t)),r=i.f;return r?n.concat(r(t)):n}},{40:40,7:7,77:77,78:78}],86:[function(t,n,r){var e=t(40).parseFloat,i=t(111).trim;n.exports=1/e(t(112)+"-0")!=-1/0?function parseFloat(t){var n=i(String(t),3),r=e(n);return 0===r&&"-"==n.charAt(0)?-0:r}:e},{111:111,112:112,40:40}],87:[function(t,n,r){var e=t(40).parseInt,i=t(111).trim,o=t(112),u=/^[-+]?0[xX]/;n.exports=8!==e(o+"08")||22!==e(o+"0x16")?function parseInt(t,n){var r=i(String(t),3);return e(r,n>>>0||(u.test(r)?16:10))}:e},{111:111,112:112,40:40}],88:[function(t,n,r){"use strict";var e=t(89),i=t(46),o=t(3);n.exports=function(){for(var t=o(this),n=arguments.length,r=Array(n),u=0,c=e._,a=!1;n>u;)(r[u]=arguments[u++])===c&&(a=!0);return function(){var e,o=this,u=arguments.length,f=0,s=0;if(!a&&!u)return i(t,r,o);if(e=r.slice(),a)for(;n>f;f++)e[f]===c&&(e[f]=arguments[s++]);for(;u>s;)e.push(arguments[s++]);return i(t,e,o)}}},{3:3,46:46,89:89}],89:[function(t,n,r){n.exports=t(40)},{40:40}],90:[function(t,n,r){n.exports=function(t){try{return{e:!1,v:t()}}catch(t){return{e:!0,v:t}}}},{}],91:[function(t,n,r){var e=t(69);n.exports=function(t,n){var r=e.f(t);return(0,r.resolve)(n),r.promise}},{69:69}],92:[function(t,n,r){n.exports=function(t,n){return{enumerable:!(1&t),configurable:!(2&t),writable:!(4&t),value:n}}},{}],93:[function(t,n,r){var e=t(94);n.exports=function(t,n,r){for(var i in n)e(t,i,n[i],r);return t}},{94:94}],94:[function(t,n,r){var e=t(40),i=t(42),o=t(41),u=t(124)("src"),c=Function.toString,a=(""+c).split("toString");t(23).inspectSource=function(t){return c.call(t)},(n.exports=function(t,n,r,c){var f="function"==typeof r;f&&(o(r,"name")||i(r,"name",n)),t[n]!==r&&(f&&(o(r,u)||i(r,u,t[n]?""+t[n]:a.join(String(n)))),t===e?t[n]=r:c?t[n]?t[n]=r:i(t,n,r):(delete t[n],i(t,n,r)))})(Function.prototype,"toString",function toString(){return"function"==typeof this&&this[u]||c.call(this)})},{124:124,23:23,40:40,41:41,42:42}],95:[function(t,n,r){n.exports=function(t,n){var r=n===Object(n)?function(t){return n[t]}:n;return function(n){return String(n).replace(t,r)}}},{}],96:[function(t,n,r){n.exports=Object.is||function is(t,n){return t===n?0!==t||1/t==1/n:t!=t&&n!=n}},{}],97:[function(t,n,r){"use strict";var e=t(33),i=t(3),o=t(25),u=t(39);n.exports=function(t){e(e.S,t,{from:function from(t){var n,r,e,c,a=arguments[1];return i(this),n=void 0!==a,n&&i(a),void 0==t?new this:(r=[],n?(e=0,c=o(a,arguments[2],2),u(t,!1,function(t){r.push(c(t,e++))})):u(t,!1,r.push,r),new this(r))}})}},{25:25,3:3,33:33,39:39}],98:[function(t,n,r){"use strict";var e=t(33);n.exports=function(t){e(e.S,t,{of:function of(){for(var t=arguments.length,n=Array(t);t--;)n[t]=arguments[t];return new this(n)}})}},{33:33}],99:[function(t,n,r){var e=t(51),i=t(7),o=function(t,n){if(i(t),!e(n)&&null!==n)throw TypeError(n+": can't set as prototype!")};n.exports={set:Object.setPrototypeOf||("__proto__"in{}?function(n,r,e){try{e=t(25)(Function.call,t(75).f(Object.prototype,"__proto__").set,2),e(n,[]),r=!(n instanceof Array)}catch(t){r=!0}return function setPrototypeOf(t,n){return o(t,n),r?t.__proto__=n:e(t,n),t}}({},!1):void 0),check:o}},{25:25,51:51,7:7,75:75}],100:[function(t,n,r){"use strict";var e=t(40),i=t(72),o=t(29),u=t(128)("species");n.exports=function(t){var n=e[t];o&&n&&!n[u]&&i.f(n,u,{configurable:!0,get:function(){return this}})}},{128:128,29:29,40:40,72:72}],101:[function(t,n,r){var e=t(72).f,i=t(41),o=t(128)("toStringTag");n.exports=function(t,n,r){t&&!i(t=r?t:t.prototype,o)&&e(t,o,{configurable:!0,value:n})}},{128:128,41:41,72:72}],102:[function(t,n,r){var e=t(103)("keys"),i=t(124);n.exports=function(t){return e[t]||(e[t]=i(t))}},{103:103,124:124}],103:[function(t,n,r){var e=t(40),i=e["__core-js_shared__"]||(e["__core-js_shared__"]={});n.exports=function(t){return i[t]||(i[t]={})}},{40:40}],104:[function(t,n,r){var e=t(7),i=t(3),o=t(128)("species");n.exports=function(t,n){var r,u=e(t).constructor;return void 0===u||void 0==(r=e(u)[o])?n:i(r)}},{128:128,3:3,7:7}],105:[function(t,n,r){"use strict";var e=t(35);n.exports=function(t,n){return!!t&&e(function(){n?t.call(null,function(){},1):t.call(null)})}},{35:35}],106:[function(t,n,r){var e=t(116),i=t(28);n.exports=function(t){return function(n,r){var o,u,c=String(i(n)),a=e(r),f=c.length;return a<0||a>=f?t?"":void 0:(o=c.charCodeAt(a),o<55296||o>56319||a+1===f||(u=c.charCodeAt(a+1))<56320||u>57343?t?c.charAt(a):o:t?c.slice(a,a+2):u-56320+(o-55296<<10)+65536)}}},{116:116,28:28}],107:[function(t,n,r){var e=t(52),i=t(28);n.exports=function(t,n,r){if(e(n))throw TypeError("String#"+r+" doesn't accept regex!");return String(i(t))}},{28:28,52:52}],108:[function(t,n,r){var e=t(33),i=t(35),o=t(28),u=/"/g,c=function(t,n,r,e){var i=String(o(t)),c="<"+n;return""!==r&&(c+=" "+r+'="'+String(e).replace(u,"&quot;")+'"'),c+">"+i+"</"+n+">"};n.exports=function(t,n){var r={};r[t]=n(c),e(e.P+e.F*i(function(){var n=""[t]('"');return n!==n.toLowerCase()||n.split('"').length>3}),"String",r)}},{28:28,33:33,35:35}],109:[function(t,n,r){var e=t(118),i=t(110),o=t(28);n.exports=function(t,n,r,u){var c=String(o(t)),a=c.length,f=void 0===r?" ":String(r),s=e(n);if(s<=a||""==f)return c;var l=s-a,h=i.call(f,Math.ceil(l/f.length));return h.length>l&&(h=h.slice(0,l)),u?h+c:c+h}},{110:110,118:118,28:28}],110:[function(t,n,r){"use strict";var e=t(116),i=t(28);n.exports=function repeat(t){var n=String(i(this)),r="",o=e(t);if(o<0||o==1/0)throw RangeError("Count can't be negative");for(;o>0;(o>>>=1)&&(n+=n))1&o&&(r+=n);return r}},{116:116,28:28}],111:[function(t,n,r){var e=t(33),i=t(28),o=t(35),u=t(112),c="["+u+"]",a="​",f=RegExp("^"+c+c+"*"),s=RegExp(c+c+"*$"),l=function(t,n,r){var i={},c=o(function(){return!!u[t]()||a[t]()!=a}),f=i[t]=c?n(h):u[t];r&&(i[r]=f),e(e.P+e.F*c,"String",i)},h=l.trim=function(t,n){return t=String(i(t)),1&n&&(t=t.replace(f,"")),2&n&&(t=t.replace(s,"")),t};n.exports=l},{112:112,28:28,33:33,35:35}],112:[function(t,n,r){n.exports="\t\n\v\f\r   ᠎             　\u2028\u2029\ufeff"},{}],113:[function(t,n,r){var e,i,o,u=t(25),c=t(46),a=t(43),f=t(30),s=t(40),l=s.process,h=s.setImmediate,v=s.clearImmediate,p=s.MessageChannel,d=s.Dispatch,y=0,g={},m=function(){var t=+this;if(g.hasOwnProperty(t)){var n=g[t];delete g[t],n()}},b=function(t){m.call(t.data)};h&&v||(h=function setImmediate(t){for(var n=[],r=1;arguments.length>r;)n.push(arguments[r++]);return g[++y]=function(){c("function"==typeof t?t:Function(t),n)},e(y),y},v=function clearImmediate(t){delete g[t]},"process"==t(18)(l)?e=function(t){l.nextTick(u(m,t,1))}:d&&d.now?e=function(t){d.now(u(m,t,1))}:p?(i=new p,o=i.port2,i.port1.onmessage=b,e=u(o.postMessage,o,1)):s.addEventListener&&"function"==typeof postMessage&&!s.importScripts?(e=function(t){s.postMessage(t+"","*")},s.addEventListener("message",b,!1)):e="onreadystatechange"in f("script")?function(t){a.appendChild(f("script")).onreadystatechange=function(){a.removeChild(this),m.call(t)}}:function(t){setTimeout(u(m,t,1),0)}),n.exports={set:h,clear:v}},{18:18,25:25,30:30,40:40,43:43,46:46}],114:[function(t,n,r){var e=t(116),i=Math.max,o=Math.min;n.exports=function(t,n){return t=e(t),t<0?i(t+n,0):o(t,n)}},{116:116}],115:[function(t,n,r){var e=t(116),i=t(118);n.exports=function(t){if(void 0===t)return 0;var n=e(t),r=i(n);if(n!==r)throw RangeError("Wrong length!");return r}},{116:116,118:118}],116:[function(t,n,r){var e=Math.ceil,i=Math.floor;n.exports=function(t){return isNaN(t=+t)?0:(t>0?i:e)(t)}},{}],117:[function(t,n,r){var e=t(47),i=t(28);n.exports=function(t){return e(i(t))}},{28:28,47:47}],118:[function(t,n,r){var e=t(116),i=Math.min;n.exports=function(t){return t>0?i(e(t),9007199254740991):0}},{116:116}],
119:[function(t,n,r){var e=t(28);n.exports=function(t){return Object(e(t))}},{28:28}],120:[function(t,n,r){var e=t(51);n.exports=function(t,n){if(!e(t))return t;var r,i;if(n&&"function"==typeof(r=t.toString)&&!e(i=r.call(t)))return i;if("function"==typeof(r=t.valueOf)&&!e(i=r.call(t)))return i;if(!n&&"function"==typeof(r=t.toString)&&!e(i=r.call(t)))return i;throw TypeError("Can't convert object to primitive value")}},{51:51}],121:[function(t,n,r){"use strict";if(t(29)){var e=t(60),i=t(40),o=t(35),u=t(33),c=t(123),a=t(122),f=t(25),s=t(6),l=t(92),h=t(42),v=t(93),p=t(116),d=t(118),y=t(115),g=t(114),m=t(120),b=t(41),x=t(17),S=t(51),w=t(119),_=t(48),E=t(71),O=t(79),P=t(77).f,M=t(129),F=t(124),I=t(128),A=t(12),k=t(11),N=t(104),j=t(141),T=t(58),R=t(56),L=t(100),G=t(9),D=t(8),C=t(72),W=t(75),U=C.f,B=W.f,V=i.RangeError,z=i.TypeError,q=i.Uint8Array,K=Array.prototype,Y=a.ArrayBuffer,J=a.DataView,H=A(0),X=A(2),$=A(3),Z=A(4),Q=A(5),tt=A(6),nt=k(!0),rt=k(!1),et=j.values,it=j.keys,ot=j.entries,ut=K.lastIndexOf,ct=K.reduce,at=K.reduceRight,ft=K.join,st=K.sort,lt=K.slice,ht=K.toString,vt=K.toLocaleString,pt=I("iterator"),dt=I("toStringTag"),yt=F("typed_constructor"),gt=F("def_constructor"),mt=c.CONSTR,bt=c.TYPED,xt=c.VIEW,St=A(1,function(t,n){return Pt(N(t,t[gt]),n)}),wt=o(function(){return 1===new q(new Uint16Array([1]).buffer)[0]}),_t=!!q&&!!q.prototype.set&&o(function(){new q(1).set({})}),Et=function(t,n){var r=p(t);if(r<0||r%n)throw V("Wrong offset!");return r},Ot=function(t){if(S(t)&&bt in t)return t;throw z(t+" is not a typed array!")},Pt=function(t,n){if(!(S(t)&&yt in t))throw z("It is not a typed array constructor!");return new t(n)},Mt=function(t,n){return Ft(N(t,t[gt]),n)},Ft=function(t,n){for(var r=0,e=n.length,i=Pt(t,e);e>r;)i[r]=n[r++];return i},It=function(t,n,r){U(t,n,{get:function(){return this._d[r]}})},At=function from(t){var n,r,e,i,o,u,c=w(t),a=arguments.length,s=a>1?arguments[1]:void 0,l=void 0!==s,h=M(c);if(void 0!=h&&!_(h)){for(u=h.call(c),e=[],n=0;!(o=u.next()).done;n++)e.push(o.value);c=e}for(l&&a>2&&(s=f(s,arguments[2],2)),n=0,r=d(c.length),i=Pt(this,r);r>n;n++)i[n]=l?s(c[n],n):c[n];return i},kt=function of(){for(var t=0,n=arguments.length,r=Pt(this,n);n>t;)r[t]=arguments[t++];return r},Nt=!!q&&o(function(){vt.call(new q(1))}),jt=function toLocaleString(){return vt.apply(Nt?lt.call(Ot(this)):Ot(this),arguments)},Tt={copyWithin:function copyWithin(t,n){return D.call(Ot(this),t,n,arguments.length>2?arguments[2]:void 0)},every:function every(t){return Z(Ot(this),t,arguments.length>1?arguments[1]:void 0)},fill:function fill(t){return G.apply(Ot(this),arguments)},filter:function filter(t){return Mt(this,X(Ot(this),t,arguments.length>1?arguments[1]:void 0))},find:function find(t){return Q(Ot(this),t,arguments.length>1?arguments[1]:void 0)},findIndex:function findIndex(t){return tt(Ot(this),t,arguments.length>1?arguments[1]:void 0)},forEach:function forEach(t){H(Ot(this),t,arguments.length>1?arguments[1]:void 0)},indexOf:function indexOf(t){return rt(Ot(this),t,arguments.length>1?arguments[1]:void 0)},includes:function includes(t){return nt(Ot(this),t,arguments.length>1?arguments[1]:void 0)},join:function join(t){return ft.apply(Ot(this),arguments)},lastIndexOf:function lastIndexOf(t){return ut.apply(Ot(this),arguments)},map:function map(t){return St(Ot(this),t,arguments.length>1?arguments[1]:void 0)},reduce:function reduce(t){return ct.apply(Ot(this),arguments)},reduceRight:function reduceRight(t){return at.apply(Ot(this),arguments)},reverse:function reverse(){for(var t,n=this,r=Ot(n).length,e=Math.floor(r/2),i=0;i<e;)t=n[i],n[i++]=n[--r],n[r]=t;return n},some:function some(t){return $(Ot(this),t,arguments.length>1?arguments[1]:void 0)},sort:function sort(t){return st.call(Ot(this),t)},subarray:function subarray(t,n){var r=Ot(this),e=r.length,i=g(t,e);return new(N(r,r[gt]))(r.buffer,r.byteOffset+i*r.BYTES_PER_ELEMENT,d((void 0===n?e:g(n,e))-i))}},Rt=function slice(t,n){return Mt(this,lt.call(Ot(this),t,n))},Lt=function set(t){Ot(this);var n=Et(arguments[1],1),r=this.length,e=w(t),i=d(e.length),o=0;if(i+n>r)throw V("Wrong length!");for(;o<i;)this[n+o]=e[o++]},Gt={entries:function entries(){return ot.call(Ot(this))},keys:function keys(){return it.call(Ot(this))},values:function values(){return et.call(Ot(this))}},Dt=function(t,n){return S(t)&&t[bt]&&"symbol"!=typeof n&&n in t&&String(+n)==String(n)},Ct=function getOwnPropertyDescriptor(t,n){return Dt(t,n=m(n,!0))?l(2,t[n]):B(t,n)},Wt=function defineProperty(t,n,r){return!(Dt(t,n=m(n,!0))&&S(r)&&b(r,"value"))||b(r,"get")||b(r,"set")||r.configurable||b(r,"writable")&&!r.writable||b(r,"enumerable")&&!r.enumerable?U(t,n,r):(t[n]=r.value,t)};mt||(W.f=Ct,C.f=Wt),u(u.S+u.F*!mt,"Object",{getOwnPropertyDescriptor:Ct,defineProperty:Wt}),o(function(){ht.call({})})&&(ht=vt=function toString(){return ft.call(this)});var Ut=v({},Tt);v(Ut,Gt),h(Ut,pt,Gt.values),v(Ut,{slice:Rt,set:Lt,constructor:function(){},toString:ht,toLocaleString:jt}),It(Ut,"buffer","b"),It(Ut,"byteOffset","o"),It(Ut,"byteLength","l"),It(Ut,"length","e"),U(Ut,dt,{get:function(){return this[bt]}}),n.exports=function(t,n,r,a){a=!!a;var f=t+(a?"Clamped":"")+"Array",l="get"+t,v="set"+t,p=i[f],g=p||{},m=p&&O(p),b=!p||!c.ABV,w={},_=p&&p.prototype,M=function(t,r){var e=t._d;return e.v[l](r*n+e.o,wt)},F=function(t,r,e){var i=t._d;a&&(e=(e=Math.round(e))<0?0:e>255?255:255&e),i.v[v](r*n+i.o,e,wt)},I=function(t,n){U(t,n,{get:function(){return M(this,n)},set:function(t){return F(this,n,t)},enumerable:!0})};b?(p=r(function(t,r,e,i){s(t,p,f,"_d");var o,u,c,a,l=0,v=0;if(S(r)){if(!(r instanceof Y||"ArrayBuffer"==(a=x(r))||"SharedArrayBuffer"==a))return bt in r?Ft(p,r):At.call(p,r);o=r,v=Et(e,n);var g=r.byteLength;if(void 0===i){if(g%n)throw V("Wrong length!");if((u=g-v)<0)throw V("Wrong length!")}else if((u=d(i)*n)+v>g)throw V("Wrong length!");c=u/n}else c=y(r),u=c*n,o=new Y(u);for(h(t,"_d",{b:o,o:v,l:u,e:c,v:new J(o)});l<c;)I(t,l++)}),_=p.prototype=E(Ut),h(_,"constructor",p)):o(function(){p(1)})&&o(function(){new p(-1)})&&R(function(t){new p,new p(null),new p(1.5),new p(t)},!0)||(p=r(function(t,r,e,i){s(t,p,f);var o;return S(r)?r instanceof Y||"ArrayBuffer"==(o=x(r))||"SharedArrayBuffer"==o?void 0!==i?new g(r,Et(e,n),i):void 0!==e?new g(r,Et(e,n)):new g(r):bt in r?Ft(p,r):At.call(p,r):new g(y(r))}),H(m!==Function.prototype?P(g).concat(P(m)):P(g),function(t){t in p||h(p,t,g[t])}),p.prototype=_,e||(_.constructor=p));var A=_[pt],k=!!A&&("values"==A.name||void 0==A.name),N=Gt.values;h(p,yt,!0),h(_,bt,f),h(_,xt,!0),h(_,gt,p),(a?new p(1)[dt]==f:dt in _)||U(_,dt,{get:function(){return f}}),w[f]=p,u(u.G+u.W+u.F*(p!=g),w),u(u.S,f,{BYTES_PER_ELEMENT:n}),u(u.S+u.F*o(function(){g.of.call(p,1)}),f,{from:At,of:kt}),"BYTES_PER_ELEMENT"in _||h(_,"BYTES_PER_ELEMENT",n),u(u.P,f,Tt),L(f),u(u.P+u.F*_t,f,{set:Lt}),u(u.P+u.F*!k,f,Gt),e||_.toString==ht||(_.toString=ht),u(u.P+u.F*o(function(){new p(1).slice()}),f,{slice:Rt}),u(u.P+u.F*(o(function(){return[1,2].toLocaleString()!=new p([1,2]).toLocaleString()})||!o(function(){_.toLocaleString.call([1,2])})),f,{toLocaleString:jt}),T[f]=k?A:N,e||k||h(_,pt,N)}}else n.exports=function(){}},{100:100,104:104,11:11,114:114,115:115,116:116,118:118,119:119,12:12,120:120,122:122,123:123,124:124,128:128,129:129,141:141,17:17,25:25,29:29,33:33,35:35,40:40,41:41,42:42,48:48,51:51,56:56,58:58,6:6,60:60,71:71,72:72,75:75,77:77,79:79,8:8,9:9,92:92,93:93}],122:[function(t,n,r){"use strict";function packIEEE754(t,n,r){var e,i,o,u=Array(r),c=8*r-n-1,a=(1<<c)-1,f=a>>1,s=23===n?M(2,-24)-M(2,-77):0,l=0,h=t<0||0===t&&1/t<0?1:0;for(t=P(t),t!=t||t===E?(i=t!=t?1:0,e=a):(e=F(I(t)/A),t*(o=M(2,-e))<1&&(e--,o*=2),t+=e+f>=1?s/o:s*M(2,1-f),t*o>=2&&(e++,o/=2),e+f>=a?(i=0,e=a):e+f>=1?(i=(t*o-1)*M(2,n),e+=f):(i=t*M(2,f-1)*M(2,n),e=0));n>=8;u[l++]=255&i,i/=256,n-=8);for(e=e<<n|i,c+=n;c>0;u[l++]=255&e,e/=256,c-=8);return u[--l]|=128*h,u}function unpackIEEE754(t,n,r){var e,i=8*r-n-1,o=(1<<i)-1,u=o>>1,c=i-7,a=r-1,f=t[a--],s=127&f;for(f>>=7;c>0;s=256*s+t[a],a--,c-=8);for(e=s&(1<<-c)-1,s>>=-c,c+=n;c>0;e=256*e+t[a],a--,c-=8);if(0===s)s=1-u;else{if(s===o)return e?NaN:f?-E:E;e+=M(2,n),s-=u}return(f?-1:1)*e*M(2,s-n)}function unpackI32(t){return t[3]<<24|t[2]<<16|t[1]<<8|t[0]}function packI8(t){return[255&t]}function packI16(t){return[255&t,t>>8&255]}function packI32(t){return[255&t,t>>8&255,t>>16&255,t>>24&255]}function packF64(t){return packIEEE754(t,52,8)}function packF32(t){return packIEEE754(t,23,4)}function addGetter(t,n,r){d(t[m],n,{get:function(){return this[r]}})}function get(t,n,r,e){var i=+r,o=v(i);if(o+n>t[N])throw _(b);var u=t[k]._b,c=o+t[j],a=u.slice(c,c+n);return e?a:a.reverse()}function set(t,n,r,e,i,o){var u=+r,c=v(u);if(c+n>t[N])throw _(b);for(var a=t[k]._b,f=c+t[j],s=e(+i),l=0;l<n;l++)a[f+l]=s[o?l:n-l-1]}var e=t(40),i=t(29),o=t(60),u=t(123),c=t(42),a=t(93),f=t(35),s=t(6),l=t(116),h=t(118),v=t(115),p=t(77).f,d=t(72).f,y=t(9),g=t(101),m="prototype",b="Wrong index!",x=e.ArrayBuffer,S=e.DataView,w=e.Math,_=e.RangeError,E=e.Infinity,O=x,P=w.abs,M=w.pow,F=w.floor,I=w.log,A=w.LN2,k=i?"_b":"buffer",N=i?"_l":"byteLength",j=i?"_o":"byteOffset";if(u.ABV){if(!f(function(){x(1)})||!f(function(){new x(-1)})||f(function(){return new x,new x(1.5),new x(NaN),"ArrayBuffer"!=x.name})){x=function ArrayBuffer(t){return s(this,x),new O(v(t))};for(var T,R=x[m]=O[m],L=p(O),G=0;L.length>G;)(T=L[G++])in x||c(x,T,O[T]);o||(R.constructor=x)}var D=new S(new x(2)),C=S[m].setInt8;D.setInt8(0,2147483648),D.setInt8(1,2147483649),!D.getInt8(0)&&D.getInt8(1)||a(S[m],{setInt8:function setInt8(t,n){C.call(this,t,n<<24>>24)},setUint8:function setUint8(t,n){C.call(this,t,n<<24>>24)}},!0)}else x=function ArrayBuffer(t){s(this,x,"ArrayBuffer");var n=v(t);this._b=y.call(Array(n),0),this[N]=n},S=function DataView(t,n,r){s(this,S,"DataView"),s(t,x,"DataView");var e=t[N],i=l(n);if(i<0||i>e)throw _("Wrong offset!");if(r=void 0===r?e-i:h(r),i+r>e)throw _("Wrong length!");this[k]=t,this[j]=i,this[N]=r},i&&(addGetter(x,"byteLength","_l"),addGetter(S,"buffer","_b"),addGetter(S,"byteLength","_l"),addGetter(S,"byteOffset","_o")),a(S[m],{getInt8:function getInt8(t){return get(this,1,t)[0]<<24>>24},getUint8:function getUint8(t){return get(this,1,t)[0]},getInt16:function getInt16(t){var n=get(this,2,t,arguments[1]);return(n[1]<<8|n[0])<<16>>16},getUint16:function getUint16(t){var n=get(this,2,t,arguments[1]);return n[1]<<8|n[0]},getInt32:function getInt32(t){return unpackI32(get(this,4,t,arguments[1]))},getUint32:function getUint32(t){return unpackI32(get(this,4,t,arguments[1]))>>>0},getFloat32:function getFloat32(t){return unpackIEEE754(get(this,4,t,arguments[1]),23,4)},getFloat64:function getFloat64(t){return unpackIEEE754(get(this,8,t,arguments[1]),52,8)},setInt8:function setInt8(t,n){set(this,1,t,packI8,n)},setUint8:function setUint8(t,n){set(this,1,t,packI8,n)},setInt16:function setInt16(t,n){set(this,2,t,packI16,n,arguments[2])},setUint16:function setUint16(t,n){set(this,2,t,packI16,n,arguments[2])},setInt32:function setInt32(t,n){set(this,4,t,packI32,n,arguments[2])},setUint32:function setUint32(t,n){set(this,4,t,packI32,n,arguments[2])},setFloat32:function setFloat32(t,n){set(this,4,t,packF32,n,arguments[2])},setFloat64:function setFloat64(t,n){set(this,8,t,packF64,n,arguments[2])}});g(x,"ArrayBuffer"),g(S,"DataView"),c(S[m],u.VIEW,!0),r.ArrayBuffer=x,r.DataView=S},{101:101,115:115,116:116,118:118,123:123,29:29,35:35,40:40,42:42,6:6,60:60,72:72,77:77,9:9,93:93}],123:[function(t,n,r){for(var e,i=t(40),o=t(42),u=t(124),c=u("typed_array"),a=u("view"),f=!(!i.ArrayBuffer||!i.DataView),s=f,l=0,h="Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array".split(",");l<9;)(e=i[h[l++]])?(o(e.prototype,c,!0),o(e.prototype,a,!0)):s=!1;n.exports={ABV:f,CONSTR:s,TYPED:c,VIEW:a}},{124:124,40:40,42:42}],124:[function(t,n,r){var e=0,i=Math.random();n.exports=function(t){return"Symbol(".concat(void 0===t?"":t,")_",(++e+i).toString(36))}},{}],125:[function(t,n,r){var e=t(51);n.exports=function(t,n){if(!e(t)||t._t!==n)throw TypeError("Incompatible receiver, "+n+" required!");return t}},{51:51}],126:[function(t,n,r){var e=t(40),i=t(23),o=t(60),u=t(127),c=t(72).f;n.exports=function(t){var n=i.Symbol||(i.Symbol=o?{}:e.Symbol||{});"_"==t.charAt(0)||t in n||c(n,t,{value:u.f(t)})}},{127:127,23:23,40:40,60:60,72:72}],127:[function(t,n,r){r.f=t(128)},{128:128}],128:[function(t,n,r){var e=t(103)("wks"),i=t(124),o=t(40).Symbol,u="function"==typeof o;(n.exports=function(t){return e[t]||(e[t]=u&&o[t]||(u?o:i)("Symbol."+t))}).store=e},{103:103,124:124,40:40}],129:[function(t,n,r){var e=t(17),i=t(128)("iterator"),o=t(58);n.exports=t(23).getIteratorMethod=function(t){if(void 0!=t)return t[i]||t["@@iterator"]||o[e(t)]}},{128:128,17:17,23:23,58:58}],130:[function(t,n,r){var e=t(33),i=t(95)(/[\\^$*+?.()|[\]{}]/g,"\\$&");e(e.S,"RegExp",{escape:function escape(t){return i(t)}})},{33:33,95:95}],131:[function(t,n,r){var e=t(33);e(e.P,"Array",{copyWithin:t(8)}),t(5)("copyWithin")},{33:33,5:5,8:8}],132:[function(t,n,r){"use strict";var e=t(33),i=t(12)(4);e(e.P+e.F*!t(105)([].every,!0),"Array",{every:function every(t){return i(this,t,arguments[1])}})},{105:105,12:12,33:33}],133:[function(t,n,r){var e=t(33);e(e.P,"Array",{fill:t(9)}),t(5)("fill")},{33:33,5:5,9:9}],134:[function(t,n,r){"use strict";var e=t(33),i=t(12)(2);e(e.P+e.F*!t(105)([].filter,!0),"Array",{filter:function filter(t){return i(this,t,arguments[1])}})},{105:105,12:12,33:33}],135:[function(t,n,r){"use strict";var e=t(33),i=t(12)(6),o="findIndex",u=!0;o in[]&&Array(1)[o](function(){u=!1}),e(e.P+e.F*u,"Array",{findIndex:function findIndex(t){return i(this,t,arguments.length>1?arguments[1]:void 0)}}),t(5)(o)},{12:12,33:33,5:5}],136:[function(t,n,r){"use strict";var e=t(33),i=t(12)(5),o=!0;"find"in[]&&Array(1).find(function(){o=!1}),e(e.P+e.F*o,"Array",{find:function find(t){return i(this,t,arguments.length>1?arguments[1]:void 0)}}),t(5)("find")},{12:12,33:33,5:5}],137:[function(t,n,r){"use strict";var e=t(33),i=t(12)(0),o=t(105)([].forEach,!0);e(e.P+e.F*!o,"Array",{forEach:function forEach(t){return i(this,t,arguments[1])}})},{105:105,12:12,33:33}],138:[function(t,n,r){"use strict";var e=t(25),i=t(33),o=t(119),u=t(53),c=t(48),a=t(118),f=t(24),s=t(129);i(i.S+i.F*!t(56)(function(t){Array.from(t)}),"Array",{from:function from(t){var n,r,i,l,h=o(t),v="function"==typeof this?this:Array,p=arguments.length,d=p>1?arguments[1]:void 0,y=void 0!==d,g=0,m=s(h);if(y&&(d=e(d,p>2?arguments[2]:void 0,2)),void 0==m||v==Array&&c(m))for(n=a(h.length),r=new v(n);n>g;g++)f(r,g,y?d(h[g],g):h[g]);else for(l=m.call(h),r=new v;!(i=l.next()).done;g++)f(r,g,y?u(l,d,[i.value,g],!0):i.value);return r.length=g,r}})},{118:118,119:119,129:129,24:24,25:25,33:33,48:48,53:53,56:56}],139:[function(t,n,r){"use strict";var e=t(33),i=t(11)(!1),o=[].indexOf,u=!!o&&1/[1].indexOf(1,-0)<0;e(e.P+e.F*(u||!t(105)(o)),"Array",{indexOf:function indexOf(t){return u?o.apply(this,arguments)||0:i(this,t,arguments[1])}})},{105:105,11:11,33:33}],140:[function(t,n,r){var e=t(33);e(e.S,"Array",{isArray:t(49)})},{33:33,49:49}],141:[function(t,n,r){"use strict";var e=t(5),i=t(57),o=t(58),u=t(117);n.exports=t(55)(Array,"Array",function(t,n){this._t=u(t),this._i=0,this._k=n},function(){var t=this._t,n=this._k,r=this._i++;return!t||r>=t.length?(this._t=void 0,i(1)):"keys"==n?i(0,r):"values"==n?i(0,t[r]):i(0,[r,t[r]])},"values"),o.Arguments=o.Array,e("keys"),e("values"),e("entries")},{117:117,5:5,55:55,57:57,58:58}],142:[function(t,n,r){"use strict";var e=t(33),i=t(117),o=[].join;e(e.P+e.F*(t(47)!=Object||!t(105)(o)),"Array",{join:function join(t){return o.call(i(this),void 0===t?",":t)}})},{105:105,117:117,33:33,47:47}],143:[function(t,n,r){"use strict";var e=t(33),i=t(117),o=t(116),u=t(118),c=[].lastIndexOf,a=!!c&&1/[1].lastIndexOf(1,-0)<0;e(e.P+e.F*(a||!t(105)(c)),"Array",{lastIndexOf:function lastIndexOf(t){if(a)return c.apply(this,arguments)||0;var n=i(this),r=u(n.length),e=r-1;for(arguments.length>1&&(e=Math.min(e,o(arguments[1]))),e<0&&(e=r+e);e>=0;e--)if(e in n&&n[e]===t)return e||0;return-1}})},{105:105,116:116,117:117,118:118,33:33}],144:[function(t,n,r){"use strict";var e=t(33),i=t(12)(1);e(e.P+e.F*!t(105)([].map,!0),"Array",{map:function map(t){return i(this,t,arguments[1])}})},{105:105,12:12,33:33}],145:[function(t,n,r){"use strict";var e=t(33),i=t(24);e(e.S+e.F*t(35)(function(){function F(){}return!(Array.of.call(F)instanceof F)}),"Array",{of:function of(){for(var t=0,n=arguments.length,r=new("function"==typeof this?this:Array)(n);n>t;)i(r,t,arguments[t++]);return r.length=n,r}})},{24:24,33:33,35:35}],146:[function(t,n,r){"use strict";var e=t(33),i=t(13);e(e.P+e.F*!t(105)([].reduceRight,!0),"Array",{reduceRight:function reduceRight(t){return i(this,t,arguments.length,arguments[1],!0)}})},{105:105,13:13,33:33}],147:[function(t,n,r){"use strict";var e=t(33),i=t(13);e(e.P+e.F*!t(105)([].reduce,!0),"Array",{reduce:function reduce(t){return i(this,t,arguments.length,arguments[1],!1)}})},{105:105,13:13,33:33}],148:[function(t,n,r){"use strict";var e=t(33),i=t(43),o=t(18),u=t(114),c=t(118),a=[].slice;e(e.P+e.F*t(35)(function(){i&&a.call(i)}),"Array",{slice:function slice(t,n){var r=c(this.length),e=o(this);if(n=void 0===n?r:n,"Array"==e)return a.call(this,t,n);for(var i=u(t,r),f=u(n,r),s=c(f-i),l=Array(s),h=0;h<s;h++)l[h]="String"==e?this.charAt(i+h):this[i+h];return l}})},{114:114,118:118,18:18,33:33,35:35,43:43}],149:[function(t,n,r){"use strict";var e=t(33),i=t(12)(3);e(e.P+e.F*!t(105)([].some,!0),"Array",{some:function some(t){return i(this,t,arguments[1])}})},{105:105,12:12,33:33}],150:[function(t,n,r){"use strict";var e=t(33),i=t(3),o=t(119),u=t(35),c=[].sort,a=[1,2,3];e(e.P+e.F*(u(function(){a.sort(void 0)})||!u(function(){a.sort(null)})||!t(105)(c)),"Array",{sort:function sort(t){return void 0===t?c.call(o(this)):c.call(o(this),i(t))}})},{105:105,119:119,3:3,33:33,35:35}],151:[function(t,n,r){t(100)("Array")},{100:100}],152:[function(t,n,r){var e=t(33);e(e.S,"Date",{now:function(){return(new Date).getTime()}})},{33:33}],153:[function(t,n,r){var e=t(33),i=t(26);e(e.P+e.F*(Date.prototype.toISOString!==i),"Date",{toISOString:i})},{26:26,33:33}],154:[function(t,n,r){"use strict";var e=t(33),i=t(119),o=t(120);e(e.P+e.F*t(35)(function(){return null!==new Date(NaN).toJSON()||1!==Date.prototype.toJSON.call({toISOString:function(){return 1}})}),"Date",{toJSON:function toJSON(t){var n=i(this),r=o(n);return"number"!=typeof r||isFinite(r)?n.toISOString():null}})},{119:119,120:120,33:33,35:35}],155:[function(t,n,r){var e=t(128)("toPrimitive"),i=Date.prototype;e in i||t(42)(i,e,t(27))},{128:128,27:27,42:42}],156:[function(t,n,r){var e=Date.prototype,i=e.toString,o=e.getTime;new Date(NaN)+""!="Invalid Date"&&t(94)(e,"toString",function toString(){var t=o.call(this);return t===t?i.call(this):"Invalid Date"})},{94:94}],157:[function(t,n,r){var e=t(33);e(e.P,"Function",{bind:t(16)})},{16:16,33:33}],158:[function(t,n,r){"use strict";var e=t(51),i=t(79),o=t(128)("hasInstance"),u=Function.prototype;o in u||t(72).f(u,o,{value:function(t){if("function"!=typeof this||!e(t))return!1;if(!e(this.prototype))return t instanceof this;for(;t=i(t);)if(this.prototype===t)return!0;return!1}})},{128:128,51:51,72:72,79:79}],159:[function(t,n,r){var e=t(72).f,i=Function.prototype,o=/^\s*function ([^ (]*)/;"name"in i||t(29)&&e(i,"name",{configurable:!0,get:function(){try{return(""+this).match(o)[1]}catch(t){return""}}})},{29:29,72:72}],160:[function(t,n,r){"use strict";var e=t(19),i=t(125);n.exports=t(22)("Map",function(t){return function Map(){return t(this,arguments.length>0?arguments[0]:void 0)}},{get:function get(t){var n=e.getEntry(i(this,"Map"),t);return n&&n.v},set:function set(t,n){return e.def(i(this,"Map"),0===t?0:t,n)}},e,!0)},{125:125,19:19,22:22}],161:[function(t,n,r){var e=t(33),i=t(63),o=Math.sqrt,u=Math.acosh;e(e.S+e.F*!(u&&710==Math.floor(u(Number.MAX_VALUE))&&u(1/0)==1/0),"Math",{acosh:function acosh(t){return(t=+t)<1?NaN:t>94906265.62425156?Math.log(t)+Math.LN2:i(t-1+o(t-1)*o(t+1))}})},{33:33,63:63}],162:[function(t,n,r){function asinh(t){return isFinite(t=+t)&&0!=t?t<0?-asinh(-t):Math.log(t+Math.sqrt(t*t+1)):t}var e=t(33),i=Math.asinh;e(e.S+e.F*!(i&&1/i(0)>0),"Math",{asinh:asinh})},{33:33}],163:[function(t,n,r){var e=t(33),i=Math.atanh;e(e.S+e.F*!(i&&1/i(-0)<0),"Math",{atanh:function atanh(t){return 0==(t=+t)?t:Math.log((1+t)/(1-t))/2}})},{33:33}],164:[function(t,n,r){var e=t(33),i=t(65);e(e.S,"Math",{cbrt:function cbrt(t){return i(t=+t)*Math.pow(Math.abs(t),1/3)}})},{33:33,65:65}],165:[function(t,n,r){var e=t(33);e(e.S,"Math",{clz32:function clz32(t){return(t>>>=0)?31-Math.floor(Math.log(t+.5)*Math.LOG2E):32}})},{33:33}],166:[function(t,n,r){var e=t(33),i=Math.exp;e(e.S,"Math",{cosh:function cosh(t){return(i(t=+t)+i(-t))/2}})},{33:33}],167:[function(t,n,r){var e=t(33),i=t(61);e(e.S+e.F*(i!=Math.expm1),"Math",{expm1:i})},{33:33,61:61}],168:[function(t,n,r){var e=t(33);e(e.S,"Math",{fround:t(62)})},{33:33,62:62}],169:[function(t,n,r){var e=t(33),i=Math.abs;e(e.S,"Math",{hypot:function hypot(t,n){for(var r,e,o=0,u=0,c=arguments.length,a=0;u<c;)r=i(arguments[u++]),a<r?(e=a/r,o=o*e*e+1,a=r):r>0?(e=r/a,o+=e*e):o+=r;return a===1/0?1/0:a*Math.sqrt(o)}})},{33:33}],170:[function(t,n,r){var e=t(33),i=Math.imul;e(e.S+e.F*t(35)(function(){return-5!=i(4294967295,5)||2!=i.length}),"Math",{imul:function imul(t,n){var r=+t,e=+n,i=65535&r,o=65535&e;return 0|i*o+((65535&r>>>16)*o+i*(65535&e>>>16)<<16>>>0)}})},{33:33,35:35}],171:[function(t,n,r){var e=t(33);e(e.S,"Math",{log10:function log10(t){return Math.log(t)*Math.LOG10E}})},{33:33}],172:[function(t,n,r){var e=t(33);e(e.S,"Math",{log1p:t(63)})},{33:33,63:63}],173:[function(t,n,r){var e=t(33);e(e.S,"Math",{log2:function log2(t){return Math.log(t)/Math.LN2}})},{33:33}],174:[function(t,n,r){var e=t(33);e(e.S,"Math",{sign:t(65)})},{33:33,65:65}],175:[function(t,n,r){var e=t(33),i=t(61),o=Math.exp;e(e.S+e.F*t(35)(function(){return-2e-17!=!Math.sinh(-2e-17)}),"Math",{sinh:function sinh(t){return Math.abs(t=+t)<1?(i(t)-i(-t))/2:(o(t-1)-o(-t-1))*(Math.E/2)}})},{33:33,35:35,61:61}],176:[function(t,n,r){var e=t(33),i=t(61),o=Math.exp;e(e.S,"Math",{tanh:function tanh(t){var n=i(t=+t),r=i(-t);return n==1/0?1:r==1/0?-1:(n-r)/(o(t)+o(-t))}})},{33:33,61:61}],177:[function(t,n,r){var e=t(33);e(e.S,"Math",{trunc:function trunc(t){return(t>0?Math.floor:Math.ceil)(t)}})},{33:33}],178:[function(t,n,r){"use strict";var e=t(40),i=t(41),o=t(18),u=t(45),c=t(120),a=t(35),f=t(77).f,s=t(75).f,l=t(72).f,h=t(111).trim,v=e.Number,p=v,d=v.prototype,y="Number"==o(t(71)(d)),g="trim"in String.prototype,m=function(t){var n=c(t,!1);if("string"==typeof n&&n.length>2){n=g?n.trim():h(n,3);var r,e,i,o=n.charCodeAt(0);if(43===o||45===o){if(88===(r=n.charCodeAt(2))||120===r)return NaN}else if(48===o){switch(n.charCodeAt(1)){case 66:case 98:e=2,i=49;break;case 79:case 111:e=8,i=55;break;default:return+n}for(var u,a=n.slice(2),f=0,s=a.length;f<s;f++)if((u=a.charCodeAt(f))<48||u>i)return NaN;return parseInt(a,e)}}return+n};if(!v(" 0o1")||!v("0b1")||v("+0x1")){v=function Number(t){var n=arguments.length<1?0:t,r=this;return r instanceof v&&(y?a(function(){d.valueOf.call(r)}):"Number"!=o(r))?u(new p(m(n)),r,v):m(n)};for(var b,x=t(29)?f(p):"MAX_VALUE,MIN_VALUE,NaN,NEGATIVE_INFINITY,POSITIVE_INFINITY,EPSILON,isFinite,isInteger,isNaN,isSafeInteger,MAX_SAFE_INTEGER,MIN_SAFE_INTEGER,parseFloat,parseInt,isInteger".split(","),S=0;x.length>S;S++)i(p,b=x[S])&&!i(v,b)&&l(v,b,s(p,b));v.prototype=d,d.constructor=v,t(94)(e,"Number",v)}},{111:111,120:120,18:18,29:29,35:35,40:40,41:41,45:45,71:71,72:72,75:75,77:77,94:94}],179:[function(t,n,r){var e=t(33);e(e.S,"Number",{EPSILON:Math.pow(2,-52)})},{33:33}],180:[function(t,n,r){var e=t(33),i=t(40).isFinite;e(e.S,"Number",{isFinite:function isFinite(t){return"number"==typeof t&&i(t)}})},{33:33,40:40}],181:[function(t,n,r){var e=t(33);e(e.S,"Number",{isInteger:t(50)})},{33:33,50:50}],182:[function(t,n,r){var e=t(33);e(e.S,"Number",{isNaN:function isNaN(t){return t!=t}})},{33:33}],183:[function(t,n,r){var e=t(33),i=t(50),o=Math.abs;e(e.S,"Number",{isSafeInteger:function isSafeInteger(t){return i(t)&&o(t)<=9007199254740991}})},{33:33,50:50}],184:[function(t,n,r){var e=t(33);e(e.S,"Number",{MAX_SAFE_INTEGER:9007199254740991})},{33:33}],185:[function(t,n,r){var e=t(33);e(e.S,"Number",{MIN_SAFE_INTEGER:-9007199254740991})},{33:33}],186:[function(t,n,r){var e=t(33),i=t(86);e(e.S+e.F*(Number.parseFloat!=i),"Number",{parseFloat:i})},{33:33,86:86}],187:[function(t,n,r){var e=t(33),i=t(87);e(e.S+e.F*(Number.parseInt!=i),"Number",{parseInt:i})},{33:33,87:87}],188:[function(t,n,r){"use strict";var e=t(33),i=t(116),o=t(4),u=t(110),c=1..toFixed,a=Math.floor,f=[0,0,0,0,0,0],s="Number.toFixed: incorrect invocation!",l=function(t,n){for(var r=-1,e=n;++r<6;)e+=t*f[r],f[r]=e%1e7,e=a(e/1e7)},h=function(t){for(var n=6,r=0;--n>=0;)r+=f[n],f[n]=a(r/t),r=r%t*1e7},v=function(){for(var t=6,n="";--t>=0;)if(""!==n||0===t||0!==f[t]){var r=String(f[t]);n=""===n?r:n+u.call("0",7-r.length)+r}return n},p=function(t,n,r){return 0===n?r:n%2==1?p(t,n-1,r*t):p(t*t,n/2,r)},d=function(t){for(var n=0,r=t;r>=4096;)n+=12,r/=4096;for(;r>=2;)n+=1,r/=2;return n};e(e.P+e.F*(!!c&&("0.000"!==8e-5.toFixed(3)||"1"!==.9.toFixed(0)||"1.25"!==1.255.toFixed(2)||"1000000000000000128"!==(0xde0b6b3a7640080).toFixed(0))||!t(35)(function(){c.call({})})),"Number",{toFixed:function toFixed(t){var n,r,e,c,a=o(this,s),f=i(t),y="",g="0";if(f<0||f>20)throw RangeError(s);if(a!=a)return"NaN";if(a<=-1e21||a>=1e21)return String(a);if(a<0&&(y="-",a=-a),a>1e-21)if(n=d(a*p(2,69,1))-69,r=n<0?a*p(2,-n,1):a/p(2,n,1),r*=4503599627370496,(n=52-n)>0){for(l(0,r),e=f;e>=7;)l(1e7,0),e-=7;for(l(p(10,e,1),0),e=n-1;e>=23;)h(1<<23),e-=23;h(1<<e),l(1,1),h(2),g=v()}else l(0,r),l(1<<-n,0),g=v()+u.call("0",f);return f>0?(c=g.length,g=y+(c<=f?"0."+u.call("0",f-c)+g:g.slice(0,c-f)+"."+g.slice(c-f))):g=y+g,g}})},{110:110,116:116,33:33,35:35,4:4}],189:[function(t,n,r){"use strict";var e=t(33),i=t(35),o=t(4),u=1..toPrecision;e(e.P+e.F*(i(function(){return"1"!==u.call(1,void 0)})||!i(function(){u.call({})})),"Number",{toPrecision:function toPrecision(t){var n=o(this,"Number#toPrecision: incorrect invocation!");return void 0===t?u.call(n):u.call(n,t)}})},{33:33,35:35,4:4}],190:[function(t,n,r){var e=t(33);e(e.S+e.F,"Object",{assign:t(70)})},{33:33,70:70}],191:[function(t,n,r){var e=t(33);e(e.S,"Object",{create:t(71)})},{33:33,71:71}],192:[function(t,n,r){var e=t(33);e(e.S+e.F*!t(29),"Object",{defineProperties:t(73)})},{29:29,33:33,73:73}],193:[function(t,n,r){var e=t(33);e(e.S+e.F*!t(29),"Object",{defineProperty:t(72).f})},{29:29,33:33,72:72}],194:[function(t,n,r){var e=t(51),i=t(66).onFreeze;t(83)("freeze",function(t){return function freeze(n){return t&&e(n)?t(i(n)):n}})},{51:51,66:66,83:83}],195:[function(t,n,r){var e=t(117),i=t(75).f;t(83)("getOwnPropertyDescriptor",function(){return function getOwnPropertyDescriptor(t,n){return i(e(t),n)}})},{117:117,75:75,83:83}],196:[function(t,n,r){t(83)("getOwnPropertyNames",function(){return t(76).f})},{76:76,83:83}],197:[function(t,n,r){var e=t(119),i=t(79);t(83)("getPrototypeOf",function(){return function getPrototypeOf(t){return i(e(t))}})},{119:119,79:79,83:83}],198:[function(t,n,r){var e=t(51);t(83)("isExtensible",function(t){return function isExtensible(n){return!!e(n)&&(!t||t(n))}})},{51:51,83:83}],199:[function(t,n,r){var e=t(51);t(83)("isFrozen",function(t){return function isFrozen(n){return!e(n)||!!t&&t(n)}})},{51:51,83:83}],200:[function(t,n,r){var e=t(51);t(83)("isSealed",function(t){return function isSealed(n){return!e(n)||!!t&&t(n)}})},{51:51,83:83}],201:[function(t,n,r){var e=t(33);e(e.S,"Object",{is:t(96)})},{33:33,96:96}],202:[function(t,n,r){var e=t(119),i=t(81);t(83)("keys",function(){return function keys(t){return i(e(t))}})},{119:119,81:81,83:83}],203:[function(t,n,r){var e=t(51),i=t(66).onFreeze;t(83)("preventExtensions",function(t){return function preventExtensions(n){return t&&e(n)?t(i(n)):n}})},{51:51,66:66,83:83}],204:[function(t,n,r){var e=t(51),i=t(66).onFreeze;t(83)("seal",function(t){return function seal(n){return t&&e(n)?t(i(n)):n}})},{51:51,66:66,83:83}],205:[function(t,n,r){var e=t(33);e(e.S,"Object",{setPrototypeOf:t(99).set})},{33:33,99:99}],206:[function(t,n,r){"use strict";var e=t(17),i={};i[t(128)("toStringTag")]="z",i+""!="[object z]"&&t(94)(Object.prototype,"toString",function toString(){return"[object "+e(this)+"]"},!0)},{128:128,17:17,94:94}],207:[function(t,n,r){var e=t(33),i=t(86);e(e.G+e.F*(parseFloat!=i),{parseFloat:i})},{33:33,86:86}],208:[function(t,n,r){var e=t(33),i=t(87);e(e.G+e.F*(parseInt!=i),{parseInt:i})},{33:33,87:87}],209:[function(t,n,r){"use strict";var e,i,o,u,c=t(60),a=t(40),f=t(25),s=t(17),l=t(33),h=t(51),v=t(3),p=t(6),d=t(39),y=t(104),g=t(113).set,m=t(68)(),b=t(69),x=t(90),S=t(91),w=a.TypeError,_=a.process,E=a.Promise,O="process"==s(_),P=function(){},M=i=b.f,F=!!function(){try{var n=E.resolve(1),r=(n.constructor={})[t(128)("species")]=function(t){t(P,P)};return(O||"function"==typeof PromiseRejectionEvent)&&n.then(P)instanceof r}catch(t){}}(),I=c?function(t,n){return t===n||t===E&&n===u}:function(t,n){return t===n},A=function(t){var n;return!(!h(t)||"function"!=typeof(n=t.then))&&n},k=function(t,n){if(!t._n){t._n=!0;var r=t._c;m(function(){for(var e=t._v,i=1==t._s,o=0;r.length>o;)!function(n){var r,o,u=i?n.ok:n.fail,c=n.resolve,a=n.reject,f=n.domain;try{u?(i||(2==t._h&&T(t),t._h=1),!0===u?r=e:(f&&f.enter(),r=u(e),f&&f.exit()),r===n.promise?a(w("Promise-chain cycle")):(o=A(r))?o.call(r,c,a):c(r)):a(e)}catch(t){a(t)}}(r[o++]);t._c=[],t._n=!1,n&&!t._h&&N(t)})}},N=function(t){g.call(a,function(){var n,r,e,i=t._v,o=j(t);if(o&&(n=x(function(){O?_.emit("unhandledRejection",i,t):(r=a.onunhandledrejection)?r({promise:t,reason:i}):(e=a.console)&&e.error&&e.error("Unhandled promise rejection",i)}),t._h=O||j(t)?2:1),t._a=void 0,o&&n.e)throw n.v})},j=function(t){if(1==t._h)return!1;for(var n,r=t._a||t._c,e=0;r.length>e;)if(n=r[e++],n.fail||!j(n.promise))return!1;return!0},T=function(t){g.call(a,function(){var n;O?_.emit("rejectionHandled",t):(n=a.onrejectionhandled)&&n({promise:t,reason:t._v})})},R=function(t){var n=this;n._d||(n._d=!0,n=n._w||n,n._v=t,n._s=2,n._a||(n._a=n._c.slice()),k(n,!0))},L=function(t){var n,r=this;if(!r._d){r._d=!0,r=r._w||r;try{if(r===t)throw w("Promise can't be resolved itself");(n=A(t))?m(function(){var e={_w:r,_d:!1};try{n.call(t,f(L,e,1),f(R,e,1))}catch(t){R.call(e,t)}}):(r._v=t,r._s=1,k(r,!1))}catch(t){R.call({_w:r,_d:!1},t)}}};F||(E=function Promise(t){p(this,E,"Promise","_h"),v(t),e.call(this);try{t(f(L,this,1),f(R,this,1))}catch(t){R.call(this,t)}},e=function Promise(t){this._c=[],this._a=void 0,this._s=0,this._d=!1,this._v=void 0,this._h=0,this._n=!1},e.prototype=t(93)(E.prototype,{then:function then(t,n){var r=M(y(this,E));return r.ok="function"!=typeof t||t,r.fail="function"==typeof n&&n,r.domain=O?_.domain:void 0,this._c.push(r),this._a&&this._a.push(r),this._s&&k(this,!1),r.promise},catch:function(t){return this.then(void 0,t)}}),o=function(){var t=new e;this.promise=t,this.resolve=f(L,t,1),this.reject=f(R,t,1)},b.f=M=function(t){return I(E,t)?new o(t):i(t)}),l(l.G+l.W+l.F*!F,{Promise:E}),t(101)(E,"Promise"),t(100)("Promise"),u=t(23).Promise,l(l.S+l.F*!F,"Promise",{reject:function reject(t){var n=M(this);return(0,n.reject)(t),n.promise}}),l(l.S+l.F*(c||!F),"Promise",{resolve:function resolve(t){return t instanceof E&&I(t.constructor,this)?t:S(this,t)}}),l(l.S+l.F*!(F&&t(56)(function(t){E.all(t).catch(P)})),"Promise",{all:function all(t){var n=this,r=M(n),e=r.resolve,i=r.reject,o=x(function(){var r=[],o=0,u=1;d(t,!1,function(t){var c=o++,a=!1;r.push(void 0),u++,n.resolve(t).then(function(t){a||(a=!0,r[c]=t,--u||e(r))},i)}),--u||e(r)});return o.e&&i(o.v),r.promise},race:function race(t){var n=this,r=M(n),e=r.reject,i=x(function(){d(t,!1,function(t){n.resolve(t).then(r.resolve,e)})});return i.e&&e(i.v),r.promise}})},{100:100,101:101,104:104,113:113,128:128,17:17,23:23,25:25,
3:3,33:33,39:39,40:40,51:51,56:56,6:6,60:60,68:68,69:69,90:90,91:91,93:93}],210:[function(t,n,r){var e=t(33),i=t(3),o=t(7),u=(t(40).Reflect||{}).apply,c=Function.apply;e(e.S+e.F*!t(35)(function(){u(function(){})}),"Reflect",{apply:function apply(t,n,r){var e=i(t),a=o(r);return u?u(e,n,a):c.call(e,n,a)}})},{3:3,33:33,35:35,40:40,7:7}],211:[function(t,n,r){var e=t(33),i=t(71),o=t(3),u=t(7),c=t(51),a=t(35),f=t(16),s=(t(40).Reflect||{}).construct,l=a(function(){function F(){}return!(s(function(){},[],F)instanceof F)}),h=!a(function(){s(function(){})});e(e.S+e.F*(l||h),"Reflect",{construct:function construct(t,n){o(t),u(n);var r=arguments.length<3?t:o(arguments[2]);if(h&&!l)return s(t,n,r);if(t==r){switch(n.length){case 0:return new t;case 1:return new t(n[0]);case 2:return new t(n[0],n[1]);case 3:return new t(n[0],n[1],n[2]);case 4:return new t(n[0],n[1],n[2],n[3])}var e=[null];return e.push.apply(e,n),new(f.apply(t,e))}var a=r.prototype,v=i(c(a)?a:Object.prototype),p=Function.apply.call(t,v,n);return c(p)?p:v}})},{16:16,3:3,33:33,35:35,40:40,51:51,7:7,71:71}],212:[function(t,n,r){var e=t(72),i=t(33),o=t(7),u=t(120);i(i.S+i.F*t(35)(function(){Reflect.defineProperty(e.f({},1,{value:1}),1,{value:2})}),"Reflect",{defineProperty:function defineProperty(t,n,r){o(t),n=u(n,!0),o(r);try{return e.f(t,n,r),!0}catch(t){return!1}}})},{120:120,33:33,35:35,7:7,72:72}],213:[function(t,n,r){var e=t(33),i=t(75).f,o=t(7);e(e.S,"Reflect",{deleteProperty:function deleteProperty(t,n){var r=i(o(t),n);return!(r&&!r.configurable)&&delete t[n]}})},{33:33,7:7,75:75}],214:[function(t,n,r){"use strict";var e=t(33),i=t(7),o=function(t){this._t=i(t),this._i=0;var n,r=this._k=[];for(n in t)r.push(n)};t(54)(o,"Object",function(){var t,n=this,r=n._k;do{if(n._i>=r.length)return{value:void 0,done:!0}}while(!((t=r[n._i++])in n._t));return{value:t,done:!1}}),e(e.S,"Reflect",{enumerate:function enumerate(t){return new o(t)}})},{33:33,54:54,7:7}],215:[function(t,n,r){var e=t(75),i=t(33),o=t(7);i(i.S,"Reflect",{getOwnPropertyDescriptor:function getOwnPropertyDescriptor(t,n){return e.f(o(t),n)}})},{33:33,7:7,75:75}],216:[function(t,n,r){var e=t(33),i=t(79),o=t(7);e(e.S,"Reflect",{getPrototypeOf:function getPrototypeOf(t){return i(o(t))}})},{33:33,7:7,79:79}],217:[function(t,n,r){function get(t,n){var r,u,f=arguments.length<3?t:arguments[2];return a(t)===f?t[n]:(r=e.f(t,n))?o(r,"value")?r.value:void 0!==r.get?r.get.call(f):void 0:c(u=i(t))?get(u,n,f):void 0}var e=t(75),i=t(79),o=t(41),u=t(33),c=t(51),a=t(7);u(u.S,"Reflect",{get:get})},{33:33,41:41,51:51,7:7,75:75,79:79}],218:[function(t,n,r){var e=t(33);e(e.S,"Reflect",{has:function has(t,n){return n in t}})},{33:33}],219:[function(t,n,r){var e=t(33),i=t(7),o=Object.isExtensible;e(e.S,"Reflect",{isExtensible:function isExtensible(t){return i(t),!o||o(t)}})},{33:33,7:7}],220:[function(t,n,r){var e=t(33);e(e.S,"Reflect",{ownKeys:t(85)})},{33:33,85:85}],221:[function(t,n,r){var e=t(33),i=t(7),o=Object.preventExtensions;e(e.S,"Reflect",{preventExtensions:function preventExtensions(t){i(t);try{return o&&o(t),!0}catch(t){return!1}}})},{33:33,7:7}],222:[function(t,n,r){var e=t(33),i=t(99);i&&e(e.S,"Reflect",{setPrototypeOf:function setPrototypeOf(t,n){i.check(t,n);try{return i.set(t,n),!0}catch(t){return!1}}})},{33:33,99:99}],223:[function(t,n,r){function set(t,n,r){var c,l,h=arguments.length<4?t:arguments[3],v=i.f(f(t),n);if(!v){if(s(l=o(t)))return set(l,n,r,h);v=a(0)}return u(v,"value")?!(!1===v.writable||!s(h))&&(c=i.f(h,n)||a(0),c.value=r,e.f(h,n,c),!0):void 0!==v.set&&(v.set.call(h,r),!0)}var e=t(72),i=t(75),o=t(79),u=t(41),c=t(33),a=t(92),f=t(7),s=t(51);c(c.S,"Reflect",{set:set})},{33:33,41:41,51:51,7:7,72:72,75:75,79:79,92:92}],224:[function(t,n,r){var e=t(40),i=t(45),o=t(72).f,u=t(77).f,c=t(52),a=t(37),f=e.RegExp,s=f,l=f.prototype,h=/a/g,v=/a/g,p=new f(h)!==h;if(t(29)&&(!p||t(35)(function(){return v[t(128)("match")]=!1,f(h)!=h||f(v)==v||"/a/i"!=f(h,"i")}))){f=function RegExp(t,n){var r=this instanceof f,e=c(t),o=void 0===n;return!r&&e&&t.constructor===f&&o?t:i(p?new s(e&&!o?t.source:t,n):s((e=t instanceof f)?t.source:t,e&&o?a.call(t):n),r?this:l,f)};for(var d=u(s),y=0;d.length>y;)!function(t){t in f||o(f,t,{configurable:!0,get:function(){return s[t]},set:function(n){s[t]=n}})}(d[y++]);l.constructor=f,f.prototype=l,t(94)(e,"RegExp",f)}t(100)("RegExp")},{100:100,128:128,29:29,35:35,37:37,40:40,45:45,52:52,72:72,77:77,94:94}],225:[function(t,n,r){t(29)&&"g"!=/./g.flags&&t(72).f(RegExp.prototype,"flags",{configurable:!0,get:t(37)})},{29:29,37:37,72:72}],226:[function(t,n,r){t(36)("match",1,function(t,n,r){return[function match(r){"use strict";var e=t(this),i=void 0==r?void 0:r[n];return void 0!==i?i.call(r,e):new RegExp(r)[n](String(e))},r]})},{36:36}],227:[function(t,n,r){t(36)("replace",2,function(t,n,r){return[function replace(e,i){"use strict";var o=t(this),u=void 0==e?void 0:e[n];return void 0!==u?u.call(e,o,i):r.call(String(o),e,i)},r]})},{36:36}],228:[function(t,n,r){t(36)("search",1,function(t,n,r){return[function search(r){"use strict";var e=t(this),i=void 0==r?void 0:r[n];return void 0!==i?i.call(r,e):new RegExp(r)[n](String(e))},r]})},{36:36}],229:[function(t,n,r){t(36)("split",2,function(n,r,e){"use strict";var i=t(52),o=e,u=[].push,c="length";if("c"=="abbc".split(/(b)*/)[1]||4!="test".split(/(?:)/,-1)[c]||2!="ab".split(/(?:ab)*/)[c]||4!=".".split(/(.?)(.?)/)[c]||".".split(/()()/)[c]>1||"".split(/.?/)[c]){var a=void 0===/()??/.exec("")[1];e=function(t,n){var r=String(this);if(void 0===t&&0===n)return[];if(!i(t))return o.call(r,t,n);var e,f,s,l,h,v=[],p=(t.ignoreCase?"i":"")+(t.multiline?"m":"")+(t.unicode?"u":"")+(t.sticky?"y":""),d=0,y=void 0===n?4294967295:n>>>0,g=new RegExp(t.source,p+"g");for(a||(e=new RegExp("^"+g.source+"$(?!\\s)",p));(f=g.exec(r))&&!((s=f.index+f[0][c])>d&&(v.push(r.slice(d,f.index)),!a&&f[c]>1&&f[0].replace(e,function(){for(h=1;h<arguments[c]-2;h++)void 0===arguments[h]&&(f[h]=void 0)}),f[c]>1&&f.index<r[c]&&u.apply(v,f.slice(1)),l=f[0][c],d=s,v[c]>=y));)g.lastIndex===f.index&&g.lastIndex++;return d===r[c]?!l&&g.test("")||v.push(""):v.push(r.slice(d)),v[c]>y?v.slice(0,y):v}}else"0".split(void 0,0)[c]&&(e=function(t,n){return void 0===t&&0===n?[]:o.call(this,t,n)});return[function split(t,i){var o=n(this),u=void 0==t?void 0:t[r];return void 0!==u?u.call(t,o,i):e.call(String(o),t,i)},e]})},{36:36,52:52}],230:[function(t,n,r){"use strict";t(225);var e=t(7),i=t(37),o=t(29),u=/./.toString,c=function(n){t(94)(RegExp.prototype,"toString",n,!0)};t(35)(function(){return"/a/b"!=u.call({source:"a",flags:"b"})})?c(function toString(){var t=e(this);return"/".concat(t.source,"/","flags"in t?t.flags:!o&&t instanceof RegExp?i.call(t):void 0)}):"toString"!=u.name&&c(function toString(){return u.call(this)})},{225:225,29:29,35:35,37:37,7:7,94:94}],231:[function(t,n,r){"use strict";var e=t(19),i=t(125);n.exports=t(22)("Set",function(t){return function Set(){return t(this,arguments.length>0?arguments[0]:void 0)}},{add:function add(t){return e.def(i(this,"Set"),t=0===t?0:t,t)}},e)},{125:125,19:19,22:22}],232:[function(t,n,r){"use strict";t(108)("anchor",function(t){return function anchor(n){return t(this,"a","name",n)}})},{108:108}],233:[function(t,n,r){"use strict";t(108)("big",function(t){return function big(){return t(this,"big","","")}})},{108:108}],234:[function(t,n,r){"use strict";t(108)("blink",function(t){return function blink(){return t(this,"blink","","")}})},{108:108}],235:[function(t,n,r){"use strict";t(108)("bold",function(t){return function bold(){return t(this,"b","","")}})},{108:108}],236:[function(t,n,r){"use strict";var e=t(33),i=t(106)(!1);e(e.P,"String",{codePointAt:function codePointAt(t){return i(this,t)}})},{106:106,33:33}],237:[function(t,n,r){"use strict";var e=t(33),i=t(118),o=t(107),u="".endsWith;e(e.P+e.F*t(34)("endsWith"),"String",{endsWith:function endsWith(t){var n=o(this,t,"endsWith"),r=arguments.length>1?arguments[1]:void 0,e=i(n.length),c=void 0===r?e:Math.min(i(r),e),a=String(t);return u?u.call(n,a,c):n.slice(c-a.length,c)===a}})},{107:107,118:118,33:33,34:34}],238:[function(t,n,r){"use strict";t(108)("fixed",function(t){return function fixed(){return t(this,"tt","","")}})},{108:108}],239:[function(t,n,r){"use strict";t(108)("fontcolor",function(t){return function fontcolor(n){return t(this,"font","color",n)}})},{108:108}],240:[function(t,n,r){"use strict";t(108)("fontsize",function(t){return function fontsize(n){return t(this,"font","size",n)}})},{108:108}],241:[function(t,n,r){var e=t(33),i=t(114),o=String.fromCharCode,u=String.fromCodePoint;e(e.S+e.F*(!!u&&1!=u.length),"String",{fromCodePoint:function fromCodePoint(t){for(var n,r=[],e=arguments.length,u=0;e>u;){if(n=+arguments[u++],i(n,1114111)!==n)throw RangeError(n+" is not a valid code point");r.push(n<65536?o(n):o(55296+((n-=65536)>>10),n%1024+56320))}return r.join("")}})},{114:114,33:33}],242:[function(t,n,r){"use strict";var e=t(33),i=t(107);e(e.P+e.F*t(34)("includes"),"String",{includes:function includes(t){return!!~i(this,t,"includes").indexOf(t,arguments.length>1?arguments[1]:void 0)}})},{107:107,33:33,34:34}],243:[function(t,n,r){"use strict";t(108)("italics",function(t){return function italics(){return t(this,"i","","")}})},{108:108}],244:[function(t,n,r){"use strict";var e=t(106)(!0);t(55)(String,"String",function(t){this._t=String(t),this._i=0},function(){var t,n=this._t,r=this._i;return r>=n.length?{value:void 0,done:!0}:(t=e(n,r),this._i+=t.length,{value:t,done:!1})})},{106:106,55:55}],245:[function(t,n,r){"use strict";t(108)("link",function(t){return function link(n){return t(this,"a","href",n)}})},{108:108}],246:[function(t,n,r){var e=t(33),i=t(117),o=t(118);e(e.S,"String",{raw:function raw(t){for(var n=i(t.raw),r=o(n.length),e=arguments.length,u=[],c=0;r>c;)u.push(String(n[c++])),c<e&&u.push(String(arguments[c]));return u.join("")}})},{117:117,118:118,33:33}],247:[function(t,n,r){var e=t(33);e(e.P,"String",{repeat:t(110)})},{110:110,33:33}],248:[function(t,n,r){"use strict";t(108)("small",function(t){return function small(){return t(this,"small","","")}})},{108:108}],249:[function(t,n,r){"use strict";var e=t(33),i=t(118),o=t(107),u="".startsWith;e(e.P+e.F*t(34)("startsWith"),"String",{startsWith:function startsWith(t){var n=o(this,t,"startsWith"),r=i(Math.min(arguments.length>1?arguments[1]:void 0,n.length)),e=String(t);return u?u.call(n,e,r):n.slice(r,r+e.length)===e}})},{107:107,118:118,33:33,34:34}],250:[function(t,n,r){"use strict";t(108)("strike",function(t){return function strike(){return t(this,"strike","","")}})},{108:108}],251:[function(t,n,r){"use strict";t(108)("sub",function(t){return function sub(){return t(this,"sub","","")}})},{108:108}],252:[function(t,n,r){"use strict";t(108)("sup",function(t){return function sup(){return t(this,"sup","","")}})},{108:108}],253:[function(t,n,r){"use strict";t(111)("trim",function(t){return function trim(){return t(this,3)}})},{111:111}],254:[function(t,n,r){"use strict";var e=t(40),i=t(41),o=t(29),u=t(33),c=t(94),a=t(66).KEY,f=t(35),s=t(103),l=t(101),h=t(124),v=t(128),p=t(127),d=t(126),y=t(59),g=t(32),m=t(49),b=t(7),x=t(117),S=t(120),w=t(92),_=t(71),E=t(76),O=t(75),P=t(72),M=t(81),F=O.f,I=P.f,A=E.f,k=e.Symbol,N=e.JSON,j=N&&N.stringify,T=v("_hidden"),R=v("toPrimitive"),L={}.propertyIsEnumerable,G=s("symbol-registry"),D=s("symbols"),C=s("op-symbols"),W=Object.prototype,U="function"==typeof k,B=e.QObject,V=!B||!B.prototype||!B.prototype.findChild,z=o&&f(function(){return 7!=_(I({},"a",{get:function(){return I(this,"a",{value:7}).a}})).a})?function(t,n,r){var e=F(W,n);e&&delete W[n],I(t,n,r),e&&t!==W&&I(W,n,e)}:I,q=function(t){var n=D[t]=_(k.prototype);return n._k=t,n},K=U&&"symbol"==typeof k.iterator?function(t){return"symbol"==typeof t}:function(t){return t instanceof k},Y=function defineProperty(t,n,r){return t===W&&Y(C,n,r),b(t),n=S(n,!0),b(r),i(D,n)?(r.enumerable?(i(t,T)&&t[T][n]&&(t[T][n]=!1),r=_(r,{enumerable:w(0,!1)})):(i(t,T)||I(t,T,w(1,{})),t[T][n]=!0),z(t,n,r)):I(t,n,r)},J=function defineProperties(t,n){b(t);for(var r,e=g(n=x(n)),i=0,o=e.length;o>i;)Y(t,r=e[i++],n[r]);return t},H=function create(t,n){return void 0===n?_(t):J(_(t),n)},X=function propertyIsEnumerable(t){var n=L.call(this,t=S(t,!0));return!(this===W&&i(D,t)&&!i(C,t))&&(!(n||!i(this,t)||!i(D,t)||i(this,T)&&this[T][t])||n)},$=function getOwnPropertyDescriptor(t,n){if(t=x(t),n=S(n,!0),t!==W||!i(D,n)||i(C,n)){var r=F(t,n);return!r||!i(D,n)||i(t,T)&&t[T][n]||(r.enumerable=!0),r}},Z=function getOwnPropertyNames(t){for(var n,r=A(x(t)),e=[],o=0;r.length>o;)i(D,n=r[o++])||n==T||n==a||e.push(n);return e},Q=function getOwnPropertySymbols(t){for(var n,r=t===W,e=A(r?C:x(t)),o=[],u=0;e.length>u;)!i(D,n=e[u++])||r&&!i(W,n)||o.push(D[n]);return o};U||(k=function Symbol(){if(this instanceof k)throw TypeError("Symbol is not a constructor!");var t=h(arguments.length>0?arguments[0]:void 0),n=function(r){this===W&&n.call(C,r),i(this,T)&&i(this[T],t)&&(this[T][t]=!1),z(this,t,w(1,r))};return o&&V&&z(W,t,{configurable:!0,set:n}),q(t)},c(k.prototype,"toString",function toString(){return this._k}),O.f=$,P.f=Y,t(77).f=E.f=Z,t(82).f=X,t(78).f=Q,o&&!t(60)&&c(W,"propertyIsEnumerable",X,!0),p.f=function(t){return q(v(t))}),u(u.G+u.W+u.F*!U,{Symbol:k});for(var tt="hasInstance,isConcatSpreadable,iterator,match,replace,search,species,split,toPrimitive,toStringTag,unscopables".split(","),nt=0;tt.length>nt;)v(tt[nt++]);for(var rt=M(v.store),et=0;rt.length>et;)d(rt[et++]);u(u.S+u.F*!U,"Symbol",{for:function(t){return i(G,t+="")?G[t]:G[t]=k(t)},keyFor:function keyFor(t){if(K(t))return y(G,t);throw TypeError(t+" is not a symbol!")},useSetter:function(){V=!0},useSimple:function(){V=!1}}),u(u.S+u.F*!U,"Object",{create:H,defineProperty:Y,defineProperties:J,getOwnPropertyDescriptor:$,getOwnPropertyNames:Z,getOwnPropertySymbols:Q}),N&&u(u.S+u.F*(!U||f(function(){var t=k();return"[null]"!=j([t])||"{}"!=j({a:t})||"{}"!=j(Object(t))})),"JSON",{stringify:function stringify(t){if(void 0!==t&&!K(t)){for(var n,r,e=[t],i=1;arguments.length>i;)e.push(arguments[i++]);return n=e[1],"function"==typeof n&&(r=n),!r&&m(n)||(n=function(t,n){if(r&&(n=r.call(this,t,n)),!K(n))return n}),e[1]=n,j.apply(N,e)}}}),k.prototype[R]||t(42)(k.prototype,R,k.prototype.valueOf),l(k,"Symbol"),l(Math,"Math",!0),l(e.JSON,"JSON",!0)},{101:101,103:103,117:117,120:120,124:124,126:126,127:127,128:128,29:29,32:32,33:33,35:35,40:40,41:41,42:42,49:49,59:59,60:60,66:66,7:7,71:71,72:72,75:75,76:76,77:77,78:78,81:81,82:82,92:92,94:94}],255:[function(t,n,r){"use strict";var e=t(33),i=t(123),o=t(122),u=t(7),c=t(114),a=t(118),f=t(51),s=t(40).ArrayBuffer,l=t(104),h=o.ArrayBuffer,v=o.DataView,p=i.ABV&&s.isView,d=h.prototype.slice,y=i.VIEW;e(e.G+e.W+e.F*(s!==h),{ArrayBuffer:h}),e(e.S+e.F*!i.CONSTR,"ArrayBuffer",{isView:function isView(t){return p&&p(t)||f(t)&&y in t}}),e(e.P+e.U+e.F*t(35)(function(){return!new h(2).slice(1,void 0).byteLength}),"ArrayBuffer",{slice:function slice(t,n){if(void 0!==d&&void 0===n)return d.call(u(this),t);for(var r=u(this).byteLength,e=c(t,r),i=c(void 0===n?r:n,r),o=new(l(this,h))(a(i-e)),f=new v(this),s=new v(o),p=0;e<i;)s.setUint8(p++,f.getUint8(e++));return o}}),t(100)("ArrayBuffer")},{100:100,104:104,114:114,118:118,122:122,123:123,33:33,35:35,40:40,51:51,7:7}],256:[function(t,n,r){var e=t(33);e(e.G+e.W+e.F*!t(123).ABV,{DataView:t(122).DataView})},{122:122,123:123,33:33}],257:[function(t,n,r){t(121)("Float32",4,function(t){return function Float32Array(n,r,e){return t(this,n,r,e)}})},{121:121}],258:[function(t,n,r){t(121)("Float64",8,function(t){return function Float64Array(n,r,e){return t(this,n,r,e)}})},{121:121}],259:[function(t,n,r){t(121)("Int16",2,function(t){return function Int16Array(n,r,e){return t(this,n,r,e)}})},{121:121}],260:[function(t,n,r){t(121)("Int32",4,function(t){return function Int32Array(n,r,e){return t(this,n,r,e)}})},{121:121}],261:[function(t,n,r){t(121)("Int8",1,function(t){return function Int8Array(n,r,e){return t(this,n,r,e)}})},{121:121}],262:[function(t,n,r){t(121)("Uint16",2,function(t){return function Uint16Array(n,r,e){return t(this,n,r,e)}})},{121:121}],263:[function(t,n,r){t(121)("Uint32",4,function(t){return function Uint32Array(n,r,e){return t(this,n,r,e)}})},{121:121}],264:[function(t,n,r){t(121)("Uint8",1,function(t){return function Uint8Array(n,r,e){return t(this,n,r,e)}})},{121:121}],265:[function(t,n,r){t(121)("Uint8",1,function(t){return function Uint8ClampedArray(n,r,e){return t(this,n,r,e)}},!0)},{121:121}],266:[function(t,n,r){"use strict";var e,i=t(12)(0),o=t(94),u=t(66),c=t(70),a=t(21),f=t(51),s=t(35),l=t(125),h=u.getWeak,v=Object.isExtensible,p=a.ufstore,d={},y=function(t){return function WeakMap(){return t(this,arguments.length>0?arguments[0]:void 0)}},g={get:function get(t){if(f(t)){var n=h(t);return!0===n?p(l(this,"WeakMap")).get(t):n?n[this._i]:void 0}},set:function set(t,n){return a.def(l(this,"WeakMap"),t,n)}},m=n.exports=t(22)("WeakMap",y,g,a,!0,!0);s(function(){return 7!=(new m).set((Object.freeze||Object)(d),7).get(d)})&&(e=a.getConstructor(y,"WeakMap"),c(e.prototype,g),u.NEED=!0,i(["delete","has","get","set"],function(t){var n=m.prototype,r=n[t];o(n,t,function(n,i){if(f(n)&&!v(n)){this._f||(this._f=new e);var o=this._f[t](n,i);return"set"==t?this:o}return r.call(this,n,i)})}))},{12:12,125:125,21:21,22:22,35:35,51:51,66:66,70:70,94:94}],267:[function(t,n,r){"use strict";var e=t(21),i=t(125);t(22)("WeakSet",function(t){return function WeakSet(){return t(this,arguments.length>0?arguments[0]:void 0)}},{add:function add(t){return e.def(i(this,"WeakSet"),t,!0)}},e,!1,!0)},{125:125,21:21,22:22}],268:[function(t,n,r){"use strict";var e=t(33),i=t(38),o=t(119),u=t(118),c=t(3),a=t(15);e(e.P,"Array",{flatMap:function flatMap(t){var n,r,e=o(this);return c(t),n=u(e.length),r=a(e,0),i(r,e,e,n,0,1,t,arguments[1]),r}}),t(5)("flatMap")},{118:118,119:119,15:15,3:3,33:33,38:38,5:5}],269:[function(t,n,r){"use strict";var e=t(33),i=t(38),o=t(119),u=t(118),c=t(116),a=t(15);e(e.P,"Array",{flatten:function flatten(){var t=arguments[0],n=o(this),r=u(n.length),e=a(n,0);return i(e,n,n,r,0,void 0===t?1:c(t)),e}}),t(5)("flatten")},{116:116,118:118,119:119,15:15,33:33,38:38,5:5}],270:[function(t,n,r){"use strict";var e=t(33),i=t(11)(!0);e(e.P,"Array",{includes:function includes(t){return i(this,t,arguments.length>1?arguments[1]:void 0)}}),t(5)("includes")},{11:11,33:33,5:5}],271:[function(t,n,r){var e=t(33),i=t(68)(),o=t(40).process,u="process"==t(18)(o);e(e.G,{asap:function asap(t){var n=u&&o.domain;i(n?n.bind(t):t)}})},{18:18,33:33,40:40,68:68}],272:[function(t,n,r){var e=t(33),i=t(18);e(e.S,"Error",{isError:function isError(t){return"Error"===i(t)}})},{18:18,33:33}],273:[function(t,n,r){var e=t(33);e(e.G,{global:t(40)})},{33:33,40:40}],274:[function(t,n,r){t(97)("Map")},{97:97}],275:[function(t,n,r){t(98)("Map")},{98:98}],276:[function(t,n,r){var e=t(33);e(e.P+e.R,"Map",{toJSON:t(20)("Map")})},{20:20,33:33}],277:[function(t,n,r){var e=t(33);e(e.S,"Math",{clamp:function clamp(t,n,r){return Math.min(r,Math.max(n,t))}})},{33:33}],278:[function(t,n,r){var e=t(33);e(e.S,"Math",{DEG_PER_RAD:Math.PI/180})},{33:33}],279:[function(t,n,r){var e=t(33),i=180/Math.PI;e(e.S,"Math",{degrees:function degrees(t){return t*i}})},{33:33}],280:[function(t,n,r){var e=t(33),i=t(64),o=t(62);e(e.S,"Math",{fscale:function fscale(t,n,r,e,u){return o(i(t,n,r,e,u))}})},{33:33,62:62,64:64}],281:[function(t,n,r){var e=t(33);e(e.S,"Math",{iaddh:function iaddh(t,n,r,e){var i=t>>>0,o=n>>>0,u=r>>>0;return o+(e>>>0)+((i&u|(i|u)&~(i+u>>>0))>>>31)|0}})},{33:33}],282:[function(t,n,r){var e=t(33);e(e.S,"Math",{imulh:function imulh(t,n){var r=+t,e=+n,i=65535&r,o=65535&e,u=r>>16,c=e>>16,a=(u*o>>>0)+(i*o>>>16);return u*c+(a>>16)+((i*c>>>0)+(65535&a)>>16)}})},{33:33}],283:[function(t,n,r){var e=t(33);e(e.S,"Math",{isubh:function isubh(t,n,r,e){var i=t>>>0,o=n>>>0,u=r>>>0;return o-(e>>>0)-((~i&u|~(i^u)&i-u>>>0)>>>31)|0}})},{33:33}],284:[function(t,n,r){var e=t(33);e(e.S,"Math",{RAD_PER_DEG:180/Math.PI})},{33:33}],285:[function(t,n,r){var e=t(33),i=Math.PI/180;e(e.S,"Math",{radians:function radians(t){return t*i}})},{33:33}],286:[function(t,n,r){var e=t(33);e(e.S,"Math",{scale:t(64)})},{33:33,64:64}],287:[function(t,n,r){var e=t(33);e(e.S,"Math",{signbit:function signbit(t){return(t=+t)!=t?t:0==t?1/t==1/0:t>0}})},{33:33}],288:[function(t,n,r){var e=t(33);e(e.S,"Math",{umulh:function umulh(t,n){var r=+t,e=+n,i=65535&r,o=65535&e,u=r>>>16,c=e>>>16,a=(u*o>>>0)+(i*o>>>16);return u*c+(a>>>16)+((i*c>>>0)+(65535&a)>>>16)}})},{33:33}],289:[function(t,n,r){"use strict";var e=t(33),i=t(119),o=t(3),u=t(72);t(29)&&e(e.P+t(74),"Object",{__defineGetter__:function __defineGetter__(t,n){u.f(i(this),t,{get:o(n),enumerable:!0,configurable:!0})}})},{119:119,29:29,3:3,33:33,72:72,74:74}],290:[function(t,n,r){"use strict";var e=t(33),i=t(119),o=t(3),u=t(72);t(29)&&e(e.P+t(74),"Object",{__defineSetter__:function __defineSetter__(t,n){u.f(i(this),t,{set:o(n),enumerable:!0,configurable:!0})}})},{119:119,29:29,3:3,33:33,72:72,74:74}],291:[function(t,n,r){var e=t(33),i=t(84)(!0);e(e.S,"Object",{entries:function entries(t){return i(t)}})},{33:33,84:84}],292:[function(t,n,r){var e=t(33),i=t(85),o=t(117),u=t(75),c=t(24);e(e.S,"Object",{getOwnPropertyDescriptors:function getOwnPropertyDescriptors(t){for(var n,r,e=o(t),a=u.f,f=i(e),s={},l=0;f.length>l;)void 0!==(r=a(e,n=f[l++]))&&c(s,n,r);return s}})},{117:117,24:24,33:33,75:75,85:85}],293:[function(t,n,r){"use strict";var e=t(33),i=t(119),o=t(120),u=t(79),c=t(75).f;t(29)&&e(e.P+t(74),"Object",{__lookupGetter__:function __lookupGetter__(t){var n,r=i(this),e=o(t,!0);do{if(n=c(r,e))return n.get}while(r=u(r))}})},{119:119,120:120,29:29,33:33,74:74,75:75,79:79}],294:[function(t,n,r){"use strict";var e=t(33),i=t(119),o=t(120),u=t(79),c=t(75).f;t(29)&&e(e.P+t(74),"Object",{__lookupSetter__:function __lookupSetter__(t){var n,r=i(this),e=o(t,!0);do{if(n=c(r,e))return n.set}while(r=u(r))}})},{119:119,120:120,29:29,33:33,74:74,75:75,79:79}],295:[function(t,n,r){var e=t(33),i=t(84)(!1);e(e.S,"Object",{values:function values(t){return i(t)}})},{33:33,84:84}],296:[function(t,n,r){"use strict";var e=t(33),i=t(40),o=t(23),u=t(68)(),c=t(128)("observable"),a=t(3),f=t(7),s=t(6),l=t(93),h=t(42),v=t(39),p=v.RETURN,d=function(t){return null==t?void 0:a(t)},y=function(t){var n=t._c;n&&(t._c=void 0,n())},g=function(t){return void 0===t._o},m=function(t){g(t)||(t._o=void 0,y(t))},b=function(t,n){f(t),this._c=void 0,this._o=t,t=new x(this);try{var r=n(t),e=r;null!=r&&("function"==typeof r.unsubscribe?r=function(){e.unsubscribe()}:a(r),this._c=r)}catch(n){return void t.error(n)}g(this)&&y(this)};b.prototype=l({},{unsubscribe:function unsubscribe(){m(this)}});var x=function(t){this._s=t};x.prototype=l({},{next:function next(t){var n=this._s;if(!g(n)){var r=n._o;try{var e=d(r.next);if(e)return e.call(r,t)}catch(t){try{m(n)}finally{throw t}}}},error:function error(t){var n=this._s;if(g(n))throw t;var r=n._o;n._o=void 0;try{var e=d(r.error);if(!e)throw t;t=e.call(r,t)}catch(t){try{y(n)}finally{throw t}}return y(n),t},complete:function complete(t){var n=this._s;if(!g(n)){var r=n._o;n._o=void 0;try{var e=d(r.complete);t=e?e.call(r,t):void 0}catch(t){try{y(n)}finally{throw t}}return y(n),t}}});var S=function Observable(t){s(this,S,"Observable","_f")._f=a(t)};l(S.prototype,{subscribe:function subscribe(t){return new b(t,this._f)},forEach:function forEach(t){var n=this;return new(o.Promise||i.Promise)(function(r,e){a(t);var i=n.subscribe({next:function(n){try{return t(n)}catch(t){e(t),i.unsubscribe()}},error:e,complete:r})})}}),l(S,{from:function from(t){var n="function"==typeof this?this:S,r=d(f(t)[c]);if(r){var e=f(r.call(t));return e.constructor===n?e:new n(function(t){return e.subscribe(t)})}return new n(function(n){var r=!1;return u(function(){if(!r){try{if(v(t,!1,function(t){if(n.next(t),r)return p})===p)return}catch(t){if(r)throw t;return void n.error(t)}n.complete()}}),function(){r=!0}})},of:function of(){for(var t=0,n=arguments.length,r=Array(n);t<n;)r[t]=arguments[t++];return new("function"==typeof this?this:S)(function(t){var n=!1;return u(function(){if(!n){for(var e=0;e<r.length;++e)if(t.next(r[e]),n)return;t.complete()}}),function(){n=!0}})}}),h(S.prototype,c,function(){return this}),e(e.G,{Observable:S}),t(100)("Observable")},{100:100,128:128,23:23,3:3,33:33,39:39,40:40,42:42,6:6,68:68,7:7,93:93}],297:[function(t,n,r){"use strict";var e=t(33),i=t(23),o=t(40),u=t(104),c=t(91);e(e.P+e.R,"Promise",{finally:function(t){var n=u(this,i.Promise||o.Promise),r="function"==typeof t;return this.then(r?function(r){return c(n,t()).then(function(){return r})}:t,r?function(r){return c(n,t()).then(function(){throw r})}:t)}})},{104:104,23:23,33:33,40:40,91:91}],298:[function(t,n,r){"use strict";var e=t(33),i=t(69),o=t(90);e(e.S,"Promise",{try:function(t){var n=i.f(this),r=o(t);return(r.e?n.reject:n.resolve)(r.v),n.promise}})},{33:33,69:69,90:90}],299:[function(t,n,r){var e=t(67),i=t(7),o=e.key,u=e.set;e.exp({defineMetadata:function defineMetadata(t,n,r,e){u(t,n,i(r),o(e))}})},{67:67,7:7}],300:[function(t,n,r){var e=t(67),i=t(7),o=e.key,u=e.map,c=e.store;e.exp({deleteMetadata:function deleteMetadata(t,n){var r=arguments.length<3?void 0:o(arguments[2]),e=u(i(n),r,!1);if(void 0===e||!e.delete(t))return!1;if(e.size)return!0;var a=c.get(n);return a.delete(r),!!a.size||c.delete(n)}})},{67:67,7:7}],301:[function(t,n,r){var e=t(231),i=t(10),o=t(67),u=t(7),c=t(79),a=o.keys,f=o.key,s=function(t,n){var r=a(t,n),o=c(t);if(null===o)return r;var u=s(o,n);return u.length?r.length?i(new e(r.concat(u))):u:r};o.exp({getMetadataKeys:function getMetadataKeys(t){return s(u(t),arguments.length<2?void 0:f(arguments[1]))}})},{10:10,231:231,67:67,7:7,79:79}],302:[function(t,n,r){var e=t(67),i=t(7),o=t(79),u=e.has,c=e.get,a=e.key,f=function(t,n,r){if(u(t,n,r))return c(t,n,r);var e=o(n);return null!==e?f(t,e,r):void 0};e.exp({getMetadata:function getMetadata(t,n){return f(t,i(n),arguments.length<3?void 0:a(arguments[2]))}})},{67:67,7:7,79:79}],303:[function(t,n,r){var e=t(67),i=t(7),o=e.keys,u=e.key;e.exp({getOwnMetadataKeys:function getOwnMetadataKeys(t){return o(i(t),arguments.length<2?void 0:u(arguments[1]))}})},{67:67,7:7}],304:[function(t,n,r){var e=t(67),i=t(7),o=e.get,u=e.key;e.exp({getOwnMetadata:function getOwnMetadata(t,n){return o(t,i(n),arguments.length<3?void 0:u(arguments[2]))}})},{67:67,7:7}],305:[function(t,n,r){var e=t(67),i=t(7),o=t(79),u=e.has,c=e.key,a=function(t,n,r){if(u(t,n,r))return!0;var e=o(n);return null!==e&&a(t,e,r)};e.exp({hasMetadata:function hasMetadata(t,n){return a(t,i(n),arguments.length<3?void 0:c(arguments[2]))}})},{67:67,7:7,79:79}],306:[function(t,n,r){var e=t(67),i=t(7),o=e.has,u=e.key;e.exp({hasOwnMetadata:function hasOwnMetadata(t,n){return o(t,i(n),arguments.length<3?void 0:u(arguments[2]))}})},{67:67,7:7}],307:[function(t,n,r){var e=t(67),i=t(7),o=t(3),u=e.key,c=e.set;e.exp({metadata:function metadata(t,n){return function decorator(r,e){c(t,n,(void 0!==e?i:o)(r),u(e))}}})},{3:3,67:67,7:7}],308:[function(t,n,r){t(97)("Set")},{97:97}],309:[function(t,n,r){t(98)("Set")},{98:98}],310:[function(t,n,r){var e=t(33);e(e.P+e.R,"Set",{toJSON:t(20)("Set")})},{20:20,33:33}],311:[function(t,n,r){"use strict";var e=t(33),i=t(106)(!0);e(e.P,"String",{at:function at(t){return i(this,t)}})},{106:106,33:33}],312:[function(t,n,r){"use strict";var e=t(33),i=t(28),o=t(118),u=t(52),c=t(37),a=RegExp.prototype,f=function(t,n){this._r=t,this._s=n};t(54)(f,"RegExp String",function next(){var t=this._r.exec(this._s);return{value:t,done:null===t}}),e(e.P,"String",{matchAll:function matchAll(t){if(i(this),!u(t))throw TypeError(t+" is not a regexp!");var n=String(this),r="flags"in a?String(t.flags):c.call(t),e=new RegExp(t.source,~r.indexOf("g")?r:"g"+r);return e.lastIndex=o(t.lastIndex),new f(e,n)}})},{118:118,28:28,33:33,37:37,52:52,54:54}],313:[function(t,n,r){"use strict";var e=t(33),i=t(109);e(e.P,"String",{padEnd:function padEnd(t){return i(this,t,arguments.length>1?arguments[1]:void 0,!1)}})},{109:109,33:33}],314:[function(t,n,r){"use strict";var e=t(33),i=t(109);e(e.P,"String",{padStart:function padStart(t){return i(this,t,arguments.length>1?arguments[1]:void 0,!0)}})},{109:109,33:33}],315:[function(t,n,r){"use strict";t(111)("trimLeft",function(t){return function trimLeft(){return t(this,1)}},"trimStart")},{111:111}],316:[function(t,n,r){"use strict";t(111)("trimRight",function(t){return function trimRight(){return t(this,2)}},"trimEnd")},{111:111}],317:[function(t,n,r){t(126)("asyncIterator")},{126:126}],318:[function(t,n,r){t(126)("observable")},{126:126}],319:[function(t,n,r){var e=t(33);e(e.S,"System",{global:t(40)})},{33:33,40:40}],320:[function(t,n,r){t(97)("WeakMap")},{97:97}],321:[function(t,n,r){t(98)("WeakMap")},{98:98}],322:[function(t,n,r){t(97)("WeakSet")},{97:97}],323:[function(t,n,r){t(98)("WeakSet")},{98:98}],324:[function(t,n,r){for(var e=t(141),i=t(81),o=t(94),u=t(40),c=t(42),a=t(58),f=t(128),s=f("iterator"),l=f("toStringTag"),h=a.Array,v={CSSRuleList:!0,CSSStyleDeclaration:!1,CSSValueList:!1,ClientRectList:!1,DOMRectList:!1,DOMStringList:!1,DOMTokenList:!0,DataTransferItemList:!1,FileList:!1,HTMLAllCollection:!1,HTMLCollection:!1,HTMLFormElement:!1,HTMLSelectElement:!1,MediaList:!0,MimeTypeArray:!1,NamedNodeMap:!1,NodeList:!0,PaintRequestList:!1,Plugin:!1,PluginArray:!1,SVGLengthList:!1,SVGNumberList:!1,SVGPathSegList:!1,SVGPointList:!1,SVGStringList:!1,SVGTransformList:!1,SourceBufferList:!1,StyleSheetList:!0,TextTrackCueList:!1,TextTrackList:!1,TouchList:!1},p=i(v),d=0;d<p.length;d++){var y,g=p[d],m=v[g],b=u[g],x=b&&b.prototype;if(x&&(x[s]||c(x,s,h),x[l]||c(x,l,g),a[g]=h,m))for(y in e)x[y]||o(x,y,e[y],!0)}},{128:128,141:141,40:40,42:42,58:58,81:81,94:94}],325:[function(t,n,r){var e=t(33),i=t(113);e(e.G+e.B,{setImmediate:i.set,clearImmediate:i.clear})},{113:113,33:33}],326:[function(t,n,r){var e=t(40),i=t(33),o=t(46),u=t(88),c=e.navigator,a=!!c&&/MSIE .\./.test(c.userAgent),f=function(t){return a?function(n,r){return t(o(u,[].slice.call(arguments,2),"function"==typeof n?n:Function(n)),r)}:t};i(i.G+i.B+i.F*a,{setTimeout:f(e.setTimeout),setInterval:f(e.setInterval)})},{33:33,40:40,46:46,88:88}],327:[function(t,n,r){t(254),t(191),t(193),t(192),t(195),t(197),t(202),t(196),t(194),t(204),t(203),t(199),t(200),t(198),t(190),t(201),t(205),t(206),t(157),t(159),t(158),t(208),t(207),t(178),t(188),t(189),t(179),t(180),t(181),t(182),t(183),t(184),t(185),t(186),t(187),t(161),t(162),t(163),t(164),t(165),t(166),t(167),t(168),t(169),t(170),t(171),t(172),t(173),t(174),t(175),t(176),t(177),t(241),t(246),t(253),t(244),t(236),t(237),t(242),t(247),t(249),t(232),t(233),t(234),t(235),t(238),t(239),t(240),t(243),t(245),t(248),t(250),t(251),t(252),t(152),t(154),t(153),t(156),t(155),t(140),t(138),t(145),t(142),t(148),t(150),t(137),t(144),t(134),t(149),t(132),t(147),t(146),t(139),t(143),t(131),t(133),t(136),t(135),t(151),t(141),t(224),t(230),t(225),t(226),t(227),t(228),t(229),t(209),t(160),t(231),t(266),t(267),t(255),t(256),t(261),t(264),t(265),t(259),t(262),t(260),t(263),t(257),t(258),t(210),t(211),t(212),t(213),t(214),t(217),t(215),t(216),t(218),t(219),t(220),t(221),t(223),t(222),t(270),t(268),t(269),t(311),t(314),t(313),t(315),t(316),t(312),t(317),t(318),t(292),t(295),t(291),t(289),t(290),t(293),t(294),t(276),t(310),t(275),t(309),t(321),t(323),t(274),t(308),t(320),t(322),t(273),t(319),t(272),t(277),t(278),t(279),t(280),t(281),t(283),t(282),t(284),t(285),t(286),t(288),t(287),t(297),t(298),t(299),t(300),t(302),t(301),t(304),t(303),t(305),t(306),t(307),t(271),t(296),t(326),t(325),t(324),n.exports=t(23)},{131:131,132:132,133:133,134:134,135:135,136:136,137:137,138:138,139:139,140:140,141:141,142:142,143:143,144:144,145:145,146:146,147:147,148:148,149:149,150:150,151:151,152:152,153:153,154:154,155:155,156:156,157:157,158:158,159:159,160:160,161:161,162:162,163:163,164:164,165:165,166:166,167:167,168:168,169:169,170:170,171:171,172:172,173:173,174:174,175:175,176:176,177:177,178:178,179:179,180:180,181:181,182:182,183:183,184:184,185:185,
186:186,187:187,188:188,189:189,190:190,191:191,192:192,193:193,194:194,195:195,196:196,197:197,198:198,199:199,200:200,201:201,202:202,203:203,204:204,205:205,206:206,207:207,208:208,209:209,210:210,211:211,212:212,213:213,214:214,215:215,216:216,217:217,218:218,219:219,220:220,221:221,222:222,223:223,224:224,225:225,226:226,227:227,228:228,229:229,23:23,230:230,231:231,232:232,233:233,234:234,235:235,236:236,237:237,238:238,239:239,240:240,241:241,242:242,243:243,244:244,245:245,246:246,247:247,248:248,249:249,250:250,251:251,252:252,253:253,254:254,255:255,256:256,257:257,258:258,259:259,260:260,261:261,262:262,263:263,264:264,265:265,266:266,267:267,268:268,269:269,270:270,271:271,272:272,273:273,274:274,275:275,276:276,277:277,278:278,279:279,280:280,281:281,282:282,283:283,284:284,285:285,286:286,287:287,288:288,289:289,290:290,291:291,292:292,293:293,294:294,295:295,296:296,297:297,298:298,299:299,300:300,301:301,302:302,303:303,304:304,305:305,306:306,307:307,308:308,309:309,310:310,311:311,312:312,313:313,314:314,315:315,316:316,317:317,318:318,319:319,320:320,321:321,322:322,323:323,324:324,325:325,326:326}],328:[function(t,n,r){(function(t){!function(t){"use strict";function wrap(t,n,r,e){var i=n&&n.prototype instanceof Generator?n:Generator,o=Object.create(i.prototype),u=new Context(e||[]);return o._invoke=makeInvokeMethod(t,r,u),o}function tryCatch(t,n,r){try{return{type:"normal",arg:t.call(n,r)}}catch(t){return{type:"throw",arg:t}}}function Generator(){}function GeneratorFunction(){}function GeneratorFunctionPrototype(){}function defineIteratorMethods(t){["next","throw","return"].forEach(function(n){t[n]=function(t){return this._invoke(n,t)}})}function AsyncIterator(n){function invoke(t,r,e,o){var u=tryCatch(n[t],n,r);if("throw"!==u.type){var c=u.arg,a=c.value;return a&&"object"==typeof a&&i.call(a,"__await")?Promise.resolve(a.__await).then(function(t){invoke("next",t,e,o)},function(t){invoke("throw",t,e,o)}):Promise.resolve(a).then(function(t){c.value=t,e(c)},o)}o(u.arg)}function enqueue(t,n){function callInvokeWithMethodAndArg(){return new Promise(function(r,e){invoke(t,n,r,e)})}return r=r?r.then(callInvokeWithMethodAndArg,callInvokeWithMethodAndArg):callInvokeWithMethodAndArg()}"object"==typeof t.process&&t.process.domain&&(invoke=t.process.domain.bind(invoke));var r;this._invoke=enqueue}function makeInvokeMethod(t,n,r){var e=l;return function invoke(i,o){if(e===v)throw new Error("Generator is already running");if(e===p){if("throw"===i)throw o;return doneResult()}for(r.method=i,r.arg=o;;){var u=r.delegate;if(u){var c=maybeInvokeDelegate(u,r);if(c){if(c===d)continue;return c}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if(e===l)throw e=p,r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);e=v;var a=tryCatch(t,n,r);if("normal"===a.type){if(e=r.done?p:h,a.arg===d)continue;return{value:a.arg,done:r.done}}"throw"===a.type&&(e=p,r.method="throw",r.arg=a.arg)}}}function maybeInvokeDelegate(t,n){var e=t.iterator[n.method];if(e===r){if(n.delegate=null,"throw"===n.method){if(t.iterator.return&&(n.method="return",n.arg=r,maybeInvokeDelegate(t,n),"throw"===n.method))return d;n.method="throw",n.arg=new TypeError("The iterator does not provide a 'throw' method")}return d}var i=tryCatch(e,t.iterator,n.arg);if("throw"===i.type)return n.method="throw",n.arg=i.arg,n.delegate=null,d;var o=i.arg;return o?o.done?(n[t.resultName]=o.value,n.next=t.nextLoc,"return"!==n.method&&(n.method="next",n.arg=r),n.delegate=null,d):o:(n.method="throw",n.arg=new TypeError("iterator result is not an object"),n.delegate=null,d)}function pushTryEntry(t){var n={tryLoc:t[0]};1 in t&&(n.catchLoc=t[1]),2 in t&&(n.finallyLoc=t[2],n.afterLoc=t[3]),this.tryEntries.push(n)}function resetTryEntry(t){var n=t.completion||{};n.type="normal",delete n.arg,t.completion=n}function Context(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(pushTryEntry,this),this.reset(!0)}function values(t){if(t){var n=t[u];if(n)return n.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var e=-1,o=function next(){for(;++e<t.length;)if(i.call(t,e))return next.value=t[e],next.done=!1,next;return next.value=r,next.done=!0,next};return o.next=o}}return{next:doneResult}}function doneResult(){return{value:r,done:!0}}var r,e=Object.prototype,i=e.hasOwnProperty,o="function"==typeof Symbol?Symbol:{},u=o.iterator||"@@iterator",c=o.asyncIterator||"@@asyncIterator",a=o.toStringTag||"@@toStringTag",f="object"==typeof n,s=t.regeneratorRuntime;if(s)return void(f&&(n.exports=s));s=t.regeneratorRuntime=f?n.exports:{},s.wrap=wrap;var l="suspendedStart",h="suspendedYield",v="executing",p="completed",d={},y={};y[u]=function(){return this};var g=Object.getPrototypeOf,m=g&&g(g(values([])));m&&m!==e&&i.call(m,u)&&(y=m);var b=GeneratorFunctionPrototype.prototype=Generator.prototype=Object.create(y);GeneratorFunction.prototype=b.constructor=GeneratorFunctionPrototype,GeneratorFunctionPrototype.constructor=GeneratorFunction,GeneratorFunctionPrototype[a]=GeneratorFunction.displayName="GeneratorFunction",s.isGeneratorFunction=function(t){var n="function"==typeof t&&t.constructor;return!!n&&(n===GeneratorFunction||"GeneratorFunction"===(n.displayName||n.name))},s.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,GeneratorFunctionPrototype):(t.__proto__=GeneratorFunctionPrototype,a in t||(t[a]="GeneratorFunction")),t.prototype=Object.create(b),t},s.awrap=function(t){return{__await:t}},defineIteratorMethods(AsyncIterator.prototype),AsyncIterator.prototype[c]=function(){return this},s.AsyncIterator=AsyncIterator,s.async=function(t,n,r,e){var i=new AsyncIterator(wrap(t,n,r,e));return s.isGeneratorFunction(n)?i:i.next().then(function(t){return t.done?t.value:i.next()})},defineIteratorMethods(b),b[a]="Generator",b[u]=function(){return this},b.toString=function(){return"[object Generator]"},s.keys=function(t){var n=[];for(var r in t)n.push(r);return n.reverse(),function next(){for(;n.length;){var r=n.pop();if(r in t)return next.value=r,next.done=!1,next}return next.done=!0,next}},s.values=values,Context.prototype={constructor:Context,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=r,this.done=!1,this.delegate=null,this.method="next",this.arg=r,this.tryEntries.forEach(resetTryEntry),!t)for(var n in this)"t"===n.charAt(0)&&i.call(this,n)&&!isNaN(+n.slice(1))&&(this[n]=r)},stop:function(){this.done=!0;var t=this.tryEntries[0],n=t.completion;if("throw"===n.type)throw n.arg;return this.rval},dispatchException:function(t){function handle(e,i){return u.type="throw",u.arg=t,n.next=e,i&&(n.method="next",n.arg=r),!!i}if(this.done)throw t;for(var n=this,e=this.tryEntries.length-1;e>=0;--e){var o=this.tryEntries[e],u=o.completion;if("root"===o.tryLoc)return handle("end");if(o.tryLoc<=this.prev){var c=i.call(o,"catchLoc"),a=i.call(o,"finallyLoc");if(c&&a){if(this.prev<o.catchLoc)return handle(o.catchLoc,!0);if(this.prev<o.finallyLoc)return handle(o.finallyLoc)}else if(c){if(this.prev<o.catchLoc)return handle(o.catchLoc,!0)}else{if(!a)throw new Error("try statement without catch or finally");if(this.prev<o.finallyLoc)return handle(o.finallyLoc)}}}},abrupt:function(t,n){for(var r=this.tryEntries.length-1;r>=0;--r){var e=this.tryEntries[r];if(e.tryLoc<=this.prev&&i.call(e,"finallyLoc")&&this.prev<e.finallyLoc){var o=e;break}}o&&("break"===t||"continue"===t)&&o.tryLoc<=n&&n<=o.finallyLoc&&(o=null);var u=o?o.completion:{};return u.type=t,u.arg=n,o?(this.method="next",this.next=o.finallyLoc,d):this.complete(u)},complete:function(t,n){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&n&&(this.next=n),d},finish:function(t){for(var n=this.tryEntries.length-1;n>=0;--n){var r=this.tryEntries[n];if(r.finallyLoc===t)return this.complete(r.completion,r.afterLoc),resetTryEntry(r),d}},catch:function(t){for(var n=this.tryEntries.length-1;n>=0;--n){var r=this.tryEntries[n];if(r.tryLoc===t){var e=r.completion;if("throw"===e.type){var i=e.arg;resetTryEntry(r)}return i}}throw new Error("illegal catch attempt")},delegateYield:function(t,n,e){return this.delegate={iterator:values(t),resultName:n,nextLoc:e},"next"===this.method&&(this.arg=r),d}}}("object"==typeof t?t:"object"==typeof window?window:"object"==typeof self?self:this)}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}]},{},[1]);

var Ext=Ext||{};Ext._startTime=new Date().getTime();(function(){var a=this,c=Object.prototype,b=c.toString,k=true,l={toString:1},e=function(){},j=function(){var i=j.caller.caller;return i.$owner.prototype[i.$name].apply(this,arguments)},d,h=/\S/,g;Function.prototype.$extIsFunction=true;Ext.global=a;for(d in l){k=null}if(k){k=["hasOwnProperty","valueOf","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","constructor"]}Ext.enumerables=k;Ext.apply=function(p,o,r){if(r){Ext.apply(p,r)}if(p&&o&&typeof o==="object"){var q,n,m;for(q in o){p[q]=o[q]}if(k){for(n=k.length;n--;){m=k[n];if(o.hasOwnProperty(m)){p[m]=o[m]}}}}return p};Ext.buildSettings=Ext.apply({baseCSSPrefix:"x-"},Ext.buildSettings||{});Ext.apply(Ext,{name:Ext.sandboxName||"Ext",emptyFn:e,identityFn:function(i){return i},emptyString:new String(),baseCSSPrefix:Ext.buildSettings.baseCSSPrefix,applyIf:function(m,i){var n;if(m){for(n in i){if(m[n]===undefined){m[n]=i[n]}}}return m},iterate:function(i,n,m){if(Ext.isEmpty(i)){return}if(m===undefined){m=i}if(Ext.isIterable(i)){Ext.Array.each.call(Ext.Array,i,n,m)}else{Ext.Object.each.call(Ext.Object,i,n,m)}}});Ext.apply(Ext,{extend:(function(){var i=c.constructor,m=function(p){for(var n in p){if(!p.hasOwnProperty(n)){continue}this[n]=p[n]}};return function(n,s,q){if(Ext.isObject(s)){q=s;s=n;n=q.constructor!==i?q.constructor:function(){s.apply(this,arguments)}}var p=function(){},o,r=s.prototype;p.prototype=r;o=n.prototype=new p();o.constructor=n;n.superclass=r;if(r.constructor===i){r.constructor=s}n.override=function(t){Ext.override(n,t)};o.override=m;o.proto=o;n.override(q);n.extend=function(t){return Ext.extend(n,t)};return n}}()),override:function(o,p){if(o.$isClass){o.override(p)}else{if(typeof o=="function"){Ext.apply(o.prototype,p)}else{var i=o.self,m,n;if(i&&i.$isClass){for(m in p){if(p.hasOwnProperty(m)){n=p[m];if(typeof n=="function"){n.$name=m;n.$owner=i;n.$previous=o.hasOwnProperty(m)?o[m]:j}o[m]=n}}}else{Ext.apply(o,p)}}}return o}});Ext.apply(Ext,{valueFrom:function(n,i,m){return Ext.isEmpty(n,m)?i:n},typeOf:function(m){var i,n;if(m===null){return"null"}i=typeof m;if(i==="undefined"||i==="string"||i==="number"||i==="boolean"){return i}n=b.call(m);switch(n){case"[object Array]":return"array";case"[object Date]":return"date";case"[object Boolean]":return"boolean";case"[object Number]":return"number";case"[object RegExp]":return"regexp"}if(i==="function"){return"function"}if(i==="object"){if(m.nodeType!==undefined){if(m.nodeType===3){return(h).test(m.nodeValue)?"textnode":"whitespace"}else{return"element"}}return"object"}},coerce:function(p,o){var n=Ext.typeOf(p),m=Ext.typeOf(o),i=typeof p==="string";if(n!==m){switch(m){case"string":return String(p);case"number":return Number(p);case"boolean":return i&&(!p||p==="false")?false:Boolean(p);case"null":return i&&(!p||p==="null")?null:p;case"undefined":return i&&(!p||p==="undefined")?undefined:p;case"date":return i&&isNaN(p)?Ext.Date.parse(p,Ext.Date.defaultFormat):Date(Number(p))}}return p},isEmpty:function(i,m){return(i===null)||(i===undefined)||(!m?i==="":false)||(Ext.isArray(i)&&i.length===0)},isArray:("isArray" in Array)?Array.isArray:function(i){return b.call(i)==="[object Array]"},isDate:function(i){return b.call(i)==="[object Date]"},isObject:(b.call(null)==="[object Object]")?function(i){return i!==null&&i!==undefined&&b.call(i)==="[object Object]"&&i.ownerDocument===undefined}:function(i){return b.call(i)==="[object Object]"},isSimpleObject:function(i){return i instanceof Object&&i.constructor===Object},isPrimitive:function(m){var i=typeof m;return i==="string"||i==="number"||i==="boolean"},isFunction:function(i){return !!(i&&i.$extIsFunction)},isNumber:function(i){return typeof i==="number"&&isFinite(i)},isNumeric:function(i){return !isNaN(parseFloat(i))&&isFinite(i)},isString:function(i){return typeof i==="string"},isBoolean:function(i){return typeof i==="boolean"},isElement:function(i){return i?i.nodeType===1:false},isTextNode:function(i){return i?i.nodeName==="#text":false},isDefined:function(i){return typeof i!=="undefined"},isIterable:function(m){var i=typeof m,n=false;if(m&&i!="string"){if(i=="function"){if(Ext.isSafari){n=m instanceof NodeList||m instanceof HTMLCollection}}else{n=true}}return n?m.length!==undefined:false}});Ext.apply(Ext,{clone:function(r){var q,p,n,m,s,o;if(r===null||r===undefined){return r}if(r.nodeType&&r.cloneNode){return r.cloneNode(true)}q=b.call(r);if(q==="[object Date]"){return new Date(r.getTime())}if(q==="[object Array]"){p=r.length;s=[];while(p--){s[p]=Ext.clone(r[p])}}else{if(q==="[object Object]"&&r.constructor===Object){s={};for(o in r){s[o]=Ext.clone(r[o])}if(k){for(n=k.length;n--;){m=k[n];s[m]=r[m]}}}}return s||r},getUniqueGlobalNamespace:function(){var n=this.uniqueGlobalNamespace,m;if(n===undefined){m=0;do{n="ExtBox"+(++m)}while(Ext.global[n]!==undefined);Ext.global[n]=Ext;this.uniqueGlobalNamespace=n}return n},functionFactoryCache:{},cacheableFunctionFactory:function(){var q=this,n=Array.prototype.slice.call(arguments),m=q.functionFactoryCache,i,o,p;if(Ext.isSandboxed){p=n.length;if(p>0){p--;n[p]="var Ext=window."+Ext.name+";"+n[p]}}i=n.join("");o=m[i];if(!o){o=Function.prototype.constructor.apply(Function.prototype,n);m[i]=o}return o},functionFactory:function(){var n=this,i=Array.prototype.slice.call(arguments),m;if(Ext.isSandboxed){m=i.length;if(m>0){m--;i[m]="var Ext=window."+Ext.name+";"+i[m]}}return Function.prototype.constructor.apply(Function.prototype,i)},Logger:{verbose:e,log:e,info:e,warn:e,error:function(i){throw new Error(i)},deprecate:e}});Ext.type=Ext.typeOf;g=Ext.app;if(!g){g=Ext.app={}}Ext.apply(g,{namespaces:{},collectNamespaces:function(n){var i=Ext.app.namespaces,m;for(m in n){if(n.hasOwnProperty(m)){i[m]=true}}},addNamespaces:function(o){var p=Ext.app.namespaces,n,m;if(!Ext.isArray(o)){o=[o]}for(n=0,m=o.length;n<m;n++){p[o[n]]=true}},clearNamespaces:function(){Ext.app.namespaces={}},getNamespace:function(m){var o=Ext.app.namespaces,i="",n;for(n in o){if(o.hasOwnProperty(n)&&n.length>i.length&&(n+"."===m.substring(0,n.length+1))){i=n}}return i===""?undefined:i}})}());Ext.globalEval=Ext.global.execScript?function(a){execScript(a)}:function($$code){(function(){var Ext=this.Ext;eval($$code)}())};(function(){var a="4.2.0.663",b;Ext.Version=b=Ext.extend(Object,{constructor:function(c){var e,d;if(c instanceof b){return c}this.version=this.shortVersion=String(c).toLowerCase().replace(/_/g,".").replace(/[\-+]/g,"");d=this.version.search(/([^\d\.])/);if(d!==-1){this.release=this.version.substr(d,c.length);this.shortVersion=this.version.substr(0,d)}this.shortVersion=this.shortVersion.replace(/[^\d]/g,"");e=this.version.split(".");this.major=parseInt(e.shift()||0,10);this.minor=parseInt(e.shift()||0,10);this.patch=parseInt(e.shift()||0,10);this.build=parseInt(e.shift()||0,10);return this},toString:function(){return this.version},valueOf:function(){return this.version},getMajor:function(){return this.major||0},getMinor:function(){return this.minor||0},getPatch:function(){return this.patch||0},getBuild:function(){return this.build||0},getRelease:function(){return this.release||""},isGreaterThan:function(c){return b.compare(this.version,c)===1},isGreaterThanOrEqual:function(c){return b.compare(this.version,c)>=0},isLessThan:function(c){return b.compare(this.version,c)===-1},isLessThanOrEqual:function(c){return b.compare(this.version,c)<=0},equals:function(c){return b.compare(this.version,c)===0},match:function(c){c=String(c);return this.version.substr(0,c.length)===c},toArray:function(){return[this.getMajor(),this.getMinor(),this.getPatch(),this.getBuild(),this.getRelease()]},getShortVersion:function(){return this.shortVersion},gt:function(){return this.isGreaterThan.apply(this,arguments)},lt:function(){return this.isLessThan.apply(this,arguments)},gtEq:function(){return this.isGreaterThanOrEqual.apply(this,arguments)},ltEq:function(){return this.isLessThanOrEqual.apply(this,arguments)}});Ext.apply(b,{releaseValueMap:{dev:-6,alpha:-5,a:-5,beta:-4,b:-4,rc:-3,"#":-2,p:-1,pl:-1},getComponentValue:function(c){return !c?0:(isNaN(c)?this.releaseValueMap[c]||c:parseInt(c,10))},compare:function(h,g){var d,e,c;h=new b(h).toArray();g=new b(g).toArray();for(c=0;c<Math.max(h.length,g.length);c++){d=this.getComponentValue(h[c]);e=this.getComponentValue(g[c]);if(d<e){return -1}else{if(d>e){return 1}}}return 0}});Ext.apply(Ext,{versions:{},lastRegisteredVersion:null,setVersion:function(d,c){Ext.versions[d]=new b(c);Ext.lastRegisteredVersion=Ext.versions[d];return this},getVersion:function(c){if(c===undefined){return Ext.lastRegisteredVersion}return Ext.versions[c]},deprecate:function(c,e,g,d){if(b.compare(Ext.getVersion(c),e)<1){g.call(d)}}});Ext.setVersion("core",a)}());Ext.String=(function(){var j=/^[\x09\x0a\x0b\x0c\x0d\x20\xa0\u1680\u180e\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u2028\u2029\u202f\u205f\u3000]+|[\x09\x0a\x0b\x0c\x0d\x20\xa0\u1680\u180e\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u2028\u2029\u202f\u205f\u3000]+$/g,n=/('|\\)/g,i=/\{(\d+)\}/g,b=/([-.*+?\^${}()|\[\]\/\\])/g,o=/^\s+|\s+$/g,k=/\s+/,m=/(^[^a-z]*|[^\w])/gi,e,a,h,d,g=function(q,p){return e[p]},l=function(q,p){return(p in a)?a[p]:String.fromCharCode(parseInt(p.substr(2),10))},c=function(q,p){if(q===null||q===undefined||p===null||p===undefined){return false}return p.length<=q.length};return{insert:function(r,t,q){if(!r){return t}if(!t){return r}var p=r.length;if(!q&&q!==0){q=p}if(q<0){q*=-1;if(q>=p){q=0}else{q=p-q}}if(q===0){r=t+r}else{if(q>=r.length){r+=t}else{r=r.substr(0,q)+t+r.substr(q)}}return r},startsWith:function(r,t,q){var p=c(r,t);if(p){if(q){r=r.toLowerCase();t=t.toLowerCase()}p=r.lastIndexOf(t,0)===0}return p},endsWith:function(t,q,r){var p=c(t,q);if(p){if(r){t=t.toLowerCase();q=q.toLowerCase()}p=t.indexOf(q,t.length-q.length)!==-1}return p},createVarName:function(p){return p.replace(m,"")},htmlEncode:function(p){return(!p)?p:String(p).replace(h,g)},htmlDecode:function(p){return(!p)?p:String(p).replace(d,l)},addCharacterEntities:function(q){var p=[],t=[],r,s;for(r in q){s=q[r];a[r]=s;e[s]=r;p.push(s);t.push(r)}h=new RegExp("("+p.join("|")+")","g");d=new RegExp("("+t.join("|")+"|&#[0-9]{1,5};)","g")},resetCharacterEntities:function(){e={};a={};this.addCharacterEntities({"&amp;":"&","&gt;":">","&lt;":"<","&quot;":'"',"&#39;":"'"})},urlAppend:function(q,p){if(!Ext.isEmpty(p)){return q+(q.indexOf("?")===-1?"?":"&")+p}return q},trim:function(p){return p.replace(j,"")},capitalize:function(p){return p.charAt(0).toUpperCase()+p.substr(1)},uncapitalize:function(p){return p.charAt(0).toLowerCase()+p.substr(1)},ellipsis:function(r,p,s){if(r&&r.length>p){if(s){var t=r.substr(0,p-2),q=Math.max(t.lastIndexOf(" "),t.lastIndexOf("."),t.lastIndexOf("!"),t.lastIndexOf("?"));if(q!==-1&&q>=(p-15)){return t.substr(0,q)+"..."}}return r.substr(0,p-3)+"..."}return r},escapeRegex:function(p){return p.replace(b,"\\$1")},escape:function(p){return p.replace(n,"\\$1")},toggle:function(q,r,p){return q===r?p:r},leftPad:function(q,r,s){var p=String(q);s=s||" ";while(p.length<r){p=s+p}return p},format:function(q){var p=Ext.Array.toArray(arguments,1);return q.replace(i,function(r,s){return p[s]})},repeat:function(t,s,q){if(s<1){s=0}for(var p=[],r=s;r--;){p.push(t)}return p.join(q||"")},splitWords:function(p){if(p&&typeof p=="string"){return p.replace(o,"").split(k)}return p||[]}}}());Ext.String.resetCharacterEntities();Ext.htmlEncode=Ext.String.htmlEncode;Ext.htmlDecode=Ext.String.htmlDecode;Ext.urlAppend=Ext.String.urlAppend;Ext.Number=new function(){var b=this,c=(0.9).toFixed()!=="1",a=Math;Ext.apply(this,{constrain:function(h,g,e){var d=parseFloat(h);return(d<g)?g:((d>e)?e:d)},snap:function(h,e,g,i){var d;if(h===undefined||h<g){return g||0}if(e){d=h%e;if(d!==0){h-=d;if(d*2>=e){h+=e}else{if(d*2<-e){h-=e}}}}return b.constrain(h,g,i)},snapInRange:function(h,d,g,i){var e;g=(g||0);if(h===undefined||h<g){return g}if(d&&(e=((h-g)%d))){h-=e;e*=2;if(e>=d){h+=d}}if(i!==undefined){if(h>(i=b.snapInRange(i,d,g))){h=i}}return h},toFixed:c?function(g,d){d=d||0;var e=a.pow(10,d);return(a.round(g*e)/e).toFixed(d)}:function(e,d){return e.toFixed(d)},from:function(e,d){if(isFinite(e)){e=parseFloat(e)}return !isNaN(e)?e:d},randomInt:function(e,d){return a.floor(a.random()*(d-e+1)+e)},correctFloat:function(d){return parseFloat(d.toPrecision(14))}});Ext.num=function(){return b.from.apply(this,arguments)}};(function(){var g=Array.prototype,o=g.slice,q=(function(){var A=[],e,z=20;if(!A.splice){return false}while(z--){A.push("A")}A.splice(15,0,"F","F","F","F","F","F","F","F","F","F","F","F","F","F","F","F","F","F","F","F","F");e=A.length;A.splice(13,0,"XXX");if(e+1!=A.length){return false}return true}()),j="forEach" in g,u="map" in g,p="indexOf" in g,y="every" in g,c="some" in g,d="filter" in g,n=(function(){var e=[1,2,3,4,5].sort(function(){return 0});return e[0]===1&&e[1]===2&&e[2]===3&&e[3]===4&&e[4]===5}()),k=true,a,w,t,v;try{if(typeof document!=="undefined"){o.call(document.getElementsByTagName("body"))}}catch(s){k=false}function m(z,e){return(e<0)?Math.max(0,z.length+e):Math.min(z.length,e)}function x(G,F,z,J){var K=J?J.length:0,B=G.length,H=m(G,F),E,I,A,e,C,D;if(H===B){if(K){G.push.apply(G,J)}}else{E=Math.min(z,B-H);I=H+E;A=I+K-E;e=B-I;C=B-E;if(A<I){for(D=0;D<e;++D){G[A+D]=G[I+D]}}else{if(A>I){for(D=e;D--;){G[A+D]=G[I+D]}}}if(K&&H===C){G.length=C;G.push.apply(G,J)}else{G.length=C+K;for(D=0;D<K;++D){G[H+D]=J[D]}}}return G}function i(B,e,A,z){if(z&&z.length){if(e===0&&!A){B.unshift.apply(B,z)}else{if(e<B.length){B.splice.apply(B,[e,A].concat(z))}else{B.push.apply(B,z)}}}else{B.splice(e,A)}return B}function b(A,e,z){return x(A,e,z)}function r(A,e,z){A.splice(e,z);return A}function l(C,e,A){var B=m(C,e),z=C.slice(e,m(C,B+A));if(arguments.length<4){x(C,B,A)}else{x(C,B,A,o.call(arguments,3))}return z}function h(e){return e.splice.apply(e,o.call(arguments,1))}w=q?r:b;t=q?i:x;v=q?h:l;a=Ext.Array={each:function(D,B,A,e){D=a.from(D);var z,C=D.length;if(e!==true){for(z=0;z<C;z++){if(B.call(A||D[z],D[z],z,D)===false){return z}}}else{for(z=C-1;z>-1;z--){if(B.call(A||D[z],D[z],z,D)===false){return z}}}return true},forEach:j?function(A,z,e){A.forEach(z,e)}:function(C,A,z){var e=0,B=C.length;for(;e<B;e++){A.call(z,C[e],e,C)}},indexOf:p?function(A,e,z){return g.indexOf.call(A,e,z)}:function(C,A,B){var e,z=C.length;for(e=(B<0)?Math.max(0,z+B):B||0;e<z;e++){if(C[e]===A){return e}}return -1},contains:p?function(z,e){return g.indexOf.call(z,e)!==-1}:function(B,A){var e,z;for(e=0,z=B.length;e<z;e++){if(B[e]===A){return true}}return false},toArray:function(A,C,e){if(!A||!A.length){return[]}if(typeof A==="string"){A=A.split("")}if(k){return o.call(A,C||0,e||A.length)}var B=[],z;C=C||0;e=e?((e<0)?A.length+e:e):A.length;for(z=C;z<e;z++){B.push(A[z])}return B},pluck:function(D,e){var z=[],A,C,B;for(A=0,C=D.length;A<C;A++){B=D[A];z.push(B[e])}return z},map:u?function(A,z,e){return A.map(z,e)}:function(D,C,B){var A=[],z=0,e=D.length;for(;z<e;z++){A[z]=C.call(B,D[z],z,D)}return A},every:y?function(A,z,e){return A.every(z,e)}:function(C,A,z){var e=0,B=C.length;for(;e<B;++e){if(!A.call(z,C[e],e,C)){return false}}return true},some:c?function(A,z,e){return A.some(z,e)}:function(C,A,z){var e=0,B=C.length;for(;e<B;++e){if(A.call(z,C[e],e,C)){return true}}return false},equals:function(C,B){var z=C.length,e=B.length,A;if(C===B){return true}if(z!==e){return false}for(A=0;A<z;++A){if(C[A]!==B[A]){return false}}return true},clean:function(C){var z=[],e=0,B=C.length,A;for(;e<B;e++){A=C[e];if(!Ext.isEmpty(A)){z.push(A)}}return z},unique:function(C){var B=[],e=0,A=C.length,z;for(;e<A;e++){z=C[e];if(a.indexOf(B,z)===-1){B.push(z)}}return B},filter:d?function(A,z,e){return A.filter(z,e)}:function(D,B,A){var z=[],e=0,C=D.length;for(;e<C;e++){if(B.call(A,D[e],e,D)){z.push(D[e])}}return z},findBy:function(C,B,A){var z=0,e=C.length;for(;z<e;z++){if(B.call(A||C,C[z],z)){return C[z]}}return null},from:function(A,z){if(A===undefined||A===null){return[]}if(Ext.isArray(A)){return(z)?o.call(A):A}var e=typeof A;if(A&&A.length!==undefined&&e!=="string"&&(e!=="function"||!A.apply)){return a.toArray(A)}return[A]},remove:function(A,z){var e=a.indexOf(A,z);if(e!==-1){w(A,e,1)}return A},include:function(z,e){if(!a.contains(z,e)){z.push(e)}},clone:function(e){return o.call(e)},merge:function(){var e=o.call(arguments),B=[],z,A;for(z=0,A=e.length;z<A;z++){B=B.concat(e[z])}return a.unique(B)},intersect:function(){var e=[],A=o.call(arguments),L,J,F,I,M,B,z,H,K,C,G,E,D;if(!A.length){return e}L=A.length;for(G=M=0;G<L;G++){B=A[G];if(!I||B.length<I.length){I=B;M=G}}I=a.unique(I);w(A,M,1);z=I.length;L=A.length;for(G=0;G<z;G++){H=I[G];C=0;for(E=0;E<L;E++){J=A[E];F=J.length;for(D=0;D<F;D++){K=J[D];if(H===K){C++;break}}}if(C===L){e.push(H)}}return e},difference:function(z,e){var E=o.call(z),C=E.length,B,A,D;for(B=0,D=e.length;B<D;B++){for(A=0;A<C;A++){if(E[A]===e[B]){w(E,A,1);A--;C--}}}return E},slice:([1,2].slice(1,undefined).length?function(A,z,e){return o.call(A,z,e)}:function(A,z,e){if(typeof z==="undefined"){return o.call(A)}if(typeof e==="undefined"){return o.call(A,z)}return o.call(A,z,e)}),sort:n?function(z,e){if(e){return z.sort(e)}else{return z.sort()}}:function(F,E){var C=F.length,B=0,D,e,A,z;for(;B<C;B++){A=B;for(e=B+1;e<C;e++){if(E){D=E(F[e],F[A]);if(D<0){A=e}}else{if(F[e]<F[A]){A=e}}}if(A!==B){z=F[B];F[B]=F[A];F[A]=z}}return F},flatten:function(A){var z=[];function e(B){var D,E,C;for(D=0,E=B.length;D<E;D++){C=B[D];if(Ext.isArray(C)){e(C)}else{z.push(C)}}return z}return e(A)},min:function(D,C){var z=D[0],e,B,A;for(e=0,B=D.length;e<B;e++){A=D[e];if(C){if(C(z,A)===1){z=A}}else{if(A<z){z=A}}}return z},max:function(D,C){var e=D[0],z,B,A;for(z=0,B=D.length;z<B;z++){A=D[z];if(C){if(C(e,A)===-1){e=A}}else{if(A>e){e=A}}}return e},mean:function(e){return e.length>0?a.sum(e)/e.length:undefined},sum:function(C){var z=0,e,B,A;for(e=0,B=C.length;e<B;e++){A=C[e];z+=A}return z},toMap:function(C,e,A){var B={},z=C.length;if(!e){while(z--){B[C[z]]=z+1}}else{if(typeof e=="string"){while(z--){B[C[z][e]]=z+1}}else{while(z--){B[e.call(A,C[z])]=z+1}}}return B},toValueMap:function(C,e,A){var B={},z=C.length;if(!e){while(z--){B[C[z]]=C[z]}}else{if(typeof e=="string"){while(z--){B[C[z][e]]=C[z]}}else{while(z--){B[e.call(A,C[z])]=C[z]}}}return B},erase:w,insert:function(A,z,e){return t(A,z,0,e)},replace:t,splice:v,push:function(B){var e=arguments.length,A=1,z;if(B===undefined){B=[]}else{if(!Ext.isArray(B)){B=[B]}}for(;A<e;A++){z=arguments[A];Array.prototype.push[Ext.isIterable(z)?"apply":"call"](B,z)}return B}};Ext.each=a.each;a.union=a.merge;Ext.min=a.min;Ext.max=a.max;Ext.sum=a.sum;Ext.mean=a.mean;Ext.flatten=a.flatten;Ext.clean=a.clean;Ext.unique=a.unique;Ext.pluck=a.pluck;Ext.toArray=function(){return a.toArray.apply(a,arguments)}}());Ext.Function={flexSetter:function(a){return function(d,c){var e,g;if(d===null){return this}if(typeof d!=="string"){for(e in d){if(d.hasOwnProperty(e)){a.call(this,e,d[e])}}if(Ext.enumerables){for(g=Ext.enumerables.length;g--;){e=Ext.enumerables[g];if(d.hasOwnProperty(e)){a.call(this,e,d[e])}}}}else{a.call(this,d,c)}return this}},bind:function(d,c,b,a){if(arguments.length===2){return function(){return d.apply(c,arguments)}}var g=d,e=Array.prototype.slice;return function(){var h=b||arguments;if(a===true){h=e.call(arguments,0);h=h.concat(b)}else{if(typeof a=="number"){h=e.call(arguments,0);Ext.Array.insert(h,a,b)}}return g.apply(c||Ext.global,h)}},pass:function(c,a,b){if(!Ext.isArray(a)){if(Ext.isIterable(a)){a=Ext.Array.clone(a)}else{a=a!==undefined?[a]:[]}}return function(){var d=[].concat(a);d.push.apply(d,arguments);return c.apply(b||this,d)}},alias:function(b,a){return function(){return b[a].apply(b,arguments)}},clone:function(a){return function(){return a.apply(this,arguments)}},createInterceptor:function(d,c,b,a){var e=d;if(!Ext.isFunction(c)){return d}else{a=Ext.isDefined(a)?a:null;return function(){var h=this,g=arguments;c.target=h;c.method=d;return(c.apply(b||h||Ext.global,g)!==false)?d.apply(h||Ext.global,g):a}}},createDelayed:function(e,c,d,b,a){if(d||b){e=Ext.Function.bind(e,d,b,a)}return function(){var h=this,g=Array.prototype.slice.call(arguments);setTimeout(function(){e.apply(h,g)},c)}},defer:function(e,c,d,b,a){e=Ext.Function.bind(e,d,b,a);if(c>0){return setTimeout(Ext.supports.TimeoutActualLateness?function(){e()}:e,c)}e();return 0},createSequence:function(b,c,a){if(!c){return b}else{return function(){var d=b.apply(this,arguments);c.apply(a||this,arguments);return d}}},createBuffered:function(e,b,d,c){var a;return function(){var h=c||Array.prototype.slice.call(arguments,0),g=d||this;if(a){clearTimeout(a)}a=setTimeout(function(){e.apply(g,h)},b)}},createThrottled:function(e,b,d){var g,a,c,i,h=function(){e.apply(d||this,c);g=new Date().getTime()};return function(){a=new Date().getTime()-g;c=arguments;clearTimeout(i);if(!g||(a>=b)){h()}else{i=setTimeout(h,b-a)}}},interceptBefore:function(b,a,d,c){var e=b[a]||Ext.emptyFn;return(b[a]=function(){var g=d.apply(c||this,arguments);e.apply(this,arguments);return g})},interceptAfter:function(b,a,d,c){var e=b[a]||Ext.emptyFn;return(b[a]=function(){e.apply(this,arguments);return d.apply(c||this,arguments)})}};Ext.defer=Ext.Function.alias(Ext.Function,"defer");Ext.pass=Ext.Function.alias(Ext.Function,"pass");Ext.bind=Ext.Function.alias(Ext.Function,"bind");(function(){var a=function(){},b=Ext.Object={chain:Object.create||function(d){a.prototype=d;var c=new a();a.prototype=null;return c},toQueryObjects:function(e,k,d){var c=b.toQueryObjects,j=[],g,h;if(Ext.isArray(k)){for(g=0,h=k.length;g<h;g++){if(d){j=j.concat(c(e+"["+g+"]",k[g],true))}else{j.push({name:e,value:k[g]})}}}else{if(Ext.isObject(k)){for(g in k){if(k.hasOwnProperty(g)){if(d){j=j.concat(c(e+"["+g+"]",k[g],true))}else{j.push({name:e,value:k[g]})}}}}else{j.push({name:e,value:k})}}return j},toQueryString:function(g,d){var h=[],e=[],l,k,m,c,n;for(l in g){if(g.hasOwnProperty(l)){h=h.concat(b.toQueryObjects(l,g[l],d))}}for(k=0,m=h.length;k<m;k++){c=h[k];n=c.value;if(Ext.isEmpty(n)){n=""}else{if(Ext.isDate(n)){n=Ext.Date.toString(n)}}e.push(encodeURIComponent(c.name)+"="+encodeURIComponent(String(n)))}return e.join("&")},fromQueryString:function(d,r){var m=d.replace(/^\?/,"").split("&"),u={},s,k,w,n,q,g,o,p,c,h,t,l,v,e;for(q=0,g=m.length;q<g;q++){o=m[q];if(o.length>0){k=o.split("=");w=decodeURIComponent(k[0]);n=(k[1]!==undefined)?decodeURIComponent(k[1]):"";if(!r){if(u.hasOwnProperty(w)){if(!Ext.isArray(u[w])){u[w]=[u[w]]}u[w].push(n)}else{u[w]=n}}else{h=w.match(/(\[):?([^\]]*)\]/g);t=w.match(/^([^\[]+)/);w=t[0];l=[];if(h===null){u[w]=n;continue}for(p=0,c=h.length;p<c;p++){v=h[p];v=(v.length===2)?"":v.substring(1,v.length-1);l.push(v)}l.unshift(w);s=u;for(p=0,c=l.length;p<c;p++){v=l[p];if(p===c-1){if(Ext.isArray(s)&&v===""){s.push(n)}else{s[v]=n}}else{if(s[v]===undefined||typeof s[v]==="string"){e=l[p+1];s[v]=(Ext.isNumeric(e)||e==="")?[]:{}}s=s[v]}}}}}return u},each:function(c,e,d){for(var g in c){if(c.hasOwnProperty(g)){if(e.call(d||c,g,c[g],c)===false){return}}}},merge:function(k){var h=1,j=arguments.length,c=b.merge,e=Ext.clone,g,m,l,d;for(;h<j;h++){g=arguments[h];for(m in g){l=g[m];if(l&&l.constructor===Object){d=k[m];if(d&&d.constructor===Object){c(d,l)}else{k[m]=e(l)}}else{k[m]=l}}}return k},mergeIf:function(c){var h=1,j=arguments.length,e=Ext.clone,d,g,k;for(;h<j;h++){d=arguments[h];for(g in d){if(!(g in c)){k=d[g];if(k&&k.constructor===Object){c[g]=e(k)}else{c[g]=k}}}}return c},getKey:function(c,e){for(var d in c){if(c.hasOwnProperty(d)&&c[d]===e){return d}}return null},getValues:function(d){var c=[],e;for(e in d){if(d.hasOwnProperty(e)){c.push(d[e])}}return c},getKeys:(typeof Object.keys=="function")?function(c){if(!c){return[]}return Object.keys(c)}:function(c){var d=[],e;for(e in c){if(c.hasOwnProperty(e)){d.push(e)}}return d},getSize:function(c){var d=0,e;for(e in c){if(c.hasOwnProperty(e)){d++}}return d},isEmpty:function(c){for(var d in c){if(c.hasOwnProperty(d)){return false}}return true},equals:(function(){var c=function(g,e){var d;for(d in g){if(g.hasOwnProperty(d)){if(g[d]!==e[d]){return false}}}return true};return function(e,d){if(e===d){return true}if(e&&d){return c(e,d)&&c(d,e)}else{if(!e&&!d){return e===d}else{return false}}}})(),classify:function(g){var e=g,i=[],d={},c=function(){var k=0,l=i.length,m;for(;k<l;k++){m=i[k];this[m]=new d[m]()}},h,j;for(h in g){if(g.hasOwnProperty(h)){j=g[h];if(j&&j.constructor===Object){i.push(h);d[h]=b.classify(j)}}}c.prototype=e;return c}};Ext.merge=Ext.Object.merge;Ext.mergeIf=Ext.Object.mergeIf;Ext.urlEncode=function(){var c=Ext.Array.from(arguments),d="";if((typeof c[1]==="string")){d=c[1]+"&";c[1]=false}return d+b.toQueryString.apply(b,c)};Ext.urlDecode=function(){return b.fromQueryString.apply(b,arguments)}}());Ext.Date=new function(){var d=this,j=/(\\.)/g,a=/([gGhHisucUOPZ]|MS)/,e=/([djzmnYycU]|MS)/,i=/\\/gi,c=/\{(\d+)\}/g,g=new RegExp("\\/Date\\(([-+])?(\\d+)(?:[+-]\\d{4})?\\)\\/"),b=["var me = this, dt, y, m, d, h, i, s, ms, o, O, z, zz, u, v, W, year, jan4, week1monday,","def = me.defaults,","from = Ext.Number.from,","results = String(input).match(me.parseRegexes[{0}]);","if(results){","{1}","if(u != null){","v = new Date(u * 1000);","}else{","dt = me.clearTime(new Date);","y = from(y, from(def.y, dt.getFullYear()));","m = from(m, from(def.m - 1, dt.getMonth()));","d = from(d, from(def.d, dt.getDate()));","h  = from(h, from(def.h, dt.getHours()));","i  = from(i, from(def.i, dt.getMinutes()));","s  = from(s, from(def.s, dt.getSeconds()));","ms = from(ms, from(def.ms, dt.getMilliseconds()));","if(z >= 0 && y >= 0){","v = me.add(new Date(y < 100 ? 100 : y, 0, 1, h, i, s, ms), me.YEAR, y < 100 ? y - 100 : 0);","v = !strict? v : (strict === true && (z <= 364 || (me.isLeapYear(v) && z <= 365))? me.add(v, me.DAY, z) : null);","}else if(strict === true && !me.isValid(y, m + 1, d, h, i, s, ms)){","v = null;","}else{","if (W) {","year = y || (new Date()).getFullYear(),","jan4 = new Date(year, 0, 4, 0, 0, 0),","week1monday = new Date(jan4.getTime() - ((jan4.getDay() - 1) * 86400000));","v = Ext.Date.clearTime(new Date(week1monday.getTime() + ((W - 1) * 604800000)));","} else {","v = me.add(new Date(y < 100 ? 100 : y, m, d, h, i, s, ms), me.YEAR, y < 100 ? y - 100 : 0);","}","}","}","}","if(v){","if(zz != null){","v = me.add(v, me.SECOND, -v.getTimezoneOffset() * 60 - zz);","}else if(o){","v = me.add(v, me.MINUTE, -v.getTimezoneOffset() + (sn == '+'? -1 : 1) * (hr * 60 + mn));","}","}","return v;"].join("\n");function h(l){var k=Array.prototype.slice.call(arguments,1);return l.replace(c,function(n,o){return k[o]})}Ext.apply(d,{now:Date.now||function(){return +new Date()},toString:function(k){var l=Ext.String.leftPad;return k.getFullYear()+"-"+l(k.getMonth()+1,2,"0")+"-"+l(k.getDate(),2,"0")+"T"+l(k.getHours(),2,"0")+":"+l(k.getMinutes(),2,"0")+":"+l(k.getSeconds(),2,"0")},getElapsed:function(l,k){return Math.abs(l-(k||new Date()))},useStrict:false,formatCodeToRegex:function(l,k){var m=d.parseCodes[l];if(m){m=typeof m=="function"?m():m;d.parseCodes[l]=m}return m?Ext.applyIf({c:m.c?h(m.c,k||"{0}"):m.c},m):{g:0,c:null,s:Ext.String.escapeRegex(l)}},parseFunctions:{MS:function(l,k){var m=(l||"").match(g);return m?new Date(((m[1]||"")+m[2])*1):null},time:function(l,k){var m=parseInt(l,10);if(m||m===0){return new Date(m)}return null},timestamp:function(l,k){var m=parseInt(l,10);if(m||m===0){return new Date(m*1000)}return null}},parseRegexes:[],formatFunctions:{MS:function(){return"\\/Date("+this.getTime()+")\\/"},time:function(){return this.getTime().toString()},timestamp:function(){return d.format(this,"U")}},y2kYear:50,MILLI:"ms",SECOND:"s",MINUTE:"mi",HOUR:"h",DAY:"d",MONTH:"mo",YEAR:"y",defaults:{},dayNames:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],monthNames:["January","February","March","April","May","June","July","August","September","October","November","December"],monthNumbers:{January:0,Jan:0,February:1,Feb:1,March:2,Mar:2,April:3,Apr:3,May:4,June:5,Jun:5,July:6,Jul:6,August:7,Aug:7,September:8,Sep:8,October:9,Oct:9,November:10,Nov:10,December:11,Dec:11},defaultFormat:"m/d/Y",getShortMonthName:function(k){return Ext.Date.monthNames[k].substring(0,3)},getShortDayName:function(k){return Ext.Date.dayNames[k].substring(0,3)},getMonthNumber:function(k){return Ext.Date.monthNumbers[k.substring(0,1).toUpperCase()+k.substring(1,3).toLowerCase()]},formatContainsHourInfo:function(k){return a.test(k.replace(j,""))},formatContainsDateInfo:function(k){return e.test(k.replace(j,""))},unescapeFormat:function(k){return k.replace(i,"")},formatCodes:{d:"Ext.String.leftPad(this.getDate(), 2, '0')",D:"Ext.Date.getShortDayName(this.getDay())",j:"this.getDate()",l:"Ext.Date.dayNames[this.getDay()]",N:"(this.getDay() ? this.getDay() : 7)",S:"Ext.Date.getSuffix(this)",w:"this.getDay()",z:"Ext.Date.getDayOfYear(this)",W:"Ext.String.leftPad(Ext.Date.getWeekOfYear(this), 2, '0')",F:"Ext.Date.monthNames[this.getMonth()]",m:"Ext.String.leftPad(this.getMonth() + 1, 2, '0')",M:"Ext.Date.getShortMonthName(this.getMonth())",n:"(this.getMonth() + 1)",t:"Ext.Date.getDaysInMonth(this)",L:"(Ext.Date.isLeapYear(this) ? 1 : 0)",o:"(this.getFullYear() + (Ext.Date.getWeekOfYear(this) == 1 && this.getMonth() > 0 ? +1 : (Ext.Date.getWeekOfYear(this) >= 52 && this.getMonth() < 11 ? -1 : 0)))",Y:"Ext.String.leftPad(this.getFullYear(), 4, '0')",y:"('' + this.getFullYear()).substring(2, 4)",a:"(this.getHours() < 12 ? 'am' : 'pm')",A:"(this.getHours() < 12 ? 'AM' : 'PM')",g:"((this.getHours() % 12) ? this.getHours() % 12 : 12)",G:"this.getHours()",h:"Ext.String.leftPad((this.getHours() % 12) ? this.getHours() % 12 : 12, 2, '0')",H:"Ext.String.leftPad(this.getHours(), 2, '0')",i:"Ext.String.leftPad(this.getMinutes(), 2, '0')",s:"Ext.String.leftPad(this.getSeconds(), 2, '0')",u:"Ext.String.leftPad(this.getMilliseconds(), 3, '0')",O:"Ext.Date.getGMTOffset(this)",P:"Ext.Date.getGMTOffset(this, true)",T:"Ext.Date.getTimezone(this)",Z:"(this.getTimezoneOffset() * -60)",c:function(){var p,n,m,k,o;for(p="Y-m-dTH:i:sP",n=[],m=0,k=p.length;m<k;++m){o=p.charAt(m);n.push(o=="T"?"'T'":d.getFormatCode(o))}return n.join(" + ")},U:"Math.round(this.getTime() / 1000)"},isValid:function(t,k,r,p,n,o,l){p=p||0;n=n||0;o=o||0;l=l||0;var q=d.add(new Date(t<100?100:t,k-1,r,p,n,o,l),d.YEAR,t<100?t-100:0);return t==q.getFullYear()&&k==q.getMonth()+1&&r==q.getDate()&&p==q.getHours()&&n==q.getMinutes()&&o==q.getSeconds()&&l==q.getMilliseconds()},parse:function(l,n,k){var m=d.parseFunctions;if(m[n]==null){d.createParser(n)}return m[n].call(d,l,Ext.isDefined(k)?k:d.useStrict)},parseDate:function(l,m,k){return d.parse(l,m,k)},getFormatCode:function(l){var k=d.formatCodes[l];if(k){k=typeof k=="function"?k():k;d.formatCodes[l]=k}return k||("'"+Ext.String.escape(l)+"'")},createFormat:function(o){var n=[],k=false,m="",l;for(l=0;l<o.length;++l){m=o.charAt(l);if(!k&&m=="\\"){k=true}else{if(k){k=false;n.push("'"+Ext.String.escape(m)+"'")}else{n.push(d.getFormatCode(m))}}}d.formatFunctions[o]=Ext.functionFactory("return "+n.join("+"))},createParser:function(t){var l=d.parseRegexes.length,u=1,m=[],s=[],q=false,k="",o=0,p=t.length,r=[],n;for(;o<p;++o){k=t.charAt(o);if(!q&&k=="\\"){q=true}else{if(q){q=false;s.push(Ext.String.escape(k))}else{n=d.formatCodeToRegex(k,u);u+=n.g;s.push(n.s);if(n.g&&n.c){if(n.calcAtEnd){r.push(n.c)}else{m.push(n.c)}}}}}m=m.concat(r);d.parseRegexes[l]=new RegExp("^"+s.join("")+"$","i");d.parseFunctions[t]=Ext.functionFactory("input","strict",h(b,l,m.join("")))},parseCodes:{d:{g:1,c:"d = parseInt(results[{0}], 10);\n",s:"(3[0-1]|[1-2][0-9]|0[1-9])"},j:{g:1,c:"d = parseInt(results[{0}], 10);\n",s:"(3[0-1]|[1-2][0-9]|[1-9])"},D:function(){for(var k=[],l=0;l<7;k.push(d.getShortDayName(l)),++l){}return{g:0,c:null,s:"(?:"+k.join("|")+")"}},l:function(){return{g:0,c:null,s:"(?:"+d.dayNames.join("|")+")"}},N:{g:0,c:null,s:"[1-7]"},S:{g:0,c:null,s:"(?:st|nd|rd|th)"},w:{g:0,c:null,s:"[0-6]"},z:{g:1,c:"z = parseInt(results[{0}], 10);\n",s:"(\\d{1,3})"},W:{g:1,c:"W = parseInt(results[{0}], 10);\n",s:"(\\d{2})"},F:function(){return{g:1,c:"m = parseInt(me.getMonthNumber(results[{0}]), 10);\n",s:"("+d.monthNames.join("|")+")"}},M:function(){for(var k=[],l=0;l<12;k.push(d.getShortMonthName(l)),++l){}return Ext.applyIf({s:"("+k.join("|")+")"},d.formatCodeToRegex("F"))},m:{g:1,c:"m = parseInt(results[{0}], 10) - 1;\n",s:"(1[0-2]|0[1-9])"},n:{g:1,c:"m = parseInt(results[{0}], 10) - 1;\n",s:"(1[0-2]|[1-9])"},t:{g:0,c:null,s:"(?:\\d{2})"},L:{g:0,c:null,s:"(?:1|0)"},o:{g:1,c:"y = parseInt(results[{0}], 10);\n",s:"(\\d{4})"},Y:{g:1,c:"y = parseInt(results[{0}], 10);\n",s:"(\\d{4})"},y:{g:1,c:"var ty = parseInt(results[{0}], 10);\ny = ty > me.y2kYear ? 1900 + ty : 2000 + ty;\n",s:"(\\d{1,2})"},a:{g:1,c:"if (/(am)/i.test(results[{0}])) {\nif (!h || h == 12) { h = 0; }\n} else { if (!h || h < 12) { h = (h || 0) + 12; }}",s:"(am|pm|AM|PM)",calcAtEnd:true},A:{g:1,c:"if (/(am)/i.test(results[{0}])) {\nif (!h || h == 12) { h = 0; }\n} else { if (!h || h < 12) { h = (h || 0) + 12; }}",s:"(AM|PM|am|pm)",calcAtEnd:true},g:{g:1,c:"h = parseInt(results[{0}], 10);\n",s:"(1[0-2]|[0-9])"},G:{g:1,c:"h = parseInt(results[{0}], 10);\n",s:"(2[0-3]|1[0-9]|[0-9])"},h:{g:1,c:"h = parseInt(results[{0}], 10);\n",s:"(1[0-2]|0[1-9])"},H:{g:1,c:"h = parseInt(results[{0}], 10);\n",s:"(2[0-3]|[0-1][0-9])"},i:{g:1,c:"i = parseInt(results[{0}], 10);\n",s:"([0-5][0-9])"},s:{g:1,c:"s = parseInt(results[{0}], 10);\n",s:"([0-5][0-9])"},u:{g:1,c:"ms = results[{0}]; ms = parseInt(ms, 10)/Math.pow(10, ms.length - 3);\n",s:"(\\d+)"},O:{g:1,c:["o = results[{0}];","var sn = o.substring(0,1),","hr = o.substring(1,3)*1 + Math.floor(o.substring(3,5) / 60),","mn = o.substring(3,5) % 60;","o = ((-12 <= (hr*60 + mn)/60) && ((hr*60 + mn)/60 <= 14))? (sn + Ext.String.leftPad(hr, 2, '0') + Ext.String.leftPad(mn, 2, '0')) : null;\n"].join("\n"),s:"([+-]\\d{4})"},P:{g:1,c:["o = results[{0}];","var sn = o.substring(0,1),","hr = o.substring(1,3)*1 + Math.floor(o.substring(4,6) / 60),","mn = o.substring(4,6) % 60;","o = ((-12 <= (hr*60 + mn)/60) && ((hr*60 + mn)/60 <= 14))? (sn + Ext.String.leftPad(hr, 2, '0') + Ext.String.leftPad(mn, 2, '0')) : null;\n"].join("\n"),s:"([+-]\\d{2}:\\d{2})"},T:{g:0,c:null,s:"[A-Z]{1,5}"},Z:{g:1,c:"zz = results[{0}] * 1;\nzz = (-43200 <= zz && zz <= 50400)? zz : null;\n",s:"([+-]?\\d{1,5})"},c:function(){var n=[],k=[d.formatCodeToRegex("Y",1),d.formatCodeToRegex("m",2),d.formatCodeToRegex("d",3),d.formatCodeToRegex("H",4),d.formatCodeToRegex("i",5),d.formatCodeToRegex("s",6),{c:"ms = results[7] || '0'; ms = parseInt(ms, 10)/Math.pow(10, ms.length - 3);\n"},{c:["if(results[8]) {","if(results[8] == 'Z'){","zz = 0;","}else if (results[8].indexOf(':') > -1){",d.formatCodeToRegex("P",8).c,"}else{",d.formatCodeToRegex("O",8).c,"}","}"].join("\n")}],o,m;for(o=0,m=k.length;o<m;++o){n.push(k[o].c)}return{g:1,c:n.join(""),s:[k[0].s,"(?:","-",k[1].s,"(?:","-",k[2].s,"(?:","(?:T| )?",k[3].s,":",k[4].s,"(?::",k[5].s,")?","(?:(?:\\.|,)(\\d+))?","(Z|(?:[-+]\\d{2}(?::)?\\d{2}))?",")?",")?",")?"].join("")}},U:{g:1,c:"u = parseInt(results[{0}], 10);\n",s:"(-?\\d+)"}},dateFormat:function(k,l){return d.format(k,l)},isEqual:function(l,k){if(l&&k){return(l.getTime()===k.getTime())}return !(l||k)},format:function(l,m){var k=d.formatFunctions;if(!Ext.isDate(l)){return""}if(k[m]==null){d.createFormat(m)}return k[m].call(l)+""},getTimezone:function(k){return k.toString().replace(/^.* (?:\((.*)\)|([A-Z]{1,5})(?:[\-+][0-9]{4})?(?: -?\d+)?)$/,"$1$2").replace(/[^A-Z]/g,"")},getGMTOffset:function(k,l){var m=k.getTimezoneOffset();return(m>0?"-":"+")+Ext.String.leftPad(Math.floor(Math.abs(m)/60),2,"0")+(l?":":"")+Ext.String.leftPad(Math.abs(m%60),2,"0")},getDayOfYear:function(n){var l=0,p=Ext.Date.clone(n),k=n.getMonth(),o;for(o=0,p.setDate(1),p.setMonth(0);o<k;p.setMonth(++o)){l+=d.getDaysInMonth(p)}return l+n.getDate()-1},getWeekOfYear:(function(){var k=86400000,l=7*k;return function(n){var o=Date.UTC(n.getFullYear(),n.getMonth(),n.getDate()+3)/k,m=Math.floor(o/7),p=new Date(m*l).getUTCFullYear();return m-Math.floor(Date.UTC(p,0,7)/l)+1}}()),isLeapYear:function(k){var l=k.getFullYear();return !!((l&3)==0&&(l%100||(l%400==0&&l)))},getFirstDayOfMonth:function(l){var k=(l.getDay()-(l.getDate()-1))%7;return(k<0)?(k+7):k},getLastDayOfMonth:function(k){return d.getLastDateOfMonth(k).getDay()},getFirstDateOfMonth:function(k){return new Date(k.getFullYear(),k.getMonth(),1)},getLastDateOfMonth:function(k){return new Date(k.getFullYear(),k.getMonth(),d.getDaysInMonth(k))},getDaysInMonth:(function(){var k=[31,28,31,30,31,30,31,31,30,31,30,31];return function(n){var l=n.getMonth();return l==1&&d.isLeapYear(n)?29:k[l]}}()),getSuffix:function(k){switch(k.getDate()){case 1:case 21:case 31:return"st";case 2:case 22:return"nd";case 3:case 23:return"rd";default:return"th"}},clone:function(k){return new Date(k.getTime())},isDST:function(k){return new Date(k.getFullYear(),0,1).getTimezoneOffset()!=k.getTimezoneOffset()},clearTime:function(k,o){if(o){return Ext.Date.clearTime(Ext.Date.clone(k))}var m=k.getDate(),l,n;k.setHours(0);k.setMinutes(0);k.setSeconds(0);k.setMilliseconds(0);if(k.getDate()!=m){for(l=1,n=d.add(k,Ext.Date.HOUR,l);n.getDate()!=m;l++,n=d.add(k,Ext.Date.HOUR,l)){}k.setDate(m);k.setHours(n.getHours())}return k},add:function(n,m,q){var r=Ext.Date.clone(n),k=Ext.Date,l,p,o=0;if(!m||q===0){return r}p=q-parseInt(q,10);q=parseInt(q,10);if(q){switch(m.toLowerCase()){case Ext.Date.MILLI:r.setTime(r.getTime()+q);break;case Ext.Date.SECOND:r.setTime(r.getTime()+q*1000);break;case Ext.Date.MINUTE:r.setTime(r.getTime()+q*60*1000);break;case Ext.Date.HOUR:r.setTime(r.getTime()+q*60*60*1000);break;case Ext.Date.DAY:r.setDate(r.getDate()+q);break;case Ext.Date.MONTH:l=n.getDate();if(l>28){l=Math.min(l,Ext.Date.getLastDateOfMonth(Ext.Date.add(Ext.Date.getFirstDateOfMonth(n),Ext.Date.MONTH,q)).getDate())}r.setDate(l);r.setMonth(n.getMonth()+q);break;case Ext.Date.YEAR:l=n.getDate();if(l>28){l=Math.min(l,Ext.Date.getLastDateOfMonth(Ext.Date.add(Ext.Date.getFirstDateOfMonth(n),Ext.Date.YEAR,q)).getDate())}r.setDate(l);r.setFullYear(n.getFullYear()+q);break}}if(p){switch(m.toLowerCase()){case Ext.Date.MILLI:o=1;break;case Ext.Date.SECOND:o=1000;break;case Ext.Date.MINUTE:o=1000*60;break;case Ext.Date.HOUR:o=1000*60*60;break;case Ext.Date.DAY:o=1000*60*60*24;break;case Ext.Date.MONTH:l=d.getDaysInMonth(r);o=1000*60*60*24*l;break;case Ext.Date.YEAR:l=(d.isLeapYear(r)?366:365);o=1000*60*60*24*l;break}if(o){r.setTime(r.getTime()+o*p)}}return r},subtract:function(l,k,m){return d.add(l,k,-m)},between:function(l,n,k){var m=l.getTime();return n.getTime()<=m&&m<=k.getTime()},compat:function(){var l=window.Date,k,r=["useStrict","formatCodeToRegex","parseFunctions","parseRegexes","formatFunctions","y2kYear","MILLI","SECOND","MINUTE","HOUR","DAY","MONTH","YEAR","defaults","dayNames","monthNames","monthNumbers","getShortMonthName","getShortDayName","getMonthNumber","formatCodes","isValid","parseDate","getFormatCode","createFormat","createParser","parseCodes"],o=["dateFormat","format","getTimezone","getGMTOffset","getDayOfYear","getWeekOfYear","isLeapYear","getFirstDayOfMonth","getLastDayOfMonth","getDaysInMonth","getSuffix","clone","isDST","clearTime","add","between"],q=r.length,m=o.length,n,t,u;for(u=0;u<q;u++){n=r[u];l[n]=d[n]}for(k=0;k<m;k++){t=o[k];l.prototype[t]=function(){var p=Array.prototype.slice.call(arguments);p.unshift(this);return d[t].apply(d,p)}}}})};(function(a){var d=[],b=function(){},c=function(j,g,i,h){var e=function(){var k=this.callParent(arguments);j.apply(this,arguments);return k};e.$name=i;e.$owner=h;if(g){e.$previous=g.$previous;g.$previous=e}return e};Ext.apply(b,{$className:"Ext.Base",$isClass:true,create:function(){return Ext.create.apply(Ext,[this].concat(Array.prototype.slice.call(arguments,0)))},extend:function(k){var e=k.prototype,n,h,j,l,g,m;h=this.prototype=Ext.Object.chain(e);h.self=this;this.superclass=h.superclass=e;if(!k.$isClass){n=Ext.Base.prototype;for(j in n){if(j in h){h[j]=n[j]}}}m=e.$inheritableStatics;if(m){for(j=0,l=m.length;j<l;j++){g=m[j];if(!this.hasOwnProperty(g)){this[g]=k[g]}}}if(k.$onExtended){this.$onExtended=k.$onExtended.slice()}h.config=new h.configClass();h.initConfigList=h.initConfigList.slice();h.initConfigMap=Ext.clone(h.initConfigMap);h.configMap=Ext.Object.chain(h.configMap)},$onExtended:[],triggerExtended:function(){var h=this.$onExtended,g=h.length,e,j;if(g>0){for(e=0;e<g;e++){j=h[e];j.fn.apply(j.scope||this,arguments)}}},onExtended:function(g,e){this.$onExtended.push({fn:g,scope:e});return this},addConfig:function(i,m){var o=this.prototype,n=Ext.Class.configNameCache,j=o.configMap,k=o.initConfigList,h=o.initConfigMap,l=o.config,e,g,p;for(g in i){if(i.hasOwnProperty(g)){if(!j[g]){j[g]=true}p=i[g];e=n[g].initialized;if(!h[g]&&p!==null&&!o[e]){h[g]=true;k.push(g)}}}if(m){Ext.merge(l,i)}else{Ext.mergeIf(l,i)}o.configClass=Ext.Object.classify(l)},addStatics:function(e){var h,g;for(g in e){if(e.hasOwnProperty(g)){h=e[g];if(typeof h=="function"&&!h.$isClass&&h!==Ext.emptyFn&&h!==Ext.identityFn){h.$owner=this;h.$name=g}this[g]=h}}return this},addInheritableStatics:function(g){var j,e,i=this.prototype,h,k;j=i.$inheritableStatics;e=i.$hasInheritableStatics;if(!j){j=i.$inheritableStatics=[];e=i.$hasInheritableStatics={}}for(h in g){if(g.hasOwnProperty(h)){k=g[h];this[h]=k;if(!e[h]){e[h]=true;j.push(h)}}}return this},addMembers:function(g){var j=this.prototype,e=Ext.enumerables,m=[],k,l,h,n;for(h in g){m.push(h)}if(e){m.push.apply(m,e)}for(k=0,l=m.length;k<l;k++){h=m[k];if(g.hasOwnProperty(h)){n=g[h];if(typeof n=="function"&&!n.$isClass&&n!==Ext.emptyFn&&n!==Ext.identityFn){n.$owner=this;n.$name=h}j[h]=n}}return this},addMember:function(e,g){if(typeof g=="function"&&!g.$isClass&&g!==Ext.emptyFn&&g!==Ext.identityFn){g.$owner=this;g.$name=e}this.prototype[e]=g;return this},implement:function(){this.addMembers.apply(this,arguments)},borrow:function(k,h){var o=this.prototype,n=k.prototype,j,l,g,m,e;h=Ext.Array.from(h);for(j=0,l=h.length;j<l;j++){g=h[j];e=n[g];if(typeof e=="function"){m=Ext.Function.clone(e);m.$owner=this;m.$name=g;o[g]=m}else{o[g]=e}}return this},override:function(g){var n=this,p=Ext.enumerables,l=n.prototype,i=Ext.Function.clone,e,k,h,o,m,j;if(arguments.length===2){e=g;g={};g[e]=arguments[1];p=null}do{m=[];o=null;for(e in g){if(e=="statics"){o=g[e]}else{if(e=="inheritableStatics"){n.addInheritableStatics(g[e])}else{if(e=="config"){n.addConfig(g[e],true)}else{m.push(e)}}}}if(p){m.push.apply(m,p)}for(k=m.length;k--;){e=m[k];if(g.hasOwnProperty(e)){h=g[e];if(typeof h=="function"&&!h.$className&&h!==Ext.emptyFn&&h!==Ext.identityFn){if(typeof h.$owner!="undefined"){h=i(h)}h.$owner=n;h.$name=e;j=l[e];if(j){h.$previous=j}}l[e]=h}}l=n;g=o}while(g);return this},callParent:function(e){var g;return(g=this.callParent.caller)&&(g.$previous||((g=g.$owner?g:g.caller)&&g.$owner.superclass.self[g.$name])).apply(this,e||d)},callSuper:function(e){var g;return(g=this.callSuper.caller)&&((g=g.$owner?g:g.caller)&&g.$owner.superclass.self[g.$name]).apply(this,e||d)},mixin:function(g,h){var l=this,s=h.prototype,n=l.prototype,r,m,j,k,q,p,o,e;if(typeof s.onClassMixedIn!="undefined"){s.onClassMixedIn.call(h,l)}if(!n.hasOwnProperty("mixins")){if("mixins" in n){n.mixins=Ext.Object.chain(n.mixins)}else{n.mixins={}}}for(r in s){p=s[r];if(r==="mixins"){Ext.merge(n.mixins,p)}else{if(r==="xhooks"){for(o in p){e=p[o];e.$previous=Ext.emptyFn;if(n.hasOwnProperty(o)){c(e,n[o],o,l)}else{n[o]=c(e,null,o,l)}}}else{if(!(r==="mixinId"||r==="config")&&(n[r]===undefined)){n[r]=p}}}}m=s.$inheritableStatics;if(m){for(j=0,k=m.length;j<k;j++){q=m[j];if(!l.hasOwnProperty(q)){l[q]=h[q]}}}if("config" in s){l.addConfig(s.config,false)}n.mixins[g]=s;return l},getName:function(){return Ext.getClassName(this)},createAlias:a(function(g,e){this.override(g,function(){return this[e].apply(this,arguments)})}),addXtype:function(j){var g=this.prototype,i=g.xtypesMap,h=g.xtypes,e=g.xtypesChain;if(!g.hasOwnProperty("xtypesMap")){i=g.xtypesMap=Ext.merge({},g.xtypesMap||{});h=g.xtypes=g.xtypes?[].concat(g.xtypes):[];e=g.xtypesChain=g.xtypesChain?[].concat(g.xtypesChain):[];g.xtype=j}if(!i[j]){i[j]=true;h.push(j);e.push(j);Ext.ClassManager.setAlias(this,"widget."+j)}return this}});b.implement({isInstance:true,$className:"Ext.Base",configClass:Ext.emptyFn,initConfigList:[],configMap:{},initConfigMap:{},statics:function(){var g=this.statics.caller,e=this.self;if(!g){return e}return g.$owner},callParent:function(g){var h,e=(h=this.callParent.caller)&&(h.$previous||((h=h.$owner?h:h.caller)&&h.$owner.superclass[h.$name]));return e.apply(this,g||d)},callSuper:function(g){var h,e=(h=this.callSuper.caller)&&((h=h.$owner?h:h.caller)&&h.$owner.superclass[h.$name]);return e.apply(this,g||d)},self:b,constructor:function(){return this},initConfig:function(h){var n=h,m=Ext.Class.configNameCache,k=new this.configClass(),q=this.initConfigList,j=this.configMap,p,l,o,g,e;this.initConfig=Ext.emptyFn;this.initialConfig=n||{};this.config=h=(n)?Ext.merge(k,h):k;if(n){q=q.slice();for(g in n){if(j[g]){if(n[g]!==null){q.push(g);this[m[g].initialized]=false}}}}for(l=0,o=q.length;l<o;l++){g=q[l];p=m[g];e=p.initialized;if(!this[e]){this[e]=true;this[p.set].call(this,h[g])}}return this},hasConfig:function(e){return Boolean(this.configMap[e])},setConfig:function(i,m){if(!i){return this}var h=Ext.Class.configNameCache,e=this.config,l=this.configMap,k=this.initialConfig,g,j;m=Boolean(m);for(g in i){if(m&&k.hasOwnProperty(g)){continue}j=i[g];e[g]=j;if(l[g]){this[h[g].set](j)}}return this},getConfig:function(g){var e=Ext.Class.configNameCache;return this[e[g].get]()},getInitialConfig:function(g){var e=this.config;if(!g){return e}else{return e[g]}},onConfigUpdate:function(l,n,o){var p=this.self,h,k,e,j,m,g;l=Ext.Array.from(l);o=o||this;for(h=0,k=l.length;h<k;h++){e=l[h];j="update"+Ext.String.capitalize(e);m=this[j]||Ext.emptyFn;g=function(){m.apply(this,arguments);o[n].apply(o,arguments)};g.$name=j;g.$owner=p;this[j]=g}},destroy:function(){this.destroy=Ext.emptyFn}});b.prototype.callOverridden=b.prototype.callParent;Ext.Base=b}(Ext.Function.flexSetter));(function(){var c,b=Ext.Base,g=[],e,d;for(e in b){if(b.hasOwnProperty(e)){g.push(e)}}d=g.length;function a(i){function h(){return this.constructor.apply(this,arguments)||null}return h}Ext.Class=c=function(i,j,h){if(typeof i!="function"){h=j;j=i;i=null}if(!j){j={}}i=c.create(i,j);c.process(i,j,h);return i};Ext.apply(c,{onBeforeCreated:function(i,j,h){i.addMembers(j);h.onCreated.call(i,i)},create:function(h,l){var j,k;if(!h){h=a()}for(k=0;k<d;k++){j=g[k];h[j]=b[j]}return h},process:function(h,p,l){var k=p.preprocessors||c.defaultPreprocessors,s=this.preprocessors,v={onBeforeCreated:this.onBeforeCreated},u=[],w,o,n,t,m,r,q;delete p.preprocessors;for(n=0,t=k.length;n<t;n++){w=k[n];if(typeof w=="string"){w=s[w];o=w.properties;if(o===true){u.push(w.fn)}else{if(o){for(m=0,r=o.length;m<r;m++){q=o[m];if(p.hasOwnProperty(q)){u.push(w.fn);break}}}}}else{u.push(w)}}v.onCreated=l?l:Ext.emptyFn;v.preprocessors=u;this.doProcess(h,p,v)},doProcess:function(i,m,h){var l=this,n=h.preprocessors,j=n.shift(),k=l.doProcess;for(;j;j=n.shift()){if(j.call(l,i,m,h,k)===false){return}}h.onBeforeCreated.apply(l,arguments)},preprocessors:{},registerPreprocessor:function(i,l,j,h,k){if(!h){h="last"}if(!j){j=[i]}this.preprocessors[i]={name:i,properties:j||false,fn:l};this.setDefaultPreprocessorPosition(i,h,k);return this},getPreprocessor:function(h){return this.preprocessors[h]},getPreprocessors:function(){return this.preprocessors},defaultPreprocessors:[],getDefaultPreprocessors:function(){return this.defaultPreprocessors},setDefaultPreprocessors:function(h){this.defaultPreprocessors=Ext.Array.from(h);return this},setDefaultPreprocessorPosition:function(j,l,k){var h=this.defaultPreprocessors,i;if(typeof l=="string"){if(l==="first"){h.unshift(j);return this}else{if(l==="last"){h.push(j);return this}}l=(l==="after")?1:-1}i=Ext.Array.indexOf(h,k);if(i!==-1){Ext.Array.splice(h,Math.max(0,i+l),0,j)}return this},configNameCache:{},getConfigNameMap:function(j){var i=this.configNameCache,k=i[j],h;if(!k){h=j.charAt(0).toUpperCase()+j.substr(1);k=i[j]={internal:j,initialized:"_is"+h+"Initialized",apply:"apply"+h,update:"update"+h,set:"set"+h,get:"get"+h,doSet:"doSet"+h,changeEvent:j.toLowerCase()+"change"}}return k}});c.registerPreprocessor("extend",function(j,l,q){var m=Ext.Base,n=m.prototype,o=l.extend,h,p,k;delete l.extend;if(o&&o!==Object){h=o}else{h=m}p=h.prototype;if(!h.$isClass){for(k in n){if(!p[k]){p[k]=n[k]}}}j.extend(h);j.triggerExtended.apply(j,arguments);if(l.onClassExtended){j.onExtended(l.onClassExtended,j);delete l.onClassExtended}},true);c.registerPreprocessor("statics",function(h,i){h.addStatics(i.statics);delete i.statics});c.registerPreprocessor("inheritableStatics",function(h,i){h.addInheritableStatics(i.inheritableStatics);delete i.inheritableStatics});c.registerPreprocessor("config",function(h,k){var j=k.config,i=h.prototype;delete k.config;Ext.Object.each(j,function(n,w){var u=c.getConfigNameMap(n),q=u.internal,l=u.initialized,v=u.apply,o=u.update,t=u.set,m=u.get,y=(t in i)||k.hasOwnProperty(t),p=(v in i)||k.hasOwnProperty(v),r=(o in i)||k.hasOwnProperty(o),x,s;if(w===null||(!y&&!p&&!r)){i[q]=w;i[l]=true}else{i[l]=false}if(!y){k[t]=function(B){var A=this[q],z=this[v],C=this[o];if(!this[l]){this[l]=true}if(z){B=z.call(this,B,A)}if(typeof B!="undefined"){this[q]=B;if(C&&B!==A){C.call(this,B,A)}}return this}}if(!(m in i)||k.hasOwnProperty(m)){s=k[m]||false;if(s){x=function(){return s.apply(this,arguments)}}else{x=function(){return this[q]}}k[m]=function(){var z;if(!this[l]){this[l]=true;this[t](this.config[n])}z=this[m];if("$previous" in z){z.$previous=x}else{this[m]=x}return x.apply(this,arguments)}}});h.addConfig(j,true)});c.registerPreprocessor("mixins",function(l,p,h){var j=p.mixins,m,k,n,o;delete p.mixins;Ext.Function.interceptBefore(h,"onCreated",function(){if(j instanceof Array){for(n=0,o=j.length;n<o;n++){k=j[n];m=k.prototype.mixinId||k.$className;l.mixin(m,k)}}else{for(var i in j){if(j.hasOwnProperty(i)){l.mixin(i,j[i])}}}})});Ext.extend=function(j,k,i){if(arguments.length===2&&Ext.isObject(k)){i=k;k=j;j=null}var h;if(!k){throw new Error("[Ext.extend] Attempting to extend from a class which has not been loaded on the page.")}i.extend=k;i.preprocessors=["extend","statics","inheritableStatics","mixins","config"];if(j){h=new c(j,i);h.prototype.constructor=j}else{h=new c(i)}h.prototype.override=function(n){for(var l in n){if(n.hasOwnProperty(l)){this[l]=n[l]}}};return h}}());(function(c,e,h,d,g){function a(){function i(){return this.constructor.apply(this,arguments)||null}return i}var b=Ext.ClassManager={classes:{},existCache:{},namespaceRewrites:[{from:"Ext.",to:Ext}],maps:{alternateToName:{},aliasToName:{},nameToAliases:{},nameToAlternates:{}},enableNamespaceParseCache:true,namespaceParseCache:{},instantiators:[],isCreated:function(n){var m=this.existCache,l,o,k,j,p;if(this.classes[n]||m[n]){return true}j=g;p=this.parseNamespace(n);for(l=0,o=p.length;l<o;l++){k=p[l];if(typeof k!="string"){j=k}else{if(!j||!j[k]){return false}j=j[k]}}m[n]=true;this.triggerCreated(n);return true},createdListeners:[],nameCreatedListeners:{},triggerCreated:function(s){var u=this.createdListeners,m=this.nameCreatedListeners,n=this.maps.nameToAlternates[s],t=[s],p,r,o,q,l,k;for(p=0,r=u.length;p<r;p++){l=u[p];l.fn.call(l.scope,s)}if(n){t.push.apply(t,n)}for(p=0,r=t.length;p<r;p++){k=t[p];u=m[k];if(u){for(o=0,q=u.length;o<q;o++){l=u[o];l.fn.call(l.scope,k)}delete m[k]}}},onCreated:function(m,l,k){var j=this.createdListeners,i=this.nameCreatedListeners,n={fn:m,scope:l};if(k){if(this.isCreated(k)){m.call(l,k);return}if(!i[k]){i[k]=[]}i[k].push(n)}else{j.push(n)}},parseNamespace:function(l){var j=this.namespaceParseCache,m,o,q,k,t,s,r,n,p;if(this.enableNamespaceParseCache){if(j.hasOwnProperty(l)){return j[l]}}m=[];o=this.namespaceRewrites;q=g;k=l;for(n=0,p=o.length;n<p;n++){t=o[n];s=t.from;r=t.to;if(k===s||k.substring(0,s.length)===s){k=k.substring(s.length);if(typeof r!="string"){q=r}else{m=m.concat(r.split("."))}break}}m.push(q);m=m.concat(k.split("."));if(this.enableNamespaceParseCache){j[l]=m}return m},setNamespace:function(m,p){var k=g,q=this.parseNamespace(m),o=q.length-1,j=q[o],n,l;for(n=0;n<o;n++){l=q[n];if(typeof l!="string"){k=l}else{if(!k[l]){k[l]={}}k=k[l]}}k[j]=p;return k[j]},createNamespaces:function(){var k=g,p,m,n,l,o,q;for(n=0,o=arguments.length;n<o;n++){p=this.parseNamespace(arguments[n]);for(l=0,q=p.length;l<q;l++){m=p[l];if(typeof m!="string"){k=m}else{if(!k[m]){k[m]={}}k=k[m]}}}return k},set:function(i,m){var l=this,o=l.maps,n=o.nameToAlternates,k=l.getName(m),j;l.classes[i]=l.setNamespace(i,m);if(k&&k!==i){o.alternateToName[i]=k;j=n[k]||(n[k]=[]);j.push(i)}return this},get:function(l){var n=this.classes,j,p,k,m,o;if(n[l]){return n[l]}j=g;p=this.parseNamespace(l);for(m=0,o=p.length;m<o;m++){k=p[m];if(typeof k!="string"){j=k}else{if(!j||!j[k]){return null}j=j[k]}}return j},setAlias:function(i,j){var l=this.maps.aliasToName,m=this.maps.nameToAliases,k;if(typeof i=="string"){k=i}else{k=this.getName(i)}if(j&&l[j]!==k){l[j]=k}if(!m[k]){m[k]=[]}if(j){Ext.Array.include(m[k],j)}return this},addNameAliasMappings:function(j){var o=this.maps.aliasToName,p=this.maps.nameToAliases,m,n,l,k;for(m in j){n=p[m]||(p[m]=[]);for(k=0;k<j[m].length;k++){l=j[m][k];if(!o[l]){o[l]=m;n.push(l)}}}return this},addNameAlternateMappings:function(m){var j=this.maps.alternateToName,p=this.maps.nameToAlternates,l,n,o,k;for(l in m){n=p[l]||(p[l]=[]);for(k=0;k<m[l].length;k++){o=m[l];if(!j[o]){j[o]=l;n.push(o)}}}return this},getByAlias:function(i){return this.get(this.getNameByAlias(i))},getNameByAlias:function(i){return this.maps.aliasToName[i]||""},getNameByAlternate:function(i){return this.maps.alternateToName[i]||""},getAliasesByName:function(i){return this.maps.nameToAliases[i]||[]},getName:function(i){return i&&i.$className||""},getClass:function(i){return i&&i.self||null},create:function(j,l,i){var k=a();if(typeof l=="function"){l=l(k)}l.$className=j;return new c(k,l,function(){var m=l.postprocessors||b.defaultPostprocessors,t=b.postprocessors,u=[],s,o,r,n,q,p,v;delete l.postprocessors;for(o=0,r=m.length;o<r;o++){s=m[o];if(typeof s=="string"){s=t[s];p=s.properties;if(p===true){u.push(s.fn)}else{if(p){for(n=0,q=p.length;n<q;n++){v=p[n];if(l.hasOwnProperty(v)){u.push(s.fn);break}}}}}else{u.push(s)}}l.postprocessors=u;l.createdFn=i;b.processCreate(j,this,l)})},processCreate:function(l,j,n){var m=this,i=n.postprocessors.shift(),k=n.createdFn;if(!i){if(l){m.set(l,j)}if(k){k.call(j,j)}if(l){m.triggerCreated(l)}return}if(i.call(m,l,j,n,m.processCreate)!==false){m.processCreate(l,j,n)}},createOverride:function(l,p,j){var o=this,n=p.override,k=p.requires,i=p.uses,m=function(){var q,r;if(k){r=k;k=null;Ext.Loader.require(r,m)}else{q=o.get(n);delete p.override;delete p.requires;delete p.uses;Ext.override(q,p);o.triggerCreated(l);if(i){Ext.Loader.addUsedClasses(i)}if(j){j.call(q)}}};o.existCache[l]=true;o.onCreated(m,o,n);return o},instantiateByAlias:function(){var j=arguments[0],i=h.call(arguments),k=this.getNameByAlias(j);if(!k){k=this.maps.aliasToName[j];Ext.syncRequire(k)}i[0]=k;return this.instantiate.apply(this,i)},instantiate:function(){var k=arguments[0],m=typeof k,j=h.call(arguments,1),l=k,n,i;if(m!="function"){if(m!="string"&&j.length===0){j=[k];k=k.xclass}i=this.get(k)}else{i=k}if(!i){n=this.getNameByAlias(k);if(n){k=n;i=this.get(k)}}if(!i){n=this.getNameByAlternate(k);if(n){k=n;i=this.get(k)}}if(!i){Ext.syncRequire(k);i=this.get(k)}return this.getInstantiator(j.length)(i,j)},dynInstantiate:function(j,i){i=d(i,true);i.unshift(j);return this.instantiate.apply(this,i)},getInstantiator:function(m){var l=this.instantiators,n,k,j;n=l[m];if(!n){k=m;j=[];for(k=0;k<m;k++){j.push("a["+k+"]")}n=l[m]=new Function("c","a","return new c("+j.join(",")+")")}return n},postprocessors:{},defaultPostprocessors:[],registerPostprocessor:function(j,m,k,i,l){if(!i){i="last"}if(!k){k=[j]}this.postprocessors[j]={name:j,properties:k||false,fn:m};this.setDefaultPostprocessorPosition(j,i,l);return this},setDefaultPostprocessors:function(i){this.defaultPostprocessors=d(i);return this},setDefaultPostprocessorPosition:function(j,m,l){var k=this.defaultPostprocessors,i;if(typeof m=="string"){if(m==="first"){k.unshift(j);return this}else{if(m==="last"){k.push(j);return this}}m=(m==="after")?1:-1}i=Ext.Array.indexOf(k,l);if(i!==-1){Ext.Array.splice(k,Math.max(0,i+m),0,j)}return this},getNamesByExpression:function(q){var o=this.maps.nameToAliases,r=[],j,n,l,k,s,m,p;if(q.indexOf("*")!==-1){q=q.replace(/\*/g,"(.*?)");s=new RegExp("^"+q+"$");for(j in o){if(o.hasOwnProperty(j)){l=o[j];if(j.search(s)!==-1){r.push(j)}else{for(m=0,p=l.length;m<p;m++){n=l[m];if(n.search(s)!==-1){r.push(j);break}}}}}}else{k=this.getNameByAlias(q);if(k){r.push(k)}else{k=this.getNameByAlternate(q);if(k){r.push(k)}else{r.push(q)}}}return r}};b.registerPostprocessor("alias",function(l,k,o){var j=o.alias,m,n;for(m=0,n=j.length;m<n;m++){e=j[m];this.setAlias(k,e)}},["xtype","alias"]);b.registerPostprocessor("singleton",function(j,i,l,k){if(l.singleton){k.call(this,j,new i(),l)}else{return true}return false});b.registerPostprocessor("alternateClassName",function(k,j,o){var m=o.alternateClassName,l,n,p;if(!(m instanceof Array)){m=[m]}for(l=0,n=m.length;l<n;l++){p=m[l];this.set(p,j)}});Ext.apply(Ext,{create:e(b,"instantiate"),widget:function(k,j){var o=k,l,m,i,n;if(typeof o!="string"){j=k;o=j.xtype}else{j=j||{}}if(j.isComponent){return j}l="widget."+o;m=b.getNameByAlias(l);if(!m){n=true}i=b.get(m);if(n||!i){return b.instantiateByAlias(l,j)}return new i(j)},createByAlias:e(b,"instantiateByAlias"),define:function(j,k,i){if(k.override){return b.createOverride.apply(b,arguments)}return b.create.apply(b,arguments)},getClassName:e(b,"getName"),getDisplayName:function(i){if(i){if(i.displayName){return i.displayName}if(i.$name&&i.$class){return Ext.getClassName(i.$class)+"#"+i.$name}if(i.$className){return i.$className}}return"Anonymous"},getClass:e(b,"getClass"),namespace:e(b,"createNamespaces")});Ext.createWidget=Ext.widget;Ext.ns=Ext.namespace;c.registerPreprocessor("className",function(i,j){if(j.$className){i.$className=j.$className}},true,"first");c.registerPreprocessor("alias",function(u,o){var s=u.prototype,l=d(o.xtype),j=d(o.alias),v="widget.",t=v.length,p=Array.prototype.slice.call(s.xtypesChain||[]),m=Ext.merge({},s.xtypesMap||{}),n,r,q,k;for(n=0,r=j.length;n<r;n++){q=j[n];if(q.substring(0,t)===v){k=q.substring(t);Ext.Array.include(l,k)}}u.xtype=o.xtype=l[0];o.xtypes=l;for(n=0,r=l.length;n<r;n++){k=l[n];if(!m[k]){m[k]=true;p.push(k)}}o.xtypesChain=p;o.xtypesMap=m;Ext.Function.interceptAfter(o,"onClassCreated",function(){var i=s.mixins,x,w;for(x in i){if(i.hasOwnProperty(x)){w=i[x];l=w.xtypes;if(l){for(n=0,r=l.length;n<r;n++){k=l[n];if(!m[k]){m[k]=true;p.push(k)}}}}}});for(n=0,r=l.length;n<r;n++){k=l[n];Ext.Array.include(j,v+k)}o.alias=j},["xtype","alias"])}(Ext.Class,Ext.Function.alias,Array.prototype.slice,Ext.Array.from,Ext.global));if(Ext._alternatesMetadata){Ext.ClassManager.addNameAlternateMappings(Ext._alternatesMetadata);Ext._alternatesMetadata=null}if(Ext._aliasMetadata){Ext.ClassManager.addNameAliasMappings(Ext._aliasMetadata);Ext._aliasMetadata=null}Ext.Loader=new function(){var k=this,b=Ext.ClassManager,t=Ext.Class,e=Ext.Function.flexSetter,o=Ext.Function.alias,a=Ext.Function.pass,d=Ext.Function.defer,h=Ext.Array.erase,n=["extend","mixins","requires"],v={},m=[],c=/\/\.\//g,g=/\./g,j=0;Ext.apply(k,{isInHistory:v,history:m,config:{enabled:false,scriptChainDelay:false,disableCaching:true,disableCachingParam:"_dc",garbageCollect:false,paths:{Ext:"."},preserveScripts:true,scriptCharset:undefined},setConfig:function(y,z){if(Ext.isObject(y)&&arguments.length===1){Ext.merge(k.config,y);if("paths" in y){Ext.app.collectNamespaces(y.paths)}}else{k.config[y]=(Ext.isObject(z))?Ext.merge(k.config[y],z):z;if(y==="paths"){Ext.app.collectNamespaces(z)}}return k},getConfig:function(y){if(y){return k.config[y]}return k.config},setPath:e(function(y,z){k.config.paths[y]=z;Ext.app.namespaces[y]=true;j++;return k}),addClassPathMappings:function(z){var y;if(j==0){k.config.paths=z}else{for(y in z){k.config.paths[y]=z[y]}}j++;return k},getPath:function(y){var A="",B=k.config.paths,z=k.getPrefix(y);if(z.length>0){if(z===y){return B[z]}A=B[z];y=y.substring(z.length+1)}if(A.length>0){A+="/"}return A.replace(c,"/")+y.replace(g,"/")+".js"},getPrefix:function(z){var B=k.config.paths,A,y="";if(B.hasOwnProperty(z)){return z}for(A in B){if(B.hasOwnProperty(A)&&A+"."===z.substring(0,A.length+1)){if(A.length>y.length){y=A}}}return y},isAClassNameWithAKnownPrefix:function(y){var z=k.getPrefix(y);return z!==""&&z!==y},require:function(A,z,y,B){if(z){z.call(y)}},syncRequire:function(){},exclude:function(y){return{require:function(B,A,z){return k.require(B,A,z,y)},syncRequire:function(B,A,z){return k.syncRequire(B,A,z,y)}}},onReady:function(B,A,C,y){var z;if(C!==false&&Ext.onDocumentReady){z=B;B=function(){Ext.onDocumentReady(z,A,y)}}B.call(A)}});var q=[],r={},u={},s={},p={},w=[],x=[],i={},l=function(y,z){return z.priority-y.priority};Ext.apply(k,{documentHead:typeof document!="undefined"&&(document.head||document.getElementsByTagName("head")[0]),isLoading:false,queue:q,isClassFileLoaded:r,isFileLoaded:u,readyListeners:w,optionalRequires:x,requiresMap:i,numPendingFiles:0,numLoadedFiles:0,hasFileLoadError:false,classNameToFilePathMap:s,scriptsLoading:0,syncModeEnabled:false,scriptElements:p,refreshQueue:function(){var C=q.length,z,B,y,A;if(!C&&!k.scriptsLoading){return k.triggerReady()}for(z=0;z<C;z++){B=q[z];if(B){A=B.requires;if(A.length>k.numLoadedFiles){continue}for(y=0;y<A.length;){if(b.isCreated(A[y])){h(A,y,1)}else{y++}}if(B.requires.length===0){h(q,z,1);B.callback.call(B.scope);k.refreshQueue();break}}}return k},injectScriptElement:function(y,F,C,H,A){var G=document.createElement("script"),D=false,z=k.config,E=function(){if(!D){D=true;G.onload=G.onreadystatechange=G.onerror=null;if(typeof z.scriptChainDelay=="number"){d(F,z.scriptChainDelay,H)}else{F.call(H)}k.cleanupScriptElement(G,z.preserveScripts===false,z.garbageCollect)}},B=function(I){d(C,1,H);k.cleanupScriptElement(G,z.preserveScripts===false,z.garbageCollect)};G.type="text/javascript";G.onerror=B;A=A||z.scriptCharset;if(A){G.charset=A}if("addEventListener" in G){G.onload=E}else{if("readyState" in G){G.onreadystatechange=function(){if(this.readyState=="loaded"||this.readyState=="complete"){E()}}}else{G.onload=E}}G.src=y;(k.documentHead||document.getElementsByTagName("head")[0]).appendChild(G);return G},removeScriptElement:function(y){if(p[y]){k.cleanupScriptElement(p[y],true,!!k.getConfig("garbageCollect"));delete p[y]}return k},cleanupScriptElement:function(A,z,B){var C;A.onload=A.onreadystatechange=A.onerror=null;if(z){Ext.removeNode(A);if(B){for(C in A){try{if(C!="src"){A[C]=null}delete A[C]}catch(y){}}}}return k},loadScript:function(H){var B=k.getConfig(),A=typeof H=="string",z=A?H:H.url,D=!A&&H.onError,E=!A&&H.onLoad,G=!A&&H.scope,F=function(){k.numPendingFiles--;k.scriptsLoading--;if(D){D.call(G,"Failed loading '"+z+"', please verify that the file exists")}if(k.numPendingFiles+k.scriptsLoading===0){k.refreshQueue()}},C=function(){k.numPendingFiles--;k.scriptsLoading--;if(E){E.call(G)}if(k.numPendingFiles+k.scriptsLoading===0){k.refreshQueue()}},y;k.isLoading=true;k.numPendingFiles++;k.scriptsLoading++;y=B.disableCaching?(z+"?"+B.disableCachingParam+"="+Ext.Date.now()):z;p[z]=k.injectScriptElement(y,C,F)},loadScriptFile:function(z,G,E,J,y){if(u[z]){return k}var B=k.getConfig(),K=z+(B.disableCaching?("?"+B.disableCachingParam+"="+Ext.Date.now()):""),A=false,I,C,H,D="";J=J||k;k.isLoading=true;if(!y){H=function(){};p[z]=k.injectScriptElement(K,G,H,J)}else{if(typeof XMLHttpRequest!="undefined"){I=new XMLHttpRequest()}else{I=new ActiveXObject("Microsoft.XMLHTTP")}try{I.open("GET",K,false);I.send(null)}catch(F){A=true}C=(I.status===1223)?204:(I.status===0&&((self.location||{}).protocol=="file:"||(self.location||{}).protocol=="ionp:"))?200:I.status;A=A||(C===0);if(A){}else{if((C>=200&&C<300)||(C===304)){if(!Ext.isIE){D="\n//@ sourceURL="+z}Ext.globalEval(I.responseText+D);G.call(J)}else{}}I=null}},syncRequire:function(){var y=k.syncModeEnabled;if(!y){k.syncModeEnabled=true}k.require.apply(k,arguments);if(!y){k.syncModeEnabled=false}k.refreshQueue()},require:function(Q,H,B,D){var J={},A={},G=[],S=[],P=[],z=[],F,R,L,K,y,E,O,N,M,I,C;if(D){D=(typeof D==="string")?[D]:D;for(N=0,I=D.length;N<I;N++){y=D[N];if(typeof y=="string"&&y.length>0){G=b.getNamesByExpression(y);for(M=0,C=G.length;M<C;M++){J[G[M]]=true}}}}Q=(typeof Q==="string")?[Q]:(Q?Q:[]);if(H){if(H.length>0){F=function(){var U=[],T,V;for(T=0,V=z.length;T<V;T++){U.push(b.get(z[T]))}return H.apply(this,U)}}else{F=H}}else{F=Ext.emptyFn}B=B||Ext.global;for(N=0,I=Q.length;N<I;N++){K=Q[N];if(typeof K=="string"&&K.length>0){S=b.getNamesByExpression(K);C=S.length;for(M=0;M<C;M++){O=S[M];if(J[O]!==true){z.push(O);if(!b.isCreated(O)&&!A[O]){A[O]=true;P.push(O)}}}}}if(P.length>0){if(!k.config.enabled){throw new Error("Ext.Loader is not enabled, so dependencies cannot be resolved dynamically. Missing required class"+((P.length>1)?"es":"")+": "+P.join(", "))}}else{F.call(B);return k}R=k.syncModeEnabled;if(!R){q.push({requires:P.slice(),callback:F,scope:B})}I=P.length;for(N=0;N<I;N++){E=P[N];L=k.getPath(E);if(R&&r.hasOwnProperty(E)){if(!r[E]){k.numPendingFiles--;k.removeScriptElement(L);delete r[E]}}if(!r.hasOwnProperty(E)){r[E]=false;s[E]=L;k.numPendingFiles++;k.loadScriptFile(L,a(k.onFileLoaded,[E,L],k),a(k.onFileLoadError,[E,L],k),k,R)}}if(R){F.call(B);if(I===1){return b.get(E)}}return k},onFileLoaded:function(A,z){var y=r[A];k.numLoadedFiles++;r[A]=true;u[z]=true;if(!y){k.numPendingFiles--}if(k.numPendingFiles===0){k.refreshQueue()}},onFileLoadError:function(A,z,y,B){k.numPendingFiles--;k.hasFileLoadError=true},addUsedClasses:function(A){var y,z,B;if(A){A=(typeof A=="string")?[A]:A;for(z=0,B=A.length;z<B;z++){y=A[z];if(typeof y=="string"&&!Ext.Array.contains(x,y)){x.push(y)}}}return k},triggerReady:function(){var y,z=x;if(k.isLoading){k.isLoading=false;if(z.length!==0){z=z.slice();x.length=0;k.require(z,k.triggerReady,k);return k}}Ext.Array.sort(w,l);while(w.length&&!k.isLoading){y=w.shift();y.fn.call(y.scope)}return k},onReady:function(B,A,C,y){var z;if(C!==false&&Ext.onDocumentReady){z=B;B=function(){Ext.onDocumentReady(z,A,y)}}if(!k.isLoading){B.call(A)}else{w.push({fn:B,scope:A,priority:(y&&y.priority)||0})}},historyPush:function(y){if(y&&r.hasOwnProperty(y)&&!v[y]){v[y]=true;m.push(y)}return k}});Ext.disableCacheBuster=function(z,A){var y=new Date();y.setTime(y.getTime()+(z?10*365:-1)*24*60*60*1000);y=y.toGMTString();document.cookie="ext-cache=1; expires="+y+"; path="+(A||"/")};Ext.require=o(k,"require");Ext.syncRequire=o(k,"syncRequire");Ext.exclude=o(k,"exclude");Ext.onReady=function(A,z,y){k.onReady(A,z,true,y)};t.registerPreprocessor("loader",function(O,C,N,M){var J=this,H=[],y,I=b.getName(O),B,A,G,F,L,E,z,K,D;for(B=0,G=n.length;B<G;B++){E=n[B];if(C.hasOwnProperty(E)){z=C[E];if(typeof z=="string"){H.push(z)}else{if(z instanceof Array){for(A=0,F=z.length;A<F;A++){L=z[A];if(typeof L=="string"){H.push(L)}}}else{if(typeof z!="function"){for(A in z){if(z.hasOwnProperty(A)){L=z[A];if(typeof L=="string"){H.push(L)}}}}}}}}if(H.length===0){return}k.require(H,function(){for(B=0,G=n.length;B<G;B++){E=n[B];if(C.hasOwnProperty(E)){z=C[E];if(typeof z=="string"){C[E]=b.get(z)}else{if(z instanceof Array){for(A=0,F=z.length;A<F;A++){L=z[A];if(typeof L=="string"){C[E][A]=b.get(L)}}}else{if(typeof z!="function"){for(var P in z){if(z.hasOwnProperty(P)){L=z[P];if(typeof L=="string"){C[E][P]=b.get(L)}}}}}}}}M.call(J,O,C,N)});return false},true,"after","className");b.registerPostprocessor("uses",function(A,z,B){var y=B.uses;if(y){k.addUsedClasses(y)}});b.onCreated(k.historyPush)};if(Ext._classPathMetadata){Ext.Loader.addClassPathMappings(Ext._classPathMetadata);Ext._classPathMetadata=null}(function(){var a=document.getElementsByTagName("script"),b=a[a.length-1],d=b.src,c=d.substring(0,d.lastIndexOf("/")+1),e=Ext.Loader;e.setConfig({enabled:true,disableCaching:true,paths:{Ext:c+"src"}})})();Ext._endTime=new Date().getTime();if(Ext._beforereadyhandler){Ext._beforereadyhandler()}Ext.Error=Ext.extend(Error,{statics:{ignore:false,raise:function(a){a=a||{};if(Ext.isString(a)){a={msg:a}}var c=this.raise.caller,b;if(c){if(c.$name){a.sourceMethod=c.$name}if(c.$owner){a.sourceClass=c.$owner.$className}}if(Ext.Error.handle(a)!==true){b=Ext.Error.prototype.toString.call(a);Ext.log({msg:b,level:"error",dump:a,stack:true});throw new Ext.Error(a)}},handle:function(){return Ext.Error.ignore}},name:"Ext.Error",constructor:function(a){if(Ext.isString(a)){a={msg:a}}var b=this;Ext.apply(b,a);b.message=b.message||b.msg},toString:function(){var c=this,b=c.sourceClass?c.sourceClass:"",a=c.sourceMethod?"."+c.sourceMethod+"(): ":"",d=c.msg||"(No description provided)";return b+a+d}});Ext.deprecated=function(a){return Ext.emptyFn};Ext.JSON=(new (function(){var me=this,encodingFunction,decodingFunction,useNative=null,useHasOwn=!!{}.hasOwnProperty,isNative=function(){if(useNative===null){useNative=Ext.USE_NATIVE_JSON&&window.JSON&&JSON.toString()=="[object JSON]"}return useNative},pad=function(n){return n<10?"0"+n:n},doDecode=function(json){return eval("("+json+")")},doEncode=function(o,newline){if(o===null||o===undefined){return"null"}else{if(Ext.isDate(o)){return Ext.JSON.encodeDate(o)}else{if(Ext.isString(o)){return Ext.JSON.encodeString(o)}else{if(typeof o=="number"){return isFinite(o)?String(o):"null"}else{if(Ext.isBoolean(o)){return String(o)}else{if(o.toJSON){return o.toJSON()}else{if(Ext.isArray(o)){return encodeArray(o,newline)}else{if(Ext.isObject(o)){return encodeObject(o,newline)}else{if(typeof o==="function"){return"null"}}}}}}}}}return"undefined"},m={"\b":"\\b","\t":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\","\x0b":"\\u000b"},charToReplace=/[\\\"\x00-\x1f\x7f-\uffff]/g,encodeString=function(s){return'"'+s.replace(charToReplace,function(a){var c=m[a];return typeof c==="string"?c:"\\u"+("0000"+a.charCodeAt(0).toString(16)).slice(-4)})+'"'},encodeArray=function(o,newline){var a=["[",""],len=o.length,i;for(i=0;i<len;i+=1){a.push(Ext.JSON.encodeValue(o[i]),",")}a[a.length-1]="]";return a.join("")},encodeObject=function(o,newline){var a=["{",""],i,val;for(i in o){val=o[i];if(!useHasOwn||o.hasOwnProperty(i)){if(typeof val==="function"||val===undefined){continue}a.push(Ext.JSON.encodeValue(i),":",Ext.JSON.encodeValue(val),",")}}a[a.length-1]="}";return a.join("")};me.encodeString=encodeString;me.encodeValue=doEncode;me.encodeDate=function(o){return'"'+o.getFullYear()+"-"+pad(o.getMonth()+1)+"-"+pad(o.getDate())+"T"+pad(o.getHours())+":"+pad(o.getMinutes())+":"+pad(o.getSeconds())+'"'};me.encode=function(o){if(!encodingFunction){encodingFunction=isNative()?JSON.stringify:me.encodeValue}return encodingFunction(o)};me.decode=function(json,safe){if(!decodingFunction){decodingFunction=isNative()?JSON.parse:doDecode}try{return decodingFunction(json)}catch(e){if(safe===true){return null}Ext.Error.raise({sourceClass:"Ext.JSON",sourceMethod:"decode",msg:"You're trying to decode an invalid JSON String: "+json})}}})());Ext.encode=Ext.JSON.encode;Ext.decode=Ext.JSON.decode;Ext.apply(Ext,{userAgent:navigator.userAgent.toLowerCase(),cache:{},idSeed:1000,windowId:"ext-window",documentId:"ext-document",isReady:false,enableGarbageCollector:true,enableListenerCollection:true,rootHierarchyState:{},addCacheEntry:function(g,c,e){e=e||c.dom;var a=Ext.cache,b=g||(c&&c.id)||e.id,d=a[b]||(a[b]={data:{},events:{},dom:e,skipGarbageCollection:!!(e.getElementById||e.navigator)});if(c){c.$cache=d;d.el=c}return d},updateCacheEntry:function(a,b){a.dom=b;if(a.el){a.el.dom=b}return a},id:function(a,c){var b=this,d="";a=Ext.getDom(a,true)||{};if(a===document){a.id=b.documentId}else{if(a===window){a.id=b.windowId}}if(!a.id){if(b.isSandboxed){d=Ext.sandboxName.toLowerCase()+"-"}a.id=d+(c||"ext-gen")+(++Ext.idSeed)}return a.id},escapeId:(function(){var c=/^[a-zA-Z_][a-zA-Z0-9_\-]*$/i,d=/([\W]{1})/g,b=/^(\d)/g,a=function(h,g){return"\\"+g},e=function(h,g){return"\\00"+g.charCodeAt(0).toString(16)+" "};return function(g){return c.test(g)?g:g.replace(d,a).replace(b,e)}}()),getBody:(function(){var a;return function(){return a||(a=Ext.get(document.body))}}()),getHead:(function(){var a;return function(){return a||(a=Ext.get(document.getElementsByTagName("head")[0]))}}()),getDoc:(function(){var a;return function(){return a||(a=Ext.get(document))}}()),getOrientation:function(){return window.innerHeight>window.innerWidth?"portrait":"landscape"},destroy:function(){var c=arguments.length,b,a;for(b=0;b<c;b++){a=arguments[b];if(a){if(Ext.isArray(a)){this.destroy.apply(this,a)}else{if(Ext.isFunction(a.destroy)){a.destroy()}else{if(a.dom){a.remove()}}}}}},callback:function(d,c,b,a){if(Ext.isFunction(d)){b=b||[];c=c||window;if(a){Ext.defer(d,a,c,b)}else{d.apply(c,b)}}},htmlEncode:function(a){return Ext.String.htmlEncode(a)},htmlDecode:function(a){return Ext.String.htmlDecode(a)},urlAppend:function(a,b){return Ext.String.urlAppend(a,b)}});Ext.ns=Ext.namespace;window.undefined=window.undefined;(function(){var p=function(e){return e.test(Ext.userAgent)},u=document.compatMode=="CSS1Compat",G=function(S,R){var e;return(S&&(e=R.exec(Ext.userAgent)))?parseFloat(e[1]):0},q=document.documentMode,a=p(/opera/),w=a&&p(/version\/10\.5/),L=p(/\bchrome\b/),A=p(/webkit/),c=!L&&p(/safari/),J=c&&p(/applewebkit\/4/),H=c&&p(/version\/3/),E=c&&p(/version\/4/),k=c&&p(/version\/5\.0/),D=c&&p(/version\/5/),j=!a&&p(/msie/),K=j&&((p(/msie 7/)&&q!=8&&q!=9&&q!=10)||q==7),I=j&&((p(/msie 8/)&&q!=7&&q!=9&&q!=10)||q==8),F=j&&((p(/msie 9/)&&q!=7&&q!=8&&q!=10)||q==9),h=j&&((p(/msie 10/)&&q!=7&&q!=8&&q!=9)||q==10),N=j&&p(/msie 6/),b=!A&&p(/gecko/),Q=b&&p(/rv:1\.9/),P=b&&p(/rv:2\.0/),O=b&&p(/rv:5\./),s=b&&p(/rv:10\./),z=Q&&p(/rv:1\.9\.0/),x=Q&&p(/rv:1\.9\.1/),v=Q&&p(/rv:1\.9\.2/),g=p(/windows|win32/),C=p(/macintosh|mac os x/),y=p(/linux/),m=null,n=G(true,/\bchrome\/(\d+\.\d+)/),i=G(true,/\bfirefox\/(\d+\.\d+)/),o=G(j,/msie (\d+\.\d+)/),t=G(a,/version\/(\d+\.\d+)/),d=G(c,/version\/(\d+\.\d+)/),B=G(A,/webkit\/(\d+\.\d+)/),r=/^https/i.test(window.location.protocol),l;try{document.execCommand("BackgroundImageCache",false,true)}catch(M){}l=function(){};l.info=l.warn=l.error=Ext.emptyFn;Ext.setVersion("extjs","4.2.0.663");Ext.apply(Ext,{SSL_SECURE_URL:r&&j?"javascript:''":"about:blank",plainTableCls:Ext.buildSettings.baseCSSPrefix+"table-plain",plainListCls:Ext.buildSettings.baseCSSPrefix+"list-plain",enableNestedListenerRemoval:false,USE_NATIVE_JSON:false,getDom:function(S,R){if(!S||!document){return null}if(S.dom){return S.dom}else{if(typeof S=="string"){var T=Ext.getElementById(S);if(T&&j&&R){if(S==T.getAttribute("id")){return T}else{return null}}return T}else{return S}}},removeNode:N||K||I?(function(){var e;return function(T){if(T&&T.tagName.toUpperCase()!="BODY"){(Ext.enableNestedListenerRemoval)?Ext.EventManager.purgeElement(T):Ext.EventManager.removeAll(T);var R=Ext.cache,S=T.id;if(R[S]){delete R[S].dom;delete R[S]}if(I&&T.parentNode){T.parentNode.removeChild(T)}e=e||document.createElement("div");e.appendChild(T);e.innerHTML=""}}}()):function(S){if(S&&S.parentNode&&S.tagName.toUpperCase()!="BODY"){(Ext.enableNestedListenerRemoval)?Ext.EventManager.purgeElement(S):Ext.EventManager.removeAll(S);var e=Ext.cache,R=S.id;if(e[R]){delete e[R].dom;delete e[R]}S.parentNode.removeChild(S)}},isStrict:u,isIEQuirks:j&&(!u&&(N||K||I||F)),isOpera:a,isOpera10_5:w,isWebKit:A,isChrome:L,isSafari:c,isSafari3:H,isSafari4:E,isSafari5:D,isSafari5_0:k,isSafari2:J,isIE:j,isIE6:N,isIE7:K,isIE7m:N||K,isIE7p:j&&!N,isIE8:I,isIE8m:N||K||I,isIE8p:j&&!(N||K),isIE9:F,isIE9m:N||K||I||F,isIE9p:j&&!(N||K||I),isIE10:h,isIE10m:N||K||I||F||h,isIE10p:j&&!(N||K||I||F),isGecko:b,isGecko3:Q,isGecko4:P,isGecko5:O,isGecko10:s,isFF3_0:z,isFF3_5:x,isFF3_6:v,isFF4:4<=i&&i<5,isFF5:5<=i&&i<6,isFF10:10<=i&&i<11,isLinux:y,isWindows:g,isMac:C,chromeVersion:n,firefoxVersion:i,ieVersion:o,operaVersion:t,safariVersion:d,webKitVersion:B,isSecure:r,BLANK_IMAGE_URL:(N||K)?"//www.sencha.com/s.gif":"data:image/gif;base64,R0lGODlhAQABAID/AMDAwAAAACH5BAEAAAAALAAAAAABAAEAAAICRAEAOw==",value:function(S,e,R){return Ext.isEmpty(S,R)?e:S},escapeRe:function(e){return e.replace(/([-.*+?\^${}()|\[\]\/\\])/g,"\\$1")},addBehaviors:function(U){if(!Ext.isReady){Ext.onReady(function(){Ext.addBehaviors(U)})}else{var R={},T,e,S;for(e in U){if((T=e.split("@"))[1]){S=T[0];if(!R[S]){R[S]=Ext.select(S)}R[S].on(T[1],U[e])}}R=null}},getScrollbarSize:function(R){if(!Ext.isReady){return{}}if(R||!m){var e=document.body,S=document.createElement("div");S.style.width=S.style.height="100px";S.style.overflow="scroll";S.style.position="absolute";e.appendChild(S);m={width:S.offsetWidth-S.clientWidth,height:S.offsetHeight-S.clientHeight};e.removeChild(S)}return m},getScrollBarWidth:function(R){var e=Ext.getScrollbarSize(R);return e.width+2},copyTo:function(R,T,V,U){if(typeof V=="string"){V=V.split(/[,;\s]/)}var W,S=V?V.length:0,e;for(W=0;W<S;W++){e=V[W];if(U||T.hasOwnProperty(e)){R[e]=T[e]}}return R},destroyMembers:function(T){for(var S=1,R=arguments,e=R.length;S<e;S++){Ext.destroy(T[R[S]]);delete T[R[S]]}},log:l,partition:function(e,U){var V=[[],[]],R,T,S=e.length;for(R=0;R<S;R++){T=e[R];V[(U&&U(T,R,e))||(!U&&T)?0:1].push(T)}return V},invoke:function(e,U){var W=[],V=Array.prototype.slice.call(arguments,2),R,T,S=e.length;for(R=0;R<S;R++){T=e[R];if(T&&typeof T[U]=="function"){W.push(T[U].apply(T,V))}else{W.push(undefined)}}return W},zip:function(){var X=Ext.partition(arguments,function(Y){return typeof Y!="function"}),U=X[0],W=X[1][0],e=Ext.max(Ext.pluck(U,"length")),T=[],V,S,R;for(V=0;V<e;V++){T[V]=[];if(W){T[V]=W.apply(W,Ext.pluck(U,V))}else{for(S=0,R=U.length;S<R;S++){T[V].push(U[S][V])}}}return T},toSentence:function(R,e){var U=R.length,T,S;if(U<=1){return R[0]}else{T=R.slice(0,U-1);S=R[U-1];return Ext.util.Format.format("{0} {1} {2}",T.join(", "),e||"and",S)}},setGlyphFontFamily:function(e){Ext._glyphFontFamily=e},useShims:N})}());Ext.application=function(a){var c,d,b;if(typeof a==="string"){Ext.require(a,function(){c=Ext.ClassManager.get(a)})}else{Ext.Loader.setPath(a.name,a.appFolder||"app");if(d=a.paths){for(b in d){if(d.hasOwnProperty(b)){Ext.Loader.setPath(b,d[b])}}}a["paths processed"]=true;Ext.define(a.name+".$application",Ext.apply({extend:"Ext.app.Application"},a),function(){c=this})}Ext.onReady(function(){Ext.app.Application.instance=new c()})};(function(){Ext.ns("Ext.util");Ext.util.Format={};var g=Ext.util.Format,e=/<\/?[^>]+>/gi,c=/(?:<script.*?>)((\n|\r|.)*?)(?:<\/script>)/ig,b=/\r?\n/g,d=/[^\d\.]/g,a;Ext.apply(g,{thousandSeparator:",",decimalSeparator:".",currencyPrecision:2,currencySign:"$",currencyAtEnd:false,undef:function(h){return h!==undefined?h:""},defaultValue:function(i,h){return i!==undefined&&i!==""?i:h},substr:"ab".substr(-1)!="b"?function(i,k,h){var j=String(i);return(k<0)?j.substr(Math.max(j.length+k,0),h):j.substr(k,h)}:function(i,j,h){return String(i).substr(j,h)},lowercase:function(h){return String(h).toLowerCase()},uppercase:function(h){return String(h).toUpperCase()},usMoney:function(h){return g.currency(h,"$",2)},currency:function(k,m,j,h){var o="",n=",0",l=0;k=k-0;if(k<0){k=-k;o="-"}j=Ext.isDefined(j)?j:g.currencyPrecision;n+=n+(j>0?".":"");for(;l<j;l++){n+="0"}k=g.number(k,n);if((h||g.currencyAtEnd)===true){return Ext.String.format("{0}{1}{2}",o,k,m||g.currencySign)}else{return Ext.String.format("{0}{1}{2}",o,m||g.currencySign,k)}},date:function(h,i){if(!h){return""}if(!Ext.isDate(h)){h=new Date(Date.parse(h))}return Ext.Date.dateFormat(h,i||Ext.Date.defaultFormat)},dateRenderer:function(h){return function(i){return g.date(i,h)}},stripTags:function(h){return !h?h:String(h).replace(e,"")},stripScripts:function(h){return !h?h:String(h).replace(c,"")},fileSize:function(h){if(h<1024){return h+" bytes"}else{if(h<1048576){return(Math.round(((h*10)/1024))/10)+" KB"}else{return(Math.round(((h*10)/1048576))/10)+" MB"}}},math:(function(){var h={};return function(j,i){if(!h[i]){h[i]=Ext.functionFactory("v","return v "+i+";")}return h[i](j)}}()),round:function(j,i){var h=Number(j);if(typeof i=="number"){i=Math.pow(10,i);h=Math.round(j*i)/i}return h},number:function(y,s){if(!s){return y}y=Ext.Number.from(y,NaN);if(isNaN(y)){return""}var z=g.thousandSeparator,q=g.decimalSeparator,r=y<0,k,h,x,w,p,t,o,l,u;y=Math.abs(y);if(s.substr(s.length-2)=="/i"){if(!a){a=new RegExp("[^\\d\\"+g.decimalSeparator+"]","g")}s=s.substr(0,s.length-2);k=s.indexOf(z)!=-1;h=s.replace(a,"").split(q)}else{k=s.indexOf(",")!=-1;h=s.replace(d,"").split(".")}if(h.length>2){}else{if(h.length>1){y=Ext.Number.toFixed(y,h[1].length)}else{y=Ext.Number.toFixed(y,0)}}x=y.toString();h=x.split(".");if(k){w=h[0];p=[];t=w.length;o=Math.floor(t/3);l=w.length%3||3;for(u=0;u<t;u+=l){if(u!==0){l=3}p[p.length]=w.substr(u,l);o-=1}x=p.join(z);if(h[1]){x+=q+h[1]}}else{if(h[1]){x=h[0]+q+h[1]}}if(r){r=x.replace(/[^1-9]/g,"")!==""}return(r?"-":"")+s.replace(/[\d,?\.?]+/,x)},numberRenderer:function(h){return function(i){return g.number(i,h)}},attributes:function(i){if(typeof i==="object"){var h=[],j;for(j in i){h.push(j,'="',j==="style"?Ext.DomHelper.generateStyles(i[j]):Ext.htmlEncode(i[j]),'"')}i=h.join("")}return i||""},plural:function(h,i,j){return h+" "+(h==1?i:(j?j:i+"s"))},nl2br:function(h){return Ext.isEmpty(h)?"":h.replace(b,"<br/>")},capitalize:Ext.String.capitalize,ellipsis:Ext.String.ellipsis,format:Ext.String.format,htmlDecode:Ext.String.htmlDecode,htmlEncode:Ext.String.htmlEncode,leftPad:Ext.String.leftPad,trim:Ext.String.trim,parseBox:function(i){i=i||0;if(typeof i==="number"){return{top:i,right:i,bottom:i,left:i}}var j=i.split(" "),h=j.length;if(h==1){j[1]=j[2]=j[3]=j[0]}else{if(h==2){j[2]=j[0];j[3]=j[1]}else{if(h==3){j[3]=j[1]}}}return{top:parseInt(j[0],10)||0,right:parseInt(j[1],10)||0,bottom:parseInt(j[2],10)||0,left:parseInt(j[3],10)||0}},escapeRegex:function(h){return h.replace(/([\-.*+?\^${}()|\[\]\/\\])/g,"\\$1")}})}());Ext.define("Ext.util.TaskRunner",{interval:10,timerId:null,constructor:function(a){var b=this;if(typeof a=="number"){b.interval=a}else{if(a){Ext.apply(b,a)}}b.tasks=[];b.timerFn=Ext.Function.bind(b.onTick,b)},newTask:function(b){var a=new Ext.util.TaskRunner.Task(b);a.manager=this;return a},start:function(a){var c=this,b=new Date().getTime();if(!a.pending){c.tasks.push(a);a.pending=true}a.stopped=false;a.taskStartTime=b;a.taskRunTime=a.fireOnStart!==false?0:a.taskStartTime;a.taskRunCount=0;if(!c.firing){if(a.fireOnStart!==false){c.startTimer(0,b)}else{c.startTimer(a.interval,b)}}return a},stop:function(a){if(!a.stopped){a.stopped=true;if(a.onStop){a.onStop.call(a.scope||a,a)}}return a},stopAll:function(){Ext.each(this.tasks,this.stop,this)},firing:false,nextExpires:1e+99,onTick:function(){var m=this,e=m.tasks,a=new Date().getTime(),n=1e+99,k=e.length,c,o,h,b,d,g;m.timerId=null;m.firing=true;for(h=0;h<k||h<(k=e.length);++h){b=e[h];if(!(g=b.stopped)){c=b.taskRunTime+b.interval;if(c<=a){d=1;try{d=b.run.apply(b.scope||b,b.args||[++b.taskRunCount])}catch(j){try{if(b.onError){d=b.onError.call(b.scope||b,b,j)}}catch(l){}}b.taskRunTime=a;if(d===false||b.taskRunCount===b.repeat){m.stop(b);g=true}else{g=b.stopped;c=a+b.interval}}if(!g&&b.duration&&b.duration<=(a-b.taskStartTime)){m.stop(b);g=true}}if(g){b.pending=false;if(!o){o=e.slice(0,h)}}else{if(o){o.push(b)}if(n>c){n=c}}}if(o){m.tasks=o}m.firing=false;if(m.tasks.length){m.startTimer(n-a,new Date().getTime())}if(m.fireIdleEvent!==false){Ext.EventManager.idleEvent.fire()}},startTimer:function(e,c){var d=this,b=c+e,a=d.timerId;if(a&&d.nextExpires-b>d.interval){clearTimeout(a);a=null}if(!a){if(e<d.interval){e=d.interval}d.timerId=setTimeout(d.timerFn,e);d.nextExpires=b}}},function(){var b=this,a=b.prototype;a.destroy=a.stopAll;Ext.util.TaskManager=Ext.TaskManager=new b();b.Task=new Ext.Class({isTask:true,stopped:true,fireOnStart:false,constructor:function(c){Ext.apply(this,c)},restart:function(c){if(c!==undefined){this.interval=c}this.manager.start(this)},start:function(c){if(this.stopped){this.restart(c)}},stop:function(){this.manager.stop(this)}});a=b.Task.prototype;a.destroy=a.stop});Ext.define("Ext.util.TaskManager",{extend:Ext.util.TaskRunner,alternateClassName:["Ext.TaskManager"],singleton:true});Ext.define("Ext.perf.Accumulator",(function(){var c=null,h=Ext.global.chrome,d,b=function(){b=function(){return new Date().getTime()};var l,m;if(Ext.isChrome&&h&&h.Interval){l=new h.Interval();l.start();b=function(){return l.microseconds()/1000}}else{if(window.ActiveXObject){try{m=new ActiveXObject("SenchaToolbox.Toolbox");Ext.senchaToolbox=m;b=function(){return m.milliseconds}}catch(n){}}else{if(Date.now){b=Date.now}}}Ext.perf.getTimestamp=Ext.perf.Accumulator.getTimestamp=b;return b()};function i(m,l){m.sum+=l;m.min=Math.min(m.min,l);m.max=Math.max(m.max,l)}function e(o){var m=o?o:(b()-this.time),n=this,l=n.accum;++l.count;if(!--l.depth){i(l.total,m)}i(l.pure,m-n.childTime);c=n.parent;if(c){++c.accum.childCount;c.childTime+=m}}function a(){return{min:Number.MAX_VALUE,max:0,sum:0}}function j(m,l){return function(){var o=m.enter(),n=l.apply(this,arguments);o.leave();return n}}function k(l){return Math.round(l*100)/100}function g(n,m,l,p){var o={avg:0,min:p.min,max:p.max,sum:0};if(n){l=l||0;o.sum=p.sum-m*l;o.avg=o.sum/n}return o}return{constructor:function(l){var m=this;m.count=m.childCount=m.depth=m.maxDepth=0;m.pure=a();m.total=a();m.name=l},statics:{getTimestamp:b},format:function(l){if(!d){d=new Ext.XTemplate(["{name} - {count} call(s)",'<tpl if="count">','<tpl if="childCount">'," ({childCount} children)","</tpl>",'<tpl if="depth - 1">'," ({depth} deep)","</tpl>",'<tpl for="times">',", {type}: {[this.time(values.sum)]} msec (","avg={[this.time(values.sum / parent.count)]}",")","</tpl>","</tpl>"].join(""),{time:function(n){return Math.round(n*100)/100}})}var m=this.getData(l);m.name=this.name;m.pure.type="Pure";m.total.type="Total";m.times=[m.pure,m.total];return d.apply(m)},getData:function(l){var m=this;return{count:m.count,childCount:m.childCount,depth:m.maxDepth,pure:g(m.count,m.childCount,l,m.pure),total:g(m.count,m.childCount,l,m.total)}},enter:function(){var l=this,m={accum:l,leave:e,childTime:0,parent:c};++l.depth;if(l.maxDepth<l.depth){l.maxDepth=l.depth}c=m;m.time=b();return m},monitor:function(n,m,l){var o=this.enter();if(l){n.apply(m,l)}else{n.call(m)}o.leave()},report:function(){Ext.log(this.format())},tap:function(t,v){var u=this,o=typeof v=="string"?[v]:v,s,w,q,p,n,m,l,r;r=function(){if(typeof t=="string"){s=Ext.global;p=t.split(".");for(q=0,n=p.length;q<n;++q){s=s[p[q]]}}else{s=t}for(q=0,n=o.length;q<n;++q){m=o[q];w=m.charAt(0)=="!";if(w){m=m.substring(1)}else{w=!(m in s.prototype)}l=w?s:s.prototype;l[m]=j(u,l[m])}};Ext.ClassManager.onCreated(r,u,t);return u}}}()),function(){Ext.perf.getTimestamp=this.getTimestamp});Ext.define("Ext.perf.Monitor",{singleton:true,alternateClassName:"Ext.Perf",constructor:function(){this.accumulators=[];this.accumulatorsByName={}},calibrate:function(){var b=new Ext.perf.Accumulator("$"),g=b.total,c=Ext.perf.Accumulator.getTimestamp,e=0,h,a,d;d=c();do{h=b.enter();h.leave();++e}while(g.sum<100);a=c();return(a-d)/e},get:function(b){var c=this,a=c.accumulatorsByName[b];if(!a){c.accumulatorsByName[b]=a=new Ext.perf.Accumulator(b);c.accumulators.push(a)}return a},enter:function(a){return this.get(a).enter()},monitor:function(a,c,b){this.get(a).monitor(c,b)},report:function(){var c=this,b=c.accumulators,a=c.calibrate();b.sort(function(e,d){return(e.name<d.name)?-1:((d.name<e.name)?1:0)});c.updateGC();Ext.log("Calibration: "+Math.round(a*100)/100+" msec/sample");Ext.each(b,function(d){Ext.log(d.format(a))})},getData:function(c){var b={},a=this.accumulators;Ext.each(a,function(d){if(c||d.count){b[d.name]=d.getData()}});return b},reset:function(){Ext.each(this.accumulators,function(a){var b=a;b.count=b.childCount=b.depth=b.maxDepth=0;b.pure={min:Number.MAX_VALUE,max:0,sum:0};b.total={min:Number.MAX_VALUE,max:0,sum:0}})},updateGC:function(){var a=this.accumulatorsByName.GC,b=Ext.senchaToolbox,c;if(a){a.count=b.garbageCollectionCounter||0;if(a.count){c=a.pure;a.total.sum=c.sum=b.garbageCollectionMilliseconds;c.min=c.max=c.sum/a.count;c=a.total;c.min=c.max=c.sum/a.count}}},watchGC:function(){Ext.perf.getTimestamp();var a=Ext.senchaToolbox;if(a){this.get("GC");a.watchGarbageCollector(false)}},setup:function(c){if(!c){c={render:{"Ext.AbstractComponent":"render"},layout:{"Ext.layout.Context":"run"}}}this.currentConfig=c;var d,g,b,e,a;for(d in c){if(c.hasOwnProperty(d)){g=c[d];b=Ext.Perf.get(d);for(e in g){if(g.hasOwnProperty(e)){a=g[e];b.tap(e,a)}}}}this.watchGC()}});Ext.is={init:function(b){var c=this.platforms,e=c.length,d,a;b=b||window.navigator;for(d=0;d<e;d++){a=c[d];this[a.identity]=a.regex.test(b[a.property])}this.Desktop=this.Mac||this.Windows||(this.Linux&&!this.Android);this.Tablet=this.iPad;this.Phone=!this.Desktop&&!this.Tablet;this.iOS=this.iPhone||this.iPad||this.iPod;this.Standalone=!!window.navigator.standalone},platforms:[{property:"platform",regex:/iPhone/i,identity:"iPhone"},{property:"platform",regex:/iPod/i,identity:"iPod"},{property:"userAgent",regex:/iPad/i,identity:"iPad"},{property:"userAgent",regex:/Blackberry/i,identity:"Blackberry"},{property:"userAgent",regex:/Android/i,identity:"Android"},{property:"platform",regex:/Mac/i,identity:"Mac"},{property:"platform",regex:/Win/i,identity:"Windows"},{property:"platform",regex:/Linux/i,identity:"Linux"}]};Ext.is.init();(function(){var a=function(g,e){var d=g.ownerDocument.defaultView,h=(d?d.getComputedStyle(g,null):g.currentStyle)||g.style;return h[e]},c={"IE6-quirks":[0,1,0,0,1,0,0,0,1,0,0,0,0,0,0,0,1,1,0,0,0,0,1,0,0,1,0,0,1,0,1,0,0],"IE6-strict":[0,1,0,0,1,0,0,0,1,0,0,0,0,0,0,0,1,1,0,0,0,0,1,0,1,1,0,0,1,0,1,0,0],"IE7-quirks":[0,1,0,0,1,0,0,0,1,0,0,0,0,0,0,0,1,1,0,0,0,0,1,0,0,1,0,0,1,0,1,0,0],"IE7-strict":[0,1,0,0,1,0,0,0,1,0,0,0,0,0,0,0,1,1,0,0,0,0,1,1,0,1,0,0,1,0,1,0,0],"IE8-quirks":[0,1,0,0,1,0,0,0,1,0,0,0,0,0,0,0,1,1,0,0,0,0,1,0,0,1,0,0,1,0,1,0,0],"IE8-strict":[0,1,0,0,1,0,0,0,1,0,0,0,0,0,0,0,1,1,0,0,0,0,1,1,1,1,0,0,1,0,1,0,0],"IE9-quirks":[0,1,0,0,1,0,0,0,1,0,0,0,0,0,0,0,1,1,1,0,0,0,1,0,0,1,0,0,1,0,1,0,0],"IE9-strict":[0,1,0,0,1,1,1,1,1,1,1,0,0,0,1,1,1,1,1,0,1,1,1,1,1,1,1,0,1,0,0,0,0],"IE10-quirks":[1,1,0,0,1,1,1,1,0,1,1,1,0,0,1,1,1,1,1,1,0,1,0,1,1,1,1,1,1,0,0,0],"IE10-strict":[1,1,0,0,1,1,1,1,0,1,1,1,0,0,1,1,1,1,1,1,0,1,0,1,1,1,1,1,1,0,0,0]};function b(){var d=Ext.isIE6?"IE6":Ext.isIE7?"IE7":Ext.isIE8?"IE8":Ext.isIE9?"IE9":Ext.isIE10?"IE10":"";return d?d+(Ext.isStrict?"-strict":"-quirks"):""}Ext.supports={init:function(){var k=this,o=document,i=k.toRun||k.tests,h=i.length,d=h&&Ext.isReady&&o.createElement("div"),e=[],l=b(),j,g,m;if(d){d.innerHTML=['<div style="height:30px;width:50px;">','<div style="height:20px;width:20px;"></div>',"</div>",'<div style="width: 200px; height: 200px; position: relative; padding: 5px;">','<div style="position: absolute; top: 0; left: 0; width: 100%; height: 100%;"></div>',"</div>",'<div style="position: absolute; left: 10%; top: 10%;"></div>','<div style="float:left; background-color:transparent;"></div>'].join("");o.body.appendChild(d)}g=c[l];while(h--){j=i[h];m=g&&g[h];if(m!==undefined){k[j.identity]=m}else{if(d||j.early){k[j.identity]=j.fn.call(k,o,d)}else{e.push(j)}}}if(d){o.body.removeChild(d)}k.toRun=e},PointerEvents:"pointerEvents" in document.documentElement.style,LocalStorage:(function(){try{return"localStorage" in window&&window.localStorage!==null}catch(d){return false}})(),CSS3BoxShadow:"boxShadow" in document.documentElement.style||"WebkitBoxShadow" in document.documentElement.style||"MozBoxShadow" in document.documentElement.style,ClassList:!!document.documentElement.classList,OrientationChange:((typeof window.orientation!="undefined")&&("onorientationchange" in window)),DeviceMotion:("ondevicemotion" in window),Touch:("ontouchstart" in window)&&(!Ext.is.Desktop),TimeoutActualLateness:(function(){setTimeout(function(){Ext.supports.TimeoutActualLateness=arguments.length!==0},0)}()),tests:[{identity:"Transitions",fn:function(k,m){var j=["webkit","Moz","o","ms","khtml"],l="TransitionEnd",d=[j[0]+l,"transitionend",j[2]+l,j[3]+l,j[4]+l],h=j.length,g=0,e=false;for(;g<h;g++){if(a(m,j[g]+"TransitionProperty")){Ext.supports.CSS3Prefix=j[g];Ext.supports.CSS3TransitionEnd=d[g];e=true;break}}return e}},{identity:"RightMargin",fn:function(e,g){var d=e.defaultView;return !(d&&d.getComputedStyle(g.firstChild.firstChild,null).marginRight!="0px")}},{identity:"DisplayChangeInputSelectionBug",early:true,fn:function(){var d=Ext.webKitVersion;return 0<d&&d<533}},{identity:"DisplayChangeTextAreaSelectionBug",early:true,fn:function(){var d=Ext.webKitVersion;return 0<d&&d<534.24}},{identity:"TransparentColor",fn:function(e,g,d){d=e.defaultView;return !(d&&d.getComputedStyle(g.lastChild,null).backgroundColor!="transparent")}},{identity:"ComputedStyle",fn:function(e,g,d){d=e.defaultView;return d&&d.getComputedStyle}},{identity:"Svg",fn:function(d){return !!d.createElementNS&&!!d.createElementNS("http://www.w3.org/2000/svg","svg").createSVGRect}},{identity:"Canvas",fn:function(d){return !!d.createElement("canvas").getContext}},{identity:"Vml",fn:function(e){var g=e.createElement("div");g.innerHTML="<!--[if vml]><br/><br/><![endif]-->";return(g.childNodes.length==2)}},{identity:"Float",fn:function(d,e){return !!e.lastChild.style.cssFloat}},{identity:"AudioTag",fn:function(d){return !!d.createElement("audio").canPlayType}},{identity:"History",fn:function(){var d=window.history;return !!(d&&d.pushState)}},{identity:"CSS3DTransform",fn:function(){return(typeof WebKitCSSMatrix!="undefined"&&new WebKitCSSMatrix().hasOwnProperty("m41"))}},{identity:"CSS3LinearGradient",fn:function(j,d){var l="background-image:",k="-webkit-gradient(linear, left top, right bottom, from(black), to(white))",i="linear-gradient(left top, black, white)",h="-moz-"+i,e="-ms-"+i,g="-o-"+i,m=[l+k,l+i,l+h,l+e,l+g];d.style.cssText=m.join(";");return((""+d.style.backgroundImage).indexOf("gradient")!==-1)&&!Ext.isIE9}},{identity:"CSS3BorderRadius",fn:function(h,j){var e=["borderRadius","BorderRadius","MozBorderRadius","WebkitBorderRadius","OBorderRadius","KhtmlBorderRadius"],g=false,d;for(d=0;d<e.length;d++){if(document.body.style[e[d]]!==undefined){return true}}return g}},{identity:"GeoLocation",fn:function(){return(typeof navigator!="undefined"&&"geolocation" in navigator)||(typeof google!="undefined"&&typeof google.gears!="undefined")}},{identity:"MouseEnterLeave",fn:function(d,e){return("onmouseenter" in e&&"onmouseleave" in e)}},{identity:"MouseWheel",fn:function(d,e){return("onmousewheel" in e)}},{identity:"Opacity",fn:function(d,e){if(Ext.isIE6||Ext.isIE7||Ext.isIE8){return false}e.firstChild.style.cssText="opacity:0.73";return e.firstChild.style.opacity=="0.73"}},{identity:"Placeholder",fn:function(d){return"placeholder" in d.createElement("input")}},{identity:"Direct2DBug",fn:function(){return Ext.isString(document.body.style.msTransformOrigin)&&Ext.isIE10m}},{identity:"BoundingClientRect",fn:function(d,e){return Ext.isFunction(e.getBoundingClientRect)}},{identity:"RotatedBoundingClientRect",fn:function(){var d=document.body,e=false,h=document.createElement("div"),g=h.style;if(h.getBoundingClientRect){g.WebkitTransform=g.MozTransform=g.OTransform=g.transform="rotate(90deg)";g.width="100px";g.height="30px";d.appendChild(h);e=h.getBoundingClientRect().height!==100;d.removeChild(h)}return e}},{identity:"IncludePaddingInWidthCalculation",fn:function(d,e){return e.childNodes[1].firstChild.offsetWidth==210}},{identity:"IncludePaddingInHeightCalculation",fn:function(d,e){return e.childNodes[1].firstChild.offsetHeight==210}},{identity:"ArraySort",fn:function(){var d=[1,2,3,4,5].sort(function(){return 0});return d[0]===1&&d[1]===2&&d[2]===3&&d[3]===4&&d[4]===5}},{identity:"Range",fn:function(){return !!document.createRange}},{identity:"CreateContextualFragment",fn:function(){var d=Ext.supports.Range?document.createRange():false;return d&&!!d.createContextualFragment}},{identity:"WindowOnError",fn:function(){return Ext.isIE||Ext.isGecko||Ext.webKitVersion>=534.16}},{identity:"TextAreaMaxLength",fn:function(){var d=document.createElement("textarea");return("maxlength" in d)}},{identity:"GetPositionPercentage",fn:function(d,e){return a(e.childNodes[2],"left")=="10%"}},{identity:"PercentageHeightOverflowBug",fn:function(h){var d=false,g,e;if(Ext.getScrollbarSize().height){e=h.createElement("div");g=e.style;g.height="50px";g.width="50px";g.overflow="auto";g.position="absolute";e.innerHTML=['<div style="display:table;height:100%;">','<div style="width:51px;"></div>',"</div>"].join("");h.body.appendChild(e);if(e.firstChild.offsetHeight===50){d=true}h.body.removeChild(e)}return d}},{identity:"xOriginBug",fn:function(h,i){i.innerHTML='<div id="b1" style="height:100px;width:100px;direction:rtl;position:relative;overflow:scroll"><div id="b2" style="position:relative;width:100%;height:20px;"></div><div id="b3" style="position:absolute;width:20px;height:20px;top:0px;right:0px"></div></div>';var g=document.getElementById("b1").getBoundingClientRect(),e=document.getElementById("b2").getBoundingClientRect(),d=document.getElementById("b3").getBoundingClientRect();return(e.left!==g.left&&d.right!==g.right)}}]}}());Ext.supports.init();Ext.util.DelayedTask=function(e,d,b,h){var g=this,i,a,c=function(){clearInterval(i);i=null;e.apply(d,b||[]);Ext.EventManager.idleEvent.fire()};h=typeof h==="boolean"?h:true;g.delay=function(k,m,l,j){if(h){g.cancel()}a=k||a,e=m||e;d=l||d;b=j||b;if(!i){i=setInterval(c,a)}};g.cancel=function(){if(i){clearInterval(i);i=null}}};Ext.define("Ext.util.Event",function(){var d=Array.prototype.slice,a=Ext.Array.insert,b=Ext.Array.toArray,c=Ext.util.DelayedTask;return{isEvent:true,suspended:0,noOptions:{},constructor:function(g,e){this.name=e;this.observable=g;this.listeners=[]},addListener:function(p,r,t){var n=this,o,j,q,e,s,m,h,l,k,g;r=r||n.observable;if(!n.isListening(p,r)){j=n.createListener(p,r,t);if(n.firing){n.listeners=n.listeners.slice(0)}o=n.listeners;l=h=o.length;q=t&&t.priority;s=n._highestNegativePriorityIndex;m=(s!==undefined);if(q){e=(q<0);if(!e||m){for(k=(e?s:0);k<h;k++){g=o[k].o?o[k].o.priority||0:0;if(g<q){l=k;break}}}else{n._highestNegativePriorityIndex=l}}else{if(m){l=s}}if(!e&&l<=s){n._highestNegativePriorityIndex++}if(l===h){n.listeners[h]=j}else{a(n.listeners,l,[j])}}},createListener:function(h,g,k){g=g||this.observable;var i=this,j={fn:h,scope:g,ev:i},e=h;if(k){j.o=k;if(k.single){e=i.createSingle(e,j,k,g)}if(k.target){e=i.createTargeted(e,j,k,g)}if(k.delay){e=i.createDelayed(e,j,k,g)}if(k.buffer){e=i.createBuffered(e,j,k,g)}}j.fireFn=e;return j},findListener:function(k,j){var h=this.listeners,e=h.length,l,g;while(e--){l=h[e];if(l){g=l.scope;if(l.fn==k&&(g==(j||this.observable))){return e}}}return -1},isListening:function(g,e){return this.findListener(g,e)!==-1},removeListener:function(i,h){var j=this,g,m,l,e;g=j.findListener(i,h);if(g!=-1){m=j.listeners[g];l=j._highestNegativePriorityIndex;if(j.firing){j.listeners=j.listeners.slice(0)}if(m.task){m.task.cancel();delete m.task}e=m.tasks&&m.tasks.length;if(e){while(e--){m.tasks[e].cancel()}delete m.tasks}j.listeners.splice(g,1);if(l){if(g<l){j._highestNegativePriorityIndex--}else{if(g===l&&g===j.listeners.length){delete j._highestNegativePriorityIndex}}}return true}return false},clearListeners:function(){var g=this.listeners,e=g.length;while(e--){this.removeListener(g[e].fn,g[e].scope)}},suspend:function(){this.suspended+=1},resume:function(){if(this.suspended){this.suspended--}},fire:function(){var l=this,j=l.listeners,k=j.length,h,g,m,e;if(!l.suspended&&k>0){l.firing=true;g=arguments.length?d.call(arguments,0):[];e=g.length;for(h=0;h<k;h++){m=j[h];if(m.o){g[e]=m.o}if(m&&m.fireFn.apply(m.scope||l.observable,g)===false){return(l.firing=false)}}}l.firing=false;return true},createTargeted:function(g,h,i,e){return function(){if(i.target===arguments[0]){g.apply(e,arguments)}}},createBuffered:function(g,h,i,e){h.task=new c();return function(){h.task.delay(i.buffer,g,e,b(arguments))}},createDelayed:function(g,h,i,e){return function(){var j=new c();if(!h.tasks){h.tasks=[]}h.tasks.push(j);j.delay(i.delay||10,g,e,b(arguments))}},createSingle:function(g,h,i,e){return function(){var j=h.ev;if(j.removeListener(h.fn,e)&&j.observable){j.observable.hasListeners[j.name]--}return g.apply(e,arguments)}}}});Ext.EventManager=new function(){var a=this,g=document,e=window,d=/\\/g,b=Ext.baseCSSPrefix,h,c=function(){var n=g.body||g.getElementsByTagName("body")[0],j=[b+"body"],i=[],k=Ext.supports.CSS3LinearGradient,m=Ext.supports.CSS3BorderRadius,l;if(!n){return false}l=n.parentNode;function o(p){j.push(b+p)}if(Ext.isIE&&Ext.isIE9m){o("ie");if(Ext.isIE6){o("ie6")}else{o("ie7p");if(Ext.isIE7){o("ie7")}else{o("ie8p");if(Ext.isIE8){o("ie8")}else{o("ie9p");if(Ext.isIE9){o("ie9")}}}}if(Ext.isIE7m){o("ie7m")}if(Ext.isIE8m){o("ie8m")}if(Ext.isIE9m){o("ie9m")}if(Ext.isIE7||Ext.isIE8){o("ie78")}}if(Ext.isIE10){o("ie10")}if(Ext.isGecko){o("gecko");if(Ext.isGecko3){o("gecko3")}if(Ext.isGecko4){o("gecko4")}if(Ext.isGecko5){o("gecko5")}}if(Ext.isOpera){o("opera")}if(Ext.isWebKit){o("webkit")}if(Ext.isSafari){o("safari");if(Ext.isSafari2){o("safari2")}if(Ext.isSafari3){o("safari3")}if(Ext.isSafari4){o("safari4")}if(Ext.isSafari5){o("safari5")}if(Ext.isSafari5_0){o("safari5_0")}}if(Ext.isChrome){o("chrome")}if(Ext.isMac){o("mac")}if(Ext.isLinux){o("linux")}if(!m){o("nbr")}if(!k){o("nlg")}if(l){if(Ext.isStrict&&(Ext.isIE6||Ext.isIE7)){Ext.isBorderBox=false}else{Ext.isBorderBox=true}if(Ext.isBorderBox){i.push(b+"border-box")}if(Ext.isStrict){i.push(b+"strict")}else{i.push(b+"quirks")}Ext.fly(l,"_internal").addCls(i)}Ext.fly(n,"_internal").addCls(j);return true};Ext.apply(a,{hasBoundOnReady:false,hasFiredReady:false,deferReadyEvent:1,onReadyChain:[],readyEvent:(function(){h=new Ext.util.Event();h.fire=function(){Ext._beforeReadyTime=Ext._beforeReadyTime||new Date().getTime();h.self.prototype.fire.apply(h,arguments);Ext._afterReadytime=new Date().getTime()};return h}()),idleEvent:new Ext.util.Event(),isReadyPaused:function(){return(/[?&]ext-pauseReadyFire\b/i.test(location.search)&&!Ext._continueFireReady)},bindReadyEvent:function(){if(a.hasBoundOnReady){return}if(g.readyState=="complete"){a.onReadyEvent({type:g.readyState||"body"})}else{g.addEventListener("DOMContentLoaded",a.onReadyEvent,false);e.addEventListener("load",a.onReadyEvent,false);a.hasBoundOnReady=true}},onReadyEvent:function(i){if(i&&i.type){a.onReadyChain.push(i.type)}if(a.hasBoundOnReady){g.removeEventListener("DOMContentLoaded",a.onReadyEvent,false);e.removeEventListener("load",a.onReadyEvent,false)}if(!Ext.isReady){a.fireDocReady()}},fireDocReady:function(){if(!Ext.isReady){Ext._readyTime=new Date().getTime();Ext.isReady=true;Ext.supports.init();a.onWindowUnload();h.onReadyChain=a.onReadyChain;if(Ext.isNumber(a.deferReadyEvent)){Ext.Function.defer(a.fireReadyEvent,a.deferReadyEvent);a.hasDocReadyTimer=true}else{a.fireReadyEvent()}}},fireReadyEvent:function(){a.hasDocReadyTimer=false;a.isFiring=true;while(h.listeners.length&&!a.isReadyPaused()){h.fire()}a.isFiring=false;a.hasFiredReady=true;Ext.EventManager.idleEvent.fire()},onDocumentReady:function(k,j,i){i=i||{};i.single=true;h.addListener(k,j,i);if(!(a.isFiring||a.hasDocReadyTimer)){if(Ext.isReady){a.fireReadyEvent()}else{a.bindReadyEvent()}}},stoppedMouseDownEvent:new Ext.util.Event(),propRe:/^(?:scope|delay|buffer|single|stopEvent|preventDefault|stopPropagation|normalized|args|delegate|freezeEvent)$/,getId:function(i){var j;i=Ext.getDom(i);if(i===g||i===e){j=i===g?Ext.documentId:Ext.windowId}else{j=Ext.id(i)}if(!Ext.cache[j]){Ext.addCacheEntry(j,null,i)}return j},prepareListenerConfig:function(l,j,n){var o=a.propRe,k,m,i;for(k in j){if(j.hasOwnProperty(k)){if(!o.test(k)){m=j[k];if(typeof m=="function"){i=[l,k,m,j.scope,j]}else{i=[l,k,m.fn,m.scope,m]}if(n){a.removeListener.apply(a,i)}else{a.addListener.apply(a,i)}}}}},mouseEnterLeaveRe:/mouseenter|mouseleave/,normalizeEvent:function(i,j){if(a.mouseEnterLeaveRe.test(i)&&!Ext.supports.MouseEnterLeave){if(j){j=Ext.Function.createInterceptor(j,a.contains)}i=i=="mouseenter"?"mouseover":"mouseout"}else{if(i=="mousewheel"&&!Ext.supports.MouseWheel&&!Ext.isOpera){i="DOMMouseScroll"}}return{eventName:i,fn:j}},contains:function(j){j=j.browserEvent||j;var i=j.currentTarget,k=a.getRelatedTarget(j);if(i&&i.firstChild){while(k){if(k===i){return false}k=k.parentNode;if(k&&(k.nodeType!=1)){k=null}}}return true},addListener:function(m,o,q,r,s){if(typeof o!=="string"){a.prepareListenerConfig(m,o);return}var l=m.dom||Ext.getDom(m),p,k,i,j,n;s=s||{};p=a.normalizeEvent(o,q);k=a.createListenerWrap(l,o,p.fn,r,s);i=a.getEventListenerCache(m.dom?m:l,o);o=p.eventName;if(l.attachEvent){j=a.normalizeId(l);if(j){n=Ext.cache[j][o];if(n&&n.firing){i=a.cloneEventListenerCache(l,o)}}}i.push({fn:q,wrap:k,scope:r});if(l.attachEvent){if(i.length===1){j=a.normalizeId(l,true);q=Ext.Function.bind(a.handleSingleEvent,a,[j,o],true);Ext.cache[j][o]={firing:false,fn:q};l.attachEvent("on"+o,q)}}else{l.addEventListener(o,k,s.capture||false)}if(l==g&&o=="mousedown"){a.stoppedMouseDownEvent.addListener(k)}},normalizeId:function(j,i){var k;if(j===document){k=Ext.documentId}else{if(j===window){k=Ext.windowId}else{k=j.id}}if(!k&&i){k=a.getId(j)}return k},handleSingleEvent:function(o,p,l){var m=a.getEventListenerCache(p,l),k=Ext.cache[p][l],j,n;if(k.firing){return}k.firing=true;for(n=0,j=m.length;n<j;++n){m[n].wrap(o)}k.firing=false},removeListener:function(s,u,v,x){if(typeof u!=="string"){a.prepareListenerConfig(s,u,true);return}var q=Ext.getDom(s),m,n=s.dom?s:Ext.get(q),k=a.getEventListenerCache(n,u),w=a.normalizeEvent(u).eventName,r=k.length,p,t,o,l;while(r--){o=k[r];if(o&&(!v||o.fn==v)&&(!x||o.scope===x)){l=o.wrap;if(l.task){clearTimeout(l.task);delete l.task}p=l.tasks&&l.tasks.length;if(p){while(p--){clearTimeout(l.tasks[p])}delete l.tasks}if(q.detachEvent){m=a.normalizeId(q,true);t=Ext.cache[m][w];if(t&&t.firing){k=a.cloneEventListenerCache(q,w)}if(k.length===1){v=t.fn;delete Ext.cache[m][w];q.detachEvent("on"+w,v)}}else{q.removeEventListener(w,l,false)}if(l&&q==g&&u=="mousedown"){a.stoppedMouseDownEvent.removeListener(l)}Ext.Array.erase(k,r,1)}}},removeAll:function(l){var m=(typeof l==="string")?l:l.id,j,k,i;if(m&&(j=Ext.cache[m])){k=j.events;for(i in k){if(k.hasOwnProperty(i)){a.removeListener(l,i)}}j.events={}}},purgeElement:function(m,k){var o=Ext.getDom(m),l=0,j,n;if(k){a.removeListener(m,k)}else{a.removeAll(m)}if(o&&o.childNodes){n=o.childNodes;for(j=n.length;l<j;l++){a.purgeElement(n[l],k)}}},createListenerWrap:function(p,j,m,l,i){i=i||{};var n,o,k=function(r,q){if(!o){n=["if(!"+Ext.name+") {return;}"];if(i.buffer||i.delay||i.freezeEvent){if(i.freezeEvent){n.push("e = X.EventObject.setEvent(e);")}n.push("e = new X.EventObjectImpl(e, "+(i.freezeEvent?"true":"false")+");")}else{n.push("e = X.EventObject.setEvent(e);")}if(i.delegate){n.push('var result, t = e.getTarget("'+(i.delegate+"").replace(d,"\\\\")+'", this);');n.push("if(!t) {return;}")}else{n.push("var t = e.target, result;")}if(i.target){n.push("if(e.target !== options.target) {return;}")}if(i.stopEvent){n.push("e.stopEvent();")}else{if(i.preventDefault){n.push("e.preventDefault();")}if(i.stopPropagation){n.push("e.stopPropagation();")}}if(i.normalized===false){n.push("e = e.browserEvent;")}if(i.buffer){n.push("(wrap.task && clearTimeout(wrap.task));");n.push("wrap.task = setTimeout(function() {")}if(i.delay){n.push("wrap.tasks = wrap.tasks || [];");n.push("wrap.tasks.push(setTimeout(function() {")}n.push("result = fn.call(scope || dom, e, t, options);");if(i.single){n.push("evtMgr.removeListener(dom, ename, fn, scope);")}if(j!=="mousemove"&&j!=="unload"){n.push("if (evtMgr.idleEvent.listeners.length) {");n.push("evtMgr.idleEvent.fire();");n.push("}")}if(i.delay){n.push("}, "+i.delay+"));")}if(i.buffer){n.push("}, "+i.buffer+");")}n.push("return result;");o=Ext.cacheableFunctionFactory("e","options","fn","scope","ename","dom","wrap","args","X","evtMgr",n.join("\n"))}return o.call(p,r,i,m,l,j,p,k,q,Ext,a)};return k},getEventCache:function(k){var j,i,l;if(!k){return[]}if(k.$cache){j=k.$cache}else{if(typeof k==="string"){l=k}else{l=a.getId(k)}j=Ext.cache[l]}i=j.events||(j.events={});return i},getEventListenerCache:function(k,i){var j=a.getEventCache(k);return j[i]||(j[i]=[])},cloneEventListenerCache:function(l,i){var k=a.getEventCache(l),j;if(k[i]){j=k[i].slice(0)}else{j=[]}k[i]=j;return j},mouseLeaveRe:/(mouseout|mouseleave)/,mouseEnterRe:/(mouseover|mouseenter)/,stopEvent:function(i){a.stopPropagation(i);a.preventDefault(i)},stopPropagation:function(i){i=i.browserEvent||i;if(i.stopPropagation){i.stopPropagation()}else{i.cancelBubble=true}},preventDefault:function(i){i=i.browserEvent||i;if(i.preventDefault){i.preventDefault()}else{i.returnValue=false;try{if(i.ctrlKey||i.keyCode>111&&i.keyCode<124){i.keyCode=-1}}catch(j){}}},getRelatedTarget:function(i){i=i.browserEvent||i;var j=i.relatedTarget;if(!j){if(a.mouseLeaveRe.test(i.type)){j=i.toElement}else{if(a.mouseEnterRe.test(i.type)){j=i.fromElement}}}return a.resolveTextNode(j)},getPageX:function(i){return a.getPageXY(i)[0]},getPageY:function(i){return a.getPageXY(i)[1]},getPageXY:function(k){k=k.browserEvent||k;var j=k.pageX,m=k.pageY,l=g.documentElement,i=g.body;if(!j&&j!==0){j=k.clientX+(l&&l.scrollLeft||i&&i.scrollLeft||0)-(l&&l.clientLeft||i&&i.clientLeft||0);m=k.clientY+(l&&l.scrollTop||i&&i.scrollTop||0)-(l&&l.clientTop||i&&i.clientTop||0)}return[j,m]},getTarget:function(i){i=i.browserEvent||i;return a.resolveTextNode(i.target||i.srcElement)},resolveTextNode:Ext.isGecko?function(j){if(j){var i=HTMLElement.prototype.toString.call(j);if(i!=="[xpconnect wrapped native prototype]"&&i!=="[object XULElement]"){return j.nodeType==3?j.parentNode:j}}}:function(i){return i&&i.nodeType==3?i.parentNode:i},curWidth:0,curHeight:0,onWindowResize:function(l,k,j){var i=a.resizeEvent;if(!i){a.resizeEvent=i=new Ext.util.Event();a.on(e,"resize",a.fireResize,null,{buffer:100})}i.addListener(l,k,j)},fireResize:function(){var i=Ext.Element.getViewWidth(),j=Ext.Element.getViewHeight();if(a.curHeight!=j||a.curWidth!=i){a.curHeight=j;a.curWidth=i;a.resizeEvent.fire(i,j)}},removeResizeListener:function(k,j){var i=a.resizeEvent;if(i){i.removeListener(k,j)}},onWindowUnload:function(l,k,j){var i=a.unloadEvent;if(!i){a.unloadEvent=i=new Ext.util.Event();a.addListener(e,"unload",a.fireUnload)}if(l){i.addListener(l,k,j)}},fireUnload:function(){try{g=e=undefined;var o,k,m,l,j;a.unloadEvent.fire();if(Ext.isGecko3){o=Ext.ComponentQuery.query("gridview");k=0;m=o.length;for(;k<m;k++){o[k].scrollToTop()}}j=Ext.cache;for(l in j){if(j.hasOwnProperty(l)){a.removeAll(l)}}}catch(n){}},removeUnloadListener:function(k,j){var i=a.unloadEvent;if(i){i.removeListener(k,j)}},useKeyDown:Ext.isWebKit?parseInt(navigator.userAgent.match(/AppleWebKit\/(\d+)/)[1],10)>=525:!((Ext.isGecko&&!Ext.isWindows)||Ext.isOpera),getKeyEvent:function(){return a.useKeyDown?"keydown":"keypress"}});if(!("addEventListener" in document)&&document.attachEvent){Ext.apply(a,{pollScroll:function(){var i=true;try{document.documentElement.doScroll("left")}catch(j){i=false}if(i&&document.body){a.onReadyEvent({type:"doScroll"})}else{a.scrollTimeout=setTimeout(a.pollScroll,20)}return i},scrollTimeout:null,readyStatesRe:/complete/i,checkReadyState:function(){var i=document.readyState;if(a.readyStatesRe.test(i)){a.onReadyEvent({type:i})}},bindReadyEvent:function(){var i=true;if(a.hasBoundOnReady){return}try{i=window.frameElement===undefined}catch(j){i=false}if(!i||!g.documentElement.doScroll){a.pollScroll=Ext.emptyFn}if(a.pollScroll()===true){return}if(g.readyState=="complete"){a.onReadyEvent({type:"already "+(g.readyState||"body")})}else{g.attachEvent("onreadystatechange",a.checkReadyState);window.attachEvent("onload",a.onReadyEvent);a.hasBoundOnReady=true}},onReadyEvent:function(i){if(i&&i.type){a.onReadyChain.push(i.type)}if(a.hasBoundOnReady){document.detachEvent("onreadystatechange",a.checkReadyState);window.detachEvent("onload",a.onReadyEvent)}if(Ext.isNumber(a.scrollTimeout)){clearTimeout(a.scrollTimeout);delete a.scrollTimeout}if(!Ext.isReady){a.fireDocReady()}},onReadyChain:[]})}Ext.onReady=function(k,j,i){Ext.Loader.onReady(k,j,true,i)};Ext.onDocumentReady=a.onDocumentReady;a.on=a.addListener;a.un=a.removeListener;Ext.onReady(c)};Ext.define("Ext.util.Observable",function(a){var d=[],e=Array.prototype,g=e.slice,c=Ext.util.Event,b=function(h){if(h instanceof b){return h}this.observable=h;if(arguments[1].isObservable){this.managedListeners=true}this.args=g.call(arguments,1)};b.prototype.destroy=function(){this.observable[this.managedListeners?"mun":"un"].apply(this.observable,this.args)};return{statics:{releaseCapture:function(h){h.fireEvent=this.prototype.fireEvent},capture:function(j,i,h){j.fireEvent=Ext.Function.createInterceptor(j.fireEvent,i,h)},observe:function(h,i){if(h){if(!h.isObservable){Ext.applyIf(h,new this());this.capture(h.prototype,h.fireEvent,h)}if(Ext.isObject(i)){h.on(i)}}return h},prepareClass:function(j,i){if(!j.HasListeners){var k=function(){},h=j.superclass.HasListeners||(i&&i.HasListeners)||a.HasListeners;j.prototype.HasListeners=j.HasListeners=k;k.prototype=j.hasListeners=new h()}}},isObservable:true,eventsSuspended:0,constructor:function(h){var i=this;Ext.apply(i,h);if(!i.hasListeners){i.hasListeners=new i.HasListeners()}i.events=i.events||{};if(i.listeners){i.on(i.listeners);i.listeners=null}if(i.bubbleEvents){i.enableBubble(i.bubbleEvents)}},onClassExtended:function(h){if(!h.HasListeners){a.prepareClass(h)}},eventOptionsRe:/^(?:scope|delay|buffer|single|stopEvent|preventDefault|stopPropagation|normalized|args|delegate|element|destroyable|vertical|horizontal|freezeEvent|priority)$/,addManagedListener:function(o,k,m,p,q,j){var l=this,n=l.managedListeners=l.managedListeners||[],i,h;if(typeof k!=="string"){h=arguments.length>4?q:k;q=k;for(k in q){if(q.hasOwnProperty(k)){i=q[k];if(!l.eventOptionsRe.test(k)){l.addManagedListener(o,k,i.fn||i,i.scope||q.scope||p,i.fn?i:h,true)}}}if(q&&q.destroyable){return new b(l,o,q)}}else{if(typeof m==="string"){p=p||l;m=p[m]}n.push({item:o,ename:k,fn:m,scope:p,options:q});o.on(k,m,p,q);if(!j&&q&&q.destroyable){return new b(l,o,k,m,p)}}},removeManagedListener:function(p,k,n,q){var m=this,r,j,o,h,l;if(typeof k!=="string"){r=k;for(k in r){if(r.hasOwnProperty(k)){j=r[k];if(!m.eventOptionsRe.test(k)){m.removeManagedListener(p,k,j.fn||j,j.scope||r.scope||q)}}}}else{o=m.managedListeners?m.managedListeners.slice():[];for(l=0,h=o.length;l<h;l++){m.removeManagedListenerItem(false,o[l],p,k,n,q)}}},fireEvent:function(h){return this.fireEventArgs(h,Array.prototype.slice.call(arguments,1))},fireEventArgs:function(h,j){h=h.toLowerCase();var m=this,k=m.events,l=k&&k[h],i=true;if(l&&m.hasListeners[h]){i=m.continueFireEvent(h,j||d,l.bubble)}return i},continueFireEvent:function(j,l,i){var n=this,h,m,k=true;do{if(n.eventsSuspended){if((h=n.eventQueue)){h.push([j,l,i])}return k}else{m=n.events[j];if(m&&m!=true){if((k=m.fire.apply(m,l))===false){break}}}}while(i&&(n=n.getBubbleParent()));return k},getBubbleParent:function(){var i=this,h=i.getBubbleTarget&&i.getBubbleTarget();if(h&&h.isObservable){return h}return null},addListener:function(k,m,l,j){var o=this,i,n,h=0;if(typeof k!=="string"){j=k;for(k in j){if(j.hasOwnProperty(k)){i=j[k];if(!o.eventOptionsRe.test(k)){o.addListener(k,i.fn||i,i.scope||j.scope,i.fn?i:j)}}}if(j&&j.destroyable){return new b(o,j)}}else{k=k.toLowerCase();n=o.events[k];if(n&&n.isEvent){h=n.listeners.length}else{o.events[k]=n=new c(o,k)}if(typeof m==="string"){l=l||o;m=l[m]}n.addListener(m,l,j);if(n.listeners.length!==h){o.hasListeners._incr_(k)}if(j&&j.destroyable){return new b(o,k,m,l,j)}}},removeListener:function(j,l,k){var n=this,i,m,h;if(typeof j!=="string"){h=j;for(j in h){if(h.hasOwnProperty(j)){i=h[j];if(!n.eventOptionsRe.test(j)){n.removeListener(j,i.fn||i,i.scope||h.scope)}}}}else{j=j.toLowerCase();m=n.events[j];if(m&&m.isEvent){if(m.removeListener(l,k)){n.hasListeners._decr_(j)}}}},clearListeners:function(){var j=this.events,h=this.hasListeners,k,i;for(i in j){if(j.hasOwnProperty(i)){k=j[i];if(k.isEvent){delete h[i];k.clearListeners()}}}this.clearManagedListeners()},clearManagedListeners:function(){var j=this.managedListeners||[],k=0,h=j.length;for(;k<h;k++){this.removeManagedListenerItem(true,j[k])}this.managedListeners=[]},removeManagedListenerItem:function(i,h,m,j,l,k){if(i||(h.item===m&&h.ename===j&&(!l||h.fn===l)&&(!k||h.scope===k))){h.item.un(h.ename,h.fn,h.scope);if(!i){Ext.Array.remove(this.managedListeners,h)}}},addEvents:function(n){var m=this,l=m.events||(m.events={}),h,j,k;if(typeof n=="string"){for(j=arguments,k=j.length;k--;){h=j[k];if(!l[h]){l[h]=true}}}else{Ext.applyIf(m.events,n)}},hasListener:function(h){return !!this.hasListeners[h.toLowerCase()]},suspendEvents:function(h){this.eventsSuspended+=1;if(h&&!this.eventQueue){this.eventQueue=[]}},suspendEvent:function(j){var h=arguments.length,k,l;for(k=0;k<h;k++){l=this.events[arguments[k]];if(l&&l.suspend){l.suspend()}}},resumeEvent:function(){var h=arguments.length,j,k;for(j=0;j<h;j++){k=this.events[arguments[j]];if(k&&k.resume){k.resume()}}},resumeEvents:function(){var h=this,k=h.eventQueue,j,i;if(h.eventsSuspended&&!--h.eventsSuspended){delete h.eventQueue;if(k){j=k.length;for(i=0;i<j;i++){h.continueFireEvent.apply(h,k[i])}}}},relayEvents:function(j,l,o){var n=this,h=l.length,k=0,m,p={};for(;k<h;k++){m=l[k];p[m]=n.createRelayer(o?o+m:m)}n.mon(j,p,null,null,undefined);return new b(n,j,p)},createRelayer:function(h,i){var j=this;return function(){return j.fireEventArgs.call(j,h,i?Array.prototype.slice.apply(arguments,i):arguments)}},enableBubble:function(p){if(p){var n=this,o=(typeof p=="string")?arguments:p,m=o.length,k=n.events,j,l,h;for(h=0;h<m;++h){j=o[h].toLowerCase();l=k[j];if(!l||typeof l=="boolean"){k[j]=l=new c(n,j)}n.hasListeners._incr_(j);l.bubble=true}}}}},function(){var b=this,e=b.prototype,c=function(){},g=function(h){if(!h.HasListeners){var i=h.prototype;b.prepareClass(h,this);h.onExtended(function(j){b.prepareClass(j)});if(i.onClassMixedIn){Ext.override(h,{onClassMixedIn:function(j){g.call(this,j);this.callParent(arguments)}})}else{i.onClassMixedIn=function(j){g.call(this,j)}}}},a;c.prototype={_decr_:function(h){if(!--this[h]){delete this[h]}},_incr_:function(h){if(this.hasOwnProperty(h)){++this[h]}else{this[h]=1}}};e.HasListeners=b.HasListeners=c;b.createAlias({on:"addListener",un:"removeListener",mon:"addManagedListener",mun:"removeManagedListener"});b.observeClass=b.observe;Ext.globalEvents=a=new b({events:{idle:Ext.EventManager.idleEvent,ready:Ext.EventManager.readyEvent}});Ext.on=function(){return a.addListener.apply(a,arguments)};Ext.un=function(){return a.removeListener.apply(a,arguments)};function d(n){var m=(this.methodEvents=this.methodEvents||{})[n],j,i,k,l=this,h;if(!m){this.methodEvents[n]=m={};m.originalFn=this[n];m.methodName=n;m.before=[];m.after=[];h=function(q,p,o){if((i=q.apply(p||l,o))!==undefined){if(typeof i=="object"){if(i.returnValue!==undefined){j=i.returnValue}else{j=i}k=!!i.cancel}else{if(i===false){k=true}else{j=i}}}};this[n]=function(){var q=Array.prototype.slice.call(arguments,0),p,r,o;j=i=undefined;k=false;for(r=0,o=m.before.length;r<o;r++){p=m.before[r];h(p.fn,p.scope,q);if(k){return j}}if((i=m.originalFn.apply(l,q))!==undefined){j=i}for(r=0,o=m.after.length;r<o;r++){p=m.after[r];h(p.fn,p.scope,q);if(k){return j}}return j}}return m}Ext.apply(e,{onClassMixedIn:g,beforeMethod:function(j,i,h){d.call(this,j).before.push({fn:i,scope:h})},afterMethod:function(j,i,h){d.call(this,j).after.push({fn:i,scope:h})},removeMethodListener:function(n,l,k){var m=this.getMethodEvent(n),j,h;for(j=0,h=m.before.length;j<h;j++){if(m.before[j].fn==l&&m.before[j].scope==k){Ext.Array.erase(m.before,j,1);return}}for(j=0,h=m.after.length;j<h;j++){if(m.after[j].fn==l&&m.after[j].scope==k){Ext.Array.erase(m.after,j,1);return}}},toggleEventLogging:function(h){Ext.util.Observable[h?"capture":"releaseCapture"](this,function(i){if(Ext.isDefined(Ext.global.console)){Ext.global.console.log(i,arguments)}})}})});Ext.define("Ext.EventObjectImpl",{BACKSPACE:8,TAB:9,NUM_CENTER:12,ENTER:13,RETURN:13,SHIFT:16,CTRL:17,ALT:18,PAUSE:19,CAPS_LOCK:20,ESC:27,SPACE:32,PAGE_UP:33,PAGE_DOWN:34,END:35,HOME:36,LEFT:37,UP:38,RIGHT:39,DOWN:40,PRINT_SCREEN:44,INSERT:45,DELETE:46,ZERO:48,ONE:49,TWO:50,THREE:51,FOUR:52,FIVE:53,SIX:54,SEVEN:55,EIGHT:56,NINE:57,A:65,B:66,C:67,D:68,E:69,F:70,G:71,H:72,I:73,J:74,K:75,L:76,M:77,N:78,O:79,P:80,Q:81,R:82,S:83,T:84,U:85,V:86,W:87,X:88,Y:89,Z:90,CONTEXT_MENU:93,NUM_ZERO:96,NUM_ONE:97,NUM_TWO:98,NUM_THREE:99,NUM_FOUR:100,NUM_FIVE:101,NUM_SIX:102,NUM_SEVEN:103,NUM_EIGHT:104,NUM_NINE:105,NUM_MULTIPLY:106,NUM_PLUS:107,NUM_MINUS:109,NUM_PERIOD:110,NUM_DIVISION:111,F1:112,F2:113,F3:114,F4:115,F5:116,F6:117,F7:118,F8:119,F9:120,F10:121,F11:122,F12:123,WHEEL_SCALE:(function(){var a;if(Ext.isGecko){a=3}else{if(Ext.isMac){if(Ext.isSafari&&Ext.webKitVersion>=532){a=120}else{a=12}a*=3}else{a=120}}return a}()),clickRe:/(dbl)?click/,safariKeys:{3:13,63234:37,63235:39,63232:38,63233:40,63276:33,63277:34,63272:46,63273:36,63275:35},btnMap:Ext.isIE?{1:0,4:1,2:2}:{0:0,1:1,2:2},constructor:function(a,b){if(a){this.setEvent(a.browserEvent||a,b)}},setEvent:function(d,e){var c=this,b,a;if(d===c||(d&&d.browserEvent)){return d}c.browserEvent=d;if(d){b=d.button?c.btnMap[d.button]:(d.which?d.which-1:-1);if(c.clickRe.test(d.type)&&b==-1){b=0}a={type:d.type,button:b,shiftKey:d.shiftKey,ctrlKey:d.ctrlKey||d.metaKey||false,altKey:d.altKey,keyCode:d.keyCode,charCode:d.charCode,target:Ext.EventManager.getTarget(d),relatedTarget:Ext.EventManager.getRelatedTarget(d),currentTarget:d.currentTarget,xy:(e?c.getXY():null)}}else{a={button:-1,shiftKey:false,ctrlKey:false,altKey:false,keyCode:0,charCode:0,target:null,xy:[0,0]}}Ext.apply(c,a);return c},stopEvent:function(){this.stopPropagation();this.preventDefault()},preventDefault:function(){if(this.browserEvent){Ext.EventManager.preventDefault(this.browserEvent)}},stopPropagation:function(){var a=this.browserEvent;if(a){if(a.type=="mousedown"){Ext.EventManager.stoppedMouseDownEvent.fire(this)}Ext.EventManager.stopPropagation(a)}},getCharCode:function(){return this.charCode||this.keyCode},getKey:function(){return this.normalizeKey(this.keyCode||this.charCode)},normalizeKey:function(a){return Ext.isWebKit?(this.safariKeys[a]||a):a},getPageX:function(){return this.getX()},getPageY:function(){return this.getY()},getX:function(){return this.getXY()[0]},getY:function(){return this.getXY()[1]},getXY:function(){if(!this.xy){this.xy=Ext.EventManager.getPageXY(this.browserEvent)}return this.xy},getTarget:function(b,c,a){if(b){return Ext.fly(this.target).findParent(b,c,a)}return a?Ext.get(this.target):this.target},getRelatedTarget:function(b,c,a){if(b&&this.relatedTarget){return Ext.fly(this.relatedTarget).findParent(b,c,a)}return a?Ext.get(this.relatedTarget):this.relatedTarget},correctWheelDelta:function(c){var b=this.WHEEL_SCALE,a=Math.round(c/b);if(!a&&c){a=(c<0)?-1:1}return a},getWheelDeltas:function(){var d=this,c=d.browserEvent,b=0,a=0;if(Ext.isDefined(c.wheelDeltaX)){b=c.wheelDeltaX;a=c.wheelDeltaY}else{if(c.wheelDelta){a=c.wheelDelta}else{if(c.detail){a=-c.detail;if(a>100){a=3}else{if(a<-100){a=-3}}if(Ext.isDefined(c.axis)&&c.axis===c.HORIZONTAL_AXIS){b=a;a=0}}}}return{x:d.correctWheelDelta(b),y:d.correctWheelDelta(a)}},getWheelDelta:function(){var a=this.getWheelDeltas();return a.y},within:function(d,e,b){if(d){var c=e?this.getRelatedTarget():this.getTarget(),a;if(c){a=Ext.fly(d).contains(c);if(!a&&b){a=c==Ext.getDom(d)}return a}}return false},isNavKeyPress:function(){var b=this,a=this.normalizeKey(b.keyCode);return(a>=33&&a<=40)||a==b.RETURN||a==b.TAB||a==b.ESC},isSpecialKey:function(){var a=this.normalizeKey(this.keyCode);return(this.type=="keypress"&&this.ctrlKey)||this.isNavKeyPress()||(a==this.BACKSPACE)||(a>=16&&a<=20)||(a>=44&&a<=46)},getPoint:function(){var a=this.getXY();return new Ext.util.Point(a[0],a[1])},hasModifier:function(){return this.ctrlKey||this.altKey||this.shiftKey||this.metaKey},injectEvent:(function(){var d,e={},c;if(!Ext.isIE&&document.createEvent){d={createHtmlEvent:function(k,i,h,g){var j=k.createEvent("HTMLEvents");j.initEvent(i,h,g);return j},createMouseEvent:function(u,s,m,l,o,k,i,j,g,r,q,n,p){var h=u.createEvent("MouseEvents"),t=u.defaultView||window;if(h.initMouseEvent){h.initMouseEvent(s,m,l,t,o,k,i,k,i,j,g,r,q,n,p)}else{h=u.createEvent("UIEvents");h.initEvent(s,m,l);h.view=t;h.detail=o;h.screenX=k;h.screenY=i;h.clientX=k;h.clientY=i;h.ctrlKey=j;h.altKey=g;h.metaKey=q;h.shiftKey=r;h.button=n;h.relatedTarget=p}return h},createUIEvent:function(m,k,i,h,j){var l=m.createEvent("UIEvents"),g=m.defaultView||window;l.initUIEvent(k,i,h,g,j);return l},fireEvent:function(i,g,h){i.dispatchEvent(h)},fixTarget:function(g){if(g==window&&!g.dispatchEvent){return document}return g}}}else{if(document.createEventObject){c={0:1,1:4,2:2};d={createHtmlEvent:function(k,i,h,g){var j=k.createEventObject();j.bubbles=h;j.cancelable=g;return j},createMouseEvent:function(t,s,m,l,o,k,i,j,g,r,q,n,p){var h=t.createEventObject();h.bubbles=m;h.cancelable=l;h.detail=o;h.screenX=k;h.screenY=i;h.clientX=k;h.clientY=i;h.ctrlKey=j;h.altKey=g;h.shiftKey=r;h.metaKey=q;h.button=c[n]||n;h.relatedTarget=p;return h},createUIEvent:function(l,j,h,g,i){var k=l.createEventObject();k.bubbles=h;k.cancelable=g;return k},fireEvent:function(i,g,h){i.fireEvent("on"+g,h)},fixTarget:function(g){if(g==document){return document.documentElement}return g}}}}Ext.Object.each({load:[false,false],unload:[false,false],select:[true,false],change:[true,false],submit:[true,true],reset:[true,false],resize:[true,false],scroll:[true,false]},function(i,j){var h=j[0],g=j[1];e[i]=function(m,k){var l=d.createHtmlEvent(i,h,g);d.fireEvent(m,i,l)}});function b(i,h){var g=(i!="mousemove");return function(m,j){var l=j.getXY(),k=d.createMouseEvent(m.ownerDocument,i,true,g,h,l[0],l[1],j.ctrlKey,j.altKey,j.shiftKey,j.metaKey,j.button,j.relatedTarget);d.fireEvent(m,i,k)}}Ext.each(["click","dblclick","mousedown","mouseup","mouseover","mousemove","mouseout"],function(g){e[g]=b(g,1)});Ext.Object.each({focusin:[true,false],focusout:[true,false],activate:[true,true],focus:[false,false],blur:[false,false]},function(i,j){var h=j[0],g=j[1];e[i]=function(m,k){var l=d.createUIEvent(m.ownerDocument,i,h,g,1);d.fireEvent(m,i,l)}});if(!d){e={};d={fixTarget:Ext.identityFn}}function a(h,g){}return function(j){var i=this,h=e[i.type]||a,g=j?(j.dom||j):i.getTarget();g=d.fixTarget(g);h(g,i)}}())},function(){Ext.EventObject=new Ext.EventObjectImpl()});Ext.define("Ext.dom.AbstractQuery",{select:function(k,b){var h=[],d,g,e,c,a;b=b||document;if(typeof b=="string"){b=document.getElementById(b)}k=k.split(",");for(g=0,c=k.length;g<c;g++){if(typeof k[g]=="string"){if(typeof k[g][0]=="@"){d=b.getAttributeNode(k[g].substring(1));h.push(d)}else{d=b.querySelectorAll(k[g]);for(e=0,a=d.length;e<a;e++){h.push(d[e])}}}}return h},selectNode:function(b,a){return this.select(b,a)[0]},is:function(a,b){if(typeof a=="string"){a=document.getElementById(a)}return this.select(b).indexOf(a)!==-1}});Ext.define("Ext.dom.AbstractHelper",{emptyTags:/^(?:br|frame|hr|img|input|link|meta|range|spacer|wbr|area|param|col)$/i,confRe:/^(?:tag|children|cn|html|tpl|tplData)$/i,endRe:/end/i,styleSepRe:/\s*(?::|;)\s*/,attributeTransform:{cls:"class",htmlFor:"for"},closeTags:{},decamelizeName:(function(){var c=/([a-z])([A-Z])/g,b={};function a(d,g,e){return g+"-"+e.toLowerCase()}return function(d){return b[d]||(b[d]=d.replace(c,a))}}()),generateMarkup:function(j,b){var h=this,g=typeof j,e,a,k,d,c;if(g=="string"||g=="number"){b.push(j)}else{if(Ext.isArray(j)){for(d=0;d<j.length;d++){if(j[d]){h.generateMarkup(j[d],b)}}}else{k=j.tag||"div";b.push("<",k);for(e in j){if(j.hasOwnProperty(e)){a=j[e];if(!h.confRe.test(e)){if(typeof a=="object"){b.push(" ",e,'="');h.generateStyles(a,b).push('"')}else{b.push(" ",h.attributeTransform[e]||e,'="',a,'"')}}}}if(h.emptyTags.test(k)){b.push("/>")}else{b.push(">");if((a=j.tpl)){a.applyOut(j.tplData,b)}if((a=j.html)){b.push(a)}if((a=j.cn||j.children)){h.generateMarkup(a,b)}c=h.closeTags;b.push(c[k]||(c[k]="</"+k+">"))}}}return b},generateStyles:function(e,c){var b=c||[],d;for(d in e){if(e.hasOwnProperty(d)){b.push(this.decamelizeName(d),":",e[d],";")}}return c||b.join("")},markup:function(a){if(typeof a=="string"){return a}var b=this.generateMarkup(a,[]);return b.join("")},applyStyles:function(c,d){if(d){var b=0,a;c=Ext.fly(c,"_applyStyles");if(typeof d=="function"){d=d.call()}if(typeof d=="string"){d=Ext.util.Format.trim(d).split(this.styleSepRe);for(a=d.length;b<a;){c.setStyle(d[b++],d[b++])}}else{if(Ext.isObject(d)){c.setStyle(d)}}}},insertHtml:function(c,g,d){var h={},a,b,i,e;c=c.toLowerCase();h.beforebegin=["BeforeBegin","previousSibling"];h.afterend=["AfterEnd","nextSibling"];b=g.ownerDocument.createRange();a="setStart"+(this.endRe.test(c)?"After":"Before");if(h[c]){b[a](g);i=b.createContextualFragment(d);g.parentNode.insertBefore(i,c=="beforebegin"?g:g.nextSibling);return g[(c=="beforebegin"?"previous":"next")+"Sibling"]}else{e=(c=="afterbegin"?"first":"last")+"Child";if(g.firstChild){b[a](g[e]);i=b.createContextualFragment(d);if(c=="afterbegin"){g.insertBefore(i,g.firstChild)}else{g.appendChild(i)}}else{g.innerHTML=d}return g[e]}throw'Illegal insertion point -> "'+c+'"'},insertBefore:function(a,c,b){return this.doInsert(a,c,b,"beforebegin")},insertAfter:function(a,c,b){return this.doInsert(a,c,b,"afterend","nextSibling")},insertFirst:function(a,c,b){return this.doInsert(a,c,b,"afterbegin","firstChild")},append:function(a,c,b){return this.doInsert(a,c,b,"beforeend","",true)},overwrite:function(a,c,b){a=Ext.getDom(a);a.innerHTML=this.markup(c);return b?Ext.get(a.firstChild):a.firstChild},doInsert:function(d,g,e,h,c,a){var b=this.insertHtml(h,Ext.getDom(d),this.markup(g));return e?Ext.get(b,true):b}});Ext.define("Ext.dom.AbstractElement_static",{override:"Ext.dom.AbstractElement",inheritableStatics:{unitRe:/\d+(px|em|%|en|ex|pt|in|cm|mm|pc)$/i,camelRe:/(-[a-z])/gi,msRe:/^-ms-/,cssRe:/([a-z0-9\-]+)\s*:\s*([^;\s]+(?:\s*[^;\s]+)*)?;?/gi,opacityRe:/alpha\(opacity=(.*)\)/i,propertyCache:{},defaultUnit:"px",borders:{l:"border-left-width",r:"border-right-width",t:"border-top-width",b:"border-bottom-width"},paddings:{l:"padding-left",r:"padding-right",t:"padding-top",b:"padding-bottom"},margins:{l:"margin-left",r:"margin-right",t:"margin-top",b:"margin-bottom"},addUnits:function(b,a){if(typeof b=="number"){return b+(a||this.defaultUnit||"px")}if(b===""||b=="auto"||b===undefined||b===null){return b||""}if(!this.unitRe.test(b)){return b||""}return b},isAncestor:function(b,d){var a=false;b=Ext.getDom(b);d=Ext.getDom(d);if(b&&d){if(b.contains){return b.contains(d)}else{if(b.compareDocumentPosition){return !!(b.compareDocumentPosition(d)&16)}else{while((d=d.parentNode)){a=d==b||a}}}}return a},parseBox:function(c){c=c||0;var a=typeof c,d,b;if(a==="number"){return{top:c,right:c,bottom:c,left:c}}else{if(a!=="string"){return c}}d=c.split(" ");b=d.length;if(b==1){d[1]=d[2]=d[3]=d[0]}else{if(b==2){d[2]=d[0];d[3]=d[1]}else{if(b==3){d[3]=d[1]}}}return{top:parseFloat(d[0])||0,right:parseFloat(d[1])||0,bottom:parseFloat(d[2])||0,left:parseFloat(d[3])||0}},unitizeBox:function(g,e){var d=this.addUnits,c=this.parseBox(g);return d(c.top,e)+" "+d(c.right,e)+" "+d(c.bottom,e)+" "+d(c.left,e)},camelReplaceFn:function(b,c){return c.charAt(1).toUpperCase()},normalize:function(a){if(a=="float"){a=Ext.supports.Float?"cssFloat":"styleFloat"}return this.propertyCache[a]||(this.propertyCache[a]=a.replace(this.msRe,"ms-").replace(this.camelRe,this.camelReplaceFn))},getDocumentHeight:function(){return Math.max(!Ext.isStrict?document.body.scrollHeight:document.documentElement.scrollHeight,this.getViewportHeight())},getDocumentWidth:function(){return Math.max(!Ext.isStrict?document.body.scrollWidth:document.documentElement.scrollWidth,this.getViewportWidth())},getViewportHeight:function(){return window.innerHeight},getViewportWidth:function(){return window.innerWidth},getViewSize:function(){return{width:window.innerWidth,height:window.innerHeight}},getOrientation:function(){if(Ext.supports.OrientationChange){return(window.orientation==0)?"portrait":"landscape"}return(window.innerHeight>window.innerWidth)?"portrait":"landscape"},fromPoint:function(a,b){return Ext.get(document.elementFromPoint(a,b))},parseStyles:function(c){var a={},b=this.cssRe,d;if(c){b.lastIndex=0;while((d=b.exec(c))){a[d[1]]=d[2]||""}}return a}}},function(){var c=document,b=null,a=c.compatMode=="CSS1Compat";if(!("activeElement" in c)&&c.addEventListener){c.addEventListener("focus",function(e){if(e&&e.target){b=(e.target==c)?null:e.target}},true)}function d(g,h,e){return function(){g.selectionStart=h;g.selectionEnd=e}}this.addInheritableStatics({getActiveElement:function(){var h;try{h=c.activeElement}catch(g){}h=h||b;if(!h){h=b=document.body}return h},getRightMarginFixCleaner:function(k){var h=Ext.supports,i=h.DisplayChangeInputSelectionBug,j=h.DisplayChangeTextAreaSelectionBug,l,e,m,g;if(i||j){l=c.activeElement||b;e=l&&l.tagName;if((j&&e=="TEXTAREA")||(i&&e=="INPUT"&&l.type=="text")){if(Ext.dom.Element.isAncestor(k,l)){m=l.selectionStart;g=l.selectionEnd;if(Ext.isNumber(m)&&Ext.isNumber(g)){return d(l,m,g)}}}}return Ext.emptyFn},getViewWidth:function(e){return e?Ext.dom.Element.getDocumentWidth():Ext.dom.Element.getViewportWidth()},getViewHeight:function(e){return e?Ext.dom.Element.getDocumentHeight():Ext.dom.Element.getViewportHeight()},getDocumentHeight:function(){return Math.max(!a?c.body.scrollHeight:c.documentElement.scrollHeight,Ext.dom.Element.getViewportHeight())},getDocumentWidth:function(){return Math.max(!a?c.body.scrollWidth:c.documentElement.scrollWidth,Ext.dom.Element.getViewportWidth())},getViewportHeight:function(){return Ext.isIE9m?(Ext.isStrict?c.documentElement.clientHeight:c.body.clientHeight):self.innerHeight},getViewportWidth:function(){return(!Ext.isStrict&&!Ext.isOpera)?c.body.clientWidth:Ext.isIE9m?c.documentElement.clientWidth:self.innerWidth},serializeForm:function(i){var j=i.elements||(document.forms[i]||Ext.getDom(i)).elements,t=false,s=encodeURIComponent,m="",l=j.length,n,g,r,v,u,p,k,q,h;for(p=0;p<l;p++){n=j[p];g=n.name;r=n.type;v=n.options;if(!n.disabled&&g){if(/select-(one|multiple)/i.test(r)){q=v.length;for(k=0;k<q;k++){h=v[k];if(h.selected){u=h.hasAttribute?h.hasAttribute("value"):h.getAttributeNode("value").specified;m+=Ext.String.format("{0}={1}&",s(g),s(u?h.value:h.text))}}}else{if(!(/file|undefined|reset|button/i.test(r))){if(!(/radio|checkbox/i.test(r)&&!n.checked)&&!(r=="submit"&&t)){m+=s(g)+"="+s(n.value)+"&";t=/submit/i.test(r)}}}}}return m.substr(0,m.length-1)}})});Ext.define("Ext.dom.AbstractElement_insertion",{override:"Ext.dom.AbstractElement",appendChild:function(d,c){var g=this,i,b,h,a;if(d.nodeType||d.dom||typeof d=="string"){d=Ext.getDom(d);g.dom.appendChild(d);return !c?Ext.get(d):d}else{if(d.length){i=Ext.fly(document.createDocumentFragment(),"_internal");b=d.length;Ext.DomHelper.useDom=true;for(h=0;h<b;h++){i.appendChild(d[h],c)}Ext.DomHelper.useDom=a;g.dom.appendChild(i.dom);return c?i.dom:i}else{return g.createChild(d,null,c)}}},appendTo:function(a){Ext.getDom(a).appendChild(this.dom);return this},insertBefore:function(a){a=Ext.getDom(a);a.parentNode.insertBefore(this.dom,a);return this},insertAfter:function(a){a=Ext.getDom(a);a.parentNode.insertBefore(this.dom,a.nextSibling);return this},insertFirst:function(b,a){b=b||{};if(b.nodeType||b.dom||typeof b=="string"){b=Ext.getDom(b);this.dom.insertBefore(b,this.dom.firstChild);return !a?Ext.get(b):b}else{return this.createChild(b,this.dom.firstChild,a)}},insertSibling:function(b,g,j){var i=this,k=Ext.core.DomHelper,l=k.useDom,m=(g||"before").toLowerCase()=="after",d,a,c,h;if(Ext.isArray(b)){a=Ext.fly(document.createDocumentFragment(),"_internal");c=b.length;k.useDom=true;for(h=0;h<c;h++){d=a.appendChild(b[h],j)}k.useDom=l;i.dom.parentNode.insertBefore(a.dom,m?i.dom.nextSibling:i.dom);return d}b=b||{};if(b.nodeType||b.dom){d=i.dom.parentNode.insertBefore(Ext.getDom(b),m?i.dom.nextSibling:i.dom);if(!j){d=Ext.get(d)}}else{if(m&&!i.dom.nextSibling){d=k.append(i.dom.parentNode,b,!j)}else{d=k[m?"insertAfter":"insertBefore"](i.dom,b,!j)}}return d},replace:function(a){a=Ext.get(a);this.insertBefore(a);a.remove();return this},replaceWith:function(a){var b=this;if(a.nodeType||a.dom||typeof a=="string"){a=Ext.get(a);b.dom.parentNode.insertBefore(a.dom,b.dom)}else{a=Ext.core.DomHelper.insertBefore(b.dom,a)}delete Ext.cache[b.id];Ext.removeNode(b.dom);b.id=Ext.id(b.dom=a);Ext.dom.AbstractElement.addToCache(b.isFlyweight?new Ext.dom.AbstractElement(b.dom):b);return b},createChild:function(b,a,c){b=b||{tag:"div"};if(a){return Ext.core.DomHelper.insertBefore(a,b,c!==true)}else{return Ext.core.DomHelper.append(this.dom,b,c!==true)}},wrap:function(b,c,a){var e=Ext.core.DomHelper.insertBefore(this.dom,b||{tag:"div"},true),d=e;if(a){d=Ext.DomQuery.selectNode(a,e.dom)}d.appendChild(this.dom);return c?e.dom:e},insertHtml:function(b,c,a){var d=Ext.core.DomHelper.insertHtml(b,this.dom,c);return a?Ext.get(d):d}});Ext.define("Ext.dom.AbstractElement_style",{override:"Ext.dom.AbstractElement"},function(){var d=this,m=/\w/g,q=/\s+/,c=/^(?:transparent|(?:rgba[(](?:\s*\d+\s*[,]){3}\s*0\s*[)]))$/i,j=Ext.supports.ClassList,e="padding",i="margin",a="border",r="-left",b="-right",o="-top",k="-bottom",p="-width",l={l:a+r+p,r:a+b+p,t:a+o+p,b:a+k+p},g={l:e+r,r:e+b,t:e+o,b:e+k},n={l:i+r,r:i+b,t:i+o,b:i+k},h=new d.Fly();Ext.override(d,{styleHooks:{},addStyles:function(z,y){var u=0,x=(z||"").match(m),w,s=x.length,v,t=[];if(s==1){u=Math.abs(parseFloat(this.getStyle(y[x[0]]))||0)}else{if(s){for(w=0;w<s;w++){v=x[w];t.push(y[v])}t=this.getStyle(t);for(w=0;w<s;w++){v=x[w];u+=Math.abs(parseFloat(t[y[v]])||0)}}}return u},addCls:(function(){var t=function(z){var A=this,w=A.dom,u=A.trimRe,B=z,v,C,x,y,D;if(typeof(z)=="string"){z=z.replace(u,"").split(q)}if(w&&z&&!!(y=z.length)){if(!w.className){w.className=z.join(" ")}else{v=w.classList;if(v){for(x=0;x<y;++x){D=z[x];if(D){if(!v.contains(D)){if(C){C.push(D)}else{C=w.className.replace(u,"");C=C?[C,D]:[D]}}}}if(C){w.className=C.join(" ")}}else{s(B)}}}return A},s=function(v){var w=this,x=w.dom,u;if(x&&v&&v.length){u=Ext.Element.mergeClsList(x.className,v);if(u.changed){x.className=u.join(" ")}}return w};return j?t:s})(),removeCls:function(u){var v=this,x=v.dom,w,s,t;if(typeof(u)=="string"){u=u.replace(v.trimRe,"").split(q)}if(x&&x.className&&u&&!!(s=u.length)){w=x.classList;if(s===1&&w){if(u[0]){w.remove(u[0])}}else{t=Ext.Element.removeCls(x.className,u);if(t.changed){x.className=t.join(" ")}}}return v},radioCls:function(w){var x=this.dom.parentNode.childNodes,t,u,s;w=Ext.isArray(w)?w:[w];for(u=0,s=x.length;u<s;u++){t=x[u];if(t&&t.nodeType==1){h.attach(t).removeCls(w)}}return this.addCls(w)},toggleCls:(function(){var s=function(u){var v=this,x=v.dom,w;if(x){u=u.replace(v.trimRe,"");if(u){w=x.classList;if(w){w.toggle(u)}else{t(u)}}}return v},t=function(u){return this.hasCls(u)?this.removeCls(u):this.addCls(u)};return j?s:t})(),hasCls:(function(){var s=function(v){var x=this.dom,u=false,w;if(x&&v){w=x.classList;if(w){u=w.contains(v)}else{u=t(v)}}return u},t=function(u){var v=this.dom;return v?u&&(" "+v.className+" ").indexOf(" "+u+" ")!==-1:false};return j?s:t})(),replaceCls:function(t,s){return this.removeCls(t).addCls(s)},isStyle:function(s,t){return this.getStyle(s)==t},getStyle:function(E,z){var A=this,v=A.dom,H=typeof E!="string",F=A.styleHooks,t=E,B=t,y=1,x,G,D,C,u,s,w;if(H){D={};t=B[0];w=0;if(!(y=B.length)){return D}}if(!v||v.documentElement){return D||""}x=v.style;if(z){s=x}else{s=v.ownerDocument.defaultView.getComputedStyle(v,null);if(!s){z=true;s=x}}do{C=F[t];if(!C){F[t]=C={name:d.normalize(t)}}if(C.get){u=C.get(v,A,z,s)}else{G=C.name;u=s[G]}if(!H){return u}D[t]=u;t=B[++w]}while(w<y);return D},getStyles:function(){var t=Ext.Array.slice(arguments),s=t.length,u;if(s&&typeof t[s-1]=="boolean"){u=t.pop()}return this.getStyle(t,u)},isTransparent:function(t){var s=this.getStyle(t);return s?c.test(s):false},setStyle:function(z,x){var v=this,y=v.dom,s=v.styleHooks,u=y.style,t=z,w;if(typeof t=="string"){w=s[t];if(!w){s[t]=w={name:d.normalize(t)}}x=(x==null)?"":x;if(w.set){w.set(y,x,v)}else{u[w.name]=x}if(w.afterSet){w.afterSet(y,x,v)}}else{for(t in z){if(z.hasOwnProperty(t)){w=s[t];if(!w){s[t]=w={name:d.normalize(t)}}x=z[t];x=(x==null)?"":x;if(w.set){w.set(y,x,v)}else{u[w.name]=x}if(w.afterSet){w.afterSet(y,x,v)}}}}return v},getHeight:function(t){var u=this.dom,s=t?(u.clientHeight-this.getPadding("tb")):u.offsetHeight;return s>0?s:0},getWidth:function(s){var u=this.dom,t=s?(u.clientWidth-this.getPadding("lr")):u.offsetWidth;return t>0?t:0},setWidth:function(s){var t=this;t.dom.style.width=d.addUnits(s);return t},setHeight:function(s){var t=this;t.dom.style.height=d.addUnits(s);return t},getBorderWidth:function(s){return this.addStyles(s,l)},getPadding:function(s){return this.addStyles(s,g)},margins:n,applyStyles:function(u){if(u){var t,s,v=this.dom;if(typeof u=="function"){u=u.call()}if(typeof u=="string"){u=Ext.util.Format.trim(u).split(/\s*(?::|;)\s*/);for(t=0,s=u.length;t<s;){v.style[d.normalize(u[t++])]=u[t++]}}else{if(typeof u=="object"){this.setStyle(u)}}}},setSize:function(u,s){var v=this,t=v.dom.style;if(Ext.isObject(u)){s=u.height;u=u.width}t.width=d.addUnits(u);t.height=d.addUnits(s);return v},getViewSize:function(){var s=document,t=this.dom;if(t==s||t==s.body){return{width:d.getViewportWidth(),height:d.getViewportHeight()}}else{return{width:t.clientWidth,height:t.clientHeight}}},getSize:function(t){var s=this.dom;return{width:Math.max(0,t?(s.clientWidth-this.getPadding("lr")):s.offsetWidth),height:Math.max(0,t?(s.clientHeight-this.getPadding("tb")):s.offsetHeight)}},repaint:function(){var s=this.dom;this.addCls(Ext.baseCSSPrefix+"repaint");setTimeout(function(){h.attach(s).removeCls(Ext.baseCSSPrefix+"repaint")},1);return this},getMargin:function(t){var u=this,w={t:"top",l:"left",r:"right",b:"bottom"},s,x,v;if(!t){v=[];for(s in u.margins){if(u.margins.hasOwnProperty(s)){v.push(u.margins[s])}}x=u.getStyle(v);if(x&&typeof x=="object"){for(s in u.margins){if(u.margins.hasOwnProperty(s)){x[w[s]]=parseFloat(x[u.margins[s]])||0}}}return x}else{return u.addStyles(t,u.margins)}},mask:function(t,x,B){var y=this,u=y.dom,v=(y.$cache||y.getCache()).data,s=v.mask,C,A,z="",w=Ext.baseCSSPrefix;y.addCls(w+"masked");if(y.getStyle("position")=="static"){y.addCls(w+"masked-relative")}if(s){s.remove()}if(x&&typeof x=="string"){z=" "+x}else{z=" "+w+"mask-gray"}C=y.createChild({cls:w+"mask"+((B!==false)?"":(" "+w+"mask-gray")),html:t?('<div class="'+(x||(w+"mask-message"))+'">'+t+"</div>"):""});A=y.getSize();v.mask=C;if(u===document.body){A.height=window.innerHeight;if(y.orientationHandler){Ext.EventManager.unOrientationChange(y.orientationHandler,y)}y.orientationHandler=function(){A=y.getSize();A.height=window.innerHeight;C.setSize(A)};Ext.EventManager.onOrientationChange(y.orientationHandler,y)}C.setSize(A);if(Ext.is.iPad){Ext.repaint()}},unmask:function(){var t=this,v=(t.$cache||t.getCache()).data,s=v.mask,u=Ext.baseCSSPrefix;if(s){s.remove();delete v.mask}t.removeCls([u+"masked",u+"masked-relative"]);if(t.dom===document.body){Ext.EventManager.unOrientationChange(t.orientationHandler,t);delete t.orientationHandler}}});Ext.onReady(function(){var A=Ext.supports,s,y,w,t,z;function x(F,C,E,B){var D=B[this.name]||"";return c.test(D)?"transparent":D}function v(H,E,G,D){var B=D.marginRight,C,F;if(B!="0px"){C=H.style;F=C.display;C.display="inline-block";B=(G?D:H.ownerDocument.defaultView.getComputedStyle(H,null)).marginRight;C.display=F}return B}function u(I,F,H,E){var B=E.marginRight,D,C,G;if(B!="0px"){D=I.style;C=d.getRightMarginFixCleaner(I);G=D.display;D.display="inline-block";B=(H?E:I.ownerDocument.defaultView.getComputedStyle(I,"")).marginRight;D.display=G;C()}return B}s=d.prototype.styleHooks;if(A.init){A.init()}if(!A.RightMargin){s.marginRight=s["margin-right"]={name:"marginRight",get:(A.DisplayChangeInputSelectionBug||A.DisplayChangeTextAreaSelectionBug)?u:v}}if(!A.TransparentColor){y=["background-color","border-color","color","outline-color"];for(w=y.length;w--;){t=y[w];z=d.normalize(t);s[t]=s[z]={name:z,get:x}}}})});Ext.define("Ext.dom.AbstractElement_traversal",{override:"Ext.dom.AbstractElement",findParent:function(h,b,a){var e=this.dom,c=document.documentElement,g=0,d;b=b||50;if(isNaN(b)){d=Ext.getDom(b);b=Number.MAX_VALUE}while(e&&e.nodeType==1&&g<b&&e!=c&&e!=d){if(Ext.DomQuery.is(e,h)){return a?Ext.get(e):e}g++;e=e.parentNode}return null},findParentNode:function(d,b,a){var c=Ext.fly(this.dom.parentNode,"_internal");return c?c.findParent(d,b,a):null},up:function(c,a,b){return this.findParentNode(c,a,!b)},select:function(a,b){return Ext.dom.Element.select(a,this.dom,b)},query:function(a){return Ext.DomQuery.select(a,this.dom)},down:function(a,b){var c=Ext.DomQuery.selectNode(a,this.dom);return b?c:Ext.get(c)},child:function(a,b){var d,c=this,e;e=Ext.id(c.dom);e=Ext.escapeId(e);d=Ext.DomQuery.selectNode("#"+e+" > "+a,c.dom);return b?d:Ext.get(d)},parent:function(a,b){return this.matchNode("parentNode","parentNode",a,b)},next:function(a,b){return this.matchNode("nextSibling","nextSibling",a,b)},prev:function(a,b){return this.matchNode("previousSibling","previousSibling",a,b)},first:function(a,b){return this.matchNode("nextSibling","firstChild",a,b)},last:function(a,b){return this.matchNode("previousSibling","lastChild",a,b)},matchNode:function(b,e,a,c){if(!this.dom){return null}var d=this.dom[e];while(d){if(d.nodeType==1&&(!a||Ext.DomQuery.is(d,a))){return !c?Ext.get(d):d}d=d[b]}return null},isAncestor:function(a){return this.self.isAncestor.call(this.self,this.dom,a)}});Ext.define("Ext.dom.AbstractElement",{trimRe:/^\s+|\s+$/g,whitespaceRe:/\s/,inheritableStatics:{trimRe:/^\s+|\s+$/g,whitespaceRe:/\s/,get:function(c){var i=this,j=window.document,d=Ext.dom.Element,h,b,g,e,a;if(!c){return null}if(c.isFly){c=c.dom}if(typeof c=="string"){if(c==Ext.windowId){return d.get(window)}else{if(c==Ext.documentId){return d.get(j)}}h=Ext.cache[c];if(h&&h.skipGarbageCollection){g=h.el;return g}if(!(e=j.getElementById(c))){return null}if(h&&h.el){g=Ext.updateCacheEntry(h,e).el}else{g=new d(e,!!h)}return g}else{if(c.tagName){if(!(a=c.id)){a=Ext.id(c)}h=Ext.cache[a];if(h&&h.el){g=Ext.updateCacheEntry(h,c).el}else{g=new d(c,!!h)}return g}else{if(c instanceof i){if(c!=i.docEl&&c!=i.winEl){a=c.id;h=Ext.cache[a];if(h){Ext.updateCacheEntry(h,j.getElementById(a)||c.dom)}}return c}else{if(c.isComposite){return c}else{if(Ext.isArray(c)){return i.select(c)}else{if(c===j){if(!i.docEl){b=i.docEl=Ext.Object.chain(d.prototype);b.dom=j;b.el=b;b.id=Ext.id(j);i.addToCache(b)}return i.docEl}else{if(c===window){if(!i.winEl){i.winEl=Ext.Object.chain(d.prototype);i.winEl.dom=window;i.winEl.id=Ext.id(window);i.addToCache(i.winEl)}return i.winEl}}}}}}}return null},addToCache:function(a,b){if(a){Ext.addCacheEntry(b,a)}return a},addMethods:function(){this.override.apply(this,arguments)},mergeClsList:function(){var m,k={},g,b,d,h,c,n=[],e=false,a=this.trimRe,l=this.whitespaceRe;for(g=0,b=arguments.length;g<b;g++){m=arguments[g];if(Ext.isString(m)){m=m.replace(a,"").split(l)}if(m){for(d=0,h=m.length;d<h;d++){c=m[d];if(!k[c]){if(g){e=true}k[c]=true}}}}for(c in k){n.push(c)}n.changed=e;return n},removeCls:function(a,b){var h={},g,c,d,k=[],e=false,j=this.whitespaceRe;if(a){if(Ext.isString(a)){a=a.replace(this.trimRe,"").split(j)}for(g=0,c=a.length;g<c;g++){h[a[g]]=true}}if(b){if(Ext.isString(b)){b=b.split(j)}for(g=0,c=b.length;g<c;g++){d=b[g];if(h[d]){e=true;delete h[d]}}}for(d in h){k.push(d)}k.changed=e;return k},VISIBILITY:1,DISPLAY:2,OFFSETS:3,ASCLASS:4},constructor:function(a,b){var c=this,d=typeof a=="string"?document.getElementById(a):a,e;c.el=c;if(!d){return null}e=d.id;if(!b&&e&&Ext.cache[e]){return Ext.cache[e].el}c.dom=d;c.id=e||Ext.id(d);c.self.addToCache(c)},set:function(e,b){var c=this.dom,a,d;for(a in e){if(e.hasOwnProperty(a)){d=e[a];if(a=="style"){this.applyStyles(d)}else{if(a=="cls"){c.className=d}else{if(b!==false){if(d===undefined){c.removeAttribute(a)}else{c.setAttribute(a,d)}}else{c[a]=d}}}}}return this},defaultUnit:"px",is:function(a){return Ext.DomQuery.is(this.dom,a)},getValue:function(a){var b=this.dom.value;return a?parseInt(b,10):b},remove:function(){var a=this,b=a.dom;if(a.isAnimate){a.stopAnimation()}if(b){Ext.removeNode(b);delete a.dom}},contains:function(a){if(!a){return false}var b=this,c=a.dom||a;return(c===b.dom)||Ext.dom.AbstractElement.isAncestor(b.dom,c)},getAttribute:function(a,b){var c=this.dom;return c.getAttributeNS(b,a)||c.getAttribute(b+":"+a)||c.getAttribute(a)||c[a]},update:function(a){if(this.dom){this.dom.innerHTML=a}return this},setHTML:function(a){if(this.dom){this.dom.innerHTML=a}return this},getHTML:function(){return this.dom?this.dom.innerHTML:""},hide:function(){this.setVisible(false);return this},show:function(){this.setVisible(true);return this},setVisible:function(g,a){var b=this,e=b.self,d=b.getVisibilityMode(),c=Ext.baseCSSPrefix;switch(d){case e.VISIBILITY:b.removeCls([c+"hidden-display",c+"hidden-offsets"]);b[g?"removeCls":"addCls"](c+"hidden-visibility");break;case e.DISPLAY:b.removeCls([c+"hidden-visibility",c+"hidden-offsets"]);b[g?"removeCls":"addCls"](c+"hidden-display");break;case e.OFFSETS:b.removeCls([c+"hidden-visibility",c+"hidden-display"]);b[g?"removeCls":"addCls"](c+"hidden-offsets");break}return b},getVisibilityMode:function(){var b=(this.$cache||this.getCache()).data,a=b.visibilityMode;if(a===undefined){b.visibilityMode=a=this.self.DISPLAY}return a},setVisibilityMode:function(a){(this.$cache||this.getCache()).data.visibilityMode=a;return this},getCache:function(){var a=this,b=a.dom.id||Ext.id(a.dom);a.$cache=Ext.cache[b]||Ext.addCacheEntry(b,null,a.dom);return a.$cache}},function(){var a=this;Ext.getDetachedBody=function(){var b=a.detachedBodyEl;if(!b){b=document.createElement("div");a.detachedBodyEl=b=new a.Fly(b);b.isDetachedBody=true}return b};Ext.getElementById=function(d){var c=document.getElementById(d),b;if(!c&&(b=a.detachedBodyEl)){c=b.dom.querySelector("#"+Ext.escapeId(d))}return c};Ext.get=function(b){return Ext.dom.Element.get(b)};this.addStatics({Fly:new Ext.Class({extend:a,isFly:true,constructor:function(b){this.dom=b;this.el=this},attach:function(b){this.dom=b;this.$cache=b.id?Ext.cache[b.id]:null;return this}}),_flyweights:{},fly:function(e,c){var d=null,b=a._flyweights;c=c||"_global";e=Ext.getDom(e);if(e){d=b[c]||(b[c]=new a.Fly());d.dom=e;d.$cache=e.id?Ext.cache[e.id]:null}return d}});Ext.fly=function(){return a.fly.apply(a,arguments)};(function(b){b.destroy=b.remove;if(document.querySelector){b.getById=function(e,c){var d=document.getElementById(e)||this.dom.querySelector("#"+Ext.escapeId(e));return c?d:(d?Ext.get(d):null)}}else{b.getById=function(e,c){var d=document.getElementById(e);return c?d:(d?Ext.get(d):null)}}}(this.prototype))});Ext.define("Ext.dom.Helper",(function(){var b="afterbegin",i="afterend",a="beforebegin",o="beforeend",l="<table>",h="</table>",c=l+"<tbody>",n="</tbody>"+h,k=c+"<tr>",e="</tr>"+n,p=document.createElement("div"),m=["BeforeBegin","previousSibling"],j=["AfterEnd","nextSibling"],d={beforebegin:m,afterend:j},g={beforebegin:m,afterend:j,afterbegin:["AfterBegin","firstChild"],beforeend:["BeforeEnd","lastChild"]};return{extend:Ext.dom.AbstractHelper,tableRe:/^(?:table|thead|tbody|tr|td)$/i,tableElRe:/td|tr|tbody|thead/i,useDom:false,createDom:function(q,w){var r,z=document,u,x,s,y,v,t;if(Ext.isArray(q)){r=z.createDocumentFragment();for(v=0,t=q.length;v<t;v++){this.createDom(q[v],r)}}else{if(typeof q=="string"){r=z.createTextNode(q)}else{r=z.createElement(q.tag||"div");u=!!r.setAttribute;for(x in q){if(!this.confRe.test(x)){s=q[x];if(x=="cls"){r.className=s}else{if(u){r.setAttribute(x,s)}else{r[x]=s}}}}Ext.DomHelper.applyStyles(r,q.style);if((y=q.children||q.cn)){this.createDom(y,r)}else{if(q.html){r.innerHTML=q.html}}}}if(w){w.appendChild(r)}return r},ieTable:function(v,q,w,u){p.innerHTML=[q,w,u].join("");var r=-1,t=p,s;while(++r<v){t=t.firstChild}s=t.nextSibling;if(s){s=t;t=document.createDocumentFragment();while(s){nx=s.nextSibling;t.appendChild(s);s=nx}}return t},insertIntoTable:function(z,s,r,t){var q,w,v=s==a,y=s==b,u=s==o,x=s==i;if(z=="td"&&(y||u)||!this.tableElRe.test(z)&&(v||x)){return null}w=v?r:x?r.nextSibling:y?r.firstChild:null;if(v||x){r=r.parentNode}if(z=="td"||(z=="tr"&&(u||y))){q=this.ieTable(4,k,t,e)}else{if(((z=="tbody"||z=="thead")&&(u||y))||(z=="tr"&&(v||x))){q=this.ieTable(3,c,t,n)}else{q=this.ieTable(2,l,t,h)}}r.insertBefore(q,w);return q},createContextualFragment:function(r){var q=document.createDocumentFragment(),s,t;p.innerHTML=r;t=p.childNodes;s=t.length;while(s--){q.appendChild(t[0])}return q},applyStyles:function(q,r){if(r){if(typeof r=="function"){r=r.call()}if(typeof r=="string"){r=Ext.dom.Element.parseStyles(r)}if(typeof r=="object"){Ext.fly(q,"_applyStyles").setStyle(r)}}},createHtml:function(q){return this.markup(q)},doInsert:function(t,v,u,w,s,q){t=t.dom||Ext.getDom(t);var r;if(this.useDom){r=this.createDom(v,null);if(q){t.appendChild(r)}else{(s=="firstChild"?t:t.parentNode).insertBefore(r,t[s]||t)}}else{r=this.insertHtml(w,t,this.markup(v))}return u?Ext.get(r,true):r},overwrite:function(s,r,t){var q;s=Ext.getDom(s);r=this.markup(r);if(Ext.isIE&&this.tableRe.test(s.tagName)){while(s.firstChild){s.removeChild(s.firstChild)}if(r){q=this.insertHtml("afterbegin",s,r);return t?Ext.get(q):q}return null}s.innerHTML=r;return t?Ext.get(s.firstChild):s.firstChild},insertHtml:function(s,v,t){var x,r,u,q,w;s=s.toLowerCase();if(v.insertAdjacentHTML){if(Ext.isIE&&this.tableRe.test(v.tagName)&&(w=this.insertIntoTable(v.tagName.toLowerCase(),s,v,t))){return w}if((x=g[s])){if(Ext.global.MSApp&&Ext.global.MSApp.execUnsafeLocalFunction){MSApp.execUnsafeLocalFunction(function(){v.insertAdjacentHTML(x[0],t)})}else{v.insertAdjacentHTML(x[0],t)}return v[x[1]]}}else{if(v.nodeType===3){s=s==="afterbegin"?"beforebegin":s;s=s==="beforeend"?"afterend":s}r=Ext.supports.CreateContextualFragment?v.ownerDocument.createRange():undefined;q="setStart"+(this.endRe.test(s)?"After":"Before");if(d[s]){if(r){r[q](v);w=r.createContextualFragment(t)}else{w=this.createContextualFragment(t)}v.parentNode.insertBefore(w,s==a?v:v.nextSibling);return v[(s==a?"previous":"next")+"Sibling"]}else{u=(s==b?"first":"last")+"Child";if(v.firstChild){if(r){r[q](v[u]);w=r.createContextualFragment(t)}else{w=this.createContextualFragment(t)}if(s==b){v.insertBefore(w,v.firstChild)}else{v.appendChild(w)}}else{v.innerHTML=t}return v[u]}}},createTemplate:function(r){var q=this.markup(r);return new Ext.Template(q)}}})(),function(){Ext.ns("Ext.core");Ext.DomHelper=Ext.core.DomHelper=new this});Ext.define("Ext.Template",{inheritableStatics:{from:function(b,a){b=Ext.getDom(b);return new this(b.value||b.innerHTML,a||"")}},constructor:function(d){var g=this,b=arguments,a=[],c=0,e=b.length,h;g.initialConfig={};if(e===1&&Ext.isArray(d)){b=d;e=b.length}if(e>1){for(;c<e;c++){h=b[c];if(typeof h=="object"){Ext.apply(g.initialConfig,h);Ext.apply(g,h)}else{a.push(h)}}}else{a.push(d)}g.html=a.join("");if(g.compiled){g.compile()}},isTemplate:true,disableFormats:false,re:/\{([\w\-]+)(?:\:([\w\.]*)(?:\((.*?)?\))?)?\}/g,apply:function(a){var h=this,d=h.disableFormats!==true,g=Ext.util.Format,c=h,b;if(h.compiled){return h.compiled(a).join("")}function e(i,k,l,j){if(l&&d){if(j){j=[a[k]].concat(Ext.functionFactory("return ["+j+"];")())}else{j=[a[k]]}if(l.substr(0,5)=="this."){return c[l.substr(5)].apply(c,j)}else{return g[l].apply(g,j)}}else{return a[k]!==undefined?a[k]:""}}b=h.html.replace(h.re,e);return b},applyOut:function(a,b){var c=this;if(c.compiled){b.push.apply(b,c.compiled(a))}else{b.push(c.apply(a))}return b},applyTemplate:function(){return this.apply.apply(this,arguments)},set:function(a,c){var b=this;b.html=a;b.compiled=null;return c?b.compile():b},compileARe:/\\/g,compileBRe:/(\r\n|\n)/g,compileCRe:/'/g,compile:function(){var me=this,fm=Ext.util.Format,useFormat=me.disableFormats!==true,body,bodyReturn;function fn(m,name,format,args){if(format&&useFormat){args=args?","+args:"";if(format.substr(0,5)!="this."){format="fm."+format+"("}else{format="this."+format.substr(5)+"("}}else{args="";format="(values['"+name+"'] == undefined ? '' : "}return"',"+format+"values['"+name+"']"+args+") ,'"}bodyReturn=me.html.replace(me.compileARe,"\\\\").replace(me.compileBRe,"\\n").replace(me.compileCRe,"\\'").replace(me.re,fn);body="this.compiled = function(values){ return ['"+bodyReturn+"'];};";eval(body);return me},insertFirst:function(b,a,c){return this.doInsert("afterBegin",b,a,c)},insertBefore:function(b,a,c){return this.doInsert("beforeBegin",b,a,c)},insertAfter:function(b,a,c){return this.doInsert("afterEnd",b,a,c)},append:function(b,a,c){return this.doInsert("beforeEnd",b,a,c)},doInsert:function(b,d,a,e){var c=Ext.DomHelper.insertHtml(b,Ext.getDom(d),this.apply(a));return e?Ext.get(c):c},overwrite:function(c,a,d){var b=Ext.DomHelper.overwrite(Ext.getDom(c),this.apply(a));return d?Ext.get(b):b}});Ext.define("Ext.XTemplateParser",{constructor:function(a){Ext.apply(this,a)},doTpl:Ext.emptyFn,parse:function(l){var v=this,p=l.length,o={elseif:"elif"},q=v.topRe,c=v.actionsRe,e,d,j,n,h,k,i,u,r,b,g,a;v.level=0;v.stack=d=[];for(e=0;e<p;e=b){q.lastIndex=e;n=q.exec(l);if(!n){v.doText(l.substring(e,p));break}r=n.index;b=q.lastIndex;if(e<r){v.doText(l.substring(e,r))}if(n[1]){b=l.indexOf("%}",r+2);v.doEval(l.substring(r+2,b));b+=2}else{if(n[2]){b=l.indexOf("]}",r+2);v.doExpr(l.substring(r+2,b));b+=2}else{if(n[3]){v.doTag(n[3])}else{if(n[4]){g=null;while((u=c.exec(n[4]))!==null){j=u[2]||u[3];if(j){j=Ext.String.htmlDecode(j);h=u[1];h=o[h]||h;g=g||{};k=g[h];if(typeof k=="string"){g[h]=[k,j]}else{if(k){g[h].push(j)}else{g[h]=j}}}}if(!g){if(v.elseRe.test(n[4])){v.doElse()}else{if(v.defaultRe.test(n[4])){v.doDefault()}else{v.doTpl();d.push({type:"tpl"})}}}else{if(g["if"]){v.doIf(g["if"],g);d.push({type:"if"})}else{if(g["switch"]){v.doSwitch(g["switch"],g);d.push({type:"switch"})}else{if(g["case"]){v.doCase(g["case"],g)}else{if(g.elif){v.doElseIf(g.elif,g)}else{if(g["for"]){++v.level;if(a=v.propRe.exec(n[4])){g.propName=a[1]||a[2]}v.doFor(g["for"],g);d.push({type:"for",actions:g})}else{if(g.foreach){++v.level;if(a=v.propRe.exec(n[4])){g.propName=a[1]||a[2]}v.doForEach(g.foreach,g);d.push({type:"foreach",actions:g})}else{if(g.exec){v.doExec(g.exec,g);d.push({type:"exec",actions:g})}}}}}}}}}else{if(n[0].length===5){d.push({type:"tpl"})}else{i=d.pop();v.doEnd(i.type,i.actions);if(i.type=="for"||i.type=="foreach"){--v.level}}}}}}}},topRe:/(?:(\{\%)|(\{\[)|\{([^{}]+)\})|(?:<tpl([^>]*)\>)|(?:<\/tpl>)/g,actionsRe:/\s*(elif|elseif|if|for|foreach|exec|switch|case|eval|between)\s*\=\s*(?:(?:"([^"]*)")|(?:'([^']*)'))\s*/g,propRe:/prop=(?:(?:"([^"]*)")|(?:'([^']*)'))/,defaultRe:/^\s*default\s*$/,elseRe:/^\s*else\s*$/});Ext.define("Ext.XTemplateCompiler",{extend:Ext.XTemplateParser,useEval:Ext.isGecko,useIndex:Ext.isIE8m,useFormat:true,propNameRe:/^[\w\d\$]*$/,compile:function(a){var c=this,b=c.generate(a);return c.useEval?c.evalTpl(b):(new Function("Ext",b))(Ext)},generate:function(a){var d=this,b="var fm=Ext.util.Format,ts=Object.prototype.toString;",c;d.maxLevel=0;d.body=["var c0=values, a0="+d.createArrayTest(0)+", p0=parent, n0=xcount, i0=xindex, k0, v;\n"];if(d.definitions){if(typeof d.definitions==="string"){d.definitions=[d.definitions,b]}else{d.definitions.push(b)}}else{d.definitions=[b]}d.switches=[];d.parse(a);d.definitions.push((d.useEval?"$=":"return")+" function ("+d.fnArgs+") {",d.body.join(""),"}");c=d.definitions.join("\n");d.definitions.length=d.body.length=d.switches.length=0;delete d.definitions;delete d.body;delete d.switches;return c},doText:function(c){var b=this,a=b.body;c=c.replace(b.aposRe,"\\'").replace(b.newLineRe,"\\n");if(b.useIndex){a.push("out[out.length]='",c,"'\n")}else{a.push("out.push('",c,"')\n")}},doExpr:function(b){var a=this.body;a.push("if ((v="+b+") != null) out");if(this.useIndex){a.push("[out.length]=v+''\n")}else{a.push(".push(v+'')\n")}},doTag:function(a){var b=this.parseTag(a);if(b){this.doExpr(b)}else{this.doText("{"+a+"}")}},doElse:function(){this.body.push("} else {\n")},doEval:function(a){this.body.push(a,"\n")},doIf:function(b,c){var a=this;if(b==="."){a.body.push("if (values) {\n")}else{if(a.propNameRe.test(b)){a.body.push("if (",a.parseTag(b),") {\n")}else{a.body.push("if (",a.addFn(b),a.callFn,") {\n")}}if(c.exec){a.doExec(c.exec)}},doElseIf:function(b,c){var a=this;if(b==="."){a.body.push("else if (values) {\n")}else{if(a.propNameRe.test(b)){a.body.push("} else if (",a.parseTag(b),") {\n")}else{a.body.push("} else if (",a.addFn(b),a.callFn,") {\n")}}if(c.exec){a.doExec(c.exec)}},doSwitch:function(b){var a=this;if(b==="."){a.body.push("switch (values) {\n")}else{if(a.propNameRe.test(b)){a.body.push("switch (",a.parseTag(b),") {\n")}else{a.body.push("switch (",a.addFn(b),a.callFn,") {\n")}}a.switches.push(0)},doCase:function(e){var d=this,c=Ext.isArray(e)?e:[e],g=d.switches.length-1,a,b;if(d.switches[g]){d.body.push("break;\n")}else{d.switches[g]++}for(b=0,g=c.length;b<g;++b){a=d.intRe.exec(c[b]);c[b]=a?a[1]:("'"+c[b].replace(d.aposRe,"\\'")+"'")}d.body.push("case ",c.join(": case "),":\n")},doDefault:function(){var a=this,b=a.switches.length-1;if(a.switches[b]){a.body.push("break;\n")}else{a.switches[b]++}a.body.push("default:\n")},doEnd:function(b,d){var c=this,a=c.level-1;if(b=="for"||b=="foreach"){if(d.exec){c.doExec(d.exec)}c.body.push("}\n");c.body.push("parent=p",a,";values=r",a+1,";xcount=n"+a+";xindex=i",a,"+1;xkey=k",a,";\n")}else{if(b=="if"||b=="switch"){c.body.push("}\n")}}},doFor:function(e,h){var d=this,c,b=d.level,a=b-1,g;if(e==="."){c="values"}else{if(d.propNameRe.test(e)){c=d.parseTag(e)}else{c=d.addFn(e)+d.callFn}}if(d.maxLevel<b){d.maxLevel=b;d.body.push("var ")}if(e=="."){g="c"+b}else{g="a"+a+"?c"+a+"[i"+a+"]:c"+a}d.body.push("i",b,"=0,n",b,"=0,c",b,"=",c,",a",b,"=",d.createArrayTest(b),",r",b,"=values,p",b,",k",b,";\n","p",b,"=parent=",g,"\n","if (c",b,"){if(a",b,"){n",b,"=c",b,".length;}else if (c",b,".isMixedCollection){c",b,"=c",b,".items;n",b,"=c",b,".length;}else if(c",b,".isStore){c",b,"=c",b,".data.items;n",b,"=c",b,".length;}else{c",b,"=[c",b,"];n",b,"=1;}}\n","for (xcount=n",b,";i",b,"<n"+b+";++i",b,"){\n","values=c",b,"[i",b,"]");if(h.propName){d.body.push(".",h.propName)}d.body.push("\n","xindex=i",b,"+1\n");if(h.between){d.body.push('if(xindex>1){ out.push("',h.between,'"); } \n')}},doForEach:function(e,h){var d=this,c,b=d.level,a=b-1,g;if(e==="."){c="values"}else{if(d.propNameRe.test(e)){c=d.parseTag(e)}else{c=d.addFn(e)+d.callFn}}if(d.maxLevel<b){d.maxLevel=b;d.body.push("var ")}if(e=="."){g="c"+b}else{g="a"+a+"?c"+a+"[i"+a+"]:c"+a}d.body.push("i",b,"=-1,n",b,"=0,c",b,"=",c,",a",b,"=",d.createArrayTest(b),",r",b,"=values,p",b,",k",b,";\n","p",b,"=parent=",g,"\n","for(k",b," in c",b,"){\n","xindex=++i",b,"+1;\n","xkey=k",b,";\n","values=c",b,"[k",b,"];");if(h.propName){d.body.push(".",h.propName)}if(h.between){d.body.push('if(xindex>1){ out.push("',h.between,'"); } \n')}},createArrayTest:("isArray" in Array)?function(a){return"Array.isArray(c"+a+")"}:function(a){return"ts.call(c"+a+')==="[object Array]"'},doExec:function(c,d){var b=this,a="f"+b.definitions.length;b.definitions.push("function "+a+"("+b.fnArgs+") {"," try { with(values) {","  "+c," }} catch(e) {","}","}");b.body.push(a+b.callFn+"\n")},addFn:function(a){var c=this,b="f"+c.definitions.length;if(a==="."){c.definitions.push("function "+b+"("+c.fnArgs+") {"," return values","}")}else{if(a===".."){c.definitions.push("function "+b+"("+c.fnArgs+") {"," return parent","}")}else{c.definitions.push("function "+b+"("+c.fnArgs+") {"," try { with(values) {","  return("+a+")"," }} catch(e) {","}","}")}}return b},parseTag:function(b){var h=this,a=h.tagRe.exec(b),e,i,d,g,c;if(!a){return null}e=a[1];i=a[2];d=a[3];g=a[4];if(e=="."){if(!h.validTypes){h.definitions.push("var validTypes={string:1,number:1,boolean:1};");h.validTypes=true}c='validTypes[typeof values] || ts.call(values) === "[object Date]" ? values : ""'}else{if(e=="#"){c="xindex"}else{if(e=="$"){c="xkey"}else{if(e.substr(0,7)=="parent."){c=e}else{if(isNaN(e)&&e.indexOf("-")==-1&&e.indexOf(".")!=-1){c="values."+e}else{c="values['"+e+"']"}}}}}if(g){c="("+c+g+")"}if(i&&h.useFormat){d=d?","+d:"";if(i.substr(0,5)!="this."){i="fm."+i+"("}else{i+="("}}else{return c}return i+c+d+")"},evalTpl:function($){eval($);return $},newLineRe:/\r\n|\r|\n/g,aposRe:/[']/g,intRe:/^\s*(\d+)\s*$/,tagRe:/^([\w-\.\#\$]+)(?:\:([\w\.]*)(?:\((.*?)?\))?)?(\s?[\+\-\*\/]\s?[\d\.\+\-\*\/\(\)]+)?$/},function(){var a=this.prototype;a.fnArgs="out,values,parent,xindex,xcount,xkey";a.callFn=".call(this,"+a.fnArgs+")"});Ext.define("Ext.XTemplate",{extend:Ext.Template,emptyObj:{},apply:function(a,b){return this.applyOut(a,[],b).join("")},applyOut:function(a,b,d){var g=this,c;if(!g.fn){c=new Ext.XTemplateCompiler({useFormat:g.disableFormats!==true,definitions:g.definitions});g.fn=c.compile(g.html)}try{g.fn(b,a,d||g.emptyObj,1,1)}catch(h){}return b},compile:function(){return this},statics:{getTpl:function(b,d){var c=b[d],a;if(c&&!c.isTemplate){c=Ext.ClassManager.dynInstantiate("Ext.XTemplate",c);if(b.hasOwnProperty(d)){a=b}else{for(a=b.self.prototype;a&&!a.hasOwnProperty(d);a=a.superclass){}}a[d]=c;c.owner=a}return c||null}}});Ext.ns("Ext.core");Ext.dom.Query=Ext.core.DomQuery=Ext.DomQuery=(function(){var DQ,doc=document,cache={},simpleCache={},valueCache={},useClassList=!!doc.documentElement.classList,useElementPointer=!!doc.documentElement.firstElementChild,useChildrenCollection=(function(){var d=doc.createElement("div");d.innerHTML="<!-- -->text<!-- -->";return d.children&&(d.children.length===0)})(),nonSpace=/\S/,trimRe=/^\s+|\s+$/g,tplRe=/\{(\d+)\}/g,modeRe=/^(\s?[\/>+~]\s?|\s|$)/,tagTokenRe=/^(#)?([\w\-\*\|\\]+)/,nthRe=/(\d*)n\+?(\d*)/,nthRe2=/\D/,startIdRe=/^\s*#/,isIE=window.ActiveXObject?true:false,key=30803,longHex=/\\([0-9a-fA-F]{6})/g,shortHex=/\\([0-9a-fA-F]{1,6})\s{0,1}/g,nonHex=/\\([^0-9a-fA-F]{1})/g,escapes=/\\/g,num,hasEscapes,supportsColonNsSeparator=(function(){var xmlDoc,xmlString='<r><a:b xmlns:a="n"></a:b></r>';if(window.DOMParser){xmlDoc=(new DOMParser()).parseFromString(xmlString,"application/xml")}else{xmlDoc=new ActiveXObject("Microsoft.XMLDOM");xmlDoc.loadXML(xmlString)}return !!xmlDoc.getElementsByTagName("a:b").length})(),longHexToChar=function($0,$1){return String.fromCharCode(parseInt($1,16))},shortToLongHex=function($0,$1){while($1.length<6){$1="0"+$1}return"\\"+$1},charToLongHex=function($0,$1){num=$1.charCodeAt(0).toString(16);if(num.length===1){num="0"+num}return"\\0000"+num},unescapeCssSelector=function(selector){return(hasEscapes)?selector.replace(longHex,longHexToChar):selector},setupEscapes=function(path){hasEscapes=(path.indexOf("\\")>-1);if(hasEscapes){path=path.replace(shortHex,shortToLongHex).replace(nonHex,charToLongHex).replace(escapes,"\\\\")}return path};eval("var batch = 30803, child, next, prev, byClassName;");child=useChildrenCollection?function child(parent,index){return parent.children[index]}:function child(parent,index){var i=0,n=parent.firstChild;while(n){if(n.nodeType==1){if(++i==index){return n}}n=n.nextSibling}return null};next=useElementPointer?function(n){return n.nextElementSibling}:function(n){while((n=n.nextSibling)&&n.nodeType!=1){}return n};prev=useElementPointer?function(n){return n.previousElementSibling}:function(n){while((n=n.previousSibling)&&n.nodeType!=1){}return n};function children(parent){var n=parent.firstChild,nodeIndex=-1,nextNode;while(n){nextNode=n.nextSibling;if(n.nodeType==3&&!nonSpace.test(n.nodeValue)){parent.removeChild(n)}else{n.nodeIndex=++nodeIndex}n=nextNode}return this}byClassName=useClassList?function(nodeSet,cls){cls=unescapeCssSelector(cls);if(!cls){return nodeSet}var result=[],ri=-1,i,ci,classList;for(i=0;ci=nodeSet[i];i++){classList=ci.classList;if(classList){if(classList.contains(cls)){result[++ri]=ci}}else{if((" "+ci.className+" ").indexOf(cls)!==-1){result[++ri]=ci}}}return result}:function(nodeSet,cls){cls=unescapeCssSelector(cls);if(!cls){return nodeSet}var result=[],ri=-1,i,ci;for(i=0;ci=nodeSet[i];i++){if((" "+ci.className+" ").indexOf(cls)!==-1){result[++ri]=ci}}return result};function attrValue(n,attr){if(!n.tagName&&typeof n.length!="undefined"){n=n[0]}if(!n){return null}if(attr=="for"){return n.htmlFor}if(attr=="class"||attr=="className"){return n.className}return n.getAttribute(attr)||n[attr]}function getNodes(ns,mode,tagName){var result=[],ri=-1,cs,i,ni,j,ci,cn,utag,n,cj;if(!ns){return result}tagName=tagName.replace("|",":")||"*";if(typeof ns.getElementsByTagName!="undefined"){ns=[ns]}if(!mode){tagName=unescapeCssSelector(tagName);if(!supportsColonNsSeparator&&DQ.isXml(ns[0])&&tagName.indexOf(":")!==-1){for(i=0;ni=ns[i];i++){cs=ni.getElementsByTagName(tagName.split(":").pop());for(j=0;ci=cs[j];j++){if(ci.tagName===tagName){result[++ri]=ci}}}}else{for(i=0;ni=ns[i];i++){cs=ni.getElementsByTagName(tagName);for(j=0;ci=cs[j];j++){result[++ri]=ci}}}}else{if(mode=="/"||mode==">"){utag=tagName.toUpperCase();for(i=0;ni=ns[i];i++){cn=ni.childNodes;for(j=0;cj=cn[j];j++){if(cj.nodeName==utag||cj.nodeName==tagName||tagName=="*"){result[++ri]=cj}}}}else{if(mode=="+"){utag=tagName.toUpperCase();for(i=0;n=ns[i];i++){while((n=n.nextSibling)&&n.nodeType!=1){}if(n&&(n.nodeName==utag||n.nodeName==tagName||tagName=="*")){result[++ri]=n}}}else{if(mode=="~"){utag=tagName.toUpperCase();for(i=0;n=ns[i];i++){while((n=n.nextSibling)){if(n.nodeName==utag||n.nodeName==tagName||tagName=="*"){result[++ri]=n}}}}}}}return result}function concat(a,b){a.push.apply(a,b);return a}function byTag(cs,tagName){if(cs.tagName||cs===doc){cs=[cs]}if(!tagName){return cs}var result=[],ri=-1,i,ci;tagName=tagName.toLowerCase();for(i=0;ci=cs[i];i++){if(ci.nodeType==1&&ci.tagName.toLowerCase()==tagName){result[++ri]=ci}}return result}function byId(cs,id){id=unescapeCssSelector(id);if(cs.tagName||cs===doc){cs=[cs]}if(!id){return cs}var result=[],ri=-1,i,ci;for(i=0;ci=cs[i];i++){if(ci&&ci.id==id){result[++ri]=ci;return result}}return result}function byAttribute(cs,attr,value,op,custom){var result=[],ri=-1,useGetStyle=custom=="{",fn=DQ.operators[op],a,xml,hasXml,i,ci;value=unescapeCssSelector(value);for(i=0;ci=cs[i];i++){if(ci.nodeType===1){if(!hasXml){xml=DQ.isXml(ci);hasXml=true}if(!xml){if(useGetStyle){a=DQ.getStyle(ci,attr)}else{if(attr=="class"||attr=="className"){a=ci.className}else{if(attr=="for"){a=ci.htmlFor}else{if(attr=="href"){a=ci.getAttribute("href",2)}else{a=ci.getAttribute(attr)}}}}}else{a=ci.getAttribute(attr)}if((fn&&fn(a,value))||(!fn&&a)){result[++ri]=ci}}}return result}function byPseudo(cs,name,value){value=unescapeCssSelector(value);return DQ.pseudos[name](cs,value)}function nodupIEXml(cs){var d=++key,r,i,len,c;cs[0].setAttribute("_nodup",d);r=[cs[0]];for(i=1,len=cs.length;i<len;i++){c=cs[i];if(!c.getAttribute("_nodup")!=d){c.setAttribute("_nodup",d);r[r.length]=c}}for(i=0,len=cs.length;i<len;i++){cs[i].removeAttribute("_nodup")}return r}function nodup(cs){if(!cs){return[]}var len=cs.length,c,i,r=cs,cj,ri=-1,d,j;if(!len||typeof cs.nodeType!="undefined"||len==1){return cs}if(isIE&&typeof cs[0].selectSingleNode!="undefined"){return nodupIEXml(cs)}d=++key;cs[0]._nodup=d;for(i=1;c=cs[i];i++){if(c._nodup!=d){c._nodup=d}else{r=[];for(j=0;j<i;j++){r[++ri]=cs[j]}for(j=i+1;cj=cs[j];j++){if(cj._nodup!=d){cj._nodup=d;r[++ri]=cj}}return r}}return r}function quickDiffIEXml(c1,c2){var d=++key,r=[],i,len;for(i=0,len=c1.length;i<len;i++){c1[i].setAttribute("_qdiff",d)}for(i=0,len=c2.length;i<len;i++){if(c2[i].getAttribute("_qdiff")!=d){r[r.length]=c2[i]}}for(i=0,len=c1.length;i<len;i++){c1[i].removeAttribute("_qdiff")}return r}function quickDiff(c1,c2){var len1=c1.length,d=++key,r=[],i,len;if(!len1){return c2}if(isIE&&typeof c1[0].selectSingleNode!="undefined"){return quickDiffIEXml(c1,c2)}for(i=0;i<len1;i++){c1[i]._qdiff=d}for(i=0,len=c2.length;i<len;i++){if(c2[i]._qdiff!=d){r[r.length]=c2[i]}}return r}function quickId(ns,mode,root,id){if(ns==root){id=unescapeCssSelector(id);var d=root.ownerDocument||root;return d.getElementById(id)}ns=getNodes(ns,mode,"*");return byId(ns,id)}return DQ={getStyle:function(el,name){return Ext.fly(el,"_DomQuery").getStyle(name)},compile:function(path,type){type=type||"select";var fn=["var f = function(root) {\n var mode; ++batch; var n = root || document;\n"],lastPath,matchers=DQ.matchers,matchersLn=matchers.length,modeMatch,lmode=path.match(modeRe),tokenMatch,matched,j,t,m;path=setupEscapes(path);if(lmode&&lmode[1]){fn[fn.length]='mode="'+lmode[1].replace(trimRe,"")+'";';path=path.replace(lmode[1],"")}while(path.substr(0,1)=="/"){path=path.substr(1)}while(path&&lastPath!=path){lastPath=path;tokenMatch=path.match(tagTokenRe);if(type=="select"){if(tokenMatch){if(tokenMatch[1]=="#"){fn[fn.length]='n = quickId(n, mode, root, "'+tokenMatch[2]+'");'}else{fn[fn.length]='n = getNodes(n, mode, "'+tokenMatch[2]+'");'}path=path.replace(tokenMatch[0],"")}else{if(path.substr(0,1)!="@"){fn[fn.length]='n = getNodes(n, mode, "*");'}}}else{if(tokenMatch){if(tokenMatch[1]=="#"){fn[fn.length]='n = byId(n, "'+tokenMatch[2]+'");'}else{fn[fn.length]='n = byTag(n, "'+tokenMatch[2]+'");'}path=path.replace(tokenMatch[0],"")}}while(!(modeMatch=path.match(modeRe))){matched=false;for(j=0;j<matchersLn;j++){t=matchers[j];m=path.match(t.re);if(m){fn[fn.length]=t.select.replace(tplRe,function(x,i){return m[i]});path=path.replace(m[0],"");matched=true;break}}if(!matched){Ext.Error.raise({sourceClass:"Ext.DomQuery",sourceMethod:"compile",msg:'Error parsing selector. Parsing failed at "'+path+'"'})}}if(modeMatch[1]){fn[fn.length]='mode="'+modeMatch[1].replace(trimRe,"")+'";';path=path.replace(modeMatch[1],"")}}fn[fn.length]="return nodup(n);\n}";eval(fn.join(""));return f},jsSelect:function(path,root,type){root=root||doc;if(typeof root=="string"){root=doc.getElementById(root)}var paths=path.split(","),results=[],i,len,subPath,result;for(i=0,len=paths.length;i<len;i++){subPath=paths[i].replace(trimRe,"");if(!cache[subPath]){cache[subPath]=DQ.compile(subPath,type);if(!cache[subPath]){Ext.Error.raise({sourceClass:"Ext.DomQuery",sourceMethod:"jsSelect",msg:subPath+" is not a valid selector"})}}else{setupEscapes(subPath)}result=cache[subPath](root);if(result&&result!==doc){results=results.concat(result)}}if(paths.length>1){return nodup(results)}return results},isXml:function(el){var docEl=(el?el.ownerDocument||el:0).documentElement;return docEl?docEl.nodeName!=="HTML":false},select:doc.querySelectorAll?function(path,root,type,single){root=root||doc;if(!DQ.isXml(root)){try{if(root.parentNode&&(root.nodeType!==9)&&path.indexOf(",")===-1&&!startIdRe.test(path)){path="#"+Ext.escapeId(Ext.id(root))+" "+path;root=root.parentNode}return single?[root.querySelector(path)]:Ext.Array.toArray(root.querySelectorAll(path))}catch(e){}}return DQ.jsSelect.call(this,path,root,type)}:function(path,root,type){return DQ.jsSelect.call(this,path,root,type)},selectNode:function(path,root){return Ext.DomQuery.select(path,root,null,true)[0]},selectValue:function(path,root,defaultValue){path=path.replace(trimRe,"");if(!valueCache[path]){valueCache[path]=DQ.compile(path,"select")}else{setupEscapes(path)}var n=valueCache[path](root),v;n=n[0]?n[0]:n;if(typeof n.normalize=="function"){n.normalize()}v=(n&&n.firstChild?n.firstChild.nodeValue:null);return((v===null||v===undefined||v==="")?defaultValue:v)},selectNumber:function(path,root,defaultValue){var v=DQ.selectValue(path,root,defaultValue||0);return parseFloat(v)},is:function(el,ss){if(typeof el=="string"){el=doc.getElementById(el)}var isArray=Ext.isArray(el),result=DQ.filter(isArray?el:[el],ss);return isArray?(result.length==el.length):(result.length>0)},filter:function(els,ss,nonMatches){ss=ss.replace(trimRe,"");if(!simpleCache[ss]){simpleCache[ss]=DQ.compile(ss,"simple")}else{setupEscapes(ss)}var result=simpleCache[ss](els);return nonMatches?quickDiff(result,els):result},matchers:[{re:/^\.([\w\-\\]+)/,select:useClassList?'n = byClassName(n, "{1}");':'n = byClassName(n, " {1} ");'},{re:/^\:([\w\-]+)(?:\(((?:[^\s>\/]*|.*?))\))?/,select:'n = byPseudo(n, "{1}", "{2}");'},{re:/^(?:([\[\{])(?:@)?([\w\-]+)\s?(?:(=|.=)\s?['"]?(.*?)["']?)?[\]\}])/,select:'n = byAttribute(n, "{2}", "{4}", "{3}", "{1}");'},{re:/^#([\w\-\\]+)/,select:'n = byId(n, "{1}");'},{re:/^@([\w\-\.]+)/,select:'return {firstChild:{nodeValue:attrValue(n, "{1}")}};'}],operators:{"=":function(a,v){return a==v},"!=":function(a,v){return a!=v},"^=":function(a,v){return a&&a.substr(0,v.length)==v},"$=":function(a,v){return a&&a.substr(a.length-v.length)==v},"*=":function(a,v){return a&&a.indexOf(v)!==-1},"%=":function(a,v){return(a%v)==0},"|=":function(a,v){return a&&(a==v||a.substr(0,v.length+1)==v+"-")},"~=":function(a,v){return a&&(" "+a+" ").indexOf(" "+v+" ")!=-1}},pseudos:{"first-child":function(c){var r=[],ri=-1,n,i,ci;for(i=0;(ci=n=c[i]);i++){while((n=n.previousSibling)&&n.nodeType!=1){}if(!n){r[++ri]=ci}}return r},"last-child":function(c){var r=[],ri=-1,n,i,ci;for(i=0;(ci=n=c[i]);i++){while((n=n.nextSibling)&&n.nodeType!=1){}if(!n){r[++ri]=ci}}return r},"nth-child":function(c,a){var r=[],ri=-1,m=nthRe.exec(a=="even"&&"2n"||a=="odd"&&"2n+1"||!nthRe2.test(a)&&"n+"+a||a),f=(m[1]||1)-0,l=m[2]-0,i,n,j,cn,pn;for(i=0;n=c[i];i++){pn=n.parentNode;if(batch!=pn._batch){j=0;for(cn=pn.firstChild;cn;cn=cn.nextSibling){if(cn.nodeType==1){cn.nodeIndex=++j}}pn._batch=batch}if(f==1){if(l==0||n.nodeIndex==l){r[++ri]=n}}else{if((n.nodeIndex+l)%f==0){r[++ri]=n}}}return r},"only-child":function(c){var r=[],ri=-1,i,ci;for(i=0;ci=c[i];i++){if(!prev(ci)&&!next(ci)){r[++ri]=ci}}return r},empty:function(c){var r=[],ri=-1,i,ci,cns,j,cn,empty;for(i=0;ci=c[i];i++){cns=ci.childNodes;j=0;empty=true;while(cn=cns[j]){++j;if(cn.nodeType==1||cn.nodeType==3){empty=false;break}}if(empty){r[++ri]=ci}}return r},contains:function(c,v){var r=[],ri=-1,i,ci;for(i=0;ci=c[i];i++){if((ci.textContent||ci.innerText||ci.text||"").indexOf(v)!=-1){r[++ri]=ci}}return r},nodeValue:function(c,v){var r=[],ri=-1,i,ci;for(i=0;ci=c[i];i++){if(ci.firstChild&&ci.firstChild.nodeValue==v){r[++ri]=ci}}return r},checked:function(c){var r=[],ri=-1,i,ci;for(i=0;ci=c[i];i++){if(ci.checked==true){r[++ri]=ci}}return r},not:function(c,ss){return DQ.filter(c,ss,true)},any:function(c,selectors){var ss=selectors.split("|"),r=[],ri=-1,s,i,ci,j;for(i=0;ci=c[i];i++){for(j=0;s=ss[j];j++){if(DQ.is(ci,s)){r[++ri]=ci;break}}}return r},odd:function(c){return this["nth-child"](c,"odd")},even:function(c){return this["nth-child"](c,"even")},nth:function(c,a){return c[a-1]||[]},first:function(c){return c[0]||[]},last:function(c){return c[c.length-1]||[]},has:function(c,ss){var s=DQ.select,r=[],ri=-1,i,ci;for(i=0;ci=c[i];i++){if(s(ss,ci).length>0){r[++ri]=ci}}return r},next:function(c,ss){var is=DQ.is,r=[],ri=-1,i,ci,n;for(i=0;ci=c[i];i++){n=next(ci);if(n&&is(n,ss)){r[++ri]=ci}}return r},prev:function(c,ss){var is=DQ.is,r=[],ri=-1,i,ci,n;for(i=0;ci=c[i];i++){n=prev(ci);if(n&&is(n,ss)){r[++ri]=ci}}return r},focusable:function(candidates){var len=candidates.length,results=[],i=0,c;for(;i<len;i++){c=candidates[i];if(Ext.fly(c,"_DomQuery").isFocusable()){results.push(c)}}return results},visible:function(candidates,deep){var len=candidates.length,results=[],i=0,c;for(;i<len;i++){c=candidates[i];if(Ext.fly(c,"_DomQuery").isVisible(deep)){results.push(c)}}return results}}}}());Ext.query=Ext.DomQuery.select;Ext.define("Ext.dom.Element_anim",{override:"Ext.dom.Element",animate:function(b){var d=this,c,e,a=d.dom.id||Ext.id(d.dom);if(!Ext.fx.Manager.hasFxBlock(a)){if(b.listeners){c=b.listeners;delete b.listeners}if(b.internalListeners){b.listeners=b.internalListeners;delete b.internalListeners}e=new Ext.fx.Anim(d.anim(b));if(c){e.on(c)}Ext.fx.Manager.queueFx(e)}return d},anim:function(a){if(!Ext.isObject(a)){return(a)?{}:false}var b=this,c=a.duration||Ext.fx.Anim.prototype.duration,e=a.easing||"ease",d;if(a.stopAnimation){b.stopAnimation()}Ext.applyIf(a,Ext.fx.Manager.getFxDefaults(b.id));Ext.fx.Manager.setFxDefaults(b.id,{delay:0});d={target:b.dom,remove:a.remove,alternate:a.alternate||false,duration:c,easing:e,callback:a.callback,listeners:a.listeners,iterations:a.iterations||1,scope:a.scope,block:a.block,concurrent:a.concurrent,delay:a.delay||0,paused:true,keyframes:a.keyframes,from:a.from||{},to:Ext.apply({},a)};Ext.apply(d.to,a.to);delete d.to.to;delete d.to.from;delete d.to.remove;delete d.to.alternate;delete d.to.keyframes;delete d.to.iterations;delete d.to.listeners;delete d.to.target;delete d.to.paused;delete d.to.callback;delete d.to.scope;delete d.to.duration;delete d.to.easing;delete d.to.concurrent;delete d.to.block;delete d.to.stopAnimation;delete d.to.delay;return d},slideIn:function(d,c,e){var h=this,b=h.dom,k=b.style,j,a,g,i;d=d||"t";c=c||{};j=function(){var p=this,o=c.listeners,n=Ext.fly(b,"_anim"),q,l,r,m;if(!e){n.fixDisplay()}q=n.getBox();if((d=="t"||d=="b")&&q.height===0){q.height=b.scrollHeight}else{if((d=="l"||d=="r")&&q.width===0){q.width=b.scrollWidth}}l=n.getStyles("width","height","left","right","top","bottom","position","z-index",true);n.setSize(q.width,q.height);if(c.preserveScroll){g=n.cacheScrollValues()}m=n.wrap({id:Ext.id()+"-anim-wrap-for-"+n.dom.id,style:{visibility:e?"visible":"hidden"}});i=m.dom.parentNode;m.setPositioning(n.getPositioning(true));if(m.isStyle("position","static")){m.position("relative")}n.clearPositioning("auto");m.clip();if(g){g()}n.setStyle({visibility:"",position:"absolute"});if(e){m.setSize(q.width,q.height)}switch(d){case"t":r={from:{width:q.width+"px",height:"0px"},to:{width:q.width+"px",height:q.height+"px"}};k.bottom="0px";break;case"l":r={from:{width:"0px",height:q.height+"px"},to:{width:q.width+"px",height:q.height+"px"}};h.anchorAnimX(d);break;case"r":r={from:{x:q.x+q.width,width:"0px",height:q.height+"px"},to:{x:q.x,width:q.width+"px",height:q.height+"px"}};h.anchorAnimX(d);break;case"b":r={from:{y:q.y+q.height,width:q.width+"px",height:"0px"},to:{y:q.y,width:q.width+"px",height:q.height+"px"}};break;case"tl":r={from:{x:q.x,y:q.y,width:"0px",height:"0px"},to:{width:q.width+"px",height:q.height+"px"}};k.bottom="0px";h.anchorAnimX("l");break;case"bl":r={from:{y:q.y+q.height,width:"0px",height:"0px"},to:{y:q.y,width:q.width+"px",height:q.height+"px"}};h.anchorAnimX("l");break;case"br":r={from:{x:q.x+q.width,y:q.y+q.height,width:"0px",height:"0px"},to:{x:q.x,y:q.y,width:q.width+"px",height:q.height+"px"}};h.anchorAnimX("r");break;case"tr":r={from:{x:q.x+q.width,width:"0px",height:"0px"},to:{x:q.x,width:q.width+"px",height:q.height+"px"}};k.bottom="0px";h.anchorAnimX("r");break}m.show();a=Ext.apply({},c);delete a.listeners;a=new Ext.fx.Anim(Ext.applyIf(a,{target:m,duration:500,easing:"ease-out",from:e?r.to:r.from,to:e?r.from:r.to}));a.on("afteranimate",function(){var s=Ext.fly(b,"_anim");s.setStyle(l);if(e){if(c.useDisplay){s.setDisplayed(false)}else{s.hide()}}if(m.dom){if(m.dom.parentNode){m.dom.parentNode.insertBefore(s.dom,m.dom)}else{i.appendChild(s.dom)}m.remove()}if(g){g()}p.end()});if(o){a.on(o)}};h.animate({duration:c.duration?Math.max(c.duration,500)*2:1000,listeners:{beforeanimate:j}});return h},slideOut:function(a,b){return this.slideIn(a,b,true)},puff:function(e){var d=this,g=d.dom,b,c=d.getBox(),a=d.getStyles("width","height","left","right","top","bottom","position","z-index","font-size","opacity",true);e=Ext.applyIf(e||{},{easing:"ease-out",duration:500,useDisplay:false});b=function(){var h=Ext.fly(g,"_anim");h.clearOpacity();h.show();this.to={width:c.width*2,height:c.height*2,x:c.x-(c.width/2),y:c.y-(c.height/2),opacity:0,fontSize:"200%"};this.on("afteranimate",function(){var i=Ext.fly(g,"_anim");if(i){if(e.useDisplay){i.setDisplayed(false)}else{i.hide()}i.setStyle(a);Ext.callback(e.callback,e.scope)}})};d.animate({duration:e.duration,easing:e.easing,listeners:{beforeanimate:{fn:b}}});return d},switchOff:function(c){var b=this,d=b.dom,a;c=Ext.applyIf(c||{},{easing:"ease-in",duration:500,remove:false,useDisplay:false});a=function(){var j=Ext.fly(d,"_anim"),i=this,h=j.getSize(),k=j.getXY(),g,e;j.clearOpacity();j.clip();e=j.getPositioning();g=new Ext.fx.Animator({target:d,duration:c.duration,easing:c.easing,keyframes:{33:{opacity:0.3},66:{height:1,y:k[1]+h.height/2},100:{width:1,x:k[0]+h.width/2}}});g.on("afteranimate",function(){var l=Ext.fly(d,"_anim");if(c.useDisplay){l.setDisplayed(false)}else{l.hide()}l.clearOpacity();l.setPositioning(e);l.setSize(h);i.end()})};b.animate({duration:(Math.max(c.duration,500)*2),listeners:{beforeanimate:{fn:a}}});return b},frame:function(a,d,e){var c=this,g=c.dom,b;a=a||"#C3DAF9";d=d||1;e=e||{};b=function(){var k=Ext.fly(g,"_anim"),j=this,l,i,h;k.show();l=k.getBox();i=Ext.getBody().createChild({id:k.dom.id+"-anim-proxy",style:{position:"absolute","pointer-events":"none","z-index":35000,border:"0px solid "+a}});h=new Ext.fx.Anim({target:i,duration:e.duration||1000,iterations:d,from:{top:l.y,left:l.x,borderWidth:0,opacity:1,height:l.height,width:l.width},to:{top:l.y-20,left:l.x-20,borderWidth:10,opacity:0,height:l.height+40,width:l.width+40}});h.on("afteranimate",function(){i.remove();j.end()})};c.animate({duration:(Math.max(e.duration,500)*2)||2000,listeners:{beforeanimate:{fn:b}}});return c},ghost:function(a,d){var c=this,e=c.dom,b;a=a||"b";b=function(){var j=Ext.fly(e,"_anim"),i=j.getWidth(),h=j.getHeight(),k=j.getXY(),g=j.getPositioning(),l={opacity:0};switch(a){case"t":l.y=k[1]-h;break;case"l":l.x=k[0]-i;break;case"r":l.x=k[0]+i;break;case"b":l.y=k[1]+h;break;case"tl":l.x=k[0]-i;l.y=k[1]-h;break;case"bl":l.x=k[0]-i;l.y=k[1]+h;break;case"br":l.x=k[0]+i;l.y=k[1]+h;break;case"tr":l.x=k[0]+i;l.y=k[1]-h;break}this.to=l;this.on("afteranimate",function(){var m=Ext.fly(e,"_anim");if(m){m.hide();m.clearOpacity();m.setPositioning(g)}})};c.animate(Ext.applyIf(d||{},{duration:500,easing:"ease-out",listeners:{beforeanimate:b}}));return c},highlight:function(d,b){var i=this,e=i.dom,k={},h,l,g,c,a,j;if(e.tagName.match(i.tableTagRe)){return i.select("div").highlight(d,b)}b=b||{};c=b.listeners||{};g=b.attr||"backgroundColor";k[g]=d||"ffff9c";if(!b.to){l={};l[g]=b.endColor||i.getColor(g,"ffffff","")}else{l=b.to}b.listeners=Ext.apply(Ext.apply({},c),{beforeanimate:function(){h=e.style[g];var m=Ext.fly(e,"_anim");m.clearOpacity();m.show();a=c.beforeanimate;if(a){j=a.fn||a;return j.apply(a.scope||c.scope||window,arguments)}},afteranimate:function(){if(e){e.style[g]=h}a=c.afteranimate;if(a){j=a.fn||a;j.apply(a.scope||c.scope||window,arguments)}}});i.animate(Ext.apply({},b,{duration:1000,easing:"ease-in",from:k,to:l}));return i},pause:function(a){var b=this;Ext.fx.Manager.setFxDefaults(b.id,{delay:a});return b},fadeIn:function(c){var a=this,b=a.dom;a.animate(Ext.apply({},c,{opacity:1,internalListeners:{beforeanimate:function(e){var d=Ext.fly(b,"_anim");if(d.isStyle("display","none")){d.setDisplayed("")}else{d.show()}}}}));return this},fadeOut:function(c){var a=this,b=a.dom;c=Ext.apply({opacity:0,internalListeners:{afteranimate:function(e){if(b&&e.to.opacity===0){var d=Ext.fly(b,"_anim");if(c.useDisplay){d.setDisplayed(false)}else{d.hide()}}}}},c);a.animate(c);return a},scale:function(a,b,c){this.animate(Ext.apply({},c,{width:a,height:b}));return this},shift:function(a){this.animate(a);return this},anchorAnimX:function(a){var b=(a==="l")?"right":"left";this.dom.style[b]="0px"}});Ext.define("Ext.dom.Element_dd",{override:"Ext.dom.Element",initDD:function(c,b,d){var a=new Ext.dd.DD(Ext.id(this.dom),c,b);return Ext.apply(a,d)},initDDProxy:function(c,b,d){var a=new Ext.dd.DDProxy(Ext.id(this.dom),c,b);return Ext.apply(a,d)},initDDTarget:function(c,b,d){var a=new Ext.dd.DDTarget(Ext.id(this.dom),c,b);return Ext.apply(a,d)}});Ext.define("Ext.dom.Element_fx",{override:"Ext.dom.Element"},function(){var b=Ext.dom.Element,i="visibility",g="display",n="none",e="hidden",m="visible",o="offsets",j="asclass",a="nosize",c="originalDisplay",d="visibilityMode",h="isVisible",l=Ext.baseCSSPrefix+"hide-offsets",k=function(q){var r=(q.$cache||q.getCache()).data,s=r[c];if(s===undefined){r[c]=s=""}return s},p=function(r){var s=(r.$cache||r.getCache()).data,q=s[d];if(q===undefined){s[d]=q=b.VISIBILITY}return q};b.override({originalDisplay:"",visibilityMode:1,setVisible:function(u,q){var s=this,t=s.dom,r=p(s);if(typeof q=="string"){switch(q){case g:r=b.DISPLAY;break;case i:r=b.VISIBILITY;break;case o:r=b.OFFSETS;break;case a:case j:r=b.ASCLASS;break}s.setVisibilityMode(r);q=false}if(!q||!s.anim){if(r==b.DISPLAY){return s.setDisplayed(u)}else{if(r==b.OFFSETS){s[u?"removeCls":"addCls"](l)}else{if(r==b.VISIBILITY){s.fixDisplay();t.style.visibility=u?"":e}else{if(r==b.ASCLASS){s[u?"removeCls":"addCls"](s.visibilityCls||b.visibilityCls)}}}}}else{if(u){s.setOpacity(0.01);s.setVisible(true)}if(!Ext.isObject(q)){q={duration:350,easing:"ease-in"}}s.animate(Ext.applyIf({callback:function(){if(!u){Ext.fly(t,"_internal").setVisible(false).setOpacity(1)}},to:{opacity:(u)?1:0}},q))}(s.$cache||s.getCache()).data[h]=u;return s},hasMetrics:function(){var q=p(this);return this.isVisible()||(q==b.OFFSETS)||(q==b.VISIBILITY)},toggle:function(q){var r=this;r.setVisible(!r.isVisible(),r.anim(q));return r},setDisplayed:function(q){if(typeof q=="boolean"){q=q?k(this):n}this.setStyle(g,q);return this},fixDisplay:function(){var q=this;if(q.isStyle(g,n)){q.setStyle(i,e);q.setStyle(g,k(q));if(q.isStyle(g,n)){q.setStyle(g,"block")}}},hide:function(q){if(typeof q=="string"){this.setVisible(false,q);return this}this.setVisible(false,this.anim(q));return this},show:function(q){if(typeof q=="string"){this.setVisible(true,q);return this}this.setVisible(true,this.anim(q));return this}})});Ext.define("Ext.dom.Element_position",{override:"Ext.dom.Element"},function(){var x,q=this,m="left",j="right",p="top",h="bottom",n="position",i="static",y="relative",u="z-index",t="BODY",c="padding",s="border",r="-left",l="-right",a="-top",k="-bottom",g="-width",e={l:s+r+g,r:s+l+g,t:s+a+g,b:s+k+g},d={l:c+r,r:c+l,t:c+a,b:c+k},v=[d.l,d.r,d.t,d.b],b=[e.l,e.r,e.t,e.b],w=Math.round,z=document,o=function(A){if(!x){x=new Ext.Element.Fly()}x.attach(A);return x};q.override({pxRe:/^\d+(?:\.\d*)?px$/i,inheritableStatics:{getX:function(A){return q.getXY(A)[0]},getXY:function(C){var F=z.body,B=z.documentElement,A=0,D=0,G=[0,0],E,I;C=Ext.getDom(C);if(C!=z&&C!=F){if(Ext.isIE){try{E=C.getBoundingClientRect();D=B.clientTop||F.clientTop;A=B.clientLeft||F.clientLeft}catch(H){E={left:0,top:0}}}else{E=C.getBoundingClientRect()}I=o(z).getScroll();G=[w(E.left+I.left-A),w(E.top+I.top-D)]}return G},getY:function(A){return q.getXY(A)[1]},setX:function(B,A){q.setXY(B,[A,false])},setXY:function(B,C){(B=Ext.fly(B,"_setXY")).position();var D=B.translatePoints(C),A=B.dom.style,E;A.right="auto";for(E in D){if(!isNaN(D[E])){A[E]=D[E]+"px"}}},setY:function(A,B){q.setXY(A,[false,B])}},center:function(A){return this.alignTo(A||z,"c-c")},clearPositioning:function(A){A=A||"";return this.setStyle({left:A,right:A,top:A,bottom:A,"z-index":"",position:i})},getAnchorToXY:function(D,A,C,B){return D.getAnchorXY(A,C,B)},getBottom:function(A){return(A?this.getLocalY():this.getY())+this.getHeight()},getBorderPadding:function(){var A=this.getStyle(v),B=this.getStyle(b);return{beforeX:(parseFloat(B[e.l])||0)+(parseFloat(A[d.l])||0),afterX:(parseFloat(B[e.r])||0)+(parseFloat(A[d.r])||0),beforeY:(parseFloat(B[e.t])||0)+(parseFloat(A[d.t])||0),afterY:(parseFloat(B[e.b])||0)+(parseFloat(A[d.b])||0)}},getCenterXY:function(){return this.getAlignToXY(z,"c-c")},getLeft:function(A){return A?this.getLocalX():this.getX()},getLocalX:function(){var C=this,B=C.dom.offsetParent,A=C.getStyle("left");if(!A||A==="auto"){A=0}else{if(C.pxRe.test(A)){A=parseFloat(A)}else{A=C.getX();if(B){A-=q.getX(B)}}}return A},getLocalXY:function(){var D=this,C=D.dom.offsetParent,B=D.getStyle(["left","top"]),A=B.left,E=B.top;if(!A||A==="auto"){A=0}else{if(D.pxRe.test(A)){A=parseFloat(A)}else{A=D.getX();if(C){A-=q.getX(C)}}}if(!E||E==="auto"){E=0}else{if(D.pxRe.test(E)){E=parseFloat(E)}else{E=D.getY();if(C){E-=q.getY(C)}}}return[A,E]},getLocalY:function(){var B=this,A=B.dom.offsetParent,C=B.getStyle("top");if(!C||C==="auto"){C=0}else{if(B.pxRe.test(C)){C=parseFloat(C)}else{C=B.getY();if(A){C-=q.getY(A)}}}return C},getPageBox:function(C){var F=this,D=F.dom,H=D.nodeName==t,I=H?Ext.Element.getViewWidth():D.offsetWidth,E=H?Ext.Element.getViewHeight():D.offsetHeight,K=F.getXY(),J=K[1],A=K[0]+I,G=K[1]+E,B=K[0];if(C){return new Ext.util.Region(J,A,G,B)}else{return{left:B,top:J,width:I,height:E,right:A,bottom:G}}},getPositioning:function(B){var A=this.getStyle(["left","top","position","z-index"]),C=this.dom;if(B){if(A.left==="auto"){A.left=C.offsetLeft+"px"}if(A.top==="auto"){A.top=C.offsetTop+"px"}}return A},getRight:function(A){return(A?this.getLocalX():this.getX())+this.getWidth()},getTop:function(A){return A?this.getLocalY():this.getY()},getX:function(){return q.getX(this.dom)},getXY:function(){return q.getXY(this.dom)},getY:function(){return q.getY(this.dom)},moveTo:function(A,C,B){return this.setXY([A,C],B)},position:function(E,D,A,C){var B=this;if(!E&&B.isStyle(n,i)){B.setStyle(n,y)}else{if(E){B.setStyle(n,E)}}if(D){B.setStyle(u,D)}if(A||C){B.setXY([A||false,C||false])}},setBottom:function(A){this.dom.style[h]=this.addUnits(A);return this},setBounds:function(B,E,D,A,C){return this.setBox({x:B,y:E,width:D,height:A},C)},setLeft:function(A){this.dom.style[m]=this.addUnits(A);return this},setLeftTop:function(D,C){var B=this,A=B.dom.style;A.left=B.addUnits(D);A.top=B.addUnits(C);return B},setLocalX:function(A){var B=this.dom.style;B.right="auto";B.left=(A===null)?"auto":A+"px"},setLocalXY:function(A,C){var B=this.dom.style;B.right="auto";if(A&&A.length){C=A[1];A=A[0]}if(A===null){B.left="auto"}else{if(A!==undefined){B.left=A+"px"}}if(C===null){B.top="auto"}else{if(C!==undefined){B.top=C+"px"}}},setLocalY:function(A){this.dom.style.top=(A===null)?"auto":A+"px"},setLocation:function(A,C,B){return this.setXY([A,C],B)},setPositioning:function(A){return this.setStyle(A)},setRight:function(A){this.dom.style[j]=this.addUnits(A);return this},setTop:function(A){this.dom.style[p]=this.addUnits(A);return this},setX:function(A,B){return this.setXY([A,this.getY()],B)},setXY:function(C,A){var B=this;if(!A||!B.anim){q.setXY(B.dom,C)}else{if(!Ext.isObject(A)){A={}}B.animate(Ext.applyIf({to:{x:C[0],y:C[1]}},A))}return this},setY:function(B,A){return this.setXY([this.getX(),B],A)}});q.getTrueXY=q.getXY});Ext.define("Ext.dom.Element_scroll",{override:"Ext.dom.Element",isScrollable:function(){var a=this.dom;return a.scrollHeight>a.clientHeight||a.scrollWidth>a.clientWidth},getScroll:function(){var c=this,h=c.dom,g=document,a=g.body,b=g.documentElement,e,d;if(h===g||h===a){e=b.scrollLeft||(a?a.scrollLeft:0);d=b.scrollTop||(a?a.scrollTop:0)}else{e=h.scrollLeft;d=h.scrollTop}return{left:e,top:d}},getScrollLeft:function(){var b=this.dom,a=document;if(b===a||b===a.body){return this.getScroll().left}else{return b.scrollLeft}},getScrollTop:function(){var b=this.dom,a=document;if(b===a||b===a.body){return this.getScroll().top}else{return b.scrollTop}},setScrollLeft:function(a){this.dom.scrollLeft=this.normalizeScrollLeft(a);return this},normalizeScrollLeft:Ext.identityFn,setScrollTop:function(a){this.dom.scrollTop=a;return this},scrollBy:function(b,a,c){var d=this,e=d.dom;if(b.length){c=a;a=b[1];b=b[0]}else{if(typeof b!="number"){c=a;a=b.y;b=b.x}}if(b){d.scrollTo("left",Math.max(Math.min(d.getScrollLeft()+b,e.scrollWidth-e.clientWidth),0),c)}if(a){d.scrollTo("top",Math.max(Math.min(e.scrollTop+a,e.scrollHeight-e.clientHeight),0),c)}return d},scrollTo:function(c,e,a){var g=/top/i.test(c),i="scroll"+(g?"Top":"Left"),d=this,h=d.dom,b,i;if(!g){e=d.normalizeScrollLeft(e)}if(!a||!d.anim){h[i]=e;h[i]=e}else{b={to:{}};b.to[i]=e;if(Ext.isObject(a)){Ext.applyIf(b,a)}d.animate(b)}return d},scrollIntoView:function(b,e,c){var l=this,j=l.dom,h=l.getOffsetsTo(b=Ext.getDom(b)||Ext.getBody().dom),g=h[0]+b.scrollLeft,m=h[1]+b.scrollTop,a=m+j.offsetHeight,n=g+j.offsetWidth,q=b.clientHeight,p=parseInt(b.scrollTop,10),d=parseInt(b.scrollLeft,10),i=p+q,o=d+b.clientWidth,k;if(c){c=Ext.apply({listeners:{afteranimate:function(){l.scrollChildFly.attach(j).highlight()}}},c)}if(j.offsetHeight>q||m<p){k=m}else{if(a>i){k=a-q}}if(k!=null){l.scrollChildFly.attach(b).scrollTo("top",k,c)}if(e!==false){k=null;if(j.offsetWidth>b.clientWidth||g<d){k=g}else{if(n>o){k=n-b.clientWidth}}if(k!=null){l.scrollChildFly.attach(b).scrollTo("left",k,c)}}return l},scrollChildIntoView:function(b,a){this.scrollChildFly.attach(Ext.getDom(b)).scrollIntoView(this,a)},scroll:function(m,b,d){if(!this.isScrollable()){return false}var e=this.dom,g=e.scrollLeft,p=e.scrollTop,n=e.scrollWidth,k=e.scrollHeight,i=e.clientWidth,a=e.clientHeight,c=false,o,j={l:Math.min(g+b,n-i),r:o=Math.max(g-b,0),t:Math.max(p-b,0),b:Math.min(p+b,k-a)};j.d=j.b;j.u=j.t;m=m.substr(0,1);if((o=j[m])>-1){c=true;this.scrollTo(m=="l"||m=="r"?"left":"top",o,this.anim(d))}return c}},function(){this.prototype.scrollChildFly=new this.Fly();this.prototype.scrolltoFly=new this.Fly()});Ext.define("Ext.dom.Element_style",{override:"Ext.dom.Element"},function(){var r=this,n=document.defaultView,p=/table-row|table-.*-group/,a="_internal",t="hidden",q="height",h="width",e="isClipped",j="overflow",m="overflow-x",l="overflow-y",u="originalClip",b=/#document|body/i,v,g,o,d,s,i,w;if(!n||!n.getComputedStyle){r.prototype.getStyle=function(B,A){var N=this,I=N.dom,L=typeof B!="string",k=N.styleHooks,y=B,z=y,H=1,D=A,M,E,x,C,G,J,F;if(L){x={};y=z[0];F=0;if(!(H=z.length)){return x}}if(!I||I.documentElement){return x||""}E=I.style;if(A){J=E}else{J=I.currentStyle;if(!J){D=true;J=E}}do{C=k[y];if(!C){k[y]=C={name:r.normalize(y)}}if(C.get){G=C.get(I,N,D,J)}else{M=C.name;if(C.canThrow){try{G=J[M]}catch(K){G=""}}else{G=J?J[M]:""}}if(!L){return G}x[y]=G;y=z[++F]}while(F<H);return x}}r.override({getHeight:function(z,x){var y=this,A=y.isStyle("display","none"),k,B;if(A){return 0}k=y.dom.offsetHeight;if(Ext.supports.Direct2DBug){B=y.adjustDirect2DDimension(q);if(x){k+=B}else{if(B>0&&B<0.5){k++}}}if(z){k-=y.getBorderWidth("tb")+y.getPadding("tb")}return(k<0)?0:k},getWidth:function(k,B){var z=this,C=z.dom,A=z.isStyle("display","none"),y,x,D;if(A){return 0}if(B&&Ext.supports.BoundingClientRect){y=C.getBoundingClientRect();x=(z.vertical&&!Ext.isIE9&&!Ext.supports.RotatedBoundingClientRect)?(y.bottom-y.top):(y.right-y.left)}else{x=C.offsetWidth}if(Ext.supports.Direct2DBug&&!z.vertical){D=z.adjustDirect2DDimension(h);if(B){x+=D}else{if(D>0&&D<0.5){x++}}}if(k){x-=z.getBorderWidth("lr")+z.getPadding("lr")}return(x<0)?0:x},setWidth:function(x,k){var y=this;x=y.adjustWidth(x);if(!k||!y.anim){y.dom.style.width=y.addUnits(x)}else{if(!Ext.isObject(k)){k={}}y.animate(Ext.applyIf({to:{width:x}},k))}return y},setHeight:function(k,x){var y=this;k=y.adjustHeight(k);if(!x||!y.anim){y.dom.style.height=y.addUnits(k)}else{if(!Ext.isObject(x)){x={}}y.animate(Ext.applyIf({to:{height:k}},x))}return y},applyStyles:function(k){Ext.DomHelper.applyStyles(this.dom,k);return this},setSize:function(y,k,x){var z=this;if(Ext.isObject(y)){x=k;k=y.height;y=y.width}y=z.adjustWidth(y);k=z.adjustHeight(k);if(!x||!z.anim){z.dom.style.width=z.addUnits(y);z.dom.style.height=z.addUnits(k)}else{if(x===true){x={}}z.animate(Ext.applyIf({to:{width:y,height:k}},x))}return z},getViewSize:function(){var y=this,z=y.dom,x=b.test(z.nodeName),k;if(x){k={width:r.getViewWidth(),height:r.getViewHeight()}}else{k={width:z.clientWidth,height:z.clientHeight}}return k},getSize:function(k){return{width:this.getWidth(k),height:this.getHeight(k)}},adjustWidth:function(k){var x=this,y=(typeof k=="number");if(y&&x.autoBoxAdjust&&!x.isBorderBox()){k-=(x.getBorderWidth("lr")+x.getPadding("lr"))}return(y&&k<0)?0:k},adjustHeight:function(k){var x=this,y=(typeof k=="number");if(y&&x.autoBoxAdjust&&!x.isBorderBox()){k-=(x.getBorderWidth("tb")+x.getPadding("tb"))}return(y&&k<0)?0:k},getColor:function(x,y,D){var A=this.getStyle(x),z=D||D===""?D:"#",C,k,B=0;if(!A||(/transparent|inherit/.test(A))){return y}if(/^r/.test(A)){A=A.slice(4,A.length-1).split(",");k=A.length;for(;B<k;B++){C=parseInt(A[B],10);z+=(C<16?"0":"")+C.toString(16)}}else{A=A.replace("#","");z+=A.length==3?A.replace(/^(\w)(\w)(\w)$/,"$1$1$2$2$3$3"):A}return(z.length>5?z.toLowerCase():y)},setOpacity:function(x,k){var y=this;if(!y.dom){return y}if(!k||!y.anim){y.setStyle("opacity",x)}else{if(typeof k!="object"){k={duration:350,easing:"ease-in"}}y.animate(Ext.applyIf({to:{opacity:x}},k))}return y},clearOpacity:function(){return this.setOpacity("")},adjustDirect2DDimension:function(y){var D=this,x=D.dom,B=D.getStyle("display"),A=x.style.display,E=x.style.position,C=y===h?0:1,k=x.currentStyle,z;if(B==="inline"){x.style.display="inline-block"}x.style.position=B.match(p)?"absolute":"static";z=(parseFloat(k[y])||parseFloat(k.msTransformOrigin.split(" ")[C])*2)%1;x.style.position=E;if(B==="inline"){x.style.display=A}return z},clip:function(){var x=this,y=(x.$cache||x.getCache()).data,k;if(!y[e]){y[e]=true;k=x.getStyle([j,m,l]);y[u]={o:k[j],x:k[m],y:k[l]};x.setStyle(j,t);x.setStyle(m,t);x.setStyle(l,t)}return x},unclip:function(){var x=this,y=(x.$cache||x.getCache()).data,k;if(y[e]){y[e]=false;k=y[u];if(k.o){x.setStyle(j,k.o)}if(k.x){x.setStyle(m,k.x)}if(k.y){x.setStyle(l,k.y)}}return x},boxWrap:function(k){k=k||Ext.baseCSSPrefix+"box";var x=Ext.get(this.insertHtml("beforeBegin","<div class='"+k+"'>"+Ext.String.format(r.boxMarkup,k)+"</div>"));Ext.DomQuery.selectNode("."+k+"-mc",x.dom).appendChild(this.dom);return x},getComputedHeight:function(){var x=this,k=Math.max(x.dom.offsetHeight,x.dom.clientHeight);if(!k){k=parseFloat(x.getStyle(q))||0;if(!x.isBorderBox()){k+=x.getFrameWidth("tb")}}return k},getComputedWidth:function(){var x=this,k=Math.max(x.dom.offsetWidth,x.dom.clientWidth);if(!k){k=parseFloat(x.getStyle(h))||0;if(!x.isBorderBox()){k+=x.getFrameWidth("lr")}}return k},getFrameWidth:function(x,k){return(k&&this.isBorderBox())?0:(this.getPadding(x)+this.getBorderWidth(x))},addClsOnOver:function(y,B,x){var z=this,A=z.dom,k=Ext.isFunction(B);z.hover(function(){if(k&&B.call(x||z,z)===false){return}Ext.fly(A,a).addCls(y)},function(){Ext.fly(A,a).removeCls(y)});return z},addClsOnFocus:function(y,B,x){var z=this,A=z.dom,k=Ext.isFunction(B);z.on("focus",function(){if(k&&B.call(x||z,z)===false){return false}Ext.fly(A,a).addCls(y)});z.on("blur",function(){Ext.fly(A,a).removeCls(y)});return z},addClsOnClick:function(y,B,x){var z=this,A=z.dom,k=Ext.isFunction(B);z.on("mousedown",function(){if(k&&B.call(x||z,z)===false){return false}Ext.fly(A,a).addCls(y);var D=Ext.getDoc(),C=function(){Ext.fly(A,a).removeCls(y);D.removeListener("mouseup",C)};D.on("mouseup",C)});return z},getStyleSize:function(){var A=this,B=this.dom,x=b.test(B.nodeName),z,k,y;if(x){return{width:r.getViewWidth(),height:r.getViewHeight()}}z=A.getStyle([q,h],true);if(z.width&&z.width!="auto"){k=parseFloat(z.width);if(A.isBorderBox()){k-=A.getFrameWidth("lr")}}if(z.height&&z.height!="auto"){y=parseFloat(z.height);if(A.isBorderBox()){y-=A.getFrameWidth("tb")}}return{width:k||A.getWidth(true),height:y||A.getHeight(true)}},statics:{selectableCls:Ext.baseCSSPrefix+"selectable",unselectableCls:Ext.baseCSSPrefix+"unselectable"},selectable:function(){var k=this;k.dom.unselectable="";k.removeCls(r.unselectableCls);k.addCls(r.selectableCls);return k},unselectable:function(){var k=this;if(Ext.isOpera){k.dom.unselectable="on"}k.removeCls(r.selectableCls);k.addCls(r.unselectableCls);return k},setVertical:function(A,x){var z=this,y=r.prototype,k;z.vertical=true;if(x){z.addCls(z.verticalCls=x)}z.setWidth=y.setHeight;z.setHeight=y.setWidth;if(!Ext.isIE9m){z.getWidth=y.getHeight;z.getHeight=y.getWidth}z.styleHooks=(A===270)?r.prototype.verticalStyleHooks270:r.prototype.verticalStyleHooks90},setHorizontal:function(){var x=this,k=x.verticalCls;delete x.vertical;if(k){delete x.verticalCls;x.removeCls(k)}delete x.setWidth;delete x.setHeight;if(!Ext.isIE9m){delete x.getWidth;delete x.getHeight}delete x.styleHooks}});r.prototype.styleHooks=v=Ext.dom.AbstractElement.prototype.styleHooks;r.prototype.verticalStyleHooks90=g=Ext.Object.chain(r.prototype.styleHooks);r.prototype.verticalStyleHooks270=o=Ext.Object.chain(r.prototype.styleHooks);g.width={name:"height"};g.height={name:"width"};g["margin-top"]={name:"marginLeft"};g["margin-right"]={name:"marginTop"};g["margin-bottom"]={name:"marginRight"};g["margin-left"]={name:"marginBottom"};g["padding-top"]={name:"paddingLeft"};g["padding-right"]={name:"paddingTop"};g["padding-bottom"]={name:"paddingRight"};g["padding-left"]={name:"paddingBottom"};g["border-top"]={name:"borderLeft"};g["border-right"]={name:"borderTop"};g["border-bottom"]={name:"borderRight"};g["border-left"]={name:"borderBottom"};o.width={name:"height"};o.height={name:"width"};o["margin-top"]={name:"marginRight"};o["margin-right"]={name:"marginBottom"};o["margin-bottom"]={name:"marginLeft"};o["margin-left"]={name:"marginTop"};o["padding-top"]={name:"paddingRight"};o["padding-right"]={name:"paddingBottom"};o["padding-bottom"]={name:"paddingLeft"};o["padding-left"]={name:"paddingTop"};o["border-top"]={name:"borderRight"};o["border-right"]={name:"borderBottom"};o["border-bottom"]={name:"borderLeft"};o["border-left"]={name:"borderTop"};if(Ext.isIE7m){v.fontSize=v["font-size"]={name:"fontSize",canThrow:true};v.fontStyle=v["font-style"]={name:"fontStyle",canThrow:true};v.fontFamily=v["font-family"]={name:"fontFamily",canThrow:true}}if(Ext.isIEQuirks||Ext.isIE&&Ext.ieVersion<=8){function c(z,x,y,k){if(k[this.styleName]=="none"){return"0px"}return k[this.name]}d=["Top","Right","Bottom","Left"];s=d.length;while(s--){i=d[s];w="border"+i+"Width";v["border-"+i.toLowerCase()+"-width"]=v[w]={name:w,styleName:"border"+i+"Style",get:c}}}Ext.getDoc().on("selectstart",function(A,C){var B=document.documentElement,z=r.selectableCls,y=r.unselectableCls,k=C&&C.tagName;k=k&&k.toLowerCase();if(k==="input"||k==="textarea"){return}while(C&&C.nodeType===1&&C!==B){var x=Ext.fly(C);if(x.hasCls(z)){return}if(x.hasCls(y)){A.stopEvent();return}C=C.parentNode}})});Ext.onReady(function(){var c=/alpha\(opacity=(.*)\)/i,b=/^\s+|\s+$/g,a=Ext.dom.Element.prototype.styleHooks;a.opacity={name:"opacity",afterSet:function(g,e,d){if(d.isLayer){d.onOpacitySet(e)}}};if(!Ext.supports.Opacity&&Ext.isIE){Ext.apply(a.opacity,{get:function(h){var g=h.style.filter,e,d;if(g.match){e=g.match(c);if(e){d=parseFloat(e[1]);if(!isNaN(d)){return d?d/100:0}}}return 1},set:function(h,e){var d=h.style,g=d.filter.replace(c,"").replace(b,"");d.zoom=1;if(typeof(e)=="number"&&e>=0&&e<1){e*=100;d.filter=g+(g.length?" ":"")+"alpha(opacity="+e+")"}else{d.filter=g}}})}});Ext.define("Ext.util.Positionable",{_positionTopLeft:["position","top","left"],_alignRe:/^([a-z]+)-([a-z]+)(\?)?$/,afterSetPosition:Ext.emptyFn,adjustForConstraints:function(c,b){var a=this.getConstrainVector(b,c);if(a){c[0]+=a[0];c[1]+=a[1]}return c},alignTo:function(c,a,g,b){var e=this,d=e.el;return e.setXY(e.getAlignToXY(c,a,g),d.anim&&!!b?d.anim(b):false)},anchorTo:function(h,e,b,a,j,k){var g=this,i=!Ext.isEmpty(j),c=function(){g.alignTo(h,e,b,a);Ext.callback(k,g)},d=g.getAnchor();g.removeAnchor();Ext.apply(d,{fn:c,scroll:i});Ext.EventManager.onWindowResize(c,null);if(i){Ext.EventManager.on(window,"scroll",c,null,{buffer:!isNaN(j)?j:50})}c();return g},calculateAnchorXY:function(g,i,h,d){var j=this,c=j.el,k=document,e=c.dom==k.body||c.dom==k,l=Math.round,m,b,a;g=(g||"tl").toLowerCase();d=d||{};b=d.width||e?Ext.Element.getViewWidth():j.getWidth();a=d.height||e?Ext.Element.getViewHeight():j.getHeight();switch(g){case"tl":m=[0,0];break;case"bl":m=[0,a];break;case"tr":m=[b,0];break;case"c":m=[l(b*0.5),l(a*0.5)];break;case"t":m=[l(b*0.5),0];break;case"l":m=[0,l(a*0.5)];break;case"r":m=[b,l(a*0.5)];break;case"b":m=[l(b*0.5),a];break;case"tc":m=[l(b*0.5),0];break;case"bc":m=[l(b*0.5),a];break;case"br":m=[b,a]}return[m[0]+i,m[1]+h]},convertPositionSpec:function(a){return a},getAlignToXY:function(j,C,e){var D=this,A=Ext.Element.getViewWidth()-10,d=Ext.Element.getViewHeight()-10,E=document,B=E.documentElement,o=E.body,z=(B.scrollLeft||o.scrollLeft||0),v=(B.scrollTop||o.scrollTop||0),a,h,s,g,t,u,q,r,w,p,n,b,c,i,l,m,k;j=Ext.get(j.el||j);if(!j||!j.dom){}e=e||[0,0];C=(!C||C=="?"?"tl-bl?":(!(/-/).test(C)&&C!==""?"tl-"+C:C||"tl-bl")).toLowerCase();C=D.convertPositionSpec(C);a=C.match(D._alignRe);p=a[1];n=a[2];w=!!a[3];h=D.getAnchorXY(p,true);s=D.getAnchorToXY(j,n,false);m=s[0]-h[0]+e[0];k=s[1]-h[1]+e[1];if(w){g=D.getWidth();t=D.getHeight();u=j.getRegion();b=p.charAt(0);c=p.charAt(p.length-1);i=n.charAt(0);l=n.charAt(n.length-1);q=((b=="t"&&i=="b")||(b=="b"&&i=="t"));r=((c=="r"&&l=="l")||(c=="l"&&l=="r"));if(m+g>A+z){m=r?u.left-g:A+z-g}if(m<z){m=r?u.right:z}if(k+t>d+v){k=q?u.top-t:d+v-t}if(k<v){k=q?u.bottom:v}}return[m,k]},getAnchor:function(){var b=this.el,c=(b.$cache||b.getCache()).data,a;if(!b.dom){return}a=c._anchor;if(!a){a=c._anchor={}}return a},getAnchorXY:function(d,i,b){var h=this,j=h.getXY(),a=h.el,l=document,c=a.dom==l.body||a.dom==l,k=a.getScroll(),g=c?k.left:i?0:j[0],e=c?k.top:i?0:j[1];return h.calculateAnchorXY(d,g,e,b)},getBox:function(d,i){var e=this,m=i?e.getLocalXY():e.getXY(),j=m[0],g=m[1],k=e.getWidth(),b=e.getHeight(),c,a,l;if(d){c=e.getBorderPadding();a=c.beforeX;l=c.beforeY;j+=a;g+=l;k-=(a+c.afterX);b-=(l+c.afterY)}return{x:j,left:j,0:j,y:g,top:g,1:g,width:k,height:b,right:j+k,bottom:g+b}},calculateConstrainedPosition:function(h,b,l,d){var k=this,c,i=k.floatParent,e=i?i.getTargetEl():null,a,g,j,m=false;if(l&&i){a=e.getXY();g=e.getBorderPadding();a[0]+=g.beforeX;a[1]+=g.beforeY;if(b){j=[b[0]+a[0],b[1]+a[1]]}}else{j=b}h=h||k.constrainTo||e||k.container||k.el.parent();c=(k.constrainHeader?k.header.el:k.el).getConstrainVector(h,j,d);if(c){m=b||k.getPosition(l);m[0]+=c[0];m[1]+=c[1]}return m},getConstrainVector:function(e,c,a){var h=this.getRegion(),b=[0,0],g=(this.shadow&&this.constrainShadow&&!this.shadowDisabled)?this.shadow.getShadowSize():undefined,d=false;if(!(e instanceof Ext.util.Region)){e=Ext.get(e.el||e).getViewRegion()}if(c){h.translateBy(c[0]-h.x,c[1]-h.y)}if(a){h.right=h.left+a[0];h.bottom=h.top+a[1]}if(g){e.adjust(g[0],-g[1],-g[2],g[3])}if(h.right>e.right){d=true;b[0]=(e.right-h.right)}if(h.left+b[0]<e.left){d=true;b[0]=(e.left-h.left)}if(h.bottom>e.bottom){d=true;b[1]=(e.bottom-h.bottom)}if(h.top+b[1]<e.top){d=true;b[1]=(e.top-h.top)}return d?b:false},getOffsetsTo:function(a){var c=this.getXY(),b=Ext.fly(a.el||a,"_internal").getXY();return[c[0]-b[0],c[1]-b[1]]},getRegion:function(){var a=this.getBox();return new Ext.util.Region(a.top,a.right,a.bottom,a.left)},getViewRegion:function(){var g=this,c=g.el,a=c.dom.nodeName==="BODY",e,j,h,i,d,b,k;if(a){j=c.getScroll();d=j.left;i=j.top;b=Ext.dom.AbstractElement.getViewportWidth();k=Ext.dom.AbstractElement.getViewportHeight()}else{e=g.getBorderPadding();h=g.getXY();d=h[0]+e.beforeX;i=h[1]+e.beforeY;b=g.getWidth(true);k=g.getHeight(true)}return new Ext.util.Region(i,d+b,i+k,d)},move:function(j,b,c){var g=this,m=g.getXY(),k=m[0],i=m[1],d=[k-b,i],l=[k+b,i],h=[k,i-b],a=[k,i+b],e={l:d,left:d,r:l,right:l,t:h,top:h,up:h,b:a,bottom:a,down:a};j=j.toLowerCase();g.setXY([e[j][0],e[j][1]],c)},removeAnchor:function(){var a=this.getAnchor();if(a&&a.fn){Ext.EventManager.removeResizeListener(a.fn);if(a.scroll){Ext.EventManager.un(window,"scroll",a.fn)}delete a.fn}return this},setBox:function(d,a){var e=this,b=e.el,i=d.x,g=d.y,l=[i,g],j=d.width,c=d.height,k=e.constrain&&e.calculateConstrainedPosition(null,[i,g],false,[j,c]);if(k){i=k[0];g=k[1]}if(!a||!b.anim){e.setSize(j,c);e.setXY([i,g]);e.afterSetPosition(i,g)}else{e.animate(Ext.applyIf({to:{x:i,y:g,width:b.adjustWidth(j),height:b.adjustHeight(c)},listeners:{afteranimate:Ext.Function.bind(e.afterSetPosition,e,[i,g])}},a))}return e},setRegion:function(b,a){return this.setBox({x:b.left,y:b.top,width:b.right-b.left,height:b.bottom-b.top},a)},translatePoints:function(a,c){var b=this.translateXY(a,c);return{left:b.x,top:b.y}},translateXY:function(h,e){var d=this,b=d.el,i=b.getStyle(d._positionTopLeft),a=i.position=="relative",c=parseFloat(i.left),g=parseFloat(i.top),j=d.getXY();if(Ext.isArray(h)){e=h[1];h=h[0]}if(isNaN(c)){c=a?0:b.dom.offsetLeft}if(isNaN(g)){g=a?0:b.dom.offsetTop}c=(typeof h=="number")?h-j[0]+c:undefined;g=(typeof e=="number")?e-j[1]+g:undefined;return{x:c,y:g}}});Ext.define("Ext.dom.Element",function(a){var b="hidden",g=document,j="visibility",c="display",k="none",e=Ext.baseCSSPrefix+"masked",l=Ext.baseCSSPrefix+"masked-relative",i=Ext.baseCSSPrefix+"mask-msg",m=/^body/i,h,d=Ext.isStrict?{select:1}:{input:1,select:1,textarea:1},n=function(t){var s=[],o=-1,q,p;for(q=0;p=t[q];q++){if(p.scrollTop>0||p.scrollLeft>0){s[++o]=p}}return s};return{extend:Ext.dom.AbstractElement,alternateClassName:["Ext.Element","Ext.core.Element"],tableTagRe:/^(?:tr|td|table|tbody)$/i,mixins:[Ext.util.Positionable],addUnits:function(){return a.addUnits.apply(a,arguments)},focus:function(r,q){var o=this;q=q||o.dom;try{if(Number(r)){Ext.defer(o.focus,r,o,[null,q])}else{q.focus()}}catch(p){}return o},blur:function(){var o=this,q=o.dom;if(q!==document.body){try{q.blur()}catch(p){}return o}else{return o.focus(undefined,q)}},isBorderBox:function(){var o=Ext.isBorderBox;if(o&&Ext.isIE7m){o=!((this.dom.tagName||"").toLowerCase() in d)}return o},hover:function(p,o,r,q){var s=this;s.on("mouseenter",p,r||s.dom,q);s.on("mouseleave",o,r||s.dom,q);return s},getAttributeNS:function(p,o){return this.getAttribute(o,p)},getAttribute:(Ext.isIE&&!(Ext.isIE9p&&g.documentMode>=9))?function(o,q){var r=this.dom,p;if(q){p=typeof r[q+":"+o];if(p!="undefined"&&p!="unknown"){return r[q+":"+o]||null}return null}if(o==="for"){o="htmlFor"}return r[o]||null}:function(o,p){var q=this.dom;if(p){return q.getAttributeNS(p,o)||q.getAttribute(p+":"+o)}return q.getAttribute(o)||q[o]||null},cacheScrollValues:function(){var s=this,r,q,p,t=[],o=function(){for(p=0;p<r.length;p++){q=r[p];q.scrollLeft=t[p][0];q.scrollTop=t[p][1]}};if(!Ext.DomQuery.pseudos.isScrolled){Ext.DomQuery.pseudos.isScrolled=n}r=s.query(":isScrolled");for(p=0;p<r.length;p++){q=r[p];t[p]=[q.scrollLeft,q.scrollTop]}return o},autoBoxAdjust:true,isVisible:function(o){var q=this,r=q.dom,p=r.ownerDocument.documentElement;if(!h){h=new a.Fly()}while(r!==p){if(!r||r.nodeType===11||(h.attach(r)).isStyle(j,b)||h.isStyle(c,k)){return false}if(!o){break}r=r.parentNode}return true},isDisplayed:function(){return !this.isStyle(c,k)},enableDisplayMode:function(p){var o=this;o.setVisibilityMode(a.DISPLAY);if(!Ext.isEmpty(p)){(o.$cache||o.getCache()).data.originalDisplay=p}return o},mask:function(o,y,v){var A=this,r=A.dom,s=r.style.setExpression,u=(A.$cache||A.getCache()).data,q=u.maskShimEl,x=u.maskEl,p=u.maskMsg,t,w;if(!(m.test(r.tagName)&&A.getStyle("position")=="static")){A.addCls(l)}if(x){x.remove()}if(p){p.remove()}if(q){q.remove()}if(Ext.isIE6){q=Ext.DomHelper.append(r,{tag:"iframe",cls:Ext.baseCSSPrefix+"shim "+Ext.baseCSSPrefix+"mask-shim"},true);u.maskShimEl=q;q.setDisplayed(true)}Ext.DomHelper.append(r,[{cls:Ext.baseCSSPrefix+"mask",style:"top:0;left:0;"},{cls:y?i+" "+y:i,cn:{tag:"div",cls:Ext.baseCSSPrefix+"mask-msg-inner",cn:{tag:"div",cls:Ext.baseCSSPrefix+"mask-msg-text",html:o||""}}}]);p=Ext.get(r.lastChild);x=Ext.get(p.dom.previousSibling);u.maskMsg=p;u.maskEl=x;A.addCls(e);x.setDisplayed(true);if(typeof o=="string"){p.setDisplayed(true);p.center(A)}else{p.setDisplayed(false)}if(!Ext.supports.IncludePaddingInWidthCalculation&&s){try{x.dom.style.setExpression("width",'this.parentNode.clientWidth + "px"');t='this.parentNode.clientWidth + "px"';if(q){q.dom.style.setExpression("width",t)}x.dom.style.setExpression("width",t)}catch(z){}}if(!Ext.supports.IncludePaddingInHeightCalculation&&s){try{w="this.parentNode."+(r==g.body?"scrollHeight":"offsetHeight")+' + "px"';if(q){q.dom.style.setExpression("height",w)}x.dom.style.setExpression("height",w)}catch(z){}}else{if(Ext.isIE9m&&!(Ext.isIE7&&Ext.isStrict)&&A.getStyle("height")=="auto"){if(q){q.setSize(undefined,v||A.getHeight())}x.setSize(undefined,v||A.getHeight())}}return x},unmask:function(){var s=this,t=(s.$cache||s.getCache()).data,r=t.maskEl,p=t.maskShimEl,o=t.maskMsg,q;if(r){q=r.dom.style;if(q.clearExpression){q.clearExpression("width");q.clearExpression("height")}if(r){r.remove();delete t.maskEl}if(o){o.remove();delete t.maskMsg}s.removeCls([e,l]);if(p){q=p.dom.style;if(q.clearExpression){q.clearExpression("width");q.clearExpression("height")}p.remove();delete t.maskShimEl}}},isMasked:function(){var q=this,s=(q.$cache||q.getCache()).data,p=s.maskEl,o=s.maskMsg,r=false;if(p&&p.isVisible()){if(o){o.center(q)}r=true}return r},createShim:function(){var o=g.createElement("iframe"),p;o.frameBorder="0";o.className=Ext.baseCSSPrefix+"shim";o.src=Ext.SSL_SECURE_URL;p=Ext.get(this.dom.parentNode.insertBefore(o,this.dom));p.autoBoxAdjust=false;return p},addKeyListener:function(p,r,q){var o;if(typeof p!="object"||Ext.isArray(p)){o={target:this,key:p,fn:r,scope:q}}else{o={target:this,key:p.key,shift:p.shift,ctrl:p.ctrl,alt:p.alt,fn:r,scope:q}}return new Ext.util.KeyMap(o)},addKeyMap:function(o){return new Ext.util.KeyMap(Ext.apply({target:this},o))},on:function(o,r,q,p){Ext.EventManager.on(this,o,r,q||this,p);return this},un:function(o,q,p){Ext.EventManager.un(this,o,q,p||this);return this},removeAllListeners:function(){Ext.EventManager.removeAll(this);return this},purgeAllListeners:function(){Ext.EventManager.purgeElement(this);return this},select:function(o){return a.select(o,false,this.dom)}}},function(){var DOC=document,EC=Ext.cache,Element=this,AbstractElement=Ext.dom.AbstractElement,focusRe=/^a|button|embed|iframe|input|object|select|textarea$/i,nonSpaceRe=/\S/,scriptTagRe=/(?:<script([^>]*)?>)((\n|\r|.)*?)(?:<\/script>)/ig,replaceScriptTagRe=/(?:<script.*?>)((\n|\r|.)*?)(?:<\/script>)/ig,srcRe=/\ssrc=([\'\"])(.*?)\1/i,typeRe=/\stype=([\'\"])(.*?)\1/i,useDocForId=!Ext.isIE8m,internalFly;Element.boxMarkup='<div class="{0}-tl"><div class="{0}-tr"><div class="{0}-tc"></div></div></div><div class="{0}-ml"><div class="{0}-mr"><div class="{0}-mc"></div></div></div><div class="{0}-bl"><div class="{0}-br"><div class="{0}-bc"></div></div></div>';function garbageCollect(){if(!Ext.enableGarbageCollector){clearInterval(Element.collectorThreadId)}else{var eid,d,o,t;for(eid in EC){if(!EC.hasOwnProperty(eid)){continue}o=EC[eid];if(o.skipGarbageCollection){continue}d=o.dom;if(!d.parentNode||(!d.offsetParent&&!Ext.getElementById(eid))){if(d&&Ext.enableListenerCollection){Ext.EventManager.removeAll(d)}delete EC[eid]}}if(Ext.isIE){t={};for(eid in EC){if(!EC.hasOwnProperty(eid)){continue}t[eid]=EC[eid]}EC=Ext.cache=t}}}Element.collectorThreadId=setInterval(garbageCollect,30000);Element.addMethods({monitorMouseLeave:function(delay,handler,scope){var me=this,timer,listeners={mouseleave:function(e){timer=setTimeout(Ext.Function.bind(handler,scope||me,[e]),delay)},mouseenter:function(){clearTimeout(timer)},freezeEvent:true};me.on(listeners);return listeners},swallowEvent:function(eventName,preventDefault){var me=this,e,eLen,fn=function(e){e.stopPropagation();if(preventDefault){e.preventDefault()}};if(Ext.isArray(eventName)){eLen=eventName.length;for(e=0;e<eLen;e++){me.on(eventName[e],fn)}return me}me.on(eventName,fn);return me},relayEvent:function(eventName,observable){this.on(eventName,function(e){observable.fireEvent(eventName,e)})},clean:function(forceReclean){var me=this,dom=me.dom,data=(me.$cache||me.getCache()).data,n=dom.firstChild,ni=-1,nx;if(data.isCleaned&&forceReclean!==true){return me}while(n){nx=n.nextSibling;if(n.nodeType==3){if(!(nonSpaceRe.test(n.nodeValue))){dom.removeChild(n)}else{if(nx&&nx.nodeType==3){n.appendData(Ext.String.trim(nx.data));dom.removeChild(nx);nx=n.nextSibling;n.nodeIndex=++ni}}}else{internalFly.attach(n).clean();n.nodeIndex=++ni}n=nx}data.isCleaned=true;return me},load:function(options){this.getLoader().load(options);return this},getLoader:function(){var me=this,data=(me.$cache||me.getCache()).data,loader=data.loader;if(!loader){data.loader=loader=new Ext.ElementLoader({target:me})}return loader},syncContent:function(source){source=Ext.getDom(source);var sourceNodes=source.childNodes,sourceLen=sourceNodes.length,dest=this.dom,destNodes=dest.childNodes,destLen=destNodes.length,i,destNode,sourceNode,nodeType,newAttrs,attLen,attName;if(dest.mergeAttributes){dest.mergeAttributes(source,true);dest.src=source.src}else{newAttrs=source.attributes;attLen=newAttrs.length;for(i=0;i<attLen;i++){attName=newAttrs[i].name;if(attName!=="id"){dest.setAttribute(attName,newAttrs[i].value)}}}if(sourceLen!==destLen){dest.innerHTML=source.innerHTML;return}for(i=0;i<sourceLen;i++){sourceNode=sourceNodes[i];destNode=destNodes[i];nodeType=sourceNode.nodeType;if(nodeType!==destNode.nodeType||(nodeType===1&&sourceNode.tagName!==destNode.tagName)){dest.innerHTML=source.innerHTML;return}if(nodeType===3){destNode.data=sourceNode.data}else{if(sourceNode.id&&destNode.id!==sourceNode.id){destNode.id=sourceNode.id}destNode.style.cssText=sourceNode.style.cssText;destNode.className=sourceNode.className;internalFly.attach(destNode).syncContent(sourceNode)}}},update:function(html,loadScripts,callback){var me=this,id,dom,interval;if(!me.dom){return me}html=html||"";dom=me.dom;if(loadScripts!==true){dom.innerHTML=html;Ext.callback(callback,me);return me}id=Ext.id();html+='<span id="'+id+'"></span>';interval=setInterval(function(){var hd,match,attrs,srcMatch,typeMatch,el,s;if(!(el=DOC.getElementById(id))){return false}clearInterval(interval);Ext.removeNode(el);hd=Ext.getHead().dom;while((match=scriptTagRe.exec(html))){attrs=match[1];srcMatch=attrs?attrs.match(srcRe):false;if(srcMatch&&srcMatch[2]){s=DOC.createElement("script");s.src=srcMatch[2];typeMatch=attrs.match(typeRe);if(typeMatch&&typeMatch[2]){s.type=typeMatch[2]}hd.appendChild(s)}else{if(match[2]&&match[2].length>0){if(window.execScript){window.execScript(match[2])}else{window.eval(match[2])}}}}Ext.callback(callback,me)},20);dom.innerHTML=html.replace(replaceScriptTagRe,"");return me},removeAllListeners:function(){this.removeAnchor();Ext.EventManager.removeAll(this.dom);return this},createProxy:function(config,renderTo,matchBox){config=(typeof config=="object")?config:{tag:"div",cls:config};var me=this,proxy=renderTo?Ext.DomHelper.append(renderTo,config,true):Ext.DomHelper.insertBefore(me.dom,config,true);proxy.setVisibilityMode(Element.DISPLAY);proxy.hide();if(matchBox&&me.setBox&&me.getBox){proxy.setBox(me.getBox())}return proxy},needsTabIndex:function(){if(this.dom){if((this.dom.nodeName==="a")&&(!this.dom.href)){return true}return !focusRe.test(this.dom.nodeName)}},isFocusable:function(asFocusEl){var dom=this.dom,tabIndexAttr=dom.getAttributeNode("tabIndex"),tabIndex,nodeName=dom.nodeName,canFocus=false;if(tabIndexAttr&&tabIndexAttr.specified){tabIndex=tabIndexAttr.value}if(dom&&!dom.disabled){if(tabIndex==-1){canFocus=Ext.FocusManager&&Ext.FocusManager.enabled&&asFocusEl}else{if(focusRe.test(nodeName)){if((nodeName!=="a")||dom.href){canFocus=true}}else{canFocus=tabIndex!=null&&tabIndex>=0}}canFocus=canFocus&&this.isVisible(true)}return canFocus}});if(Ext.isIE){Element.prototype.getById=function(id,asDom){var dom=this.dom,cacheItem,el,ret;if(dom){el=(useDocForId&&DOC.getElementById(id))||dom.all[id];if(el){if(asDom){ret=el}else{cacheItem=EC[id];if(cacheItem&&cacheItem.el){ret=Ext.updateCacheEntry(cacheItem,el).el}else{ret=new Element(el)}}return ret}}return asDom?Ext.getDom(id):Element.get(id)}}Element.createAlias({addListener:"on",removeListener:"un",clearListeners:"removeAllListeners",focusable:"isFocusable"});Element.Fly=AbstractElement.Fly=new Ext.Class({extend:Element,isFly:true,constructor:function(dom){this.dom=dom;this.el=this},attach:AbstractElement.Fly.prototype.attach});internalFly=new Element.Fly();if(Ext.isIE){Ext.getElementById=function(id){var el=DOC.getElementById(id),detachedBodyEl;if(!el&&(detachedBodyEl=AbstractElement.detachedBodyEl)){el=detachedBodyEl.dom.all[id]}return el}}else{if(!DOC.querySelector){Ext.getDetachedBody=Ext.getBody;Ext.getElementById=function(id){return DOC.getElementById(id)}}}});Ext.define("Ext.dom.CompositeElementLite",{alternateClassName:"Ext.CompositeElementLite",statics:{importElementMethods:function(){var b,c=Ext.dom.Element.prototype,a=this.prototype;for(b in c){if(typeof c[b]=="function"){(function(d){a[d]=a[d]||function(){return this.invoke(d,arguments)}}).call(a,b)}}}},constructor:function(b,a){this.elements=[];this.add(b,a);this.el=new Ext.dom.AbstractElement.Fly()},isComposite:true,getElement:function(a){return this.el.attach(a)},transformElement:function(a){return Ext.getDom(a)},getCount:function(){return this.elements.length},add:function(c,a){var e=this.elements,b,d;if(!c){return this}if(typeof c=="string"){c=Ext.dom.Element.selectorFunction(c,a)}else{if(c.isComposite){c=c.elements}else{if(!Ext.isIterable(c)){c=[c]}}}for(b=0,d=c.length;b<d;++b){e.push(this.transformElement(c[b]))}return this},invoke:function(d,a){var g=this.elements,e=g.length,c,b;d=Ext.dom.Element.prototype[d];for(b=0;b<e;b++){c=g[b];if(c){d.apply(this.getElement(c),a)}}return this},item:function(b){var c=this.elements[b],a=null;if(c){a=this.getElement(c)}return a},slice:function(){return this.elements.slice.apply(this.elements,arguments)},addListener:function(b,j,h,g){var d=this.elements,a=d.length,c,k;for(c=0;c<a;c++){k=d[c];if(k){Ext.EventManager.on(k,b,j,h||k,g)}}return this},each:function(g,d){var h=this,c=h.elements,a=c.length,b,j;for(b=0;b<a;b++){j=c[b];if(j){j=this.getElement(j);if(g.call(d||j,j,h,b)===false){break}}}return h},fill:function(a){var b=this;b.elements=[];b.add(a);return b},insert:function(b,a){Ext.Array.insert(this.elements,b,a)},filter:function(b){var h=this,c=h.elements,g=c.length,d=[],e=0,j=typeof b=="function",k,a;for(;e<g;e++){a=c[e];k=false;if(a){a=h.getElement(a);if(j){k=b.call(a,a,h,e)!==false}else{k=a.is(b)}if(k){d.push(h.transformElement(a))}}}h.elements=d;return h},indexOf:function(a){return Ext.Array.indexOf(this.elements,this.transformElement(a))},replaceElement:function(e,c,a){var b=!isNaN(e)?e:this.indexOf(e),g;if(b>-1){c=Ext.getDom(c);if(a){g=this.elements[b];g.parentNode.insertBefore(c,g);Ext.removeNode(g)}Ext.Array.splice(this.elements,b,1,c)}return this},clear:function(d){var c=this,b=c.elements,a=b.length-1;if(d){for(;a>=0;a--){Ext.removeNode(b[a])}}this.elements=[]},addElements:function(d,b){if(!d){return this}if(typeof d=="string"){d=Ext.dom.Element.selectorFunction(d,b)}var c=this.elements,a=d.length,g;for(g=0;g<a;g++){c.push(Ext.get(d[g]))}return this},first:function(){return this.item(0)},last:function(){return this.item(this.getCount()-1)},contains:function(a){return this.indexOf(a)!=-1},removeElement:function(e,i){e=[].concat(e);var d=this,g=d.elements,c=e.length,h,b,a;for(a=0;a<c;a++){h=e[a];if((b=(g[h]||g[h=d.indexOf(h)]))){if(i){if(b.dom){b.remove()}else{Ext.removeNode(b)}}Ext.Array.erase(g,h,1)}}return d}},function(){this.importElementMethods();this.prototype.on=this.prototype.addListener;if(Ext.DomQuery){Ext.dom.Element.selectorFunction=Ext.DomQuery.select}Ext.dom.Element.select=function(a,b){var c;if(typeof a=="string"){c=Ext.dom.Element.selectorFunction(a,b)}else{if(a.length!==undefined){c=a}else{}}return new Ext.CompositeElementLite(c)};Ext.select=function(){return Ext.dom.Element.select.apply(Ext.dom.Element,arguments)}});Ext.define("Ext.dom.CompositeElement",{alternateClassName:"Ext.CompositeElement",extend:Ext.dom.CompositeElementLite,getElement:function(a){return a},transformElement:function(a){return Ext.get(a)}},function(){Ext.dom.Element.select=function(a,d,b){var c;if(typeof a=="string"){c=Ext.dom.Element.selectorFunction(a,b)}else{if(a.length!==undefined){c=a}else{}}return(d===true)?new Ext.CompositeElement(c):new Ext.CompositeElementLite(c)}});Ext.select=Ext.Element.select;Ext.define("Ext.util.HashMap",{mixins:{observable:Ext.util.Observable},constructor:function(a){a=a||{};var c=this,b=a.keyFn;c.initialConfig=a;c.addEvents("add","clear","remove","replace");c.mixins.observable.constructor.call(c,a);c.clear(true);if(b){c.getKey=b}},getCount:function(){return this.length},getData:function(a,b){if(b===undefined){b=a;a=this.getKey(b)}return[a,b]},getKey:function(a){return a.id},add:function(a,c){var b=this;if(arguments.length===1){c=a;a=b.getKey(c)}if(b.containsKey(a)){return b.replace(a,c)}b.map[a]=c;++b.length;if(b.hasListeners.add){b.fireEvent("add",b,a,c)}return c},replace:function(b,d){var c=this,e=c.map,a;if(arguments.length===1){d=b;b=c.getKey(d)}if(!c.containsKey(b)){c.add(b,d)}a=e[b];e[b]=d;if(c.hasListeners.replace){c.fireEvent("replace",c,b,d,a)}return d},remove:function(b){var a=this.findKey(b);if(a!==undefined){return this.removeAtKey(a)}return false},removeAtKey:function(a){var b=this,c;if(b.containsKey(a)){c=b.map[a];delete b.map[a];--b.length;if(b.hasListeners.remove){b.fireEvent("remove",b,a,c)}return true}return false},get:function(a){return this.map[a]},clear:function(a){var b=this;b.map={};b.length=0;if(a!==true&&b.hasListeners.clear){b.fireEvent("clear",b)}return b},containsKey:function(a){return this.map[a]!==undefined},contains:function(a){return this.containsKey(this.findKey(a))},getKeys:function(){return this.getArray(true)},getValues:function(){return this.getArray(false)},getArray:function(d){var a=[],b,c=this.map;for(b in c){if(c.hasOwnProperty(b)){a.push(d?b:c[b])}}return a},each:function(d,c){var a=Ext.apply({},this.map),b,e=this.length;c=c||this;for(b in a){if(a.hasOwnProperty(b)){if(d.call(c,b,a[b],e)===false){break}}}return this},clone:function(){var c=new this.self(this.initialConfig),b=this.map,a;c.suspendEvents();for(a in b){if(b.hasOwnProperty(a)){c.add(a,b[a])}}c.resumeEvents();return c},findKey:function(b){var a,c=this.map;for(a in c){if(c.hasOwnProperty(a)&&c[a]===b){return a}}return undefined}});Ext.define("Ext.AbstractManager",{typeName:"type",constructor:function(a){Ext.apply(this,a||{});this.all=new Ext.util.HashMap();this.types={}},get:function(a){return this.all.get(a)},register:function(a){this.all.add(a)},unregister:function(a){this.all.remove(a)},registerType:function(b,a){this.types[b]=a;a[this.typeName]=b},isRegistered:function(a){return this.types[a]!==undefined},create:function(a,d){var b=a[this.typeName]||a.type||d,c=this.types[b];return new c(a)},onAvailable:function(g,c,b){var a=this.all,d,e;if(a.containsKey(g)){d=a.get(g);c.call(b||d,d)}else{e=function(j,h,i){if(h==g){c.call(b||i,i);a.un("add",e)}};a.on("add",e)}},each:function(b,a){this.all.each(b,a||this)},getCount:function(){return this.all.getCount()}});Ext.define("Ext.ComponentManager",{extend:Ext.AbstractManager,alternateClassName:"Ext.ComponentMgr",singleton:true,typeName:"xtype",create:function(a,b){if(typeof a=="string"){return Ext.widget(a)}if(a.isComponent){return a}return Ext.widget(a.xtype||b,a)},registerType:function(b,a){this.types[b]=a;a[this.typeName]=b;a.prototype[this.typeName]=b}},function(){Ext.getCmp=function(a){return Ext.ComponentManager.get(a)}});Ext.define("Ext.ComponentQuery",{singleton:true},function(){var i=this,l=Ext.dom.Query.operators,o=/(\d*)n\+?(\d*)/,a=/\D/,m=["var r = [],","i = 0,","it = items,","l = it.length,","c;","for (; i < l; i++) {","c = it[i];","if (c.{0}) {","r.push(c);","}","}","return r;"].join(""),g=function(s,r){return r.method.apply(this,[s].concat(r.args))},b=function(t,x){var r=[],u=0,w=t.length,v,s=x!==">";for(;u<w;u++){v=t[u];if(v.getRefItems){r=r.concat(v.getRefItems(s))}}return r},h=function(s){var r=[],t=0,v=s.length,u;for(;t<v;t++){u=s[t];while(!!(u=u.getRefOwner())){r.push(u)}}return r},p=function(s,x,w){if(x==="*"){return s.slice()}else{var r=[],t=0,v=s.length,u;for(;t<v;t++){u=s[t];if(u.isXType(x,w)){r.push(u)}}return r}},k=function(s,v){var r=[],t=0,w=s.length,u;for(;t<w;t++){u=s[t];if(u.hasCls(v)){r.push(u)}}return r},q=function(z,A,u,t){var D=[],y=0,s=z.length,C,v,B,r,x,w;if(A.charAt(0)==="@"){C=true;A=A.substr(1)}if(A.charAt(0)==="?"){C=true;v=true;A=A.substr(1)}for(;y<s;y++){B=z[y];if(!C||B.hasOwnProperty(A)){r=B[A];if(v){D.push(B)}else{if(u==="~="){if(r){if(!Ext.isArray(r)){r=r.split(" ")}for(x=0,w=r.length;x<w;x++){if(l[u](Ext.coerce(r[x],t),t)){D.push(B);break}}}}else{if(!t?!!B[A]:l[u](Ext.coerce(r,t),t)){D.push(B)}}}}}return D},e=function(s,w){var r=[],t=0,v=s.length,u;for(;t<v;t++){u=s[t];if(u.getItemId()===w){r.push(u)}}return r},n=function(r,s,t){return i.pseudos[s](r,t)},j=/^(\s?([>\^])\s?|\s|$)/,d=/^(#)?([\w\-]+|\*)(?:\((true|false)\))?/,c=[{re:/^\.([\w\-]+)(?:\((true|false)\))?/,method:p},{re:/^(?:\[((?:@|\?)?[\w\-\$]*[^\^\$\*~%!])\s?(?:(=|.=)\s?['"]?(.*?)["']?)?\])/,method:q},{re:/^#([\w\-]+)/,method:e},{re:/^\:([\w\-]+)(?:\(((?:\{[^\}]+\})|(?:(?!\{)[^\s>\/]*?(?!\})))\))?/,method:n},{re:/^(?:\{([^\}]+)\})/,method:m}];i.Query=Ext.extend(Object,{constructor:function(r){r=r||{};Ext.apply(this,r)},execute:function(s){var u=this.operations,v=0,w=u.length,t,r;if(!s){r=Ext.ComponentManager.all.getArray()}else{if(Ext.isIterable(s)){r=s}else{if(s.isMixedCollection){r=s.items}}}for(;v<w;v++){t=u[v];if(t.mode==="^"){r=h(r||[s])}else{if(t.mode){r=b(r||[s],t.mode)}else{r=g(r||b([s]),t)}}if(v===w-1){return r}}return[]},is:function(t){var s=this.operations,w=Ext.isArray(t)?t:[t],r=w.length,x=s[s.length-1],v,u;w=g(w,x);if(w.length===r){if(s.length>1){for(u=0,v=w.length;u<v;u++){if(Ext.Array.indexOf(this.execute(),w[u])===-1){return false}}}return true}return false}});Ext.apply(this,{cache:{},pseudos:{not:function(x,r){var y=Ext.ComponentQuery,v=0,w=x.length,u=[],t=-1,s;for(;v<w;++v){s=x[v];if(!y.is(s,r)){u[++t]=s}}return u},first:function(s){var r=[];if(s.length>0){r.push(s[0])}return r},last:function(t){var r=t.length,s=[];if(r>0){s.push(t[r-1])}return s},focusable:function(s){var r=s.length,u=[],t=0,v;for(;t<r;t++){v=s[t];if(v.isFocusable()){u.push(v)}}return u},"nth-child":function(x,y){var z=[],s=o.exec(y=="even"&&"2n"||y=="odd"&&"2n+1"||!a.test(y)&&"n+"+y||y),w=(s[1]||1)-0,u=s[2]-0,v,r,t;for(v=0;r=x[v];v++){t=v+1;if(w==1){if(u==0||t==u){z.push(r)}}else{if((t+u)%w==0){z.push(r)}}}return z}},query:function(s,z){var A=s.split(","),r=A.length,t=0,u=[],B=[],y={},w,v,x;for(;t<r;t++){s=Ext.String.trim(A[t]);w=this.cache[s]||(this.cache[s]=this.parse(s));u=u.concat(w.execute(z))}if(r>1){v=u.length;for(t=0;t<v;t++){x=u[t];if(!y[x.id]){B.push(x);y[x.id]=true}}u=B}return u},is:function(s,r){if(!r){return true}var u=r.split(","),v=u.length,t=0,w;for(;t<v;t++){r=Ext.String.trim(u[t]);w=this.cache[r]||(this.cache[r]=this.parse(r));if(w.is(s)){return true}}return false},parse:function(u){var s=[],t=c.length,y,v,z,A,B,w,x,r;while(u&&y!==u){y=u;v=u.match(d);if(v){z=v[1];if(z==="#"){s.push({method:e,args:[Ext.String.trim(v[2])]})}else{if(z==="."){s.push({method:k,args:[Ext.String.trim(v[2])]})}else{s.push({method:p,args:[Ext.String.trim(v[2]),Boolean(v[3])]})}}u=u.replace(v[0],"")}while(!(A=u.match(j))){for(w=0;u&&w<t;w++){x=c[w];B=u.match(x.re);r=x.method;if(B){s.push({method:Ext.isString(x.method)?Ext.functionFactory("items",Ext.String.format.apply(Ext.String,[r].concat(B.slice(1)))):x.method,args:B.slice(1)});u=u.replace(B[0],"");break}if(w===(t-1)){Ext.Error.raise('Invalid ComponentQuery selector: "'+arguments[0]+'"')}}}if(A[1]){s.push({mode:A[2]||A[1]});u=u.replace(A[0],"")}}return new i.Query({operations:s})}})});Ext.define("Ext.util.ProtoElement",(function(){var b=Ext.String.splitWords,a=Ext.Array.toMap;return{isProtoEl:true,clsProp:"cls",styleProp:"style",removedProp:"removed",styleIsText:false,constructor:function(c){var d=this;Ext.apply(d,c);d.classList=b(d.cls);d.classMap=a(d.classList);delete d.cls;if(Ext.isFunction(d.style)){d.styleFn=d.style;delete d.style}else{if(typeof d.style=="string"){d.style=Ext.Element.parseStyles(d.style)}else{if(d.style){d.style=Ext.apply({},d.style)}}}},flush:function(){this.flushClassList=[];this.removedClasses={};delete this.style;delete this.unselectableAttr},addCls:function(n){var l=this,m=(typeof n==="string")?b(n):n,e=m.length,j=l.classList,d=l.classMap,g=l.flushClassList,h=0,k;for(;h<e;++h){k=m[h];if(!d[k]){d[k]=true;j.push(k);if(g){g.push(k);delete l.removedClasses[k]}}}return l},hasCls:function(c){return c in this.classMap},removeCls:function(o){var n=this,l=n.classList,g=(n.classList=[]),j=a(b(o)),e=l.length,d=n.classMap,k=n.removedClasses,h,m;for(h=0;h<e;++h){m=l[h];if(j[m]){if(k){if(d[m]){k[m]=true;Ext.Array.remove(n.flushClassList,m)}}delete d[m]}else{g.push(m)}}return n},setStyle:function(g,e){var d=this,c=d.style||(d.style={});if(typeof g=="string"){if(arguments.length===1){d.setStyle(Ext.Element.parseStyles(g))}else{c[g]=e}}else{Ext.apply(c,g)}return d},unselectable:function(){this.addCls(Ext.dom.Element.unselectableCls);if(Ext.isOpera){this.unselectableAttr=true}},writeTo:function(h){var e=this,g=e.flushClassList||e.classList,d=e.removedClasses,c;if(e.styleFn){c=Ext.apply({},e.styleFn());Ext.apply(c,e.style)}else{c=e.style}h[e.clsProp]=g.join(" ");if(c){h[e.styleProp]=e.styleIsText?Ext.DomHelper.generateStyles(c):c}if(d){d=Ext.Object.getKeys(d);if(d.length){h[e.removedProp]=d.join(" ")}}if(e.unselectableAttr){h.unselectable="on"}return h}}}()));Ext.define("Ext.PluginManager",{extend:Ext.AbstractManager,alternateClassName:"Ext.PluginMgr",singleton:true,typeName:"ptype",create:function(b,d,c){var a;if(b.init){a=b}else{if(c){b=Ext.apply({},b);b.cmp=c}else{c=b.cmp}if(b.xclass){a=Ext.create(b)}else{a=Ext.ClassManager.getByAlias(("plugin."+(b.ptype||d)));if(typeof a==="function"){a=new a(b)}}}if(a&&c&&a.setCmp&&!a.setCmpCalled){a.setCmp(c);a.setCmpCalled=true}return a},findByType:function(c,g){var e=[],b=this.types,a,d;for(a in b){if(!b.hasOwnProperty(a)){continue}d=b[a];if(d.type==c&&(!g||(g===true&&d.isDefault))){e.push(d)}}return e}},function(){Ext.preg=function(){return Ext.PluginManager.registerType.apply(Ext.PluginManager,arguments)}});Ext.define("Ext.util.Filter",{id:null,anyMatch:false,exactMatch:false,caseSensitive:false,disabled:false,operator:null,statics:{createFilterFn:function(a){return a&&a.length?function(e){var d=true,g=a.length,b,c;for(b=0;d&&b<g;b++){c=a[b];if(!c.disabled){d=d&&c.filterFn.call(c.scope||c,e)}}return d}:function(){return true}}},operatorFns:{"<":function(a){return Ext.coerce(this.getRoot(a)[this.property],this.value)<this.value},"<=":function(a){return Ext.coerce(this.getRoot(a)[this.property],this.value)<=this.value},"=":function(a){return Ext.coerce(this.getRoot(a)[this.property],this.value)==this.value},">=":function(a){return Ext.coerce(this.getRoot(a)[this.property],this.value)>=this.value},">":function(a){return Ext.coerce(this.getRoot(a)[this.property],this.value)>this.value},"!=":function(a){return Ext.coerce(this.getRoot(a)[this.property],this.value)!=this.value}},constructor:function(a){var b=this;b.initialConfig=a;Ext.apply(b,a);b.filter=b.filter||b.filterFn;if(b.filter===undefined){b.setValue(a.value)}},setValue:function(b){var a=this;a.value=b;if(a.property===undefined||a.value===undefined){}else{a.filter=a.createFilterFn()}a.filterFn=a.filter},setFilterFn:function(a){this.filterFn=this.filter=a},createFilterFn:function(){var a=this,c=a.createValueMatcher(),b=a.property;if(a.operator){return a.operatorFns[a.operator]}else{return function(d){var e=a.getRoot(d)[b];return c===null?e===null:c.test(e)}}},getRoot:function(b){var a=this.root;return a===undefined?b:b[a]},createValueMatcher:function(){var d=this,e=d.value,g=d.anyMatch,c=d.exactMatch,a=d.caseSensitive,b=Ext.String.escapeRegex;if(e===null){return e}if(!e.exec){e=String(e);if(g===true){e=b(e)}else{e="^"+b(e);if(c===true){e+="$"}}e=new RegExp(e,a?"":"i")}return e},serialize:function(){var b=this,a=Ext.apply({},b.initialConfig);a.value=b.value;return a}},function(){this.prototype.operatorFns["=="]=this.prototype.operatorFns["="]});Ext.define("Ext.util.AbstractMixedCollection",{mixins:{observable:Ext.util.Observable},isMixedCollection:true,generation:0,indexGeneration:0,constructor:function(b,a){var c=this;if(arguments.length===1&&Ext.isObject(b)){c.initialConfig=b;Ext.apply(c,b)}else{c.allowFunctions=b===true;if(a){c.getKey=a}c.initialConfig={allowFunctions:c.allowFunctions,getKey:c.getKey}}c.items=[];c.map={};c.keys=[];c.indexMap={};c.length=0;c.mixins.observable.constructor.call(c)},allowFunctions:false,add:function(a,b){return this.insert(this.length,a,b)},getKey:function(a){return a.id},replace:function(c,e){var d=this,a,b;if(arguments.length==1){e=arguments[0];c=d.getKey(e)}a=d.map[c];if(typeof c=="undefined"||c===null||typeof a=="undefined"){return d.add(c,e)}d.generation++;b=d.indexOfKey(c);d.items[b]=e;d.map[c]=e;if(d.hasListeners.replace){d.fireEvent("replace",c,a,e)}return e},updateKey:function(g,h){var d=this,e=d.map,c=d.indexMap,a=d.indexOfKey(g),b;if(a>-1){b=e[g];delete e[g];delete c[g];e[h]=b;c[h]=a;d.keys[a]=h;d.generation++}},addAll:function(c){var b=this,a;if(arguments.length>1||Ext.isArray(c)){b.insert(b.length,arguments.length>1?arguments:c)}else{for(a in c){if(c.hasOwnProperty(a)){if(b.allowFunctions||typeof c[a]!="function"){b.add(a,c[a])}}}}},each:function(e,d){var b=Ext.Array.push([],this.items),c=0,a=b.length,g;for(;c<a;c++){g=b[c];if(e.call(d||g,g,c,a)===false){break}}},eachKey:function(e,d){var g=this.keys,b=this.items,c=0,a=g.length;for(;c<a;c++){e.call(d||window,g[c],b[c],c,a)}},findBy:function(e,d){var g=this.keys,b=this.items,c=0,a=b.length;for(;c<a;c++){if(e.call(d||window,b[c],g[c])){return b[c]}}return null},find:function(){if(Ext.isDefined(Ext.global.console)){Ext.global.console.warn("Ext.util.MixedCollection: find has been deprecated. Use findBy instead.")}return this.findBy.apply(this,arguments)},insert:function(a,b,c){if(Ext.isIterable(b)){return this.doInsert(a,b,c)}return(c?this.doInsert(a,[b],[c]):this.doInsert(a,[b]))[0]},doInsert:function(g,l,k){var j=this,a,b,e,h=l.length,d=j.hasListeners.add,c;if(k!=null){j.useLinearSearch=true}else{k=l;l=new Array(h);for(e=0;e<h;e++){l[e]=this.getKey(k[e])}}j.suspendEvents();for(e=0;e<h;e++){b=j.indexOfKey(l[e]);if(b!==-1){if(b<g){g--}j.removeAt(b)}}j.resumeEvents();c=g===j.length&&j.indexGeneration===j.generation;Ext.Array.insert(j.items,g,k);Ext.Array.insert(j.keys,g,l);j.length+=h;j.generation++;if(c){j.indexGeneration=j.generation}for(e=0;e<h;e++,g++){a=l[e];if(a!=null){j.map[a]=k[e];if(c){j.indexMap[a]=g}}if(d){j.fireEvent("add",g,k[e],a)}}return k},remove:function(d){var c=this,b,a;if(!c.useLinearSearch&&(b=c.getKey(d))){a=c.indexOfKey(b)}else{a=Ext.Array.indexOf(c.items,d)}return(a===-1)?false:c.removeAt(a)},removeAll:function(a){var c=this,b;if(a||c.hasListeners.remove){if(a){for(b=a.length-1;b>=0;--b){c.remove(a[b])}}else{while(c.length){c.removeAt(0)}}}else{c.length=c.items.length=c.keys.length=0;c.map={};c.indexMap={};c.generation++;c.indexGeneration=c.generation}},removeAt:function(a){var c=this,d,b;if(a<c.length&&a>=0){c.length--;d=c.items[a];Ext.Array.erase(c.items,a,1);b=c.keys[a];if(typeof b!="undefined"){delete c.map[b]}Ext.Array.erase(c.keys,a,1);if(c.hasListeners.remove){c.fireEvent("remove",d,b)}c.generation++;return d}return false},removeRange:function(h,a){var j=this,b,k,g,e,c,d;if(h<j.length&&h>=0){if(!a){a=1}e=Math.min(h+a,j.length);a=e-h;d=e===j.length;c=d&&j.indexGeneration===j.generation;for(g=h;g<e;g++){k=j.keys[g];if(k!=null){delete j.map[k];if(c){delete j.indexMap[k]}}}b=j.items[g-1];j.length-=a;j.generation++;if(c){j.indexGeneration=j.generation}if(d){j.items.length=j.keys.length=j.length}else{j.items.splice(h,a);j.keys.splice(h,a)}return b}return false},removeAtKey:function(b){var d=this,c=d.keys,a;if(b==null){for(a=c.length-1;a>=0;a--){if(c[a]==null){d.removeAt(a)}}}else{return d.removeAt(d.indexOfKey(b))}},getCount:function(){return this.length},indexOf:function(c){var b=this,a;if(c!=null){if(!b.useLinearSearch&&(a=b.getKey(c))){return this.indexOfKey(a)}return Ext.Array.indexOf(b.items,c)}return -1},indexOfKey:function(a){if(this.map[a]==null){return -1}if(this.indexGeneration!==this.generation){this.rebuildIndexMap()}return this.indexMap[a]},rebuildIndexMap:function(){var e=this,d=e.indexMap={},c=this.keys,a=c.length,b;for(b=0;b<a;b++){d[c[b]]=b}e.indexGeneration=e.generation},get:function(b){var d=this,a=d.map[b],c=a!==undefined?a:(typeof b=="number")?d.items[b]:undefined;return typeof c!="function"||d.allowFunctions?c:null},getAt:function(a){return this.items[a]},getByKey:function(a){return this.map[a]},contains:function(c){var b=this,a;if(c!=null){if(!b.useLinearSearch&&(a=b.getKey(c))){return this.map[a]!=null}return Ext.Array.indexOf(this.items,c)!==-1}return false},containsKey:function(a){return this.map[a]!=null},clear:function(){var a=this;a.length=0;a.items=[];a.keys=[];a.map={};a.indexMap={};a.generation++;a.indexGeneration=a.generation;if(a.hasListeners.clear){a.fireEvent("clear")}},first:function(){return this.items[0]},last:function(){return this.items[this.length-1]},sum:function(h,b,j,a){var c=this.extractValues(h,b),g=c.length,e=0,d;j=j||0;a=(a||a===0)?a:g-1;for(d=j;d<=a;d++){e+=c[d]}return e},collect:function(k,e,h){var l=this.extractValues(k,e),a=l.length,b={},c=[],j,g,d;for(d=0;d<a;d++){j=l[d];g=String(j);if((h||!Ext.isEmpty(j))&&!b[g]){b[g]=true;c.push(j)}}return c},extractValues:function(c,a){var b=this.items;if(a){b=Ext.Array.pluck(b,a)}return Ext.Array.pluck(b,c)},hasRange:function(b,a){return(a<this.length)},getRange:function(g,a){var e=this,c=e.items,b=[],d;if(c.length<1){return b}g=g||0;a=Math.min(a==null?e.length-1:a,e.length-1);if(g<=a){return c.slice(g,a+1)}else{for(d=g;d>=a;d--){b[b.length]=c[d]}}return b},filter:function(d,c,e,a){var b=[];if(Ext.isString(d)){b.push(new Ext.util.Filter({property:d,value:c,anyMatch:e,caseSensitive:a}))}else{if(Ext.isArray(d)||d instanceof Ext.util.Filter){b=b.concat(d)}}return this.filterBy(Ext.util.Filter.createFilterFn(b))},filterBy:function(e,d){var j=this,a=new j.self(j.initialConfig),h=j.keys,b=j.items,g=b.length,c;a.getKey=j.getKey;for(c=0;c<g;c++){if(e.call(d||j,b[c],h[c])){a.add(h[c],b[c])}}return a},findIndex:function(c,b,e,d,a){if(Ext.isEmpty(b,false)){return -1}b=this.createValueMatcher(b,d,a);return this.findIndexBy(function(g){return g&&b.test(g[c])},null,e)},findIndexBy:function(e,d,j){var h=this,g=h.keys,b=h.items,c=j||0,a=b.length;for(;c<a;c++){if(e.call(d||h,b[c],g[c])){return c}}return -1},createValueMatcher:function(c,e,a,b){if(!c.exec){var d=Ext.String.escapeRegex;c=String(c);if(e===true){c=d(c)}else{c="^"+d(c);if(b===true){c+="$"}}c=new RegExp(c,a?"":"i")}return c},clone:function(){var a=this,b=new this.self(a.initialConfig);b.add(a.keys,a.items);return b}});Ext.define("Ext.util.Sorter",{direction:"ASC",constructor:function(a){var b=this;Ext.apply(b,a);b.updateSortFunction()},createSortFunction:function(b){var c=this,d=c.direction||"ASC",a=d.toUpperCase()=="DESC"?-1:1;return function(g,e){return a*b.call(c,g,e)}},defaultSorterFn:function(d,c){var b=this,a=b.transform,g=b.getRoot(d)[b.property],e=b.getRoot(c)[b.property];if(a){g=a(g);e=a(e)}return g>e?1:(g<e?-1:0)},getRoot:function(a){return this.root===undefined?a:a[this.root]},setDirection:function(b){var a=this;a.direction=b?b.toUpperCase():b;a.updateSortFunction()},toggle:function(){var a=this;a.direction=Ext.String.toggle(a.direction,"ASC","DESC");a.updateSortFunction()},updateSortFunction:function(a){var b=this;a=a||b.sorterFn||b.defaultSorterFn;b.sort=b.createSortFunction(a)},serialize:function(){return{root:this.root,property:this.property,direction:this.direction}}});Ext.define("Ext.util.Sortable",{isSortable:true,defaultSortDirection:"ASC",statics:{createComparator:function(a){return a&&a.length?function(d,c){var b=a[0].sort(d,c),g=a.length,e=1;for(;e<g;e++){b=b||a[e].sort.call(this,d,c)}return b}:function(){return 0}}},initSortable:function(){var a=this,b=a.sorters;a.sorters=new Ext.util.AbstractMixedCollection(false,function(c){return c.id||c.property});if(b){a.sorters.addAll(a.decodeSorters(b))}},sort:function(g,e,b,d){var c=this,h,a;if(Ext.isArray(g)){d=b;b=e;a=g}else{if(Ext.isObject(g)){d=b;b=e;a=[g]}else{if(Ext.isString(g)){h=c.sorters.get(g);if(!h){h={property:g,direction:e};a=[h]}else{if(e===undefined){h.toggle()}else{h.setDirection(e)}}}}}if(a&&a.length){a=c.decodeSorters(a);if(Ext.isString(b)){if(b==="prepend"){c.sorters.insert(0,a)}else{c.sorters.addAll(a)}}else{c.sorters.clear();c.sorters.addAll(a)}}if(d!==false){c.fireEvent("beforesort",c,a);c.onBeforeSort(a);g=c.sorters.items;if(g.length){c.doSort(c.generateComparator())}}return g},generateComparator:function(){var a=this.sorters.getRange();return a.length?this.createComparator(a):this.emptyComparator},emptyComparator:function(){return 0},onBeforeSort:Ext.emptyFn,decodeSorters:function(g){if(!Ext.isArray(g)){if(g===undefined){g=[]}else{g=[g]}}var d=g.length,h=Ext.util.Sorter,a=this.model?this.model.prototype.fields:null,e,b,c;for(c=0;c<d;c++){b=g[c];if(!(b instanceof h)){if(Ext.isString(b)){b={property:b}}Ext.applyIf(b,{root:this.sortRoot,direction:"ASC"});if(b.fn){b.sorterFn=b.fn}if(typeof b=="function"){b={sorterFn:b}}if(a&&!b.transform){e=a.get(b.property);b.transform=e&&e.sortType!==Ext.identityFn?e.sortType:undefined}g[c]=new Ext.util.Sorter(b)}}return g},getSorters:function(){return this.sorters.items},getFirstSorter:function(){var c=this.sorters.items,a=c.length,b=0,d;for(;b<a;++b){d=c[b];if(!d.isGrouper){return d}}return null}},function(){this.prototype.createComparator=this.createComparator});Ext.define("Ext.util.MixedCollection",{extend:Ext.util.AbstractMixedCollection,mixins:{sortable:Ext.util.Sortable},constructor:function(){var a=this;a.callParent(arguments);a.addEvents("sort");a.mixins.sortable.initSortable.call(a)},doSort:function(a){this.sortBy(a)},_sort:function(m,b,l){var k=this,e,g,d=String(b).toUpperCase()=="DESC"?-1:1,j=[],n=k.keys,h=k.items,a;l=l||function(i,c){return i-c};for(e=0,g=h.length;e<g;e++){j[j.length]={key:n[e],value:h[e],index:e}}Ext.Array.sort(h,function(i,c){return l(i[m],c[m])*d||(i.index<c.index?-1:1)});for(e=0,g=j.length;e<g;e++){a=j[e];h[e]=a.value;n[e]=a.key;k.indexMap[a.key]=e}k.generation++;k.indexGeneration=k.generation;k.fireEvent("sort",k)},sortBy:function(b){var j=this,a=j.items,h,g=j.keys,d,e=a.length,c;for(c=0;c<e;c++){a[c].$extCollectionIndex=c}Ext.Array.sort(a,function(k,i){return b(k,i)||(k.$extCollectionIndex<i.$extCollectionIndex?-1:1)});for(c=0;c<e;c++){h=a[c];d=j.getKey(h);g[c]=d;j.indexMap[d]=c;delete a.$extCollectionIndex}j.generation++;j.indexGeneration=j.generation;j.fireEvent("sort",j,a,g)},findInsertionIndex:function(e,d){var g=this,b=g.items,i=0,a=b.length-1,c,h;if(!d){d=g.generateComparator()}while(i<=a){c=(i+a)>>1;h=d(e,b[c]);if(h>=0){i=c+1}else{if(h<0){a=c-1}}}return i},reorder:function(d){var h=this,b=h.items,c=0,g=b.length,a=[],e=[],i;h.suspendEvents();for(i in d){a[d[i]]=b[i]}for(c=0;c<g;c++){if(d[c]==undefined){e.push(b[c])}}for(c=0;c<g;c++){if(a[c]==undefined){a[c]=e.shift()}}h.clear();h.addAll(a);h.resumeEvents();h.fireEvent("sort",h)},sortByKey:function(a,b){this._sort("key",a,b||function(d,c){var g=String(d).toUpperCase(),e=String(c).toUpperCase();return g>e?1:(g<e?-1:0)})}});Ext.define("Ext.fx.target.Target",{isAnimTarget:true,constructor:function(a){this.target=a;this.id=this.getId()},getId:function(){return this.target.id}});Ext.define("Ext.fx.target.Element",{extend:Ext.fx.target.Target,type:"element",getElVal:function(b,a,c){if(c==undefined){if(a==="x"){c=b.getX()}else{if(a==="y"){c=b.getY()}else{if(a==="scrollTop"){c=b.getScroll().top}else{if(a==="scrollLeft"){c=b.getScroll().left}else{if(a==="height"){c=b.getHeight()}else{if(a==="width"){c=b.getWidth()}else{c=b.getStyle(a)}}}}}}}return c},getAttr:function(a,c){var b=this.target;return[[b,this.getElVal(b,a,c)]]},setAttr:function(k){var e=this.target,h=k.length,l,g,b,d,c,a;for(d=0;d<h;d++){l=k[d].attrs;for(g in l){if(l.hasOwnProperty(g)){a=l[g].length;for(c=0;c<a;c++){b=l[g][c];this.setElVal(b[0],g,b[1])}}}}},setElVal:function(b,a,c){if(a==="x"){b.setX(c)}else{if(a==="y"){b.setY(c)}else{if(a==="scrollTop"){b.scrollTo("top",c)}else{if(a==="scrollLeft"){b.scrollTo("left",c)}else{if(a==="width"){b.setWidth(c)}else{if(a==="height"){b.setHeight(c)}else{b.setStyle(a,c)}}}}}}}});Ext.define("Ext.fx.target.ElementCSS",{extend:Ext.fx.target.Element,setAttr:function(n,e){var q={attrs:[],duration:[],easing:[]},m=n.length,g,p,k,l,c,b,h,d,a;for(h=0;h<m;h++){p=n[h];c=p.duration;l=p.easing;p=p.attrs;for(k in p){if(Ext.Array.indexOf(q.attrs,k)==-1){q.attrs.push(k.replace(/[A-Z]/g,function(i){return"-"+i.toLowerCase()}));q.duration.push(c+"ms");q.easing.push(l)}}}g=q.attrs.join(",");c=q.duration.join(",");l=q.easing.join(", ");for(h=0;h<m;h++){p=n[h].attrs;for(k in p){a=p[k].length;for(d=0;d<a;d++){b=p[k][d];b[0].setStyle(Ext.supports.CSS3Prefix+"TransitionProperty",e?"":g);b[0].setStyle(Ext.supports.CSS3Prefix+"TransitionDuration",e?"":c);b[0].setStyle(Ext.supports.CSS3Prefix+"TransitionTimingFunction",e?"":l);b[0].setStyle(k,b[1]);if(e){b=b[0].dom.offsetWidth}else{b[0].on(Ext.supports.CSS3TransitionEnd,function(){this.setStyle(Ext.supports.CSS3Prefix+"TransitionProperty",null);this.setStyle(Ext.supports.CSS3Prefix+"TransitionDuration",null);this.setStyle(Ext.supports.CSS3Prefix+"TransitionTimingFunction",null)},b[0],{single:true})}}}}}});Ext.define("Ext.fx.target.CompositeElement",{extend:Ext.fx.target.Element,isComposite:true,constructor:function(a){a.id=a.id||Ext.id(null,"ext-composite-");this.callParent([a])},getAttr:function(a,j){var b=[],h=this.target,g=h.elements,e=g.length,c,d;for(c=0;c<e;c++){d=g[c];if(d){d=h.getElement(d);b.push([d,this.getElVal(d,a,j)])}}return b},setAttr:function(n){var l=this.target,m=n.length,b=l.elements,r=b.length,p,d,q,h,c,g,e,a;for(g=0;g<m;g++){q=n[g].attrs;for(h in q){if(q.hasOwnProperty(h)){a=q[h].length;for(e=0;e<a;e++){p=q[h][e][1];for(d=0;d<r;++d){el=b[d];if(el){el=l.getElement(el);this.setElVal(el,h,p)}}}}}}}});Ext.define("Ext.fx.target.CompositeElementCSS",{extend:Ext.fx.target.CompositeElement,setAttr:function(){return Ext.fx.target.ElementCSS.prototype.setAttr.apply(this,arguments)}});Ext.define("Ext.fx.target.Sprite",{extend:Ext.fx.target.Target,type:"draw",getFromPrim:function(b,a){var c;switch(a){case"rotate":case"rotation":c=b.attr.rotation;return{x:c.x||0,y:c.y||0,degrees:c.degrees||0};case"scale":case"scaling":c=b.attr.scaling;return{x:c.x||1,y:c.y||1,cx:c.cx||0,cy:c.cy||0};case"translate":case"translation":c=b.attr.translation;return{x:c.x||0,y:c.y||0};default:return b.attr[a]}},getAttr:function(a,b){return[[this.target,b!=undefined?b:this.getFromPrim(this.target,a)]]},setAttr:function(m){var g=m.length,k=[],b,e,p,r,q,o,n,d,c,l,h,a;for(d=0;d<g;d++){b=m[d].attrs;for(e in b){p=b[e];a=p.length;for(c=0;c<a;c++){q=p[c][0];r=p[c][1];if(e==="translate"||e==="translation"){n={x:r.x,y:r.y}}else{if(e==="rotate"||e==="rotation"){l=r.x;if(isNaN(l)){l=null}h=r.y;if(isNaN(h)){h=null}n={degrees:r.degrees,x:l,y:h}}else{if(e==="scale"||e==="scaling"){l=r.x;if(isNaN(l)){l=null}h=r.y;if(isNaN(h)){h=null}n={x:l,y:h,cx:r.cx,cy:r.cy}}else{if(e==="width"||e==="height"||e==="x"||e==="y"){n=parseFloat(r)}else{n=r}}}}o=Ext.Array.indexOf(k,q);if(o==-1){k.push([q,{}]);o=k.length-1}k[o][1][e]=n}}}g=k.length;for(d=0;d<g;d++){k[d][0].setAttributes(k[d][1])}this.target.redraw()}});Ext.define("Ext.fx.target.CompositeSprite",{extend:Ext.fx.target.Sprite,getAttr:function(a,h){var b=[],g=[].concat(this.target.items),e=g.length,d,c;for(d=0;d<e;d++){c=g[d];b.push([c,h!=undefined?h:this.getFromPrim(c,a)])}return b}});Ext.define("Ext.fx.target.Component",{extend:Ext.fx.target.Target,type:"component",getPropMethod:{top:function(){return this.getPosition(true)[1]},left:function(){return this.getPosition(true)[0]},x:function(){return this.getPosition()[0]},y:function(){return this.getPosition()[1]},height:function(){return this.getHeight()},width:function(){return this.getWidth()},opacity:function(){return this.el.getStyle("opacity")}},setMethods:{top:"setPosition",left:"setPosition",x:"setPagePosition",y:"setPagePosition",height:"setSize",width:"setSize",opacity:"setOpacity"},getAttr:function(a,b){return[[this.target,b!==undefined?b:this.getPropMethod[a].call(this.target)]]},setAttr:function(s,g,b){var q=this,p=s.length,v,n,c,k,e,m,d,r,u,l,a={},t;for(k=0;k<p;k++){v=s[k].attrs;for(n in v){m=v[n].length;for(e=0;e<m;e++){c=v[n][e];t=a[q.setMethods[n]]||(a[q.setMethods[n]]={});t.target=c[0];t[n]=c[1]}}if(a.setPosition){c=a.setPosition;d=(c.left===undefined)?undefined:parseFloat(c.left);r=(c.top===undefined)?undefined:parseFloat(c.top);c.target.setPosition(d,r)}if(a.setPagePosition){c=a.setPagePosition;c.target.setPagePosition(c.x,c.y)}if(a.setSize){c=a.setSize;u=(c.width===undefined)?c.target.getWidth():parseFloat(c.width);l=(c.height===undefined)?c.target.getHeight():parseFloat(c.height);c.target.el.setSize(u,l);if(b||q.dynamic){Ext.globalEvents.on({idle:Ext.Function.bind(c.target.setSize,c.target,[u,l]),single:true})}}if(a.setOpacity){c=a.setOpacity;c.target.el.setStyle("opacity",c.opacity)}}}});Ext.define("Ext.fx.Queue",{constructor:function(){this.targets=new Ext.util.HashMap();this.fxQueue={}},getFxDefaults:function(a){var b=this.targets.get(a);if(b){return b.fxDefaults}return{}},setFxDefaults:function(a,c){var b=this.targets.get(a);if(b){b.fxDefaults=Ext.apply(b.fxDefaults||{},c)}},stopAnimation:function(b){var d=this,a=d.getFxQueue(b),c=a.length;while(c){a[c-1].end();c--}},getActiveAnimation:function(b){var a=this.getFxQueue(b);return(a&&!!a.length)?a[0]:false},hasFxBlock:function(b){var a=this.getFxQueue(b);return a&&a[0]&&a[0].block},getFxQueue:function(b){if(!b){return false}var c=this,a=c.fxQueue[b],d=c.targets.get(b);if(!d){return false}if(!a){c.fxQueue[b]=[];if(d.type!="element"){d.target.on("destroy",function(){c.fxQueue[b]=[]})}}return c.fxQueue[b]},queueFx:function(d){var c=this,e=d.target,a,b;if(!e){return}a=c.getFxQueue(e.getId());b=a.length;if(b){if(d.concurrent){d.paused=false}else{a[b-1].on("afteranimate",function(){d.paused=false})}}else{d.paused=false}d.on("afteranimate",function(){Ext.Array.remove(a,d);if(d.remove){if(e.type=="element"){var g=Ext.get(e.id);if(g){g.remove()}}}},this);a.push(d)}});Ext.define("Ext.fx.Manager",{singleton:true,mixins:{queue:Ext.fx.Queue},constructor:function(){var a=this;a.items=new Ext.util.MixedCollection();a.mixins.queue.constructor.call(a);a.taskRunner=new Ext.util.TaskRunner()},interval:16,forceJS:true,createTarget:function(d){var b=this,c=!b.forceJS&&Ext.supports.Transitions,a;b.useCSS3=c;if(d){if(d.tagName||Ext.isString(d)||d.isFly){d=Ext.get(d);a=new Ext.fx.target["Element"+(c?"CSS":"")](d)}else{if(d.dom){a=new Ext.fx.target["Element"+(c?"CSS":"")](d)}else{if(d.isComposite){a=new Ext.fx.target["CompositeElement"+(c?"CSS":"")](d)}else{if(d.isSprite){a=new Ext.fx.target.Sprite(d)}else{if(d.isCompositeSprite){a=new Ext.fx.target.CompositeSprite(d)}else{if(d.isComponent){a=new Ext.fx.target.Component(d)}else{if(d.isAnimTarget){return d}else{return null}}}}}}}b.targets.add(a);return a}else{return null}},addAnim:function(d){var c=this,b=c.items,a=c.task;b.add(d.id,d);if(!a&&b.length){a=c.task={run:c.runner,interval:c.interval,scope:c};c.taskRunner.start(a)}},removeAnim:function(d){var c=this,b=c.items,a=c.task;b.removeAtKey(d.id);if(a&&!b.length){c.taskRunner.stop(a);delete c.task}},runner:function(){var d=this,b=d.items.getRange(),c=0,a=b.length,e;d.targetArr={};d.timestamp=new Date();for(;c<a;c++){e=b[c];if(e.isReady()){d.startAnim(e)}}for(c=0;c<a;c++){e=b[c];if(e.isRunning()){d.runAnim(e)}}d.applyPendingAttrs()},startAnim:function(a){a.start(this.timestamp)},runAnim:function(d){if(!d){return}var c=this,g=c.useCSS3&&d.target.type=="element",a=c.timestamp-d.startTime,b=(a>=d.duration),e,h;e=this.collectTargetData(d,a,g,b);if(g){d.target.setAttr(e.anims[d.id].attributes,true);c.collectTargetData(d,d.duration,g,b);d.paused=true;e=d.target.target;if(d.target.isComposite){e=d.target.target.last()}h={};h[Ext.supports.CSS3TransitionEnd]=d.lastFrame;h.scope=d;h.single=true;e.on(h)}},collectTargetData:function(c,a,e,g){var b=c.target.getId(),d=this.targetArr[b];if(!d){d=this.targetArr[b]={id:b,el:c.target,anims:{}}}d.anims[c.id]={id:c.id,anim:c,elapsed:a,isLastFrame:g,attributes:[{duration:c.duration,easing:(e&&c.reverse)?c.easingFn.reverse().toCSS3():c.easing,attrs:c.runAnim(a)}]};return d},applyPendingAttrs:function(){var e=this.targetArr,g,c,b,d,a;for(c in e){if(e.hasOwnProperty(c)){g=e[c];for(a in g.anims){if(g.anims.hasOwnProperty(a)){b=g.anims[a];d=b.anim;if(b.attributes&&d.isRunning()){g.el.setAttr(b.attributes,false,b.isLastFrame);if(b.isLastFrame){d.lastFrame()}}}}}}}});Ext.define("Ext.fx.Animator",{mixins:{observable:Ext.util.Observable},isAnimator:true,duration:250,delay:0,delayStart:0,dynamic:false,easing:"ease",running:false,paused:false,damper:1,iterations:1,currentIteration:0,keyframeStep:0,animKeyFramesRE:/^(from|to|\d+%?)$/,constructor:function(a){var b=this;a=Ext.apply(b,a||{});b.config=a;b.id=Ext.id(null,"ext-animator-");b.addEvents("beforeanimate","keyframe","afteranimate");b.mixins.observable.constructor.call(b,a);b.timeline=[];b.createTimeline(b.keyframes);if(b.target){b.applyAnimator(b.target);Ext.fx.Manager.addAnim(b)}},sorter:function(d,c){return d.pct-c.pct},createTimeline:function(d){var h=this,l=[],j=h.to||{},b=h.duration,m,a,c,g,k,e;for(k in d){if(d.hasOwnProperty(k)&&h.animKeyFramesRE.test(k)){e={attrs:Ext.apply(d[k],j)};if(k=="from"){k=0}else{if(k=="to"){k=100}}e.pct=parseInt(k,10);l.push(e)}}Ext.Array.sort(l,h.sorter);g=l.length;for(c=0;c<g;c++){m=(l[c-1])?b*(l[c-1].pct/100):0;a=b*(l[c].pct/100);h.timeline.push({duration:a-m,attrs:l[c].attrs})}},applyAnimator:function(d){var h=this,j=[],l=h.timeline,g=l.length,b,e,a,k,c;if(h.fireEvent("beforeanimate",h)!==false){for(c=0;c<g;c++){b=l[c];k=b.attrs;e=k.easing||h.easing;a=k.damper||h.damper;delete k.easing;delete k.damper;b=new Ext.fx.Anim({target:d,easing:e,damper:a,duration:b.duration,paused:true,to:k});j.push(b)}h.animations=j;h.target=b.target;for(c=0;c<g-1;c++){b=j[c];b.nextAnim=j[c+1];b.on("afteranimate",function(){this.nextAnim.paused=false});b.on("afteranimate",function(){this.fireEvent("keyframe",this,++this.keyframeStep)},h)}j[g-1].on("afteranimate",function(){this.lastFrame()},h)}},start:function(d){var e=this,c=e.delay,b=e.delayStart,a;if(c){if(!b){e.delayStart=d;return}else{a=d-b;if(a<c){return}else{d=new Date(b.getTime()+c)}}}if(e.fireEvent("beforeanimate",e)!==false){e.startTime=d;e.running=true;e.animations[e.keyframeStep].paused=false}},lastFrame:function(){var c=this,a=c.iterations,b=c.currentIteration;b++;if(b<a){c.startTime=new Date();c.currentIteration=b;c.keyframeStep=0;c.applyAnimator(c.target);c.animations[c.keyframeStep].paused=false}else{c.currentIteration=0;c.end()}},end:function(){var a=this;a.fireEvent("afteranimate",a,a.startTime,new Date()-a.startTime)},isReady:function(){return this.paused===false&&this.running===false&&this.iterations>0},isRunning:function(){return false}});Ext.define("Ext.fx.CubicBezier",{singleton:true,cubicBezierAtTime:function(o,d,b,n,m,i){var j=3*d,l=3*(n-d)-j,a=1-j-l,h=3*b,k=3*(m-b)-h,p=1-h-k;function g(q){return((a*q+l)*q+j)*q}function c(q,s){var r=e(q,s);return((p*r+k)*r+h)*r}function e(q,y){var w,v,t,r,u,s;for(t=q,s=0;s<8;s++){r=g(t)-q;if(Math.abs(r)<y){return t}u=(3*a*t+2*l)*t+j;if(Math.abs(u)<0.000001){break}t=t-r/u}w=0;v=1;t=q;if(t<w){return w}if(t>v){return v}while(w<v){r=g(t);if(Math.abs(r-q)<y){return t}if(q>r){w=t}else{v=t}t=(v-w)/2+w}return t}return c(o,1/(200*i))},cubicBezier:function(b,e,a,c){var d=function(g){return Ext.fx.CubicBezier.cubicBezierAtTime(g,b,e,a,c,1)};d.toCSS3=function(){return"cubic-bezier("+[b,e,a,c].join(",")+")"};d.reverse=function(){return Ext.fx.CubicBezier.cubicBezier(1-a,1-c,1-b,1-e)};return d}});Ext.require("Ext.fx.CubicBezier",function(){var e=Math,h=e.PI,d=e.pow,b=e.sin,g=e.sqrt,a=e.abs,c=1.70158;Ext.define("Ext.fx.Easing",{singleton:true,linear:Ext.identityFn,ease:function(l){var i=0.07813-l/2,m=-0.25,o=g(0.0066+i*i),r=o-i,k=d(a(r),1/3)*(r<0?-1:1),p=-o-i,j=d(a(p),1/3)*(p<0?-1:1),s=k+j+0.25;return d(1-s,2)*3*s*0.1+(1-s)*3*s*s+s*s*s},easeIn:function(i){return d(i,1.7)},easeOut:function(i){return d(i,0.48)},easeInOut:function(r){var l=0.48-r/1.04,k=g(0.1734+l*l),i=k-l,p=d(a(i),1/3)*(i<0?-1:1),o=-k-l,m=d(a(o),1/3)*(o<0?-1:1),j=p+m+0.5;return(1-j)*3*j*j+j*j*j},backIn:function(i){return i*i*((c+1)*i-c)},backOut:function(i){i=i-1;return i*i*((c+1)*i+c)+1},elasticIn:function(k){if(k===0||k===1){return k}var j=0.3,i=j/4;return d(2,-10*k)*b((k-i)*(2*h)/j)+1},elasticOut:function(i){return 1-Ext.fx.Easing.elasticIn(1-i)},bounceIn:function(i){return 1-Ext.fx.Easing.bounceOut(1-i)},bounceOut:function(m){var j=7.5625,k=2.75,i;if(m<(1/k)){i=j*m*m}else{if(m<(2/k)){m-=(1.5/k);i=j*m*m+0.75}else{if(m<(2.5/k)){m-=(2.25/k);i=j*m*m+0.9375}else{m-=(2.625/k);i=j*m*m+0.984375}}}return i}},function(){var j=Ext.fx.Easing.self,i=j.prototype;j.implement({"back-in":i.backIn,"back-out":i.backOut,"ease-in":i.easeIn,"ease-out":i.easeOut,"elastic-in":i.elasticIn,"elastic-out":i.elasticOut,"bounce-in":i.bounceIn,"bounce-out":i.bounceOut,"ease-in-out":i.easeInOut})})});Ext.define("Ext.draw.Color",{colorToHexRe:/(.*?)rgb\((\d+),\s*(\d+),\s*(\d+)\)/,rgbRe:/\s*rgb\s*\(\s*([0-9]+)\s*,\s*([0-9]+)\s*,\s*([0-9]+)\s*\)\s*/,hexRe:/\s*#([0-9a-fA-F][0-9a-fA-F]?)([0-9a-fA-F][0-9a-fA-F]?)([0-9a-fA-F][0-9a-fA-F]?)\s*/,lightnessFactor:0.2,constructor:function(d,c,a){var b=this,e=Ext.Number.constrain;b.r=e(d,0,255);b.g=e(c,0,255);b.b=e(a,0,255)},getRed:function(){return this.r},getGreen:function(){return this.g},getBlue:function(){return this.b},getRGB:function(){var a=this;return[a.r,a.g,a.b]},getHSL:function(){var j=this,a=j.r/255,i=j.g/255,k=j.b/255,m=Math.max(a,i,k),d=Math.min(a,i,k),n=m-d,e,o=0,c=0.5*(m+d);if(d!=m){o=(c<0.5)?n/(m+d):n/(2-m-d);if(a==m){e=60*(i-k)/n}else{if(i==m){e=120+60*(k-a)/n}else{e=240+60*(a-i)/n}}if(e<0){e+=360}if(e>=360){e-=360}}return[e,o,c]},getLighter:function(b){var a=this.getHSL();b=b||this.lightnessFactor;a[2]=Ext.Number.constrain(a[2]+b,0,1);return this.fromHSL(a[0],a[1],a[2])},getDarker:function(a){a=a||this.lightnessFactor;return this.getLighter(-a)},toString:function(){var h=this,c=Math.round,e=c(h.r).toString(16),d=c(h.g).toString(16),a=c(h.b).toString(16);e=(e.length==1)?"0"+e:e;d=(d.length==1)?"0"+d:d;a=(a.length==1)?"0"+a:a;return["#",e,d,a].join("")},toHex:function(b){if(Ext.isArray(b)){b=b[0]}if(!Ext.isString(b)){return""}if(b.substr(0,1)==="#"){return b}var e=this.colorToHexRe.exec(b),g,d,a,c;if(Ext.isArray(e)){g=parseInt(e[2],10);d=parseInt(e[3],10);a=parseInt(e[4],10);c=a|(d<<8)|(g<<16);return e[1]+"#"+("000000"+c.toString(16)).slice(-6)}else{return b}},fromString:function(i){var c,e,d,a,h=parseInt;if((i.length==4||i.length==7)&&i.substr(0,1)==="#"){c=i.match(this.hexRe);if(c){e=h(c[1],16)>>0;d=h(c[2],16)>>0;a=h(c[3],16)>>0;if(i.length==4){e+=(e*16);d+=(d*16);a+=(a*16)}}}else{c=i.match(this.rgbRe);if(c){e=c[1];d=c[2];a=c[3]}}return(typeof e=="undefined")?undefined:new Ext.draw.Color(e,d,a)},getGrayscale:function(){return this.r*0.3+this.g*0.59+this.b*0.11},fromHSL:function(g,o,d){var a,b,c,e,k=[],n=Math.abs,j=Math.floor;if(o==0||g==null){k=[d,d,d]}else{g/=60;a=o*(1-n(2*d-1));b=a*(1-n(g-2*j(g/2)-1));c=d-a/2;switch(j(g)){case 0:k=[a,b,0];break;case 1:k=[b,a,0];break;case 2:k=[0,a,b];break;case 3:k=[0,b,a];break;case 4:k=[b,0,a];break;case 5:k=[a,0,b];break}k=[k[0]+c,k[1]+c,k[2]+c]}return new Ext.draw.Color(k[0]*255,k[1]*255,k[2]*255)}},function(){var a=this.prototype;this.addStatics({fromHSL:function(){return a.fromHSL.apply(a,arguments)},fromString:function(){return a.fromString.apply(a,arguments)},toHex:function(){return a.toHex.apply(a,arguments)}})});Ext.define("Ext.draw.Draw",{singleton:true,pathToStringRE:/,?([achlmqrstvxz]),?/gi,pathCommandRE:/([achlmqstvz])[\s,]*((-?\d*\.?\d*(?:e[-+]?\d+)?\s*,?\s*)+)/ig,pathValuesRE:/(-?\d*\.?\d*(?:e[-+]?\d+)?)\s*,?\s*/ig,stopsRE:/^(\d+%?)$/,radian:Math.PI/180,availableAnimAttrs:{along:"along",blur:null,"clip-rect":"csv",cx:null,cy:null,fill:"color","fill-opacity":null,"font-size":null,height:null,opacity:null,path:"path",r:null,rotation:"csv",rx:null,ry:null,scale:"csv",stroke:"color","stroke-opacity":null,"stroke-width":null,translation:"csv",width:null,x:null,y:null},is:function(b,a){a=String(a).toLowerCase();return(a=="object"&&b===Object(b))||(a=="undefined"&&typeof b==a)||(a=="null"&&b===null)||(a=="array"&&Array.isArray&&Array.isArray(b))||(Object.prototype.toString.call(b).toLowerCase().slice(8,-1))==a},ellipsePath:function(b){var a=b.attr;return Ext.String.format("M{0},{1}A{2},{3},0,1,1,{0},{4}A{2},{3},0,1,1,{0},{1}z",a.x,a.y-a.ry,a.rx,a.ry,a.y+a.ry)},rectPath:function(b){var a=b.attr;if(a.radius){return Ext.String.format("M{0},{1}l{2},0a{3},{3},0,0,1,{3},{3}l0,{5}a{3},{3},0,0,1,{4},{3}l{6},0a{3},{3},0,0,1,{4},{4}l0,{7}a{3},{3},0,0,1,{3},{4}z",a.x+a.radius,a.y,a.width-a.radius*2,a.radius,-a.radius,a.height-a.radius*2,a.radius*2-a.width,a.radius*2-a.height)}else{return Ext.String.format("M{0},{1}L{2},{1},{2},{3},{0},{3}z",a.x,a.y,a.width+a.x,a.height+a.y)}},path2string:function(){return this.join(",").replace(Ext.draw.Draw.pathToStringRE,"$1")},pathToString:function(a){return a.join(",").replace(Ext.draw.Draw.pathToStringRE,"$1")},parsePathString:function(a){if(!a){return null}var d={a:7,c:6,h:1,l:2,m:2,q:4,s:4,t:2,v:1,z:0},c=[],b=this;if(b.is(a,"array")&&b.is(a[0],"array")){c=b.pathClone(a)}if(!c.length){String(a).replace(b.pathCommandRE,function(g,e,j){var i=[],h=e.toLowerCase();j.replace(b.pathValuesRE,function(l,k){k&&i.push(+k)});if(h=="m"&&i.length>2){c.push([e].concat(Ext.Array.splice(i,0,2)));h="l";e=(e=="m")?"l":"L"}while(i.length>=d[h]){c.push([e].concat(Ext.Array.splice(i,0,d[h])));if(!d[h]){break}}})}c.toString=b.path2string;return c},mapPath:function(l,g){if(!g){return l}var h,e,c,k,a,d,b;l=this.path2curve(l);for(c=0,k=l.length;c<k;c++){b=l[c];for(a=1,d=b.length;a<d-1;a+=2){h=g.x(b[a],b[a+1]);e=g.y(b[a],b[a+1]);b[a]=h;b[a+1]=e}}return l},pathClone:function(g){var c=[],a,e,b,d;if(!this.is(g,"array")||!this.is(g&&g[0],"array")){g=this.parsePathString(g)}for(b=0,d=g.length;b<d;b++){c[b]=[];for(a=0,e=g[b].length;a<e;a++){c[b][a]=g[b][a]}}c.toString=this.path2string;return c},pathToAbsolute:function(c){if(!this.is(c,"array")||!this.is(c&&c[0],"array")){c=this.parsePathString(c)}var k=[],m=0,l=0,o=0,n=0,g=0,h=c.length,b,d,e,a;if(h&&c[0][0]=="M"){m=+c[0][1];l=+c[0][2];o=m;n=l;g++;k[0]=["M",m,l]}for(;g<h;g++){b=k[g]=[];d=c[g];if(d[0]!=d[0].toUpperCase()){b[0]=d[0].toUpperCase();switch(b[0]){case"A":b[1]=d[1];b[2]=d[2];b[3]=d[3];b[4]=d[4];b[5]=d[5];b[6]=+(d[6]+m);b[7]=+(d[7]+l);break;case"V":b[1]=+d[1]+l;break;case"H":b[1]=+d[1]+m;break;case"M":o=+d[1]+m;n=+d[2]+l;default:e=1;a=d.length;for(;e<a;e++){b[e]=+d[e]+((e%2)?m:l)}}}else{e=0;a=d.length;for(;e<a;e++){k[g][e]=d[e]}}switch(b[0]){case"Z":m=o;l=n;break;case"H":m=b[1];break;case"V":l=b[1];break;case"M":d=k[g];a=d.length;o=d[a-2];n=d[a-1];default:d=k[g];a=d.length;m=d[a-2];l=d[a-1]}}k.toString=this.path2string;return k},pathToRelative:function(d){if(!this.is(d,"array")||!this.is(d&&d[0],"array")){d=this.parsePathString(d)}var n=[],p=0,o=0,t=0,s=0,c=0,a,q,h,g,e,m,u,l,b;if(d[0][0]=="M"){p=d[0][1];o=d[0][2];t=p;s=o;c++;n.push(["M",p,o])}for(h=c,u=d.length;h<u;h++){a=n[h]=[];q=d[h];if(q[0]!=q[0].toLowerCase()){a[0]=q[0].toLowerCase();switch(a[0]){case"a":a[1]=q[1];a[2]=q[2];a[3]=q[3];a[4]=q[4];a[5]=q[5];a[6]=+(q[6]-p).toFixed(3);a[7]=+(q[7]-o).toFixed(3);break;case"v":a[1]=+(q[1]-o).toFixed(3);break;case"m":t=q[1];s=q[2];default:for(g=1,l=q.length;g<l;g++){a[g]=+(q[g]-((g%2)?p:o)).toFixed(3)}}}else{a=n[h]=[];if(q[0]=="m"){t=q[1]+p;s=q[2]+o}for(e=0,b=q.length;e<b;e++){n[h][e]=q[e]}}m=n[h].length;switch(n[h][0]){case"z":p=t;o=s;break;case"h":p+=+n[h][m-1];break;case"v":o+=+n[h][m-1];break;default:p+=+n[h][m-2];o+=+n[h][m-1]}}n.toString=this.path2string;return n},path2curve:function(k){var d=this,h=d.pathToAbsolute(k),c=h.length,j={x:0,y:0,bx:0,by:0,X:0,Y:0,qx:null,qy:null},b,a,g,e;for(b=0;b<c;b++){h[b]=d.command2curve(h[b],j);if(h[b].length>7){h[b].shift();e=h[b];while(e.length){Ext.Array.splice(h,b++,0,["C"].concat(Ext.Array.splice(e,0,6)))}Ext.Array.erase(h,b,1);c=h.length;b--}a=h[b];g=a.length;j.x=a[g-2];j.y=a[g-1];j.bx=parseFloat(a[g-4])||j.x;j.by=parseFloat(a[g-3])||j.y}return h},interpolatePaths:function(r,l){var j=this,d=j.pathToAbsolute(r),m=j.pathToAbsolute(l),n={x:0,y:0,bx:0,by:0,X:0,Y:0,qx:null,qy:null},a={x:0,y:0,bx:0,by:0,X:0,Y:0,qx:null,qy:null},b=function(p,s){if(p[s].length>7){p[s].shift();var t=p[s];while(t.length){Ext.Array.splice(p,s++,0,["C"].concat(Ext.Array.splice(t,0,6)))}Ext.Array.erase(p,s,1);o=Math.max(d.length,m.length||0)}},c=function(v,u,s,p,t){if(v&&u&&v[t][0]=="M"&&u[t][0]!="M"){Ext.Array.splice(u,t,0,["M",p.x,p.y]);s.bx=0;s.by=0;s.x=v[t][1];s.y=v[t][2];o=Math.max(d.length,m.length||0)}},h,o,g,q,e,k;for(h=0,o=Math.max(d.length,m.length||0);h<o;h++){d[h]=j.command2curve(d[h],n);b(d,h);(m[h]=j.command2curve(m[h],a));b(m,h);c(d,m,n,a,h);c(m,d,a,n,h);g=d[h];q=m[h];e=g.length;k=q.length;n.x=g[e-2];n.y=g[e-1];n.bx=parseFloat(g[e-4])||n.x;n.by=parseFloat(g[e-3])||n.y;a.bx=(parseFloat(q[k-4])||a.x);a.by=(parseFloat(q[k-3])||a.y);a.x=q[k-2];a.y=q[k-1]}return[d,m]},command2curve:function(c,b){var a=this;if(!c){return["C",b.x,b.y,b.x,b.y,b.x,b.y]}if(c[0]!="T"&&c[0]!="Q"){b.qx=b.qy=null}switch(c[0]){case"M":b.X=c[1];b.Y=c[2];break;case"A":c=["C"].concat(a.arc2curve.apply(a,[b.x,b.y].concat(c.slice(1))));break;case"S":c=["C",b.x+(b.x-(b.bx||b.x)),b.y+(b.y-(b.by||b.y))].concat(c.slice(1));break;case"T":b.qx=b.x+(b.x-(b.qx||b.x));b.qy=b.y+(b.y-(b.qy||b.y));c=["C"].concat(a.quadratic2curve(b.x,b.y,b.qx,b.qy,c[1],c[2]));break;case"Q":b.qx=c[1];b.qy=c[2];c=["C"].concat(a.quadratic2curve(b.x,b.y,c[1],c[2],c[3],c[4]));break;case"L":c=["C"].concat(b.x,b.y,c[1],c[2],c[1],c[2]);break;case"H":c=["C"].concat(b.x,b.y,c[1],b.y,c[1],b.y);break;case"V":c=["C"].concat(b.x,b.y,b.x,c[1],b.x,c[1]);break;case"Z":c=["C"].concat(b.x,b.y,b.X,b.Y,b.X,b.Y);break}return c},quadratic2curve:function(b,d,h,e,a,c){var g=1/3,i=2/3;return[g*b+i*h,g*d+i*e,g*a+i*h,g*c+i*e,a,c]},rotate:function(b,h,a){var d=Math.cos(a),c=Math.sin(a),g=b*d-h*c,e=b*c+h*d;return{x:g,y:e}},arc2curve:function(s,af,H,F,z,n,g,r,ae,A){var v=this,d=Math.PI,w=v.radian,E=d*120/180,b=w*(+z||0),M=[],J=Math,T=J.cos,a=J.sin,V=J.sqrt,u=J.abs,o=J.asin,I,O,N,aa,c,R,U,C,B,m,l,q,j,ad,e,ac,P,S,Q,ab,Z,Y,W,L,X,K,D,G,p;if(!A){I=v.rotate(s,af,-b);s=I.x;af=I.y;I=v.rotate(r,ae,-b);r=I.x;ae=I.y;O=(s-r)/2;N=(af-ae)/2;aa=(O*O)/(H*H)+(N*N)/(F*F);if(aa>1){aa=V(aa);H=aa*H;F=aa*F}c=H*H;R=F*F;U=(n==g?-1:1)*V(u((c*R-c*N*N-R*O*O)/(c*N*N+R*O*O)));C=U*H*N/F+(s+r)/2;B=U*-F*O/H+(af+ae)/2;m=o(((af-B)/F).toFixed(7));l=o(((ae-B)/F).toFixed(7));m=s<C?d-m:m;l=r<C?d-l:l;if(m<0){m=d*2+m}if(l<0){l=d*2+l}if(g&&m>l){m=m-d*2}if(!g&&l>m){l=l-d*2}}else{m=A[0];l=A[1];C=A[2];B=A[3]}q=l-m;if(u(q)>E){D=l;G=r;p=ae;l=m+E*(g&&l>m?1:-1);r=C+H*T(l);ae=B+F*a(l);M=v.arc2curve(r,ae,H,F,z,0,g,G,p,[l,D,C,B])}q=l-m;j=T(m);ad=a(m);e=T(l);ac=a(l);P=J.tan(q/4);S=4/3*H*P;Q=4/3*F*P;ab=[s,af];Z=[s+S*ad,af-Q*j];Y=[r+S*ac,ae-Q*e];W=[r,ae];Z[0]=2*ab[0]-Z[0];Z[1]=2*ab[1]-Z[1];if(A){return[Z,Y,W].concat(M)}else{M=[Z,Y,W].concat(M).join().split(",");L=[];K=M.length;for(X=0;X<K;X++){L[X]=X%2?v.rotate(M[X-1],M[X],b).y:v.rotate(M[X],M[X+1],b).x}return L}},rotateAndTranslatePath:function(k){var c=k.rotation.degrees,d=k.rotation.x,b=k.rotation.y,o=k.translation.x,l=k.translation.y,n,g,a,m,e,h=[];if(!c&&!o&&!l){return this.pathToAbsolute(k.attr.path)}o=o||0;l=l||0;n=this.pathToAbsolute(k.attr.path);for(g=n.length;g--;){a=h[g]=n[g].slice();if(a[0]=="A"){m=this.rotatePoint(a[6],a[7],c,d,b);a[6]=m.x+o;a[7]=m.y+l}else{e=1;while(a[e+1]!=null){m=this.rotatePoint(a[e],a[e+1],c,d,b);a[e]=m.x+o;a[e+1]=m.y+l;e+=2}}}return h},rotatePoint:function(b,h,e,a,g){if(!e){return{x:b,y:h}}a=a||0;g=g||0;b=b-a;h=h-g;e=e*this.radian;var d=Math.cos(e),c=Math.sin(e);return{x:b*d-h*c+a,y:b*c+h*d+g}},pathDimensions:function(o){if(!o||!(o+"")){return{x:0,y:0,width:0,height:0}}o=this.path2curve(o);var m=0,l=0,e=[],b=[],h=0,k=o.length,c,a,n,g,d,j;for(;h<k;h++){c=o[h];if(c[0]=="M"){m=c[1];l=c[2];e.push(m);b.push(l)}else{j=this.curveDim(m,l,c[1],c[2],c[3],c[4],c[5],c[6]);e=e.concat(j.min.x,j.max.x);b=b.concat(j.min.y,j.max.y);m=c[5];l=c[6]}}a=Math.min.apply(0,e);n=Math.min.apply(0,b);g=Math.max.apply(0,e);d=Math.max.apply(0,b);return{x:Math.round(a),y:Math.round(n),path:o,width:Math.round(g-a),height:Math.round(d-n)}},intersectInside:function(b,c,a){return(a[0]-c[0])*(b[1]-c[1])>(a[1]-c[1])*(b[0]-c[0])},intersectIntersection:function(n,m,g,d){var c=[],b=g[0]-d[0],a=g[1]-d[1],k=n[0]-m[0],i=n[1]-m[1],l=g[0]*d[1]-g[1]*d[0],j=n[0]*m[1]-n[1]*m[0],h=1/(b*i-a*k);c[0]=(l*k-j*b)*h;c[1]=(l*i-j*a)*h;return c},intersect:function(o,c){var n=this,k=0,m=c.length,h=c[m-1],p=o,g,q,l,a,b,d;for(;k<m;++k){g=c[k];b=p;p=[];q=b[b.length-1];d=0;a=b.length;for(;d<a;d++){l=b[d];if(n.intersectInside(l,h,g)){if(!n.intersectInside(q,h,g)){p.push(n.intersectIntersection(q,l,h,g))}p.push(l)}else{if(n.intersectInside(q,h,g)){p.push(n.intersectIntersection(q,l,h,g))}}q=l}h=g}return p},bezier:function(h,g,m,l,e){if(e===0){return h}else{if(e===1){return l}}var j=1-e,i=j*j*j,k=e/j;return i*(h+k*(3*g+k*(3*m+l*k)))},bezierDim:function(t,q,n,m){var v=[],g,j,p,h,u,e,w,k,o,l;if(t+3*n==m+3*q){g=t-q;g/=2*(t-q-q+n);if(g<1&&g>0){v.push(g)}}else{j=t-3*q+3*n-m;p=2*(t-q-q+n);h=t-q;u=p*p-4*j*h;e=j+j;if(u===0){g=p/e;if(g<1&&g>0){v.push(g)}}else{if(u>0){w=Math.sqrt(u);g=(w+p)/e;if(g<1&&g>0){v.push(g)}g=(p-w)/e;if(g<1&&g>0){v.push(g)}}}}k=Math.min(t,m);o=Math.max(t,m);for(l=0;l<v.length;l++){k=Math.min(k,this.bezier(t,q,n,m,v[l]));o=Math.max(o,this.bezier(t,q,n,m,v[l]))}return[k,o]},curveDim:function(b,a,d,c,k,j,h,e){var i=this.bezierDim(b,d,k,h),g=this.bezierDim(a,c,j,e);return{min:{x:i[0],y:g[0]},max:{x:i[1],y:g[1]}}},getAnchors:function(e,d,k,j,v,u,q){q=q||4;var i=Math,p=i.PI,r=p/2,m=i.abs,a=i.sin,b=i.cos,g=i.atan,t,s,h,l,o,n,x,w,c;t=(k-e)/q;s=(v-k)/q;if((j>=d&&j>=u)||(j<=d&&j<=u)){h=l=r}else{h=g((k-e)/m(j-d));if(d<j){h=p-h}l=g((v-k)/m(j-u));if(u<j){l=p-l}}c=r-((h+l)%(p*2))/2;if(c>r){c-=p}h+=c;l+=c;o=k-t*a(h);n=j+t*b(h);x=k+s*a(l);w=j+s*b(l);if((j>d&&n<d)||(j<d&&n>d)){o+=m(d-n)*(o-k)/(n-j);n=d}if((j>u&&w<u)||(j<u&&w>u)){x-=m(u-w)*(x-k)/(w-j);w=u}return{x1:o,y1:n,x2:x,y2:w}},smooth:function(a,p){var o=this.path2curve(a),c=[o[0]],g=o[0][1],e=o[0][2],q,s,t=1,h=o.length,d=1,l=g,k=e,w,v,u,m,r,n,b;for(;t<h;t++){w=o[t];v=w.length;u=o[t-1];m=u.length;r=o[t+1];n=r&&r.length;if(w[0]=="M"){l=w[1];k=w[2];q=t+1;while(o[q][0]!="C"){q++}c.push(["M",l,k]);d=c.length;g=l;e=k;continue}if(w[v-2]==l&&w[v-1]==k&&(!r||r[0]=="M")){b=c[d].length;s=this.getAnchors(u[m-2],u[m-1],l,k,c[d][b-2],c[d][b-1],p);c[d][1]=s.x2;c[d][2]=s.y2}else{if(!r||r[0]=="M"){s={x1:w[v-2],y1:w[v-1]}}else{s=this.getAnchors(u[m-2],u[m-1],w[v-2],w[v-1],r[n-2],r[n-1],p)}}c.push(["C",g,e,s.x1,s.y1,w[v-2],w[v-1]]);g=s.x2;e=s.y2}return c},findDotAtSegment:function(b,a,d,c,j,i,h,g,k){var e=1-k;return{x:Math.pow(e,3)*b+Math.pow(e,2)*3*k*d+e*3*k*k*j+Math.pow(k,3)*h,y:Math.pow(e,3)*a+Math.pow(e,2)*3*k*c+e*3*k*k*i+Math.pow(k,3)*g}},snapEnds:function(o,c,k,u){if(Ext.isDate(o)){return this.snapEndsByDate(o,c,k)}var e=(c-o)/k,b=Math.floor(Math.log(e)/Math.LN10)+1,n=Math.pow(10,b),d,q,r=Math.round((e%n)*Math.pow(10,2-b)),s=[[0,15],[10,1],[20,4],[25,2],[50,9],[100,15]],a=0,l,j,p,h,t=1000000000,g=s.length;q=Math.floor(o/n)*n;if(o==q&&q>0){q=Math.floor((o-(n/10))/n)*n}if(u){for(p=0;p<g;p++){l=s[p][0];j=(l-r)<0?1000000:(l-r)/s[p][1];if(j<t){h=l;t=j}}e=Math.floor(e*Math.pow(10,-b))*Math.pow(10,b)+h*Math.pow(10,b-2);if(o<0&&c>=0){d=0;while(d>o){d-=e;a++}o=+d.toFixed(10);d=0;while(d<c){d+=e;a++}c=+d.toFixed(10)}else{d=o=q;while(d<c){d+=e;a++}}c=+d.toFixed(10)}else{o=q;a=k}return{from:o,to:c,power:b,step:e,steps:a}},snapEndsByDate:function(k,l,b,m){var e=false,h=[[Ext.Date.MILLI,[1,2,5,10,20,50,100,200,250,500]],[Ext.Date.SECOND,[1,2,5,10,15,30]],[Ext.Date.MINUTE,[1,2,5,10,15,30]],[Ext.Date.HOUR,[1,2,3,4,6,12]],[Ext.Date.DAY,[1,2,7,14]],[Ext.Date.MONTH,[1,2,3,6]]],g=h.length,i=false,c,d,a,n;for(n=0;n<g;n++){c=h[n];if(!i){for(d=0;d<c[1].length;d++){if(l<Ext.Date.add(k,c[0],c[1][d]*b)){e=[c[0],c[1][d]];i=true;break}}}}if(!e){a=this.snapEnds(k.getFullYear(),l.getFullYear()+1,b,m);e=[Date.YEAR,Math.round(a.step)]}return this.snapEndsByDateAndStep(k,l,e,m)},snapEndsByDateAndStep:function(l,m,a,o){var n=[l.getFullYear(),l.getMonth(),l.getDate(),l.getHours(),l.getMinutes(),l.getSeconds(),l.getMilliseconds()],k,c,p,b,i,e,j,d,h=a[0],g=a[1];if(o){c=l}else{switch(h){case Ext.Date.MILLI:c=new Date(n[0],n[1],n[2],n[3],n[4],n[5],Math.floor(n[6]/g)*g);break;case Ext.Date.SECOND:c=new Date(n[0],n[1],n[2],n[3],n[4],Math.floor(n[5]/g)*g,0);break;case Ext.Date.MINUTE:c=new Date(n[0],n[1],n[2],n[3],Math.floor(n[4]/g)*g,0,0);break;case Ext.Date.HOUR:c=new Date(n[0],n[1],n[2],Math.floor(n[3]/g)*g,0,0,0);break;case Ext.Date.DAY:c=new Date(n[0],n[1],Math.floor((n[2]-1)/g)*g+1,0,0,0,0);break;case Ext.Date.MONTH:c=new Date(n[0],Math.floor(n[1]/g)*g,1,0,0,0,0);break;default:c=new Date(Math.floor(n[0]/g)*g,0,1,0,0,0,0);break}}d=((h===Ext.Date.MONTH)&&(g==1/2||g==1/3||g==1/4));k=(d?[]:0);p=new Date(c);while(p<m){if(d){b=new Date(p);i=b.getFullYear();e=b.getMonth();j=b.getDate();switch(g){case 1/2:if(j>=15){j=1;if(++e>11){i++}}else{j=15}break;case 1/3:if(j>=20){j=1;if(++e>11){i++}}else{if(j>=10){j=20}else{j=10}}break;case 1/4:if(j>=22){j=1;if(++e>11){i++}}else{if(j>=15){j=22}else{if(j>=8){j=15}else{j=8}}}break}p.setYear(i);p.setMonth(e);p.setDate(j);k.push(new Date(p))}else{p=Ext.Date.add(p,h,g);k++}}if(o){p=m}if(d){return{from:+c,to:+p,steps:k}}else{return{from:+c,to:+p,step:(p-c)/k,steps:k}}},sorter:function(d,c){return d.offset-c.offset},rad:function(a){return a%360*Math.PI/180},degrees:function(a){return a*180/Math.PI%360},withinBox:function(a,c,b){b=b||{};return(a>=b.x&&a<=(b.x+b.width)&&c>=b.y&&c<=(b.y+b.height))},parseGradient:function(k){var e=this,g=k.type||"linear",c=k.angle||0,i=e.radian,l=k.stops,a=[],j,b,h,d;if(g=="linear"){b=[0,0,Math.cos(c*i),Math.sin(c*i)];h=1/(Math.max(Math.abs(b[2]),Math.abs(b[3]))||1);b[2]*=h;b[3]*=h;if(b[2]<0){b[0]=-b[2];b[2]=0}if(b[3]<0){b[1]=-b[3];b[3]=0}}for(j in l){if(l.hasOwnProperty(j)&&e.stopsRE.test(j)){d={offset:parseInt(j,10),color:Ext.draw.Color.toHex(l[j].color)||"#ffffff",opacity:l[j].opacity||1};a.push(d)}}Ext.Array.sort(a,e.sorter);if(g=="linear"){return{id:k.id,type:g,vector:b,stops:a}}else{return{id:k.id,type:g,centerX:k.centerX,centerY:k.centerY,focalX:k.focalX,focalY:k.focalY,radius:k.radius,vector:b,stops:a}}}});Ext.define("Ext.fx.PropertyHandler",{statics:{defaultHandler:{pixelDefaultsRE:/width|height|top$|bottom$|left$|right$/i,unitRE:/^(-?\d*\.?\d*){1}(em|ex|px|in|cm|mm|pt|pc|%)*$/,scrollRE:/^scroll/i,computeDelta:function(j,c,a,g,i){a=(typeof a=="number")?a:1;var h=this.unitRE,d=h.exec(j),b,e;if(d){j=d[1];e=d[2];if(!this.scrollRE.test(i)&&!e&&this.pixelDefaultsRE.test(i)){e="px"}}j=+j||0;d=h.exec(c);if(d){c=d[1];e=d[2]||e}c=+c||0;b=(g!=null)?g:j;return{from:j,delta:(c-b)*a,units:e}},get:function(o,b,a,n,k){var m=o.length,d=[],e,h,l,c,g;for(e=0;e<m;e++){if(n){h=n[e][1].from}if(Ext.isArray(o[e][1])&&Ext.isArray(b)){l=[];c=0;g=o[e][1].length;for(;c<g;c++){l.push(this.computeDelta(o[e][1][c],b[c],a,h,k))}d.push([o[e][0],l])}else{d.push([o[e][0],this.computeDelta(o[e][1],b,a,h,k)])}}return d},set:function(l,g){var h=l.length,c=[],d,a,k,e,b;for(d=0;d<h;d++){a=l[d][1];if(Ext.isArray(a)){k=[];b=0;e=a.length;for(;b<e;b++){k.push(a[b].from+a[b].delta*g+(a[b].units||0))}c.push([l[d][0],k])}else{c.push([l[d][0],a.from+a.delta*g+(a.units||0)])}}return c}},stringHandler:{computeDelta:function(e,b,d,c,a){return{from:e,delta:b}},get:function(o,b,a,n,k){var m=o.length,d=[],e,h,l,c,g;for(e=0;e<m;e++){d.push([o[e][0],this.computeDelta(o[e][1],b,a,h,k)])}return d},set:function(l,g){var h=l.length,c=[],d,a,k,e,b;for(d=0;d<h;d++){a=l[d][1];c.push([l[d][0],a.delta])}return c}},color:{rgbRE:/^rgb\(([0-9]+)\s*,\s*([0-9]+)\s*,\s*([0-9]+)\)$/i,hexRE:/^#?([0-9A-F]{2})([0-9A-F]{2})([0-9A-F]{2})$/i,hex3RE:/^#?([0-9A-F]{1})([0-9A-F]{1})([0-9A-F]{1})$/i,parseColor:function(e,a){a=(typeof a=="number")?a:1;var g=false,c=[this.hexRE,this.rgbRE,this.hex3RE],d=c.length,j,b,k,h;for(h=0;h<d;h++){k=c[h];b=(h%2===0)?16:10;j=k.exec(e);if(j&&j.length===4){if(h===2){j[1]+=j[1];j[2]+=j[2];j[3]+=j[3]}g={red:parseInt(j[1],b),green:parseInt(j[2],b),blue:parseInt(j[3],b)};break}}return g||e},computeDelta:function(h,a,e,c){h=this.parseColor(h);a=this.parseColor(a,e);var g=c?c:h,b=typeof g,d=typeof a;if(b=="string"||b=="undefined"||d=="string"||d=="undefined"){return a||g}return{from:h,delta:{red:Math.round((a.red-g.red)*e),green:Math.round((a.green-g.green)*e),blue:Math.round((a.blue-g.blue)*e)}}},get:function(j,a,g,d){var h=j.length,c=[],e,b;for(e=0;e<h;e++){if(d){b=d[e][1].from}c.push([j[e][0],this.computeDelta(j[e][1],a,g,b)])}return c},set:function(k,e){var g=k.length,c=[],d,b,a,h,j;for(d=0;d<g;d++){b=k[d][1];if(b){h=b.from;j=b.delta;b=(typeof b=="object"&&"red" in b)?"rgb("+b.red+", "+b.green+", "+b.blue+")":b;b=(typeof b=="object"&&b.length)?b[0]:b;if(typeof b=="undefined"){return[]}a=typeof b=="string"?b:"rgb("+[(h.red+Math.round(j.red*e))%256,(h.green+Math.round(j.green*e))%256,(h.blue+Math.round(j.blue*e))%256].join(",")+")";c.push([k[d][0],a])}}return c}},object:{interpolate:function(d,b){b=(typeof b=="number")?b:1;var a={},c;for(c in d){a[c]=parseFloat(d[c])*b}return a},computeDelta:function(h,a,c,b){h=this.interpolate(h);a=this.interpolate(a,c);var g=b?b:h,e={},d;for(d in a){e[d]=a[d]-g[d]}return{from:h,delta:e}},get:function(j,a,g,d){var h=j.length,c=[],e,b;for(e=0;e<h;e++){if(d){b=d[e][1].from}c.push([j[e][0],this.computeDelta(j[e][1],a,g,b)])}return c},set:function(l,g){var h=l.length,c=[],e={},d,j,k,b,a;for(d=0;d<h;d++){b=l[d][1];j=b.from;k=b.delta;for(a in j){e[a]=j[a]+k[a]*g}c.push([l[d][0],e])}return c}},path:{computeDelta:function(e,a,c,b){c=(typeof c=="number")?c:1;var d;e=+e||0;a=+a||0;d=(b!=null)?b:e;return{from:e,delta:(a-d)*c}},forcePath:function(a){if(!Ext.isArray(a)&&!Ext.isArray(a[0])){a=Ext.draw.Draw.parsePathString(a)}return a},get:function(b,l,a,q){var c=this.forcePath(l),n=[],s=b.length,d,h,o,g,p,m,e,t,r;for(o=0;o<s;o++){r=this.forcePath(b[o][1]);g=Ext.draw.Draw.interpolatePaths(r,c);r=g[0];c=g[1];d=r.length;t=[];for(m=0;m<d;m++){g=[r[m][0]];h=r[m].length;for(e=1;e<h;e++){p=q&&q[0][1][m][e].from;g.push(this.computeDelta(r[m][e],c[m][e],a,p))}t.push(g)}n.push([b[o][0],t])}return n},set:function(p,n){var o=p.length,e=[],h,g,d,l,m,c,a,b;for(h=0;h<o;h++){c=p[h][1];l=[];a=c.length;for(g=0;g<a;g++){m=[c[g][0]];b=c[g].length;for(d=1;d<b;d++){m.push(c[g][d].from+c[g][d].delta*n)}l.push(m.join(","))}e.push([p[h][0],l.join(",")])}return e}}}},function(){var b=["outlineColor","backgroundColor","borderColor","borderTopColor","borderRightColor","borderBottomColor","borderLeftColor","fill","stroke"],c=b.length,a=0,d;for(;a<c;a++){d=b[a];this[d]=this.color}b=["cursor"];c=b.length;a=0;for(;a<c;a++){d=b[a];this[d]=this.stringHandler}});Ext.define("Ext.fx.Anim",{mixins:{observable:Ext.util.Observable},isAnimation:true,duration:250,delay:0,delayStart:0,dynamic:false,easing:"ease",damper:1,bezierRE:/^(?:cubic-)?bezier\(([^,]+),([^,]+),([^,]+),([^\)]+)\)/,reverse:false,running:false,paused:false,iterations:1,alternate:false,currentIteration:0,startTime:0,frameCount:0,constructor:function(a){var b=this,c;a=a||{};if(a.keyframes){return new Ext.fx.Animator(a)}Ext.apply(b,a);if(b.from===undefined){b.from={}}b.propHandlers={};b.config=a;b.target=Ext.fx.Manager.createTarget(b.target);b.easingFn=Ext.fx.Easing[b.easing];b.target.dynamic=b.dynamic;if(!b.easingFn){b.easingFn=String(b.easing).match(b.bezierRE);if(b.easingFn&&b.easingFn.length==5){c=b.easingFn;b.easingFn=Ext.fx.CubicBezier.cubicBezier(+c[1],+c[2],+c[3],+c[4])}}b.id=Ext.id(null,"ext-anim-");b.addEvents("beforeanimate","afteranimate","lastframe");b.mixins.observable.constructor.call(b);Ext.fx.Manager.addAnim(b)},setAttr:function(a,b){return Ext.fx.Manager.items.get(this.id).setAttr(this.target,a,b)},initAttrs:function(){var e=this,h=e.from,i=e.to,g=e.initialFrom||{},c={},a,b,j,d;for(d in i){if(i.hasOwnProperty(d)){a=e.target.getAttr(d,h[d]);b=i[d];if(!Ext.fx.PropertyHandler[d]){if(Ext.isObject(b)){j=e.propHandlers[d]=Ext.fx.PropertyHandler.object}else{j=e.propHandlers[d]=Ext.fx.PropertyHandler.defaultHandler}}else{j=e.propHandlers[d]=Ext.fx.PropertyHandler[d]}c[d]=j.get(a,b,e.damper,g[d],d)}}e.currentAttrs=c},start:function(d){var e=this,c=e.delay,b=e.delayStart,a;if(c){if(!b){e.delayStart=d;return}else{a=d-b;if(a<c){return}else{d=new Date(b.getTime()+c)}}}if(e.fireEvent("beforeanimate",e)!==false){e.startTime=d;if(!e.paused&&!e.currentAttrs){e.initAttrs()}e.running=true;e.frameCount=0}},runAnim:function(l){var i=this,k=i.currentAttrs,d=i.duration,c=i.easingFn,b=i.propHandlers,g={},h,j,e,a;if(l>=d){l=d;a=true}if(i.reverse){l=d-l}for(e in k){if(k.hasOwnProperty(e)){j=k[e];h=a?1:c(l/d);g[e]=b[e].set(j,h)}}i.frameCount++;return g},lastFrame:function(){var c=this,a=c.iterations,b=c.currentIteration;b++;if(b<a){if(c.alternate){c.reverse=!c.reverse}c.startTime=new Date();c.currentIteration=b;c.paused=false}else{c.currentIteration=0;c.end();c.fireEvent("lastframe",c,c.startTime)}},endWasCalled:0,end:function(){if(this.endWasCalled++){return}var a=this;a.startTime=0;a.paused=false;a.running=false;Ext.fx.Manager.removeAnim(a);a.fireEvent("afteranimate",a,a.startTime);Ext.callback(a.callback,a.scope,[a,a.startTime])},isReady:function(){return this.paused===false&&this.running===false&&this.iterations>0},isRunning:function(){return this.paused===false&&this.running===true&&this.isAnimator!==true}});Ext.enableFx=true;Ext.define("Ext.util.Animate",{isAnimate:true,animate:function(a){var b=this;if(Ext.fx.Manager.hasFxBlock(b.id)){return b}Ext.fx.Manager.queueFx(new Ext.fx.Anim(b.anim(a)));return this},anim:function(a){if(!Ext.isObject(a)){return(a)?{}:false}var b=this;if(a.stopAnimation){b.stopAnimation()}Ext.applyIf(a,Ext.fx.Manager.getFxDefaults(b.id));return Ext.apply({target:b,paused:true},a)},stopFx:Ext.Function.alias(Ext.util.Animate,"stopAnimation"),stopAnimation:function(){Ext.fx.Manager.stopAnimation(this.id);return this},syncFx:function(){Ext.fx.Manager.setFxDefaults(this.id,{concurrent:true});return this},sequenceFx:function(){Ext.fx.Manager.setFxDefaults(this.id,{concurrent:false});return this},hasActiveFx:Ext.Function.alias(Ext.util.Animate,"getActiveAnimation"),getActiveAnimation:function(){return Ext.fx.Manager.getActiveAnimation(this.id)}},function(){Ext.applyIf(Ext.Element.prototype,this.prototype);Ext.CompositeElementLite.importElementMethods()});Ext.define("Ext.util.ElementContainer",{childEls:[],constructor:function(){var b=this,a;if(b.hasOwnProperty("childEls")){a=b.childEls;delete b.childEls;b.addChildEls.apply(b,a)}},destroy:function(){var e=this,d=e.getChildEls(),g,a,c,b;for(c=d.length;c--;){a=d[c];if(typeof a!="string"){a=a.name}g=e[a];if(g){e[a]=null;g.remove()}}},addChildEls:function(){var b=this,a=arguments;if(b.hasOwnProperty("childEls")){b.childEls.push.apply(b.childEls,a)}else{b.childEls=b.getChildEls().concat(Array.prototype.slice.call(a))}b.prune(b.childEls,false)},applyChildEls:function(b,a){var e=this,g=e.getChildEls(),j,k,d,c,h;j=(a||e.id)+"-";for(d=g.length;d--;){k=g[d];if(typeof k=="string"){h=b.getById(j+k)}else{if((c=k.select)){h=Ext.select(c,true,b.dom)}else{if((c=k.selectNode)){h=Ext.get(Ext.DomQuery.selectNode(c,b.dom))}else{h=b.getById(k.id||(j+k.itemId))}}k=k.name}e[k]=h}},getChildEls:function(){var b=this,a;if(b.hasOwnProperty("childEls")){return b.childEls}a=b.self;return a.$childEls||b.getClassChildEls(a)},getClassChildEls:function(o){var k=this,p=o.$childEls,m,d,b,j,n,h,a,c,e,g,l;if(!p){g=o.superclass;if(g){g=g.self;c=[g.$childEls||k.getClassChildEls(g)];l=g.prototype.mixins||{}}else{c=[];l={}}e=o.prototype;h=e.mixins;for(a in h){if(h.hasOwnProperty(a)&&!l.hasOwnProperty(a)){n=h[a].self;c.push(n.$childEls||k.getClassChildEls(n))}}c.push(e.hasOwnProperty("childEls")&&e.childEls);for(d=0,b=c.length;d<b;++d){m=c[d];if(m&&m.length){if(!p){p=m}else{if(!j){j=true;p=p.slice(0)}p.push.apply(p,m)}}}o.$childEls=p=(p?k.prune(p,!j):[])}return p},prune:function(c,e){var b=c.length,d={},a;while(b--){a=c[b];if(typeof a!="string"){a=a.name}if(!d[a]){d[a]=1}else{if(e){e=false;c=c.slice(0)}Ext.Array.erase(c,b,1)}}return c},removeChildEls:function(g){var e=this,a=e.getChildEls(),d=(e.childEls=[]),h,b,c;for(b=0,h=a.length;b<h;++b){c=a[b];if(!g(c)){d.push(c)}}}});Ext.define("Ext.util.Renderable",{frameCls:Ext.baseCSSPrefix+"frame",frameIdRegex:/[\-]frame\d+[TMB][LCR]$/,frameElNames:["TL","TC","TR","ML","MC","MR","BL","BC","BR"],frameTpl:["{%this.renderDockedItems(out,values,0);%}",'<tpl if="top">','<tpl if="left"><div id="{fgid}TL" class="{frameCls}-tl {baseCls}-tl {baseCls}-{ui}-tl<tpl for="uiCls"> {parent.baseCls}-{parent.ui}-{.}-tl</tpl>{frameElCls}" role="presentation"></tpl>','<tpl if="right"><div id="{fgid}TR" class="{frameCls}-tr {baseCls}-tr {baseCls}-{ui}-tr<tpl for="uiCls"> {parent.baseCls}-{parent.ui}-{.}-tr</tpl>{frameElCls}" role="presentation"></tpl>','<div id="{fgid}TC" class="{frameCls}-tc {baseCls}-tc {baseCls}-{ui}-tc<tpl for="uiCls"> {parent.baseCls}-{parent.ui}-{.}-tc</tpl>{frameElCls}" role="presentation"></div>','<tpl if="right"></div></tpl>','<tpl if="left"></div></tpl>',"</tpl>",'<tpl if="left"><div id="{fgid}ML" class="{frameCls}-ml {baseCls}-ml {baseCls}-{ui}-ml<tpl for="uiCls"> {parent.baseCls}-{parent.ui}-{.}-ml</tpl>{frameElCls}" role="presentation"></tpl>','<tpl if="right"><div id="{fgid}MR" class="{frameCls}-mr {baseCls}-mr {baseCls}-{ui}-mr<tpl for="uiCls"> {parent.baseCls}-{parent.ui}-{.}-mr</tpl>{frameElCls}" role="presentation"></tpl>','<div id="{fgid}MC" class="{frameCls}-mc {baseCls}-mc {baseCls}-{ui}-mc<tpl for="uiCls"> {parent.baseCls}-{parent.ui}-{.}-mc</tpl>{frameElCls}" role="presentation">',"{%this.applyRenderTpl(out, values)%}","</div>",'<tpl if="right"></div></tpl>','<tpl if="left"></div></tpl>','<tpl if="bottom">','<tpl if="left"><div id="{fgid}BL" class="{frameCls}-bl {baseCls}-bl {baseCls}-{ui}-bl<tpl for="uiCls"> {parent.baseCls}-{parent.ui}-{.}-bl</tpl>{frameElCls}" role="presentation"></tpl>','<tpl if="right"><div id="{fgid}BR" class="{frameCls}-br {baseCls}-br {baseCls}-{ui}-br<tpl for="uiCls"> {parent.baseCls}-{parent.ui}-{.}-br</tpl>{frameElCls}" role="presentation"></tpl>','<div id="{fgid}BC" class="{frameCls}-bc {baseCls}-bc {baseCls}-{ui}-bc<tpl for="uiCls"> {parent.baseCls}-{parent.ui}-{.}-bc</tpl>{frameElCls}" role="presentation"></div>','<tpl if="right"></div></tpl>','<tpl if="left"></div></tpl>',"</tpl>","{%this.renderDockedItems(out,values,1);%}"],frameTableTpl:["{%this.renderDockedItems(out,values,0);%}",'<table class="',Ext.baseCSSPrefix,"table-plain",'" cellpadding="0"><tbody>','<tpl if="top">',"<tr>",'<tpl if="left"><td id="{fgid}TL" class="{frameCls}-tl {baseCls}-tl {baseCls}-{ui}-tl<tpl for="uiCls"> {parent.baseCls}-{parent.ui}-{.}-tl</tpl>{frameElCls}" role="presentation"></td></tpl>','<td id="{fgid}TC" class="{frameCls}-tc {baseCls}-tc {baseCls}-{ui}-tc<tpl for="uiCls"> {parent.baseCls}-{parent.ui}-{.}-tc</tpl>{frameElCls}" role="presentation"></td>','<tpl if="right"><td id="{fgid}TR" class="{frameCls}-tr {baseCls}-tr {baseCls}-{ui}-tr<tpl for="uiCls"> {parent.baseCls}-{parent.ui}-{.}-tr</tpl>{frameElCls}" role="presentation"></td></tpl>',"</tr>","</tpl>","<tr>",'<tpl if="left"><td id="{fgid}ML" class="{frameCls}-ml {baseCls}-ml {baseCls}-{ui}-ml<tpl for="uiCls"> {parent.baseCls}-{parent.ui}-{.}-ml</tpl>{frameElCls}" role="presentation"></td></tpl>','<td id="{fgid}MC" class="{frameCls}-mc {baseCls}-mc {baseCls}-{ui}-mc<tpl for="uiCls"> {parent.baseCls}-{parent.ui}-{.}-mc</tpl>{frameElCls}" role="presentation">',"{%this.applyRenderTpl(out, values)%}","</td>",'<tpl if="right"><td id="{fgid}MR" class="{frameCls}-mr {baseCls}-mr {baseCls}-{ui}-mr<tpl for="uiCls"> {parent.baseCls}-{parent.ui}-{.}-mr</tpl>{frameElCls}" role="presentation"></td></tpl>',"</tr>",'<tpl if="bottom">',"<tr>",'<tpl if="left"><td id="{fgid}BL" class="{frameCls}-bl {baseCls}-bl {baseCls}-{ui}-bl<tpl for="uiCls"> {parent.baseCls}-{parent.ui}-{.}-bl</tpl>{frameElCls}" role="presentation"></td></tpl>','<td id="{fgid}BC" class="{frameCls}-bc {baseCls}-bc {baseCls}-{ui}-bc<tpl for="uiCls"> {parent.baseCls}-{parent.ui}-{.}-bc</tpl>{frameElCls}" role="presentation"></td>','<tpl if="right"><td id="{fgid}BR" class="{frameCls}-br {baseCls}-br {baseCls}-{ui}-br<tpl for="uiCls"> {parent.baseCls}-{parent.ui}-{.}-br</tpl>{frameElCls}" role="presentation"></td></tpl>',"</tr>","</tpl>","</tbody></table>","{%this.renderDockedItems(out,values,1);%}"],afterRender:function(){var d=this,e={},i=d.protoEl,h=d.el,c,g,a,b;d.finishRenderChildren();if(d.contentEl){g=Ext.baseCSSPrefix;a=g+"hide-";b=Ext.get(d.contentEl);b.removeCls([g+"hidden",a+"display",a+"offsets",a+"nosize"]);d.getContentTarget().appendChild(b.dom)}i.writeTo(e);c=e.removed;if(c){h.removeCls(c)}c=e.cls;if(c.length){h.addCls(c)}c=e.style;if(e.style){h.setStyle(c)}d.protoEl=null;if(!d.ownerCt){d.updateLayout()}},afterFirstLayout:function(b,i){var d=this,h=d.x,e=d.y,c,a,g,j;if(!d.ownerLayout){c=Ext.isDefined(h);a=Ext.isDefined(e)}if(d.floating&&(!c||!a)){if(d.floatParent){g=d.floatParent.getTargetEl().getViewRegion();j=d.el.getAlignToXY(d.floatParent.getTargetEl(),"c-c");g.x=j[0]-g.x;g.y=j[1]-g.y}else{j=d.el.getAlignToXY(d.container,"c-c");g=d.container.translateXY(j[0],j[1])}h=c?h:g.x;e=a?e:g.y;c=a=true}if(c||a){d.setPosition(h,e)}d.onBoxReady(b,i)},applyRenderSelectors:function(){var d=this,b=d.renderSelectors,c=d.el,e=c.dom,a;d.applyChildEls(c);if(b){for(a in b){if(b.hasOwnProperty(a)&&b[a]){d[a]=Ext.get(Ext.DomQuery.selectNode(b[a],e))}}}},beforeRender:function(){var c=this,e=c.getTargetEl(),d=c.getOverflowEl(),b=c.getComponentLayout(),a=c.getOverflowStyle();c.frame=c.frame||c.alwaysFramed;if(!b.initialized){b.initLayout()}if(d){d.setStyle(a);c.overflowStyleSet=true}c.setUI(c.ui);if(c.disabled){c.disable(true)}},doApplyRenderTpl:function(c,a){var d=a.$comp,b;if(!d.rendered){b=d.initRenderTpl();b.applyOut(a.renderData,c)}},doAutoRender:function(){var a=this;if(!a.rendered){if(a.floating){a.render(document.body)}else{a.render(Ext.isBoolean(a.autoRender)?Ext.getBody():a.autoRender)}}},doRenderContent:function(a,c){var b=c.$comp;if(b.html){Ext.DomHelper.generateMarkup(b.html,a);delete b.html}if(b.tpl){if(!b.tpl.isTemplate){b.tpl=new Ext.XTemplate(b.tpl)}if(b.data){b.tpl.applyOut(b.data,a);delete b.data}}},doRenderFramingDockedItems:function(a,c,d){var b=c.$comp;if(!b.rendered&&b.doRenderDockedItems){c.renderData.$skipDockedItems=true;b.doRenderDockedItems.call(this,a,c,d)}},finishRender:function(a){var d=this,b,e,c;if(!d.el||d.$pid){if(d.container){c=d.container.getById(d.id,true)}else{c=Ext.getDom(d.id)}if(!d.el){d.wrapPrimaryEl(c)}else{delete d.$pid;if(!d.el.dom){d.wrapPrimaryEl(d.el)}c.parentNode.insertBefore(d.el.dom,c);Ext.removeNode(c)}}else{if(!d.rendering){b=d.initRenderTpl();if(b){e=d.initRenderData();b.insertFirst(d.getTargetEl(),e)}}}if(!d.container){d.container=Ext.get(d.el.dom.parentNode)}if(d.ctCls){d.container.addCls(d.ctCls)}d.onRender(d.container,a);if(!d.overflowStyleSet){d.getOverflowEl().setStyle(d.getOverflowStyle())}d.el.setVisibilityMode(Ext.Element[d.hideMode.toUpperCase()]);if(d.overCls){d.el.hover(d.addOverCls,d.removeOverCls,d)}if(d.hasListeners.render){d.fireEvent("render",d)}d.afterRender();if(d.hasListeners.afterrender){d.fireEvent("afterrender",d)}d.initEvents();if(d.hidden){d.el.hide()}},finishRenderChildren:function(){var a=this.getComponentLayout();a.finishRender()},getElConfig:function(){var j=this,l=j.autoEl,g=j.getFrameInfo(),b={tag:"div",tpl:g?j.initFramingTpl(g.table):j.initRenderTpl()},a=j.protoEl,c,e,h,m,d,k;j.initStyles(a);if(g){a.setStyle("background-image","none")}a.writeTo(b);a.flush();if(Ext.isString(l)){b.tag=l}else{Ext.apply(b,l)}b.id=j.id;if(b.tpl){if(g){e=j.frameElNames;h=e.length;b.tplData=k=j.getFrameRenderData();k.renderData=j.initRenderData();d=k.fgid;for(c=0;c<h;c++){m=e[c];j.addChildEls({name:"frame"+m,id:d+m})}j.addChildEls({name:"frameBody",id:d+"MC"})}else{b.tplData=j.initRenderData()}}return b},initFramingTpl:function(b){var a=this.getFrameTpl(b);if(a&&!a.applyRenderTpl){this.setupFramingTpl(a)}return a},setupFramingTpl:function(a){a.applyRenderTpl=this.doApplyRenderTpl;a.renderDockedItems=this.doRenderFramingDockedItems},getInsertPosition:function(a){if(a!==undefined){if(Ext.isNumber(a)){a=this.container.dom.childNodes[a]}else{a=Ext.getDom(a)}}return a},getRenderTree:function(){var a=this;if(!a.hasListeners.beforerender||a.fireEvent("beforerender",a)!==false){a.beforeRender();a.rendering=true;if(a.el){return{tag:"div",id:(a.$pid=Ext.id())}}return a.getElConfig()}return null},initContainer:function(a){var b=this;if(!a&&b.el){a=b.el.dom.parentNode;b.allowDomMove=false}b.container=a.dom?a:Ext.get(a);return b.container},initRenderData:function(){var a=this;return Ext.apply({$comp:a,id:a.id,ui:a.ui,uiCls:a.uiCls,baseCls:a.baseCls,componentCls:a.componentCls,frame:a.frame,childElCls:""},a.renderData)},initRenderTpl:function(){var a=this.getTpl("renderTpl");if(a&&!a.renderContent){this.setupRenderTpl(a)}return a},onRender:function(d,e){var h=this,j=h.x,i=h.y,c=null,a,k,b=h.el,g;h.applyRenderSelectors();h.rendering=null;h.rendered=true;if(j!=null){c={x:j}}if(i!=null){(c=c||{}).y=i}if(!h.getFrameInfo()&&Ext.isBorderBox){a=h.width;k=h.height;if(typeof a==="number"){c=c||{};c.width=a}if(typeof k==="number"){c=c||{};c.height=k}}h.lastBox=b.lastBox=c},render:function(c,b){var e=this,d=e.el&&(e.el=Ext.get(e.el)),h,a,g;Ext.suspendLayouts();c=e.initContainer(c);g=e.getInsertPosition(b);if(!d){a=e.getRenderTree();if(e.ownerLayout&&e.ownerLayout.transformItemRenderTree){a=e.ownerLayout.transformItemRenderTree(a)}if(a){if(g){d=Ext.DomHelper.insertBefore(g,a)}else{d=Ext.DomHelper.append(c,a)}e.wrapPrimaryEl(d)}}else{if(!e.hasListeners.beforerender||e.fireEvent("beforerender",e)!==false){e.beforeRender();e.initStyles(d);if(e.allowDomMove!==false){if(g){c.dom.insertBefore(d.dom,g)}else{c.dom.appendChild(d.dom)}}}else{h=true}}if(d&&!h){e.finishRender(b)}Ext.resumeLayouts(!c.isDetachedBody)},ensureAttachedToBody:function(c){var b=this,a;while(b.ownerCt){b=b.ownerCt}if(b.container.isDetachedBody){b.container=a=Ext.getBody();a.appendChild(b.el.dom);if(c){b.updateLayout()}if(typeof b.x=="number"||typeof b.y=="number"){b.setPosition(b.x,b.y)}}},setupRenderTpl:function(a){a.renderBody=a.renderContent=this.doRenderContent},wrapPrimaryEl:function(a){this.el=Ext.get(a,true)},initFrame:function(){if(Ext.supports.CSS3BorderRadius||!this.frame){return}var h=this,e=h.getFrameInfo(),a,c,d=h.frameElNames,g=d.length,b,j,k;if(e){a=h.getFrameTpl(e.table);j=h.getFrameRenderData();c=j.fgid;a.insertFirst(h.el,j);h.frameBody=h.el.down("."+h.frameCls+"-mc");h.removeChildEls(function(i){return i.id&&h.frameIdRegex.test(i.id)});for(b=0;b<g;b++){k=d[b];h["frame"+k]=h.el.getById(c+k)}}},getFrameRenderData:function(){var c=this,b=c.frameSize,a=(c.frameGenId||0)+1;c.frameGenId=a;return{$comp:c,fgid:c.id+"-frame"+a,ui:c.ui,uiCls:c.uiCls,frameCls:c.frameCls,baseCls:c.baseCls,top:!!b.top,left:!!b.left,right:!!b.right,bottom:!!b.bottom,frameElCls:""}},updateFrame:function(){if(Ext.supports.CSS3BorderRadius||!this.frame){return}var e=this,h=e.frameSize&&e.frameSize.table,g=e.frameTL,d=e.frameBL,c=e.frameML,a=e.frameMC,b;e.initFrame();if(a){if(e.frame){b=e.frameMC.dom.className;a.insertAfter(e.frameMC);e.frameMC.remove();e.frameBody=e.frameMC=a;a.dom.className=b;if(h){e.el.query("> table")[1].remove()}else{if(g){g.remove()}if(d){d.remove()}if(c){c.remove()}}}}else{if(e.frame){e.applyRenderSelectors()}}},getFrameInfo:function(){if(Ext.supports.CSS3BorderRadius||!this.frame){return false}var x=this,p=x.frameInfoCache,g=x.el||x.protoEl,e=g.dom?g.dom.className:g.classList.join(" "),y=p[e],q=Math.max,o,k,t,n,z,h,l,b,c,m,i,s,u,j,a,d,w,r,v;if(y==null){o=Ext.fly(x.getStyleProxy(e),"frame-style-el");t=o.getStyle("background-image");k=t.indexOf("about:blank#");if(k<0){y=false}else{t=t.substring(k+12).split("-");d=parseInt(t[1],10);w=parseInt(t[2],10);r=parseInt(t[3],10);v=parseInt(t[4],10);b=parseInt(t[5],10);c=parseInt(t[6],10);m=parseInt(t[7],10);i=parseInt(t[8],10);s=parseInt(t[9],10);u=parseInt(t[10],10);j=parseInt(t[11],10);a=parseInt(t[12],10);n=q(b,q(d,w));z=q(c,q(w,r));h=q(m,q(v,r));l=q(i,q(d,v));y={table:t[0].charAt(0)==="t",vertical:t[0].charAt(1)==="v",top:n,right:z,bottom:h,left:l,width:l+z,height:n+h,maxWidth:q(n,z,h,l),border:{top:b,right:c,bottom:m,left:i,width:i+c,height:b+m},padding:{top:s,right:u,bottom:j,left:a,width:a+u,height:s+j},radius:{tl:d,tr:w,br:r,bl:v}}}p[e]=y}x.frame=!!y;x.frameSize=y;return y},getStyleProxy:function(b){var a=this.styleProxyEl||(Ext.AbstractComponent.prototype.styleProxyEl=Ext.getBody().createChild({style:{position:"absolute",top:"-10000px"}},null,true));a.className=b;return a},getFrameTpl:function(a){return this.getTpl(a?"frameTableTpl":"frameTpl")},frameInfoCache:{}});Ext.define("Ext.state.Provider",{mixins:{observable:Ext.util.Observable},prefix:"ext-",constructor:function(a){a=a||{};var b=this;Ext.apply(b,a);b.addEvents("statechange");b.state={};b.mixins.observable.constructor.call(b)},get:function(b,a){return typeof this.state[b]=="undefined"?a:this.state[b]},clear:function(a){var b=this;delete b.state[a];b.fireEvent("statechange",b,a,null)},set:function(a,c){var b=this;b.state[a]=c;b.fireEvent("statechange",b,a,c)},decodeValue:function(g){var c=this,k=/^(a|n|d|b|s|o|e)\:(.*)$/,b=k.exec(unescape(g)),h,d,a,j,e,i;if(!b||!b[1]){return}d=b[1];g=b[2];switch(d){case"e":return null;case"n":return parseFloat(g);case"d":return new Date(Date.parse(g));case"b":return(g=="1");case"a":h=[];if(g!=""){j=g.split("^");e=j.length;for(i=0;i<e;i++){g=j[i];h.push(c.decodeValue(g))}}return h;case"o":h={};if(g!=""){j=g.split("^");e=j.length;for(i=0;i<e;i++){g=j[i];a=g.split("=");h[a[0]]=c.decodeValue(a[1])}}return h;default:return g}},encodeValue:function(e){var g="",d=0,b,a,c;if(e==null){return"e:1"}else{if(typeof e=="number"){b="n:"+e}else{if(typeof e=="boolean"){b="b:"+(e?"1":"0")}else{if(Ext.isDate(e)){b="d:"+e.toGMTString()}else{if(Ext.isArray(e)){for(a=e.length;d<a;d++){g+=this.encodeValue(e[d]);if(d!=a-1){g+="^"}}b="a:"+g}else{if(typeof e=="object"){for(c in e){if(typeof e[c]!="function"&&e[c]!==undefined){g+=c+"="+this.encodeValue(e[c])+"^"}}b="o:"+g.substring(0,g.length-1)}else{b="s:"+e}}}}}}return escape(b)}});Ext.define("Ext.state.Manager",{singleton:true,constructor:function(){this.provider=new Ext.state.Provider()},setProvider:function(a){this.provider=a},get:function(b,a){return this.provider.get(b,a)},set:function(a,b){this.provider.set(a,b)},clear:function(a){this.provider.clear(a)},getProvider:function(){return this.provider}});Ext.define("Ext.state.Stateful",{mixins:{observable:Ext.util.Observable},stateful:false,saveDelay:100,constructor:function(a){var b=this;a=a||{};if(a.stateful!==undefined){b.stateful=a.stateful}if(a.saveDelay!==undefined){b.saveDelay=a.saveDelay}b.stateId=b.stateId||a.stateId;if(!b.stateEvents){b.stateEvents=[]}if(a.stateEvents){b.stateEvents.concat(a.stateEvents)}this.addEvents("beforestaterestore","staterestore","beforestatesave","statesave");b.mixins.observable.constructor.call(b);if(b.stateful!==false){b.addStateEvents(b.stateEvents);b.initState()}},addStateEvents:function(c){var e=this,b,d,a;if(e.stateful&&e.getStateId()){if(typeof c=="string"){c=Array.prototype.slice.call(arguments,0)}a=e.stateEventsByName||(e.stateEventsByName={});for(b=c.length;b--;){d=c[b];if(!a[d]){a[d]=1;e.on(d,e.onStateChange,e)}}}},onStateChange:function(){var c=this,a=c.saveDelay,d,b;if(!c.stateful){return}if(a){if(!c.stateTask){d=Ext.state.Stateful;b=d.runner||(d.runner=new Ext.util.TaskRunner());c.stateTask=b.newTask({run:c.saveState,scope:c,interval:a,repeat:1})}c.stateTask.start()}else{c.saveState()}},saveState:function(){var b=this,d=b.stateful&&b.getStateId(),a=b.hasListeners,c;if(d){c=b.getState()||{};if(!a.beforestatesave||b.fireEvent("beforestatesave",b,c)!==false){Ext.state.Manager.set(d,c);if(a.statesave){b.fireEvent("statesave",b,c)}}}},getState:function(){return null},applyState:function(a){if(a){Ext.apply(this,a)}},getStateId:function(){var a=this;return a.stateId||(a.autoGenId?null:a.id)},initState:function(){var b=this,d=b.stateful&&b.getStateId(),a=b.hasListeners,c;if(d){c=Ext.state.Manager.get(d);if(c){c=Ext.apply({},c);if(!a.beforestaterestore||b.fireEvent("beforestaterestore",b,c)!==false){b.applyState(c);if(a.staterestore){b.fireEvent("staterestore",b,c)}}}}},savePropToState:function(g,e,d){var b=this,c=b[g],a=b.initialConfig;if(b.hasOwnProperty(g)){if(!a||a[g]!==c){if(e){e[d||g]=c}return true}}return false},savePropsToState:function(e,c){var b=this,a,d;if(typeof e=="string"){b.savePropToState(e,c)}else{for(a=0,d=e.length;a<d;++a){b.savePropToState(e[a],c)}}return c},destroy:function(){var b=this,a=b.stateTask;if(a){a.destroy();b.stateTask=null}b.clearListeners()}});Ext.define("Ext.AbstractComponent",{mixins:{positionable:Ext.util.Positionable,observable:Ext.util.Observable,animate:Ext.util.Animate,elementCt:Ext.util.ElementContainer,renderable:Ext.util.Renderable,state:Ext.state.Stateful},statics:{AUTO_ID:1000,pendingLayouts:null,layoutSuspendCount:0,cancelLayout:function(a,c){var b=this.runningLayoutContext||this.pendingLayouts;if(b){b.cancelComponent(a,false,c)}},flushLayouts:function(){var b=this,a=b.pendingLayouts;if(a&&a.invalidQueue.length){b.pendingLayouts=null;b.runningLayoutContext=a;Ext.override(a,{runComplete:function(){b.runningLayoutContext=null;var c=this.callParent();if(Ext.globalEvents.hasListeners.afterlayout){Ext.globalEvents.fireEvent("afterlayout")}return c}});a.run()}},resumeLayouts:function(a){if(this.layoutSuspendCount&&!--this.layoutSuspendCount){if(a){this.flushLayouts()}if(Ext.globalEvents.hasListeners.resumelayouts){Ext.globalEvents.fireEvent("resumelayouts")}}},suspendLayouts:function(){++this.layoutSuspendCount},updateLayout:function(b,e){var c=this,a=c.runningLayoutContext,d;if(a){a.queueInvalidate(b)}else{d=c.pendingLayouts||(c.pendingLayouts=new Ext.layout.Context());d.queueInvalidate(b);if(!e&&!c.layoutSuspendCount&&!b.isLayoutSuspended()){c.flushLayouts()}}}},isComponent:true,getAutoId:function(){this.autoGenId=true;return ++Ext.AbstractComponent.AUTO_ID},deferLayouts:false,autoGenId:false,renderTpl:"{%this.renderContent(out,values)%}",frameSize:null,tplWriteMode:"overwrite",baseCls:Ext.baseCSSPrefix+"component",disabledCls:Ext.baseCSSPrefix+"item-disabled",ui:"default",uiCls:[],hidden:false,disabled:false,draggable:false,floating:false,hideMode:"display",autoShow:false,autoRender:false,allowDomMove:true,rendered:false,componentLayoutCounter:0,shrinkWrap:2,weight:0,maskOnDisable:true,_isLayoutRoot:false,contentPaddingProperty:"padding",horizontalPosProp:"left",constructor:function(c){var e=this,d,a,b;if(c){Ext.apply(e,c);b=e.xhooks;if(b){delete e.xhooks;Ext.override(e,b)}}else{c={}}e.initialConfig=c;e.mixins.elementCt.constructor.call(e);e.addEvents("beforeactivate","activate","beforedeactivate","deactivate","added","disable","enable","beforeshow","show","beforehide","hide","removed","beforerender","render","afterrender","boxready","beforedestroy","destroy","resize","move","focus","blur");e.getId();e.setupProtoEl();if(e.cls){e.initialCls=e.cls;e.protoEl.addCls(e.cls)}if(e.style){e.initialStyle=e.style;e.protoEl.setStyle(e.style)}e.renderData=e.renderData||{};e.renderSelectors=e.renderSelectors||{};if(e.plugins){e.plugins=e.constructPlugins()}if(!e.hasListeners){e.hasListeners=new e.HasListeners()}e.initComponent();Ext.ComponentManager.register(e);e.mixins.observable.constructor.call(e);e.mixins.state.constructor.call(e,c);this.addStateEvents("resize");if(e.plugins){for(d=0,a=e.plugins.length;d<a;d++){e.plugins[d]=e.initPlugin(e.plugins[d])}}e.loader=e.getLoader();if(e.renderTo){e.render(e.renderTo)}if(e.autoShow&&!e.isContained){e.show()}},initComponent:function(){this.plugins=this.constructPlugins();this.setSize(this.width,this.height)},getState:function(){var b=this,c=null,a=b.getSizeModel();if(a.width.configured){c=b.addPropertyToState(c,"width")}if(a.height.configured){c=b.addPropertyToState(c,"height")}return c},addPropertyToState:function(e,d,c){var b=this,a=arguments.length;if(a==3||b.hasOwnProperty(d)){if(a<3){c=b[d]}if(c!==b.initialConfig[d]){(e||(e={}))[d]=c}}return e},show:Ext.emptyFn,animate:function(c){var t=this,g,l,k,a,d,b,s,p,m,e,q,n,i,o,r,j;c=c||{};d=c.to||{};if(Ext.fx.Manager.hasFxBlock(t.id)){return t}g=Ext.isDefined(d.width);if(g){a=Ext.Number.constrain(d.width,t.minWidth,t.maxWidth)}l=Ext.isDefined(d.height);if(l){k=Ext.Number.constrain(d.height,t.minHeight,t.maxHeight)}if(!c.dynamic&&(g||l)){p=(c.from?c.from.width:undefined)||t.getWidth();m=p;e=(c.from?c.from.height:undefined)||t.getHeight();q=e;n=false;if(l&&k>e){q=k;n=true}if(g&&a>p){m=a;n=true}if(l||g){j=t.el.getStyle("overtflow");if(j!=="hidden"){t.el.setStyle("overflow","hidden")}}if(n){b=!Ext.isNumber(t.width);s=!Ext.isNumber(t.height);t.setSize(m,q);t.el.setSize(p,e);if(b){delete t.width}if(s){delete t.height}}if(g){d.width=a}if(l){d.height=k}}i=t.constrain;o=t.constrainHeader;if(i||o){t.constrain=t.constrainHeader=false;r=c.callback;c.callback=function(){t.constrain=i;t.constrainHeader=o;if(r){r.call(c.scope||t,arguments)}if(j!=="hidden"){t.el.setStyle("overflow",j)}}}return t.mixins.animate.animate.apply(t,arguments)},onHide:function(){if(this.ownerLayout){this.updateLayout({isRoot:false})}},onShow:function(){this.updateLayout({isRoot:false})},constructPlugin:function(b){var a=this;if(typeof b=="string"){b=Ext.PluginManager.create({},b,a)}else{b=Ext.PluginManager.create(b,null,a)}return b},constructPlugins:function(){var e=this,c=e.plugins,b,d,a;if(c){b=[];if(!Ext.isArray(c)){c=[c]}for(d=0,a=c.length;d<a;d++){b[d]=e.constructPlugin(c[d])}}e.pluginsInitialized=true;return b},initPlugin:function(a){a.init(this);return a},addPlugin:function(b){var a=this;b=a.constructPlugin(b);if(a.plugins){a.plugins.push(b)}else{a.plugins=[b]}if(a.pluginsInitialized){a.initPlugin(b)}return b},removePlugin:function(a){Ext.Array.remove(this.plugins,a);a.destroy()},findPlugin:function(a){if(this.plugins){return Ext.Array.findBy(this.plugins,function(b){if(b.ptype===a){return true}})}},beforeLayout:Ext.emptyFn,updateAria:Ext.emptyFn,registerFloatingItem:function(b){var a=this;if(!a.floatingDescendants){a.floatingDescendants=new Ext.ZIndexManager(a)}a.floatingDescendants.register(b)},unregisterFloatingItem:function(b){var a=this;if(a.floatingDescendants){a.floatingDescendants.unregister(b)}},layoutSuspendCount:0,suspendLayouts:function(){var a=this;if(!a.rendered){return}if(++a.layoutSuspendCount==1){a.suspendLayout=true}},resumeLayouts:function(b){var a=this;if(!a.rendered){return}if(!--a.layoutSuspendCount){a.suspendLayout=false;if(b&&!a.isLayoutSuspended()){a.updateLayout(b)}}},setupProtoEl:function(){var a=this.initCls();this.protoEl=new Ext.util.ProtoElement({cls:a.join(" ")})},initCls:function(){var b=this,a=[b.baseCls,b.getComponentLayout().targetCls];if(Ext.isDefined(b.cmpCls)){if(Ext.isDefined(Ext.global.console)){Ext.global.console.warn("Ext.Component: cmpCls has been deprecated. Please use componentCls.")}b.componentCls=b.cmpCls;delete b.cmpCls}if(b.componentCls){a.push(b.componentCls)}else{b.componentCls=b.baseCls}return a},setUI:function(c){var b=this,e=b.uiCls,d=b.activeUI,a;if(c===d){return}if(d){a=b.removeClsWithUI(e,true);if(a.length){b.removeCls(a)}b.removeUIFromElement()}else{b.uiCls=[]}b.ui=c;b.activeUI=c;b.addUIToElement();a=b.addClsWithUI(e,true);if(a.length){b.addCls(a)}if(b.rendered){b.updateLayout()}},addClsWithUI:function(c,j){var h=this,g=[],e=0,d=h.uiCls=Ext.Array.clone(h.uiCls),b=h.activeUI,a,k;if(typeof c==="string"){c=(c.indexOf(" ")<0)?[c]:Ext.String.splitWords(c)}a=c.length;for(;e<a;e++){k=c[e];if(k&&!h.hasUICls(k)){d.push(k);if(b){g=g.concat(h.addUIClsToElement(k))}}}if(j!==true&&b){h.addCls(g)}return g},removeClsWithUI:function(d,l){var k=this,j=[],g=0,a=Ext.Array,h=a.remove,e=k.uiCls=a.clone(k.uiCls),c=k.activeUI,b,m;if(typeof d==="string"){d=(d.indexOf(" ")<0)?[d]:Ext.String.splitWords(d)}b=d.length;for(g=0;g<b;g++){m=d[g];if(m&&k.hasUICls(m)){h(e,m);if(c){j=j.concat(k.removeUIClsFromElement(m))}}}if(l!==true&&c){k.removeCls(j)}return j},hasUICls:function(a){var b=this,c=b.uiCls||[];return Ext.Array.contains(c,a)},frameElementsArray:["tl","tc","tr","ml","mc","mr","bl","bc","br"],addUIClsToElement:function(j){var h=this,b=h.baseCls+"-"+h.ui+"-"+j,k=[Ext.baseCSSPrefix+j,h.baseCls+"-"+j,b],g,e,d,a,c;if(h.rendered&&h.frame&&!Ext.supports.CSS3BorderRadius){g=h.frameElementsArray;e=g.length;for(d=0;d<e;d++){c=g[d];a=h["frame"+c.toUpperCase()];if(a){a.addCls(b+"-"+c)}}}return k},removeUIClsFromElement:function(j){var h=this,b=h.baseCls+"-"+h.ui+"-"+j,k=[Ext.baseCSSPrefix+j,h.baseCls+"-"+j,b],g,e,d,a,c;if(h.rendered&&h.frame&&!Ext.supports.CSS3BorderRadius){g=h.frameElementsArray;e=g.length;for(d=0;d<e;d++){c=g[d];a=h["frame"+c.toUpperCase()];if(a){a.addCls(b+"-"+c)}}}return k},addUIToElement:function(){var g=this,b=g.baseCls+"-"+g.ui,a,e,c,d,h;g.addCls(b);if(g.rendered&&g.frame&&!Ext.supports.CSS3BorderRadius){a=g.frameElementsArray;e=a.length;for(c=0;c<e;c++){h=a[c];d=g["frame"+h.toUpperCase()];if(d){d.addCls(b+"-"+h)}}}},removeUIFromElement:function(){var g=this,b=g.baseCls+"-"+g.ui,a,e,c,d,h;g.removeCls(b);if(g.rendered&&g.frame&&!Ext.supports.CSS3BorderRadius){a=g.frameElementsArray;e=a.length;for(c=0;c<e;c++){h=a[c];d=g["frame"+h.toUpperCase()];if(d){d.removeCls(b+"-"+h)}}}},getTpl:function(a){return Ext.XTemplate.getTpl(this,a)},initStyles:function(k){var g=this,c=Ext.Element,d=g.margin,e=g.border,l=g.cls,a=g.style,i=g.x,h=g.y,b,j;g.initPadding(k);if(d!=null){k.setStyle("margin",this.unitizeBox((d===true)?5:d))}if(e!=null){g.setBorder(e,k)}if(l&&l!=g.initialCls){k.addCls(l);g.cls=g.initialCls=null}if(a&&a!=g.initialStyle){k.setStyle(a);g.style=g.initialStyle=null}if(i!=null){k.setStyle(g.horizontalPosProp,(typeof i=="number")?(i+"px"):i)}if(h!=null){k.setStyle("top",(typeof h=="number")?(h+"px"):h)}if(!g.getFrameInfo()){b=g.width;j=g.height;if(b!=null){if(typeof b==="number"){if(Ext.isBorderBox){k.setStyle("width",b+"px")}}else{k.setStyle("width",b)}}if(j!=null){if(typeof j==="number"){if(Ext.isBorderBox){k.setStyle("height",j+"px")}}else{k.setStyle("height",j)}}}},initPadding:function(c){var a=this,b=a.padding;if(b!=null){if(a.layout&&a.layout.managePadding&&a.contentPaddingProperty==="padding"){c.setStyle("padding",0)}else{c.setStyle("padding",this.unitizeBox((b===true)?5:b))}}},parseBox:function(a){return Ext.dom.Element.parseBox(a)},unitizeBox:function(a){return Ext.dom.Element.unitizeBox(a)},setMargin:function(c,b){var a=this;if(a.rendered){if(!c&&c!==0){c=""}else{if(c===true){c=5}c=this.unitizeBox(c)}a.getTargetEl().setStyle("margin",c);if(!b){a.updateLayout()}}else{a.margin=c}},initEvents:function(){var e=this,h=e.afterRenderEvents,b,d,g,c,a;if(h){for(g in h){d=e[g];if(d&&d.on){b=h[g];for(c=0,a=b.length;c<a;++c){e.mon(d,b[c])}}}}e.addFocusListener()},addFocusListener:function(){var c=this,b=c.getFocusEl(),a;if(b){if(b.isComponent){return b.addFocusListener()}a=b.needsTabIndex();if(!c.focusListenerAdded&&(!a||Ext.FocusManager.enabled)){if(a){b.dom.tabIndex=-1}b.on({focus:c.onFocus,blur:c.onBlur,scope:c});c.focusListenerAdded=true}}},getFocusEl:Ext.emptyFn,isFocusable:function(){var b=this,a;if((b.focusable!==false)&&(a=b.getFocusEl())&&b.rendered&&!b.destroying&&!b.isDestroyed&&!b.disabled&&b.isVisible(true)){return a.isFocusable(true)}},beforeFocus:Ext.emptyFn,onFocus:function(d){var c=this,b=c.focusCls,a=c.getFocusEl();if(!c.disabled){c.beforeFocus(d);if(b&&a){a.addCls(c.addClsWithUI(b,true))}if(!c.hasFocus){c.hasFocus=true;c.fireEvent("focus",c,d)}}},beforeBlur:Ext.emptyFn,onBlur:function(d){var c=this,b=c.focusCls,a=c.getFocusEl();if(c.destroying){return}c.beforeBlur(d);if(b&&a){a.removeCls(c.removeClsWithUI(b,true))}if(c.validateOnBlur){c.validate()}c.hasFocus=false;c.fireEvent("blur",c,d);c.postBlur(d)},postBlur:Ext.emptyFn,is:function(a){return Ext.ComponentQuery.is(this,a)},up:function(b){var a=this.getRefOwner();if(b){for(;a;a=a.getRefOwner()){if(b.isComponent){if(a===b){return a}}else{if(Ext.ComponentQuery.is(a,b)){return a}}}}return a},nextSibling:function(b){var g=this.ownerCt,d,e,a,h;if(g){d=g.items;a=d.indexOf(this)+1;if(a){if(b){for(e=d.getCount();a<e;a++){if((h=d.getAt(a)).is(b)){return h}}}else{if(a<d.getCount()){return d.getAt(a)}}}}return null},previousSibling:function(b){var e=this.ownerCt,d,a,g;if(e){d=e.items;a=d.indexOf(this);if(a!=-1){if(b){for(--a;a>=0;a--){if((g=d.getAt(a)).is(b)){return g}}}else{if(a){return d.getAt(--a)}}}}return null},previousNode:function(b,d){var j=this,h=j.ownerCt,a,g,e,c;if(d&&j.is(b)){return j}if(h){for(g=h.items.items,e=Ext.Array.indexOf(g,j)-1;e>-1;e--){c=g[e];if(c.query){a=c.query(b);a=a[a.length-1];if(a){return a}}if(c.is(b)){return c}}return h.previousNode(b,true)}return null},nextNode:function(d,j){var b=this,c=b.ownerCt,k,e,h,g,a;if(j&&b.is(d)){return b}if(c){for(e=c.items.items,g=Ext.Array.indexOf(e,b)+1,h=e.length;g<h;g++){a=e[g];if(a.is(d)){return a}if(a.down){k=a.down(d);if(k){return k}}}return c.nextNode(d)}return null},getId:function(){return this.id||(this.id="ext-comp-"+(this.getAutoId()))},getItemId:function(){return this.itemId||this.id},getEl:function(){return this.el},getTargetEl:function(){return this.frameBody||this.el},getOverflowEl:function(){return this.getTargetEl()},getOverflowStyle:function(){var e=this,b=null,d,c,a;if(typeof e.autoScroll==="boolean"){b={overflow:a=e.autoScroll?"auto":""};e.scrollFlags={overflowX:a,overflowY:a,x:true,y:true,both:true}}else{d=e.overflowX;c=e.overflowY;if(d!==undefined||c!==undefined){b={overflowX:d=d||"",overflowY:c=c||""};e.scrollFlags={overflowX:d,overflowY:c,x:d=(d==="auto"||d==="scroll"),y:c=(c==="auto"||c==="scroll"),both:d&&c}}else{e.scrollFlags={overflowX:"",overflowY:"",x:false,y:false,both:false}}}if(b&&Ext.isIE7m){b.position="relative"}return b},isXType:function(b,a){if(a){return this.xtype===b}else{return this.xtypesMap[b]}},getXTypes:function(){var c=this.self,d,b,a;if(!c.xtypes){d=[];b=this;while(b){a=b.xtypes;if(a!==undefined){d.unshift.apply(d,a)}b=b.superclass}c.xtypeChain=d;c.xtypes=d.join("/")}return c.xtypes},update:function(b,c,a){var e=this,g=(e.tpl&&!Ext.isString(b)),d;if(g){e.data=b}else{e.html=Ext.isObject(b)?Ext.DomHelper.markup(b):b}if(e.rendered){d=e.isContainer?e.layout.getRenderTarget():e.getTargetEl();if(g){e.tpl[e.tplWriteMode](d,b||{})}else{d.update(e.html,c,a)}e.updateLayout()}},setVisible:function(a){return this[a?"show":"hide"]()},isVisible:function(a){var b=this,c;if(b.hidden||!b.rendered||b.isDestroyed){c=true}else{if(a){c=b.isHierarchicallyHidden()}}return !c},isHierarchicallyHidden:function(){var d=this,c=false,b,a;for(;(b=d.ownerCt||d.floatParent);d=b){a=b.getHierarchyState();if(a.hidden){c=true;break}if(d.getHierarchyState().collapseImmune){if(b.collapsed&&!d.collapseImmune){c=true;break}}else{c=!!a.collapsed;break}}return c},onBoxReady:function(b,a){var c=this;if(c.disableOnBoxReady){c.onDisable()}else{if(c.enableOnBoxReady){c.onEnable()}}if(c.resizable){c.initResizable(c.resizable)}if(c.draggable){c.initDraggable()}if(c.hasListeners.boxready){c.fireEvent("boxready",c,b,a)}},enable:function(a){var b=this;delete b.disableOnBoxReady;b.removeCls(b.disabledCls);if(b.rendered){b.onEnable()}else{b.enableOnBoxReady=true}b.disabled=false;delete b.resetDisable;if(a!==true){b.fireEvent("enable",b)}return b},disable:function(a){var b=this;delete b.enableOnBoxReady;b.addCls(b.disabledCls);if(b.rendered){b.onDisable()}else{b.disableOnBoxReady=true}b.disabled=true;if(a!==true){delete b.resetDisable;b.fireEvent("disable",b)}return b},onEnable:function(){if(this.maskOnDisable){this.el.dom.disabled=false;this.unmask()}},onDisable:function(){var c=this,b=c.focusCls,a=c.getFocusEl();if(b&&a){a.removeCls(c.removeClsWithUI(b,true))}if(c.maskOnDisable){c.el.dom.disabled=true;c.mask()}},mask:function(){var b=this.lastBox,c=this.getMaskTarget(),a=[];if(b){a[2]=b.height}c.mask.apply(c,a)},unmask:function(){this.getMaskTarget().unmask()},getMaskTarget:function(){return this.el},isDisabled:function(){return this.disabled},setDisabled:function(a){return this[a?"disable":"enable"]()},isHidden:function(){return this.hidden},addCls:function(a){var c=this,b=c.rendered?c.el:c.protoEl;b.addCls.apply(b,arguments);return c},addClass:function(){return this.addCls.apply(this,arguments)},hasCls:function(a){var c=this,b=c.rendered?c.el:c.protoEl;return b.hasCls.apply(b,arguments)},removeCls:function(a){var c=this,b=c.rendered?c.el:c.protoEl;b.removeCls.apply(b,arguments);return c},addOverCls:function(){var a=this;if(!a.disabled){a.el.addCls(a.overCls)}},removeOverCls:function(){this.el.removeCls(this.overCls)},addListener:function(b,g,e,a){var h=this,d,c;if(Ext.isString(b)&&(Ext.isObject(g)||a&&a.element)){if(a.element){d=g;g={};g[b]=d;b=a.element;if(e){g.scope=e}for(c in a){if(a.hasOwnProperty(c)){if(h.eventOptionsRe.test(c)){g[c]=a[c]}}}}if(h[b]&&h[b].on){h.mon(h[b],g)}else{h.afterRenderEvents=h.afterRenderEvents||{};if(!h.afterRenderEvents[b]){h.afterRenderEvents[b]=[]}h.afterRenderEvents[b].push(g)}return}return h.mixins.observable.addListener.apply(h,arguments)},removeManagedListenerItem:function(b,a,i,d,g,e){var h=this,c=a.options?a.options.element:null;if(c){c=h[c];if(c&&c.un){if(b||(a.item===i&&a.ename===d&&(!g||a.fn===g)&&(!e||a.scope===e))){c.un(a.ename,a.fn,a.scope);if(!b){Ext.Array.remove(h.managedListeners,a)}}}}else{return h.mixins.observable.removeManagedListenerItem.apply(h,arguments)}},getBubbleTarget:function(){return this.ownerCt},isFloating:function(){return this.floating},isDraggable:function(){return !!this.draggable},isDroppable:function(){return !!this.droppable},onAdded:function(a,c){var b=this;b.ownerCt=a;if(b.hierarchyState){b.hierarchyState.invalid=true;delete b.hierarchyState}if(b.hasListeners.added){b.fireEvent("added",b,a,c)}},onRemoved:function(b){var a=this;if(a.hasListeners.removed){a.fireEvent("removed",a,a.ownerCt)}delete a.ownerCt;delete a.ownerLayout},beforeDestroy:Ext.emptyFn,onResize:function(c,a,b,e){var d=this;if(d.floating&&d.constrain){d.doConstrain()}if(d.hasListeners.resize){d.fireEvent("resize",d,c,a,b,e)}},setSize:function(b,a){var c=this;if(b&&typeof b=="object"){a=b.height;b=b.width}if(typeof b=="number"){c.width=Ext.Number.constrain(b,c.minWidth,c.maxWidth)}else{if(b===null){delete c.width}}if(typeof a=="number"){c.height=Ext.Number.constrain(a,c.minHeight,c.maxHeight)}else{if(a===null){delete c.height}}if(c.rendered&&c.isVisible()){c.updateLayout({isRoot:false})}return c},isLayoutRoot:function(){var a=this,b=a.ownerLayout;if(!b||a._isLayoutRoot||a.floating){return true}return b.isItemLayoutRoot(a)},isLayoutSuspended:function(){var a=this,b;while(a){if(a.layoutSuspendCount||a.suspendLayout){return true}b=a.ownerLayout;if(!b){break}a=b.owner}return false},updateLayout:function(c){var d=this,e,b=d.lastBox,a=c&&c.isRoot;if(b){b.invalid=true}if(!d.rendered||d.layoutSuspendCount||d.suspendLayout){return}if(d.hidden){Ext.AbstractComponent.cancelLayout(d)}else{if(typeof a!="boolean"){a=d.isLayoutRoot()}}if(a||!d.ownerLayout||!d.ownerLayout.onContentChange(d)){if(!d.isLayoutSuspended()){e=(c&&c.hasOwnProperty("defer"))?c.defer:d.deferLayouts;Ext.AbstractComponent.updateLayout(d,e)}}},getSizeModel:function(j){var n=this,a=Ext.layout.SizeModel,d=n.componentLayout.ownerContext,b=n.width,p=n.height,q,c,g,e,h,o,l,m,k,i;if(d){i=d.widthModel;h=d.heightModel}if(!i||!h){g=((q=typeof b)=="number");e=((c=typeof p)=="number");k=n.floating||!(o=n.ownerLayout);if(k){l=Ext.layout.Layout.prototype.autoSizePolicy;m=n.floating?3:n.shrinkWrap;if(g){i=a.configured}if(e){h=a.configured}}else{l=o.getItemSizePolicy(n,j);m=o.isItemShrinkWrap(n)}if(d){d.ownerSizePolicy=l}m=(m===true)?3:(m||0);if(k&&m){if(b&&q=="string"){m&=2}if(p&&c=="string"){m&=1}}if(m!==3){if(!j){j=n.ownerCt&&n.ownerCt.getSizeModel()}if(j){m|=(j.width.shrinkWrap?1:0)|(j.height.shrinkWrap?2:0)}}if(!i){if(!l.setsWidth){if(g){i=a.configured}else{i=(m&1)?a.shrinkWrap:a.natural}}else{if(l.readsWidth){if(g){i=a.calculatedFromConfigured}else{i=(m&1)?a.calculatedFromShrinkWrap:a.calculatedFromNatural}}else{i=a.calculated}}}if(!h){if(!l.setsHeight){if(e){h=a.configured}else{h=(m&2)?a.shrinkWrap:a.natural}}else{if(l.readsHeight){if(e){h=a.calculatedFromConfigured}else{h=(m&2)?a.calculatedFromShrinkWrap:a.calculatedFromNatural}}else{h=a.calculated}}}}return i.pairsByHeightOrdinal[h.ordinal]},isDescendant:function(a){if(a.isContainer){for(var b=this.ownerCt;b;b=b.ownerCt){if(b===a){return true}}}return false},doComponentLayout:function(){this.updateLayout();return this},forceComponentLayout:function(){this.updateLayout()},setComponentLayout:function(b){var a=this.componentLayout;if(a&&a.isLayout&&a!=b){a.setOwner(null)}this.componentLayout=b;b.setOwner(this)},getComponentLayout:function(){var a=this;if(!a.componentLayout||!a.componentLayout.isLayout){a.setComponentLayout(Ext.layout.Layout.create(a.componentLayout,"autocomponent"))}return a.componentLayout},afterComponentLayout:function(c,a,b,e){var d=this;if(++d.componentLayoutCounter===1){d.afterFirstLayout(c,a)}if(c!==b||a!==e){d.onResize(c,a,b,e)}},beforeComponentLayout:function(b,a){return true},setPosition:function(a,e,b){var c=this,d=c.beforeSetPosition.apply(c,arguments);if(d&&c.rendered){a=d.x;e=d.y;if(b){if(a!==c.getLocalX()||e!==c.getLocalY()){c.stopAnimation();c.animate(Ext.apply({duration:1000,listeners:{afteranimate:Ext.Function.bind(c.afterSetPosition,c,[a,e])},to:{x:a,y:e}},b))}}else{c.setLocalXY(a,e);c.afterSetPosition(a,e)}}return c},beforeSetPosition:function(a,e,b){var d,c;if(a){if(Ext.isNumber(c=a[0])){b=e;e=a[1];a=c}else{if((c=a.x)!==undefined){b=e;e=a.y;a=c}}}if(this.constrain||this.constrainHeader){d=this.calculateConstrainedPosition(null,[a,e],true);if(d){a=d[0];e=d[1]}}d={x:this.x=a,y:this.y=e,anim:b,hasX:a!==undefined,hasY:e!==undefined};return(d.hasX||d.hasY)?d:null},afterSetPosition:function(a,c){var b=this;b.onPosition(a,c);if(b.hasListeners.move){b.fireEvent("move",b,a,c)}},onPosition:Ext.emptyFn,setWidth:function(a){return this.setSize(a)},setHeight:function(a){return this.setSize(undefined,a)},getSize:function(){return this.el.getSize()},getWidth:function(){return this.el.getWidth()},getHeight:function(){return this.el.getHeight()},getLoader:function(){var c=this,b=c.autoLoad?(Ext.isObject(c.autoLoad)?c.autoLoad:{url:c.autoLoad}):null,a=c.loader||b;if(a){if(!a.isLoader){c.loader=new Ext.ComponentLoader(Ext.apply({target:c,autoLoad:b},a))}else{a.setTarget(c)}return c.loader}return null},setDocked:function(b,c){var a=this;a.dock=b;if(c&&a.ownerCt&&a.rendered){a.ownerCt.updateLayout()}return a},setBorder:function(b,d){var c=this,a=!!d;if(c.rendered||a){if(!a){d=c.el}if(!b){b=0}else{if(b===true){b="1px"}else{b=this.unitizeBox(b)}}d.setStyle("border-width",b);if(!a){c.updateLayout()}}c.border=b},onDestroy:function(){var a=this;if(a.monitorResize&&Ext.EventManager.resizeEvent){Ext.EventManager.resizeEvent.removeListener(a.setSize,a)}Ext.destroy(a.componentLayout,a.loadMask,a.floatingDescendants)},destroy:function(){var d=this,b=d.renderSelectors,a,c;if(!d.isDestroyed){if(!d.hasListeners.beforedestroy||d.fireEvent("beforedestroy",d)!==false){d.destroying=true;d.beforeDestroy();if(d.floating){delete d.floatParent;if(d.zIndexManager){d.zIndexManager.unregister(d)}}else{if(d.ownerCt&&d.ownerCt.remove){d.ownerCt.remove(d,false)}}d.stopAnimation();d.onDestroy();Ext.destroy(d.plugins);if(d.hasListeners.destroy){d.fireEvent("destroy",d)}Ext.ComponentManager.unregister(d);d.mixins.state.destroy.call(d);d.clearListeners();if(d.rendered){if(!d.preserveElOnDestroy){d.el.remove()}d.mixins.elementCt.destroy.call(d);if(b){for(a in b){if(b.hasOwnProperty(a)){c=d[a];if(c){delete d[a];c.remove()}}}}delete d.el;delete d.frameBody;delete d.rendered}d.destroying=false;d.isDestroyed=true}}},getPlugin:function(b){var c=0,a=this.plugins,d=a.length;for(;c<d;c++){if(a[c].pluginId===b){return a[c]}}},isDescendantOf:function(a){return !!this.findParentBy(function(b){return b===a})},getHierarchyState:function(a){var e=this,i=(a&&e.hierarchyStateInner)||e.hierarchyState,c=e.ownerCt,b,d,g,h;if(!i||i.invalid){b=e.getRefOwner();if(c){h=e.ownerLayout===c.layout}e.hierarchyState=i=Ext.Object.chain(b?b.getHierarchyState(h):Ext.rootHierarchyState);e.initHierarchyState(i);if((d=e.componentLayout).initHierarchyState){d.initHierarchyState(i)}if(e.isContainer){e.hierarchyStateInner=g=Ext.Object.chain(i);d=e.layout;if(d&&d.initHierarchyState){d.initHierarchyState(g,i)}if(a){i=g}}}return i},initHierarchyState:function(b){var a=this;if(a.collapsed){b.collapsed=true}if(a.hidden){b.hidden=true}if(a.collapseImmune){b.collapseImmune=true}},getAnchorToXY:function(d,a,c,b){return d.getAnchorXY(a,c,b)},getBorderPadding:function(){return this.el.getBorderPadding()},getLocalX:function(){return this.el.getLocalX()},getLocalXY:function(){return this.el.getLocalXY()},getLocalY:function(){return this.el.getLocalY()},getX:function(){return this.el.getX()},getXY:function(){return this.el.getXY()},getY:function(){return this.el.getY()},setLocalX:function(a){this.el.setLocalX(a)},setLocalXY:function(a,b){this.el.setLocalXY(a,b)},setLocalY:function(a){this.el.setLocalY(a)},setX:function(a,b){this.el.setX(a,b)},setXY:function(b,a){this.el.setXY(b,a)},setY:function(b,a){this.el.setY(b,a)}},function(){var a=this;a.createAlias({on:"addListener",prev:"previousSibling",next:"nextSibling"});Ext.resumeLayouts=function(b){a.resumeLayouts(b)};Ext.suspendLayouts=function(){a.suspendLayouts()};Ext.batchLayouts=function(c,b){a.suspendLayouts();c.call(b);a.resumeLayouts(true)}});Ext.define("Ext.AbstractPlugin",{disabled:false,isPlugin:true,constructor:function(a){this.pluginConfig=a;Ext.apply(this,a)},clonePlugin:function(a){return new this.self(Ext.apply({},a,this.pluginConfig))},setCmp:function(a){this.cmp=a},getCmp:function(){return this.cmp},init:Ext.emptyFn,destroy:Ext.emptyFn,enable:function(){this.disabled=false},disable:function(){this.disabled=true}});Ext.define("Ext.data.flash.BinaryXhr",{statics:{flashPluginActivated:function(){Ext.data.flash.BinaryXhr.flashPluginActive=true;Ext.data.flash.BinaryXhr.flashPlugin=document.getElementById("ext-flash-polyfill");Ext.globalEvents.fireEvent("flashready")},flashPluginActive:false,flashPluginInjected:false,connectionIndex:1,liveConnections:{},flashPlugin:null,onFlashStateChange:function(d,c,b){var a;a=this.liveConnections[Number(d)];if(a){a.onFlashStateChange(c,b)}},registerConnection:function(b){var a=this.connectionIndex;this.conectionIndex=this.connectionIndex+1;this.liveConnections[a]=b;return a},injectFlashPlugin:function(){var g,b,c,a,e=this,d,h;a=document.createElement("img");a.setAttribute("src",window.location.protocol+"//www.adobe.com/images/shared/download_buttons/get_flash_player.gif");a.setAttribute("alt","Get Adobe Flash player");c=document.createElement("a");c.setAttribute("href","http://www.adobe.com/go/getflashplayer");c.appendChild(a);b=document.createElement("p");b.innerHTML="To view this page ensure that Adobe Flash Player version 11.1.0 or greater is installed.";g=document.createElement("div");g.setAttribute("id","ext-flash-polyfill");g.appendChild(b);g.appendChild(a);Ext.getBody().dom.appendChild(g);d=[Ext.Loader.getPath("Ext.data.Connection"),"../../../plugins/flash/swfobject.js"].join("/");h="/plugins/flash/FlashPlugin.swf";if(Ext.flashPluginPath){h=Ext.flashPluginPath}Ext.Loader.loadScript({url:d,onLoad:function(){var j="11.4.0";var l="playerProductInstall.swf";var i={};var m={};m.quality="high";m.bgcolor="#ffffff";m.allowscriptaccess="sameDomain";m.allowfullscreen="true";var k={};k.id="ext-flash-polyfill";k.name="polyfill";k.align="middle";swfobject.embedSWF(h,"ext-flash-polyfill","0","0",j,l,i,m,k)},onError:function(){},scope:e});Ext.globalEvents.addEvents("flashready");Ext.data.flash.BinaryXhr.flashPluginInjected=true}},readyState:0,status:0,statusText:"",responseBytes:null,javascriptId:null,constructor:function(a){if(!Ext.data.flash.BinaryXhr.flashPluginInjected){Ext.data.flash.BinaryXhr.injectFlashPlugin()}var b=this;Ext.apply(b,a);b.requestHeaders={}},abort:function(){var a=this;if(a.readyState==4){return}a.aborted=true;if(!Ext.data.flash.BinaryXhr.flashPluginActive){Ext.globalEvents.removeListener("flashready",a.onFlashReady,a);return}Ext.data.flash.BinaryXhr.flashPlugin.abortRequest(a.javascriptId);delete Ext.data.flash.BinaryXhr.liveConnections[a.javascriptId]},getAllResponseHeaders:function(){var a=[];Ext.Object.each(this.responseHeaders,function(b,c){a.push(b+": "+c)});return a.join("\x0d\x0a")},getResponseHeader:function(b){var a=this.responseHeaders;return(a&&a[b])||null},open:function(g,c,d,a,b){var e=this;e.method=g;e.url=c;e.async=d!==false;e.user=a;e.password=b},overrideMimeType:function(a){this.mimeType=a},send:function(a){var b=this;b.body=a;if(!Ext.data.flash.BinaryXhr.flashPluginActive){Ext.globalEvents.addListener("flashready",b.onFlashReady,b)}else{this.onFlashReady()}},onFlashReady:function(){var c=this,b,a;c.javascriptId=Ext.data.flash.BinaryXhr.registerConnection(c);b={method:c.method,url:c.url,user:c.user,password:c.password,mimeType:c.mimeType,requestHeaders:c.requestHeaders,body:c.body,javascriptId:c.javascriptId};a=Ext.data.flash.BinaryXhr.flashPlugin.postBinary(b)},setReadyState:function(b){var a=this;if(a.readyState!=b){a.readyState=b;a.onreadystatechange()}},setRequestHeader:function(b,a){this.requestHeaders[b]=a},onreadystatechange:Ext.emptyFn,parseData:function(b){var a=this;this.status=b.status||0;a.responseHeaders={};if(a.mimeType){a.responseHeaders["content-type"]=a.mimeType}if(b.reason=="complete"){this.responseBytes=b.data;a.responseHeaders["content-length"]=b.data.length}else{if(b.reason=="error"||b.reason=="securityError"){this.statusText=b.text;a.responseHeaders["content-length"]=0}}},onFlashStateChange:function(c,b){var a=this;if(c==4){a.parseData(b);delete Ext.data.flash.BinaryXhr.liveConnections[a.javascriptId]}a.setReadyState(c)}});Ext.define("Ext.data.Connection",{mixins:{observable:Ext.util.Observable},statics:{requestId:0},url:null,async:true,method:null,username:"",password:"",disableCaching:true,withCredentials:false,binary:false,cors:false,isXdr:false,defaultXdrContentType:"text/plain",disableCachingParam:"_dc",timeout:30000,useDefaultHeader:true,defaultPostHeader:"application/x-www-form-urlencoded; charset=UTF-8",useDefaultXhrHeader:true,defaultXhrHeader:"XMLHttpRequest",constructor:function(a){a=a||{};Ext.apply(this,a);this.requests={};this.mixins.observable.constructor.call(this)},request:function(k){k=k||{};var g=this,j=k.scope||window,e=k.username||g.username,h=k.password||g.password||"",b,c,d,a,i;if(g.fireEvent("beforerequest",g,k)!==false){c=g.setOptions(k,j);if(g.isFormUpload(k)){g.upload(k.form,c.url,c.data,k);return null}if(k.autoAbort||g.autoAbort){g.abort()}b=k.async!==false?(k.async||g.async):false;i=g.openRequest(k,c,b,e,h);if(!g.isXdr){a=g.setupHeaders(i,k,c.data,c.params)}d={id:++Ext.data.Connection.requestId,xhr:i,headers:a,options:k,async:b,binary:k.binary||g.binary,timeout:setTimeout(function(){d.timedout=true;g.abort(d)},k.timeout||g.timeout)};g.requests[d.id]=d;g.latestId=d.id;if(b){if(!g.isXdr){i.onreadystatechange=Ext.Function.bind(g.onStateChange,g,[d])}}if(g.isXdr){g.processXdrRequest(d,i)}i.send(c.data);if(!b){return g.onComplete(d)}return d}else{Ext.callback(k.callback,k.scope,[k,undefined,undefined]);return null}},processXdrRequest:function(b,c){var a=this;delete b.headers;b.contentType=b.options.contentType||a.defaultXdrContentType;c.onload=Ext.Function.bind(a.onStateChange,a,[b,true]);c.onerror=c.ontimeout=Ext.Function.bind(a.onStateChange,a,[b,false])},processXdrResponse:function(a,b){a.getAllResponseHeaders=function(){return[]};a.getResponseHeader=function(){return""};a.contentType=b.contentType||this.defaultXdrContentType},upload:function(b,g,s,e){b=Ext.getDom(b);e=e||{};var n=Ext.id(),l=document.createElement("iframe"),c=[],d="multipart/form-data",r={target:b.target,method:b.method,encoding:b.encoding,enctype:b.enctype,action:b.action},a=function(h,u){i=document.createElement("input");Ext.fly(i).set({type:"hidden",value:u,name:h});b.appendChild(i);c.push(i)},i,k,p,t,o,j,m,q;Ext.fly(l).set({id:n,name:n,cls:Ext.baseCSSPrefix+"hide-display",src:Ext.SSL_SECURE_URL});document.body.appendChild(l);if(document.frames){document.frames[n].name=n}Ext.fly(b).set({target:n,method:"POST",enctype:d,encoding:d,action:g||r.action});if(s){k=Ext.Object.fromQueryString(s)||{};for(t in k){if(k.hasOwnProperty(t)){p=k[t];if(Ext.isArray(p)){o=p.length;for(j=0;j<o;j++){a(t,p[j])}}else{a(t,p)}}}}Ext.fly(l).on("load",Ext.Function.bind(this.onUploadComplete,this,[l,e]),null,{single:!Ext.isOpera});b.submit();Ext.fly(b).set(r);m=c.length;for(q=0;q<m;q++){Ext.removeNode(c[q])}},onUploadComplete:function(a,k){var g=this,b={responseText:"",responseXML:null},i,j,h,c;try{h=a.contentWindow.document||a.contentDocument||window.frames[a.id].document;if(h){if(Ext.isOpera&&h.location=="about:blank"){return}if(h.body){if((c=h.body.firstChild)&&/pre/i.test(c.tagName)){b.responseText=c.textContent}else{if((c=h.getElementsByTagName("textarea")[0])){b.responseText=c.value}else{b.responseText=h.body.textContent||h.body.innerText}}}b.responseXML=h.XMLDocument||h;i=k.success;j=true}}catch(d){b.responseText='{success:false,message:"'+Ext.String.trim(d.message||d.description)+'"}';i=k.failure;j=false}g.fireEvent("requestcomplete",g,b,k);Ext.callback(i,k.scope,[b,k]);Ext.callback(k.callback,k.scope,[k,j,b]);setTimeout(function(){Ext.removeNode(a)},100)},isFormUpload:function(a){var b=this.getForm(a);if(b){return(a.isUpload||(/multipart\/form-data/i).test(b.getAttribute("enctype")))}return false},getForm:function(a){return Ext.getDom(a.form)||null},setOptions:function(l,k){var i=this,e=l.params||{},h=i.extraParams,d=l.urlParams,c=l.url||i.url,j=l.jsonData,b,a,g;if(Ext.isFunction(e)){e=e.call(k,l)}if(Ext.isFunction(c)){c=c.call(k,l)}c=this.setupUrl(l,c);g=l.rawData||l.binaryData||l.xmlData||j||null;if(j&&!Ext.isPrimitive(j)){g=Ext.encode(g)}if(l.binaryData){if(i.nativeBinaryPostSupport()){g=(new Uint8Array(l.binaryData));if((Ext.isChrome&&Ext.chromeVersion<22)||Ext.isSafari||Ext.isGecko){g=g.buffer}}}if(Ext.isObject(e)){e=Ext.Object.toQueryString(e)}if(Ext.isObject(h)){h=Ext.Object.toQueryString(h)}e=e+((h)?((e)?"&":"")+h:"");d=Ext.isObject(d)?Ext.Object.toQueryString(d):d;e=this.setupParams(l,e);b=(l.method||i.method||((e||g)?"POST":"GET")).toUpperCase();this.setupMethod(l,b);a=l.disableCaching!==false?(l.disableCaching||i.disableCaching):false;if(b==="GET"&&a){c=Ext.urlAppend(c,(l.disableCachingParam||i.disableCachingParam)+"="+(new Date().getTime()))}if((b=="GET"||g)&&e){c=Ext.urlAppend(c,e);e=null}if(d){c=Ext.urlAppend(c,d)}return{url:c,method:b,data:g||e||null}},setupUrl:function(b,a){var c=this.getForm(b);if(c){a=a||c.action}return a},setupParams:function(a,d){var c=this.getForm(a),b;if(c&&!this.isFormUpload(a)){b=Ext.Element.serializeForm(c);d=d?(d+"&"+b):b}return d},setupMethod:function(a,b){if(this.isFormUpload(a)){return"POST"}return b},setupHeaders:function(m,n,d,c){var i=this,b=Ext.apply({},n.headers||{},i.defaultHeaders||{}),l=i.defaultPostHeader,j=n.jsonData,a=n.xmlData,k,g;if(!b["Content-Type"]&&(d||c)){if(d){if(n.rawData){l="text/plain"}else{if(a&&Ext.isDefined(a)){l="text/xml"}else{if(j&&Ext.isDefined(j)){l="application/json"}}}}b["Content-Type"]=l}if(i.useDefaultXhrHeader&&!b["X-Requested-With"]){b["X-Requested-With"]=i.defaultXhrHeader}try{for(k in b){if(b.hasOwnProperty(k)){g=b[k];m.setRequestHeader(k,g)}}}catch(h){i.fireEvent("exception",k,g)}return b},newRequest:function(a){var b=this,c;if(a.binaryData){if(b.nativeBinaryPostSupport()){c=this.getXhrInstance()}else{c=new Ext.data.flash.BinaryXhr()}}else{if((a.cors||b.cors)&&Ext.isIE&&Ext.ieVersion<=9){c=b.getXdrInstance();b.isXdr=true}else{c=b.getXhrInstance()}}return c},openRequest:function(c,a,d,h,b){var e=this,g=e.newRequest(c);if(h){g.open(a.method,a.url,d,h,b)}else{if(e.isXdr){g.open(a.method,a.url)}else{g.open(a.method,a.url,d)}}if(c.binary||e.binary){if(window.Uint8Array){g.responseType="arraybuffer"}else{if(g.overrideMimeType){g.overrideMimeType("text/plain; charset=x-user-defined")}}}if(c.withCredentials||e.withCredentials){g.withCredentials=true}return g},getXdrInstance:function(){var a;if(Ext.ieVersion>=8){a=new XDomainRequest()}else{Ext.Error.raise({msg:"Your browser does not support CORS"})}return a},getXhrInstance:(function(){var b=[function(){return new XMLHttpRequest()},function(){return new ActiveXObject("MSXML2.XMLHTTP.3.0")},function(){return new ActiveXObject("MSXML2.XMLHTTP")},function(){return new ActiveXObject("Microsoft.XMLHTTP")}],c=0,a=b.length,g;for(;c<a;++c){try{g=b[c];g();break}catch(d){}}return g}()),isLoading:function(a){if(!a){a=this.getLatest()}if(!(a&&a.xhr)){return false}var b=a.xhr.readyState;return((a.xhr instanceof Ext.data.flash.BinaryXhr)&&b!=4)||!(b===0||b==4)},abort:function(b){var a=this,d;if(!b){b=a.getLatest()}if(b&&a.isLoading(b)){d=b.xhr;try{d.onreadystatechange=null}catch(c){d.onreadystatechange=Ext.emptyFn}d.abort();a.clearTimeout(b);if(!b.timedout){b.aborted=true}a.onComplete(b);a.cleanup(b)}},abortAll:function(){var b=this.requests,a;for(a in b){if(b.hasOwnProperty(a)){this.abort(b[a])}}},getLatest:function(){var b=this.latestId,a;if(b){a=this.requests[b]}return a||null},onStateChange:function(c,a){var b=this;if((c.xhr&&c.xhr.readyState==4)||b.isXdr){b.clearTimeout(c);b.onComplete(c,a);b.cleanup(c);Ext.EventManager.idleEvent.fire()}},clearTimeout:function(a){clearTimeout(a.timeout);delete a.timeout},cleanup:function(a){a.xhr=null;delete a.xhr},onComplete:function(h,d){var g=this,c=h.options,a,j,b;try{a=g.parseStatus(h.xhr.status)}catch(i){a={success:false,isException:false}}j=g.isXdr?d:a.success;if(j){b=g.createResponse(h);g.fireEvent("requestcomplete",g,b,c);Ext.callback(c.success,c.scope,[b,c])}else{if(a.isException||h.aborted||h.timedout){b=g.createException(h)}else{b=g.createResponse(h)}g.fireEvent("requestexception",g,b,c);Ext.callback(c.failure,c.scope,[b,c])}Ext.callback(c.callback,c.scope,[c,j,b]);delete g.requests[h.id];return b},parseStatus:function(a){a=a==1223?204:a;var c=(a>=200&&a<300)||a==304,b=false;if(!c){switch(a){case 12002:case 12029:case 12030:case 12031:case 12152:case 13030:b=true;break}}return{success:c,isException:b}},createResponse:function(e){var i=this,k=e.xhr,c=i.isXdr,b={},l=c?[]:k.getAllResponseHeaders().replace(/\r\n/g,"\n").split("\n"),h=l.length,m,g,j,d,a;while(h--){m=l[h];g=m.indexOf(":");if(g>=0){j=m.substr(0,g).toLowerCase();if(m.charAt(g+1)==" "){++g}b[j]=m.substr(g+1)}}e.xhr=null;delete e.xhr;d={request:e,requestId:e.id,status:k.status,statusText:k.statusText,getResponseHeader:function(n){return b[n.toLowerCase()]},getAllResponseHeaders:function(){return b}};if(c){i.processXdrResponse(d,k)}if(e.binary){d.responseBytes=i.getByteArray(k)}else{d.responseText=k.responseText;d.responseXML=k.responseXML}k=null;return d},createException:function(a){return{request:a,requestId:a.id,status:a.aborted?-1:0,statusText:a.aborted?"transaction aborted":"communication failure",aborted:a.aborted,timedout:a.timedout}},getByteArray:function(k){var c=k.response,j=k.responseBody,b,g,a,d;if(k instanceof Ext.data.flash.BinaryXhr){b=k.responseBytes}else{if(window.Uint8Array){b=c?new Uint8Array(c):[]}else{if(Ext.isIE9p){try{b=new VBArray(j).toArray()}catch(h){b=[]}}else{if(Ext.isIE){if(!this.self.vbScriptInjected){this.injectVBScript()}getIEByteArray(k.responseBody,b=[])}else{b=[];g=k.responseText;a=g.length;for(d=0;d<a;d++){b.push(g.charCodeAt(d)&255)}}}}}return b},injectVBScript:function(){var a=document.createElement("script");a.type="text/vbscript";a.text=["Function getIEByteArray(byteArray, out)","Dim len, i","len = LenB(byteArray)","For i = 1 to len","out.push(AscB(MidB(byteArray, i, 1)))","Next","End Function"].join("\n");Ext.getHead().dom.appendChild(a);this.self.vbScriptInjected=true},nativeBinaryPostSupport:function(){return Ext.isChrome||(Ext.isSafari&&Ext.isDefined(window.Uint8Array))||(Ext.isGecko&&Ext.isDefined(window.Uint8Array))}});Ext.define("Ext.Ajax",{extend:Ext.data.Connection,singleton:true,autoAbort:false});Ext.define("Ext.util.Floating",{focusOnToFront:true,shadow:"sides",constrain:false,constructor:function(b){var a=this;a.fixed=a.fixed&&!(Ext.isIE6||Ext.isIEQuirks);a.el=new Ext.dom.Layer(Ext.apply({hideMode:a.hideMode,hidden:a.hidden,shadow:(typeof a.shadow!="undefined")?a.shadow:"sides",shadowOffset:a.shadowOffset,constrain:false,fixed:a.fixed,shim:(a.shim===false)?false:undefined},a.floating),b);if(a.modal&&!(Ext.FocusManager&&Ext.FocusManager.enabled)){a.mon(a.el,{keydown:a.onKeyDown,scope:a})}a.mon(a.el,{mousedown:a.onMouseDown,scope:a});a.floating=true;a.registerWithOwnerCt();a.initHierarchyEvents()},initHierarchyEvents:function(){var b=this,a=this.syncHidden;if(!b.hasHierarchyEventListeners){b.mon(b.hierarchyEventSource,{hide:a,collapse:a,show:a,expand:a,added:a,scope:b});b.hasHierarchyEventListeners=true}},registerWithOwnerCt:function(){var c=this,b=c.ownerCt,a=c.zIndexParent;if(a){a.unregisterFloatingItem(c)}a=c.zIndexParent=c.up("[floating]");c.setFloatParent(b||a);delete c.ownerCt;if(a){a.registerFloatingItem(c)}else{Ext.WindowManager.register(c)}},onKeyDown:function(d){var c=this,a,h,g,b;if(d.getKey()==Ext.EventObject.TAB){a=d.shiftKey;h=c.el.query(":focusable");g=h[0];b=h[h.length-1];if(g&&b&&d.target===(a?g:b)){d.stopEvent();(a?b:g).focus(false,true)}}},onMouseDown:function(a){if(this.floating){this.toFront(!!a.getTarget(":focusable"))}},setFloatParent:function(b){var a=this;a.floatParent=b;if((a.constrain||a.constrainHeader)&&!a.constrainTo){a.constrainTo=b?b.getTargetEl():a.container}},onAfterFloatLayout:function(){this.syncShadow()},syncHidden:function(){var c=this,d=c.hidden||!c.rendered,a=c.hierarchicallyHidden=c.isHierarchicallyHidden(),b=c.pendingShow;if(d!==a){if(a){c.hide();c.pendingShow=true}else{if(b){delete c.pendingShow;if(b.length){c.show.apply(c,b)}else{c.show()}}}}},setZIndex:function(a){var b=this;b.el.setZIndex(a);a+=10;if(b.floatingDescendants){a=Math.floor(b.floatingDescendants.setBase(a)/100)*100+10000}return a},doConstrain:function(a){var b=this,c=b.calculateConstrainedPosition(a,null,true);if(c){b.setPosition(c)}},toFront:function(c){var b=this,a=b.zIndexParent,d=b.preventFocusOnActivate;if(a&&b.bringParentToFront!==false){a.toFront(true)}if(!Ext.isDefined(c)){c=!b.focusOnToFront}if(c){b.preventFocusOnActivate=true}if(b.zIndexManager.bringToFront(b,c)){if(!c){b.focus(false,true)}}b.preventFocusOnActivate=d;return b},setActive:function(b,c){var a=this;if(b){if(a.el.shadow&&!a.maximized){a.el.enableShadow(true)}if(!a.preventFocusOnActivate){a.focus(false,true)}a.fireEvent("activate",a)}else{if(a.isWindow&&(c&&c.isWindow)&&a.hideShadowOnDeactivate){a.el.disableShadow()}a.fireEvent("deactivate",a)}},toBack:function(){this.zIndexManager.sendToBack(this);return this},center:function(){var a=this,b;if(a.isVisible()){b=a.getAlignToXY(a.container,"c-c");a.setPagePosition(b)}else{a.needsCenter=true}return a},onFloatShow:function(){if(this.needsCenter){this.center()}delete this.needsCenter},syncShadow:function(){if(this.floating){this.el.sync(true)}},fitContainer:function(c){var g=this,e=g.floatParent,b=e?e.getTargetEl():g.container,a=b.getViewSize(false),d=e||(b.dom!==document.body)?[0,0]:b.getXY();a.x=d[0];a.y=d[1];g.setBox(a,c)}});Ext.define("Ext.Component",{alias:["widget.component","widget.box"],extend:Ext.AbstractComponent,mixins:{floating:Ext.util.Floating},statics:{DIRECTION_TOP:"top",DIRECTION_RIGHT:"right",DIRECTION_BOTTOM:"bottom",DIRECTION_LEFT:"left",VERTICAL_DIRECTION_Re:/^(?:top|bottom)$/,INVALID_ID_CHARS_Re:/[\.,\s]/g},resizeHandles:"all",floating:false,defaultAlign:"tl-bl?",toFrontOnShow:true,hideMode:"display",offsetsCls:Ext.baseCSSPrefix+"hide-offsets",bubbleEvents:[],defaultComponentLayoutType:"autocomponent",constructor:function(a){var b=this;a=a||{};if(a.initialConfig){if(a.isAction){b.baseAction=a}a=a.initialConfig}else{if(a.tagName||a.dom||Ext.isString(a)){a={applyTo:a,id:a.id||a}}}b.callParent([a]);if(b.baseAction){b.baseAction.addComponent(b)}},initComponent:function(){var a=this;a.callParent();if(a.listeners){a.on(a.listeners);a.listeners=null}a.enableBubble(a.bubbleEvents)},afterRender:function(){var a=this;a.callParent();if(!(a.x&&a.y)&&(a.pageX||a.pageY)){a.setPagePosition(a.pageX,a.pageY)}},setAutoScroll:function(a){var b=this;b.autoScroll=!!a;if(b.rendered){b.getOverflowEl().setStyle(b.getOverflowStyle())}b.updateLayout();return b},setOverflowXY:function(b,a){var c=this,d=arguments.length;if(d){c.overflowX=b||"";if(d>1){c.overflowY=a||""}}if(c.rendered){c.getOverflowEl().setStyle(c.getOverflowStyle())}c.updateLayout();return c},beforeRender:function(){var b=this,c=b.floating,a;if(c){b.addCls(Ext.baseCSSPrefix+"layer");a=c.cls;if(a){b.addCls(a)}}return b.callParent()},afterComponentLayout:function(){this.callParent(arguments);if(this.floating){this.onAfterFloatLayout()}},makeFloating:function(a){this.mixins.floating.constructor.call(this,a)},wrapPrimaryEl:function(a){if(this.floating){this.makeFloating(a)}else{this.callParent(arguments)}},initResizable:function(a){var b=this;a=Ext.apply({target:b,dynamic:false,constrainTo:b.constrainTo||(b.floatParent?b.floatParent.getTargetEl():null),handles:b.resizeHandles},a);a.target=b;b.resizer=new Ext.resizer.Resizer(a)},getDragEl:function(){return this.el},initDraggable:function(){var c=this,a=(c.resizer&&c.resizer.el!==c.el)?c.resizerComponent=new Ext.Component({el:c.resizer.el,rendered:true,container:c.container}):c,b=Ext.applyIf({el:a.getDragEl(),constrainTo:(c.constrain||c.draggable.constrain)?(c.constrainTo||(c.floatParent?c.floatParent.getTargetEl():c.container)):undefined},c.draggable);if(c.constrain||c.constrainDelegate){b.constrain=c.constrain;b.constrainDelegate=c.constrainDelegate}c.dd=new Ext.util.ComponentDragger(a,b)},scrollBy:function(b,a,c){var d;if((d=this.getTargetEl())&&d.dom){d.scrollBy.apply(d,arguments)}},setLoading:function(c,d){var b=this,a={target:b};if(b.rendered){Ext.destroy(b.loadMask);b.loadMask=null;if(c!==false&&!b.collapsed){if(Ext.isObject(c)){Ext.apply(a,c)}else{if(Ext.isString(c)){a.msg=c}}if(d){Ext.applyIf(a,{useTargetEl:true})}b.loadMask=new Ext.LoadMask(a);b.loadMask.show()}}return b.loadMask},beforeSetPosition:function(){var b=this,c=b.callParent(arguments),a;if(c){a=b.adjustPosition(c.x,c.y);c.x=a.x;c.y=a.y}return c||null},afterSetPosition:function(b,a){this.onPosition(b,a);this.fireEvent("move",this,b,a)},showAt:function(a,d,b){var c=this;if(!c.rendered&&(c.autoRender||c.floating)){c.x=a;c.y=d;return c.show()}if(c.floating){c.setPosition(a,d,b)}else{c.setPagePosition(a,d,b)}c.show()},showBy:function(b,d,c){var a=this;if(a.floating&&b){a.show();if(a.rendered&&!a.hidden){a.alignTo(b,d||a.defaultAlign,c)}}return a},setPagePosition:function(a,g,b){var c=this,d,e;if(Ext.isArray(a)){g=a[1];a=a[0]}c.pageX=a;c.pageY=g;if(c.floating){if(c.isContainedFloater()){e=c.floatParent.getTargetEl().getViewRegion();if(Ext.isNumber(a)&&Ext.isNumber(e.left)){a-=e.left}if(Ext.isNumber(g)&&Ext.isNumber(e.top)){g-=e.top}}else{d=c.el.translateXY(a,g);a=d.x;g=d.y}c.setPosition(a,g,b)}else{d=c.el.translateXY(a,g);c.setPosition(d.x,d.y,b)}return c},isContainedFloater:function(){return(this.floating&&this.floatParent)},updateBox:function(a){this.setSize(a.width,a.height);this.setPagePosition(a.x,a.y);return this},getOuterSize:function(){var a=this.el;return{width:a.getWidth()+a.getMargin("lr"),height:a.getHeight()+a.getMargin("tb")}},adjustPosition:function(a,d){var b=this,c;if(b.isContainedFloater()){c=b.floatParent.getTargetEl().getViewRegion();a+=c.left;d+=c.top}return{x:a,y:d}},getPosition:function(a){var b=this,d,c=b.isContainedFloater(),e;if((a===true)&&!c){return[b.getLocalX(),b.getLocalY()]}d=b.getXY();if((a===true)&&c){e=b.floatParent.getTargetEl().getViewRegion();d[0]-=e.left;d[1]-=e.top}return d},getId:function(){var a=this,b;if(!a.id){b=a.getXType();if(b){b=b.replace(Ext.Component.INVALID_ID_CHARS_Re,"-")}else{b=Ext.name.toLowerCase()+"-comp"}a.id=b+"-"+a.getAutoId()}return a.id},show:function(d,a,b){var c=this,e=c.rendered;if(c.hierarchicallyHidden||(c.floating&&!e&&c.isHierarchicallyHidden())){if(!e){c.initHierarchyEvents()}if(arguments.length>1){arguments[0]=null;c.pendingShow=arguments}else{c.pendingShow=true}}else{if(e&&c.isVisible()){if(c.toFrontOnShow&&c.floating){c.toFront()}}else{if(c.fireEvent("beforeshow",c)!==false){c.hidden=false;delete this.getHierarchyState().hidden;if(!e&&(c.autoRender||c.floating)){c.doAutoRender();e=c.rendered}if(e){c.beforeShow();c.onShow.apply(c,arguments);c.afterShow.apply(c,arguments)}}else{c.onShowVeto()}}}return c},onShowVeto:Ext.emptyFn,beforeShow:Ext.emptyFn,onShow:function(){var a=this;a.el.show();a.callParent(arguments);if(a.floating){if(a.maximized){a.fitContainer()}else{if(a.constrain){a.doConstrain()}}}},getAnimateTarget:function(a){a=a||this.animateTarget;if(a){a=a.isComponent?a.getEl():Ext.get(a)}return a||null},afterShow:function(h,b,e){var g=this,i=g.el,a,c,d;h=g.getAnimateTarget(h);if(!g.ghost){h=null}if(h){c={x:i.getX(),y:i.getY(),width:i.dom.offsetWidth,height:i.dom.offsetHeight};a={x:h.getX(),y:h.getY(),width:h.dom.offsetWidth,height:h.dom.offsetHeight};i.addCls(g.offsetsCls);d=g.ghost();d.el.stopAnimation();d.setX(-10000);g.ghostBox=c;d.el.animate({from:a,to:c,listeners:{afteranimate:function(){delete d.componentLayout.lastComponentSize;g.unghost();delete g.ghostBox;i.removeCls(g.offsetsCls);g.onShowComplete(b,e)}}})}else{g.onShowComplete(b,e)}g.fireHierarchyEvent("show")},onShowComplete:function(a,b){var c=this;if(c.floating){c.toFront();c.onFloatShow()}Ext.callback(a,b||c);c.fireEvent("show",c);delete c.hiddenByLayout},hide:function(e,b,c){var d=this,a;if(d.pendingShow){delete d.pendingShow}if(!(d.rendered&&!d.isVisible())){a=(d.fireEvent("beforehide",d)!==false);if(d.hierarchicallyHidden||a){d.hidden=true;d.getHierarchyState().hidden=true;if(d.rendered){d.onHide.apply(d,arguments)}}}return d},onHide:function(i,a,e){var g=this,c,d,b,h=Ext.Element.getActiveElement();if(h===g.el||g.el.contains(h)){Ext.fly(h).blur()}i=g.getAnimateTarget(i);if(!g.ghost){i=null}if(i){b={x:i.getX(),y:i.getY(),width:i.dom.offsetWidth,height:i.dom.offsetHeight};c=g.ghost();c.el.stopAnimation();d=g.getSize();c.el.animate({to:b,listeners:{afteranimate:function(){delete c.componentLayout.lastComponentSize;c.el.hide();c.el.setSize(d);g.afterHide(a,e)}}})}g.el.hide();if(!i){g.afterHide(a,e)}},afterHide:function(a,b){var c=this;delete c.hiddenByLayout;Ext.AbstractComponent.prototype.onHide.call(c);Ext.callback(a,b||c);c.fireEvent("hide",c);c.fireHierarchyEvent("hide")},onDestroy:function(){var a=this;if(a.rendered){Ext.destroy(a.dd,a.resizer,a.proxy,a.proxyWrap,a.resizerComponent)}delete a.focusTask;a.callParent()},deleteMembers:function(){var b=arguments,a=b.length,c=0;for(;c<a;++c){delete this[b[c]]}},focus:function(e,c){var d=this,a,g,b;if(c){if(!d.focusTask){d.self.prototype.focusTask=new Ext.util.DelayedTask(d.focus)}d.focusTask.delay(Ext.isNumber(c)?c:10,null,d,[e,false]);return d}if(d.focusTask){d.focusTask.cancel()}if(d.rendered&&!d.isDestroyed&&d.isVisible(true)&&(a=d.getFocusEl())){if(a.isComponent){return a.focus(e,c)}if((g=a.dom)){if(a.needsTabIndex()){g.tabIndex=-1}if(d.floating){b=d.container.dom.scrollTop}a.focus();if(e===true){g.select()}}if(d.floating){d.toFront(true);if(b!==undefined){d.container.dom.scrollTop=b}}}return d},cancelFocus:function(){var a=this.focusTask;if(a){a.cancel()}},blur:function(){var a;if(this.rendered&&(a=this.getFocusEl())){a.blur()}return this},getEl:function(){return this.el},getResizeEl:function(){return this.el},getPositionEl:function(){return this.el},getActionEl:function(){return this.el},getVisibilityEl:function(){return this.el},getRefOwner:function(){return this.ownerCt||this.floatParent},getBubbleTarget:function(){return this.getRefOwner()},getContentTarget:function(){return this.el},cloneConfig:function(c){c=c||{};var d=c.id||Ext.id(),a=Ext.applyIf(c,this.initialConfig),b;a.id=d;b=Ext.getClass(this);return new b(a)},getXType:function(){return this.self.xtype},findParentBy:function(a){var b;for(b=this.getBubbleTarget();b&&!a(b,this);b=b.getBubbleTarget()){}return b||null},findParentByType:function(a){return Ext.isFunction(a)?this.findParentBy(function(b){return b.constructor===a}):this.up(a)},bubble:function(c,b,a){var d=this;while(d){if(c.apply(b||d,a||[d])===false){break}d=d.getBubbleTarget()}return this},getProxy:function(){var a=this,b;if(!a.proxy){b=Ext.getBody();a.proxy=a.el.createProxy(Ext.baseCSSPrefix+"proxy-el",b,true)}return a.proxy},fireHierarchyEvent:function(a){this.hierarchyEventSource.fireEvent(a,this)},onAdded:function(){this.callParent(arguments);if(this.hierarchyEventSource.hasListeners.added){this.fireHierarchyEvent("added")}}},function(){this.hierarchyEventSource=this.prototype.hierarchyEventSource=new Ext.util.Observable({events:{hide:true,show:true,collapse:true,expand:true,added:true}})});Ext.define("Ext.ElementLoader",{mixins:{observable:Ext.util.Observable},statics:{Renderer:{Html:function(a,b,c){a.getTarget().update(b.responseText,c.scripts===true);return true}}},url:null,params:null,baseParams:null,autoLoad:false,target:null,loadMask:false,ajaxOptions:null,scripts:false,isLoader:true,constructor:function(b){var c=this,a;b=b||{};Ext.apply(c,b);c.setTarget(c.target);c.addEvents("beforeload","exception","load");c.mixins.observable.constructor.call(c);if(c.autoLoad){a=c.autoLoad;if(a===true){a={}}c.load(a)}},setTarget:function(b){var a=this;b=Ext.get(b);if(a.target&&a.target!=b){a.abort()}a.target=b},getTarget:function(){return this.target||null},abort:function(){var a=this.active;if(a!==undefined){Ext.Ajax.abort(a.request);if(a.mask){this.removeMask()}delete this.active}},removeMask:function(){this.target.unmask()},addMask:function(a){this.target.mask(a===true?null:a)},load:function(c){c=Ext.apply({},c);var e=this,a=Ext.isDefined(c.loadMask)?c.loadMask:e.loadMask,g=Ext.apply({},c.params),b=Ext.apply({},c.ajaxOptions),h=c.callback||e.callback,d=c.scope||e.scope||e;Ext.applyIf(b,e.ajaxOptions);Ext.applyIf(c,b);Ext.applyIf(g,e.params);Ext.apply(g,e.baseParams);Ext.applyIf(c,{url:e.url});Ext.apply(c,{scope:e,params:g,callback:e.onComplete});if(e.fireEvent("beforeload",e,c)===false){return}if(a){e.addMask(a)}e.active={options:c,mask:a,scope:d,callback:h,success:c.success||e.success,failure:c.failure||e.failure,renderer:c.renderer||e.renderer,scripts:Ext.isDefined(c.scripts)?c.scripts:e.scripts};e.active.request=Ext.Ajax.request(c);e.setOptions(e.active,c)},setOptions:Ext.emptyFn,onComplete:function(b,g,a){var d=this,e=d.active,c;if(e){c=e.scope;if(g){g=d.getRenderer(e.renderer).call(d,d,a,e)!==false}if(g){Ext.callback(e.success,c,[d,a,b]);d.fireEvent("load",d,a,b)}else{Ext.callback(e.failure,c,[d,a,b]);d.fireEvent("exception",d,a,b)}Ext.callback(e.callback,c,[d,g,a,b]);if(e.mask){d.removeMask()}}delete d.active},getRenderer:function(a){if(Ext.isFunction(a)){return a}return this.statics().Renderer.Html},startAutoRefresh:function(a,b){var c=this;c.stopAutoRefresh();c.autoRefresh=setInterval(function(){c.load(b)},a)},stopAutoRefresh:function(){clearInterval(this.autoRefresh);delete this.autoRefresh},isAutoRefreshing:function(){return Ext.isDefined(this.autoRefresh)},destroy:function(){var a=this;a.stopAutoRefresh();delete a.target;a.abort();a.clearListeners()}});Ext.define("Ext.ComponentLoader",{extend:Ext.ElementLoader,statics:{Renderer:{Data:function(a,b,d){var g=true;try{a.getTarget().update(Ext.decode(b.responseText))}catch(c){g=false}return g},Component:function(a,c,h){var i=true,g=a.getTarget(),b=[];try{b=Ext.decode(c.responseText)}catch(d){i=false}if(i){g.suspendLayouts();if(h.removeAll){g.removeAll()}g.add(b);g.resumeLayouts(true)}return i}}},target:null,loadMask:false,renderer:"html",setTarget:function(b){var a=this;if(Ext.isString(b)){b=Ext.getCmp(b)}if(a.target&&a.target!=b){a.abort()}a.target=b},removeMask:function(){this.target.setLoading(false)},addMask:function(a){this.target.setLoading(a)},setOptions:function(b,a){b.removeAll=Ext.isDefined(a.removeAll)?a.removeAll:this.removeAll},getRenderer:function(b){if(Ext.isFunction(b)){return b}var a=this.statics().Renderer;switch(b){case"component":return a.Component;case"data":return a.Data;default:return Ext.ElementLoader.Renderer.Html}}});Ext.define("Ext.layout.SizeModel",{constructor:function(c){var e=this,d=e.self,a=d.sizeModelsArray,b;Ext.apply(e,c);e[b=e.name]=true;e.fixed=!(e.auto=e.natural||e.shrinkWrap);a[e.ordinal=a.length]=d[b]=d.sizeModels[b]=e},statics:{sizeModelsArray:[],sizeModels:{}},calculated:false,configured:false,constrainedMax:false,constrainedMin:false,natural:false,shrinkWrap:false,calculatedFromConfigured:false,calculatedFromNatural:false,calculatedFromShrinkWrap:false,names:null},function(){var e=this,a=e.sizeModelsArray,c,b,h,g,d;new e({name:"calculated"});new e({name:"configured",names:{width:"width",height:"height"}});new e({name:"natural"});new e({name:"shrinkWrap"});new e({name:"calculatedFromConfigured",configured:true,names:{width:"width",height:"height"}});new e({name:"calculatedFromNatural",natural:true});new e({name:"calculatedFromShrinkWrap",shrinkWrap:true});new e({name:"constrainedMax",configured:true,constrained:true,names:{width:"maxWidth",height:"maxHeight"}});new e({name:"constrainedMin",configured:true,constrained:true,names:{width:"minWidth",height:"minHeight"}});new e({name:"constrainedDock",configured:true,constrained:true,constrainedByMin:true,names:{width:"dockConstrainedWidth",height:"dockConstrainedHeight"}});for(c=0,h=a.length;c<h;++c){d=a[c];d.pairsByHeightOrdinal=g=[];for(b=0;b<h;++b){g.push({width:d,height:a[b]})}}});Ext.define("Ext.layout.Layout",{isLayout:true,initialized:false,running:false,autoSizePolicy:{readsWidth:1,readsHeight:1,setsWidth:0,setsHeight:0},statics:{layoutsByType:{},create:function(g,e){var k=Ext.ClassManager,c=this.layoutsByType,d,h,b,a,i,j;if(!g||typeof g==="string"){i=g||e;b={}}else{if(g.isLayout){return g}else{b=g;i=g.type||e}}if(!(a=c[i])){d="layout."+i;h=k.getNameByAlias(d);if(!h){j=true}a=k.get(h);if(j||!a){return k.instantiateByAlias(d,b||{})}c[i]=a}return new a(b)}},constructor:function(a){var b=this;b.id=Ext.id(null,b.type+"-");Ext.apply(b,a);b.layoutCount=0},beginLayout:Ext.emptyFn,beginLayoutCycle:function(c){var b=this,a=b.context,d;if(b.lastWidthModel!=c.widthModel){if(b.lastWidthModel){d=true}b.lastWidthModel=c.widthModel}if(b.lastHeightModel!=c.heightModel){if(b.lastWidthModel){d=true}b.lastHeightModel=c.heightModel}if(d){(a=c.context).clearTriggers(b,false);a.clearTriggers(b,true);b.triggerCount=0}},finishedLayout:function(a){this.lastWidthModel=a.widthModel;this.lastHeightModel=a.heightModel;this.ownerContext=null},redoLayout:Ext.emptyFn,undoLayout:Ext.emptyFn,getAnimatePolicy:function(){return this.animatePolicy},getItemSizePolicy:function(a){return this.autoSizePolicy},isItemBoxParent:function(a){return false},isItemLayoutRoot:function(d){var c=d.getSizeModel(),b=c.width,a=c.height;if(!d.componentLayout.lastComponentSize&&(b.calculated||a.calculated)){return false}return !b.shrinkWrap&&!a.shrinkWrap},isItemShrinkWrap:function(a){return a.shrinkWrap},isRunning:function(){return !!this.ownerContext},getItemsRenderTree:function(d,b){var h=d.length,e,g,c,a;if(h){a=[];for(e=0;e<h;++e){g=d[e];if(!g.rendered){if(b&&(b[g.id]!==undefined)){c=b[g.id]}else{this.configureItem(g);c=g.getRenderTree();if(b){b[g.id]=c}}if(c){a.push(c)}}}}return a},finishRender:Ext.emptyFn,finishRenderItems:function(e,a){var d=a.length,b,c;for(b=0;b<d;b++){c=a[b];if(c.rendering){c.finishRender(b);this.afterRenderItem(c)}}},renderChildren:function(){var b=this,a=b.getLayoutItems(),c=b.getRenderTarget();b.renderItems(a,c)},renderItems:function(a,g){var e=this,d=a.length,b=0,c;if(d){Ext.suspendLayouts();for(;b<d;b++){c=a[b];if(c&&!c.rendered){e.renderItem(c,g,b)}else{if(!e.isValidParent(c,g,b)){e.moveItem(c,g,b)}else{e.configureItem(c)}}}Ext.resumeLayouts(true)}},isValidParent:function(g,h,b){var c=g.el?g.el.dom:Ext.getDom(g),e=(h&&h.dom)||h,a=c.parentNode,d;if(a){d=a.className;if(d&&d.indexOf(Ext.baseCSSPrefix+"resizable-wrap")!==-1){c=c.parentNode}}if(c&&e){if(typeof b=="number"){b=this.getPositionOffset(b);return c===e.childNodes[b]}return c.parentNode===e}return false},getPositionOffset:function(a){return a},configureItem:function(a){a.ownerLayout=this},renderItem:function(c,d,a){var b=this;if(!c.rendered){b.configureItem(c);c.render(d,a);b.afterRenderItem(c)}},moveItem:function(b,c,a){c=c.dom||c;if(typeof a=="number"){a=c.childNodes[a]}c.insertBefore(b.el.dom,a||null);b.container=Ext.get(c);this.configureItem(b)},onContentChange:function(){this.owner.updateLayout();return true},initLayout:function(){this.initialized=true},setOwner:function(a){this.owner=a},getLayoutItems:function(){return[]},afterRenderItem:Ext.emptyFn,onAdd:Ext.emptyFn,onRemove:Ext.emptyFn,onDestroy:Ext.emptyFn,afterRemove:function(e){var d=this,c=e.el,b=d.owner,a;if(e.rendered){a=[].concat(d.itemCls||[]);if(b.itemCls){a=Ext.Array.push(a,b.itemCls)}if(a.length){c.removeCls(a)}}delete e.ownerLayout},destroy:function(){var a=this,b;if(a.targetCls){b=a.getTarget();if(b){b.removeCls(a.targetCls)}}a.onDestroy()},sortWeightedItems:function(a,d){for(var b=0,c=a.length;b<c;++b){a[b].$i=b}Ext.Array.sort(a,function(g,e){var h=e.weight-g.weight;if(!h){h=g.$i-e.$i;if(g[d]){h=-h}}return h});for(b=0;b<c;++b){delete a[b].$i}}},function(){var a=this;a.prototype.sizeModels=a.sizeModels=Ext.layout.SizeModel.sizeModels});Ext.define("Ext.layout.container.Container",{alias:["layout.container"],extend:Ext.layout.Layout,alternateClassName:"Ext.layout.ContainerLayout",mixins:{elementCt:Ext.util.ElementContainer},type:"container",beginCollapse:Ext.emptyFn,beginExpand:Ext.emptyFn,animatePolicy:null,childEls:["overflowPadderEl"],renderTpl:["{%this.renderBody(out,values)%}"],usesContainerHeight:true,usesContainerWidth:true,usesHeight:true,usesWidth:true,constructor:function(){this.callParent(arguments);this.mixins.elementCt.constructor.call(this)},destroy:function(){this.callParent();this.mixins.elementCt.destroy.call(this)},beginLayout:function(a){this.callParent(arguments);a.targetContext=a.paddingContext=a.getEl("getTarget",this);this.cacheChildItems(a)},beginLayoutCycle:function(c,a){var b=this;b.callParent(arguments);if(a){if(b.usesContainerHeight){++c.consumersContainerHeight}if(b.usesContainerWidth){++c.consumersContainerWidth}}},cacheChildItems:function(e){var c=e.context,g=[],a=this.getVisibleItems(),d=a.length,b;e.childItems=g;e.visibleItems=a;for(b=0;b<d;++b){g.push(c.getCmp(a[b]))}},cacheElements:function(){var a=this.owner;this.applyChildEls(a.el,a.id)},configureItem:function(c){var b=this,d=b.itemCls,a=b.owner.itemCls,e;c.ownerLayout=b;if(d){e=typeof d==="string"?[d]:d}if(a){e=Ext.Array.push(e||[],a)}if(e){c.addCls(e)}},doRenderBody:function(a,b){this.renderItems(a,b);this.renderContent(a,b)},doRenderContainer:function(b,e){var c=e.$comp.layout,a=c.getRenderTpl(),d=c.getRenderData();a.applyOut(d,b)},doRenderItems:function(b,d){var c=d.$layout,a=c.getRenderTree();if(a){Ext.DomHelper.generateMarkup(a,b)}},finishRender:function(){var b=this,c,a;b.callParent();b.cacheElements();c=b.getRenderTarget();a=b.getLayoutItems();b.finishRenderItems(c,a)},notifyOwner:function(){this.owner.afterLayout(this)},getContainerSize:function(b,g){var c=b.targetContext,e=c.getFrameInfo(),j=b.paddingContext.getPaddingInfo(),i=0,k=0,d,h,a,l;if(!b.widthModel.shrinkWrap){++k;a=g?c.getDomProp("width"):c.getProp("width");d=(typeof a=="number");if(d){++i;a-=e.width+j.width;if(a<0){a=0}}}if(!b.heightModel.shrinkWrap){++k;l=g?c.getDomProp("height"):c.getProp("height");h=(typeof l=="number");if(h){++i;l-=e.height+j.height;if(l<0){l=0}}}return{width:a,height:l,needed:k,got:i,gotAll:i==k,gotWidth:d,gotHeight:h}},getPositionOffset:function(a){if(!this.createsInnerCt){var b=this.owner.itemNodeOffset;if(b){a+=b}}return a},getLayoutItems:function(){var a=this.owner,b=a&&a.items;return(b&&b.items)||[]},getRenderData:function(){var a=this.owner;return{$comp:a,$layout:this,ownerId:a.id}},getRenderedItems:function(){var e=this,h=e.getRenderTarget(),a=e.getLayoutItems(),d=a.length,g=[],b,c;for(b=0;b<d;b++){c=a[b];if(c.rendered&&e.isValidParent(c,h,b)){g.push(c)}}return g},getRenderTarget:function(){return this.owner.getTargetEl()},getElementTarget:function(){return this.getRenderTarget()},getRenderTpl:function(){var a=this,b=Ext.XTemplate.getTpl(this,"renderTpl");if(!b.renderContent){a.owner.setupRenderTpl(b)}return b},getRenderTree:function(){var a,c=this.owner.items,d,b={};do{d=c.generation;a=this.getItemsRenderTree(this.getLayoutItems(),b)}while(c.generation!==d);return a},getScrollbarsNeeded:function(c,i,b,h){var a=Ext.getScrollbarSize(),e=typeof c=="number",j=typeof i=="number",g=0,d=0;if(!a.width){return 0}if(j&&i<h){d=2;c-=a.width}if(e&&c<b){g=1;if(!d&&j){i-=a.height;if(i<h){d=2}}}return d+g},getTarget:function(){return this.owner.getTargetEl()},getVisibleItems:function(){var g=this.getRenderTarget(),b=this.getLayoutItems(),e=b.length,a=[],c,d;for(c=0;c<e;c++){d=b[c];if(d.rendered&&this.isValidParent(d,g,c)&&d.hidden!==true){a.push(d)}}return a},setupRenderTpl:function(b){var a=this;b.renderBody=a.doRenderBody;b.renderContainer=a.doRenderContainer;b.renderItems=a.doRenderItems},getContentTarget:function(){return this.owner.getDefaultContentTarget()}});Ext.define("Ext.layout.container.Auto",{alias:["layout.auto","layout.autocontainer"],extend:Ext.layout.container.Container,type:"autocontainer",childEls:["outerCt","innerCt","clearEl"],reserveScrollbar:false,managePadding:true,manageOverflow:false,lastOverflowAdjust:{width:0,height:0},renderTpl:["{% if (!(Ext.isIEQuirks || Ext.isIE7m)) { %}",'<span id="{ownerId}-outerCt" style="display:table;">','<div id="{ownerId}-innerCt" style="display:table-cell;height:100%;','vertical-align:top;{%this.renderPadding(out, values)%}" class="{innerCtCls}">',"{%this.renderBody(out,values)%}","</div>","</span>","{% } else if (values.shrinkWrapWidth) { %}",'<table id="{ownerId}-outerCt" class="'+Ext.baseCSSPrefix+'table-plain">',"<tr>",'<td id="{ownerId}-innerCt" style="vertical-align:top;padding:0;','{%this.renderPadding(out, values)%}" class="{innerCtCls}">',"{%this.renderBody(out,values)%}",'<div id="{ownerId}-clearEl" class="',Ext.baseCSSPrefix,'clear"','role="presentation"></div>',"</td>","</tr>","</table>","{% } else { %}",'<div id="{ownerId}-outerCt" style="zoom:1;{%this.renderPadding(out, values)%}">','<div id="{ownerId}-innerCt" style="zoom:1;height:100%;" class="{innerCtCls}">',"{%this.renderBody(out,values)%}",'<div id="{ownerId}-clearEl" class="',Ext.baseCSSPrefix,'clear"','role="presentation"></div>',"</div>","</div>","{% values.$layout.isShrinkWrapTpl = false %}","{% } %}"],tableTpl:['<table id="{ownerId}-outerCt" class="'+Ext.baseCSSPrefix+'table-plain">',"<tr>",'<td id="{ownerId}-innerCt" style="vertical-align:top;padding:0;','{%this.renderPadding(out, values)%}" class="{innerCtCls}">',"</td>","</tr>","</table>"],isShrinkWrapTpl:true,beginLayout:function(e){var d=this,a,b,c,g;d.callParent(arguments);d.initContextItems(e);if(!d.isShrinkWrapTpl){if(e.widthModel.shrinkWrap){g=true}if(Ext.isStrict&&Ext.isIE7){c=d.getOverflowXStyle(e);if((c==="auto"||c==="scroll")&&e.paddingContext.getPaddingInfo().right){g=true}}if(g){d.insertTableCt(e)}}if(!d.isShrinkWrapTpl&&Ext.isIE7&&Ext.isStrict&&!d.clearElHasPadding){a=e.paddingContext.getPaddingInfo().bottom;b=d.getOverflowYStyle(e);if(a&&(b==="auto"||b==="scroll")){d.clearEl.setStyle("height",a);d.clearElHasPadding=true}}},beforeLayoutCycle:function(c){var a=this.owner,d=a.hierarchyState,b=a.hierarchyStateInner;if(!d||d.invalid){d=a.getHierarchyState();b=a.hierarchyStateInner}if(c.widthModel.shrinkWrap&&this.isShrinkWrapTpl){b.inShrinkWrapTable=true}else{delete b.inShrinkWrapTable}},beginLayoutCycle:function(e){var k=this,b=k.outerCt,j=k.lastOuterCtWidth||"",i=k.lastOuterCtHeight||"",l=k.lastOuterCtTableLayout||"",m,g,h,n,c,a,d;k.callParent(arguments);h=n=c="";if(!e.widthModel.shrinkWrap&&k.isShrinkWrapTpl){if(Ext.isIE7m&&Ext.isStrict){g=k.getOverflowYStyle(e);if(g==="auto"||g==="scroll"){a=true}}if(!a){h="100%"}d=k.owner.hierarchyStateInner;m=k.getOverflowXStyle(e);c=(d.inShrinkWrapTable||m==="auto"||m==="scroll")?"":"fixed"}if(!e.heightModel.shrinkWrap&&!Ext.supports.PercentageHeightOverflowBug){n="100%"}if((h!==j)||k.hasOuterCtPxWidth){b.setStyle("width",h);k.lastOuterCtWidth=h;k.hasOuterCtPxWidth=false}if(c!==l){b.setStyle("table-layout",c);k.lastOuterCtTableLayout=c}if((n!==i)||k.hasOuterCtPxHeight){b.setStyle("height",n);k.lastOuterCtHeight=n;k.hasOuterCtPxHeight=false}if(k.hasInnerCtPxHeight){k.innerCt.setStyle("height","");k.hasInnerCtPxHeight=false}e.state.overflowAdjust=k.lastOverflowAdjust},calculate:function(c){var a=this,b=c.state,e=a.getContainerSize(c,true),d=b.calculatedItems||(b.calculatedItems=a.calculateItems?a.calculateItems(c,e):true);a.setCtSizeIfNeeded(c,e);if(d&&c.hasDomProp("containerChildrenSizeDone")){a.calculateContentSize(c);if(e.gotAll){if(a.manageOverflow&&!c.state.secondPass&&!a.reserveScrollbar){a.calculateOverflow(c,e)}return}}a.done=false},calculateContentSize:function(g){var e=this,a=((g.widthModel.shrinkWrap?1:0)|(g.heightModel.shrinkWrap?2:0)),c=(a&1)||undefined,h=(a&2)||undefined,d=0,b=g.props;if(c){if(isNaN(b.contentWidth)){++d}else{c=undefined}}if(h){if(isNaN(b.contentHeight)){++d}else{h=undefined}}if(d){if(c&&!g.setContentWidth(e.measureContentWidth(g))){e.done=false}if(h&&!g.setContentHeight(e.measureContentHeight(g))){e.done=false}}},calculateOverflow:function(c){var h=this,b,j,a,g,e,d,i;e=(h.getOverflowXStyle(c)==="auto");d=(h.getOverflowYStyle(c)==="auto");if(e||d){a=Ext.getScrollbarSize();i=c.overflowContext.el.dom;g=0;if(i.scrollWidth>i.clientWidth){g|=1}if(i.scrollHeight>i.clientHeight){g|=2}b=(d&&(g&2))?a.width:0;j=(e&&(g&1))?a.height:0;if(b!==h.lastOverflowAdjust.width||j!==h.lastOverflowAdjust.height){h.done=false;c.invalidate({state:{overflowAdjust:{width:b,height:j},overflowState:g,secondPass:true}})}}},completeLayout:function(a){this.lastOverflowAdjust=a.state.overflowAdjust},doRenderPadding:function(b,d){var c=d.$layout,a=d.$layout.owner,e=a[a.contentPaddingProperty];if(c.managePadding&&e){b.push("padding:",Ext.Element.unitizeBox(e))}},finishedLayout:function(b){var a=this.innerCt;this.callParent(arguments);if(Ext.isIEQuirks||Ext.isIE8m){a.repaint()}if(Ext.isOpera){a.setStyle("position","relative");a.dom.scrollWidth;a.setStyle("position","")}},getContainerSize:function(b,c){var a=this.callParent(arguments),d=b.state.overflowAdjust;if(d){a.width-=d.width;a.height-=d.height}return a},getRenderData:function(){var a=this.owner,b=this.callParent();if((Ext.isIEQuirks||Ext.isIE7m)&&((a.shrinkWrap&1)||(a.floating&&!a.width))){b.shrinkWrapWidth=true}return b},getRenderTarget:function(){return this.innerCt},getElementTarget:function(){return this.innerCt},getOverflowXStyle:function(a){return a.overflowXStyle||(a.overflowXStyle=this.owner.scrollFlags.overflowX||a.overflowContext.getStyle("overflow-x"))},getOverflowYStyle:function(a){return a.overflowYStyle||(a.overflowYStyle=this.owner.scrollFlags.overflowY||a.overflowContext.getStyle("overflow-y"))},initContextItems:function(c){var b=this,d=c.target,a=b.owner.customOverflowEl;c.outerCtContext=c.getEl("outerCt",b);c.innerCtContext=c.getEl("innerCt",b);if(a){c.overflowContext=c.getEl(a)}else{c.overflowContext=c.targetContext}if(d[d.contentPaddingProperty]!==undefined){c.paddingContext=b.isShrinkWrapTpl?c.innerCtContext:c.outerCtContext}},initLayout:function(){var c=this,b=Ext.getScrollbarSize().width,a=c.owner;c.callParent();if(b&&c.manageOverflow&&!c.hasOwnProperty("lastOverflowAdjust")){if(a.autoScroll||c.reserveScrollbar){c.lastOverflowAdjust={width:b,height:0}}}},insertTableCt:function(b){var h=this,a=h.owner,c=0,e,g,k,d,j;e=Ext.XTemplate.getTpl(this,"tableTpl");e.renderPadding=h.doRenderPadding;h.outerCt.dom.removeChild(h.innerCt.dom);g=document.createDocumentFragment();k=h.innerCt.dom.childNodes;d=k.length;for(;c<d;c++){g.appendChild(k[0])}j=h.getTarget();j.dom.innerHTML=e.apply({$layout:h,ownerId:h.owner.id});j.down("td").dom.appendChild(g);h.applyChildEls(a.el,a.id);h.isShrinkWrapTpl=true;b.removeEl(h.outerCt);b.removeEl(h.innerCt);h.initContextItems(b)},measureContentHeight:function(b){var a=this.outerCt.getHeight(),c=b.target;if(this.managePadding&&(c[c.contentPaddingProperty]===undefined)){a+=b.targetContext.getPaddingInfo().height}return a},measureContentWidth:function(b){var a=this.outerCt.getWidth(),c=b.target;if(this.managePadding&&(c[c.contentPaddingProperty]===undefined)){a+=b.targetContext.getPaddingInfo().width}return a},setCtSizeIfNeeded:function(d,n){var s=this,l=n.width,i=n.height,g=d.paddingContext.getPaddingInfo(),j=s.getTarget(),e=s.getOverflowXStyle(d),k=s.getOverflowYStyle(d),o=(e==="auto"||e==="scroll"),m=(k==="auto"||k==="scroll"),p=Ext.getScrollbarSize(),q=s.isShrinkWrapTpl,b=s.manageOverflow,a,r,h,c;if(l&&!d.widthModel.shrinkWrap&&((Ext.isIE7m&&Ext.isStrict&&q&&m)||(Ext.isIEQuirks&&!q&&!o))){if(!b){if(m&&(j.dom.scrollHeight>j.dom.clientHeight)){l-=p.width}}d.outerCtContext.setProp("width",l+g.width);s.hasOuterCtPxWidth=true}if(i&&!d.heightModel.shrinkWrap){if(Ext.supports.PercentageHeightOverflowBug){r=true}if(((Ext.isIE8&&Ext.isStrict)||Ext.isIE7m&&Ext.isStrict&&q)){h=true;c=!Ext.isIE8}if((r||h)&&o&&(j.dom.scrollWidth>j.dom.clientWidth)){i-=p.height}if(r){d.outerCtContext.setProp("height",i+g.height);s.hasOuterCtPxHeight=true}if(h){if(c){i+=g.height}d.innerCtContext.setProp("height",i);s.hasInnerCtPxHeight=true}}if(Ext.isIE7&&Ext.isStrict&&!q&&(k==="auto")){a=(e==="auto")?"overflow-x":"overflow-y";j.setStyle(a,"hidden");j.setStyle(a,"auto")}},setupRenderTpl:function(a){this.callParent(arguments);a.renderPadding=this.doRenderPadding},getContentTarget:function(){return this.innerCt}});Ext.define("Ext.ZIndexManager",{alternateClassName:"Ext.WindowGroup",statics:{zBase:9000},constructor:function(a){var b=this;b.list={};b.zIndexStack=[];b.front=null;if(a){if(a.isContainer){a.on("resize",b._onContainerResize,b);b.zseed=Ext.Number.from(b.rendered?a.getEl().getStyle("zIndex"):undefined,b.getNextZSeed());b.targetEl=a.getTargetEl();b.container=a}else{Ext.EventManager.onWindowResize(b._onContainerResize,b);b.zseed=b.getNextZSeed();b.targetEl=Ext.get(a)}}else{Ext.EventManager.onWindowResize(b._onContainerResize,b);b.zseed=b.getNextZSeed();Ext.onDocumentReady(function(){b.targetEl=Ext.getBody()})}},getNextZSeed:function(){return(Ext.ZIndexManager.zBase+=10000)},setBase:function(b){this.zseed=b;var a=this.assignZIndices();this._activateLast();return a},assignZIndices:function(){var c=this.zIndexStack,b=c.length,e=0,h=this.zseed,d,g;for(;e<b;e++){d=c[e];if(d&&!d.hidden){h=d.setZIndex(h);if(d.modal){g=d}}}if(g){this._showModalMask(g)}return h},_setActiveChild:function(b,a){var c=this.front,d=b.preventFocusOnActivate;if(b!==c){if(c&&!c.destroying){c.setActive(false,b)}this.front=b;if(b&&b!=a){b.preventFocusOnActivate=b.preventFocusOnActivate||a&&(a.preventFocusOnActivate||!a.focusOnToFront);b.setActive(true);if(b.modal){this._showModalMask(b)}b.preventFocusOnActivate=d}}},onComponentHide:function(a){this._activateLast()},_activateLast:function(){var d=this,a=d.zIndexStack,c=a.length-1,b;for(;c>=0&&a[c].hidden;--c){}if((b=a[c])){d._setActiveChild(b,d.front);if(b.modal){return}}else{if(d.front&&!d.front.destroying){d.front.setActive(false)}d.front=null}for(;c>=0;--c){b=a[c];if(b.isVisible()&&b.modal){d._showModalMask(b);return}}d._hideModalMask()},_showModalMask:function(b){var d=this,h=b.el.getStyle("zIndex")-4,c=b.floatParent?b.floatParent.getTargetEl():b.container,a=d.mask,g=d.maskShim,e;if(!a){if(Ext.isIE6){g=d.maskShim=Ext.getBody().createChild({tag:"iframe",cls:Ext.baseCSSPrefix+"shim "+Ext.baseCSSPrefix+"mask-shim"});g.setVisibilityMode(Ext.Element.DISPLAY)}a=d.mask=Ext.getBody().createChild({cls:Ext.baseCSSPrefix+"mask",style:"height:0;width:0"});a.setVisibilityMode(Ext.Element.DISPLAY);a.on("click",d._onMaskClick,d)}a.maskTarget=c;e=d.getMaskBox();if(g){g.setStyle("zIndex",h);g.show();g.setBox(e)}a.setStyle("zIndex",h);a.show();a.setBox(e)},_hideModalMask:function(){var b=this.mask,a=this.maskShim;if(b&&b.isVisible()){b.maskTarget=undefined;b.hide();if(a){a.hide()}}},_onMaskClick:function(){if(this.front){this.front.focus()}},getMaskBox:function(){var a=this.mask.maskTarget;if(a.dom===document.body){return{height:Math.max(document.body.scrollHeight,Ext.dom.Element.getDocumentHeight()),width:Math.max(document.body.scrollWidth,document.documentElement.clientWidth),x:0,y:0}}else{return a.getBox()}},_onContainerResize:function(){var c=this,b=c.mask,a=c.maskShim,d;if(b&&b.isVisible()){b.hide();if(a){a.hide()}d=c.getMaskBox();if(a){a.setSize(d);a.show()}b.setSize(d);b.show()}},register:function(b){var c=this,a=b.afterHide;if(b.zIndexManager){b.zIndexManager.unregister(b)}b.zIndexManager=c;c.list[b.id]=b;c.zIndexStack.push(b);b.afterHide=function(){a.apply(b,arguments);c.onComponentHide(b)}},unregister:function(a){var b=this,c=b.list;delete a.zIndexManager;if(c&&c[a.id]){delete c[a.id];delete a.afterHide;Ext.Array.remove(b.zIndexStack,a);b._activateLast()}},get:function(a){return a.isComponent?a:this.list[a]},bringToFront:function(b,d){var c=this,a=false,e=c.zIndexStack;b=c.get(b);if(b!==c.front){Ext.Array.remove(e,b);if(b.preventBringToFront){e.unshift(b)}else{e.push(b)}c.assignZIndices();if(!d){c._activateLast()}a=true;c.front=b;if(b.modal){c._showModalMask(b)}}return a},sendToBack:function(a){var b=this;a=b.get(a);Ext.Array.remove(b.zIndexStack,a);b.zIndexStack.unshift(a);b.assignZIndices();this._activateLast();return a},hideAll:function(){var b=this.list,a,c;for(c in b){if(b.hasOwnProperty(c)){a=b[c];if(a.isComponent&&a.isVisible()){a.hide()}}}},hide:function(){var d=0,b=this.zIndexStack,a=b.length,c;this.tempHidden=[];for(;d<a;d++){c=b[d];if(c.isVisible()){this.tempHidden.push(c);c.el.hide();c.hidden=true}}},show:function(){var c=0,d=this.tempHidden,a=d?d.length:0,b;for(;c<a;c++){b=d[c];b.el.show();b.hidden=false;b.setPosition(b.x,b.y)}delete this.tempHidden},getActive:function(){return this.front},getBy:function(g,e){var h=[],d=0,b=this.zIndexStack,a=b.length,c;for(;d<a;d++){c=b[d];if(g.call(e||c,c)!==false){h.push(c)}}return h},each:function(c,b){var d=this.list,e,a;for(e in d){if(d.hasOwnProperty(e)){a=d[e];if(a.isComponent&&c.call(b||a,a)===false){return}}}},eachBottomUp:function(g,e){var b=this.zIndexStack,d=0,a=b.length,c;for(;d<a;d++){c=b[d];if(c.isComponent&&g.call(e||c,c)===false){return}}},eachTopDown:function(e,d){var a=this.zIndexStack,c=a.length,b;for(;c-->0;){b=a[c];if(b.isComponent&&e.call(d||b,b)===false){return}}},destroy:function(){var b=this,c=b.list,a,d;for(d in c){if(c.hasOwnProperty(d)){a=c[d];if(a.isComponent){a.destroy()}}}delete b.zIndexStack;delete b.list;delete b.container;delete b.targetEl}},function(){Ext.WindowManager=Ext.WindowMgr=new this()});Ext.define("Ext.container.AbstractContainer",{extend:Ext.Component,renderTpl:"{%this.renderContainer(out,values)%}",suspendLayout:false,autoDestroy:true,defaultType:"panel",detachOnRemove:true,isContainer:true,layoutCounter:0,baseCls:Ext.baseCSSPrefix+"container",defaultLayoutType:"auto",initComponent:function(){var a=this;a.addEvents("afterlayout","beforeadd","beforeremove","add","remove");a.callParent();a.getLayout();a.initItems()},initItems:function(){var b=this,a=b.items;b.items=new Ext.util.AbstractMixedCollection(false,b.getComponentId);b.floatingItems=new Ext.util.MixedCollection(false,b.getComponentId);if(a){if(!Ext.isArray(a)){a=[a]}b.add(a)}},getFocusEl:function(){return this.getTargetEl()},finishRenderChildren:function(){this.callParent();var a=this.getLayout();if(a){a.finishRender()}},beforeRender:function(){var b=this,a=b.getLayout(),c;b.callParent();if(!a.initialized){a.initLayout()}c=a.targetCls;if(c){b.applyTargetCls(c)}},applyTargetCls:function(a){this.addCls(a)},afterComponentLayout:function(){var b=this.floatingItems.items,a=b.length,d,c;this.callParent(arguments);for(d=0;d<a;d++){c=b[d];if(!c.rendered&&c.autoShow){c.show()}}},onPosition:function(){this.callParent(arguments);this.repositionFloatingItems()},onResize:function(){this.callParent(arguments);this.repositionFloatingItems()},repositionFloatingItems:function(){var b=this.floatingItems.items,a=b.length,d,c;for(d=0;d<a;d++){c=b[d];if(c.el&&!c.hidden){c.setPosition(c.x,c.y)}}},setupRenderTpl:function(a){this.callParent(arguments);this.getLayout().setupRenderTpl(a)},getDefaultContentTarget:function(){return this.el},getContentTarget:function(){return this.getLayout().getContentTarget()},setLayout:function(b){var a=this.layout;if(a&&a.isLayout&&a!=b){a.setOwner(null)}this.layout=b;b.setOwner(this)},getLayout:function(){var a=this;if(!a.layout||!a.layout.isLayout){a.setLayout(Ext.layout.Layout.create(a.layout,a.self.prototype.layout||a.defaultLayoutType))}return a.layout},doLayout:function(){this.updateLayout();return this},afterLayout:function(b){var a=this;++a.layoutCounter;if(a.hasListeners.afterlayout){a.fireEvent("afterlayout",a,b)}},prepareItems:function(b,d){if(Ext.isArray(b)){b=b.slice()}else{b=[b]}var g=this,c=0,a=b.length,e;for(;c<a;c++){e=b[c];if(e==null){Ext.Array.erase(b,c,1);--c;--a}else{if(d){e=this.applyDefaults(e)}e.isContained=g;b[c]=g.lookupComponent(e);delete e.isContained;delete b[c].isContained}}return b},applyDefaults:function(a){var b=this.defaults;if(b){if(Ext.isFunction(b)){b=b.call(this,a)}if(Ext.isString(a)){a=Ext.ComponentManager.get(a)}Ext.applyIf(a,b)}return a},lookupComponent:function(a){return(typeof a=="string")?Ext.ComponentManager.get(a):Ext.ComponentManager.create(a,this.defaultType)},getComponentId:function(a){if(a.getItemId){return a.getItemId()}},add:function(){var j=this,g=Ext.Array.slice(arguments),d=(typeof g[0]=="number")?g.shift():-1,c=j.getLayout(),l,h,b,a,m,k,e;if(g.length==1&&Ext.isArray(g[0])){h=g[0];l=true}else{h=g}e=h=j.prepareItems(h,true);a=h.length;if(j.rendered){Ext.suspendLayouts()}if(!l&&a==1){e=h[0]}for(b=0;b<a;b++){m=h[b];k=(d<0)?j.items.length:(d+b);if(m.floating){j.floatingItems.add(m);m.onAdded(j,k);if(j.hasListeners.add){j.fireEvent("add",j,m,k)}}else{if((!j.hasListeners.beforeadd||j.fireEvent("beforeadd",j,m,k)!==false)&&j.onBeforeAdd(m)!==false){j.items.insert(k,m);m.onAdded(j,k);j.onAdd(m,k);c.onAdd(m,k);if(j.hasListeners.add){j.fireEvent("add",j,m,k)}}}}j.updateLayout();if(j.rendered){Ext.resumeLayouts(true)}return e},onAdd:Ext.emptyFn,onRemove:Ext.emptyFn,insert:function(b,a){return this.add(b,a)},move:function(b,d){var a=this.items,c;c=a.removeAt(b);if(c===false){return false}a.insert(d,c);this.onMove(c,b,d);this.updateLayout();return c},onMove:Ext.emptyFn,onBeforeAdd:function(a){if(a.ownerCt&&a.ownerCt!==this){a.ownerCt.remove(a,false)}},remove:function(a,b){var d=this,e=d.getComponent(a);if(e&&(!d.hasListeners.beforeremove||d.fireEvent("beforeremove",d,e)!==false)){d.doRemove(e,b);if(d.hasListeners.remove){d.fireEvent("remove",d,e)}if(!d.destroying&&!e.floating){d.updateLayout()}}return e},doRemove:function(c,b){b=b===true||(b!==false&&this.autoDestroy);var g=this,e=g.layout,a=e&&g.rendered,d=c.destroying||b,h=c.floating;if(h){g.floatingItems.remove(c)}else{g.items.remove(c)}if(a&&!h){if(e.running){Ext.AbstractComponent.cancelLayout(c,d)}e.onRemove(c,d)}c.onRemoved(d);g.onRemove(c,d);if(b){c.destroy()}else{if(a&&!h){e.afterRemove(c)}if(g.detachOnRemove&&c.rendered){g.detachComponent(c)}}},detachComponent:function(a){Ext.getDetachedBody().appendChild(a.getEl())},removeAll:function(c){var h=this,e=h.items.items.slice().concat(h.floatingItems.items),b=[],d=0,a=e.length,g;h.suspendLayouts();for(;d<a;d++){g=e[d];h.remove(g,c);if(g.ownerCt!==h){b.push(g)}}h.resumeLayouts(!!a);return b},getRefItems:function(c){var h=this,d=h.items.items,b=d.length,e=0,g,a=[];for(;e<b;e++){g=d[e];a.push(g);if(c&&g.getRefItems){a.push.apply(a,g.getRefItems(true))}}a.push.apply(a,h.floatingItems.items);return a},cascade:function(l,m,a){var k=this,e=k.items?k.items.items:[],g=e.length,d=0,j,h=a?a.concat(k):[k],b=h.length-1;if(l.apply(m||k,h)!==false){for(;d<g;d++){j=e[d];if(j.cascade){j.cascade(l,m,a)}else{h[b]=j;l.apply(m||e,h)}}}return this},isAncestor:function(a){while(a){if(a.ownerCt===this){return true}a=a.ownerCt}},getComponent:function(a){if(Ext.isObject(a)){a=a.getItemId()}var b=this.items.get(a);if(!b&&typeof a!="number"){b=this.floatingItems.get(a)}return b},query:function(a){a=a||"*";return Ext.ComponentQuery.query(a,this)},queryBy:function(g,e){var c=[],b=this.getRefItems(true),d=0,a=b.length,h;for(;d<a;++d){h=b[d];if(g.call(e||h,h)!==false){c.push(h)}}return c},queryById:function(a){return this.down("#"+a)},child:function(a){if(a&&a.isComponent){a="#"+Ext.escapeId(a.getItemId())}a=a||"";return this.query("> "+a)[0]||null},contains:function(c,b){var a=false;if(b){this.cascade(function(d){if(d.contains&&d.contains(c)){a=true;return false}});return a}else{return this.items.contains(c)||this.floatingItems.contains(c)}},nextChild:function(e,b){var c=this,a,d=c.items.indexOf(e);if(d!==-1){a=b?Ext.ComponentQuery(b,c.items.items.slice(d+1)):c.items.getAt(d+1);if(!a&&c.ownerCt){a=c.ownerCt.nextChild(c,b)}}return a},prevChild:function(e,b){var c=this,a,d=c.items.indexOf(e);if(d!==-1){a=b?Ext.ComponentQuery(b,c.items.items.slice(d+1)):c.items.getAt(d+1);if(!a&&c.ownerCt){a=c.ownerCt.nextChild(c,b)}}return a},down:function(a){if(a&&a.isComponent){a="#"+Ext.escapeId(a.getItemId())}a=a||"";return this.query(a)[0]||null},enable:function(){this.callParent(arguments);var d=this.getChildItemsToDisable(),c=d.length,b,a;for(a=0;a<c;a++){b=d[a];if(b.resetDisable){b.enable()}}return this},disable:function(){this.callParent(arguments);var d=this.getChildItemsToDisable(),c=d.length,b,a;for(a=0;a<c;a++){b=d[a];if(b.resetDisable!==false&&!b.disabled){b.disable();b.resetDisable=true}}return this},getChildItemsToDisable:function(){return this.query("[isFormField],button")},beforeDestroy:function(){var b=this,a=b.items,d=b.floatingItems,e;if(a){while((e=a.first())){b.doRemove(e,true)}}if(d){while((e=d.first())){b.doRemove(e,true)}}Ext.destroy(b.layout);b.callParent()}});Ext.define("Ext.container.Container",{extend:Ext.container.AbstractContainer,alias:"widget.container",alternateClassName:"Ext.Container",getChildByElement:function(e,a){var h,c,b=0,d=this.getRefItems(),g=d.length;e=Ext.getDom(e);for(;b<g;b++){h=d[b];c=h.getEl();if(c&&((c.dom===e)||c.contains(e))){return(a&&h.getChildByElement)?h.getChildByElement(e,a):h}}return null}});Ext.define("Ext.util.KeyMap",{alternateClassName:"Ext.KeyMap",eventName:"keydown",constructor:function(a){var b=this;if((arguments.length!==1)||(typeof a==="string")||a.dom||a.tagName||a===document||a.isComponent){b.legacyConstructor.apply(b,arguments);return}Ext.apply(b,a);b.bindings=[];if(!b.target.isComponent){b.target=Ext.get(b.target)}if(b.binding){b.addBinding(b.binding)}else{if(a.key){b.addBinding(a)}}b.enable()},legacyConstructor:function(b,d,a){var c=this;Ext.apply(c,{target:Ext.get(b),eventName:a||c.eventName,bindings:[]});if(d){c.addBinding(d)}c.enable()},addBinding:function(e){var c=this,d=e.key,b,a;if(c.processing){c.bindings=bindings.slice(0)}if(Ext.isArray(e)){for(b=0,a=e.length;b<a;b++){c.addBinding(e[b])}return}c.bindings.push(Ext.apply({keyCode:c.processKeys(d)},e))},removeBinding:function(g){var e=this,h=e.bindings,a=h.length,b,d,c;if(e.processing){e.bindings=h.slice(0)}c=e.processKeys(g.key);for(b=0;b<a;++b){d=h[b];if(d.fn===g.fn&&d.scope===g.scope){if(g.alt==d.alt&&g.crtl==d.crtl&&g.shift==d.shift){if(Ext.Array.equals(d.keyCode,c)){Ext.Array.erase(e.bindings,b,1);return}}}}},processKeys:function(g){var h=false,d,e,b,a,c;if(Ext.isString(g)){e=[];b=g.toUpperCase();for(c=0,a=b.length;c<a;++c){e.push(b.charCodeAt(c))}g=e;h=true}if(!Ext.isArray(g)){g=[g]}if(!h){for(c=0,a=g.length;c<a;++c){d=g[c];if(Ext.isString(d)){g[c]=d.toUpperCase().charCodeAt(0)}}}return g},handleTargetEvent:(function(){var a=/input|textarea/i;return function(g){var e=this,j,c,b,h,d;if(e.enabled){j=e.bindings;c=0;b=j.length;g=e.processEvent.apply(e||e.processEventScope,arguments);if(e.ignoreInputFields){h=g.target;d=h.contentEditable;if(a.test(h.tagName)||(d===""||d==="true")){return}}if(!g.getKey){return g}e.processing=true;for(;c<b;++c){e.processBinding(j[c],g)}e.processing=false}}}()),processEvent:Ext.identityFn,processBinding:function(g,a){if(this.checkModifiers(g,a)){var h=a.getKey(),k=g.fn||g.handler,l=g.scope||this,j=g.keyCode,b=g.defaultEventAction,c,e,d=new Ext.EventObjectImpl(a);for(c=0,e=j.length;c<e;++c){if(h===j[c]){if(k.call(l,h,a)!==true&&b){d[b]()}break}}}},checkModifiers:function(j,g){var d=["shift","ctrl","alt"],c=0,a=d.length,h,b;for(;c<a;++c){b=d[c];h=j[b];if(!(h===undefined||(h===g[b+"Key"]))){return false}}return true},on:function(b,d,c){var h,a,e,g;if(Ext.isObject(b)&&!Ext.isArray(b)){h=b.key;a=b.shift;e=b.ctrl;g=b.alt}else{h=b}this.addBinding({key:h,shift:a,ctrl:e,alt:g,fn:d,scope:c})},un:function(b,d,c){var h,a,e,g;if(Ext.isObject(b)&&!Ext.isArray(b)){h=b.key;a=b.shift;e=b.ctrl;g=b.alt}else{h=b}this.removeBinding({key:h,shift:a,ctrl:e,alt:g,fn:d,scope:c})},isEnabled:function(){return this.enabled},enable:function(){var a=this;if(!a.enabled){a.target.on(a.eventName,a.handleTargetEvent,a);a.enabled=true}},disable:function(){var a=this;if(a.enabled){a.target.removeListener(a.eventName,a.handleTargetEvent,a);a.enabled=false}},setDisabled:function(a){if(a){this.disable()}else{this.enable()}},destroy:function(c){var a=this,b=a.target;a.bindings=[];a.disable();if(c===true){if(b.isComponent){b.destroy()}else{b.remove()}}delete a.target}});Ext.define("Ext.util.KeyNav",{alternateClassName:"Ext.KeyNav",statics:{keyOptions:{left:37,right:39,up:38,down:40,space:32,pageUp:33,pageDown:34,del:46,backspace:8,home:36,end:35,enter:13,esc:27,tab:9}},constructor:function(a){var b=this;if(arguments.length===2){b.legacyConstructor.apply(b,arguments);return}b.setConfig(a)},legacyConstructor:function(b,a){this.setConfig(Ext.apply({target:b},a))},setConfig:function(b){var e=this,c={target:b.target,ignoreInputFields:b.ignoreInputFields,eventName:e.getKeyEvent("forceKeyDown" in b?b.forceKeyDown:e.forceKeyDown,b.eventName)},g,a,i,d,h;if(e.map){e.map.destroy()}if(b.processEvent){c.processEvent=b.processEvent;c.processEventScope=b.processEventScope||e}if(b.keyMap){g=e.map=b.keyMap}else{g=e.map=new Ext.util.KeyMap(c);e.destroyKeyMap=true}a=Ext.util.KeyNav.keyOptions;i=b.scope||e;for(d in a){if(a.hasOwnProperty(d)){if(h=b[d]){if(typeof h==="function"){h={handler:h,defaultEventAction:(b.defaultEventAction!==undefined)?b.defaultEventAction:e.defaultEventAction}}g.addBinding({key:a[d],handler:Ext.Function.bind(e.handleEvent,h.scope||i,h.handler||h.fn,true),defaultEventAction:(h.defaultEventAction!==undefined)?h.defaultEventAction:e.defaultEventAction})}}}g.disable();if(!b.disabled){g.enable()}},handleEvent:function(c,b,a){return a.call(this,b)},disabled:false,defaultEventAction:"stopEvent",forceKeyDown:false,eventName:"keypress",destroy:function(a){if(this.destroyKeyMap){this.map.destroy(a)}delete this.map},enable:function(){this.map.enable();this.disabled=false},disable:function(){this.map.disable();this.disabled=true},setDisabled:function(a){this.map.setDisabled(a);this.disabled=a},getKeyEvent:function(b,a){if(b||(Ext.EventManager.useKeyDown&&!a)){return"keydown"}else{return a||this.eventName}}});Ext.define("Ext.FocusManager",{singleton:true,alternateClassName:["Ext.FocusMgr"],mixins:{observable:Ext.util.Observable},enabled:false,focusElementCls:Ext.baseCSSPrefix+"focus-element",focusFrameCls:Ext.baseCSSPrefix+"focus-frame",whitelist:["textfield"],constructor:function(a){var b=this,c=Ext.ComponentQuery;b.mixins.observable.constructor.call(b,a);b.addEvents("beforecomponentfocus","componentfocus","disable","enable");b.focusTask=new Ext.util.DelayedTask(b.handleComponentFocus,b);Ext.override(Ext.AbstractComponent,{onFocus:function(){this.callParent(arguments);if(b.enabled&&this.hasFocus){Array.prototype.unshift.call(arguments,this);b.onComponentFocus.apply(b,arguments)}},onBlur:function(){this.callParent(arguments);if(b.enabled&&!this.hasFocus){Array.prototype.unshift.call(arguments,this);b.onComponentBlur.apply(b,arguments)}},onDestroy:function(){this.callParent(arguments);if(b.enabled){Array.prototype.unshift.call(arguments,this);b.onComponentDestroy.apply(b,arguments)}}});Ext.override(Ext.Component,{afterHide:function(){this.callParent(arguments);if(b.enabled){Array.prototype.unshift.call(arguments,this);b.onComponentHide.apply(b,arguments)}}});b.keyNav=new Ext.util.KeyNav(Ext.getDoc(),{disabled:true,scope:b,backspace:b.focusLast,enter:b.navigateIn,esc:b.navigateOut,tab:b.navigateSiblings,space:b.navigateIn,del:b.focusLast,left:b.navigateSiblings,right:b.navigateSiblings,down:b.navigateSiblings,up:b.navigateSiblings});b.focusData={};b.subscribers=new Ext.util.HashMap();b.focusChain={};Ext.apply(c.pseudos,{nextFocus:function(g,e,j){j=j||1;e=parseInt(e,10);var d=g.length,h=e,k;for(;;){if((h+=j)>=d){h=0}else{if(h<0){h=d-1}}if(h===e){return[]}if((k=g[h]).isFocusable()){return[k]}}return[]},prevFocus:function(e,d){return this.nextFocus(e,d,-1)},root:function(e){var d=e.length,h=[],g=0,j;for(;g<d;g++){j=e[g];if(!j.ownerCt){h.push(j)}}return h}})},addXTypeToWhitelist:function(b){var a=this;if(Ext.isArray(b)){Ext.Array.forEach(b,a.addXTypeToWhitelist,a);return}if(!Ext.Array.contains(a.whitelist,b)){a.whitelist.push(b)}},clearComponent:function(a){clearTimeout(this.cmpFocusDelay);if(!a.isDestroyed){a.blur()}},disable:function(){var a=this;if(!a.enabled){return}delete a.options;a.enabled=false;a.removeDOM();a.keyNav.disable();a.fireEvent("disable",a)},enable:function(a){var b=this;if(a===true){a={focusFrame:true}}b.options=a=a||{};if(b.enabled){return}b.enabled=true;b.initDOM(a);b.keyNav.enable();b.focusEl.focus();delete b.focusedCmp;b.fireEvent("enable",b)},focusLast:function(b){var a=this;if(a.isWhitelisted(a.focusedCmp)){return true}if(a.previousFocusedCmp){a.previousFocusedCmp.focus()}},getRootComponents:function(){var b=Ext.ComponentQuery,a=b.query(":focusable:root:not([floating])"),c=b.query(":focusable:root[floating]");c.sort(function(e,d){return e.el.getZIndex()>d.el.getZIndex()});return c.concat(a)},initDOM:function(c){var g=this,b=g.focusFrameCls,e=Ext.ComponentQuery.query("{getFocusEl()}:not([focusListenerAdded])"),d=0,a=e.length;if(!Ext.isReady){return Ext.onReady(g.initDOM,g)}for(;d<a;d++){e[d].addFocusListener()}if(!g.focusEl){g.focusEl=Ext.getBody();g.focusEl.dom.tabIndex=-1}if(!g.focusFrame&&c.focusFrame){g.focusFrame=Ext.getBody().createChild({cls:b,children:[{cls:b+"-top"},{cls:b+"-bottom"},{cls:b+"-left"},{cls:b+"-right"}],style:"top: -100px; left: -100px;"});g.focusFrame.setVisibilityMode(Ext.Element.DISPLAY);g.focusFrame.hide().setLocalXY(0,0)}},isWhitelisted:function(a){return a&&Ext.Array.some(this.whitelist,function(b){return a.isXType(b)})},navigateIn:function(g){var c=this,a=c.focusedCmp,b,d;if(c.isWhitelisted(a)){return true}if(!a){b=c.getRootComponents()[0];if(b){if(b.getFocusEl()===c.focusEl){c.focusEl.blur()}b.focus()}}else{d=a.hasFocus?Ext.ComponentQuery.query(">:focusable",a)[0]:a;if(d){d.focus()}else{if(Ext.isFunction(a.onClick)){g.button=0;a.onClick(g);if(a.isVisible(true)){a.focus()}else{c.navigateOut()}}}}},navigateOut:function(c){var b=this,a;if(!b.focusedCmp||!(a=b.focusedCmp.up(":focusable"))){b.focusEl.focus()}else{a.focus()}return true},navigateSiblings:function(i,b,o){var j=this,a=b||j,p=i.getKey(),g=Ext.EventObject,k=i.shiftKey||p==g.LEFT||p==g.UP,c=p==g.LEFT||p==g.RIGHT||p==g.UP||p==g.DOWN,h=k?"prev":"next",n,d,m,l;m=(a.focusedCmp&&a.focusedCmp.comp)||a.focusedCmp;if(!m&&!o){return true}if(c&&j.isWhitelisted(m)){return true}if(!m||m.is(":root")){l=j.getRootComponents()}else{o=o||m.up();if(o){l=o.getRefItems()}}if(l){n=m?Ext.Array.indexOf(l,m):-1;d=Ext.ComponentQuery.query(":"+h+"Focus("+n+")",l)[0];if(d&&m!==d){d.focus();return d}}},onComponentBlur:function(b,c){var a=this;if(a.focusedCmp===b){a.previousFocusedCmp=b;delete a.focusedCmp}if(a.focusFrame){a.focusFrame.hide()}},onComponentFocus:function(d,g){var c=this,a=c.focusChain,b;if(!d.isFocusable()){c.clearComponent(d);if(a[d.id]){return}b=d.up();if(b){a[d.id]=true;b.focus()}return}c.focusChain={};c.focusTask.delay(10,null,null,[d,d.getFocusEl()])},handleComponentFocus:function(l,h){var j=this,o,a,g,n,b,k,d,e,c,m,i;if(j.fireEvent("beforecomponentfocus",j,l,j.previousFocusedCmp)===false){j.clearComponent(l);return}j.focusedCmp=l;if(j.shouldShowFocusFrame(l)){o="."+j.focusFrameCls+"-";a=j.focusFrame;g=(h.dom?h:h.el).getBox();n=g.top;b=g.left;k=g.width;d=g.height;e=a.child(o+"top");c=a.child(o+"bottom");m=a.child(o+"left");i=a.child(o+"right");e.setWidth(k).setLocalXY(b,n);c.setWidth(k).setLocalXY(b,n+d-2);m.setHeight(d-2).setLocalXY(b,n+2);i.setHeight(d-2).setLocalXY(b+k-2,n+2);a.show()}j.fireEvent("componentfocus",j,l,j.previousFocusedCmp)},onComponentHide:function(e){var d=this,b=false,a=d.focusedCmp,c;if(a){b=e.hasFocus||(e.isContainer&&e.isAncestor(d.focusedCmp))}d.clearComponent(e);if(b&&(c=e.up(":focusable"))){c.focus()}else{d.focusEl.focus()}},onComponentDestroy:function(){},removeDOM:function(){var a=this;if(a.enabled||a.subscribers.length){return}Ext.destroy(a.focusFrame);delete a.focusEl;delete a.focusFrame},removeXTypeFromWhitelist:function(b){var a=this;if(Ext.isArray(b)){Ext.Array.forEach(b,a.removeXTypeFromWhitelist,a);return}Ext.Array.remove(a.whitelist,b)},setupSubscriberKeys:function(a,g){var e=this,d=a.getFocusEl(),c=g.scope,b={backspace:e.focusLast,enter:e.navigateIn,esc:e.navigateOut,scope:e},h=function(i){if(e.focusedCmp===a){return e.navigateSiblings(i,e,a)}else{return e.navigateSiblings(i)}};Ext.iterate(g,function(j,i){b[j]=function(l){var k=h(l);if(Ext.isFunction(i)&&i.call(c||a,l,k)===true){return true}return k}},e);return new Ext.util.KeyNav(d,b)},shouldShowFocusFrame:function(c){var b=this,a=b.options||{};if(!b.focusFrame||!c){return false}if(a.focusFrame){return true}if(b.focusData[c.id].focusFrame){return true}return false}});Ext.define("Ext.Img",{extend:Ext.Component,alias:["widget.image","widget.imagecomponent"],autoEl:"img",baseCls:Ext.baseCSSPrefix+"img",src:"",alt:"",title:"",imgCls:"",initComponent:function(){if(this.glyph){this.autoEl="div"}this.callParent()},getElConfig:function(){var e=this,b=e.callParent(),g=Ext._glyphFontFamily,d=e.glyph,a,c;if(e.autoEl=="img"){a=b}else{if(e.glyph){if(typeof d==="string"){c=d.split("@");d=c[0];g=c[1]}b.html="&#"+d+";";if(g){b.style="font-family:"+g}}else{b.cn=[a={tag:"img",id:e.id+"-img"}]}}if(a){if(e.imgCls){a.cls=(a.cls?a.cls+" ":"")+e.imgCls}a.src=e.src||Ext.BLANK_IMAGE_URL}if(e.alt){(a||b).alt=e.alt}if(e.title){(a||b).title=e.title}return b},onRender:function(){var b=this,a;b.callParent(arguments);a=b.el;b.imgEl=(b.autoEl=="img")?a:a.getById(b.id+"-img")},onDestroy:function(){Ext.destroy(this.imgEl);this.imgEl=null;this.callParent()},setSrc:function(c){var a=this,b=a.imgEl;a.src=c;if(b){b.dom.src=c||Ext.BLANK_IMAGE_URL}},setGlyph:function(c){var b=this,d=Ext._glyphFontFamily,a,e;if(c!=b.glyph){if(typeof c==="string"){a=c.split("@");c=a[0];d=a[1]}e=b.el.dom;e.innerHTML="&#"+c+";";if(d){e.style="font-family:"+d}}}});Ext.define("Ext.util.Bindable",{bindStore:function(b,c,a){a=a||"store";var d=this,e=d[a];if(!c&&e){d.onUnbindStore(e,c,a);if(b!==e&&e.autoDestroy){e.destroyStore()}else{d.unbindStoreListeners(e)}}if(b){b=Ext.data.StoreManager.lookup(b);d.bindStoreListeners(b);d.onBindStore(b,c,a)}d[a]=b||null;return d},getStore:function(){return this.store},unbindStoreListeners:function(a){var b=this.storeListeners;if(b){a.un(b)}},bindStoreListeners:function(a){var c=this,b=Ext.apply({},c.getStoreListeners(a));if(!b.scope){b.scope=c}c.storeListeners=b;a.on(b)},getStoreListeners:Ext.emptyFn,onUnbindStore:Ext.emptyFn,onBindStore:Ext.emptyFn});Ext.define("Ext.LoadMask",{extend:Ext.Component,alias:"widget.loadmask",mixins:{floating:Ext.util.Floating,bindable:Ext.util.Bindable},msg:"Loading...",msgCls:Ext.baseCSSPrefix+"mask-loading",maskCls:Ext.baseCSSPrefix+"mask",useMsg:true,useTargetEl:false,baseCls:Ext.baseCSSPrefix+"mask-msg",childEls:["msgEl","msgTextEl"],renderTpl:['<div id="{id}-msgEl" class="{[values.$comp.msgCls]} ',Ext.baseCSSPrefix,'mask-msg-inner{childElCls}">','<div id="{id}-msgTextEl" class="',Ext.baseCSSPrefix,"mask-msg-text",'{childElCls}"></div>',"</div>"],floating:{shadow:"frame"},focusOnToFront:false,bringParentToFront:false,constructor:function(b){var c=this,a;if(arguments.length===2){a=b;b=arguments[1]}else{a=b.target}if(!a.isComponent){a=Ext.get(a);this.isElement=true}c.ownerCt=a;if(!this.isElement){c.bindComponent(a)}c.callParent([b]);if(c.store){c.bindStore(c.store,true)}},bindComponent:function(a){var c=this,b={scope:this,resize:c.sizeMask,added:c.onComponentAdded,removed:c.onComponentRemoved};if(a.floating){b.move=c.sizeMask;c.activeOwner=a}else{if(a.ownerCt){c.onComponentAdded(a.ownerCt)}else{c.preventBringToFront=true}}c.mon(a,b);c.mon(c.hierarchyEventSource,{show:c.onContainerShow,hide:c.onContainerHide,expand:c.onContainerExpand,collapse:c.onContainerCollapse,scope:c})},onComponentAdded:function(a){var b=this;delete b.activeOwner;b.floatParent=a;if(!a.floating){a=a.up("[floating]")}if(a){b.activeOwner=a;b.mon(a,"move",b.sizeMask,b)}else{b.preventBringToFront=true}a=b.floatParent.ownerCt;if(b.rendered&&b.isVisible()&&a){b.floatOwner=a;b.mon(a,"afterlayout",b.sizeMask,b,{single:true})}},onComponentRemoved:function(a){var c=this,d=c.activeOwner,b=c.floatOwner;if(d){c.mun(d,"move",c.sizeMask,c)}if(b){c.mun(b,"afterlayout",c.sizeMask,c)}delete c.activeOwner;delete c.floatOwner},afterRender:function(){this.callParent(arguments);this.container=this.floatParent.getContentTarget()},onContainerShow:function(a){if(this.isActiveContainer(a)){this.onComponentShow()}},onContainerHide:function(a){if(this.isActiveContainer(a)){this.onComponentHide()}},onContainerExpand:function(a){if(this.isActiveContainer(a)){this.onComponentShow()}},onContainerCollapse:function(a){if(this.isActiveContainer(a)){this.onComponentHide()}},isActiveContainer:function(a){return this.isDescendantOf(a)},onComponentHide:function(){var a=this;if(a.rendered&&a.isVisible()){a.hide();a.showNext=true}},onComponentShow:function(){if(this.showNext){this.show()}delete this.showNext},sizeMask:function(){var a=this,b;if(a.rendered&&a.isVisible()){a.center();b=a.getMaskTarget();a.getMaskEl().show().setSize(b.getSize()).alignTo(b,"tl-tl")}},bindStore:function(a,b){var c=this;c.mixins.bindable.bindStore.apply(c,arguments);a=c.store;if(a&&a.isLoading()){c.onBeforeLoad()}},getStoreListeners:function(b){var d=this.onLoad,c=this.onBeforeLoad,a={cachemiss:c,cachefilled:d};if(!b.proxy.isSynchronous){a.beforeLoad=c;a.load=d;a.prefetch=d}return a},onDisable:function(){this.callParent(arguments);if(this.loading){this.onLoad()}},getOwner:function(){return this.ownerCt||this.floatParent},getMaskTarget:function(){var a=this.getOwner();return this.useTargetEl?a.getTargetEl():a.getEl()},onBeforeLoad:function(){var c=this,a=c.getOwner(),b;if(!c.disabled){c.loading=true;if(a.componentLayoutCounter){c.maybeShow()}else{b=a.afterComponentLayout;a.afterComponentLayout=function(){a.afterComponentLayout=b;b.apply(a,arguments);c.maybeShow()}}}},maybeShow:function(){var b=this,a=b.getOwner();if(!a.isVisible(true)){b.showNext=true}else{if(b.loading&&a.rendered){b.show()}}},getMaskEl:function(){var a=this;return a.maskEl||(a.maskEl=a.el.insertSibling({cls:a.maskCls,style:{zIndex:a.el.getStyle("zIndex")-2}},"before"))},onShow:function(){var b=this,a=b.msgEl;b.callParent(arguments);b.loading=true;if(b.useMsg){a.show();b.msgTextEl.update(b.msg)}else{a.parent().hide()}},hide:function(){if(this.isElement){this.ownerCt.unmask();this.fireEvent("hide",this);return}delete this.showNext;return this.callParent(arguments)},onHide:function(){this.callParent();this.getMaskEl().hide()},show:function(){if(this.isElement){this.ownerCt.mask(this.useMsg?this.msg:"",this.msgCls);this.fireEvent("show",this);return}return this.callParent(arguments)},afterShow:function(){this.callParent(arguments);this.sizeMask()},setZIndex:function(b){var c=this,a=c.activeOwner;if(a){b=parseInt(a.el.getStyle("zIndex"),10)+1}c.getMaskEl().setStyle("zIndex",b-1);return c.mixins.floating.setZIndex.apply(c,arguments)},onLoad:function(){this.loading=false;this.hide()},onDestroy:function(){var a=this;if(a.isElement){a.ownerCt.unmask()}Ext.destroy(a.maskEl);a.callParent()}});Ext.define("Ext.data.association.Association",{alternateClassName:"Ext.data.Association",primaryKey:"id",associationKeyFunction:null,defaultReaderType:"json",isAssociation:true,initialConfig:null,statics:{AUTO_ID:1000,create:function(a){if(Ext.isString(a)){a={type:a}}switch(a.type){case"belongsTo":return new Ext.data.association.BelongsTo(a);case"hasMany":return new Ext.data.association.HasMany(a);case"hasOne":return new Ext.data.association.HasOne(a);default:}return a}},constructor:function(d){Ext.apply(this,d);var h=this,g=Ext.ModelManager.types,j=d.ownerModel,a=d.associatedModel,e=g[j],i=g[a],b=d.associationKey,c;if(b){c=String(b).search(/[\[\.]/);if(c>=0){h.associationKeyFunction=Ext.functionFactory("obj","return obj"+(c>0?".":"")+b)}}h.initialConfig=d;h.ownerModel=e;h.associatedModel=i;Ext.applyIf(h,{ownerName:j,associatedName:a});h.associationId="association"+(++h.statics().AUTO_ID)},getReader:function(){var c=this,a=c.reader,b=c.associatedModel;if(a){if(Ext.isString(a)){a={type:a}}if(a.isReader){a.setModel(b)}else{Ext.applyIf(a,{model:b,type:c.defaultReaderType})}c.reader=Ext.createByAlias("reader."+a.type,a)}return c.reader||null}});Ext.define("Ext.ModelManager",{extend:Ext.AbstractManager,alternateClassName:"Ext.ModelMgr",singleton:true,typeName:"mtype",associationStack:[],registerType:function(c,b){var d=b.prototype,a;if(d&&d.isModel){a=b}else{if(!b.extend){b.extend="Ext.data.Model"}a=Ext.define(c,b)}this.types[c]=a;return a},onModelDefined:function(c){var a=this.associationStack,g=a.length,e=[],b,d,h;for(d=0;d<g;d++){b=a[d];if(b.associatedModel==c.modelName){e.push(b)}}for(d=0,g=e.length;d<g;d++){h=e[d];this.types[h.ownerModel].prototype.associations.add(Ext.data.association.Association.create(h));Ext.Array.remove(a,h)}},registerDeferredAssociation:function(a){this.associationStack.push(a)},getModel:function(b){var a=b;if(typeof a=="string"){a=this.types[a]}return a},create:function(b,a,d){var c=typeof a=="function"?a:this.types[a||b.name];return new c(b,d)}},function(){Ext.regModel=function(){return this.ModelManager.registerType.apply(this.ModelManager,arguments)}});Ext.define("Ext.layout.component.Component",{extend:Ext.layout.Layout,type:"component",isComponentLayout:true,nullBox:{},usesContentHeight:true,usesContentWidth:true,usesHeight:true,usesWidth:true,beginLayoutCycle:function(c,p){var k=this,b=k.owner,e=c.ownerCtContext,g=c.heightModel,h=c.widthModel,i=b.el.dom===document.body,d=b.lastBox||k.nullBox,n=b.el.lastBox||k.nullBox,a=!i,m,o,l,j;k.callParent(arguments);if(p){if(k.usesContentWidth){++c.consumersContentWidth}if(k.usesContentHeight){++c.consumersContentHeight}if(k.usesWidth){++c.consumersWidth}if(k.usesHeight){++c.consumersHeight}if(e&&!e.hasRawContent){m=b.ownerLayout;if(m.usesWidth){++c.consumersWidth}if(m.usesHeight){++c.consumersHeight}}}if(h.configured){l=h.names.width;if(!i){a=p?b[l]!==n.width:h.constrained}c.setWidth(b[l],a)}else{if(c.isTopLevel){if(h.calculated){o=d.width;c.setWidth(o,o!=n.width)}o=d.x;c.setProp("x",o,o!=n.x)}}if(g.configured){j=g.names.height;if(!i){a=p?b[j]!==n.height:g.constrained}c.setHeight(b[j],a)}else{if(c.isTopLevel){if(g.calculated){o=d.height;c.setHeight(o,o!=n.height)}o=d.y;c.setProp("y",o,o!=n.y)}}},finishedLayout:function(b){var h=this,l=b.children,a=h.owner,e,c,k,d,g,j;if(l){e=l.length;for(c=0;c<e;c++){k=l[c];k.el.lastBox=k.props}}b.previousSize=h.lastComponentSize;h.lastComponentSize=a.el.lastBox=g=b.props;d=a.lastBox||(a.lastBox={});d.x=g.x;d.y=g.y;d.width=g.width;d.height=g.height;d.invalid=false;h.callParent(arguments)},notifyOwner:function(d){var c=this,a=c.lastComponentSize,e=d.previousSize,b=[a.width,a.height];if(e){b.push(e.width,e.height)}c.owner.afterComponentLayout.apply(c.owner,b)},getTarget:function(){return this.owner.el},getRenderTarget:function(){return this.owner.el},cacheTargetInfo:function(b){var a=this,d=a.targetInfo,c;if(!d){c=b.getEl("getTarget",a);a.targetInfo=d={padding:c.getPaddingInfo(),border:c.getBorderInfo()}}return d},measureAutoDimensions:function(m,i){var t=this,a=t.owner,q=a.layout,d=m.heightModel,h=m.widthModel,c=m.boxParent,n=m.isBoxParent,b=m.props,j,u={gotWidth:false,gotHeight:false,isContainer:(j=!m.hasRawContent)},s=i||3,p,e,k=0,g=0,l,o,r;if(h.shrinkWrap&&m.consumersContentWidth){++k;p=!(s&1);if(j){if(p){u.contentWidth=0;u.gotWidth=true;++g}else{if((u.contentWidth=m.getProp("contentWidth"))!==undefined){u.gotWidth=true;++g}}}else{o=b.contentWidth;if(typeof o=="number"){u.contentWidth=o;u.gotWidth=true;++g}else{if(p){l=true}else{if(!m.hasDomProp("containerChildrenSizeDone")){l=false}else{if(n||!c||c.widthModel.shrinkWrap){l=true}else{l=c.hasDomProp("width")}}}if(l){if(p){r=0}else{if(q&&q.measureContentWidth){r=q.measureContentWidth(m)}else{r=t.measureContentWidth(m)}}if(!isNaN(u.contentWidth=r)){m.setContentWidth(r,true);u.gotWidth=true;++g}}}}}else{if(h.natural&&m.consumersWidth){++k;o=b.width;if(typeof o=="number"){u.width=o;u.gotWidth=true;++g}else{if(n||!c){l=true}else{l=c.hasDomProp("width")}if(l){if(!isNaN(u.width=t.measureOwnerWidth(m))){m.setWidth(u.width,false);u.gotWidth=true;++g}}}}}if(d.shrinkWrap&&m.consumersContentHeight){++k;e=!(s&2);if(j){if(e){u.contentHeight=0;u.gotHeight=true;++g}else{if((u.contentHeight=m.getProp("contentHeight"))!==undefined){u.gotHeight=true;++g}}}else{o=b.contentHeight;if(typeof o=="number"){u.contentHeight=o;u.gotHeight=true;++g}else{if(e){l=true}else{if(!m.hasDomProp("containerChildrenSizeDone")){l=false}else{if(a.noWrap){l=true}else{if(!h.shrinkWrap){l=(m.bodyContext||m).hasDomProp("width")}else{if(n||!c||c.widthModel.shrinkWrap){l=true}else{l=c.hasDomProp("width")}}}}}if(l){if(e){r=0}else{if(q&&q.measureContentHeight){r=q.measureContentHeight(m)}else{r=t.measureContentHeight(m)}}if(!isNaN(u.contentHeight=r)){m.setContentHeight(r,true);u.gotHeight=true;++g}}}}}else{if(d.natural&&m.consumersHeight){++k;o=b.height;if(typeof o=="number"){u.height=o;u.gotHeight=true;++g}else{if(n||!c){l=true}else{l=c.hasDomProp("width")}if(l){if(!isNaN(u.height=t.measureOwnerHeight(m))){m.setHeight(u.height,false);u.gotHeight=true;++g}}}}}if(c){m.onBoxMeasured()}u.gotAll=g==k;return u},measureContentWidth:function(a){return a.el.getWidth()-a.getFrameInfo().width},measureContentHeight:function(a){return a.el.getHeight()-a.getFrameInfo().height},measureOwnerHeight:function(a){return a.el.getHeight()},measureOwnerWidth:function(a){return a.el.getWidth()}});Ext.define("Ext.layout.component.Auto",{alias:"layout.autocomponent",extend:Ext.layout.component.Component,type:"autocomponent",setHeightInDom:false,setWidthInDom:false,waitForOuterHeightInDom:false,waitForOuterWidthInDom:false,beginLayoutCycle:function(d,a){var c=this,g=c.lastWidthModel,e=c.lastHeightModel,b=c.owner.el;c.callParent(arguments);if(g&&g.fixed&&d.widthModel.shrinkWrap){b.setWidth(null)}if(e&&e.fixed&&d.heightModel.shrinkWrap){b.setHeight(null)}},calculate:function(h){var g=this,e=g.measureAutoDimensions(h),b=h.heightModel,c=h.widthModel,d,a;if(e.gotWidth){if(c.shrinkWrap){g.publishOwnerWidth(h,e.contentWidth)}else{if(g.publishInnerWidth){g.publishInnerWidth(h,e.width)}}}else{if(!c.auto&&g.publishInnerWidth){d=g.waitForOuterWidthInDom?h.getDomProp("width"):h.getProp("width");if(d===undefined){g.done=false}else{g.publishInnerWidth(h,d)}}}if(e.gotHeight){if(b.shrinkWrap){g.publishOwnerHeight(h,e.contentHeight)}else{if(g.publishInnerHeight){g.publishInnerHeight(h,e.height)}}}else{if(!b.auto&&g.publishInnerHeight){a=g.waitForOuterHeightInDom?h.getDomProp("height"):h.getProp("height");if(a===undefined){g.done=false}else{g.publishInnerHeight(h,a)}}}if(!e.gotAll){g.done=false}},calculateOwnerHeightFromContentHeight:function(b,a){return a+b.getFrameInfo().height},calculateOwnerWidthFromContentWidth:function(b,a){return a+b.getFrameInfo().width},publishOwnerHeight:function(i,g){var e=this,b=e.owner,a=e.calculateOwnerHeightFromContentHeight(i,g),h,d,c;if(isNaN(a)){e.done=false}else{h=Ext.Number.constrain(a,b.minHeight,b.maxHeight);if(h==a){d=e.setHeightInDom}else{c=e.sizeModels[(h<a)?"constrainedMax":"constrainedMin"];a=h;if(i.heightModel.calculatedFromShrinkWrap){i.heightModel=c}else{i.invalidate({heightModel:c})}}i.setHeight(a,d)}},publishOwnerWidth:function(h,b){var g=this,a=g.owner,e=g.calculateOwnerWidthFromContentWidth(h,b),i,d,c;if(isNaN(e)){g.done=false}else{i=Ext.Number.constrain(e,a.minWidth,a.maxWidth);if(i==e){d=g.setWidthInDom}else{c=g.sizeModels[(i<e)?"constrainedMax":"constrainedMin"];e=i;if(h.widthModel.calculatedFromShrinkWrap){h.widthModel=c}else{h.invalidate({widthModel:c})}}h.setWidth(e,d)}}});Ext.define("Ext.ShadowPool",{singleton:true,markup:(function(){return Ext.String.format('<div class="{0}{1}-shadow" role="presentation"></div>',Ext.baseCSSPrefix,Ext.isIE&&!Ext.supports.CSS3BoxShadow?"ie":"css")}()),shadows:[],pull:function(){var a=this.shadows.shift();if(!a){a=Ext.get(Ext.DomHelper.insertHtml("beforeBegin",document.body.firstChild,this.markup));a.autoBoxAdjust=false}return a},push:function(a){this.shadows.push(a)},reset:function(){var c=[].concat(this.shadows),b,a=c.length;for(b=0;b<a;b++){c[b].remove()}this.shadows=[]}});Ext.define("Ext.Shadow",{localXYNames:{get:"getLocalXY",set:"setLocalXY"},constructor:function(b){var c=this,d,e,a;Ext.apply(c,b);if(!Ext.isString(c.mode)){c.mode=c.defaultMode}e=c.offset;a=Math.floor(e/2);c.opacity=50;switch(c.mode.toLowerCase()){case"drop":if(Ext.supports.CSS3BoxShadow){d={t:e,l:e,h:-e,w:-e}}else{d={t:-a,l:-a,h:-a,w:-a}}break;case"sides":if(Ext.supports.CSS3BoxShadow){d={t:e,l:0,h:-e,w:0}}else{d={t:-(1+a),l:1+a-2*e,h:-1,w:a-1}}break;case"frame":if(Ext.supports.CSS3BoxShadow){d={t:0,l:0,h:0,w:0}}else{d={t:1+a-2*e,l:1+a-2*e,h:e-a-1,w:e-a-1}}break;case"bottom":if(Ext.supports.CSS3BoxShadow){d={t:e,l:0,h:-e,w:0}}else{d={t:e,l:0,h:0,w:0}}break}c.adjusts=d},getShadowSize:function(){var b=this,d=b.el?b.offset:0,a=[d,d,d,d],c=b.mode.toLowerCase();if(b.el&&c!=="frame"){a[0]=0;if(c=="drop"){a[3]=0}}return a},offset:4,defaultMode:"drop",boxShadowProperty:(function(){var b="boxShadow",a=document.documentElement.style;if(!("boxShadow" in a)){if("WebkitBoxShadow" in a){b="WebkitBoxShadow"}else{if("MozBoxShadow" in a){b="MozBoxShadow"}}}return b}()),show:function(d){var b=this,a,c;d=Ext.get(d);a=(parseInt(d.getStyle("z-index"),10)-1)||0;c=d[b.localXYNames.get]();if(!b.el){b.el=Ext.ShadowPool.pull();if(b.fixed){b.el.dom.style.position="fixed"}else{b.el.dom.style.position=""}if(b.el.dom.nextSibling!=d.dom){b.el.insertBefore(d)}}b.el.setStyle("z-index",b.zIndex||a);if(Ext.isIE&&!Ext.supports.CSS3BoxShadow){b.el.dom.style.filter="progid:DXImageTransform.Microsoft.alpha(opacity="+b.opacity+") progid:DXImageTransform.Microsoft.Blur(pixelradius="+(b.offset)+")"}b.realign(c[0],c[1],d.dom.offsetWidth,d.dom.offsetHeight);b.el.dom.style.display="block"},isVisible:function(){return this.el?true:false},realign:function(c,m,j,g){if(!this.el){return}var b=this.adjusts,a=this.el,i=a.dom.style,d,e,h,k;a[this.localXYNames.set](c+b.l,m+b.t);d=Math.max(j+b.w,0);e=Math.max(g+b.h,0);h=d+"px";k=e+"px";if(i.width!=h||i.height!=k){i.width=h;i.height=k;if(Ext.supports.CSS3BoxShadow){i[this.boxShadowProperty]="0 0 "+(this.offset+2)+"px #888"}}},hide:function(){var a=this;if(a.el){a.el.dom.style.display="none";Ext.ShadowPool.push(a.el);delete a.el}},setZIndex:function(a){this.zIndex=a;if(this.el){this.el.setStyle("z-index",a)}},setOpacity:function(a){if(this.el){if(Ext.isIE&&!Ext.supports.CSS3BoxShadow){a=Math.floor(a*100/2)/100}this.opacity=a;this.el.setOpacity(a)}}});Ext.define("Ext.data.StoreManager",{extend:Ext.util.MixedCollection,alternateClassName:["Ext.StoreMgr","Ext.data.StoreMgr","Ext.StoreManager"],singleton:true,register:function(){for(var a=0,b;(b=arguments[a]);a++){this.add(b)}},unregister:function(){for(var a=0,b;(b=arguments[a]);a++){this.remove(this.lookup(b))}},lookup:function(c){if(Ext.isArray(c)){var b=["field1"],e=!Ext.isArray(c[0]),g=c,d,a;if(e){g=[];for(d=0,a=c.length;d<a;++d){g.push([c[d]])}}else{for(d=2,a=c[0].length;d<=a;++d){b.push("field"+d)}}return new Ext.data.ArrayStore({data:g,fields:b,autoDestroy:true,autoCreated:true,expanded:e})}if(Ext.isString(c)){return this.get(c)}else{return Ext.data.AbstractStore.create(c)}},getKey:function(a){return a.storeId}},function(){Ext.regStore=function(c,b){var a;if(Ext.isObject(c)){b=c}else{b.storeId=c}if(b instanceof Ext.data.Store){a=b}else{a=new Ext.data.Store(b)}return Ext.data.StoreManager.register(a)};Ext.getStore=function(a){return Ext.data.StoreManager.lookup(a)}});Ext.define("Ext.data.ResultSet",{loaded:true,count:0,total:0,success:false,constructor:function(a){Ext.apply(this,a);this.totalRecords=this.total;if(a.count===undefined){this.count=this.records.length}}});Ext.define("Ext.data.reader.Reader",{alternateClassName:["Ext.data.Reader","Ext.data.DataReader"],mixins:{observable:Ext.util.Observable},totalProperty:"total",successProperty:"success",root:"",implicitIncludes:true,readRecordsOnFailure:true,isReader:true,applyDefaults:true,lastFieldGeneration:null,constructor:function(a){var b=this;b.mixins.observable.constructor.call(b,a);b.fieldCount=0;b.model=Ext.ModelManager.getModel(b.model);b.accessExpressionFn=Ext.Function.bind(b.createFieldAccessExpression,b);if(b.model&&b.model.prototype.fields){b.buildExtractors()}this.addEvents("exception")},setModel:function(a,c){var b=this;b.model=Ext.ModelManager.getModel(a);if(a){b.buildExtractors(true)}if(c&&b.proxy){b.proxy.setModel(b.model,true)}},read:function(a){var b;if(a){b=a.responseText?this.getResponseData(a):this.readRecords(a)}return b||this.nullResultSet},readRecords:function(c){var d=this,i,b,a,g,e,h,j;if(d.lastFieldGeneration!==d.model.prototype.fields.generation){d.buildExtractors(true)}d.rawData=c;c=d.getData(c);i=true;b=0;a=[];if(d.successProperty){h=d.getSuccess(c);if(h===false||h==="false"){i=false}}if(d.messageProperty){j=d.getMessage(c)}if(d.readRecordsOnFailure||i){g=Ext.isArray(c)?c:d.getRoot(c);if(g){e=g.length}if(d.totalProperty){h=parseInt(d.getTotal(c),10);if(!isNaN(h)){e=h}}if(g){a=d.extractData(g);b=a.length}}return new Ext.data.ResultSet({total:e||b,count:b,records:a,success:i,message:j})},extractData:function(k){var j=this,b=j.model,a=k.length,d=new Array(a),e,c,h,g;if(!k.length&&Ext.isObject(k)){k=[k];a=1}for(g=0;g<a;g++){c=k[g];if(c.isModel){d[g]=c}else{d[g]=h=new b(undefined,j.getId(c),c,e={});h.phantom=false;j.convertRecordData(e,c,h);if(j.implicitIncludes&&h.associations.length){j.readAssociated(h,c)}}}return d},readAssociated:function(h,e){var d=h.associations.items,g=0,a=d.length,c,b,k,j;for(;g<a;g++){c=d[g];b=this.getAssociatedDataRoot(e,c.associationKeyFunction||c.associationKey||c.name);if(b){j=c.getReader();if(!j){k=c.associatedModel.getProxy();if(k){j=k.getReader()}else{j=new this.constructor({model:c.associatedName})}}c.read(h,j,b)}}},getAssociatedDataRoot:function(b,a){if(Ext.isFunction(a)){return a(b)}return b[a]},getFields:function(){return this.model.prototype.fields.items},getData:Ext.identityFn,getRoot:Ext.identityFn,getResponseData:function(a){},onMetaChange:function(e){var d=this,b=e.fields||d.getFields(),c,a;d.metaData=e;d.root=e.root||d.root;d.idProperty=e.idProperty||d.idProperty;d.totalProperty=e.totalProperty||d.totalProperty;d.successProperty=e.successProperty||d.successProperty;d.messageProperty=e.messageProperty||d.messageProperty;a=e.clientIdProperty;if(d.model){d.model.setFields(b,d.idProperty,a);d.setModel(d.model,true)}else{c=Ext.define("Ext.data.reader.Json-Model"+Ext.id(),{extend:"Ext.data.Model",fields:b,clientIdProperty:a});if(d.idProperty){c.idProperty=d.idProperty}d.setModel(c,true)}},getIdProperty:function(){var b=this.model.prototype.idField,a=this.idProperty;if(!a&&b&&(a=b.mapping)==null){a=b.name}return a},buildExtractors:function(e){var c=this,h=c.getIdProperty(),d=c.totalProperty,b=c.successProperty,g=c.messageProperty,a;if(e===true){delete c.convertRecordData}if(c.convertRecordData){return}if(d){c.getTotal=c.createAccessor(d)}if(b){c.getSuccess=c.createAccessor(b)}if(g){c.getMessage=c.createAccessor(g)}if(h){a=c.createAccessor(h);c.getId=function(i){var j=a.call(c,i);return(j===undefined||j==="")?null:j}}else{c.getId=function(){return null}}c.convertRecordData=c.buildRecordDataExtractor();c.lastFieldGeneration=c.model.prototype.fields.generation},recordDataExtractorTemplate:["var me = this\n","    ,fields = me.model.prototype.fields\n","    ,value\n","    ,internalId\n",'<tpl for="fields">','    ,__field{#} = fields.map["{name}"]\n',"</tpl>",";\n","return function(dest, source, record) {\n",'<tpl for="fields">','{% var fieldAccessExpression =  this.createFieldAccessExpression(values, "__field" + xindex, "source");',"   if (fieldAccessExpression) { %}",'    value = {[ this.createFieldAccessExpression(values, "__field" + xindex, "source") ]};\n','<tpl if="hasCustomConvert">','    dest["{name}"] = value === undefined ? __field{#}.convert(__field{#}.defaultValue, record) : __field{#}.convert(value, record);\n','<tpl elseif="defaultValue !== undefined">',"    if (value === undefined) {\n","        if (me.applyDefaults) {\n",'<tpl if="convert">','            dest["{name}"] = __field{#}.convert(__field{#}.defaultValue, record);\n',"<tpl else>",'            dest["{name}"] = __field{#}.defaultValue\n',"</tpl>","        };\n","    } else {\n",'<tpl if="convert">','        dest["{name}"] = __field{#}.convert(value, record);\n',"<tpl else>",'        dest["{name}"] = value;\n',"</tpl>","    };\n","<tpl else>","    if (value !== undefined) {\n",'<tpl if="convert">','        dest["{name}"] = __field{#}.convert(value, record);\n',"<tpl else>",'        dest["{name}"] = value;\n',"</tpl>","    }\n","</tpl>","{% } else { %}",'<tpl if="defaultValue !== undefined">','<tpl if="convert">','    dest["{name}"] = __field{#}.convert(__field{#}.defaultValue, record);\n',"<tpl else>",'    dest["{name}"] = __field{#}.defaultValue\n',"</tpl>","</tpl>","{% } %}","</tpl>",'<tpl if="clientIdProp">','    if (record && (internalId = {[ this.createFieldAccessExpression({mapping: values.clientIdProp}, null, "source") ]})) {\n','        record.{["internalId"]} = internalId;\n',"    }\n","</tpl>","};"],buildRecordDataExtractor:function(){var c=this,a=c.model.prototype,b={clientIdProp:a.clientIdProperty,fields:a.fields.items};c.recordDataExtractorTemplate.createFieldAccessExpression=c.accessExpressionFn;return Ext.functionFactory(c.recordDataExtractorTemplate.apply(b)).call(c)},destroyReader:function(){var a=this;delete a.proxy;delete a.model;delete a.convertRecordData;delete a.getId;delete a.getTotal;delete a.getSuccess;delete a.getMessage}},function(){var a=this.prototype;Ext.apply(a,{nullResultSet:new Ext.data.ResultSet({total:0,count:0,records:[],success:true,message:""}),recordDataExtractorTemplate:new Ext.XTemplate(a.recordDataExtractorTemplate)})});Ext.define("Ext.data.reader.Json",{extend:Ext.data.reader.Reader,alternateClassName:"Ext.data.JsonReader",alias:"reader.json",root:"",metaProperty:"metaData",useSimpleAccessors:false,readRecords:function(b){var a=this,c;if(a.getMeta){c=a.getMeta(b);if(c){a.onMetaChange(c)}}else{if(b.metaData){a.onMetaChange(b.metaData)}}a.jsonData=b;return a.callParent([b])},getResponseData:function(a){var d,b;try{d=Ext.decode(a.responseText);return this.readRecords(d)}catch(c){b=new Ext.data.ResultSet({total:0,count:0,records:[],success:false,message:c.message});this.fireEvent("exception",this,a,b);Ext.Logger.warn("Unable to parse the JSON returned by the server");return b}},buildExtractors:function(){var b=this,a=b.metaProperty;b.callParent(arguments);if(b.root){b.getRoot=b.createAccessor(b.root)}else{b.getRoot=Ext.identityFn}if(a){b.getMeta=b.createAccessor(a)}},extractData:function(a){var e=this.record,d=[],c,b;if(e){c=a.length;if(!c&&Ext.isObject(a)){c=1;a=[a]}for(b=0;b<c;b++){d[b]=a[b][e]}}else{d=a}return this.callParent([d])},createAccessor:(function(){var a=/[\[\.]/;return function(c){if(Ext.isEmpty(c)){return Ext.emptyFn}if(Ext.isFunction(c)){return c}if(this.useSimpleAccessors!==true){var b=String(c).search(a);if(b>=0){return Ext.functionFactory("obj","return obj"+(b>0?".":"")+c)}}return function(d){return d[c]}}}()),createFieldAccessExpression:(function(){var a=/[\[\.]/;return function(o,d,e){var b=o.mapping,m=b||b===0,c=m?b:o.name,p,g;if(b===false){return}if(typeof c==="function"){p=d+".mapping("+e+", this)"}else{if(this.useSimpleAccessors===true||((g=String(c).search(a))<0)){if(!m||isNaN(c)){c='"'+c+'"'}p=e+"["+c+"]"}else{if(g===0){p=e+c}else{var j=c.split("."),l=j.length,k=1,n=e+"."+j[0],h=[n];for(;k<l;k++){n+="."+j[k];h.push(n)}p=h.join(" && ")}}}return p}}())});Ext.define("Ext.data.writer.Writer",{alias:"writer.base",alternateClassName:["Ext.data.DataWriter","Ext.data.Writer"],writeAllFields:true,nameProperty:"name",writeRecordId:true,isWriter:true,constructor:function(a){Ext.apply(this,a)},write:function(e){var c=e.operation,b=c.records||[],a=b.length,d=0,g=[];for(;d<a;d++){g.push(this.getRecordData(b[d],c))}return this.writeRecords(e,g)},getRecordData:function(d,b){var m=d.phantom===true,a=this.writeAllFields||m,g=d.fields,o=g.items,c={},k=d.clientIdProperty,j,i,n,l,e,h,p;if(a){p=o.length;for(h=0;h<p;h++){i=o[h];if(i.persist){this.writeValue(c,i,d)}}}else{j=d.getChanges();for(n in j){if(j.hasOwnProperty(n)){i=g.get(n);if(i.persist){this.writeValue(c,i,d)}}}}if(m){if(k&&b&&b.records.length>1){c[k]=d.internalId}}else{if(this.writeRecordId){e=g.get(d.idProperty)[this.nameProperty]||d.idProperty;c[e]=d.getId()}}return c},writeValue:function(e,g,b){var c=g[this.nameProperty]||g.name,a=this.dateFormat||g.dateWriteFormat||g.dateFormat,d=b.get(g.name);if(g.serialize){e[c]=g.serialize(d,b)}else{if(g.type===Ext.data.Types.DATE&&a&&Ext.isDate(d)){e[c]=Ext.Date.format(d,a)}else{e[c]=d}}}});Ext.define("Ext.data.writer.Json",{extend:Ext.data.writer.Writer,alternateClassName:"Ext.data.JsonWriter",alias:"writer.json",root:undefined,encode:false,allowSingle:true,expandData:false,getExpandedData:function(d){var b=d.length,e=0,k,a,g,c,h,l=function(i,j){var m={};m[i]=j;return m};for(;e<b;e++){k=d[e];for(a in k){if(k.hasOwnProperty(a)){g=a.split(".");c=g.length-1;if(c>0){h=k[a];for(;c>0;c--){h=l(g[c],h)}k[g[0]]=k[g[0]]||{};Ext.Object.merge(k[g[0]],h);delete k[a]}}}}return d},writeRecords:function(b,c){var a=this.root;if(this.expandData){c=this.getExpandedData(c)}if(this.allowSingle&&c.length===1){c=c[0]}if(this.encode){if(a){b.params[a]=Ext.encode(c)}else{}}else{b.jsonData=b.jsonData||{};if(a){b.jsonData[a]=c}else{b.jsonData=c}}return b}});Ext.define("Ext.data.proxy.Proxy",{alias:"proxy.proxy",alternateClassName:["Ext.data.DataProxy","Ext.data.Proxy"],mixins:{observable:Ext.util.Observable},batchOrder:"create,update,destroy",batchActions:true,defaultReaderType:"json",defaultWriterType:"json",isProxy:true,constructor:function(a){var b=this;a=a||{};b.proxyConfig=a;b.mixins.observable.constructor.call(b,a);if(b.model!==undefined&&!(b.model instanceof Ext.data.Model)){b.setModel(b.model)}else{if(b.reader){b.setReader(b.reader)}if(b.writer){b.setWriter(b.writer)}}},setModel:function(a,b){var c=this;c.model=Ext.ModelManager.getModel(a);c.setReader(this.reader);c.setWriter(this.writer);if(b&&c.store){c.store.setModel(c.model)}},getModel:function(){return this.model},setReader:function(a){var c=this,b=true,d=c.reader;if(a===undefined||typeof a=="string"){a={type:a};b=false}if(a.isReader){a.setModel(c.model)}else{if(b){a=Ext.apply({},a)}Ext.applyIf(a,{proxy:c,model:c.model,type:c.defaultReaderType});a=Ext.createByAlias("reader."+a.type,a)}if(a!==d&&a.onMetaChange){a.onMetaChange=Ext.Function.createSequence(a.onMetaChange,this.onMetaChange,this)}c.reader=a;return c.reader},getReader:function(){return this.reader},onMetaChange:function(a){this.fireEvent("metachange",this,a)},setWriter:function(c){var b=this,a=true;if(c===undefined||typeof c=="string"){c={type:c};a=false}if(!c.isWriter){if(a){c=Ext.apply({},c)}Ext.applyIf(c,{model:b.model,type:b.defaultWriterType});c=Ext.createByAlias("writer."+c.type,c)}b.writer=c;return b.writer},getWriter:function(){return this.writer},create:Ext.emptyFn,read:Ext.emptyFn,update:Ext.emptyFn,destroy:Ext.emptyFn,batch:function(o,l){var k=this,j=k.batchActions,h,c,g,d,e,m,b,n,i;if(o.operations===undefined){o={operations:o,listeners:l}}if(o.batch){if(Ext.isDefined(o.batch.runOperation)){h=Ext.applyIf(o.batch,{proxy:k,listeners:{}})}}else{o.batch={proxy:k,listeners:o.listeners||{}}}if(!h){h=new Ext.data.Batch(o.batch)}h.on("complete",Ext.bind(k.onBatchComplete,k,[o],0));g=k.batchOrder.split(",");d=g.length;for(m=0;m<d;m++){e=g[m];c=o.operations[e];if(c){if(j){h.add(new Ext.data.Operation({action:e,records:c}))}else{n=c.length;for(b=0;b<n;b++){i=c[b];h.add(new Ext.data.Operation({action:e,records:[i]}))}}}}h.start();return h},onBatchComplete:function(a,b){var c=a.scope||this;if(b.hasException){if(Ext.isFunction(a.failure)){Ext.callback(a.failure,c,[b,a])}}else{if(Ext.isFunction(a.success)){Ext.callback(a.success,c,[b,a])}}if(Ext.isFunction(a.callback)){Ext.callback(a.callback,c,[b,a])}},clone:function(){return new this.self(this.proxyConfig)}});Ext.define("Ext.data.Operation",{synchronous:true,action:undefined,filters:undefined,sorters:undefined,groupers:undefined,start:undefined,limit:undefined,batch:undefined,callback:undefined,scope:undefined,started:false,running:false,complete:false,success:undefined,exception:false,error:undefined,actionCommitRecordsRe:/^(?:create|update)$/i,actionSkipSyncRe:/^destroy$/i,constructor:function(a){Ext.apply(this,a||{})},commitRecords:function(n){var j=this,m=j.actionCommitRecordsRe.test(j.action),l,h,a,e,b,d,g,k,c;if(!j.actionSkipSyncRe.test(j.action)){a=j.records;if(a&&a.length){if(m){c=[]}if(a.length>1){if(j.action=="update"||a[0].clientIdProperty){l=new Ext.util.MixedCollection();l.addAll(n);for(h=a.length;h--;){b=a[h];e=l.findBy(j.matchClientRec,b);k=b.copyFrom(e);if(m){c.push(k)}}}else{for(d=0,g=a.length;d<g;++d){b=a[d];e=n[d];if(b&&e){k=j.updateRecord(b,e);if(m){c.push(k)}}}}}else{k=j.updateRecord(a[0],n[0]);if(m){c[0]=k}}if(m){for(h=a.length;h--;){a[h].commit(false,c[h])}}}}},updateRecord:function(a,b){if(b&&(a.phantom||a.getId()===b.getId())){return a.copyFrom(b)}return[]},matchClientRec:function(c){var a=this,b=a.getId();if(b&&c.getId()===b){return true}return c.internalId===a.internalId},setStarted:function(){this.started=true;this.running=true},setCompleted:function(){this.complete=true;this.running=false},setSuccessful:function(){this.success=true},setException:function(a){this.exception=true;this.success=false;this.running=false;this.error=a},hasException:function(){return this.exception===true},getError:function(){return this.error},getRecords:function(){var a=this.getResultSet();return this.records||(a?a.records:null)},getResultSet:function(){return this.resultSet},isStarted:function(){return this.started===true},isRunning:function(){return this.running===true},isComplete:function(){return this.complete===true},wasSuccessful:function(){return this.isComplete()&&this.success===true},setBatch:function(a){this.batch=a},allowWrite:function(){return this.action!="read"}});Ext.define("Ext.data.AbstractStore",{mixins:{observable:Ext.util.Observable,sortable:Ext.util.Sortable},statics:{create:function(a){if(!a.isStore){if(!a.type){a.type="store"}a=Ext.createByAlias("store."+a.type,a)}return a}},onClassExtended:function(b,d,a){var c=d.model,e;if(typeof c=="string"){e=a.onBeforeCreated;a.onBeforeCreated=function(){var h=this,g=arguments;Ext.require(c,function(){e.apply(h,g)})}}},remoteSort:false,remoteFilter:false,autoLoad:undefined,autoSync:false,batchUpdateMode:"operation",filterOnLoad:true,sortOnLoad:true,implicitModel:false,defaultProxyType:"memory",isDestroyed:false,isStore:true,sortRoot:"data",constructor:function(a){var c=this,b;Ext.apply(c,a);c.removed=[];c.mixins.observable.constructor.apply(c,arguments);c.model=Ext.ModelManager.getModel(c.model);Ext.applyIf(c,{modelDefaults:null});if(!c.model&&c.fields){c.model=Ext.define("Ext.data.Store.ImplicitModel-"+(c.storeId||Ext.id()),{extend:"Ext.data.Model",fields:c.fields,proxy:c.proxy||c.defaultProxyType});delete c.fields;c.implicitModel=true}c.setProxy(c.proxy||c.model.getProxy());c.proxy.on("metachange",c.onMetaChange,c);if(c.id&&!c.storeId){c.storeId=c.id;delete c.id}if(c.storeId){Ext.data.StoreManager.register(c)}c.mixins.sortable.initSortable.call(c);b=c.decodeFilters(c.filters);c.filters=new Ext.util.MixedCollection();c.filters.addAll(b)},setProxy:function(a){var b=this;if(a instanceof Ext.data.proxy.Proxy){a.setModel(b.model)}else{if(Ext.isString(a)){a={type:a}}Ext.applyIf(a,{model:b.model});a=Ext.createByAlias("proxy."+a.type,a)}b.proxy=a;return b.proxy},getProxy:function(){return this.proxy},onMetaChange:function(a,b){this.fireEvent("metachange",this,b)},create:function(e,c){var d=this,a=Ext.ModelManager.create(Ext.applyIf(e,d.modelDefaults),d.model.modelName),b;c=c||{};Ext.applyIf(c,{action:"create",records:[a]});b=new Ext.data.Operation(c);d.proxy.create(b,d.onProxyWrite,d);return a},read:function(){return this.load.apply(this,arguments)},update:function(b){var c=this,a;b=b||{};Ext.applyIf(b,{action:"update",records:c.getUpdatedRecords()});a=new Ext.data.Operation(b);return c.proxy.update(a,c.onProxyWrite,c)},onProxyWrite:function(b){var c=this,d=b.wasSuccessful(),a=b.getRecords();switch(b.action){case"create":c.onCreateRecords(a,b,d);break;case"update":c.onUpdateRecords(a,b,d);break;case"destroy":c.onDestroyRecords(a,b,d);break}if(d){c.fireEvent("write",c,b);c.fireEvent("datachanged",c);c.fireEvent("refresh",c)}Ext.callback(b.callback,b.scope||c,[a,b,d])},onCreateRecords:Ext.emptyFn,onUpdateRecords:Ext.emptyFn,onDestroyRecords:function(b,a,c){if(c){this.removed=[]}},destroy:function(b){var c=this,a;b=b||{};Ext.applyIf(b,{action:"destroy",records:c.getRemovedRecords()});a=new Ext.data.Operation(b);return c.proxy.destroy(a,c.onProxyWrite,c)},onBatchOperationComplete:function(b,a){return this.onProxyWrite(a)},onBatchComplete:function(c,a){var g=this,b=c.operations,e=b.length,d;g.suspendEvents();for(d=0;d<e;d++){g.onProxyWrite(b[d])}g.resumeEvents();g.fireEvent("datachanged",g);g.fireEvent("refresh",g)},onBatchException:function(b,a){},filterNew:function(a){return a.phantom===true&&a.isValid()},getNewRecords:function(){return[]},getUpdatedRecords:function(){return[]},getModifiedRecords:function(){return[].concat(this.getNewRecords(),this.getUpdatedRecords())},filterUpdated:function(a){return a.dirty===true&&a.phantom!==true&&a.isValid()},getRemovedRecords:function(){return this.removed},filter:function(a,b){},decodeFilters:function(e){if(!Ext.isArray(e)){if(e===undefined){e=[]}else{e=[e]}}var d=e.length,a=Ext.util.Filter,b,c;for(c=0;c<d;c++){b=e[c];if(!(b instanceof a)){Ext.apply(b,{root:"data"});if(b.fn){b.filterFn=b.fn}if(typeof b=="function"){b={filterFn:b}}e[c]=new a(b)}}return e},clearFilter:function(a){},isFiltered:function(){},filterBy:function(b,a){},sync:function(c){var e=this,b={},g=e.getNewRecords(),d=e.getUpdatedRecords(),a=e.getRemovedRecords(),h=false;if(g.length>0){b.create=g;h=true}if(d.length>0){b.update=d;h=true}if(a.length>0){b.destroy=a;h=true}if(h&&e.fireEvent("beforesync",b)!==false){c=c||{};e.proxy.batch(Ext.apply(c,{operations:b,listeners:e.getBatchListeners()}))}return e},getBatchListeners:function(){var b=this,a={scope:b,exception:b.onBatchException};if(b.batchUpdateMode=="operation"){a.operationcomplete=b.onBatchOperationComplete}else{a.complete=b.onBatchComplete}return a},save:function(){return this.sync.apply(this,arguments)},load:function(b){var c=this,a;b=Ext.apply({action:"read",filters:c.filters.items,sorters:c.getSorters()},b);c.lastOptions=b;a=new Ext.data.Operation(b);if(c.fireEvent("beforeload",c,a)!==false){c.loading=true;c.proxy.read(a,c.onProxyLoad,c)}return c},reload:function(a){return this.load(Ext.apply(this.lastOptions,a))},afterEdit:function(a,e){var d=this,b,c;if(d.autoSync&&!d.autoSyncSuspended){for(b=e.length;b--;){if(a.fields.get(e[b]).persist){c=true;break}}if(c){d.sync()}}d.onUpdate(a,Ext.data.Model.EDIT,e);d.fireEvent("update",d,a,Ext.data.Model.EDIT,e)},afterReject:function(a){this.onUpdate(a,Ext.data.Model.REJECT,null);this.fireEvent("update",this,a,Ext.data.Model.REJECT,null)},afterCommit:function(a,b){if(!b){b=null}this.onUpdate(a,Ext.data.Model.COMMIT,b);this.fireEvent("update",this,a,Ext.data.Model.COMMIT,b)},onUpdate:Ext.emptyFn,onIdChanged:function(c,d,b,a){this.fireEvent("idchanged",this,c,d,b,a)},destroyStore:function(){var a=this;if(!a.isDestroyed){a.clearListeners();if(a.storeId){Ext.data.StoreManager.unregister(a)}a.clearData();a.data=a.tree=a.sorters=a.filters=a.groupers=null;if(a.reader){a.reader.destroyReader()}a.proxy=a.reader=a.writer=null;a.isDestroyed=true;if(a.implicitModel){Ext.destroy(a.model)}else{a.model=null}}},getState:function(){var e=this,c,a,b=!!e.groupers,g=[],h=[],d=[];if(b){e.groupers.each(function(i){g[g.length]=i.serialize();c=true})}if(e.sorters){e.sorters.each(function(i){if(b&&!e.groupers.contains(i)){h[h.length]=i.serialize();c=true}})}if(e.filters&&e.statefulFilters){e.filters.each(function(i){d[d.length]=i.serialize();c=true})}if(c){a={};if(g.length){a.groupers=g}if(h.length){a.sorters=h}if(d.length){a.filters=d}return a}},applyState:function(g){var e=this,c=!!e.sorters,b=!!e.groupers,a=!!e.filters,d;if(b&&g.groupers){e.groupers.clear();e.groupers.addAll(e.decodeGroupers(g.groupers))}if(c&&g.sorters){e.sorters.clear();e.sorters.addAll(e.decodeSorters(g.sorters))}if(a&&g.filters){e.filters.clear();e.filters.addAll(e.decodeFilters(g.filters))}if(c&&b){e.sorters.insert(0,e.groupers.getRange())}if(e.remoteSort||e.remoteGroup||e.remoteFilter){e.reload()}if(a&&e.filters.length&&!e.remoteFilter){e.filter();d=e.sortOnFilter}if(c&&e.sorters.length&&!e.remoteSort&&!d){e.sort()}},doSort:function(a){var b=this;if(b.remoteSort){b.load()}else{b.data.sortBy(a);b.fireEvent("datachanged",b);b.fireEvent("refresh",b)}b.fireEvent("sort",b,b.sorters.getRange())},clearData:Ext.emptyFn,getCount:Ext.emptyFn,getById:Ext.emptyFn,removeAll:Ext.emptyFn,isLoading:function(){return !!this.loading},suspendAutoSync:function(){this.autoSyncSuspended=true},resumeAutoSync:function(){this.autoSyncSuspended=false}});Ext.define("Ext.container.DockingContainer",{isDockingContainer:true,defaultDockWeights:{top:{render:1,visual:1},left:{render:3,visual:5},right:{render:5,visual:7},bottom:{render:7,visual:3}},dockOrder:{top:-1,left:-1,right:1,bottom:1},horizontalDocks:0,addDocked:function(a,g){var e=this,b=0,d,c;a=e.prepareItems(a);c=a.length;for(;b<c;b++){d=a[b];d.dock=d.dock||"top";if(d.dock==="left"||d.dock==="right"){e.horizontalDocks++}if(g!==undefined){b+=g;e.dockedItems.insert(b,d)}else{e.dockedItems.add(d)}d.onAdded(e,b);if(e.hasListeners.dockedadd){e.fireEvent("dockedadd",e,d,b)}if(e.onDockedAdd!==Ext.emptyFn){e.onDockedAdd(d)}}if(e.rendered&&!e.suspendLayout){e.updateLayout()}return a},destroyDockedItems:function(){var a=this.dockedItems,b;if(a){while((b=a.first())){this.removeDocked(b,true)}}},doRenderDockedItems:function(c,g,h){var e=g.$comp,d=e.componentLayout,b,a;if(d.getDockedItems&&!g.$skipDockedItems){b=d.getDockedItems("render",!h);a=b&&d.getItemsRenderTree(b);if(a){Ext.DomHelper.generateMarkup(a,c)}}},getDockedComponent:function(a){if(Ext.isObject(a)){a=a.getItemId()}return this.dockedItems.get(a)},getDockedItems:function(a,c){var b=this.getComponentLayout().getDockedItems("render",c);if(a&&b.length){b=Ext.ComponentQuery.query(a,b)}return b},getDockingRefItems:function(b,e){var a=b&&"*,* *",d=this.getDockedItems(a,true),c;d.push.apply(d,e);c=this.getDockedItems(a,false);d.push.apply(d,c);return d},initDockingItems:function(){var b=this,a=b.dockedItems;b.dockedItems=new Ext.util.AbstractMixedCollection(false,b.getComponentId);if(a){b.addDocked(a)}},insertDocked:function(b,a){this.addDocked(a,b)},onDockedAdd:Ext.emptyFn,onDockedRemove:Ext.emptyFn,removeDocked:function(e,b){var d=this,c,a;b=b===true||(b!==false&&d.autoDestroy);if(!d.dockedItems.contains(e)){return e}if(e.dock==="left"||e.dock==="right"){d.horizontalDocks--}c=d.componentLayout;a=c&&d.rendered;if(a){c.onRemove(e)}d.dockedItems.remove(e);e.onRemoved(e.destroying||b);d.onDockedRemove(e);if(b){e.destroy()}else{if(a){c.afterRemove(e)}}if(d.hasListeners.dockedremove){d.fireEvent("dockedremove",d,e)}if(!d.destroying&&!d.suspendLayout){d.updateLayout()}return e},setupDockingRenderTpl:function(a){a.renderDockedItems=this.doRenderDockedItems}});Ext.define("Ext.toolbar.Fill",{extend:Ext.Component,alias:"widget.tbfill",alternateClassName:"Ext.Toolbar.Fill",isFill:true,flex:1});Ext.define("Ext.layout.container.boxOverflow.None",{alternateClassName:"Ext.layout.boxOverflow.None",constructor:function(b,a){this.layout=b;Ext.apply(this,a)},handleOverflow:Ext.emptyFn,clearOverflow:Ext.emptyFn,beginLayout:Ext.emptyFn,beginLayoutCycle:Ext.emptyFn,calculate:function(b){var a=this,c=b.state.boxPlan,d;if(c&&c.tooNarrow){d=a.handleOverflow(b);if(d){if(d.reservedSpace){a.layout.publishInnerCtSize(b,d.reservedSpace)}}}else{a.clearOverflow()}},completeLayout:Ext.emptyFn,finishedLayout:function(d){var c=this,a=c.layout.owner,b,e;if(a.hasListeners.overflowchange){b=a.query(">[hidden]");e=b.length;if(e!==c.lastHiddenCount){a.fireEvent("overflowchange",c.lastHiddenCount,e,b);c.lastHiddenCount=e}}},onRemove:Ext.emptyFn,getItem:function(a){return this.layout.owner.getComponent(a)},getOwnerType:function(a){var b;if(a.isToolbar){b="toolbar"}else{if(a.isTabBar){b="tabbar"}else{if(a.isMenu){b="menu"}else{b=a.getXType()}}}return b},getPrefixConfig:Ext.emptyFn,getSuffixConfig:Ext.emptyFn,getOverflowCls:function(){return""}});Ext.define("Ext.toolbar.Item",{extend:Ext.Component,alias:"widget.tbitem",alternateClassName:"Ext.Toolbar.Item",enable:Ext.emptyFn,disable:Ext.emptyFn,focus:Ext.emptyFn});Ext.define("Ext.toolbar.Separator",{extend:Ext.toolbar.Item,alias:"widget.tbseparator",alternateClassName:"Ext.Toolbar.Separator",baseCls:Ext.baseCSSPrefix+"toolbar-separator",focusable:false,border:true});Ext.define("Ext.button.Manager",{singleton:true,alternateClassName:"Ext.ButtonToggleManager",groups:{},buttonSelector:"."+Ext.baseCSSPrefix+"btn",init:function(){var a=this;if(a.initialized){return}Ext.getBody().on("keydown",a.onKeyDown,a);a.initialized=true},onKeyDown:function(c){var a=c.getKey(),b;if(a===c.SPACE||a===c.ENTER){b=c.getTarget(this.buttonSelector);if(b){Ext.getCmp(b.id).onClick(c)}}},toggleGroup:function(b,e){if(e){var d=this.groups[b.toggleGroup],c=d.length,a;for(a=0;a<c;a++){if(d[a]!==b){d[a].toggle(false)}}}},register:function(b){var c=this,a=this.groups,d=a[b.toggleGroup];c.init();if(!b.toggleGroup){return}if(!d){d=a[b.toggleGroup]=[]}d.push(b);b.on("toggle",c.toggleGroup,c)},unregister:function(a){if(!a.toggleGroup){return}var b=this,c=b.groups[a.toggleGroup];if(c){Ext.Array.remove(c,a);a.un("toggle",b.toggleGroup,b)}},getPressed:function(d){var c=this.groups[d],b=0,a;if(c){for(a=c.length;b<a;b++){if(c[b].pressed===true){return c[b]}}}return null}});Ext.define("Ext.menu.Manager",{singleton:true,alternateClassName:"Ext.menu.MenuMgr",menuSelector:"."+Ext.baseCSSPrefix+"menu",menus:{},groups:{},attached:false,lastShow:new Date(),init:function(){var a=this;a.active=new Ext.util.MixedCollection();Ext.getDoc().addKeyListener(27,function(){if(a.active.length>0){a.hideAll()}},a)},hideAll:function(){var c=this.active,e,b,a,d;if(c&&c.length>0){e=c.clone();b=e.items;d=b.length;for(a=0;a<d;a++){b[a].hide()}return true}return false},onHide:function(a){var b=this,c=b.active;c.remove(a);if(c.length<1){Ext.getDoc().un("mousedown",b.onMouseDown,b);b.attached=false}},onShow:function(a){var c=this,d=c.active,b=c.attached;c.lastShow=new Date();d.add(a);if(!b){Ext.getDoc().on("mousedown",c.onMouseDown,c,{buffer:Ext.isIE9m?10:undefined});c.attached=true}a.toFront()},onBeforeHide:function(a){if(a.activeChild){a.activeChild.hide()}if(a.autoHideTimer){clearTimeout(a.autoHideTimer);delete a.autoHideTimer}},onBeforeShow:function(a){var c=this.active,b=a.parentMenu;c.remove(a);if(!b&&!a.allowOtherMenus){this.hideAll()}else{if(b&&b.activeChild&&a!=b.activeChild){b.activeChild.hide()}}},onMouseDown:function(g){var b=this,d=b.active,a=b.lastShow,c=true;if(Ext.Date.getElapsed(a)>50&&d.length>0&&!g.getTarget(b.menuSelector)){if(Ext.isIE9m&&!Ext.getBody().contains(g.target)){c=false}if(c){b.hideAll()}}},register:function(b){var a=this;if(!a.active){a.init()}if(b.floating){a.menus[b.id]=b;b.on({beforehide:a.onBeforeHide,hide:a.onHide,beforeshow:a.onBeforeShow,show:a.onShow,scope:a})}},get:function(b){var a=this.menus;if(typeof b=="string"){if(!a){return null}return a[b]}else{if(b.isMenu){return b}else{if(Ext.isArray(b)){return new Ext.menu.Menu({items:b})}else{return Ext.ComponentManager.create(b,"menu")}}}},unregister:function(d){var a=this,b=a.menus,c=a.active;delete b[d.id];c.remove(d);d.un({beforehide:a.onBeforeHide,hide:a.onHide,beforeshow:a.onBeforeShow,show:a.onShow,scope:a})},registerCheckable:function(c){var a=this.groups,b=c.group;if(b){if(!a[b]){a[b]=[]}a[b].push(c)}},unregisterCheckable:function(c){var a=this.groups,b=c.group;if(b){Ext.Array.remove(a[b],c)}},onCheckChange:function(d,g){var a=this.groups,c=d.group,b=0,j,e,h;if(c&&g){j=a[c];e=j.length;for(;b<e;b++){h=j[b];if(h!=d){h.setChecked(false)}}}}});Ext.define("Ext.util.ClickRepeater",{extend:Ext.util.Observable,constructor:function(b,a){var c=this;c.el=Ext.get(b);c.el.unselectable();Ext.apply(c,a);c.callParent();c.addEvents("mousedown","click","mouseup");if(!c.disabled){c.disabled=true;c.enable()}if(c.handler){c.on("click",c.handler,c.scope||c)}},interval:20,delay:250,preventDefault:true,stopDefault:false,timer:0,enable:function(){if(this.disabled){this.el.on("mousedown",this.handleMouseDown,this);if(Ext.isIE&&!(Ext.isIE10p||(Ext.isStrict&&Ext.isIE9))){this.el.on("dblclick",this.handleDblClick,this)}if(this.preventDefault||this.stopDefault){this.el.on("click",this.eventOptions,this)}}this.disabled=false},disable:function(a){if(a||!this.disabled){clearTimeout(this.timer);if(this.pressedCls){this.el.removeCls(this.pressedCls)}Ext.getDoc().un("mouseup",this.handleMouseUp,this);this.el.removeAllListeners()}this.disabled=true},setDisabled:function(a){this[a?"disable":"enable"]()},eventOptions:function(a){if(this.preventDefault){a.preventDefault()}if(this.stopDefault){a.stopEvent()}},destroy:function(){this.disable(true);Ext.destroy(this.el);this.clearListeners()},handleDblClick:function(a){clearTimeout(this.timer);this.el.blur();this.fireEvent("mousedown",this,a);this.fireEvent("click",this,a)},handleMouseDown:function(a){clearTimeout(this.timer);this.el.blur();if(this.pressedCls){this.el.addCls(this.pressedCls)}this.mousedownTime=new Date();Ext.getDoc().on("mouseup",this.handleMouseUp,this);this.el.on("mouseout",this.handleMouseOut,this);this.fireEvent("mousedown",this,a);this.fireEvent("click",this,a);if(this.accelerate){this.delay=400}a=new Ext.EventObjectImpl(a);this.timer=Ext.defer(this.click,this.delay||this.interval,this,[a])},click:function(a){this.fireEvent("click",this,a);this.timer=Ext.defer(this.click,this.accelerate?this.easeOutExpo(Ext.Date.getElapsed(this.mousedownTime),400,-390,12000):this.interval,this,[a])},easeOutExpo:function(e,a,h,g){return(e==g)?a+h:h*(-Math.pow(2,-10*e/g)+1)+a},handleMouseOut:function(){clearTimeout(this.timer);if(this.pressedCls){this.el.removeCls(this.pressedCls)}this.el.on("mouseover",this.handleMouseReturn,this)},handleMouseReturn:function(){this.el.un("mouseover",this.handleMouseReturn,this);if(this.pressedCls){this.el.addCls(this.pressedCls)}this.click()},handleMouseUp:function(a){clearTimeout(this.timer);this.el.un("mouseover",this.handleMouseReturn,this);this.el.un("mouseout",this.handleMouseOut,this);Ext.getDoc().un("mouseup",this.handleMouseUp,this);if(this.pressedCls){this.el.removeCls(this.pressedCls)}this.fireEvent("mouseup",this,a)}});Ext.define("Ext.layout.component.Button",{alias:["layout.button"],extend:Ext.layout.component.Auto,type:"button",htmlRE:/<.*>/,beginLayout:function(c){var b=this,a=b.owner,d=a.text;b.callParent(arguments);c.btnWrapContext=c.getEl("btnWrap");c.btnElContext=c.getEl("btnEl");c.btnInnerElContext=c.getEl("btnInnerEl");c.btnIconElContext=c.getEl("btnIconEl");if(d&&b.htmlRE.test(d)){c.isHtmlText=true;a.btnInnerEl.setStyle("line-height","normal");a.btnInnerEl.setStyle("padding-top","")}},beginLayoutCycle:function(b){var a=this.owner,c=this.lastWidthModel;this.callParent(arguments);if(c&&!this.lastWidthModel.shrinkWrap&&b.widthModel.shrinkWrap){a.btnWrap.setStyle("height","");a.btnEl.setStyle("height","");a.btnInnerEl.setStyle("line-height","")}},calculate:function(d){var g=this,c=g.owner,h=d.btnElContext,e=d.btnInnerElContext,k=d.btnWrapContext,b,i,j,a;g.callParent(arguments);if(d.heightModel.shrinkWrap){j=c.btnEl.getHeight();if(d.isHtmlText){g.centerInnerEl(d,j);g.ieCenterIcon(d,j)}}else{b=d.getProp("height");if(b){i=b-d.getFrameInfo().height-d.getPaddingInfo().height;j=i;if((c.menu||c.split)&&c.arrowAlign==="bottom"){j-=k.getPaddingInfo().bottom}a=j;if((c.icon||c.iconCls||c.glyph)&&(c.iconAlign==="top"||c.iconAlign==="bottom")){a-=e.getPaddingInfo().height}k.setProp("height",i);h.setProp("height",j);if(d.isHtmlText){g.centerInnerEl(d,j)}else{e.setProp("line-height",a+"px")}g.ieCenterIcon(d,j)}else{g.done=false}}},centerInnerEl:function(e,d){var c=this,b=e.btnInnerElContext,a=c.owner.btnInnerEl.getHeight();if(e.heightModel.shrinkWrap&&(d<a)){e.btnElContext.setHeight(a)}else{if(d>a){b.setProp("padding-top",Math.round((d-a)/2)+b.getPaddingInfo().top)}}},ieCenterIcon:function(c,b){var a=this.owner.iconAlign;if((Ext.isIEQuirks||Ext.isIE6)&&(a==="left"||a==="right")){c.btnIconElContext.setHeight(b)}},publishInnerWidth:function(b,a){if(this.owner.getFrameInfo().table){b.btnInnerElContext.setWidth(a-b.getFrameInfo().width-b.getPaddingInfo().width-b.btnWrapContext.getPaddingInfo().width)}}});Ext.define("Ext.util.TextMetrics",{statics:{shared:null,measure:function(a,d,e){var b=this,c=b.shared;if(!c){c=b.shared=new b(a,e)}c.bind(a);c.setFixedWidth(e||"auto");return c.getSize(d)},destroy:function(){var a=this;Ext.destroy(a.shared);a.shared=null}},constructor:function(a,c){var b=this.measure=Ext.getBody().createChild({cls:Ext.baseCSSPrefix+"textmetrics"});this.el=Ext.get(a);b.position("absolute");b.setLocalXY(-1000,-1000);b.hide();if(c){b.setWidth(c)}},getSize:function(c){var b=this.measure,a;b.update(c);a=b.getSize();b.update("");return a},bind:function(a){var b=this;b.el=Ext.get(a);b.measure.setStyle(b.el.getStyles("font-size","font-style","font-weight","font-family","line-height","text-transform","letter-spacing"))},setFixedWidth:function(a){this.measure.setWidth(a)},getWidth:function(a){this.measure.dom.style.width="auto";return this.getSize(a).width},getHeight:function(a){return this.getSize(a).height},destroy:function(){var a=this;a.measure.remove();delete a.el;delete a.measure}},function(){Ext.Element.addMethods({getTextWidth:function(c,b,a){return Ext.Number.constrain(Ext.util.TextMetrics.measure(this.dom,Ext.value(c,this.dom.innerHTML,true)).width,b||0,a||1000000)}})});Ext.define("Ext.button.Button",{alias:"widget.button",extend:Ext.Component,alternateClassName:"Ext.Button",isButton:true,componentLayout:"button",hidden:false,disabled:false,pressed:false,enableToggle:false,menuAlign:"tl-bl?",showEmptyMenu:false,textAlign:"center",type:"button",clickEvent:"click",preventDefault:true,handleMouseEvents:true,tooltipType:"qtip",baseCls:Ext.baseCSSPrefix+"btn",pressedCls:"pressed",overCls:"over",focusCls:"focus",menuActiveCls:"menu-active",hrefTarget:"_blank",border:true,childEls:["btnEl","btnWrap","btnInnerEl","btnIconEl"],renderTpl:['<div id="{id}-btnWrap" class="{baseCls}-wrap','<tpl if="splitCls"> {splitCls}</tpl>','{childElCls}" unselectable="on">','<a id="{id}-btnEl" class="{baseCls}-button" role="button" hidefocus="on" unselectable="on"','<tpl if="tabIndex != null>',' tabIndex="{tabIndex}"',"</tpl>",'<tpl if="href">',' href="{href}"','<tpl if="hrefTarget">',' target="{hrefTarget}"',"</tpl>","</tpl>",">",'<span id="{id}-btnInnerEl" class="{baseCls}-inner {innerCls}','{childElCls}" unselectable="on">',"{text}","</span>",'<span role="img" id="{id}-btnIconEl" class="{baseCls}-icon-el {iconCls}','{childElCls} {glyphCls}" unselectable="on" style="','<tpl if="iconUrl">background-image:url({iconUrl});</tpl>','<tpl if="glyph && glyphFontFamily">font-family:{glyphFontFamily};</tpl>">','<tpl if="glyph">&#{glyph};</tpl><tpl if="iconCls || iconUrl">&#160;</tpl>',"</span>","</a>","</div>",'<tpl if="closable">','<a id="{id}-closeEl" class="{baseCls}-close-btn" title="{closeText}" href="#"></a>',"</tpl>"],scale:"small",allowedScales:["small","medium","large"],iconAlign:"left",arrowAlign:"right",arrowCls:"arrow",maskOnDisable:false,shrinkWrap:3,frame:true,_triggerRegion:{},initComponent:function(){var a=this;a.addCls("x-unselectable");a.callParent(arguments);a.addEvents("click","toggle","mouseover","mouseout","menushow","menuhide","menutriggerover","menutriggerout","textchange","iconchange","glyphchange");if(a.menu){a.split=true;a.menu=Ext.menu.Manager.get(a.menu);a.menu.ownerButton=a}if(a.url){a.href=a.url}if(a.href&&!a.hasOwnProperty("preventDefault")){a.preventDefault=false}if(Ext.isString(a.toggleGroup)&&a.toggleGroup!==""){a.enableToggle=true}if(a.html&&!a.text){a.text=a.html;delete a.html}a.glyphCls=a.baseCls+"-glyph"},getActionEl:function(){return this.btnEl},getFocusEl:function(){return this.useElForFocus?this.el:this.btnEl},onFocus:function(b){var a=this;a.useElForFocus=true;a.callParent(arguments);a.useElForFocus=false},onBlur:function(a){this.useElForFocus=true;this.callParent(arguments);this.useElForFocus=false},onDisable:function(){this.useElForFocus=true;this.callParent(arguments);this.useElForFocus=false},setComponentCls:function(){var b=this,a=b.getComponentCls();if(!Ext.isEmpty(b.oldCls)){b.removeClsWithUI(b.oldCls);b.removeClsWithUI(b.pressedCls)}b.oldCls=a;b.addClsWithUI(a)},getComponentCls:function(){var b=this,a=[];if(b.iconCls||b.icon||b.glyph){if(b.text){a.push("icon-text-"+b.iconAlign)}else{a.push("icon")}}else{if(b.text){a.push("noicon")}}if(b.pressed){a.push(b.pressedCls)}return a},beforeRender:function(){var a=this;a.callParent();a.oldCls=a.getComponentCls();a.addClsWithUI(a.oldCls);Ext.applyIf(a.renderData,a.getTemplateArgs())},onRender:function(){var c=this,d,a,b;c.doc=Ext.getDoc();c.callParent(arguments);a=c.el;if(c.tooltip){c.setTooltip(c.tooltip,true)}if(c.handleMouseEvents){b={scope:c,mouseover:c.onMouseOver,mouseout:c.onMouseOut,mousedown:c.onMouseDown};if(c.split){b.mousemove=c.onMouseMove}}else{b={scope:c}}if(c.menu){c.mon(c.menu,{scope:c,show:c.onMenuShow,hide:c.onMenuHide});c.keyMap=new Ext.util.KeyMap({target:c.el,key:Ext.EventObject.DOWN,handler:c.onDownKey,scope:c})}if(c.repeat){c.mon(new Ext.util.ClickRepeater(a,Ext.isObject(c.repeat)?c.repeat:{}),"click",c.onRepeatClick,c)}else{if(b[c.clickEvent]){d=true}else{b[c.clickEvent]=c.onClick}}c.mon(a,b);if(d){c.mon(a,c.clickEvent,c.onClick,c)}Ext.button.Manager.register(c)},getTemplateArgs:function(){var c=this,b=c.glyph,d=Ext._glyphFontFamily,a;if(typeof b==="string"){a=b.split("@");b=a[0];d=a[1]}return{href:c.getHref(),hrefTarget:c.hrefTarget,type:c.type,innerCls:c.getInnerCls(),splitCls:c.getSplitCls(),iconUrl:c.icon,iconCls:c.iconCls,glyph:b,glyphCls:b?c.glyphCls:"",glyphFontFamily:d,text:c.text||"&#160;",tabIndex:c.tabIndex==null?0:c.tabIndex}},setHref:function(a){this.href=a;this.btnEl.dom.href=this.getHref()},getHref:function(){var b=this,a=b.href;return a?Ext.urlAppend(a,Ext.Object.toQueryString(Ext.apply({},b.params,b.baseParams))):false},setParams:function(a){this.params=a;this.btnEl.dom.href=this.getHref()},getSplitCls:function(){var a=this;return a.split?(a.baseCls+"-"+a.arrowCls)+" "+(a.baseCls+"-"+a.arrowCls+"-"+a.arrowAlign):""},getInnerCls:function(){return this.textAlign?this.baseCls+"-inner-"+this.textAlign:""},setIcon:function(b){b=b||"";var c=this,a=c.btnIconEl,d=c.icon||"";c.icon=b;if(b!=d){if(a){a.setStyle("background-image",b?"url("+b+")":"");c.setComponentCls();if(c.didIconStateChange(d,b)){c.updateLayout()}}c.fireEvent("iconchange",c,d,b)}return c},setIconCls:function(b){b=b||"";var d=this,a=d.btnIconEl,c=d.iconCls||"";d.iconCls=b;if(c!=b){if(a){a.removeCls(c);a.addCls(b||"");d.setComponentCls();if(d.didIconStateChange(c,b)){d.updateLayout()}}d.fireEvent("iconchange",d,c,b)}return d},setGlyph:function(g){g=g||0;var e=this,b=e.btnIconEl,c=e.glyph,a,d;e.glyph=g;if(b){if(typeof g==="string"){d=g.split("@");g=d[0];a=d[1]||Ext._glyphFontFamily}if(!g){b.dom.innerHTML=""}else{if(c!=g){b.dom.innerHTML="&#"+g+";"}}if(a){b.setStyle("font-family",a)}}e.fireEvent("glyphchange",e,e.glyph,c);return e},setTooltip:function(c,a){var b=this;if(b.rendered){if(!a||!c){b.clearTip()}if(c){if(Ext.quickTipsActive&&Ext.isObject(c)){Ext.tip.QuickTipManager.register(Ext.apply({target:b.btnEl.id},c));b.tooltip=c}else{b.btnEl.dom.setAttribute(b.getTipAttr(),c)}}}else{b.tooltip=c}return b},setTextAlign:function(c){var b=this,a=b.btnEl;if(a){a.removeCls(b.baseCls+"-inner-"+b.textAlign);a.addCls(b.baseCls+"-inner-"+c)}b.textAlign=c;return b},getTipAttr:function(){return this.tooltipType=="qtip"?"data-qtip":"title"},getRefItems:function(a){var c=this.menu,b;if(c){b=c.getRefItems(a);b.unshift(c)}return b||[]},clearTip:function(){var b=this,a=b.btnEl;if(Ext.quickTipsActive&&Ext.isObject(b.tooltip)){Ext.tip.QuickTipManager.unregister(a)}else{a.dom.removeAttribute(b.getTipAttr())}},beforeDestroy:function(){var a=this;if(a.rendered){a.clearTip()}if(a.menu&&a.destroyMenu!==false){Ext.destroy(a.menu)}Ext.destroy(a.btnInnerEl,a.repeater);a.callParent()},onDestroy:function(){var a=this;if(a.rendered){a.doc.un("mouseover",a.monitorMouseOver,a);a.doc.un("mouseup",a.onMouseUp,a);delete a.doc;Ext.destroy(a.keyMap);delete a.keyMap}Ext.button.Manager.unregister(a);a.callParent()},setHandler:function(b,a){this.handler=b;this.scope=a;return this},setText:function(c){c=c||"";var b=this,a=b.text||"";if(c!=a){b.text=c;if(b.rendered){b.btnInnerEl.update(c||"&#160;");b.setComponentCls();if(Ext.isStrict&&Ext.isIE8){b.el.repaint()}b.updateLayout()}b.fireEvent("textchange",b,a,c)}return b},didIconStateChange:function(a,c){var b=Ext.isEmpty(c);return Ext.isEmpty(a)?!b:b},getText:function(){return this.text},toggle:function(c,a){var b=this;c=c===undefined?!b.pressed:!!c;if(c!==b.pressed){if(b.rendered){b[c?"addClsWithUI":"removeClsWithUI"](b.pressedCls)}b.pressed=c;if(!a){b.fireEvent("toggle",b,c);Ext.callback(b.toggleHandler,b.scope||b,[b,c])}}return b},maybeShowMenu:function(){var a=this;if(a.menu&&!a.hasVisibleMenu()&&!a.ignoreNextClick){a.showMenu(true)}},showMenu:function(b){var a=this,c=a.menu;if(a.rendered){if(a.tooltip&&Ext.quickTipsActive&&a.getTipAttr()!="title"){Ext.tip.QuickTipManager.getQuickTip().cancelShow(a.btnEl)}if(c.isVisible()){c.hide()}if(!b||a.showEmptyMenu||c.items.getCount()>0){c.showBy(a.el,a.menuAlign,(Ext.isIEQuirks||Ext.isIE6)?[-2,-2]:undefined)}}return a},hideMenu:function(){if(this.hasVisibleMenu()){this.menu.hide()}return this},hasVisibleMenu:function(){var a=this.menu;return a&&a.rendered&&a.isVisible()},onRepeatClick:function(a,b){this.onClick(b)},onClick:function(b){var a=this;if(a.preventDefault||(a.disabled&&a.getHref())&&b){b.preventDefault()}if(b.type!=="keydown"&&b.button!==0){return}if(!a.disabled){a.doToggle();a.maybeShowMenu();a.fireHandler(b)}},fireHandler:function(c){var b=this,a=b.handler;if(b.fireEvent("click",b,c)!==false){if(a){a.call(b.scope||b,b,c)}b.blur()}},doToggle:function(){var a=this;if(a.enableToggle&&(a.allowDepress!==false||!a.pressed)){a.toggle()}},onMouseOver:function(b){var a=this;if(!a.disabled&&!b.within(a.el,true,true)){a.onMouseEnter(b)}},onMouseOut:function(b){var a=this;if(!b.within(a.el,true,true)){if(a.overMenuTrigger){a.onMenuTriggerOut(b)}a.onMouseLeave(b)}},onMouseMove:function(g){var c=this,b=c.el,d=c.overMenuTrigger,h,a;if(c.split){h=(c.arrowAlign==="right")?g.getX()-c.getX():g.getY()-b.getY();a=c.getTriggerRegion();if(h>a.begin&&h<a.end){if(!d){c.onMenuTriggerOver(g)}}else{if(d){c.onMenuTriggerOut(g)}}}},getTriggerRegion:function(){var c=this,d=c._triggerRegion,b=c.getTriggerSize(),a=c.arrowAlign==="right"?c.getWidth():c.getHeight();d.begin=a-b;d.end=a;return d},getTriggerSize:function(){var d=this,c=d.triggerSize,b,a;if(c==null){b=d.arrowAlign;a=b.charAt(0);c=d.triggerSize=d.el.getFrameWidth(a)+d.getBtnWrapFrameWidth(a);if(d.frameSize){c=d.triggerSize+=d.frameSize[b]}}return c},getBtnWrapFrameWidth:function(a){return this.btnWrap.getFrameWidth(a)},addOverCls:function(){if(!this.disabled){this.addClsWithUI(this.overCls)}},removeOverCls:function(){this.removeClsWithUI(this.overCls)},onMouseEnter:function(a){this.fireEvent("mouseover",this,a)},onMouseLeave:function(a){this.fireEvent("mouseout",this,a)},onMenuTriggerOver:function(c){var b=this,a=b.arrowTooltip;b.overMenuTrigger=true;if(b.split&&a){b.btnWrap.dom.setAttribute(b.getTipAttr(),a)}b.fireEvent("menutriggerover",b,b.menu,c)},onMenuTriggerOut:function(b){var a=this;delete a.overMenuTrigger;if(a.split&&a.arrowTooltip){a.btnWrap.dom.setAttribute(a.getTipAttr(),"")}a.fireEvent("menutriggerout",a,a.menu,b)},enable:function(a){var b=this;b.callParent(arguments);b.removeClsWithUI("disabled");return b},disable:function(a){var b=this;b.callParent(arguments);b.addClsWithUI("disabled");b.removeClsWithUI(b.overCls);if(b.btnInnerEl&&Ext.isIE7m){b.btnInnerEl.repaint()}return b},setScale:function(c){var a=this,b=a.ui.replace("-"+a.scale,"");if(!Ext.Array.contains(a.allowedScales,c)){throw ("#setScale: scale must be an allowed scale ("+a.allowedScales.join(", ")+")")}a.scale=c;a.setUI(b)},setUI:function(b){var a=this;if(a.scale&&!b.match(a.scale)){b=b+"-"+a.scale}a.callParent([b])},onMouseDown:function(b){var a=this;if(!a.disabled&&b.button===0){a.addClsWithUI(a.pressedCls);a.doc.on("mouseup",a.onMouseUp,a)}},onMouseUp:function(b){var a=this;if(b.button===0){if(!a.pressed){a.removeClsWithUI(a.pressedCls)}a.doc.un("mouseup",a.onMouseUp,a)}},onMenuShow:function(b){var a=this;a.ignoreNextClick=0;a.addClsWithUI(a.menuActiveCls);a.fireEvent("menushow",a,a.menu)},onMenuHide:function(b){var a=this;a.removeClsWithUI(a.menuActiveCls);a.ignoreNextClick=Ext.defer(a.restoreClick,250,a);a.fireEvent("menuhide",a,a.menu)},restoreClick:function(){this.ignoreNextClick=0},onDownKey:function(){var a=this;if(!a.disabled){if(a.menu){a.showMenu()}}}});Ext.define("Ext.layout.container.boxOverflow.Menu",{extend:Ext.layout.container.boxOverflow.None,alternateClassName:"Ext.layout.boxOverflow.Menu",noItemsMenuText:'<div class="'+Ext.baseCSSPrefix+'toolbar-no-items">(None)</div>',constructor:function(b){var a=this;a.callParent(arguments);a.triggerButtonCls=a.triggerButtonCls||Ext.baseCSSPrefix+"box-menu-after";a.menuItems=[]},beginLayout:function(a){this.callParent(arguments);this.clearOverflow(a)},beginLayoutCycle:function(b,a){this.callParent(arguments);if(!a){this.clearOverflow(b);this.layout.cacheChildItems(b)}},onRemove:function(a){Ext.Array.remove(this.menuItems,a)},getSuffixConfig:function(){var d=this,c=d.layout,a=c.owner,b=a.id;d.menu=new Ext.menu.Menu({listeners:{scope:d,beforeshow:d.beforeMenuShow}});d.menuTrigger=new Ext.button.Button({id:b+"-menu-trigger",cls:Ext.layout.container.Box.prototype.innerCls+" "+d.triggerButtonCls+" "+Ext.baseCSSPrefix+"toolbar-item",plain:a.usePlainButtons,ownerCt:a,ownerLayout:c,iconCls:Ext.baseCSSPrefix+d.getOwnerType(a)+"-more-icon",ui:a instanceof Ext.toolbar.Toolbar?"default-toolbar":"default",menu:d.menu,showEmptyMenu:true,getSplitCls:function(){return""}});return d.menuTrigger.getRenderTree()},getOverflowCls:function(){return Ext.baseCSSPrefix+this.layout.direction+"-box-overflow-body"},handleOverflow:function(d){var c=this,b=c.layout,g=b.names,e=d.state.boxPlan,a=[null,null];c.showTrigger(d);if(c.layout.direction!=="vertical"){a[g.heightIndex]=(e.maxSize-c.menuTrigger[g.getHeight]())/2;c.menuTrigger.setPosition.apply(c.menuTrigger,a)}return{reservedSpace:c.triggerTotalWidth}},captureChildElements:function(){var a=this,c=a.menuTrigger,b=a.layout.names;if(c.rendering){c.finishRender();a.triggerTotalWidth=c[b.getWidth]()+c.el.getMargin(b.parallelMargins)}},_asLayoutRoot:{isRoot:true},clearOverflow:function(h){var g=this,b=g.menuItems,e,c=0,d=b.length,a=g.layout.owner,j=g._asLayoutRoot;a.suspendLayouts();g.captureChildElements();g.hideTrigger();a.resumeLayouts();for(;c<d;c++){e=b[c];e.suspendLayouts();e.show();e.resumeLayouts(j)}b.length=0},showTrigger:function(c){var o=this,k=o.layout,a=k.owner,n=k.names,r=n.x,e=n.width,p=c.state.boxPlan,b=p.targetSize[e],h=c.childItems,l=h.length,g=o.menuTrigger,q,j,d,m;g.suspendLayouts();g.show();g.resumeLayouts(o._asLayoutRoot);b-=o.triggerTotalWidth;a.suspendLayouts();o.menuItems.length=0;for(d=0;d<l;d++){q=h[d];m=q.props;if(m[r]+m[e]>b){j=q.target;o.menuItems.push(j);j.hide()}}a.resumeLayouts()},hideTrigger:function(){var a=this.menuTrigger;if(a){a.hide()}},beforeMenuShow:function(j){var h=this,b=h.menuItems,d=0,a=b.length,g,e,c=function(k,i){return k.isXType("buttongroup")&&!(i instanceof Ext.toolbar.Separator)};j.suspendLayouts();h.clearMenu();j.removeAll();for(;d<a;d++){g=b[d];if(!d&&(g instanceof Ext.toolbar.Separator)){continue}if(e&&(c(g,e)||c(e,g))){j.add("-")}h.addComponentToMenu(j,g);e=g}if(j.items.length<1){j.add(h.noItemsMenuText)}j.resumeLayouts()},createMenuConfig:function(c,a){var d=this,b=Ext.apply({},c.initialConfig),e=c.toggleGroup;Ext.copyTo(b,c,["iconCls","icon","itemId","disabled","handler","scope","menu","tabIndex"]);Ext.apply(b,{text:c.overflowText||c.text,hideOnClick:a,destroyMenu:false,listeners:{}});if(c.isFormField){b.value=c.getValue();b.listeners.change=function(i,h,g){c.setValue(h)}}else{if(e||c.enableToggle){Ext.apply(b,{hideOnClick:false,group:e,checked:c.pressed,handler:function(g,h){c.onClick(h)}})}}if(c.isButton&&!c.changeListenersAdded){c.on({textchange:d.onButtonAttrChange,iconchange:d.onButtonAttrChange,toggle:d.onButtonToggle});c.changeListenersAdded=true}delete b.ownerCt;delete b.xtype;delete b.id;return b},onButtonAttrChange:function(a){var b=a.overflowClone;b.suspendLayouts();b.setText(a.text);b.setIcon(a.icon);b.setIconCls(a.iconCls);b.resumeLayouts(true)},onButtonToggle:function(a,b){if(a.overflowClone.checked!==b){a.overflowClone.setChecked(b)}},addComponentToMenu:function(g,c){var e=this,d,b,a;if(c instanceof Ext.toolbar.Separator){g.add("-")}else{if(c.isComponent){if(c.isXType("splitbutton")){c.overflowClone=g.add(e.createMenuConfig(c,true))}else{if(c.isXType("button")){c.overflowClone=g.add(e.createMenuConfig(c,!c.menu))}else{if(c.isXType("buttongroup")){b=c.items.items;a=b.length;for(d=0;d<a;d++){e.addComponentToMenu(g,b[d])}}else{c.overflowClone=g.add(Ext.create(Ext.getClassName(c),e.createMenuConfig(c)))}}}}}},clearMenu:function(){var e=this.menu,b,c,a,d;if(e&&e.items){b=e.items.items;a=b.length;for(c=0;c<a;c++){d=b[c];if(d.setMenu){d.setMenu(null)}}}},destroy:function(){var a=this.menuTrigger;if(a&&!this.layout.owner.items.contains(a)){delete a.ownerCt}Ext.destroy(this.menu,a)}});Ext.define("Ext.layout.container.boxOverflow.Scroller",{extend:Ext.layout.container.boxOverflow.None,alternateClassName:"Ext.layout.boxOverflow.Scroller",mixins:{observable:Ext.util.Observable},animateScroll:false,scrollIncrement:20,wheelIncrement:10,scrollRepeatInterval:60,scrollDuration:400,scrollerCls:Ext.baseCSSPrefix+"box-scroller",constructor:function(c,a){var b=this;b.layout=c;Ext.apply(b,a||{});b.mixins.observable.constructor.call(b);b.addEvents("scroll");b.scrollPosition=0;b.scrollSize=0},getPrefixConfig:function(){var c=this,a=c.layout.owner,b;c.initCSSClasses();b=Ext.layout.container.Box.prototype.innerCls+" "+c.beforeCtCls;if(a.plain){b+=" "+c.scrollerCls+"-plain"}return{cls:b,cn:{id:a.id+"-before-scroller",cls:c.scrollerCls+" "+c.beforeScrollerCls,style:"display:none"}}},getSuffixConfig:function(){var c=this,a=c.layout.owner,b=Ext.layout.container.Box.prototype.innerCls+" "+c.afterCtCls;if(a.plain){b+=" "+c.scrollerCls+"-plain"}return{cls:b,cn:{id:c.layout.owner.id+"-after-scroller",cls:c.scrollerCls+" "+c.afterScrollerCls,style:"display:none"}}},getOverflowCls:function(){return Ext.baseCSSPrefix+this.layout.direction+"-box-overflow-body"},initCSSClasses:function(){var d=this,g=Ext.baseCSSPrefix,c=d.layout,h=c.names,a=h.beforeX,e=h.afterX,b=d.getOwnerType(c.owner);d.beforeCtCls=d.beforeCtCls||g+"box-scroller-"+a;d.afterCtCls=d.afterCtCls||g+"box-scroller-"+e;d.beforeScrollerCls=d.beforeScrollerCls||g+b+"-scroll-"+a;d.afterScrollerCls=d.afterScrollerCls||g+b+"-scroll-"+e},beginLayout:function(a){a.innerCtScrollPos=this.getElScrollPos();this.callParent(arguments)},completeLayout:function(c){var b=this,e=c.state.boxPlan,d=b.layout.names,a;if(e&&e.tooNarrow){a=c.childItems[c.childItems.length-1];b.scrollSize=a.props[d.x]+a.props[d.width];b.updateScrollButtons()}this.callParent(arguments)},finishedLayout:function(a){var b=Math.min(this.getMaxScrollPosition(),a.innerCtScrollPos);this.setElScrollPos(b)},setElScrollPos:function(b){var a=this.layout;if(a.direction==="vertical"){a.innerCt.dom.scrollTop=b}else{a.innerCt.setScrollLeft(b)}},getElScrollPos:function(){var a=this.layout;if(a.direction==="vertical"){return a.innerCt.dom.scrollTop}else{return a.innerCt.getScrollLeft()}},handleOverflow:function(c){var b=this,a=b.layout.names.getWidth;b.showScrollers();return{reservedSpace:b.beforeCt[a]()+b.afterCt[a]()}},captureChildElements:function(){var e=this,c=e.layout.owner.el,g,i,b,a,d,h;if(!e.beforeCt){h="-hover";a="-pressed";b=e.scrollerCls+h;d=e.scrollerCls+a;g=e.beforeScroller=c.getById(e.layout.owner.id+"-before-scroller");i=e.afterScroller=c.getById(e.layout.owner.id+"-after-scroller");e.beforeCt=g.up("");e.afterCt=i.up("");e.createWheelListener();g.addClsOnOver(b);g.addClsOnOver(e.beforeScrollerCls+h);g.addClsOnClick(d);g.addClsOnClick(e.beforeScrollerCls+a);i.addClsOnOver(b);i.addClsOnOver(e.afterScrollerCls+h);i.addClsOnClick(d);i.addClsOnClick(e.afterScrollerCls+a);g.setVisibilityMode(Ext.Element.DISPLAY);i.setVisibilityMode(Ext.Element.DISPLAY);e.beforeRepeater=new Ext.util.ClickRepeater(g,{interval:e.scrollRepeatInterval,handler:e.scrollLeft,scope:e});e.afterRepeater=new Ext.util.ClickRepeater(i,{interval:e.scrollRepeatInterval,handler:e.scrollRight,scope:e})}},createWheelListener:function(){var a=this;a.layout.innerCt.on({mousewheel:function(b){a.scrollBy(b.getWheelDelta()*a.wheelIncrement*-1,false)},stopEvent:true})},clearOverflow:function(){this.hideScrollers()},showScrollers:function(){var a=this;a.captureChildElements();a.beforeScroller.show();a.afterScroller.show();a.layout.owner.addClsWithUI(a.layout.direction==="vertical"?"vertical-scroller":"scroller")},hideScrollers:function(){var a=this;if(a.beforeScroller!==undefined){a.beforeScroller.hide();a.afterScroller.hide();a.layout.owner.removeClsWithUI(a.layout.direction==="vertical"?"vertical-scroller":"scroller")}},destroy:function(){var a=this;Ext.destroy(a.beforeRepeater,a.afterRepeater,a.beforeScroller,a.afterScroller,a.beforeCt,a.afterCt)},scrollBy:function(b,a){this.scrollTo(this.getScrollPosition()+b,a)},getScrollAnim:function(){return{duration:this.scrollDuration,callback:this.updateScrollButtons,scope:this}},updateScrollButtons:function(){var d=this,h,c,a,b,e,g="-disabled";if(d.beforeScroller==null||d.afterScroller==null){return}h=d.atExtremeBefore()?"addCls":"removeCls";c=d.atExtremeAfter()?"addCls":"removeCls";e=d.scrollerCls+g;a=[e,d.beforeScrollerCls+g];b=[e,d.afterScrollerCls+g];d.beforeScroller[h](a);d.afterScroller[c](b);d.scrolling=false},scrollLeft:function(){this.scrollBy(-this.scrollIncrement,false)},scrollRight:function(){this.scrollBy(this.scrollIncrement,false)},getScrollPosition:function(){var c=this,b=c.layout,a;if(isNaN(c.scrollPosition)){a=c.getElScrollPos()}else{a=c.scrollPosition}return a},getMaxScrollPosition:function(){var b=this,a=b.layout,c=b.scrollSize-a.innerCt[a.names.getWidth]();return(c<0)?0:c},atExtremeBefore:function(){return !this.getScrollPosition()},atExtremeAfter:function(){return this.getScrollPosition()>=this.getMaxScrollPosition()},scrollTo:function(a,b){var g=this,e=g.layout,d=g.getScrollPosition(),c=Ext.Number.constrain(a,0,g.getMaxScrollPosition());if(c!=d&&!g.scrolling){g.scrollPosition=NaN;if(b===undefined){b=g.animateScroll}e.innerCt.scrollTo(e.names.beforeX,c,b?g.getScrollAnim():false);if(b){g.scrolling=true}else{g.updateScrollButtons()}g.fireEvent("scroll",g,c,b?g.getScrollAnim():false)}},scrollToItem:function(j,b){var i=this,e=i.layout,c=e.owner,h=e.names,a,d,g;j=i.getItem(j);if(j!==undefined){if(j==c.items.first()){g=0}else{if(j===c.items.last()){g=i.getMaxScrollPosition()}else{a=i.getItemVisibility(j);if(!a.fullyVisible){d=j.getBox(false,true);g=d[h.x];if(a.hiddenEnd){g-=(i.layout.innerCt[h.getWidth]()-d[h.width])}}}}i.scrollTo(g,b)}},getItemVisibility:function(j){var h=this,b=h.getItem(j).getBox(true,true),c=h.layout,g=c.names,e=b[g.x],d=e+b[g.width],a=h.getScrollPosition(),i=a+c.innerCt[g.getWidth]();return{hiddenStart:e<a,hiddenEnd:d>i,fullyVisible:e>a&&d<i}}});Ext.define("Ext.util.Offset",{statics:{fromObject:function(a){return new this(a.x,a.y)}},constructor:function(a,b){this.x=(a!=null&&!isNaN(a))?a:0;this.y=(b!=null&&!isNaN(b))?b:0;return this},copy:function(){return new Ext.util.Offset(this.x,this.y)},copyFrom:function(a){this.x=a.x;this.y=a.y},toString:function(){return"Offset["+this.x+","+this.y+"]"},equals:function(a){return(this.x==a.x&&this.y==a.y)},round:function(b){if(!isNaN(b)){var a=Math.pow(10,b);this.x=Math.round(this.x*a)/a;this.y=Math.round(this.y*a)/a}else{this.x=Math.round(this.x);this.y=Math.round(this.y)}},isZero:function(){return this.x==0&&this.y==0}});Ext.define("Ext.util.Region",{statics:{getRegion:function(a){return Ext.fly(a).getRegion()},from:function(a){return new this(a.top,a.right,a.bottom,a.left)}},constructor:function(d,g,a,c){var e=this;e.y=e.top=e[1]=d;e.right=g;e.bottom=a;e.x=e.left=e[0]=c},contains:function(b){var a=this;return(b.x>=a.x&&b.right<=a.right&&b.y>=a.y&&b.bottom<=a.bottom)},intersect:function(h){var g=this,d=Math.max(g.y,h.y),e=Math.min(g.right,h.right),a=Math.min(g.bottom,h.bottom),c=Math.max(g.x,h.x);if(a>d&&e>c){return new this.self(d,e,a,c)}else{return false}},union:function(h){var g=this,d=Math.min(g.y,h.y),e=Math.max(g.right,h.right),a=Math.max(g.bottom,h.bottom),c=Math.min(g.x,h.x);return new this.self(d,e,a,c)},constrainTo:function(b){var a=this,c=Ext.Number.constrain;a.top=a.y=c(a.top,b.y,b.bottom);a.bottom=c(a.bottom,b.y,b.bottom);a.left=a.x=c(a.left,b.x,b.right);a.right=c(a.right,b.x,b.right);return a},adjust:function(d,g,a,c){var e=this;e.top=e.y+=d;e.left=e.x+=c;e.right+=g;e.bottom+=a;return e},getOutOfBoundOffset:function(a,b){if(!Ext.isObject(a)){if(a=="x"){return this.getOutOfBoundOffsetX(b)}else{return this.getOutOfBoundOffsetY(b)}}else{b=a;var c=new Ext.util.Offset();c.x=this.getOutOfBoundOffsetX(b.x);c.y=this.getOutOfBoundOffsetY(b.y);return c}},getOutOfBoundOffsetX:function(a){if(a<=this.x){return this.x-a}else{if(a>=this.right){return this.right-a}}return 0},getOutOfBoundOffsetY:function(a){if(a<=this.y){return this.y-a}else{if(a>=this.bottom){return this.bottom-a}}return 0},isOutOfBound:function(a,b){if(!Ext.isObject(a)){if(a=="x"){return this.isOutOfBoundX(b)}else{return this.isOutOfBoundY(b)}}else{b=a;return(this.isOutOfBoundX(b.x)||this.isOutOfBoundY(b.y))}},isOutOfBoundX:function(a){return(a<this.x||a>this.right)},isOutOfBoundY:function(a){return(a<this.y||a>this.bottom)},restrict:function(b,d,a){if(Ext.isObject(b)){var c;a=d;d=b;if(d.copy){c=d.copy()}else{c={x:d.x,y:d.y}}c.x=this.restrictX(d.x,a);c.y=this.restrictY(d.y,a);return c}else{if(b=="x"){return this.restrictX(d,a)}else{return this.restrictY(d,a)}}},restrictX:function(b,a){if(!a){a=1}if(b<=this.x){b-=(b-this.x)*a}else{if(b>=this.right){b-=(b-this.right)*a}}return b},restrictY:function(b,a){if(!a){a=1}if(b<=this.y){b-=(b-this.y)*a}else{if(b>=this.bottom){b-=(b-this.bottom)*a}}return b},getSize:function(){return{width:this.right-this.x,height:this.bottom-this.y}},copy:function(){return new this.self(this.y,this.right,this.bottom,this.x)},copyFrom:function(b){var a=this;a.top=a.y=a[1]=b.y;a.right=b.right;a.bottom=b.bottom;a.left=a.x=a[0]=b.x;return this},toString:function(){return"Region["+this.top+","+this.right+","+this.bottom+","+this.left+"]"},translateBy:function(a,c){if(arguments.length==1){c=a.y;a=a.x}var b=this;b.top=b.y+=c;b.right+=a;b.bottom+=c;b.left=b.x+=a;return b},round:function(){var a=this;a.top=a.y=Math.round(a.y);a.right=Math.round(a.right);a.bottom=Math.round(a.bottom);a.left=a.x=Math.round(a.x);return a},equals:function(a){return(this.top==a.top&&this.right==a.right&&this.bottom==a.bottom&&this.left==a.left)}});Ext.define("Ext.dd.DragDropManager",{singleton:true,alternateClassName:["Ext.dd.DragDropMgr","Ext.dd.DDM"],ids:{},handleIds:{},dragCurrent:null,dragOvers:{},deltaX:0,deltaY:0,preventDefault:true,stopPropagation:true,initialized:false,locked:false,init:function(){this.initialized=true},POINT:0,INTERSECT:1,mode:0,notifyOccluded:false,dragCls:Ext.baseCSSPrefix+"dd-drag-current",_execOnAll:function(c,b){var d,a,e;for(d in this.ids){for(a in this.ids[d]){e=this.ids[d][a];if(!this.isTypeOfDD(e)){continue}e[c].apply(e,b)}}},_onLoad:function(){this.init();var a=Ext.EventManager;a.on(document,"mouseup",this.handleMouseUp,this,true);a.on(document,"mousemove",this.handleMouseMove,this,true);a.on(window,"unload",this._onUnload,this,true);a.on(window,"resize",this._onResize,this,true)},_onResize:function(a){this._execOnAll("resetConstraints",[])},lock:function(){this.locked=true},unlock:function(){this.locked=false},isLocked:function(){return this.locked},locationCache:{},useCache:true,clickPixelThresh:3,clickTimeThresh:350,dragThreshMet:false,clickTimeout:null,startX:0,startY:0,regDragDrop:function(b,a){if(!this.initialized){this.init()}if(!this.ids[a]){this.ids[a]={}}this.ids[a][b.id]=b},removeDDFromGroup:function(c,a){if(!this.ids[a]){this.ids[a]={}}var b=this.ids[a];if(b&&b[c.id]){delete b[c.id]}},_remove:function(b){for(var a in b.groups){if(a&&this.ids[a]&&this.ids[a][b.id]){delete this.ids[a][b.id]}}delete this.handleIds[b.id]},regHandle:function(b,a){if(!this.handleIds[b]){this.handleIds[b]={}}this.handleIds[b][a]=a},isDragDrop:function(a){return(this.getDDById(a))?true:false},getRelated:function(g,b){var e=[],d,c,a;for(d in g.groups){for(c in this.ids[d]){a=this.ids[d][c];if(!this.isTypeOfDD(a)){continue}if(!b||a.isTarget){e[e.length]=a}}}return e},isLegalTarget:function(e,d){var b=this.getRelated(e,true),c,a;for(c=0,a=b.length;c<a;++c){if(b[c].id==d.id){return true}}return false},isTypeOfDD:function(a){return(a&&a.__ygDragDrop)},isHandle:function(b,a){return(this.handleIds[b]&&this.handleIds[b][a])},getDDById:function(c){var b,a;for(b in this.ids){a=this.ids[b][c];if(a instanceof Ext.dd.DDTarget){return a}}return null},handleMouseDown:function(d,c){var b=this,a;if(Ext.quickTipsActive){Ext.tip.QuickTipManager.ddDisable()}if(b.dragCurrent){b.handleMouseUp(d)}b.currentTarget=d.getTarget();b.dragCurrent=c;a=c.getEl();if(Ext.isIE&&a.setCapture){a.setCapture()}b.startX=d.getPageX();b.startY=d.getPageY();b.deltaX=b.startX-a.offsetLeft;b.deltaY=b.startY-a.offsetTop;b.dragThreshMet=false;b.clickTimeout=setTimeout(function(){b.startDrag(b.startX,b.startY)},b.clickTimeThresh)},startDrag:function(b,e){var c=this,d=c.dragCurrent,a;clearTimeout(c.clickTimeout);if(d){d.b4StartDrag(b,e);d.startDrag(b,e);a=d.getDragEl();if(a){Ext.fly(a).addCls(c.dragCls)}}c.dragThreshMet=true},handleMouseUp:function(b){var a=this;if(Ext.quickTipsActive){Ext.tip.QuickTipManager.ddEnable()}if(!a.dragCurrent){return}if(Ext.isIE&&document.releaseCapture){document.releaseCapture()}clearTimeout(a.clickTimeout);if(a.dragThreshMet){a.fireEvents(b,true)}a.stopDrag(b);a.stopEvent(b)},stopEvent:function(a){if(this.stopPropagation){a.stopPropagation()}if(this.preventDefault){a.preventDefault()}},stopDrag:function(d){var b=this,c=b.dragCurrent,a;if(c){if(b.dragThreshMet){a=c.getDragEl();if(a){Ext.fly(a).removeCls(b.dragCls)}c.b4EndDrag(d);c.endDrag(d)}b.dragCurrent.onMouseUp(d)}b.dragCurrent=null;b.dragOvers={}},handleMouseMove:function(g){var c=this,d=c.dragCurrent,b,a;if(!d){return true}if(!c.dragThreshMet){b=Math.abs(c.startX-g.getPageX());a=Math.abs(c.startY-g.getPageY());if(b>c.clickPixelThresh||a>c.clickPixelThresh){c.startDrag(c.startX,c.startY)}}if(c.dragThreshMet){d.b4Drag(g);d.onDrag(g);if(!d.moveOnly){c.fireEvents(g,false)}}c.stopEvent(g);return true},fireEvents:function(u,m){var w=this,g=w.dragCurrent,c,o,s=u.getPoint(),d,l,n=[],h=[],k=[],a=[],v=[],t=[],j,b,q,r,p;if(!g||g.isLocked()){return}if(!w.notifyOccluded&&(!Ext.supports.PointerEvents||Ext.isIE10m||Ext.isOpera)&&!(g.deltaX<0||g.deltaY<0)){c=g.getDragEl();o=c.style.top;c.style.top="-10000px";j=u.getXY();u.target=document.elementFromPoint(j[0],j[1]);c.style.top=o}for(q in w.dragOvers){d=w.dragOvers[q];if(!w.isTypeOfDD(d)){continue}if(w.notifyOccluded){if(!this.isOverTarget(s,d,w.mode)){k.push(d)}}else{if(!u.within(d.getEl())){k.push(d)}}h[q]=true;delete w.dragOvers[q]}for(p in g.groups){if("string"!=typeof p){continue}for(q in w.ids[p]){d=w.ids[p][q];if(w.isTypeOfDD(d)&&(l=d.getEl())&&(d.isTarget)&&(!d.isLocked())&&(Ext.fly(l).isVisible(true))&&((d!=g)||(g.ignoreSelf===false))){if(w.notifyOccluded){if((d.zIndex=w.getZIndex(l))!==-1){b=true}n.push(d)}else{if(u.within(d.getEl())){n.push(d);break}}}}}if(b){Ext.Array.sort(n,w.byZIndex)}for(q=0,r=n.length;q<r;q++){d=n[q];if(w.isOverTarget(s,d,w.mode)){if(m){v.push(d)}else{if(!h[d.id]){t.push(d)}else{a.push(d)}w.dragOvers[d.id]=d}if(!w.notifyOccluded){break}}}if(w.mode){if(k.length){g.b4DragOut(u,k);g.onDragOut(u,k)}if(t.length){g.onDragEnter(u,t)}if(a.length){g.b4DragOver(u,a);g.onDragOver(u,a)}if(v.length){g.b4DragDrop(u,v);g.onDragDrop(u,v)}}else{for(q=0,r=k.length;q<r;++q){g.b4DragOut(u,k[q].id);g.onDragOut(u,k[q].id)}for(q=0,r=t.length;q<r;++q){g.onDragEnter(u,t[q].id)}for(q=0,r=a.length;q<r;++q){g.b4DragOver(u,a[q].id);g.onDragOver(u,a[q].id)}for(q=0,r=v.length;q<r;++q){g.b4DragDrop(u,v[q].id);g.onDragDrop(u,v[q].id)}}if(m&&!v.length){g.onInvalidDrop(u)}},getZIndex:function(b){var a=document.body,c,d=-1;b=Ext.getDom(b);while(b!==a){if(!isNaN(c=Number(Ext.fly(b).getStyle("zIndex")))){d=c}b=b.parentNode}return d},byZIndex:function(b,a){return b.zIndex<a.zIndex},getBestMatch:function(c){var e=null,b=c.length,d,a;if(b==1){e=c[0]}else{for(d=0;d<b;++d){a=c[d];if(a.cursorIsOver){e=a;break}else{if(!e||e.overlap.getArea()<a.overlap.getArea()){e=a}}}}return e},refreshCache:function(b){var a,c,d,e;for(a in b){if("string"!=typeof a){continue}for(c in this.ids[a]){d=this.ids[a][c];if(this.isTypeOfDD(d)){e=this.getLocation(d);if(e){this.locationCache[d.id]=e}else{delete this.locationCache[d.id]}}}}},verifyEl:function(b){if(b){var a;if(Ext.isIE){try{a=b.offsetParent}catch(c){}}else{a=b.offsetParent}if(a){return true}}return false},getLocation:function(i){if(!this.isTypeOfDD(i)){return null}if(i.getRegion){return i.getRegion()}var g=i.getEl(),m,d,c,o,n,p,a,k,h;try{m=Ext.Element.getXY(g)}catch(j){}if(!m){return null}d=m[0];c=d+g.offsetWidth;o=m[1];n=o+g.offsetHeight;p=o-i.padding[0];a=c+i.padding[1];k=n+i.padding[2];h=d-i.padding[3];return new Ext.util.Region(p,a,k,h)},isOverTarget:function(j,a,c){var e=this.locationCache[a.id],i,g,b,d,h;if(!e||!this.useCache){e=this.getLocation(a);this.locationCache[a.id]=e}if(!e){return false}a.cursorIsOver=e.contains(j);i=this.dragCurrent;if(!i||!i.getTargetCoord||(!c&&!i.constrainX&&!i.constrainY)){return a.cursorIsOver}a.overlap=null;g=i.getTargetCoord(j.x,j.y);b=i.getDragEl();d=new Ext.util.Region(g.y,g.x+b.offsetWidth,g.y+b.offsetHeight,g.x);h=d.intersect(e);if(h){a.overlap=h;return(c)?true:a.cursorIsOver}else{return false}},_onUnload:function(b,a){Ext.dd.DragDropManager.unregAll()},unregAll:function(){if(this.dragCurrent){this.stopDrag();this.dragCurrent=null}this._execOnAll("unreg",[]);for(var a in this.elementCache){delete this.elementCache[a]}this.elementCache={};this.ids={}},elementCache:{},getElWrapper:function(b){var a=this.elementCache[b];if(!a||!a.el){a=this.elementCache[b]=new this.ElementWrapper(Ext.getDom(b))}return a},getElement:function(a){return Ext.getDom(a)},getCss:function(b){var a=Ext.getDom(b);return(a)?a.style:null},ElementWrapper:function(a){this.el=a||null;this.id=this.el&&a.id;this.css=this.el&&a.style},getPosX:function(a){return Ext.Element.getX(a)},getPosY:function(a){return Ext.Element.getY(a)},swapNode:function(c,a){if(c.swapNode){c.swapNode(a)}else{var d=a.parentNode,b=a.nextSibling;if(b==c){d.insertBefore(c,a)}else{if(a==c.nextSibling){d.insertBefore(a,c)}else{c.parentNode.replaceChild(a,c);d.insertBefore(c,b)}}}},getScroll:function(){var d=window.document,e=d.documentElement,a=d.body,c=0,b=0;if(Ext.isGecko4){c=window.scrollYOffset;b=window.scrollXOffset}else{if(e&&(e.scrollTop||e.scrollLeft)){c=e.scrollTop;b=e.scrollLeft}else{if(a){c=a.scrollTop;b=a.scrollLeft}}}return{top:c,left:b}},getStyle:function(b,a){return Ext.fly(b).getStyle(a)},getScrollTop:function(){return this.getScroll().top},getScrollLeft:function(){return this.getScroll().left},moveToEl:function(a,c){var b=Ext.Element.getXY(c);Ext.Element.setXY(a,b)},numericSort:function(d,c){return(d-c)},_timeoutCount:0,_addListeners:function(){if(document){this._onLoad()}else{if(this._timeoutCount<=2000){setTimeout(this._addListeners,10);if(document&&document.body){this._timeoutCount+=1}}}},handleWasClicked:function(a,c){if(this.isHandle(c,a.id)){return true}else{var b=a.parentNode;while(b){if(this.isHandle(c,b.id)){return true}else{b=b.parentNode}}}return false}},function(){this._addListeners()});Ext.define("Ext.layout.container.Box",{alias:["layout.box"],extend:Ext.layout.container.Container,alternateClassName:"Ext.layout.BoxLayout",defaultMargins:{top:0,right:0,bottom:0,left:0},padding:0,pack:"start",flex:undefined,stretchMaxPartner:undefined,alignRoundingMethod:"round",type:"box",scrollOffset:0,itemCls:Ext.baseCSSPrefix+"box-item",targetCls:Ext.baseCSSPrefix+"box-layout-ct",targetElCls:Ext.baseCSSPrefix+"box-target",innerCls:Ext.baseCSSPrefix+"box-inner",availableSpaceOffset:0,reserveOffset:true,manageMargins:true,createsInnerCt:true,childEls:["innerCt","targetEl"],renderTpl:["{%var oc,l=values.$comp.layout,oh=l.overflowHandler;","if (oh.getPrefixConfig!==Ext.emptyFn) {","if(oc=oh.getPrefixConfig())dh.generateMarkup(oc, out)","}%}",'<div id="{ownerId}-innerCt" class="{[l.innerCls]} {[oh.getOverflowCls()]}" role="presentation">','<div id="{ownerId}-targetEl" class="{targetElCls}">',"{%this.renderBody(out, values)%}","</div>","</div>","{%if (oh.getSuffixConfig!==Ext.emptyFn) {","if(oc=oh.getSuffixConfig())dh.generateMarkup(oc, out)","}%}",{disableFormats:true,definitions:"var dh=Ext.DomHelper;"}],constructor:function(a){var c=this,b;c.callParent(arguments);c.flexSortFn=Ext.Function.bind(c.flexSort,c);c.initOverflowHandler();b=typeof c.padding;if(b=="string"||b=="number"){c.padding=Ext.util.Format.parseBox(c.padding);c.padding.height=c.padding.top+c.padding.bottom;c.padding.width=c.padding.left+c.padding.right}},_percentageRe:/^\s*(\d+(?:\.\d*)?)\s*[%]\s*$/,getItemSizePolicy:function(o,p){var k=this,i=k.sizePolicy,h=k.align,g=o.flex,m=h,j=k.names,b=o[j.width],n=o[j.height],d=k._percentageRe,c=d.test(b),e=(h=="stretch"),a=(h=="stretchmax"),l=k.constrainAlign;if(!p&&(e||g||c||(l&&!a))){p=k.owner.getSizeModel()}if(e){if(!d.test(n)&&p[j.height].shrinkWrap){m="stretchmax"}}else{if(!a){if(d.test(n)){m="stretch"}else{if(l&&!p[j.height].shrinkWrap){m="stretchmax"}else{m=""}}}}if(g||c){if(!p[j.width].shrinkWrap){i=i.flex}}return i[m]},flexSort:function(m,l){var j=this.names.maxWidth,e=this.names.minWidth,k=Infinity,i=m.target,p=l.target,q=0,c,n,h,d,o,g;h=i[j]||k;d=p[j]||k;c=i[e]||0;n=p[e]||0;o=isFinite(c)||isFinite(n);g=isFinite(h)||isFinite(d);if(o||g){if(g){q=h-d}if(q===0&&o){q=n-c}}return q},isItemBoxParent:function(a){return true},isItemShrinkWrap:function(a){return true},roundFlex:function(a){return Math.ceil(a)},beginCollapse:function(b){var a=this;if(a.direction==="vertical"&&b.collapsedVertical()){b.collapseMemento.capture(["flex"]);delete b.flex}else{if(a.direction==="horizontal"&&b.collapsedHorizontal()){b.collapseMemento.capture(["flex"]);delete b.flex}}},beginExpand:function(a){a.collapseMemento.restore(["flex"])},beginLayout:function(d){var c=this,a=c.owner,g=a.stretchMaxPartner,b=c.innerCt.dom.style,e=c.names;d.boxNames=e;c.overflowHandler.beginLayout(d);if(typeof g==="string"){g=Ext.getCmp(g)||a.query(g)[0]}d.stretchMaxPartner=g&&d.context.getCmp(g);c.callParent(arguments);d.innerCtContext=d.getEl("innerCt",c);c.scrollParallel=a.scrollFlags[e.x];c.scrollPerpendicular=a.scrollFlags[e.y];if(c.scrollParallel){c.scrollPos=a.getTargetEl().dom[e.scrollLeft]}b.width="";b.height=""},beginLayoutCycle:function(e,a){var d=this,h=d.align,g=e.boxNames,b=d.pack,c=g.heightModel;d.overflowHandler.beginLayoutCycle(e,a);d.callParent(arguments);e.parallelSizeModel=e[g.widthModel];e.perpendicularSizeModel=e[c];e.boxOptions={align:h={stretch:h=="stretch",stretchmax:h=="stretchmax",center:h==g.center,bottom:h==g.afterY},pack:b={center:b=="center",end:b=="end"}};if(h.stretch&&e.perpendicularSizeModel.shrinkWrap){h.stretchmax=true;h.stretch=false}h.nostretch=!(h.stretch||h.stretchmax);if(e.parallelSizeModel.shrinkWrap){b.center=b.end=false}d.cacheFlexes(e);d.targetEl.setWidth(20000)},cacheFlexes:function(k){var u=this,l=k.boxNames,a=l.widthModel,d=l.heightModel,c=k.boxOptions.align.nostretch,o=0,b=k.childItems,q=b.length,s=[],m=0,j=l.minWidth,g=u._percentageRe,r=0,t=0,e,n,p,h;while(q--){n=b[q];e=n.target;if(n[a].calculated){n.flex=p=e.flex;if(p){o+=p;s.push(n);m+=e[j]||0}else{h=g.exec(e[l.width]);n.percentageParallel=parseFloat(h[1])/100;++r}}if(c&&n[d].calculated){h=g.exec(e[l.height]);n.percentagePerpendicular=parseFloat(h[1])/100;++t}}k.flexedItems=s;k.flexedMinSize=m;k.totalFlex=o;k.percentageWidths=r;k.percentageHeights=t;Ext.Array.sort(s,u.flexSortFn)},calculate:function(e){var c=this,b=c.getContainerSize(e),h=e.boxNames,d=e.state,g=d.boxPlan||(d.boxPlan={}),a=e.targetContext;g.targetSize=b;if(!e.parallelSizeModel.shrinkWrap&&!b[h.gotWidth]){c.done=false;return}if(!d.parallelDone){d.parallelDone=c.calculateParallel(e,h,g)}if(!d.perpendicularDone){d.perpendicularDone=c.calculatePerpendicular(e,h,g)}if(d.parallelDone&&d.perpendicularDone){if(c.owner.dock&&(Ext.isIE7m||Ext.isIEQuirks)&&!c.owner.width&&!c.horizontal){g.isIEVerticalDock=true;g.calculatedWidth=g.maxSize+e.getPaddingInfo().width+e.getFrameInfo().width;if(a!==e){g.calculatedWidth+=a.getPaddingInfo().width}}c.publishInnerCtSize(e,c.reserveOffset?c.availableSpaceOffset:0);if(c.done&&(e.childItems.length>1||e.stretchMaxPartner)&&e.boxOptions.align.stretchmax&&!d.stretchMaxDone){c.calculateStretchMax(e,h,g);d.stretchMaxDone=true}c.overflowHandler.calculate(e)}else{c.done=false}},calculateParallel:function(k,n,b){var F=this,z=n.width,a=k.childItems,s=n.beforeX,d=n.afterX,q=n.setWidth,A=a.length,x=k.flexedItems,r=x.length,v=k.boxOptions.pack,m=F.padding,h=b.targetSize[z],B=0,e=m[s],E=e+m[d]+F.scrollOffset+(F.reserveOffset?F.availableSpaceOffset:0),w=Ext.getScrollbarSize()[n.width],u,l,g,y,o,t,D,p,C,c,j;if(w&&F.scrollPerpendicular&&k.parallelSizeModel.shrinkWrap&&!k.boxOptions.align.stretch&&!k.perpendicularSizeModel.shrinkWrap){if(!k.state.perpendicularDone){return false}C=true}for(u=0;u<A;++u){o=a[u];l=o.marginInfo||o.getMarginInfo();B+=l[z];if(!o[n.widthModel].calculated){c=o.getProp(z);E+=c;if(isNaN(E)){return false}}}E+=B;if(k.percentageWidths){j=h-B;if(isNaN(j)){return false}for(u=0;u<A;++u){o=a[u];if(o.percentageParallel){c=Math.ceil(j*o.percentageParallel);c=o.setWidth(c);E+=c}}}if(k.parallelSizeModel.shrinkWrap){b.availableSpace=0;b.tooNarrow=false}else{b.availableSpace=h-E;b.tooNarrow=b.availableSpace<k.flexedMinSize;if(b.tooNarrow&&Ext.getScrollbarSize()[n.height]&&F.scrollParallel&&k.state.perpendicularDone){k.state.perpendicularDone=false;for(u=0;u<A;++u){a[u].invalidate()}}}p=E;g=b.availableSpace;y=k.totalFlex;for(u=0;u<r;u++){o=x[u];t=o.flex;D=F.roundFlex((t/y)*g);D=o[q](D);p+=D;g=Math.max(0,g-D);y-=t}if(v.center){e+=g/2;if(e<0){e=0}}else{if(v.end){e+=g}}for(u=0;u<A;++u){o=a[u];l=o.marginInfo;e+=l[s];o.setProp(n.x,e);e+=l[d]+o.props[z]}p+=k.targetContext.getPaddingInfo()[z];k.state.contentWidth=p;if(C&&(k.peek(n.contentHeight)>b.targetSize[n.height])){p+=w;k[n.hasOverflowY]=true;k.target.componentLayout[n.setWidthInDom]=true;k[n.invalidateScrollY]=Ext.isStrict&&Ext.isIE8}k[n.setContentWidth](p);return true},calculatePerpendicular:function(u,K,z){var t=this,d=u.perpendicularSizeModel.shrinkWrap,b=z.targetSize,j=u.childItems,y=j.length,m=Math.max,l=K.height,n=K.setHeight,h=K.beforeY,s=K.y,H=t.padding,k=H[h],o=b[l]-k-H[K.afterY],E=u.boxOptions.align,p=E.stretch,q=E.stretchmax,N=E.center,M=E.bottom,G=t.constrainAlign,F=0,B=0,D=t.onBeforeConstrainInvalidateChild,A=t.onAfterConstrainInvalidateChild,a=Ext.getScrollbarSize().height,x,I,C,v,w,c,r,e,L,J,g;if(p||((N||M)&&!d)){if(isNaN(o)){return false}}if(t.scrollParallel&&z.tooNarrow){if(d){J=true}else{o-=a;z.targetSize[l]-=a}}if(p){c=o}else{for(I=0;I<y;I++){r=j[I];v=(r.marginInfo||r.getMarginInfo())[l];if(!(g=r.percentagePerpendicular)){C=r.getProp(l)}else{++B;if(d){continue}else{C=g*o-v;C=r[K.setHeight](C)}}if(!d&&G&&r[K.heightModel].shrinkWrap&&C>o){r.invalidate({before:D,after:A,layout:t,childHeight:o,names:K});u.state.parallelDone=false}if(isNaN(F=m(F,C+v,r.target[K.minHeight]||0))){return false}}if(J){F+=a;u[K.hasOverflowX]=true;u.target.componentLayout[K.setHeightInDom]=true;u[K.invalidateScrollX]=Ext.isStrict&&Ext.isIE8}e=u.stretchMaxPartner;if(e){u.setProp("maxChildHeight",F);L=e.childItems;if(L&&L.length){F=m(F,e.getProp("maxChildHeight"));if(isNaN(F)){return false}}}u[K.setContentHeight](F+t.padding[l]+u.targetContext.getPaddingInfo()[l]);if(J){F-=a}z.maxSize=F;if(q){c=F}else{if(N||M||B){if(G){c=d?F:o}else{c=d?F:m(o,F)}c-=u.innerCtContext.getBorderInfo()[l]}}}for(I=0;I<y;I++){r=j[I];v=r.marginInfo||r.getMarginInfo();x=k+v[h];if(p){r[n](c-v[l])}else{g=r.percentagePerpendicular;if(d&&g){v=r.marginInfo||r.getMarginInfo();C=g*c-v[l];C=r.setHeight(C)}if(N){w=c-r.props[l];if(w>0){x=k+Math[t.alignRoundingMethod](w/2)}}else{if(M){x=m(0,c-x-r.props[l])}}}r.setProp(s,x)}return true},onBeforeConstrainInvalidateChild:function(b,a){var c=a.names.heightModel;if(!b[c].constrainedMin){b[c]=Ext.layout.SizeModel.calculated}},onAfterConstrainInvalidateChild:function(b,a){var c=a.names;b.setProp(c.beforeY,0);if(b[c.heightModel].calculated){b[c.setHeight](a.childHeight)}},calculateStretchMax:function(c,k,m){var l=this,h=k.height,n=k.width,g=c.childItems,a=g.length,p=m.maxSize,o=l.onBeforeStretchMaxInvalidateChild,e=l.onAfterStretchMaxInvalidateChild,q,j,d,b;for(d=0;d<a;++d){q=g[d];j=q.props;b=p-q.getMarginInfo()[h];if(b!=j[h]||q[k.heightModel].constrained){q.invalidate({before:o,after:e,layout:l,childWidth:j[n],childHeight:b,childX:j.x,childY:j.y,names:k})}}},onBeforeStretchMaxInvalidateChild:function(b,a){var c=a.names.heightModel;if(!b[c].constrainedMax){b[c]=Ext.layout.SizeModel.calculated}},onAfterStretchMaxInvalidateChild:function(d,c){var e=c.names,a=c.childHeight,b=c.childWidth;d.setProp("x",c.childX);d.setProp("y",c.childY);if(d[e.heightModel].calculated){d[e.setHeight](a)}if(d[e.widthModel].calculated){d[e.setWidth](b)}},completeLayout:function(b){var j=this,i=b.boxNames,h=b.invalidateScrollX,g=b.invalidateScrollY,d,a,e,c,k;j.overflowHandler.completeLayout(b);if(h||g){a=j.getTarget();d=a.dom;k=d.style;if(h){e=a.getStyle("overflowX");if(e=="auto"){e=k.overflowX;k.overflowX="scroll"}else{h=false}}if(g){c=a.getStyle("overflowY");if(c=="auto"){c=k.overflowY;k.overflowY="scroll"}else{g=false}}if(h||g){d.scrollWidth;if(h){k.overflowX=e}if(g){k.overflowY=c}}}if(j.scrollParallel){j.owner.getTargetEl().dom[i.scrollLeft]=j.scrollPos}},finishedLayout:function(a){this.overflowHandler.finishedLayout(a);this.callParent(arguments);this.targetEl.setWidth(a.innerCtContext.props.width)},publishInnerCtSize:function(a,d){var i=this,h=a.boxNames,g=h.height,k=h.width,e=a.boxOptions.align,o=i.owner.dock,l=i.padding,j=a.state.boxPlan,c=j.targetSize,n=c[g],p=a.innerCtContext,b=(a.parallelSizeModel.shrinkWrap||(j.tooNarrow&&i.scrollParallel)?a.state.contentWidth-a.targetContext.getPaddingInfo()[k]:c[k])-(d||0),m;if(e.stretch){m=n}else{m=j.maxSize+l[h.beforeY]+l[h.afterY]+p.getBorderInfo()[g];if(!a.perpendicularSizeModel.shrinkWrap&&(e.center||e.bottom)){m=Math.max(n,m)}}p[h.setWidth](b);p[h.setHeight](m);if(isNaN(b+m)){i.done=false}if(j.calculatedWidth&&(o=="left"||o=="right")){a.setWidth(j.calculatedWidth,true,true)}},onRemove:function(a){var b=this;b.callParent(arguments);if(b.overflowHandler){b.overflowHandler.onRemove(a)}if(a.layoutMarginCap==b.id){delete a.layoutMarginCap}},initOverflowHandler:function(){var d=this,c=d.overflowHandler,b,a;if(typeof c=="string"){c={type:c}}b="None";if(c&&c.type!==undefined){b=c.type}a=Ext.layout.container.boxOverflow[b];if(a[d.type]){a=a[d.type]}d.overflowHandler=Ext.create("Ext.layout.container.boxOverflow."+b,d,c)},getRenderTarget:function(){return this.targetEl},getElementTarget:function(){return this.innerCt},destroy:function(){Ext.destroy(this.innerCt,this.overflowHandler);this.callParent(arguments)},getRenderData:function(){var a=this.callParent();a.targetElCls=this.targetElCls;return a}});Ext.define("Ext.layout.container.HBox",{alias:["layout.hbox"],extend:Ext.layout.container.Box,alternateClassName:"Ext.layout.HBoxLayout",align:"top",constrainAlign:false,type:"hbox",direction:"horizontal",horizontal:true,names:{beforeX:"left",leftCap:"Left",afterX:"right",width:"width",contentWidth:"contentWidth",minWidth:"minWidth",maxWidth:"maxWidth",widthCap:"Width",widthModel:"widthModel",widthIndex:0,x:"x",scrollLeft:"scrollLeft",overflowX:"overflowX",hasOverflowX:"hasOverflowX",invalidateScrollX:"invalidateScrollX",parallelMargins:"lr",center:"middle",beforeY:"top",afterY:"bottom",height:"height",contentHeight:"contentHeight",minHeight:"minHeight",maxHeight:"maxHeight",heightCap:"Height",heightModel:"heightModel",heightIndex:1,y:"y",scrollTop:"scrollTop",overflowY:"overflowY",hasOverflowY:"hasOverflowY",invalidateScrollY:"invalidateScrollY",perpendicularMargins:"tb",getWidth:"getWidth",getHeight:"getHeight",setWidth:"setWidth",setHeight:"setHeight",gotWidth:"gotWidth",gotHeight:"gotHeight",setContentWidth:"setContentWidth",setContentHeight:"setContentHeight",setWidthInDom:"setWidthInDom",setHeightInDom:"setHeightInDom"},sizePolicy:{flex:{"":{readsWidth:0,readsHeight:1,setsWidth:1,setsHeight:0},stretch:{readsWidth:0,readsHeight:0,setsWidth:1,setsHeight:1},stretchmax:{readsWidth:0,readsHeight:1,setsWidth:1,setsHeight:1}},"":{readsWidth:1,readsHeight:1,setsWidth:0,setsHeight:0},stretch:{readsWidth:1,readsHeight:0,setsWidth:0,setsHeight:1},stretchmax:{readsWidth:1,readsHeight:1,setsWidth:0,setsHeight:1}}});Ext.define("Ext.layout.container.VBox",{alias:["layout.vbox"],extend:Ext.layout.container.Box,alternateClassName:"Ext.layout.VBoxLayout",align:"left",constrainAlign:false,type:"vbox",direction:"vertical",horizontal:false,names:{beforeX:"top",leftCap:"Top",afterX:"bottom",width:"height",contentWidth:"contentHeight",minWidth:"minHeight",maxWidth:"maxHeight",widthCap:"Height",widthModel:"heightModel",widthIndex:1,x:"y",scrollLeft:"scrollTop",overflowX:"overflowY",hasOverflowX:"hasOverflowY",invalidateScrollX:"invalidateScrollY",parallelMargins:"tb",center:"center",beforeY:"left",afterY:"right",height:"width",contentHeight:"contentWidth",minHeight:"minWidth",maxHeight:"maxWidth",heightCap:"Width",heightModel:"widthModel",heightIndex:0,y:"x",scrollTop:"scrollLeft",overflowY:"overflowX",hasOverflowY:"hasOverflowX",invalidateScrollY:"invalidateScrollX",perpendicularMargins:"lr",getWidth:"getHeight",getHeight:"getWidth",setWidth:"setHeight",setHeight:"setWidth",gotWidth:"gotHeight",gotHeight:"gotWidth",setContentWidth:"setContentHeight",setContentHeight:"setContentWidth",setWidthInDom:"setHeightInDom",setHeightInDom:"setWidthInDom"},sizePolicy:{flex:{"":{readsWidth:1,readsHeight:0,setsWidth:0,setsHeight:1},stretch:{readsWidth:0,readsHeight:0,setsWidth:1,setsHeight:1},stretchmax:{readsWidth:1,readsHeight:0,setsWidth:1,setsHeight:1}},"":{readsWidth:1,readsHeight:1,setsWidth:0,setsHeight:0},stretch:{readsWidth:0,readsHeight:1,setsWidth:1,setsHeight:0},stretchmax:{readsWidth:1,readsHeight:1,setsWidth:1,setsHeight:0}}});Ext.define("Ext.toolbar.Toolbar",{extend:Ext.container.Container,alias:"widget.toolbar",alternateClassName:"Ext.Toolbar",isToolbar:true,baseCls:Ext.baseCSSPrefix+"toolbar",ariaRole:"toolbar",defaultType:"button",vertical:false,enableOverflow:false,menuTriggerCls:Ext.baseCSSPrefix+"toolbar-more-icon",trackMenus:true,itemCls:Ext.baseCSSPrefix+"toolbar-item",statics:{shortcuts:{"-":"tbseparator"," ":"tbspacer"},shortcutsHV:{0:{"->":{xtype:"tbfill",height:0}},1:{"->":{xtype:"tbfill",width:0}}}},initComponent:function(){var a=this;if(!a.layout&&a.enableOverflow){a.layout={overflowHandler:"Menu"}}if(a.dock==="right"||a.dock==="left"){a.vertical=true}a.layout=Ext.applyIf(Ext.isString(a.layout)?{type:a.layout}:a.layout||{},{type:a.vertical?"vbox":"hbox",align:a.vertical?"stretchmax":"middle"});if(a.vertical){a.addClsWithUI("vertical")}if(a.ui==="footer"){a.ignoreBorderManagement=true}a.callParent();a.addEvents("overflowchange")},getRefItems:function(a){var e=this,b=e.callParent(arguments),d=e.layout,c;if(a&&e.enableOverflow){c=d.overflowHandler;if(c&&c.menu){b=b.concat(c.menu.getRefItems(a))}}return b},lookupComponent:function(e){var d=arguments;if(typeof e=="string"){var b=Ext.toolbar.Toolbar,a=b.shortcutsHV[this.vertical?1:0][e]||b.shortcuts[e];if(typeof a=="string"){e={xtype:a}}else{if(a){e=Ext.apply({},a)}else{e={xtype:"tbtext",text:e}}}this.applyDefaults(e);d=[e]}return this.callParent(d)},applyDefaults:function(a){if(!Ext.isString(a)){a=this.callParent(arguments)}return a},trackMenu:function(c,a){if(this.trackMenus&&c.menu){var d=a?"mun":"mon",b=this;b[d](c,"mouseover",b.onButtonOver,b);b[d](c,"menushow",b.onButtonMenuShow,b);b[d](c,"menuhide",b.onButtonMenuHide,b)}},onBeforeAdd:function(b){var c=this,a=b.isButton;if(a&&c.defaultButtonUI&&b.ui==="default"&&!b.hasOwnProperty("ui")){b.ui=c.defaultButtonUI}else{if((a||b.isFormField)&&c.ui!=="footer"){b.ui=b.ui+"-toolbar"}}if(b instanceof Ext.toolbar.Separator){b.setUI((c.vertical)?"vertical":"horizontal")}c.callParent(arguments)},onAdd:function(a){this.callParent(arguments);this.trackMenu(a)},onRemove:function(a){this.callParent(arguments);this.trackMenu(a,true)},getChildItemsToDisable:function(){return this.items.getRange()},onButtonOver:function(a){if(this.activeMenuBtn&&this.activeMenuBtn!=a){this.activeMenuBtn.hideMenu();a.showMenu();this.activeMenuBtn=a}},onButtonMenuShow:function(a){this.activeMenuBtn=a},onButtonMenuHide:function(a){delete this.activeMenuBtn}});Ext.define("Ext.panel.AbstractPanel",{extend:Ext.container.Container,mixins:{docking:Ext.container.DockingContainer},baseCls:Ext.baseCSSPrefix+"panel",isPanel:true,contentPaddingProperty:"bodyPadding",shrinkWrapDock:false,componentLayout:"dock",childEls:["body"],renderTpl:["{% this.renderDockedItems(out,values,0); %}",(Ext.isIE7m||Ext.isIEQuirks)?'<div style="position:relative"></div>':"",'<div id="{id}-body" class="{baseCls}-body<tpl if="bodyCls"> {bodyCls}</tpl>',' {baseCls}-body-{ui}<tpl if="uiCls">','<tpl for="uiCls"> {parent.baseCls}-body-{parent.ui}-{.}</tpl>','</tpl>{childElCls}"','<tpl if="bodyStyle"> style="{bodyStyle}"</tpl>>',"{%this.renderContainer(out,values);%}","</div>","{% this.renderDockedItems(out,values,1); %}"],bodyPosProps:{x:"x",y:"y"},border:true,emptyArray:[],initComponent:function(){this.initBorderProps();this.callParent()},initBorderProps:function(){var a=this;if(a.frame&&a.border&&a.bodyBorder===undefined){a.bodyBorder=false}if(a.frame&&a.border&&(a.bodyBorder===false||a.bodyBorder===0)){a.manageBodyBorders=true}},beforeDestroy:function(){this.destroyDockedItems();this.callParent()},initItems:function(){this.callParent();this.initDockingItems()},initRenderData:function(){var a=this,b=a.callParent();a.initBodyStyles();a.protoBody.writeTo(b);delete a.protoBody;return b},getComponent:function(a){var b=this.callParent(arguments);if(b===undefined&&!Ext.isNumber(a)){b=this.getDockedComponent(a)}return b},getProtoBody:function(){var b=this,a=b.protoBody;if(!a){b.protoBody=a=new Ext.util.ProtoElement({cls:b.bodyCls,style:b.bodyStyle,clsProp:"bodyCls",styleProp:"bodyStyle",styleIsText:true})}return a},initBodyStyles:function(){var b=this,a=b.getProtoBody();if(b.bodyPadding!==undefined){if(b.layout.managePadding){a.setStyle("padding",0)}else{a.setStyle("padding",this.unitizeBox((b.bodyPadding===true)?5:b.bodyPadding))}}b.initBodyBorder()},initBodyBorder:function(){var a=this;if(a.frame&&a.bodyBorder){if(!Ext.isNumber(a.bodyBorder)){a.bodyBorder=1}a.getProtoBody().setStyle("border-width",this.unitizeBox(a.bodyBorder))}},getCollapsedDockedItems:function(){var a=this;return a.header===false||a.collapseMode=="placeholder"?a.emptyArray:[a.getReExpander()]},setBodyStyle:function(b,d){var c=this,a=c.rendered?c.body:c.getProtoBody();if(Ext.isFunction(b)){b=b()}if(arguments.length==1){if(Ext.isString(b)){b=Ext.Element.parseStyles(b)}a.setStyle(b)}else{a.setStyle(b,d)}return c},addBodyCls:function(b){var c=this,a=c.rendered?c.body:c.getProtoBody();a.addCls(b);return c},removeBodyCls:function(b){var c=this,a=c.rendered?c.body:c.getProtoBody();a.removeCls(b);return c},addUIClsToElement:function(b){var c=this,a=c.callParent(arguments);c.addBodyCls([Ext.baseCSSPrefix+b,c.baseCls+"-body-"+b,c.baseCls+"-body-"+c.ui+"-"+b]);return a},removeUIClsFromElement:function(b){var c=this,a=c.callParent(arguments);c.removeBodyCls([Ext.baseCSSPrefix+b,c.baseCls+"-body-"+b,c.baseCls+"-body-"+c.ui+"-"+b]);return a},addUIToElement:function(){var a=this;a.callParent(arguments);a.addBodyCls(a.baseCls+"-body-"+a.ui)},removeUIFromElement:function(){var a=this;a.callParent(arguments);a.removeBodyCls(a.baseCls+"-body-"+a.ui)},getTargetEl:function(){return this.body},applyTargetCls:function(a){this.getProtoBody().addCls(a)},getRefItems:function(a){var b=this.callParent(arguments);return this.getDockingRefItems(a,b)},setupRenderTpl:function(a){this.callParent(arguments);this.setupDockingRenderTpl(a)}});Ext.define("Ext.panel.Header",{extend:Ext.container.Container,alias:"widget.header",isHeader:true,defaultType:"tool",indicateDrag:false,weight:-1,componentLayout:"body",childEls:["body"],renderTpl:['<div id="{id}-body" class="{headerCls}-body {baseCls}-body {bodyCls} {bodyTargetCls}','<tpl for="uiCls"> {parent.baseCls}-body-{parent.ui}-{.}</tpl>"','<tpl if="bodyStyle"> style="{bodyStyle}"</tpl>>',"{%this.renderContainer(out,values)%}","</div>"],headingTpl:['<span id="{id}-textEl" class="{headerCls}-text {cls}-text" unselectable="on">{title}</span>'],shrinkWrap:3,titlePosition:0,headerCls:Ext.baseCSSPrefix+"header",initComponent:function(){var g=this,e=g.hasOwnProperty("titlePosition"),c=g.items,a=e?g.titlePosition:(c?c.length:0),b=[g.orientation,g.getDockName()],d=g.ownerCt;g.addEvents("click","dblclick");g.indicateDragCls=g.headerCls+"-draggable";g.title=g.title||"&#160;";g.tools=g.tools||[];c=g.items=(c?Ext.Array.slice(c):[]);g.orientation=g.orientation||"horizontal";g.dock=(g.dock)?g.dock:(g.orientation=="horizontal")?"top":"left";if(d?(!d.border&&!d.frame):!g.border){b.push(g.orientation+"-noborder")}g.addClsWithUI(b);g.addCls([g.headerCls,g.headerCls+"-"+g.orientation]);if(g.indicateDrag){g.addCls(g.indicateDragCls)}if(g.iconCls||g.icon||g.glyph){g.initIconCmp();if(!e&&!c.length){++a}c.push(g.iconCmp)}g.titleCmp=new Ext.Component({ariaRole:"heading",focusable:false,noWrap:true,flex:1,rtl:g.rtl,id:g.id+"_hd",style:g.titleAlign?("text-align:"+g.titleAlign):"",cls:g.headerCls+"-text-container "+g.baseCls+"-text-container "+g.baseCls+"-text-container-"+g.ui,renderTpl:g.getTpl("headingTpl"),renderData:{title:g.title,cls:g.baseCls,headerCls:g.headerCls,ui:g.ui},childEls:["textEl"],autoEl:{unselectable:"on"},listeners:{render:g.onTitleRender,scope:g}});g.layout=(g.orientation=="vertical")?{type:"vbox",align:"center",alignRoundingMethod:"ceil"}:{type:"hbox",align:"middle",alignRoundingMethod:"floor"};Ext.Array.push(c,g.tools);g.tools.length=0;g.callParent();if(c.length<a){a=c.length}g.titlePosition=a;g.insert(a,g.titleCmp);g.on({dblclick:g.onDblClick,click:g.onClick,element:"el",scope:g})},initIconCmp:function(){var c=this,b=[c.headerCls+"-icon",c.baseCls+"-icon",c.iconCls],a;if(c.glyph){b.push(c.baseCls+"-glyph")}a={focusable:false,src:Ext.BLANK_IMAGE_URL,cls:b,baseCls:c.baseCls+"-icon",id:c.id+"-iconEl",iconCls:c.iconCls,glyph:c.glyph};if(!Ext.isEmpty(c.icon)){delete a.iconCls;a.src=c.icon}c.iconCmp=new Ext.Img(a)},beforeRender:function(){this.protoEl.unselectable();this.callParent()},afterLayout:function(){var b=this,e,a,c,d;if(b.orientation==="vertical"){b.adjustTitlePosition();a=b.frameTR;if(a){e=b.frameBR;c=b.frameTL;d=(b.getWidth()-a.getPadding("r")-((c)?c.getPadding("l"):b.el.getBorderWidth("l")))+"px";e.setStyle("background-position-x",d);a.setStyle("background-position-x",d)}if(Ext.isIE7&&Ext.isStrict&&b.frame){b.el.repaint()}}},beforeLayout:function(){this.callParent();this.syncBeforeAfterTitleClasses()},adjustTitlePosition:function(){var b=this.titleCmp,a;if(!Ext.isIE9m&&b){a=b.el;a.setStyle("left",a.getWidth()+"px")}},onTitleRender:function(){if(this.orientation==="vertical"){this.titleCmp.el.setVertical(90)}},addUIClsToElement:function(b){var e=this,a=e.callParent(arguments),d=[e.baseCls+"-body-"+b,e.baseCls+"-body-"+e.ui+"-"+b],g,c;if(e.bodyCls){g=e.bodyCls.split(" ");for(c=0;c<d.length;c++){if(!Ext.Array.contains(g,d[c])){g.push(d[c])}}e.bodyCls=g.join(" ")}else{e.bodyCls=d.join(" ")}return a},removeUIClsFromElement:function(b){var e=this,a=e.callParent(arguments),d=[e.baseCls+"-body-"+b,e.baseCls+"-body-"+e.ui+"-"+b],g,c;if(e.bodyCls){g=e.bodyCls.split(" ");for(c=0;c<d.length;c++){Ext.Array.remove(g,d[c])}e.bodyCls=g.join(" ")}return a},addUIToElement:function(){var b=this,c,a;b.callParent(arguments);a=b.baseCls+"-body-"+b.ui;if(b.rendered){if(b.bodyCls){b.body.addCls(b.bodyCls)}else{b.body.addCls(a)}}else{if(b.bodyCls){c=b.bodyCls.split(" ");if(!Ext.Array.contains(c,a)){c.push(a)}b.bodyCls=c.join(" ")}else{b.bodyCls=a}}if(b.titleCmp&&b.titleCmp.rendered){b.titleCmp.addCls(b.baseCls+"-text-container-"+b.ui)}},removeUIFromElement:function(){var b=this,c,a;b.callParent(arguments);a=b.baseCls+"-body-"+b.ui;if(b.rendered){if(b.bodyCls){b.body.removeCls(b.bodyCls)}else{b.body.removeCls(a)}}else{if(b.bodyCls){c=b.bodyCls.split(" ");Ext.Array.remove(c,a);b.bodyCls=c.join(" ")}else{b.bodyCls=a}}if(b.titleCmp&&b.titleCmp.rendered){b.titleCmp.removeCls(b.baseCls+"-text-container-"+b.ui)}},onClick:function(a){this.fireClickEvent("click",a)},onDblClick:function(a){this.fireClickEvent("dblclick",a)},fireClickEvent:function(a,c){var b="."+Ext.panel.Tool.prototype.baseCls;if(!c.getTarget(b)){this.fireEvent(a,this,c)}},getFocusEl:function(){return this.el},getTargetEl:function(){return this.body||this.frameBody||this.el},applyTargetCls:function(a){this.bodyTargetCls=a},setTitle:function(c){var b=this,a=b.titleCmp;b.title=c;if(a.rendered){a.textEl.update(b.title||"&#160;");a.updateLayout()}else{b.titleCmp.on({render:function(){b.setTitle(c)},single:true})}},getMinWidth:function(){var e=this,d=e.titleCmp.textEl.dom,a,g=e.tools,b,c;d.style.display="inline";a=d.offsetWidth;d.style.display="";if(g&&(b=g.length)){for(c=0;c<b;c++){if(g[c].el){a+=g[c].el.dom.offsetWidth}}}if(e.iconCmp){a+=e.iconCmp.el.dom.offsetWidth}return a+10},setIconCls:function(a){var b=this,d=!a||!a.length,c=b.iconCmp;b.iconCls=a;if(!b.iconCmp&&!d){b.initIconCmp();b.insert(0,b.iconCmp)}else{if(c){if(d){b.iconCmp.destroy();delete b.iconCmp}else{c.removeCls(c.iconCls);c.addCls(a);c.iconCls=a}}}},setIcon:function(a){var b=this,d=!a||!a.length,c=b.iconCmp;b.icon=a;if(!b.iconCmp&&!d){b.initIconCmp();b.insert(0,b.iconCmp)}else{if(c){if(d){b.iconCmp.destroy();delete b.iconCmp}else{c.setSrc(b.icon)}}}},setGlyph:function(b){var a=this,c=a.iconCmp;if(!a.iconCmp){a.initIconCmp();a.insert(0,a.iconCmp)}else{if(c){if(b){a.iconCmp.setGlyph(b)}else{a.iconCmp.destroy();delete a.iconCmp}}}},getTools:function(){return this.tools.slice()},addTool:function(a){this.add(Ext.ComponentManager.create(a,"tool"))},syncBeforeAfterTitleClasses:function(){var j=this,h=j.items,e=h.items,b=j.titlePosition,a=e.length,g=h.generation,k=j.syncBeforeAfterGen,m,d,c,l;if(k===g){return}j.syncBeforeAfterGen=g;for(c=0;c<a;++c){l=e[c];m=l.afterTitleCls||(l.afterTitleCls=l.baseCls+"-after-title");d=l.beforeTitleCls||(l.beforeTitleCls=l.baseCls+"-before-title");if(!j.title||c<b){if(k){l.removeCls(m)}l.addCls(d)}else{if(c>b){if(k){l.removeCls(d)}l.addCls(m)}}}},onAdd:function(b,a){var c=this.tools;this.callParent(arguments);if(b.isTool){c.push(b);c[b.type]=b}},initRenderData:function(){return Ext.applyIf(this.callParent(),{bodyCls:this.bodyCls,bodyTargetCls:this.bodyTargetCls,headerCls:this.headerCls})},getDockName:function(){return this.dock}});Ext.define("Ext.dd.DragDrop",{constructor:function(c,a,b){if(c){this.init(c,a,b)}},id:null,config:null,dragElId:null,handleElId:null,invalidHandleTypes:null,invalidHandleIds:null,invalidHandleClasses:null,startPageX:0,startPageY:0,groups:null,locked:false,lock:function(){this.locked=true},moveOnly:false,unlock:function(){this.locked=false},isTarget:true,padding:null,_domRef:null,__ygDragDrop:true,constrainX:false,constrainY:false,minX:0,maxX:0,minY:0,maxY:0,maintainOffset:false,xTicks:null,yTicks:null,primaryButtonOnly:true,available:false,hasOuterHandles:false,b4StartDrag:function(a,b){},startDrag:function(a,b){},b4Drag:function(a){},onDrag:function(a){},onDragEnter:function(a,b){},b4DragOver:function(a){},onDragOver:function(a,b){},b4DragOut:function(a){},onDragOut:function(a,b){},b4DragDrop:function(a){},onDragDrop:function(a,b){},onInvalidDrop:function(a){},b4EndDrag:function(a){},endDrag:function(a){},b4MouseDown:function(a){},onMouseDown:function(a){},onMouseUp:function(a){},onAvailable:function(){},defaultPadding:{left:0,right:0,top:0,bottom:0},constrainTo:function(i,g,n){if(Ext.isNumber(g)){g={left:g,right:g,top:g,bottom:g}}g=g||this.defaultPadding;var k=Ext.get(this.getEl()).getBox(),a=Ext.get(i),m=a.getScroll(),j,d=a.dom,l,h,e;if(d==document.body){j={x:m.left,y:m.top,width:Ext.Element.getViewWidth(),height:Ext.Element.getViewHeight()}}else{l=a.getXY();j={x:l[0],y:l[1],width:d.clientWidth,height:d.clientHeight}}h=k.y-j.y;e=k.x-j.x;this.resetConstraints();this.setXConstraint(e-(g.left||0),j.width-e-k.width-(g.right||0),this.xTickSize);this.setYConstraint(h-(g.top||0),j.height-h-k.height-(g.bottom||0),this.yTickSize)},getEl:function(){if(!this._domRef){this._domRef=Ext.getDom(this.id)}return this._domRef},getDragEl:function(){return Ext.getDom(this.dragElId)},init:function(c,a,b){this.initTarget(c,a,b);Ext.EventManager.on(this.id,"mousedown",this.handleMouseDown,this)},initTarget:function(c,a,b){this.config=b||{};this.DDMInstance=Ext.dd.DragDropManager;this.groups={};if(typeof c!=="string"){c=Ext.id(c)}this.id=c;this.addToGroup((a)?a:"default");this.handleElId=c;this.setDragElId(c);this.invalidHandleTypes={A:"A"};this.invalidHandleIds={};this.invalidHandleClasses=[];this.applyConfig();this.handleOnAvailable()},applyConfig:function(){this.padding=this.config.padding||[0,0,0,0];this.isTarget=(this.config.isTarget!==false);this.maintainOffset=(this.config.maintainOffset);this.primaryButtonOnly=(this.config.primaryButtonOnly!==false)},handleOnAvailable:function(){this.available=true;this.resetConstraints();this.onAvailable()},setPadding:function(c,a,d,b){if(!a&&0!==a){this.padding=[c,c,c,c]}else{if(!d&&0!==d){this.padding=[c,a,c,a]}else{this.padding=[c,a,d,b]}}},setInitPosition:function(d,c){var e=this.getEl(),b,a,g;if(!this.DDMInstance.verifyEl(e)){return}b=d||0;a=c||0;g=Ext.Element.getXY(e);this.initPageX=g[0]-b;this.initPageY=g[1]-a;this.lastPageX=g[0];this.lastPageY=g[1];this.setStartPosition(g)},setStartPosition:function(b){var a=b||Ext.Element.getXY(this.getEl());this.deltaSetXY=null;this.startPageX=a[0];this.startPageY=a[1]},addToGroup:function(a){this.groups[a]=true;this.DDMInstance.regDragDrop(this,a)},removeFromGroup:function(a){if(this.groups[a]){delete this.groups[a]}this.DDMInstance.removeDDFromGroup(this,a)},setDragElId:function(a){this.dragElId=a},setHandleElId:function(a){if(typeof a!=="string"){a=Ext.id(a)}this.handleElId=a;this.DDMInstance.regHandle(this.id,a)},setOuterHandleElId:function(a){if(typeof a!=="string"){a=Ext.id(a)}Ext.EventManager.on(a,"mousedown",this.handleMouseDown,this);this.setHandleElId(a);this.hasOuterHandles=true},unreg:function(){Ext.EventManager.un(this.id,"mousedown",this.handleMouseDown,this);this._domRef=null;this.DDMInstance._remove(this)},destroy:function(){this.unreg()},isLocked:function(){return(this.DDMInstance.isLocked()||this.locked)},handleMouseDown:function(c,b){var a=this,d;if((a.primaryButtonOnly&&c.button!=0)||a.isLocked()){return}a.DDMInstance.refreshCache(a.groups);if(a.hasOuterHandles||a.DDMInstance.isOverTarget(c.getPoint(),a)){if(a.clickValidator(c)){d=Ext.Element.getActiveElement();a.setStartPosition();a.b4MouseDown(c);a.onMouseDown(c);a.DDMInstance.handleMouseDown(c,a);if(d){Ext.fly(d).blur()}a.DDMInstance.stopEvent(c)}}},clickValidator:function(b){var a=b.getTarget();return(this.isValidHandleChild(a)&&(this.id==this.handleElId||this.DDMInstance.handleWasClicked(a,this.id)))},addInvalidHandleType:function(a){var b=a.toUpperCase();this.invalidHandleTypes[b]=b},addInvalidHandleId:function(a){if(typeof a!=="string"){a=Ext.id(a)}this.invalidHandleIds[a]=a},addInvalidHandleClass:function(a){this.invalidHandleClasses.push(a)},removeInvalidHandleType:function(a){var b=a.toUpperCase();delete this.invalidHandleTypes[b]},removeInvalidHandleId:function(a){if(typeof a!=="string"){a=Ext.id(a)}delete this.invalidHandleIds[a]},removeInvalidHandleClass:function(b){for(var c=0,a=this.invalidHandleClasses.length;c<a;++c){if(this.invalidHandleClasses[c]==b){delete this.invalidHandleClasses[c]}}},isValidHandleChild:function(d){var c=true,h,b,a;try{h=d.nodeName.toUpperCase()}catch(g){h=d.nodeName}c=c&&!this.invalidHandleTypes[h];c=c&&!this.invalidHandleIds[d.id];for(b=0,a=this.invalidHandleClasses.length;c&&b<a;++b){c=!Ext.fly(d).hasCls(this.invalidHandleClasses[b])}return c},setXTicks:function(d,a){this.xTicks=[];this.xTickSize=a;var c={},b;for(b=this.initPageX;b>=this.minX;b=b-a){if(!c[b]){this.xTicks[this.xTicks.length]=b;c[b]=true}}for(b=this.initPageX;b<=this.maxX;b=b+a){if(!c[b]){this.xTicks[this.xTicks.length]=b;c[b]=true}}Ext.Array.sort(this.xTicks,this.DDMInstance.numericSort)},setYTicks:function(d,a){this.yTicks=[];this.yTickSize=a;var c={},b;for(b=this.initPageY;b>=this.minY;b=b-a){if(!c[b]){this.yTicks[this.yTicks.length]=b;c[b]=true}}for(b=this.initPageY;b<=this.maxY;b=b+a){if(!c[b]){this.yTicks[this.yTicks.length]=b;c[b]=true}}Ext.Array.sort(this.yTicks,this.DDMInstance.numericSort)},setXConstraint:function(c,b,a){this.leftConstraint=c;this.rightConstraint=b;this.minX=this.initPageX-c;this.maxX=this.initPageX+b;if(a){this.setXTicks(this.initPageX,a)}this.constrainX=true},clearConstraints:function(){this.constrainX=false;this.constrainY=false;this.clearTicks()},clearTicks:function(){this.xTicks=null;this.yTicks=null;this.xTickSize=0;this.yTickSize=0},setYConstraint:function(a,c,b){this.topConstraint=a;this.bottomConstraint=c;this.minY=this.initPageY-a;this.maxY=this.initPageY+c;if(b){this.setYTicks(this.initPageY,b)}this.constrainY=true},resetConstraints:function(){if(this.initPageX||this.initPageX===0){var b=(this.maintainOffset)?this.lastPageX-this.initPageX:0,a=(this.maintainOffset)?this.lastPageY-this.initPageY:0;this.setInitPosition(b,a)}else{this.setInitPosition()}if(this.constrainX){this.setXConstraint(this.leftConstraint,this.rightConstraint,this.xTickSize)}if(this.constrainY){this.setYConstraint(this.topConstraint,this.bottomConstraint,this.yTickSize)}},getTick:function(h,d){if(!d){return h}else{if(d[0]>=h){return d[0]}else{var b,a,c,g,e;for(b=0,a=d.length;b<a;++b){c=b+1;if(d[c]&&d[c]>=h){g=h-d[b];e=d[c]-h;return(e>g)?d[b]:d[c]}}return d[d.length-1]}}},toString:function(){return("DragDrop "+this.id)}});Ext.define("Ext.dd.DD",{extend:Ext.dd.DragDrop,constructor:function(c,a,b){if(c){this.init(c,a,b)}},scroll:true,autoOffset:function(c,b){var a=c-this.startPageX,d=b-this.startPageY;this.setDelta(a,d)},setDelta:function(b,a){this.deltaX=b;this.deltaY=a},setDragElPos:function(c,b){var a=this.getDragEl();this.alignElWithMouse(a,c,b)},alignElWithMouse:function(b,e,c){var g=this.getTargetCoord(e,c),d=b.dom?b:Ext.fly(b,"_dd"),l=d.getSize(),i=Ext.Element,j,a,k,h;if(!this.deltaSetXY){j=this.cachedViewportSize={width:i.getDocumentWidth(),height:i.getDocumentHeight()};a=[Math.max(0,Math.min(g.x,j.width-l.width)),Math.max(0,Math.min(g.y,j.height-l.height))];d.setXY(a);k=this.getLocalX(d);h=d.getLocalY();this.deltaSetXY=[k-g.x,h-g.y]}else{j=this.cachedViewportSize;this.setLocalXY(d,Math.max(0,Math.min(g.x+this.deltaSetXY[0],j.width-l.width)),Math.max(0,Math.min(g.y+this.deltaSetXY[1],j.height-l.height)))}this.cachePosition(g.x,g.y);this.autoScroll(g.x,g.y,b.offsetHeight,b.offsetWidth);return g},cachePosition:function(b,a){if(b){this.lastPageX=b;this.lastPageY=a}else{var c=Ext.Element.getXY(this.getEl());this.lastPageX=c[0];this.lastPageY=c[1]}},autoScroll:function(l,k,e,m){if(this.scroll){var n=Ext.Element.getViewHeight(),b=Ext.Element.getViewWidth(),p=this.DDMInstance.getScrollTop(),d=this.DDMInstance.getScrollLeft(),j=e+k,o=m+l,i=(n+p-k-this.deltaY),g=(b+d-l-this.deltaX),c=40,a=(document.all)?80:30;if(j>n&&i<c){window.scrollTo(d,p+a)}if(k<p&&p>0&&k-p<c){window.scrollTo(d,p-a)}if(o>b&&g<c){window.scrollTo(d+a,p)}if(l<d&&d>0&&l-d<c){window.scrollTo(d-a,p)}}},getTargetCoord:function(c,b){var a=c-this.deltaX,d=b-this.deltaY;if(this.constrainX){if(a<this.minX){a=this.minX}if(a>this.maxX){a=this.maxX}}if(this.constrainY){if(d<this.minY){d=this.minY}if(d>this.maxY){d=this.maxY}}a=this.getTick(a,this.xTicks);d=this.getTick(d,this.yTicks);return{x:a,y:d}},applyConfig:function(){this.callParent();this.scroll=(this.config.scroll!==false)},b4MouseDown:function(a){this.autoOffset(a.getPageX(),a.getPageY())},b4Drag:function(a){this.setDragElPos(a.getPageX(),a.getPageY())},toString:function(){return("DD "+this.id)},getLocalX:function(a){return a.getLocalX()},setLocalXY:function(b,a,c){b.setLocalXY(a,c)}});Ext.define("Ext.dd.DDProxy",{extend:Ext.dd.DD,statics:{dragElId:"ygddfdiv"},constructor:function(c,a,b){if(c){this.init(c,a,b);this.initFrame()}},resizeFrame:true,centerFrame:false,createFrame:function(){var b=this,a=document.body,d,c;if(!a||!a.firstChild){setTimeout(function(){b.createFrame()},50);return}d=this.getDragEl();if(!d){d=document.createElement("div");d.id=this.dragElId;c=d.style;c.position="absolute";c.visibility="hidden";c.cursor="move";c.border="2px solid #aaa";c.zIndex=999;a.insertBefore(d,a.firstChild)}},initFrame:function(){this.createFrame()},applyConfig:function(){this.callParent();this.resizeFrame=(this.config.resizeFrame!==false);this.centerFrame=(this.config.centerFrame);this.setDragElId(this.config.dragElId||Ext.dd.DDProxy.dragElId)},showFrame:function(e,d){var c=this.getEl(),a=this.getDragEl(),b=a.style;this._resizeProxy();if(this.centerFrame){this.setDelta(Math.round(parseInt(b.width,10)/2),Math.round(parseInt(b.height,10)/2))}this.setDragElPos(e,d);Ext.fly(a).show()},_resizeProxy:function(){if(this.resizeFrame){var a=this.getEl();Ext.fly(this.getDragEl()).setSize(a.offsetWidth,a.offsetHeight)}},b4MouseDown:function(b){var a=b.getPageX(),c=b.getPageY();this.autoOffset(a,c);this.setDragElPos(a,c)},b4StartDrag:function(a,b){this.showFrame(a,b)},b4EndDrag:function(a){Ext.fly(this.getDragEl()).hide()},endDrag:function(c){var b=this.getEl(),a=this.getDragEl();a.style.visibility="";this.beforeMove();b.style.visibility="hidden";Ext.dd.DDM.moveToEl(b,a);a.style.visibility="hidden";b.style.visibility="";this.afterDrag()},beforeMove:function(){},afterDrag:function(){},toString:function(){return("DDProxy "+this.id)}});Ext.define("Ext.dd.StatusProxy",{extend:Ext.Component,animRepair:false,childEls:["ghost"],renderTpl:['<div class="'+Ext.baseCSSPrefix+'dd-drop-icon"></div><div id="{id}-ghost" class="'+Ext.baseCSSPrefix+'dd-drag-ghost"></div>'],repairCls:Ext.baseCSSPrefix+"dd-drag-repair",constructor:function(a){var b=this;a=a||{};Ext.apply(b,{hideMode:"visibility",hidden:true,floating:true,id:b.id||Ext.id(),cls:Ext.baseCSSPrefix+"dd-drag-proxy "+this.dropNotAllowed,shadow:a.shadow||false,renderTo:Ext.getDetachedBody()});b.callParent(arguments);this.dropStatus=this.dropNotAllowed},dropAllowed:Ext.baseCSSPrefix+"dd-drop-ok",dropNotAllowed:Ext.baseCSSPrefix+"dd-drop-nodrop",setStatus:function(a){a=a||this.dropNotAllowed;if(this.dropStatus!=a){this.el.replaceCls(this.dropStatus,a);this.dropStatus=a}},reset:function(b){var c=this,a=Ext.baseCSSPrefix+"dd-drag-proxy ";c.el.replaceCls(a+c.dropAllowed,a+c.dropNotAllowed);c.dropStatus=c.dropNotAllowed;if(b){c.ghost.update("")}},update:function(a){if(typeof a=="string"){this.ghost.update(a)}else{this.ghost.update("");a.style.margin="0";this.ghost.dom.appendChild(a)}var b=this.ghost.dom.firstChild;if(b){Ext.fly(b).setStyle("float","none")}},getGhost:function(){return this.ghost},hide:function(a){this.callParent();if(a){this.reset(true)}},stop:function(){if(this.anim&&this.anim.isAnimated&&this.anim.isAnimated()){this.anim.stop()}},sync:function(){this.el.sync()},repair:function(c,d,a){var b=this;b.callback=d;b.scope=a;if(c&&b.animRepair!==false){b.el.addCls(b.repairCls);b.el.hideUnders(true);b.anim=b.el.animate({duration:b.repairDuration||500,easing:"ease-out",to:{x:c[0],y:c[1]},stopAnimation:true,callback:b.afterRepair,scope:b})}else{b.afterRepair()}},afterRepair:function(){var a=this;a.hide(true);a.el.removeCls(a.repairCls);if(typeof a.callback=="function"){a.callback.call(a.scope||a)}delete a.callback;delete a.scope}});Ext.define("Ext.dd.DragSource",{extend:Ext.dd.DDProxy,dropAllowed:Ext.baseCSSPrefix+"dd-drop-ok",dropNotAllowed:Ext.baseCSSPrefix+"dd-drop-nodrop",animRepair:true,repairHighlightColor:"c3daf9",constructor:function(b,a){this.el=Ext.get(b);if(!this.dragData){this.dragData={}}Ext.apply(this,a);if(!this.proxy){this.proxy=new Ext.dd.StatusProxy({id:this.el.id+"-drag-status-proxy",animRepair:this.animRepair})}this.callParent([this.el.dom,this.ddGroup||this.group,{dragElId:this.proxy.id,resizeFrame:false,isTarget:false,scroll:this.scroll===true}]);this.dragging=false},getDragData:function(a){return this.dragData},onDragEnter:function(c,d){var b=Ext.dd.DragDropManager.getDDById(d),a;this.cachedTarget=b;if(this.beforeDragEnter(b,c,d)!==false){if(b.isNotifyTarget){a=b.notifyEnter(this,c,this.dragData);this.proxy.setStatus(a)}else{this.proxy.setStatus(this.dropAllowed)}if(this.afterDragEnter){this.afterDragEnter(b,c,d)}}},beforeDragEnter:function(b,a,c){return true},onDragOver:function(c,d){var b=this.cachedTarget||Ext.dd.DragDropManager.getDDById(d),a;if(this.beforeDragOver(b,c,d)!==false){if(b.isNotifyTarget){a=b.notifyOver(this,c,this.dragData);this.proxy.setStatus(a)}if(this.afterDragOver){this.afterDragOver(b,c,d)}}},beforeDragOver:function(b,a,c){return true},onDragOut:function(b,c){var a=this.cachedTarget||Ext.dd.DragDropManager.getDDById(c);if(this.beforeDragOut(a,b,c)!==false){if(a.isNotifyTarget){a.notifyOut(this,b,this.dragData)}this.proxy.reset();if(this.afterDragOut){this.afterDragOut(a,b,c)}}this.cachedTarget=null},beforeDragOut:function(b,a,c){return true},onDragDrop:function(b,c){var a=this.cachedTarget||Ext.dd.DragDropManager.getDDById(c);if(this.beforeDragDrop(a,b,c)!==false){if(a.isNotifyTarget){if(a.notifyDrop(this,b,this.dragData)!==false){this.onValidDrop(a,b,c)}else{this.onInvalidDrop(a,b,c)}}else{this.onValidDrop(a,b,c)}if(this.afterDragDrop){this.afterDragDrop(a,b,c)}}delete this.cachedTarget},beforeDragDrop:function(b,a,c){return true},onValidDrop:function(b,a,c){this.hideProxy();if(this.afterValidDrop){this.afterValidDrop(b,a,c)}},getRepairXY:function(b,a){return this.el.getXY()},onInvalidDrop:function(b,a,c){if(!a){a=b;b=null;c=a.getTarget().id}this.beforeInvalidDrop(b,a,c);if(this.cachedTarget){if(this.cachedTarget.isNotifyTarget){this.cachedTarget.notifyOut(this,a,this.dragData)}this.cacheTarget=null}this.proxy.repair(this.getRepairXY(a,this.dragData),this.afterRepair,this);if(this.afterInvalidDrop){this.afterInvalidDrop(a,c)}},afterRepair:function(){var a=this;if(Ext.enableFx){a.el.highlight(a.repairHighlightColor)}a.dragging=false},beforeInvalidDrop:function(b,a,c){return true},handleMouseDown:function(b){if(this.dragging){return}var a=this.getDragData(b);if(a&&this.onBeforeDrag(a,b)!==false){this.dragData=a;this.proxy.stop();this.callParent(arguments)}},onBeforeDrag:function(a,b){return true},onStartDrag:Ext.emptyFn,alignElWithMouse:function(){this.proxy.ensureAttachedToBody(true);return this.callParent(arguments)},startDrag:function(a,b){this.proxy.reset();this.proxy.hidden=false;this.dragging=true;this.proxy.update("");this.onInitDrag(a,b);this.proxy.show()},onInitDrag:function(a,c){var b=this.el.dom.cloneNode(true);b.id=Ext.id();this.proxy.update(b);this.onStartDrag(a,c);return true},getProxy:function(){return this.proxy},hideProxy:function(){this.proxy.hide();this.proxy.reset(true);this.dragging=false},triggerCacheRefresh:function(){Ext.dd.DDM.refreshCache(this.groups)},b4EndDrag:function(a){},endDrag:function(a){this.onEndDrag(this.dragData,a)},onEndDrag:function(a,b){},autoOffset:function(a,b){this.setDelta(-12,-20)},destroy:function(){this.callParent();Ext.destroy(this.proxy)}});Ext.define("Ext.panel.Proxy",{alternateClassName:"Ext.dd.PanelProxy",moveOnDrag:true,constructor:function(a,b){var c=this;c.panel=a;c.id=c.panel.id+"-ddproxy";Ext.apply(c,b)},insertProxy:true,setStatus:Ext.emptyFn,reset:Ext.emptyFn,update:Ext.emptyFn,stop:Ext.emptyFn,sync:Ext.emptyFn,getEl:function(){return this.ghost.el},getGhost:function(){return this.ghost},getProxy:function(){return this.proxy},hide:function(){var a=this;if(a.ghost){if(a.proxy){a.proxy.remove();delete a.proxy}a.panel.unghost(null,a.moveOnDrag);delete a.ghost}},show:function(){var b=this,a;if(!b.ghost){a=b.panel.getSize();b.panel.el.setVisibilityMode(Ext.Element.DISPLAY);b.ghost=b.panel.ghost();if(b.insertProxy){b.proxy=b.panel.el.insertSibling({cls:Ext.baseCSSPrefix+"panel-dd-spacer"});b.proxy.setSize(a)}}},repair:function(b,c,a){this.hide();Ext.callback(c,a||this)},moveProxy:function(a,b){if(this.proxy){a.insertBefore(this.proxy.dom,b)}}});Ext.define("Ext.panel.DD",{extend:Ext.dd.DragSource,constructor:function(b,a){var c=this;c.panel=b;c.dragData={panel:b};c.panelProxy=new Ext.panel.Proxy(b,a);c.proxy=c.panelProxy.proxy;c.callParent([b.el,a]);c.setupEl(b)},setupEl:function(a){var c=this,d=a.header,b=a.body;if(d){c.setHandleElId(d.id);b=d.el}if(b){b.setStyle("cursor","move");c.scroll=false}else{a.on("boxready",c.setupEl,c,{single:true})}},showFrame:Ext.emptyFn,startDrag:Ext.emptyFn,b4StartDrag:function(a,b){this.panelProxy.show()},b4MouseDown:function(b){var a=b.getPageX(),c=b.getPageY();this.autoOffset(a,c)},onInitDrag:function(a,b){this.onStartDrag(a,b);return true},createFrame:Ext.emptyFn,getDragEl:function(b){var a=this.panelProxy.ghost;if(a){return a.el.dom}},endDrag:function(a){this.panelProxy.hide();this.panel.saveState()},autoOffset:function(a,b){a-=this.startPageX;b-=this.startPageY;this.setDelta(a,b)},onInvalidDrop:function(c,b,d){var a=this;a.beforeInvalidDrop(c,b,d);if(a.cachedTarget){if(a.cachedTarget.isNotifyTarget){a.cachedTarget.notifyOut(a,b,a.dragData)}a.cacheTarget=null}if(a.afterInvalidDrop){a.afterInvalidDrop(b,d)}}});Ext.define("Ext.layout.component.Dock",{extend:Ext.layout.component.Component,alias:"layout.dock",alternateClassName:"Ext.layout.component.AbstractDock",type:"dock",horzAxisProps:{name:"horz",oppositeName:"vert",dockBegin:"left",dockEnd:"right",horizontal:true,marginBegin:"margin-left",maxSize:"maxWidth",minSize:"minWidth",pos:"x",setSize:"setWidth",shrinkWrapDock:"shrinkWrapDockWidth",size:"width",sizeModel:"widthModel"},vertAxisProps:{name:"vert",oppositeName:"horz",dockBegin:"top",dockEnd:"bottom",horizontal:false,marginBegin:"margin-top",maxSize:"maxHeight",minSize:"minHeight",pos:"y",setSize:"setHeight",shrinkWrapDock:"shrinkWrapDockHeight",size:"height",sizeModel:"heightModel"},initializedBorders:-1,horizontalCollapsePolicy:{width:true,x:true},verticalCollapsePolicy:{height:true,y:true},finishRender:function(){var b=this,c,a;b.callParent();c=b.getRenderTarget();a=b.getDockedItems();b.finishRenderItems(c,a)},isItemBoxParent:function(a){return true},isItemShrinkWrap:function(a){return true},noBorderClasses:[Ext.baseCSSPrefix+"docked-noborder-top",Ext.baseCSSPrefix+"docked-noborder-right",Ext.baseCSSPrefix+"docked-noborder-bottom",Ext.baseCSSPrefix+"docked-noborder-left"],noBorderClassesSides:{top:Ext.baseCSSPrefix+"docked-noborder-top",right:Ext.baseCSSPrefix+"docked-noborder-right",bottom:Ext.baseCSSPrefix+"docked-noborder-bottom",left:Ext.baseCSSPrefix+"docked-noborder-left"},borderWidthProps:{top:"border-top-width",right:"border-right-width",bottom:"border-bottom-width",left:"border-left-width"},handleItemBorders:function(){var n=this,a=n.owner,m,r,j=n.lastDockedItems,h=n.borders,b=a.dockedItems.generation,c=n.noBorderClassesSides,o=n.borderWidthProps,g,l,q,p,k,d,e=n.collapsed;if(n.initializedBorders==b||(a.border&&!a.manageBodyBorders)){return}n.initializedBorders=b;n.collapsed=false;n.lastDockedItems=r=n.getLayoutItems();n.collapsed=e;m={top:[],right:[],bottom:[],left:[]};for(g=0,l=r.length;g<l;g++){q=r[g];p=q.dock;if(q.ignoreBorderManagement){continue}if(!m[p].satisfied){m[p].push(q);m[p].satisfied=true}if(!m.top.satisfied&&p!=="bottom"){m.top.push(q)}if(!m.right.satisfied&&p!=="left"){m.right.push(q)}if(!m.bottom.satisfied&&p!=="top"){m.bottom.push(q)}if(!m.left.satisfied&&p!=="right"){m.left.push(q)}}if(j){for(g=0,l=j.length;g<l;g++){q=j[g];if(!q.isDestroyed&&!q.ignoreBorderManagement&&!a.manageBodyBorders){q.removeCls(n.noBorderClasses)}}}if(h){for(k in h){if(a.manageBodyBorders&&h[k].satisfied){a.setBodyStyle(o[k],"")}}}for(k in m){l=m[k].length;if(!a.manageBodyBorders){for(g=0;g<l;g++){m[k][g].addCls(c[k])}if((!m[k].satisfied&&!a.bodyBorder)||a.bodyBorder===false){a.addBodyCls(c[k])}}else{if(m[k].satisfied){a.setBodyStyle(o[k],"1px")}}}n.borders=m},beforeLayoutCycle:function(g){var c=this,b=c.owner,h=c.sizeModels.shrinkWrap,e=b.shrinkWrapDock,d,a;if(b.collapsed){if(b.collapsedVertical()){a=true;g.measureDimensions=1}else{d=true;g.measureDimensions=2}}g.collapsedVert=a;g.collapsedHorz=d;if(a){g.heightModel=h}else{if(d){g.widthModel=h}}e=e===true?3:(e||0);g.shrinkWrapDockHeight=(e&1)&&g.heightModel.shrinkWrap;g.shrinkWrapDockWidth=(e&2)&&g.widthModel.shrinkWrap},beginLayout:function(d){var k=this,c=k.owner,o=k.getLayoutItems(),b=d.context,g=o.length,l,j,n,a,e,h,m;k.callParent(arguments);h=c.getCollapsed();if(h!==k.lastCollapsedState&&Ext.isDefined(k.lastCollapsedState)){if(k.owner.collapsed){d.isCollapsingOrExpanding=1;c.addClsWithUI(c.collapsedCls)}else{d.isCollapsingOrExpanding=2;c.removeClsWithUI(c.collapsedCls);d.lastCollapsedState=k.lastCollapsedState}}k.lastCollapsedState=h;d.dockedItems=l=[];for(j=0;j<g;j++){n=o[j];if(n.rendered){m=n.dock;a=b.getCmp(n);a.dockedAt={x:0,y:0};a.offsets=e=Ext.Element.parseBox(n.offsets||0);a.horizontal=m=="top"||m=="bottom";e.width=e.left+e.right;e.height=e.top+e.bottom;l.push(a)}}d.bodyContext=d.getEl("body")},beginLayoutCycle:function(b){var e=this,l=b.dockedItems,d=l.length,a=e.owner,g=a.frameBody,k=e.lastHeightModel,c,j,h;e.callParent(arguments);if(e.owner.manageHeight){if(e.lastBodyDisplay){a.body.dom.style.display=e.lastBodyDisplay=""}}else{if(e.lastBodyDisplay!=="inline-block"){a.body.dom.style.display=e.lastBodyDisplay="inline-block"}if(k&&k.shrinkWrap&&!b.heightModel.shrinkWrap){a.body.dom.style.marginBottom=""}}if(b.widthModel.auto){if(b.widthModel.shrinkWrap){a.el.setWidth(null)}a.body.setWidth(null);if(g){g.setWidth(null)}}if(b.heightModel.auto){a.body.setHeight(null);if(g){g.setHeight(null)}}if(b.collapsedVert){b.setContentHeight(0)}else{if(b.collapsedHorz){b.setContentWidth(0)}}for(c=0;c<d;c++){j=l[c].target;h=j.dock;if(h=="right"){j.setLocalX(0)}else{if(h!="left"){continue}}}},calculate:function(d){var l=this,c=l.measureAutoDimensions(d,d.measureDimensions),b=d.state,k=b.horzDone,e=b.vertDone,g=d.bodyContext,j,a,i,h,m;d.borderInfo||d.getBorderInfo();d.paddingInfo||d.getPaddingInfo();d.frameInfo||d.getFrameInfo();g.borderInfo||g.getBorderInfo();g.paddingInfo||g.getPaddingInfo();if(!d.frameBorder){if(!(j=d.framing)){d.frameBorder=d.borderInfo;d.framePadding=d.paddingInfo}else{d.frameBorder=j.border;d.framePadding=j.padding}}a=!k&&l.createAxis(d,c.contentWidth,d.widthModel,l.horzAxisProps,d.collapsedHorz);i=!e&&l.createAxis(d,c.contentHeight,d.heightModel,l.vertAxisProps,d.collapsedVert);for(h=0,m=d.dockedItems.length;m--;++h){if(a){l.dockChild(d,a,m,h)}if(i){l.dockChild(d,i,m,h)}}if(a&&l.finishAxis(d,a)){b.horzDone=k=a}if(i&&l.finishAxis(d,i)){b.vertDone=e=i}if(k&&e&&l.finishConstraints(d,k,e)){l.finishPositions(d,k,e)}else{l.done=false}},createAxis:function(p,j,e,m,d){var u=this,t=0,b=u.owner,g=b[m.maxSize],c=b[m.minSize]||0,n=m.dockBegin,i=m.dockEnd,r=m.pos,l=m.size,k=g!=null,o=e.shrinkWrap,a,s,q,h;if(o){if(d){h=0}else{a=p.bodyContext;h=j+a.borderInfo[l]}}else{s=p.frameBorder;q=p.framePadding;t=s[n]+q[n];h=p.getProp(l)-(s[i]+q[i])}return{shrinkWrap:e.shrinkWrap,sizeModel:e,initialBegin:t,begin:t,end:h,collapsed:d,horizontal:m.horizontal,ignoreFrameBegin:null,ignoreFrameEnd:null,initialSize:h-t,maxChildSize:0,hasMinMaxConstraints:(c||k)&&e.shrinkWrap,minSize:c,maxSize:k?g:1000000000,bodyPosProp:u.owner.manageHeight?r:m.marginBegin,dockBegin:n,dockEnd:i,posProp:r,sizeProp:l,setSize:m.setSize,shrinkWrapDock:p[m.shrinkWrapDock],sizeModelName:m.sizeModel,dockedPixelsEnd:0}},dockChild:function(b,c,l,e){var g=this,a=b.dockedItems[c.shrinkWrap?l:e],i=a.target,j=i.dock,d=c.sizeProp,h,k;if(i.ignoreParentFrame&&b.isCollapsingOrExpanding){a.clearMarginCache()}a.marginInfo||a.getMarginInfo();if(j==c.dockBegin){if(c.shrinkWrap){h=g.dockOutwardBegin(b,a,i,c)}else{h=g.dockInwardBegin(b,a,i,c)}}else{if(j==c.dockEnd){if(c.shrinkWrap){h=g.dockOutwardEnd(b,a,i,c)}else{h=g.dockInwardEnd(b,a,i,c)}}else{if(c.shrinkWrapDock){k=a.getProp(d)+a.marginInfo[d];c.maxChildSize=Math.max(c.maxChildSize,k);h=0}else{h=g.dockStretch(b,a,i,c)}}}a.dockedAt[c.posProp]=h},dockInwardBegin:function(b,a,j,d){var g=d.begin,e=d.sizeProp,c=j.ignoreParentFrame,h,k,i;if(c){d.ignoreFrameBegin=a;i=j.dock;h=b.frameBorder[i];g-=h+b.framePadding[i]}if(!j.overlay){k=a.getProp(e)+a.marginInfo[e];d.begin+=k;if(c){d.begin-=h}}return g},dockInwardEnd:function(e,d,c,b){var i=b.sizeProp,a=d.getProp(i)+d.marginInfo[i],h=b.end-a,g;if(!c.overlay){b.end=h}if(c.ignoreParentFrame){b.ignoreFrameEnd=d;g=e.frameBorder[c.dock];h+=g+e.framePadding[c.dock];b.end+=g}return h},dockOutwardBegin:function(e,d,c,b){var h=b.begin,g=b.sizeProp,a;if(b.collapsed){b.ignoreFrameBegin=b.ignoreFrameEnd=d}else{if(c.ignoreParentFrame){b.ignoreFrameBegin=d}}if(!c.overlay){a=d.getProp(g)+d.marginInfo[g];h-=a;b.begin=h}return h},dockOutwardEnd:function(e,d,c,b){var h=b.end,g=b.sizeProp,a;a=d.getProp(g)+d.marginInfo[g];if(b.collapsed){b.ignoreFrameBegin=b.ignoreFrameEnd=d}else{if(c.ignoreParentFrame){b.ignoreFrameEnd=d}}if(!c.overlay){b.end=h+a;b.dockedPixelsEnd+=a}return h},dockStretch:function(c,b,m,d){var n=m.dock,j=d.sizeProp,a=n=="top"||n=="bottom",i=c.frameBorder,e=b.offsets,l=c.framePadding,h=a?"right":"bottom",p=a?"left":"top",k=d.begin+e[p],g,o;if(m.stretch!==false){o=d.end-k-e[h];if(m.ignoreParentFrame){k-=l[p]+i[p];o+=l[j]+i[j]}g=b.marginInfo;o-=g[j];b[d.setSize](o)}return k},finishAxis:function(m,e){if(isNaN(e.maxChildSize)){return false}var d=e.begin,p=e.end-d,h=e.collapsed,w=e.setSize,k=e.dockBegin,u=e.dockEnd,o=m.framePadding,r=m.frameBorder,g=r[k],s=m.framing,n=s&&s[k],b=h?0:o[k],j=e.sizeProp,t=e.ignoreFrameBegin,q=e.ignoreFrameEnd,a=m.bodyContext,l=Math.max(g+b-n,0),c,x,v,i;if(e.shrinkWrap){x=e.initialSize;if(s){v=-d+g+b;c=v-n-l}else{c=-d;v=c+b}if(!h){p+=o[j]}if(t){v-=g;c-=g;t.dockedAt[e.posProp]-=b}else{p+=g}if(h){}else{if(q){q.dockedAt[e.posProp]+=o[u]}else{p+=r[u]}}e.size=p;if(!e.horizontal&&!this.owner.manageHeight){i=false}}else{if(s){v=0;c=d-n-l}else{v=-g;c=d-b-g}x=p}e.delta=v;a[w](x,i);a.setProp(e.bodyPosProp,c);return !isNaN(p)},beforeInvalidateShrinkWrapDock:function(c,b){var a=b.axis.sizeModelName;if(!c[a].constrainedMin){c[a]=Ext.layout.SizeModel.calculated}},afterInvalidateShrinkWrapDock:function(d,a){var b=a.axis,c=a.layout,e;if(d[b.sizeModelName].calculated){e=c.dockStretch(a.ownerContext,d,d.target,b);d.setProp(b.posProp,b.delta+e)}},finishConstraints:function(k,c,p){var s=this,r=s.sizeModels,o=c.shrinkWrap,q=p.shrinkWrap,a=s.owner,i,m,n,g,h,l,b,d,e,j;if(o){l=c.size;b=c.collapsed?0:c.minSize;d=c.maxSize;e=c.maxChildSize;j=Math.max(l,e);if(j>d){h=r.constrainedMax;n=d}else{if(j<b){h=r.constrainedMin;n=b}else{if(l<e){h=r.constrainedDock;a.dockConstrainedWidth=n=e}else{n=l}}}}if(q){l=p.size;b=p.collapsed?0:p.minSize;d=p.maxSize;e=p.maxChildSize;j=Math.max(l,e+l-p.initialSize);if(j>d){g=r.constrainedMax;m=d}else{if(j<b){g=r.constrainedMin;m=b}else{if(l<e){g=r.constrainedDock;a.dockConstrainedHeight=m=e}else{if(!k.collapsedVert&&!a.manageHeight){i=false;k.bodyContext.setProp("margin-bottom",p.dockedPixelsEnd)}m=l}}}}if(h||g){if(h&&g&&h.constrainedMax&&g.constrainedByMin){k.invalidate({widthModel:h});return false}if(!k.widthModel.calculatedFromShrinkWrap&&!k.heightModel.calculatedFromShrinkWrap){k.invalidate({widthModel:h,heightModel:g});return false}}else{s.invalidateAxes(k,c,p)}if(o){k.setWidth(n);if(h){k.widthModel=h}}if(q){k.setHeight(m,i);if(g){k.heightModel=g}}return true},invalidateAxes:function(g,a,l){var p=this.beforeInvalidateShrinkWrapDock,b=this.afterInvalidateShrinkWrapDock,e=a.end-a.begin,s=l.initialSize,c=a.shrinkWrapDock&&a.maxChildSize<e,m=l.shrinkWrapDock&&l.maxChildSize<s,q,n,k,d,r,o,h,j;if(c||m){if(m){l.begin=l.initialBegin;l.end=l.begin+l.initialSize}q=g.dockedItems;for(k=0,n=q.length;k<n;++k){d=q[k];o=d.horizontal;h=null;if(c&&o){j=a.sizeProp;r=e;h=a}else{if(m&&!o){j=l.sizeProp;r=s;h=l}}if(h){r-=d.getMarginInfo()[j];if(r!==d.props[j]){d.invalidate({before:p,after:b,axis:h,ownerContext:g,layout:this})}}}}},finishPositions:function(d,a,h){var j=d.dockedItems,c=j.length,g=a.delta,e=h.delta,i,b;for(i=0;i<c;++i){b=j[i];b.setProp("x",g+b.dockedAt.x);b.setProp("y",e+b.dockedAt.y)}},finishedLayout:function(b){var a=this,c=b.target;a.callParent(arguments);if(!b.animatePolicy){if(b.isCollapsingOrExpanding===1){c.afterCollapse(false)}else{if(b.isCollapsingOrExpanding===2){c.afterExpand(false)}}}},getAnimatePolicy:function(c){var b=this,a,d;if(c.isCollapsingOrExpanding==1){a=b.lastCollapsedState}else{if(c.isCollapsingOrExpanding==2){a=c.lastCollapsedState}}if(a=="left"||a=="right"){d=b.horizontalCollapsePolicy}else{if(a=="top"||a=="bottom"){d=b.verticalCollapsePolicy}}return d},getDockedItems:function(c,n){var j=this,e=(c==="visual"),k=e?Ext.ComponentQuery.query("[rendered]",j.owner.dockedItems.items):j.owner.dockedItems.items,h=k&&k.length&&c!==false,b,m,l,g,d,a;if(n==null){l=h&&!e?k.slice():k}else{l=[];for(g=0,a=k.length;g<a;++g){m=k[g].dock;d=(m=="top"||m=="left");if(n?d:!d){l.push(k[g])}}h=h&&l.length}if(h){b=(c=c||"render")=="render";Ext.Array.sort(l,function(o,i){var p,q;if(b&&((p=j.owner.dockOrder[o.dock])!==(q=j.owner.dockOrder[i.dock]))){if(!(p+q)){return p-q}}p=j.getItemWeight(o,c);q=j.getItemWeight(i,c);if((p!==undefined)&&(q!==undefined)){return p-q}return 0})}return l||[]},getItemWeight:function(b,a){var c=b.weight||this.owner.defaultDockWeights[b.dock];return c[a]||c},getLayoutItems:function(){var e=this,b,g,d,c,a;if(e.owner.collapsed){a=e.owner.getCollapsedDockedItems()}else{b=e.getDockedItems("visual");g=b.length;a=[];for(c=0;c<g;c++){d=b[c];if(!d.hidden){a.push(d)}}}return a},measureContentWidth:function(a){var b=a.bodyContext;return b.el.getWidth()-b.getBorderInfo().width},measureContentHeight:function(a){var b=a.bodyContext;return b.el.getHeight()-b.getBorderInfo().height},redoLayout:function(c){var b=this,a=b.owner;if(c.isCollapsingOrExpanding==1){if(a.reExpander){a.reExpander.el.show()}a.addClsWithUI(a.collapsedCls);c.redo(true)}else{if(c.isCollapsingOrExpanding==2){a.removeClsWithUI(a.collapsedCls);c.bodyContext.redo()}}},renderChildren:function(){var b=this,a=b.getDockedItems(),c=b.getRenderTarget();b.handleItemBorders();b.renderItems(a,c)},renderItems:function(k,h){var l=this,c=k.length,a=0,b=0,p=0,m=l.getRenderTarget().dom.childNodes,n=m.length,g,d,e,o;for(g=0,d=0;g<n;g++){e=m[g];if(Ext.fly(e).hasCls(Ext.baseCSSPrefix+"resizable-handle")){break}for(d=0;d<c;d++){o=k[d];if(o.rendered&&o.el.dom===e){break}}if(d===c){p++}}for(;a<c;a++,b++){o=k[a];if(a===b&&(o.dock==="right"||o.dock==="bottom")){b+=p}if(o&&!o.rendered){l.renderItem(o,h,b)}else{if(!l.isValidParent(o,h,b)){l.moveItem(o,h,b)}}}},undoLayout:function(c){var b=this,a=b.owner;if(c.isCollapsingOrExpanding==1){if(a.reExpander){a.reExpander.el.hide()}a.removeClsWithUI(a.collapsedCls);c.undo(true)}else{if(c.isCollapsingOrExpanding==2){a.addClsWithUI(a.collapsedCls);c.bodyContext.undo()}}},sizePolicy:{nostretch:{setsWidth:0,setsHeight:0},horz:{shrinkWrap:{setsWidth:1,setsHeight:0,readsWidth:1},stretch:{setsWidth:1,setsHeight:0}},vert:{shrinkWrap:{setsWidth:0,setsHeight:1,readsHeight:1},stretch:{setsWidth:0,setsHeight:1}},stretchV:{setsWidth:0,setsHeight:1},autoStretchH:{readsWidth:1,setsWidth:1,setsHeight:0},autoStretchV:{readsHeight:1,setsWidth:0,setsHeight:1}},getItemSizePolicy:function(d,g){var c=this,h=c.sizePolicy,e=c.owner.shrinkWrapDock,b,a;if(d.stretch===false){return h.nostretch}b=d.dock;a=(b=="left"||b=="right");e=e===true?3:(e||0);if(a){h=h.vert;e=e&1}else{h=h.horz;e=e&2}if(e){if(!g){g=c.owner.getSizeModel()}if(g[a?"height":"width"].shrinkWrap){return h.shrinkWrap}}return h.stretch},configureItem:function(a,b){this.callParent(arguments);a.addCls(Ext.baseCSSPrefix+"docked");a.addClsWithUI(this.getDockCls(a.dock))},getDockCls:function(a){return"docked-"+a},afterRemove:function(a){this.callParent(arguments);if(this.itemCls){a.el.removeCls(this.itemCls+"-"+a.dock)}var b=a.el.dom;if(!a.destroying&&b){b.parentNode.removeChild(b)}this.childrenChanged=true},borderCollapseMap:{},getBorderCollapseTable:function(){var d=this,g=d.borderCollapseMap,a=d.owner,b=a.baseCls,e=a.ui,c;g=g[b]||(g[b]={});c=g[e];if(!c){b+="-"+e+"-outer-border-";g[e]=c=[0,b+"l",b+"b",b+"bl",b+"r",b+"rl",b+"rb",b+"rbl",b+"t",b+"tl",b+"tb",b+"tbl",b+"tr",b+"trl",b+"trb",b+"trbl"]}return c}});Ext.define("Ext.util.Memento",(function(){function d(i,h,j,g){i[g?g+j:j]=h[j]}function c(h,g,i){delete h[i]}function e(k,j,l,i){var g=i?i+l:l,h=k[g];if(h||k.hasOwnProperty(g)){a(j,l,h)}}function a(h,i,g){if(Ext.isDefined(g)){h[i]=g}else{delete h[i]}}function b(h,m,l,i,j){if(m){if(Ext.isArray(i)){var k,g=i.length;for(k=0;k<g;k++){h(m,l,i[k],j)}}else{h(m,l,i,j)}}}return{data:null,target:null,constructor:function(h,g){if(h){this.target=h;if(g){this.capture(g)}}},capture:function(g,j,i){var h=this;b(d,h.data||(h.data={}),j||h.target,g,i)},remove:function(g){b(c,this.data,null,g)},restore:function(h,g,j,i){b(e,this.data,j||this.target,h,i);if(g!==false){this.remove(h)}},restoreAll:function(g,k){var i=this,h=k||this.target,j=i.data,l;for(l in j){if(j.hasOwnProperty(l)){a(h,l,j[l])}}if(g!==false){delete i.data}}}}()));Ext.define("Ext.panel.Panel",{extend:Ext.panel.AbstractPanel,alias:"widget.panel",alternateClassName:"Ext.Panel",collapsedCls:"collapsed",animCollapse:Ext.enableFx,minButtonWidth:75,collapsed:false,collapseFirst:true,hideCollapseTool:false,titleCollapse:undefined,floatable:true,collapsible:undefined,closable:false,closeAction:"destroy",placeholderCollapseHideMode:Ext.Element.VISIBILITY,preventHeader:false,header:undefined,headerPosition:"top",frame:false,frameHeader:true,manageHeight:true,constrain:false,constrainHeader:false,initComponent:function(){var a=this;a.addEvents("beforeclose","close","beforeexpand","beforecollapse","expand","collapse","titlechange","iconchange","iconclschange","glyphchange","float","unfloat");if(a.collapsible){this.addStateEvents(["expand","collapse"])}if(a.unstyled){a.setUI("plain")}if(a.frame){a.setUI(a.ui+"-framed")}a.bridgeToolbars();a.callParent();a.collapseDirection=a.collapseDirection||a.headerPosition||Ext.Component.DIRECTION_TOP;a.hiddenOnCollapse=new Ext.dom.CompositeElement()},beforeDestroy:function(){var a=this;Ext.destroy(a.placeholder,a.ghostPanel,a.dd);a.callParent()},initAria:function(){this.callParent();this.initHeaderAria()},getFocusEl:function(){return this.el},initHeaderAria:function(){var b=this,a=b.el,c=b.header;if(a&&c){a.dom.setAttribute("aria-labelledby",c.titleCmp.id)}},getHeader:function(){return this.header},setTitle:function(g){var c=this,b=c.title,e=c.header,a=c.reExpander,d=c.placeholder;c.title=g;if(e){if(e.isHeader){e.setTitle(g)}else{e.title=g}}else{c.updateHeader()}if(a){a.setTitle(g)}if(d&&d.setTitle){d.setTitle(g)}c.fireEvent("titlechange",c,g,b)},setIconCls:function(a){var c=this,b=c.iconCls,e=c.header,d=c.placeholder;c.iconCls=a;if(e){if(e.isHeader){e.setIconCls(a)}else{e.iconCls=a}}else{c.updateHeader()}if(d&&d.setIconCls){d.setIconCls(a)}c.fireEvent("iconclschange",c,a,b)},setIcon:function(a){var b=this,c=b.icon,e=b.header,d=b.placeholder;b.icon=a;if(e){if(e.isHeader){e.setIcon(a)}else{e.icon=a}}else{b.updateHeader()}if(d&&d.setIcon){d.setIcon(a)}b.fireEvent("iconchange",b,a,c)},setGlyph:function(c){var b=this,a=b.glyph,e=b.header,d=b.placeholder;b.glyph=c;if(e){if(e.isHeader){e.setGlyph(c)}else{e.glyph=c}}else{b.updateHeader()}if(d&&d.setGlyph){d.setIcon(c)}b.fireEvent("glyphchange",b,c,a)},bridgeToolbars:function(){var a=this,g=[],c,b,e=a.minButtonWidth;function d(h,j,i){if(Ext.isArray(h)){h={xtype:"toolbar",items:h}}else{if(!h.xtype){h.xtype="toolbar"}}h.dock=j;if(j=="left"||j=="right"){h.vertical=true}if(i){h.layout=Ext.applyIf(h.layout||{},{pack:{left:"start",center:"center"}[a.buttonAlign]||"end"})}return h}if(a.tbar){g.push(d(a.tbar,"top"));a.tbar=null}if(a.bbar){g.push(d(a.bbar,"bottom"));a.bbar=null}if(a.buttons){a.fbar=a.buttons;a.buttons=null}if(a.fbar){c=d(a.fbar,"bottom",true);c.ui="footer";if(e){b=c.defaults;c.defaults=function(h){var i=b||{};if((!h.xtype||h.xtype==="button"||(h.isComponent&&h.isXType("button")))&&!("minWidth" in i)){i=Ext.apply({minWidth:e},i)}return i}}g.push(c);a.fbar=null}if(a.lbar){g.push(d(a.lbar,"left"));a.lbar=null}if(a.rbar){g.push(d(a.rbar,"right"));a.rbar=null}if(a.dockedItems){if(!Ext.isArray(a.dockedItems)){a.dockedItems=[a.dockedItems]}a.dockedItems=a.dockedItems.concat(g)}else{a.dockedItems=g}},isPlaceHolderCollapse:function(){return this.collapseMode=="placeholder"},onBoxReady:function(){this.callParent();if(this.collapsed){this.setHiddenDocked()}},beforeRender:function(){var b=this,a;b.callParent();b.initTools();if(!(b.preventHeader||(b.header===false))){b.updateHeader()}if(b.collapsed){if(b.isPlaceHolderCollapse()){if(!b.hidden){b.hidden=true;b.preventCollapseFire=true;b.placeholderCollapse();delete b.preventCollapseFire;a=b.collapsed;b.collapsed=false}}else{b.beginCollapse();b.addClsWithUI(b.collapsedCls)}}if(a){b.collapsed=a}},initTools:function(){var a=this;a.tools=a.tools?Ext.Array.clone(a.tools):[];if(a.collapsible&&!(a.hideCollapseTool||a.header===false||a.preventHeader)){a.collapseDirection=a.collapseDirection||a.headerPosition||"top";a.collapseTool=a.expandTool=Ext.widget({xtype:"tool",type:(a.collapsed&&!a.isPlaceHolderCollapse())?("expand-"+a.getOppositeDirection(a.collapseDirection)):("collapse-"+a.collapseDirection),handler:a.toggleCollapse,scope:a});if(a.collapseFirst){a.tools.unshift(a.collapseTool)}}a.addTools();if(a.closable){a.addClsWithUI("closable");a.addTool(Ext.widget({xtype:"tool",type:"close",handler:Ext.Function.bind(a.close,a,[])}))}if(a.collapseTool&&!a.collapseFirst){a.addTool(a.collapseTool)}},addTools:Ext.emptyFn,close:function(){if(this.fireEvent("beforeclose",this)!==false){this.doClose()}},doClose:function(){this.fireEvent("close",this);this[this.closeAction]()},updateHeader:function(d){var c=this,h=c.header,g=c.title,e=c.tools,b=c.icon||c.iconCls,a=c.headerPosition=="left"||c.headerPosition=="right";if(Ext.isObject(h)||(h!==false&&(d||(g||b)||(e&&e.length)||(c.collapsible&&!c.titleCollapse)))){if(h&&h.isHeader){h.show()}else{h=c.header=Ext.widget(Ext.apply({xtype:"header",title:g,titleAlign:c.titleAlign,orientation:a?"vertical":"horizontal",dock:c.headerPosition||"top",textCls:c.headerTextCls,iconCls:c.iconCls,icon:c.icon,glyph:c.glyph,baseCls:c.baseCls+"-header",tools:e,ui:c.ui,id:c.id+"_header",overCls:c.headerOverCls,indicateDrag:c.draggable,frame:(c.frame||c.alwaysFramed)&&c.frameHeader,ignoreParentFrame:c.frame||c.overlapHeader,ignoreBorderManagement:c.frame||c.ignoreHeaderBorderManagement,ownerCt:c,listeners:c.collapsible&&c.titleCollapse?{click:c.toggleCollapse,scope:c}:null},c.header));c.addDocked(h,0)}c.initHeaderAria()}else{if(h){h.hide()}}},setUI:function(b){var a=this;a.callParent(arguments);if(a.header&&a.header.rendered){a.header.setUI(b)}},getDefaultContentTarget:function(){return this.body},getTargetEl:function(){var a=this;return a.body||a.protoBody||a.frameBody||a.el},isVisible:function(a){var b=this;if(b.collapsed&&b.placeholder){return b.placeholder.isVisible(a)}return b.callParent(arguments)},onHide:function(){var a=this;if(a.collapsed&&a.placeholder){a.placeholder.hide()}else{a.callParent(arguments)}},onShow:function(){var a=this;if(a.collapsed&&a.isPlaceHolderCollapse()){a.hidden=true;a.placeholderCollapse()}else{a.callParent(arguments)}},onRemoved:function(b){var a=this;if(a.placeholder&&!b){a.ownerCt.remove(a.placeholder,false)}a.callParent(arguments)},addTool:function(e){if(!Ext.isArray(e)){e=[e]}var d=this,g=d.header,c,a=e.length,b;for(c=0;c<a;c++){b=e[c];if(g&&g.isHeader){g.addTool(b)}else{d.tools.push(b)}}d.updateHeader()},getOppositeDirection:function(a){var b=Ext.Component;switch(a){case b.DIRECTION_TOP:return b.DIRECTION_BOTTOM;case b.DIRECTION_RIGHT:return b.DIRECTION_LEFT;case b.DIRECTION_BOTTOM:return b.DIRECTION_TOP;case b.DIRECTION_LEFT:return b.DIRECTION_RIGHT}},getWidthAuthority:function(){if(this.collapsed&&this.collapsedHorizontal()){return 1}return this.callParent()},getHeightAuthority:function(){if(this.collapsed&&this.collapsedVertical()){return 1}return this.callParent()},collapsedHorizontal:function(){var a=this.getCollapsed();return a=="left"||a=="right"},collapsedVertical:function(){var a=this.getCollapsed();return a=="top"||a=="bottom"},restoreDimension:function(){var a=this.collapseDirection;return(a==="top"||a==="bottom")?"height":"width"},getCollapsed:function(){var a=this;if(a.collapsed===true){return a.collapseDirection}return a.collapsed},getState:function(){var a=this,b=a.callParent(),c;b=a.addPropertyToState(b,"collapsed");if(a.collapsed){c=a.collapseMemento;c=c&&c.data;if(a.collapsedVertical()){if(b){delete b.height}if(c){b=a.addPropertyToState(b,"height",c.height)}}else{if(b){delete b.width}if(c){b=a.addPropertyToState(b,"width",c.width)}}}return b},findReExpander:function(h){var g=this,j=Ext.Component,e=g.dockedItems.items,a=e.length,b,d;if(g.collapseMode=="mini"){return}switch(h){case j.DIRECTION_TOP:case j.DIRECTION_BOTTOM:for(d=0;d<a;d++){b=e[d];if(!b.hidden){if(b.isHeader&&(!b.dock||b.dock=="top"||b.dock=="bottom")){return b}}}break;case j.DIRECTION_LEFT:case j.DIRECTION_RIGHT:for(d=0;d<a;d++){b=e[d];if(!b.hidden){if(b.isHeader&&(b.dock=="left"||b.dock=="right")){return b}}}break;default:throw ("Panel#findReExpander must be passed a valid collapseDirection")}},getReExpander:function(c){var b=this,d=c||b.collapseDirection,a=b.reExpander||b.findReExpander(d);b.expandDirection=b.getOppositeDirection(d);if(!a){b.reExpander=a=b.createReExpander(d,{dock:d,cls:Ext.baseCSSPrefix+"docked "+b.baseCls+"-"+b.ui+"-collapsed"});b.dockedItems.insert(0,a)}return a},createReExpander:function(e,d){var c=this,h=e=="left",b=e=="right",g=h||b,a=Ext.apply({hideMode:"offsets",title:c.title||"&#160;",titleAlign:c.titleAlign,orientation:g?"vertical":"horizontal",textCls:c.headerTextCls,icon:c.icon,iconCls:c.iconCls,glyph:c.glyph,baseCls:c.self.prototype.baseCls+"-header",ui:c.ui,frame:c.frame&&c.frameHeader,ignoreParentFrame:c.frame||c.overlapHeader,indicateDrag:c.draggable,collapseImmune:true,ownerCt:c.ownerCt,ownerLayout:c.componentLayout},d);if(c.collapseMode=="mini"){if(g){a.width=1}else{a.height=1}}if(!c.hideCollapseTool){if(h||(b&&c.isPlaceHolderCollapse())){a.titlePosition=1}a.tools=[{xtype:"tool",type:"expand-"+c.getOppositeDirection(e),uiCls:["top"],handler:c.toggleCollapse,scope:c}]}a=new Ext.panel.Header(a);a.addClsWithUI(c.getHeaderCollapsedClasses(a));return a},getHeaderCollapsedClasses:function(d){var b=this,c=b.collapsedCls,a;a=[c,c+"-"+d.getDockName()];if(b.border&&(!b.frame||(b.frame&&Ext.supports.CSS3BorderRadius))){a.push(c+"-border-"+d.getDockName())}return a},beginCollapse:function(){var e=this,c=e.lastBox,h=e.rendered,b=e.collapseMemento||(e.collapseMemento=new Ext.util.Memento(e)),d=e.getSizeModel(),g=e.header,a;b.capture(["height","minHeight","width","minWidth"]);if(c){b.capture(e.restoreDimension(),c,"last.")}if(e.collapsedVertical()){if(d.width.shrinkWrap){e.width=h?e.getWidth():e.width||e.minWidth||100}delete e.height;e.minHeight=0}else{if(e.collapsedHorizontal()){if(d.height.shrinkWrap){e.height=h?e.getHeight():e.height||e.minHeight||100}delete e.width;e.minWidth=0}}if(e.ownerCt){e.ownerCt.getLayout().beginCollapse(e)}if(!e.isPlaceHolderCollapse()&&g!==false){if(g===(a=e.getReExpander())){g.collapseImmune=true;g.getHierarchyState().collapseImmune=true;g.addClsWithUI(e.getHeaderCollapsedClasses(g));if(g.rendered){g.updateFrame()}}else{if(a.el){a.el.show();a.hidden=false}}}if(e.resizer){e.resizer.disable()}},beginExpand:function(){var e=this,d=e.lastBox,c=e.collapseMemento,a=this.restoreDimension(),g=e.header,b;if(c){c.restore(["minHeight","minWidth",a]);if(d){c.restore(a,true,d,"last.")}}if(e.ownerCt){e.ownerCt.getLayout().beginExpand(e)}if(!e.isPlaceHolderCollapse()&&g!==false){if(g===(b=e.getReExpander())){delete g.collapseImmune;delete g.getHierarchyState().collapseImmune;g.removeClsWithUI(e.getHeaderCollapsedClasses(g));if(g.rendered){g.updateFrame()}}else{b.hidden=true;b.el.hide()}}if(e.resizer){e.resizer.enable()}},collapse:function(d,a){var c=this,e=d||c.collapseDirection,b=c.ownerCt;if(c.isCollapsingOrExpanding){return c}if(arguments.length<2){a=c.animCollapse}if(c.collapsed||c.fireEvent("beforecollapse",c,d,a)===false){return c}if(b&&c.isPlaceHolderCollapse()){return c.placeholderCollapse(d,a)}c.collapsed=e;c.beginCollapse();c.getHierarchyState().collapsed=true;c.fireHierarchyEvent("collapse");return c.doCollapseExpand(1,a)},doCollapseExpand:function(a,b){var d=this,c=d.animCollapse,e=d.ownerLayout;d.animCollapse=b;d.isCollapsingOrExpanding=a;if(b){d.addCls(Ext.baseCSSPrefix+"animating-size")}if(e&&!b){e.onContentChange(d)}else{d.updateLayout({isRoot:true})}d.animCollapse=c;return d},afterCollapse:function(b){var a=this,c=a.ownerLayout;a.isCollapsingOrExpanding=0;if(a.collapseTool){a.collapseTool.setType("expand-"+a.getOppositeDirection(a.collapseDirection))}if(b){a.removeCls(Ext.baseCSSPrefix+"animating-size")}if(c&&b){c.onContentChange(a)}a.setHiddenDocked();a.fireEvent("collapse",a)},setHiddenDocked:function(){var h=this,d=h.hiddenOnCollapse,c=h.getDockedItems(),a=c.length,e=0,g,b;if(h.header!==false){b=h.getReExpander()}d.add(h.body);for(;e<a;e++){g=c[e];if(g&&g!==b&&g.el){d.add(g.el)}}d.setStyle("visibility","hidden")},restoreHiddenDocked:function(){var a=this.hiddenOnCollapse;a.setStyle("visibility","");a.clear()},getPlaceholder:function(e){var d=this,h=e||d.collapseDirection,c=null,g=d.placeholder,b=d.floatable,a=d.titleCollapse;if(!g){if(b||(d.collapsible&&a)){c={click:{fn:(!a&&b)?d.floatCollapsedPanel:d.toggleCollapse,element:"el",scope:d}}}d.placeholder=g=Ext.widget(d.createReExpander(h,{id:d.id+"-placeholder",listeners:c}))}if(!g.placeholderFor){if(!g.isComponent){d.placeholder=g=d.lookupComponent(g)}Ext.applyIf(g,{margins:d.margins,placeholderFor:d});g.addCls([Ext.baseCSSPrefix+"region-collapsed-placeholder",Ext.baseCSSPrefix+"region-collapsed-"+h+"-placeholder",d.collapsedCls])}return g},placeholderCollapse:function(g,a){var d=this,c=d.ownerCt,i=g||d.collapseDirection,b=Ext.baseCSSPrefix+"border-region-slide-in",h=d.getPlaceholder(g),e;d.isCollapsingOrExpanding=1;d.hidden=true;d.collapsed=i;if(h.rendered){if(h.el.dom.parentNode!==d.el.dom.parentNode){d.el.dom.parentNode.insertBefore(h.el.dom,d.el.dom)}h.hidden=false;h.el.show();c.updateLayout()}else{c.insert(c.items.indexOf(d),h)}if(d.rendered){d.el.setVisibilityMode(d.placeholderCollapseHideMode);if(a){d.el.addCls(b);h.el.hide();e=d.convertCollapseDir(i);d.el.slideOut(e,{preserveScroll:true,duration:Ext.Number.from(a,Ext.fx.Anim.prototype.duration),listeners:{afteranimate:function(){d.el.removeCls(b);h.el.show().setStyle("display","none").slideIn(e,{easing:"linear",duration:100,listeners:{afteranimate:function(){h.focus();d.isCollapsingOrExpanding=0;d.fireEvent("collapse",d)}}})}}})}else{d.el.hide();d.isCollapsingOrExpanding=0;d.fireEvent("collapse",d)}}else{d.isCollapsingOrExpanding=0;if(!d.preventCollapseFire){d.fireEvent("collapse",d)}}return d},floatCollapsedPanel:function(){var c=this,i=c.placeholder,h=i.getSize(),d,b=Ext.baseCSSPrefix+"border-region-slide-in",g=c.collapsed,e=c.ownerCt||c,a;if(c.isSliding){return}if(c.el.hasCls(b)){c.slideOutFloatedPanel();return}c.isSliding=true;i.el.hide();i.hidden=true;c.el.show();c.hidden=false;c.collapsed=false;e.updateLayout();d=c.getBox(false,true);i.el.show();i.hidden=false;c.el.hide();c.hidden=true;c.collapsed=g;e.updateLayout();c.slideOutTask=c.slideOutTask||new Ext.util.DelayedTask(c.slideOutFloatedPanel,c);i.el.on("mouseleave",c.onMouseLeaveFloated,c);c.el.on("mouseleave",c.onMouseLeaveFloated,c);i.el.on("mouseenter",c.onMouseEnterFloated,c);c.el.on("mouseenter",c.onMouseEnterFloated,c);c.el.addCls(b);c.floated=true;if(c.collapseTool){c.collapseTool.el.hide()}switch(c.collapsed){case"top":c.setLocalXY(d.x,d.y+h.height-1);break;case"right":c.setLocalXY(d.x-h.width+1,d.y);break;case"bottom":c.setLocalXY(d.x,d.y-h.height+1);break;case"left":c.setLocalXY(d.x+h.width-1,d.y);break}a=c.convertCollapseDir(c.collapsed);c.floatedFromCollapse=c.collapsed;c.collapsed=c.hidden=false;c.el.slideIn(a,{preserveScroll:true,duration:Ext.Number.from(c.animCollapse,Ext.fx.Anim.prototype.duration),listeners:{afteranimate:function(){c.isSliding=false;c.fireEvent("float",c)}}})},onMouseLeaveFloated:function(a){this.slideOutTask.delay(500)},onMouseEnterFloated:function(a){this.slideOutTask.cancel()},isLayoutRoot:function(){if(this.floatedFromCollapse){return true}return this.callParent()},slideOutFloatedPanel:function(){var a=this,c=this.el,b;if(a.isSliding||a.isDestroyed){return}a.isSliding=true;a.floated=false;a.slideOutFloatedPanelBegin();if(typeof a.collapsed=="string"){b=a.convertCollapseDir(a.collapsed)}c.slideOut(b,{preserveScroll:true,duration:Ext.Number.from(a.animCollapse,Ext.fx.Anim.prototype.duration),listeners:{afteranimate:function(){a.slideOutFloatedPanelEnd();a.el.removeCls(Ext.baseCSSPrefix+"border-region-slide-in")}}})},slideOutFloatedPanelBegin:function(){var b=this,c=b.placeholder.el,a=b.el;b.collapsed=b.floatedFromCollapse;b.hidden=true;b.floatedFromCollapse=null;c.un("mouseleave",b.onMouseLeaveFloated,b);a.un("mouseleave",b.onMouseLeaveFloated,b);c.un("mouseenter",b.onMouseEnterFloated,b);a.un("mouseenter",b.onMouseEnterFloated,b)},slideOutFloatedPanelEnd:function(){var a=this;if(a.collapseTool){a.collapseTool.el.show()}a.isSliding=false;a.fireEvent("unfloat",a)},expand:function(a){var b=this;if(b.isCollapsingOrExpanding){return b}if(!arguments.length){a=b.animCollapse}if(!b.collapsed&&!b.floatedFromCollapse){return b}if(b.fireEvent("beforeexpand",b,a)===false){return b}delete this.getHierarchyState().collapsed;if(b.isPlaceHolderCollapse()){return b.placeholderExpand(a)}b.restoreHiddenDocked();b.beginExpand();b.collapsed=false;return b.doCollapseExpand(2,a)},placeholderExpand:function(c){var e=this,h=e.collapsed,d=Ext.baseCSSPrefix+"border-region-slide-in",g,b,a=e.ownerLayout?e.ownerLayout.centerRegion:null;if(Ext.AbstractComponent.layoutSuspendCount){c=false}if(e.floatedFromCollapse){b=e.getPosition(true);e.slideOutFloatedPanelBegin();e.slideOutFloatedPanelEnd();e.floated=false}if(c){Ext.suspendLayouts();e.placeholder.hide();e.el.show();e.hidden=e.collapsed=false;if(a&&!b){a.hidden=true}Ext.resumeLayouts(true);a.hidden=false;e.el.addCls(d);e.isCollapsingOrExpanding=2;if(b){g=e.getXY();e.setLocalXY(b[0],b[1]);e.setXY([g[0],g[1]],{duration:Ext.Number.from(c,Ext.fx.Anim.prototype.duration),listeners:{afteranimate:function(){e.el.removeCls(d);e.isCollapsingOrExpanding=0;e.fireEvent("expand",e)}}})}else{e.el.hide();e.placeholder.el.show();e.placeholder.hidden=false;e.hidden=false;e.el.slideIn(e.convertCollapseDir(h),{preserveScroll:true,duration:Ext.Number.from(c,Ext.fx.Anim.prototype.duration),listeners:{afteranimate:function(){e.el.removeCls(d);e.placeholder.hide();e.updateLayout();e.isCollapsingOrExpanding=0;e.fireEvent("expand",e)}}})}}else{e.floated=e.collapsed=false;Ext.suspendLayouts();e.placeholder.hide();e.show();Ext.resumeLayouts(true);e.fireEvent("expand",e)}return e},afterExpand:function(b){var a=this,c=a.ownerLayout;a.isCollapsingOrExpanding=0;if(a.collapseTool){a.collapseTool.setType("collapse-"+a.collapseDirection)}if(b){a.removeCls(Ext.baseCSSPrefix+"animating-size")}if(c&&b){c.onContentChange(a)}a.fireEvent("expand",a);a.fireHierarchyEvent("expand")},setBorder:function(a,c){if(c){return}var b=this,d=b.header;if(!a){a=0}else{if(a===true){a="1px"}else{a=Ext.Element.unitizeBox(a)}}if(d){if(d.isHeader){d.setBorder(a)}else{d.border=a}}if(b.rendered&&b.bodyBorder!==false){b.body.setStyle("border-width",a)}b.updateLayout();b.border=a},toggleCollapse:function(){return(this.collapsed||this.floatedFromCollapse)?this.expand():this.collapse()},getKeyMap:function(){return this.keyMap||(this.keyMap=new Ext.util.KeyMap(Ext.apply({target:this.el},this.keys)))},initDraggable:function(){if(this.simpleDrag){this.initSimpleDraggable()}else{this.dd=new Ext.panel.DD(this,Ext.isBoolean(this.draggable)?null:this.draggable)}},initSimpleDraggable:function(){var c=this,b,a;if(!c.header){c.updateHeader(true)}if(c.header){b=Ext.applyIf({el:c.el,delegate:"#"+Ext.escapeId(c.header.id)},c.draggable);if(c.constrain||c.constrainHeader){b.constrain=c.constrain;b.constrainDelegate=c.constrainHeader;b.constrainTo=c.constrainTo||c.container}a=c.dd=new Ext.util.ComponentDragger(this,b);c.relayEvents(a,["dragstart","drag","dragend"]);if(c.maximized){a.disable()}}},ghostTools:function(){var e=[],g=this.header,d=g?g.query("tool[hidden=false]"):[],c,a,b;if(d.length){c=0;a=d.length;for(;c<a;c++){b=d[c];e.push({type:b.type})}}else{e=[{type:"placeholder"}]}return e},ghost:function(a){var d=this,b=d.ghostPanel,c=d.getBox(),e;if(!b){b=new Ext.panel.Panel({renderTo:Ext.getBody(),floating:{shadow:false},frame:d.frame&&!d.alwaysFramed,alwaysFramed:d.alwaysFramed,overlapHeader:d.overlapHeader,headerPosition:d.headerPosition,baseCls:d.baseCls,cls:d.baseCls+"-ghost "+(a||"")});d.ghostPanel=b}else{b.el.show()}d.ghostPanel.hidden=false;b.floatParent=d.floatParent;if(d.floating){b.setZIndex(Ext.Number.from(d.el.getStyle("zIndex"),0))}else{b.toFront()}if(!(d.preventHeader||(d.header===false))){e=b.header;if(e){e.suspendLayouts();Ext.Array.forEach(e.query("tool"),e.remove,e);e.resumeLayouts()}b.addTool(d.ghostTools());b.setTitle(d.title);if(d.iconCls){b.setIconCls(d.iconCls)}else{if(d.icon){b.setIcon(d.icon)}else{if(d.glyph){b.setGlyph(d.glyph)}}}b.header.addCls(Ext.baseCSSPrefix+"header-ghost")}b.setPagePosition(c.x,c.y);b.setSize(c.width,c.height);d.el.hide();return b},unghost:function(b,a){var c=this;if(!c.ghostPanel){return}if(b!==false){c.el.show();if(a!==false){c.setPagePosition(c.ghostPanel.getXY());if(c.hideMode=="offsets"){delete c.el.hideModeStyles}}Ext.defer(c.focus,10,c)}c.ghostPanel.el.hide();c.ghostPanel.hidden=true},beginDrag:function(){if(this.floatingDescendants){this.floatingDescendants.hide()}},endDrag:function(){if(this.floatingDescendants){this.floatingDescendants.show()}},initResizable:function(){this.callParent(arguments);if(this.collapsed){this.resizer.disable()}},convertCollapseDir:function(a){return a.substr(0,1)}},function(){this.prototype.animCollapse=Ext.enableFx});Ext.define("Ext.data.IdGenerator",{isGenerator:true,constructor:function(a){var b=this;Ext.apply(b,a);if(b.id){Ext.data.IdGenerator.all[b.id]=b}},getRecId:function(a){return a.modelName+"-"+a.internalId},statics:{all:{},get:function(a){var c,d,b;if(typeof a=="string"){d=b=a;a=null}else{if(a.isGenerator){return a}else{d=a.id||a.type;b=a.type}}c=this.all[d];if(!c){c=Ext.create("idgen."+b,a)}return c}}});Ext.define("Ext.data.SortTypes",{singleton:true,none:Ext.identityFn,stripTagsRE:/<\/?[^>]+>/gi,asText:function(a){return String(a).replace(this.stripTagsRE,"")},asUCText:function(a){return String(a).toUpperCase().replace(this.stripTagsRE,"")},asUCString:function(a){return String(a).toUpperCase()},asDate:function(a){if(!a){return 0}if(Ext.isDate(a)){return a.getTime()}return Date.parse(String(a))},asFloat:function(a){var b=parseFloat(String(a).replace(/,/g,""));return isNaN(b)?0:b},asInt:function(a){var b=parseInt(String(a).replace(/,/g,""),10);return isNaN(b)?0:b}});Ext.define("Ext.data.Types",{singleton:true},function(){var a=Ext.data.SortTypes;Ext.apply(Ext.data.Types,{stripRe:/[\$,%]/g,AUTO:{sortType:a.none,type:"auto"},STRING:{convert:function(c){var b=this.useNull?null:"";return(c===undefined||c===null)?b:String(c)},sortType:a.asUCString,type:"string"},INT:{convert:function(b){if(typeof b=="number"){return parseInt(b)}return b!==undefined&&b!==null&&b!==""?parseInt(String(b).replace(Ext.data.Types.stripRe,""),10):(this.useNull?null:0)},sortType:a.none,type:"int"},FLOAT:{convert:function(b){if(typeof b==="number"){return b}return b!==undefined&&b!==null&&b!==""?parseFloat(String(b).replace(Ext.data.Types.stripRe,""),10):(this.useNull?null:0)},sortType:a.none,type:"float"},BOOL:{convert:function(b){if(typeof b==="boolean"){return b}if(this.useNull&&(b===undefined||b===null||b==="")){return null}return b===true||b==="true"||b==1},sortType:a.none,type:"bool"},DATE:{convert:function(c){var d=this.dateReadFormat||this.dateFormat,b;if(!c){return null}if(c instanceof Date){return c}if(d){return Ext.Date.parse(c,d)}b=Date.parse(c);return b?new Date(b):null},sortType:a.asDate,type:"date"}});Ext.apply(Ext.data.Types,{BOOLEAN:this.BOOL,INTEGER:this.INT,NUMBER:this.FLOAT})});Ext.define("Ext.data.Field",{alias:"data.field",isField:true,constructor:function(b){var d=this,c=Ext.data.Types,a;if(Ext.isString(b)){b={name:b}}Ext.apply(d,b);a=d.sortType;if(d.type){if(Ext.isString(d.type)){d.type=c[d.type.toUpperCase()]||c.AUTO}}else{d.type=c.AUTO}if(Ext.isString(a)){d.sortType=Ext.data.SortTypes[a]}else{if(Ext.isEmpty(a)){d.sortType=d.type.sortType}}if(!b.hasOwnProperty("convert")){d.convert=d.type.convert}else{if(!d.convert&&d.type.convert&&!b.hasOwnProperty("defaultValue")){d.defaultValue=d.type.convert(d.defaultValue)}}if(b.convert){d.hasCustomConvert=true}},dateFormat:null,dateReadFormat:null,dateWriteFormat:null,useNull:false,defaultValue:"",mapping:null,sortType:null,sortDir:"ASC",allowBlank:true,persist:true});Ext.define("Ext.data.Errors",{extend:Ext.util.MixedCollection,isValid:function(){return this.length===0},getByField:function(d){var c=[],a,b;for(b=0;b<this.length;b++){a=this.items[b];if(a.field==d){c.push(a)}}return c}});Ext.define("Ext.data.validations",{singleton:true,presenceMessage:"must be present",lengthMessage:"is the wrong length",formatMessage:"is the wrong format",inclusionMessage:"is not included in the list of acceptable values",exclusionMessage:"is not an acceptable value",emailMessage:"is not a valid email address",emailRe:/^([a-zA-Z0-9_\.\-])+\@(([a-zA-Z0-9\-])+\.)+([a-zA-Z0-9]{2,4})+$/,presence:function(a,b){if(arguments.length===1){b=a}return !!b||b===0||b===false},length:function(b,e){if(e===undefined||e===null){return false}var d=e.length,c=b.min,a=b.max;if((c&&d<c)||(a&&d>a)){return false}else{return true}},email:function(b,a){return Ext.data.validations.emailRe.test(a)},format:function(a,b){return !!(a.matcher&&a.matcher.test(b))},inclusion:function(a,b){return a.list&&Ext.Array.indexOf(a.list,b)!=-1},exclusion:function(a,b){return a.list&&Ext.Array.indexOf(a.list,b)==-1}});Ext.define("Ext.data.Model",{alternateClassName:"Ext.data.Record",mixins:{observable:Ext.util.Observable},compareConvertFields:function(a,d){var c=a.convert&&a.type&&a.convert!==a.type.convert,b=d.convert&&d.type&&d.convert!==d.type.convert;if(c&&!b){return 1}if(!c&&b){return -1}return 0},itemNameFn:function(a){return a.name},onClassExtended:function(b,c,a){var d=a.onBeforeCreated;a.onBeforeCreated=function(g,F){var E=this,G=Ext.getClassName(g),t=g.prototype,z=g.prototype.superclass,j=F.validations||[],v=F.fields||[],h,o=F.associations||[],e=function(I,K){var J=0,H,L;if(I){I=Ext.Array.from(I);for(H=I.length;J<H;++J){L=I[J];if(!Ext.isObject(L)){L={model:L}}L.type=K;o.push(L)}}},w=F.idgen,C=new Ext.util.MixedCollection(false,t.itemNameFn),A=new Ext.util.MixedCollection(false,t.itemNameFn),s=z.validations,D=z.fields,m=z.associations,B,y,q,r=[],p="idProperty" in F?F.idProperty:t.idProperty,n=p?(p.isField?p:new Ext.data.Field(p)):null,k=false,x=function(I,H,i){var J,K;if(C.events.add.firing){K=I;J=H}else{J=i;K=H.originalIndex}J.originalIndex=K;if(n&&((J.mapping&&(J.mapping===n.mapping))||(J.name===n.name))){t.idField=J;k=true;J.defaultValue=undefined}},u=F.proxy,l=function(){C.sortBy(t.compareConvertFields)};g.modelName=G;t.modelName=G;if(s){j=s.concat(j)}F.validations=j;if(D){v=D.items.concat(v)}C.on({add:x,replace:x});for(y=0,q=v.length;y<q;++y){h=v[y];C.add(h.isField?h:new Ext.data.Field(h))}if(n&&!k){t.idField=n;n.defaultValue=undefined;C.add(n)}l();C.on({add:l,replace:l});F.fields=C;if(w){F.idgen=Ext.data.IdGenerator.get(w)}e(F.belongsTo,"belongsTo");delete F.belongsTo;e(F.hasMany,"hasMany");delete F.hasMany;e(F.hasOne,"hasOne");delete F.hasOne;if(m){o=m.items.concat(o)}for(y=0,q=o.length;y<q;++y){r.push("association."+o[y].type.toLowerCase())}if(u){if(!u.isProxy){r.push("proxy."+(u.type||u))}}else{if(!g.prototype.proxy){g.prototype.proxy=g.prototype.defaultProxyType;r.push("proxy."+g.prototype.defaultProxyType)}}Ext.require(r,function(){Ext.ModelManager.registerType(G,g);for(y=0,q=o.length;y<q;++y){B=o[y];if(B.isAssociation){B=Ext.applyIf({ownerModel:G,associatedModel:B.model},B.initialConfig)}else{Ext.apply(B,{ownerModel:G,associatedModel:B.model})}if(Ext.ModelManager.getModel(B.model)===undefined){Ext.ModelManager.registerDeferredAssociation(B)}else{A.add(Ext.data.association.Association.create(B))}}F.associations=A;d.call(E,g,F,a);if(u&&u.isProxy){g.setProxy(u)}Ext.ModelManager.onModelDefined(g)})}},inheritableStatics:{setProxy:function(a){if(!a.isProxy){if(typeof a=="string"){a={type:a}}a=Ext.createByAlias("proxy."+a.type,a)}a.setModel(this);this.proxy=this.prototype.proxy=a;return a},getProxy:function(){var a=this.proxy;if(!a){a=this.prototype.proxy;if(a.isProxy){a=a.clone()}return this.setProxy(a)}return a},setFields:function(g,n,m){var k=this,a,b,l=false,e=k.prototype,c=e.fields,j=e.superclass.fields,h,d;if(n){e.idProperty=n;b=n.isField?n:new Ext.data.Field(n)}if(m){e.clientIdProperty=m}if(c){c.clear()}else{c=k.prototype.fields=new Ext.util.MixedCollection(false,function(i){return i.name})}if(j){g=j.items.concat(g)}for(d=0,h=g.length;d<h;d++){a=new Ext.data.Field(g[d]);if(b&&((a.mapping&&(a.mapping===b.mapping))||(a.name===b.name))){l=true;a.defaultValue=undefined}c.add(a)}if(b&&!l){b.defaultValue=undefined;c.add(b)}k.fields=c;return c},getFields:function(){return this.prototype.fields.items},load:function(g,c){c=Ext.apply({},c);c=Ext.applyIf(c,{action:"read",id:g});var b=new Ext.data.Operation(c),d=c.scope||this,a=null,e;e=function(h){if(h.wasSuccessful()){a=h.getRecords()[0];if(!a.hasId()){a.setId(g)}Ext.callback(c.success,d,[a,h])}else{Ext.callback(c.failure,d,[a,h])}Ext.callback(c.callback,d,[a,h])};this.getProxy().read(b,e,this)}},statics:{PREFIX:"ext-record",AUTO_ID:1,EDIT:"edit",REJECT:"reject",COMMIT:"commit",id:function(a){var b=[this.PREFIX,"-",this.AUTO_ID++].join("");a.phantom=true;a.internalId=b;return b}},idgen:{isGenerator:true,type:"default",generate:function(){return null},getRecId:function(a){return a.modelName+"-"+a.internalId}},editing:false,dirty:false,persistenceProperty:"data",evented:false,isModel:true,phantom:false,idProperty:"id",clientIdProperty:null,defaultProxyType:"ajax",emptyData:[],constructor:function(l,e,q,b){var n=this,k=(e||e===0),r,m,g,o,a,p,h,d,s=n.idProperty,c=n.idField,j;n.raw=q||l;n.modified={};d=n[n.persistenceProperty]=b||{};n.data=n[n.persistenceProperty];n.mixins.observable.constructor.call(n);if(!b){if(l){if(!k&&s){e=l[s];r=(e||e===0)}}else{l=n.emptyData}m=n.fields.items;g=m.length;j=0;if(Ext.isArray(l)){for(;j<g;j++){o=m[j];a=o.name;p=l[o.originalIndex];if(p===undefined){p=o.defaultValue}if(o.convert){p=o.convert(p,n)}if(p!==undefined){d[a]=p}}}else{for(;j<g;j++){o=m[j];a=o.name;p=l[a];if(p===undefined){p=o.defaultValue}if(o.convert){p=o.convert(p,n)}if(p!==undefined){d[a]=p}}}}n.stores=[];if(k){r=true;d[s]=c&&c.convert?c.convert(e):e}else{if(!r){h=n.idgen.generate();if(h!=null){n.preventInternalUpdate=true;n.setId(h);delete n.preventInternalUpdate}}}n.internalId=r?e:Ext.data.Model.id(n);if(typeof n.init=="function"){n.init()}n.id=n.idgen.getRecId(n)},get:function(a){return this[this.persistenceProperty][a]},_singleProp:{},set:function(r,b){var j=this,h=j[j.persistenceProperty],i=j.fields,q=j.modified,o=(typeof r=="string"),p,k,g,n,e,a,c,d,l,m;if(o){m=j._singleProp;m[r]=b}else{m=r}for(a in m){if(m.hasOwnProperty(a)){l=m[a];if(i&&(k=i.get(a))&&k.convert){l=k.convert(l,j)}p=h[a];if(j.isEqual(p,l)){continue}h[a]=l;(e||(e=[])).push(a);if(k&&k.persist){if(q.hasOwnProperty(a)){if(j.isEqual(q[a],l)){delete q[a];j.dirty=false;for(n in q){if(q.hasOwnProperty(n)){j.dirty=true;break}}}}else{j.dirty=true;q[a]=p}}if(a==j.idProperty){g=true;c=p;d=l}}}if(o){delete m[r]}if(g){j.changeId(c,d)}if(!j.editing&&e){j.afterEdit(e)}return e||null},copyFrom:function(j){var h=this,e=h.fields.items,m=e.length,b=[],k,c=0,g,d,n=h.idProperty,a,l;if(j){g=h[h.persistenceProperty];d=j[j.persistenceProperty];for(;c<m;c++){k=e[c];a=k.name;if(a!=n){l=d[a];if(l!==undefined&&!h.isEqual(g[a],l)){g[a]=l;b.push(a)}}}if(h.phantom&&!j.phantom){h.beginEdit();h.setId(j.getId());h.endEdit(true);h.commit(true)}}return b},isEqual:function(d,c){if(d instanceof Date&&c instanceof Date){return d.getTime()===c.getTime()}return d===c},beginEdit:function(){var b=this,a,c,d;if(!b.editing){b.editing=true;b.dirtySave=b.dirty;d=b[b.persistenceProperty];c=b.dataSave={};for(a in d){if(d.hasOwnProperty(a)){c[a]=d[a]}}d=b.modified;c=b.modifiedSave={};for(a in d){if(d.hasOwnProperty(a)){c[a]=d[a]}}}},cancelEdit:function(){var a=this;if(a.editing){a.editing=false;a.modified=a.modifiedSave;a[a.persistenceProperty]=a.dataSave;a.dirty=a.dirtySave;a.modifiedSave=a.dataSave=a.dirtySave=null}},endEdit:function(a,d){var c=this,b,e;a=a===true;if(c.editing){c.editing=false;b=c.dataSave;c.modifiedSave=c.dataSave=c.dirtySave=null;if(!a){if(!d){d=c.getModifiedFieldNames(b)}e=c.dirty||d.length>0;if(e){c.afterEdit(d)}}}},getModifiedFieldNames:function(d){var c=this,e=c[c.persistenceProperty],a=[],b;d=d||c.dataSave;for(b in e){if(e.hasOwnProperty(b)){if(!c.isEqual(e[b],d[b])){a.push(b)}}}return a},getChanges:function(){var a=this.modified,b={},c;for(c in a){if(a.hasOwnProperty(c)){b[c]=this.get(c)}}return b},isModified:function(a){return this.modified.hasOwnProperty(a)},setDirty:function(){var c=this,a=c.fields.items,g=a.length,e,b,d;c.dirty=true;for(d=0;d<g;d++){e=a[d];if(e.persist){b=e.name;c.modified[b]=c.get(b)}}},reject:function(a){var c=this,b=c.modified,d;for(d in b){if(b.hasOwnProperty(d)){if(typeof b[d]!="function"){c[c.persistenceProperty][d]=b[d]}}}c.dirty=false;c.editing=false;c.modified={};if(a!==true){c.afterReject()}},commit:function(a,c){var b=this;b.phantom=b.dirty=b.editing=false;b.modified={};if(a!==true){b.afterCommit(c)}},copy:function(a){var b=this;return new b.self(b.raw,a,null,Ext.apply({},b[b.persistenceProperty]))},setProxy:function(a){if(!a.isProxy){if(typeof a==="string"){a={type:a}}a=Ext.createByAlias("proxy."+a.type,a)}a.setModel(this.self);this.proxy=a;return a},getProxy:function(){return this.hasOwnProperty("proxy")?this.proxy:this.self.getProxy()},validate:function(){var k=new Ext.data.Errors(),c=this.validations,e=Ext.data.validations,b,d,j,a,h,g;if(c){b=c.length;for(g=0;g<b;g++){d=c[g];j=d.field||d.name;h=d.type;a=e[h](d,this.get(j));if(!a){k.add({field:j,message:d.message||e[h+"Message"]})}}}return k},isValid:function(){return this.validate().isValid()},save:function(m){m=Ext.apply({},m);var g=this,b=g.phantom?"create":"update",l=m.scope||g,j=g.stores,c=0,e,h,d,a,k;Ext.apply(m,{records:[g],action:b});a=new Ext.data.Operation(m);k=function(i){d=[g,i];if(i.wasSuccessful()){for(e=j.length;c<e;c++){h=j[c];h.fireEvent("write",h,i);h.fireEvent("datachanged",h)}Ext.callback(m.success,l,d)}else{Ext.callback(m.failure,l,d)}Ext.callback(m.callback,l,d)};g.getProxy()[b](a,k,g);return g},destroy:function(m){m=Ext.apply({records:[this],action:"destroy"},m);var g=this,a=g.phantom!==true,l=m.scope||g,j,c=0,e,h,d,b,k;b=new Ext.data.Operation(m);k=function(i){d=[g,i];j=Ext.Array.clone(g.stores);if(i.wasSuccessful()){for(e=j.length;c<e;c++){h=j[c];if(h.remove){h.remove(g,true)}if(a){h.fireEvent("write",h,i)}}g.clearListeners();Ext.callback(m.success,l,d)}else{Ext.callback(m.failure,l,d)}Ext.callback(m.callback,l,d)};if(a){g.getProxy().destroy(b,k,g)}else{b.complete=b.success=true;b.resultSet=g.getProxy().reader.nullResultSet;k(b)}return g},getId:function(){return this.get(this.idField.name)},getObservableId:function(){return this.id},setId:function(a){this.set(this.idProperty,a)},changeId:function(g,b){var e=this,d,c,a;if(!e.preventInternalUpdate){d=e.hasId(g);c=e.hasId(b);a=e.internalId;e.phantom=!c;if(c!==d||(c&&d)){e.internalId=c?b:Ext.data.Model.id(e)}e.fireEvent("idchanged",e,g,b,a);e.callStore("onIdChanged",g,b,a)}},hasId:function(a){if(arguments.length===0){a=this.getId()}return !!(a||a===0)},join:function(a){var b=this;if(!b.stores.length){b.stores[0]=a}else{Ext.Array.include(this.stores,a)}this.store=this.stores[0]},unjoin:function(a){Ext.Array.remove(this.stores,a);this.store=this.stores[0]||null},afterEdit:function(a){this.callStore("afterEdit",a)},afterReject:function(){this.callStore("afterReject")},afterCommit:function(a){this.callStore("afterCommit",a)},callStore:function(g){var d=Ext.Array.clone(arguments),b=this.stores,e=0,a=b.length,c;d[0]=this;for(;e<a;++e){c=b[e];if(c&&Ext.isFunction(c[g])){c[g].apply(c,d)}}},getData:function(c){var d=this,a=d.fields.items,h=a.length,g={},b,e;for(e=0;e<h;e++){b=a[e].name;g[b]=d.get(b)}if(c===true){Ext.apply(g,d.getAssociatedData())}return g},getAssociatedData:function(){return this.prepareAssociatedData({},1)},prepareAssociatedData:function(w,z){var y=this,t=y.associations.items,e=t.length,x={},q=[],v=[],m=[],p,b,a,n,g,l,k,u,h,c,s,r,d,A;for(s=0;s<e;s++){c=t[s];u=c.associationId;k=w[u];if(k&&k!==z){continue}w[u]=z;d=c.type;A=c.name;if(d=="hasMany"){p=y[c.storeName];x[A]=[];if(p&&p.getCount()>0){b=p.data.items;h=b.length;for(r=0;r<h;r++){a=b[r];x[A][r]=a.getData();q.push(a);v.push(A);m.push(r)}}}else{if(d=="belongsTo"||d=="hasOne"){a=y[c.instanceName];if(a!==undefined){x[A]=a.getData();q.push(a);v.push(A);m.push(-1)}}}}for(s=0,h=q.length;s<h;++s){a=q[s];n=x[v[s]];g=m[s];l=a.prepareAssociatedData(w,z+1);if(g===-1){Ext.apply(n,l)}else{Ext.apply(n[g],l)}}return x}});Ext.define("Ext.data.proxy.Server",{extend:Ext.data.proxy.Proxy,alias:"proxy.server",alternateClassName:"Ext.data.ServerProxy",pageParam:"page",startParam:"start",limitParam:"limit",groupParam:"group",groupDirectionParam:"groupDir",sortParam:"sort",filterParam:"filter",directionParam:"dir",idParam:"id",simpleSortMode:false,simpleGroupMode:false,noCache:true,cacheString:"_dc",timeout:30000,constructor:function(a){var b=this;a=a||{};b.callParent([a]);b.extraParams=a.extraParams||{};b.api=Ext.apply({},a.api||b.api);b.nocache=b.noCache},create:function(){return this.doRequest.apply(this,arguments)},read:function(){return this.doRequest.apply(this,arguments)},update:function(){return this.doRequest.apply(this,arguments)},destroy:function(){return this.doRequest.apply(this,arguments)},setExtraParam:function(a,b){this.extraParams[a]=b},buildRequest:function(a){var c=this,d=a.params=Ext.apply({},a.params,c.extraParams),b;Ext.applyIf(d,c.getParams(a));if(a.id!==undefined&&d[c.idParam]===undefined){d[c.idParam]=a.id}b=new Ext.data.Request({params:d,action:a.action,records:a.records,operation:a,url:a.url,proxy:c});b.url=c.buildUrl(b);a.request=b;return b},processResponse:function(h,a,c,b,g,i){var e=this,d,j;if(h===true){d=e.getReader();d.applyDefaults=a.action==="read";j=d.read(e.extractResponseData(b));if(j.success!==false){Ext.apply(a,{response:b,resultSet:j});a.commitRecords(j.records);a.setCompleted();a.setSuccessful()}else{a.setException(j.message);e.fireEvent("exception",this,b,a)}}else{e.setException(a,b);e.fireEvent("exception",this,b,a)}if(typeof g=="function"){g.call(i||e,a)}e.afterRequest(c,h)},setException:function(b,a){b.setException({status:a.status,statusText:a.statusText})},extractResponseData:Ext.identityFn,applyEncoding:function(a){return Ext.encode(a)},encodeSorters:function(d){var b=[],c=d.length,a=0;for(;a<c;a++){b[a]={property:d[a].property,direction:d[a].direction}}return this.applyEncoding(b)},encodeFilters:function(d){var b=[],c=d.length,a=0;for(;a<c;a++){b[a]={property:d[a].property,value:d[a].value}}return this.applyEncoding(b)},getParams:function(p){var w=this,v={},s=Ext.isDefined,t=p.groupers,a=p.sorters,n=p.filters,i=p.page,h=p.start,u=p.limit,l=w.simpleSortMode,d=w.simpleGroupMode,r=w.pageParam,g=w.startParam,b=w.limitParam,c=w.groupParam,m=w.groupDirectionParam,e=w.sortParam,q=w.filterParam,o=w.directionParam,k,j;if(r&&s(i)){v[r]=i}if(g&&s(h)){v[g]=h}if(b&&s(u)){v[b]=u}k=c&&t&&t.length>0;if(k){if(d){v[c]=t[0].property;v[m]=t[0].direction||"ASC"}else{v[c]=w.encodeSorters(t)}}if(e&&a&&a.length>0){if(l){j=0;if(a.length>1&&k){j=1}v[e]=a[j].property;v[o]=a[j].direction}else{v[e]=w.encodeSorters(a)}}if(q&&n&&n.length>0){v[q]=w.encodeFilters(n)}return v},buildUrl:function(c){var b=this,a=b.getUrl(c);if(b.noCache){a=Ext.urlAppend(a,Ext.String.format("{0}={1}",b.cacheString,Ext.Date.now()))}return a},getUrl:function(a){return a.url||this.api[a.action]||this.url},doRequest:function(a,c,b){},afterRequest:Ext.emptyFn,onDestroy:function(){Ext.destroy(this.reader,this.writer)}});Ext.define("Ext.data.proxy.Ajax",{extend:Ext.data.proxy.Server,alias:"proxy.ajax",alternateClassName:["Ext.data.HttpProxy","Ext.data.AjaxProxy"],actionMethods:{create:"POST",read:"GET",update:"POST",destroy:"POST"},binary:false,doRequest:function(a,e,b){var d=this.getWriter(),c=this.buildRequest(a);if(a.allowWrite()){c=d.write(c)}Ext.apply(c,{binary:this.binary,headers:this.headers,timeout:this.timeout,scope:this,callback:this.createRequestCallback(c,a,e,b),method:this.getMethod(c),disableCaching:false});Ext.Ajax.request(c);return c},getMethod:function(a){return this.actionMethods[a.action]},createRequestCallback:function(d,a,e,b){var c=this;return function(h,i,g){c.processResponse(i,a,d,g,e,b)}}},function(){Ext.data.HttpProxy=this});Ext.define("Ext.data.proxy.Client",{extend:Ext.data.proxy.Proxy,alternateClassName:"Ext.data.ClientProxy",isSynchronous:true,clear:function(){}});Ext.define("Ext.data.proxy.Memory",{extend:Ext.data.proxy.Client,alias:"proxy.memory",alternateClassName:"Ext.data.MemoryProxy",constructor:function(a){this.callParent([a]);this.setReader(this.reader)},updateOperation:function(b,g,d){var c=0,e=b.getRecords(),a=e.length;for(c;c<a;c++){e[c].commit()}b.setCompleted();b.setSuccessful();Ext.callback(g,d||this,[b])},create:function(){this.updateOperation.apply(this,arguments)},update:function(){this.updateOperation.apply(this,arguments)},destroy:function(){this.updateOperation.apply(this,arguments)},read:function(c,i,j){var g=this,h=c.resultSet=g.getReader().read(g.data),b=h.records,e=c.sorters,d=c.groupers,a=c.filters;c.setCompleted();if(h.success){if(a&&a.length){b=h.records=Ext.Array.filter(b,Ext.util.Filter.createFilterFn(a))}if(d&&d.length){Ext.Array.insert(e||[],0,d)}if(e&&e.length){h.records=Ext.Array.sort(b,Ext.util.Sortable.createComparator(e))}if(g.enablePaging&&c.start!==undefined&&c.limit!==undefined){if(c.start>=h.total){h.success=false;h.count=0;h.records=[]}else{h.records=Ext.Array.slice(h.records,c.start,c.start+c.limit);h.count=h.records.length}}}if(h.success){c.setSuccessful()}else{g.fireEvent("exception",g,null,c)}Ext.callback(i,j||g,[c])},clear:Ext.emptyFn});Ext.define("Ext.util.LruCache",{extend:Ext.util.HashMap,constructor:function(a){Ext.apply(this,a);this.callParent([a])},add:function(b,e){var d=this,a=d.findKey(e),c;if(a){d.unlinkEntry(c=d.map[a]);c.prev=d.last;c.next=null}else{c={prev:d.last,next:null,key:b,value:e}}if(d.last){d.last.next=c}else{d.first=c}d.last=c;d.callParent([b,c]);d.prune();return e},insertBefore:function(b,g,c){var e=this,a,d;if(c=this.map[this.findKey(c)]){a=e.findKey(g);if(a){e.unlinkEntry(d=e.map[a])}else{d={prev:c.prev,next:c,key:b,value:g}}if(c.prev){d.prev.next=d}else{e.first=d}d.next=c;c.prev=d;e.prune();return g}else{return e.add(b,g)}},get:function(a){var b=this.map[a];if(b){if(b.next){this.moveToEnd(b)}return b.value}},removeAtKey:function(a){this.unlinkEntry(this.map[a]);return this.callParent(arguments)},clear:function(a){this.first=this.last=null;return this.callParent(arguments)},unlinkEntry:function(a){if(a){if(a.next){a.next.prev=a.prev}else{this.last=a.prev}if(a.prev){a.prev.next=a.next}else{this.first=a.next}a.prev=a.next=null}},moveToEnd:function(a){this.unlinkEntry(a);if(a.prev=this.last){this.last.next=a}else{this.first=a}this.last=a},getArray:function(c){var a=[],b=this.first;while(b){a.push(c?b.key:b.value);b=b.next}return a},each:function(c,b,a){var g=this,e=a?g.last:g.first,d=g.length;b=b||g;while(e){if(c.call(b,e.key,e.value,d)===false){break}e=a?e.prev:e.next}return g},findKey:function(b){var a,c=this.map;for(a in c){if(c.hasOwnProperty(a)&&c[a].value===b){return a}}return undefined},clone:function(){var a=new this.self(this.initialConfig),c=this.map,b;a.suspendEvents();for(b in c){if(c.hasOwnProperty(b)){a.add(b,c[b].value)}}a.resumeEvents();return a},prune:function(){var a=this,b=a.maxSize?(a.length-a.maxSize):0;if(b>0){for(;a.first&&b;b--){a.removeAtKey(a.first.key)}}}});Ext.define("Ext.data.Group",{extend:Ext.util.Observable,key:undefined,dirty:true,constructor:function(){this.callParent(arguments);this.records=[]},contains:function(a){return Ext.Array.indexOf(this.records,a)},add:function(a){Ext.Array.push(this.records,a);this.dirty=true},remove:function(b){if(!Ext.isArray(b)){b=[b]}var a=b.length,c;for(c=0;c<a;++c){Ext.Array.remove(this.records,b[c])}this.dirty=true},isDirty:function(){return this.dirty},hasAggregate:function(){return !!this.aggregate},setDirty:function(){this.dirty=true},commit:function(){this.dirty=false},isCollapsed:function(){return this.collapsed},getAggregateRecord:function(a){var b=this,c;if(a===true||b.dirty||!b.aggregate){c=b.store.model;b.aggregate=new c();b.aggregate.isSummary=true}return b.aggregate}});Ext.define("Ext.data.Store",{extend:Ext.data.AbstractStore,alias:"store.store",remoteSort:false,remoteFilter:false,remoteGroup:false,groupField:undefined,groupDir:"ASC",trailingBufferZone:25,leadingBufferZone:200,pageSize:undefined,currentPage:1,clearOnPageLoad:true,loading:false,sortOnFilter:true,buffered:false,purgePageCount:5,clearRemovedOnLoad:true,defaultPageSize:25,defaultViewSize:100,addRecordsOptions:{addRecords:true},statics:{recordIdFn:function(a){return a.internalId},recordIndexFn:function(a){return a.index},grouperIdFn:function(a){return a.id||a.property},groupIdFn:function(a){return a.key}},constructor:function(b){b=Ext.apply({},b);var d=this,g=b.groupers||d.groupers,a=b.groupField||d.groupField,c,e;e=b.data||d.data;if(e){d.inlineData=e;delete b.data}if(!g&&a){g=[{property:a,direction:b.groupDir||d.groupDir}]}delete b.groupers;d.groupers=new Ext.util.MixedCollection(false,Ext.data.Store.grouperIdFn);d.groupers.addAll(d.decodeGroupers(g));d.groups=new Ext.util.MixedCollection(false,Ext.data.Store.groupIdFn);d.callParent([b]);if(d.buffered){d.data=new d.PageMap({store:d,keyFn:Ext.data.Store.recordIdFn,pageSize:d.pageSize,maxSize:d.purgePageCount,listeners:{clear:d.onPageMapClear,scope:d}});d.pageRequests={};d.remoteSort=d.remoteGroup=d.remoteFilter=true;d.sortOnLoad=false;d.filterOnLoad=false}else{d.data=new Ext.util.MixedCollection({getKey:Ext.data.Store.recordIdFn,maintainIndices:true});d.data.pageSize=d.pageSize}if(d.remoteGroup){d.remoteSort=true}c=d.proxy;e=d.inlineData;if(!d.buffered&&!d.pageSize){d.pageSize=d.defaultPageSize}if(e){if(c instanceof Ext.data.proxy.Memory){c.data=e;d.read()}else{d.add.apply(d,[e])}if(!d.remoteSort){d.sort()}delete d.inlineData}else{if(d.autoLoad){Ext.defer(d.load,1,d,[typeof d.autoLoad==="object"?d.autoLoad:undefined])}}if(d.groupers.items.length&&!d.remoteGroup){d.group(null,null,true)}},onBeforeSort:function(){var a=this.groupers;if(a.getCount()>0){this.sort(a.items,"prepend",false)}},decodeGroupers:function(e){if(!Ext.isArray(e)){if(e===undefined){e=[]}else{e=[e]}}var d=e.length,g=Ext.util.Grouper,b,c,a=[];for(c=0;c<d;c++){b=e[c];if(!(b instanceof g)){if(Ext.isString(b)){b={property:b}}b=Ext.apply({root:"data",direction:"ASC"},b);if(b.fn){b.sorterFn=b.fn}if(typeof b=="function"){b={sorterFn:b}}a.push(new g(b))}else{a.push(b)}}return a},group:function(c,j,k){var e=this,a,b,g=e.groupers.getRange(),d,h=g.length;for(d=0;d<h;d++){e.sorters.remove(g[d])}if(Ext.isArray(c)){b=c}else{if(Ext.isObject(c)){b=[c]}else{if(Ext.isString(c)){a=e.groupers.get(c);if(!a){a={property:c,direction:j||"ASC"};b=[a]}else{if(j===undefined){a.toggle()}else{a.setDirection(j)}}}}}if(b&&b.length){e.groupers.clear();e.groupers.addAll(e.decodeGroupers(b))}e.sorters.insert(0,e.groupers.getRange());if(e.remoteGroup){if(e.buffered){e.data.clear();e.loadPage(1,{groupChange:true})}else{e.load({scope:e,callback:k?null:e.fireGroupChange})}}else{e.doSort(e.generateComparator());e.constructGroups();if(!k){e.fireGroupChange()}}},getGroupField:function(){var b=this.groupers.first(),a;if(b){a=b.property}return a},constructGroups:function(){var e=this,g=this.data.items,c=g.length,b=e.groups,a,d,h,j;b.clear();for(d=0;d<c;++d){j=g[d];a=e.getGroupString(j);h=b.get(a);if(!h){h=new Ext.data.Group({key:a,store:e});b.add(a,h)}h.add(j)}},clearGrouping:function(){var c=this,d=c.groupers.items,b=d.length,a;for(a=0;a<b;a++){c.sorters.remove(d[a])}c.groupers.clear();if(c.remoteGroup){if(c.buffered){c.data.clear();c.loadPage(1,{groupChange:true})}else{c.load({scope:c,callback:c.fireGroupChange})}}else{c.groups.clear();if(c.sorters.length){c.sort()}else{c.fireEvent("datachanged",c);c.fireEvent("refresh",c)}c.fireGroupChange()}},isGrouped:function(){return this.groupers.getCount()>0},fireGroupChange:function(){this.fireEvent("groupchange",this,this.groupers)},getGroups:function(b){var d=this.data.items,a=d.length,c=[],k={},g,h,j,e;for(e=0;e<a;e++){g=d[e];h=this.getGroupString(g);j=k[h];if(j===undefined){j={name:h,children:[]};c.push(j);k[h]=j}j.children.push(g)}return b?k[b]:c},getGroupsForGrouper:function(g,b){var d=g.length,e=[],a,c,j,k,h;for(h=0;h<d;h++){j=g[h];c=b.getGroupString(j);if(c!==a){k={name:c,grouper:b,records:[]};e.push(k)}k.records.push(j);a=c}return e},getGroupsForGrouperIndex:function(c,j){var g=this,h=g.groupers,b=h.getAt(j),a=g.getGroupsForGrouper(c,b),e=a.length,d;if(j+1<h.length){for(d=0;d<e;d++){a[d].children=g.getGroupsForGrouperIndex(a[d].records,j+1)}}for(d=0;d<e;d++){a[d].depth=j}return a},getGroupData:function(a){var b=this;if(a!==false){b.sort()}return b.getGroupsForGrouperIndex(b.data.items,0)},getGroupString:function(a){var b=this.groupers.first();if(b){return b.getGroupString(a)}return""},insert:function(g,a){var j=this,k=false,d,h,e,b=j.modelDefaults,c;if(!Ext.isIterable(a)){c=a=[a]}else{c=[]}h=a.length;if(h){for(d=0;d<h;d++){e=a[d];if(!e.isModel){e=j.createModel(e)}c[d]=e;if(b){e.set(b)}e.join(j);k=k||e.phantom===true}j.data.insert(g,c);if(j.snapshot){j.snapshot.addAll(c)}if(j.requireSort){j.suspendEvents();j.sort();j.resumeEvents()}if(j.isGrouped()){j.updateGroupsOnAdd(c)}j.fireEvent("add",j,c,g);j.fireEvent("datachanged",j);if(j.autoSync&&k&&!j.autoSyncSuspended){j.sync()}}return c},updateGroupsOnAdd:function(c){var e=this,b=e.groups,a=c.length,d,j,g,h;for(d=0;d<a;++d){h=c[d];j=e.getGroupString(h);g=b.getByKey(j);if(!g){g=b.add(new Ext.data.Group({key:j,store:e}))}g.add(h)}},updateGroupsOnRemove:function(c){var e=this,b=e.groups,a=c.length,d,j,g,h;for(d=0;d<a;++d){h=c[d];j=e.getGroupString(h);g=b.getByKey(j);if(g){g.remove(h);if(g.records.length===0){b.remove(g)}}}},updateGroupsOnUpdate:function(e,c){var j=this,a=j.getGroupField(),l=j.getGroupString(e),b=j.groups,g,d,h,k;if(c&&Ext.Array.indexOf(c,a)!==-1){h=b.items;for(d=0,g=h.length;d<g;++d){k=h[d];if(k.contains(e)){k.remove(e);break}}b.getByKey(l);if(!k){k=b.add(new Ext.data.Group({key:l,store:j}))}k.add(e);j.suspendEvents();j.remove(e);j.addSorted(e);j.resumeEvents()}else{b.getByKey(l).setDirty()}},add:function(a){var d=this,b,c,e;if(Ext.isArray(a)){b=a}else{b=arguments}c=b.length;e=!d.remoteSort&&d.sorters&&d.sorters.items.length;if(e&&c===1){return[d.addSorted(d.createModel(b[0]))]}if(e){d.requireSort=true}b=d.insert(d.data.length,b);delete d.requireSort;return b},addSorted:function(a){var c=this,b=c.data.findInsertionIndex(a,c.generateComparator());c.insert(b,a);return a},createModel:function(a){if(!a.isModel){a=Ext.ModelManager.create(a,this.model)}return a},onUpdate:function(a,b,c){if(this.isGrouped()){this.updateGroupsOnUpdate(a,c)}},each:function(e,c){var g=this.data.items,b=g.length,a,h;for(h=0;h<b;h++){a=g[h];if(e.call(c||a,a,h,b)===false){break}}},remove:function(o,l,p){l=l===true;var t=this,j=false,d=t.snapshot,u=t.data,n=0,c,q=[],s=[],e=[],r,m,g,b,k,h,a=!p&&t.hasListeners.remove;if(o.isModel){o=[o];c=1}else{if(Ext.isIterable(o)){c=o.length}else{if(typeof o==="object"){k=true;n=o.start;c=o.end+1;h=c-n}}}if(!k){for(n=0;n<c;++n){b=o[n];if(typeof b=="number"){g=b;b=u.getAt(g)}else{g=t.indexOf(b)}if(b&&g>-1){q.push({record:b,index:g})}if(d){d.remove(b)}}q=Ext.Array.sort(q,function(v,i){var x=v.index,w=i.index;return x===i.index2?0:(x<w?-1:1)});n=0;c=q.length}for(;n<c;n++){if(k){b=u.getAt(n);g=n}else{r=q[n];b=r.record;g=r.index}s.push(b);e.push(g);m=b.phantom!==true;if(!l&&m){b.removedFrom=g;t.removed.push(b)}b.unjoin(t);g-=n;j=j||m;if(!k){u.removeAt(g);if(a){t.fireEvent("remove",t,b,g,!!l)}}}if(k){u.removeRange(o.start,h)}if(!p){t.fireEvent("bulkremove",t,s,e,!!l);t.fireEvent("datachanged",t)}if(!l&&t.autoSync&&j&&!t.autoSyncSuspended){t.sync()}},removeAt:function(a,c){var b=this,d=b.getCount();if(a<=d){if(arguments.length===1){b.remove([a])}else{if(c){b.remove({start:a,end:Math.min(a+c,d)-1})}}}},removeAll:function(a){var b=this;b.remove({start:0,end:b.getCount()-1},false,a);if(b.data){b.data.clear()}if(a!==true){b.fireEvent("clear",b)}},load:function(a){var b=this;a=a||{};if(typeof a=="function"){a={callback:a}}a.groupers=a.groupers||b.groupers.items;a.page=a.page||b.currentPage;a.start=(a.start!==undefined)?a.start:(a.page-1)*b.pageSize;a.limit=a.limit||b.pageSize;a.addRecords=a.addRecords||false;if(b.buffered){a.limit=b.viewSize||b.defaultViewSize;return b.loadToPrefetch(a)}return b.callParent([a])},reload:function(m){var h=this,j,b,g,l,d,a,k,c,e=h.getCount();if(!m){m={}}if(h.buffered){delete h.totalCount;a=function(){if(h.rangeCached(j,b)){h.loading=false;h.data.un("pageAdded",a);c=h.data.getRange(j,b);h.fireEvent("load",h,c,true)}};k=Math.ceil((h.leadingBufferZone+h.trailingBufferZone)/2);j=m.start||(e?h.getAt(0).index:0);b=j+(m.count||(e?e:h.pageSize))-1;g=h.getPageFromRecordIndex(Math.max(j-k,0));l=h.getPageFromRecordIndex(b+k);h.data.clear(true);if(h.fireEvent("beforeload",h,m)!==false){h.loading=true;h.data.on("pageAdded",a);for(d=g;d<=l;d++){h.prefetchPage(d,m)}}}else{return h.callParent(arguments)}},onProxyLoad:function(b){var d=this,c=b.getResultSet(),a=b.getRecords(),e=b.wasSuccessful();if(c){d.totalCount=c.total}d.loading=false;if(e){d.loadRecords(a,b)}if(d.hasListeners.load){d.fireEvent("load",d,a,e)}if(d.hasListeners.read){d.fireEvent("read",d,a,e)}Ext.callback(b.callback,b.scope||d,[a,b,e])},getNewRecords:function(){return this.data.filterBy(this.filterNew).items},getUpdatedRecords:function(){return this.data.filterBy(this.filterUpdated).items},filter:function(e,g){if(Ext.isString(e)){e={property:e,value:g}}var d=this,a=d.decodeFilters(e),b,h=d.sorters.length&&d.sortOnFilter&&!d.remoteSort,c=a.length;for(b=0;b<c;b++){d.filters.replace(a[b])}if(d.remoteFilter){delete d.totalCount;if(d.buffered){d.data.clear();d.loadPage(1)}else{d.currentPage=1;d.load()}}else{if(d.filters.getCount()){d.snapshot=d.snapshot||d.data.clone();d.data=d.snapshot.filter(d.filters.items);d.constructGroups();if(h){d.sort()}else{d.fireEvent("datachanged",d);d.fireEvent("refresh",d)}}}d.fireEvent("filterchange",d,d.filters.items)},clearFilter:function(a){var b=this;b.filters.clear();if(b.remoteFilter){if(a){return}delete b.totalCount;if(b.buffered){b.data.clear();b.loadPage(1)}else{b.currentPage=1;b.load()}}else{if(b.isFiltered()){b.data=b.snapshot;delete b.snapshot;b.constructGroups();if(a!==true){b.fireEvent("datachanged",b);b.fireEvent("refresh",b)}}}b.fireEvent("filterchange",b,b.filters.items)},removeFilter:function(b,a){var c=this;if(!c.remoteFilter&&c.isFiltered()){if(b instanceof Ext.util.Filter){c.filters.remove(b)}else{c.filters.removeAtKey(b)}if(a!==false){if(c.filters.getCount()){c.filter()}else{c.clearFilter()}}c.fireEvent("filterchange",c,c.filters.items)}},addFilter:function(g,a){var e=this,b,c,d;b=e.decodeFilters(g);d=b.length;for(c=0;c<d;c++){e.filters.replace(b[c])}if(a!==false){e.filter()}e.fireEvent("filterchange",e,e.filters.items)},isFiltered:function(){var a=this.snapshot;return !!(a&&a!==this.data)},filterBy:function(b,a){var c=this;c.snapshot=c.snapshot||c.data.clone();c.data=c.queryBy(b,a||c);c.fireEvent("datachanged",c);c.fireEvent("refresh",c)},queryBy:function(b,a){var c=this;return(c.snapshot||c.data).filterBy(b,a||c)},query:function(h,g,i,a,e){var d=this,b=d.createFilterFn(h,g,i,a,e),c=d.queryBy(b);if(!c){c=new Ext.util.MixedCollection()}return c},loadData:function(e,a){var d=e.length,c=[],b;for(b=0;b<d;b++){c.push(this.createModel(e[b]))}this.loadRecords(c,a?this.addRecordsOptions:undefined)},loadRawData:function(e,b){var d=this,a=d.proxy.reader.read(e),c=a.records;if(a.success){d.totalCount=a.total;d.loadRecords(c,b?d.addRecordsOptions:undefined)}},loadRecords:function(b,c){var h=this,d=0,g=b.length,j,e,a=h.snapshot;if(c){j=c.start;e=c.addRecords}if(!e){delete h.snapshot;h.clearData(true)}else{if(a){a.addAll(b)}}h.data.addAll(b);if(j!==undefined){for(;d<g;d++){b[d].index=j+d;b[d].join(h)}}else{for(;d<g;d++){b[d].join(h)}}h.suspendEvents();if(h.filterOnLoad&&!h.remoteFilter){h.filter()}if(h.sortOnLoad&&!h.remoteSort){h.sort(undefined,undefined,undefined,true)}h.resumeEvents();if(h.isGrouped()){h.constructGroups()}h.fireEvent("datachanged",h);h.fireEvent("refresh",h)},loadPage:function(c,a){var b=this;b.currentPage=c;a=Ext.apply({page:c,start:(c-1)*b.pageSize,limit:b.pageSize,addRecords:!b.clearOnPageLoad},a);if(b.buffered){a.limit=b.viewSize||b.defaultViewSize;return b.loadToPrefetch(a)}b.read(a)},nextPage:function(a){this.loadPage(this.currentPage+1,a)},previousPage:function(a){this.loadPage(this.currentPage-1,a)},clearData:function(d){var c=this,a,b;if(!c.buffered){a=c.data.items;b=a.length;while(b--){a[b].unjoin(c)}}c.data.clear();if(d!==true||c.clearRemovedOnLoad){c.removed.length=0}},loadToPrefetch:function(n){var j=this,e,b,l,c=n,k=n.start,a=n.start+n.limit-1,g=Math.min(a,n.start+(j.viewSize||n.limit)-1),h=j.getPageFromRecordIndex(Math.max(k-j.trailingBufferZone,0)),m=j.getPageFromRecordIndex(a+j.leadingBufferZone),d=function(){if(j.rangeCached(k,g)){j.loading=false;b=j.data.getRange(k,g);j.data.un("pageAdded",d);if(j.hasListeners.guaranteedrange){j.guaranteeRange(k,g,n.callback,n.scope)}if(n.callback){n.callback.call(n.scope||j,b,k,a,n)}j.fireEvent("datachanged",j);j.fireEvent("refresh",j);j.fireEvent("load",j,b,true);if(n.groupChange){j.fireGroupChange()}}};if(j.fireEvent("beforeload",j,n)!==false){delete j.totalCount;j.loading=true;if(n.callback){c=Ext.apply({},n);delete n.callback}j.on("prefetch",function(o,p,i){if(p){if((l=j.getTotalCount())){j.data.on("pageAdded",d);g=Math.min(g,l-1);m=j.getPageFromRecordIndex(g);for(e=h+1;e<=m;++e){j.prefetchPage(e,c)}}else{j.fireEvent("datachanged",j);j.fireEvent("refresh",j);j.fireEvent("load",j,o,true)}}else{j.fireEvent("load",j,o,false)}},null,{single:true});j.prefetchPage(h,c)}},prefetch:function(c){var e=this,a=e.pageSize,d,b;if(a){if(e.lastPageSize&&a!=e.lastPageSize){Ext.Error.raise("pageSize cannot be dynamically altered")}if(!e.data.pageSize){e.data.pageSize=a}}else{e.pageSize=e.data.pageSize=a=c.limit}e.lastPageSize=a;if(!c.page){c.page=e.getPageFromRecordIndex(c.start);c.start=(c.page-1)*a;c.limit=Math.ceil(c.limit/a)*a}if(!e.pageRequests[c.page]){c=Ext.apply({action:"read",filters:e.filters.items,sorters:e.sorters.items,groupers:e.groupers.items,generation:e.data.generation},c);b=new Ext.data.Operation(c);if(e.fireEvent("beforeprefetch",e,b)!==false){d=e.proxy;e.pageRequests[c.page]=d.read(b,e.onProxyPrefetch,e);if(d.isSynchronous){delete e.pageRequests[c.page]}}}return e},onPageMapClear:function(){var d=this,c=d.wasLoading,a=d.pageRequests,b,e;if(d.data.events.pageadded){d.data.events.pageadded.clearListeners()}d.loading=true;d.totalCount=0;for(e in a){if(a.hasOwnProperty(e)){b=a[e];delete a[e];delete b.callback}}d.fireEvent("clear",d);d.loading=c},prefetchPage:function(e,b){var d=this,a=d.pageSize||d.defaultPageSize,g=(e-1)*d.pageSize,c=d.totalCount;if(c!==undefined&&d.getCount()===c){return}d.prefetch(Ext.applyIf({page:e,start:g,limit:a},b))},onProxyPrefetch:function(b){var d=this,c=b.getResultSet(),a=b.getRecords(),g=b.wasSuccessful(),e=b.page;if(b.generation===d.data.generation){if(c){d.totalCount=c.total;d.fireEvent("totalcountchange",d.totalCount)}if(e!==undefined){delete d.pageRequests[e]}d.loading=false;d.fireEvent("prefetch",d,a,g,b);if(g){d.cachePage(a,b.page)}Ext.callback(b.callback,b.scope||d,[a,b,g])}},cachePage:function(b,e){var d=this,a=b.length,c;if(!Ext.isDefined(d.totalCount)){d.totalCount=b.length;d.fireEvent("totalcountchange",d.totalCount)}for(c=0;c<a;c++){b[c].join(d)}d.data.addPage(e,b)},rangeCached:function(b,a){return this.data&&this.data.hasRange(b,a)},pageCached:function(a){return this.data&&this.data.hasPage(a)},rangeSatisfied:function(b,a){return this.rangeCached(b,a)},getPageFromRecordIndex:function(a){return Math.floor(a/this.pageSize)+1},onGuaranteedRange:function(d){var e=this,b=e.getTotalCount(),g=d.prefetchStart,a=(d.prefetchEnd>b-1)?b-1:d.prefetchEnd,c;a=Math.max(0,a);c=e.data.getRange(g,a);if(d.fireEvent!==false){e.fireEvent("guaranteedrange",c,g,a,d)}if(d.callback){d.callback.call(d.scope||e,c,g,a,d)}},guaranteeRange:function(e,a,d,c,b){b=Ext.apply({callback:d,scope:c},b);this.getRange(e,a,b)},prefetchRange:function(g,b){var d=this,c,a,e;if(!d.rangeCached(g,b)){c=d.getPageFromRecordIndex(g);a=d.getPageFromRecordIndex(b);d.data.maxSize=d.purgePageCount?(a-c+1)+d.purgePageCount:0;for(e=c;e<=a;e++){if(!d.pageCached(e)){d.prefetchPage(e)}}}},primeCache:function(d,a,c){var b=this;if(c===-1){d=Math.max(d-b.leadingBufferZone,0);a=Math.min(a+b.trailingBufferZone,b.totalCount-1)}else{if(c===1){d=Math.max(Math.min(d-b.trailingBufferZone,b.totalCount-b.pageSize),0);a=Math.min(a+b.leadingBufferZone,b.totalCount-1)}else{d=Math.min(Math.max(Math.floor(d-((b.leadingBufferZone+b.trailingBufferZone)/2)),0),b.totalCount-b.pageSize);a=Math.min(Math.max(Math.ceil(a+((b.leadingBufferZone+b.trailingBufferZone)/2)),0),b.totalCount-1)}}b.prefetchRange(d,a)},sort:function(){var a=this;if(a.buffered&&a.remoteSort){a.data.clear()}return a.callParent(arguments)},doSort:function(b){var e=this,a,d,c;if(e.remoteSort){if(e.buffered){e.data.clear();e.loadPage(1)}else{e.load()}}else{e.data.sortBy(b);if(!e.buffered){a=e.getRange();d=a.length;for(c=0;c<d;c++){a[c].index=c}}e.fireEvent("datachanged",e);e.fireEvent("refresh",e)}},find:function(e,d,h,g,a,c){var b=this.createFilterFn(e,d,g,a,c);return b?this.data.findIndexBy(b,null,h):-1},findRecord:function(){var b=this,a=b.find.apply(b,arguments);return a!==-1?b.getAt(a):null},createFilterFn:function(d,c,e,a,b){if(Ext.isEmpty(c)){return false}c=this.data.createValueMatcher(c,e,a,b);return function(g){return c.test(g.data[d])}},findExact:function(b,a,c){return this.data.findIndexBy(function(d){return d.isEqual(d.get(b),a)},this,c)},findBy:function(b,a,c){return this.data.findIndexBy(b,a,c)},collect:function(b,a,c){var d=this,e=(c===true&&d.snapshot)?d.snapshot:d.data;return e.collect(b,"data",a)},getCount:function(){return this.data.getCount()},getTotalCount:function(){return this.totalCount||0},getAt:function(a){return this.data.getAt(a)},getRange:function(c,g,k){var h=this,i,b,d=h.totalCount-1,e=h.lastRequestStart,a,j;k=Ext.apply({prefetchStart:c,prefetchEnd:g},k);if(h.buffered){g=(g>=h.totalCount)?d:g;i=c===0?0:c-1;b=g===d?g:g+1;h.lastRequestStart=c;if(h.rangeCached(i,b)){h.onGuaranteedRange(k);j=h.data.getRange(c,g)}else{h.fireEvent("cachemiss",h,c,g);a=function(m,l){if(h.rangeCached(i,b)){h.fireEvent("cachefilled",h,c,g);h.data.un("pageAdded",a);h.onGuaranteedRange(k)}};h.data.on("pageAdded",a);h.prefetchRange(c,g)}h.primeCache(c,g,c<e?-1:1)}else{j=h.data.getRange(c,g);if(k.callback){k.callback.call(k.scope||h,j,c,g,k)}}return j},getById:function(b){var a=(this.snapshot||this.data).findBy(function(c){return c.getId()===b});return a},indexOf:function(a){return this.data.indexOf(a)},indexOfTotal:function(a){var b=a.index;if(b||b===0){return b}return this.indexOf(a)},indexOfId:function(a){return this.indexOf(this.getById(a))},first:function(a){var b=this;if(a&&b.isGrouped()){return b.aggregate(function(c){return c.length?c[0]:undefined},b,true)}else{return b.data.first()}},last:function(a){var b=this;if(a&&b.isGrouped()){return b.aggregate(function(d){var c=d.length;return c?d[c-1]:undefined},b,true)}else{return b.data.last()}},sum:function(c,a){var b=this;if(a&&b.isGrouped()){return b.aggregate(b.getSum,b,true,[c])}else{return b.getSum(b.data.items,c)}},getSum:function(b,e){var d=0,c=0,a=b.length;for(;c<a;++c){d+=b[c].get(e)}return d},count:function(a){var b=this;if(a&&b.isGrouped()){return b.aggregate(function(c){return c.length},b,true)}else{return b.getCount()}},min:function(c,a){var b=this;if(a&&b.isGrouped()){return b.aggregate(b.getMin,b,true,[c])}else{return b.getMin(b.data.items,c)}},getMin:function(b,g){var d=1,a=b.length,e,c;if(a>0){c=b[0].get(g)}for(;d<a;++d){e=b[d].get(g);if(e<c){c=e}}return c},max:function(c,a){var b=this;if(a&&b.isGrouped()){return b.aggregate(b.getMax,b,true,[c])}else{return b.getMax(b.data.items,c)}},getMax:function(c,g){var d=1,b=c.length,e,a;if(b>0){a=c[0].get(g)}for(;d<b;++d){e=c[d].get(g);if(e>a){a=e}}return a},average:function(c,a){var b=this;if(a&&b.isGrouped()){return b.aggregate(b.getAverage,b,true,[c])}else{return b.getAverage(b.data.items,c)}},getAverage:function(b,e){var c=0,a=b.length,d=0;if(b.length>0){for(;c<a;++c){d+=b[c].get(e)}return d/a}return 0},aggregate:function(h,k,e,g){g=g||[];if(e&&this.isGrouped()){var a=this.getGroups(),d=a.length,b={},j,c;for(c=0;c<d;++c){j=a[c];b[j.name]=this.getAggregate(h,k||this,j.children,g)}return b}else{return this.getAggregate(h,k,this.data.items,g)}},getAggregate:function(d,c,a,b){b=b||[];return d.apply(c||this,[a].concat(b))},onIdChanged:function(d,c,b,a){this.data.updateKey(a,b);this.callParent(arguments)},commitChanges:function(){var c=this,d=c.getModifiedRecords(),a=d.length,b=0;for(;b<a;b++){d[b].commit()}c.removed.length=0},filterNewOnly:function(a){return a.phantom===true},getRejectRecords:function(){return Ext.Array.push(this.data.filterBy(this.filterNewOnly).items,this.getUpdatedRecords())},rejectChanges:function(){var c=this,d=c.getRejectRecords(),a=d.length,b=0,e;for(;b<a;b++){e=d[b];e.reject();if(e.phantom){c.remove(e)}}d=c.removed;a=d.length;for(b=0;b<a;b++){e=d[b];c.insert(e.removedFrom||0,e);e.reject()}c.removed.length=0}},function(){Ext.regStore("ext-empty-store",{fields:[],proxy:"memory"});this.prototype.PageMap=new Ext.Class({extend:"Ext.util.LruCache",clear:function(a){var b=this;b.generation=(b.generation||0)+1;b.callParent(arguments)},forEach:function(k,l){var h=this,d=Ext.Object.getKeys(h.map),a=d.length,c,b,e,g;for(c=0;c<a;c++){d[c]=Number(d[c])}Ext.Array.sort(d);l=l||h;for(c=0;c<a;c++){e=h.getPage(d[c]);g=e.length;for(b=0;b<g;b++){if(k.call(l,e[b])===false){return}}}},findBy:function(c,b){var d=this,a=null;b=b||d;d.forEach(function(e){if(c.call(b,e)){a=e;return false}});return a},getPageFromRecordIndex:this.prototype.getPageFromRecordIndex,addAll:function(a){this.addPage(1,a)},addPage:function(a,b){var d=this,g=a+Math.floor((b.length-1)/d.pageSize),c,e;for(c=0;a<=g;a++,c+=d.pageSize){e=Ext.Array.slice(b,c,c+d.pageSize);d.add(a,e);d.fireEvent("pageAdded",a,e)}},getCount:function(){var a=this.callParent();if(a){a=(a-1)*this.pageSize+this.last.value.length}return a},indexOf:function(a){return a?a.index:-1},insert:function(){},remove:function(){},removeAt:function(){},getPage:function(a){return this.get(a)},hasRange:function(d,b){var a=this.getPageFromRecordIndex(d),c=this.getPageFromRecordIndex(b);for(;a<=c;a++){if(!this.hasPage(a)){return false}}return true},hasPage:function(a){return !!this.get(a)},getAt:function(a){return this.getRange(a,a)[0]},getRange:function(a,b){if(!this.hasRange(a,b)){Ext.Error.raise("PageMap asked for range which it does not have")}var j=this,m=j.getPageFromRecordIndex(a),e=j.getPageFromRecordIndex(b),c=(m-1)*j.pageSize,o=(e*j.pageSize)-1,k=m,p=[],n,h,l,d=0,g;for(;k<=e;k++){if(k==m){n=a-c;l=true}else{n=0;l=false}if(k==e){h=j.pageSize-(o-b);l=true}if(l){Ext.Array.push(p,Ext.Array.slice(j.getPage(k),n,h))}else{Ext.Array.push(p,j.getPage(k))}}for(g=p.length;d<g;d++){p[d].index=a++}return p}})});Ext.define("Ext.data.reader.Array",{extend:Ext.data.reader.Json,alternateClassName:"Ext.data.ArrayReader",alias:"reader.array",totalProperty:undefined,successProperty:undefined,createFieldAccessExpression:function(e,c,b){var d=(e.mapping==null)?e.originalIndex:e.mapping,a;if(typeof d==="function"){a=c+".mapping("+b+", this)"}else{if(isNaN(d)){d='"'+d+'"'}a=b+"["+d+"]"}return a}});Ext.define("Ext.data.ArrayStore",{extend:Ext.data.Store,alias:"store.array",constructor:function(a){a=Ext.apply({proxy:{type:"memory",reader:"array"}},a);this.callParent([a])},loadData:function(e,a){if(this.expandData===true){var d=[],b=0,c=e.length;for(;b<c;b++){d[d.length]=[e[b]]}e=d}this.callParent([e,a])}},function(){Ext.data.SimpleStore=Ext.data.ArrayStore});Ext.define("Ext.data.Batch",{mixins:{observable:Ext.util.Observable},autoStart:false,pauseOnException:false,current:-1,total:0,isRunning:false,isComplete:false,hasException:false,constructor:function(a){var b=this;b.mixins.observable.constructor.call(b,a);b.operations=[];b.exceptions=[]},add:function(a){this.total++;a.setBatch(this);this.operations.push(a);return this},start:function(a){var b=this;if(b.isRunning){return b}b.exceptions.length=0;b.hasException=false;b.isRunning=true;return b.runOperation(Ext.isDefined(a)?a:b.current+1)},retry:function(){return this.start(this.current)},runNextOperation:function(){return this.runOperation(this.current+1)},pause:function(){this.isRunning=false;return this},runOperation:function(d){var e=this,c=e.operations,b=c[d],a;if(b===undefined){e.isRunning=false;e.isComplete=true;e.fireEvent("complete",e,c[c.length-1])}else{e.current=d;a=function(g){var h=g.hasException();if(h){e.hasException=true;e.exceptions.push(g);e.fireEvent("exception",e,g)}if(h&&e.pauseOnException){e.pause()}else{g.setCompleted();e.fireEvent("operationcomplete",e,g);e.runNextOperation()}};b.setStarted();e.proxy[b.action](b,a,e)}return e}});Ext.define("Ext.data.JsonP",{singleton:true,requestCount:0,requests:{},timeout:30000,disableCaching:true,disableCachingParam:"_dc",callbackKey:"callback",request:function(n){n=Ext.apply({},n);var j=this,d=Ext.isDefined(n.disableCaching)?n.disableCaching:j.disableCaching,h=n.disableCachingParam||j.disableCachingParam,c=++j.requestCount,l=n.callbackName||"callback"+c,i=n.callbackKey||j.callbackKey,m=Ext.isDefined(n.timeout)?n.timeout:j.timeout,e=n.params||{},b=n.url,a=Ext.name,g,k;if(d&&!e[h]){e[h]=new Date().getTime()}else{e=n.params}e[i]=a+".data.JsonP."+l;k=j.createScript(b,e,n);j.requests[c]=g={url:b,params:e,script:k,id:c,scope:n.scope,success:n.success,failure:n.failure,callback:n.callback,callbackKey:i,callbackName:l};if(m>0){g.timeout=setTimeout(Ext.bind(j.handleTimeout,j,[g]),m)}j.setupErrorHandling(g);j[l]=Ext.bind(j.handleResponse,j,[g],true);j.loadScript(g);return g},abort:function(c){var b=this,d=b.requests,a;if(c){if(!c.id){c=d[c]}b.handleAbort(c)}else{for(a in d){if(d.hasOwnProperty(a)){b.abort(d[a])}}}},setupErrorHandling:function(a){a.script.onerror=Ext.bind(this.handleError,this,[a])},handleAbort:function(a){a.errorType="abort";this.handleResponse(null,a)},handleError:function(a){a.errorType="error";this.handleResponse(null,a)},cleanupErrorHandling:function(a){a.script.onerror=null},handleTimeout:function(a){a.errorType="timeout";this.handleResponse(null,a)},handleResponse:function(a,b){var c=true;if(b.timeout){clearTimeout(b.timeout)}delete this[b.callbackName];delete this.requests[b.id];this.cleanupErrorHandling(b);Ext.fly(b.script).remove();if(b.errorType){c=false;Ext.callback(b.failure,b.scope,[b.errorType])}else{Ext.callback(b.success,b.scope,[a])}Ext.callback(b.callback,b.scope,[c,a,b.errorType]);Ext.EventManager.idleEvent.fire()},createScript:function(c,d,b){var a=document.createElement("script");a.setAttribute("src",Ext.urlAppend(c,Ext.Object.toQueryString(d)));a.setAttribute("async",true);a.setAttribute("type","text/javascript");return a},loadScript:function(a){Ext.getHead().appendChild(a.script)}});Ext.define("Ext.data.Request",{action:undefined,params:undefined,method:"GET",url:undefined,constructor:function(a){Ext.apply(this,a)}});Ext.define("Ext.data.SequentialIdGenerator",{extend:Ext.data.IdGenerator,alias:"idgen.sequential",constructor:function(){var a=this;a.callParent(arguments);a.parts=[a.prefix,""]},prefix:"",seed:1,generate:function(){var a=this,b=a.parts;b[1]=a.seed++;return b.join("")}});Ext.define("Ext.data.UuidGenerator",(function(){var h=Math.pow(2,14),g=Math.pow(2,16),e=Math.pow(2,28),c=Math.pow(2,32);function a(k,j){var i=k.toString(16);if(i.length>j){i=i.substring(i.length-j)}else{if(i.length<j){i=Ext.String.leftPad(i,j,"0")}}return i}function d(k,j){var i=Math.random()*(j-k+1);return Math.floor(i)+k}function b(j){if(typeof(j)=="number"){var i=Math.floor(j/c);return{lo:Math.floor(j-i*c),hi:i}}return j}return{extend:Ext.data.IdGenerator,alias:"idgen.uuid",id:"uuid",version:4,constructor:function(){var i=this;i.callParent(arguments);i.parts=[];i.init()},generate:function(){var j=this,k=j.parts,i=j.timestamp;k[0]=a(i.lo,8);k[1]=a(i.hi&65535,4);k[2]=a(((i.hi>>>16)&4095)|(j.version<<12),4);k[3]=a(128|((j.clockSeq>>>8)&63),2)+a(j.clockSeq&255,2);k[4]=a(j.salt.hi,4)+a(j.salt.lo,8);if(j.version==4){j.init()}else{++i.lo;if(i.lo>=c){i.lo=0;++i.hi}}return k.join("-").toLowerCase()},getRecId:function(i){return i.getId()},init:function(){var j=this,i,k;if(j.version==4){j.clockSeq=d(0,h-1);i=j.salt||(j.salt={});k=j.timestamp||(j.timestamp={});i.lo=d(0,c-1);i.hi=d(0,g-1);k.lo=d(0,c-1);k.hi=d(0,e-1)}else{j.salt=b(j.salt);j.timestamp=b(j.timestamp);j.salt.hi|=256}},reconfigure:function(i){Ext.apply(this,i);this.init()}}}()));Ext.define("Ext.data.association.BelongsTo",{extend:Ext.data.association.Association,alternateClassName:"Ext.data.BelongsToAssociation",alias:"association.belongsto",constructor:function(c){this.callParent(arguments);var e=this,a=e.ownerModel.prototype,g=e.associatedName,d=e.getterName||"get"+g,b=e.setterName||"set"+g;Ext.applyIf(e,{name:g,foreignKey:g.toLowerCase()+"_id",instanceName:g+"BelongsToInstance",associationKey:g.toLowerCase()});a[d]=e.createGetter();a[b]=e.createSetter()},createSetter:function(){var c=this,b=c.foreignKey,a=c.instanceName;return function(h,e,g){var i=h&&h.isModel,d=i?h.getId():h;if(i){this[a]=h}else{if(this[a] instanceof Ext.data.Model&&!this.isEqual(this.get(b),d)){delete this[a]}}this.set(b,d);if(Ext.isFunction(e)){e={callback:e,scope:g||this}}if(Ext.isObject(e)){return this.save(e)}}},createGetter:function(){var d=this,e=d.associatedName,g=d.associatedModel,c=d.foreignKey,b=d.primaryKey,a=d.instanceName;return function(k,l){k=k||{};var j=this,m=j.get(c),n,h,i;if(k.reload===true||j[a]===undefined){h=Ext.ModelManager.create({},e);h.set(b,m);if(typeof k=="function"){k={callback:k,scope:l||j}}n=k.success;k.success=function(o){j[a]=o;if(n){n.apply(this,arguments)}};g.load(m,k);j[a]=h;return h}else{h=j[a];i=[h];l=l||k.scope||j;Ext.callback(k,l,i);Ext.callback(k.success,l,i);Ext.callback(k.failure,l,i);Ext.callback(k.callback,l,i);return h}}},read:function(b,a,c){b[this.instanceName]=a.read([c]).records[0]}});Ext.define("Ext.util.Inflector",{singleton:true,plurals:[[(/(quiz)$/i),"$1zes"],[(/^(ox)$/i),"$1en"],[(/([m|l])ouse$/i),"$1ice"],[(/(matr|vert|ind)ix|ex$/i),"$1ices"],[(/(x|ch|ss|sh)$/i),"$1es"],[(/([^aeiouy]|qu)y$/i),"$1ies"],[(/(hive)$/i),"$1s"],[(/(?:([^f])fe|([lr])f)$/i),"$1$2ves"],[(/sis$/i),"ses"],[(/([ti])um$/i),"$1a"],[(/(buffal|tomat|potat)o$/i),"$1oes"],[(/(bu)s$/i),"$1ses"],[(/(alias|status|sex)$/i),"$1es"],[(/(octop|vir)us$/i),"$1i"],[(/(ax|test)is$/i),"$1es"],[(/^person$/),"people"],[(/^man$/),"men"],[(/^(child)$/),"$1ren"],[(/s$/i),"s"],[(/$/),"s"]],singulars:[[(/(quiz)zes$/i),"$1"],[(/(matr)ices$/i),"$1ix"],[(/(vert|ind)ices$/i),"$1ex"],[(/^(ox)en/i),"$1"],[(/(alias|status)es$/i),"$1"],[(/(octop|vir)i$/i),"$1us"],[(/(cris|ax|test)es$/i),"$1is"],[(/(shoe)s$/i),"$1"],[(/(o)es$/i),"$1"],[(/(bus)es$/i),"$1"],[(/([m|l])ice$/i),"$1ouse"],[(/(x|ch|ss|sh)es$/i),"$1"],[(/(m)ovies$/i),"$1ovie"],[(/(s)eries$/i),"$1eries"],[(/([^aeiouy]|qu)ies$/i),"$1y"],[(/([lr])ves$/i),"$1f"],[(/(tive)s$/i),"$1"],[(/(hive)s$/i),"$1"],[(/([^f])ves$/i),"$1fe"],[(/(^analy)ses$/i),"$1sis"],[(/((a)naly|(b)a|(d)iagno|(p)arenthe|(p)rogno|(s)ynop|(t)he)ses$/i),"$1$2sis"],[(/([ti])a$/i),"$1um"],[(/(n)ews$/i),"$1ews"],[(/people$/i),"person"],[(/s$/i),""]],uncountable:["sheep","fish","series","species","money","rice","information","equipment","grass","mud","offspring","deer","means"],singular:function(b,a){this.singulars.unshift([b,a])},plural:function(b,a){this.plurals.unshift([b,a])},clearSingulars:function(){this.singulars=[]},clearPlurals:function(){this.plurals=[]},isTransnumeral:function(a){return Ext.Array.indexOf(this.uncountable,a)!=-1},pluralize:function(g){if(this.isTransnumeral(g)){return g}var e=this.plurals,d=e.length,a,c,b;for(b=0;b<d;b++){a=e[b];c=a[0];if(c==g||(c.test&&c.test(g))){return g.replace(c,a[1])}}return g},singularize:function(g){if(this.isTransnumeral(g)){return g}var e=this.singulars,d=e.length,a,c,b;for(b=0;b<d;b++){a=e[b];c=a[0];if(c==g||(c.test&&c.test(g))){return g.replace(c,a[1])}}return g},classify:function(a){return Ext.String.capitalize(this.singularize(a))},ordinalize:function(d){var b=parseInt(d,10),c=b%10,a=b%100;if(11<=a&&a<=13){return d+"th"}else{switch(c){case 1:return d+"st";case 2:return d+"nd";case 3:return d+"rd";default:return d+"th"}}}},function(){var b={alumnus:"alumni",cactus:"cacti",focus:"foci",nucleus:"nuclei",radius:"radii",stimulus:"stimuli",ellipsis:"ellipses",paralysis:"paralyses",oasis:"oases",appendix:"appendices",index:"indexes",beau:"beaux",bureau:"bureaux",tableau:"tableaux",woman:"women",child:"children",man:"men",corpus:"corpora",criterion:"criteria",curriculum:"curricula",genus:"genera",memorandum:"memoranda",phenomenon:"phenomena",foot:"feet",goose:"geese",tooth:"teeth",antenna:"antennae",formula:"formulae",nebula:"nebulae",vertebra:"vertebrae",vita:"vitae"},a;for(a in b){this.plural(a,b[a]);this.singular(b[a],a)}});Ext.define("Ext.data.association.HasMany",{extend:Ext.data.association.Association,alternateClassName:"Ext.data.HasManyAssociation",alias:"association.hasmany",constructor:function(c){var d=this,a,b;d.callParent(arguments);d.name=d.name||Ext.util.Inflector.pluralize(d.associatedName.toLowerCase());a=d.ownerModel.prototype;b=d.name;Ext.applyIf(d,{storeName:b+"Store",foreignKey:d.ownerName.toLowerCase()+"_id"});a[b]=d.createStore()},createStore:function(){var h=this,i=h.associatedModel,c=h.storeName,d=h.foreignKey,a=h.primaryKey,g=h.filterProperty,b=h.autoLoad,e=h.storeConfig||{};return function(){var m=this,k,l,j={};if(m[c]===undefined){if(g){l={property:g,value:m.get(g),exactMatch:true}}else{l={property:d,value:m.get(a),exactMatch:true}}j[d]=m.get(a);k=Ext.apply({},e,{model:i,filters:[l],remoteFilter:false,modelDefaults:j});m[c]=Ext.data.AbstractStore.create(k);if(b){m[c].load()}}return m[c]}},read:function(d,b,j){var g=d[this.name](),c,e,a,h;g.add(b.read(j).records);c=this.associatedModel.prototype.associations.findBy(function(i){return i.type==="belongsTo"&&i.associatedName===d.$className});if(c){e=g.data.items;a=e.length;for(h=0;h<a;h++){e[h][c.instanceName]=d}}}});Ext.define("Ext.data.association.HasOne",{extend:Ext.data.association.Association,alternateClassName:"Ext.data.HasOneAssociation",alias:"association.hasone",constructor:function(c){this.callParent(arguments);var e=this,a=e.ownerModel.prototype,g=e.associatedName,d=e.getterName||"get"+g,b=e.setterName||"set"+g;Ext.applyIf(e,{name:g,foreignKey:g.toLowerCase()+"_id",instanceName:g+"HasOneInstance",associationKey:g.toLowerCase()});a[d]=e.createGetter();a[b]=e.createSetter()},createSetter:function(){var c=this,b=c.foreignKey,a=c.instanceName;return function(h,e,g){var i=h&&h.isModel,d=i?h.getId():h;if(i){this[a]=h}else{if(this[a] instanceof Ext.data.Model&&!this.isEqual(this.get(b),d)){delete this[a]}}this.set(b,d);if(Ext.isFunction(e)){e={callback:e,scope:g||this}}if(Ext.isObject(e)){return this.save(e)}}},createGetter:function(){var d=this,g=d.ownerModel,e=d.associatedName,h=d.associatedModel,c=d.foreignKey,b=d.primaryKey,a=d.instanceName;return function(l,m){l=l||{};var k=this,n=k.get(c),o,i,j;if(l.reload===true||k[a]===undefined){i=Ext.ModelManager.create({},e);i.set(b,n);if(typeof l=="function"){l={callback:l,scope:m||k}}o=l.success;l.success=function(p){k[a]=p;if(o){o.apply(this,arguments)}};h.load(n,l);k[a]=i;return i}else{i=k[a];j=[i];m=m||l.scope||k;Ext.callback(l,m,j);Ext.callback(l.success,m,j);Ext.callback(l.failure,m,j);Ext.callback(l.callback,m,j);return i}}},read:function(c,a,e){var b=this.associatedModel.prototype.associations.findBy(function(g){return g.type==="belongsTo"&&g.associatedName===c.$className}),d=a.read([e]).records[0];c[this.instanceName]=d;if(b){d[b.instanceName]=c}}});Ext.define("Ext.dd.DDTarget",{extend:Ext.dd.DragDrop,constructor:function(c,a,b){if(c){this.initTarget(c,a,b)}},getDragEl:Ext.emptyFn,isValidHandleChild:Ext.emptyFn,startDrag:Ext.emptyFn,endDrag:Ext.emptyFn,onDrag:Ext.emptyFn,onDragDrop:Ext.emptyFn,onDragEnter:Ext.emptyFn,onDragOut:Ext.emptyFn,onDragOver:Ext.emptyFn,onInvalidDrop:Ext.emptyFn,onMouseDown:Ext.emptyFn,onMouseUp:Ext.emptyFn,setXConstraint:Ext.emptyFn,setYConstraint:Ext.emptyFn,resetConstraints:Ext.emptyFn,clearConstraints:Ext.emptyFn,clearTicks:Ext.emptyFn,setInitPosition:Ext.emptyFn,setDragElId:Ext.emptyFn,setHandleElId:Ext.emptyFn,setOuterHandleElId:Ext.emptyFn,addInvalidHandleClass:Ext.emptyFn,addInvalidHandleId:Ext.emptyFn,addInvalidHandleType:Ext.emptyFn,removeInvalidHandleClass:Ext.emptyFn,removeInvalidHandleId:Ext.emptyFn,removeInvalidHandleType:Ext.emptyFn,toString:function(){return("DDTarget "+this.id)}});Ext.define("Ext.dd.DragTracker",{mixins:{observable:Ext.util.Observable},active:false,trackOver:false,tolerance:5,autoStart:false,constructor:function(a){var b=this;Ext.apply(b,a);b.addEvents("mouseover","mouseout","mousedown","mouseup","mousemove","beforedragstart","dragstart","dragend","drag");b.dragRegion=new Ext.util.Region(0,0,0,0);if(b.el){b.initEl(b.el)}b.mixins.observable.constructor.call(b);if(b.disabled){b.disable()}},initEl:function(a){var b=this;b.el=Ext.get(a);b.handle=Ext.get(b.delegate);b.delegate=b.handle?undefined:b.delegate;if(!b.handle){b.handle=b.el}b.handleListeners={scope:b,delegate:b.delegate,mousedown:b.onMouseDown};if(b.trackOver||b.overCls){Ext.apply(b.handleListeners,{mouseover:b.onMouseOver,mouseout:b.onMouseOut})}b.mon(b.handle,b.handleListeners)},disable:function(){this.disabled=true},enable:function(){this.disabled=false},destroy:function(){var a=this;if(a.active){a.endDrag({})}a.clearListeners();a.mun(a.handle,a.handleListeners);a.el=a.handle=null},onMouseOver:function(c,b){var a=this;if(!a.disabled){if(Ext.EventManager.contains(c)||a.delegate){a.mouseIsOut=false;if(a.overCls){a.el.addCls(a.overCls)}a.fireEvent("mouseover",a,c,a.delegate?c.getTarget(a.delegate,b):a.handle)}}},onMouseOut:function(b){var a=this;if(a.mouseIsDown){a.mouseIsOut=true}else{if(a.overCls){a.el.removeCls(a.overCls)}a.fireEvent("mouseout",a,b)}},onMouseDown:function(d,c){var b=this,a;if(b.disabled||d.dragTracked){return}b.dragTarget=b.delegate?c:b.handle.dom;b.startXY=b.lastXY=d.getXY();b.startRegion=Ext.fly(b.dragTarget).getRegion();if(b.fireEvent("mousedown",b,d)===false||b.fireEvent("beforedragstart",b,d)===false||b.onBeforeStart(d)===false){return}b.mouseIsDown=true;d.dragTracked=true;a=b.el.dom;if(Ext.isIE&&a.setCapture){a.setCapture()}if(b.preventDefault!==false){d.preventDefault()}Ext.getDoc().on({scope:b,mouseup:b.onMouseUp,mousemove:b.onMouseMove,selectstart:b.stopSelect});if(b.autoStart){b.timer=Ext.defer(b.triggerStart,b.autoStart===true?1000:b.autoStart,b,[d])}},onMouseMove:function(g,d){var b=this,c=g.getXY(),a=b.startXY;g.preventDefault();b.lastXY=c;if(!b.active){if(Math.max(Math.abs(a[0]-c[0]),Math.abs(a[1]-c[1]))>b.tolerance){b.triggerStart(g)}else{return}}if(b.fireEvent("mousemove",b,g)===false){b.onMouseUp(g)}else{b.onDrag(g);b.fireEvent("drag",b,g)}},onMouseUp:function(b){var a=this;a.mouseIsDown=false;if(a.mouseIsOut){a.mouseIsOut=false;a.onMouseOut(b)}b.preventDefault();if(Ext.isIE&&document.releaseCapture){document.releaseCapture()}a.fireEvent("mouseup",a,b);a.endDrag(b)},endDrag:function(d){var b=this,c=Ext.getDoc(),a=b.active;c.un("mousemove",b.onMouseMove,b);c.un("mouseup",b.onMouseUp,b);c.un("selectstart",b.stopSelect,b);b.clearStart();b.active=false;if(a){b.onEnd(d);b.fireEvent("dragend",b,d)}delete b._constrainRegion;delete Ext.EventObject.dragTracked},triggerStart:function(b){var a=this;a.clearStart();a.active=true;a.onStart(b);a.fireEvent("dragstart",a,b)},clearStart:function(){var a=this.timer;if(a){clearTimeout(a);delete this.timer}},stopSelect:function(a){a.stopEvent();return false},onBeforeStart:function(a){},onStart:function(a){},onDrag:function(a){},onEnd:function(a){},getDragTarget:function(){return this.dragTarget},getDragCt:function(){return this.el},getConstrainRegion:function(){var a=this;if(a.constrainTo){if(a.constrainTo instanceof Ext.util.Region){return a.constrainTo}if(!a._constrainRegion){a._constrainRegion=Ext.fly(a.constrainTo).getViewRegion()}}else{if(!a._constrainRegion){a._constrainRegion=a.getDragCt().getViewRegion()}}return a._constrainRegion},getXY:function(a){return a?this.constrainModes[a](this,this.lastXY):this.lastXY},getOffset:function(c){var b=this.getXY(c),a=this.startXY;return[b[0]-a[0],b[1]-a[1]]},constrainModes:{point:function(b,d){var c=b.dragRegion,a=b.getConstrainRegion();if(!a){return d}c.x=c.left=c[0]=c.right=d[0];c.y=c.top=c[1]=c.bottom=d[1];c.constrainTo(a);return[c.left,c.top]},dragTarget:function(c,g){var b=c.startXY,e=c.startRegion.copy(),a=c.getConstrainRegion(),d;if(!a){return g}e.translateBy(g[0]-b[0],g[1]-b[1]);if(e.right>a.right){g[0]+=d=(a.right-e.right);e.left+=d}if(e.left<a.left){g[0]+=(a.left-e.left)}if(e.bottom>a.bottom){g[1]+=d=(a.bottom-e.bottom);e.top+=d}if(e.top<a.top){g[1]+=(a.top-e.top)}return g}}});Ext.define("Ext.dd.ScrollManager",{singleton:true,constructor:function(){var a=Ext.dd.DragDropManager;a.fireEvents=Ext.Function.createSequence(a.fireEvents,this.onFire,this);a.stopDrag=Ext.Function.createSequence(a.stopDrag,this.onStop,this);this.doScroll=Ext.Function.bind(this.doScroll,this);this.ddmInstance=a;this.els={};this.dragEl=null;this.proc={}},onStop:function(a){var b=Ext.dd.ScrollManager;b.dragEl=null;b.clearProc()},triggerRefresh:function(){if(this.ddmInstance.dragCurrent){this.ddmInstance.refreshCache(this.ddmInstance.dragCurrent.groups)}},doScroll:function(){if(this.ddmInstance.dragCurrent){var a=this.proc,b=a.el,c=a.el.ddScrollConfig,d=c?c.increment:this.increment;if(!this.animate){if(b.scroll(a.dir,d)){this.triggerRefresh()}}else{b.scroll(a.dir,d,true,this.animDuration,this.triggerRefresh)}}},clearProc:function(){var a=this.proc;if(a.id){clearInterval(a.id)}a.id=0;a.el=null;a.dir=""},startProc:function(b,a){this.clearProc();this.proc.el=b;this.proc.dir=a;var d=b.ddScrollConfig?b.ddScrollConfig.ddGroup:undefined,c=(b.ddScrollConfig&&b.ddScrollConfig.frequency)?b.ddScrollConfig.frequency:this.frequency;if(d===undefined||this.ddmInstance.dragCurrent.ddGroup==d){this.proc.id=setInterval(this.doScroll,c)}},onFire:function(h,k){if(k||!this.ddmInstance.dragCurrent){return}if(!this.dragEl||this.dragEl!=this.ddmInstance.dragCurrent){this.dragEl=this.ddmInstance.dragCurrent;this.refreshCache()}var l=h.getXY(),m=h.getPoint(),i=this.proc,g=this.els,b,d,a,j;for(b in g){d=g[b];a=d._region;j=d.ddScrollConfig?d.ddScrollConfig:this;if(a&&a.contains(m)&&d.isScrollable()){if(a.bottom-m.y<=j.vthresh){if(i.el!=d){this.startProc(d,"down")}return}else{if(a.right-m.x<=j.hthresh){if(i.el!=d){this.startProc(d,"left")}return}else{if(m.y-a.top<=j.vthresh){if(i.el!=d){this.startProc(d,"up")}return}else{if(m.x-a.left<=j.hthresh){if(i.el!=d){this.startProc(d,"right")}return}}}}}}this.clearProc()},register:function(c){if(Ext.isArray(c)){for(var b=0,a=c.length;b<a;b++){this.register(c[b])}}else{c=Ext.get(c);this.els[c.id]=c}},unregister:function(c){if(Ext.isArray(c)){for(var b=0,a=c.length;b<a;b++){this.unregister(c[b])}}else{c=Ext.get(c);delete this.els[c.id]}},vthresh:25,hthresh:25,increment:100,frequency:500,animate:true,animDuration:0.4,ddGroup:undefined,refreshCache:function(){var a=this.els,b;for(b in a){if(typeof a[b]=="object"){a[b]._region=a[b].getRegion()}}}});Ext.define("Ext.dd.DropTarget",{extend:Ext.dd.DDTarget,constructor:function(b,a){this.el=Ext.get(b);Ext.apply(this,a);if(this.containerScroll){Ext.dd.ScrollManager.register(this.el)}this.callParent([this.el.dom,this.ddGroup||this.group,{isTarget:true}])},dropAllowed:Ext.baseCSSPrefix+"dd-drop-ok",dropNotAllowed:Ext.baseCSSPrefix+"dd-drop-nodrop",isTarget:true,isNotifyTarget:true,notifyEnter:function(a,c,b){if(this.overClass){this.el.addCls(this.overClass)}return this.dropAllowed},notifyOver:function(a,c,b){return this.dropAllowed},notifyOut:function(a,c,b){if(this.overClass){this.el.removeCls(this.overClass)}},notifyDrop:function(a,c,b){return false},destroy:function(){this.callParent();if(this.containerScroll){Ext.dd.ScrollManager.unregister(this.el)}}});Ext.define("Ext.dd.Registry",{singleton:true,constructor:function(){this.elements={};this.handles={};this.autoIdSeed=0},getId:function(b,a){if(typeof b=="string"){return b}var c=b.id;if(!c&&a!==false){c="extdd-"+(++this.autoIdSeed);b.id=c}return c},register:function(d,e){e=e||{};if(typeof d=="string"){d=document.getElementById(d)}e.ddel=d;this.elements[this.getId(d)]=e;if(e.isHandle!==false){this.handles[e.ddel.id]=e}if(e.handles){var c=e.handles,b,a;for(b=0,a=c.length;b<a;b++){this.handles[this.getId(c[b])]=e}}},unregister:function(d){var g=this.getId(d,false),e=this.elements[g],c,b,a;if(e){delete this.elements[g];if(e.handles){c=e.handles;for(b=0,a=c.length;b<a;b++){delete this.handles[this.getId(c[b],false)]}}}},getHandle:function(a){if(typeof a!="string"){a=a.id}return this.handles[a]},getHandleFromEvent:function(b){var a=b.getTarget();return a?this.handles[a.id]:null},getTarget:function(a){if(typeof a!="string"){a=a.id}return this.elements[a]},getTargetFromEvent:function(b){var a=b.getTarget();return a?this.elements[a.id]||this.handles[a.id]:null}});Ext.define("Ext.dd.DropZone",{extend:Ext.dd.DropTarget,getTargetFromEvent:function(a){return Ext.dd.Registry.getTargetFromEvent(a)},onNodeEnter:function(d,a,c,b){},onNodeOver:function(d,a,c,b){return this.dropAllowed},onNodeOut:function(d,a,c,b){},onNodeDrop:function(d,a,c,b){return false},onContainerOver:function(a,c,b){return this.dropNotAllowed},onContainerDrop:function(a,c,b){return false},notifyEnter:function(a,c,b){return this.dropNotAllowed},notifyOver:function(a,c,b){var d=this.getTargetFromEvent(c);if(!d){if(this.lastOverNode){this.onNodeOut(this.lastOverNode,a,c,b);this.lastOverNode=null}return this.onContainerOver(a,c,b)}if(this.lastOverNode!=d){if(this.lastOverNode){this.onNodeOut(this.lastOverNode,a,c,b)}this.onNodeEnter(d,a,c,b);this.lastOverNode=d}return this.onNodeOver(d,a,c,b)},notifyOut:function(a,c,b){if(this.lastOverNode){this.onNodeOut(this.lastOverNode,a,c,b);this.lastOverNode=null}},notifyDrop:function(b,g,d){var c=this,h=c.getTargetFromEvent(g),a=h?c.onNodeDrop(h,b,g,d):c.onContainerDrop(b,g,d);if(c.lastOverNode){c.onNodeOut(c.lastOverNode,b,g,d);c.lastOverNode=null}return a},triggerCacheRefresh:function(){Ext.dd.DDM.refreshCache(this.groups)}});Ext.define("Ext.util.Queue",{constructor:function(){this.clear()},add:function(c){var b=this,a=b.getKey(c);if(!b.map[a]){++b.length;b.items.push(c);b.map[a]=c}return c},clear:function(){var b=this,a=b.items;b.items=[];b.map={};b.length=0;return a},contains:function(b){var a=this.getKey(b);return this.map.hasOwnProperty(a)},getCount:function(){return this.length},getKey:function(a){return a.id},remove:function(e){var d=this,c=d.getKey(e),a=d.items,b;if(d.map[c]){b=Ext.Array.indexOf(a,e);Ext.Array.erase(a,b,1);delete d.map[c];--d.length}return e}});Ext.define("Ext.layout.ClassList",(function(){var b=Ext.String.splitWords,a=Ext.Array.toMap;return{dirty:false,constructor:function(c){this.owner=c;this.map=a(this.classes=b(c.el.className))},add:function(c){var d=this;if(!d.map[c]){d.map[c]=true;d.classes.push(c);if(!d.dirty){d.dirty=true;d.owner.markDirty()}}},addMany:function(c){Ext.each(b(c),this.add,this)},contains:function(c){return this.map[c]},flush:function(){this.owner.el.className=this.classes.join(" ");this.dirty=false},remove:function(c){var d=this;if(d.map[c]){delete d.map[c];d.classes=Ext.Array.filter(d.classes,function(e){return e!=c});if(!d.dirty){d.dirty=true;d.owner.markDirty()}}},removeMany:function(d){var e=this,c=a(b(d));e.classes=Ext.Array.filter(e.classes,function(g){if(!c[g]){return true}delete e.map[g];if(!e.dirty){e.dirty=true;e.owner.markDirty()}return false})}}}()));Ext.define("Ext.layout.ContextItem",{heightModel:null,widthModel:null,sizeModel:null,optOut:false,ownerSizePolicy:null,boxChildren:null,boxParent:null,isBorderBoxValue:null,children:[],dirty:null,dirtyCount:0,hasRawContent:true,isContextItem:true,isTopLevel:false,consumersContentHeight:0,consumersContentWidth:0,consumersContainerHeight:0,consumersContainerWidth:0,consumersHeight:0,consumersWidth:0,ownerCtContext:null,remainingChildDimensions:0,props:null,state:null,wrapsComponent:false,constructor:function(r){var s=this,p=Ext.layout.SizeModel.sizeModels,k=p.configured,j=p.shrinkWrap,b,q,n,m,g,d,t,e,o,l,c,i,h,a;Ext.apply(s,r);b=s.el;s.id=b.id;s.flushedProps={};s.props=g={};s.styles={};t=s.target;if(!t.isComponent){q=b.lastBox}else{s.wrapsComponent=true;s.framing=t.frameSize||null;s.isComponentChild=t.ownerLayout&&t.ownerLayout.isComponentLayout;q=t.lastBox;n=t.ownerCt;if(n&&(m=s.context.items[n.el.id])){s.ownerCtContext=m}s.sizeModel=d=t.getSizeModel(m&&m.widthModel.pairsByHeightOrdinal[m.heightModel.ordinal]);s.widthModel=i=d.width;s.heightModel=h=d.height;if(q&&q.invalid===false){l=(t.width===(e=q.width));c=(t.height===(o=q.height));if(i===j&&h===j){a=true}else{if(i===k&&l){a=h===j||(h===k&&c)}}if(a){s.optOut=true;g.width=e;g.height=o}}}s.lastBox=q},init:function(j,c){var s=this,a=s.props,d=s.dirty,l=s.ownerCtContext,p=s.target.ownerLayout,h=!s.state,t=j||h,e,o,m,q,b,u,v=s.heightModel,g=s.widthModel,k,r;s.dirty=s.invalid=false;s.props={};s.remainingChildDimensions=0;if(s.boxChildren){s.boxChildren.length=0}if(!h){s.clearAllBlocks("blocks");s.clearAllBlocks("domBlocks")}if(!s.wrapsComponent){return t}u=s.target;s.state={};if(h){if(u.beforeLayout&&u.beforeLayout!==Ext.emptyFn){u.beforeLayout()}if(!l&&(q=u.ownerCt)){l=s.context.items[q.el.id]}if(l){s.ownerCtContext=l;s.isBoxParent=u.ownerLayout.isItemBoxParent(s)}else{s.isTopLevel=true}s.frameBodyContext=s.getEl("frameBody")}else{l=s.ownerCtContext;s.isTopLevel=!l;e=s.children;for(o=0,m=e.length;o<m;++o){e[o].init(true)}}s.hasRawContent=!(u.isContainer&&u.items.items.length>0);if(j){s.widthModel=s.heightModel=null;b=u.getSizeModel(l&&l.widthModel.pairsByHeightOrdinal[l.heightModel.ordinal]);if(h){s.sizeModel=b}s.widthModel=b.width;s.heightModel=b.height;if(l&&!s.isComponentChild){l.remainingChildDimensions+=2}}else{if(a){s.recoverProp("x",a,d);s.recoverProp("y",a,d);if(s.widthModel.calculated){s.recoverProp("width",a,d)}if(s.heightModel.calculated){s.recoverProp("height",a,d)}if(l&&!s.isComponentChild){l.remainingChildDimensions+=("width" in a)+("height" in a)}}}if(a&&p&&p.manageMargins){s.recoverProp("margin-top",a,d);s.recoverProp("margin-right",a,d);s.recoverProp("margin-bottom",a,d);s.recoverProp("margin-left",a,d)}if(c){k=c.heightModel;r=c.widthModel;if(r&&k&&g&&v){if(g.shrinkWrap&&v.shrinkWrap){if(r.constrainedMax&&k.constrainedMin){k=null}}}if(r){s.widthModel=r}if(k){s.heightModel=k}if(c.state){Ext.apply(s.state,c.state)}}return t},initContinue:function(e){var g=this,d=g.ownerCtContext,a=g.target,c=g.widthModel,h=a.getHierarchyState(),b;if(c.fixed){h.inShrinkWrapTable=false}else{delete h.inShrinkWrapTable}if(e){if(d&&c.shrinkWrap){b=d.isBoxParent?d:d.boxParent;if(b){b.addBoxChild(g)}}else{if(c.natural){g.boxParent=d}}}return e},initDone:function(d){var b=this,a=b.props,c=b.state;if(b.remainingChildDimensions===0){a.containerChildrenSizeDone=true}if(d){a.containerLayoutDone=true}if(b.boxChildren&&b.boxChildren.length&&b.widthModel.shrinkWrap){b.el.setWidth(10000);c.blocks=(c.blocks||0)+1}},initAnimation:function(){var b=this,c=b.target,a=b.ownerCtContext;if(a&&a.isTopLevel){b.animatePolicy=c.ownerLayout.getAnimatePolicy(b)}else{if(!a&&c.isCollapsingOrExpanding&&c.animCollapse){b.animatePolicy=c.componentLayout.getAnimatePolicy(b)}}if(b.animatePolicy){b.context.queueAnimation(b)}},addCls:function(a){this.getClassList().addMany(a)},removeCls:function(a){this.getClassList().removeMany(a)},addBlock:function(b,d,e){var c=this,g=c[b]||(c[b]={}),a=g[e]||(g[e]={});if(!a[d.id]){a[d.id]=d;++d.blockCount;++c.context.blockCount}},addBoxChild:function(d){var c=this,b,a=d.widthModel;d.boxParent=this;d.measuresBox=a.shrinkWrap?d.hasRawContent:a.natural;if(d.measuresBox){b=c.boxChildren;if(b){b.push(d)}else{c.boxChildren=[d]}}},addPositionStyles:function(d,b){var a=b.x,e=b.y,c=0;if(a!==undefined){d.left=a+"px";++c}if(e!==undefined){d.top=e+"px";++c}return c},addTrigger:function(g,h){var e=this,a=h?"domTriggers":"triggers",i=e[a]||(e[a]={}),b=e.context,d=b.currentLayout,c=i[g]||(i[g]={});if(!c[d.id]){c[d.id]=d;++d.triggerCount;c=b.triggers[h?"dom":"data"];(c[d.id]||(c[d.id]=[])).push({item:this,prop:g});if(e.props[g]!==undefined){if(!h||!(e.dirty&&(g in e.dirty))){++d.firedTriggers}}}},boxChildMeasured:function(){var b=this,c=b.state,a=(c.boxesMeasured=(c.boxesMeasured||0)+1);if(a==b.boxChildren.length){c.clearBoxWidth=1;++b.context.progressCount;b.markDirty()}},borderNames:["border-top-width","border-right-width","border-bottom-width","border-left-width"],marginNames:["margin-top","margin-right","margin-bottom","margin-left"],paddingNames:["padding-top","padding-right","padding-bottom","padding-left"],trblNames:["top","right","bottom","left"],cacheMissHandlers:{borderInfo:function(a){var b=a.getStyles(a.borderNames,a.trblNames);b.width=b.left+b.right;b.height=b.top+b.bottom;return b},marginInfo:function(a){var b=a.getStyles(a.marginNames,a.trblNames);b.width=b.left+b.right;b.height=b.top+b.bottom;return b},paddingInfo:function(b){var a=b.frameBodyContext||b,c=a.getStyles(b.paddingNames,b.trblNames);c.width=c.left+c.right;c.height=c.top+c.bottom;return c}},checkCache:function(a){return this.cacheMissHandlers[a](this)},clearAllBlocks:function(a){var c=this[a],b;if(c){for(b in c){this.clearBlocks(a,b)}}},clearBlocks:function(c,g){var h=this[c],b=h&&h[g],d,e,a;if(b){delete h[g];d=this.context;for(a in b){e=b[a];--d.blockCount;if(!--e.blockCount&&!e.pending&&!e.done){d.queueLayout(e)}}}},block:function(a,b){this.addBlock("blocks",a,b)},domBlock:function(a,b){this.addBlock("domBlocks",a,b)},fireTriggers:function(b,g){var h=this[b],d=h&&h[g],c=this.context,e,a;if(d){for(a in d){e=d[a];++e.firedTriggers;if(!e.done&&!e.blockCount&&!e.pending){c.queueLayout(e)}}}},flush:function(){var b=this,a=b.dirty,c=b.state,d=b.el;b.dirtyCount=0;if(b.classList&&b.classList.dirty){b.classList.flush()}if("attributes" in b){d.set(b.attributes);delete b.attributes}if("innerHTML" in b){d.innerHTML=b.innerHTML;delete b.innerHTML}if(c&&c.clearBoxWidth){c.clearBoxWidth=0;b.el.setStyle("width",null);if(!--c.blocks){b.context.queueItemLayouts(b)}}if(a){delete b.dirty;b.writeProps(a,true)}},flushAnimations:function(){var o=this,c=o.previousSize,l,n,e,h,g,d,i,m,k,a,b;if(c){l=o.target;n=l.layout&&l.layout.animate;if(n){e=Ext.isNumber(n)?n:n.duration}h=Ext.Object.getKeys(o.animatePolicy);g=Ext.apply({},{from:{},to:{},duration:e||Ext.fx.Anim.prototype.duration},n);for(d=0,i=0,m=h.length;i<m;i++){k=h[i];a=c[k];b=o.peek(k);if(a!=b){k=o.translateProps[k]||k;g.from[k]=a;g.to[k]=b;++d}}if(d){if(o.isCollapsingOrExpanding===1){l.componentLayout.undoLayout(o)}else{o.writeProps(g.from)}o.el.animate(g);Ext.fx.Manager.getFxQueue(o.el.id)[0].on({afteranimate:function(){if(o.isCollapsingOrExpanding===1){l.componentLayout.redoLayout(o);l.afterCollapse(true)}else{if(o.isCollapsingOrExpanding===2){l.afterExpand(true)}}}})}}},getBorderInfo:function(){var a=this,b=a.borderInfo;if(!b){a.borderInfo=b=a.checkCache("borderInfo")}return b},getClassList:function(){return this.classList||(this.classList=new Ext.layout.ClassList(this))},getEl:function(c,a){var e=this,g,d,b;if(c){if(c.dom){d=c}else{g=e.target;if(a){g=a}d=g[c];if(typeof d=="function"){d=d.call(g);if(d===e.el){return this}}}if(d){b=e.context.getEl(e,d)}}return b||null},getFrameInfo:function(){var c=this,d=c.frameInfo,b,a;if(!d){b=c.framing;a=c.getBorderInfo();c.frameInfo=d=b?{top:b.top+a.top,right:b.right+a.right,bottom:b.bottom+a.bottom,left:b.left+a.left,width:b.width+a.width,height:b.height+a.height}:a}return d},getMarginInfo:function(){var d=this,h=d.marginInfo,b,a,g,e,c;if(!h){if(!d.wrapsComponent){h=d.checkCache("marginInfo")}else{b=d.target;e=b.ownerLayout;c=e?e.id:null;a=e&&e.manageMargins;h=b.margin$;if(h&&h.ownerId!==c){h=null}if(!h){h=d.parseMargins(b,b.margin)||d.checkCache("marginInfo");if(a){g=d.parseMargins(b,b.margins,e.defaultMargins);if(g){h={top:h.top+g.top,right:h.right+g.right,bottom:h.bottom+g.bottom,left:h.left+g.left}}d.setProp("margin-top",0);d.setProp("margin-right",0);d.setProp("margin-bottom",0);d.setProp("margin-left",0)}h.ownerId=c;b.margin$=h}h.width=h.left+h.right;h.height=h.top+h.bottom}d.marginInfo=h}return h},clearMarginCache:function(){delete this.marginInfo;delete this.target.margin$},getPaddingInfo:function(){var a=this,b=a.paddingInfo;if(!b){a.paddingInfo=b=a.checkCache("paddingInfo")}return b},getProp:function(c){var b=this,a=b.props[c];b.addTrigger(c);return a},getDomProp:function(c){var b=this,a=(b.dirty&&(c in b.dirty))?undefined:b.props[c];b.addTrigger(c,true);return a},getStyle:function(a){var c=this,b=c.styles,e,d;if(a in b){d=b[a]}else{e=c.styleInfo[a];d=c.el.getStyle(a);if(e&&e.parseInt){d=parseInt(d,10)||0}b[a]=d}return d},getStyles:function(p,b){var m=this,e=m.styles,q={},g=0,d=p.length,k,j,l,a,c,h,r,o;b=b||p;for(k=0;k<d;++k){a=p[k];if(a in e){q[b[k]]=e[a];++g;if(k&&g==1){j=p.slice(0,k);l=b.slice(0,k)}}else{if(g){(j||(j=[])).push(a);(l||(l=[])).push(b[k])}}}if(g<d){j=j||p;l=l||b;h=m.styleInfo;r=m.el.getStyle(j);for(k=j.length;k--;){a=j[k];c=h[a];o=r[a];if(c&&c.parseInt){o=parseInt(o,10)||0}q[l[k]]=o;e[a]=o}}return q},hasProp:function(b){var a=this.getProp(b);return typeof a!="undefined"},hasDomProp:function(b){var a=this.getDomProp(b);return typeof a!="undefined"},invalidate:function(a){this.context.queueInvalidate(this,a)},markDirty:function(){if(++this.dirtyCount==1){this.context.queueFlush(this)}},onBoxMeasured:function(){var a=this.boxParent,b=this.state;if(a&&a.widthModel.shrinkWrap&&!b.boxMeasured&&this.measuresBox){b.boxMeasured=1;a.boxChildMeasured()}},parseMargins:function(a,e,d){if(e===true){e=5}var c=typeof e,b;if(c=="string"||c=="number"){b=a.parseBox(e)}else{if(e||d){b={top:0,right:0,bottom:0,left:0};if(d){Ext.apply(b,this.parseMargins(a,d))}if(e){e=Ext.apply(b,a.parseBox(e))}}}return b},peek:function(a){return this.props[a]},recoverProp:function(g,b,a){var e=this,d=e.props,c;if(g in b){d[g]=b[g];if(a&&g in a){c=e.dirty||(e.dirty={});c[g]=a[g]}}},redo:function(b){var e=this,c,a,d;e.revertProps(e.props);if(b&&e.wrapsComponent){if(e.childItems){for(d=0,c=e.childItems,a=c.length;d<a;d++){c[d].redo(b)}}for(d=0,c=e.children,a=c.length;d<a;d++){c[d].redo()}}},removeEl:function(b,a){var d=this,e,c;if(b){if(b.dom){c=b}else{e=d.target;if(a){e=a}c=e[b];if(typeof c=="function"){c=c.call(e);if(c===d.el){return this}}}if(c){d.context.removeEl(d,c)}}},revertProps:function(d){var a,b=this.flushedProps,c={};for(a in d){if(b.hasOwnProperty(a)){c[a]=d[a]}}this.writeProps(c)},setAttribute:function(a,c){var b=this;if(!b.attributes){b.attributes={}}b.attributes[a]=c;b.markDirty()},setBox:function(b){var a=this;if("left" in b){a.setProp("x",b.left)}if("top" in b){a.setProp("y",b.top)}a.setSize(b.width,b.height)},setContentHeight:function(a,b){if(!b&&this.hasRawContent){return 1}return this.setProp("contentHeight",a)},setContentWidth:function(b,a){if(!a&&this.hasRawContent){return 1}return this.setProp("contentWidth",b)},setContentSize:function(c,a,b){return this.setContentWidth(c,b)+this.setContentHeight(a,b)==2},setProp:function(d,c,a){var b=this,h=typeof c,g,e;if(h=="undefined"||(h==="number"&&isNaN(c))){return 0}if(b.props[d]===c){return 1}b.props[d]=c;++b.context.progressCount;if(a===false){b.fireTriggers("domTriggers",d);b.clearBlocks("domBlocks",d)}else{e=b.styleInfo[d];if(e){if(!b.dirty){b.dirty={}}if(d=="width"||d=="height"){g=b.isBorderBoxValue;if(g===null){b.isBorderBoxValue=g=!!b.el.isBorderBox()}if(!g){b.borderInfo||b.getBorderInfo();b.paddingInfo||b.getPaddingInfo()}}b.dirty[d]=c;b.markDirty()}}b.fireTriggers("triggers",d);b.clearBlocks("blocks",d);return 1},setHeight:function(k,a){var g=this,d=g.target,c=g.ownerCtContext,h,e,b,j,i;if(k<0){k=0}if(!g.wrapsComponent){if(!g.setProp("height",k,a)){return NaN}}else{b=g.collapsedVert?0:(d.minHeight||0);k=Ext.Number.constrain(k,b,d.maxHeight);j=g.props.height;if(!g.setProp("height",k,a)){return NaN}if(c&&!g.isComponentChild&&isNaN(j)){i=--c.remainingChildDimensions;if(!i){c.setProp("containerChildrenSizeDone",true)}}h=g.frameBodyContext;if(h){e=g.getFrameInfo();h.setHeight(k-e.height,a)}}return k},setWidth:function(b,a){var i=this,g=i.target,e=i.ownerCtContext,j,h,d,c,k;if(b<0){b=0}if(!i.wrapsComponent){if(!i.setProp("width",b,a)){return NaN}}else{d=i.collapsedHorz?0:(g.minWidth||0);b=Ext.Number.constrain(b,d,g.maxWidth);c=i.props.width;if(!i.setProp("width",b,a)){return NaN}if(e&&!i.isComponentChild&&isNaN(c)){k=--e.remainingChildDimensions;if(!k){e.setProp("containerChildrenSizeDone",true)}}j=i.frameBodyContext;if(j){h=i.getFrameInfo();j.setWidth(b-h.width,a)}}return b},setSize:function(c,a,b){this.setWidth(c,b);this.setHeight(a,b)},translateProps:{x:"left",y:"top"},undo:function(b){var e=this,c,a,d;e.revertProps(e.lastBox);if(b&&e.wrapsComponent){if(e.childItems){for(d=0,c=e.childItems,a=c.length;d<a;d++){c[d].undo(b)}}for(d=0,c=e.children,a=c.length;d<a;d++){c[d].undo()}}},unsetProp:function(b){var a=this.dirty;delete this.props[b];if(a){delete a[b]}},writeProps:function(e,d){if(!(e&&typeof e=="object")){return}var w=this,c=w.el,i={},h=0,b=w.styleInfo,v,j,n,p=e.width,l=e.height,u=w.isBorderBoxValue,x=w.target,r=Math.max,t=0,k=0,g,a,o,q,s,m;if("displayed" in e){c.setDisplayed(e.displayed)}for(j in e){if(d){w.fireTriggers("domTriggers",j);w.clearBlocks("domBlocks",j);w.flushedProps[j]=1}v=b[j];if(v&&v.dom){if(v.suffix&&(n=parseInt(e[j],10))){i[j]=n+v.suffix}else{i[j]=e[j]}++h}}if("x" in e||"y" in e){if(x.isComponent){x.setPosition(e.x,e.y)}else{h+=w.addPositionStyles(i,e)}}if(!u&&(p>0||l>0)){if(!w.frameBodyContext){t=w.paddingInfo.width;k=w.paddingInfo.height}if(p){p=r(parseInt(p,10)-(w.borderInfo.width+t),0);i.width=p+"px";++h}if(l){l=r(parseInt(l,10)-(w.borderInfo.height+k),0);i.height=l+"px";++h}}if(w.wrapsComponent&&Ext.isIE9&&Ext.isStrict){if((g=p!==undefined&&w.hasOverflowY)||(a=l!==undefined&&w.hasOverflowX)){o=w.isAbsolute;if(o===undefined){o=false;m=w.target.getTargetEl();s=m.getStyle("position");if(s=="absolute"){s=m.getStyle("box-sizing");o=(s=="border-box")}w.isAbsolute=o}if(o){q=Ext.getScrollbarSize();if(g){p=parseInt(p,10)+q.width;i.width=p+"px";++h}if(a){l=parseInt(l,10)+q.height;i.height=l+"px";++h}}}}if(h){c.setStyle(i)}}},function(){var c={dom:true,parseInt:true,suffix:"px"},b={dom:true},a={dom:false};this.prototype.styleInfo={containerChildrenSizeDone:a,containerLayoutDone:a,displayed:a,done:a,x:a,y:a,columnWidthsDone:a,left:c,top:c,right:c,bottom:c,width:c,height:c,"border-top-width":c,"border-right-width":c,"border-bottom-width":c,"border-left-width":c,"margin-top":c,"margin-right":c,"margin-bottom":c,"margin-left":c,"padding-top":c,"padding-right":c,"padding-bottom":c,"padding-left":c,"line-height":b,display:b}});Ext.define("Ext.layout.Context",{remainingLayouts:0,state:0,constructor:function(a){var b=this;Ext.apply(b,a);b.items={};b.layouts={};b.blockCount=0;b.cycleCount=0;b.flushCount=0;b.calcCount=0;b.animateQueue=b.newQueue();b.completionQueue=b.newQueue();b.finalizeQueue=b.newQueue();b.finishQueue=b.newQueue();b.flushQueue=b.newQueue();b.invalidateData={};b.layoutQueue=b.newQueue();b.invalidQueue=[];b.triggers={data:{},dom:{}}},callLayout:function(b,a){this.currentLayout=b;b[a](this.getCmp(b.owner))},cancelComponent:function(j,a,m){var p=this,h=j,l=!j.isComponent,b=l?h.length:1,d,c,o,n,g,s,q,r,t,e;for(d=0;d<b;++d){if(l){j=h[d]}if(m&&j.ownerCt){e=this.items[j.ownerCt.el.id];if(e){Ext.Array.remove(e.childItems,p.getCmp(j))}}if(!a){q=p.invalidQueue;o=q.length;if(o){p.invalidQueue=s=[];for(c=0;c<o;++c){r=q[c];t=r.item.target;if(t!=j&&!t.isDescendant(j)){s.push(r)}}}}g=j.componentLayout;p.cancelLayout(g);if(g.getLayoutItems){n=g.getLayoutItems();if(n.length){p.cancelComponent(n,true)}}if(j.isContainer&&!j.collapsed){g=j.layout;p.cancelLayout(g);n=g.getVisibleItems();if(n.length){p.cancelComponent(n,true)}}}},cancelLayout:function(b){var a=this;a.completionQueue.remove(b);a.finalizeQueue.remove(b);a.finishQueue.remove(b);a.layoutQueue.remove(b);if(b.running){a.layoutDone(b)}b.ownerContext=null},clearTriggers:function(g,h){var a=g.id,e=this.triggers[h?"dom":"data"],j=e&&e[a],b=(j&&j.length)||0,e,d,k,c;for(d=0;d<b;++d){c=j[d];k=c.item;e=h?k.domTriggers:k.triggers;delete e[c.prop][a]}},flush:function(){var d=this,a=d.flushQueue.clear(),c=a.length,b;if(c){++d.flushCount;for(b=0;b<c;++b){a[b].flush()}}},flushAnimations:function(){var d=this,b=d.animateQueue.clear(),a=b.length,c;if(a){for(c=0;c<a;c++){if(b[c].target.animate!==false){b[c].flushAnimations()}}Ext.fx.Manager.runner()}},flushInvalidates:function(){var h=this,a=h.invalidQueue,g=a&&a.length,b,e,d,c;h.invalidQueue=[];if(g){e=[];for(c=0;c<g;++c){b=(d=a[c]).item.target;if(!b.container.isDetachedBody){e.push(b);if(d.options){h.invalidateData[b.id]=d.options}}}h.invalidate(e,null)}},flushLayouts:function(h,a,c){var g=this,j=c?g[h].items:g[h].clear(),e=j.length,b,d;if(e){for(b=0;b<e;++b){d=j[b];if(!d.running){g.callLayout(d,a)}}g.currentLayout=null}},getCmp:function(a){return this.getItem(a,a.el)},getEl:function(b,a){var c=this.getItem(a,a);if(!c.parent){c.parent=b;if(b.children.length){b.children.push(c)}else{b.children=[c]}}return c},getItem:function(d,b){var e=b.id,a=this.items,c=a[e]||(a[e]=new Ext.layout.ContextItem({context:this,target:d,el:b}));return c},handleFailure:function(){var c=this.layouts,b,a;Ext.failedLayouts=(Ext.failedLayouts||0)+1;for(a in c){b=c[a];if(c.hasOwnProperty(a)){b.running=false;b.ownerContext=null}}},invalidate:function(k,n){var p=this,m=!k.isComponent,c,a,g,l,q,o,b,h,j,e,d;for(g=0,b=m?k.length:1;g<b;++g){l=m?k[g]:k;if(l.rendered&&!l.hidden){q=p.getCmp(l);h=l.componentLayout;a=!h.ownerContext;j=(l.isContainer&&!l.collapsed)?l.layout:null;e=p.invalidateData[q.id];delete p.invalidateData[q.id];d=q.init(n,e);if(e){p.processInvalidate(e,q,"before")}if(h.beforeLayoutCycle){h.beforeLayoutCycle(q)}if(j&&j.beforeLayoutCycle){j.beforeLayoutCycle(q)}d=q.initContinue(d);c=true;if(h.getLayoutItems){h.renderChildren();o=h.getLayoutItems();if(o.length){p.invalidate(o,true)}}if(j){c=false;j.renderChildren();o=j.getVisibleItems();if(o.length){p.invalidate(o,true)}}q.initDone(c);p.resetLayout(h,q,a);if(j){p.resetLayout(j,q,a)}q.initAnimation();if(e){p.processInvalidate(e,q,"after")}}}p.currentLayout=null},layoutDone:function(a){var b=a.ownerContext;a.running=false;if(a.isComponentLayout){if(b.measuresBox){b.onBoxMeasured()}b.setProp("done",true)}else{b.setProp("containerLayoutDone",true)}--this.remainingLayouts;++this.progressCount},newQueue:function(){return new Ext.util.Queue()},processInvalidate:function(b,e,a){if(b[a]){var d=this,c=d.currentLayout;d.currentLayout=b.layout||null;b[a](e,b);d.currentLayout=c}},queueAnimation:function(a){this.animateQueue.add(a)},queueCompletion:function(a){this.completionQueue.add(a)},queueFinalize:function(a){this.finalizeQueue.add(a)},queueFlush:function(a){this.flushQueue.add(a)},chainFns:function(a,i,g){var d=this,c=a.layout,e=i.layout,b=a[g],h=i[g];return function(j){var k=d.currentLayout;if(b){d.currentLayout=c;b.call(a.scope||a,j,a)}d.currentLayout=e;h.call(i.scope||i,j,i);d.currentLayout=k}},queueInvalidate:function(k,l){var h=this,j=[],i=h.invalidQueue,g=i.length,d,b,e,a,c;if(k.isComponent){k=h.getCmp(d=k)}else{d=k.target}k.invalid=true;while(g--){b=i[g];e=b.item.target;if(d.isDescendant(e)){return}if(e==d){if(!(a=b.options)){b.options=l}else{if(l){if(l.widthModel){a.widthModel=l.widthModel}if(l.heightModel){a.heightModel=l.heightModel}if(!(c=a.state)){a.state=l.state}else{if(l.state){Ext.apply(c,l.state)}}if(l.before){a.before=h.chainFns(a,l,"before")}if(l.after){a.after=h.chainFns(a,l,"after")}}}return}if(!e.isDescendant(d)){j.push(b)}}j.push({item:k,options:l});h.invalidQueue=j},queueItemLayouts:function(c){var a=c.isComponent?c:c.target,b=a.componentLayout;if(!b.pending&&!b.invalid&&!b.done){this.queueLayout(b)}b=a.layout;if(b&&!b.pending&&!b.invalid&&!b.done){this.queueLayout(b)}},queueLayout:function(a){this.layoutQueue.add(a);a.pending=true},removeEl:function(d,c){var e=c.id,b=d.children,a=this.items;if(b){Ext.Array.remove(b,a[e])}delete a[e]},resetLayout:function(b,c,d){var a=this;a.currentLayout=b;b.done=false;b.pending=true;b.firedTriggers=0;a.layoutQueue.add(b);if(d){a.layouts[b.id]=b;b.running=true;if(b.finishedLayout){a.finishQueue.add(b)}++a.remainingLayouts;++b.layoutCount;b.ownerContext=c;b.beginCount=0;b.blockCount=0;b.calcCount=0;b.triggerCount=0;if(!b.initialized){b.initLayout()}b.beginLayout(c)}else{++b.beginCount;if(!b.running){++a.remainingLayouts;b.running=true;if(b.isComponentLayout){c.unsetProp("done")}a.completionQueue.remove(b);a.finalizeQueue.remove(b)}}b.beginLayoutCycle(c,d)},run:function(){var c=this,b=false,a=100;c.flushInvalidates();c.state=1;c.totalCount=c.layoutQueue.getCount();c.flush();while((c.remainingLayouts||c.invalidQueue.length)&&a--){if(c.invalidQueue.length){c.flushInvalidates()}if(c.runCycle()){b=false}else{if(!b){c.flush();b=true;c.flushLayouts("completionQueue","completeLayout")}else{if(!c.invalidQueue.length){c.state=2;break}}}if(!(c.remainingLayouts||c.invalidQueue.length)){c.flush();c.flushLayouts("completionQueue","completeLayout");c.flushLayouts("finalizeQueue","finalizeLayout")}}return c.runComplete()},runComplete:function(){var a=this;a.state=2;if(a.remainingLayouts){a.handleFailure();return false}a.flush();a.flushLayouts("finishQueue","finishedLayout",true);a.flushLayouts("finishQueue","notifyOwner");a.flush();a.flushAnimations();return true},runCycle:function(){var c=this,d=c.layoutQueue.clear(),b=d.length,a;++c.cycleCount;c.progressCount=0;for(a=0;a<b;++a){c.runLayout(c.currentLayout=d[a])}c.currentLayout=null;return c.progressCount>0},runLayout:function(b){var a=this,c=a.getCmp(b.owner);b.pending=false;if(c.state.blocks){return}b.done=true;++b.calcCount;++a.calcCount;b.calculate(c);if(b.done){a.layoutDone(b);if(b.completeLayout){a.queueCompletion(b)}if(b.finalizeLayout){a.queueFinalize(b)}}else{if(!b.pending&&!b.invalid&&!(b.blockCount+b.triggerCount-b.firedTriggers)){a.queueLayout(b)}}},setItemSize:function(h,g,b){var d=h,a=1,c,e;if(h.isComposite){d=h.elements;a=d.length;h=d[0]}else{if(!h.dom&&!h.el){a=d.length;h=d[0]}}for(e=0;e<a;){c=this.get(h);c.setSize(g,b);h=d[++e]}}});Ext.define("Ext.dom.Layer",{extend:Ext.Element,alternateClassName:"Ext.Layer",statics:{shims:[]},isLayer:true,localXYNames:{get:"getLocalXY",set:"setLocalXY"},constructor:function(c,b){c=c||{};var d=this,e=Ext.DomHelper,h=c.parentEl,g=h?Ext.getDom(h):document.body,i=c.hideMode,a=Ext.baseCSSPrefix+(c.fixed&&!(Ext.isIE6||Ext.isIEQuirks)?"fixed-layer":"layer");d.el=d;if(b){d.dom=Ext.getDom(b)}if(!d.dom){d.dom=e.append(g,c.dh||{tag:"div",cls:a})}else{d.addCls(a);if(!d.dom.parentNode){g.appendChild(d.dom)}}if(c.id){d.id=d.dom.id=c.id}else{d.id=Ext.id(d.dom)}Ext.Element.addToCache(d);if(c.cls){d.addCls(c.cls)}d.constrain=c.constrain!==false;if(i){d.setVisibilityMode(Ext.Element[i.toUpperCase()]);if(d.visibilityMode==Ext.Element.ASCLASS){d.visibilityCls=c.visibilityCls}}else{if(c.useDisplay){d.setVisibilityMode(Ext.Element.DISPLAY)}else{d.setVisibilityMode(Ext.Element.VISIBILITY)}}if(c.shadow){d.shadowOffset=c.shadowOffset||4;d.shadow=new Ext.Shadow({offset:d.shadowOffset,mode:c.shadow,fixed:c.fixed});d.disableShadow()}else{d.shadowOffset=0}d.useShim=c.shim!==false&&Ext.useShims;if(c.hidden===true){d.hide()}else{d.show()}},getZIndex:function(){return parseInt((this.getShim()||this).getStyle("z-index"),10)},getShim:function(){var b=this,c,a;if(!b.useShim){return null}if(!b.shim){c=b.self.shims.shift();if(!c){c=b.createShim();c.enableDisplayMode("block");c.hide()}a=b.dom.parentNode;if(c.dom.parentNode!=a){a.insertBefore(c.dom,b.dom)}b.shim=c}return b.shim},hideShim:function(){var a=this;if(a.shim){a.shim.setDisplayed(false);a.self.shims.push(a.shim);delete a.shim}},disableShadow:function(){var a=this;if(a.shadow&&!a.shadowDisabled){a.shadowDisabled=true;a.shadow.hide();a.lastShadowOffset=a.shadowOffset;a.shadowOffset=0}},enableShadow:function(a){var b=this;if(b.shadow&&b.shadowDisabled){b.shadowDisabled=false;b.shadowOffset=b.lastShadowOffset;delete b.lastShadowOffset;if(a){b.sync(true)}}},sync:function(b){var i=this,n=i.shadow,g,d,a,c,o,k,j,m,e,l;if(!i.updating&&i.isVisible()&&(n||i.useShim)){c=i.getShim();o=i[i.localXYNames.get]();k=o[0];j=o[1];m=i.dom.offsetWidth;e=i.dom.offsetHeight;if(n&&!i.shadowDisabled){if(b&&!n.isVisible()){n.show(i)}else{n.realign(k,j,m,e)}if(c){l=c.getStyle("z-index");if(l>i.zindex){i.shim.setStyle("z-index",i.zindex-2)}c.show();if(n.isVisible()){g=n.el.getXY();d=c.dom.style;a=n.el.getSize();if(Ext.supports.CSS3BoxShadow){a.height+=6;a.width+=4;g[0]-=2;g[1]-=4}d.left=(g[0])+"px";d.top=(g[1])+"px";d.width=(a.width)+"px";d.height=(a.height)+"px"}else{c.setSize(m,e);c[i.localXYNames.set](k,j)}}}else{if(c){l=c.getStyle("z-index");if(l>i.zindex){i.shim.setStyle("z-index",i.zindex-2)}c.show();c.setSize(m,e);c[i.localXYNames.set](k,j)}}}return i},remove:function(){this.hideUnders();this.callParent()},beginUpdate:function(){this.updating=true},endUpdate:function(){this.updating=false;this.sync(true)},hideUnders:function(){if(this.shadow){this.shadow.hide()}this.hideShim()},constrainXY:function(){if(this.constrain){var g=Ext.Element.getViewWidth(),b=Ext.Element.getViewHeight(),l=Ext.getDoc().getScroll(),k=this.getXY(),i=k[0],e=k[1],a=this.shadowOffset,j=this.dom.offsetWidth+a,c=this.dom.offsetHeight+a,d=false;if((i+j)>g+l.left){i=g-j-a;d=true}if((e+c)>b+l.top){e=b-c-a;d=true}if(i<l.left){i=l.left;d=true}if(e<l.top){e=l.top;d=true}if(d){Ext.Layer.superclass.setXY.call(this,[i,e]);this.sync()}}return this},getConstrainOffset:function(){return this.shadowOffset},setVisible:function(e,b,d,h,g){var c=this,a;a=function(){if(e){c.sync(true)}if(h){h()}};if(!e){c.hideUnders(true)}c.callParent([e,b,d,h,g]);if(!b){a()}return c},beforeFx:function(){this.beforeAction();return this.callParent(arguments)},afterFx:function(){this.callParent(arguments);this.sync(this.isVisible())},beforeAction:function(){if(!this.updating&&this.shadow){this.shadow.hide()}},setLeft:function(a){this.callParent(arguments);return this.sync()},setTop:function(a){this.callParent(arguments);return this.sync()},setLeftTop:function(b,a){this.callParent(arguments);return this.sync()},setLocalX:function(){this.callParent(arguments);return this.sync()},setLocalXY:function(){this.callParent(arguments);return this.sync()},setLocalY:function(){this.callParent(arguments);return this.sync()},setXY:function(d,a,c,g,e){var b=this;g=b.createCB(g);b.fixDisplay();b.beforeAction();b.callParent([d,a,c,g,e]);if(!a){g()}return b},createCB:function(c){var a=this,b=a.shadow&&a.shadow.isVisible();return function(){a.constrainXY();a.sync(b);if(c){c()}}},setX:function(a,b,c,e,d){this.setXY([a,this.getY()],b,c,e,d);return this},setY:function(e,a,b,d,c){this.setXY([this.getX(),e],a,b,d,c);return this},setSize:function(a,c,b,e,i,g){var d=this;i=d.createCB(i);d.beforeAction();d.callParent([a,c,b,e,i,g]);if(!b){i()}return d},setWidth:function(a,b,d,g,e){var c=this;g=c.createCB(g);c.beforeAction();c.callParent([a,b,d,g,e]);if(!b){g()}return c},setHeight:function(b,a,d,g,e){var c=this;g=c.createCB(g);c.beforeAction();c.callParent([b,a,d,g,e]);if(!a){g()}return c},setBounds:function(h,g,a,j,b,c,i,d){var e=this;i=e.createCB(i);e.beforeAction();if(!b){Ext.Layer.superclass.setXY.call(e,[h,g]);Ext.Layer.superclass.setSize.call(e,a,j);i()}else{e.callParent([h,g,a,j,b,c,i,d])}return e},setZIndex:function(a){var b=this;b.zindex=a;if(b.getShim()){b.shim.setStyle("z-index",a++)}if(b.shadow){b.shadow.setZIndex(a++)}return b.setStyle("z-index",a)},onOpacitySet:function(a){var b=this.shadow;if(b){b.setOpacity(a)}}});Ext.define("Ext.util.ComponentDragger",{extend:Ext.dd.DragTracker,autoStart:500,constructor:function(a,b){this.comp=a;this.initialConstrainTo=b.constrainTo;this.callParent([b])},onStart:function(c){var b=this,a=b.comp;this.startPosition=a.getXY();if(a.ghost&&!a.liveDrag){b.proxy=a.ghost();b.dragTarget=b.proxy.header.el}if(b.constrain||b.constrainDelegate){b.constrainTo=b.calculateConstrainRegion()}if(a.beginDrag){a.beginDrag()}},calculateConstrainRegion:function(){var g=this,d=g.comp,j=g.initialConstrainTo,b,h,i,a=g.proxy?g.proxy.el:d.el,e=(!g.constrainDelegate&&a.shadow&&!a.shadowDisabled)?a.shadow.getShadowSize():0;if(!(j instanceof Ext.util.Region)){b=Ext.fly(j);j=b.getViewRegion();j.right=j.left+b.dom.clientWidth}if(e){j.adjust(e[0],-e[1],-e[2],e[3])}if(!g.constrainDelegate){h=Ext.fly(g.dragTarget).getRegion();i=a.getRegion();j.adjust(h.top-i.top,h.right-i.right,h.bottom-i.bottom,h.left-i.left)}return j},onDrag:function(c){var b=this,a=(b.proxy&&!b.comp.liveDrag)?b.proxy:b.comp,d=b.getOffset(b.constrain||b.constrainDelegate?"dragTarget":null);a.setPagePosition(b.startPosition[0]+d[0],b.startPosition[1]+d[1])},onEnd:function(b){var a=this.comp;if(a.isDestroyed||a.destroying){return}if(this.proxy&&!a.liveDrag){a.unghost()}if(a.endDrag){a.endDrag()}}});Ext.define("Ext.window.Window",{extend:Ext.panel.Panel,alternateClassName:"Ext.Window",alias:"widget.window",baseCls:Ext.baseCSSPrefix+"window",resizable:true,draggable:true,constrain:false,constrainHeader:false,plain:false,minimizable:false,maximizable:false,minHeight:50,minWidth:50,expandOnShow:true,collapsible:false,closable:true,hidden:true,autoRender:true,hideMode:"offsets",floating:true,ariaRole:"alertdialog",itemCls:Ext.baseCSSPrefix+"window-item",initialAlphaNum:/^[a-z0-9]/,overlapHeader:true,ignoreHeaderBorderManagement:true,alwaysFramed:true,isRootCfg:{isRoot:true},isWindow:true,initComponent:function(){var a=this;a.frame=false;a.callParent();a.addEvents("resize","maximize","minimize","restore");if(a.plain){a.addClsWithUI("plain")}if(a.modal){a.ariaRole="dialog"}a.addStateEvents(["maximize","restore","resize","dragend"])},getElConfig:function(){var b=this,a;a=b.callParent();a.tabIndex=-1;return a},getState:function(){var b=this,d=b.callParent()||{},a=!!b.maximized,c=b.ghostBox,e;d.maximized=a;if(a){e=b.restorePos}else{if(c){e=[c.x,c.y]}else{e=b.getPosition()}}Ext.apply(d,{size:a?b.restoreSize:b.getSize(),pos:e});return d},applyState:function(b){var a=this;if(b){a.maximized=b.maximized;if(a.maximized){a.hasSavedRestore=true;a.restoreSize=b.size;a.restorePos=b.pos}else{Ext.apply(a,{width:b.size.width,height:b.size.height,x:b.pos[0],y:b.pos[1]})}}},onRender:function(b,a){var c=this;c.callParent(arguments);c.focusEl=c.el;if(c.maximizable){c.header.on({scope:c,dblclick:c.toggleMaximize})}},afterRender:function(){var a=this,c=a.header,b;a.callParent();if(a.maximized){a.maximized=false;a.maximize();if(c){c.removeCls(c.indicateDragCls)}}if(a.closable){b=a.getKeyMap();b.on(27,a.onEsc,a)}else{b=a.keyMap}if(b&&a.hidden){b.disable()}},initDraggable:function(){this.initSimpleDraggable()},initResizable:function(){this.callParent(arguments);if(this.maximized){this.resizer.disable()}},onEsc:function(a,b){if(!Ext.FocusManager||!Ext.FocusManager.enabled||Ext.FocusManager.focusedCmp===this){b.stopEvent();this.close()}},beforeDestroy:function(){var a=this;if(a.rendered){delete this.animateTarget;a.hide();Ext.destroy(a.keyMap)}a.callParent()},addTools:function(){var a=this;a.callParent();if(a.minimizable){a.addTool({type:"minimize",handler:Ext.Function.bind(a.minimize,a,[])})}if(a.maximizable){a.addTool({type:"maximize",handler:Ext.Function.bind(a.maximize,a,[])});a.addTool({type:"restore",handler:Ext.Function.bind(a.restore,a,[]),hidden:true})}},getFocusEl:function(){return this.getDefaultFocus()},getDefaultFocus:function(){var c=this,b,d=c.defaultButton||c.defaultFocus,a;if(d!==undefined){if(Ext.isNumber(d)){b=c.query("button")[d]}else{if(Ext.isString(d)){a=d;if(a.match(c.initialAlphaNum)){b=c.down("#"+a)}if(!b){b=c.down(a)}}else{if(d.focus){b=d}}}}return b||c.el},onFocus:function(){var b=this,a;if((Ext.FocusManager&&Ext.FocusManager.enabled)||((a=b.getDefaultFocus())===b)){b.callParent(arguments)}else{a.focus()}},beforeLayout:function(){var a=this.el.shadow;this.callParent();if(a){a.hide()}},onShow:function(){var a=this;a.callParent(arguments);if(a.expandOnShow){a.expand(false)}a.syncMonitorWindowResize();if(a.keyMap){a.keyMap.enable()}},doClose:function(){var a=this;if(a.hidden){a.fireEvent("close",a);if(a.closeAction=="destroy"){this.destroy()}}else{a.hide(a.animateTarget,a.doClose,a)}},afterHide:function(){var a=this;a.syncMonitorWindowResize();if(a.keyMap){a.keyMap.disable()}a.callParent(arguments)},onWindowResize:function(){var b=this,a;if(b.maximized){b.fitContainer()}else{a=b.getSizeModel();if(a.width.natural||a.height.natural){b.updateLayout()}b.doConstrain()}},minimize:function(){this.fireEvent("minimize",this);return this},resumeHeaderLayout:function(a){this.header.resumeLayouts(a?this.isRootCfg:null)},afterCollapse:function(){var a=this,c=a.header,b=a.tools;if(c&&a.maximizable){c.suspendLayouts();b.maximize.hide();b.restore.hide();this.resumeHeaderLayout(true)}if(a.resizer){a.resizer.disable()}a.callParent(arguments)},afterExpand:function(){var a=this,d=a.header,b=a.tools,c;if(d){d.suspendLayouts();if(a.maximized){b.restore.show();c=true}else{if(a.maximizable){b.maximize.show();c=true}}this.resumeHeaderLayout(c)}if(a.resizer){a.resizer.enable()}a.callParent(arguments)},maximize:function(a){var b=this,e=b.header,c=b.tools,d;if(!b.maximized){b.expand(false);if(!b.hasSavedRestore){b.restoreSize=b.getSize();b.restorePos=b.getPosition(true)}if(e){e.suspendLayouts();if(c.maximize){c.maximize.hide();d=true}if(c.restore){c.restore.show();d=true}if(b.collapseTool){b.collapseTool.hide();d=true}b.resumeHeaderLayout(d)}b.maximized=true;b.el.disableShadow();if(b.dd){b.dd.disable();if(e){e.removeCls(e.indicateDragCls)}}if(b.resizer){b.resizer.disable()}b.el.addCls(Ext.baseCSSPrefix+"window-maximized");b.container.addCls(Ext.baseCSSPrefix+"window-maximized-ct");b.syncMonitorWindowResize();b.fitContainer(a=(a||!!b.animateTarget)?{callback:function(){b.fireEvent("maximize",b)}}:null);if(!a){b.fireEvent("maximize",b)}}return b},restore:function(b){var c=this,d=c.tools,g=c.header,a=c.restoreSize,e;if(c.maximized){c.hasSavedRestore=null;c.removeCls(Ext.baseCSSPrefix+"window-maximized");if(g){g.suspendLayouts();if(d.restore){d.restore.hide();e=true}if(d.maximize){d.maximize.show();e=true}if(c.collapseTool){c.collapseTool.show();e=true}c.resumeHeaderLayout(e)}c.maximized=false;a.x=c.restorePos[0];a.y=c.restorePos[1];c.setBox(a,b=(b||!!c.animateTarget)?{callback:function(){c.el.enableShadow(true);c.fireEvent("restore",c)}}:null);c.restorePos=c.restoreSize=null;if(c.dd){c.dd.enable();if(g){g.addCls(g.indicateDragCls)}}if(c.resizer){c.resizer.enable()}c.container.removeCls(Ext.baseCSSPrefix+"window-maximized-ct");c.syncMonitorWindowResize();if(!b){c.el.enableShadow(true);c.fireEvent("restore",c)}}return c},syncMonitorWindowResize:function(){var b=this,c=b._monitoringResize,d=b.monitorResize||b.constrain||b.constrainHeader||b.maximized,a=b.hidden||b.destroying||b.isDestroyed;if(d&&!a){if(!c){Ext.EventManager.onWindowResize(b.onWindowResize,b,{delay:1});b._monitoringResize=true}}else{if(c){Ext.EventManager.removeResizeListener(b.onWindowResize,b);b._monitoringResize=false}}},toggleMaximize:function(){return this[this.maximized?"restore":"maximize"]()}});Ext.define("Ext.toolbar.TextItem",{extend:Ext.toolbar.Item,alias:"widget.tbtext",alternateClassName:"Ext.Toolbar.TextItem",text:"",renderTpl:"{text}",baseCls:Ext.baseCSSPrefix+"toolbar-text",beforeRender:function(){var a=this;a.callParent();Ext.apply(a.renderData,{text:a.text})},setText:function(b){var a=this;a.text=b;if(a.rendered){a.el.update(b);a.updateLayout()}}});Ext.define("Ext.util.CSS",function(){var c,e=null,d=document,b=/(-[a-z])/gi,a=function(g,h){return h.charAt(1).toUpperCase()};return{singleton:true,rules:e,initialized:false,constructor:function(){c=this},createStyleSheet:function(i,l){var h,g=d.getElementsByTagName("head")[0],k=d.createElement("style");k.setAttribute("type","text/css");if(l){k.setAttribute("id",l)}if(Ext.isIE){g.appendChild(k);h=k.styleSheet;h.cssText=i}else{try{k.appendChild(d.createTextNode(i))}catch(j){k.cssText=i}g.appendChild(k);h=k.styleSheet?k.styleSheet:(k.sheet||d.styleSheets[d.styleSheets.length-1])}c.cacheStyleSheet(h);return h},removeStyleSheet:function(h){var g=d.getElementById(h);if(g){g.parentNode.removeChild(g)}},swapStyleSheet:function(i,g){var h;c.removeStyleSheet(i);h=d.createElement("link");h.setAttribute("rel","stylesheet");h.setAttribute("type","text/css");h.setAttribute("id",i);h.setAttribute("href",g);d.getElementsByTagName("head")[0].appendChild(h)},refreshCache:function(){return c.getRules(true)},cacheStyleSheet:function(m){if(!e){e=c.rules={}}try{var p=m.cssRules||m.rules,l=p.length-1,h=m.imports,g=h?h.length:0,o,k;for(k=0;k<g;++k){c.cacheStyleSheet(h[k])}for(;l>=0;--l){o=p[l];if(o.styleSheet){c.cacheStyleSheet(o.styleSheet)}c.cacheRule(o,m)}}catch(n){}},cacheRule:function(h,l){if(h.styleSheet){return c.cacheStyleSheet(h.styleSheet)}var k=h.selectorText,i,g;if(k){k=k.split(",");i=k.length;for(g=0;g<i;g++){e[Ext.String.trim(k[g]).toLowerCase()]={parentStyleSheet:l,cssRule:h}}}},getRules:function(i){var h={},g;if(e===null||i){c.refreshCache()}for(g in e){h[g]=e[g].cssRule}return h},refreshCache:function(){var j=d.styleSheets,h=0,g=j.length;e=c.rules={};for(;h<g;h++){try{if(!j[h].disabled){c.cacheStyleSheet(j[h])}}catch(k){}}},getRule:function(h,k,j){var l,g;if(!e||k){c.refreshCache()}if(!Ext.isArray(h)){g=e[h.toLowerCase()];if(g&&!j){g=g.cssRule}return g||null}for(l=0;l<h.length;l++){if(e[h[l]]){return j?e[h[l].toLowerCase()]:e[h[l].toLowerCase()].cssRule}}return null},createRule:function(l,h,j){var g,k=l.cssRules||l.rules,i=k.length;if(l.insertRule){l.insertRule(h+"{"+j+"}",i)}else{l.addRule(h,j||" ")}c.cacheRule(g=k[i],l);return g},updateRule:function(g,l,k){var m,h,j;if(!Ext.isArray(g)){m=c.getRule(g);if(m){if(arguments.length==2){j=Ext.Element.parseStyles(l);for(l in j){m.style[l.replace(b,a)]=j[l]}}else{m.style[l.replace(b,a)]=k}return true}}else{for(h=0;h<g.length;h++){if(c.updateRule(g[h],l,k)){return true}}}return false},deleteRule:function(g){var i=c.getRule(g,false,true),j,h;if(i){j=i.parentStyleSheet;h=Ext.Array.indexOf(j.cssRules||j.rules,i.cssRule);if(j.deleteRule){j.deleteRule(h)}else{j.removeRule(h)}delete e[g]}}}});Ext.define("Ext.layout.component.Body",{alias:["layout.body"],extend:Ext.layout.component.Auto,type:"body",beginLayout:function(a){this.callParent(arguments);a.bodyContext=a.getEl("body")},beginLayoutCycle:function(d,b){var c=this,g=c.lastWidthModel,e=c.lastHeightModel,a=c.owner.body;c.callParent(arguments);if(g&&g.fixed&&d.widthModel.shrinkWrap){a.setWidth(null)}if(e&&e.fixed&&d.heightModel.shrinkWrap){a.setHeight(null)}},calculateOwnerHeightFromContentHeight:function(c,b){var a=this.callParent(arguments);if(c.targetContext!=c){a+=c.getPaddingInfo().height}return a},calculateOwnerWidthFromContentWidth:function(c,a){var b=this.callParent(arguments);if(c.targetContext!=c){b+=c.getPaddingInfo().width}return b},measureContentWidth:function(a){return a.bodyContext.setWidth(a.bodyContext.el.dom.offsetWidth,false)},measureContentHeight:function(a){return a.bodyContext.setHeight(a.bodyContext.el.dom.offsetHeight,false)},publishInnerHeight:function(c,a){var d=a-c.getFrameInfo().height,b=c.targetContext;if(b!=c){d-=c.getPaddingInfo().height}return c.bodyContext.setHeight(d,!c.heightModel.natural)},publishInnerWidth:function(d,c){var a=c-d.getFrameInfo().width,b=d.targetContext;if(b!=d){a-=d.getPaddingInfo().width}d.bodyContext.setWidth(a,!d.widthModel.natural)}});Ext.define("Ext.layout.container.Fit",{extend:Ext.layout.container.Container,alternateClassName:"Ext.layout.FitLayout",alias:"layout.fit",itemCls:Ext.baseCSSPrefix+"fit-item",targetCls:Ext.baseCSSPrefix+"layout-fit",type:"fit",defaultMargins:{top:0,right:0,bottom:0,left:0},manageMargins:true,sizePolicies:{0:{readsWidth:1,readsHeight:1,setsWidth:0,setsHeight:0},1:{readsWidth:0,readsHeight:1,setsWidth:1,setsHeight:0},2:{readsWidth:1,readsHeight:0,setsWidth:0,setsHeight:1},3:{readsWidth:0,readsHeight:0,setsWidth:1,setsHeight:1}},getItemSizePolicy:function(b,c){var a=c||this.owner.getSizeModel(),d=(a.width.shrinkWrap?0:1)|(a.height.shrinkWrap?0:2);return this.sizePolicies[d]},beginLayoutCycle:function(k,g){var t=this,u=t.lastHeightModel&&t.lastHeightModel.calculated,h=t.lastWidthModel&&t.lastWidthModel.calculated,o=h||u,l=0,m=0,s,b,p,r,e,a,j,n,q,d;t.callParent(arguments);if(o&&k.targetContext.el.dom.tagName.toUpperCase()!="TD"){o=h=u=false}b=k.childItems;e=b.length;for(p=0;p<e;++p){r=b[p];if(g){s=r.target;j=s.minHeight;n=s.minWidth;if(n||j){a=r.marginInfo||r.getMarginInfo();j+=a.height;n+=a.height;if(l<j){l=j}if(m<n){m=n}}}if(o){q=r.el.dom.style;if(u){q.height=""}if(h){q.width=""}}}if(g){k.maxChildMinHeight=l;k.maxChildMinWidth=m}s=k.target;k.overflowX=(!k.widthModel.shrinkWrap&&k.maxChildMinWidth&&s.scrollFlags.x)||d;k.overflowY=(!k.heightModel.shrinkWrap&&k.maxChildMinHeight&&s.scrollFlags.y)||d},calculate:function(g){var o=this,l=g.childItems,d=l.length,c=o.getContainerSize(g),e={length:d,ownerContext:g,targetSize:c},r=g.widthModel.shrinkWrap,m=g.heightModel.shrinkWrap,k=g.overflowX,h=g.overflowY,n,b,p,j,a,q;if(k||h){n=o.getScrollbarsNeeded(k&&c.width,h&&c.height,g.maxChildMinWidth,g.maxChildMinHeight);if(n){b=Ext.getScrollbarSize();if(n&1){c.height-=b.height}if(n&2){c.width-=b.width}}}for(j=0;j<d;++j){e.index=j;o.fitItem(l[j],e)}if(m||r){p=g.targetContext.getPaddingInfo();if(r){if(h&&!c.gotHeight){o.done=false}else{a=e.contentWidth+p.width;if(n&2){a+=b.width}if(!g.setContentWidth(a)){o.done=false}}}if(m){if(k&&!c.gotWidth){o.done=false}else{q=e.contentHeight+p.height;if(n&1){q+=b.height}if(!g.setContentHeight(q)){o.done=false}}}}},fitItem:function(b,c){var a=this;if(b.invalid){a.done=false;return}c.margins=b.getMarginInfo();c.needed=c.got=0;a.fitItemWidth(b,c);a.fitItemHeight(b,c);if(c.got!=c.needed){a.done=false}},fitItemWidth:function(c,d){var a,b;if(d.ownerContext.widthModel.shrinkWrap){b=c.getProp("width")+d.margins.width;a=d.contentWidth;if(a===undefined){d.contentWidth=b}else{d.contentWidth=Math.max(a,b)}}else{if(c.widthModel.calculated){++d.needed;if(d.targetSize.gotWidth){++d.got;this.setItemWidth(c,d)}}}this.positionItemX(c,d)},fitItemHeight:function(c,d){var b,a;if(d.ownerContext.heightModel.shrinkWrap){a=c.getProp("height")+d.margins.height;b=d.contentHeight;if(b===undefined){d.contentHeight=a}else{d.contentHeight=Math.max(b,a)}}else{if(c.heightModel.calculated){++d.needed;if(d.targetSize.gotHeight){++d.got;this.setItemHeight(c,d)}}}this.positionItemY(c,d)},positionItemX:function(a,c){var b=c.margins;if(c.index||b.left){a.setProp("x",b.left)}if(b.width){a.setProp("margin-right",b.width)}},positionItemY:function(a,c){var b=c.margins;if(c.index||b.top){a.setProp("y",b.top)}if(b.height){a.setProp("margin-bottom",b.height)}},setItemHeight:function(a,b){a.setHeight(b.targetSize.height-b.margins.height)},setItemWidth:function(a,b){a.setWidth(b.targetSize.width-b.margins.width)}});Ext.define("Ext.menu.Item",{extend:Ext.Component,alias:"widget.menuitem",alternateClassName:"Ext.menu.TextItem",activeCls:Ext.baseCSSPrefix+"menu-item-active",ariaRole:"menuitem",canActivate:true,clickHideDelay:1,destroyMenu:true,disabledCls:Ext.baseCSSPrefix+"menu-item-disabled",hideOnClick:true,isMenuItem:true,menuAlign:"tl-tr?",menuExpandDelay:200,menuHideDelay:200,tooltipType:"qtip",arrowCls:Ext.baseCSSPrefix+"menu-item-arrow",childEls:["itemEl","iconEl","textEl","arrowEl"],renderTpl:['<tpl if="plain">',"{text}","<tpl else>",'<a id="{id}-itemEl"',' class="'+Ext.baseCSSPrefix+'menu-item-link{childElCls}"',' href="{href}"','<tpl if="hrefTarget"> target="{hrefTarget}"</tpl>',' hidefocus="true"',' unselectable="on"','<tpl if="tabIndex">',' tabIndex="{tabIndex}"',"</tpl>",">",'<div role="img" id="{id}-iconEl" class="'+Ext.baseCSSPrefix+"menu-item-icon {iconCls}",'{childElCls} {glyphCls}" style="<tpl if="icon">background-image:url({icon});</tpl>','<tpl if="glyph && glyphFontFamily">font-family:{glyphFontFamily};</tpl>">','<tpl if="glyph">&#{glyph};</tpl>',"</div>",'<span id="{id}-textEl" class="'+Ext.baseCSSPrefix+'menu-item-text" unselectable="on">{text}</span>','<img id="{id}-arrowEl" src="{blank}" class="{arrowCls}','{childElCls}"/>',"</a>","</tpl>"],maskOnDisable:false,activate:function(){var a=this;if(!a.activated&&a.canActivate&&a.rendered&&!a.isDisabled()&&a.isVisible()){a.el.addCls(a.activeCls);a.focus();a.activated=true;a.fireEvent("activate",a)}},getFocusEl:function(){return this.itemEl},deactivate:function(){var a=this;if(a.activated){a.el.removeCls(a.activeCls);a.blur();a.hideMenu();a.activated=false;a.fireEvent("deactivate",a)}},deferHideMenu:function(){if(this.menu.isVisible()){this.menu.hide()}},cancelDeferHide:function(){clearTimeout(this.hideMenuTimer)},deferHideParentMenus:function(){var a;Ext.menu.Manager.hideAll();if(!Ext.Element.getActiveElement()){a=this.up(":not([hidden])");if(a){a.focus()}}},expandMenu:function(a){var b=this;if(b.menu){b.cancelDeferHide();if(a===0){b.doExpandMenu()}else{clearTimeout(b.expandMenuTimer);b.expandMenuTimer=Ext.defer(b.doExpandMenu,Ext.isNumber(a)?a:b.menuExpandDelay,b)}}},doExpandMenu:function(){var a=this,b=a.menu;if(a.activated&&(!b.rendered||!b.isVisible())){a.parentMenu.activeChild=b;b.parentItem=a;b.parentMenu=a.parentMenu;b.showBy(a,a.menuAlign)}},getRefItems:function(a){var c=this.menu,b;if(c){b=c.getRefItems(a);b.unshift(c)}return b||[]},hideMenu:function(a){var b=this;if(b.menu){clearTimeout(b.expandMenuTimer);b.hideMenuTimer=Ext.defer(b.deferHideMenu,Ext.isNumber(a)?a:b.menuHideDelay,b)}},initComponent:function(){var b=this,c=Ext.baseCSSPrefix,a=[c+"menu-item"],d;b.addEvents("activate","click","deactivate","textchange","iconchange");if(b.plain){a.push(c+"menu-item-plain")}if(b.cls){a.push(b.cls)}b.cls=a.join(" ");if(b.menu){d=b.menu;delete b.menu;b.setMenu(d)}b.callParent(arguments)},onClick:function(b){var a=this;if(!a.href){b.stopEvent()}if(a.disabled){return}if(a.hideOnClick){a.deferHideParentMenusTimer=Ext.defer(a.deferHideParentMenus,a.clickHideDelay,a)}Ext.callback(a.handler,a.scope||a,[a,b]);a.fireEvent("click",a,b);if(!a.hideOnClick){a.focus()}},onRemoved:function(){var a=this;if(a.activated&&a.parentMenu.activeItem===a){a.parentMenu.deactivateActiveItem()}a.callParent(arguments);a.parentMenu=a.ownerButton=null},beforeDestroy:function(){var a=this;if(a.rendered){a.clearTip()}a.callParent()},onDestroy:function(){var a=this;clearTimeout(a.expandMenuTimer);a.cancelDeferHide();clearTimeout(a.deferHideParentMenusTimer);a.setMenu(null);a.callParent(arguments)},beforeRender:function(){var d=this,h=Ext.BLANK_IMAGE_URL,c=d.glyph,g=Ext._glyphFontFamily,b,a,e;d.callParent();if(d.iconAlign==="right"){a=d.checkChangeDisabled?d.disabledCls:"";e=Ext.baseCSSPrefix+"menu-item-icon-right "+d.iconCls}else{a=(d.iconCls||"")+(d.checkChangeDisabled?" "+d.disabledCls:"");e=d.menu?d.arrowCls:""}if(typeof c==="string"){b=c.split("@");c=b[0];g=b[1]}Ext.applyIf(d.renderData,{href:d.href||"#",hrefTarget:d.hrefTarget,icon:d.icon,iconCls:a,glyph:c,glyphCls:c?Ext.baseCSSPrefix+"menu-item-glyph":undefined,glyphFontFamily:g,hasIcon:!!(d.icon||d.iconCls||c),iconAlign:d.iconAlign,plain:d.plain,text:d.text,arrowCls:e,blank:h,tabIndex:d.tabIndex})},onRender:function(){var a=this;a.callParent(arguments);if(a.tooltip){a.setTooltip(a.tooltip,true)}},setMenu:function(e,d){var c=this,b=c.menu,a=c.arrowEl;if(b){delete b.parentItem;delete b.parentMenu;delete b.ownerItem;if(d===true||(d!==false&&c.destroyMenu)){Ext.destroy(b)}}if(e){c.menu=Ext.menu.Manager.get(e);c.menu.ownerItem=c}else{c.menu=null}if(c.rendered&&!c.destroying&&a){a[c.menu?"addCls":"removeCls"](c.arrowCls)}},setHandler:function(b,a){this.handler=b||null;this.scope=a},setIcon:function(b){var a=this.iconEl,c=this.icon;if(a){a.src=b||Ext.BLANK_IMAGE_URL}this.icon=b;this.fireEvent("iconchange",this,c,b)},setIconCls:function(b){var d=this,a=d.iconEl,c=d.iconCls;if(a){if(d.iconCls){a.removeCls(d.iconCls)}if(b){a.addCls(b)}}d.iconCls=b;d.fireEvent("iconchange",d,c,b)},setText:function(d){var c=this,b=c.textEl||c.el,a=c.text;c.text=d;if(c.rendered){b.update(d||"");c.ownerCt.updateLayout()}c.fireEvent("textchange",c,a,d)},getTipAttr:function(){return this.tooltipType=="qtip"?"data-qtip":"title"},clearTip:function(){if(Ext.quickTipsActive&&Ext.isObject(this.tooltip)){Ext.tip.QuickTipManager.unregister(this.itemEl)}},setTooltip:function(c,a){var b=this;if(b.rendered){if(!a){b.clearTip()}if(Ext.quickTipsActive&&Ext.isObject(c)){Ext.tip.QuickTipManager.register(Ext.apply({target:b.itemEl.id},c));b.tooltip=c}else{b.itemEl.dom.setAttribute(b.getTipAttr(),c)}}else{b.tooltip=c}return b}});Ext.define("Ext.menu.CheckItem",{extend:Ext.menu.Item,alias:"widget.menucheckitem",checkedCls:Ext.baseCSSPrefix+"menu-item-checked",uncheckedCls:Ext.baseCSSPrefix+"menu-item-unchecked",groupCls:Ext.baseCSSPrefix+"menu-group-icon",hideOnClick:false,checkChangeDisabled:false,childEls:["itemEl","iconEl","textEl","checkEl"],showCheckbox:true,renderTpl:['<tpl if="plain">',"{text}","<tpl else>","{%var showCheckbox = values.showCheckbox,",'      rightCheckbox = showCheckbox && values.hasIcon && (values.iconAlign !== "left"), textCls = rightCheckbox ? "'+Ext.baseCSSPrefix+'right-check-item-text" : "";%}','<a id="{id}-itemEl" class="'+Ext.baseCSSPrefix+'menu-item-link{childElCls}" href="{href}" <tpl if="hrefTarget">target="{hrefTarget}"</tpl> hidefocus="true" unselectable="on"','<tpl if="tabIndex">',' tabIndex="{tabIndex}"',"</tpl>",">",'{%if (values.hasIcon && (values.iconAlign !== "left")) {%}','<div role="img" id="{id}-iconEl" class="'+Ext.baseCSSPrefix+"menu-item-icon {iconCls}",'{childElCls} {glyphCls}" style="<tpl if="icon">background-image:url({icon});</tpl>','<tpl if="glyph && glyphFontFamily">font-family:{glyphFontFamily};</tpl>">','<tpl if="glyph">&#{glyph};</tpl>',"</div>","{%} else if (showCheckbox){%}",'<img id="{id}-checkEl" src="{blank}" class="'+Ext.baseCSSPrefix+'menu-item-icon{childElCls}" />',"{%}%}",'<span id="{id}-textEl" class="'+Ext.baseCSSPrefix+'menu-item-text {[textCls]}{childElCls}" <tpl if="arrowCls">style="margin-right: 17px;"</tpl> >{text}</span>',"{%if (rightCheckbox) {%}",'<img id="{id}-checkEl" src="{blank}" class="'+Ext.baseCSSPrefix+'menu-item-icon-right{childElCls}" />',"{%} else if (values.arrowCls) {%}",'<img id="{id}-arrowEl" src="{blank}" class="{arrowCls}{childElCls}"/>',"{%}%}","</a>","</tpl>"],initComponent:function(){var a=this;a.checked=!!a.checked;a.addEvents("beforecheckchange","checkchange");a.callParent(arguments);Ext.menu.Manager.registerCheckable(a);if(a.group){if(!(a.iconCls||a.icon||a.glyph)){a.iconCls=a.groupCls}if(a.initialConfig.hideOnClick!==false){a.hideOnClick=true}}},beforeRender:function(){this.callParent();this.renderData.showCheckbox=this.showCheckbox},afterRender:function(){var a=this;a.callParent();a.checked=!a.checked;a.setChecked(!a.checked,true);if(a.checkChangeDisabled){a.disableCheckChange()}},disableCheckChange:function(){var b=this,a=b.checkEl;if(a){a.addCls(b.disabledCls)}if(!(Ext.isIE10p||(Ext.isIE9&&Ext.isStrict))&&b.rendered){b.el.repaint()}b.checkChangeDisabled=true},enableCheckChange:function(){var b=this,a=b.checkEl;if(a){a.removeCls(b.disabledCls)}b.checkChangeDisabled=false},onClick:function(b){var a=this;if(!a.disabled&&!a.checkChangeDisabled&&!(a.checked&&a.group)){a.setChecked(!a.checked)}this.callParent([b])},onDestroy:function(){Ext.menu.Manager.unregisterCheckable(this);this.callParent(arguments)},setChecked:function(c,a){var b=this;if(b.checked!==c&&(a||b.fireEvent("beforecheckchange",b,c)!==false)){if(b.el){b.el[c?"addCls":"removeCls"](b.checkedCls)[!c?"addCls":"removeCls"](b.uncheckedCls)}b.checked=c;Ext.menu.Manager.onCheckChange(b,c);if(!a){Ext.callback(b.checkHandler,b.scope,[b,c]);b.fireEvent("checkchange",b,c)}}}});Ext.define("Ext.menu.KeyNav",{extend:Ext.util.KeyNav,constructor:function(a){var b=this;b.menu=a.target;b.callParent([Ext.apply({down:b.down,enter:b.enter,esc:b.escape,left:b.left,right:b.right,space:b.enter,tab:b.tab,up:b.up},a)])},down:function(b){var a=this,c=a.menu.focusedItem;if(c&&b.getKey()==Ext.EventObject.DOWN&&a.isWhitelisted(c)){return true}a.focusNextItem(1)},enter:function(b){var c=this.menu,a=c.focusedItem;if(c.activeItem){c.onClick(b)}else{if(a&&a.isFormField){return true}}},escape:function(a){Ext.menu.Manager.hideAll()},focusNextItem:function(b){var a=this.menu,e=a.items,h=a.focusedItem,g=h?e.indexOf(h):-1,i=g+b,d=e.length,c=0,j;while(c<d&&i!==g){if(i<0){i=d-1}else{if(i>=d){i=0}}j=e.getAt(i);if(a.canActivateItem(j)){a.setActiveItem(j);break}i+=b;++c}},isWhitelisted:function(a){return Ext.FocusManager.isWhitelisted(a)},left:function(a){var b=this.menu,c=b.focusedItem;if(c&&this.isWhitelisted(c)){return true}b.hide();if(b.parentMenu){b.parentMenu.focus()}},right:function(c){var d=this.menu,g=d.focusedItem,a=d.activeItem,b;if(g&&this.isWhitelisted(g)){return true}if(a){b=d.activeItem.menu;if(b){a.expandMenu(0);b.setActiveItem(b.child(":focusable"))}}},tab:function(b){var a=this;if(b.shiftKey){a.up(b)}else{a.down(b)}},up:function(b){var a=this,c=a.menu.focusedItem;if(c&&b.getKey()==Ext.EventObject.UP&&a.isWhitelisted(c)){return true}a.focusNextItem(-1)}});Ext.define("Ext.menu.Separator",{extend:Ext.menu.Item,alias:"widget.menuseparator",canActivate:false,focusable:false,hideOnClick:false,plain:true,separatorCls:Ext.baseCSSPrefix+"menu-item-separator",text:"&#160;",beforeRender:function(a,c){var b=this;b.callParent();b.addCls(b.separatorCls)}});Ext.define("Ext.menu.Menu",{extend:Ext.panel.Panel,alias:"widget.menu",enableKeyNav:true,allowOtherMenus:false,ariaRole:"menu",floating:true,constrain:true,hidden:true,hideMode:"visibility",ignoreParentClicks:false,isMenu:true,showSeparator:true,minWidth:undefined,defaultMinWidth:120,initComponent:function(){var b=this,d=Ext.baseCSSPrefix,a=[d+"menu"],c=b.bodyCls?[b.bodyCls]:[],e=b.floating!==false;b.addEvents("click","mouseenter","mouseleave","mouseover");Ext.menu.Manager.register(b);if(b.plain){a.push(d+"menu-plain")}b.cls=a.join(" ");c.push(d+"menu-body",Ext.dom.Element.unselectableCls);b.bodyCls=c.join(" ");if(!b.layout){b.layout={type:"vbox",align:"stretchmax",overflowHandler:"Scroller"}}if(e){if(b.minWidth===undefined){b.minWidth=b.defaultMinWidth}}else{b.hidden=!!b.initialConfig.hidden}b.callParent(arguments)},registerWithOwnerCt:function(){if(this.floating){this.ownerCt=null;Ext.WindowManager.register(this)}},initHierarchyEvents:Ext.emptyFn,isVisible:function(){return this.callParent()},getHierarchyState:function(){var a=this.callParent();a.hidden=this.hidden;return a},beforeRender:function(){this.callParent(arguments);if(!this.getSizeModel().width.shrinkWrap){this.layout.align="stretch"}},onBoxReady:function(){var a=this;a.callParent(arguments);if(a.showSeparator){a.iconSepEl=a.layout.getElementTarget().insertFirst({cls:Ext.baseCSSPrefix+"menu-icon-separator",html:"&#160;"})}a.mon(a.el,{click:a.onClick,mouseover:a.onMouseOver,scope:a});a.mouseMonitor=a.el.monitorMouseLeave(100,a.onMouseLeave,a);if(a.enableKeyNav){a.keyNav=new Ext.menu.KeyNav({target:a,keyMap:a.getKeyMap()})}},getRefOwner:function(){return this.parentMenu||this.ownerButton||this.callParent(arguments)},canActivateItem:function(a){return a&&!a.isDisabled()&&a.isVisible()&&(a.canActivate||a.getXTypes().indexOf("menuitem")<0)},deactivateActiveItem:function(b){var c=this,d=c.activeItem,a=c.focusedItem;if(d){d.deactivate();if(!d.activated){delete c.activeItem}}if(a&&b){a.blur();delete c.focusedItem}},getFocusEl:function(){return this.focusedItem||this.el},hide:function(){this.deactivateActiveItem(true);this.callParent(arguments)},getItemFromEvent:function(a){return this.getChildByElement(a.getTarget())},lookupComponent:function(b){var a=this;if(typeof b=="string"){b=a.lookupItemFromString(b)}else{if(Ext.isObject(b)){b=a.lookupItemFromObject(b)}}b.minWidth=b.minWidth||a.minWidth;return b},lookupItemFromObject:function(c){var b=this,d=Ext.baseCSSPrefix,a;if(!c.isComponent){if(!c.xtype){c=Ext.create("Ext.menu."+(Ext.isBoolean(c.checked)?"Check":"")+"Item",c)}else{c=Ext.ComponentManager.create(c,c.xtype)}}if(c.isMenuItem){c.parentMenu=b}if(!c.isMenuItem&&!c.dock){a=[d+"menu-item-cmp"];if(!b.plain&&(c.indent!==false||c.iconCls==="no-icon")){a.push(d+"menu-item-indent")}if(c.rendered){c.el.addCls(a)}else{c.cls=(c.cls||"")+" "+a.join(" ")}}return c},lookupItemFromString:function(a){return(a=="separator"||a=="-")?new Ext.menu.Separator():new Ext.menu.Item({canActivate:false,hideOnClick:false,plain:true,text:a})},onClick:function(c){var b=this,a;if(b.disabled){c.stopEvent();return}a=(c.type==="click")?b.getItemFromEvent(c):b.activeItem;if(a&&a.isMenuItem){if(!a.menu||!b.ignoreParentClicks){a.onClick(c)}else{c.stopEvent()}}if(!a||a.disabled){a=undefined}b.fireEvent("click",b,a,c)},onDestroy:function(){var a=this;Ext.menu.Manager.unregister(a);a.parentMenu=a.ownerButton=null;if(a.rendered){a.el.un(a.mouseMonitor);Ext.destroy(a.keyNav);a.keyNav=null}a.callParent(arguments)},onMouseLeave:function(b){var a=this;a.deactivateActiveItem();if(a.disabled){return}a.fireEvent("mouseleave",a,b)},onMouseOver:function(h){var g=this,i=h.getRelatedTarget(),b=!g.el.contains(i),d=g.getItemFromEvent(h),c=g.parentMenu,a=g.parentItem;if(b&&c){c.setActiveItem(a);a.cancelDeferHide();c.mouseMonitor.mouseenter()}if(g.disabled){return}if(d&&!d.activated){g.setActiveItem(d);if(d.activated&&d.expandMenu){d.expandMenu()}}if(b){g.fireEvent("mouseenter",g,h)}g.fireEvent("mouseover",g,d,h)},setActiveItem:function(b){var a=this;if(b&&(b!=a.activeItem)){a.deactivateActiveItem();if(a.canActivateItem(b)){if(b.activate){b.activate();if(b.activated){a.activeItem=b;a.focusedItem=b;a.focus()}}else{b.focus();a.focusedItem=b}}b.el.scrollIntoView(a.layout.getRenderTarget())}},showBy:function(b,d,c){var a=this;a.callParent(arguments);if(!a.hidden){a.setVerticalPosition()}return a},show:function(){var c=this,b,a,d=c.maxHeight;if(!c.rendered){c.doAutoRender()}if(c.floating){b=c.el.parent();a=b.getViewSize().height;c.maxHeight=Math.min(d||a,a)}c.callParent(arguments);c.maxHeight=d;return c},setVerticalPosition:function(){var d=this,g,e=d.getY(),h=e,j=d.getHeight(),b=Ext.Element.getViewportHeight().height,c=d.el.parent(),a=c.getViewSize().height,i=e-c.getScroll().top;c=null;if(d.floating){g=d.maxHeight?d.maxHeight:a-i;if(j>a){h=e-i}else{if(g<j){h=e-(j-g)}else{if((e+j)>b){h=b-j}}}}d.setY(h)}});Ext.define("Ext.panel.Tool",{extend:Ext.Component,alias:"widget.tool",isTool:true,baseCls:Ext.baseCSSPrefix+"tool",disabledCls:Ext.baseCSSPrefix+"tool-disabled",toolPressedCls:Ext.baseCSSPrefix+"tool-pressed",toolOverCls:Ext.baseCSSPrefix+"tool-over",ariaRole:"button",childEls:["toolEl"],renderTpl:['<img id="{id}-toolEl" src="{blank}" class="{baseCls}-img {baseCls}-{type}{childElCls}" role="presentation"/>'],tooltipType:"qtip",stopEvent:true,height:15,width:15,initComponent:function(){var a=this;a.addEvents("click");a.type=a.type||a.id;Ext.applyIf(a.renderData,{baseCls:a.baseCls,blank:Ext.BLANK_IMAGE_URL,type:a.type});a.tooltip=a.tooltip||a.qtip;a.callParent()},afterRender:function(){var b=this,a;b.callParent(arguments);b.el.on({click:b.onClick,mousedown:b.onMouseDown,mouseover:b.onMouseOver,mouseout:b.onMouseOut,scope:b});if(b.tooltip){if(Ext.quickTipsActive&&Ext.isObject(b.tooltip)){Ext.tip.QuickTipManager.register(Ext.apply({target:b.id},b.tooltip))}else{a=b.tooltipType=="qtip"?"data-qtip":"title";b.el.dom.setAttribute(a,b.tooltip)}}},getFocusEl:function(){return this.el},setType:function(a){var b=this,c=b.type;b.type=a;if(b.rendered){if(c){b.toolEl.removeCls(b.baseCls+"-"+c)}b.toolEl.addCls(b.baseCls+"-"+a)}else{b.renderData.type=a}return b},onClick:function(c,b){var a=this;if(a.disabled){return false}a.el.removeCls(a.toolPressedCls);a.el.removeCls(a.toolOverCls);if(a.stopEvent!==false){c.stopEvent()}Ext.callback(a.handler,a.scope||a,[c,b,a.ownerCt,a]);a.fireEvent("click",a,c);return true},onDestroy:function(){if(Ext.quickTipsActive&&Ext.isObject(this.tooltip)){Ext.tip.QuickTipManager.unregister(this.id)}this.callParent()},onMouseDown:function(){if(this.disabled){return false}this.el.addCls(this.toolPressedCls)},onMouseOver:function(){if(this.disabled){return false}this.el.addCls(this.toolOverCls)},onMouseOut:function(){this.el.removeCls(this.toolOverCls)}});Ext.define("Ext.resizer.ResizeTracker",{extend:Ext.dd.DragTracker,dynamic:true,preserveRatio:false,constrainTo:null,proxyCls:Ext.baseCSSPrefix+"resizable-proxy",constructor:function(b){var d=this,c,a,e;if(!b.el){if(b.target.isComponent){d.el=b.target.getEl()}else{d.el=b.target}}this.callParent(arguments);if(d.preserveRatio&&d.minWidth&&d.minHeight){c=d.minWidth/d.el.getWidth();a=d.minHeight/d.el.getHeight();if(a>c){d.minWidth=d.el.getWidth()*a}else{d.minHeight=d.el.getHeight()*c}}if(d.throttle){e=Ext.Function.createThrottled(function(){Ext.resizer.ResizeTracker.prototype.resize.apply(d,arguments)},d.throttle);d.resize=function(h,i,g){if(g){Ext.resizer.ResizeTracker.prototype.resize.apply(d,arguments)}else{e.apply(null,arguments)}}}},onBeforeStart:function(a){this.startBox=this.target.getBox()},getDynamicTarget:function(){var a=this,b=a.target;if(a.dynamic){return b}else{if(!a.proxy){a.proxy=a.createProxy(b)}}a.proxy.show();return a.proxy},createProxy:function(c){var b,a=this.proxyCls;if(c.isComponent){b=c.getProxy().addCls(a)}else{b=c.createProxy({tag:"div",cls:a,id:c.id+"-rzproxy"},Ext.getBody())}b.removeCls(Ext.baseCSSPrefix+"proxy-el");return b},onStart:function(a){this.activeResizeHandle=Ext.get(this.getDragTarget().id);if(!this.dynamic){this.resize(this.startBox,{horizontal:"none",vertical:"none"})}},onDrag:function(a){if(this.dynamic||this.proxy){this.updateDimensions(a)}},updateDimensions:function(s,m){var t=this,c=t.activeResizeHandle.region,g=t.getOffset(t.constrainTo?"dragTarget":null),k=t.startBox,h,p=0,u=0,j,q,a=0,w=0,v,n=g[0]<0?"right":"left",r=g[1]<0?"down":"up",i,b,d,o,l;c=t.convertRegionName(c);switch(c){case"south":u=g[1];b=2;break;case"north":u=-g[1];w=-u;b=2;break;case"east":p=g[0];b=1;break;case"west":p=-g[0];a=-p;b=1;break;case"northeast":u=-g[1];w=-u;p=g[0];i=[k.x,k.y+k.height];b=3;break;case"southeast":u=g[1];p=g[0];i=[k.x,k.y];b=3;break;case"southwest":p=-g[0];a=-p;u=g[1];i=[k.x+k.width,k.y];b=3;break;case"northwest":u=-g[1];w=-u;p=-g[0];a=-p;i=[k.x+k.width,k.y+k.height];b=3;break}d={width:k.width+p,height:k.height+u,x:k.x+a,y:k.y+w};j=Ext.Number.snap(d.width,t.widthIncrement);q=Ext.Number.snap(d.height,t.heightIncrement);if(j!=d.width||q!=d.height){switch(c){case"northeast":d.y-=q-d.height;break;case"north":d.y-=q-d.height;break;case"southwest":d.x-=j-d.width;break;case"west":d.x-=j-d.width;break;case"northwest":d.x-=j-d.width;d.y-=q-d.height}d.width=j;d.height=q}if(d.width<t.minWidth||d.width>t.maxWidth){d.width=Ext.Number.constrain(d.width,t.minWidth,t.maxWidth);if(a){d.x=k.x+(k.width-d.width)}}else{t.lastX=d.x}if(d.height<t.minHeight||d.height>t.maxHeight){d.height=Ext.Number.constrain(d.height,t.minHeight,t.maxHeight);if(w){d.y=k.y+(k.height-d.height)}}else{t.lastY=d.y}if(t.preserveRatio||s.shiftKey){h=t.startBox.width/t.startBox.height;o=Math.min(Math.max(t.minHeight,d.width/h),t.maxHeight);l=Math.min(Math.max(t.minWidth,d.height*h),t.maxWidth);if(b==1){d.height=o}else{if(b==2){d.width=l}else{v=Math.abs(i[0]-this.lastXY[0])/Math.abs(i[1]-this.lastXY[1]);if(v>h){d.height=o}else{d.width=l}if(c=="northeast"){d.y=k.y-(d.height-k.height)}else{if(c=="northwest"){d.y=k.y-(d.height-k.height);d.x=k.x-(d.width-k.width)}else{if(c=="southwest"){d.x=k.x-(d.width-k.width)}}}}}}if(u===0){r="none"}if(p===0){n="none"}t.resize(d,{horizontal:n,vertical:r},m)},getResizeTarget:function(a){return a?this.target:this.getDynamicTarget()},resize:function(c,e,a){var b=this,d=b.getResizeTarget(a);d.setBox(c);if(b.originalTarget&&(b.dynamic||a)){b.originalTarget.setBox(c)}},onEnd:function(a){this.updateDimensions(a,true);if(this.proxy){this.proxy.hide()}},convertRegionName:function(a){return a}});Ext.define("Ext.resizer.Resizer",{mixins:{observable:Ext.util.Observable},alternateClassName:"Ext.Resizable",handleCls:Ext.baseCSSPrefix+"resizable-handle",pinnedCls:Ext.baseCSSPrefix+"resizable-pinned",overCls:Ext.baseCSSPrefix+"resizable-over",wrapCls:Ext.baseCSSPrefix+"resizable-wrap",delimiterRe:/(?:\s*[,;]\s*)|\s+/,dynamic:true,handles:"s e se",height:null,width:null,heightIncrement:0,widthIncrement:0,minHeight:20,minWidth:20,maxHeight:10000,maxWidth:10000,pinned:false,preserveRatio:false,transparent:false,possiblePositions:{n:"north",s:"south",e:"east",w:"west",se:"southeast",sw:"southwest",nw:"northwest",ne:"northeast"},constructor:function(b){var m=this,j,q,s,r=m.handles,c,p,g,d=0,o,n=[],h,a,e,l,k=Ext.dom.Element.unselectableCls;m.addEvents("beforeresize","resizedrag","resize");if(Ext.isString(b)||Ext.isElement(b)||b.dom){j=b;b=arguments[1]||{};b.target=j}m.mixins.observable.constructor.call(m,b);j=m.target;if(j){if(j.isComponent){j.addClsWithUI("resizable");m.el=j.getEl();if(j.minWidth){m.minWidth=j.minWidth}if(j.minHeight){m.minHeight=j.minHeight}if(j.maxWidth){m.maxWidth=j.maxWidth}if(j.maxHeight){m.maxHeight=j.maxHeight}if(j.floating){if(!m.hasOwnProperty("handles")){m.handles="n ne e se s sw w nw"}}}else{m.el=m.target=Ext.get(j)}}else{m.target=m.el=Ext.get(m.el)}s=m.el.dom.tagName.toUpperCase();if(s=="TEXTAREA"||s=="IMG"||s=="TABLE"){m.originalTarget=m.target;q=m.el;e=q.getBox();m.target=m.el=m.el.wrap({cls:m.wrapCls,id:m.el.id+"-rzwrap",style:q.getStyles("margin-top","margin-bottom")});m.el.setPositioning(q.getPositioning());q.clearPositioning();m.el.setBox(e);q.setStyle("position","absolute")}m.el.position();if(m.pinned){m.el.addCls(m.pinnedCls)}m.resizeTracker=new Ext.resizer.ResizeTracker({disabled:m.disabled,target:m.target,constrainTo:m.constrainTo,overCls:m.overCls,throttle:m.throttle,originalTarget:m.originalTarget,delegate:"."+m.handleCls,dynamic:m.dynamic,preserveRatio:m.preserveRatio,heightIncrement:m.heightIncrement,widthIncrement:m.widthIncrement,minHeight:m.minHeight,maxHeight:m.maxHeight,minWidth:m.minWidth,maxWidth:m.maxWidth});m.resizeTracker.on({mousedown:m.onBeforeResize,drag:m.onResize,dragend:m.onResizeEnd,scope:m});if(m.handles=="all"){m.handles="n s e w ne nw se sw"}r=m.handles=m.handles.split(m.delimiterRe);p=m.possiblePositions;g=r.length;c=m.handleCls+" "+m.handleCls+"-{0}";if(m.target.isComponent){l=m.target.baseCls;c+=" "+l+"-handle "+l+"-handle-{0}";if(Ext.supports.CSS3BorderRadius){c+=" "+l+"-handle-{0}-br"}}h=Ext.isIE6?' style="height:'+m.el.getHeight()+'px"':"";for(;d<g;d++){if(r[d]&&p[r[d]]){o=p[r[d]];if(o==="east"||o==="west"){a=h}else{a=""}n.push('<div id="',m.el.id,"-",o,'-handle"',' class="',Ext.String.format(c,o)," ",k,'"',' unselectable="on"',a,"></div>")}}Ext.DomHelper.append(m.el,n.join(""));for(d=0;d<g;d++){if(r[d]&&p[r[d]]){o=p[r[d]];m[o]=m.el.getById(m.el.id+"-"+o+"-handle");m[o].region=o;if(m.transparent){m[o].setOpacity(0)}}}if(Ext.isNumber(m.width)){m.width=Ext.Number.constrain(m.width,m.minWidth,m.maxWidth)}if(Ext.isNumber(m.height)){m.height=Ext.Number.constrain(m.height,m.minHeight,m.maxHeight)}if(m.width!==null||m.height!==null){if(m.originalTarget){m.originalTarget.setWidth(m.width);m.originalTarget.setHeight(m.height)}m.resizeTo(m.width,m.height)}m.forceHandlesHeight()},disable:function(){this.resizeTracker.disable()},enable:function(){this.resizeTracker.enable()},onBeforeResize:function(b,c){var a=this.el.getBox();return this.fireEvent("beforeresize",this,a.width,a.height,c)},onResize:function(c,d){var b=this,a=b.el.getBox();b.forceHandlesHeight();return b.fireEvent("resizedrag",b,a.width,a.height,d)},onResizeEnd:function(c,d){var b=this,a=b.el.getBox();b.forceHandlesHeight();return b.fireEvent("resize",b,a.width,a.height,d)},resizeTo:function(b,a){var c=this;c.target.setSize(b,a);c.fireEvent("resize",c,b,a,null)},getEl:function(){return this.el},getTarget:function(){return this.target},destroy:function(){var e=this,d,c=e.handles,a=c.length,b=e.possiblePositions,g;e.resizeTracker.destroy();for(d=0;d<a;d++){if(g=e[b[c[d]]]){g.remove()}}},forceHandlesHeight:function(){var a=this,b;if(Ext.isIE6){b=a.east;if(b){b.setHeight(a.el.getHeight())}b=a.west;if(b){b.setHeight(a.el.getHeight())}a.el.repaint()}}});Ext.define("Ext.util.Point",{extend:Ext.util.Region,statics:{fromEvent:function(a){a=a.browserEvent||a;a=(a.changedTouches&&a.changedTouches.length>0)?a.changedTouches[0]:a;return new this(a.pageX,a.pageY)}},constructor:function(a,b){this.callParent([b,a,b,a])},toString:function(){return"Point["+this.x+","+this.y+"]"},equals:function(a){return(this.x==a.x&&this.y==a.y)},isWithin:function(b,a){if(!Ext.isObject(a)){a={x:a,y:a}}return(this.x<=b.x+a.x&&this.x>=b.x-a.x&&this.y<=b.y+a.y&&this.y>=b.y-a.y)},isContainedBy:function(a){if(!(a instanceof Ext.util.Region)){a=Ext.get(a.el||a).getRegion()}return a.contains(this)},roundedEquals:function(a){return(Math.round(this.x)==Math.round(a.x)&&Math.round(this.y)==Math.round(a.y))}},function(){this.prototype.translate=Ext.util.Region.prototype.translateBy});Ext.define("Ext.util.Cookies",{singleton:true,set:function(c,e){var a=arguments,i=arguments.length,b=(i>2)?a[2]:null,h=(i>3)?a[3]:"/",d=(i>4)?a[4]:null,g=(i>5)?a[5]:false;document.cookie=c+"="+escape(e)+((b===null)?"":("; expires="+b.toGMTString()))+((h===null)?"":("; path="+h))+((d===null)?"":("; domain="+d))+((g===true)?"; secure":"")},get:function(d){var b=d+"=",g=b.length,a=document.cookie.length,e=0,c=0;while(e<a){c=e+g;if(document.cookie.substring(e,c)==b){return this.getCookieVal(c)}e=document.cookie.indexOf(" ",e)+1;if(e===0){break}}return null},clear:function(a,b){if(this.get(a)){b=b||"/";document.cookie=a+"=; expires=Thu, 01-Jan-70 00:00:01 GMT; path="+b}},getCookieVal:function(b){var a=document.cookie.indexOf(";",b);if(a==-1){a=document.cookie.length}return unescape(document.cookie.substring(b,a))}});Ext.define("Ext.util.Grouper",{extend:Ext.util.Sorter,isGrouper:true,getGroupString:function(a){return a.get(this.property)}});Ext.define("Ext.util.History",{singleton:true,alternateClassName:"Ext.History",mixins:{observable:Ext.util.Observable},useTopWindow:true,fieldId:Ext.baseCSSPrefix+"history-field",iframeId:Ext.baseCSSPrefix+"history-frame",constructor:function(){var a=this;a.oldIEMode=Ext.isIE7m||!Ext.isStrict&&Ext.isIE8;a.iframe=null;a.hiddenField=null;a.ready=false;a.currentToken=null;a.mixins.observable.constructor.call(a)},getHash:function(){var a=window.location.href,b=a.indexOf("#");return b>=0?a.substr(b+1):null},setHash:function(d){var a=this,c=a.useTopWindow?window.top:window;try{c.location.hash=d}catch(b){}},doSave:function(){this.hiddenField.value=this.currentToken},handleStateChange:function(a){this.currentToken=a;this.fireEvent("change",a)},updateIFrame:function(b){var a='<html><body><div id="state">'+Ext.util.Format.htmlEncode(b)+"</div></body></html>",d;try{d=this.iframe.contentWindow.document;d.open();d.write(a);d.close();return true}catch(c){return false}},checkIFrame:function(){var d=this,b=d.iframe.contentWindow,e,c,a,g;if(!b||!b.document){Ext.Function.defer(this.checkIFrame,10,this);return}e=b.document;c=e.getElementById("state");a=c?c.innerText:null;g=d.getHash();Ext.TaskManager.start({run:function(){var k=b.document,j=k.getElementById("state"),h=j?j.innerText:null,i=d.getHash();if(h!==a){a=h;d.handleStateChange(h);d.setHash(h);g=h;d.doSave()}else{if(i!==g){g=i;d.updateIFrame(i)}}},interval:50,scope:d});d.ready=true;d.fireEvent("ready",d)},startUp:function(){var a=this,b;a.currentToken=a.hiddenField.value||this.getHash();if(a.oldIEMode){a.checkIFrame()}else{b=a.getHash();Ext.TaskManager.start({run:function(){var c=a.getHash();if(c!==b){b=c;a.handleStateChange(b);a.doSave()}},interval:50,scope:a});a.ready=true;a.fireEvent("ready",a)}},init:function(d,b){var c=this,a=Ext.DomHelper;if(c.ready){Ext.callback(d,b,[c]);return}if(!Ext.isReady){Ext.onReady(function(){c.init(d,b)});return}c.hiddenField=Ext.getDom(c.fieldId);if(!c.hiddenField){c.hiddenField=Ext.getBody().createChild({id:Ext.id(),tag:"form",cls:Ext.baseCSSPrefix+"hide-display",children:[{tag:"input",type:"hidden",id:c.fieldId}]},false,true).firstChild}if(c.oldIEMode){c.iframe=Ext.getDom(c.iframeId);if(!c.iframe){c.iframe=a.append(c.hiddenField.parentNode,{tag:"iframe",id:c.iframeId,src:Ext.SSL_SECURE_URL})}}c.addEvents("ready","change");if(d){c.on("ready",d,b,{single:true})}c.startUp()},add:function(a,c){var b=this;if(c!==false){if(b.getToken()===a){return true}}if(b.oldIEMode){return b.updateIFrame(a)}else{b.setHash(a);return true}},back:function(){window.history.go(-1)},forward:function(){window.history.go(1)},getToken:function(){return this.ready?this.currentToken:this.getHash()}});Ext.ns("Ext.tip");Ext.USE_NATIVE_JSON=true;
!function(e,t){e.ResizeObserver=t()}(this,(function(){"use strict";var e=function(){if("undefined"!=typeof Map)return Map;function e(e,t){var r=-1;return e.some((function(e,n){return e[0]===t&&(r=n,!0)})),r}return function(){function t(){this.__entries__=[]}var r={size:{configurable:!0}};return r.size.get=function(){return this.__entries__.length},t.prototype.get=function(t){var r=e(this.__entries__,t),n=this.__entries__[r];return n&&n[1]},t.prototype.set=function(t,r){var n=e(this.__entries__,t);~n?this.__entries__[n][1]=r:this.__entries__.push([t,r])},t.prototype.delete=function(t){var r=this.__entries__,n=e(r,t);~n&&r.splice(n,1)},t.prototype.has=function(t){return!!~e(this.__entries__,t)},t.prototype.clear=function(){this.__entries__.splice(0)},t.prototype.forEach=function(e,t){void 0===t&&(t=null);for(var r=0,n=this.__entries__;r<n.length;r+=1){var i=n[r];e.call(t,i[1],i[0])}},Object.defineProperties(t.prototype,r),t}()}(),t="undefined"!=typeof window&&"undefined"!=typeof document&&window.document===document,r="undefined"!=typeof global&&global.Math===Math?global:"undefined"!=typeof self&&self.Math===Math?self:"undefined"!=typeof window&&window.Math===Math?window:Function("return this")(),n="function"==typeof requestAnimationFrame?requestAnimationFrame.bind(r):function(e){return setTimeout((function(){return e(Date.now())}),1e3/60)},i=["top","right","bottom","left","width","height","size","weight"],a="undefined"!=typeof MutationObserver,s=function(){this.connected_=!1,this.mutationEventsAdded_=!1,this.mutationsObserver_=null,this.observers_=[],this.onTransitionEnd_=this.onTransitionEnd_.bind(this),this.refresh=function(e,t){var r=!1,i=!1,a=0;function s(){r&&(r=!1,e()),i&&l()}function o(){n(s)}function l(){var e=Date.now();if(r){if(e-a<2)return;i=!0}else r=!0,i=!1,setTimeout(o,t);a=e}return l}(this.refresh.bind(this),20)};s.prototype.addObserver=function(e){~this.observers_.indexOf(e)||this.observers_.push(e),this.connected_||this.connect_()},s.prototype.removeObserver=function(e){var t=this.observers_,r=t.indexOf(e);~r&&t.splice(r,1),!t.length&&this.connected_&&this.disconnect_()},s.prototype.refresh=function(){this.updateObservers_()&&this.refresh()},s.prototype.updateObservers_=function(){var e=this.observers_.filter((function(e){return e.gatherActive(),e.hasActive()}));return e.forEach((function(e){return e.broadcastActive()})),e.length>0},s.prototype.connect_=function(){t&&!this.connected_&&(document.addEventListener("transitionend",this.onTransitionEnd_),window.addEventListener("resize",this.refresh),a?(this.mutationsObserver_=new MutationObserver(this.refresh),this.mutationsObserver_.observe(document,{attributes:!0,childList:!0,characterData:!0,subtree:!0})):(document.addEventListener("DOMSubtreeModified",this.refresh),this.mutationEventsAdded_=!0),this.connected_=!0)},s.prototype.disconnect_=function(){t&&this.connected_&&(document.removeEventListener("transitionend",this.onTransitionEnd_),window.removeEventListener("resize",this.refresh),this.mutationsObserver_&&this.mutationsObserver_.disconnect(),this.mutationEventsAdded_&&document.removeEventListener("DOMSubtreeModified",this.refresh),this.mutationsObserver_=null,this.mutationEventsAdded_=!1,this.connected_=!1)},s.prototype.onTransitionEnd_=function(e){var t=e.propertyName;void 0===t&&(t=""),i.some((function(e){return!!~t.indexOf(e)}))&&this.refresh()},s.getInstance=function(){return this.instance_||(this.instance_=new s),this.instance_},s.instance_=null;var o=function(e,t){for(var r=0,n=Object.keys(t);r<n.length;r+=1){var i=n[r];Object.defineProperty(e,i,{value:t[i],enumerable:!1,writable:!1,configurable:!0})}return e},l=function(e){return e&&e.ownerDocument&&e.ownerDocument.defaultView||r},c=m(0,0,0,0);function u(e){return parseFloat(e)||0}function h(e){for(var t=[],r=arguments.length-1;r-- >0;)t[r]=arguments[r+1];return t.reduce((function(t,r){return t+u(e["border-"+r+"-width"])}),0)}function f(e){var t=e.clientWidth,r=e.clientHeight;if(!t&&!r)return c;var n=l(e).getComputedStyle(e),i=function(e){for(var t={},r=0,n=["top","right","bottom","left"];r<n.length;r+=1){var i=n[r],a=e["padding-"+i];t[i]=u(a)}return t}(n),a=i.left+i.right,s=i.top+i.bottom,o=u(n.width),f=u(n.height);if("border-box"===n.boxSizing&&(Math.round(o+a)!==t&&(o-=h(n,"left","right")+a),Math.round(f+s)!==r&&(f-=h(n,"top","bottom")+s)),!function(e){return e===l(e).document.documentElement}(e)){var d=Math.round(o+a)-t,p=Math.round(f+s)-r;1!==Math.abs(d)&&(o-=d),1!==Math.abs(p)&&(f-=p)}return m(i.left,i.top,o,f)}var d="undefined"!=typeof SVGGraphicsElement?function(e){return e instanceof l(e).SVGGraphicsElement}:function(e){return e instanceof l(e).SVGElement&&"function"==typeof e.getBBox};function p(e){return t?d(e)?function(e){var t=e.getBBox();return m(0,0,t.width,t.height)}(e):f(e):c}function m(e,t,r,n){return{x:e,y:t,width:r,height:n}}var g=function(e){this.broadcastWidth=0,this.broadcastHeight=0,this.contentRect_=m(0,0,0,0),this.target=e};g.prototype.isActive=function(){var e=p(this.target);return this.contentRect_=e,e.width!==this.broadcastWidth||e.height!==this.broadcastHeight},g.prototype.broadcastRect=function(){var e=this.contentRect_;return this.broadcastWidth=e.width,this.broadcastHeight=e.height,e};var T=function(e,t){var r,n,i,a,s,l,c,u=(n=(r=t).x,i=r.y,a=r.width,s=r.height,l="undefined"!=typeof DOMRectReadOnly?DOMRectReadOnly:Object,c=Object.create(l.prototype),o(c,{x:n,y:i,width:a,height:s,top:i,right:n+a,bottom:s+i,left:n}),c);o(this,{target:e,contentRect:u})},y=function(t,r,n){if(this.activeObservations_=[],this.observations_=new e,"function"!=typeof t)throw new TypeError("The callback provided as parameter 1 is not a function.");this.callback_=t,this.controller_=r,this.callbackCtx_=n};y.prototype.observe=function(e){if(!arguments.length)throw new TypeError("1 argument required, but only 0 present.");if("undefined"!=typeof Element&&Element instanceof Object){if(!(e instanceof l(e).Element))throw new TypeError("parameter 1 is not of type 'Element'.");var t=this.observations_;t.has(e)||(t.set(e,new g(e)),this.controller_.addObserver(this),this.controller_.refresh())}},y.prototype.unobserve=function(e){if(!arguments.length)throw new TypeError("1 argument required, but only 0 present.");if("undefined"!=typeof Element&&Element instanceof Object){if(!(e instanceof l(e).Element))throw new TypeError("parameter 1 is not of type 'Element'.");var t=this.observations_;t.has(e)&&(t.delete(e),t.size||this.controller_.removeObserver(this))}},y.prototype.disconnect=function(){this.clearActive(),this.observations_.clear(),this.controller_.removeObserver(this)},y.prototype.gatherActive=function(){var e=this;this.clearActive(),this.observations_.forEach((function(t){t.isActive()&&e.activeObservations_.push(t)}))},y.prototype.broadcastActive=function(){if(this.hasActive()){var e=this.callbackCtx_,t=this.activeObservations_.map((function(e){return new T(e.target,e.broadcastRect())}));this.callback_.call(e,t,e),this.clearActive()}},y.prototype.clearActive=function(){this.activeObservations_.splice(0)},y.prototype.hasActive=function(){return this.activeObservations_.length>0};var v="undefined"!=typeof WeakMap?new WeakMap:new e,E=function(e){if(!(this instanceof E))throw new TypeError("Cannot call a class as a function.");if(!arguments.length)throw new TypeError("1 argument required, but only 0 present.");var t=s.getInstance(),r=new y(e,t,this);v.set(this,r)};return["observe","unobserve","disconnect"].forEach((function(e){E.prototype[e]=function(){return(t=v.get(this))[e].apply(t,arguments);var t}})),void 0!==r.ResizeObserver?r.ResizeObserver:E})),function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?exports.signalR=t():e.signalR=t()}(window,(function(){return function(e){var t={};function r(n){if(t[n])return t[n].exports;var i=t[n]={i:n,l:!1,exports:{}};return e[n].call(i.exports,i,i.exports,r),i.l=!0,i.exports}return r.m=e,r.c=t,r.d=function(e,t,n){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},r.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(r.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var i in e)r.d(n,i,function(t){return e[t]}.bind(null,i));return n},r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="",r(r.s=0)}([function(e,t,r){"use strict";r.r(t);var n=r(1),i=(r.n(n),r(3));r.d(t,"VERSION",(function(){return i.VERSION})),r.d(t,"AbortError",(function(){return i.AbortError})),r.d(t,"HttpError",(function(){return i.HttpError})),r.d(t,"TimeoutError",(function(){return i.TimeoutError})),r.d(t,"HttpClient",(function(){return i.HttpClient})),r.d(t,"HttpResponse",(function(){return i.HttpResponse})),r.d(t,"DefaultHttpClient",(function(){return i.DefaultHttpClient})),r.d(t,"HubConnection",(function(){return i.HubConnection})),r.d(t,"HubConnectionState",(function(){return i.HubConnectionState})),r.d(t,"HubConnectionBuilder",(function(){return i.HubConnectionBuilder})),r.d(t,"MessageType",(function(){return i.MessageType})),r.d(t,"LogLevel",(function(){return i.LogLevel})),r.d(t,"HttpTransportType",(function(){return i.HttpTransportType})),r.d(t,"TransferFormat",(function(){return i.TransferFormat})),r.d(t,"NullLogger",(function(){return i.NullLogger})),r.d(t,"JsonHubProtocol",(function(){return i.JsonHubProtocol})),r.d(t,"Subject",(function(){return i.Subject})),Uint8Array.prototype.indexOf||Object.defineProperty(Uint8Array.prototype,"indexOf",{value:Array.prototype.indexOf,writable:!0}),Uint8Array.prototype.slice||Object.defineProperty(Uint8Array.prototype,"slice",{value:function(e,t){return new Uint8Array(Array.prototype.slice.call(this,e,t))},writable:!0}),Uint8Array.prototype.forEach||Object.defineProperty(Uint8Array.prototype,"forEach",{value:Array.prototype.forEach,writable:!0})},function(e,t,r){(function(t){var n;
/*!
 * @overview es6-promise - a tiny implementation of Promises/A+.
 * @copyright Copyright (c) 2014 Yehuda Katz, Tom Dale, Stefan Penner and contributors (Conversion to ES6 API by Jake Archibald)
 * @license   Licensed under MIT license
 *            See https://raw.githubusercontent.com/stefanpenner/es6-promise/master/LICENSE
 * @version   v4.2.2+97478eb6
 */
/*!
 * @overview es6-promise - a tiny implementation of Promises/A+.
 * @copyright Copyright (c) 2014 Yehuda Katz, Tom Dale, Stefan Penner and contributors (Conversion to ES6 API by Jake Archibald)
 * @license   Licensed under MIT license
 *            See https://raw.githubusercontent.com/stefanpenner/es6-promise/master/LICENSE
 * @version   v4.2.2+97478eb6
 */n=function(){"use strict";function e(e){return"function"==typeof e}var n=Array.isArray?Array.isArray:function(e){return"[object Array]"===Object.prototype.toString.call(e)},i=0,a=void 0,s=void 0,o=function(e,t){p[i]=e,p[i+1]=t,2===(i+=2)&&(s?s(m):E())},l="undefined"!=typeof window?window:void 0,c=l||{},u=c.MutationObserver||c.WebKitMutationObserver,h="undefined"==typeof self&&"undefined"!=typeof process&&"[object process]"==={}.toString.call(process),f="undefined"!=typeof Uint8ClampedArray&&"undefined"!=typeof importScripts&&"undefined"!=typeof MessageChannel;function d(){var e=setTimeout;return function(){return e(m,1)}}var p=new Array(1e3);function m(){for(var e=0;e<i;e+=2)(0,p[e])(p[e+1]),p[e]=void 0,p[e+1]=void 0;i=0}var g,T,y,v,E=void 0;function C(e,t){var r=this,n=new this.constructor(I);void 0===n[S]&&B(n);var i=r._state;if(i){var a=arguments[i-1];o((function(){return L(i,n,a,r._result)}))}else M(r,n,e,t);return n}function b(e){if(e&&"object"==typeof e&&e.constructor===this)return e;var t=new this(I);return D(t,e),t}h?E=function(){return process.nextTick(m)}:u?(T=0,y=new u(m),v=document.createTextNode(""),y.observe(v,{characterData:!0}),E=function(){v.data=T=++T%2}):f?((g=new MessageChannel).port1.onmessage=m,E=function(){return g.port2.postMessage(0)}):E=void 0===l?function(){try{var e=r(!function(){var e=new Error("Cannot find module 'vertx'");throw e.code="MODULE_NOT_FOUND",e}());return void 0!==(a=e.runOnLoop||e.runOnContext)?function(){a(m)}:d()}catch(e){return d()}}():d();var S=Math.random().toString(36).substring(16);function I(){}var x=new k;function P(e){try{return e.then}catch(e){return x.error=e,x}}function w(t,r,n){r.constructor===t.constructor&&n===C&&r.constructor.resolve===b?function(e,t){1===t._state?A(e,t._result):2===t._state?R(e,t._result):M(t,void 0,(function(t){return D(e,t)}),(function(t){return R(e,t)}))}(t,r):n===x?(R(t,x.error),x.error=null):void 0===n?A(t,r):e(n)?function(e,t,r){o((function(e){var n=!1,i=function(e,t,r,n){try{e.call(t,r,n)}catch(e){return e}}(r,t,(function(r){n||(n=!0,t!==r?D(e,r):A(e,r))}),(function(t){n||(n=!0,R(e,t))}),e._label);!n&&i&&(n=!0,R(e,i))}),e)}(t,r,n):A(t,r)}function D(e,t){var r,n;e===t?R(e,new TypeError("You cannot resolve a promise with itself")):(n=typeof(r=t),null===r||"object"!==n&&"function"!==n?A(e,t):w(e,t,P(t)))}function _(e){e._onerror&&e._onerror(e._result),N(e)}function A(e,t){void 0===e._state&&(e._result=t,e._state=1,0!==e._subscribers.length&&o(N,e))}function R(e,t){void 0===e._state&&(e._state=2,e._result=t,o(_,e))}function M(e,t,r,n){var i=e._subscribers,a=i.length;e._onerror=null,i[a]=t,i[a+1]=r,i[a+2]=n,0===a&&e._state&&o(N,e)}function N(e){var t=e._subscribers,r=e._state;if(0!==t.length){for(var n=void 0,i=void 0,a=e._result,s=0;s<t.length;s+=3)n=t[s],i=t[s+r],n?L(r,n,i,a):i(a);e._subscribers.length=0}}function k(){this.error=null}var O=new k;function L(t,r,n,i){var a=e(n),s=void 0,o=void 0,l=void 0,c=void 0;if(a){if((s=function(e,t){try{return e(t)}catch(e){return O.error=e,O}}(n,i))===O?(c=!0,o=s.error,s.error=null):l=!0,r===s)return void R(r,new TypeError("A promises callback cannot return that same promise."))}else s=i,l=!0;void 0!==r._state||(a&&l?D(r,s):c?R(r,o):1===t?A(r,s):2===t&&R(r,s))}var F=0;function B(e){e[S]=F++,e._state=void 0,e._result=void 0,e._subscribers=[]}var V=function(){function e(e,t){this._instanceConstructor=e,this.promise=new e(I),this.promise[S]||B(this.promise),n(t)?(this.length=t.length,this._remaining=t.length,this._result=new Array(this.length),0===this.length?A(this.promise,this._result):(this.length=this.length||0,this._enumerate(t),0===this._remaining&&A(this.promise,this._result))):R(this.promise,new Error("Array Methods must be provided an Array"))}return e.prototype._enumerate=function(e){for(var t=0;void 0===this._state&&t<e.length;t++)this._eachEntry(e[t],t)},e.prototype._eachEntry=function(e,t){var r=this._instanceConstructor,n=r.resolve;if(n===b){var i=P(e);if(i===C&&void 0!==e._state)this._settledAt(e._state,t,e._result);else if("function"!=typeof i)this._remaining--,this._result[t]=e;else if(r===U){var a=new r(I);w(a,e,i),this._willSettleAt(a,t)}else this._willSettleAt(new r((function(t){return t(e)})),t)}else this._willSettleAt(n(e),t)},e.prototype._settledAt=function(e,t,r){var n=this.promise;void 0===n._state&&(this._remaining--,2===e?R(n,r):this._result[t]=r),0===this._remaining&&A(n,this._result)},e.prototype._willSettleAt=function(e,t){var r=this;M(e,void 0,(function(e){return r._settledAt(1,t,e)}),(function(e){return r._settledAt(2,t,e)}))},e}(),U=function(){function e(t){this[S]=F++,this._result=this._state=void 0,this._subscribers=[],I!==t&&("function"!=typeof t&&function(){throw new TypeError("You must pass a resolver function as the first argument to the promise constructor")}(),this instanceof e?function(e,t){try{t((function(t){D(e,t)}),(function(t){R(e,t)}))}catch(t){R(e,t)}}(this,t):function(){throw new TypeError("Failed to construct 'Promise': Please use the 'new' operator, this object constructor cannot be called as a function.")}())}return e.prototype.catch=function(e){return this.then(null,e)},e.prototype.finally=function(e){var t=this.constructor;return this.then((function(r){return t.resolve(e()).then((function(){return r}))}),(function(r){return t.resolve(e()).then((function(){throw r}))}))},e}();return U.prototype.then=C,U.all=function(e){return new V(this,e).promise},U.race=function(e){var t=this;return n(e)?new t((function(r,n){for(var i=e.length,a=0;a<i;a++)t.resolve(e[a]).then(r,n)})):new t((function(e,t){return t(new TypeError("You must pass an array to race."))}))},U.resolve=b,U.reject=function(e){var t=new this(I);return R(t,e),t},U._setScheduler=function(e){s=e},U._setAsap=function(e){o=e},U._asap=o,U.polyfill=function(){var e=void 0;if(void 0!==t)e=t;else if("undefined"!=typeof self)e=self;else try{e=Function("return this")()}catch(e){throw new Error("polyfill failed because global object is unavailable in this environment")}var r=e.Promise;if(r){var n=null;try{n=Object.prototype.toString.call(r.resolve())}catch(e){}if("[object Promise]"===n&&!r.cast)return}e.Promise=U},U.Promise=U,U.polyfill(),U},e.exports=n()}).call(this,r(2))},function(e,t){var r;r=function(){return this}();try{r=r||new Function("return this")()}catch(e){"object"==typeof window&&(r=window)}e.exports=r},function(e,t,r){"use strict";r.r(t),r.d(t,"VERSION",(function(){return p}));var n=r(4);r.d(t,"AbortError",(function(){return n.AbortError})),r.d(t,"HttpError",(function(){return n.HttpError})),r.d(t,"TimeoutError",(function(){return n.TimeoutError}));var i=r(5);r.d(t,"HttpClient",(function(){return i.HttpClient})),r.d(t,"HttpResponse",(function(){return i.HttpResponse}));var a=r(6);r.d(t,"DefaultHttpClient",(function(){return a.DefaultHttpClient}));var s=r(10);r.d(t,"HubConnection",(function(){return s.HubConnection})),r.d(t,"HubConnectionState",(function(){return s.HubConnectionState}));var o=r(17);r.d(t,"HubConnectionBuilder",(function(){return o.HubConnectionBuilder}));var l=r(15);r.d(t,"MessageType",(function(){return l.MessageType}));var c=r(9);r.d(t,"LogLevel",(function(){return c.LogLevel}));var u=r(20);r.d(t,"HttpTransportType",(function(){return u.HttpTransportType})),r.d(t,"TransferFormat",(function(){return u.TransferFormat}));var h=r(14);r.d(t,"NullLogger",(function(){return h.NullLogger}));var f=r(25);r.d(t,"JsonHubProtocol",(function(){return f.JsonHubProtocol}));var d=r(16);r.d(t,"Subject",(function(){return d.Subject}));var p="3.1.3"},function(e,t,r){"use strict";r.r(t),r.d(t,"HttpError",(function(){return a})),r.d(t,"TimeoutError",(function(){return s})),r.d(t,"AbortError",(function(){return o}));var n,i=(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])},function(e,t){function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}),a=function(e){function t(t,r){var n=this,i=this.constructor.prototype;return(n=e.call(this,t)||this).statusCode=r,n.__proto__=i,n}return i(t,e),t}(Error),s=function(e){function t(t){void 0===t&&(t="A timeout occurred.");var r=this,n=this.constructor.prototype;return(r=e.call(this,t)||this).__proto__=n,r}return i(t,e),t}(Error),o=function(e){function t(t){void 0===t&&(t="An abort occurred.");var r=this,n=this.constructor.prototype;return(r=e.call(this,t)||this).__proto__=n,r}return i(t,e),t}(Error)},function(e,t,r){"use strict";r.r(t),r.d(t,"HttpResponse",(function(){return i})),r.d(t,"HttpClient",(function(){return a}));var n=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var i in t=arguments[r])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},i=function(e,t,r){this.statusCode=e,this.statusText=t,this.content=r},a=function(){function e(){}return e.prototype.get=function(e,t){return this.send(n({},t,{method:"GET",url:e}))},e.prototype.post=function(e,t){return this.send(n({},t,{method:"POST",url:e}))},e.prototype.delete=function(e,t){return this.send(n({},t,{method:"DELETE",url:e}))},e.prototype.getCookieString=function(e){return""},e}()},function(e,t,r){"use strict";r.r(t),r.d(t,"DefaultHttpClient",(function(){return c}));var n,i=r(4),a=r(5),s=r(7),o=r(8),l=(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])},function(e,t){function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}),c=function(e){function t(t){var r=e.call(this)||this;return"undefined"!=typeof XMLHttpRequest?r.httpClient=new o.XhrHttpClient(t):r.httpClient=new s.NodeHttpClient(t),r}return l(t,e),t.prototype.send=function(e){return e.abortSignal&&e.abortSignal.aborted?Promise.reject(new i.AbortError):e.method?e.url?this.httpClient.send(e):Promise.reject(new Error("No url defined.")):Promise.reject(new Error("No method defined."))},t.prototype.getCookieString=function(e){return this.httpClient.getCookieString(e)},t}(a.HttpClient)},function(e,t,r){"use strict";r.r(t),r.d(t,"NodeHttpClient",(function(){return s}));var n,i=r(5),a=(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])},function(e,t){function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}),s=function(e){function t(t){return e.call(this)||this}return a(t,e),t.prototype.send=function(){return Promise.reject(new Error("If using Node either provide an XmlHttpRequest polyfill or consume the cjs or esm script instead of the browser/signalr.js one."))},t}(i.HttpClient)},function(e,t,r){"use strict";r.r(t),r.d(t,"XhrHttpClient",(function(){return l}));var n,i=r(4),a=r(5),s=r(9),o=(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])},function(e,t){function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}),l=function(e){function t(t){var r=e.call(this)||this;return r.logger=t,r}return o(t,e),t.prototype.send=function(e){var t=this;return e.abortSignal&&e.abortSignal.aborted?Promise.reject(new i.AbortError):e.method?e.url?new Promise((function(r,n){var o=new XMLHttpRequest;o.open(e.method,e.url,!0),o.withCredentials=!0,o.setRequestHeader("X-Requested-With","XMLHttpRequest"),o.setRequestHeader("Content-Type","text/plain;charset=UTF-8");var l=e.headers;l&&Object.keys(l).forEach((function(e){o.setRequestHeader(e,l[e])})),e.responseType&&(o.responseType=e.responseType),e.abortSignal&&(e.abortSignal.onabort=function(){o.abort(),n(new i.AbortError)}),e.timeout&&(o.timeout=e.timeout),o.onload=function(){e.abortSignal&&(e.abortSignal.onabort=null),o.status>=200&&o.status<300?r(new a.HttpResponse(o.status,o.statusText,o.response||o.responseText)):n(new i.HttpError(o.statusText,o.status))},o.onerror=function(){t.logger.log(s.LogLevel.Warning,"Error from HTTP request. "+o.status+": "+o.statusText+"."),n(new i.HttpError(o.statusText,o.status))},o.ontimeout=function(){t.logger.log(s.LogLevel.Warning,"Timeout from HTTP request."),n(new i.TimeoutError)},o.send(e.content||"")})):Promise.reject(new Error("No url defined.")):Promise.reject(new Error("No method defined."))},t}(a.HttpClient)},function(e,t,r){"use strict";var n;r.r(t),r.d(t,"LogLevel",(function(){return n})),function(e){e[e.Trace=0]="Trace",e[e.Debug=1]="Debug",e[e.Information=2]="Information",e[e.Warning=3]="Warning",e[e.Error=4]="Error",e[e.Critical=5]="Critical",e[e.None=6]="None"}(n||(n={}))},function(e,t,r){"use strict";r.r(t),r.d(t,"HubConnectionState",(function(){return n})),r.d(t,"HubConnection",(function(){return h}));var n,i=r(11),a=r(15),s=r(9),o=r(16),l=r(13),c=function(e,t,r,n){return new(r||(r=Promise))((function(i,a){function s(e){try{l(n.next(e))}catch(e){a(e)}}function o(e){try{l(n.throw(e))}catch(e){a(e)}}function l(e){e.done?i(e.value):new r((function(t){t(e.value)})).then(s,o)}l((n=n.apply(e,t||[])).next())}))},u=function(e,t){var r,n,i,a,s={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return a={next:o(0),throw:o(1),return:o(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function o(a){return function(o){return function(a){if(r)throw new TypeError("Generator is already executing.");for(;s;)try{if(r=1,n&&(i=2&a[0]?n.return:a[0]?n.throw||((i=n.return)&&i.call(n),0):n.next)&&!(i=i.call(n,a[1])).done)return i;switch(n=0,i&&(a=[2&a[0],i.value]),a[0]){case 0:case 1:i=a;break;case 4:return s.label++,{value:a[1],done:!1};case 5:s.label++,n=a[1],a=[0];continue;case 7:a=s.ops.pop(),s.trys.pop();continue;default:if(!(i=s.trys,(i=i.length>0&&i[i.length-1])||6!==a[0]&&2!==a[0])){s=0;continue}if(3===a[0]&&(!i||a[1]>i[0]&&a[1]<i[3])){s.label=a[1];break}if(6===a[0]&&s.label<i[1]){s.label=i[1],i=a;break}if(i&&s.label<i[2]){s.label=i[2],s.ops.push(a);break}i[2]&&s.ops.pop(),s.trys.pop();continue}a=t.call(e,s)}catch(e){a=[6,e],n=0}finally{r=i=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,o])}}};!function(e){e.Disconnected="Disconnected",e.Connecting="Connecting",e.Connected="Connected",e.Disconnecting="Disconnecting",e.Reconnecting="Reconnecting"}(n||(n={}));var h=function(){function e(e,t,r,s){var o=this;l.Arg.isRequired(e,"connection"),l.Arg.isRequired(t,"logger"),l.Arg.isRequired(r,"protocol"),this.serverTimeoutInMilliseconds=3e4,this.keepAliveIntervalInMilliseconds=15e3,this.logger=t,this.protocol=r,this.connection=e,this.reconnectPolicy=s,this.handshakeProtocol=new i.HandshakeProtocol,this.connection.onreceive=function(e){return o.processIncomingData(e)},this.connection.onclose=function(e){return o.connectionClosed(e)},this.callbacks={},this.methods={},this.closedCallbacks=[],this.reconnectingCallbacks=[],this.reconnectedCallbacks=[],this.invocationId=0,this.receivedHandshakeResponse=!1,this.connectionState=n.Disconnected,this.connectionStarted=!1,this.cachedPingMessage=this.protocol.writeMessage({type:a.MessageType.Ping})}return e.create=function(t,r,n,i){return new e(t,r,n,i)},Object.defineProperty(e.prototype,"state",{get:function(){return this.connectionState},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"connectionId",{get:function(){return this.connection&&this.connection.connectionId||null},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"baseUrl",{get:function(){return this.connection.baseUrl||""},set:function(e){if(this.connectionState!==n.Disconnected&&this.connectionState!==n.Reconnecting)throw new Error("The HubConnection must be in the Disconnected or Reconnecting state to change the url.");if(!e)throw new Error("The HubConnection url must be a valid url.");this.connection.baseUrl=e},enumerable:!0,configurable:!0}),e.prototype.start=function(){return this.startPromise=this.startWithStateTransitions(),this.startPromise},e.prototype.startWithStateTransitions=function(){return c(this,void 0,void 0,(function(){var e;return u(this,(function(t){switch(t.label){case 0:if(this.connectionState!==n.Disconnected)return[2,Promise.reject(new Error("Cannot start a HubConnection that is not in the 'Disconnected' state."))];this.connectionState=n.Connecting,this.logger.log(s.LogLevel.Debug,"Starting HubConnection."),t.label=1;case 1:return t.trys.push([1,3,,4]),[4,this.startInternal()];case 2:return t.sent(),this.connectionState=n.Connected,this.connectionStarted=!0,this.logger.log(s.LogLevel.Debug,"HubConnection connected successfully."),[3,4];case 3:return e=t.sent(),this.connectionState=n.Disconnected,this.logger.log(s.LogLevel.Debug,"HubConnection failed to start successfully because of error '"+e+"'."),[2,Promise.reject(e)];case 4:return[2]}}))}))},e.prototype.startInternal=function(){return c(this,void 0,void 0,(function(){var e,t,r,n=this;return u(this,(function(i){switch(i.label){case 0:return this.stopDuringStartError=void 0,this.receivedHandshakeResponse=!1,e=new Promise((function(e,t){n.handshakeResolver=e,n.handshakeRejecter=t})),[4,this.connection.start(this.protocol.transferFormat)];case 1:i.sent(),i.label=2;case 2:return i.trys.push([2,5,,7]),t={protocol:this.protocol.name,version:this.protocol.version},this.logger.log(s.LogLevel.Debug,"Sending handshake request."),[4,this.sendMessage(this.handshakeProtocol.writeHandshakeRequest(t))];case 3:return i.sent(),this.logger.log(s.LogLevel.Information,"Using HubProtocol '"+this.protocol.name+"'."),this.cleanupTimeout(),this.resetTimeoutPeriod(),this.resetKeepAliveInterval(),[4,e];case 4:if(i.sent(),this.stopDuringStartError)throw this.stopDuringStartError;return[3,7];case 5:return r=i.sent(),this.logger.log(s.LogLevel.Debug,"Hub handshake failed with error '"+r+"' during start(). Stopping HubConnection."),this.cleanupTimeout(),this.cleanupPingTimer(),[4,this.connection.stop(r)];case 6:throw i.sent(),r;case 7:return[2]}}))}))},e.prototype.stop=function(){return c(this,void 0,void 0,(function(){var e;return u(this,(function(t){switch(t.label){case 0:return e=this.startPromise,this.stopPromise=this.stopInternal(),[4,this.stopPromise];case 1:t.sent(),t.label=2;case 2:return t.trys.push([2,4,,5]),[4,e];case 3:return t.sent(),[3,5];case 4:return t.sent(),[3,5];case 5:return[2]}}))}))},e.prototype.stopInternal=function(e){return this.connectionState===n.Disconnected?(this.logger.log(s.LogLevel.Debug,"Call to HubConnection.stop("+e+") ignored because it is already in the disconnected state."),Promise.resolve()):this.connectionState===n.Disconnecting?(this.logger.log(s.LogLevel.Debug,"Call to HttpConnection.stop("+e+") ignored because the connection is already in the disconnecting state."),this.stopPromise):(this.connectionState=n.Disconnecting,this.logger.log(s.LogLevel.Debug,"Stopping HubConnection."),this.reconnectDelayHandle?(this.logger.log(s.LogLevel.Debug,"Connection stopped during reconnect delay. Done reconnecting."),clearTimeout(this.reconnectDelayHandle),this.reconnectDelayHandle=void 0,this.completeClose(),Promise.resolve()):(this.cleanupTimeout(),this.cleanupPingTimer(),this.stopDuringStartError=e||new Error("The connection was stopped before the hub handshake could complete."),this.connection.stop(e)))},e.prototype.stream=function(e){for(var t=this,r=[],n=1;n<arguments.length;n++)r[n-1]=arguments[n];var i,s=this.replaceStreamingParams(r),l=s[0],c=s[1],u=this.createStreamInvocation(e,r,c),h=new o.Subject;return h.cancelCallback=function(){var e=t.createCancelInvocation(u.invocationId);return delete t.callbacks[u.invocationId],i.then((function(){return t.sendWithProtocol(e)}))},this.callbacks[u.invocationId]=function(e,t){t?h.error(t):e&&(e.type===a.MessageType.Completion?e.error?h.error(new Error(e.error)):h.complete():h.next(e.item))},i=this.sendWithProtocol(u).catch((function(e){h.error(e),delete t.callbacks[u.invocationId]})),this.launchStreams(l,i),h},e.prototype.sendMessage=function(e){return this.resetKeepAliveInterval(),this.connection.send(e)},e.prototype.sendWithProtocol=function(e){return this.sendMessage(this.protocol.writeMessage(e))},e.prototype.send=function(e){for(var t=[],r=1;r<arguments.length;r++)t[r-1]=arguments[r];var n=this.replaceStreamingParams(t),i=n[0],a=n[1],s=this.sendWithProtocol(this.createInvocation(e,t,!0,a));return this.launchStreams(i,s),s},e.prototype.invoke=function(e){for(var t=this,r=[],n=1;n<arguments.length;n++)r[n-1]=arguments[n];var i=this.replaceStreamingParams(r),s=i[0],o=i[1],l=this.createInvocation(e,r,!1,o),c=new Promise((function(e,r){t.callbacks[l.invocationId]=function(t,n){n?r(n):t&&(t.type===a.MessageType.Completion?t.error?r(new Error(t.error)):e(t.result):r(new Error("Unexpected message type: "+t.type)))};var n=t.sendWithProtocol(l).catch((function(e){r(e),delete t.callbacks[l.invocationId]}));t.launchStreams(s,n)}));return c},e.prototype.on=function(e,t){e&&t&&(e=e.toLowerCase(),this.methods[e]||(this.methods[e]=[]),-1===this.methods[e].indexOf(t)&&this.methods[e].push(t))},e.prototype.off=function(e,t){if(e){e=e.toLowerCase();var r=this.methods[e];if(r)if(t){var n=r.indexOf(t);-1!==n&&(r.splice(n,1),0===r.length&&delete this.methods[e])}else delete this.methods[e]}},e.prototype.onclose=function(e){e&&this.closedCallbacks.push(e)},e.prototype.onreconnecting=function(e){e&&this.reconnectingCallbacks.push(e)},e.prototype.onreconnected=function(e){e&&this.reconnectedCallbacks.push(e)},e.prototype.processIncomingData=function(e){if(this.cleanupTimeout(),this.receivedHandshakeResponse||(e=this.processHandshakeResponse(e),this.receivedHandshakeResponse=!0),e)for(var t=0,r=this.protocol.parseMessages(e,this.logger);t<r.length;t++){var n=r[t];switch(n.type){case a.MessageType.Invocation:this.invokeClientMethod(n);break;case a.MessageType.StreamItem:case a.MessageType.Completion:var i=this.callbacks[n.invocationId];i&&(n.type===a.MessageType.Completion&&delete this.callbacks[n.invocationId],i(n));break;case a.MessageType.Ping:break;case a.MessageType.Close:this.logger.log(s.LogLevel.Information,"Close message received from server.");var o=n.error?new Error("Server returned an error on close: "+n.error):void 0;!0===n.allowReconnect?this.connection.stop(o):this.stopPromise=this.stopInternal(o);break;default:this.logger.log(s.LogLevel.Warning,"Invalid message type: "+n.type+".")}}this.resetTimeoutPeriod()},e.prototype.processHandshakeResponse=function(e){var t,r,n;try{n=(t=this.handshakeProtocol.parseHandshakeResponse(e))[0],r=t[1]}catch(e){var i="Error parsing handshake response: "+e;this.logger.log(s.LogLevel.Error,i);var a=new Error(i);throw this.handshakeRejecter(a),a}if(r.error){i="Server returned handshake error: "+r.error;this.logger.log(s.LogLevel.Error,i);a=new Error(i);throw this.handshakeRejecter(a),a}return this.logger.log(s.LogLevel.Debug,"Server handshake complete."),this.handshakeResolver(),n},e.prototype.resetKeepAliveInterval=function(){var e=this;this.cleanupPingTimer(),this.pingServerHandle=setTimeout((function(){return c(e,void 0,void 0,(function(){return u(this,(function(e){switch(e.label){case 0:if(this.connectionState!==n.Connected)return[3,4];e.label=1;case 1:return e.trys.push([1,3,,4]),[4,this.sendMessage(this.cachedPingMessage)];case 2:return e.sent(),[3,4];case 3:return e.sent(),this.cleanupPingTimer(),[3,4];case 4:return[2]}}))}))}),this.keepAliveIntervalInMilliseconds)},e.prototype.resetTimeoutPeriod=function(){var e=this;this.connection.features&&this.connection.features.inherentKeepAlive||(this.timeoutHandle=setTimeout((function(){return e.serverTimeout()}),this.serverTimeoutInMilliseconds))},e.prototype.serverTimeout=function(){this.connection.stop(new Error("Server timeout elapsed without receiving a message from the server."))},e.prototype.invokeClientMethod=function(e){var t=this,r=this.methods[e.target.toLowerCase()];if(r){try{r.forEach((function(r){return r.apply(t,e.arguments)}))}catch(t){this.logger.log(s.LogLevel.Error,"A callback for the method "+e.target.toLowerCase()+" threw error '"+t+"'.")}if(e.invocationId){var n="Server requested a response, which is not supported in this version of the client.";this.logger.log(s.LogLevel.Error,n),this.stopPromise=this.stopInternal(new Error(n))}}else this.logger.log(s.LogLevel.Warning,"No client method with the name '"+e.target+"' found.")},e.prototype.connectionClosed=function(e){this.logger.log(s.LogLevel.Debug,"HubConnection.connectionClosed("+e+") called while in state "+this.connectionState+"."),this.stopDuringStartError=this.stopDuringStartError||e||new Error("The underlying connection was closed before the hub handshake could complete."),this.handshakeResolver&&this.handshakeResolver(),this.cancelCallbacksWithError(e||new Error("Invocation canceled due to the underlying connection being closed.")),this.cleanupTimeout(),this.cleanupPingTimer(),this.connectionState===n.Disconnecting?this.completeClose(e):this.connectionState===n.Connected&&this.reconnectPolicy?this.reconnect(e):this.connectionState===n.Connected&&this.completeClose(e)},e.prototype.completeClose=function(e){var t=this;if(this.connectionStarted){this.connectionState=n.Disconnected,this.connectionStarted=!1;try{this.closedCallbacks.forEach((function(r){return r.apply(t,[e])}))}catch(t){this.logger.log(s.LogLevel.Error,"An onclose callback called with error '"+e+"' threw error '"+t+"'.")}}},e.prototype.reconnect=function(e){return c(this,void 0,void 0,(function(){var t,r,i,a,o,l=this;return u(this,(function(c){switch(c.label){case 0:if(t=Date.now(),r=0,i=void 0!==e?e:new Error("Attempting to reconnect due to a unknown error."),null===(a=this.getNextRetryDelay(r++,0,i)))return this.logger.log(s.LogLevel.Debug,"Connection not reconnecting because the IRetryPolicy returned null on the first reconnect attempt."),this.completeClose(e),[2];if(this.connectionState=n.Reconnecting,e?this.logger.log(s.LogLevel.Information,"Connection reconnecting because of error '"+e+"'."):this.logger.log(s.LogLevel.Information,"Connection reconnecting."),this.onreconnecting){try{this.reconnectingCallbacks.forEach((function(t){return t.apply(l,[e])}))}catch(t){this.logger.log(s.LogLevel.Error,"An onreconnecting callback called with error '"+e+"' threw error '"+t+"'.")}if(this.connectionState!==n.Reconnecting)return this.logger.log(s.LogLevel.Debug,"Connection left the reconnecting state in onreconnecting callback. Done reconnecting."),[2]}c.label=1;case 1:return null===a?[3,7]:(this.logger.log(s.LogLevel.Information,"Reconnect attempt number "+r+" will start in "+a+" ms."),[4,new Promise((function(e){l.reconnectDelayHandle=setTimeout(e,a)}))]);case 2:if(c.sent(),this.reconnectDelayHandle=void 0,this.connectionState!==n.Reconnecting)return this.logger.log(s.LogLevel.Debug,"Connection left the reconnecting state during reconnect delay. Done reconnecting."),[2];c.label=3;case 3:return c.trys.push([3,5,,6]),[4,this.startInternal()];case 4:if(c.sent(),this.connectionState=n.Connected,this.logger.log(s.LogLevel.Information,"HubConnection reconnected successfully."),this.onreconnected)try{this.reconnectedCallbacks.forEach((function(e){return e.apply(l,[l.connection.connectionId])}))}catch(e){this.logger.log(s.LogLevel.Error,"An onreconnected callback called with connectionId '"+this.connection.connectionId+"; threw error '"+e+"'.")}return[2];case 5:return o=c.sent(),this.logger.log(s.LogLevel.Information,"Reconnect attempt failed because of error '"+o+"'."),this.connectionState!==n.Reconnecting?(this.logger.log(s.LogLevel.Debug,"Connection left the reconnecting state during reconnect attempt. Done reconnecting."),[2]):(i=o instanceof Error?o:new Error(o.toString()),a=this.getNextRetryDelay(r++,Date.now()-t,i),[3,6]);case 6:return[3,1];case 7:return this.logger.log(s.LogLevel.Information,"Reconnect retries have been exhausted after "+(Date.now()-t)+" ms and "+r+" failed attempts. Connection disconnecting."),this.completeClose(),[2]}}))}))},e.prototype.getNextRetryDelay=function(e,t,r){try{return this.reconnectPolicy.nextRetryDelayInMilliseconds({elapsedMilliseconds:t,previousRetryCount:e,retryReason:r})}catch(r){return this.logger.log(s.LogLevel.Error,"IRetryPolicy.nextRetryDelayInMilliseconds("+e+", "+t+") threw error '"+r+"'."),null}},e.prototype.cancelCallbacksWithError=function(e){var t=this.callbacks;this.callbacks={},Object.keys(t).forEach((function(r){(0,t[r])(null,e)}))},e.prototype.cleanupPingTimer=function(){this.pingServerHandle&&clearTimeout(this.pingServerHandle)},e.prototype.cleanupTimeout=function(){this.timeoutHandle&&clearTimeout(this.timeoutHandle)},e.prototype.createInvocation=function(e,t,r,n){if(r)return{arguments:t,streamIds:n,target:e,type:a.MessageType.Invocation};var i=this.invocationId;return this.invocationId++,{arguments:t,invocationId:i.toString(),streamIds:n,target:e,type:a.MessageType.Invocation}},e.prototype.launchStreams=function(e,t){var r=this;if(0!==e.length){t||(t=Promise.resolve());var n=function(n){e[n].subscribe({complete:function(){t=t.then((function(){return r.sendWithProtocol(r.createCompletionMessage(n))}))},error:function(e){var i;i=e instanceof Error?e.message:e&&e.toString?e.toString():"Unknown error",t=t.then((function(){return r.sendWithProtocol(r.createCompletionMessage(n,i))}))},next:function(e){t=t.then((function(){return r.sendWithProtocol(r.createStreamItemMessage(n,e))}))}})};for(var i in e)n(i)}},e.prototype.replaceStreamingParams=function(e){for(var t=[],r=[],n=0;n<e.length;n++){var i=e[n];if(this.isObservable(i)){var a=this.invocationId;this.invocationId++,t[a]=i,r.push(a.toString()),e.splice(n,1)}}return[t,r]},e.prototype.isObservable=function(e){return e&&e.subscribe&&"function"==typeof e.subscribe},e.prototype.createStreamInvocation=function(e,t,r){var n=this.invocationId;return this.invocationId++,{arguments:t,invocationId:n.toString(),streamIds:r,target:e,type:a.MessageType.StreamInvocation}},e.prototype.createCancelInvocation=function(e){return{invocationId:e,type:a.MessageType.CancelInvocation}},e.prototype.createStreamItemMessage=function(e,t){return{invocationId:e,item:t,type:a.MessageType.StreamItem}},e.prototype.createCompletionMessage=function(e,t,r){return t?{error:t,invocationId:e,type:a.MessageType.Completion}:{invocationId:e,result:r,type:a.MessageType.Completion}},e}()},function(e,t,r){"use strict";r.r(t),r.d(t,"HandshakeProtocol",(function(){return a}));var n=r(12),i=r(13),a=function(){function e(){}return e.prototype.writeHandshakeRequest=function(e){return n.TextMessageFormat.write(JSON.stringify(e))},e.prototype.parseHandshakeResponse=function(e){var t,r;if(Object(i.isArrayBuffer)(e)||"undefined"!=typeof Buffer&&e instanceof Buffer){var a=new Uint8Array(e);if(-1===(o=a.indexOf(n.TextMessageFormat.RecordSeparatorCode)))throw new Error("Message is incomplete.");var s=o+1;t=String.fromCharCode.apply(null,a.slice(0,s)),r=a.byteLength>s?a.slice(s).buffer:null}else{var o,l=e;if(-1===(o=l.indexOf(n.TextMessageFormat.RecordSeparator)))throw new Error("Message is incomplete.");s=o+1;t=l.substring(0,s),r=l.length>s?l.substring(s):null}var c=n.TextMessageFormat.parse(t),u=JSON.parse(c[0]);if(u.type)throw new Error("Expected a handshake response from the server.");return[r,u]},e}()},function(e,t,r){"use strict";r.r(t),r.d(t,"TextMessageFormat",(function(){return n}));var n=function(){function e(){}return e.write=function(t){return""+t+e.RecordSeparator},e.parse=function(t){if(t[t.length-1]!==e.RecordSeparator)throw new Error("Message is incomplete.");var r=t.split(e.RecordSeparator);return r.pop(),r},e.RecordSeparatorCode=30,e.RecordSeparator=String.fromCharCode(e.RecordSeparatorCode),e}()},function(e,t,r){"use strict";r.r(t),r.d(t,"Arg",(function(){return o})),r.d(t,"Platform",(function(){return l})),r.d(t,"getDataDetail",(function(){return c})),r.d(t,"formatArrayBuffer",(function(){return u})),r.d(t,"isArrayBuffer",(function(){return h})),r.d(t,"sendMessage",(function(){return f})),r.d(t,"createLogger",(function(){return d})),r.d(t,"SubjectSubscription",(function(){return p})),r.d(t,"ConsoleLogger",(function(){return m}));var n=r(9),i=r(14),a=function(e,t,r,n){return new(r||(r=Promise))((function(i,a){function s(e){try{l(n.next(e))}catch(e){a(e)}}function o(e){try{l(n.throw(e))}catch(e){a(e)}}function l(e){e.done?i(e.value):new r((function(t){t(e.value)})).then(s,o)}l((n=n.apply(e,t||[])).next())}))},s=function(e,t){var r,n,i,a,s={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return a={next:o(0),throw:o(1),return:o(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function o(a){return function(o){return function(a){if(r)throw new TypeError("Generator is already executing.");for(;s;)try{if(r=1,n&&(i=2&a[0]?n.return:a[0]?n.throw||((i=n.return)&&i.call(n),0):n.next)&&!(i=i.call(n,a[1])).done)return i;switch(n=0,i&&(a=[2&a[0],i.value]),a[0]){case 0:case 1:i=a;break;case 4:return s.label++,{value:a[1],done:!1};case 5:s.label++,n=a[1],a=[0];continue;case 7:a=s.ops.pop(),s.trys.pop();continue;default:if(!(i=s.trys,(i=i.length>0&&i[i.length-1])||6!==a[0]&&2!==a[0])){s=0;continue}if(3===a[0]&&(!i||a[1]>i[0]&&a[1]<i[3])){s.label=a[1];break}if(6===a[0]&&s.label<i[1]){s.label=i[1],i=a;break}if(i&&s.label<i[2]){s.label=i[2],s.ops.push(a);break}i[2]&&s.ops.pop(),s.trys.pop();continue}a=t.call(e,s)}catch(e){a=[6,e],n=0}finally{r=i=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,o])}}},o=function(){function e(){}return e.isRequired=function(e,t){if(null==e)throw new Error("The '"+t+"' argument is required.")},e.isIn=function(e,t,r){if(!(e in t))throw new Error("Unknown "+r+" value: "+e+".")},e}(),l=function(){function e(){}return Object.defineProperty(e,"isBrowser",{get:function(){return"object"==typeof window},enumerable:!0,configurable:!0}),Object.defineProperty(e,"isWebWorker",{get:function(){return"object"==typeof self&&"importScripts"in self},enumerable:!0,configurable:!0}),Object.defineProperty(e,"isNode",{get:function(){return!this.isBrowser&&!this.isWebWorker},enumerable:!0,configurable:!0}),e}();function c(e,t){var r="";return h(e)?(r="Binary data of length "+e.byteLength,t&&(r+=". Content: '"+u(e)+"'")):"string"==typeof e&&(r="String data of length "+e.length,t&&(r+=". Content: '"+e+"'")),r}function u(e){var t=new Uint8Array(e),r="";return t.forEach((function(e){r+="0x"+(e<16?"0":"")+e.toString(16)+" "})),r.substr(0,r.length-1)}function h(e){return e&&"undefined"!=typeof ArrayBuffer&&(e instanceof ArrayBuffer||e.constructor&&"ArrayBuffer"===e.constructor.name)}function f(e,t,r,i,o,l,u){return a(this,void 0,void 0,(function(){var a,f,d,p,m;return s(this,(function(s){switch(s.label){case 0:return o?[4,o()]:[3,2];case 1:(d=s.sent())&&((a={}).Authorization="Bearer "+d,f=a),s.label=2;case 2:return e.log(n.LogLevel.Trace,"("+t+" transport) sending data. "+c(l,u)+"."),p=h(l)?"arraybuffer":"text",[4,r.post(i,{content:l,headers:f,responseType:p})];case 3:return m=s.sent(),e.log(n.LogLevel.Trace,"("+t+" transport) request complete. Response status: "+m.statusCode+"."),[2]}}))}))}function d(e){return void 0===e?new m(n.LogLevel.Information):null===e?i.NullLogger.instance:e.log?e:new m(e)}var p=function(){function e(e,t){this.subject=e,this.observer=t}return e.prototype.dispose=function(){var e=this.subject.observers.indexOf(this.observer);e>-1&&this.subject.observers.splice(e,1),0===this.subject.observers.length&&this.subject.cancelCallback&&this.subject.cancelCallback().catch((function(e){}))},e}(),m=function(){function e(e){this.minimumLogLevel=e,this.outputConsole=console}return e.prototype.log=function(e,t){if(e>=this.minimumLogLevel)switch(e){case n.LogLevel.Critical:case n.LogLevel.Error:this.outputConsole.error("["+(new Date).toISOString()+"] "+n.LogLevel[e]+": "+t);break;case n.LogLevel.Warning:this.outputConsole.warn("["+(new Date).toISOString()+"] "+n.LogLevel[e]+": "+t);break;case n.LogLevel.Information:this.outputConsole.info("["+(new Date).toISOString()+"] "+n.LogLevel[e]+": "+t);break;default:this.outputConsole.log("["+(new Date).toISOString()+"] "+n.LogLevel[e]+": "+t)}},e}()},function(e,t,r){"use strict";r.r(t),r.d(t,"NullLogger",(function(){return n}));var n=function(){function e(){}return e.prototype.log=function(e,t){},e.instance=new e,e}()},function(e,t,r){"use strict";var n;r.r(t),r.d(t,"MessageType",(function(){return n})),function(e){e[e.Invocation=1]="Invocation",e[e.StreamItem=2]="StreamItem",e[e.Completion=3]="Completion",e[e.StreamInvocation=4]="StreamInvocation",e[e.CancelInvocation=5]="CancelInvocation",e[e.Ping=6]="Ping",e[e.Close=7]="Close"}(n||(n={}))},function(e,t,r){"use strict";r.r(t),r.d(t,"Subject",(function(){return i}));var n=r(13),i=function(){function e(){this.observers=[]}return e.prototype.next=function(e){for(var t=0,r=this.observers;t<r.length;t++){r[t].next(e)}},e.prototype.error=function(e){for(var t=0,r=this.observers;t<r.length;t++){var n=r[t];n.error&&n.error(e)}},e.prototype.complete=function(){for(var e=0,t=this.observers;e<t.length;e++){var r=t[e];r.complete&&r.complete()}},e.prototype.subscribe=function(e){return this.observers.push(e),new n.SubjectSubscription(this,e)},e}()},function(e,t,r){"use strict";r.r(t),r.d(t,"HubConnectionBuilder",(function(){return f}));var n=r(18),i=r(19),a=r(10),s=r(9),o=r(25),l=r(14),c=r(13),u=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var i in t=arguments[r])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},h={trace:s.LogLevel.Trace,debug:s.LogLevel.Debug,info:s.LogLevel.Information,information:s.LogLevel.Information,warn:s.LogLevel.Warning,warning:s.LogLevel.Warning,error:s.LogLevel.Error,critical:s.LogLevel.Critical,none:s.LogLevel.None};var f=function(){function e(){}return e.prototype.configureLogging=function(e){if(c.Arg.isRequired(e,"logging"),void 0!==e.log)this.logger=e;else if("string"==typeof e){var t=function(e){var t=h[e.toLowerCase()];if(void 0!==t)return t;throw new Error("Unknown log level: "+e)}(e);this.logger=new c.ConsoleLogger(t)}else this.logger=new c.ConsoleLogger(e);return this},e.prototype.withUrl=function(e,t){return c.Arg.isRequired(e,"url"),this.url=e,this.httpConnectionOptions=u({},this.httpConnectionOptions,"object"==typeof t?t:{transport:t}),this},e.prototype.withHubProtocol=function(e){return c.Arg.isRequired(e,"protocol"),this.protocol=e,this},e.prototype.withAutomaticReconnect=function(e){if(this.reconnectPolicy)throw new Error("A reconnectPolicy has already been set.");return e?Array.isArray(e)?this.reconnectPolicy=new n.DefaultReconnectPolicy(e):this.reconnectPolicy=e:this.reconnectPolicy=new n.DefaultReconnectPolicy,this},e.prototype.build=function(){var e=this.httpConnectionOptions||{};if(void 0===e.logger&&(e.logger=this.logger),!this.url)throw new Error("The 'HubConnectionBuilder.withUrl' method must be called before building the connection.");var t=new i.HttpConnection(this.url,e);return a.HubConnection.create(t,this.logger||l.NullLogger.instance,this.protocol||new o.JsonHubProtocol,this.reconnectPolicy)},e}()},function(e,t,r){"use strict";r.r(t),r.d(t,"DefaultReconnectPolicy",(function(){return i}));var n=[0,2e3,1e4,3e4,null],i=function(){function e(e){this.retryDelays=void 0!==e?e.concat([null]):n}return e.prototype.nextRetryDelayInMilliseconds=function(e){return this.retryDelays[e.previousRetryCount]},e}()},function(e,t,r){"use strict";r.r(t),r.d(t,"HttpConnection",(function(){return m})),r.d(t,"TransportSendQueue",(function(){return g}));var n=r(6),i=r(9),a=r(20),s=r(21),o=r(23),l=r(13),c=r(24),u=function(e,t,r,n){return new(r||(r=Promise))((function(i,a){function s(e){try{l(n.next(e))}catch(e){a(e)}}function o(e){try{l(n.throw(e))}catch(e){a(e)}}function l(e){e.done?i(e.value):new r((function(t){t(e.value)})).then(s,o)}l((n=n.apply(e,t||[])).next())}))},h=function(e,t){var r,n,i,a,s={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return a={next:o(0),throw:o(1),return:o(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function o(a){return function(o){return function(a){if(r)throw new TypeError("Generator is already executing.");for(;s;)try{if(r=1,n&&(i=2&a[0]?n.return:a[0]?n.throw||((i=n.return)&&i.call(n),0):n.next)&&!(i=i.call(n,a[1])).done)return i;switch(n=0,i&&(a=[2&a[0],i.value]),a[0]){case 0:case 1:i=a;break;case 4:return s.label++,{value:a[1],done:!1};case 5:s.label++,n=a[1],a=[0];continue;case 7:a=s.ops.pop(),s.trys.pop();continue;default:if(!(i=s.trys,(i=i.length>0&&i[i.length-1])||6!==a[0]&&2!==a[0])){s=0;continue}if(3===a[0]&&(!i||a[1]>i[0]&&a[1]<i[3])){s.label=a[1];break}if(6===a[0]&&s.label<i[1]){s.label=i[1],i=a;break}if(i&&s.label<i[2]){s.label=i[2],s.ops.push(a);break}i[2]&&s.ops.pop(),s.trys.pop();continue}a=t.call(e,s)}catch(e){a=[6,e],n=0}finally{r=i=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,o])}}},f=null,d=null;if(l.Platform.isNode){var p=require;f=p("ws"),d=p("eventsource")}var m=function(){function e(e,t){void 0===t&&(t={}),this.features={},this.negotiateVersion=1,l.Arg.isRequired(e,"url"),this.logger=Object(l.createLogger)(t.logger),this.baseUrl=this.resolveUrl(e),(t=t||{}).logMessageContent=t.logMessageContent||!1,l.Platform.isNode||"undefined"==typeof WebSocket||t.WebSocket?l.Platform.isNode&&!t.WebSocket&&f&&(t.WebSocket=f):t.WebSocket=WebSocket,l.Platform.isNode||"undefined"==typeof EventSource||t.EventSource?l.Platform.isNode&&!t.EventSource&&void 0!==d&&(t.EventSource=d):t.EventSource=EventSource,this.httpClient=t.httpClient||new n.DefaultHttpClient(this.logger),this.connectionState="Disconnected",this.connectionStarted=!1,this.options=t,this.onreceive=null,this.onclose=null}return e.prototype.start=function(e){return u(this,void 0,void 0,(function(){var t;return h(this,(function(r){switch(r.label){case 0:return e=e||a.TransferFormat.Binary,l.Arg.isIn(e,a.TransferFormat,"transferFormat"),this.logger.log(i.LogLevel.Debug,"Starting connection with transfer format '"+a.TransferFormat[e]+"'."),"Disconnected"!==this.connectionState?[2,Promise.reject(new Error("Cannot start an HttpConnection that is not in the 'Disconnected' state."))]:(this.connectionState="Connecting ",this.startInternalPromise=this.startInternal(e),[4,this.startInternalPromise]);case 1:return r.sent(),"Disconnecting"!==this.connectionState?[3,3]:(t="Failed to start the HttpConnection before stop() was called.",this.logger.log(i.LogLevel.Error,t),[4,this.stopPromise]);case 2:return r.sent(),[2,Promise.reject(new Error(t))];case 3:if("Connected"!==this.connectionState)return t="HttpConnection.startInternal completed gracefully but didn't enter the connection into the connected state!",this.logger.log(i.LogLevel.Error,t),[2,Promise.reject(new Error(t))];r.label=4;case 4:return this.connectionStarted=!0,[2]}}))}))},e.prototype.send=function(e){return"Connected"!==this.connectionState?Promise.reject(new Error("Cannot send data if the connection is not in the 'Connected' State.")):(this.sendQueue||(this.sendQueue=new g(this.transport)),this.sendQueue.send(e))},e.prototype.stop=function(e){return u(this,void 0,void 0,(function(){var t=this;return h(this,(function(r){switch(r.label){case 0:return"Disconnected"===this.connectionState?(this.logger.log(i.LogLevel.Debug,"Call to HttpConnection.stop("+e+") ignored because the connection is already in the disconnected state."),[2,Promise.resolve()]):"Disconnecting"===this.connectionState?(this.logger.log(i.LogLevel.Debug,"Call to HttpConnection.stop("+e+") ignored because the connection is already in the disconnecting state."),[2,this.stopPromise]):(this.connectionState="Disconnecting",this.stopPromise=new Promise((function(e){t.stopPromiseResolver=e})),[4,this.stopInternal(e)]);case 1:return r.sent(),[4,this.stopPromise];case 2:return r.sent(),[2]}}))}))},e.prototype.stopInternal=function(e){return u(this,void 0,void 0,(function(){var t,r;return h(this,(function(n){switch(n.label){case 0:this.stopError=e,n.label=1;case 1:return n.trys.push([1,3,,4]),[4,this.startInternalPromise];case 2:return n.sent(),[3,4];case 3:return n.sent(),[3,4];case 4:if(!this.sendQueue)return[3,9];n.label=5;case 5:return n.trys.push([5,7,,8]),[4,this.sendQueue.stop()];case 6:return n.sent(),[3,8];case 7:return t=n.sent(),this.logger.log(i.LogLevel.Error,"TransportSendQueue.stop() threw error '"+t+"'."),[3,8];case 8:this.sendQueue=void 0,n.label=9;case 9:if(!this.transport)return[3,14];n.label=10;case 10:return n.trys.push([10,12,,13]),[4,this.transport.stop()];case 11:return n.sent(),[3,13];case 12:return r=n.sent(),this.logger.log(i.LogLevel.Error,"HttpConnection.transport.stop() threw error '"+r+"'."),this.stopConnection(),[3,13];case 13:return this.transport=void 0,[3,15];case 14:this.logger.log(i.LogLevel.Debug,"HttpConnection.transport is undefined in HttpConnection.stop() because start() failed."),this.stopConnection(),n.label=15;case 15:return[2]}}))}))},e.prototype.startInternal=function(e){return u(this,void 0,void 0,(function(){var t,r,n,o,l,c;return h(this,(function(u){switch(u.label){case 0:t=this.baseUrl,this.accessTokenFactory=this.options.accessTokenFactory,u.label=1;case 1:return u.trys.push([1,12,,13]),this.options.skipNegotiation?this.options.transport!==a.HttpTransportType.WebSockets?[3,3]:(this.transport=this.constructTransport(a.HttpTransportType.WebSockets),[4,this.startTransport(t,e)]):[3,5];case 2:return u.sent(),[3,4];case 3:throw new Error("Negotiation can only be skipped when using the WebSocket transport directly.");case 4:return[3,11];case 5:r=null,n=0,o=function(){var e;return h(this,(function(i){switch(i.label){case 0:return[4,l.getNegotiationResponse(t)];case 1:if(r=i.sent(),"Disconnecting"===l.connectionState||"Disconnected"===l.connectionState)throw new Error("The connection was stopped during negotiation.");if(r.error)throw new Error(r.error);if(r.ProtocolVersion)throw new Error("Detected a connection attempt to an ASP.NET SignalR Server. This client only supports connecting to an ASP.NET Core SignalR Server. See https://aka.ms/signalr-core-differences for details.");return r.url&&(t=r.url),r.accessToken&&(e=r.accessToken,l.accessTokenFactory=function(){return e}),n++,[2]}}))},l=this,u.label=6;case 6:return[5,o()];case 7:u.sent(),u.label=8;case 8:if(r.url&&n<100)return[3,6];u.label=9;case 9:if(100===n&&r.url)throw new Error("Negotiate redirection limit exceeded.");return[4,this.createTransport(t,this.options.transport,r,e)];case 10:u.sent(),u.label=11;case 11:return this.transport instanceof s.LongPollingTransport&&(this.features.inherentKeepAlive=!0),"Connecting "===this.connectionState&&(this.logger.log(i.LogLevel.Debug,"The HttpConnection connected successfully."),this.connectionState="Connected"),[3,13];case 12:return c=u.sent(),this.logger.log(i.LogLevel.Error,"Failed to start the connection: "+c),this.connectionState="Disconnected",this.transport=void 0,[2,Promise.reject(c)];case 13:return[2]}}))}))},e.prototype.getNegotiationResponse=function(e){return u(this,void 0,void 0,(function(){var t,r,n,a,s,o,l;return h(this,(function(c){switch(c.label){case 0:return this.accessTokenFactory?[4,this.accessTokenFactory()]:[3,2];case 1:(n=c.sent())&&((t={}).Authorization="Bearer "+n,r=t),c.label=2;case 2:a=this.resolveNegotiateUrl(e),this.logger.log(i.LogLevel.Debug,"Sending negotiation request: "+a+"."),c.label=3;case 3:return c.trys.push([3,5,,6]),[4,this.httpClient.post(a,{content:"",headers:r})];case 4:return 200!==(s=c.sent()).statusCode?[2,Promise.reject(new Error("Unexpected status code returned from negotiate "+s.statusCode))]:((!(o=JSON.parse(s.content)).negotiateVersion||o.negotiateVersion<1)&&(o.connectionToken=o.connectionId),[2,o]);case 5:return l=c.sent(),this.logger.log(i.LogLevel.Error,"Failed to complete negotiation with the server: "+l),[2,Promise.reject(l)];case 6:return[2]}}))}))},e.prototype.createConnectUrl=function(e,t){return t?e+(-1===e.indexOf("?")?"?":"&")+"id="+t:e},e.prototype.createTransport=function(e,t,r,n){return u(this,void 0,void 0,(function(){var a,s,o,l,c,u,f,d,p,m,g;return h(this,(function(h){switch(h.label){case 0:return a=this.createConnectUrl(e,r.connectionToken),this.isITransport(t)?(this.logger.log(i.LogLevel.Debug,"Connection was provided an instance of ITransport, using that directly."),this.transport=t,[4,this.startTransport(a,n)]):[3,2];case 1:return h.sent(),this.connectionId=r.connectionId,[2];case 2:s=[],o=r.availableTransports||[],l=r,c=0,u=o,h.label=3;case 3:return c<u.length?(f=u[c],(d=this.resolveTransportOrError(f,t,n))instanceof Error?(s.push(f.transport+" failed: "+d),[3,12]):[3,4]):[3,13];case 4:if(!this.isITransport(d))return[3,12];if(this.transport=d,l)return[3,9];h.label=5;case 5:return h.trys.push([5,7,,8]),[4,this.getNegotiationResponse(e)];case 6:return l=h.sent(),[3,8];case 7:return p=h.sent(),[2,Promise.reject(p)];case 8:a=this.createConnectUrl(e,l.connectionToken),h.label=9;case 9:return h.trys.push([9,11,,12]),[4,this.startTransport(a,n)];case 10:return h.sent(),this.connectionId=l.connectionId,[2];case 11:return m=h.sent(),this.logger.log(i.LogLevel.Error,"Failed to start the transport '"+f.transport+"': "+m),l=void 0,s.push(f.transport+" failed: "+m),"Connecting "!==this.connectionState?(g="Failed to select transport before stop() was called.",this.logger.log(i.LogLevel.Debug,g),[2,Promise.reject(new Error(g))]):[3,12];case 12:return c++,[3,3];case 13:return s.length>0?[2,Promise.reject(new Error("Unable to connect to the server with any of the available transports. "+s.join(" ")))]:[2,Promise.reject(new Error("None of the transports supported by the client are supported by the server."))]}}))}))},e.prototype.constructTransport=function(e){switch(e){case a.HttpTransportType.WebSockets:if(!this.options.WebSocket)throw new Error("'WebSocket' is not supported in your environment.");return new c.WebSocketTransport(this.httpClient,this.accessTokenFactory,this.logger,this.options.logMessageContent||!1,this.options.WebSocket);case a.HttpTransportType.ServerSentEvents:if(!this.options.EventSource)throw new Error("'EventSource' is not supported in your environment.");return new o.ServerSentEventsTransport(this.httpClient,this.accessTokenFactory,this.logger,this.options.logMessageContent||!1,this.options.EventSource);case a.HttpTransportType.LongPolling:return new s.LongPollingTransport(this.httpClient,this.accessTokenFactory,this.logger,this.options.logMessageContent||!1);default:throw new Error("Unknown transport: "+e+".")}},e.prototype.startTransport=function(e,t){var r=this;return this.transport.onreceive=this.onreceive,this.transport.onclose=function(e){return r.stopConnection(e)},this.transport.connect(e,t)},e.prototype.resolveTransportOrError=function(e,t,r){var n=a.HttpTransportType[e.transport];if(null==n)return this.logger.log(i.LogLevel.Debug,"Skipping transport '"+e.transport+"' because it is not supported by this client."),new Error("Skipping transport '"+e.transport+"' because it is not supported by this client.");if(!function(e,t){return!e||0!=(t&e)}(t,n))return this.logger.log(i.LogLevel.Debug,"Skipping transport '"+a.HttpTransportType[n]+"' because it was disabled by the client."),new Error("'"+a.HttpTransportType[n]+"' is disabled by the client.");if(!(e.transferFormats.map((function(e){return a.TransferFormat[e]})).indexOf(r)>=0))return this.logger.log(i.LogLevel.Debug,"Skipping transport '"+a.HttpTransportType[n]+"' because it does not support the requested transfer format '"+a.TransferFormat[r]+"'."),new Error("'"+a.HttpTransportType[n]+"' does not support "+a.TransferFormat[r]+".");if(n===a.HttpTransportType.WebSockets&&!this.options.WebSocket||n===a.HttpTransportType.ServerSentEvents&&!this.options.EventSource)return this.logger.log(i.LogLevel.Debug,"Skipping transport '"+a.HttpTransportType[n]+"' because it is not supported in your environment.'"),new Error("'"+a.HttpTransportType[n]+"' is not supported in your environment.");this.logger.log(i.LogLevel.Debug,"Selecting transport '"+a.HttpTransportType[n]+"'.");try{return this.constructTransport(n)}catch(e){return e}},e.prototype.isITransport=function(e){return e&&"object"==typeof e&&"connect"in e},e.prototype.stopConnection=function(e){if(this.logger.log(i.LogLevel.Debug,"HttpConnection.stopConnection("+e+") called while in state "+this.connectionState+"."),this.transport=void 0,e=this.stopError||e,this.stopError=void 0,"Disconnected"!==this.connectionState)if("Connecting "!==this.connectionState){if("Disconnecting"===this.connectionState&&this.stopPromiseResolver(),e?this.logger.log(i.LogLevel.Error,"Connection disconnected with error '"+e+"'."):this.logger.log(i.LogLevel.Information,"Connection disconnected."),this.connectionId=void 0,this.connectionState="Disconnected",this.onclose&&this.connectionStarted){this.connectionStarted=!1;try{this.onclose(e)}catch(t){this.logger.log(i.LogLevel.Error,"HttpConnection.onclose("+e+") threw error '"+t+"'.")}}}else this.logger.log(i.LogLevel.Warning,"Call to HttpConnection.stopConnection("+e+") was ignored because the connection hasn't yet left the in the connecting state.");else this.logger.log(i.LogLevel.Debug,"Call to HttpConnection.stopConnection("+e+") was ignored because the connection is already in the disconnected state.")},e.prototype.resolveUrl=function(e){if(0===e.lastIndexOf("https://",0)||0===e.lastIndexOf("http://",0))return e;if(!l.Platform.isBrowser||!window.document)throw new Error("Cannot resolve '"+e+"'.");var t=window.document.createElement("a");return t.href=e,this.logger.log(i.LogLevel.Information,"Normalizing '"+e+"' to '"+t.href+"'."),t.href},e.prototype.resolveNegotiateUrl=function(e){var t=e.indexOf("?"),r=e.substring(0,-1===t?e.length:t);return"/"!==r[r.length-1]&&(r+="/"),r+="negotiate",-1===(r+=-1===t?"":e.substring(t)).indexOf("negotiateVersion")&&(r+=-1===t?"?":"&",r+="negotiateVersion="+this.negotiateVersion),r},e}();var g=function(){function e(e){this.transport=e,this.buffer=[],this.executing=!0,this.sendBufferedData=new T,this.transportResult=new T,this.sendLoopPromise=this.sendLoop()}return e.prototype.send=function(e){return this.bufferData(e),this.transportResult||(this.transportResult=new T),this.transportResult.promise},e.prototype.stop=function(){return this.executing=!1,this.sendBufferedData.resolve(),this.sendLoopPromise},e.prototype.bufferData=function(e){if(this.buffer.length&&typeof this.buffer[0]!=typeof e)throw new Error("Expected data to be of type "+typeof this.buffer+" but was of type "+typeof e);this.buffer.push(e),this.sendBufferedData.resolve()},e.prototype.sendLoop=function(){return u(this,void 0,void 0,(function(){var t,r,n;return h(this,(function(i){switch(i.label){case 0:return[4,this.sendBufferedData.promise];case 1:if(i.sent(),!this.executing)return this.transportResult&&this.transportResult.reject("Connection stopped."),[3,6];this.sendBufferedData=new T,t=this.transportResult,this.transportResult=void 0,r="string"==typeof this.buffer[0]?this.buffer.join(""):e.concatBuffers(this.buffer),this.buffer.length=0,i.label=2;case 2:return i.trys.push([2,4,,5]),[4,this.transport.send(r)];case 3:return i.sent(),t.resolve(),[3,5];case 4:return n=i.sent(),t.reject(n),[3,5];case 5:return[3,0];case 6:return[2]}}))}))},e.concatBuffers=function(e){for(var t=e.map((function(e){return e.byteLength})).reduce((function(e,t){return e+t})),r=new Uint8Array(t),n=0,i=0,a=e;i<a.length;i++){var s=a[i];r.set(new Uint8Array(s),n),n+=s.byteLength}return r},e}(),T=function(){function e(){var e=this;this.promise=new Promise((function(t,r){var n;return n=[t,r],e.resolver=n[0],e.rejecter=n[1],n}))}return e.prototype.resolve=function(){this.resolver()},e.prototype.reject=function(e){this.rejecter(e)},e}()},function(e,t,r){"use strict";var n,i;r.r(t),r.d(t,"HttpTransportType",(function(){return n})),r.d(t,"TransferFormat",(function(){return i})),function(e){e[e.None=0]="None",e[e.WebSockets=1]="WebSockets",e[e.ServerSentEvents=2]="ServerSentEvents",e[e.LongPolling=4]="LongPolling"}(n||(n={})),function(e){e[e.Text=1]="Text",e[e.Binary=2]="Binary"}(i||(i={}))},function(e,t,r){"use strict";r.r(t),r.d(t,"LongPollingTransport",(function(){return u}));var n=r(22),i=r(4),a=r(9),s=r(20),o=r(13),l=function(e,t,r,n){return new(r||(r=Promise))((function(i,a){function s(e){try{l(n.next(e))}catch(e){a(e)}}function o(e){try{l(n.throw(e))}catch(e){a(e)}}function l(e){e.done?i(e.value):new r((function(t){t(e.value)})).then(s,o)}l((n=n.apply(e,t||[])).next())}))},c=function(e,t){var r,n,i,a,s={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return a={next:o(0),throw:o(1),return:o(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function o(a){return function(o){return function(a){if(r)throw new TypeError("Generator is already executing.");for(;s;)try{if(r=1,n&&(i=2&a[0]?n.return:a[0]?n.throw||((i=n.return)&&i.call(n),0):n.next)&&!(i=i.call(n,a[1])).done)return i;switch(n=0,i&&(a=[2&a[0],i.value]),a[0]){case 0:case 1:i=a;break;case 4:return s.label++,{value:a[1],done:!1};case 5:s.label++,n=a[1],a=[0];continue;case 7:a=s.ops.pop(),s.trys.pop();continue;default:if(!(i=s.trys,(i=i.length>0&&i[i.length-1])||6!==a[0]&&2!==a[0])){s=0;continue}if(3===a[0]&&(!i||a[1]>i[0]&&a[1]<i[3])){s.label=a[1];break}if(6===a[0]&&s.label<i[1]){s.label=i[1],i=a;break}if(i&&s.label<i[2]){s.label=i[2],s.ops.push(a);break}i[2]&&s.ops.pop(),s.trys.pop();continue}a=t.call(e,s)}catch(e){a=[6,e],n=0}finally{r=i=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,o])}}},u=function(){function e(e,t,r,i){this.httpClient=e,this.accessTokenFactory=t,this.logger=r,this.pollAbort=new n.AbortController,this.logMessageContent=i,this.running=!1,this.onreceive=null,this.onclose=null}return Object.defineProperty(e.prototype,"pollAborted",{get:function(){return this.pollAbort.aborted},enumerable:!0,configurable:!0}),e.prototype.connect=function(e,t){return l(this,void 0,void 0,(function(){var r,n,l,u;return c(this,(function(c){switch(c.label){case 0:if(o.Arg.isRequired(e,"url"),o.Arg.isRequired(t,"transferFormat"),o.Arg.isIn(t,s.TransferFormat,"transferFormat"),this.url=e,this.logger.log(a.LogLevel.Trace,"(LongPolling transport) Connecting."),t===s.TransferFormat.Binary&&"undefined"!=typeof XMLHttpRequest&&"string"!=typeof(new XMLHttpRequest).responseType)throw new Error("Binary protocols over XmlHttpRequest not implementing advanced features are not supported.");return r={abortSignal:this.pollAbort.signal,headers:{},timeout:1e5},t===s.TransferFormat.Binary&&(r.responseType="arraybuffer"),[4,this.getAccessToken()];case 1:return n=c.sent(),this.updateHeaderToken(r,n),l=e+"&_="+Date.now(),this.logger.log(a.LogLevel.Trace,"(LongPolling transport) polling: "+l+"."),[4,this.httpClient.get(l,r)];case 2:return 200!==(u=c.sent()).statusCode?(this.logger.log(a.LogLevel.Error,"(LongPolling transport) Unexpected response code: "+u.statusCode+"."),this.closeError=new i.HttpError(u.statusText||"",u.statusCode),this.running=!1):this.running=!0,this.receiving=this.poll(this.url,r),[2]}}))}))},e.prototype.getAccessToken=function(){return l(this,void 0,void 0,(function(){return c(this,(function(e){switch(e.label){case 0:return this.accessTokenFactory?[4,this.accessTokenFactory()]:[3,2];case 1:return[2,e.sent()];case 2:return[2,null]}}))}))},e.prototype.updateHeaderToken=function(e,t){e.headers||(e.headers={}),t?e.headers.Authorization="Bearer "+t:e.headers.Authorization&&delete e.headers.Authorization},e.prototype.poll=function(e,t){return l(this,void 0,void 0,(function(){var r,n,s,l;return c(this,(function(c){switch(c.label){case 0:c.trys.push([0,,8,9]),c.label=1;case 1:return this.running?[4,this.getAccessToken()]:[3,7];case 2:r=c.sent(),this.updateHeaderToken(t,r),c.label=3;case 3:return c.trys.push([3,5,,6]),n=e+"&_="+Date.now(),this.logger.log(a.LogLevel.Trace,"(LongPolling transport) polling: "+n+"."),[4,this.httpClient.get(n,t)];case 4:return 204===(s=c.sent()).statusCode?(this.logger.log(a.LogLevel.Information,"(LongPolling transport) Poll terminated by server."),this.running=!1):200!==s.statusCode?(this.logger.log(a.LogLevel.Error,"(LongPolling transport) Unexpected response code: "+s.statusCode+"."),this.closeError=new i.HttpError(s.statusText||"",s.statusCode),this.running=!1):s.content?(this.logger.log(a.LogLevel.Trace,"(LongPolling transport) data received. "+Object(o.getDataDetail)(s.content,this.logMessageContent)+"."),this.onreceive&&this.onreceive(s.content)):this.logger.log(a.LogLevel.Trace,"(LongPolling transport) Poll timed out, reissuing."),[3,6];case 5:return l=c.sent(),this.running?l instanceof i.TimeoutError?this.logger.log(a.LogLevel.Trace,"(LongPolling transport) Poll timed out, reissuing."):(this.closeError=l,this.running=!1):this.logger.log(a.LogLevel.Trace,"(LongPolling transport) Poll errored after shutdown: "+l.message),[3,6];case 6:return[3,1];case 7:return[3,9];case 8:return this.logger.log(a.LogLevel.Trace,"(LongPolling transport) Polling complete."),this.pollAborted||this.raiseOnClose(),[7];case 9:return[2]}}))}))},e.prototype.send=function(e){return l(this,void 0,void 0,(function(){return c(this,(function(t){return this.running?[2,Object(o.sendMessage)(this.logger,"LongPolling",this.httpClient,this.url,this.accessTokenFactory,e,this.logMessageContent)]:[2,Promise.reject(new Error("Cannot send until the transport is connected"))]}))}))},e.prototype.stop=function(){return l(this,void 0,void 0,(function(){var e,t;return c(this,(function(r){switch(r.label){case 0:this.logger.log(a.LogLevel.Trace,"(LongPolling transport) Stopping polling."),this.running=!1,this.pollAbort.abort(),r.label=1;case 1:return r.trys.push([1,,5,6]),[4,this.receiving];case 2:return r.sent(),this.logger.log(a.LogLevel.Trace,"(LongPolling transport) sending DELETE request to "+this.url+"."),e={headers:{}},[4,this.getAccessToken()];case 3:return t=r.sent(),this.updateHeaderToken(e,t),[4,this.httpClient.delete(this.url,e)];case 4:return r.sent(),this.logger.log(a.LogLevel.Trace,"(LongPolling transport) DELETE request sent."),[3,6];case 5:return this.logger.log(a.LogLevel.Trace,"(LongPolling transport) Stop finished."),this.raiseOnClose(),[7];case 6:return[2]}}))}))},e.prototype.raiseOnClose=function(){if(this.onclose){var e="(LongPolling transport) Firing onclose event.";this.closeError&&(e+=" Error: "+this.closeError),this.logger.log(a.LogLevel.Trace,e),this.onclose(this.closeError)}},e}()},function(e,t,r){"use strict";r.r(t),r.d(t,"AbortController",(function(){return n}));var n=function(){function e(){this.isAborted=!1,this.onabort=null}return e.prototype.abort=function(){this.isAborted||(this.isAborted=!0,this.onabort&&this.onabort())},Object.defineProperty(e.prototype,"signal",{get:function(){return this},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"aborted",{get:function(){return this.isAborted},enumerable:!0,configurable:!0}),e}()},function(e,t,r){"use strict";r.r(t),r.d(t,"ServerSentEventsTransport",(function(){return l}));var n=r(9),i=r(20),a=r(13),s=function(e,t,r,n){return new(r||(r=Promise))((function(i,a){function s(e){try{l(n.next(e))}catch(e){a(e)}}function o(e){try{l(n.throw(e))}catch(e){a(e)}}function l(e){e.done?i(e.value):new r((function(t){t(e.value)})).then(s,o)}l((n=n.apply(e,t||[])).next())}))},o=function(e,t){var r,n,i,a,s={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return a={next:o(0),throw:o(1),return:o(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function o(a){return function(o){return function(a){if(r)throw new TypeError("Generator is already executing.");for(;s;)try{if(r=1,n&&(i=2&a[0]?n.return:a[0]?n.throw||((i=n.return)&&i.call(n),0):n.next)&&!(i=i.call(n,a[1])).done)return i;switch(n=0,i&&(a=[2&a[0],i.value]),a[0]){case 0:case 1:i=a;break;case 4:return s.label++,{value:a[1],done:!1};case 5:s.label++,n=a[1],a=[0];continue;case 7:a=s.ops.pop(),s.trys.pop();continue;default:if(!(i=s.trys,(i=i.length>0&&i[i.length-1])||6!==a[0]&&2!==a[0])){s=0;continue}if(3===a[0]&&(!i||a[1]>i[0]&&a[1]<i[3])){s.label=a[1];break}if(6===a[0]&&s.label<i[1]){s.label=i[1],i=a;break}if(i&&s.label<i[2]){s.label=i[2],s.ops.push(a);break}i[2]&&s.ops.pop(),s.trys.pop();continue}a=t.call(e,s)}catch(e){a=[6,e],n=0}finally{r=i=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,o])}}},l=function(){function e(e,t,r,n,i){this.httpClient=e,this.accessTokenFactory=t,this.logger=r,this.logMessageContent=n,this.eventSourceConstructor=i,this.onreceive=null,this.onclose=null}return e.prototype.connect=function(e,t){return s(this,void 0,void 0,(function(){var r,s=this;return o(this,(function(o){switch(o.label){case 0:return a.Arg.isRequired(e,"url"),a.Arg.isRequired(t,"transferFormat"),a.Arg.isIn(t,i.TransferFormat,"transferFormat"),this.logger.log(n.LogLevel.Trace,"(SSE transport) Connecting."),this.url=e,this.accessTokenFactory?[4,this.accessTokenFactory()]:[3,2];case 1:(r=o.sent())&&(e+=(e.indexOf("?")<0?"?":"&")+"access_token="+encodeURIComponent(r)),o.label=2;case 2:return[2,new Promise((function(r,o){var l=!1;if(t===i.TransferFormat.Text){var c;if(a.Platform.isBrowser||a.Platform.isWebWorker)c=new s.eventSourceConstructor(e,{withCredentials:!0});else{var u=s.httpClient.getCookieString(e);c=new s.eventSourceConstructor(e,{withCredentials:!0,headers:{Cookie:u}})}try{c.onmessage=function(e){if(s.onreceive)try{s.logger.log(n.LogLevel.Trace,"(SSE transport) data received. "+Object(a.getDataDetail)(e.data,s.logMessageContent)+"."),s.onreceive(e.data)}catch(e){return void s.close(e)}},c.onerror=function(e){var t=new Error(e.data||"Error occurred");l?s.close(t):o(t)},c.onopen=function(){s.logger.log(n.LogLevel.Information,"SSE connected to "+s.url),s.eventSource=c,l=!0,r()}}catch(e){return void o(e)}}else o(new Error("The Server-Sent Events transport only supports the 'Text' transfer format"))}))]}}))}))},e.prototype.send=function(e){return s(this,void 0,void 0,(function(){return o(this,(function(t){return this.eventSource?[2,Object(a.sendMessage)(this.logger,"SSE",this.httpClient,this.url,this.accessTokenFactory,e,this.logMessageContent)]:[2,Promise.reject(new Error("Cannot send until the transport is connected"))]}))}))},e.prototype.stop=function(){return this.close(),Promise.resolve()},e.prototype.close=function(e){this.eventSource&&(this.eventSource.close(),this.eventSource=void 0,this.onclose&&this.onclose(e))},e}()},function(e,t,r){"use strict";r.r(t),r.d(t,"WebSocketTransport",(function(){return l}));var n=r(9),i=r(20),a=r(13),s=function(e,t,r,n){return new(r||(r=Promise))((function(i,a){function s(e){try{l(n.next(e))}catch(e){a(e)}}function o(e){try{l(n.throw(e))}catch(e){a(e)}}function l(e){e.done?i(e.value):new r((function(t){t(e.value)})).then(s,o)}l((n=n.apply(e,t||[])).next())}))},o=function(e,t){var r,n,i,a,s={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return a={next:o(0),throw:o(1),return:o(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function o(a){return function(o){return function(a){if(r)throw new TypeError("Generator is already executing.");for(;s;)try{if(r=1,n&&(i=2&a[0]?n.return:a[0]?n.throw||((i=n.return)&&i.call(n),0):n.next)&&!(i=i.call(n,a[1])).done)return i;switch(n=0,i&&(a=[2&a[0],i.value]),a[0]){case 0:case 1:i=a;break;case 4:return s.label++,{value:a[1],done:!1};case 5:s.label++,n=a[1],a=[0];continue;case 7:a=s.ops.pop(),s.trys.pop();continue;default:if(!(i=s.trys,(i=i.length>0&&i[i.length-1])||6!==a[0]&&2!==a[0])){s=0;continue}if(3===a[0]&&(!i||a[1]>i[0]&&a[1]<i[3])){s.label=a[1];break}if(6===a[0]&&s.label<i[1]){s.label=i[1],i=a;break}if(i&&s.label<i[2]){s.label=i[2],s.ops.push(a);break}i[2]&&s.ops.pop(),s.trys.pop();continue}a=t.call(e,s)}catch(e){a=[6,e],n=0}finally{r=i=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,o])}}},l=function(){function e(e,t,r,n,i){this.logger=r,this.accessTokenFactory=t,this.logMessageContent=n,this.webSocketConstructor=i,this.httpClient=e,this.onreceive=null,this.onclose=null}return e.prototype.connect=function(e,t){return s(this,void 0,void 0,(function(){var r,s=this;return o(this,(function(o){switch(o.label){case 0:return a.Arg.isRequired(e,"url"),a.Arg.isRequired(t,"transferFormat"),a.Arg.isIn(t,i.TransferFormat,"transferFormat"),this.logger.log(n.LogLevel.Trace,"(WebSockets transport) Connecting."),this.accessTokenFactory?[4,this.accessTokenFactory()]:[3,2];case 1:(r=o.sent())&&(e+=(e.indexOf("?")<0?"?":"&")+"access_token="+encodeURIComponent(r)),o.label=2;case 2:return[2,new Promise((function(r,o){var l;e=e.replace(/^http/,"ws");var c=s.httpClient.getCookieString(e),u=!1;a.Platform.isNode&&c&&(l=new s.webSocketConstructor(e,void 0,{headers:{Cookie:""+c}})),l||(l=new s.webSocketConstructor(e)),t===i.TransferFormat.Binary&&(l.binaryType="arraybuffer"),l.onopen=function(t){s.logger.log(n.LogLevel.Information,"WebSocket connected to "+e+"."),s.webSocket=l,u=!0,r()},l.onerror=function(e){var t=null;t="undefined"!=typeof ErrorEvent&&e instanceof ErrorEvent?e.error:new Error("There was an error with the transport."),o(t)},l.onmessage=function(e){s.logger.log(n.LogLevel.Trace,"(WebSockets transport) data received. "+Object(a.getDataDetail)(e.data,s.logMessageContent)+"."),s.onreceive&&s.onreceive(e.data)},l.onclose=function(e){if(u)s.close(e);else{var t=null;t="undefined"!=typeof ErrorEvent&&e instanceof ErrorEvent?e.error:new Error("There was an error with the transport."),o(t)}}}))]}}))}))},e.prototype.send=function(e){return this.webSocket&&this.webSocket.readyState===this.webSocketConstructor.OPEN?(this.logger.log(n.LogLevel.Trace,"(WebSockets transport) sending data. "+Object(a.getDataDetail)(e,this.logMessageContent)+"."),this.webSocket.send(e),Promise.resolve()):Promise.reject("WebSocket is not in the OPEN state")},e.prototype.stop=function(){return this.webSocket&&(this.webSocket.onclose=function(){},this.webSocket.onmessage=function(){},this.webSocket.onerror=function(){},this.webSocket.close(),this.webSocket=void 0,this.close(void 0)),Promise.resolve()},e.prototype.close=function(e){this.logger.log(n.LogLevel.Trace,"(WebSockets transport) socket closed."),this.onclose&&(!e||!1!==e.wasClean&&1e3===e.code?this.onclose():this.onclose(new Error("WebSocket closed with status code: "+e.code+" ("+e.reason+").")))},e}()},function(e,t,r){"use strict";r.r(t),r.d(t,"JsonHubProtocol",(function(){return l}));var n=r(15),i=r(9),a=r(20),s=r(14),o=r(12),l=function(){function e(){this.name="json",this.version=1,this.transferFormat=a.TransferFormat.Text}return e.prototype.parseMessages=function(e,t){if("string"!=typeof e)throw new Error("Invalid input for JSON hub protocol. Expected a string.");if(!e)return[];null===t&&(t=s.NullLogger.instance);for(var r=[],a=0,l=o.TextMessageFormat.parse(e);a<l.length;a++){var c=l[a],u=JSON.parse(c);if("number"!=typeof u.type)throw new Error("Invalid payload.");switch(u.type){case n.MessageType.Invocation:this.isInvocationMessage(u);break;case n.MessageType.StreamItem:this.isStreamItemMessage(u);break;case n.MessageType.Completion:this.isCompletionMessage(u);break;case n.MessageType.Ping:case n.MessageType.Close:break;default:t.log(i.LogLevel.Information,"Unknown message type '"+u.type+"' ignored.");continue}r.push(u)}return r},e.prototype.writeMessage=function(e){return o.TextMessageFormat.write(JSON.stringify(e))},e.prototype.isInvocationMessage=function(e){this.assertNotEmptyString(e.target,"Invalid payload for Invocation message."),void 0!==e.invocationId&&this.assertNotEmptyString(e.invocationId,"Invalid payload for Invocation message.")},e.prototype.isStreamItemMessage=function(e){if(this.assertNotEmptyString(e.invocationId,"Invalid payload for StreamItem message."),void 0===e.item)throw new Error("Invalid payload for StreamItem message.")},e.prototype.isCompletionMessage=function(e){if(e.result&&e.error)throw new Error("Invalid payload for Completion message.");!e.result&&e.error&&this.assertNotEmptyString(e.error,"Invalid payload for Completion message."),this.assertNotEmptyString(e.invocationId,"Invalid payload for Completion message.")},e.prototype.assertNotEmptyString=function(e,t){if("string"!=typeof e||""===e)throw new Error(t)},e}()}])})),function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():(e=e||self).DOMPurify=t()}(this,(function(){"use strict";var e=Object.hasOwnProperty,t=Object.setPrototypeOf,r=Object.isFrozen,n=Object.getPrototypeOf,i=Object.getOwnPropertyDescriptor,a=Object.freeze,s=Object.seal,o=Object.create,l="undefined"!=typeof Reflect&&Reflect,c=l.apply,u=l.construct;c||(c=function(e,t,r){return e.apply(t,r)}),a||(a=function(e){return e}),s||(s=function(e){return e}),u||(u=function(e,t){return new(Function.prototype.bind.apply(e,[null].concat(function(e){if(Array.isArray(e)){for(var t=0,r=Array(e.length);t<e.length;t++)r[t]=e[t];return r}return Array.from(e)}(t))))});var h,f=b(Array.prototype.forEach),d=b(Array.prototype.pop),p=b(Array.prototype.push),m=b(String.prototype.toLowerCase),g=b(String.prototype.match),T=b(String.prototype.replace),y=b(String.prototype.indexOf),v=b(String.prototype.trim),E=b(RegExp.prototype.test),C=(h=TypeError,function(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];return u(h,t)});function b(e){return function(t){for(var r=arguments.length,n=Array(r>1?r-1:0),i=1;i<r;i++)n[i-1]=arguments[i];return c(e,t,n)}}function S(e,n){t&&t(e,null);for(var i=n.length;i--;){var a=n[i];if("string"==typeof a){var s=m(a);s!==a&&(r(n)||(n[i]=s),a=s)}e[a]=!0}return e}function I(t){var r=o(null),n=void 0;for(n in t)c(e,t,[n])&&(r[n]=t[n]);return r}function x(e,t){for(;null!==e;){var r=i(e,t);if(r){if(r.get)return b(r.get);if("function"==typeof r.value)return b(r.value)}e=n(e)}return function(e){return console.warn("fallback value for",e),null}}var P=a(["a","abbr","acronym","address","area","article","aside","audio","b","bdi","bdo","big","blink","blockquote","body","br","button","canvas","caption","center","cite","code","col","colgroup","content","data","datalist","dd","decorator","del","details","dfn","dialog","dir","div","dl","dt","element","em","fieldset","figcaption","figure","font","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","img","input","ins","kbd","label","legend","li","main","map","mark","marquee","menu","menuitem","meter","nav","nobr","ol","optgroup","option","output","p","picture","pre","progress","q","rp","rt","ruby","s","samp","section","select","shadow","small","source","spacer","span","strike","strong","style","sub","summary","sup","table","tbody","td","template","textarea","tfoot","th","thead","time","tr","track","tt","u","ul","var","video","wbr"]),w=a(["svg","a","altglyph","altglyphdef","altglyphitem","animatecolor","animatemotion","animatetransform","circle","clippath","defs","desc","ellipse","filter","font","g","glyph","glyphref","hkern","image","line","lineargradient","marker","mask","metadata","mpath","path","pattern","polygon","polyline","radialgradient","rect","stop","style","switch","symbol","text","textpath","title","tref","tspan","view","vkern"]),D=a(["feBlend","feColorMatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feDistantLight","feFlood","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feMerge","feMergeNode","feMorphology","feOffset","fePointLight","feSpecularLighting","feSpotLight","feTile","feTurbulence"]),_=a(["animate","color-profile","cursor","discard","fedropshadow","feimage","font-face","font-face-format","font-face-name","font-face-src","font-face-uri","foreignobject","hatch","hatchpath","mesh","meshgradient","meshpatch","meshrow","missing-glyph","script","set","solidcolor","unknown","use"]),A=a(["math","menclose","merror","mfenced","mfrac","mglyph","mi","mlabeledtr","mmultiscripts","mn","mo","mover","mpadded","mphantom","mroot","mrow","ms","mspace","msqrt","mstyle","msub","msup","msubsup","mtable","mtd","mtext","mtr","munder","munderover"]),R=a(["maction","maligngroup","malignmark","mlongdiv","mscarries","mscarry","msgroup","mstack","msline","msrow","semantics","annotation","annotation-xml","mprescripts","none"]),M=a(["#text"]),N=a(["accept","action","align","alt","autocapitalize","autocomplete","autopictureinpicture","autoplay","background","bgcolor","border","capture","cellpadding","cellspacing","checked","cite","class","clear","color","cols","colspan","controls","controlslist","coords","crossorigin","datetime","decoding","default","dir","disabled","disablepictureinpicture","disableremoteplayback","download","draggable","enctype","enterkeyhint","face","for","headers","height","hidden","high","href","hreflang","id","inputmode","integrity","ismap","kind","label","lang","list","loading","loop","low","max","maxlength","media","method","min","minlength","multiple","muted","name","noshade","novalidate","nowrap","open","optimum","pattern","placeholder","playsinline","poster","preload","pubdate","radiogroup","readonly","rel","required","rev","reversed","role","rows","rowspan","spellcheck","scope","selected","shape","size","sizes","span","srclang","start","src","srcset","step","style","summary","tabindex","title","translate","type","usemap","valign","value","width","xmlns","slot"]),k=a(["accent-height","accumulate","additive","alignment-baseline","ascent","attributename","attributetype","azimuth","basefrequency","baseline-shift","begin","bias","by","class","clip","clippathunits","clip-path","clip-rule","color","color-interpolation","color-interpolation-filters","color-profile","color-rendering","cx","cy","d","dx","dy","diffuseconstant","direction","display","divisor","dur","edgemode","elevation","end","fill","fill-opacity","fill-rule","filter","filterunits","flood-color","flood-opacity","font-family","font-size","font-size-adjust","font-stretch","font-style","font-variant","font-weight","fx","fy","g1","g2","glyph-name","glyphref","gradientunits","gradienttransform","height","href","id","image-rendering","in","in2","k","k1","k2","k3","k4","kerning","keypoints","keysplines","keytimes","lang","lengthadjust","letter-spacing","kernelmatrix","kernelunitlength","lighting-color","local","marker-end","marker-mid","marker-start","markerheight","markerunits","markerwidth","maskcontentunits","maskunits","max","mask","media","method","mode","min","name","numoctaves","offset","operator","opacity","order","orient","orientation","origin","overflow","paint-order","path","pathlength","patterncontentunits","patterntransform","patternunits","points","preservealpha","preserveaspectratio","primitiveunits","r","rx","ry","radius","refx","refy","repeatcount","repeatdur","restart","result","rotate","scale","seed","shape-rendering","specularconstant","specularexponent","spreadmethod","startoffset","stddeviation","stitchtiles","stop-color","stop-opacity","stroke-dasharray","stroke-dashoffset","stroke-linecap","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke","stroke-width","style","surfacescale","systemlanguage","tabindex","targetx","targety","transform","text-anchor","text-decoration","text-rendering","textlength","type","u1","u2","unicode","values","viewbox","visibility","version","vert-adv-y","vert-origin-x","vert-origin-y","width","word-spacing","wrap","writing-mode","xchannelselector","ychannelselector","x","x1","x2","xmlns","y","y1","y2","z","zoomandpan"]),O=a(["accent","accentunder","align","bevelled","close","columnsalign","columnlines","columnspan","denomalign","depth","dir","display","displaystyle","encoding","fence","frame","height","href","id","largeop","length","linethickness","lspace","lquote","mathbackground","mathcolor","mathsize","mathvariant","maxsize","minsize","movablelimits","notation","numalign","open","rowalign","rowlines","rowspacing","rowspan","rspace","rquote","scriptlevel","scriptminsize","scriptsizemultiplier","selection","separator","separators","stretchy","subscriptshift","supscriptshift","symmetric","voffset","width","xmlns"]),L=a(["xlink:href","xml:id","xlink:title","xml:space","xmlns:xlink"]),F=s(/\{\{[\s\S]*|[\s\S]*\}\}/gm),B=s(/<%[\s\S]*|[\s\S]*%>/gm),V=s(/^data-[\-\w.\u00B7-\uFFFF]/),U=s(/^aria-[\-\w]+$/),H=s(/^(?:(?:(?:f|ht)tps?|mailto|tel|callto|cid|xmpp):|[^a-z]|[a-z+.\-]+(?:[^a-z+.\-:]|$))/i),z=s(/^(?:\w+script|data):/i),j=s(/[\u0000-\u0020\u00A0\u1680\u180E\u2000-\u2029\u205F\u3000]/g),q="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};function G(e){if(Array.isArray(e)){for(var t=0,r=Array(e.length);t<e.length;t++)r[t]=e[t];return r}return Array.from(e)}var W=function(){return"undefined"==typeof window?null:window},Y=function(e,t){if("object"!==(void 0===e?"undefined":q(e))||"function"!=typeof e.createPolicy)return null;var r=null,n="data-tt-policy-suffix";t.currentScript&&t.currentScript.hasAttribute(n)&&(r=t.currentScript.getAttribute(n));var i="dompurify"+(r?"#"+r:"");try{return e.createPolicy(i,{createHTML:function(e){return e}})}catch(e){return console.warn("TrustedTypes policy "+i+" could not be created."),null}};return function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:W(),r=function(t){return e(t)};if(r.version="2.2.9",r.removed=[],!t||!t.document||9!==t.document.nodeType)return r.isSupported=!1,r;var n=t.document,i=t.document,s=t.DocumentFragment,o=t.HTMLTemplateElement,l=t.Node,c=t.Element,u=t.NodeFilter,h=t.NamedNodeMap,b=void 0===h?t.NamedNodeMap||t.MozNamedAttrMap:h,K=t.Text,Q=t.Comment,X=t.DOMParser,$=t.trustedTypes,Z=c.prototype,J=x(Z,"cloneNode"),ee=x(Z,"nextSibling"),te=x(Z,"childNodes"),re=x(Z,"parentNode");if("function"==typeof o){var ne=i.createElement("template");ne.content&&ne.content.ownerDocument&&(i=ne.content.ownerDocument)}var ie=Y($,n),ae=ie&&Le?ie.createHTML(""):"",se=i,oe=se.implementation,le=se.createNodeIterator,ce=se.createDocumentFragment,ue=n.importNode,he={};try{he=I(i).documentMode?i.documentMode:{}}catch(e){}var fe={};r.isSupported="function"==typeof re&&oe&&void 0!==oe.createHTMLDocument&&9!==he;var de=F,pe=B,me=V,ge=U,Te=z,ye=j,ve=H,Ee=null,Ce=S({},[].concat(G(P),G(w),G(D),G(A),G(M))),be=null,Se=S({},[].concat(G(N),G(k),G(O),G(L))),Ie=null,xe=null,Pe=!0,we=!0,De=!1,_e=!1,Ae=!1,Re=!1,Me=!1,Ne=!1,ke=!1,Oe=!0,Le=!1,Fe=!0,Be=!0,Ve=!1,Ue={},He=S({},["annotation-xml","audio","colgroup","desc","foreignobject","head","iframe","math","mi","mn","mo","ms","mtext","noembed","noframes","noscript","plaintext","script","style","svg","template","thead","title","video","xmp"]),ze=null,je=S({},["audio","video","img","source","image","track"]),qe=null,Ge=S({},["alt","class","for","id","label","name","pattern","placeholder","summary","title","value","style","xmlns"]),We="http://www.w3.org/1998/Math/MathML",Ye="http://www.w3.org/2000/svg",Ke="http://www.w3.org/1999/xhtml",Qe=Ke,Xe=!1,$e=null,Ze=i.createElement("form"),Je=function(e){$e&&$e===e||(e&&"object"===(void 0===e?"undefined":q(e))||(e={}),e=I(e),Ee="ALLOWED_TAGS"in e?S({},e.ALLOWED_TAGS):Ce,be="ALLOWED_ATTR"in e?S({},e.ALLOWED_ATTR):Se,qe="ADD_URI_SAFE_ATTR"in e?S(I(Ge),e.ADD_URI_SAFE_ATTR):Ge,ze="ADD_DATA_URI_TAGS"in e?S(I(je),e.ADD_DATA_URI_TAGS):je,Ie="FORBID_TAGS"in e?S({},e.FORBID_TAGS):{},xe="FORBID_ATTR"in e?S({},e.FORBID_ATTR):{},Ue="USE_PROFILES"in e&&e.USE_PROFILES,Pe=!1!==e.ALLOW_ARIA_ATTR,we=!1!==e.ALLOW_DATA_ATTR,De=e.ALLOW_UNKNOWN_PROTOCOLS||!1,_e=e.SAFE_FOR_TEMPLATES||!1,Ae=e.WHOLE_DOCUMENT||!1,Ne=e.RETURN_DOM||!1,ke=e.RETURN_DOM_FRAGMENT||!1,Oe=!1!==e.RETURN_DOM_IMPORT,Le=e.RETURN_TRUSTED_TYPE||!1,Me=e.FORCE_BODY||!1,Fe=!1!==e.SANITIZE_DOM,Be=!1!==e.KEEP_CONTENT,Ve=e.IN_PLACE||!1,ve=e.ALLOWED_URI_REGEXP||ve,Qe=e.NAMESPACE||Ke,_e&&(we=!1),ke&&(Ne=!0),Ue&&(Ee=S({},[].concat(G(M))),be=[],!0===Ue.html&&(S(Ee,P),S(be,N)),!0===Ue.svg&&(S(Ee,w),S(be,k),S(be,L)),!0===Ue.svgFilters&&(S(Ee,D),S(be,k),S(be,L)),!0===Ue.mathMl&&(S(Ee,A),S(be,O),S(be,L))),e.ADD_TAGS&&(Ee===Ce&&(Ee=I(Ee)),S(Ee,e.ADD_TAGS)),e.ADD_ATTR&&(be===Se&&(be=I(be)),S(be,e.ADD_ATTR)),e.ADD_URI_SAFE_ATTR&&S(qe,e.ADD_URI_SAFE_ATTR),Be&&(Ee["#text"]=!0),Ae&&S(Ee,["html","head","body"]),Ee.table&&(S(Ee,["tbody"]),delete Ie.tbody),a&&a(e),$e=e)},et=S({},["mi","mo","mn","ms","mtext"]),tt=S({},["foreignobject","desc","title","annotation-xml"]),rt=S({},w);S(rt,D),S(rt,_);var nt=S({},A);S(nt,R);var it=function(e){var t=re(e);t&&t.tagName||(t={namespaceURI:Ke,tagName:"template"});var r=m(e.tagName),n=m(t.tagName);if(e.namespaceURI===Ye)return t.namespaceURI===Ke?"svg"===r:t.namespaceURI===We?"svg"===r&&("annotation-xml"===n||et[n]):Boolean(rt[r]);if(e.namespaceURI===We)return t.namespaceURI===Ke?"math"===r:t.namespaceURI===Ye?"math"===r&&tt[n]:Boolean(nt[r]);if(e.namespaceURI===Ke){if(t.namespaceURI===Ye&&!tt[n])return!1;if(t.namespaceURI===We&&!et[n])return!1;var i=S({},["title","style","font","a","script"]);return!nt[r]&&(i[r]||!rt[r])}return!1},at=function(e){p(r.removed,{element:e});try{e.parentNode.removeChild(e)}catch(t){try{e.outerHTML=ae}catch(t){e.remove()}}},st=function(e,t){try{p(r.removed,{attribute:t.getAttributeNode(e),from:t})}catch(e){p(r.removed,{attribute:null,from:t})}if(t.removeAttribute(e),"is"===e&&!be[e])if(Ne||ke)try{at(t)}catch(e){}else try{t.setAttribute(e,"")}catch(e){}},ot=function(e){var t=void 0,r=void 0;if(Me)e="<remove></remove>"+e;else{var n=g(e,/^[\r\n\t ]+/);r=n&&n[0]}var a=ie?ie.createHTML(e):e;if(Qe===Ke)try{t=(new X).parseFromString(a,"text/html")}catch(e){}if(!t||!t.documentElement){t=oe.createDocument(Qe,"template",null);try{t.documentElement.innerHTML=Xe?"":a}catch(e){}}var s=t.body||t.documentElement;return e&&r&&s.insertBefore(i.createTextNode(r),s.childNodes[0]||null),Ae?t.documentElement:s},lt=function(e){return le.call(e.ownerDocument||e,e,u.SHOW_ELEMENT|u.SHOW_COMMENT|u.SHOW_TEXT,null,!1)},ct=function(e){return!(e instanceof K||e instanceof Q||"string"==typeof e.nodeName&&"string"==typeof e.textContent&&"function"==typeof e.removeChild&&e.attributes instanceof b&&"function"==typeof e.removeAttribute&&"function"==typeof e.setAttribute&&"string"==typeof e.namespaceURI&&"function"==typeof e.insertBefore)},ut=function(e){return"object"===(void 0===l?"undefined":q(l))?e instanceof l:e&&"object"===(void 0===e?"undefined":q(e))&&"number"==typeof e.nodeType&&"string"==typeof e.nodeName},ht=function(e,t,n){fe[e]&&f(fe[e],(function(e){e.call(r,t,n,$e)}))},ft=function(e){var t=void 0;if(ht("beforeSanitizeElements",e,null),ct(e))return at(e),!0;if(g(e.nodeName,/[\u0080-\uFFFF]/))return at(e),!0;var n=m(e.nodeName);if(ht("uponSanitizeElement",e,{tagName:n,allowedTags:Ee}),!ut(e.firstElementChild)&&(!ut(e.content)||!ut(e.content.firstElementChild))&&E(/<[/\w]/g,e.innerHTML)&&E(/<[/\w]/g,e.textContent))return at(e),!0;if(!Ee[n]||Ie[n]){if(Be&&!He[n]){var i=re(e)||e.parentNode,a=te(e)||e.childNodes;if(a&&i)for(var s=a.length-1;s>=0;--s)i.insertBefore(J(a[s],!0),ee(e))}return at(e),!0}return e instanceof c&&!it(e)?(at(e),!0):"noscript"!==n&&"noembed"!==n||!E(/<\/no(script|embed)/i,e.innerHTML)?(_e&&3===e.nodeType&&(t=e.textContent,t=T(t,de," "),t=T(t,pe," "),e.textContent!==t&&(p(r.removed,{element:e.cloneNode()}),e.textContent=t)),ht("afterSanitizeElements",e,null),!1):(at(e),!0)},dt=function(e,t,r){if(Fe&&("id"===t||"name"===t)&&(r in i||r in Ze))return!1;if(we&&E(me,t));else if(Pe&&E(ge,t));else{if(!be[t]||xe[t])return!1;if(qe[t]);else if(E(ve,T(r,ye,"")));else if("src"!==t&&"xlink:href"!==t&&"href"!==t||"script"===e||0!==y(r,"data:")||!ze[e])if(De&&!E(Te,T(r,ye,"")));else if(r)return!1}return!0},pt=function(e){var t=void 0,n=void 0,i=void 0,a=void 0;ht("beforeSanitizeAttributes",e,null);var s=e.attributes;if(s){var o={attrName:"",attrValue:"",keepAttr:!0,allowedAttributes:be};for(a=s.length;a--;){var l=t=s[a],c=l.name,u=l.namespaceURI;if(n=v(t.value),i=m(c),o.attrName=i,o.attrValue=n,o.keepAttr=!0,o.forceKeepAttr=void 0,ht("uponSanitizeAttribute",e,o),n=o.attrValue,!o.forceKeepAttr&&(st(c,e),o.keepAttr))if(E(/\/>/i,n))st(c,e);else{_e&&(n=T(n,de," "),n=T(n,pe," "));var h=e.nodeName.toLowerCase();if(dt(h,i,n))try{u?e.setAttributeNS(u,c,n):e.setAttribute(c,n),d(r.removed)}catch(e){}}}ht("afterSanitizeAttributes",e,null)}},mt=function e(t){var r=void 0,n=lt(t);for(ht("beforeSanitizeShadowDOM",t,null);r=n.nextNode();)ht("uponSanitizeShadowNode",r,null),ft(r)||(r.content instanceof s&&e(r.content),pt(r));ht("afterSanitizeShadowDOM",t,null)};return r.sanitize=function(e,i){var a=void 0,o=void 0,c=void 0,u=void 0,h=void 0;if((Xe=!e)&&(e="\x3c!--\x3e"),"string"!=typeof e&&!ut(e)){if("function"!=typeof e.toString)throw C("toString is not a function");if("string"!=typeof(e=e.toString()))throw C("dirty is not a string, aborting")}if(!r.isSupported){if("object"===q(t.toStaticHTML)||"function"==typeof t.toStaticHTML){if("string"==typeof e)return t.toStaticHTML(e);if(ut(e))return t.toStaticHTML(e.outerHTML)}return e}if(Re||Je(i),r.removed=[],"string"==typeof e&&(Ve=!1),Ve);else if(e instanceof l)1===(o=(a=ot("\x3c!----\x3e")).ownerDocument.importNode(e,!0)).nodeType&&"BODY"===o.nodeName||"HTML"===o.nodeName?a=o:a.appendChild(o);else{if(!Ne&&!_e&&!Ae&&-1===e.indexOf("<"))return ie&&Le?ie.createHTML(e):e;if(!(a=ot(e)))return Ne?null:ae}a&&Me&&at(a.firstChild);for(var f=lt(Ve?e:a);c=f.nextNode();)3===c.nodeType&&c===u||ft(c)||(c.content instanceof s&&mt(c.content),pt(c),u=c);if(u=null,Ve)return e;if(Ne){if(ke)for(h=ce.call(a.ownerDocument);a.firstChild;)h.appendChild(a.firstChild);else h=a;return Oe&&(h=ue.call(n,h,!0)),h}var d=Ae?a.outerHTML:a.innerHTML;return _e&&(d=T(d,de," "),d=T(d,pe," ")),ie&&Le?ie.createHTML(d):d},r.setConfig=function(e){Je(e),Re=!0},r.clearConfig=function(){$e=null,Re=!1},r.isValidAttribute=function(e,t,r){$e||Je({});var n=m(e),i=m(t);return dt(n,i,r)},r.addHook=function(e,t){"function"==typeof t&&(fe[e]=fe[e]||[],p(fe[e],t))},r.removeHook=function(e){fe[e]&&d(fe[e])},r.removeHooks=function(e){fe[e]&&(fe[e]=[])},r.removeAllHooks=function(){fe={}},r}()})),function(){var e=function(e){return e.test(Ext.userAgent)},t=document.documentMode,r=e(/opera/),n=e(/webkit/),i=!r&&(e(/msie/)||e(/trident/)),a=i&&(e(/trident\/7\.0/)&&7!=t&&8!=t&&9!=t&&10!=t||11==t),s=!n&&!i&&e(/gecko/),o=e(/edge/);Ext.isEdge=o,Ext.isIE=i,Ext.isIE11=a,Ext.isGecko=s,Ext.isIEOrEdge=i||o}(),function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define("underscore",t):(e="undefined"!=typeof globalThis?globalThis:e||self,function(){var r=e._,n=e._=t();n.noConflict=function(){return e._=r,n}}())}(this,(function(){var e="object"==typeof self&&self.self===self&&self||"object"==typeof global&&global.global===global&&global||Function("return this")()||{},t=Array.prototype,r=Object.prototype,n="undefined"!=typeof Symbol?Symbol.prototype:null,i=t.push,a=t.slice,s=r.toString,o=r.hasOwnProperty,l="undefined"!=typeof ArrayBuffer,c="undefined"!=typeof DataView,u=Array.isArray,h=Object.keys,f=Object.create,d=l&&ArrayBuffer.isView,p=isNaN,m=isFinite,g=!{toString:null}.propertyIsEnumerable("toString"),T=["valueOf","isPrototypeOf","toString","propertyIsEnumerable","hasOwnProperty","toLocaleString"],y=Math.pow(2,53)-1;function v(e,t){return t=null==t?e.length-1:+t,function(){for(var r=Math.max(arguments.length-t,0),n=Array(r),i=0;i<r;i++)n[i]=arguments[i+t];switch(t){case 0:return e.call(this,n);case 1:return e.call(this,arguments[0],n);case 2:return e.call(this,arguments[0],arguments[1],n)}var a=Array(t+1);for(i=0;i<t;i++)a[i]=arguments[i];return a[t]=n,e.apply(this,a)}}function E(e){var t=typeof e;return"function"===t||"object"===t&&!!e}function C(e){return void 0===e}function b(e){return!0===e||!1===e||"[object Boolean]"===s.call(e)}function S(e){var t="[object "+e+"]";return function(e){return s.call(e)===t}}var I=S("String"),x=S("Number"),P=S("Date"),w=S("RegExp"),D=S("Error"),_=S("Symbol"),A=S("ArrayBuffer"),R=S("Function"),M=e.document&&e.document.childNodes;"function"!=typeof/./&&"object"!=typeof Int8Array&&"function"!=typeof M&&(R=function(e){return"function"==typeof e||!1});var N=R,k=S("Object"),O=c&&k(new DataView(new ArrayBuffer(8))),L="undefined"!=typeof Map&&k(new Map),F=S("DataView");var B=O?function(e){return null!=e&&N(e.getInt8)&&A(e.buffer)}:F,V=u||S("Array");function U(e,t){return null!=e&&o.call(e,t)}var H=S("Arguments");!function(){H(arguments)||(H=function(e){return U(e,"callee")})}();var z=H;function j(e){return x(e)&&p(e)}function q(e){return function(){return e}}function G(e){return function(t){var r=e(t);return"number"==typeof r&&r>=0&&r<=y}}function W(e){return function(t){return null==t?void 0:t[e]}}var Y=W("byteLength"),K=G(Y),Q=/\[object ((I|Ui)nt(8|16|32)|Float(32|64)|Uint8Clamped|Big(I|Ui)nt64)Array\]/;var X=l?function(e){return d?d(e)&&!B(e):K(e)&&Q.test(s.call(e))}:q(!1),$=W("length");function Z(e,t){t=function(e){for(var t={},r=e.length,n=0;n<r;++n)t[e[n]]=!0;return{contains:function(e){return!0===t[e]},push:function(r){return t[r]=!0,e.push(r)}}}(t);var n=T.length,i=e.constructor,a=N(i)&&i.prototype||r,s="constructor";for(U(e,s)&&!t.contains(s)&&t.push(s);n--;)(s=T[n])in e&&e[s]!==a[s]&&!t.contains(s)&&t.push(s)}function J(e){if(!E(e))return[];if(h)return h(e);var t=[];for(var r in e)U(e,r)&&t.push(r);return g&&Z(e,t),t}function ee(e,t){var r=J(t),n=r.length;if(null==e)return!n;for(var i=Object(e),a=0;a<n;a++){var s=r[a];if(t[s]!==i[s]||!(s in i))return!1}return!0}function te(e){return e instanceof te?e:this instanceof te?void(this._wrapped=e):new te(e)}function re(e){return new Uint8Array(e.buffer||e,e.byteOffset||0,Y(e))}te.VERSION="1.13.6",te.prototype.value=function(){return this._wrapped},te.prototype.valueOf=te.prototype.toJSON=te.prototype.value,te.prototype.toString=function(){return String(this._wrapped)};function ne(e,t,r,i){if(e===t)return 0!==e||1/e==1/t;if(null==e||null==t)return!1;if(e!=e)return t!=t;var a=typeof e;return("function"===a||"object"===a||"object"==typeof t)&&function e(t,r,i,a){t instanceof te&&(t=t._wrapped);r instanceof te&&(r=r._wrapped);var o=s.call(t);if(o!==s.call(r))return!1;if(O&&"[object Object]"==o&&B(t)){if(!B(r))return!1;o="[object DataView]"}switch(o){case"[object RegExp]":case"[object String]":return""+t==""+r;case"[object Number]":return+t!=+t?+r!=+r:0==+t?1/+t==1/r:+t==+r;case"[object Date]":case"[object Boolean]":return+t==+r;case"[object Symbol]":return n.valueOf.call(t)===n.valueOf.call(r);case"[object ArrayBuffer]":case"[object DataView]":return e(re(t),re(r),i,a)}var l="[object Array]"===o;if(!l&&X(t)){if(Y(t)!==Y(r))return!1;if(t.buffer===r.buffer&&t.byteOffset===r.byteOffset)return!0;l=!0}if(!l){if("object"!=typeof t||"object"!=typeof r)return!1;var c=t.constructor,u=r.constructor;if(c!==u&&!(N(c)&&c instanceof c&&N(u)&&u instanceof u)&&"constructor"in t&&"constructor"in r)return!1}a=a||[];var h=(i=i||[]).length;for(;h--;)if(i[h]===t)return a[h]===r;if(i.push(t),a.push(r),l){if((h=t.length)!==r.length)return!1;for(;h--;)if(!ne(t[h],r[h],i,a))return!1}else{var f,d=J(t);if(h=d.length,J(r).length!==h)return!1;for(;h--;)if(f=d[h],!U(r,f)||!ne(t[f],r[f],i,a))return!1}return i.pop(),a.pop(),!0}(e,t,r,i)}function ie(e){if(!E(e))return[];var t=[];for(var r in e)t.push(r);return g&&Z(e,t),t}function ae(e){var t=$(e);return function(r){if(null==r)return!1;var n=ie(r);if($(n))return!1;for(var i=0;i<t;i++)if(!N(r[e[i]]))return!1;return e!==ue||!N(r[se])}}var se="forEach",oe=["clear","delete"],le=["get","has","set"],ce=oe.concat(se,le),ue=oe.concat(le),he=["add"].concat(oe,se,"has"),fe=L?ae(ce):S("Map"),de=L?ae(ue):S("WeakMap"),pe=L?ae(he):S("Set"),me=S("WeakSet");function ge(e){for(var t=J(e),r=t.length,n=Array(r),i=0;i<r;i++)n[i]=e[t[i]];return n}function Te(e){for(var t={},r=J(e),n=0,i=r.length;n<i;n++)t[e[r[n]]]=r[n];return t}function ye(e){var t=[];for(var r in e)N(e[r])&&t.push(r);return t.sort()}function ve(e,t){return function(r){var n=arguments.length;if(t&&(r=Object(r)),n<2||null==r)return r;for(var i=1;i<n;i++)for(var a=arguments[i],s=e(a),o=s.length,l=0;l<o;l++){var c=s[l];t&&void 0!==r[c]||(r[c]=a[c])}return r}}var Ee=ve(ie),Ce=ve(J),be=ve(ie,!0);function Se(e){if(!E(e))return{};if(f)return f(e);var t=function(){};t.prototype=e;var r=new t;return t.prototype=null,r}function Ie(e){return V(e)?e:[e]}function xe(e){return te.toPath(e)}function Pe(e,t){for(var r=t.length,n=0;n<r;n++){if(null==e)return;e=e[t[n]]}return r?e:void 0}function we(e,t,r){var n=Pe(e,xe(t));return C(n)?r:n}function De(e){return e}function _e(e){return e=Ce({},e),function(t){return ee(t,e)}}function Ae(e){return e=xe(e),function(t){return Pe(t,e)}}function Re(e,t,r){if(void 0===t)return e;switch(null==r?3:r){case 1:return function(r){return e.call(t,r)};case 3:return function(r,n,i){return e.call(t,r,n,i)};case 4:return function(r,n,i,a){return e.call(t,r,n,i,a)}}return function(){return e.apply(t,arguments)}}function Me(e,t,r){return null==e?De:N(e)?Re(e,t,r):E(e)&&!V(e)?_e(e):Ae(e)}function Ne(e,t){return Me(e,t,1/0)}function ke(e,t,r){return te.iteratee!==Ne?te.iteratee(e,t):Me(e,t,r)}function Oe(){}function Le(e,t){return null==t&&(t=e,e=0),e+Math.floor(Math.random()*(t-e+1))}te.toPath=Ie,te.iteratee=Ne;var Fe=Date.now||function(){return(new Date).getTime()};function Be(e){var t=function(t){return e[t]},r="(?:"+J(e).join("|")+")",n=RegExp(r),i=RegExp(r,"g");return function(e){return e=null==e?"":""+e,n.test(e)?e.replace(i,t):e}}var Ve={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;","`":"&#x60;"},Ue=Be(Ve),He=Be(Te(Ve)),ze=te.templateSettings={evaluate:/<%([\s\S]+?)%>/g,interpolate:/<%=([\s\S]+?)%>/g,escape:/<%-([\s\S]+?)%>/g},je=/(.)^/,qe={"'":"'","\\":"\\","\r":"r","\n":"n","\u2028":"u2028","\u2029":"u2029"},Ge=/\\|'|\r|\n|\u2028|\u2029/g;function We(e){return"\\"+qe[e]}var Ye=/^\s*(\w|\$)+\s*$/;var Ke=0;function Qe(e,t,r,n,i){if(!(n instanceof t))return e.apply(r,i);var a=Se(e.prototype),s=e.apply(a,i);return E(s)?s:a}var Xe=v((function(e,t){var r=Xe.placeholder,n=function(){for(var i=0,a=t.length,s=Array(a),o=0;o<a;o++)s[o]=t[o]===r?arguments[i++]:t[o];for(;i<arguments.length;)s.push(arguments[i++]);return Qe(e,n,this,this,s)};return n}));Xe.placeholder=te;var $e=v((function(e,t,r){if(!N(e))throw new TypeError("Bind must be called on a function");var n=v((function(i){return Qe(e,n,t,this,r.concat(i))}));return n})),Ze=G($);function Je(e,t,r,n){if(n=n||[],t||0===t){if(t<=0)return n.concat(e)}else t=1/0;for(var i=n.length,a=0,s=$(e);a<s;a++){var o=e[a];if(Ze(o)&&(V(o)||z(o)))if(t>1)Je(o,t-1,r,n),i=n.length;else for(var l=0,c=o.length;l<c;)n[i++]=o[l++];else r||(n[i++]=o)}return n}var et=v((function(e,t){var r=(t=Je(t,!1,!1)).length;if(r<1)throw new Error("bindAll must be passed function names");for(;r--;){var n=t[r];e[n]=$e(e[n],e)}return e}));var tt=v((function(e,t,r){return setTimeout((function(){return e.apply(null,r)}),t)})),rt=Xe(tt,te,1);function nt(e){return function(){return!e.apply(this,arguments)}}function it(e,t){var r;return function(){return--e>0&&(r=t.apply(this,arguments)),e<=1&&(t=null),r}}var at=Xe(it,2);function st(e,t,r){t=ke(t,r);for(var n,i=J(e),a=0,s=i.length;a<s;a++)if(t(e[n=i[a]],n,e))return n}function ot(e){return function(t,r,n){r=ke(r,n);for(var i=$(t),a=e>0?0:i-1;a>=0&&a<i;a+=e)if(r(t[a],a,t))return a;return-1}}var lt=ot(1),ct=ot(-1);function ut(e,t,r,n){for(var i=(r=ke(r,n,1))(t),a=0,s=$(e);a<s;){var o=Math.floor((a+s)/2);r(e[o])<i?a=o+1:s=o}return a}function ht(e,t,r){return function(n,i,s){var o=0,l=$(n);if("number"==typeof s)e>0?o=s>=0?s:Math.max(s+l,o):l=s>=0?Math.min(s+1,l):s+l+1;else if(r&&s&&l)return n[s=r(n,i)]===i?s:-1;if(i!=i)return(s=t(a.call(n,o,l),j))>=0?s+o:-1;for(s=e>0?o:l-1;s>=0&&s<l;s+=e)if(n[s]===i)return s;return-1}}var ft=ht(1,lt,ut),dt=ht(-1,ct);function pt(e,t,r){var n=(Ze(e)?lt:st)(e,t,r);if(void 0!==n&&-1!==n)return e[n]}function mt(e,t,r){var n,i;if(t=Re(t,r),Ze(e))for(n=0,i=e.length;n<i;n++)t(e[n],n,e);else{var a=J(e);for(n=0,i=a.length;n<i;n++)t(e[a[n]],a[n],e)}return e}function gt(e,t,r){t=ke(t,r);for(var n=!Ze(e)&&J(e),i=(n||e).length,a=Array(i),s=0;s<i;s++){var o=n?n[s]:s;a[s]=t(e[o],o,e)}return a}function Tt(e){var t=function(t,r,n,i){var a=!Ze(t)&&J(t),s=(a||t).length,o=e>0?0:s-1;for(i||(n=t[a?a[o]:o],o+=e);o>=0&&o<s;o+=e){var l=a?a[o]:o;n=r(n,t[l],l,t)}return n};return function(e,r,n,i){var a=arguments.length>=3;return t(e,Re(r,i,4),n,a)}}var yt=Tt(1),vt=Tt(-1);function Et(e,t,r){var n=[];return t=ke(t,r),mt(e,(function(e,r,i){t(e,r,i)&&n.push(e)})),n}function Ct(e,t,r){t=ke(t,r);for(var n=!Ze(e)&&J(e),i=(n||e).length,a=0;a<i;a++){var s=n?n[a]:a;if(!t(e[s],s,e))return!1}return!0}function bt(e,t,r){t=ke(t,r);for(var n=!Ze(e)&&J(e),i=(n||e).length,a=0;a<i;a++){var s=n?n[a]:a;if(t(e[s],s,e))return!0}return!1}function St(e,t,r,n){return Ze(e)||(e=ge(e)),("number"!=typeof r||n)&&(r=0),ft(e,t,r)>=0}var It=v((function(e,t,r){var n,i;return N(t)?i=t:(t=xe(t),n=t.slice(0,-1),t=t[t.length-1]),gt(e,(function(e){var a=i;if(!a){if(n&&n.length&&(e=Pe(e,n)),null==e)return;a=e[t]}return null==a?a:a.apply(e,r)}))}));function xt(e,t){return gt(e,Ae(t))}function Pt(e,t,r){var n,i,a=-1/0,s=-1/0;if(null==t||"number"==typeof t&&"object"!=typeof e[0]&&null!=e)for(var o=0,l=(e=Ze(e)?e:ge(e)).length;o<l;o++)null!=(n=e[o])&&n>a&&(a=n);else t=ke(t,r),mt(e,(function(e,r,n){((i=t(e,r,n))>s||i===-1/0&&a===-1/0)&&(a=e,s=i)}));return a}var wt=/[^\ud800-\udfff]|[\ud800-\udbff][\udc00-\udfff]|[\ud800-\udfff]/g;function Dt(e){return e?V(e)?a.call(e):I(e)?e.match(wt):Ze(e)?gt(e,De):ge(e):[]}function _t(e,t,r){if(null==t||r)return Ze(e)||(e=ge(e)),e[Le(e.length-1)];var n=Dt(e),i=$(n);t=Math.max(Math.min(t,i),0);for(var a=i-1,s=0;s<t;s++){var o=Le(s,a),l=n[s];n[s]=n[o],n[o]=l}return n.slice(0,t)}function At(e,t){return function(r,n,i){var a=t?[[],[]]:{};return n=ke(n,i),mt(r,(function(t,i){var s=n(t,i,r);e(a,t,s)})),a}}var Rt=At((function(e,t,r){U(e,r)?e[r].push(t):e[r]=[t]})),Mt=At((function(e,t,r){e[r]=t})),Nt=At((function(e,t,r){U(e,r)?e[r]++:e[r]=1})),kt=At((function(e,t,r){e[r?0:1].push(t)}),!0);function Ot(e,t,r){return t in r}var Lt=v((function(e,t){var r={},n=t[0];if(null==e)return r;N(n)?(t.length>1&&(n=Re(n,t[1])),t=ie(e)):(n=Ot,t=Je(t,!1,!1),e=Object(e));for(var i=0,a=t.length;i<a;i++){var s=t[i],o=e[s];n(o,s,e)&&(r[s]=o)}return r})),Ft=v((function(e,t){var r,n=t[0];return N(n)?(n=nt(n),t.length>1&&(r=t[1])):(t=gt(Je(t,!1,!1),String),n=function(e,r){return!St(t,r)}),Lt(e,n,r)}));function Bt(e,t,r){return a.call(e,0,Math.max(0,e.length-(null==t||r?1:t)))}function Vt(e,t,r){return null==e||e.length<1?null==t||r?void 0:[]:null==t||r?e[0]:Bt(e,e.length-t)}function Ut(e,t,r){return a.call(e,null==t||r?1:t)}var Ht=v((function(e,t){return t=Je(t,!0,!0),Et(e,(function(e){return!St(t,e)}))})),zt=v((function(e,t){return Ht(e,t)}));function jt(e,t,r,n){b(t)||(n=r,r=t,t=!1),null!=r&&(r=ke(r,n));for(var i=[],a=[],s=0,o=$(e);s<o;s++){var l=e[s],c=r?r(l,s,e):l;t&&!r?(s&&a===c||i.push(l),a=c):r?St(a,c)||(a.push(c),i.push(l)):St(i,l)||i.push(l)}return i}var qt=v((function(e){return jt(Je(e,!0,!0))}));function Gt(e){for(var t=e&&Pt(e,$).length||0,r=Array(t),n=0;n<t;n++)r[n]=xt(e,n);return r}var Wt=v(Gt);function Yt(e,t){return e._chain?te(t).chain():t}function Kt(e){return mt(ye(e),(function(t){var r=te[t]=e[t];te.prototype[t]=function(){var e=[this._wrapped];return i.apply(e,arguments),Yt(this,r.apply(te,e))}})),te}mt(["pop","push","reverse","shift","sort","splice","unshift"],(function(e){var r=t[e];te.prototype[e]=function(){var t=this._wrapped;return null!=t&&(r.apply(t,arguments),"shift"!==e&&"splice"!==e||0!==t.length||delete t[0]),Yt(this,t)}})),mt(["concat","join","slice"],(function(e){var r=t[e];te.prototype[e]=function(){var e=this._wrapped;return null!=e&&(e=r.apply(e,arguments)),Yt(this,e)}}));var Qt=Kt({__proto__:null,VERSION:"1.13.6",restArguments:v,isObject:E,isNull:function(e){return null===e},isUndefined:C,isBoolean:b,isElement:function(e){return!(!e||1!==e.nodeType)},isString:I,isNumber:x,isDate:P,isRegExp:w,isError:D,isSymbol:_,isArrayBuffer:A,isDataView:B,isArray:V,isFunction:N,isArguments:z,isFinite:function(e){return!_(e)&&m(e)&&!isNaN(parseFloat(e))},isNaN:j,isTypedArray:X,isEmpty:function(e){if(null==e)return!0;var t=$(e);return"number"==typeof t&&(V(e)||I(e)||z(e))?0===t:0===$(J(e))},isMatch:ee,isEqual:function(e,t){return ne(e,t)},isMap:fe,isWeakMap:de,isSet:pe,isWeakSet:me,keys:J,allKeys:ie,values:ge,pairs:function(e){for(var t=J(e),r=t.length,n=Array(r),i=0;i<r;i++)n[i]=[t[i],e[t[i]]];return n},invert:Te,functions:ye,methods:ye,extend:Ee,extendOwn:Ce,assign:Ce,defaults:be,create:function(e,t){var r=Se(e);return t&&Ce(r,t),r},clone:function(e){return E(e)?V(e)?e.slice():Ee({},e):e},tap:function(e,t){return t(e),e},get:we,has:function(e,t){for(var r=(t=xe(t)).length,n=0;n<r;n++){var i=t[n];if(!U(e,i))return!1;e=e[i]}return!!r},mapObject:function(e,t,r){t=ke(t,r);for(var n=J(e),i=n.length,a={},s=0;s<i;s++){var o=n[s];a[o]=t(e[o],o,e)}return a},identity:De,constant:q,noop:Oe,toPath:Ie,property:Ae,propertyOf:function(e){return null==e?Oe:function(t){return we(e,t)}},matcher:_e,matches:_e,times:function(e,t,r){var n=Array(Math.max(0,e));t=Re(t,r,1);for(var i=0;i<e;i++)n[i]=t(i);return n},random:Le,now:Fe,escape:Ue,unescape:He,templateSettings:ze,template:function(e,t,r){!t&&r&&(t=r),t=be({},t,te.templateSettings);var n=RegExp([(t.escape||je).source,(t.interpolate||je).source,(t.evaluate||je).source].join("|")+"|$","g"),i=0,a="__p+='";e.replace(n,(function(t,r,n,s,o){return a+=e.slice(i,o).replace(Ge,We),i=o+t.length,r?a+="'+\n((__t=("+r+"))==null?'':_.escape(__t))+\n'":n?a+="'+\n((__t=("+n+"))==null?'':__t)+\n'":s&&(a+="';\n"+s+"\n__p+='"),t})),a+="';\n";var s,o=t.variable;if(o){if(!Ye.test(o))throw new Error("variable is not a bare identifier: "+o)}else a="with(obj||{}){\n"+a+"}\n",o="obj";a="var __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\n"+a+"return __p;\n";try{s=new Function(o,"_",a)}catch(e){throw e.source=a,e}var l=function(e){return s.call(this,e,te)};return l.source="function("+o+"){\n"+a+"}",l},result:function(e,t,r){var n=(t=xe(t)).length;if(!n)return N(r)?r.call(e):r;for(var i=0;i<n;i++){var a=null==e?void 0:e[t[i]];void 0===a&&(a=r,i=n),e=N(a)?a.call(e):a}return e},uniqueId:function(e){var t=++Ke+"";return e?e+t:t},chain:function(e){var t=te(e);return t._chain=!0,t},iteratee:Ne,partial:Xe,bind:$e,bindAll:et,memoize:function(e,t){var r=function(n){var i=r.cache,a=""+(t?t.apply(this,arguments):n);return U(i,a)||(i[a]=e.apply(this,arguments)),i[a]};return r.cache={},r},delay:tt,defer:rt,throttle:function(e,t,r){var n,i,a,s,o=0;r||(r={});var l=function(){o=!1===r.leading?0:Fe(),n=null,s=e.apply(i,a),n||(i=a=null)},c=function(){var c=Fe();o||!1!==r.leading||(o=c);var u=t-(c-o);return i=this,a=arguments,u<=0||u>t?(n&&(clearTimeout(n),n=null),o=c,s=e.apply(i,a),n||(i=a=null)):n||!1===r.trailing||(n=setTimeout(l,u)),s};return c.cancel=function(){clearTimeout(n),o=0,n=i=a=null},c},debounce:function(e,t,r){var n,i,a,s,o,l=function(){var c=Fe()-i;t>c?n=setTimeout(l,t-c):(n=null,r||(s=e.apply(o,a)),n||(a=o=null))},c=v((function(c){return o=this,a=c,i=Fe(),n||(n=setTimeout(l,t),r&&(s=e.apply(o,a))),s}));return c.cancel=function(){clearTimeout(n),n=a=o=null},c},wrap:function(e,t){return Xe(t,e)},negate:nt,compose:function(){var e=arguments,t=e.length-1;return function(){for(var r=t,n=e[t].apply(this,arguments);r--;)n=e[r].call(this,n);return n}},after:function(e,t){return function(){if(--e<1)return t.apply(this,arguments)}},before:it,once:at,findKey:st,findIndex:lt,findLastIndex:ct,sortedIndex:ut,indexOf:ft,lastIndexOf:dt,find:pt,detect:pt,findWhere:function(e,t){return pt(e,_e(t))},each:mt,forEach:mt,map:gt,collect:gt,reduce:yt,foldl:yt,inject:yt,reduceRight:vt,foldr:vt,filter:Et,select:Et,reject:function(e,t,r){return Et(e,nt(ke(t)),r)},every:Ct,all:Ct,some:bt,any:bt,contains:St,includes:St,include:St,invoke:It,pluck:xt,where:function(e,t){return Et(e,_e(t))},max:Pt,min:function(e,t,r){var n,i,a=1/0,s=1/0;if(null==t||"number"==typeof t&&"object"!=typeof e[0]&&null!=e)for(var o=0,l=(e=Ze(e)?e:ge(e)).length;o<l;o++)null!=(n=e[o])&&n<a&&(a=n);else t=ke(t,r),mt(e,(function(e,r,n){((i=t(e,r,n))<s||i===1/0&&a===1/0)&&(a=e,s=i)}));return a},shuffle:function(e){return _t(e,1/0)},sample:_t,sortBy:function(e,t,r){var n=0;return t=ke(t,r),xt(gt(e,(function(e,r,i){return{value:e,index:n++,criteria:t(e,r,i)}})).sort((function(e,t){var r=e.criteria,n=t.criteria;if(r!==n){if(r>n||void 0===r)return 1;if(r<n||void 0===n)return-1}return e.index-t.index})),"value")},groupBy:Rt,indexBy:Mt,countBy:Nt,partition:kt,toArray:Dt,size:function(e){return null==e?0:Ze(e)?e.length:J(e).length},pick:Lt,omit:Ft,first:Vt,head:Vt,take:Vt,initial:Bt,last:function(e,t,r){return null==e||e.length<1?null==t||r?void 0:[]:null==t||r?e[e.length-1]:Ut(e,Math.max(0,e.length-t))},rest:Ut,tail:Ut,drop:Ut,compact:function(e){return Et(e,Boolean)},flatten:function(e,t){return Je(e,t,!1)},without:zt,uniq:jt,unique:jt,union:qt,intersection:function(e){for(var t=[],r=arguments.length,n=0,i=$(e);n<i;n++){var a=e[n];if(!St(t,a)){var s;for(s=1;s<r&&St(arguments[s],a);s++);s===r&&t.push(a)}}return t},difference:Ht,unzip:Gt,transpose:Gt,zip:Wt,object:function(e,t){for(var r={},n=0,i=$(e);n<i;n++)t?r[e[n]]=t[n]:r[e[n][0]]=e[n][1];return r},range:function(e,t,r){null==t&&(t=e||0,e=0),r||(r=t<e?-1:1);for(var n=Math.max(Math.ceil((t-e)/r),0),i=Array(n),a=0;a<n;a++,e+=r)i[a]=e;return i},chunk:function(e,t){if(null==t||t<1)return[];for(var r=[],n=0,i=e.length;n<i;)r.push(a.call(e,n,n+=t));return r},mixin:Kt,default:te});return Qt._=Qt,Qt})),function(e){var t="object"==typeof self&&self.self===self&&self||"object"==typeof global&&global.global===global&&global;if("function"==typeof define&&define.amd)define(["underscore","jquery","exports"],(function(r,n,i){t.Backbone=e(t,i,r,n)}));else if("undefined"!=typeof exports){var r,n=require("underscore");try{r=require("jquery")}catch(e){}e(t,exports,n,r)}else t.Backbone=e(t,{},t._,t.jQuery||t.Zepto||t.ender||t.$)}((function(e,t,r,n){var i=e.Backbone,a=Array.prototype.slice;t.VERSION="1.3.3",t.$=n,t.noConflict=function(){return e.Backbone=i,this},t.emulateHTTP=!1,t.emulateJSON=!1;var s=function(e,t,n){r.each(t,(function(t,i){r[i]&&(e.prototype[i]=function(e,t,n){switch(e){case 1:return function(){return r[t](this[n])};case 2:return function(e){return r[t](this[n],e)};case 3:return function(e,i){return r[t](this[n],o(e,this),i)};case 4:return function(e,i,a){return r[t](this[n],o(e,this),i,a)};default:return function(){var e=a.call(arguments);return e.unshift(this[n]),r[t].apply(r,e)}}}(t,i,n))}))},o=function(e,t){return r.isFunction(e)?e:r.isObject(e)&&!t._isModel(e)?l(e):r.isString(e)?function(t){return t.get(e)}:e},l=function(e){var t=r.matches(e);return function(e){return t(e.attributes)}},c=t.Events={},u=/\s+/,h=function(e,t,n,i,a){var s,o=0;if(n&&"object"==typeof n){void 0!==i&&"context"in a&&void 0===a.context&&(a.context=i);for(s=r.keys(n);o<s.length;o++)t=h(e,t,s[o],n[s[o]],a)}else if(n&&u.test(n))for(s=n.split(u);o<s.length;o++)t=e(t,s[o],i,a);else t=e(t,n,i,a);return t};c.on=function(e,t,r){return f(this,e,t,r)};var f=function(e,t,r,n,i){(e._events=h(d,e._events||{},t,r,{context:n,ctx:e,listening:i}),i)&&((e._listeners||(e._listeners={}))[i.id]=i);return e};c.listenTo=function(e,t,n){if(!e)return this;var i=e._listenId||(e._listenId=r.uniqueId("l")),a=this._listeningTo||(this._listeningTo={}),s=a[i];if(!s){var o=this._listenId||(this._listenId=r.uniqueId("l"));s=a[i]={obj:e,objId:i,id:o,listeningTo:a,count:0}}return f(e,t,n,this,s),this};var d=function(e,t,r,n){if(r){var i=e[t]||(e[t]=[]),a=n.context,s=n.ctx,o=n.listening;o&&o.count++,i.push({callback:r,context:a,ctx:a||s,listening:o})}return e};c.off=function(e,t,r){return this._events?(this._events=h(p,this._events,e,t,{context:r,listeners:this._listeners}),this):this},c.stopListening=function(e,t,n){var i=this._listeningTo;if(!i)return this;for(var a=e?[e._listenId]:r.keys(i),s=0;s<a.length;s++){var o=i[a[s]];if(!o)break;o.obj.off(t,n,this)}return this};var p=function(e,t,n,i){if(e){var a,s=0,o=i.context,l=i.listeners;if(t||n||o){for(var c=t?[t]:r.keys(e);s<c.length;s++){var u=e[t=c[s]];if(!u)break;for(var h=[],f=0;f<u.length;f++){var d=u[f];n&&n!==d.callback&&n!==d.callback._callback||o&&o!==d.context?h.push(d):(a=d.listening)&&0==--a.count&&(delete l[a.id],delete a.listeningTo[a.objId])}h.length?e[t]=h:delete e[t]}return e}for(var p=r.keys(l);s<p.length;s++)delete l[(a=l[p[s]]).id],delete a.listeningTo[a.objId]}};c.once=function(e,t,n){var i=h(m,{},e,t,r.bind(this.off,this));return"string"==typeof e&&null==n&&(t=void 0),this.on(i,t,n)},c.listenToOnce=function(e,t,n){var i=h(m,{},t,n,r.bind(this.stopListening,this,e));return this.listenTo(e,i)};var m=function(e,t,n,i){if(n){var a=e[t]=r.once((function(){i(t,a),n.apply(this,arguments)}));a._callback=n}return e};c.trigger=function(e){if(!this._events)return this;for(var t=Math.max(0,arguments.length-1),r=Array(t),n=0;n<t;n++)r[n]=arguments[n+1];return h(g,this._events,e,void 0,r),this};var g=function(e,t,r,n){if(e){var i=e[t],a=e.all;i&&a&&(a=a.slice()),i&&T(i,n),a&&T(a,[t].concat(n))}return e},T=function(e,t){var r,n=-1,i=e.length,a=t[0],s=t[1],o=t[2];switch(t.length){case 0:for(;++n<i;)(r=e[n]).callback.call(r.ctx);return;case 1:for(;++n<i;)(r=e[n]).callback.call(r.ctx,a);return;case 2:for(;++n<i;)(r=e[n]).callback.call(r.ctx,a,s);return;case 3:for(;++n<i;)(r=e[n]).callback.call(r.ctx,a,s,o);return;default:for(;++n<i;)(r=e[n]).callback.apply(r.ctx,t);return}};c.bind=c.on,c.unbind=c.off,r.extend(t,c);var y=t.Model=function(e,t){var n=e||{};t||(t={}),this.cid=r.uniqueId(this.cidPrefix),this.attributes={},t.collection&&(this.collection=t.collection),t.parse&&(n=this.parse(n,t)||{});var i=r.result(this,"defaults");n=r.defaults(r.extend({},i,n),i),this.set(n,t),this.changed={},this.initialize.apply(this,arguments)};r.extend(y.prototype,c,{changed:null,validationError:null,idAttribute:"id",cidPrefix:"c",initialize:function(){},toJSON:function(e){return r.clone(this.attributes)},sync:function(){return t.sync.apply(this,arguments)},get:function(e){return this.attributes[e]},escape:function(e){return r.escape(this.get(e))},has:function(e){return null!=this.get(e)},matches:function(e){return!!r.iteratee(e,this)(this.attributes)},set:function(e,t,n){if(null==e)return this;var i;if("object"==typeof e?(i=e,n=t):(i={})[e]=t,n||(n={}),!this._validate(i,n))return!1;var a=n.unset,s=n.silent,o=[],l=this._changing;this._changing=!0,l||(this._previousAttributes=r.clone(this.attributes),this.changed={});var c=this.attributes,u=this.changed,h=this._previousAttributes;for(var f in i)t=i[f],r.isEqual(c[f],t)||o.push(f),r.isEqual(h[f],t)?delete u[f]:u[f]=t,a?delete c[f]:c[f]=t;if(this.idAttribute in i&&(this.id=this.get(this.idAttribute)),!s){o.length&&(this._pending=n);for(var d=0;d<o.length;d++)this.trigger("change:"+o[d],this,c[o[d]],n)}if(l)return this;if(!s)for(;this._pending;)n=this._pending,this._pending=!1,this.trigger("change",this,n);return this._pending=!1,this._changing=!1,this},unset:function(e,t){return this.set(e,void 0,r.extend({},t,{unset:!0}))},clear:function(e){var t={};for(var n in this.attributes)t[n]=void 0;return this.set(t,r.extend({},e,{unset:!0}))},hasChanged:function(e){return null==e?!r.isEmpty(this.changed):r.has(this.changed,e)},changedAttributes:function(e){if(!e)return!!this.hasChanged()&&r.clone(this.changed);var t=this._changing?this._previousAttributes:this.attributes,n={};for(var i in e){var a=e[i];r.isEqual(t[i],a)||(n[i]=a)}return!!r.size(n)&&n},previous:function(e){return null!=e&&this._previousAttributes?this._previousAttributes[e]:null},previousAttributes:function(){return r.clone(this._previousAttributes)},fetch:function(e){e=r.extend({parse:!0},e);var t=this,n=e.success;return e.success=function(r){var i=e.parse?t.parse(r,e):r;if(!t.set(i,e))return!1;n&&n.call(e.context,t,r,e),t.trigger("sync",t,r,e)},F(this,e),this.sync("read",this,e)},save:function(e,t,n){var i;null==e||"object"==typeof e?(i=e,n=t):(i={})[e]=t;var a=(n=r.extend({validate:!0,parse:!0},n)).wait;if(i&&!a){if(!this.set(i,n))return!1}else if(!this._validate(i,n))return!1;var s=this,o=n.success,l=this.attributes;n.success=function(e){s.attributes=l;var t=n.parse?s.parse(e,n):e;if(a&&(t=r.extend({},i,t)),t&&!s.set(t,n))return!1;o&&o.call(n.context,s,e,n),s.trigger("sync",s,e,n)},F(this,n),i&&a&&(this.attributes=r.extend({},l,i));var c=this.isNew()?"create":n.patch?"patch":"update";"patch"!==c||n.attrs||(n.attrs=i);var u=this.sync(c,this,n);return this.attributes=l,u},destroy:function(e){e=e?r.clone(e):{};var t=this,n=e.success,i=e.wait,a=function(){t.stopListening(),t.trigger("destroy",t,t.collection,e)};e.success=function(r){i&&a(),n&&n.call(e.context,t,r,e),t.isNew()||t.trigger("sync",t,r,e)};var s=!1;return this.isNew()?r.defer(e.success):(F(this,e),s=this.sync("delete",this,e)),i||a(),s},url:function(){var e=r.result(this,"urlRoot")||r.result(this.collection,"url")||L();if(this.isNew())return e;var t=this.get(this.idAttribute);return e.replace(/[^\/]$/,"$&/")+encodeURIComponent(t)},parse:function(e,t){return e},clone:function(){return new this.constructor(this.attributes)},isNew:function(){return!this.has(this.idAttribute)},isValid:function(e){return this._validate({},r.extend({},e,{validate:!0}))},_validate:function(e,t){if(!t.validate||!this.validate)return!0;e=r.extend({},this.attributes,e);var n=this.validationError=this.validate(e,t)||null;return!n||(this.trigger("invalid",this,n,r.extend(t,{validationError:n})),!1)}});s(y,{keys:1,values:1,pairs:1,invert:1,pick:0,omit:0,chain:1,isEmpty:1},"attributes");var v=t.Collection=function(e,t){t||(t={}),t.model&&(this.model=t.model),void 0!==t.comparator&&(this.comparator=t.comparator),this._reset(),this.initialize.apply(this,arguments),e&&this.reset(e,r.extend({silent:!0},t))},E={add:!0,remove:!0,merge:!0},C={add:!0,remove:!1},b=function(e,t,r){r=Math.min(Math.max(r,0),e.length);var n,i=Array(e.length-r),a=t.length;for(n=0;n<i.length;n++)i[n]=e[n+r];for(n=0;n<a;n++)e[n+r]=t[n];for(n=0;n<i.length;n++)e[n+a+r]=i[n]};r.extend(v.prototype,c,{model:y,initialize:function(){},toJSON:function(e){return this.map((function(t){return t.toJSON(e)}))},sync:function(){return t.sync.apply(this,arguments)},add:function(e,t){return this.set(e,r.extend({merge:!1},t,C))},remove:function(e,t){t=r.extend({},t);var n=!r.isArray(e);e=n?[e]:e.slice();var i=this._removeModels(e,t);return!t.silent&&i.length&&(t.changes={added:[],merged:[],removed:i},this.trigger("update",this,t)),n?i[0]:i},set:function(e,t){if(null!=e){(t=r.extend({},E,t)).parse&&!this._isModel(e)&&(e=this.parse(e,t)||[]);var n=!r.isArray(e);e=n?[e]:e.slice();var i=t.at;null!=i&&(i=+i),i>this.length&&(i=this.length),i<0&&(i+=this.length+1);var a,s,o=[],l=[],c=[],u=[],h={},f=t.add,d=t.merge,p=t.remove,m=!1,g=this.comparator&&null==i&&!1!==t.sort,T=r.isString(this.comparator)?this.comparator:null;for(s=0;s<e.length;s++){a=e[s];var y=this.get(a);if(y){if(d&&a!==y){var v=this._isModel(a)?a.attributes:a;t.parse&&(v=y.parse(v,t)),y.set(v,t),c.push(y),g&&!m&&(m=y.hasChanged(T))}h[y.cid]||(h[y.cid]=!0,o.push(y)),e[s]=y}else f&&(a=e[s]=this._prepareModel(a,t))&&(l.push(a),this._addReference(a,t),h[a.cid]=!0,o.push(a))}if(p){for(s=0;s<this.length;s++)h[(a=this.models[s]).cid]||u.push(a);u.length&&this._removeModels(u,t)}var C=!1,S=!g&&f&&p;if(o.length&&S?(C=this.length!==o.length||r.some(this.models,(function(e,t){return e!==o[t]})),this.models.length=0,b(this.models,o,0),this.length=this.models.length):l.length&&(g&&(m=!0),b(this.models,l,null==i?this.length:i),this.length=this.models.length),m&&this.sort({silent:!0}),!t.silent){for(s=0;s<l.length;s++)null!=i&&(t.index=i+s),(a=l[s]).trigger("add",a,this,t);(m||C)&&this.trigger("sort",this,t),(l.length||u.length||c.length)&&(t.changes={added:l,removed:u,merged:c},this.trigger("update",this,t))}return n?e[0]:e}},reset:function(e,t){t=t?r.clone(t):{};for(var n=0;n<this.models.length;n++)this._removeReference(this.models[n],t);return t.previousModels=this.models,this._reset(),e=this.add(e,r.extend({silent:!0},t)),t.silent||this.trigger("reset",this,t),e},push:function(e,t){return this.add(e,r.extend({at:this.length},t))},pop:function(e){var t=this.at(this.length-1);return this.remove(t,e)},unshift:function(e,t){return this.add(e,r.extend({at:0},t))},shift:function(e){var t=this.at(0);return this.remove(t,e)},slice:function(){return a.apply(this.models,arguments)},get:function(e){if(null!=e)return this._byId[e]||this._byId[this.modelId(e.attributes||e)]||e.cid&&this._byId[e.cid]},has:function(e){return null!=this.get(e)},at:function(e){return e<0&&(e+=this.length),this.models[e]},where:function(e,t){return this[t?"find":"filter"](e)},findWhere:function(e){return this.where(e,!0)},sort:function(e){var t=this.comparator;if(!t)throw new Error("Cannot sort a set without a comparator");e||(e={});var n=t.length;return r.isFunction(t)&&(t=r.bind(t,this)),1===n||r.isString(t)?this.models=this.sortBy(t):this.models.sort(t),e.silent||this.trigger("sort",this,e),this},pluck:function(e){return this.map(e+"")},fetch:function(e){var t=(e=r.extend({parse:!0},e)).success,n=this;return e.success=function(r){var i=e.reset?"reset":"set";n[i](r,e),t&&t.call(e.context,n,r,e),n.trigger("sync",n,r,e)},F(this,e),this.sync("read",this,e)},create:function(e,t){var n=(t=t?r.clone(t):{}).wait;if(!(e=this._prepareModel(e,t)))return!1;n||this.add(e,t);var i=this,a=t.success;return t.success=function(e,t,r){n&&i.add(e,r),a&&a.call(r.context,e,t,r)},e.save(null,t),e},parse:function(e,t){return e},clone:function(){return new this.constructor(this.models,{model:this.model,comparator:this.comparator})},modelId:function(e){return e[this.model.prototype.idAttribute||"id"]},_reset:function(){this.length=0,this.models=[],this._byId={}},_prepareModel:function(e,t){if(this._isModel(e))return e.collection||(e.collection=this),e;(t=t?r.clone(t):{}).collection=this;var n=new this.model(e,t);return n.validationError?(this.trigger("invalid",this,n.validationError,t),!1):n},_removeModels:function(e,t){for(var r=[],n=0;n<e.length;n++){var i=this.get(e[n]);if(i){var a=this.indexOf(i);this.models.splice(a,1),this.length--,delete this._byId[i.cid];var s=this.modelId(i.attributes);null!=s&&delete this._byId[s],t.silent||(t.index=a,i.trigger("remove",i,this,t)),r.push(i),this._removeReference(i,t)}}return r},_isModel:function(e){return e instanceof y},_addReference:function(e,t){this._byId[e.cid]=e;var r=this.modelId(e.attributes);null!=r&&(this._byId[r]=e),e.on("all",this._onModelEvent,this)},_removeReference:function(e,t){delete this._byId[e.cid];var r=this.modelId(e.attributes);null!=r&&delete this._byId[r],this===e.collection&&delete e.collection,e.off("all",this._onModelEvent,this)},_onModelEvent:function(e,t,r,n){if(t){if(("add"===e||"remove"===e)&&r!==this)return;if("destroy"===e&&this.remove(t,n),"change"===e){var i=this.modelId(t.previousAttributes()),a=this.modelId(t.attributes);i!==a&&(null!=i&&delete this._byId[i],null!=a&&(this._byId[a]=t))}}this.trigger.apply(this,arguments)}});s(v,{forEach:3,each:3,map:3,collect:3,reduce:0,foldl:0,inject:0,reduceRight:0,foldr:0,find:3,detect:3,filter:3,select:3,reject:3,every:3,all:3,some:3,any:3,include:3,includes:3,contains:3,invoke:0,max:3,min:3,toArray:1,size:1,first:3,head:3,take:3,initial:3,rest:3,tail:3,drop:3,last:3,without:0,difference:0,indexOf:3,shuffle:1,lastIndexOf:3,isEmpty:1,chain:1,sample:3,partition:3,groupBy:3,countBy:3,sortBy:3,indexBy:3,findIndex:3,findLastIndex:3},"models");var S=t.View=function(e){this.cid=r.uniqueId("view"),r.extend(this,r.pick(e,x)),this._ensureElement(),this.initialize.apply(this,arguments)},I=/^(\S+)\s*(.*)$/,x=["model","collection","el","id","attributes","className","tagName","events"];r.extend(S.prototype,c,{tagName:"div",$:function(e){return this.$el.find(e)},initialize:function(){},render:function(){return this},remove:function(){return this._removeElement(),this.stopListening(),this},_removeElement:function(){this.$el.remove()},setElement:function(e){return this.undelegateEvents(),this._setElement(e),this.delegateEvents(),this},_setElement:function(e){this.$el=e instanceof t.$?e:t.$(e),this.el=this.$el[0]},delegateEvents:function(e){if(e||(e=r.result(this,"events")),!e)return this;for(var t in this.undelegateEvents(),e){var n=e[t];if(r.isFunction(n)||(n=this[n]),n){var i=t.match(I);this.delegate(i[1],i[2],r.bind(n,this))}}return this},delegate:function(e,t,r){return this.$el.on(e+".delegateEvents"+this.cid,t,r),this},undelegateEvents:function(){return this.$el&&this.$el.off(".delegateEvents"+this.cid),this},undelegate:function(e,t,r){return this.$el.off(e+".delegateEvents"+this.cid,t,r),this},_createElement:function(e){return document.createElement(e)},_ensureElement:function(){if(this.el)this.setElement(r.result(this,"el"));else{var e=r.extend({},r.result(this,"attributes"));this.id&&(e.id=r.result(this,"id")),this.className&&(e.class=r.result(this,"className")),this.setElement(this._createElement(r.result(this,"tagName"))),this._setAttributes(e)}},_setAttributes:function(e){this.$el.attr(e)}}),t.sync=function(e,n,i){var a=P[e];r.defaults(i||(i={}),{emulateHTTP:t.emulateHTTP,emulateJSON:t.emulateJSON});var s={type:a,dataType:"json"};if(i.url||(s.url=r.result(n,"url")||L()),null!=i.data||!n||"create"!==e&&"update"!==e&&"patch"!==e||(s.contentType="application/json",s.data=JSON.stringify(i.attrs||n.toJSON(i))),i.emulateJSON&&(s.contentType="application/x-www-form-urlencoded",s.data=s.data?{model:s.data}:{}),i.emulateHTTP&&("PUT"===a||"DELETE"===a||"PATCH"===a)){s.type="POST",i.emulateJSON&&(s.data._method=a);var o=i.beforeSend;i.beforeSend=function(e){if(e.setRequestHeader("X-HTTP-Method-Override",a),o)return o.apply(this,arguments)}}"GET"===s.type||i.emulateJSON||(s.processData=!1);var l=i.error;i.error=function(e,t,r){i.textStatus=t,i.errorThrown=r,l&&l.call(i.context,e,t,r)};var c=i.xhr=t.ajax(r.extend(s,i));return n.trigger("request",n,c,i),c};var P={create:"POST",update:"PUT",patch:"PATCH",delete:"DELETE",read:"GET"};t.ajax=function(){return t.$.ajax.apply(t.$,arguments)};var w=t.Router=function(e){e||(e={}),e.routes&&(this.routes=e.routes),this._bindRoutes(),this.initialize.apply(this,arguments)},D=/\((.*?)\)/g,_=/(\(\?)?:\w+/g,A=/\*\w+/g,R=/[\-{}\[\]+?.,\\\^$|#\s]/g;r.extend(w.prototype,c,{initialize:function(){},route:function(e,n,i){r.isRegExp(e)||(e=this._routeToRegExp(e)),r.isFunction(n)&&(i=n,n=""),i||(i=this[n]);var a=this;return t.history.route(e,(function(r){var s=a._extractParameters(e,r);!1!==a.execute(i,s,n)&&(a.trigger.apply(a,["route:"+n].concat(s)),a.trigger("route",n,s),t.history.trigger("route",a,n,s))})),this},execute:function(e,t,r){e&&e.apply(this,t)},navigate:function(e,r){return t.history.navigate(e,r),this},_bindRoutes:function(){if(this.routes){this.routes=r.result(this,"routes");for(var e,t=r.keys(this.routes);null!=(e=t.pop());)this.route(e,this.routes[e])}},_routeToRegExp:function(e){return e=e.replace(R,"\\$&").replace(D,"(?:$1)?").replace(_,(function(e,t){return t?e:"([^/?]+)"})).replace(A,"([^?]*?)"),new RegExp("^"+e+"(?:\\?([\\s\\S]*))?$")},_extractParameters:function(e,t){var n=e.exec(t).slice(1);return r.map(n,(function(e,t){return t===n.length-1?e||null:e?decodeURIComponent(e):null}))}});var M=t.History=function(){this.handlers=[],this.checkUrl=r.bind(this.checkUrl,this),"undefined"!=typeof window&&(this.location=window.location,this.history=window.history)},N=/^[#\/]|\s+$/g,k=/^\/+|\/+$/g,O=/#.*$/;M.started=!1,r.extend(M.prototype,c,{interval:50,atRoot:function(){return this.location.pathname.replace(/[^\/]$/,"$&/")===this.root&&!this.getSearch()},matchRoot:function(){return this.decodeFragment(this.location.pathname).slice(0,this.root.length-1)+"/"===this.root},decodeFragment:function(e){return decodeURI(e.replace(/%25/g,"%2525"))},getSearch:function(){var e=this.location.href.replace(/#.*/,"").match(/\?.+/);return e?e[0]:""},getHash:function(e){var t=(e||this).location.href.match(/#(.*)$/);return t?t[1]:""},getPath:function(){var e=this.decodeFragment(this.location.pathname+this.getSearch()).slice(this.root.length-1);return"/"===e.charAt(0)?e.slice(1):e},getFragment:function(e){return null==e&&(e=this._usePushState||!this._wantsHashChange?this.getPath():this.getHash()),e.replace(N,"")},start:function(e){if(M.started)throw new Error("Backbone.history has already been started");if(M.started=!0,this.options=r.extend({root:"/"},this.options,e),this.root=this.options.root,this._wantsHashChange=!1!==this.options.hashChange,this._hasHashChange="onhashchange"in window&&(void 0===document.documentMode||document.documentMode>7),this._useHashChange=this._wantsHashChange&&this._hasHashChange,this._wantsPushState=!!this.options.pushState,this._hasPushState=!(!this.history||!this.history.pushState),this._usePushState=this._wantsPushState&&this._hasPushState,this.fragment=this.getFragment(),this.root=("/"+this.root+"/").replace(k,"/"),this._wantsHashChange&&this._wantsPushState){if(!this._hasPushState&&!this.atRoot()){var t=this.root.slice(0,-1)||"/";return this.location.replace(t+"#"+this.getPath()),!0}this._hasPushState&&this.atRoot()&&this.navigate(this.getHash(),{replace:!0})}if(!this._hasHashChange&&this._wantsHashChange&&!this._usePushState){this.iframe=document.createElement("iframe"),this.iframe.src="javascript:0",this.iframe.style.display="none",this.iframe.tabIndex=-1;var n=document.body,i=n.insertBefore(this.iframe,n.firstChild).contentWindow;i.document.open(),i.document.close(),i.location.hash="#"+this.fragment}var a=window.addEventListener||function(e,t){return attachEvent("on"+e,t)};if(this._usePushState?a("popstate",this.checkUrl,!1):this._useHashChange&&!this.iframe?a("hashchange",this.checkUrl,!1):this._wantsHashChange&&(this._checkUrlInterval=setInterval(this.checkUrl,this.interval)),!this.options.silent)return this.loadUrl()},stop:function(){var e=window.removeEventListener||function(e,t){return detachEvent("on"+e,t)};this._usePushState?e("popstate",this.checkUrl,!1):this._useHashChange&&!this.iframe&&e("hashchange",this.checkUrl,!1),this.iframe&&(document.body.removeChild(this.iframe),this.iframe=null),this._checkUrlInterval&&clearInterval(this._checkUrlInterval),M.started=!1},route:function(e,t){this.handlers.unshift({route:e,callback:t})},checkUrl:function(e){var t=this.getFragment();if(t===this.fragment&&this.iframe&&(t=this.getHash(this.iframe.contentWindow)),t===this.fragment)return!1;this.iframe&&this.navigate(t),this.loadUrl()},loadUrl:function(e){return!!this.matchRoot()&&(e=this.fragment=this.getFragment(e),r.some(this.handlers,(function(t){if(t.route.test(e))return t.callback(e),!0})))},navigate:function(e,t){if(!M.started)return!1;t&&!0!==t||(t={trigger:!!t}),e=this.getFragment(e||"");var r=this.root;""!==e&&"?"!==e.charAt(0)||(r=r.slice(0,-1)||"/");var n=r+e;if(e=this.decodeFragment(e.replace(O,"")),this.fragment!==e){if(this.fragment=e,this._usePushState)this.history[t.replace?"replaceState":"pushState"]({},document.title,n);else{if(!this._wantsHashChange)return this.location.assign(n);if(this._updateHash(this.location,e,t.replace),this.iframe&&e!==this.getHash(this.iframe.contentWindow)){var i=this.iframe.contentWindow;t.replace||(i.document.open(),i.document.close()),this._updateHash(i.location,e,t.replace)}}return t.trigger?this.loadUrl(e):void 0}},_updateHash:function(e,t,r){if(r){var n=e.href.replace(/(javascript:|#).*$/,"");e.replace(n+"#"+t)}else e.hash="#"+t}}),t.history=new M;y.extend=v.extend=w.extend=S.extend=M.extend=function(e,t){var n,i=this;return n=e&&r.has(e,"constructor")?e.constructor:function(){return i.apply(this,arguments)},r.extend(n,i,t),n.prototype=r.create(i.prototype,e),n.prototype.constructor=n,n.__super__=i.prototype,n};var L=function(){throw new Error('A "url" property or function must be specified')},F=function(e,t){var r=t.error;t.error=function(n){r&&r.call(t.context,e,n,t),e.trigger("error",e,n,t)}};return t})),function e(t,r,n){function i(s,o){if(!r[s]){if(!t[s]){var l="function"==typeof require&&require;if(!o&&l)return l(s,!0);if(a)return a(s,!0);var c=new Error("Cannot find module '"+s+"'");throw c.code="MODULE_NOT_FOUND",c}var u=r[s]={exports:{}};t[s][0].call(u.exports,(function(e){return i(t[s][1][e]||e)}),u,u.exports,e,t,r,n)}return r[s].exports}for(var a="function"==typeof require&&require,s=0;s<n.length;s++)i(n[s]);return i}({1:[function(e,t,r){"use strict";function n(e,t){var r,n;this.name=e,i&&(t=i),this.options=(0,o.fillOptionsWithDefaults)(t),this.method=(0,s.chooseMethod)(this.options),this._iL=!1,this._onML=null,this._addEL={message:[],internal:[]},this._befC=[],this._prepP=null,n=(r=this).method.create(r.name,r.options),(0,a.isPromise)(n)?(r._prepP=n).then((function(e){r._state=e})):r._state=n}Object.defineProperty(r,"__esModule",{value:!0}),r.clearNodeFolder=function(e){e=(0,o.fillOptionsWithDefaults)(e);var t=(0,s.chooseMethod)(e);return"node"===t.type?t.clearNodeFolder().then((function(){return!0})):Promise.resolve(!1)},r.enforceOptions=function(e){i=e},r.BroadcastChannel=void 0;var i,a=e("./util.js"),s=e("./method-chooser.js"),o=e("./options.js");function l(e,t,r){var n={time:e.method.microSeconds(),type:t,data:r};return(e._prepP?e._prepP:Promise.resolve()).then((function(){return e.method.postMessage(e._state,n)}))}function c(e){return 0<e._addEL.message.length||0<e._addEL.internal.length}function u(e,t,r){e._addEL[t].push(r),function(e){if(!e._iL&&c(e)){var t=function(t){e._addEL[t.type].forEach((function(e){t.time>=e.time&&e.fn(t.data)}))},r=e.method.microSeconds();e._prepP?e._prepP.then((function(){e._iL=!0,e.method.onMessage(e._state,t,r)})):(e._iL=!0,e.method.onMessage(e._state,t,r))}}(e)}function h(e,t,r){e._addEL[t]=e._addEL[t].filter((function(e){return e!==r})),function(e){if(e._iL&&!c(e)){e._iL=!1;var t=e.method.microSeconds();e.method.onMessage(e._state,null,t)}}(e)}(r.BroadcastChannel=n)._pubkey=!0,n.prototype={postMessage:function(e){if(this.closed)throw new Error("BroadcastChannel.postMessage(): Cannot post message after channel has closed");return l(this,"message",e)},postInternal:function(e){return l(this,"internal",e)},set onmessage(e){var t={time:this.method.microSeconds(),fn:e};h(this,"message",this._onML),e&&"function"==typeof e?(this._onML=t,u(this,"message",t)):this._onML=null},addEventListener:function(e,t){u(this,e,{time:this.method.microSeconds(),fn:t})},removeEventListener:function(e,t){h(this,e,this._addEL[e].find((function(e){return e.fn===t})))},close:function(){var e=this;if(!this.closed){this.closed=!0;var t=this._prepP?this._prepP:Promise.resolve();return this._onML=null,this._addEL.message=[],t.then((function(){return Promise.all(e._befC.map((function(e){return e()})))})).then((function(){return e.method.close(e._state)}))}},get type(){return this.method.type}}},{"./method-chooser.js":6,"./options.js":12,"./util.js":13}],2:[function(e,t,r){"use strict";var n=e("./index.es5.js"),i=n.BroadcastChannel,a=n.createLeaderElection;window.BroadcastChannel2=i,window.createLeaderElection=a},{"./index.es5.js":3}],3:[function(e,t,r){"use strict";var n=e("./index.js");t.exports={BroadcastChannel:n.BroadcastChannel,createLeaderElection:n.createLeaderElection,clearNodeFolder:n.clearNodeFolder,enforceOptions:n.enforceOptions}},{"./index.js":4}],4:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),Object.defineProperty(r,"BroadcastChannel",{enumerable:!0,get:function(){return n.BroadcastChannel}}),Object.defineProperty(r,"clearNodeFolder",{enumerable:!0,get:function(){return n.clearNodeFolder}}),Object.defineProperty(r,"enforceOptions",{enumerable:!0,get:function(){return n.enforceOptions}}),Object.defineProperty(r,"createLeaderElection",{enumerable:!0,get:function(){return i.createLeaderElection}});var n=e("./broadcast-channel"),i=e("./leader-election")},{"./broadcast-channel":1,"./leader-election":5}],5:[function(e,t,r){"use strict";var n=e("@babel/runtime/helpers/interopRequireDefault");Object.defineProperty(r,"__esModule",{value:!0}),r.createLeaderElection=function(e,t){if(e._leaderElector)throw new Error("BroadcastChannel already has a leader-elector");t=function(e,t){return e=e||{},(e=JSON.parse(JSON.stringify(e))).fallbackInterval||(e.fallbackInterval=3e3),e.responseTime||(e.responseTime=t.method.averageResponseTime(t.options)),e}(t,e);var r=new s(e,t);return e._befC.push((function(){return r.die()})),e._leaderElector=r};var i=e("./util.js"),a=n(e("unload")),s=function(e,t){this._channel=e,this._options=t,this.isLeader=!1,this.isDead=!1,this.token=(0,i.randomToken)(),this._isApl=!1,this._reApply=!1,this._unl=[],this._lstns=[],this._invs=[]};function o(e,t){var r={context:"leader",action:t,token:e.token};return e._channel.postInternal(r)}s.prototype={applyOnce:function(){var e=this;if(this.isLeader)return Promise.resolve(!1);if(this.isDead)return Promise.resolve(!1);if(this._isApl)return this._reApply=!0,Promise.resolve(!1);function t(t){"leader"===t.context&&t.token!=e.token&&(n.push(t),"apply"===t.action&&t.token>e.token&&(r=!0),"tell"===t.action&&(r=!0))}var r=!(this._isApl=!0),n=[];return this._channel.addEventListener("internal",t),o(this,"apply").then((function(){return(0,i.sleep)(e._options.responseTime)})).then((function(){return r?Promise.reject(new Error):o(e,"apply")})).then((function(){return(0,i.sleep)(e._options.responseTime)})).then((function(){return r?Promise.reject(new Error):o(e)})).then((function(){return function(e){e.isLeader=!0;var t=a.default.add((function(){return e.die()}));function r(t){"leader"===t.context&&"apply"===t.action&&o(e,"tell")}return e._unl.push(t),e._channel.addEventListener("internal",r),e._lstns.push(r),o(e,"tell")}(e)})).then((function(){return!0})).catch((function(){return!1})).then((function(r){return e._channel.removeEventListener("internal",t),e._isApl=!1,!r&&e._reApply?(e._reApply=!1,e.applyOnce()):r}))},awaitLeadership:function(){var e;return this._aLP||(this._aLP=(e=this).isLeader?Promise.resolve():new Promise((function(t){function r(){n||(n=!0,clearInterval(i),e._channel.removeEventListener("internal",a),t(!0))}var n=!1;e.applyOnce().then((function(){e.isLeader&&r()}));var i=setInterval((function(){e.applyOnce().then((function(){e.isLeader&&r()}))}),e._options.fallbackInterval);e._invs.push(i);var a=function(t){"leader"===t.context&&"death"===t.action&&e.applyOnce().then((function(){e.isLeader&&r()}))};e._channel.addEventListener("internal",a),e._lstns.push(a)}))),this._aLP},die:function(){var e=this;if(!this.isDead)return this.isDead=!0,this._lstns.forEach((function(t){return e._channel.removeEventListener("internal",t)})),this._invs.forEach((function(e){return clearInterval(e)})),this._unl.forEach((function(e){e.remove()})),o(this,"death")}}},{"./util.js":13,"@babel/runtime/helpers/interopRequireDefault":14,unload:19}],6:[function(e,t,r){"use strict";var n=e("@babel/runtime/helpers/interopRequireDefault");Object.defineProperty(r,"__esModule",{value:!0}),r.chooseMethod=function(e){var t=[].concat(e.methods,c).filter(Boolean);if(e.type){if("simulate"===e.type)return o.default;var r=t.find((function(t){return t.type===e.type}));if(r)return r;throw new Error("method-type "+e.type+" not found")}e.webWorkerSupport||l.isNode||(t=t.filter((function(e){return"idb"!==e.type})));var n=t.find((function(e){return e.canBeUsed()}));if(n)return n;throw new Error("No useable methode found:"+JSON.stringify(c.map((function(e){return e.type}))))};var i=n(e("./methods/native.js")),a=n(e("./methods/indexed-db.js")),s=n(e("./methods/localstorage.js")),o=n(e("./methods/simulate.js")),l=e("./util"),c=[i.default,a.default,s.default];if(l.isNode){var u=e("../../src/methods/node.js");"function"==typeof u.canBeUsed&&c.push(u)}},{"./methods/indexed-db.js":7,"./methods/localstorage.js":8,"./methods/native.js":9,"./methods/simulate.js":10,"./util":13,"@babel/runtime/helpers/interopRequireDefault":14}],7:[function(e,t,r){"use strict";var n=e("@babel/runtime/helpers/interopRequireDefault");Object.defineProperty(r,"__esModule",{value:!0}),r.getIdb=c,r.createDatabase=u,r.writeMessage=h,r.getAllMessages=function(e){var t=e.transaction(l).objectStore(l),r=[];return new Promise((function(e){t.openCursor().onsuccess=function(t){var n=t.target.result;n?(r.push(n.value),n.continue()):e(r)}}))},r.getMessagesHigherThen=f,r.removeMessageById=d,r.getOldMessages=p,r.cleanOldMessages=m,r.create=g,r.close=y,r.postMessage=v,r.onMessage=E,r.canBeUsed=C,r.averageResponseTime=b,r.default=r.type=r.microSeconds=void 0;var i=e("../util.js"),a=n(e("../oblivious-set")),s=e("../options"),o=i.microSeconds;r.microSeconds=o;var l="messages";function c(){if("undefined"!=typeof indexedDB)return indexedDB;if("undefined"!=typeof window){if(void 0!==window.mozIndexedDB)return window.mozIndexedDB;if(void 0!==window.webkitIndexedDB)return window.webkitIndexedDB;if(void 0!==window.msIndexedDB)return window.msIndexedDB}return!1}function u(e){var t="pubkey.broadcast-channel-0-"+e,r=c().open(t,1);return r.onupgradeneeded=function(e){e.target.result.createObjectStore(l,{keyPath:"id",autoIncrement:!0})},new Promise((function(e,t){r.onerror=function(e){return t(e)},r.onsuccess=function(){e(r.result)}}))}function h(e,t,r){var n={uuid:t,time:(new Date).getTime(),data:r},i=e.transaction([l],"readwrite");return new Promise((function(e,t){i.oncomplete=function(){return e()},i.onerror=function(e){return t(e)},i.objectStore(l).add(n)}))}function f(e,t){var r=e.transaction(l).objectStore(l),n=[],i=IDBKeyRange.bound(t+1,1/0);return new Promise((function(e){r.openCursor(i).onsuccess=function(t){var r=t.target.result;r?(n.push(r.value),r.continue()):e(n)}}))}function d(e,t){var r=e.transaction([l],"readwrite").objectStore(l).delete(t);return new Promise((function(e){r.onsuccess=function(){return e()}}))}function p(e,t){var r=(new Date).getTime()-t,n=e.transaction(l).objectStore(l),i=[];return new Promise((function(e){n.openCursor().onsuccess=function(t){var n=t.target.result;if(n){var a=n.value;if(!(a.time<r))return void e(i);i.push(a),n.continue()}else e(i)}}))}function m(e,t){return p(e,t).then((function(t){return Promise.all(t.map((function(t){return d(e,t.id)})))}))}function g(e,t){return t=(0,s.fillOptionsWithDefaults)(t),u(e).then((function(r){var n={closed:!1,lastCursorId:0,channelName:e,options:t,uuid:(0,i.randomToken)(),eMIs:new a.default(2*t.idb.ttl),writeBlockPromise:Promise.resolve(),messagesCallback:null,readQueuePromises:[],db:r};return function e(t){t.closed||T(t).then((function(){return(0,i.sleep)(t.options.idb.fallbackInterval)})).then((function(){return e(t)}))}(n),n}))}function T(e){return!e.closed&&e.messagesCallback?f(e.db,e.lastCursorId).then((function(t){return t.filter((function(e){return!!e})).map((function(t){return t.id>e.lastCursorId&&(e.lastCursorId=t.id),t})).filter((function(t){return n=e,!((r=t).uuid===n.uuid||n.eMIs.has(r.id)||r.data.time<n.messagesCallbackTime);var r,n})).sort((function(e,t){return e.time-t.time})).forEach((function(t){e.messagesCallback&&(e.eMIs.add(t.id),e.messagesCallback(t.data))})),Promise.resolve()})):Promise.resolve()}function y(e){e.closed=!0,e.db.close()}function v(e,t){return e.writeBlockPromise=e.writeBlockPromise.then((function(){return h(e.db,e.uuid,t)})).then((function(){0===(0,i.randomInt)(0,10)&&m(e.db,e.options.idb.ttl)})),e.writeBlockPromise}function E(e,t,r){e.messagesCallbackTime=r,e.messagesCallback=t,T(e)}function C(){return!i.isNode&&!!c()}function b(e){return 2*e.idb.fallbackInterval}var S={create:g,close:y,onMessage:E,postMessage:v,canBeUsed:C,type:r.type="idb",averageResponseTime:b,microSeconds:o};r.default=S},{"../oblivious-set":11,"../options":12,"../util.js":13,"@babel/runtime/helpers/interopRequireDefault":14}],8:[function(e,t,r){"use strict";var n=e("@babel/runtime/helpers/interopRequireDefault");Object.defineProperty(r,"__esModule",{value:!0}),r.getLocalStorage=l,r.storageKey=c,r.postMessage=u,r.addStorageEventListener=h,r.removeStorageEventListener=f,r.create=d,r.close=p,r.onMessage=m,r.canBeUsed=g,r.averageResponseTime=T,r.default=r.type=r.microSeconds=void 0;var i=n(e("../oblivious-set")),a=e("../options"),s=e("../util"),o=s.microSeconds;r.microSeconds=o;function l(){var e;if("undefined"==typeof window)return null;try{e=window.localStorage,e=window["ie8-eventlistener/storage"]||window.localStorage}catch(e){}return e}function c(e){return"pubkey.broadcastChannel-"+e}function u(e,t){return new Promise((function(r){(0,s.sleep)().then((function(){var n=c(e.channelName),i={token:(0,s.randomToken)(),time:(new Date).getTime(),data:t,uuid:e.uuid},a=JSON.stringify(i);l().setItem(n,a);var o=document.createEvent("Event");o.initEvent("storage",!0,!0),o.key=n,o.newValue=a,window.dispatchEvent(o),r()}))}))}function h(e,t){function r(e){e.key===n&&t(JSON.parse(e.newValue))}var n=c(e);return window.addEventListener("storage",r),r}function f(e){window.removeEventListener("storage",e)}function d(e,t){if(t=(0,a.fillOptionsWithDefaults)(t),!g())throw new Error("BroadcastChannel: localstorage cannot be used");var r=(0,s.randomToken)(),n=new i.default(t.localstorage.removeTimeout),o={channelName:e,uuid:r,eMIs:n};return o.listener=h(e,(function(e){o.messagesCallback&&e.uuid!==r&&e.token&&!n.has(e.token)&&(e.data.time&&e.data.time<o.messagesCallbackTime||(n.add(e.token),o.messagesCallback(e.data)))})),o}function p(e){f(e.listener)}function m(e,t,r){e.messagesCallbackTime=r,e.messagesCallback=t}function g(){if(s.isNode)return!1;var e=l();if(!e)return!1;try{var t="__broadcastchannel_check";e.setItem(t,"works"),e.removeItem(t)}catch(e){return!1}return!0}function T(){var e=navigator.userAgent.toLowerCase();return e.includes("safari")&&!e.includes("chrome")?240:120}var y={create:d,close:p,onMessage:m,postMessage:u,canBeUsed:g,type:r.type="localstorage",averageResponseTime:T,microSeconds:o};r.default=y},{"../oblivious-set":11,"../options":12,"../util":13,"@babel/runtime/helpers/interopRequireDefault":14}],9:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.create=a,r.close=s,r.postMessage=o,r.onMessage=l,r.canBeUsed=c,r.averageResponseTime=u,r.default=r.type=r.microSeconds=void 0;var n=e("../util"),i=n.microSeconds;function a(e){var t={messagesCallback:null,bc:new BroadcastChannel(e),subFns:[]};return t.bc.onmessage=function(e){t.messagesCallback&&t.messagesCallback(e.data)},t}function s(e){e.bc.close(),e.subFns=[]}function o(e,t){e.bc.postMessage(t,!1)}function l(e,t){e.messagesCallback=t}function c(){if(n.isNode&&"undefined"==typeof window)return!1;if("function"!=typeof BroadcastChannel)return!1;if(BroadcastChannel._pubkey)throw new Error("BroadcastChannel: Do not overwrite window.BroadcastChannel with this module, this is not a polyfill");return!0}function u(){return 150}r.microSeconds=i;var h={create:a,close:s,onMessage:l,postMessage:o,canBeUsed:c,type:r.type="native",averageResponseTime:u,microSeconds:i};r.default=h},{"../util":13}],10:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.create=s,r.close=o,r.postMessage=l,r.onMessage=c,r.canBeUsed=u,r.averageResponseTime=h,r.default=r.type=r.microSeconds=void 0;var n=e("../util").microSeconds;r.microSeconds=n;var i="simulate";r.type=i;var a=new Set;function s(e){var t={name:e,messagesCallback:null};return a.add(t),t}function o(e){a.delete(e)}function l(e,t){return new Promise((function(r){return setTimeout((function(){Array.from(a).filter((function(t){return t.name===e.name})).filter((function(t){return t!==e})).filter((function(e){return!!e.messagesCallback})).forEach((function(e){return e.messagesCallback(t)})),r()}),5)}))}function c(e,t){e.messagesCallback=t}function u(){return!0}function h(){return 5}var f={create:s,close:o,onMessage:c,postMessage:l,canBeUsed:u,type:i,averageResponseTime:h,microSeconds:n};r.default=f},{"../util":13}],11:[function(e,t,r){"use strict";function n(){return(new Date).getTime()}Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0,r.default=function(e){var t=new Set,r=new Map;this.has=t.has.bind(t),this.add=function(i){r.set(i,n()),t.add(i),function(){for(var i=n()-e,a=t[Symbol.iterator]();;){var s=a.next().value;if(!s)return;if(!(r.get(s)<i))return;r.delete(s),t.delete(s)}}()},this.clear=function(){t.clear(),r.clear()}}},{}],12:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.fillOptionsWithDefaults=function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},t=JSON.parse(JSON.stringify(e));return void 0===t.webWorkerSupport&&(t.webWorkerSupport=!0),t.idb||(t.idb={}),t.idb.ttl||(t.idb.ttl=45e3),t.idb.fallbackInterval||(t.idb.fallbackInterval=150),t.localstorage||(t.localstorage={}),t.localstorage.removeTimeout||(t.localstorage.removeTimeout=6e4),e.methods&&(t.methods=e.methods),t.node||(t.node={}),t.node.ttl||(t.node.ttl=12e4),void 0===t.node.useFastPath&&(t.node.useFastPath=!0),t}},{}],13:[function(e,t,r){(function(e){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.isPromise=function(e){return!(!e||"function"!=typeof e.then)},r.sleep=function(e){return e=e||0,new Promise((function(t){return setTimeout(t,e)}))},r.randomInt=function(e,t){return Math.floor(Math.random()*(t-e+1)+e)},r.randomToken=function(){return Math.random().toString(36).substring(2)},r.microSeconds=function(){var e=(new Date).getTime();return e===t?1e3*e+ ++n:(n=0,1e3*(t=e))},r.isNode=void 0;var t=0,n=0,i="[object process]"===Object.prototype.toString.call(void 0!==e?e:0);r.isNode=i}).call(this,e("_process"))},{_process:17}],14:[function(e,t,r){t.exports=function(e){return e&&e.__esModule?e:{default:e}}},{}],15:[function(e,t,r){},{}],16:[function(e,t,r){t.exports=!1},{}],17:[function(e,t,r){var n,i,a=t.exports={};function s(){throw new Error("setTimeout has not been defined")}function o(){throw new Error("clearTimeout has not been defined")}function l(e){if(n===setTimeout)return setTimeout(e,0);if((n===s||!n)&&setTimeout)return n=setTimeout,setTimeout(e,0);try{return n(e,0)}catch(t){try{return n.call(null,e,0)}catch(t){return n.call(this,e,0)}}}!function(){try{n="function"==typeof setTimeout?setTimeout:s}catch(e){n=s}try{i="function"==typeof clearTimeout?clearTimeout:o}catch(e){i=o}}();var c,u=[],h=!1,f=-1;function d(){h&&c&&(h=!1,c.length?u=c.concat(u):f=-1,u.length&&p())}function p(){if(!h){var e=l(d);h=!0;for(var t=u.length;t;){for(c=u,u=[];++f<t;)c&&c[f].run();f=-1,t=u.length}c=null,h=!1,function(e){if(i===clearTimeout)return clearTimeout(e);if((i===o||!i)&&clearTimeout)return i=clearTimeout,clearTimeout(e);try{i(e)}catch(t){try{return i.call(null,e)}catch(t){return i.call(this,e)}}}(e)}}function m(e,t){this.fun=e,this.array=t}function g(){}a.nextTick=function(e){var t=new Array(arguments.length-1);if(1<arguments.length)for(var r=1;r<arguments.length;r++)t[r-1]=arguments[r];u.push(new m(e,t)),1!==u.length||h||l(p)},m.prototype.run=function(){this.fun.apply(null,this.array)},a.title="browser",a.browser=!0,a.env={},a.argv=[],a.version="",a.versions={},a.on=g,a.addListener=g,a.once=g,a.off=g,a.removeListener=g,a.removeAllListeners=g,a.emit=g,a.prependListener=g,a.prependOnceListener=g,a.listeners=function(e){return[]},a.binding=function(e){throw new Error("process.binding is not supported")},a.cwd=function(){return"/"},a.chdir=function(e){throw new Error("process.chdir is not supported")},a.umask=function(){return 0}},{}],18:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var n={add:function(e){if(!("function"==typeof WorkerGlobalScope&&self instanceof WorkerGlobalScope)){if("function"!=typeof window.addEventListener)return;window.addEventListener("beforeunload",(function(){e()}),!0),window.addEventListener("unload",(function(){e()}),!0)}}};r.default=n},{}],19:[function(e,t,r){"use strict";var n=e("@babel/runtime/helpers/interopRequireDefault");Object.defineProperty(r,"__esModule",{value:!0}),r.add=u,r.runAll=h,r.removeAll=f,r.getSize=d,r.default=void 0;var i=n(e("detect-node")),a=n(e("./browser.js")),s=n(e("./node.js")),o=i.default?s.default:a.default,l=new Set,c=!1;function u(e){if(c||(c=!0,o.add(h)),"function"!=typeof e)throw new Error("Listener is no function");return l.add(e),{remove:function(){return l.delete(e)},run:function(){return l.delete(e),e()}}}function h(){var e=[];return l.forEach((function(t){e.push(t()),l.delete(t)})),Promise.all(e)}function f(){l.clear()}function d(){return l.size}var p={add:u,runAll:h,removeAll:f,getSize:d};r.default=p},{"./browser.js":18,"./node.js":15,"@babel/runtime/helpers/interopRequireDefault":14,"detect-node":16}]},{},[2]),"undefined"!=typeof navigator&&function(e,t){e.lottie=function(e){"use strict";var t,r="",n=!0,i=(/^((?!chrome|android).)*safari/i.test(navigator.userAgent),Math.round,Math.pow),a=Math.sqrt,s=(Math.abs,Math.floor),o=(Math.max,Math.min),l={};(function(){var e,t=Object.getOwnPropertyNames(Math),r=t.length;for(e=0;e<r;e+=1)l[t[e]]=Math[t[e]]})(),l.random=Math.random,l.abs=function(e){if("object"===typeof e&&e.length){var t,r=P(e.length),n=e.length;for(t=0;t<n;t+=1)r[t]=Math.abs(e[t]);return r}return Math.abs(e)};var c=150,u=Math.PI/180;function h(e){e?Math.round:function(e){return e}}function f(e,t,r,n){this.type=e,this.currentTime=t,this.totalTime=r,this.direction=n<0?-1:1}function d(e,t){this.type=e,this.direction=t<0?-1:1}function p(e,t,r,n){this.type=e,this.currentLoop=r,this.totalLoops=t,this.direction=n<0?-1:1}function m(e,t,r){this.type=e,this.firstFrame=t,this.totalFrames=r}function g(e,t){this.type=e,this.target=t}function T(e,t){var r;void 0===t&&(t="abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ1234567890");var n="";for(r=e;r>0;--r)n+=t[Math.round(Math.random()*(t.length-1))];return n}function y(e,t,r){var n,i,a,s,o,l,c,u;switch(l=r*(1-t),c=r*(1-(o=6*e-(s=Math.floor(6*e)))*t),u=r*(1-(1-o)*t),s%6){case 0:n=r,i=u,a=l;break;case 1:n=c,i=r,a=l;break;case 2:n=l,i=r,a=u;break;case 3:n=l,i=c,a=r;break;case 4:n=u,i=l,a=r;break;case 5:n=r,i=l,a=c}return[n,i,a]}function v(e,t,r){var n,i=Math.max(e,t,r),a=Math.min(e,t,r),s=i-a,o=0===i?0:s/i,l=i/255;switch(i){case a:n=0;break;case e:n=t-r+s*(t<r?6:0),n/=6*s;break;case t:n=r-e+2*s,n/=6*s;break;case r:n=e-t+4*s,n/=6*s}return[n,o,l]}function E(e,t){var r=v(255*e[0],255*e[1],255*e[2]);return r[1]+=t,r[1]>1?r[1]=1:r[1]<=0&&(r[1]=0),y(r[0],r[1],r[2])}function C(e,t){var r=v(255*e[0],255*e[1],255*e[2]);return r[2]+=t,r[2]>1?r[2]=1:r[2]<0&&(r[2]=0),y(r[0],r[1],r[2])}function b(e,t){var r=v(255*e[0],255*e[1],255*e[2]);return r[0]+=t/360,r[0]>1?r[0]-=1:r[0]<0&&(r[0]+=1),y(r[0],r[1],r[2])}h(!1);var S=function(){var e,t,r=[];for(e=0;e<256;e+=1)t=e.toString(16),r[e]=1==t.length?"0"+t:t;return function(e,t,n){return e<0&&(e=0),t<0&&(t=0),n<0&&(n=0),"#"+r[e]+r[t]+r[n]}}();function I(){}I.prototype={triggerEvent:function(e,t){if(this._cbs[e])for(var r=this._cbs[e].length,n=0;n<r;n++)this._cbs[e][n](t)},addEventListener:function(e,t){return this._cbs[e]||(this._cbs[e]=[]),this._cbs[e].push(t),function(){this.removeEventListener(e,t)}.bind(this)},removeEventListener:function(e,t){if(t){if(this._cbs[e]){for(var r=0,n=this._cbs[e].length;r<n;)this._cbs[e][r]===t&&(this._cbs[e].splice(r,1),r-=1,n-=1),r+=1;this._cbs[e].length||(this._cbs[e]=null)}}else this._cbs[e]=null}};var x="function"==typeof Uint8ClampedArray&&"function"==typeof Float32Array?function(e,t){return"float32"===e?new Float32Array(t):"int16"===e?new Int16Array(t):"uint8c"===e?new Uint8ClampedArray(t):void 0}:function(e,t){var r,n=0,i=[];switch(e){case"int16":case"uint8c":r=1;break;default:r=1.1}for(n=0;n<t;n+=1)i.push(r);return i};function P(e){return Array.apply(null,{length:e})}function w(e){return document.createElementNS("http://www.w3.org/2000/svg",e)}function D(e){return document.createElement(e)}function _(){}_.prototype={addDynamicProperty:function(e){-1===this.dynamicProperties.indexOf(e)&&(this.dynamicProperties.push(e),this.container.addDynamicProperty(this),this._isAnimated=!0)},iterateDynamicProperties:function(){this._mdf=!1;var e,t=this.dynamicProperties.length;for(e=0;e<t;e+=1)this.dynamicProperties[e].getValue(),this.dynamicProperties[e]._mdf&&(this._mdf=!0)},initDynamicPropertyContainer:function(e){this.container=e,this.dynamicProperties=[],this._mdf=!1,this._isAnimated=!1}}
/*!
 Transformation Matrix v2.0
 (c) Epistemex 2014-2015
 www.epistemex.com
 By Ken Fyrstenberg
 Contributions by leeoniya.
 License: MIT, header required.
 */;var A=function(){var e=Math.cos,t=Math.sin,r=Math.tan,n=Math.round;function i(){return this.props[0]=1,this.props[1]=0,this.props[2]=0,this.props[3]=0,this.props[4]=0,this.props[5]=1,this.props[6]=0,this.props[7]=0,this.props[8]=0,this.props[9]=0,this.props[10]=1,this.props[11]=0,this.props[12]=0,this.props[13]=0,this.props[14]=0,this.props[15]=1,this}function a(r){if(0===r)return this;var n=e(r),i=t(r);return this._t(n,-i,0,0,i,n,0,0,0,0,1,0,0,0,0,1)}function s(r){if(0===r)return this;var n=e(r),i=t(r);return this._t(1,0,0,0,0,n,-i,0,0,i,n,0,0,0,0,1)}function o(r){if(0===r)return this;var n=e(r),i=t(r);return this._t(n,0,i,0,0,1,0,0,-i,0,n,0,0,0,0,1)}function l(r){if(0===r)return this;var n=e(r),i=t(r);return this._t(n,-i,0,0,i,n,0,0,0,0,1,0,0,0,0,1)}function c(e,t){return this._t(1,t,e,1,0,0)}function u(e,t){return this.shear(r(e),r(t))}function h(n,i){var a=e(i),s=t(i);return this._t(a,s,0,0,-s,a,0,0,0,0,1,0,0,0,0,1)._t(1,0,0,0,r(n),1,0,0,0,0,1,0,0,0,0,1)._t(a,-s,0,0,s,a,0,0,0,0,1,0,0,0,0,1)}function f(e,t,r){return r=isNaN(r)?1:r,1==e&&1==t&&1==r?this:this._t(e,0,0,0,0,t,0,0,0,0,r,0,0,0,0,1)}function d(e,t,r,n,i,a,s,o,l,c,u,h,f,d,p,m){return this.props[0]=e,this.props[1]=t,this.props[2]=r,this.props[3]=n,this.props[4]=i,this.props[5]=a,this.props[6]=s,this.props[7]=o,this.props[8]=l,this.props[9]=c,this.props[10]=u,this.props[11]=h,this.props[12]=f,this.props[13]=d,this.props[14]=p,this.props[15]=m,this}function p(e,t,r){return r=r||0,0!==e||0!==t||0!==r?this._t(1,0,0,0,0,1,0,0,0,0,1,0,e,t,r,1):this}function m(e,t,r,n,i,a,s,o,l,c,u,h,f,d,p,m){var g=this.props;if(1===e&&0===t&&0===r&&0===n&&0===i&&1===a&&0===s&&0===o&&0===l&&0===c&&1===u&&0===h)return g[12]=g[12]*e+g[15]*f,g[13]=g[13]*a+g[15]*d,g[14]=g[14]*u+g[15]*p,g[15]=g[15]*m,this._identityCalculated=!1,this;var T=g[0],y=g[1],v=g[2],E=g[3],C=g[4],b=g[5],S=g[6],I=g[7],x=g[8],P=g[9],w=g[10],D=g[11],_=g[12],A=g[13],R=g[14],M=g[15];return g[0]=T*e+y*i+v*l+E*f,g[1]=T*t+y*a+v*c+E*d,g[2]=T*r+y*s+v*u+E*p,g[3]=T*n+y*o+v*h+E*m,g[4]=C*e+b*i+S*l+I*f,g[5]=C*t+b*a+S*c+I*d,g[6]=C*r+b*s+S*u+I*p,g[7]=C*n+b*o+S*h+I*m,g[8]=x*e+P*i+w*l+D*f,g[9]=x*t+P*a+w*c+D*d,g[10]=x*r+P*s+w*u+D*p,g[11]=x*n+P*o+w*h+D*m,g[12]=_*e+A*i+R*l+M*f,g[13]=_*t+A*a+R*c+M*d,g[14]=_*r+A*s+R*u+M*p,g[15]=_*n+A*o+R*h+M*m,this._identityCalculated=!1,this}function g(){return this._identityCalculated||(this._identity=!(1!==this.props[0]||0!==this.props[1]||0!==this.props[2]||0!==this.props[3]||0!==this.props[4]||1!==this.props[5]||0!==this.props[6]||0!==this.props[7]||0!==this.props[8]||0!==this.props[9]||1!==this.props[10]||0!==this.props[11]||0!==this.props[12]||0!==this.props[13]||0!==this.props[14]||1!==this.props[15]),this._identityCalculated=!0),this._identity}function T(e){for(var t=0;t<16;){if(e.props[t]!==this.props[t])return!1;t+=1}return!0}function y(e){var t;for(t=0;t<16;t+=1)e.props[t]=this.props[t]}function v(e){var t;for(t=0;t<16;t+=1)this.props[t]=e[t]}function E(e,t,r){return{x:e*this.props[0]+t*this.props[4]+r*this.props[8]+this.props[12],y:e*this.props[1]+t*this.props[5]+r*this.props[9]+this.props[13],z:e*this.props[2]+t*this.props[6]+r*this.props[10]+this.props[14]}}function C(e,t,r){return e*this.props[0]+t*this.props[4]+r*this.props[8]+this.props[12]}function b(e,t,r){return e*this.props[1]+t*this.props[5]+r*this.props[9]+this.props[13]}function S(e,t,r){return e*this.props[2]+t*this.props[6]+r*this.props[10]+this.props[14]}function I(e){var t=this.props[0]*this.props[5]-this.props[1]*this.props[4],r=this.props[5]/t,n=-this.props[1]/t,i=-this.props[4]/t,a=this.props[0]/t,s=(this.props[4]*this.props[13]-this.props[5]*this.props[12])/t,o=-(this.props[0]*this.props[13]-this.props[1]*this.props[12])/t;return[e[0]*r+e[1]*i+s,e[0]*n+e[1]*a+o,0]}function P(e){var t,r=e.length,n=[];for(t=0;t<r;t+=1)n[t]=I(e[t]);return n}function w(e,t,r){var n=x("float32",6);if(this.isIdentity())n[0]=e[0],n[1]=e[1],n[2]=t[0],n[3]=t[1],n[4]=r[0],n[5]=r[1];else{var i=this.props[0],a=this.props[1],s=this.props[4],o=this.props[5],l=this.props[12],c=this.props[13];n[0]=e[0]*i+e[1]*s+l,n[1]=e[0]*a+e[1]*o+c,n[2]=t[0]*i+t[1]*s+l,n[3]=t[0]*a+t[1]*o+c,n[4]=r[0]*i+r[1]*s+l,n[5]=r[0]*a+r[1]*o+c}return n}function D(e,t,r){return this.isIdentity()?[e,t,r]:[e*this.props[0]+t*this.props[4]+r*this.props[8]+this.props[12],e*this.props[1]+t*this.props[5]+r*this.props[9]+this.props[13],e*this.props[2]+t*this.props[6]+r*this.props[10]+this.props[14]]}function _(e,t){if(this.isIdentity())return e+","+t;var r=this.props;return Math.round(100*(e*r[0]+t*r[4]+r[12]))/100+","+Math.round(100*(e*r[1]+t*r[5]+r[13]))/100}function A(){for(var e=0,t=this.props,r="matrix3d(";e<16;)r+=n(1e4*t[e])/1e4,r+=15===e?")":",",e+=1;return r}function R(e){return e<1e-6&&e>0||e>-1e-6&&e<0?n(1e4*e)/1e4:e}function M(){var e=this.props;return"matrix("+R(e[0])+","+R(e[1])+","+R(e[4])+","+R(e[5])+","+R(e[12])+","+R(e[13])+")"}return function(){this.reset=i,this.rotate=a,this.rotateX=s,this.rotateY=o,this.rotateZ=l,this.skew=u,this.skewFromAxis=h,this.shear=c,this.scale=f,this.setTransform=d,this.translate=p,this.transform=m,this.applyToPoint=E,this.applyToX=C,this.applyToY=b,this.applyToZ=S,this.applyToPointArray=D,this.applyToTriplePoints=w,this.applyToPointStringified=_,this.toCSS=A,this.to2dCSS=M,this.clone=y,this.cloneFromProps=v,this.equals=T,this.inversePoints=P,this.inversePoint=I,this._t=this.transform,this.isIdentity=g,this._identity=!0,this._identityCalculated=!1,this.props=x("float32",16),this.reset()}}();!function(e,t){var r=this,n=t.pow(256,6),i=t.pow(2,52),a=2*i;function s(e){var t,r=e.length,n=this,i=0,a=n.i=n.j=0,s=n.S=[];for(r||(e=[r++]);i<256;)s[i]=i++;for(i=0;i<256;i++)s[i]=s[a=255&a+e[i%r]+(t=s[i])],s[a]=t;n.g=function(e){for(var t,r=0,i=n.i,a=n.j,s=n.S;e--;)t=s[i=255&i+1],r=256*r+s[255&(s[i]=s[a=255&a+t])+(s[a]=t)];return n.i=i,n.j=a,r}}function o(e,t){return t.i=e.i,t.j=e.j,t.S=e.S.slice(),t}function l(e,t){for(var r,n=e+"",i=0;i<n.length;)t[255&i]=255&(r^=19*t[255&i])+n.charCodeAt(i++);return c(t)}function c(e){return String.fromCharCode.apply(0,e)}t.seedrandom=function(u,h,f){var d=[],p=l(function e(t,r){var n,i=[],a=typeof t;if(r&&"object"==a)for(n in t)try{i.push(e(t[n],r-1))}catch(e){}return i.length?i:"string"==a?t:t+"\0"}((h=!0===h?{entropy:!0}:h||{}).entropy?[u,c(e)]:null===u?function(){try{void 0;var t=new Uint8Array(256);return(r.crypto||r.msCrypto).getRandomValues(t),c(t)}catch(t){var n=r.navigator,i=n&&n.plugins;return[+new Date,r,i,r.screen,c(e)]}}():u,3),d),m=new s(d),g=function(){for(var e=m.g(6),t=n,r=0;e<i;)e=256*(e+r),t*=256,r=m.g(1);for(;e>=a;)e/=2,t/=2,r>>>=1;return(e+r)/t};return g.int32=function(){return 0|m.g(4)},g.quick=function(){return m.g(4)/4294967296},g.double=g,l(c(m.S),e),(h.pass||f||function(e,r,n,i){return i&&(i.S&&o(i,m),e.state=function(){return o(m,{})}),n?(t.random=e,r):e})(g,p,"global"in h?h.global:this==t,h.state)},l(t.random(),e)}([],l);var R=function(){var e={getBezierEasing:function(e,r,n,i,a){var s=a||("bez_"+e+"_"+r+"_"+n+"_"+i).replace(/\./g,"p");if(t[s])return t[s];var o=new l([e,r,n,i]);return t[s]=o,o}},t={};var r="function"==typeof Float32Array;function n(e,t){return 1-3*t+3*e}function i(e,t){return 3*t-6*e}function a(e){return 3*e}function s(e,t,r){return((n(t,r)*e+i(t,r))*e+a(t))*e}function o(e,t,r){return 3*n(t,r)*e*e+2*i(t,r)*e+a(t)}function l(e){this._p=e,this._mSampleValues=r?new Float32Array(11):new Array(11),this._precomputed=!1,this.get=this.get.bind(this)}return l.prototype={get:function(e){var t=this._p[0],r=this._p[1],n=this._p[2],i=this._p[3];return this._precomputed||this._precompute(),t===r&&n===i?e:0===e?0:1===e?1:s(this._getTForX(e),r,i)},_precompute:function(){var e=this._p[0],t=this._p[1],r=this._p[2],n=this._p[3];this._precomputed=!0,e===t&&r===n||this._calcSampleValues()},_calcSampleValues:function(){for(var e=this._p[0],t=this._p[2],r=0;r<11;++r)this._mSampleValues[r]=s(.1*r,e,t)},_getTForX:function(e){for(var t=this._p[0],r=this._p[2],n=this._mSampleValues,i=0,a=1;10!==a&&n[a]<=e;++a)i+=.1;var l=i+.1*((e-n[--a])/(n[a+1]-n[a])),c=o(l,t,r);return c>=.001?function(e,t,r,n){for(var i=0;i<4;++i){var a=o(t,r,n);if(0===a)return t;t-=(s(t,r,n)-e)/a}return t}(e,l,t,r):0===c?l:function(e,t,r,n,i){var a,o,l=0;do{(a=s(o=t+(r-t)/2,n,i)-e)>0?r=o:t=o}while(Math.abs(a)>1e-7&&++l<10);return o}(e,i,i+.1,t,r)}},e}();function M(e,t){var r,n,i=e.length;for(r=0;r<i;r+=1)for(var a in n=e[r].prototype)n.hasOwnProperty(a)&&(t.prototype[a]=n[a])}function N(e){function t(){}return t.prototype=e,t}!function(){for(var t=0,r=["ms","moz","webkit","o"],n=0;n<r.length&&!e.requestAnimationFrame;++n)e.requestAnimationFrame=e[r[n]+"RequestAnimationFrame"],e.cancelAnimationFrame=e[r[n]+"CancelAnimationFrame"]||e[r[n]+"CancelRequestAnimationFrame"];e.requestAnimationFrame||(e.requestAnimationFrame=function(e,r){var n=(new Date).getTime(),i=Math.max(0,16-(n-t)),a=setTimeout((function(){e(n+i)}),i);return t=n+i,a}),e.cancelAnimationFrame||(e.cancelAnimationFrame=function(e){clearTimeout(e)})}();var k=function(){function e(e,t,r,n,i,a){var s=e*n+t*i+r*a-i*n-a*e-r*t;return s>-.001&&s<.001}Math;var t=function(e,t,r,n){var s,o,l,u,h,f,d=c,p=0,m=[],g=[],T=de.newElement();for(l=r.length,s=0;s<d;s+=1){for(h=s/(d-1),f=0,o=0;o<l;o+=1)u=i(1-h,3)*e[o]+3*i(1-h,2)*h*r[o]+3*(1-h)*i(h,2)*n[o]+i(h,3)*t[o],m[o]=u,null!==g[o]&&(f+=i(m[o]-g[o],2)),g[o]=m[o];f&&(p+=f=a(f)),T.percents[s]=h,T.lengths[s]=p}return T.addedLength=p,T};function r(e){this.segmentLength=0,this.points=new Array(e)}function n(e,t){this.partialLength=e,this.point=t}var o,l=(o={},function(t){var s=t.s,l=t.e,u=t.to,h=t.ti,f=(s[0]+"_"+s[1]+"_"+l[0]+"_"+l[1]+"_"+u[0]+"_"+u[1]+"_"+h[0]+"_"+h[1]).replace(/\./g,"p");if(o[f])t.bezierData=o[f];else{var d,p,m,g,T,y,v,E=c,C=0,b=null;2===s.length&&(s[0]!=l[0]||s[1]!=l[1])&&e(s[0],s[1],l[0],l[1],s[0]+u[0],s[1]+u[1])&&e(s[0],s[1],l[0],l[1],l[0]+h[0],l[1]+h[1])&&(E=2);var S=new r(E);for(m=u.length,d=0;d<E;d+=1){for(v=P(m),T=d/(E-1),y=0,p=0;p<m;p+=1)g=i(1-T,3)*s[p]+3*i(1-T,2)*T*(s[p]+u[p])+3*(1-T)*i(T,2)*(l[p]+h[p])+i(T,3)*l[p],v[p]=g,null!==b&&(y+=i(v[p]-b[p],2));C+=y=a(y),S.points[d]=new n(y,v),b=v}S.segmentLength=C,t.bezierData=S,o[f]=S}});function u(e,t){var r=t.percents,n=t.lengths,i=r.length,a=s((i-1)*e),o=e*t.addedLength,l=0;if(a===i-1||0===a||o===n[a])return r[a];for(var c=n[a]>o?-1:1,u=!0;u;)if(n[a]<=o&&n[a+1]>o?(l=(o-n[a])/(n[a+1]-n[a]),u=!1):a+=c,a<0||a>=i-1){if(a===i-1)return r[a];u=!1}return r[a]+(r[a+1]-r[a])*l}var h=x("float32",8);return{getSegmentsLength:function(e){var r,n=fe.newElement(),i=e.c,a=e.v,s=e.o,o=e.i,l=e._length,c=n.lengths,u=0;for(r=0;r<l-1;r+=1)c[r]=t(a[r],a[r+1],s[r],o[r+1]),u+=c[r].addedLength;return i&&l&&(c[r]=t(a[r],a[0],s[r],o[0]),u+=c[r].addedLength),n.totalLength=u,n},getNewSegment:function(e,t,r,n,i,a,s){var o,l=u(i=i<0?0:i>1?1:i,s),c=u(a=a>1?1:a,s),f=e.length,d=1-l,p=1-c,m=d*d*d,g=l*d*d*3,T=l*l*d*3,y=l*l*l,v=d*d*p,E=l*d*p+d*l*p+d*d*c,C=l*l*p+d*l*c+l*d*c,b=l*l*c,S=d*p*p,I=l*p*p+d*c*p+d*p*c,x=l*c*p+d*c*c+l*p*c,P=l*c*c,w=p*p*p,D=c*p*p+p*c*p+p*p*c,_=c*c*p+p*c*c+c*p*c,A=c*c*c;for(o=0;o<f;o+=1)h[4*o]=Math.round(1e3*(m*e[o]+g*r[o]+T*n[o]+y*t[o]))/1e3,h[4*o+1]=Math.round(1e3*(v*e[o]+E*r[o]+C*n[o]+b*t[o]))/1e3,h[4*o+2]=Math.round(1e3*(S*e[o]+I*r[o]+x*n[o]+P*t[o]))/1e3,h[4*o+3]=Math.round(1e3*(w*e[o]+D*r[o]+_*n[o]+A*t[o]))/1e3;return h},getPointInSegment:function(e,t,r,n,i,a){var s=u(i,a),o=1-s;return[Math.round(1e3*(o*o*o*e[0]+(s*o*o+o*s*o+o*o*s)*r[0]+(s*s*o+o*s*s+s*o*s)*n[0]+s*s*s*t[0]))/1e3,Math.round(1e3*(o*o*o*e[1]+(s*o*o+o*s*o+o*o*s)*r[1]+(s*s*o+o*s*s+s*o*s)*n[1]+s*s*s*t[1]))/1e3]},buildBezierData:l,pointOnLine2D:e,pointOnLine3D:function(t,r,n,i,a,s,o,l,c){if(0===n&&0===s&&0===c)return e(t,r,i,a,o,l);var u,h=Math.sqrt(Math.pow(i-t,2)+Math.pow(a-r,2)+Math.pow(s-n,2)),f=Math.sqrt(Math.pow(o-t,2)+Math.pow(l-r,2)+Math.pow(c-n,2)),d=Math.sqrt(Math.pow(o-i,2)+Math.pow(l-a,2)+Math.pow(c-s,2));return(u=h>f?h>d?h-f-d:d-f-h:d>f?d-f-h:f-h-d)>-1e-4&&u<1e-4}}}();var O=function(){function e(e,t){for(var r=0,n=t.length;r<n;){if(t[r].id===e)return t[r].layers.__used?JSON.parse(JSON.stringify(t[r].layers)):(t[r].layers.__used=!0,t[r].layers);r+=1}}function t(e){var n,i,a;for(n=e.length-1;n>=0;n-=1)if("sh"==e[n].ty){if(e[n].ks.k.i)r(e[n].ks.k);else for(a=e[n].ks.k.length,i=0;i<a;i+=1)e[n].ks.k[i].s&&r(e[n].ks.k[i].s[0]),e[n].ks.k[i].e&&r(e[n].ks.k[i].e[0]);!0}else"gr"==e[n].ty&&t(e[n].it)}function r(e){var t,r=e.i.length;for(t=0;t<r;t+=1)e.i[t][0]+=e.v[t][0],e.i[t][1]+=e.v[t][1],e.o[t][0]+=e.v[t][0],e.o[t][1]+=e.v[t][1]}function n(e,t){var r=t?t.split("."):[100,100,100];return e[0]>r[0]||!(r[0]>e[0])&&(e[1]>r[1]||!(r[1]>e[1])&&(e[2]>r[2]||!(r[2]>e[2])&&void 0))}var i,a=function(){var e=[4,4,14];function t(e){var t,r,n,i=e.length;for(t=0;t<i;t+=1)5===e[t].ty&&(r=e[t],n=void 0,n=r.t.d,r.t.d={k:[{s:n,t:0}]})}return function(r){if(n(e,r.v)&&(t(r.layers),r.assets)){var i,a=r.assets.length;for(i=0;i<a;i+=1)r.assets[i].layers&&t(r.assets[i].layers)}}}(),s=(i=[4,7,99],function(e){if(e.chars&&!n(i,e.v)){var t,a,s,o,l,c=e.chars.length;for(t=0;t<c;t+=1)if(e.chars[t].data&&e.chars[t].data.shapes)for(s=(l=e.chars[t].data.shapes[0].it).length,a=0;a<s;a+=1)(o=l[a].ks.k).__converted||(r(l[a].ks.k),o.__converted=!0)}}),o=function(){var e=[4,1,9];function t(e){var r,n,i,a=e.length;for(r=0;r<a;r+=1)if("gr"===e[r].ty)t(e[r].it);else if("fl"===e[r].ty||"st"===e[r].ty)if(e[r].c.k&&e[r].c.k[0].i)for(i=e[r].c.k.length,n=0;n<i;n+=1)e[r].c.k[n].s&&(e[r].c.k[n].s[0]/=255,e[r].c.k[n].s[1]/=255,e[r].c.k[n].s[2]/=255,e[r].c.k[n].s[3]/=255),e[r].c.k[n].e&&(e[r].c.k[n].e[0]/=255,e[r].c.k[n].e[1]/=255,e[r].c.k[n].e[2]/=255,e[r].c.k[n].e[3]/=255);else e[r].c.k[0]/=255,e[r].c.k[1]/=255,e[r].c.k[2]/=255,e[r].c.k[3]/=255}function r(e){var r,n=e.length;for(r=0;r<n;r+=1)4===e[r].ty&&t(e[r].shapes)}return function(t){if(n(e,t.v)&&(r(t.layers),t.assets)){var i,a=t.assets.length;for(i=0;i<a;i+=1)t.assets[i].layers&&r(t.assets[i].layers)}}}(),l=function(){var e=[4,4,18];function t(e){var r,n,i;for(r=e.length-1;r>=0;r-=1)if("sh"==e[r].ty){if(e[r].ks.k.i)e[r].ks.k.c=e[r].closed;else for(i=e[r].ks.k.length,n=0;n<i;n+=1)e[r].ks.k[n].s&&(e[r].ks.k[n].s[0].c=e[r].closed),e[r].ks.k[n].e&&(e[r].ks.k[n].e[0].c=e[r].closed);!0}else"gr"==e[r].ty&&t(e[r].it)}function r(e){var r,n,i,a,s,o,l=e.length;for(n=0;n<l;n+=1){if((r=e[n]).hasMask){var c=r.masksProperties;for(a=c.length,i=0;i<a;i+=1)if(c[i].pt.k.i)c[i].pt.k.c=c[i].cl;else for(o=c[i].pt.k.length,s=0;s<o;s+=1)c[i].pt.k[s].s&&(c[i].pt.k[s].s[0].c=c[i].cl),c[i].pt.k[s].e&&(c[i].pt.k[s].e[0].c=c[i].cl)}4===r.ty&&t(r.shapes)}}return function(t){if(n(e,t.v)&&(r(t.layers),t.assets)){var i,a=t.assets.length;for(i=0;i<a;i+=1)t.assets[i].layers&&r(t.assets[i].layers)}}}();function c(e,t){0!==e.t.a.length||"m"in e.t.p||(e.singleShape=!0)}var u={completeData:function(n,i){n.__complete||(o(n),a(n),s(n),l(n),function n(i,a,s){var o,l,u,h,f,d,p=i.length;for(l=0;l<p;l+=1)if("ks"in(o=i[l])&&!o.completed){if(o.completed=!0,o.tt&&(i[l-1].td=o.tt),[],-1,o.hasMask){var m=o.masksProperties;for(h=m.length,u=0;u<h;u+=1)if(m[u].pt.k.i)r(m[u].pt.k);else for(d=m[u].pt.k.length,f=0;f<d;f+=1)m[u].pt.k[f].s&&r(m[u].pt.k[f].s[0]),m[u].pt.k[f].e&&r(m[u].pt.k[f].e[0])}0===o.ty?(o.layers=e(o.refId,a),n(o.layers,a,s)):4===o.ty?t(o.shapes):5==o.ty&&c(o,s)}}(n.layers,n.assets,i),n.__complete=!0)}};return u}(),L=function(){var t={w:0,size:0,shapes:[]},r=[];function n(e,t){var r=D("span");r.style.fontFamily=t;var n=D("span");n.innerHTML="giItT1WQy@!-/#",r.style.position="absolute",r.style.left="-10000px",r.style.top="-10000px",r.style.fontSize="300px",r.style.fontVariant="normal",r.style.fontStyle="normal",r.style.fontWeight="normal",r.style.letterSpacing="0",r.appendChild(n),document.body.appendChild(r);var i=n.offsetWidth;return n.style.fontFamily=e+", "+t,{node:n,w:i,parent:r}}function i(){var t,r,n,a=this.fonts.length,s=a;for(t=0;t<a;t+=1)if(this.fonts[t].loaded)s-=1;else if("t"===this.fonts[t].fOrigin||2===this.fonts[t].origin){if(e.Typekit&&e.Typekit.load&&0===this.typekitLoaded){this.typekitLoaded=1;try{e.Typekit.load({async:!0,active:function(){this.typekitLoaded=2}.bind(this)})}catch(e){}}2===this.typekitLoaded&&(this.fonts[t].loaded=!0)}else"n"===this.fonts[t].fOrigin||0===this.fonts[t].origin?this.fonts[t].loaded=!0:(r=this.fonts[t].monoCase.node,n=this.fonts[t].monoCase.w,r.offsetWidth!==n?(s-=1,this.fonts[t].loaded=!0):(r=this.fonts[t].sansCase.node,n=this.fonts[t].sansCase.w,r.offsetWidth!==n&&(s-=1,this.fonts[t].loaded=!0)),this.fonts[t].loaded&&(this.fonts[t].sansCase.parent.parentNode.removeChild(this.fonts[t].sansCase.parent),this.fonts[t].monoCase.parent.parentNode.removeChild(this.fonts[t].monoCase.parent)));0!==s&&Date.now()-this.initTime<5e3?setTimeout(i.bind(this),20):setTimeout(function(){this.loaded=!0}.bind(this),0)}function a(e,t){var r=w("text");return r.style.fontSize="100px",r.setAttribute("font-family",t.fFamily),r.setAttribute("font-style",t.fStyle),r.setAttribute("font-weight",t.fWeight),r.textContent="1",t.fClass?(r.style.fontFamily="inherit",r.className=t.fClass):r.style.fontFamily=t.fFamily,e.appendChild(r),D("canvas").getContext("2d").font=t.fWeight+" "+t.fStyle+" 100px "+t.fFamily,r}r=r.concat([2304,2305,2306,2307,2362,2363,2364,2364,2366,2367,2368,2369,2370,2371,2372,2373,2374,2375,2376,2377,2378,2379,2380,2381,2382,2383,2387,2388,2389,2390,2391,2402,2403]);var s=function(){this.fonts=[],this.chars=null,this.typekitLoaded=0,this.loaded=!1,this.initTime=Date.now()};return s.getCombinedCharacterCodes=function(){return r},s.prototype.addChars=function(e){if(e){this.chars||(this.chars=[]);var t,r,n,i=e.length,a=this.chars.length;for(t=0;t<i;t+=1){for(r=0,n=!1;r<a;)this.chars[r].style===e[t].style&&this.chars[r].fFamily===e[t].fFamily&&this.chars[r].ch===e[t].ch&&(n=!0),r+=1;n||(this.chars.push(e[t]),a+=1)}}},s.prototype.addFonts=function(e,t){if(e){if(this.chars)return this.loaded=!0,void(this.fonts=e.list);var r,s=e.list,o=s.length;for(r=0;r<o;r+=1){if(s[r].loaded=!1,s[r].monoCase=n(s[r].fFamily,"monospace"),s[r].sansCase=n(s[r].fFamily,"sans-serif"),s[r].fPath){if("p"===s[r].fOrigin||3===s[r].origin){var l=D("style");l.type="text/css",l.innerHTML="@font-face {font-family: "+s[r].fFamily+"; font-style: normal; src: url('"+s[r].fPath+"');}",t.appendChild(l)}else if("g"===s[r].fOrigin||1===s[r].origin){var c=D("link");c.type="text/css",c.rel="stylesheet",c.href=s[r].fPath,document.body.appendChild(c)}else if("t"===s[r].fOrigin||2===s[r].origin){var u=D("script");u.setAttribute("src",s[r].fPath),t.appendChild(u)}}else s[r].loaded=!0;s[r].helper=a(t,s[r]),s[r].cache={},this.fonts.push(s[r])}setTimeout(function(){i.bind(this)()}.bind(this),100)}else this.loaded=!0},s.prototype.getCharData=function(e,r,n){for(var i=0,a=this.chars.length;i<a;){if(this.chars[i].ch===e&&this.chars[i].style===r&&this.chars[i].fFamily===n)return this.chars[i];i+=1}return console&&console.warn&&console.warn("Missing character from exported characters list: ",e,r,n),t},s.prototype.getFontByName=function(e){for(var t=0,r=this.fonts.length;t<r;){if(this.fonts[t].fName===e)return this.fonts[t];t+=1}return this.fonts[0]},s.prototype.measureText=function(e,t,r){var n=this.getFontByName(t),i=e.charCodeAt(0);if(!n.cache[i+1]){var a=n.helper;a.textContent=e,n.cache[i+1]=a.getComputedTextLength()/100}return n.cache[i+1]*r},s}(),F=function(){var e=Math.abs;function t(e,t){var n,i=this.offsetTime;"multidimensional"===this.propType&&(n=x("float32",this.pv.length));for(var a,s,o,l,c,h,f,d,p=t.lastIndex,m=p,g=this.keyframes.length-1,T=!0;T;){if(a=this.keyframes[m],s=this.keyframes[m+1],m==g-1&&e>=s.t-i){a.h&&(a=s),p=0;break}if(s.t-i>e){p=m;break}m<g-1?m+=1:(p=0,T=!1)}if(a.to){a.bezierData||k.buildBezierData(a);var y=a.bezierData;if(e>=s.t-i||e<a.t-i){var v=e>=s.t-i?y.points.length-1:0;for(l=y.points[v].point.length,o=0;o<l;o+=1)n[o]=y.points[v].point[o];t._lastBezierData=null}else{a.__fnct?d=a.__fnct:(d=R.getBezierEasing(a.o.x,a.o.y,a.i.x,a.i.y,a.n).get,a.__fnct=d),c=d((e-(a.t-i))/(s.t-i-(a.t-i)));var E,C=y.segmentLength*c,b=t.lastFrame<e&&t._lastBezierData===y?t._lastAddedLength:0;for(f=t.lastFrame<e&&t._lastBezierData===y?t._lastPoint:0,T=!0,h=y.points.length;T;){if(b+=y.points[f].partialLength,0===C||0===c||f==y.points.length-1){for(l=y.points[f].point.length,o=0;o<l;o+=1)n[o]=y.points[f].point[o];break}if(C>=b&&C<b+y.points[f+1].partialLength){for(E=(C-b)/y.points[f+1].partialLength,l=y.points[f].point.length,o=0;o<l;o+=1)n[o]=y.points[f].point[o]+(y.points[f+1].point[o]-y.points[f].point[o])*E;break}f<h-1?f+=1:T=!1}t._lastPoint=f,t._lastAddedLength=b-y.points[f].partialLength,t._lastBezierData=y}}else{var S,I,P,w,D;if(g=a.s.length,this.sh&&1!==a.h)if(e>=s.t-i)n[0]=a.e[0],n[1]=a.e[1],n[2]=a.e[2];else if(e<=a.t-i)n[0]=a.s[0],n[1]=a.s[1],n[2]=a.s[2];else{!function(e,t){var r=t[0],n=t[1],i=t[2],a=t[3],s=Math.atan2(2*n*a-2*r*i,1-2*n*n-2*i*i),o=Math.asin(2*r*n+2*i*a),l=Math.atan2(2*r*a-2*n*i,1-2*r*r-2*i*i);e[0]=s/u,e[1]=o/u,e[2]=l/u}(n,function(e,t,r){var n,i,a,s,o,l=[],c=e[0],u=e[1],h=e[2],f=e[3],d=t[0],p=t[1],m=t[2],g=t[3];(i=c*d+u*p+h*m+f*g)<0&&(i=-i,d=-d,p=-p,m=-m,g=-g);1-i>1e-6?(n=Math.acos(i),a=Math.sin(n),s=Math.sin((1-r)*n)/a,o=Math.sin(r*n)/a):(s=1-r,o=r);return l[0]=s*c+o*d,l[1]=s*u+o*p,l[2]=s*h+o*m,l[3]=s*f+o*g,l}(r(a.s),r(a.e),(e-(a.t-i))/(s.t-i-(a.t-i))))}else for(m=0;m<g;m+=1)1!==a.h&&(e>=s.t-i?c=1:e<a.t-i?c=0:(a.o.x.constructor===Array?(a.__fnct||(a.__fnct=[]),a.__fnct[m]?d=a.__fnct[m]:(S=a.o.x[m]||a.o.x[0],I=a.o.y[m]||a.o.y[0],P=a.i.x[m]||a.i.x[0],w=a.i.y[m]||a.i.y[0],d=R.getBezierEasing(S,I,P,w).get,a.__fnct[m]=d)):a.__fnct?d=a.__fnct:(S=a.o.x,I=a.o.y,P=a.i.x,w=a.i.y,d=R.getBezierEasing(S,I,P,w).get,a.__fnct=d),c=d((e-(a.t-i))/(s.t-i-(a.t-i))))),D=1===a.h?a.s[m]:a.s[m]+(a.e[m]-a.s[m])*c,1===g?n=D:n[m]=D}return t.lastIndex=p,n}function r(e){var t=e[0]*u,r=e[1]*u,n=e[2]*u,i=Math.cos(t/2),a=Math.cos(r/2),s=Math.cos(n/2),o=Math.sin(t/2),l=Math.sin(r/2),c=Math.sin(n/2);return[o*l*s+i*a*c,o*a*s+i*l*c,i*l*s-o*a*c,i*a*s-o*l*c]}function n(){var e=this.comp.renderedFrame-this.offsetTime,t=this.keyframes[0].t-this.offsetTime,r=this.keyframes[this.keyframes.length-1].t-this.offsetTime;if(!(e===this._caching.lastFrame||-999999!==this._caching.lastFrame&&(this._caching.lastFrame>=r&&e>=r||this._caching.lastFrame<t&&e<t))){this._caching.lastIndex=this._caching.lastFrame<e?this._caching.lastIndex:0;var n=this.interpolateValue(e,this._caching);this.pv=n}return this._caching.lastFrame=e,this.pv}function i(t){var r;if("unidimensional"===this.propType)r=t*this.mult,e(this.v-r)>1e-5&&(this.v=r,this._mdf=!0);else for(var n=0,i=this.v.length;n<i;)r=t[n]*this.mult,e(this.v[n]-r)>1e-5&&(this.v[n]=r,this._mdf=!0),n+=1}function a(){if(this.elem.globalData.frameId!==this.frameId&&this.effectsSequence.length)if(this.lock)this.setVValue(this.pv);else{this.lock=!0,this._mdf=this._isFirstFrame;var e,t=this.effectsSequence.length,r=this.kf?this.pv:this.data.k;for(e=0;e<t;e+=1)r=this.effectsSequence[e](r);this.setVValue(r),this._isFirstFrame=!1,this.lock=!1,this.frameId=this.elem.globalData.frameId}}function s(e){this.effectsSequence.push(e),this.container.addDynamicProperty(this)}function o(e,t,r,n){this.propType="unidimensional",this.mult=r||1,this.data=t,this.v=r?t.k*r:t.k,this.pv=t.k,this._mdf=!1,this.elem=e,this.container=n,this.comp=e.comp,this.k=!1,this.kf=!1,this.vel=0,this.effectsSequence=[],this._isFirstFrame=!0,this.getValue=a,this.setVValue=i,this.addEffect=s}function l(e,t,r,n){this.propType="multidimensional",this.mult=r||1,this.data=t,this._mdf=!1,this.elem=e,this.container=n,this.comp=e.comp,this.k=!1,this.kf=!1,this.frameId=-1;var o,l=t.k.length;this.v=x("float32",l),this.pv=x("float32",l);x("float32",l);for(this.vel=x("float32",l),o=0;o<l;o+=1)this.v[o]=t.k[o]*this.mult,this.pv[o]=t.k[o];this._isFirstFrame=!0,this.effectsSequence=[],this.getValue=a,this.setVValue=i,this.addEffect=s}function c(e,r,o,l){this.propType="unidimensional",this.keyframes=r.k,this.offsetTime=e.data.st,this.frameId=-1,this._caching={lastFrame:-999999,lastIndex:0,value:0},this.k=!0,this.kf=!0,this.data=r,this.mult=o||1,this.elem=e,this.container=l,this.comp=e.comp,this.v=-999999,this.pv=-999999,this._isFirstFrame=!0,this.getValue=a,this.setVValue=i,this.interpolateValue=t,this.effectsSequence=[n.bind(this)],this.addEffect=s}function h(e,r,o,l){this.propType="multidimensional";var c,u,h,f,d,p=r.k.length;for(c=0;c<p-1;c+=1)r.k[c].to&&r.k[c].s&&r.k[c].e&&(u=r.k[c].s,h=r.k[c].e,f=r.k[c].to,d=r.k[c].ti,(2===u.length&&(u[0]!==h[0]||u[1]!==h[1])&&k.pointOnLine2D(u[0],u[1],h[0],h[1],u[0]+f[0],u[1]+f[1])&&k.pointOnLine2D(u[0],u[1],h[0],h[1],h[0]+d[0],h[1]+d[1])||3===u.length&&(u[0]!==h[0]||u[1]!==h[1]||u[2]!==h[2])&&k.pointOnLine3D(u[0],u[1],u[2],h[0],h[1],h[2],u[0]+f[0],u[1]+f[1],u[2]+f[2])&&k.pointOnLine3D(u[0],u[1],u[2],h[0],h[1],h[2],h[0]+d[0],h[1]+d[1],h[2]+d[2]))&&(r.k[c].to=null,r.k[c].ti=null),u[0]===h[0]&&u[1]===h[1]&&0===f[0]&&0===f[1]&&0===d[0]&&0===d[1]&&(2===u.length||u[2]===h[2]&&0===f[2]&&0===d[2])&&(r.k[c].to=null,r.k[c].ti=null));this.effectsSequence=[n.bind(this)],this.keyframes=r.k,this.offsetTime=e.data.st,this.k=!0,this.kf=!0,this._isFirstFrame=!0,this.mult=o||1,this.elem=e,this.container=l,this.comp=e.comp,this.getValue=a,this.setVValue=i,this.interpolateValue=t,this.frameId=-1;var m=r.k[0].s.length;for(this.v=x("float32",m),this.pv=x("float32",m),c=0;c<m;c+=1)this.v[c]=-999999,this.pv[c]=-999999;this._caching={lastFrame:-999999,lastIndex:0,value:x("float32",m)},this.addEffect=s}return{getProp:function(e,t,r,n,i){var a;if(0===t.a)a=0===r?new o(e,t,n,i):new l(e,t,n,i);else if(1===t.a)a=0===r?new c(e,t,n,i):new h(e,t,n,i);else if(t.k.length)if("number"==typeof t.k[0])a=new l(e,t,n,i);else switch(r){case 0:a=new c(e,t,n,i);break;case 1:a=new h(e,t,n,i)}else a=new o(e,t,n,i);return a.effectsSequence.length&&i.addDynamicProperty(a),a}}}(),B=function(){function e(e,t,r){if(this.elem=e,this.frameId=-1,this.propType="transform",this.data=t,this.v=new A,this.pre=new A,this.appliedTransformations=0,this.initDynamicPropertyContainer(r||e),t.p.s?(this.px=F.getProp(e,t.p.x,0,0,this),this.py=F.getProp(e,t.p.y,0,0,this),t.p.z&&(this.pz=F.getProp(e,t.p.z,0,0,this))):this.p=F.getProp(e,t.p,1,0,this),t.r)this.r=F.getProp(e,t.r,0,u,this);else if(t.rx){if(this.rx=F.getProp(e,t.rx,0,u,this),this.ry=F.getProp(e,t.ry,0,u,this),this.rz=F.getProp(e,t.rz,0,u,this),t.or.k[0].ti){var n,i=t.or.k.length;for(n=0;n<i;n+=1)t.or.k[n].to=t.or.k[n].ti=null}this.or=F.getProp(e,t.or,1,u,this),this.or.sh=!0}t.sk&&(this.sk=F.getProp(e,t.sk,0,u,this),this.sa=F.getProp(e,t.sa,0,u,this)),t.a&&(this.a=F.getProp(e,t.a,1,0,this)),t.s&&(this.s=F.getProp(e,t.s,1,.01,this)),t.o?this.o=F.getProp(e,t.o,0,.01,e):this.o={_mdf:!1,v:1},this._isDirty=!0,this.dynamicProperties.length||this.getValue(!0)}return e.prototype={applyToMatrix:function(e){var t=this._mdf;this.iterateDynamicProperties(),this._mdf=this._mdf||t,this.a&&e.translate(-this.a.v[0],-this.a.v[1],this.a.v[2]),this.s&&e.scale(this.s.v[0],this.s.v[1],this.s.v[2]),this.sk&&e.skewFromAxis(-this.sk.v,this.sa.v),this.r?e.rotate(-this.r.v):e.rotateZ(-this.rz.v).rotateY(this.ry.v).rotateX(this.rx.v).rotateZ(-this.or.v[2]).rotateY(this.or.v[1]).rotateX(this.or.v[0]),this.data.p.s?this.data.p.z?e.translate(this.px.v,this.py.v,-this.pz.v):e.translate(this.px.v,this.py.v,0):e.translate(this.p.v[0],this.p.v[1],-this.p.v[2])},getValue:function(e){if(this.elem.globalData.frameId!==this.frameId){if(this._isDirty&&(this.precalculateMatrix(),this._isDirty=!1),this.iterateDynamicProperties(),this._mdf||e){if(this.v.cloneFromProps(this.pre.props),this.appliedTransformations<1&&this.v.translate(-this.a.v[0],-this.a.v[1],this.a.v[2]),this.appliedTransformations<2&&this.v.scale(this.s.v[0],this.s.v[1],this.s.v[2]),this.sk&&this.appliedTransformations<3&&this.v.skewFromAxis(-this.sk.v,this.sa.v),this.r&&this.appliedTransformations<4?this.v.rotate(-this.r.v):!this.r&&this.appliedTransformations<4&&this.v.rotateZ(-this.rz.v).rotateY(this.ry.v).rotateX(this.rx.v).rotateZ(-this.or.v[2]).rotateY(this.or.v[1]).rotateX(this.or.v[0]),this.autoOriented){var t,r,n=this.elem.globalData.frameRate;if(this.p&&this.p.keyframes&&this.p.getValueAtTime)this.p._caching.lastFrame+this.p.offsetTime<=this.p.keyframes[0].t?(t=this.p.getValueAtTime((this.p.keyframes[0].t+.01)/n,0),r=this.p.getValueAtTime(this.p.keyframes[0].t/n,0)):this.p._caching.lastFrame+this.p.offsetTime>=this.p.keyframes[this.p.keyframes.length-1].t?(t=this.p.getValueAtTime(this.p.keyframes[this.p.keyframes.length-1].t/n,0),r=this.p.getValueAtTime((this.p.keyframes[this.p.keyframes.length-1].t-.01)/n,0)):(t=this.p.pv,r=this.p.getValueAtTime((this.p._caching.lastFrame+this.p.offsetTime-.01)/n,this.p.offsetTime));else if(this.px&&this.px.keyframes&&this.py.keyframes&&this.px.getValueAtTime&&this.py.getValueAtTime){t=[],r=[];var i=this.px,a=this.py;i._caching.lastFrame+i.offsetTime<=i.keyframes[0].t?(t[0]=i.getValueAtTime((i.keyframes[0].t+.01)/n,0),t[1]=a.getValueAtTime((a.keyframes[0].t+.01)/n,0),r[0]=i.getValueAtTime(i.keyframes[0].t/n,0),r[1]=a.getValueAtTime(a.keyframes[0].t/n,0)):i._caching.lastFrame+i.offsetTime>=i.keyframes[i.keyframes.length-1].t?(t[0]=i.getValueAtTime(i.keyframes[i.keyframes.length-1].t/n,0),t[1]=a.getValueAtTime(a.keyframes[a.keyframes.length-1].t/n,0),r[0]=i.getValueAtTime((i.keyframes[i.keyframes.length-1].t-.01)/n,0),r[1]=a.getValueAtTime((a.keyframes[a.keyframes.length-1].t-.01)/n,0)):(t=[i.pv,a.pv],r[0]=i.getValueAtTime((i._caching.lastFrame+i.offsetTime-.01)/n,i.offsetTime),r[1]=a.getValueAtTime((a._caching.lastFrame+a.offsetTime-.01)/n,a.offsetTime))}this.v.rotate(-Math.atan2(t[1]-r[1],t[0]-r[0]))}this.data.p.s?this.data.p.z?this.v.translate(this.px.v,this.py.v,-this.pz.v):this.v.translate(this.px.v,this.py.v,0):this.v.translate(this.p.v[0],this.p.v[1],-this.p.v[2])}this.frameId=this.elem.globalData.frameId}},precalculateMatrix:function(){if(!this.a.k&&(this.pre.translate(-this.a.v[0],-this.a.v[1],this.a.v[2]),this.appliedTransformations=1,!this.s.effectsSequence.length)){if(this.pre.scale(this.s.v[0],this.s.v[1],this.s.v[2]),this.appliedTransformations=2,this.sk){if(this.sk.effectsSequence.length||this.sa.effectsSequence.length)return;this.pre.skewFromAxis(-this.sk.v,this.sa.v),this.appliedTransformations=3}if(this.r){if(this.r.effectsSequence.length)return;this.pre.rotate(-this.r.v),this.appliedTransformations=4}else this.rz.effectsSequence.length||this.ry.effectsSequence.length||this.rx.effectsSequence.length||this.or.effectsSequence.length||(this.pre.rotateZ(-this.rz.v).rotateY(this.ry.v).rotateX(this.rx.v).rotateZ(-this.or.v[2]).rotateY(this.or.v[1]).rotateX(this.or.v[0]),this.appliedTransformations=4)}},autoOrient:function(){}},M([_],e),e.prototype.addDynamicProperty=function(e){this._addDynamicProperty(e),this.elem.addDynamicProperty(e),this._isDirty=!0},e.prototype._addDynamicProperty=_.prototype.addDynamicProperty,{getTransformProperty:function(t,r,n){return new e(t,r,n)}}}();function V(){this.c=!1,this._length=0,this._maxLength=8,this.v=P(this._maxLength),this.o=P(this._maxLength),this.i=P(this._maxLength)}V.prototype.setPathData=function(e,t){this.c=e,this.setLength(t);for(var r=0;r<t;)this.v[r]=ce.newElement(),this.o[r]=ce.newElement(),this.i[r]=ce.newElement(),r+=1},V.prototype.setLength=function(e){for(;this._maxLength<e;)this.doubleArrayLength();this._length=e},V.prototype.doubleArrayLength=function(){this.v=this.v.concat(P(this._maxLength)),this.i=this.i.concat(P(this._maxLength)),this.o=this.o.concat(P(this._maxLength)),this._maxLength*=2},V.prototype.setXYAt=function(e,t,r,n,i){var a;switch(this._length=Math.max(this._length,n+1),this._length>=this._maxLength&&this.doubleArrayLength(),r){case"v":a=this.v;break;case"i":a=this.i;break;case"o":a=this.o}(!a[n]||a[n]&&!i)&&(a[n]=ce.newElement()),a[n][0]=e,a[n][1]=t},V.prototype.setTripleAt=function(e,t,r,n,i,a,s,o){this.setXYAt(e,t,"v",s,o),this.setXYAt(r,n,"o",s,o),this.setXYAt(i,a,"i",s,o)},V.prototype.reverse=function(){var e=new V;e.setPathData(this.c,this._length);var t=this.v,r=this.o,n=this.i,i=0;this.c&&(e.setTripleAt(t[0][0],t[0][1],n[0][0],n[0][1],r[0][0],r[0][1],0,!1),i=1);var a,s=this._length-1,o=this._length;for(a=i;a<o;a+=1)e.setTripleAt(t[s][0],t[s][1],n[s][0],n[s][1],r[s][0],r[s][1],a,!1),s-=1;return e};var U=function(){function e(e,t,r){var n,i,a,s,o,l,c,u,h,f=r.lastIndex,d=this.keyframes;if(e<d[0].t-this.offsetTime)n=d[0].s[0],a=!0,f=0;else if(e>=d[d.length-1].t-this.offsetTime)n=1===d[d.length-2].h?d[d.length-1].s[0]:d[d.length-2].e[0],a=!0;else{for(var p,m,g=f,T=d.length-1,y=!0;y&&(p=d[g],!((m=d[g+1]).t-this.offsetTime>e));)g<T-1?g+=1:y=!1;if(f=g,!(a=1===p.h)){if(e>=m.t-this.offsetTime)u=1;else if(e<p.t-this.offsetTime)u=0;else{var v;p.__fnct?v=p.__fnct:(v=R.getBezierEasing(p.o.x,p.o.y,p.i.x,p.i.y).get,p.__fnct=v),u=v((e-(p.t-this.offsetTime))/(m.t-this.offsetTime-(p.t-this.offsetTime)))}i=p.e[0]}n=p.s[0]}for(l=t._length,c=n.i[0].length,r.lastIndex=f,s=0;s<l;s+=1)for(o=0;o<c;o+=1)h=a?n.i[s][o]:n.i[s][o]+(i.i[s][o]-n.i[s][o])*u,t.i[s][o]=h,h=a?n.o[s][o]:n.o[s][o]+(i.o[s][o]-n.o[s][o])*u,t.o[s][o]=h,h=a?n.v[s][o]:n.v[s][o]+(i.v[s][o]-n.v[s][o])*u,t.v[s][o]=h}function t(){var e=this.comp.renderedFrame-this.offsetTime,t=this.keyframes[0].t-this.offsetTime,r=this.keyframes[this.keyframes.length-1].t-this.offsetTime,n=this._caching.lastFrame;return-999999!==n&&(n<t&&e<t||n>r&&e>r)||(this._caching.lastIndex=n<e?this._caching.lastIndex:0,this.interpolateShape(e,this.pv,this._caching)),this._caching.lastFrame=e,this.pv}function r(){this.paths=this.localShapeCollection}function n(){if(!this.lock&&this.elem.globalData.frameId!==this.frameId){this.lock=!0,this.frameId=this.elem.globalData.frameId,this._mdf=!1;var e,t=this.kf?this.pv:this.data.ks?this.data.ks.k:this.data.pt.k,r=this.effectsSequence.length;for(e=0;e<r;e+=1)t=this.effectsSequence[e](t);(function(e,t){if(e._length!==t._length||e.c!==t.c)return!1;var r,n=e._length;for(r=0;r<n;r+=1)if(e.v[r][0]!==t.v[r][0]||e.v[r][1]!==t.v[r][1]||e.o[r][0]!==t.o[r][0]||e.o[r][1]!==t.o[r][1]||e.i[r][0]!==t.i[r][0]||e.i[r][1]!==t.i[r][1])return!1;return!0})(this.v,t)||(this.v=ue.clone(t),this.localShapeCollection.releaseShapes(),this.localShapeCollection.addShape(this.v),this._mdf=!0,this.paths=this.localShapeCollection),this.lock=!1}}function i(e,t,n){this.propType="shape",this.comp=e.comp,this.container=e,this.elem=e,this.data=t,this.k=!1,this.kf=!1,this._mdf=!1;var i=3===n?t.pt.k:t.ks.k;this.v=ue.clone(i),this.pv=ue.clone(this.v),this.localShapeCollection=he.newShapeCollection(),this.paths=this.localShapeCollection,this.paths.addShape(this.v),this.reset=r,this.effectsSequence=[]}function a(e){this.effectsSequence.push(e),this.container.addDynamicProperty(this)}function s(e,n,i){this.propType="shape",this.comp=e.comp,this.elem=e,this.container=e,this.offsetTime=e.data.st,this.keyframes=3===i?n.pt.k:n.ks.k,this.k=!0,this.kf=!0;var a=this.keyframes[0].s[0].i.length;this.keyframes[0].s[0].i[0].length;this.v=ue.newElement(),this.v.setPathData(this.keyframes[0].s[0].c,a),this.pv=ue.clone(this.v),this.localShapeCollection=he.newShapeCollection(),this.paths=this.localShapeCollection,this.paths.addShape(this.v),this.lastFrame=-999999,this.reset=r,this._caching={lastFrame:-999999,lastIndex:0},this.effectsSequence=[t.bind(this)]}i.prototype.interpolateShape=e,i.prototype.getValue=n,i.prototype.getValue=n,i.prototype.addEffect=a,s.prototype.getValue=n,s.prototype.interpolateShape=e,s.prototype.addEffect=a;var l=function(){function e(e,t){this.v=ue.newElement(),this.v.setPathData(!0,4),this.localShapeCollection=he.newShapeCollection(),this.paths=this.localShapeCollection,this.localShapeCollection.addShape(this.v),this.d=t.d,this.elem=e,this.comp=e.comp,this.frameId=-1,this.initDynamicPropertyContainer(e),this.p=F.getProp(e,t.p,1,0,this),this.s=F.getProp(e,t.s,1,0,this),this.dynamicProperties.length?this.k=!0:(this.k=!1,this.convertEllToPath())}return e.prototype={reset:r,getValue:function(){this.elem.globalData.frameId!==this.frameId&&(this.frameId=this.elem.globalData.frameId,this.iterateDynamicProperties(),this._mdf&&this.convertEllToPath())},convertEllToPath:function(){var e=this.p.v[0],t=this.p.v[1],r=this.s.v[0]/2,n=this.s.v[1]/2,i=3!==this.d,a=this.v;a.v[0][0]=e,a.v[0][1]=t-n,a.v[1][0]=i?e+r:e-r,a.v[1][1]=t,a.v[2][0]=e,a.v[2][1]=t+n,a.v[3][0]=i?e-r:e+r,a.v[3][1]=t,a.i[0][0]=i?e-.5519*r:e+.5519*r,a.i[0][1]=t-n,a.i[1][0]=i?e+r:e-r,a.i[1][1]=t-.5519*n,a.i[2][0]=i?e+.5519*r:e-.5519*r,a.i[2][1]=t+n,a.i[3][0]=i?e-r:e+r,a.i[3][1]=t+.5519*n,a.o[0][0]=i?e+.5519*r:e-.5519*r,a.o[0][1]=t-n,a.o[1][0]=i?e+r:e-r,a.o[1][1]=t+.5519*n,a.o[2][0]=i?e-.5519*r:e+.5519*r,a.o[2][1]=t+n,a.o[3][0]=i?e-r:e+r,a.o[3][1]=t-.5519*n}},M([_],e),e}(),c=function(){function e(e,t){this.v=ue.newElement(),this.v.setPathData(!0,0),this.elem=e,this.comp=e.comp,this.data=t,this.frameId=-1,this.d=t.d,this.initDynamicPropertyContainer(e),1===t.sy?(this.ir=F.getProp(e,t.ir,0,0,this),this.is=F.getProp(e,t.is,0,.01,this),this.convertToPath=this.convertStarToPath):this.convertToPath=this.convertPolygonToPath,this.pt=F.getProp(e,t.pt,0,0,this),this.p=F.getProp(e,t.p,1,0,this),this.r=F.getProp(e,t.r,0,u,this),this.or=F.getProp(e,t.or,0,0,this),this.os=F.getProp(e,t.os,0,.01,this),this.localShapeCollection=he.newShapeCollection(),this.localShapeCollection.addShape(this.v),this.paths=this.localShapeCollection,this.dynamicProperties.length?this.k=!0:(this.k=!1,this.convertToPath())}return e.prototype={reset:r,getValue:function(){this.elem.globalData.frameId!==this.frameId&&(this.frameId=this.elem.globalData.frameId,this.iterateDynamicProperties(),this._mdf&&this.convertToPath())},convertStarToPath:function(){var e,t,r,n,i=2*Math.floor(this.pt.v),a=2*Math.PI/i,s=!0,o=this.or.v,l=this.ir.v,c=this.os.v,u=this.is.v,h=2*Math.PI*o/(2*i),f=2*Math.PI*l/(2*i),d=-Math.PI/2;d+=this.r.v;var p=3===this.data.d?-1:1;for(this.v._length=0,e=0;e<i;e+=1){r=s?c:u,n=s?h:f;var m=(t=s?o:l)*Math.cos(d),g=t*Math.sin(d),T=0===m&&0===g?0:g/Math.sqrt(m*m+g*g),y=0===m&&0===g?0:-m/Math.sqrt(m*m+g*g);m+=+this.p.v[0],g+=+this.p.v[1],this.v.setTripleAt(m,g,m-T*n*r*p,g-y*n*r*p,m+T*n*r*p,g+y*n*r*p,e,!0),s=!s,d+=a*p}},convertPolygonToPath:function(){var e,t=Math.floor(this.pt.v),r=2*Math.PI/t,n=this.or.v,i=this.os.v,a=2*Math.PI*n/(4*t),s=-Math.PI/2,o=3===this.data.d?-1:1;for(s+=this.r.v,this.v._length=0,e=0;e<t;e+=1){var l=n*Math.cos(s),c=n*Math.sin(s),u=0===l&&0===c?0:c/Math.sqrt(l*l+c*c),h=0===l&&0===c?0:-l/Math.sqrt(l*l+c*c);l+=+this.p.v[0],c+=+this.p.v[1],this.v.setTripleAt(l,c,l-u*a*i*o,c-h*a*i*o,l+u*a*i*o,c+h*a*i*o,e,!0),s+=r*o}this.paths.length=0,this.paths[0]=this.v}},M([_],e),e}(),h=function(){function e(e,t){this.v=ue.newElement(),this.v.c=!0,this.localShapeCollection=he.newShapeCollection(),this.localShapeCollection.addShape(this.v),this.paths=this.localShapeCollection,this.elem=e,this.comp=e.comp,this.frameId=-1,this.d=t.d,this.initDynamicPropertyContainer(e),this.p=F.getProp(e,t.p,1,0,this),this.s=F.getProp(e,t.s,1,0,this),this.r=F.getProp(e,t.r,0,0,this),this.dynamicProperties.length?this.k=!0:(this.k=!1,this.convertRectToPath())}return e.prototype={convertRectToPath:function(){var e=this.p.v[0],t=this.p.v[1],r=this.s.v[0]/2,n=this.s.v[1]/2,i=o(r,n,this.r.v),a=i*(1-.5519);this.v._length=0,2===this.d||1===this.d?(this.v.setTripleAt(e+r,t-n+i,e+r,t-n+i,e+r,t-n+a,0,!0),this.v.setTripleAt(e+r,t+n-i,e+r,t+n-a,e+r,t+n-i,1,!0),0!==i?(this.v.setTripleAt(e+r-i,t+n,e+r-i,t+n,e+r-a,t+n,2,!0),this.v.setTripleAt(e-r+i,t+n,e-r+a,t+n,e-r+i,t+n,3,!0),this.v.setTripleAt(e-r,t+n-i,e-r,t+n-i,e-r,t+n-a,4,!0),this.v.setTripleAt(e-r,t-n+i,e-r,t-n+a,e-r,t-n+i,5,!0),this.v.setTripleAt(e-r+i,t-n,e-r+i,t-n,e-r+a,t-n,6,!0),this.v.setTripleAt(e+r-i,t-n,e+r-a,t-n,e+r-i,t-n,7,!0)):(this.v.setTripleAt(e-r,t+n,e-r+a,t+n,e-r,t+n,2),this.v.setTripleAt(e-r,t-n,e-r,t-n+a,e-r,t-n,3))):(this.v.setTripleAt(e+r,t-n+i,e+r,t-n+a,e+r,t-n+i,0,!0),0!==i?(this.v.setTripleAt(e+r-i,t-n,e+r-i,t-n,e+r-a,t-n,1,!0),this.v.setTripleAt(e-r+i,t-n,e-r+a,t-n,e-r+i,t-n,2,!0),this.v.setTripleAt(e-r,t-n+i,e-r,t-n+i,e-r,t-n+a,3,!0),this.v.setTripleAt(e-r,t+n-i,e-r,t+n-a,e-r,t+n-i,4,!0),this.v.setTripleAt(e-r+i,t+n,e-r+i,t+n,e-r+a,t+n,5,!0),this.v.setTripleAt(e+r-i,t+n,e+r-a,t+n,e+r-i,t+n,6,!0),this.v.setTripleAt(e+r,t+n-i,e+r,t+n-i,e+r,t+n-a,7,!0)):(this.v.setTripleAt(e-r,t-n,e-r+a,t-n,e-r,t-n,1,!0),this.v.setTripleAt(e-r,t+n,e-r,t+n-a,e-r,t+n,2,!0),this.v.setTripleAt(e+r,t+n,e+r-a,t+n,e+r,t+n,3,!0)))},getValue:function(e){this.elem.globalData.frameId!==this.frameId&&(this.frameId=this.elem.globalData.frameId,this.iterateDynamicProperties(),this._mdf&&this.convertRectToPath())},reset:r},M([_],e),e}();var f={getShapeProp:function(e,t,r){var n;if(3===r||4===r){var a=3===r?t.pt:t.ks,o=a.k;n=1===a.a||o.length?new s(e,t,r):new i(e,t,r)}else 5===r?n=new h(e,t):6===r?n=new l(e,t):7===r&&(n=new c(e,t));return n.k&&e.addDynamicProperty(n),n},getConstructorFunction:function(){return i},getKeyframedConstructorFunction:function(){return s}};return f}(),H=(z={},j={},z.registerModifier=function(e,t){j[e]||(j[e]=t)},z.getModifier=function(e,t,r){return new j[e](t,r)},z);var z,j;function q(){}function G(){}function W(){}function Y(){}function K(){this._length=0,this._maxLength=4,this.shapes=P(this._maxLength)}function Q(e,t,r,n){this.elem=e,this.frameId=-1,this.dataProps=P(t.length),this.renderer=r,this.k=!1,this.dashStr="",this.dashArray=x("float32",t.length?t.length-1:0),this.dashoffset=x("float32",1),this.initDynamicPropertyContainer(n);var i,a,s=t.length||0;for(i=0;i<s;i+=1)a=F.getProp(e,t[i].v,0,0,this),this.k=a.k||this.k,this.dataProps[i]={n:t[i].n,p:a};this.k||this.getValue(!0),this._isAnimated=this.k}function X(e,t){this.data=t,this.c=x("uint8c",4*t.p);var r=t.k.k[0].s?t.k.k[0].s.length-4*t.p:t.k.k.length-4*t.p;this.o=x("float32",r),this._cmdf=!1,this._omdf=!1,this._collapsable=this.checkCollapsable(),this._hasOpacity=r,this.initDynamicPropertyContainer(e),this.prop=F.getProp(e,t.k,1,null,this),this.k=this.prop.k,this.getValue(!0)}q.prototype.initModifierProperties=function(){},q.prototype.addShapeToModifier=function(){},q.prototype.addShape=function(e){if(!this.closed){var t={shape:e.sh,data:e,localShapeCollection:he.newShapeCollection()};this.shapes.push(t),this.addShapeToModifier(t),this._isAnimated&&e.setAsAnimated()}},q.prototype.init=function(e,t){this.shapes=[],this.elem=e,this.initDynamicPropertyContainer(e),this.initModifierProperties(e,t),this.frameId=-999999,this.closed=!1,this.k=!1,this.dynamicProperties.length?this.k=!0:this.getValue(!0)},q.prototype.processKeys=function(){this.elem.globalData.frameId!==this.frameId&&(this.frameId=this.elem.globalData.frameId,this.iterateDynamicProperties())},M([_],q),M([q],G),G.prototype.initModifierProperties=function(e,t){this.s=F.getProp(e,t.s,0,.01,this),this.e=F.getProp(e,t.e,0,.01,this),this.o=F.getProp(e,t.o,0,0,this),this.sValue=0,this.eValue=0,this.getValue=this.processKeys,this.m=t.m,this._isAnimated=!!this.s.effectsSequence.length||!!this.e.effectsSequence.length||!!this.o.effectsSequence.length},G.prototype.addShapeToModifier=function(e){e.pathsData=[]},G.prototype.calculateShapeEdges=function(e,t,r,n,i){var a=[];t<=1?a.push({s:e,e:t}):e>=1?a.push({s:e-1,e:t-1}):(a.push({s:e,e:1}),a.push({s:0,e:t-1}));var s,o,l=[],c=a.length;for(s=0;s<c;s+=1){var u,h;if((o=a[s]).e*i<n||o.s*i>n+r);else u=o.s*i<=n?0:(o.s*i-n)/r,h=o.e*i>=n+r?1:(o.e*i-n)/r,l.push([u,h])}return l.length||l.push([0,0]),l},G.prototype.releasePathsData=function(e){var t,r=e.length;for(t=0;t<r;t+=1)fe.release(e[t]);return e.length=0,e},G.prototype.processShapes=function(e){var t,r,n;if(this._mdf||e){var i=this.o.v%360/360;if(i<0&&(i+=1),(t=this.s.v+i)>(r=this.e.v+i)){var a=t;t=r,r=a}t=Math.round(1e3*t)/1e3,r=Math.round(1e3*r)/1e3,this.sValue=t,this.eValue=r}else t=this.sValue,r=this.eValue;var s,o,l,c,u,h,f=this.shapes.length,d=0;if(r===t)for(s=0;s<f;s+=1)this.shapes[s].localShapeCollection.releaseShapes(),this.shapes[s].shape._mdf=!0,this.shapes[s].shape.paths=this.shapes[s].localShapeCollection;else if(1===r&&0===t||0===r&&1===t){if(this._mdf)for(s=0;s<f;s+=1)this.shapes[s].pathsData.length=0,this.shapes[s].shape._mdf=!0}else{var p,m,g=[];for(s=0;s<f;s+=1)if((p=this.shapes[s]).shape._mdf||this._mdf||e||2===this.m){if(l=(n=p.shape.paths)._length,h=0,!p.shape._mdf&&p.pathsData.length)h=p.totalShapeLength;else{for(c=this.releasePathsData(p.pathsData),o=0;o<l;o+=1)u=k.getSegmentsLength(n.shapes[o]),c.push(u),h+=u.totalLength;p.totalShapeLength=h,p.pathsData=c}d+=h,p.shape._mdf=!0}else p.shape.paths=p.localShapeCollection;var T,y=t,v=r,E=0;for(s=f-1;s>=0;s-=1)if((p=this.shapes[s]).shape._mdf){for((m=p.localShapeCollection).releaseShapes(),2===this.m&&f>1?(T=this.calculateShapeEdges(t,r,p.totalShapeLength,E,d),E+=p.totalShapeLength):T=[[y,v]],l=T.length,o=0;o<l;o+=1){y=T[o][0],v=T[o][1],g.length=0,v<=1?g.push({s:p.totalShapeLength*y,e:p.totalShapeLength*v}):y>=1?g.push({s:p.totalShapeLength*(y-1),e:p.totalShapeLength*(v-1)}):(g.push({s:p.totalShapeLength*y,e:p.totalShapeLength}),g.push({s:0,e:p.totalShapeLength*(v-1)}));var C=this.addShapes(p,g[0]);if(g[0].s!==g[0].e){if(g.length>1)if(p.shape.v.c){var b=C.pop();this.addPaths(C,m),C=this.addShapes(p,g[1],b)}else this.addPaths(C,m),C=this.addShapes(p,g[1]);this.addPaths(C,m)}}p.shape.paths=m}}},G.prototype.addPaths=function(e,t){var r,n=e.length;for(r=0;r<n;r+=1)t.addShape(e[r])},G.prototype.addSegment=function(e,t,r,n,i,a,s){i.setXYAt(t[0],t[1],"o",a),i.setXYAt(r[0],r[1],"i",a+1),s&&i.setXYAt(e[0],e[1],"v",a),i.setXYAt(n[0],n[1],"v",a+1)},G.prototype.addSegmentFromArray=function(e,t,r,n){t.setXYAt(e[1],e[5],"o",r),t.setXYAt(e[2],e[6],"i",r+1),n&&t.setXYAt(e[0],e[4],"v",r),t.setXYAt(e[3],e[7],"v",r+1)},G.prototype.addShapes=function(e,t,r){var n,i,a,s,o,l,c,u,h=e.pathsData,f=e.shape.paths.shapes,d=e.shape.paths._length,p=0,m=[],g=!0;for(r?(o=r._length,u=r._length):(r=ue.newElement(),o=0,u=0),m.push(r),n=0;n<d;n+=1){for(l=h[n].lengths,r.c=f[n].c,a=f[n].c?l.length:l.length+1,i=1;i<a;i+=1)if(p+(s=l[i-1]).addedLength<t.s)p+=s.addedLength,r.c=!1;else{if(p>t.e){r.c=!1;break}t.s<=p&&t.e>=p+s.addedLength?(this.addSegment(f[n].v[i-1],f[n].o[i-1],f[n].i[i],f[n].v[i],r,o,g),g=!1):(c=k.getNewSegment(f[n].v[i-1],f[n].v[i],f[n].o[i-1],f[n].i[i],(t.s-p)/s.addedLength,(t.e-p)/s.addedLength,l[i-1]),this.addSegmentFromArray(c,r,o,g),g=!1,r.c=!1),p+=s.addedLength,o+=1}if(f[n].c&&l.length){if(s=l[i-1],p<=t.e){var T=l[i-1].addedLength;t.s<=p&&t.e>=p+T?(this.addSegment(f[n].v[i-1],f[n].o[i-1],f[n].i[0],f[n].v[0],r,o,g),g=!1):(c=k.getNewSegment(f[n].v[i-1],f[n].v[0],f[n].o[i-1],f[n].i[0],(t.s-p)/T,(t.e-p)/T,l[i-1]),this.addSegmentFromArray(c,r,o,g),g=!1,r.c=!1)}else r.c=!1;p+=s.addedLength,o+=1}if(r._length&&(r.setXYAt(r.v[u][0],r.v[u][1],"i",u),r.setXYAt(r.v[r._length-1][0],r.v[r._length-1][1],"o",r._length-1)),p>t.e)break;n<d-1&&(r=ue.newElement(),g=!0,m.push(r),o=0)}return m},H.registerModifier("tm",G),M([q],W),W.prototype.initModifierProperties=function(e,t){this.getValue=this.processKeys,this.rd=F.getProp(e,t.r,0,null,this),this._isAnimated=!!this.rd.effectsSequence.length},W.prototype.processPath=function(e,t){var r=ue.newElement();r.c=e.c;var n,i,a,s,o,l,c,u,h,f,d,p,m,g=e._length,T=0;for(n=0;n<g;n+=1)i=e.v[n],s=e.o[n],a=e.i[n],i[0]===s[0]&&i[1]===s[1]&&i[0]===a[0]&&i[1]===a[1]?0!==n&&n!==g-1||e.c?(o=0===n?e.v[g-1]:e.v[n-1],c=(l=Math.sqrt(Math.pow(i[0]-o[0],2)+Math.pow(i[1]-o[1],2)))?Math.min(l/2,t)/l:0,u=p=i[0]+(o[0]-i[0])*c,h=m=i[1]-(i[1]-o[1])*c,f=u-.5519*(u-i[0]),d=h-.5519*(h-i[1]),r.setTripleAt(u,h,f,d,p,m,T),T+=1,o=n===g-1?e.v[0]:e.v[n+1],c=(l=Math.sqrt(Math.pow(i[0]-o[0],2)+Math.pow(i[1]-o[1],2)))?Math.min(l/2,t)/l:0,u=f=i[0]+(o[0]-i[0])*c,h=d=i[1]+(o[1]-i[1])*c,p=u-.5519*(u-i[0]),m=h-.5519*(h-i[1]),r.setTripleAt(u,h,f,d,p,m,T),T+=1):(r.setTripleAt(i[0],i[1],s[0],s[1],a[0],a[1],T),T+=1):(r.setTripleAt(e.v[n][0],e.v[n][1],e.o[n][0],e.o[n][1],e.i[n][0],e.i[n][1],T),T+=1);return r},W.prototype.processShapes=function(e){var t,r,n,i,a,s,o=this.shapes.length,l=this.rd.v;if(0!==l)for(r=0;r<o;r+=1){if((a=this.shapes[r]).shape.paths,s=a.localShapeCollection,a.shape._mdf||this._mdf||e)for(s.releaseShapes(),a.shape._mdf=!0,t=a.shape.paths.shapes,i=a.shape.paths._length,n=0;n<i;n+=1)s.addShape(this.processPath(t[n],l));a.shape.paths=a.localShapeCollection}this.dynamicProperties.length||(this._mdf=!1)},H.registerModifier("rd",W),M([q],Y),Y.prototype.initModifierProperties=function(e,t){this.getValue=this.processKeys,this.c=F.getProp(e,t.c,0,null,this),this.o=F.getProp(e,t.o,0,null,this),this.tr=B.getTransformProperty(e,t.tr,this),this.data=t,this.dynamicProperties.length||this.getValue(!0),this._isAnimated=!!this.dynamicProperties.length,this.pMatrix=new A,this.rMatrix=new A,this.sMatrix=new A,this.tMatrix=new A,this.matrix=new A},Y.prototype.applyTransforms=function(e,t,r,n,i,a){var s=a?-1:1,o=n.s.v[0]+(1-n.s.v[0])*(1-i),l=n.s.v[1]+(1-n.s.v[1])*(1-i);e.translate(n.p.v[0]*s*i,n.p.v[1]*s*i,n.p.v[2]),t.translate(-n.a.v[0],-n.a.v[1],n.a.v[2]),t.rotate(-n.r.v*s*i),t.translate(n.a.v[0],n.a.v[1],n.a.v[2]),r.translate(-n.a.v[0],-n.a.v[1],n.a.v[2]),r.scale(a?1/o:o,a?1/l:l),r.translate(n.a.v[0],n.a.v[1],n.a.v[2])},Y.prototype.init=function(e,t,r,n){this.elem=e,this.arr=t,this.pos=r,this.elemsData=n,this._currentCopies=0,this._elements=[],this._groups=[],this.frameId=-1,this.initDynamicPropertyContainer(e),this.initModifierProperties(e,t[r]);for(;r>0;)r-=1,this._elements.unshift(t[r]),1;this.dynamicProperties.length?this.k=!0:this.getValue(!0)},Y.prototype.resetElements=function(e){var t,r=e.length;for(t=0;t<r;t+=1)e[t]._processed=!1,"gr"===e[t].ty&&this.resetElements(e[t].it)},Y.prototype.cloneElements=function(e){e.length;var t=JSON.parse(JSON.stringify(e));return this.resetElements(t),t},Y.prototype.changeGroupRender=function(e,t){var r,n=e.length;for(r=0;r<n;r+=1)e[r]._render=t,"gr"===e[r].ty&&this.changeGroupRender(e[r].it,t)},Y.prototype.processShapes=function(e){var t,r,n,i,a;if(this._mdf||e){var s,o=Math.ceil(this.c.v);if(this._groups.length<o){for(;this._groups.length<o;){var l={it:this.cloneElements(this._elements),ty:"gr"};l.it.push({a:{a:0,ix:1,k:[0,0]},nm:"Transform",o:{a:0,ix:7,k:100},p:{a:0,ix:2,k:[0,0]},r:{a:1,ix:6,k:[{s:0,e:0,t:0},{s:0,e:0,t:1}]},s:{a:0,ix:3,k:[100,100]},sa:{a:0,ix:5,k:0},sk:{a:0,ix:4,k:0},ty:"tr"}),this.arr.splice(0,0,l),this._groups.splice(0,0,l),this._currentCopies+=1}this.elem.reloadShapes()}for(a=0,n=0;n<=this._groups.length-1;n+=1)s=a<o,this._groups[n]._render=s,this.changeGroupRender(this._groups[n].it,s),a+=1;this._currentCopies=o;var c=this.o.v,u=c%1,h=c>0?Math.floor(c):Math.ceil(c),f=(this.tr.v.props,this.pMatrix.props),d=this.rMatrix.props,p=this.sMatrix.props;this.pMatrix.reset(),this.rMatrix.reset(),this.sMatrix.reset(),this.tMatrix.reset(),this.matrix.reset();var m,g,T=0;if(c>0){for(;T<h;)this.applyTransforms(this.pMatrix,this.rMatrix,this.sMatrix,this.tr,1,!1),T+=1;u&&(this.applyTransforms(this.pMatrix,this.rMatrix,this.sMatrix,this.tr,u,!1),T+=u)}else if(c<0){for(;T>h;)this.applyTransforms(this.pMatrix,this.rMatrix,this.sMatrix,this.tr,1,!0),T-=1;u&&(this.applyTransforms(this.pMatrix,this.rMatrix,this.sMatrix,this.tr,-u,!0),T-=u)}for(n=1===this.data.m?0:this._currentCopies-1,i=1===this.data.m?1:-1,a=this._currentCopies;a;){if(g=(r=(t=this.elemsData[n].it)[t.length-1].transform.mProps.v.props).length,t[t.length-1].transform.mProps._mdf=!0,t[t.length-1].transform.op._mdf=!0,0!==T){for((0!==n&&1===i||n!==this._currentCopies-1&&-1===i)&&this.applyTransforms(this.pMatrix,this.rMatrix,this.sMatrix,this.tr,1,!1),this.matrix.transform(d[0],d[1],d[2],d[3],d[4],d[5],d[6],d[7],d[8],d[9],d[10],d[11],d[12],d[13],d[14],d[15]),this.matrix.transform(p[0],p[1],p[2],p[3],p[4],p[5],p[6],p[7],p[8],p[9],p[10],p[11],p[12],p[13],p[14],p[15]),this.matrix.transform(f[0],f[1],f[2],f[3],f[4],f[5],f[6],f[7],f[8],f[9],f[10],f[11],f[12],f[13],f[14],f[15]),m=0;m<g;m+=1)r[m]=this.matrix.props[m];this.matrix.reset()}else for(this.matrix.reset(),m=0;m<g;m+=1)r[m]=this.matrix.props[m];T+=1,a-=1,n+=i}}else for(a=this._currentCopies,n=0,i=1;a;)r=(t=this.elemsData[n].it)[t.length-1].transform.mProps.v.props,t[t.length-1].transform.mProps._mdf=!1,t[t.length-1].transform.op._mdf=!1,a-=1,n+=i},Y.prototype.addShape=function(){},H.registerModifier("rp",Y),K.prototype.addShape=function(e){this._length===this._maxLength&&(this.shapes=this.shapes.concat(P(this._maxLength)),this._maxLength*=2),this.shapes[this._length]=e,this._length+=1},K.prototype.releaseShapes=function(){var e;for(e=0;e<this._length;e+=1)ue.release(this.shapes[e]);this._length=0},Q.prototype.getValue=function(e){if((this.elem.globalData.frameId!==this.frameId||e)&&(this.frameId=this.elem.globalData.frameId,this.iterateDynamicProperties(),this._mdf=this._mdf||e,this._mdf)){var t=0,r=this.dataProps.length;for("svg"===this.renderer&&(this.dashStr=""),t=0;t<r;t+=1)"o"!=this.dataProps[t].n?"svg"===this.renderer?this.dashStr+=" "+this.dataProps[t].p.v:this.dashArray[t]=this.dataProps[t].p.v:this.dashoffset[0]=this.dataProps[t].p.v}},M([_],Q),X.prototype.comparePoints=function(e,t){for(var r=0,n=this.o.length/2;r<n;){if(Math.abs(e[4*r]-e[4*t+2*r])>.01)return!1;r+=1}return!0},X.prototype.checkCollapsable=function(){if(this.o.length/2!=this.c.length/4)return!1;if(this.data.k.k[0].s)for(var e=0,t=this.data.k.k.length;e<t;){if(!this.comparePoints(this.data.k.k[e].s,this.data.p))return!1;e+=1}else if(!this.comparePoints(this.data.k.k,this.data.p))return!1;return!0},X.prototype.getValue=function(e){if(this.prop.getValue(),this._mdf=!1,this._cmdf=!1,this._omdf=!1,this.prop._mdf||e){var t,r,n,i=4*this.data.p;for(t=0;t<i;t+=1)r=t%4==0?100:255,n=Math.round(this.prop.v[t]*r),this.c[t]!==n&&(this.c[t]=n,this._cmdf=!e);if(this.o.length)for(i=this.prop.v.length,t=4*this.data.p;t<i;t+=1)r=t%2==0?100:1,n=t%2==0?Math.round(100*this.prop.v[t]):this.prop.v[t],this.o[t-4*this.data.p]!==n&&(this.o[t-4*this.data.p]=n,this._omdf=!e);this._mdf=!e}},M([_],X);var $=function(e,t,r,n){if(0===t)return"";var i,a=e.o,s=e.i,o=e.v,l=" M"+n.applyToPointStringified(o[0][0],o[0][1]);for(i=1;i<t;i+=1)l+=" C"+n.applyToPointStringified(a[i-1][0],a[i-1][1])+" "+n.applyToPointStringified(s[i][0],s[i][1])+" "+n.applyToPointStringified(o[i][0],o[i][1]);return r&&t&&(l+=" C"+n.applyToPointStringified(a[i-1][0],a[i-1][1])+" "+n.applyToPointStringified(s[0][0],s[0][1])+" "+n.applyToPointStringified(o[0][0],o[0][1]),l+="z"),l},Z=function(){function e(){this.loadedAssets+=1,this.loadedAssets===this.totalImages&&this.imagesLoadedCb&&this.imagesLoadedCb(null)}function t(e){var t="";if(e.e)t=e.p;else if(this.assetsPath){var r=e.p;-1!==r.indexOf("images/")&&(r=r.split("/")[1]),t=this.assetsPath+r}else t=this.path,t+=e.u?e.u:"",t+=e.p;return t}function r(t){var r=D("img");r.addEventListener("load",e.bind(this),!1),r.addEventListener("error",e.bind(this),!1),r.src=t}function n(e,n){var i;for(this.imagesLoadedCb=n,this.totalAssets=e.length,i=0;i<this.totalAssets;i+=1)e[i].layers||(r.bind(this)(t.bind(this)(e[i])),this.totalImages+=1)}function i(e){this.path=e||""}function a(e){this.assetsPath=e||""}function s(){this.imagesLoadedCb=null}return function(){this.loadAssets=n,this.setAssetsPath=a,this.setPath=i,this.destroy=s,this.assetsPath="",this.path="",this.totalAssets=0,this.totalImages=0,this.loadedAssets=0,this.imagesLoadedCb=null}}(),J=function(){var e={maskType:!0};return(/MSIE 10/i.test(navigator.userAgent)||/MSIE 9/i.test(navigator.userAgent)||/rv:11.0/i.test(navigator.userAgent)||/Edge\/\d./i.test(navigator.userAgent))&&(e.maskType=!1),e}(),ee=function(){var e={};return e.createFilter=function(e){var t=w("filter");return t.setAttribute("id",e),t.setAttribute("filterUnits","objectBoundingBox"),t.setAttribute("x","0%"),t.setAttribute("y","0%"),t.setAttribute("width","100%"),t.setAttribute("height","100%"),t},e.createAlphaToLuminanceFilter=function(){var e=w("feColorMatrix");return e.setAttribute("type","matrix"),e.setAttribute("color-interpolation-filters","sRGB"),e.setAttribute("values","0 0 0 1 0  0 0 0 1 0  0 0 0 1 0  0 0 0 1 1"),e},e}(),te=function(){function e(e){return e.response&&"object"==typeof e.response?e.response:e.response&&"string"==typeof e.response||e.responseText?JSON.parse(e.response):void 0}return{load:function(t,r,n){var i,a=new XMLHttpRequest;a.open("GET",t,!0),a.responseType="json",a.send(),a.onreadystatechange=function(){if(4==a.readyState)if(200==a.status)i=e(a),r(i);else try{i=e(a),r(i)}catch(e){n&&n(e)}}}}}();function re(e,t,r){this._isFirstFrame=!0,this._hasMaskedPath=!1,this._frameId=-1,this._textData=e,this._renderType=t,this._elem=r,this._animatorsData=P(this._textData.a.length),this._pathData={},this._moreOptions={alignment:{}},this.renderedLetters=[],this.lettersChangedFlag=!1,this.initDynamicPropertyContainer(r)}function ne(e,t,r){var n={propType:!1},i=F.getProp,a=t.a;this.a={r:a.r?i(e,a.r,0,u,r):n,rx:a.rx?i(e,a.rx,0,u,r):n,ry:a.ry?i(e,a.ry,0,u,r):n,sk:a.sk?i(e,a.sk,0,u,r):n,sa:a.sa?i(e,a.sa,0,u,r):n,s:a.s?i(e,a.s,1,.01,r):n,a:a.a?i(e,a.a,1,0,r):n,o:a.o?i(e,a.o,0,.01,r):n,p:a.p?i(e,a.p,1,0,r):n,sw:a.sw?i(e,a.sw,0,0,r):n,sc:a.sc?i(e,a.sc,1,0,r):n,fc:a.fc?i(e,a.fc,1,0,r):n,fh:a.fh?i(e,a.fh,0,0,r):n,fs:a.fs?i(e,a.fs,0,.01,r):n,fb:a.fb?i(e,a.fb,0,.01,r):n,t:a.t?i(e,a.t,0,0,r):n},this.s=se.getTextSelectorProp(e,t.s,r),this.s.t=t.s.t}function ie(e,t,r,n,i,a){this.o=e,this.sw=t,this.sc=r,this.fc=n,this.m=i,this.p=a,this._mdf={o:!0,sw:!!t,sc:!!r,fc:!!n,m:!0,p:!0}}function ae(e,t){this._frameId=-999999,this.pv="",this.v="",this.kf=!1,this._isFirstFrame=!0,this._mdf=!1,this.data=t,this.elem=e,this.comp=this.elem.comp,this.keysIndex=0,this.canResize=!1,this.minimumFontSize=1,this.effectsSequence=[],this.currentData={ascent:0,boxWidth:this.defaultBoxWidth,f:"",fStyle:"",fWeight:"",fc:"",j:"",justifyOffset:"",l:[],lh:0,lineWidths:[],ls:"",of:"",s:"",sc:"",sw:0,t:0,tr:0,sz:0,ps:null,fillColorAnim:!1,strokeColorAnim:!1,strokeWidthAnim:!1,yOffset:0,finalSize:0,finalText:[],finalLineHeight:0,__complete:!1},this.copyData(this.currentData,this.data.d.k[0].s),this.searchProperty()||this.completeTextData(this.currentData)}re.prototype.searchProperties=function(){var e,t,r=this._textData.a.length,n=F.getProp;for(e=0;e<r;e+=1)t=this._textData.a[e],this._animatorsData[e]=new ne(this._elem,t,this);this._textData.p&&"m"in this._textData.p?(this._pathData={f:n(this._elem,this._textData.p.f,0,0,this),l:n(this._elem,this._textData.p.l,0,0,this),r:this._textData.p.r,m:this._elem.maskManager.getMaskProperty(this._textData.p.m)},this._hasMaskedPath=!0):this._hasMaskedPath=!1,this._moreOptions.alignment=n(this._elem,this._textData.m.a,1,0,this)},re.prototype.getMeasures=function(e,t){if(this.lettersChangedFlag=t,this._mdf||this._isFirstFrame||t||this._hasMaskedPath&&this._pathData.m._mdf){this._isFirstFrame=!1;var r,n,i,a,s,o,l,c,u,h,f,d,p,m,g,T,y,v,S,I=this._moreOptions.alignment.v,x=this._animatorsData,P=this._textData,w=this.mHelper,D=this._renderType,_=this.renderedLetters.length,A=(this.data,e.l);if(this._hasMaskedPath){if(S=this._pathData.m,!this._pathData.n||this._pathData._mdf){var R,M=S.v;for(this._pathData.r&&(M=M.reverse()),s={tLength:0,segments:[]},a=M._length-1,T=0,i=0;i<a;i+=1)R={s:M.v[i],e:M.v[i+1],to:[M.o[i][0]-M.v[i][0],M.o[i][1]-M.v[i][1]],ti:[M.i[i+1][0]-M.v[i+1][0],M.i[i+1][1]-M.v[i+1][1]]},k.buildBezierData(R),s.tLength+=R.bezierData.segmentLength,s.segments.push(R),T+=R.bezierData.segmentLength;i=a,S.v.c&&(R={s:M.v[i],e:M.v[0],to:[M.o[i][0]-M.v[i][0],M.o[i][1]-M.v[i][1]],ti:[M.i[0][0]-M.v[0][0],M.i[0][1]-M.v[0][1]]},k.buildBezierData(R),s.tLength+=R.bezierData.segmentLength,s.segments.push(R),T+=R.bezierData.segmentLength),this._pathData.pi=s}if(s=this._pathData.pi,o=this._pathData.f.v,f=0,h=1,c=0,u=!0,m=s.segments,o<0&&S.v.c)for(s.tLength<Math.abs(o)&&(o=-Math.abs(o)%s.tLength),h=(p=m[f=m.length-1].bezierData.points).length-1;o<0;)o+=p[h].partialLength,(h-=1)<0&&(h=(p=m[f-=1].bezierData.points).length-1);d=(p=m[f].bezierData.points)[h-1],g=(l=p[h]).partialLength}a=A.length,r=0,n=0;var N,O,L,F,B=1.2*e.finalSize*.714,V=!0;L=x.length;var U,H,z,j,q,G,W,Y,K,Q,X,$,Z,J=-1,ee=o,te=f,re=h,ne=-1,ae="",se=this.defaultPropsArray;if(2===e.j||1===e.j){var oe=0,le=0,ce=2===e.j?-.5:-1,ue=0,he=!0;for(i=0;i<a;i+=1)if(A[i].n){for(oe&&(oe+=le);ue<i;)A[ue].animatorJustifyOffset=oe,ue+=1;oe=0,he=!0}else{for(O=0;O<L;O+=1)(N=x[O].a).t.propType&&(he&&2===e.j&&(le+=N.t.v*ce),(U=x[O].s.getMult(A[i].anIndexes[O],P.a[O].s.totalChars)).length?oe+=N.t.v*U[0]*ce:oe+=N.t.v*U*ce);he=!1}for(oe&&(oe+=le);ue<i;)A[ue].animatorJustifyOffset=oe,ue+=1}for(i=0;i<a;i+=1){if(w.reset(),q=1,A[i].n)r=0,n+=e.yOffset,n+=V?1:0,o=ee,V=!1,0,this._hasMaskedPath&&(h=re,d=(p=m[f=te].bezierData.points)[h-1],g=(l=p[h]).partialLength,c=0),Z=Q=$=ae="",se=this.defaultPropsArray;else{if(this._hasMaskedPath){if(ne!==A[i].line){switch(e.j){case 1:o+=T-e.lineWidths[A[i].line];break;case 2:o+=(T-e.lineWidths[A[i].line])/2}ne=A[i].line}J!==A[i].ind&&(A[J]&&(o+=A[J].extra),o+=A[i].an/2,J=A[i].ind),o+=I[0]*A[i].an/200;var fe=0;for(O=0;O<L;O+=1)(N=x[O].a).p.propType&&((U=x[O].s.getMult(A[i].anIndexes[O],P.a[O].s.totalChars)).length?fe+=N.p.v[0]*U[0]:fe+=N.p.v[0]*U),N.a.propType&&((U=x[O].s.getMult(A[i].anIndexes[O],P.a[O].s.totalChars)).length?fe+=N.a.v[0]*U[0]:fe+=N.a.v[0]*U);for(u=!0;u;)c+g>=o+fe||!p?(y=(o+fe-c)/l.partialLength,z=d.point[0]+(l.point[0]-d.point[0])*y,j=d.point[1]+(l.point[1]-d.point[1])*y,w.translate(-I[0]*A[i].an/200,-I[1]*B/100),u=!1):p&&(c+=l.partialLength,(h+=1)>=p.length&&(h=0,m[f+=1]?p=m[f].bezierData.points:S.v.c?(h=0,p=m[f=0].bezierData.points):(c-=l.partialLength,p=null)),p&&(d=l,g=(l=p[h]).partialLength));H=A[i].an/2-A[i].add,w.translate(-H,0,0)}else H=A[i].an/2-A[i].add,w.translate(-H,0,0),w.translate(-I[0]*A[i].an/200,-I[1]*B/100,0);for(A[i].l/2,O=0;O<L;O+=1)(N=x[O].a).t.propType&&(U=x[O].s.getMult(A[i].anIndexes[O],P.a[O].s.totalChars),0===r&&0===e.j||(this._hasMaskedPath?U.length?o+=N.t.v*U[0]:o+=N.t.v*U:U.length?r+=N.t.v*U[0]:r+=N.t.v*U));for(A[i].l/2,e.strokeWidthAnim&&(W=e.sw||0),e.strokeColorAnim&&(G=e.sc?[e.sc[0],e.sc[1],e.sc[2]]:[0,0,0]),e.fillColorAnim&&e.fc&&(Y=[e.fc[0],e.fc[1],e.fc[2]]),O=0;O<L;O+=1)(N=x[O].a).a.propType&&((U=x[O].s.getMult(A[i].anIndexes[O],P.a[O].s.totalChars)).length?w.translate(-N.a.v[0]*U[0],-N.a.v[1]*U[1],N.a.v[2]*U[2]):w.translate(-N.a.v[0]*U,-N.a.v[1]*U,N.a.v[2]*U));for(O=0;O<L;O+=1)(N=x[O].a).s.propType&&((U=x[O].s.getMult(A[i].anIndexes[O],P.a[O].s.totalChars)).length?w.scale(1+(N.s.v[0]-1)*U[0],1+(N.s.v[1]-1)*U[1],1):w.scale(1+(N.s.v[0]-1)*U,1+(N.s.v[1]-1)*U,1));for(O=0;O<L;O+=1){if(N=x[O].a,U=x[O].s.getMult(A[i].anIndexes[O],P.a[O].s.totalChars),N.sk.propType&&(U.length?w.skewFromAxis(-N.sk.v*U[0],N.sa.v*U[1]):w.skewFromAxis(-N.sk.v*U,N.sa.v*U)),N.r.propType&&(U.length?w.rotateZ(-N.r.v*U[2]):w.rotateZ(-N.r.v*U)),N.ry.propType&&(U.length?w.rotateY(N.ry.v*U[1]):w.rotateY(N.ry.v*U)),N.rx.propType&&(U.length?w.rotateX(N.rx.v*U[0]):w.rotateX(N.rx.v*U)),N.o.propType&&(U.length?q+=(N.o.v*U[0]-q)*U[0]:q+=(N.o.v*U-q)*U),e.strokeWidthAnim&&N.sw.propType&&(U.length?W+=N.sw.v*U[0]:W+=N.sw.v*U),e.strokeColorAnim&&N.sc.propType)for(K=0;K<3;K+=1)U.length?G[K]=G[K]+(N.sc.v[K]-G[K])*U[0]:G[K]=G[K]+(N.sc.v[K]-G[K])*U;if(e.fillColorAnim&&e.fc){if(N.fc.propType)for(K=0;K<3;K+=1)U.length?Y[K]=Y[K]+(N.fc.v[K]-Y[K])*U[0]:Y[K]=Y[K]+(N.fc.v[K]-Y[K])*U;N.fh.propType&&(Y=U.length?b(Y,N.fh.v*U[0]):b(Y,N.fh.v*U)),N.fs.propType&&(Y=U.length?E(Y,N.fs.v*U[0]):E(Y,N.fs.v*U)),N.fb.propType&&(Y=U.length?C(Y,N.fb.v*U[0]):C(Y,N.fb.v*U))}}for(O=0;O<L;O+=1)(N=x[O].a).p.propType&&(U=x[O].s.getMult(A[i].anIndexes[O],P.a[O].s.totalChars),this._hasMaskedPath?U.length?w.translate(0,N.p.v[1]*U[0],-N.p.v[2]*U[1]):w.translate(0,N.p.v[1]*U,-N.p.v[2]*U):U.length?w.translate(N.p.v[0]*U[0],N.p.v[1]*U[1],-N.p.v[2]*U[2]):w.translate(N.p.v[0]*U,N.p.v[1]*U,-N.p.v[2]*U));if(e.strokeWidthAnim&&(Q=W<0?0:W),e.strokeColorAnim&&(X="rgb("+Math.round(255*G[0])+","+Math.round(255*G[1])+","+Math.round(255*G[2])+")"),e.fillColorAnim&&e.fc&&($="rgb("+Math.round(255*Y[0])+","+Math.round(255*Y[1])+","+Math.round(255*Y[2])+")"),this._hasMaskedPath){if(w.translate(0,-e.ls),w.translate(0,I[1]*B/100+n,0),P.p.p){v=(l.point[1]-d.point[1])/(l.point[0]-d.point[0]);var de=180*Math.atan(v)/Math.PI;l.point[0]<d.point[0]&&(de+=180),w.rotate(-de*Math.PI/180)}w.translate(z,j,0),o-=I[0]*A[i].an/200,A[i+1]&&J!==A[i+1].ind&&(o+=A[i].an/2,o+=e.tr/1e3*e.finalSize)}else{switch(w.translate(r,n,0),e.ps&&w.translate(e.ps[0],e.ps[1]+e.ascent,0),e.j){case 1:w.translate(A[i].animatorJustifyOffset+e.justifyOffset+(e.boxWidth-e.lineWidths[A[i].line]),0,0);break;case 2:w.translate(A[i].animatorJustifyOffset+e.justifyOffset+(e.boxWidth-e.lineWidths[A[i].line])/2,0,0)}w.translate(0,-e.ls),w.translate(H,0,0),w.translate(I[0]*A[i].an/200,I[1]*B/100,0),r+=A[i].l+e.tr/1e3*e.finalSize}"html"===D?ae=w.toCSS():"svg"===D?ae=w.to2dCSS():se=[w.props[0],w.props[1],w.props[2],w.props[3],w.props[4],w.props[5],w.props[6],w.props[7],w.props[8],w.props[9],w.props[10],w.props[11],w.props[12],w.props[13],w.props[14],w.props[15]],Z=q}_<=i?(F=new ie(Z,Q,X,$,ae,se),this.renderedLetters.push(F),_+=1,this.lettersChangedFlag=!0):(F=this.renderedLetters[i],this.lettersChangedFlag=F.update(Z,Q,X,$,ae,se)||this.lettersChangedFlag)}}},re.prototype.getValue=function(){this._elem.globalData.frameId!==this._frameId&&(this._frameId=this._elem.globalData.frameId,this.iterateDynamicProperties())},re.prototype.mHelper=new A,re.prototype.defaultPropsArray=[],M([_],re),ie.prototype.update=function(e,t,r,n,i,a){this._mdf.o=!1,this._mdf.sw=!1,this._mdf.sc=!1,this._mdf.fc=!1,this._mdf.m=!1,this._mdf.p=!1;var s=!1;return this.o!==e&&(this.o=e,this._mdf.o=!0,s=!0),this.sw!==t&&(this.sw=t,this._mdf.sw=!0,s=!0),this.sc!==r&&(this.sc=r,this._mdf.sc=!0,s=!0),this.fc!==n&&(this.fc=n,this._mdf.fc=!0,s=!0),this.m!==i&&(this.m=i,this._mdf.m=!0,s=!0),!a.length||this.p[0]===a[0]&&this.p[1]===a[1]&&this.p[4]===a[4]&&this.p[5]===a[5]&&this.p[12]===a[12]&&this.p[13]===a[13]||(this.p=a,this._mdf.p=!0,s=!0),s},ae.prototype.defaultBoxWidth=[0,0],ae.prototype.copyData=function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r]);return e},ae.prototype.setCurrentData=function(e){e.__complete||this.completeTextData(e),this.currentData=e,this.currentData.boxWidth=this.currentData.boxWidth||this.defaultBoxWidth,this._mdf=!0},ae.prototype.searchProperty=function(){return this.searchKeyframes()},ae.prototype.searchKeyframes=function(){return this.kf=this.data.d.k.length>1,this.kf&&this.addEffect(this.getKeyframeValue.bind(this)),this.kf},ae.prototype.addEffect=function(e){this.effectsSequence.push(e),this.elem.addDynamicProperty(this)},ae.prototype.getValue=function(e){if(this.elem.globalData.frameId!==this.frameId&&this.effectsSequence.length||e){var t=this.currentData,r=this.keysIndex;if(this.lock)this.setCurrentData(this.currentData,currentTextValue);else{this.lock=!0,this._mdf=!1;var n,i=this.effectsSequence.length,a=e||this.data.d.k[this.keysIndex].s;for(n=0;n<i;n+=1)a=r!==this.keysIndex?this.effectsSequence[n](a,a.t):this.effectsSequence[n](this.currentData,a.t);t!==a&&this.setCurrentData(a),this.pv=this.v=this.currentData,this.lock=!1,this.frameId=this.elem.globalData.frameId}}},ae.prototype.getKeyframeValue=function(){for(var e=this.data.d.k,t=this.elem.comp.renderedFrame,r=0,n=e.length;r<=n-1&&(e[r].s,!(r===n-1||e[r+1].t>t));)r+=1;return this.keysIndex!==r&&(this.keysIndex=r),this.data.d.k[this.keysIndex].s},ae.prototype.buildFinalText=function(e){for(var t=L.getCombinedCharacterCodes(),r=[],n=0,i=e.length;n<i;)-1!==t.indexOf(e.charCodeAt(n))?r[r.length-1]+=e.charAt(n):r.push(e.charAt(n)),n+=1;return r},ae.prototype.completeTextData=function(e){e.__complete=!0;var t,r,n,i,a,s,o,l=this.elem.globalData.fontManager,c=this.data,u=[],h=0,f=c.m.g,d=0,p=0,m=0,g=[],T=0,y=0,v=l.getFontByName(e.f),E=0,C=v.fStyle?v.fStyle.split(" "):[],b="normal",S="normal";for(r=C.length,t=0;t<r;t+=1)switch(C[t].toLowerCase()){case"italic":S="italic";break;case"bold":b="700";break;case"black":b="900";break;case"medium":b="500";break;case"regular":case"normal":b="400";break;case"light":case"thin":b="200"}e.fWeight=v.fWeight||b,e.fStyle=S,r=e.t.length,e.finalSize=e.s,e.finalText=this.buildFinalText(e.t),e.finalLineHeight=e.lh;var I=e.tr/1e3*e.finalSize;if(e.sz)for(var x,P,w=!0,D=e.sz[0],_=e.sz[1];w;){x=0,T=0,r=(P=this.buildFinalText(e.t)).length,I=e.tr/1e3*e.finalSize;var A=-1;for(t=0;t<r;t+=1)n=!1," "===P[t]?A=t:13===P[t].charCodeAt(0)&&(T=0,n=!0,x+=e.finalLineHeight||1.2*e.finalSize),l.chars?(o=l.getCharData(P[t],v.fStyle,v.fFamily),E=n?0:o.w*e.finalSize/100):E=l.measureText(P[t],e.f,e.finalSize),T+E>D&&" "!==P[t]?(-1===A?r+=1:t=A,x+=e.finalLineHeight||1.2*e.finalSize,P.splice(t,A===t?1:0,"\r"),A=-1,T=0):(T+=E,T+=I);x+=v.ascent*e.finalSize/100,this.canResize&&e.finalSize>this.minimumFontSize&&_<x?(e.finalSize-=1,e.finalLineHeight=e.finalSize*e.lh/e.s):(e.finalText=P,r=e.finalText.length,w=!1)}T=-I,E=0;var R,M=0;for(t=0;t<r;t+=1)if(n=!1," "===(R=e.finalText[t])?i=" ":13===R.charCodeAt(0)?(M=0,g.push(T),y=T>y?T:y,T=-2*I,i="",n=!0,m+=1):i=e.finalText[t],l.chars?(o=l.getCharData(R,v.fStyle,l.getFontByName(e.f).fFamily),E=n?0:o.w*e.finalSize/100):E=l.measureText(i,e.f,e.finalSize)," "===R?M+=E+I:(T+=E+I+M,M=0),u.push({l:E,an:E,add:d,n:n,anIndexes:[],val:i,line:m,animatorJustifyOffset:0}),2==f){if(d+=E,""===i||" "===i||t===r-1){for(""!==i&&" "!==i||(d-=E);p<=t;)u[p].an=d,u[p].ind=h,u[p].extra=E,p+=1;h+=1,d=0}}else if(3==f){if(d+=E,""===i||t===r-1){for(""===i&&(d-=E);p<=t;)u[p].an=d,u[p].ind=h,u[p].extra=E,p+=1;d=0,h+=1}}else u[h].ind=h,u[h].extra=0,h+=1;if(e.l=u,y=T>y?T:y,g.push(T),e.sz)e.boxWidth=e.sz[0],e.justifyOffset=0;else switch(e.boxWidth=y,e.j){case 1:e.justifyOffset=-e.boxWidth;break;case 2:e.justifyOffset=-e.boxWidth/2;break;default:e.justifyOffset=0}e.lineWidths=g;var N,k,O=c.a;s=O.length;var L,F,B=[];for(a=0;a<s;a+=1){for((N=O[a]).a.sc&&(e.strokeColorAnim=!0),N.a.sw&&(e.strokeWidthAnim=!0),(N.a.fc||N.a.fh||N.a.fs||N.a.fb)&&(e.fillColorAnim=!0),F=0,L=N.s.b,t=0;t<r;t+=1)(k=u[t]).anIndexes[a]=F,(1==L&&""!==k.val||2==L&&""!==k.val&&" "!==k.val||3==L&&(k.n||" "==k.val||t==r-1)||4==L&&(k.n||t==r-1))&&(1===N.s.rn&&B.push(F),F+=1);c.a[a].s.totalChars=F;var V,U=-1;if(1===N.s.rn)for(t=0;t<r;t+=1)U!=(k=u[t]).anIndexes[a]&&(U=k.anIndexes[a],V=B.splice(Math.floor(Math.random()*B.length),1)[0]),k.anIndexes[a]=V}e.yOffset=e.finalLineHeight||1.2*e.finalSize,e.ls=e.ls||0,e.ascent=v.ascent*e.finalSize/100},ae.prototype.updateDocumentData=function(e,t){t=void 0===t?this.keysIndex:t;var r=this.copyData({},this.data.d.k[t].s);r=this.copyData(r,e),this.data.d.k[t].s=r,this.recalculate(t)},ae.prototype.recalculate=function(e){var t=this.data.d.k[e].s;t.__complete=!1,this.keysIndex=0,this._isFirstFrame=!0,this.getValue(t)},ae.prototype.canResizeFont=function(e){this.canResize=e,this.recalculate(this.keysIndex)},ae.prototype.setMinimumFontSize=function(e){this.minimumFontSize=Math.floor(e)||1,this.recalculate(this.keysIndex)};var se=function(){var e=Math.max,t=Math.min,r=Math.floor;function n(e,t){this._currentTextLength=-1,this.k=!1,this.data=t,this.elem=e,this.comp=e.comp,this.finalS=0,this.finalE=0,this.initDynamicPropertyContainer(e),this.s=F.getProp(e,t.s||{k:0},0,0,this),this.e="e"in t?F.getProp(e,t.e,0,0,this):{v:100},this.o=F.getProp(e,t.o||{k:0},0,0,this),this.xe=F.getProp(e,t.xe||{k:0},0,0,this),this.ne=F.getProp(e,t.ne||{k:0},0,0,this),this.a=F.getProp(e,t.a,0,.01,this),this.dynamicProperties.length||this.getValue()}return n.prototype={getMult:function(n){this._currentTextLength!==this.elem.textProperty.currentData.l.length&&this.getValue();var i=R.getBezierEasing(this.ne.v/100,0,1-this.xe.v/100,1).get,a=0,s=this.finalS,o=this.finalE,l=this.data.sh;if(2==l)a=i(a=o===s?n>=o?1:0:e(0,t(.5/(o-s)+(n-s)/(o-s),1)));else if(3==l)a=i(a=o===s?n>=o?0:1:1-e(0,t(.5/(o-s)+(n-s)/(o-s),1)));else if(4==l)o===s?a=0:(a=e(0,t(.5/(o-s)+(n-s)/(o-s),1)))<.5?a*=2:a=1-2*(a-.5),a=i(a);else if(5==l){if(o===s)a=0;else{var c=o-s,u=-c/2+(n=t(e(0,n+.5-s),o-s)),h=c/2;a=Math.sqrt(1-u*u/(h*h))}a=i(a)}else 6==l?(o===s?a=0:(n=t(e(0,n+.5-s),o-s),a=(1+Math.cos(Math.PI+2*Math.PI*n/(o-s)))/2),a=i(a)):(n>=r(s)&&(a=n-s<0?1-(s-n):e(0,t(o-n,1))),a=i(a));return a*this.a.v},getValue:function(e){this.iterateDynamicProperties(),this._mdf=e||this._mdf,this._currentTextLength=this.elem.textProperty.currentData.l.length||0,e&&2===this.data.r&&(this.e.v=this._currentTextLength);var t=2===this.data.r?1:100/this.data.totalChars,r=this.o.v/t,n=this.s.v/t+r,i=this.e.v/t+r;if(n>i){var a=n;n=i,i=a}this.finalS=n,this.finalE=i}},M([_],n),{getTextSelectorProp:function(e,t,r){return new n(e,t,r)}}}(),oe=function(e,t,r,n){var i=0,a=e,s=P(a);function o(){return i?s[i-=1]:t()}return{newElement:o,release:function(e){i===a&&(s=le.double(s),a*=2),r&&r(e),s[i]=e,i+=1}}},le={double:function(e){return e.concat(P(e.length))}},ce=oe(8,(function(){return x("float32",2)})),ue=function(){var e=oe(4,(function(){return new V}),(function(e){var t,r=e._length;for(t=0;t<r;t+=1)ce.release(e.v[t]),ce.release(e.i[t]),ce.release(e.o[t]),e.v[t]=null,e.i[t]=null,e.o[t]=null;e._length=0,e.c=!1}));return e.clone=function(t){var r,n=e.newElement(),i=void 0===t._length?t.v.length:t._length;for(n.setLength(i),n.c=t.c,r=0;r<i;r+=1)n.setTripleAt(t.v[r][0],t.v[r][1],t.o[r][0],t.o[r][1],t.i[r][0],t.i[r][1],r);return n},e}(),he=function(){var e={newShapeCollection:function(){var e;e=t?n[t-=1]:new K;return e},release:function(e){var i,a=e._length;for(i=0;i<a;i+=1)ue.release(e.shapes[i]);e._length=0,t===r&&(n=le.double(n),r*=2);n[t]=e,t+=1}},t=0,r=4,n=P(r);return e}(),fe=oe(8,(function(){return{lengths:[],totalLength:0}}),(function(e){var t,r=e.lengths.length;for(t=0;t<r;t+=1)de.release(e.lengths[t]);e.lengths.length=0})),de=oe(8,(function(){return{addedLength:0,percents:x("float32",c),lengths:x("float32",c)}}));function pe(){}function me(e,t){this.animationItem=e,this.layers=null,this.renderedFrame=-1,this.svgElement=w("svg");var r=w("defs");this.svgElement.appendChild(r);var n=w("g");this.svgElement.appendChild(n),this.layerElement=n,this.renderConfig={preserveAspectRatio:t&&t.preserveAspectRatio||"xMidYMid meet",imagePreserveAspectRatio:t&&t.imagePreserveAspectRatio||"xMidYMid slice",progressiveLoad:t&&t.progressiveLoad||!1,hideOnTransparent:!t||!1!==t.hideOnTransparent,viewBoxOnly:t&&t.viewBoxOnly||!1,viewBoxSize:t&&t.viewBoxSize||!1,className:t&&t.className||""},this.globalData={_mdf:!1,frameNum:-1,defs:r,renderConfig:this.renderConfig},this.elements=[],this.pendingElements=[],this.destroyed=!1}function ge(e,t,n){this.data=e,this.element=t,this.globalData=n,this.storedData=[],this.masksProperties=this.data.masksProperties||[],this.maskElement=null;var i,a=this.globalData.defs,s=this.masksProperties?this.masksProperties.length:0;this.viewData=P(s),this.solidPath="";var o,l,c,u,h,f,d,p=this.masksProperties,m=0,g=[],y=T(10),v="clipPath",E="clip-path";for(i=0;i<s;i++)if(("a"!==p[i].mode&&"n"!==p[i].mode||p[i].inv||100!==p[i].o.k)&&(v="mask",E="mask"),"s"!=p[i].mode&&"i"!=p[i].mode||0!==m?u=null:((u=w("rect")).setAttribute("fill","#ffffff"),u.setAttribute("width",this.element.comp.data.w||0),u.setAttribute("height",this.element.comp.data.h||0),g.push(u)),o=w("path"),"n"!=p[i].mode){var C;if(m+=1,o.setAttribute("fill","s"===p[i].mode?"#000000":"#ffffff"),o.setAttribute("clip-rule","nonzero"),0!==p[i].x.k?(v="mask",E="mask",d=F.getProp(this.element,p[i].x,0,null,this.element),C="fi_"+T(10),(h=w("filter")).setAttribute("id",C),(f=w("feMorphology")).setAttribute("operator","dilate"),f.setAttribute("in","SourceGraphic"),f.setAttribute("radius","0"),h.appendChild(f),a.appendChild(h),o.setAttribute("stroke","s"===p[i].mode?"#000000":"#ffffff")):(f=null,d=null),this.storedData[i]={elem:o,x:d,expan:f,lastPath:"",lastOperator:"",filterId:C,lastRadius:0},"i"==p[i].mode){c=g.length;var b=w("g");for(l=0;l<c;l+=1)b.appendChild(g[l]);var S=w("mask");S.setAttribute("mask-type","alpha"),S.setAttribute("id",y+"_"+m),S.appendChild(o),a.appendChild(S),b.setAttribute("mask","url("+r+"#"+y+"_"+m+")"),g.length=0,g.push(b)}else g.push(o);p[i].inv&&!this.solidPath&&(this.solidPath=this.createLayerSolidPath()),this.viewData[i]={elem:o,lastPath:"",op:F.getProp(this.element,p[i].o,0,.01,this.element),prop:U.getShapeProp(this.element,p[i],3),invRect:u},this.viewData[i].prop.k||this.drawPath(p[i],this.viewData[i].prop.v,this.viewData[i])}else this.viewData[i]={op:F.getProp(this.element,p[i].o,0,.01,this.element),prop:U.getShapeProp(this.element,p[i],3),elem:o,lastPath:""},a.appendChild(o);for(this.maskElement=w(v),s=g.length,i=0;i<s;i+=1)this.maskElement.appendChild(g[i]);m>0&&(this.maskElement.setAttribute("id",y),this.element.maskedElement.setAttribute(E,"url("+r+"#"+y+")"),a.appendChild(this.maskElement)),this.viewData.length&&this.element.addRenderableComponent(this)}function Te(){}function ye(){}function ve(){}function Ee(){}function Ce(){}function be(e,t){this.elem=e,this.pos=t}function Se(e,t){this.data=e,this.type=e.ty,this.d="",this.lvl=t,this._mdf=!1,this.closed=!0===e.hd,this.pElem=w("path"),this.msElem=null}function Ie(e,t,r){this.caches=[],this.styles=[],this.transformers=e,this.lStr="",this.sh=r,this.lvl=t,this._isAnimated=!!r.k;for(var n=0,i=e.length;n<i;){if(e[n].mProps.dynamicProperties.length){this._isAnimated=!0;break}n+=1}}function xe(e,t,r){this.transform={mProps:e,op:t,container:r},this.elements=[],this._isAnimated=this.transform.mProps.dynamicProperties.length||this.transform.op.effectsSequence.length}function Pe(e,t,r){this.initDynamicPropertyContainer(e),this.getValue=this.iterateDynamicProperties,this.o=F.getProp(e,t.o,0,.01,this),this.w=F.getProp(e,t.w,0,null,this),this.d=new Q(e,t.d||{},"svg",this),this.c=F.getProp(e,t.c,1,255,this),this.style=r,this._isAnimated=!!this._isAnimated}function we(e,t,r){this.initDynamicPropertyContainer(e),this.getValue=this.iterateDynamicProperties,this.o=F.getProp(e,t.o,0,.01,this),this.c=F.getProp(e,t.c,1,255,this),this.style=r}function De(e,t,r){this.initDynamicPropertyContainer(e),this.getValue=this.iterateDynamicProperties,this.initGradientData(e,t,r)}function _e(e,t,r){this.initDynamicPropertyContainer(e),this.getValue=this.iterateDynamicProperties,this.w=F.getProp(e,t.w,0,null,this),this.d=new Q(e,t.d||{},"svg",this),this.initGradientData(e,t,r),this._isAnimated=!!this._isAnimated}function Ae(){this.it=[],this.prevViewData=[],this.gr=w("g")}pe.prototype.checkLayers=function(e){var t,r,n=this.layers.length;for(this.completeLayers=!0,t=n-1;t>=0;t--)this.elements[t]||(r=this.layers[t]).ip-r.st<=e-this.layers[t].st&&r.op-r.st>e-this.layers[t].st&&this.buildItem(t),this.completeLayers=!!this.elements[t]&&this.completeLayers;this.checkPendingElements()},pe.prototype.createItem=function(e){switch(e.ty){case 2:return this.createImage(e);case 0:return this.createComp(e);case 1:return this.createSolid(e);case 3:return this.createNull(e);case 4:return this.createShape(e);case 5:return this.createText(e);case 13:return this.createCamera(e)}return this.createNull(e)},pe.prototype.createCamera=function(){throw new Error("You're using a 3d camera. Try the html renderer.")},pe.prototype.buildAllItems=function(){var e,t=this.layers.length;for(e=0;e<t;e+=1)this.buildItem(e);this.checkPendingElements()},pe.prototype.includeLayers=function(e){this.completeLayers=!1;var t,r,n=e.length,i=this.layers.length;for(t=0;t<n;t+=1)for(r=0;r<i;){if(this.layers[r].id==e[t].id){this.layers[r]=e[t];break}r+=1}},pe.prototype.setProjectInterface=function(e){this.globalData.projectInterface=e},pe.prototype.initItems=function(){this.globalData.progressiveLoad||this.buildAllItems()},pe.prototype.buildElementParenting=function(e,t,r){for(var n=this.elements,i=this.layers,a=0,s=i.length;a<s;)i[a].ind==t&&(n[a]&&!0!==n[a]?(r.push(n[a]),n[a].setAsParent(),void 0!==i[a].parent?this.buildElementParenting(e,i[a].parent,r):e.setHierarchy(r)):(this.buildItem(a),this.addPendingElement(e))),a+=1},pe.prototype.addPendingElement=function(e){this.pendingElements.push(e)},pe.prototype.searchExtraCompositions=function(e){var t,r=e.length;for(t=0;t<r;t+=1)if(e[t].xt){var n=this.createComp(e[t]);n.initExpressions(),this.globalData.projectInterface.registerComposition(n)}},pe.prototype.setupGlobalData=function(e,t){this.globalData.fontManager=new L,this.globalData.fontManager.addChars(e.chars),this.globalData.fontManager.addFonts(e.fonts,t),this.globalData.getAssetData=this.animationItem.getAssetData.bind(this.animationItem),this.globalData.getAssetsPath=this.animationItem.getAssetsPath.bind(this.animationItem),this.globalData.elementLoaded=this.animationItem.elementLoaded.bind(this.animationItem),this.globalData.addPendingElement=this.animationItem.addPendingElement.bind(this.animationItem),this.globalData.frameId=0,this.globalData.frameRate=e.fr,this.globalData.nm=e.nm,this.globalData.compSize={w:e.w,h:e.h}},M([pe],me),me.prototype.createNull=function(e){return new Ne(e,this.globalData,this)},me.prototype.createShape=function(e){return new ze(e,this.globalData,this)},me.prototype.createText=function(e){return new He(e,this.globalData,this)},me.prototype.createImage=function(e){return new Be(e,this.globalData,this)},me.prototype.createComp=function(e){return new Ue(e,this.globalData,this)},me.prototype.createSolid=function(e){return new Ve(e,this.globalData,this)},me.prototype.configAnimation=function(e){this.svgElement.setAttribute("xmlns","http://www.w3.org/2000/svg"),this.renderConfig.viewBoxSize?this.svgElement.setAttribute("viewBox",this.renderConfig.viewBoxSize):this.svgElement.setAttribute("viewBox","0 0 "+e.w+" "+e.h),this.renderConfig.viewBoxOnly||(this.svgElement.setAttribute("width",e.w),this.svgElement.setAttribute("height",e.h),this.svgElement.style.width="100%",this.svgElement.style.height="100%",this.svgElement.style.transform="translate3d(0,0,0)"),this.renderConfig.className&&this.svgElement.setAttribute("class",this.renderConfig.className),this.svgElement.setAttribute("preserveAspectRatio",this.renderConfig.preserveAspectRatio),this.animationItem.wrapper.appendChild(this.svgElement);var t=this.globalData.defs;this.setupGlobalData(e,t),this.globalData.progressiveLoad=this.renderConfig.progressiveLoad,this.data=e;var n=w("clipPath"),i=w("rect");i.setAttribute("width",e.w),i.setAttribute("height",e.h),i.setAttribute("x",0),i.setAttribute("y",0);var a="animationMask_"+T(10);n.setAttribute("id",a),n.appendChild(i),this.layerElement.setAttribute("clip-path","url("+r+"#"+a+")"),t.appendChild(n),this.layers=e.layers,this.elements=P(e.layers.length)},me.prototype.destroy=function(){this.animationItem.wrapper.innerHTML="",this.layerElement=null,this.globalData.defs=null;var e,t=this.layers?this.layers.length:0;for(e=0;e<t;e++)this.elements[e]&&this.elements[e].destroy();this.elements.length=0,this.destroyed=!0,this.animationItem=null},me.prototype.updateContainerSize=function(){},me.prototype.buildItem=function(e){var r=this.elements;if(!r[e]&&99!=this.layers[e].ty){r[e]=!0;var n=this.createItem(this.layers[e]);r[e]=n,t&&(0===this.layers[e].ty&&this.globalData.projectInterface.registerComposition(n),n.initExpressions()),this.appendElementInPos(n,e),this.layers[e].tt&&(this.elements[e-1]&&!0!==this.elements[e-1]?n.setMatte(r[e-1].layerId):(this.buildItem(e-1),this.addPendingElement(n)))}},me.prototype.checkPendingElements=function(){for(;this.pendingElements.length;){var e=this.pendingElements.pop();if(e.checkParenting(),e.data.tt)for(var t=0,r=this.elements.length;t<r;){if(this.elements[t]===e){e.setMatte(this.elements[t-1].layerId);break}t+=1}}},me.prototype.renderFrame=function(e){if(this.renderedFrame!==e&&!this.destroyed){null===e?e=this.renderedFrame:this.renderedFrame=e,this.globalData.frameNum=e,this.globalData.frameId+=1,this.globalData.projectInterface.currentFrame=e,this.globalData._mdf=!1;var t,r=this.layers.length;for(this.completeLayers||this.checkLayers(e),t=r-1;t>=0;t--)(this.completeLayers||this.elements[t])&&this.elements[t].prepareFrame(e-this.layers[t].st);if(this.globalData._mdf)for(t=0;t<r;t+=1)(this.completeLayers||this.elements[t])&&this.elements[t].renderFrame()}},me.prototype.appendElementInPos=function(e,t){var r=e.getBaseElement();if(r){for(var n,i=0;i<t;)this.elements[i]&&!0!==this.elements[i]&&this.elements[i].getBaseElement()&&(n=this.elements[i].getBaseElement()),i+=1;n?this.layerElement.insertBefore(r,n):this.layerElement.appendChild(r)}},me.prototype.hide=function(){this.layerElement.style.display="none"},me.prototype.show=function(){this.layerElement.style.display="block"},ge.prototype.getMaskProperty=function(e){return this.viewData[e].prop},ge.prototype.renderFrame=function(e){var t,n=this.element.finalTransform.mat,i=this.masksProperties.length;for(t=0;t<i;t++)if((this.viewData[t].prop._mdf||e)&&this.drawPath(this.masksProperties[t],this.viewData[t].prop.v,this.viewData[t]),(this.viewData[t].op._mdf||e)&&this.viewData[t].elem.setAttribute("fill-opacity",this.viewData[t].op.v),"n"!==this.masksProperties[t].mode&&(this.viewData[t].invRect&&(this.element.finalTransform.mProp._mdf||e)&&(this.viewData[t].invRect.setAttribute("x",-n.props[12]),this.viewData[t].invRect.setAttribute("y",-n.props[13])),this.storedData[t].x&&(this.storedData[t].x._mdf||e))){var a=this.storedData[t].expan;this.storedData[t].x.v<0?("erode"!==this.storedData[t].lastOperator&&(this.storedData[t].lastOperator="erode",this.storedData[t].elem.setAttribute("filter","url("+r+"#"+this.storedData[t].filterId+")")),a.setAttribute("radius",-this.storedData[t].x.v)):("dilate"!==this.storedData[t].lastOperator&&(this.storedData[t].lastOperator="dilate",this.storedData[t].elem.setAttribute("filter",null)),this.storedData[t].elem.setAttribute("stroke-width",2*this.storedData[t].x.v))}},ge.prototype.getMaskelement=function(){return this.maskElement},ge.prototype.createLayerSolidPath=function(){var e="M0,0 ";return e+=" h"+this.globalData.compSize.w,e+=" v"+this.globalData.compSize.h,e+=" h-"+this.globalData.compSize.w,e+=" v-"+this.globalData.compSize.h+" "},ge.prototype.drawPath=function(e,t,r){var n,i,a=" M"+t.v[0][0]+","+t.v[0][1];for(i=t._length,n=1;n<i;n+=1)a+=" C"+t.o[n-1][0]+","+t.o[n-1][1]+" "+t.i[n][0]+","+t.i[n][1]+" "+t.v[n][0]+","+t.v[n][1];if(t.c&&i>1&&(a+=" C"+t.o[n-1][0]+","+t.o[n-1][1]+" "+t.i[0][0]+","+t.i[0][1]+" "+t.v[0][0]+","+t.v[0][1]),r.lastPath!==a){var s="";r.elem&&(t.c&&(s=e.inv?this.solidPath+a:a),r.elem.setAttribute("d",s)),r.lastPath=a}},ge.prototype.destroy=function(){this.element=null,this.globalData=null,this.maskElement=null,this.data=null,this.masksProperties=null},Te.prototype={initHierarchy:function(){this.hierarchy=[],this._isParent=!1,this.checkParenting()},setHierarchy:function(e){this.hierarchy=e},setAsParent:function(){this._isParent=!0},checkParenting:function(){void 0!==this.data.parent&&this.comp.buildElementParenting(this,this.data.parent,[])}},ye.prototype={initFrame:function(){this._isFirstFrame=!1,this.dynamicProperties=[],this._mdf=!1},prepareProperties:function(e,t){var r,n=this.dynamicProperties.length;for(r=0;r<n;r+=1)(t||this._isParent&&"transform"===this.dynamicProperties[r].propType)&&(this.dynamicProperties[r].getValue(),this.dynamicProperties[r]._mdf&&(this.globalData._mdf=!0,this._mdf=!0))},addDynamicProperty:function(e){-1===this.dynamicProperties.indexOf(e)&&this.dynamicProperties.push(e)}},ve.prototype={initTransform:function(){this.finalTransform={mProp:this.data.ks?B.getTransformProperty(this,this.data.ks,this):{o:0},_matMdf:!1,_opMdf:!1,mat:new A},this.data.ao&&(this.finalTransform.mProp.autoOriented=!0),this.data.ty},renderTransform:function(){if(this.finalTransform._opMdf=this.finalTransform.mProp.o._mdf||this._isFirstFrame,this.finalTransform._matMdf=this.finalTransform.mProp._mdf||this._isFirstFrame,this.hierarchy){var e,t=this.finalTransform.mat,r=0,n=this.hierarchy.length;if(!this.finalTransform._matMdf)for(;r<n;){if(this.hierarchy[r].finalTransform.mProp._mdf){this.finalTransform._matMdf=!0;break}r+=1}if(this.finalTransform._matMdf)for(e=this.finalTransform.mProp.v.props,t.cloneFromProps(e),r=0;r<n;r+=1)e=this.hierarchy[r].finalTransform.mProp.v.props,t.transform(e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7],e[8],e[9],e[10],e[11],e[12],e[13],e[14],e[15])}},globalToLocal:function(e){var t=[];t.push(this.finalTransform);for(var r=!0,n=this.comp;r;)n.finalTransform?(n.data.hasMask&&t.splice(0,0,n.finalTransform),n=n.comp):r=!1;var i,a,s=t.length;for(i=0;i<s;i+=1)a=t[i].mat.applyToPointArray(0,0,0),e=[e[0]-a[0],e[1]-a[1],0];return e},mHelper:new A},Ee.prototype={initRenderable:function(){this.isInRange=!1,this.hidden=!1,this.isTransparent=!1,this.renderableComponents=[]},addRenderableComponent:function(e){-1===this.renderableComponents.indexOf(e)&&this.renderableComponents.push(e)},removeRenderableComponent:function(e){-1!==this.renderableComponents.indexOf(e)&&this.renderableComponents.splice(this.renderableComponents.indexOf(e),1)},prepareRenderableFrame:function(e){this.checkLayerLimits(e)},checkTransparency:function(){this.finalTransform.mProp.o.v<=0?!this.isTransparent&&this.globalData.renderConfig.hideOnTransparent&&(this.isTransparent=!0,this.hide()):this.isTransparent&&(this.isTransparent=!1,this.show())},checkLayerLimits:function(e){this.data.ip-this.data.st<=e&&this.data.op-this.data.st>e?!0!==this.isInRange&&(this.globalData._mdf=!0,this._mdf=!0,this.isInRange=!0,this.show()):!1!==this.isInRange&&(this.globalData._mdf=!0,this.isInRange=!1,this.hide())},renderRenderable:function(){var e,t=this.renderableComponents.length;for(e=0;e<t;e+=1)this.renderableComponents[e].renderFrame(this._isFirstFrame)},sourceRectAtTime:function(){return{top:0,left:0,width:100,height:100}},getLayerSize:function(){return 5===this.data.ty?{w:this.data.textData.width,h:this.data.textData.height}:{w:this.data.width,h:this.data.height}}},M([Ee,N({initElement:function(e,t,r){this.initFrame(),this.initBaseData(e,t,r),this.initTransform(e,t,r),this.initHierarchy(),this.initRenderable(),this.initRendererElement(),this.createContainerElements(),this.addMasks(),this.createContent(),this.hide()},hide:function(){this.hidden||this.isInRange&&!this.isTransparent||((this.baseElement||this.layerElement).style.display="none",this.hidden=!0)},show:function(){this.isInRange&&!this.isTransparent&&(this.data.hd||((this.baseElement||this.layerElement).style.display="block"),this.hidden=!1,this._isFirstFrame=!0)},renderFrame:function(){this.data.hd||this.hidden||(this.renderTransform(),this.renderRenderable(),this.renderElement(),this.renderInnerContent(),this._isFirstFrame&&(this._isFirstFrame=!1))},renderInnerContent:function(){},prepareFrame:function(e){this._mdf=!1,this.prepareRenderableFrame(e),this.prepareProperties(e,this.isInRange),this.checkTransparency()},destroy:function(){this.innerElem=null,this.destroyBaseElement()}})],Ce),Se.prototype.reset=function(){this.d="",this._mdf=!1},Ie.prototype.setAsAnimated=function(){this._isAnimated=!0},M([_],Pe),M([_],we),De.prototype.initGradientData=function(e,t,r){this.o=F.getProp(e,t.o,0,.01,this),this.s=F.getProp(e,t.s,1,null,this),this.e=F.getProp(e,t.e,1,null,this),this.h=F.getProp(e,t.h||{k:0},0,.01,this),this.a=F.getProp(e,t.a||{k:0},0,u,this),this.g=new X(e,t.g),this.style=r,this.stops=[],this.setGradientData(r.pElem,t),this.setGradientOpacity(t,r),this._isAnimated=!!this._isAnimated},De.prototype.setGradientData=function(e,t){var r="gr_"+T(10),n=w(1===t.t?"linearGradient":"radialGradient");n.setAttribute("id",r),n.setAttribute("spreadMethod","pad"),n.setAttribute("gradientUnits","userSpaceOnUse");var i,a,s,o=[];for(s=4*t.g.p,a=0;a<s;a+=4)i=w("stop"),n.appendChild(i),o.push(i);e.setAttribute("gf"===t.ty?"fill":"stroke","url(#"+r+")"),this.gf=n,this.cst=o},De.prototype.setGradientOpacity=function(e,t){if(this.g._hasOpacity&&!this.g._collapsable){var r,n,i,a=w("mask"),s=w("path");a.appendChild(s);var o="op_"+T(10),l="mk_"+T(10);a.setAttribute("id",l);var c=w(1===e.t?"linearGradient":"radialGradient");c.setAttribute("id",o),c.setAttribute("spreadMethod","pad"),c.setAttribute("gradientUnits","userSpaceOnUse"),i=e.g.k.k[0].s?e.g.k.k[0].s.length:e.g.k.k.length;var u=this.stops;for(n=4*e.g.p;n<i;n+=2)(r=w("stop")).setAttribute("stop-color","rgb(255,255,255)"),c.appendChild(r),u.push(r);s.setAttribute("gf"===e.ty?"fill":"stroke","url(#"+o+")"),this.of=c,this.ms=a,this.ost=u,this.maskId=l,t.msElem=s}},M([_],De),M([De,_],_e);var Re=function(){var e=new A,t=new A;function r(e,t,r){(r||t.transform.op._mdf)&&t.transform.container.setAttribute("opacity",t.transform.op.v),(r||t.transform.mProps._mdf)&&t.transform.container.setAttribute("transform",t.transform.mProps.v.to2dCSS())}function n(r,n,i){var a,s,o,l,c,u,h,f,d,p,m,g=n.styles.length,T=n.lvl;for(u=0;u<g;u+=1){if(l=n.sh._mdf||i,n.styles[u].lvl<T){for(f=t.reset(),p=T-n.styles[u].lvl,m=n.transformers.length-1;!l&&p>0;)l=n.transformers[m].mProps._mdf||l,p--,m--;if(l)for(p=T-n.styles[u].lvl,m=n.transformers.length-1;p>0;)d=n.transformers[m].mProps.v.props,f.transform(d[0],d[1],d[2],d[3],d[4],d[5],d[6],d[7],d[8],d[9],d[10],d[11],d[12],d[13],d[14],d[15]),p--,m--}else f=e;if(s=(h=n.sh.paths)._length,l){for(o="",a=0;a<s;a+=1)(c=h.shapes[a])&&c._length&&(o+=$(c,c._length,c.c,f));n.caches[u]=o}else o=n.caches[u];n.styles[u].d+=!0===r.hd?"":o,n.styles[u]._mdf=l||n.styles[u]._mdf}}function i(e,t,r){var n=t.style;(t.c._mdf||r)&&n.pElem.setAttribute("fill","rgb("+s(t.c.v[0])+","+s(t.c.v[1])+","+s(t.c.v[2])+")"),(t.o._mdf||r)&&n.pElem.setAttribute("fill-opacity",t.o.v)}function a(e,t,r){o(e,t,r),l(e,t,r)}function o(e,t,r){var n,i,a,s,o,l=t.gf,c=t.g._hasOpacity,u=t.s.v,h=t.e.v;if(t.o._mdf||r){var f="gf"===e.ty?"fill-opacity":"stroke-opacity";t.style.pElem.setAttribute(f,t.o.v)}if(t.s._mdf||r){var d=1===e.t?"x1":"cx",p="x1"===d?"y1":"cy";l.setAttribute(d,u[0]),l.setAttribute(p,u[1]),c&&!t.g._collapsable&&(t.of.setAttribute(d,u[0]),t.of.setAttribute(p,u[1]))}if(t.g._cmdf||r){n=t.cst;var m=t.g.c;for(a=n.length,i=0;i<a;i+=1)(s=n[i]).setAttribute("offset",m[4*i]+"%"),s.setAttribute("stop-color","rgb("+m[4*i+1]+","+m[4*i+2]+","+m[4*i+3]+")")}if(c&&(t.g._omdf||r)){var g=t.g.o;for(a=(n=t.g._collapsable?t.cst:t.ost).length,i=0;i<a;i+=1)s=n[i],t.g._collapsable||s.setAttribute("offset",g[2*i]+"%"),s.setAttribute("stop-opacity",g[2*i+1])}if(1===e.t)(t.e._mdf||r)&&(l.setAttribute("x2",h[0]),l.setAttribute("y2",h[1]),c&&!t.g._collapsable&&(t.of.setAttribute("x2",h[0]),t.of.setAttribute("y2",h[1])));else if((t.s._mdf||t.e._mdf||r)&&(o=Math.sqrt(Math.pow(u[0]-h[0],2)+Math.pow(u[1]-h[1],2)),l.setAttribute("r",o),c&&!t.g._collapsable&&t.of.setAttribute("r",o)),t.e._mdf||t.h._mdf||t.a._mdf||r){o||(o=Math.sqrt(Math.pow(u[0]-h[0],2)+Math.pow(u[1]-h[1],2)));var T=Math.atan2(h[1]-u[1],h[0]-u[0]),y=o*(t.h.v>=1?.99:t.h.v<=-1?-.99:t.h.v),v=Math.cos(T+t.a.v)*y+u[0],E=Math.sin(T+t.a.v)*y+u[1];l.setAttribute("fx",v),l.setAttribute("fy",E),c&&!t.g._collapsable&&(t.of.setAttribute("fx",v),t.of.setAttribute("fy",E))}}function l(e,t,r){var n=t.style,i=t.d;i&&(i._mdf||r)&&i.dashStr&&(n.pElem.setAttribute("stroke-dasharray",i.dashStr),n.pElem.setAttribute("stroke-dashoffset",i.dashoffset[0])),t.c&&(t.c._mdf||r)&&n.pElem.setAttribute("stroke","rgb("+s(t.c.v[0])+","+s(t.c.v[1])+","+s(t.c.v[2])+")"),(t.o._mdf||r)&&n.pElem.setAttribute("stroke-opacity",t.o.v),(t.w._mdf||r)&&(n.pElem.setAttribute("stroke-width",t.w.v),n.msElem&&n.msElem.setAttribute("stroke-width",t.w.v))}return{createRenderFunction:function(e){e.ty;switch(e.ty){case"fl":return i;case"gf":return o;case"gs":return a;case"st":return l;case"sh":case"el":case"rc":case"sr":return n;case"tr":return r}}}}();function Me(){}function Ne(e,t,r){this.initFrame(),this.initBaseData(e,t,r),this.initFrame(),this.initTransform(e,t,r),this.initHierarchy()}function ke(){}function Oe(){}function Le(){}function Fe(){}function Be(e,t,r){this.assetData=t.getAssetData(e.refId),this.initElement(e,t,r)}function Ve(e,t,r){this.initElement(e,t,r)}function Ue(e,t,r){this.layers=e.layers,this.supports3d=!0,this.completeLayers=!1,this.pendingElements=[],this.elements=this.layers?P(this.layers.length):[],this.initElement(e,t,r),this.tm=e.tm?F.getProp(this,e.tm,0,t.frameRate,this):{_placeholder:!0}}function He(e,t,r){this.textSpans=[],this.renderType="svg",this.initElement(e,t,r)}function ze(e,t,r){this.shapes=[],this.shapesData=e.shapes,this.stylesList=[],this.shapeModifiers=[],this.itemsData=[],this.processedElements=[],this.animatedContents=[],this.initElement(e,t,r),this.prevViewData=[]}function je(e,t){this.filterManager=t;var r=w("feColorMatrix");if(r.setAttribute("type","matrix"),r.setAttribute("color-interpolation-filters","linearRGB"),r.setAttribute("values","0.3333 0.3333 0.3333 0 0 0.3333 0.3333 0.3333 0 0 0.3333 0.3333 0.3333 0 0 0 0 0 1 0"),r.setAttribute("result","f1"),e.appendChild(r),(r=w("feColorMatrix")).setAttribute("type","matrix"),r.setAttribute("color-interpolation-filters","sRGB"),r.setAttribute("values","1 0 0 0 0 0 1 0 0 0 0 0 1 0 0 0 0 0 1 0"),r.setAttribute("result","f2"),e.appendChild(r),this.matrixFilter=r,100!==t.effectElements[2].p.v||t.effectElements[2].p.k){var n,i=w("feMerge");e.appendChild(i),(n=w("feMergeNode")).setAttribute("in","SourceGraphic"),i.appendChild(n),(n=w("feMergeNode")).setAttribute("in","f2"),i.appendChild(n)}}function qe(e,t){this.filterManager=t;var r=w("feColorMatrix");r.setAttribute("type","matrix"),r.setAttribute("color-interpolation-filters","sRGB"),r.setAttribute("values","1 0 0 0 0 0 1 0 0 0 0 0 1 0 0 0 0 0 1 0"),e.appendChild(r),this.matrixFilter=r}function Ge(e,t){this.initialized=!1,this.filterManager=t,this.elem=e,this.paths=[]}function We(e,t){this.filterManager=t;var r=w("feColorMatrix");r.setAttribute("type","matrix"),r.setAttribute("color-interpolation-filters","linearRGB"),r.setAttribute("values","0.3333 0.3333 0.3333 0 0 0.3333 0.3333 0.3333 0 0 0.3333 0.3333 0.3333 0 0 0 0 0 1 0"),r.setAttribute("result","f1"),e.appendChild(r);var n=w("feComponentTransfer");n.setAttribute("color-interpolation-filters","sRGB"),e.appendChild(n),this.matrixFilter=n;var i=w("feFuncR");i.setAttribute("type","table"),n.appendChild(i),this.feFuncR=i;var a=w("feFuncG");a.setAttribute("type","table"),n.appendChild(a),this.feFuncG=a;var s=w("feFuncB");s.setAttribute("type","table"),n.appendChild(s),this.feFuncB=s}function Ye(e,t){this.filterManager=t;var r=this.filterManager.effectElements,n=w("feComponentTransfer");(r[10].p.k||0!==r[10].p.v||r[11].p.k||1!==r[11].p.v||r[12].p.k||1!==r[12].p.v||r[13].p.k||0!==r[13].p.v||r[14].p.k||1!==r[14].p.v)&&(this.feFuncR=this.createFeFunc("feFuncR",n)),(r[17].p.k||0!==r[17].p.v||r[18].p.k||1!==r[18].p.v||r[19].p.k||1!==r[19].p.v||r[20].p.k||0!==r[20].p.v||r[21].p.k||1!==r[21].p.v)&&(this.feFuncG=this.createFeFunc("feFuncG",n)),(r[24].p.k||0!==r[24].p.v||r[25].p.k||1!==r[25].p.v||r[26].p.k||1!==r[26].p.v||r[27].p.k||0!==r[27].p.v||r[28].p.k||1!==r[28].p.v)&&(this.feFuncB=this.createFeFunc("feFuncB",n)),(r[31].p.k||0!==r[31].p.v||r[32].p.k||1!==r[32].p.v||r[33].p.k||1!==r[33].p.v||r[34].p.k||0!==r[34].p.v||r[35].p.k||1!==r[35].p.v)&&(this.feFuncA=this.createFeFunc("feFuncA",n)),(this.feFuncR||this.feFuncG||this.feFuncB||this.feFuncA)&&(n.setAttribute("color-interpolation-filters","sRGB"),e.appendChild(n),n=w("feComponentTransfer")),(r[3].p.k||0!==r[3].p.v||r[4].p.k||1!==r[4].p.v||r[5].p.k||1!==r[5].p.v||r[6].p.k||0!==r[6].p.v||r[7].p.k||1!==r[7].p.v)&&(n.setAttribute("color-interpolation-filters","sRGB"),e.appendChild(n),this.feFuncRComposed=this.createFeFunc("feFuncR",n),this.feFuncGComposed=this.createFeFunc("feFuncG",n),this.feFuncBComposed=this.createFeFunc("feFuncB",n))}function Ke(e,t){e.setAttribute("x","-100%"),e.setAttribute("y","-100%"),e.setAttribute("width","400%"),e.setAttribute("height","400%"),this.filterManager=t;var r=w("feGaussianBlur");r.setAttribute("in","SourceAlpha"),r.setAttribute("result","drop_shadow_1"),r.setAttribute("stdDeviation","0"),this.feGaussianBlur=r,e.appendChild(r);var n=w("feOffset");n.setAttribute("dx","25"),n.setAttribute("dy","0"),n.setAttribute("in","drop_shadow_1"),n.setAttribute("result","drop_shadow_2"),this.feOffset=n,e.appendChild(n);var i=w("feFlood");i.setAttribute("flood-color","#00ff00"),i.setAttribute("flood-opacity","1"),i.setAttribute("result","drop_shadow_3"),this.feFlood=i,e.appendChild(i);var a=w("feComposite");a.setAttribute("in","drop_shadow_3"),a.setAttribute("in2","drop_shadow_2"),a.setAttribute("operator","in"),a.setAttribute("result","drop_shadow_4"),e.appendChild(a);var s,o=w("feMerge");e.appendChild(o),s=w("feMergeNode"),o.appendChild(s),(s=w("feMergeNode")).setAttribute("in","SourceGraphic"),this.feMergeNode=s,this.feMerge=o,this.originalNodeAdded=!1,o.appendChild(s)}Me.prototype={checkMasks:function(){if(!this.data.hasMask)return!1;for(var e=0,t=this.data.masksProperties.length;e<t;){if("n"!==this.data.masksProperties[e].mode&&!1!==this.data.masksProperties[e].cl)return!0;e+=1}return!1},initExpressions:function(){this.layerInterface=LayerExpressionInterface(this),this.data.hasMask&&this.maskManager&&this.layerInterface.registerMaskInterface(this.maskManager);var e=EffectsExpressionInterface.createEffectsInterface(this,this.layerInterface);this.layerInterface.registerEffectsInterface(e),0===this.data.ty||this.data.xt?this.compInterface=CompExpressionInterface(this):4===this.data.ty?(this.layerInterface.shapeInterface=ShapeExpressionInterface(this.shapesData,this.itemsData,this.layerInterface),this.layerInterface.content=this.layerInterface.shapeInterface):5===this.data.ty&&(this.layerInterface.textInterface=TextExpressionInterface(this),this.layerInterface.text=this.layerInterface.textInterface)},blendModeEnums:{1:"multiply",2:"screen",3:"overlay",4:"darken",5:"lighten",6:"color-dodge",7:"color-burn",8:"hard-light",9:"soft-light",10:"difference",11:"exclusion",12:"hue",13:"saturation",14:"color",15:"luminosity"},getBlendMode:function(){return this.blendModeEnums[this.data.bm]||""},setBlendMode:function(){var e=this.getBlendMode();(this.baseElement||this.layerElement).style["mix-blend-mode"]=e},initBaseData:function(e,t,r){this.globalData=t,this.comp=r,this.data=e,this.layerId="ly_"+T(10),this.data.sr||(this.data.sr=1),this.effectsManager=new tt(this.data,this,this.dynamicProperties)},getType:function(){return this.type}},Ne.prototype.prepareFrame=function(e){this.prepareProperties(e,!0)},Ne.prototype.renderFrame=function(){},Ne.prototype.getBaseElement=function(){return null},Ne.prototype.destroy=function(){},Ne.prototype.sourceRectAtTime=function(){},Ne.prototype.hide=function(){},M([Me,ve,Te,ye],Ne),ke.prototype={initRendererElement:function(){this.layerElement=w("g")},createContainerElements:function(){this.matteElement=w("g"),this.transformedElement=this.layerElement,this.maskedElement=this.layerElement,this._sizeChanged=!1;var e,t,n,i=null;if(this.data.td){if(3==this.data.td||1==this.data.td){var a=w("mask");a.setAttribute("id",this.layerId),a.setAttribute("mask-type",3==this.data.td?"luminance":"alpha"),a.appendChild(this.layerElement),i=a,this.globalData.defs.appendChild(a),J.maskType||1!=this.data.td||(a.setAttribute("mask-type","luminance"),e=T(10),t=ee.createFilter(e),this.globalData.defs.appendChild(t),t.appendChild(ee.createAlphaToLuminanceFilter()),(n=w("g")).appendChild(this.layerElement),i=n,a.appendChild(n),n.setAttribute("filter","url("+r+"#"+e+")"))}else if(2==this.data.td){var s=w("mask");s.setAttribute("id",this.layerId),s.setAttribute("mask-type","alpha");var o=w("g");s.appendChild(o),e=T(10),t=ee.createFilter(e);var l=w("feColorMatrix");l.setAttribute("type","matrix"),l.setAttribute("color-interpolation-filters","sRGB"),l.setAttribute("values","1 0 0 0 0 0 1 0 0 0 0 0 1 0 0 0 0 0 -1 1"),t.appendChild(l),this.globalData.defs.appendChild(t);var c=w("rect");c.setAttribute("width",this.comp.data.w),c.setAttribute("height",this.comp.data.h),c.setAttribute("x","0"),c.setAttribute("y","0"),c.setAttribute("fill","#ffffff"),c.setAttribute("opacity","0"),o.setAttribute("filter","url("+r+"#"+e+")"),o.appendChild(c),o.appendChild(this.layerElement),i=o,J.maskType||(s.setAttribute("mask-type","luminance"),t.appendChild(ee.createAlphaToLuminanceFilter()),n=w("g"),o.appendChild(c),n.appendChild(this.layerElement),i=n,o.appendChild(n)),this.globalData.defs.appendChild(s)}}else this.data.tt?(this.matteElement.appendChild(this.layerElement),i=this.matteElement,this.baseElement=this.matteElement):this.baseElement=this.layerElement;if(this.data.ln&&this.layerElement.setAttribute("id",this.data.ln),this.data.cl&&this.layerElement.setAttribute("class",this.data.cl),0===this.data.ty&&!this.data.hd){var u=w("clipPath"),h=w("path");h.setAttribute("d","M0,0 L"+this.data.w+",0 L"+this.data.w+","+this.data.h+" L0,"+this.data.h+"z");var f="cp_"+T(8);if(u.setAttribute("id",f),u.appendChild(h),this.globalData.defs.appendChild(u),this.checkMasks()){var d=w("g");d.setAttribute("clip-path","url("+r+"#"+f+")"),d.appendChild(this.layerElement),this.transformedElement=d,i?i.appendChild(this.transformedElement):this.baseElement=this.transformedElement}else this.layerElement.setAttribute("clip-path","url("+r+"#"+f+")")}0!==this.data.bm&&this.setBlendMode(),this.renderableEffectsManager=new Ze(this)},renderElement:function(){this.finalTransform._matMdf&&this.transformedElement.setAttribute("transform",this.finalTransform.mat.to2dCSS()),this.finalTransform._opMdf&&this.transformedElement.setAttribute("opacity",this.finalTransform.mProp.o.v)},destroyBaseElement:function(){this.layerElement=null,this.matteElement=null,this.maskManager.destroy()},getBaseElement:function(){return this.data.hd?null:this.baseElement},addMasks:function(){this.maskManager=new ge(this.data,this,this.globalData)},setMatte:function(e){this.matteElement&&this.matteElement.setAttribute("mask","url("+r+"#"+e+")")}},Oe.prototype={addShapeToModifiers:function(e){var t,r=this.shapeModifiers.length;for(t=0;t<r;t+=1)this.shapeModifiers[t].addShape(e)},isShapeInAnimatedModifiers:function(e){for(var t=this.shapeModifiers.length;0<t;)if(this.shapeModifiers[0].isAnimatedWithShape(e))return!0;return!1},renderModifiers:function(){if(this.shapeModifiers.length){var e,t=this.shapes.length;for(e=0;e<t;e+=1)this.shapes[e].sh.reset();for(e=(t=this.shapeModifiers.length)-1;e>=0;e-=1)this.shapeModifiers[e].processShapes(this._isFirstFrame)}},lcEnum:{1:"butt",2:"round",3:"square"},ljEnum:{1:"miter",2:"round",3:"bevel"},searchProcessedElement:function(e){for(var t=this.processedElements,r=0,n=t.length;r<n;){if(t[r].elem===e)return t[r].pos;r+=1}return 0},addProcessedElement:function(e,t){for(var r=this.processedElements,n=r.length;n;)if(r[n-=1].elem===e)return void(r[n].pos=t);r.push(new be(e,t))},prepareFrame:function(e){this.prepareRenderableFrame(e),this.prepareProperties(e,this.isInRange)}},Le.prototype.initElement=function(e,t,r){this.lettersChangedFlag=!0,this.initFrame(),this.initBaseData(e,t,r),this.textProperty=new ae(this,e.t,this.dynamicProperties),this.textAnimator=new re(e.t,this.renderType,this),this.initTransform(e,t,r),this.initHierarchy(),this.initRenderable(),this.initRendererElement(),this.createContainerElements(),this.addMasks(),this.createContent(),this.hide(),this.textAnimator.searchProperties(this.dynamicProperties)},Le.prototype.prepareFrame=function(e){this._mdf=!1,this.prepareRenderableFrame(e),this.prepareProperties(e,this.isInRange),(this.textProperty._mdf||this.textProperty._isFirstFrame)&&(this.buildNewText(),this.textProperty._isFirstFrame=!1,this.textProperty._mdf=!1)},Le.prototype.createPathShape=function(e,t){var r,n,i=t.length,a="";for(r=0;r<i;r+=1)n=t[r].ks.k,a+=$(n,n.i.length,!0,e);return a},Le.prototype.updateDocumentData=function(e,t){this.textProperty.updateDocumentData(e,t)},Le.prototype.canResizeFont=function(e){this.textProperty.canResizeFont(e)},Le.prototype.setMinimumFontSize=function(e){this.textProperty.setMinimumFontSize(e)},Le.prototype.applyTextPropertiesToMatrix=function(e,t,r,n,i){switch(e.ps&&t.translate(e.ps[0],e.ps[1]+e.ascent,0),t.translate(0,-e.ls,0),e.j){case 1:t.translate(e.justifyOffset+(e.boxWidth-e.lineWidths[r]),0,0);break;case 2:t.translate(e.justifyOffset+(e.boxWidth-e.lineWidths[r])/2,0,0)}t.translate(n,i,0)},Le.prototype.buildColor=function(e){return"rgb("+Math.round(255*e[0])+","+Math.round(255*e[1])+","+Math.round(255*e[2])+")"},Le.prototype.emptyProp=new ie,Le.prototype.destroy=function(){},M([Me,ve,Te,ye,Ce],Fe),Fe.prototype.initElement=function(e,t,r){this.initFrame(),this.initBaseData(e,t,r),this.initTransform(e,t,r),this.initRenderable(),this.initHierarchy(),this.initRendererElement(),this.createContainerElements(),this.addMasks(),!this.data.xt&&t.progressiveLoad||this.buildAllItems(),this.hide()},Fe.prototype.prepareFrame=function(e){if(this._mdf=!1,this.prepareRenderableFrame(e),this.prepareProperties(e,this.isInRange),this.isInRange||this.data.xt){if(this.tm._placeholder)this.renderedFrame=e/this.data.sr;else{var t=this.tm.v;t===this.data.op&&(t=this.data.op-1),this.renderedFrame=t}var r,n=this.elements.length;for(this.completeLayers||this.checkLayers(this.renderedFrame),r=n-1;r>=0;r-=1)(this.completeLayers||this.elements[r])&&(this.elements[r].prepareFrame(this.renderedFrame-this.layers[r].st),this.elements[r]._mdf&&(this._mdf=!0))}},Fe.prototype.renderInnerContent=function(){var e,t=this.layers.length;for(e=0;e<t;e+=1)(this.completeLayers||this.elements[e])&&this.elements[e].renderFrame()},Fe.prototype.setElements=function(e){this.elements=e},Fe.prototype.getElements=function(){return this.elements},Fe.prototype.destroyElements=function(){var e,t=this.layers.length;for(e=0;e<t;e+=1)this.elements[e]&&this.elements[e].destroy()},Fe.prototype.destroy=function(){this.destroyElements(),this.destroyBaseElement()},M([Me,ve,ke,Te,ye,Ce],Be),Be.prototype.createContent=function(){var e=this.globalData.getAssetsPath(this.assetData);this.innerElem=w("image"),this.innerElem.setAttribute("width",this.assetData.w+"px"),this.innerElem.setAttribute("height",this.assetData.h+"px"),this.innerElem.setAttribute("preserveAspectRatio",this.assetData.pr||this.globalData.renderConfig.imagePreserveAspectRatio),this.innerElem.setAttributeNS("http://www.w3.org/1999/xlink","href",e),this.layerElement.appendChild(this.innerElem)},M([Be],Ve),Ve.prototype.createContent=function(){var e=w("rect");e.setAttribute("width",this.data.sw),e.setAttribute("height",this.data.sh),e.setAttribute("fill",this.data.sc),this.layerElement.appendChild(e)},M([me,Fe,ke],Ue),M([Me,ve,ke,Te,ye,Ce,Le],He),He.prototype.createContent=function(){this.data.singleShape&&!this.globalData.fontManager.chars&&(this.textContainer=w("text"))},He.prototype.buildTextContents=function(e){for(var t=0,r=e.length,n=[],i="";t<r;)e[t]===String.fromCharCode(13)?(n.push(i),i=""):i+=e[t],t+=1;return n.push(i),n},He.prototype.buildNewText=function(){var e,t,r=this.textProperty.currentData;this.renderedLetters=P(r?r.l.length:0),r.fc?this.layerElement.setAttribute("fill",this.buildColor(r.fc)):this.layerElement.setAttribute("fill","rgba(0,0,0,0)"),r.sc&&(this.layerElement.setAttribute("stroke",this.buildColor(r.sc)),this.layerElement.setAttribute("stroke-width",r.sw)),this.layerElement.setAttribute("font-size",r.finalSize);var n=this.globalData.fontManager.getFontByName(r.f);if(n.fClass)this.layerElement.setAttribute("class",n.fClass);else{this.layerElement.setAttribute("font-family",n.fFamily);var i=r.fWeight,a=r.fStyle;this.layerElement.setAttribute("font-style",a),this.layerElement.setAttribute("font-weight",i)}var s,o=r.l||[],l=this.globalData.fontManager.chars;t=o.length;var c,u=this.mHelper,h="",f=this.data.singleShape,d=0,p=0,m=!0,g=r.tr/1e3*r.finalSize;if(!f||l||r.sz){var T,y,v=this.textSpans.length;for(e=0;e<t;e+=1)l&&f&&0!==e||(s=v>e?this.textSpans[e]:w(l?"path":"text"),v<=e&&(s.setAttribute("stroke-linecap","butt"),s.setAttribute("stroke-linejoin","round"),s.setAttribute("stroke-miterlimit","4"),this.textSpans[e]=s,this.layerElement.appendChild(s)),s.style.display="inherit"),u.reset(),u.scale(r.finalSize/100,r.finalSize/100),f&&(o[e].n&&(d=-g,p+=r.yOffset,p+=m?1:0,m=!1),this.applyTextPropertiesToMatrix(r,u,o[e].line,d,p),d+=o[e].l||0,d+=g),l?(c=(T=(y=this.globalData.fontManager.getCharData(r.finalText[e],n.fStyle,this.globalData.fontManager.getFontByName(r.f).fFamily))&&y.data||{}).shapes?T.shapes[0].it:[],f?h+=this.createPathShape(u,c):s.setAttribute("d",this.createPathShape(u,c))):(f&&s.setAttribute("transform","translate("+u.props[12]+","+u.props[13]+")"),s.textContent=o[e].val,s.setAttributeNS("http://www.w3.org/XML/1998/namespace","xml:space","preserve"));f&&s&&s.setAttribute("d",h)}else{var E=this.textContainer,C="start";switch(r.j){case 1:C="end";break;case 2:C="middle"}E.setAttribute("text-anchor",C),E.setAttribute("letter-spacing",g);var b=this.buildTextContents(r.finalText);for(t=b.length,p=r.ps?r.ps[1]+r.ascent:0,e=0;e<t;e+=1)(s=this.textSpans[e]||w("tspan")).textContent=b[e],s.setAttribute("x",0),s.setAttribute("y",p),s.style.display="inherit",E.appendChild(s),this.textSpans[e]=s,p+=r.finalLineHeight;this.layerElement.appendChild(E)}for(;e<this.textSpans.length;)this.textSpans[e].style.display="none",e+=1;this._sizeChanged=!0},He.prototype.sourceRectAtTime=function(e){if(this.prepareFrame(this.comp.renderedFrame-this.data.st),this.renderInnerContent(),this._sizeChanged){this._sizeChanged=!1;var t=this.layerElement.getBBox();this.bbox={top:t.y,left:t.x,width:t.width,height:t.height}}return this.bbox},He.prototype.renderInnerContent=function(){if(!this.data.singleShape&&(this.textAnimator.getMeasures(this.textProperty.currentData,this.lettersChangedFlag),this.lettersChangedFlag||this.textAnimator.lettersChangedFlag)){var e,t;this._sizeChanged=!0;var r,n,i=this.textAnimator.renderedLetters,a=this.textProperty.currentData.l;for(t=a.length,e=0;e<t;e+=1)a[e].n||(r=i[e],n=this.textSpans[e],r._mdf.m&&n.setAttribute("transform",r.m),r._mdf.o&&n.setAttribute("opacity",r.o),r._mdf.sw&&n.setAttribute("stroke-width",r.sw),r._mdf.sc&&n.setAttribute("stroke",r.sc),r._mdf.fc&&n.setAttribute("fill",r.fc))}},M([Me,ve,ke,Oe,Te,ye,Ce],ze),ze.prototype.initSecondaryElement=function(){},ze.prototype.identityMatrix=new A,ze.prototype.buildExpressionInterface=function(){},ze.prototype.createContent=function(){this.searchShapes(this.shapesData,this.itemsData,this.prevViewData,this.layerElement,0,[],!0),this.filterUniqueShapes()},ze.prototype.filterUniqueShapes=function(){var e,t,r,n,i=this.shapes.length,a=this.stylesList.length,s=[],o=!1;for(r=0;r<a;r+=1){for(n=this.stylesList[r],o=!1,s.length=0,e=0;e<i;e+=1)-1!==(t=this.shapes[e]).styles.indexOf(n)&&(s.push(t),o=t._isAnimated||o);s.length>1&&o&&this.setShapesAsAnimated(s)}},ze.prototype.setShapesAsAnimated=function(e){var t,r=e.length;for(t=0;t<r;t+=1)e[t].setAsAnimated()},ze.prototype.createStyleElement=function(e,t){var r,n=new Se(e,t),i=n.pElem;if("st"===e.ty)r=new Pe(this,e,n);else if("fl"===e.ty)r=new we(this,e,n);else if("gf"===e.ty||"gs"===e.ty){r=new("gf"===e.ty?De:_e)(this,e,n),this.globalData.defs.appendChild(r.gf),r.maskId&&(this.globalData.defs.appendChild(r.ms),this.globalData.defs.appendChild(r.of),i.setAttribute("mask","url(#"+r.maskId+")"))}return"st"!==e.ty&&"gs"!==e.ty||(i.setAttribute("stroke-linecap",this.lcEnum[e.lc]||"round"),i.setAttribute("stroke-linejoin",this.ljEnum[e.lj]||"round"),i.setAttribute("fill-opacity","0"),1===e.lj&&i.setAttribute("stroke-miterlimit",e.ml)),2===e.r&&i.setAttribute("fill-rule","evenodd"),e.ln&&i.setAttribute("id",e.ln),e.cl&&i.setAttribute("class",e.cl),this.stylesList.push(n),this.addToAnimatedContents(e,r),r},ze.prototype.createGroupElement=function(e){var t=new Ae;return e.ln&&t.gr.setAttribute("id",e.ln),t},ze.prototype.createTransformElement=function(e,t){var r=B.getTransformProperty(this,e,this),n=new xe(r,r.o,t);return this.addToAnimatedContents(e,n),n},ze.prototype.createShapeElement=function(e,t,r){var n=4;"rc"===e.ty?n=5:"el"===e.ty?n=6:"sr"===e.ty&&(n=7);var i=new Ie(t,r,U.getShapeProp(this,e,n,this));return this.shapes.push(i),this.addShapeToModifiers(i),this.addToAnimatedContents(e,i),i},ze.prototype.addToAnimatedContents=function(e,t){for(var r=0,n=this.animatedContents.length;r<n;){if(this.animatedContents[r].element===t)return;r+=1}this.animatedContents.push({fn:Re.createRenderFunction(e),element:t,data:e})},ze.prototype.setElementStyles=function(e){var t,r=e.styles,n=this.stylesList.length;for(t=0;t<n;t+=1)this.stylesList[t].closed||r.push(this.stylesList[t])},ze.prototype.reloadShapes=function(){this._isFirstFrame=!0;var e,t=this.itemsData.length;for(e=0;e<t;e+=1)this.prevViewData[e]=this.itemsData[e];for(this.searchShapes(this.shapesData,this.itemsData,this.prevViewData,this.layerElement,0,[],!0),this.filterUniqueShapes(),t=this.dynamicProperties.length,e=0;e<t;e+=1)this.dynamicProperties[e].getValue();this.renderModifiers()},ze.prototype.searchShapes=function(e,t,r,n,i,a,s){var o,l,c,u,h,f,d=[].concat(a),p=e.length-1,m=[],g=[];for(o=p;o>=0;o-=1){if((f=this.searchProcessedElement(e[o]))?t[o]=r[f-1]:e[o]._render=s,"fl"==e[o].ty||"st"==e[o].ty||"gf"==e[o].ty||"gs"==e[o].ty)f?t[o].style.closed=!1:t[o]=this.createStyleElement(e[o],i),e[o]._render&&n.appendChild(t[o].style.pElem),m.push(t[o].style);else if("gr"==e[o].ty){if(f)for(c=t[o].it.length,l=0;l<c;l+=1)t[o].prevViewData[l]=t[o].it[l];else t[o]=this.createGroupElement(e[o]);this.searchShapes(e[o].it,t[o].it,t[o].prevViewData,t[o].gr,i+1,d,s),e[o]._render&&n.appendChild(t[o].gr)}else"tr"==e[o].ty?(f||(t[o]=this.createTransformElement(e[o],n)),u=t[o].transform,d.push(u)):"sh"==e[o].ty||"rc"==e[o].ty||"el"==e[o].ty||"sr"==e[o].ty?(f||(t[o]=this.createShapeElement(e[o],d,i)),this.setElementStyles(t[o])):"tm"==e[o].ty||"rd"==e[o].ty||"ms"==e[o].ty?(f?(h=t[o]).closed=!1:((h=H.getModifier(e[o].ty)).init(this,e[o]),t[o]=h,this.shapeModifiers.push(h)),g.push(h)):"rp"==e[o].ty&&(f?(h=t[o]).closed=!0:(h=H.getModifier(e[o].ty),t[o]=h,h.init(this,e,o,t),this.shapeModifiers.push(h),s=!1),g.push(h));this.addProcessedElement(e[o],o+1)}for(p=m.length,o=0;o<p;o+=1)m[o].closed=!0;for(p=g.length,o=0;o<p;o+=1)g[o].closed=!0},ze.prototype.renderInnerContent=function(){this.renderModifiers();var e,t=this.stylesList.length;for(e=0;e<t;e+=1)this.stylesList[e].reset();for(this.renderShape(),e=0;e<t;e+=1)(this.stylesList[e]._mdf||this._isFirstFrame)&&(this.stylesList[e].msElem&&(this.stylesList[e].msElem.setAttribute("d",this.stylesList[e].d),this.stylesList[e].d="M0 0"+this.stylesList[e].d),this.stylesList[e].pElem.setAttribute("d",this.stylesList[e].d||"M0 0"))},ze.prototype.renderShape=function(){var e,t,r=this.animatedContents.length;for(e=0;e<r;e+=1)t=this.animatedContents[e],(this._isFirstFrame||t.element._isAnimated)&&!0!==t.data&&t.fn(t.data,t.element,this._isFirstFrame)},ze.prototype.destroy=function(){this.destroyBaseElement(),this.shapesData=null,this.itemsData=null},je.prototype.renderFrame=function(e){if(e||this.filterManager._mdf){var t=this.filterManager.effectElements[0].p.v,r=this.filterManager.effectElements[1].p.v,n=this.filterManager.effectElements[2].p.v/100;this.matrixFilter.setAttribute("values",r[0]-t[0]+" 0 0 0 "+t[0]+" "+(r[1]-t[1])+" 0 0 0 "+t[1]+" "+(r[2]-t[2])+" 0 0 0 "+t[2]+" 0 0 0 "+n+" 0")}},qe.prototype.renderFrame=function(e){if(e||this.filterManager._mdf){var t=this.filterManager.effectElements[2].p.v,r=this.filterManager.effectElements[6].p.v;this.matrixFilter.setAttribute("values","0 0 0 0 "+t[0]+" 0 0 0 0 "+t[1]+" 0 0 0 0 "+t[2]+" 0 0 0 "+r+" 0")}},Ge.prototype.initialize=function(){var e,t,n,i,a=this.elem.layerElement.children||this.elem.layerElement.childNodes;for(1===this.filterManager.effectElements[1].p.v?(i=this.elem.maskManager.masksProperties.length,n=0):i=(n=this.filterManager.effectElements[0].p.v-1)+1,(t=w("g")).setAttribute("fill","none"),t.setAttribute("stroke-linecap","round"),t.setAttribute("stroke-dashoffset",1);n<i;n+=1)e=w("path"),t.appendChild(e),this.paths.push({p:e,m:n});if(3===this.filterManager.effectElements[10].p.v){var s=w("mask"),o="stms_"+T(10);s.setAttribute("id",o),s.setAttribute("mask-type","alpha"),s.appendChild(t),this.elem.globalData.defs.appendChild(s);var l=w("g");l.setAttribute("mask","url("+r+"#"+o+")"),a[0]&&l.appendChild(a[0]),this.elem.layerElement.appendChild(l),this.masker=s,t.setAttribute("stroke","#fff")}else if(1===this.filterManager.effectElements[10].p.v||2===this.filterManager.effectElements[10].p.v){if(2===this.filterManager.effectElements[10].p.v)for(a=this.elem.layerElement.children||this.elem.layerElement.childNodes;a.length;)this.elem.layerElement.removeChild(a[0]);this.elem.layerElement.appendChild(t),this.elem.layerElement.removeAttribute("mask"),t.setAttribute("stroke","#fff")}this.initialized=!0,this.pathMasker=t},Ge.prototype.renderFrame=function(e){this.initialized||this.initialize();var t,r,n,i=this.paths.length;for(t=0;t<i;t+=1)if(-1!==this.paths[t].m&&(r=this.elem.maskManager.viewData[this.paths[t].m],n=this.paths[t].p,(e||this.filterManager._mdf||r.prop._mdf)&&n.setAttribute("d",r.lastPath),e||this.filterManager.effectElements[9].p._mdf||this.filterManager.effectElements[4].p._mdf||this.filterManager.effectElements[7].p._mdf||this.filterManager.effectElements[8].p._mdf||r.prop._mdf)){var a;if(0!==this.filterManager.effectElements[7].p.v||100!==this.filterManager.effectElements[8].p.v){var o=Math.min(this.filterManager.effectElements[7].p.v,this.filterManager.effectElements[8].p.v)/100,l=Math.max(this.filterManager.effectElements[7].p.v,this.filterManager.effectElements[8].p.v)/100,c=n.getTotalLength();a="0 0 0 "+c*o+" ";var u,h=c*(l-o),f=1+2*this.filterManager.effectElements[4].p.v*this.filterManager.effectElements[9].p.v/100,d=Math.floor(h/f);for(u=0;u<d;u+=1)a+="1 "+2*this.filterManager.effectElements[4].p.v*this.filterManager.effectElements[9].p.v/100+" ";a+="0 "+10*c+" 0 0"}else a="1 "+2*this.filterManager.effectElements[4].p.v*this.filterManager.effectElements[9].p.v/100;n.setAttribute("stroke-dasharray",a)}if((e||this.filterManager.effectElements[4].p._mdf)&&this.pathMasker.setAttribute("stroke-width",2*this.filterManager.effectElements[4].p.v),(e||this.filterManager.effectElements[6].p._mdf)&&this.pathMasker.setAttribute("opacity",this.filterManager.effectElements[6].p.v),(1===this.filterManager.effectElements[10].p.v||2===this.filterManager.effectElements[10].p.v)&&(e||this.filterManager.effectElements[3].p._mdf)){var p=this.filterManager.effectElements[3].p.v;this.pathMasker.setAttribute("stroke","rgb("+s(255*p[0])+","+s(255*p[1])+","+s(255*p[2])+")")}},We.prototype.renderFrame=function(e){if(e||this.filterManager._mdf){var t=this.filterManager.effectElements[0].p.v,r=this.filterManager.effectElements[1].p.v,n=this.filterManager.effectElements[2].p.v,i=n[0]+" "+r[0]+" "+t[0],a=n[1]+" "+r[1]+" "+t[1],s=n[2]+" "+r[2]+" "+t[2];this.feFuncR.setAttribute("tableValues",i),this.feFuncG.setAttribute("tableValues",a),this.feFuncB.setAttribute("tableValues",s)}},Ye.prototype.createFeFunc=function(e,t){var r=w(e);return r.setAttribute("type","table"),t.appendChild(r),r},Ye.prototype.getTableValue=function(e,t,r,n,i){for(var a,s,o=0,l=Math.min(e,t),c=Math.max(e,t),u=Array.call(null,{length:256}),h=0,f=i-n,d=t-e;o<=256;)s=(a=o/256)<=l?d<0?i:n:a>=c?d<0?n:i:n+f*Math.pow((a-e)/d,1/r),u[h++]=s,o+=256/255;return u.join(" ")},Ye.prototype.renderFrame=function(e){if(e||this.filterManager._mdf){var t,r=this.filterManager.effectElements;this.feFuncRComposed&&(e||r[3].p._mdf||r[4].p._mdf||r[5].p._mdf||r[6].p._mdf||r[7].p._mdf)&&(t=this.getTableValue(r[3].p.v,r[4].p.v,r[5].p.v,r[6].p.v,r[7].p.v),this.feFuncRComposed.setAttribute("tableValues",t),this.feFuncGComposed.setAttribute("tableValues",t),this.feFuncBComposed.setAttribute("tableValues",t)),this.feFuncR&&(e||r[10].p._mdf||r[11].p._mdf||r[12].p._mdf||r[13].p._mdf||r[14].p._mdf)&&(t=this.getTableValue(r[10].p.v,r[11].p.v,r[12].p.v,r[13].p.v,r[14].p.v),this.feFuncR.setAttribute("tableValues",t)),this.feFuncG&&(e||r[17].p._mdf||r[18].p._mdf||r[19].p._mdf||r[20].p._mdf||r[21].p._mdf)&&(t=this.getTableValue(r[17].p.v,r[18].p.v,r[19].p.v,r[20].p.v,r[21].p.v),this.feFuncG.setAttribute("tableValues",t)),this.feFuncB&&(e||r[24].p._mdf||r[25].p._mdf||r[26].p._mdf||r[27].p._mdf||r[28].p._mdf)&&(t=this.getTableValue(r[24].p.v,r[25].p.v,r[26].p.v,r[27].p.v,r[28].p.v),this.feFuncB.setAttribute("tableValues",t)),this.feFuncA&&(e||r[31].p._mdf||r[32].p._mdf||r[33].p._mdf||r[34].p._mdf||r[35].p._mdf)&&(t=this.getTableValue(r[31].p.v,r[32].p.v,r[33].p.v,r[34].p.v,r[35].p.v),this.feFuncA.setAttribute("tableValues",t))}},Ke.prototype.renderFrame=function(e){if(e||this.filterManager._mdf){if((e||this.filterManager.effectElements[4].p._mdf)&&this.feGaussianBlur.setAttribute("stdDeviation",this.filterManager.effectElements[4].p.v/4),e||this.filterManager.effectElements[0].p._mdf){var t=this.filterManager.effectElements[0].p.v;this.feFlood.setAttribute("flood-color",S(Math.round(255*t[0]),Math.round(255*t[1]),Math.round(255*t[2])))}if((e||this.filterManager.effectElements[1].p._mdf)&&this.feFlood.setAttribute("flood-opacity",this.filterManager.effectElements[1].p.v/255),e||this.filterManager.effectElements[2].p._mdf||this.filterManager.effectElements[3].p._mdf){var r=this.filterManager.effectElements[3].p.v,n=(this.filterManager.effectElements[2].p.v-90)*u,i=r*Math.cos(n),a=r*Math.sin(n);this.feOffset.setAttribute("dx",i),this.feOffset.setAttribute("dy",a)}}};var Qe=[],Xe=0;function $e(e,t,r){this.initialized=!1,this.filterManager=t,this.filterElem=e,this.elem=r,r.matteElement=w("g"),r.matteElement.appendChild(r.layerElement),r.matteElement.appendChild(r.transformedElement),r.baseElement=r.matteElement}function Ze(e){var t,n,i=e.data.ef?e.data.ef.length:0,a=T(10),s=ee.createFilter(a),o=0;for(this.filters=[],t=0;t<i;t+=1)n=null,20===e.data.ef[t].ty?(o+=1,n=new je(s,e.effectsManager.effectElements[t])):21===e.data.ef[t].ty?(o+=1,n=new qe(s,e.effectsManager.effectElements[t])):22===e.data.ef[t].ty?n=new Ge(e,e.effectsManager.effectElements[t]):23===e.data.ef[t].ty?(o+=1,n=new We(s,e.effectsManager.effectElements[t])):24===e.data.ef[t].ty?(o+=1,n=new Ye(s,e.effectsManager.effectElements[t])):25===e.data.ef[t].ty?(o+=1,n=new Ke(s,e.effectsManager.effectElements[t])):28===e.data.ef[t].ty&&(n=new $e(s,e.effectsManager.effectElements[t],e)),n&&this.filters.push(n);o&&(e.globalData.defs.appendChild(s),e.layerElement.setAttribute("filter","url("+r+"#"+a+")")),this.filters.length&&e.addRenderableComponent(this)}$e.prototype.findSymbol=function(e){for(var t=0,r=Qe.length;t<r;){if(Qe[t]===e)return Qe[t];t+=1}return null},$e.prototype.replaceInParent=function(e,t){var r=e.layerElement.parentNode;if(r){for(var n,i=r.children,a=0,s=i.length;a<s&&i[a]!==e.layerElement;)a+=1;a<=s-2&&(n=i[a+1]);var o=w("use");o.setAttribute("href","#"+t),n?r.insertBefore(o,n):r.appendChild(o)}},$e.prototype.setElementAsMask=function(e,t){if(!this.findSymbol(t)){var r="matte_"+T(5)+"_"+Xe++,n=w("mask");n.setAttribute("id",t.layerId),n.setAttribute("mask-type","alpha"),Qe.push(t);var i=e.globalData.defs;i.appendChild(n);var a=w("symbol");a.setAttribute("id",r),this.replaceInParent(t,r),a.appendChild(t.layerElement),i.appendChild(a);var s=w("use");s.setAttribute("href","#"+r),n.appendChild(s),t.data.hd=!1,t.show()}e.setMatte(t.layerId)},$e.prototype.initialize=function(){for(var e=this.filterManager.effectElements[0].p.v,t=0,r=this.elem.comp.elements.length;t<r;)this.elem.comp.elements[t].data.ind===e&&this.setElementAsMask(this.elem,this.elem.comp.elements[t]),t+=1;this.initialized=!0},$e.prototype.renderFrame=function(){this.initialized||this.initialize()},Ze.prototype.renderFrame=function(e){var t,r=this.filters.length;for(t=0;t<r;t+=1)this.filters[t].renderFrame(e)};var Je=function(){var t={},r=[],n=0,i=0,a=0,s=!0,o=!1;function l(e){for(var t=0,n=e.target;t<i;)r[t].animation===n&&(r.splice(t,1),t-=1,i-=1,n.isPaused||h()),t+=1}function c(e,t){if(!e)return null;for(var n=0;n<i;){if(r[n].elem==e&&null!==r[n].elem)return r[n].animation;n+=1}var a=new et;return f(a,e),a.setData(e,t),a}function u(){a+=1,m()}function h(){a-=1}function f(e,t){e.addEventListener("destroy",l),e.addEventListener("_active",u),e.addEventListener("_idle",h),r.push({elem:t,animation:e}),i+=1}function d(t){var l,c=t-n;for(l=0;l<i;l+=1)r[l].animation.advanceTime(c);n=t,a&&!o?e.requestAnimationFrame(d):s=!0}function p(t){n=t,e.requestAnimationFrame(d)}function m(){!o&&a&&s&&(e.requestAnimationFrame(p),s=!1)}return t.registerAnimation=c,t.loadAnimation=function(e){var t=new et;return f(t,null),t.setParams(e),t},t.setSpeed=function(e,t){var n;for(n=0;n<i;n+=1)r[n].animation.setSpeed(e,t)},t.setDirection=function(e,t){var n;for(n=0;n<i;n+=1)r[n].animation.setDirection(e,t)},t.play=function(e){var t;for(t=0;t<i;t+=1)r[t].animation.play(e)},t.pause=function(e){var t;for(t=0;t<i;t+=1)r[t].animation.pause(e)},t.stop=function(e){var t;for(t=0;t<i;t+=1)r[t].animation.stop(e)},t.togglePause=function(e){var t;for(t=0;t<i;t+=1)r[t].animation.togglePause(e)},t.searchAnimations=function(e,t,r){var n,i=[].concat([].slice.call(document.getElementsByClassName("lottie")),[].slice.call(document.getElementsByClassName("bodymovin"))),a=i.length;for(n=0;n<a;n+=1)r&&i[n].setAttribute("data-bm-type",r),c(i[n],e);if(t&&0===a){r||(r="svg");var s=document.getElementsByTagName("body")[0];s.innerHTML="";var o=D("div");o.style.width="100%",o.style.height="100%",o.setAttribute("data-bm-type",r),s.appendChild(o),c(o,e)}},t.resize=function(){var e;for(e=0;e<i;e+=1)r[e].animation.resize()},t.goToAndStop=function(e,t,n){var a;for(a=0;a<i;a+=1)r[a].animation.goToAndStop(e,t,n)},t.destroy=function(e){var t;for(t=i-1;t>=0;t-=1)r[t].animation.destroy(e)},t.freeze=function(){o=!0},t.unfreeze=function(){o=!1,m()},t.getRegisteredAnimations=function(){var e,t=r.length,n=[];for(e=0;e<t;e+=1)n.push(r[e].animation);return n},t}(),et=function(){this._cbs=[],this.name="",this.path="",this.isLoaded=!1,this.currentFrame=0,this.currentRawFrame=0,this.totalFrames=0,this.frameRate=0,this.frameMult=0,this.playSpeed=1,this.playDirection=1,this.pendingElements=0,this.playCount=0,this.animationData={},this.assets=[],this.isPaused=!0,this.autoplay=!1,this.loop=!0,this.renderer=null,this.animationID=T(10),this.assetsPath="",this.timeCompleted=0,this.segmentPos=0,this.subframeEnabled=n,this.segments=[],this._idle=!0,this._completedLoop=!1,this.projectInterface={}};function tt(){}M([I],et),et.prototype.setParams=function(e){e.context&&(this.context=e.context),(e.wrapper||e.container)&&(this.wrapper=e.wrapper||e.container);var t=e.animType?e.animType:e.renderer?e.renderer:"svg";switch(t){case"canvas":this.renderer=new CanvasRenderer(this,e.rendererSettings);break;case"svg":this.renderer=new me(this,e.rendererSettings);break;default:this.renderer=new HybridRenderer(this,e.rendererSettings)}this.renderer.setProjectInterface(this.projectInterface),this.animType=t,""===e.loop||null===e.loop||(!1===e.loop?this.loop=!1:!0===e.loop?this.loop=!0:this.loop=parseInt(e.loop)),this.autoplay=!("autoplay"in e)||e.autoplay,this.name=e.name?e.name:"",this.autoloadSegments=!e.hasOwnProperty("autoloadSegments")||e.autoloadSegments,this.assetsPath=e.assetsPath,e.animationData?this.configAnimation(e.animationData):e.path&&("json"!=e.path.substr(-4)&&("/"!=e.path.substr(-1,1)&&(e.path+="/"),e.path+="data.json"),-1!=e.path.lastIndexOf("\\")?this.path=e.path.substr(0,e.path.lastIndexOf("\\")+1):this.path=e.path.substr(0,e.path.lastIndexOf("/")+1),this.fileName=e.path.substr(e.path.lastIndexOf("/")+1),this.fileName=this.fileName.substr(0,this.fileName.lastIndexOf(".json")),te.load(e.path,this.configAnimation.bind(this),function(){this.trigger("data_failed")}.bind(this)))},et.prototype.setData=function(e,t){var r={wrapper:e,animationData:t?"object"==typeof t?t:JSON.parse(t):null},n=e.attributes;r.path=n.getNamedItem("data-animation-path")?n.getNamedItem("data-animation-path").value:n.getNamedItem("data-bm-path")?n.getNamedItem("data-bm-path").value:n.getNamedItem("bm-path")?n.getNamedItem("bm-path").value:"",r.animType=n.getNamedItem("data-anim-type")?n.getNamedItem("data-anim-type").value:n.getNamedItem("data-bm-type")?n.getNamedItem("data-bm-type").value:n.getNamedItem("bm-type")?n.getNamedItem("bm-type").value:n.getNamedItem("data-bm-renderer")?n.getNamedItem("data-bm-renderer").value:n.getNamedItem("bm-renderer")?n.getNamedItem("bm-renderer").value:"canvas";var i=n.getNamedItem("data-anim-loop")?n.getNamedItem("data-anim-loop").value:n.getNamedItem("data-bm-loop")?n.getNamedItem("data-bm-loop").value:n.getNamedItem("bm-loop")?n.getNamedItem("bm-loop").value:"";""===i||(r.loop="false"!==i&&("true"===i||parseInt(i)));var a=n.getNamedItem("data-anim-autoplay")?n.getNamedItem("data-anim-autoplay").value:n.getNamedItem("data-bm-autoplay")?n.getNamedItem("data-bm-autoplay").value:!n.getNamedItem("bm-autoplay")||n.getNamedItem("bm-autoplay").value;r.autoplay="false"!==a,r.name=n.getNamedItem("data-name")?n.getNamedItem("data-name").value:n.getNamedItem("data-bm-name")?n.getNamedItem("data-bm-name").value:n.getNamedItem("bm-name")?n.getNamedItem("bm-name").value:"","false"===(n.getNamedItem("data-anim-prerender")?n.getNamedItem("data-anim-prerender").value:n.getNamedItem("data-bm-prerender")?n.getNamedItem("data-bm-prerender").value:n.getNamedItem("bm-prerender")?n.getNamedItem("bm-prerender").value:"")&&(r.prerender=!1),this.setParams(r)},et.prototype.includeLayers=function(e){e.op>this.animationData.op&&(this.animationData.op=e.op,this.totalFrames=Math.floor(e.op-this.animationData.ip));var r,n,i=this.animationData.layers,a=i.length,s=e.layers,o=s.length;for(n=0;n<o;n+=1)for(r=0;r<a;){if(i[r].id==s[n].id){i[r]=s[n];break}r+=1}if((e.chars||e.fonts)&&(this.renderer.globalData.fontManager.addChars(e.chars),this.renderer.globalData.fontManager.addFonts(e.fonts,this.renderer.globalData.defs)),e.assets)for(a=e.assets.length,r=0;r<a;r+=1)this.animationData.assets.push(e.assets[r]);this.animationData.__complete=!1,O.completeData(this.animationData,this.renderer.globalData.fontManager),this.renderer.includeLayers(e.layers),t&&t.initExpressions(this),this.loadNextSegment()},et.prototype.loadNextSegment=function(){var e=this.animationData.segments;if(!e||0===e.length||!this.autoloadSegments)return this.trigger("data_ready"),void(this.timeCompleted=this.totalFrames);var t=e.shift();this.timeCompleted=t.time*this.frameRate;var r=this.path+this.fileName+"_"+this.segmentPos+".json";this.segmentPos+=1,te.load(r,this.includeLayers.bind(this),function(){this.trigger("data_failed")}.bind(this))},et.prototype.loadSegments=function(){this.animationData.segments||(this.timeCompleted=this.totalFrames),this.loadNextSegment()},et.prototype.preloadImages=function(){this.imagePreloader=new Z,this.imagePreloader.setAssetsPath(this.assetsPath),this.imagePreloader.setPath(this.path),this.imagePreloader.loadAssets(this.animationData.assets,function(e){e||this.trigger("loaded_images")}.bind(this))},et.prototype.configAnimation=function(e){this.renderer&&(this.animationData=e,this.totalFrames=Math.floor(this.animationData.op-this.animationData.ip),this.renderer.configAnimation(e),e.assets||(e.assets=[]),this.renderer.searchExtraCompositions(e.assets),this.assets=this.animationData.assets,this.frameRate=this.animationData.fr,this.firstFrame=Math.round(this.animationData.ip),this.frameMult=this.animationData.fr/1e3,this.trigger("config_ready"),this.preloadImages(),this.loadSegments(),this.updaFrameModifier(),this.waitForFontsLoaded())},et.prototype.completeData=function(){O.completeData(this.animationData,this.renderer.globalData.fontManager),this.checkLoaded()},et.prototype.waitForFontsLoaded=function(){this.renderer&&(this.renderer.globalData.fontManager.loaded?this.completeData():setTimeout(this.waitForFontsLoaded.bind(this),20))},et.prototype.addPendingElement=function(){this.pendingElements+=1},et.prototype.elementLoaded=function(){this.pendingElements-=1,this.checkLoaded()},et.prototype.checkLoaded=function(){0===this.pendingElements&&(t&&t.initExpressions(this),this.renderer.initItems(),setTimeout(function(){this.trigger("DOMLoaded")}.bind(this),0),this.isLoaded=!0,this.gotoFrame(),this.autoplay&&this.play())},et.prototype.resize=function(){this.renderer.updateContainerSize()},et.prototype.setSubframe=function(e){this.subframeEnabled=!!e},et.prototype.gotoFrame=function(){this.currentFrame=this.subframeEnabled?this.currentRawFrame:~~this.currentRawFrame,this.timeCompleted!==this.totalFrames&&this.currentFrame>this.timeCompleted&&(this.currentFrame=this.timeCompleted),this.trigger("enterFrame"),this.renderFrame()},et.prototype.renderFrame=function(){!1!==this.isLoaded&&this.renderer.renderFrame(this.currentFrame+this.firstFrame)},et.prototype.play=function(e){e&&this.name!=e||!0===this.isPaused&&(this.isPaused=!1,this._idle&&(this._idle=!1,this.trigger("_active")))},et.prototype.pause=function(e){e&&this.name!=e||!1===this.isPaused&&(this.isPaused=!0,this._idle=!0,this.trigger("_idle"))},et.prototype.togglePause=function(e){e&&this.name!=e||(!0===this.isPaused?this.play():this.pause())},et.prototype.stop=function(e){e&&this.name!=e||(this.pause(),this.playCount=0,this._completedLoop=!1,this.setCurrentRawFrameValue(0))},et.prototype.goToAndStop=function(e,t,r){r&&this.name!=r||(t?this.setCurrentRawFrameValue(e):this.setCurrentRawFrameValue(e*this.frameModifier),this.pause())},et.prototype.goToAndPlay=function(e,t,r){this.goToAndStop(e,t,r),this.play()},et.prototype.advanceTime=function(e){if(!0!==this.isPaused&&!1!==this.isLoaded){var t=this.currentRawFrame+e*this.frameModifier,r=!1;t>=this.totalFrames-1&&this.frameModifier>0?this.loop&&this.playCount!==this.loop?t>=this.totalFrames?(this.playCount+=1,this.checkSegments(t%this.totalFrames)||(this.setCurrentRawFrameValue(t%this.totalFrames),this._completedLoop=!0,this.trigger("loopComplete"))):this.setCurrentRawFrameValue(t):this.checkSegments(t>this.totalFrames?t%this.totalFrames:0)||(r=!0,t=this.totalFrames-1):t<0?this.checkSegments(t%this.totalFrames)||(!this.loop||this.playCount--<=0&&!0!==this.loop?(r=!0,t=0):(this.setCurrentRawFrameValue(this.totalFrames+t%this.totalFrames),this._completedLoop?this.trigger("loopComplete"):this._completedLoop=!0)):this.setCurrentRawFrameValue(t),r&&(this.setCurrentRawFrameValue(t),this.pause(),this.trigger("complete"))}},et.prototype.adjustSegment=function(e,t){this.playCount=0,e[1]<e[0]?(this.frameModifier>0&&(this.playSpeed<0?this.setSpeed(-this.playSpeed):this.setDirection(-1)),this.timeCompleted=this.totalFrames=e[0]-e[1],this.firstFrame=e[1],this.setCurrentRawFrameValue(this.totalFrames-.001-t)):e[1]>e[0]&&(this.frameModifier<0&&(this.playSpeed<0?this.setSpeed(-this.playSpeed):this.setDirection(1)),this.timeCompleted=this.totalFrames=e[1]-e[0],this.firstFrame=e[0],this.setCurrentRawFrameValue(.001+t)),this.trigger("segmentStart")},et.prototype.setSegment=function(e,t){var r=-1;this.isPaused&&(this.currentRawFrame+this.firstFrame<e?r=e:this.currentRawFrame+this.firstFrame>t&&(r=t-e)),this.firstFrame=e,this.timeCompleted=this.totalFrames=t-e,-1!==r&&this.goToAndStop(r,!0)},et.prototype.playSegments=function(e,t){if("object"==typeof e[0]){var r,n=e.length;for(r=0;r<n;r+=1)this.segments.push(e[r])}else this.segments.push(e);t&&this.checkSegments(0),this.isPaused&&this.play()},et.prototype.resetSegments=function(e){this.segments.length=0,this.segments.push([this.animationData.ip,this.animationData.op]),e&&this.checkSegments(0)},et.prototype.checkSegments=function(e){return!!this.segments.length&&(this.adjustSegment(this.segments.shift(),e),!0)},et.prototype.destroy=function(e){e&&this.name!=e||!this.renderer||(this.renderer.destroy(),this.trigger("destroy"),this._cbs=null,this.onEnterFrame=this.onLoopComplete=this.onComplete=this.onSegmentStart=this.onDestroy=null,this.renderer=null)},et.prototype.setCurrentRawFrameValue=function(e){this.currentRawFrame=e,this.gotoFrame()},et.prototype.setSpeed=function(e){this.playSpeed=e,this.updaFrameModifier()},et.prototype.setDirection=function(e){this.playDirection=e<0?-1:1,this.updaFrameModifier()},et.prototype.updaFrameModifier=function(){this.frameModifier=this.frameMult*this.playSpeed*this.playDirection},et.prototype.getPath=function(){return this.path},et.prototype.getAssetsPath=function(e){var t="";if(e.e)t=e.p;else if(this.assetsPath){var r=e.p;-1!==r.indexOf("images/")&&(r=r.split("/")[1]),t=this.assetsPath+r}else t=this.path,t+=e.u?e.u:"",t+=e.p;return t},et.prototype.getAssetData=function(e){for(var t=0,r=this.assets.length;t<r;){if(e==this.assets[t].id)return this.assets[t];t+=1}},et.prototype.hide=function(){this.renderer.hide()},et.prototype.show=function(){this.renderer.show()},et.prototype.getDuration=function(e){return e?this.totalFrames:this.totalFrames/this.frameRate},et.prototype.trigger=function(e){if(this._cbs&&this._cbs[e])switch(e){case"enterFrame":this.triggerEvent(e,new f(e,this.currentFrame,this.totalFrames,this.frameMult));break;case"loopComplete":this.triggerEvent(e,new p(e,this.loop,this.playCount,this.frameMult));break;case"complete":this.triggerEvent(e,new d(e,this.frameMult));break;case"segmentStart":this.triggerEvent(e,new m(e,this.firstFrame,this.totalFrames));break;case"destroy":this.triggerEvent(e,new g(e,this));break;default:this.triggerEvent(e)}"enterFrame"===e&&this.onEnterFrame&&this.onEnterFrame.call(this,new f(e,this.currentFrame,this.totalFrames,this.frameMult)),"loopComplete"===e&&this.onLoopComplete&&this.onLoopComplete.call(this,new p(e,this.loop,this.playCount,this.frameMult)),"complete"===e&&this.onComplete&&this.onComplete.call(this,new d(e,this.frameMult)),"segmentStart"===e&&this.onSegmentStart&&this.onSegmentStart.call(this,new m(e,this.firstFrame,this.totalFrames)),"destroy"===e&&this.onDestroy&&this.onDestroy.call(this,new g(e,this))};var rt={};function nt(){!0===it?Je.searchAnimations(at,it,st):Je.searchAnimations()}rt.play=Je.play,rt.pause=Je.pause,rt.setLocationHref=function(e){r=e},rt.togglePause=Je.togglePause,rt.setSpeed=Je.setSpeed,rt.setDirection=Je.setDirection,rt.stop=Je.stop,rt.searchAnimations=nt,rt.registerAnimation=Je.registerAnimation,rt.loadAnimation=function(e){return!0===it&&(e.animationData=JSON.parse(at)),Je.loadAnimation(e)},rt.setSubframeRendering=function(e){n=e},rt.resize=Je.resize,rt.goToAndStop=Je.goToAndStop,rt.destroy=Je.destroy,rt.setQuality=function(e){if("string"==typeof e)switch(e){case"high":c=200;break;case"medium":c=50;break;case"low":c=10}else!isNaN(e)&&e>1&&(c=e);h(!(c>=50))},rt.inBrowser=function(){return"undefined"!=typeof navigator},rt.installPlugin=function(e,r){"expressions"===e&&(t=r)},rt.freeze=Je.freeze,rt.unfreeze=Je.unfreeze,rt.getRegisteredAnimations=Je.getRegisteredAnimations,rt.__getFactory=function(e){switch(e){case"propertyFactory":return F;case"shapePropertyFactory":return U;case"matrix":return A}},rt.version="5.2.1";var it="__[STANDALONE]__",at="__[ANIMATIONDATA]__",st="",ot=setInterval((function(){"complete"===document.readyState&&(clearInterval(ot),nt())}),100);return rt}(e),e.bodymovin=e.lottie}(window||{}),
/**!
 * FileAPI — a set of tools for working with files
 *
 * @author  RubaXa  <trash@rubaxa.org>
 * @build    lib/canvas-to-blob lib/FileAPI.core lib/FileAPI.Image lib/FileAPI.Form lib/FileAPI.XHR lib/FileAPI.Flash
 */
function(e){var t,r=e.HTMLCanvasElement&&e.HTMLCanvasElement.prototype;if(t=e.Blob)try{t=Boolean(new Blob)}catch(e){t=!1}var n=t;if((t=n)&&(t=e.Uint8Array))try{t=100===new Blob([new Uint8Array(100)]).size}catch(e){t=!1}var i=t,a=e.BlobBuilder||e.WebKitBlobBuilder||e.MozBlobBuilder||e.MSBlobBuilder,s=(n||a)&&e.atob&&e.ArrayBuffer&&e.Uint8Array&&function(e){var t,r,s,o;for(t=0<=e.split(",")[0].indexOf("base64")?atob(e.split(",")[1]):decodeURIComponent(e.split(",")[1]),r=new ArrayBuffer(t.length),s=new Uint8Array(r),o=0;o<t.length;o+=1)s[o]=t.charCodeAt(o);return e=e.split(",")[0].split(":")[1].split(";")[0],n?new Blob([i?s:r],{type:e}):((s=new a).append(r),s.getBlob(e))};e.HTMLCanvasElement&&!r.toBlob&&(r.mozGetAsFile?r.toBlob=function(e,t){e(this.mozGetAsFile("blob",t))}:r.toDataURL&&s&&(r.toBlob=function(e,t){e(s(this.toDataURL(t)))})),"function"==typeof define&&define.amd?define((function(){return s})):e.dataURLtoBlob=s}(this),function(e,t){function r(e,t,r){if(e)if(c(e))for(var n=0,i=e.length;n<i;n++)n in e&&t.call(r,e[n],n,e);else for(n in e)e.hasOwnProperty(n)&&t.call(r,e[n],n,e)}function n(e,t,n){if(e){var i=B.uid(e);k[i]||(k[i]={}),r(t.split(/\s+/),(function(t){y?y.event.add(e,t,n):(k[i][t]||(k[i][t]=[]),k[i][t].push(n),e.addEventListener?e.addEventListener(t,n,!1):e.attachEvent?e.attachEvent("on"+t,n):e["on"+t]=n)}))}}function i(e,t,n){if(e){var i=B.uid(e),a=k[i]||{};r(t.split(/\s+/),(function(t){if(y)y.event.remove(e,t,n);else{for(var r=a[t]||[],i=r.length;i--;)if(r[i]===n){r.splice(i,1);break}e.addEventListener?e.removeEventListener(t,n,!1):e.detachEvent?e.detachEvent("on"+t,n):e["on"+t]=null}}))}}function a(e,t,r){n(e,t,(function n(a){i(e,t,n),r(a)}))}function s(e,t,r,n,i){e={type:r.type||r,target:e,result:n},B.extend(e,i),t(e)}function o(e,r,a,o){if(B.isFile(e)&&g&&g.prototype["readAs"+a]){var l=new g;n(l,L,(function t(n){var a=n.type;"progress"==a?s(e,r,n,n.target.result,{loaded:n.loaded,total:n.total}):"loadend"==a?(i(l,L,t),l=null):s(e,r,n,n.target.result)}));try{o?l["readAs"+a](o,e):l["readAs"+a](e)}catch(n){s(e,r,"error",t,{error:n.toString()})}}else s(e,r,"error",t,{error:"filreader_not_support_"+a})}function l(e){var t;return e.getAsEntry?t=e.getAsEntry():e.webkitGetAsEntry&&(t=e.webkitGetAsEntry()),t}function c(e){return"object"==typeof e&&e&&"length"in e}function u(t){return t.target||(t.target=e.event&&e.event.srcElement||E),3===t.target.nodeType&&(t.target=event.target.parentNode),t}var h=1,f=function(){},d=navigator.userAgent,p=e.createObjectURL&&e||e.URL&&URL.revokeObjectURL&&URL||e.webkitURL&&webkitURL,m=e.File,g=e.FileReader,T=e.FormData,y=e.jQuery,v=!(!m||!(g&&e.Uint8Array||T)||/safari\//.test(d)&&/windows/i.test(d)),E=(d=v&&"withCredentials"in new XMLHttpRequest,T=v&&!!Blob&&!(!Blob.prototype.webkitSlice&&!Blob.prototype.mozSlice&&!Blob.prototype.slice),e.document),C=e.dataURLtoBlob,b=/img/i,S=/canvas/i,I=/img|canvas/,x=/input/i,P=/^data:[^,]+,/,w=Math.pow,D=Math.round,_=Number,A=function(e){return D(e*this)},R=new _(1024),M=new _(w(R,2)),N=new _(w(R,3)),k=(w=new _(w(R,4)),{}),O=[],L="abort progress error load loadend",F="status statusText readyState response responseXML responseText responseBody".split(" "),B={version:"1.2.4",cors:!1,debug:!1,pingUrl:!1,staticPath:"./",flashUrl:0,flashImageUrl:0,accept:{"image/*":"art bm bmp dwg dxf cbr cbz fif fpx gif ico iefs jfif jpe jpeg jpg jps jut mcf nap nif pbm pcx pgm pict pm png pnm qif qtif ras rast rf rp svf tga tif tiff xbm xbm xpm xwd","audio/*":"m4a flac aac rm mpa wav wma ogg mp3 mp2 m3u mod amf dmf dsm far gdm imf it m15 med okt s3m stm sfx ult uni xm sid ac3 dts cue aif aiff wpl ape mac mpc mpp shn wv nsf spc gym adplug adx dsp adp ymf ast afc hps xs","video/*":"m4v 3gp nsv ts ty strm rm rmvb m3u ifo mov qt divx xvid bivx vob nrg img iso pva wmv asf asx ogm m2v avi bin dat dvr-ms mpg mpeg mp4 mkv avc vp3 svq3 nuv viv dv fli flv wpl"},chunkSize:0,chunkUploadRetry:0,chunkNetworkDownRetryTimeout:2e3,KB:(R.from=A,R),MB:(M.from=A,M),GB:(N.from=A,N),TB:(w.from=A,w),expando:"fileapi"+(new Date).getTime(),uid:function(e){return e?e[B.expando]=e[B.expando]||B.uid():(++h,B.expando+h)},log:function(){B.debug&&e.console&&console.log&&(console.log.apply?console.log.apply(console,arguments):console.log([].join.call(arguments," ")))},getXHR:function(){var t;if(e.XMLHttpRequest)t=new XMLHttpRequest;else if(e.ActiveXObject)try{t=new ActiveXObject("MSXML2.XMLHttp.3.0")}catch(e){}return t},isArray:c,support:{dnd:d&&"ondrop"in E.createElement("div"),cors:d,html5:v,chunked:T,dataURI:!0},event:{on:n,off:i,one:a,fix:u},throttle:function(t,r){var n,i;return function(){i=arguments,n||(t.apply(e,i),n=setTimeout((function(){n=0,t.apply(e,i)}),r))}},F:function(){},parseJSON:function(t){return e.JSON&&JSON.parse?JSON.parse(t):new Function("return ("+t.replace(/([\r\n])/g,"\\$1")+");")()},trim:function(e){return(e=String(e)).trim?e.trim():e.replace(/^\s+|\s+$/g,"")},defer:function(){var e,r,n=[],i={resolve:function(t,a){for(i.resolve=f,r=t||!1,e=a;a=n.shift();)a(r,e)},then:function(i){r!==t?i(r,e):n.push(i)}};return i},queue:function(e){var t=0,r=0,n=!1,i=!1,a={inc:function(){r++},next:function(){t++,setTimeout(a.check,0)},check:function(){t>=r&&!n&&a.end()},isFail:function(){return n},fail:function(){!n&&e(n=!0)},end:function(){i||(i=!0,e())}};return a},each:r,afor:function(e,t){var r=0,n=e.length;c(e)&&n--?function i(){t(n!=r&&i,e[r],r++)}():t(!1)},extend:function(e){return r(arguments,(function(t){r(t,(function(t,r){e[r]=t}))})),e},isFile:function(e){return v&&e&&e instanceof m},isCanvas:function(e){return e&&S.test(e.nodeName)},getFilesFilter:function(e){return(e="string"==typeof e?e:e.getAttribute&&e.getAttribute("accept")||"")?RegExp("("+e.replace(/\./g,"\\.").replace(/,/g,"|")+")$","i"):/./},readAsDataURL:function(e,t){B.isCanvas(e)?s(e,t,"load",B.toDataURL(e)):o(e,t,"DataURL")},readAsBinaryString:function(e,t){g&&g.prototype.readAsBinaryString?o(e,t,"BinaryString"):o(e,(function(e){if("load"==e.type)try{e.result=B.toBinaryString(e.result)}catch(t){e.type="error",e.message=t.toString()}t(e)}),"DataURL")},readAsArrayBuffer:function(e,t){o(e,t,"ArrayBuffer")},readAsText:function(e,t,r){r||(r=t,t="utf-8"),o(e,r,"Text",t)},toDataURL:function(e){return"string"==typeof e?e:e.toDataURL?e.toDataURL("image/png"):void 0},toBinaryString:function(t){return e.atob(B.toDataURL(t).replace(P,""))},readAsImage:function(e,r,n){if(B.isFile(e))if(p){var o=p.createObjectURL(e);o===t?s(e,r,"error"):B.readAsImage(o,r,n)}else B.readAsDataURL(e,(function(t){"load"==t.type?B.readAsImage(t.result,r,n):(n||"error"==t.type)&&s(e,r,t,null,{loaded:t.loaded,total:t.total})}));else B.isCanvas(e)?s(e,r,"load",e):b.test(e.nodeName)?e.complete?s(e,r,"load",e):a(e,"error abort load",(function t(n){"load"==n.type&&p&&p.revokeObjectURL(e.src),i(e,"error abort load",t),s(e,r,n,e)})):e.iframe?s(e,r,{type:"error"}):((o=new Image).src=e.dataURL||e,B.readAsImage(o,r,n))},checkFileObj:function(e){var t={},n=B.accept;return"object"==typeof e?t=e:t.name=(e+"").split(/\\|\//g).pop(),null==t.type&&(t.type=t.name.split(".").pop()),r(n,(function(e,r){(e=RegExp(e.replace(/\s/g,"|"),"i")).test(t.type)&&(t.type=r.split("/")[0]+"/"+t.type)})),t},getDropFiles:function(e,t){var n=[],i=(e.originalEvent||e||"").dataTransfer||{},s=c(i.items)&&i.items[0]&&l(i.items[0]),o=B.queue((function(){t(n)}));r((s?i.items:i.files)||[],(function(e){if(o.inc(),s)!function e(t,r){if(t)if(t.isFile)t.file((function(e){r(!1,[e])}),(function(){r("entry_file")}));else if(t.isDirectory){var n=[];t.createReader().readEntries((function(t){B.afor(t,(function(t,i){e(i,(function(e,i){e||(n=n.concat(i)),t?t():r(!1,n)}))}))}),(function(){r("directory_reader")}))}else e(l(t),r);else r("empty_entry")}(e,(function(e,t){!e&&n.push.apply(n,t),o.next()}));else{var t=function(t){t&&n.push(e),o.next()};if(!e.type&&0==e.size%4096&&102400>=e.size)if(g)try{var r=new g;a(r,L,(function(e){e="error"!=e.type,t(e),e&&r.abort()})),r.readAsDataURL(e)}catch(e){t(!1)}else t(null);else t(!0)}})),o.check()},getFiles:function(e,t,r){var n=[];return r?(B.filterFiles(B.getFiles(e),t,r),null):(e.jquery&&(e.each((function(){n=n.concat(B.getFiles(this))})),e=n,n=[]),"string"==typeof t&&(t=B.getFilesFilter(t)),e.originalEvent?e=u(e.originalEvent):e.srcElement&&(e=u(e)),e.dataTransfer?e=e.dataTransfer:e.target&&(e=e.target),e.files?n=e.files:!v&&x.test(e&&e.tagName)?B.trim(e.value)&&((n=[B.checkFileObj(e.value)])[0].blob=e,n[0].iframe=!0):c(e)&&(n=e),B.filter(n,(function(e){return!t||t.test(e.name)})))},getInfo:function(e,t){var r={},n=O.concat();B.isFile(e)?function i(){var a=n.shift();a?a.test(e.type)?a(e,(function(e,n){e?t(e):(B.extend(r,n),i())})):i():t(!1,r)}():t("not_support",r)},addInfoReader:function(e,t){t.test=function(t){return e.test(t)},O.push(t)},filter:function(e,t){for(var r,n=[],i=0,a=e.length;i<a;i++)i in e&&(r=e[i],t.call(r,r,i,e)&&n.push(r));return n},filterFiles:function(e,t,r){if(e.length){var n,i=e.concat(),a=[],s=[];!function e(){i.length?(n=i.shift(),B.getInfo(n,(function(r,i){(t(n,!r&&i)?a:s).push(n),e()}))):r(a,s)}()}else r([],e)},upload:function(e){(e=B.extend({prepare:B.F,beforeupload:B.F,upload:B.F,fileupload:B.F,fileprogress:B.F,filecomplete:B.F,progress:B.F,complete:B.F,pause:B.F,chunkSize:B.chunkSize,chunkUpoloadRetry:B.chunkUploadRetry},e)).imageAutoOrientation&&!e.imageTransform&&(e.imageTransform={rotate:"auto"});var t,n=new B.XHR(e),i=this._getFilesDataArray(e.files),a=0,s=0,o=0,l=1,c=this,u=!1;return r(i,(function(e){a+=e.size})),n.files=[],r(i,(function(e){n.files.push(e.file)})),n.total=a,n.loaded=0,e.beforeupload(n,e),(t=function t(){var h=i.shift(),f=h&&h.file,d=!1,p={};r(e,(function(e,t){e&&"object"==typeof e&&(e=B.extend({},e)),p[t]=e})),("abort"!=n.statusText||n.current)&&h?(u=!1,n.currentFile=f,e.prepare(f,p),this._getFormData(p,h,(function(i){s||e.upload(n,e);var u=new B.XHR(B.extend({},p,{upload:function(){e.fileupload(f,u,p)},progress:function(t){d||(o=s+=a*l*(t.loaded/t.total)-o+.5|0,h.total=t.total,h.loaded=t.loaded,e.fileprogress(t,f,u,p),e.progress({type:t.type,total:a,loaded:n.loaded=s,lengthComputable:!0},f,u,p))},complete:function(i){r(F,(function(e){n[e]=u[e]})),d=!0,h.loaded=h.total,n.loaded=s+=s-o+(a*l+.5)|0,e.filecomplete(i,u,f,p),t.call(c)}}));l=h.size/a,n.abort=function(e){this.current=e,u.abort()},u.send(i)}))):(e.complete(200!=n.status&&201!=n.status&&(n.statusText||"error"),n,e),u=!0)}).call(this),n.append=function(e){r(e=B._getFilesDataArray(e),(function(e){a+=e.size,n.files.push(e.file),i.push(e)})),u&&t.call(c)},n.remove=function(e){var t=-1;r(i,(function(r){if(t++,r.file==e)return i.splice(t,1)}))},n},_getFilesDataArray:function(e){var t=[],n={};if(x.test(e&&e.tagName)){var i=B.getFiles(e);n[e.name||"file"]=null!==e.getAttribute("multiple")?i:i[0]}else c(e)&&x.test(e[0]&&e[0].tagName)?r(e,(function(e){n[e.name||"file"]=B.getFiles(e)})):n=e;return r(n,(function e(n,i){c(n)?r(n,(function(t){e(t,i)})):n&&n.name&&t.push({name:i,file:n,size:n.size,total:n.size,loaded:0})})),t},_getFormData:function(e,t,n){var i=t.file,a=t.name,s=i.name,o=i.type;t=B.support.transform&&e.imageTransform;var l=new B.Form,c=B.queue((function(){n(l)})),u=t&&(0<parseInt(t.maxWidth||t.minWidth||t.width,10)||t.rotate);B.Image&&t&&(/image/.test(i.type)||I.test(i.nodeType))?(c.inc(),u&&(t=[t]),B.Image.transform(i,t,e.imageAutoOrientation,(function(t,n){u&&!t?(!C&&!B.flashEngine&&(n[0]=B.toBinaryString(n[0]),l.multipart=!0),l.append(a,n[0],s,o)):(t||(r(n,(function(e,t){!C&&!B.flashEngine&&(e=B.toBinaryString(e),l.multipart=!0),l.append(a+"["+t+"]",e,s,o)})),a+="[original]"),(t||e.imageOriginal)&&l.append(a,i,s,o)),c.next()}))):l.append(a,i,s),r(e.data,(function e(t,n){"object"==typeof t?r(t,(function(t,r){e(t,n+"["+r+"]")})):l.append(n,t)})),c.check()},reset:function(e){var t,a;return y?(a=y(e).clone(!0).insertBefore(e).val("")[0],y(e).remove()):(t=e.parentNode,(a=t.insertBefore(e.cloneNode(!0),e)).value="",t.removeChild(e),r(k[B.uid(e)],(function(t,s){r(t,(function(t){i(e,s,t),n(a,s,t)}))}))),a},load:function(e,t){var r=B.getXHR();return r?(r.open("GET",e,!0),r.overrideMimeType&&r.overrideMimeType("text/plain; charset=x-user-defined"),n(r,"progress",(function(e){e.lengthComputable&&t({type:e.type,loaded:e.loaded,total:e.total},r)})),r.onreadystatechange=function(){if(4==r.readyState)if(r.onreadystatechange=null,200==r.status){var n={name:(e=e.split("/"))[e.length-1],size:r.getResponseHeader("Content-Length"),type:r.getResponseHeader("Content-Type")};n.dataURL="data:"+n.type+";base64,"+B.encode64(r.responseBody||r.responseText),t({type:"load",result:n})}else t({type:"error"})},r.send(null)):t({type:"error"}),r},encode64:function(e){var t="",r=0;for("string"!=typeof e&&(e=String(e));r<e.length;){var n=255&e.charCodeAt(r++),i=255&e.charCodeAt(r++),a=255&e.charCodeAt(r++),s=n>>2;n=(3&n)<<4|i>>4;isNaN(i)?i=a=64:(i=(15&i)<<2|a>>6,a=isNaN(a)?64:63&a),t+="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".charAt(s)+"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".charAt(n)+"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".charAt(i)+"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".charAt(a)}return t}};B.addInfoReader(/^image/,(function(e,t){if(!e.__dimensions){var r=e.__dimensions=B.defer();B.readAsImage(e,(function(e){var t=e.target;r.resolve("load"!=e.type&&"error",{width:t.width,height:t.height})}))}e.__dimensions.then(t)})),B.event.dnd=function(e,t,r){var i,a;r||(r=t,t=B.F),g?(n(e,"dragenter dragleave dragover",(function(e){for(var r=((e.originalEvent||e||"").dataTransfer||{}).types,n=r&&r.length;n--;)~r[n].indexOf("File")&&(e.preventDefault(),a!==e.type&&("dragleave"!=(a=e.type)&&t.call(e.currentTarget,!0,e),clearTimeout(i),i=setTimeout((function(){t.call(e.currentTarget,"dragleave"!=a,e)}),50)))})),n(e,"drop",(function(e){e.preventDefault(),a=0,t.call(e.currentTarget,!1,e),B.getDropFiles(e,(function(t){r.call(e.currentTarget,t,e)}))}))):B.log("Drag'n'Drop -- not supported")},y&&!y.fn.dnd&&(y.fn.dnd=function(e,t){return this.each((function(){B.event.dnd(this,e,t)}))}),e.FileAPI=B.extend(B,e.FileAPI),B.flashUrl||(B.flashUrl=B.staticPath+"FileAPI.flash.swf"),B.flashImageUrl||(B.flashImageUrl=B.staticPath+"FileAPI.flash.image.swf")}(window),function(e,t,r){function n(e,t){if(!(this instanceof n))return new n(e);this.file=e,this.better=!t,this.matrix={sx:0,sy:0,sw:0,sh:0,dx:0,dy:0,dw:0,dh:0,resize:0,deg:0}}var i=Math.min,a=Math.round,s=!1,o={8:270,3:180,6:90};try{s=-1<t.createElement("canvas").toDataURL("image/png").indexOf("data:image/png")}catch(e){}n.prototype={constructor:n,set:function(t){return e.extend(this.matrix,t),this},crop:function(e,t,n,i){return n===r&&(n=e,i=t,e=t=0),this.set({sx:e,sy:t,sw:n,sh:i||n})},resize:function(e,t,r){return"string"==typeof t&&(r=t,t=e),this.set({dw:e,dh:t,resize:r})},preview:function(e,t){return this.set({dw:e,dh:t||e,resize:"preview"})},rotate:function(e){return this.set({deg:e})},_load:function(t,r){var n=this;e.readAsImage(t,(function(e){r.call(n,"load"!=e.type,e.result)}))},_apply:function(e,r){var n,i=t.createElement("canvas"),a=this.getMatrix(e),s=i.getContext("2d"),o=a.deg,l=a.dw,c=a.dh,u=e.width,h=e.height,f=e;if(this.better)for(;2<Math.min(u/l,h/c);)u=~~(u/2+.5),h=~~(h/2+.5),(n=t.createElement("canvas")).width=u,n.height=h,f!==e?(n.getContext("2d").drawImage(f,0,0,f.width,f.height,0,0,u,h),f=n):((f=n).getContext("2d").drawImage(e,a.sx,a.sy,a.sw,a.sh,0,0,u,h),a.sx=a.sy=a.sw=a.sh=0);i.width=o%180?c:l,i.height=o%180?l:c,s.rotate(o*Math.PI/180),s.drawImage(f,a.sx,a.sy,a.sw||f.width,a.sh||f.height,180==o||270==o?-l:0,90==o||180==o?-c:0,l,c),r.call(this,!1,i)},getMatrix:function(t){var r=e.extend({},this.matrix),n=r.sw=r.sw||t.width;t=r.sh=r.sh||t.height;var s=r.dw=r.dw||r.sw,o=r.dh=r.dh||r.sh,l=n/t,c=s/o,u=r.resize;return"preview"==u?s==n&&o==t||(c>=l?u=(l=n)/c:l=(u=t)*c,(l!=n||u!=t)&&(r.sx=~~((n-l)/2),r.sy=~~((t-u)/2),n=l,t=u)):u&&("min"==u?(s=a(l<c?i(n,s):o*l),o=a(l<c?s/l:i(t,o))):(s=a(l>=c?i(n,s):o*l),o=a(l>=c?s/l:i(t,o)))),r.sw=n,r.sh=t,r.dw=s,r.dh=o,r},_trans:function(e){this._load(this.file,(function(t,r){t?e(t):this._apply(r,e)}))},get:function(t){if(e.support.transform){var r=this;"auto"==r.matrix.deg?e.getInfo(this.file,(function(e,n){r.matrix.deg=o[n&&n.exif&&n.exif.Orientation]||0,r._trans(t)})):r._trans(t)}else t("not_support")},toData:function(e){this.get(e)}},n.transform=function(t,i,a,s){e.getInfo(t,(function(o,l){var c={},u=e.queue((function(e){s(e,c)}));o?u.fail():e.each(i,(function(e,i){if(!u.isFail()){var s=n(l.nodeType?l:t);"function"==typeof e?e(l,s):e.width?s[e.preview?"preview":"resize"](e.width,e.height,e.type):e.maxWidth&&(l.width>e.maxWidth||l.height>e.maxHeight)&&s.resize(e.maxWidth,e.maxHeight,"max"),e.rotate===r&&a&&(e.rotate="auto"),s.rotate(e.rotate),u.inc(),s.toData((function(e,t){e?u.fail():(c[i]=t,u.next())}))}}))}))},e.support.canvas=e.support.transform=s,e.Image=n}(FileAPI,document),function(e,t,r){var n=t.encodeURIComponent,i=t.FormData;(t=function(){this.items=[]}).prototype={append:function(e,t,r,n){this.items.push({name:e,blob:t&&t.blob||t,file:r||t.name,type:n||t.type})},each:function(e){for(var t=0,r=this.items.length;t<r;t++)e.call(this,this.items[t])},toData:function(t,r){r._chunked=e.support.chunked&&0<r.chunkSize&&1==e.filter(this.items,(function(e){return e.file})).length,e.support.html5?this.multipart?(e.log("FileAPI.Form.toMultipartData"),this.toMultipartData(t)):r._chunked?(e.log("FileAPI.Form.toPlainData"),this.toPlainData(t)):(e.log("FileAPI.Form.toFormData"),this.toFormData(t)):(e.log("FileAPI.Form.toHtmlData"),this.toHtmlData(t))},_to:function(t,r,n,i){var a=e.queue((function(){r(t)}));this.each((function(e){n(e,t,a,i)})),a.check()},toHtmlData:function(t){this._to(r.createDocumentFragment(),t,(function(t,n){var i,a=t.blob;t.file?(e.reset(a),a.name=t.name,n.appendChild(a)):((i=r.createElement("input")).name=t.name,i.type="hidden",i.value=a,n.appendChild(i))}))},toPlainData:function(e){this._to({},e,(function(e,t,r){e.file&&(t.type=e.file),e.blob.toBlob?(r.inc(),e.blob.toBlob((function(n){t.name=e.name,t.file=n,t.size=n.length,t.type=e.type,r.next()}),"image/png")):e.file?(t.name=e.blob.name,t.file=e.blob,t.size=e.blob.size,t.type=e.type):(t.params||(t.params=[]),t.params.push(encodeURIComponent(e.name)+"="+encodeURIComponent(e.blob))),t.start=-1,t.end=-1,t.retry=0}))},toFormData:function(e){this._to(new i,e,(function(e,t,r){e.file&&t.append("_"+e.name,e.file),e.blob&&e.blob.toBlob?(r.inc(),e.blob.toBlob((function(n){t.append(e.name,n,e.file),r.next()}),"image/png")):e.file?t.append(e.name,e.blob,e.file):t.append(e.name,e.blob)}))},toMultipartData:function(t){this._to([],t,(function(e,t,r,i){t.push("--_"+i+'\r\nContent-Disposition: form-data; name="'+e.name+'"'+(e.file?'; filename="'+n(e.file)+'"':"")+(e.file?"\r\nContent-Type: "+(e.type||"application/octet-stream"):"")+"\r\n\r\n"+(e.file?e.blob:n(e.blob))+"\r\n")}),e.expando)}},e.Form=t}(FileAPI,window,document),function(e,t){var r=function(){},n=function(e){this.uid=t.uid(),this.xhr={abort:r,getResponseHeader:r,getAllResponseHeaders:r},this.options=e};n.prototype={status:0,statusText:"",getResponseHeader:function(e){return this.xhr.getResponseHeader(e)},getAllResponseHeaders:function(){return this.xhr.getAllResponseHeaders()||{}},end:function(n,i){var a=this,s=a.options;a.end=a.abort=r,a.status=n,i&&(a.statusText=i),t.log("xhr.end:",n,i),s.complete(200!=n&&201!=n&&(a.statusText||"unknown"),a),a.xhr&&a.xhr.node&&setTimeout((function(){var t=a.xhr.node;try{t.parentNode.removeChild(t)}catch(e){}try{delete e[a.uid]}catch(e){}e[a.uid]=a.xhr.node=null}),9)},abort:function(){this.end(0,"abort"),this.xhr&&(this.xhr.aborted=!0,this.xhr.abort())},send:function(e){var t=this,r=this.options;e.toData((function(e){r.upload(r,t),t._send.call(t,r,e)}),r)},_send:function(r,n){var i,a=this,s=a.uid,o=r.url;t.log("XHR._send:",n),o+=(~o.indexOf("?")?"&":"?")+t.uid(),n.nodeName?(r.upload(r,a),(i=document.createElement("div")).innerHTML='<form target="'+s+'" action="'+o+'" method="POST" enctype="multipart/form-data" style="position: absolute; top: -1000px; overflow: hidden; width: 1px; height: 1px;"><iframe name="'+s+'" src="javascript:false;"></iframe><input value="'+s+'" name="callback" type="hidden"/></form>',a.xhr.abort=function(){var e=i.getElementsByName("iframe")[0];if(e)try{e.stop?e.stop():e.contentWindow.stop?e.contentWindow.stop():e.contentWindow.document.execCommand("Stop")}catch(e){}i=null},(o=i.getElementsByTagName("form")[0]).appendChild(n),t.log(o.parentNode.innerHTML),document.body.appendChild(i),a.xhr.node=i,e[s]=function(e,t,r){a.readyState=4,a.responseText=r,a.end(e,t),i=null},a.readyState=2,o.submit(),o=null):(i=a.xhr=t.getXHR(),n.params&&(o+=(0>o.indexOf("?")?"?":"&")+n.params.join("&")),i.open("POST",o,!0),i.withCredential="true",(!r.headers||!r.headers["X-Requested-With"])&&i.setRequestHeader("X-Requested-With","XMLHttpRequest"),t.each(r.headers,(function(e,t){i.setRequestHeader(t,e)})),r._chunked?(i.upload&&i.upload.addEventListener("progress",(function(e){n.retry||r.progress({type:e.type,total:n.size,loaded:n.start+e.loaded,totalSize:n.size},a,r)}),!1),i.onreadystatechange=function(){if(a.status=i.status,a.statusText=i.statusText,a.readyState=i.readyState,4==i.readyState){for(var e in{"":1,XML:1,Text:1,Body:1})a["response"+e]=i["response"+e];if(i.onreadystatechange=null,!i.status||0<i.status-201)if(t.log("Error: "+i.status),(!i.status&&!i.aborted||500==i.status||416==i.status)&&++n.retry<=r.chunkUploadRetry){e=i.status?0:t.chunkNetworkDownRetryTimeout,r.pause(n.file,r);var s=i.getResponseHeader("X-Last-Known-Byte");t.log("X-Last-Known-Byte: "+s),n.end=s?parseInt(s):n.start-1,setTimeout((function(){a._send(r,n)}),e)}else a.end(i.status);else n.retry=0,n.end==n.size-1?a.end(i.status):setTimeout((function(){a._send(r,n)}),0);i=null}},n.start=n.end+1,n.end=Math.min(n.start+r.chunkSize,n.size)-1,(s="slice")in n.file||(s="mozSlice")in n.file||(s="webkitSlice"),i.setRequestHeader("Content-Range","bytes "+n.start+"-"+n.end+"/"+n.size),i.setRequestHeader("Content-Disposition","attachment; filename="+encodeURIComponent(n.name)),i.setRequestHeader("Content-Type",n.type||"application/octet-stream"),s=n.file[s](n.start,n.end+1),i.send(s),s=null):(i.upload&&i.upload.addEventListener("progress",t.throttle((function(e){r.progress(e,a,r)}),100),!1),i.onreadystatechange=function(){if(a.status=i.status,a.statusText=i.statusText,a.readyState=i.readyState,4==i.readyState){for(var e in{"":1,XML:1,Text:1,Body:1})a["response"+e]=i["response"+e];i.onreadystatechange=null,a.end(i.status),i=null}},t.isArray(n)?(i.setRequestHeader("Content-Type","multipart/form-data; boundary=_"+t.expando),n=n.join("")+"--_"+t.expando+"--",i.sendAsBinary?i.sendAsBinary(n):(s=Array.prototype.map.call(n,(function(e){return 255&e.charCodeAt(0)})),i.send(new Uint8Array(s).buffer))):i.send(n)))}},t.XHR=n}(window,FileAPI),function(e,t,r){var n=e.support,i=t.navigator,a=i.mimeTypes,s=!1;if(i.plugins&&"object"==typeof i.plugins["Shockwave Flash"])s=i.plugins["Shockwave Flash"].description&&!(a&&a["application/x-shockwave-flash"]&&!a["application/x-shockwave-flash"].enabledPlugin);else try{s=!(!t.ActiveXObject||!new ActiveXObject("ShockwaveFlash.ShockwaveFlash"))}catch(t){e.log("ShockwaveFlash.ShockwaveFlash -- does not supported.")}if(n.flash=s,e.support.flash&&(!e.support.html5||e.cors&&!e.support.cors)){var o=function(e){return('<object id="#id#" classid="clsid:D27CDB6E-AE6D-11cf-96B8-444553540000" width="'+(e.width||"100%")+'" height="'+(e.height||"100%")+'"><param name="movie" value="#src#" /><param name="flashvars" value="#flashvars#" /><param name="swliveconnect" value="true" /><param name="allowscriptaccess" value="always" /><param name="allownetworking" value="all" /><param name="menu" value="false" /><param name="wmode" value="#wmode#" /><embed flashvars="#flashvars#" swliveconnect="true" allownetworking="all" allowscriptaccess="always" name="#id#" src="#src#" width="'+(e.width||"100%")+'" height="'+(e.height||"100%")+'" menu="false" wmode="transparent" type="application/x-shockwave-flash"></embed></object>').replace(/#(\w+)#/gi,(function(t,r){return e[r]}))},l=function(e,t){var r,n;if(e&&e.style)for(r in t){"number"==typeof(n=t[r])&&(n+="px");try{e.style[r]=n}catch(e){}}},c=function(t,r){e.each(r,(function(e,r){var n=t[r];t[r]=function(){return this.parent=n,e.apply(this,arguments)}}))},u=function(t){var r=t.wid=e.uid();return T._fn[r]=t,"FileAPI.Flash._fn."+r},h=function(e){try{T._fn[e.wid]=null,delete T._fn[e.wid]}catch(e){}},f=function(e,t){if(!g.test(e)){var r;if(/^\.\//.test(e)||"/"!=e.charAt(0))e=((r=(r=location.pathname).substr(0,r.lastIndexOf("/")))+"/"+e).replace("/./","/");"//"!=e.substr(0,2)&&(e="//"+location.host+e),g.test(e)||(e=location.protocol+e)}return t&&(e+=(/\?/.test(e)?"&":"?")+t),e},d=e.uid(),p=0,m={},g=/^https?:/i,T={_fn:{},init:function(){var t=r.body&&r.body.firstChild;if(t)do{if(1==t.nodeType){e.log("FlashAPI.Flash.init...");var n=r.createElement("div");return l(n,{top:1,right:1,width:5,height:5,position:"absolute"}),t.parentNode.insertBefore(n,t),void T.publish(n,d)}}while(t=t.nextSibling);10>p&&setTimeout(T.init,50*++p)},publish:function(t,r){t.innerHTML=o({id:r,src:f(e.flashUrl,"r="+e.version),wmode:"transparent",flashvars:"callback=FileAPI.Flash.event&flashId="+r+"&storeKey="+navigator.userAgent.match(/\d/gi).join("")+"_"+e.version+(T.isReady||(e.pingUrl?"&ping="+e.pingUrl:""))})},ready:function(){T.ready=e.F,T.isReady=!0,T.patch(),e.event.on(r,"mouseover",T.mouseover),e.event.on(r,"click",(function(e){T.mouseover(e)&&(e.preventDefault?e.preventDefault():e.returnValue=!0)}))},getWrapper:function(e){do{if(/js-fileapi-wrapper/.test(e.className))return e}while((e=e.parentNode)&&e!==r.body)},mouseover:function(t){if(t=e.event.fix(t).target,/input/i.test(t.nodeName)&&"file"==t.type){if("i"==(n=t.getAttribute(d))||"r"==n)return!1;if("p"!=n){t.setAttribute(d,"i");var n=r.createElement("div"),i=T.getWrapper(t);if(!i)return void e.log("flash.mouseover.error: js-fileapi-wrapper not found");l(n,{top:0,left:0,width:"100%",height:"100%",zIndex:1e6,position:"absolute"}),i.appendChild(n),T.publish(n,e.uid()),t.setAttribute(d,"p")}return!0}},event:function(t){var r=t.type;if("ready"==r){try{T.getInput(t.flashId).setAttribute(d,"r")}catch(e){}return T.ready(),setTimeout((function(){T.mouseenter(t)}),50),!0}"ping"===r?e.log("(flash -> js).ping:",[t.status,t.savedStatus],t.error):"log"===r?e.log("(flash -> js).log:",t.target):r in T&&setTimeout((function(){e.log("Flash.event."+t.type+":",t),T[r](t)}),1)},mouseenter:function(t){var r=T.getInput(t.flashId);if(r){T.cmd(t,"multiple",null!=r.getAttribute("multiple"));var n=[],i={};e.each((r.getAttribute("accept")||"").split(/,\s*/),(function(t){e.accept[t]&&e.each(e.accept[t].split(" "),(function(e){i[e]=1}))})),e.each(i,(function(e,t){n.push(t)})),T.cmd(t,"accept",n.length?"."+n.join(",."):"*")}},get:function(e){return r[e]||t[e]||r.embeds[e]},getInput:function(t){try{var r=T.getWrapper(T.get(t));if(r)return r.getElementsByTagName("input")[0]}catch(r){e.log('Can not find "input" by flashId:',t,r)}},select:function(t){var n=T.getInput(t.flashId),i=e.uid(n);t=t.target.files,e.each(t,(function(t){e.checkFileObj(t)})),m[i]=t,r.createEvent?((i=r.createEvent("Event")).initEvent("change",!0,!1),n.dispatchEvent(i)):r.createEventObject&&(i=r.createEventObject(),n.fireEvent("onchange",i))},cmd:function(t,r,n,i){try{return e.log("(js -> flash)."+r+":",n),T.get(t.flashId||t).cmd(r,n)}catch(a){e.log("(js -> flash).onError:",a),i||setTimeout((function(){T.cmd(t,r,n,!0)}),50)}},patch:function(){e.flashEngine=e.support.transform=!0,c(e,{getFiles:function(t,r,n){if(n)return e.filterFiles(e.getFiles(t),r,n),null;var i=e.isArray(t)?t:m[e.uid(t.target||t.srcElement||t)];return i?(r&&(r=e.getFilesFilter(r),i=e.filter(i,(function(e){return r.test(e.name)}))),i):this.parent.apply(this,arguments)},getInfo:function(e,t){if(e&&!e.flashId)this.parent.apply(this,arguments);else{if(!e.__info){var r=e.__info=FileAPI.defer();T.cmd(e,"getFileInfo",{id:e.id,callback:u((function t(n,i){h(t),r.resolve(n,e.info=i)}))})}e.__info.then(t)}}}),e.support.transform=!0,FileAPI.Image&&c(FileAPI.Image.prototype,{get:function(e,t){this.set({scaleMode:t||"noScale"}),this.parent(e)},_load:function(t,r){if(e.log("FileAPI.Image._load:",t),t&&!t.flashId)this.parent.apply(this,arguments);else{var n=this;e.getInfo(t,(function(e){r.call(n,e,t)}))}},_apply:function(t,n){if(e.log("FileAPI.Image._apply:",t),t&&!t.flashId)this.parent.apply(this,arguments);else{var i=this.getMatrix(t.info);T.cmd(t,"imageTransform",{id:t.id,matrix:i,callback:u((function a(s,c){if(e.log("FileAPI.Image._apply.callback:",s),h(a),s)n(s);else if(!e.support.dataURI||3e4<c.length){var d,p={width:i.deg%180?i.dh:i.dw,height:i.deg%180?i.dw:i.dh,scale:i.scaleMode},m=n,g=function(){try{T.get(y).setImage(c)}catch(t){e.log('flash.setImage -- can not set "base64":',t)}},y=e.uid(),v=r.createElement("div");for(d in p)v.setAttribute("data-img-"+d,p[d]);l(v,p),v.innerHTML=o(e.extend({id:y,src:f(e.flashImageUrl,"r="+e.uid()),wmode:"opaque",flashvars:"scale="+p.scale+"&callback="+u((function e(){return h(e),setTimeout(g,99),!0}))},p)),m(!1,v),v=null}else{var E=new Image;e.event.one(E,"error abort load",(function(e){n("load"!=e.type&&e.type,E),E=null})),E.src="data:"+t.type+";base64,"+c}}))})}},toData:function(e){var t=this.file;t&&!t.flashId?this.parent.apply(this,arguments):e.call(this,!t.info,{id:t.id,flashId:t.flashId,name:t.name,type:t.type,matrix:this.getMatrix(t.info)})}}),c(e.Form.prototype,{toData:function(t){for(var r=this.items,n=r.length;n--;)if(r[n].file&&r[n].blob&&!r[n].blob.flashId)return this.parent.apply(this,arguments);e.log("flash.Form.toData"),t(r)}}),c(e.XHR.prototype,{_send:function(t,r){if(r.nodeName||r.append&&e.support.html5||e.isArray(r)&&"string"==typeof r[0])return this.parent.apply(this,arguments);var n,i,a={},s={},o=this;e.each(r,(function(e){e.file?(s[e.name]=e={id:e.blob.id,name:e.blob.name,matrix:e.blob.matrix,flashId:e.blob.flashId},i=e.id,n=e.flashId):a[e.name]=e.blob})),e.log("flash.XHR._send:",n,i,s),o.xhr={headers:{},abort:function(){T.cmd(n,"abort",{id:i})},getResponseHeader:function(e){return this.headers[e]},getAllResponseHeaders:function(){return this.headers}};var l=e.queue((function(){T.cmd(n,"upload",{url:f(t.url),data:a,files:s,headers:t.headers,callback:u((function r(n){var i=n.type,a=n.result;e.log("flash.upload."+i+":",n),"progress"==i?(n.loaded=Math.min(n.loaded,n.total),n.lengthComputable=!0,t.progress(n)):"complete"==i?(h(r),"string"==typeof a&&(o.responseText=a.replace(/%22/g,'"').replace(/%5c/g,"\\").replace(/%26/g,"&").replace(/%25/g,"%")),o.end(n.status||200)):"abort"!=i&&"error"!=i||(o.end(n.status||0,n.message),h(r))}))})}));e.each(s,(function(t){l.inc(),e.getInfo(t,l.next)})),l.check()}})}};e.Flash=T;var y=new Image;e.event.one(y,"error load",(function(){e.support.dataURI=!(1!=y.width||1!=y.height),y=null,T.init()})),y.src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///ywAAAAAAQABAAACAUwAOw=="}}(FileAPI,window,document),"undefined"!=typeof ajs&&ajs.loaded&&ajs.loaded("{fileapi}FileAPI.min"),"function"==typeof define&&define.amd&&define("FileAPI",[],(function(){return window.FileAPI||{}})),function(e){e.event.dnd=function(t,r,n){var i,a;n||(n=r,r=j.F),FileReader?(e.event.on(t,"dragenter dragleave dragover",(function(e){e.dataTransfer&&"copy"!==e.dataTransfer.dropEffect&&(e.dataTransfer.dropEffect="copy");for(var t=((e.originalEvent||e||"").dataTransfer||{}).types,n=t&&t.length;n--;)~t[n].indexOf("File")&&(e.preventDefault(),a!==e.type&&("dragleave"!=(a=e.type)&&r.call(e.currentTarget,!0,e),clearTimeout(i),i=setTimeout((function(){r.call(e.currentTarget,"dragleave"!=a,e)}),50)))})),e.event.on(t,"drop",(function(t){t.preventDefault(),a=0,r.call(t.currentTarget,!1,t),e.getDropFiles(t,(function(e){n.call(t.currentTarget,e,t)}))}))):e.log("Drag'n'Drop -- not supported")}}(FileAPI),function(){var e=function(){};!function(){"use strict";var t={};void 0!==r&&(t=r);var r=t;t.version="0.0.11",t.config={textDiffMinLength:60,detectArrayMove:!0,includeValueOnArrayMove:!1};var n="function"==typeof Array.prototype.indexOf?function(e,t){return e.indexOf(t)}:function(e,t){for(var r=e.length,n=0;n<r;n++)if(e[n]===t)return n;return-1},i={diff:function(e,r,i,a){for(var s,o,l,c=0,u=0,h=e.length,f=r.length,d=[],p=[],m="function"==typeof i?function(e,t,r,n){return e===t||"object"==typeof e&&"object"==typeof t&&("number"==typeof r?void 0===(a=d[r])&&(d[r]=a=i(e)):a=i(e),"number"==typeof n?void 0===(s=p[n])&&(p[n]=s=i(t)):s=i(t),a===s);var a,s}:function(e,t){return e===t},g=function(t,n){return m(e[t],r[n],t,n)},T=function(t,n){if(a&&"object"==typeof e[t]&&"object"==typeof r[n]){var i=a(e[t],r[n]);void 0!==i&&(l||(l={_t:"a"}),l[n]=i)}};c<h&&c<f&&g(c,c);)T(c,c),c++;for(;u+c<h&&u+c<f&&g(h-1-u,f-1-u);)T(h-1-u,f-1-u),u++;if(c+u===h){if(h===f)return l;for(l=l||{_t:"a"},s=c;s<f-u;s++)l[s]=[r[s]];return l}if(c+u===f){for(l=l||{_t:"a"},s=c;s<h-u;s++)l["_"+s]=[e[s],0,0];return l}var y=this.lcs(e.slice(c,h-u),r.slice(c,f-u),{areTheSameByIndex:function(e,t){return g(e+c,t+c)}});l=l||{_t:"a"};var v=[];for(s=c;s<h-u;s++)n(y.indices1,s-c)<0&&(l["_"+s]=[e[s],0,0],v.push(s));var E=v.length;for(s=c;s<f-u;s++){var C=n(y.indices2,s-c);if(C<0){var b=!1;if(t.config.detectArrayMove&&E>0)for(o=0;o<E;o++)if(g(v[o],s)){l["_"+v[o]].splice(1,2,s,3),t.config.includeValueOnArrayMove||(l["_"+v[o]][0]=""),T(v[o],s),v.splice(o,1),b=!0;break}b||(l[s]=[r[s]])}else T(y.indices1[C]+c,y.indices2[C]+c)}return l},getArrayIndexBefore:function(e,t){var r,n=t;for(var i in e)if(e.hasOwnProperty(i)&&s(e[i]))if(r="_"===i.slice(0,1)?parseInt(i.slice(1),10):parseInt(i,10),1===e[i].length){if(r<t)n--;else if(r===t)return-1}else if(3===e[i].length)if(0===e[i][2])r<=t&&n++;else if(3===e[i][2])if(r<=t&&n++,e[i][1]>t)n--;else if(e[i][1]===t)return r;return n},patch:function(e,t,r,n){var i,a,s,o=[],l=[],c=[];for(i in t)if("_t"!==i)if("_"==i[0]){if(0!==t[i][2]&&3!==t[i][2])throw new Error("only removal or move can be applied at original array indices, invalid diff type: "+t[i][2]);o.push(parseInt(i.slice(1),10))}else 1===t[i].length?l.push({index:parseInt(i,10),value:t[i][0]}):c.push({index:parseInt(i,10),diff:t[i]});for(i=(o=o.sort((function(e,t){return e-t}))).length-1;i>=0;i--){var u=t["_"+(a=o[i])],h=e.splice(a,1)[0];3===u[2]&&l.push({index:u[1],value:h})}var f=(l=l.sort((s="index",function(e,t){return e[s]-t[s]}))).length;for(i=0;i<f;i++){var d=l[i];e.splice(d.index,0,d.value)}var p=c.length;if(p>0){if("function"!=typeof r)throw new Error("to patch items in the array an objectInnerPatch function must be provided");for(i=0;i<p;i++){var m=c[i];r(e,m.index.toString(),m.diff,n)}}return e},lcs:function(e,t,r){r.areTheSameByIndex=r.areTheSameByIndex||function(r,n){return e[r]===t[n]};var n=this.lengthMatrix(e,t,r),i=this.backtrack(n,e,t,e.length,t.length);return"string"==typeof e&&"string"==typeof t&&(i.sequence=i.sequence.join("")),i},lengthMatrix:function(e,t,r){var n,i,a=e.length,s=t.length,o=[a+1];for(n=0;n<a+1;n++)for(o[n]=[s+1],i=0;i<s+1;i++)o[n][i]=0;for(o.options=r,n=1;n<a+1;n++)for(i=1;i<s+1;i++)r.areTheSameByIndex(n-1,i-1)?o[n][i]=o[n-1][i-1]+1:o[n][i]=Math.max(o[n-1][i],o[n][i-1]);return o},backtrack:function(e,t,r,n,i){if(0===n||0===i)return{sequence:[],indices1:[],indices2:[]};if(e.options.areTheSameByIndex(n-1,i-1)){var a=this.backtrack(e,t,r,n-1,i-1);return a.sequence.push(t[n-1]),a.indices1.push(n-1),a.indices2.push(i-1),a}return e[n][i-1]>e[n-1][i]?this.backtrack(e,t,r,n,i-1):this.backtrack(e,t,r,n-1,i)}};t.sequenceDiffer=i,t.dateReviver=function(e,t){var r;return"string"==typeof t&&(r=/^(\d{4})-(\d{2})-(\d{2})T(\d{2}):(\d{2}):(\d{2}(?:\.\d*)?)(Z|([+\-])(\d{2}):(\d{2}))$/.exec(t))?new Date(Date.UTC(+r[1],+r[2]-1,+r[3],+r[4],+r[5],+r[6])):t};var a=function(){var e;if(t.config.diff_match_patch&&(e=new t.config.diff_match_patch.diff_match_patch),"undefined"!=typeof diff_match_patch&&("function"==typeof diff_match_patch?e=new diff_match_patch:"object"==typeof diff_match_patch&&"function"==typeof diff_match_patch.diff_match_patch&&(e=new diff_match_patch.diff_match_patch)),e)return t.config.textDiff=function(t,r){return e.patch_toText(e.patch_make(t,r))},t.config.textPatch=function(t,r){for(var n=e.patch_apply(e.patch_fromText(r),t),i=0;i<n[1].length;i++)if(!n[1][i])throw new Error("text patch failed");return n[0]},!0},s=t.isArray="function"==typeof Array.isArray?Array.isArray:function(e){return"object"==typeof e&&e instanceof Array},o=t.isDate=function(e){return e instanceof Date||"[object Date]"===Object.prototype.toString.call(e)},l=t.diff=function(e,r){var n,c,u,h,f;if(e!==r&&(e==e||r==r)&&(n=typeof r,u=null===r,h=null===e,"object"==(c=typeof e)&&o(e)&&(c="date"),"object"!=n||!o(r)||(n="date","date"!=c||e.getTime()!==r.getTime()))){if(u||h||"undefined"==n||n!=c||"number"==n||"number"==c||"boolean"==n||"boolean"==c||"string"==n||"string"==c||"date"==n||"date"==c||"object"===n&&s(r)!=s(e)){if(f=[],void 0!==e)if(void 0!==r){var d="string"==n&&"string"==c&&Math.min(e.length,r.length)>t.config.textDiffMinLength;d&&!t.config.textDiff&&a(),d&&t.config.textDiff?f.push(t.config.textDiff(e,r),0,2):(f.push(e),f.push(r))}else f.push(e),f.push(0,0);else f.push(r);return f}return s(r)?function(e,r){return i.diff(e,r,t.config.objectHash,t.diff)}(e,r):function(e,t){var r,n,i,a;for(i in a=function(i){void 0!==(n=l(e[i],t[i]))&&(void 0===r&&(r={}),r[i]=n)},t)t.hasOwnProperty(i)&&a(i);for(i in e)e.hasOwnProperty(i)&&void 0===t[i]&&a(i);return r}(e,r)}},c=function(e,t){return s(e)?e[parseInt(t,10)]:e[t]};t.getByKey=c;var u=function(e,t,r){if(s(e)&&e._key){var n=e._key;"function"!=typeof e._key&&(n=function(t){return t[e._key]});for(var i=0;i<e.length;i++)if(n(e[i])===t)return void(void 0===r?(e.splice(i,1),i--):e[i]=r);void 0!==r&&e.push(r)}else void 0===r?s(e)?e.splice(t,1):delete e[t]:e[t]=r},h=function(e){return t.config.textDiffReverse||(t.config.textDiffReverse=function(e){var t,r,n,i,a=null,s=/^@@ +\-(\d+),(\d+) +\+(\d+),(\d+) +@@$/;for(t=0,r=(n=e.split("\n")).length;t<r;t++){var o=(i=n[t]).slice(0,1);"@"===o?(a=s.exec(i),null,null,n[t]="@@ -"+a[3]+","+a[4]+" +"+a[1]+","+a[2]+" @@"):"+"==o?(t,n[t]="-"+n[t].slice(1)):"-"==o&&(t,n[t]="+"+n[t].slice(1))}return n.join("\n")}),t.config.textDiffReverse(e)},f=t.reverse=function(e){var t,r;if(void 0!==e){if(null===e)return null;if("object"==typeof e&&!o(e)){if(s(e)){if(e.length<3)return 1===e.length?[e[0],0,0]:[e[1],e[0]];if(0===e[2])return[e[0]];if(2===e[2])return[h(e[0]),0,2];throw new Error("invalid diff type")}if(r={},"a"===e._t){for(t in e)if(e.hasOwnProperty(t)&&"_t"!==t){var n,a=t;if(n="_"===t.slice(0,1)?parseInt(t.slice(1),10):parseInt(t,10),s(e[t]))if(1===e[t].length)a="_"+n;else if(2===e[t].length)a=i.getArrayIndexBefore(e,n);else if(0===e[t][2])a=n.toString();else{if(3===e[t][2]){r[a="_"+e[t][1]]=[e[t][0],n,3];continue}a=i.getArrayIndexBefore(e,n)}else a=i.getArrayIndexBefore(e,n);r[a]=f(e[t])}r._t="a"}else for(t in e)e.hasOwnProperty(t)&&(r[t]=f(e[t]));return r}return"string"==typeof e&&"@@"===e.slice(0,2)?h(e):e}},d=t.patch=function(e,n,o,l){var h,f,p,m="";if("string"!=typeof n?(l=o,o=n,n=null):"object"!=typeof e&&(n=null),l&&(m+=l),m+="/",null!==n&&(m+=n),"object"==typeof o)if(s(o)){if(o.length<3)return f=o[o.length-1],null!==n&&u(e,n,f),f;if(0!==o[2]){if(2===o[2]){if(t.config.textPatch||a(),!t.config.textPatch)throw new Error("textPatch function not found");try{f=t.config.textPatch(c(e,n),o[0])}catch(e){throw new Error('cannot apply patch at "'+m+'": '+e)}return null!==n&&u(e,n,f),f}throw 3===o[2]?new Error("Not implemented diff type: "+o[2]):new Error("invalid diff type: "+o[2])}if(null===n)return;u(e,n)}else if("a"==o._t){if("object"!=typeof(p=null===n?e:c(e,n))||!s(p))throw new Error('cannot apply patch at "'+m+'": array expected');i.patch(p,o,r.patch,m)}else{if("object"!=typeof(p=null===n?e:c(e,n))||s(p))throw new Error('cannot apply patch at "'+m+'": object expected');for(h in o)o.hasOwnProperty(h)&&d(p,h,o[h],m)}return e};t.unpatch=function(e,t,r,n){return"string"!=typeof t?d(e,f(t),r):d(e,t,f(r),n)};"function"==typeof require&&"object"==typeof exports&&"object"==typeof module?module.exports=t:e.amd||("undefined"!=typeof window?window.jsondiffpatch=t:self.jsondiffpatch=t)}()}();var JSON5="object"==typeof exports?exports:{};function ownKeys(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function _objectSpread(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?ownKeys(Object(r),!0).forEach((function(t){_defineProperty(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):ownKeys(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function _defineProperty(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function _typeof(e){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function _toConsumableArray(e){return _arrayWithoutHoles(e)||_iterableToArray(e)||_unsupportedIterableToArray(e)||_nonIterableSpread()}function _nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _unsupportedIterableToArray(e,t){if(e){if("string"==typeof e)return _arrayLikeToArray(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?_arrayLikeToArray(e,t):void 0}}function _iterableToArray(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}function _arrayWithoutHoles(e){if(Array.isArray(e))return _arrayLikeToArray(e)}function _arrayLikeToArray(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}JSON5.parse=function(){"use strict";var e,t,r,n,i={"'":"'",'"':'"',"\\":"\\","/":"/","\n":"",b:"\b",f:"\f",n:"\n",r:"\r",t:"\t"},a=[" ","\t","\r","\n","\v","\f"," ","\ufeff"],s=function(t){var n=new SyntaxError;throw n.message=t,n.at=e,n.text=r,n},o=function(n){return n&&n!==t&&s("Expected '"+n+"' instead of '"+t+"'"),t=r.charAt(e),e+=1,t},l=function(){return r.charAt(e)},c=function(){var e=t;for("_"!==t&&"$"!==t&&("a">t||t>"z")&&("A">t||t>"Z")&&s("Bad identifier");o()&&("_"===t||"$"===t||t>="a"&&"z">=t||t>="A"&&"Z">=t||t>="0"&&"9">=t);)e+=t;return e},u=function(){var e,r="",n="",i=10;if(("-"===t||"+"===t)&&(r=t,o(t)),"I"===t)return("number"!=typeof(e=p())||isNaN(e))&&s("Unexpected word for number"),"-"===r?-e:e;if("N"===t)return e=p(),isNaN(e)||s("expected word to be NaN"),e;switch("0"===t&&(n+=t,o(),"x"===t||"X"===t?(n+=t,o(),i=16):t>="0"&&"9">=t&&s("Octal literal")),i){case 10:for(;t>="0"&&"9">=t;)n+=t,o();if("."===t)for(n+=".";o()&&t>="0"&&"9">=t;)n+=t;if("e"===t||"E"===t)for(n+=t,o(),("-"===t||"+"===t)&&(n+=t,o());t>="0"&&"9">=t;)n+=t,o();break;case 16:for(;t>="0"&&"9">=t||t>="A"&&"F">=t||t>="a"&&"f">=t;)n+=t,o()}return e="-"===r?-n:+n,isFinite(e)?e:void s("Bad number")},h=function(){var e,r,n,a,c="";if('"'===t||"'"===t)for(n=t;o();){if(t===n)return o(),c;if("\\"===t)if(o(),"u"===t){for(a=0,r=0;4>r&&(e=parseInt(o(),16),isFinite(e));r+=1)a=16*a+e;c+=String.fromCharCode(a)}else if("\r"===t)"\n"===l()&&o();else{if("string"!=typeof i[t])break;c+=i[t]}else{if("\n"===t)break;c+=t}}s("Bad string")},f=function(){"/"!==t&&s("Not a comment"),o("/"),"/"===t?function(){"/"!==t&&s("Not an inline comment");do{if(o(),"\n"===t||"\r"===t)return void o()}while(t)}():"*"===t?function(){"*"!==t&&s("Not a block comment");do{for(o();"*"===t;)if(o("*"),"/"===t)return void o("/")}while(t);s("Unterminated block comment")}():s("Unrecognized comment")},d=function(){for(;t;)if("/"===t)f();else{if(!(a.indexOf(t)>=0))return;o()}},p=function(){switch(t){case"t":return o("t"),o("r"),o("u"),o("e"),!0;case"f":return o("f"),o("a"),o("l"),o("s"),o("e"),!1;case"n":return o("n"),o("u"),o("l"),o("l"),null;case"I":return o("I"),o("n"),o("f"),o("i"),o("n"),o("i"),o("t"),o("y"),1/0;case"N":return o("N"),o("a"),o("N"),NaN}s("Unexpected '"+t+"'")};return n=function(){switch(d(),t){case"{":return function(){var e,r={};if("{"===t)for(o("{"),d();t;){if("}"===t)return o("}"),r;if(e='"'===t||"'"===t?h():c(),d(),o(":"),r[e]=n(),d(),","!==t)return o("}"),r;o(","),d()}s("Bad object")}();case"[":return function(){var e=[];if("["===t)for(o("["),d();t;){if("]"===t)return o("]"),e;if(","===t?s("Missing array element"):e.push(n()),d(),","!==t)return o("]"),e;o(","),d()}s("Bad array")}();case'"':case"'":return h();case"-":case"+":case".":return u();default:return t>="0"&&"9">=t?u():p()}},function(i,a){var o;return r=String(i),e=0,t=" ",o=n(),d(),t&&s("Syntax error"),"function"==typeof a?function e(t,r){var n,i,s=t[r];if(s&&"object"==typeof s)for(n in s)Object.prototype.hasOwnProperty.call(s,n)&&(void 0!==(i=e(s,n))?s[n]=i:delete s[n]);return a.call(t,r,s)}({"":o},""):o}}(),JSON5.stringify=function(e,t,r){function n(e){return e>="a"&&"z">=e||e>="A"&&"Z">=e||e>="0"&&"9">=e||"_"===e||"$"===e}function i(e){if("string"!=typeof e)return!1;if(!function(e){return e>="a"&&"z">=e||e>="A"&&"Z">=e||"_"===e||"$"===e}(e[0]))return!1;for(var t=1,r=e.length;r>t;){if(!n(e[t]))return!1;t++}return!0}function a(e){return Array.isArray?Array.isArray(e):"[object Array]"===Object.prototype.toString.call(e)}function s(e){for(var t=0;t<h.length;t++)if(h[t]===e)throw new TypeError("Converting circular structure to JSON")}function o(e,t,r){if(!e)return"";e.length>10&&(e=e.substring(0,10));for(var n=r?"":"\n",i=0;t>i;i++)n+=e;return n}function l(e){return f.lastIndex=0,f.test(e)?'"'+e.replace(f,(function(e){var t=d[e];return"string"==typeof t?t:"\\u"+("0000"+e.charCodeAt(0).toString(16)).slice(-4)}))+'"':'"'+e+'"'}if(t&&"function"!=typeof t&&!a(t))throw new Error("Replacer must be a function or an array");var c=function(e,r,n){var i=e[r];return i&&i.toJSON&&"function"==typeof i.toJSON&&(i=i.toJSON()),"function"==typeof t?t.call(e,r,i):t?n||a(e)||t.indexOf(r)>=0?i:void 0:i};JSON5.isWord=i;var u,h=[];r&&("string"==typeof r?u=r:"number"==typeof r&&r>=0&&(u=o(" ",r,!0)));var f=/[\\\"\x00-\x1f\x7f-\x9f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,d={"\b":"\\b","\t":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"},p={"":e};return void 0===e?c(p,"",!0):function e(t,r,n){var f,d,p=c(t,r,n);switch(p&&!function(e){return"[object Date]"===Object.prototype.toString.call(e)}(p)&&(p=p.valueOf()),typeof p){case"boolean":return p.toString();case"number":return isNaN(p)||!isFinite(p)?"null":p.toString();case"string":return l(p.toString());case"object":if(null===p)return"null";if(a(p)){s(p),f="[",h.push(p);for(var m=0;m<p.length;m++)d=e(p,m,!1),f+=o(u,h.length),f+=null==d?"null":d,m<p.length-1?f+=",":u&&(f+="\n");h.pop(),f+=o(u,h.length,!0)+"]"}else{s(p),f="{";var g=!1;for(var T in h.push(p),p)if(p.hasOwnProperty(T)){var y=e(p,T,!1);n=!1,null!=y&&(f+=o(u,h.length),g=!0,f+=(r=i(T)?T:l(T))+":"+(u?" ":"")+y+",")}h.pop(),f=g?f.substring(0,f.length-1)+o(u,h.length)+"}":"{}"}return f;default:return}}(p,"",!0)},Ext.ns("Terrasoft"),Terrasoft.Resources||(Ext.ns("Terrasoft.Resources"),Terrasoft.Resources.ExternalLibraries={},Terrasoft.Resources.ExternalLibraries.CKEditor={BpmonlinesourceTitle:"Редактировать исходный HTML-код",BpmonlineparameterTitle:"Вставить параметр процесса",BpmonlinemacrosTitle:"Вставить макрос",BpmonlineEmailTemplateLink:"Вставить ссылку",BpmonlinemacrosSelectColumn:"Выбрать колонку",BpmonlinemacrosSelectMacros:"Выбрать макрос",BpmonlineemailtemplatelinkAddWebLink:"Вставить web ссылку",BpmonlineEmailTemplateLinkAddObjectLink:"Выбрать ссылку на объект",ColorButtonCaption:"Цвет ссылки",CreateTable:"Вставить таблицу",Insert:"Вставить",Delete:"Удалить"},Terrasoft.Resources.Exception={UnknownException:"UnknownException",NotImplementedException:"NotImplementedException",ItemNotFoundException:"ItemNotFoundException",NullOrEmptyException:"NullOrEmptyException",ArgumentNullOrEmptyException:"ArgumentNullOrEmptyException",ArgumentNullOrEmptyExceptionWithArgumentName:"ArgumentNullOrEmptyException; argumentName: {0}",UnsupportedTypeException:"UnsupportedTypeException",ItemAlreadyExistsException:"ItemAlreadyExistsException",InvalidOperationException:"InvalidOperationException",InvalidObjectState:"InvalidObjectState",InvalidFormatException:"InvalidFormatException",InvalidDateFormatException:"Не верный формат даты",UnauthorizedException:"Сервер не смог авторизовать запрос",QueryExecutionException:"QueryExecutionException",ModuleProcessingException:"ModuleProcessingException",UnknownExpression:"Нераспознанное выражение:",FileExceptionFormat:"Файл: {0}",DirectoryExceptionFormat:"Директория: {0}",FileSystemExceptionFormat:"Код: {0}",FileCreate:"В процессе создания файла произошла ошибка",FileOpen:"В процессе открытия файла произошла ошибка",FileRead:"В процессе чтения файла произошла ошибка",FileWrite:"В процессе записи в файл произошла ошибка",FileCopy:"В процессе копирования файла произошла ошибка",FileSystemAbort:"Операция была прервана",FileSystemNotFound:"Объект не найден",FileSystemSecurity:"Операция небезопасна",FileSystemNotReadable:"Объект невозможно прочитать",FileSystemEncoding:"URL к объекту некорректно сформирован",FileSystemNoModificationAllowed:"Изменение объекта запрещено",FileSystemInvalidState:"Операция невозможна, так как объект находится в некорректном состоянии",FileSystemSyntax:"Формат строки не соответствует ожидаемому",FileSystemInvalidModification:"Данная модификация невозможна",FileSystemQuotaExceeded:"Недостаточно свободного пространства",FileSystemTypeMismatch:"Тип объекта не соответствует запрашиваемому",FileSystemPathExists:"Объект по такому пути уже существует",DirectoryCreate:"В процессе создания директории произошла ошибка",DirectoryOpen:"В процессе открытия директории произошла ошибка",DirectoryRemove:"В процессе удаления директории произошла ошибка",DirectoryLookup:"При обращении к директории произошла ошибка",DirectoryRetrieve:"При получении списка директорий произошла ошибка",DirectoryCopy:"В процессе копирования директории произошла ошибка",FileSystemEntryNotImplementedExceptionFormat:"Метод не реализован: {0}",CronExpressionWrongNumberOfArguments:"Неправильное количество параметров в cron выражении"},Terrasoft.appTitle="bpm'online CRM",Terrasoft.Resources.LessConstants={SectionPanelBackgroundColor:"#4d5a75",SectionPanelFontColor:"#ffffff",SectionPanelSelectedBackgroundColor:"#f49d57",SectionPanelSelectedFontColor:"#ffffff"},Terrasoft.Resources.Exception.DataFieldIsRequiredException={DataField:"DataField",IsRequired:"IsRequired"},Terrasoft.Resources.AjaxProvider={ServerUnavailable:"Сервер приложений недоступен",RequestTimeout:"Превышен лимит времени выполнения запроса к серверу приложений",RequestErrorTemplate:"При выполнении запроса возникла ошибка {errorText}\n\tстатус ответа: {errorStatus} ({errorStatusText})\n\turl запроса: {requestUrl}\n\tметод: {requestMethod}\n\tданные запроса: {requestData}"},Terrasoft.Resources.LoginPage={AuthFailed:"Ошибка авторизации",WrongLoginPassword:"Вы ввели неправильный логин или пароль, либо Ваша учетная запись неактивна",WrongNewPassword:"Текущий и новый пароль не должны совпадать",WrongConfirmPassword:"Новый пароль не совпадает с подтверждением",ChangePasswordAccessDenied:"Доступ запрещен. Обратитесь к системному администратору",LoginButtonCaption:"Войти",WorkspaceEditCaption:"Рабочее пространство",LoginEditCaption:"Логин",PasswordEditCaption:"Пароль",RememberMeCaption:"Запомнить меня",Version:"Версия ",Help:"Справка",ForgetPassword:"Забыли пароль?",Register:"Зарегистрироваться",ServerUrl:"Адрес сервера",ServerUrlIsEmpty:"Не указан адрес сервера",GetWorkspaceListError:"Не удалось получить список конфигураций",IsSecureConnectionCaption:"Безопасное соединение",NtlmLogin:"Войти под доменным пользователем",OpenIdLogin:"Войти через Creatio ID",LoginButtonHint:"Войти (Ctrl+Enter)",NtlmLoginLabelHint:"Войти под доменным пользователем (Alt+Enter)"},Terrasoft.Resources.Core={chainContainerError:"Невозможно создать цепочку для контейнера {0}, цепочка уже используется в контейнере {1}",chainModuleRenderError:"Модуль {0} невозможно отрендерить в контейнер {1}, т.к. цепочка уже используется в контейнере {2}, модуль {0} будет отрендерен в контейнер {2}",unsupportedTagsTypeError:"Неподдерживаемый тип! Для указания тегов нужно использовать массив.",userCultureIsUndefined:"Культура пользователя не определена.",InvalidObjectClass:"Объект должен быть экземпляром класса '{0}'.",RenderToElementNotFound:"Элемент {0} не найден",ModuleDescriptorNotFound:"Descriptor for module {0} is not found.",InstanceCreateErrorModuleContextNotFound:"Context for module {0} is not found, component will not be created.",ContextDestroyed:"Chain was aborted. Context is already destoyed."},Terrasoft.Resources.Json={EncodeExceptionMessage:"Ошибка кодирования значения в JSON-строку",DecodeExceptionMessage:"Ошибка декодирования значения из JSON-строки"},Terrasoft.Resources.JsonApplier={},Terrasoft.Resources.JsonApplier.Exception={RequiredParameterNotFound:"Необходимый параметр '{0}' не найден в объекте",NotContainerItemInsertException:"Элемент '{0}' не является контейнером для других элементов",ItemWithItemsPropertyMergeException:"Элемент '{0}' не должен содержать параментра '{1}'",LoopDependency:"Для операции объекта с именем '{0}' существует циклическая зависимость. Параметр parentName не должен быть равным name"},Terrasoft.Resources.JsonApplier.ObsoleteMessages={PropertyInParameterObsolete:"Параметр '{0}' больше не должен содержать '{1}'",ParameterNameObsolete:"Вместо параметра '{0}' следует использовать '{1}'"},Terrasoft.Resources.JsonDiffer={},Terrasoft.Resources.JsonDiffer.Exception={RequiredParameterNotFound:"Необходимый параметр '{0}' не найден в объекте",ItemNameAlreadyExists:"Элемент со значением '{0}' параметра 'name' уже существует",JsonDiffPatchIsNotDefined:"Модуль jsondiffpatch не найден"},Terrasoft.Resources.Router={PageTitleNotImplementedMessage:"Параметр pageTitle не поддерживается"},Terrasoft.Resources.ImageApi={ImageFileNullOrEmptyMessage:"Файл изображения не определен"},Terrasoft.Resources.chain={StepsArgumentUnsupportedTypeMessage:"Шаги цепочки должны быть массивом функций"},Terrasoft.Resources.FilterManager={FilterTypeIsNotAllowedException:"Тип фильтра не поддерживается",FilterGroupIsNotDefined:"Группа фильтров не определена"},Terrasoft.Resources.Controls={Yesterday:"Вчера",Today:"Сегодня",Tommorow:"Завтра",InvalidValue:"Недопустимое значение",RadioControlShouldHaveGroupName:"Для радио-контрола необходимо указать свойство groupName"},Terrasoft.Resources.Controls.Button={ButtonHasNoTemplateFor:"Кнопка не имеет шаблона для",ButtonCaptionApply:"Применить",ButtonCaptionCancel:"Отмена",ButtonStyleBlue:"Синий",ButtonStyleDefault:"По умолчанию",ButtonStyleGray:"Серый",ButtonStyleGreen:"Зеленый",ButtonStyleRed:"Красный",ButtonStyleTransparent:"Прозрачный"},Terrasoft.Resources.Controls.BaseObject={ClassInstanceAlreadyDestroyed:"Экземпляр класса {0} уже уничтожен."},Terrasoft.Resources.Controls.Component={ComponentIsNotRendered:"Компонент не отрисован",RequiredSelectorsAreNotDefined:"Необходимые селекторы не определены",ComponentIsAlreadyRendered:"Компонент {0} уже отрендерен",BindingContextWarningMessage:"Для корректной работы bindingContext используйте this.model вместо аргумента model для привязок элементов"},Terrasoft.Resources.Controls.Menu={MenuItemsPropertyShouldBeAnArray:"Свойства элемента меню должны быть массивом",IndexOutOfRange:"Индекс вне диапазона",MenuHasNoItems:"Элементы меню отсутствуют",Loading:"Загрузка",MenuPrimaryColumnIsEmpty:"Колонка Id не объявлена в ViewModel элемента меню"},Terrasoft.Resources.Controls.MessageBox={ButtonCaptionYes:"Да",ButtonCaptionNo:"Нет",ButtonCaptionCancel:"Отмена",ButtonCaptionClose:"Закрыть",ButtonCaptionOk:"ОК"},Terrasoft.Resources.Controls.BaseSpinner={SpinnersWidthPropertyShouldBeAString:"Свойство ширины элемента прогресса должно быть строковым"},Terrasoft.Resources.Controls.ProgressSpinner={ProgressSpinnersWidthPropertyShouldBeAString:Terrasoft.Resources.Controls.BaseSpinner.SpinnersWidthPropertyShouldBeAString},Terrasoft.Resources.Controls.ScheduleEdit={IsNullTimeScaleParameter:"Свойство временного масштаба не определено",IsNullStartDateParameter:"Свойство начала временного интервала не определено",IsNullEndDateParameter:"Свойство конца временного интервала не определено",IsNullTimeZoneParameter:"Свойство временного пояса не определено",DaysCountShouldBeGreaterThenZero:"Дата начала должна быть меньше даты окончания",SchedulerItemStatusIsNotValid:"Статус элемента расписания задан не корректно"},Terrasoft.Resources.Controls.GridLayoutEdit={PropertyIsNotANumber:"Свойство {0} должно быть числом.",PropertyIsLessThan:"Свойство {0} должно быть больше {1}."},Terrasoft.Resources.Controls.HtmlEdit={HyperlinkDialogCaption:"Ссылка",HyperlinkAddress:"Адресс ссылки",HyperlinkText:"Текст ссылки",InvalidFileTypeMessage:"Недопустимый тип файла"},Terrasoft.Resources.Controls.Bindable={DeprecatedEventMessage:'Deprecated event: "{0}"'},Terrasoft.Resources.Controls.Mask={Caption:"Загрузка",DuplicateContainerException:"По селектору найдено более одного контейнера"},Terrasoft.Resources.ContentBlock={ColumnsWidthIntersected:"В разметке {0} между его элементами {1} и {2} есть пересечения размеров",PrimaryColumnIsEmpty:"Колонка Id не объявлена в ViewModel элемента",SelectBlockButtonTitle:"Select block"},Terrasoft.Resources.EmailContentValidator={DeprecatedHtmlTags:'В коде шаблона содержатся теги "{0}" которые не поддерживаются в HTML5, что может привести к некорректному отображению шаблона в некоторых почтовых клиентах. Пожалуйста, измените шаблон используя стили css'},Terrasoft.Resources.CommonUtils={TrueStringValue:"Да",FalseStringValue:"Нет",InterfaceMemberNotImplementedInClass:"Interface member {0}.{1} not implemented in class {2}"},Terrasoft.Resources.DataProvider={emptyResponseExceptionMessage:"Empty response",timeoutResponseExceptionMessage:"Timed out"},Terrasoft.Resources.BaseEntitySchema={ColumnNotFondException:"Колонка с идентификатором '{0}' не найдена в объекте '{1}'."},Terrasoft.Resources.BaseViewModel={columnUnsupportedTypeException:"Column parameter should have LOOKUP data type",columnIncorrectTypeValidationMessage:"Значение не соответствует типу колонки",columnRequiredValidationMessage:"Необходимо указать значение",columnIncorrectMaxNumberValidationMessage:"Введенное число превышает максимально допустимое значение",columnIncorrectMinNumberValidationMessage:"Введенное число превышает минимально допустимое значение",columnIncorrectTextRangeValidationMessage:"Превышена допустимая длина текста",fieldValidationError:'Поле "{0}": {1}'},Terrasoft.Resources.BaseViewModelCollection={PrimaryColumnValueNotFound:"Primary column value not found"},Terrasoft.Resources.BusinessRules={EnabledBusinessRuleActionCaption:"Разблокировать поле для редактирования",VisibilityBusinessRuleActionCaption:"Показать элемент на странице",FiltrationBusinessRuleActionCaption:"Добавить фильтр значений в поле",RequiredBusinessRuleActionCaption:"Сделать поле обязательным",PopulateBusinessRuleActionCaption:"Заполнить поле по условию"},Terrasoft.Resources.BusinessRules.Expression={Constant:"Константа",SysValue:"Системная переменная",Attribute:"Атрибут",Column:"Колонка",Parameter:"Параметр",SysSetting:"Системная настройка",Detail:"Деталь",Module:"Модуль",Group:"Группа полей",Tab:"Вкладка"},Terrasoft.Resources.BusinessRules.ExpressionPlaceholder={Parameter:"Введите Код",Column:"Введите Код",SysValue:"Введите Код",SysSetting:"Введите Код",Attribute:"Введите Код",Detail:"Введите Код",Module:"Введите Код",Group:"Введите Код",Tab:"Введите Код"},Terrasoft.Resources.Collection={ItemWithKey:"Item with key",ItemWithIndex:"Item with index",DoesNotExists:'doesn"t exist',AlreadyExists:"already exists",ArrayUnsupportedInputType:"Array unsupported input type"},Terrasoft.Resources.BaseObject={Property:"Property",IsNotDefinedInClass:'isn"t defined in class'},Terrasoft.Resources.GroupManager={EmptyGroupName:"Creating group you have to supply group name",GroupWithNameNotFound:"Has no group for groupName"},Terrasoft.Resources.ComparisonType={BETWEEN:"входит в диапазон",IS_NULL:"не заполнено",IS_NOT_NULL:"заполнено",EQUAL:"равно",NOT_EQUAL:"не равно",LESS:"меньше",LESS_OR_EQUAL:"меньше или равно",GREATER:"больше",GREATER_OR_EQUAL:"больше или равно",START_WITH:"начинается на",NOT_START_WITH:"не начинается на",CONTAIN:"содержит",NOT_CONTAIN:"не содержит",END_WITH:"заканчивается на",NOT_END_WITH:"не заканчивается на",EXISTS:"существует",NOT_EXISTS:"не существует"},Terrasoft.Resources.AggregationType={NONE:"операция не выбрана",COUNT:"количество",SUM:"сумма",MIN:"минимум",MAX:"максимум",AVG:"среднее"},Terrasoft.Resources.LogicalOperatorType={AND:"И",OR:"ИЛИ"},Terrasoft.Resources.FilterEdit={DataValueTypeException:"Указан неизвестный тип данных для значения правой части фильтра",WELCOME_INPUT:"&#60;Введите значение&#62;",ADD_FILTER:"Добавить условие",CANCEL_MACROS_DEFAULT:"Сравнить со значением",CANCEL_MACROS_DATE:"Указать точную дату",CANCEL_MACROS_CONTACT:"Выбрать контакт",SELECT_PARAMETER:"Сравнить с Параметром",SELECT_MAIN_RECORD:"Сравнить с основной записью"},Terrasoft.Resources.FilterUtils={FilterTypeShouldBeCompare:"Тип фильтра должен быть Фильтр сравнения"},Terrasoft.Resources.Grid={isEmptyCaption:"Нет данных"},Terrasoft.Resources.GridLayout={ColumnsWidthIntersected:"В разметке {0} между его элементами {1} и {2} есть пересечения размеров",ItemConfigIsEmpty:"У элемента разметки {0} в рядке {1} столбце {2} отсутствует конфигурация элемента управления"},Terrasoft.Resources.FileUpload={caption:"Загрузить"},Terrasoft.Resources.CultureSettings={dateFormat:"d.m.Y",timeFormat:"G:i",thousandSeparator:" ",decimalSeparator:",",todayMessage:"Сегодня",shortDayNames:["Вс","Пн","Вт","Ср","Чт","Пт","Сб"],monthNames:["Январь","Февраль","Март","Апрель","Май","Июнь","Июль","Август","Сентябрь","Октябрь","Ноябрь","Декабрь"],startDay:1,numberGroupSizes:3,isRightToLeft:!1},Terrasoft.Resources.DayNames={Sunday:"Sunday",Monday:"Monday",Tuesday:"Tuesday",Wednesday:"Wednesday",Thursday:"Thursday",Friday:"Friday",Saturday:"Saturday"},Terrasoft.Resources.Telephony={},Terrasoft.Resources.Telephony.Exception={CurrentCallNotExistsException:"Отсутствует текущий звонок. Операция запрещена",ConsultCallNotExistsException:"Отсутствует консультационный звонок. Операция запрещена",CurrentCallNotExistsOrInWrongStateException:"Текущий звонок отсутствует или находится в неверном состоянии. Операция запрещена",SocketConnectionChannelIsNotOpened:"Web-socket канал не открыт"},Terrasoft.Resources.ObsoleteMessages={ArgumentTypeObsoleteMessage:"Тип {0} аргумента {1} устарел. Вместо него используйте {2}",ObsoleteMethodMessage:"Метод {0} устарел. Вместо него используйте {1}",ObsoletePropertyMessage:"Свойство {0} устарело. Вместо него используйте {1}",MethodFormatObsolete:"Формат метода function {0}({1}) устарел. Новый формат function {0}({2})",ObsoleteModule:"Модуль {0} устарел. Вместо него используйте {1}"},Terrasoft.Resources.FilterMacros={HourPrevious:"Предыдущий час",HourCurrent:"Текущий час",HourNext:"Следующий час",HourExact:"Точное время",HourPreviousN:"Предыдущих часов",HourNextN:"Следующих часов",DayYesterday:"Вчера",DayToday:"Сегодня",DayTomorrow:"Завтра",DayOfMonth:"День месяца",DayOfWeek:"День недели",DayPreviousN:"Предыдущих дней",DayNextN:"Следующих дней",WeekPrevious:"Предыдущая неделя",WeekCurrent:"Текущая неделя",WeekNext:"Следущая неделя",MonthPrevious:"Предыдущий месяц",MonthCurrent:"Текущий месяц",MonthNext:"Следующий месяц",MonthExact:"Месяц года",QuarterPrevious:"Предыдущий квартал",QuarterCurrent:"Текущий квартал",QuarterNext:"Следующий квартал",HalfYearPrevious:"Предыдущее полугодие",HalfYearCurrent:"Текущее полугодие",HalfYearNext:"Следующее полугодие",YearPrevious:"Предыдущий год",YearCurrent:"Текущий год",YearNext:"Следующий год",YearExact:"Год",ContactCurrent:"Текущий контакт",UserCurrent:"Текущий пользователь",MacrosTypeGroupHour:"Час",MacrosTypeGroupDay:"День",MacrosTypeGroupDayOfYear:"Ежегодно",MacrosTypeGroupWeek:"Неделя",MacrosTypeGroupMonth:"Месяц",MacrosTypeGroupQuarter:"Квартал",MacrosTypeGroupHalfYear:"Полугодие",MacrosTypeGroupYear:"Год",GetQueryMacrosTypeFilterMacrosTypeException:"Для указанного типа макроса запроса к схеме объекта не найден тип макроса фильтра",GetDatePartTypeFilterMacrosTypeException:"Для указанного типа части даты не найден тип макроса фильтра",DayOfYearToday:"Ежегодно, сегодня",DayOfYearTodayPlusDaysOffset:"Ежегодно, через дней",NextNDaysOfYear:"Ежегодно, следующих дней",PreviousNDaysOfYear:"Ежегодно, предыдущих дней"},Terrasoft.Resources.Managers={},Terrasoft.Resources.Managers.Exceptions={ManagerIsNotInitialized:"Менеджер не инициализирован",FilterFunctionIsNotInitialized:"Функция фильтрации не задана",UsingInvalidSetMethod:"Свойство типа 'Terrasoft.LocalizableString' должно устанавливатся через метод 'setLocalizableStringPropertyValue'",SchemaNamePrefixException:"Название элемента должно содержать префикс '{0}'",SaveSchemaErrorTemplate:"Не удалось сохранить схему. Название: {0}. Заголовок: {1}. Ошибка: {2}. Обратитесь к администратору системы."},Terrasoft.Resources.Managers.Messages={MarkerCommentsValidationMessage:"Схема не содержит маркерных коментариев: '{0}'"},Terrasoft.Resources.SchemaDesigner={SaveButtonCaption:"Сохранить",SaveNewVersionButtonCaption:"Сохранить новую версию",CloseButtonCaption:"Отмена",SaveButtonHint:"Сохранить процесс (Ctrl+S)",AlreadySavedButtonHint:"Все изменения сохранены",RunButtonCaption:"Запустить",RunButtonHint:"Запустить процесс (Ctrl+Enter)",SavingMaskCaption:"Сохранение...",ActionsButtonCaption:"Действия",ProcessPropertiesButtonHint:"Параметры процесса",SchemaSavedMessage:"Процесс успешно сохранен",FieldValidationError:'Поле "{0}": {1}',ProcessCaptionColumnCaption:"Заголовок процесса",MustBePublishedMessage:"Перед запуском процесс необходимо опубликовать.",RequireCompilationMessage:"Элементы или условия, требующие компиляции: {0}.",SchemaSavedErrorsMessage:"При сохранении процесса обнаружены ошибки. Процесс не может работать с текущими настройками.",ErrorMessages:"Схема содержит ошибки: {0}.",PublishButtonCaption:"Опубликовать",PublishingMaskCaption:"Публикация...",SourceCodeMenuItemCaption:"Исходный код (Ctrl+K)",MetaDataMenuItemCaption:"Метаданные (Ctrl+M)",LeftPanelHeaderButtonCaption:"Элементы процесса",CopyMenuItemCaption:"Копировать диаграмму",SchemaCopiedMessage:"Процесс успешно скопирован",CopySuffixCaption:" - Копия",CopyElementMenuItemCaption:"Копировать элемент (Ctrl+C)",PasteElementMenuItemCaption:"Вставить элемент (Ctrl+V)",HelpButtonHint:"Перейти к справке (F1)",FeedButtonHint:"Лента",ProcessLogMenuItemCaption:"Process Log (Ctrl+L)",ExportMetaDataItemCaption:"Экспорт метаданных",LoadStorageLabel:"У Вас есть несохраненные данные. Загрузить их?",LoadStorageButtonCaption:"Загрузить",DiscardStorageButtonCaption:"Отменить",AllChangesSaved:"Все изменения сохранены",SearchShowButtonHint:"Поиск элементов (Ctrl+F)",SearchTextEditPlaceholder:"Введите название или код элемента",SearchInfoTemplate:"{0} из {1}",SearchPreviousButtonHint:"Перейти к предыдущему (Shift+F3)",SearchNextButtonHint:"Перейти к следующему (F3)",SearchButtonHint:"Поиск элементов (Enter)",SearchHideButtonHint:"Спрятать поиск (Esc)",EditItemFromForeignPackageMessage:'Элемент "{0}" создан сторонним издателем или установлен из файлового архива. Сохранение изменений для данного элемента будет невозможно.',PackageElementEditWithoutLockMessage:"Вы не сможете зафиксировать изменения этого элемента в хранилище, а при следующем обновлении из хранилища можете потерять изменения.",ActualizeSchemaMessage:"Установить актуальной",ActualizeSchemaResultMessage:"Текущая версия процесса установлена актуальной",ActualSchemaSetErrorMessage:"Ошибка при установке текущей версии схемы как активной",ExistsRunningProcessQuestion:"По процессу есть запущенные экземпляры. Сохранение изменений в текущем процессе может привести к неработоспособности запущенных экземпляров процесса",SchemaWasExported:"Процесс был экспортирован. Сохранение изменений в текущем процессе может привести к неработоспособности запущенных экземпляров процесса",SchemaCreatesInForeighnMaintainerQuestion:"Процесс создан сторонним издателем или установлен из файлового архива. Сохранение изменений в текущем процессе невозможно",NeedSetActualSchemaVersionConfirmationMessage:'Установить текущую версию процесса "{0}" актуальной?',CloseUnsavedSchemaConfirmation:"Все изменения будут потеряны. Выйти из дизайнера?",SavingProcess:"Сохранение процесса",SaveCurrentVersion:"Сохранить текущую версию (Ctrl+Alt+S)",OpenParentProcessMenuItemCaption:"Открыть родительский процесс"},Terrasoft.Resources.DataValueType={GUID:"Уникальный идентификатор",TEXT:"Строка",SHORT_TEXT:"Строка (50 символов)",MEDIUM_TEXT:"Строка (250 символов)",LONG_TEXT:"Строка (500 символов)",RICH_TEXT:"Форматированный текст",MAXSIZE_TEXT:"Строка неограниченной длины",PHONE_TEXT:"Номер телефона",WEB_TEXT:"Web ссылка",EMAIL_TEXT:"Email адрес",SECURE_TEXT:"Зашифрованная строка",INTEGER:"Целое число",FLOAT:"Дробное число",FLOAT1:"Дробное число (0,1)",FLOAT2:"Дробное число (0,01)",FLOAT3:"Дробное число (0,001)",FLOAT4:"Дробное число (0,0001)",FLOAT8:"Дробное число (0,00000001)",MONEY:"Деньги",DATE_TIME:"Дата/Время",DATE:"Дата",TIME:"Время",LOOKUP:"Справочник",BOOLEAN:"Логическое",BLOB:"Двоичные данные",LOCALIZABLE_STRING:"Локализируемая строка",ENTITY:"Объект (Entity)",ENTITY_COLLECTION:"Коллекция объектов (EntityCollection)",OBJECT_LIST:"Коллекция значений",COMPOSITE_OBJECT_LIST:"Коллекция записей",FILE_LOCATOR:"Файл"},Terrasoft.Resources.SystemValueCaptions={AutoGuid:"New Id",SequentialGuid:"New Sequential Id",CurrentDateTime:"Current Time and Date",CurrentDate:"Current Date",CurrentTime:"Current Time",CurrentUser:"Current user",CurrentUserContact:"Current user contact",CurrentUserAccount:"Account of Current User"},Terrasoft.Resources.ProcessSchemaDesigner={Caption:"Бизнес-процесс",TypeCaption:"Процесс",FitToView:"Отобразить полностью",ResetView:"Сбросить масштаб",ZoomIn:"Уменьшить",ZoomOut:"Увеличить",MiniMapOpen:"Открыть мини-карту",MiniMapClose:"Закрыть мини-карту",ArrowHint:"Активировать выделение",LassoHint:"Активировать инструмент лассо",SpaceToolHint:"Активировать произвольное перемещение"},Terrasoft.Resources.ProcessSchemaDesigner.ElementsToolbarGroup={UserTask:"Действия пользователя",ServiceTask:"Действия системы",Gateway:"Логические операторы",Subprocess:"Подпроцессы",StartEvent:"Начальные события",IntermediateEvent:"Промежуточные события",EndEvent:"Завершающие события"},Terrasoft.Resources.ProcessSchemaDesigner.Elements={UnsupportedElement:"UnsupportedElement",ProcessTypeCaption:"Процесс",StartEventCaption:"Простое",StartTimerEventCaption:"Стартовый таймер",StartMessageCaption:"Сообщение",StartSignalCaption:"Сигнал",TerminateEventCaption:"Останов",BondaryEventCaption:"Граничное событие",IntermediateCatchMessageCaption:"Обработка сообщения",IntermediateCatchSignalCaption:"Обработка сигнала",IntermediateCatchTimerCaption:"Обработка таймера",IntermediateThrowMessageCaption:"Генерация сообщения",IntermediateThrowSignalCaption:"Генерация сигнала",ExclusiveGatewayCaption:'Исключающее "ИЛИ"',ExclusiveEventBasedGatewayCaption:'Исключающее "ИЛИ" по событиям',InclusiveGatewayCaption:'Включающее "ИЛИ"',ParallelGatewayCaption:'Логическое "И"',SubprocessCaption:"Подпроцесс (Действие вызов)",EventSubprocessCaption:"Событийный подпроцесс",ScriptTaskCaption:"Задание-сценарий",FormulaTaskCaption:"Формула",UserTaskCaption:"Действие процесса",ConditionalFlowCaption:"Условный поток",ParameterCaption:"Параметр",DefaultFlowCaption:"Поток по умолчанию",FlowCaption:"Поток управления",WebServiceCaption:"Вызвать веб-сервис",TaskCaption:"Выполнить задачу",TerminateEventHint:'При наступлении события прекращается выполнение текущего экземпляра процесса, вне зависимости от того, выполняются ли еще какие-либо другие ветки процесса. У процесса должен быть как минимум один завершающий элемент. &lt;a href="#" data-context-help-code="TerminatePropertiesPage"&gt;Перейти...&lt;/a&gt;',ExclusiveGatewayHint:'Используется для создания нескольких альтернативных ветвей процесса, если может быть выполнена только одна из них. При ветвлении может быть выполнен только один исходящий поток (требует наличия потока по умолчанию). При слиянии оператор ожидает активации лишь одного из входящих потоков. &lt;a href="#" data-context-help-code="ExclusiveGatewayPropertiesPage"&gt;Перейти...&lt;/a&gt;',InclusiveGatewayHint:'Используется для создания альтернативных потоков в процессах, которые могут выполняться параллельно. &lt;a href="#" data-context-help-code="InclusiveGatewayPropertiesPage"&gt;Перейти...&lt;/a&gt;',ParallelGatewayHint:'Используется в случае, если для дальнейшего выполнения процесса необходимо выполнение всех параллельных потоков в процессе. При слиянии ожидает активации всех входящих потоков, прежде чем активировать исходящие. &lt;a href="#" data-context-help-code="ParallelGatewayPropertiesPage"&gt;Перейти...&lt;/a&gt;',EventSubprocessHint:'Область событийного подпроцесса содержит диаграмму с начальным сообщением или сигналом. Событийный подпроцесс будет инициирован при наступлении соответствующего события и не будет прерывать выполнение родительского процесса. &lt;a href="#" data-context-help-code="EventSubprocessPropertiesPage"&gt;Перейти...&lt;/a&gt;',MICompletedCountTooltipText:"Число выполненных экземпляров",MIFailedCountTooltipText:"Число прерванных экземпляров"},Terrasoft.Resources.ProcessSchemaDesigner.ElementTools={ConnectHint:"Connect",ChangeTypeHint:"Change type",RemoveHint:"Remove",AISuggestionHint:"AI Suggestion",ArrowToolsImage:"svg_image",SetupToolsImage:"svg_image",DeleteToolsImage:"svg_image",AISuggestionToolsImage:"svg_image"},Terrasoft.Resources.ProcessSchemaDesigner.Functions={FunctionRoundUp:"RoundUp({0})",FunctionRound:"RoundOff({0})",FunctionRoundDown:"RoundDown({0})",FunctionMod:"RemainderAfterDivision({0}, )",FunctionMin:"Minimum({0})",FunctionMax:"Maximum({0})",FunctionAbs:"Module({0})",FunctionAvg:"Average({0})",FunctionDay:"Day({0})",FunctionMonth:"Month({0})",FunctionTime:"Time({0})",FunctionDayOfWeek:"DayOfWeek({0})",FunctionDayInRange:"DayIsInRangeOfDate({0}, , , )",SysSettingsDisplayPrefix:"System setting",SysVariableDisplayPrefix:"System variable",LookupValueDisplayPrefix:"Lookup",SamplingColumnValueDisplayPrefix:"Column value from selection",TimeValueDisplayPrefix:"Time value",DateValueDisplayPrefix:"Date value",DateTimeValueDisplayPrefix:"Date and time value",BooleanDisplayPrefix:"Boolean value",BooleanDisplayTrueValue:"True",BooleanDisplayFalseValue:"False",CaptionPropertyValueDisplayPrefix:"Process name",FunctionResultCaption:"Function result",MainRecordDisplayPrefix:"Main record"},Terrasoft.Resources.ProcessSchemaDesigner.PropertyNames={Caption:"Process name"},Terrasoft.Resources.ProcessSchemaDesigner.Suggestions={PopupTitle:"AI Suggestions",PopupSubtitle:"We suggest to use one of the following elements"},Terrasoft.Resources.ProcessSchemaDesigner.Messages={EntityNotFoundMessage:"<entity not found>",RecordNotFoundMessage:"<record not found>",InvalidFormulaMessage:"Invalid expression: {0}. Error: {1}.",SaveConfirmationMessage:"The process was modified. Save now and open up-to-date metadata?",SaveSourceCodeConfirmationMessage:"The process was modified. You must save the process to view up-to-date source code. Save now?",ElementNotFoundMessage:"Element {0} not found",ParameterNotFoundMessage:"Parameter {0} not found",RunProcessConfirmationMessage:"The process was modified. You must save the process to run it up-to-date. Save now?",RunProcessInformationMessage:'Click OK to continue the process "{0}".',SuccessfullyRunProcessInformationMessage:"Successfully started",ErrorStartBusinessProcessMessage:"Error starting business process ({0})",FormulaParseMacrosErrorMessage:"<ERROR>",ProcessSchemaMethodsBodyCaption:"Methods",CompiledProcessSchemaMethodsBodyCaption:"Compiled process methods",ProcessSchemaElementRequirePropertyValidation:"Open property page for validation.",InvalidProcessSchemaMessage:"Process schema is not valid.",SaveInvalidProcessButtonCaption:"Save {0}",SchemaValidationMessageCaption:"Required fields of some elements are not filled in. The {0} cannot start with the current settings",SchemaInvalidElementsMessageTemplate:"Please fill out all required fields for the following elements:\n{0}",SchemaInvalidElementsDuplicateFlowsMessageTemplate:"Some elements are connected with two or more flows. Please remove or reroute these flows:\n{0}",SchemaInvalidColumnsElementsParameterMessageTemplate:"Parameters use values of columns that cannot be found. Please check values for the following elements:\n{0}",SchemaInvalidColumnsProcessParametersMessageTemplate:"Process parameters use values of columns that cannot be found. Please check values for the following parameters:\n{0}",SysSettingValueNotFoundMessage:'Value not found for system setting "{0}"',SaveMetaDataConfirmationMessage:"The {0} has been modified. You must save the {0} to view up-to-date metadata. Save now?",LazyLoadMessage:"To delete an element  is necessary to ensure that it is not linked with other elements. Not all of the process element properties loaded. Load now?",InvalidMappingColumn:"Invalid formula"},Terrasoft.Resources.ProcessSchemaDesigner.Exceptions={LocalizableCollectionPropertyNotFoundMessage:"Localizable value not found for item {0}.",InvalidDateMessage:'Can not parse date value "{0}"',InvalidTimeMessage:'Can not parse time value "{0}"',InvalidDateTimeMessage:'Can not parse datetime value "{0}"',InvalidParameterMessage:'Parameter "{0}" not found',InvalidSysVariableMessage:"System variable with name {0} not found",InvalidParameterOfFlowElementMessage:'Parameter "{0}" of process element "{1}" not found',InvalidFlowElementMessage:'Process element "{0}" not found',InvalidSchemaUIdMessage:"Parameter schemaUId not set",InvalidColumnMessage:'Column "{0}" not found',InvalidSchemaCollectionMessage:"Schema collection is empty",InvalidLookupValueMessage:'Lookup value "{0}" not found',InvalidEntitySchemaMessage:'Entity schema "{0}" not found',InvalidSysSettingMessage:'System setting with name "{0}" not found',InvalidLookupEmptyValueMessage:"Lookup value can not be empty",InvalidBooleanValueMessage:'Can not parse boolean value "{0}"',InvalidMainRecordUsageMessage:"Main record macros is not allowed in Process Designer",InvalidMainRecordPathMessage:"Formula value error: Selected column not found",InvalidCronSecondsException:"Cron выражение не должно содержать секунды",InvalidMainRecordDataType:'Column type "{0}" is not valid. Allowed types: "{1}"'},Terrasoft.Resources.ProcessSchemaDesigner.Parameters={StartOffSetCaption:"Start in (sec.)",RecordIdCaption:"Unique identifier of record",NotificationCaption:"Process instance caption",Success:"Success",StatusCode:"Http status code",Response:"Response body",Input:"Input",Output:"Output",DefaultNestedParameterCaption:"Item value"},Terrasoft.Resources.ProcessSchemaDesigner.ParameterDirection={In:"Input",Out:"Output",Variable:"Variable"},Terrasoft.Resources.ProcessSchemaDesigner.InputRecordCollection={Caption:"Input record collection"},Terrasoft.Resources.ProcessSchemaDesigner.OutputRecordCollection={Caption:"Output record collection"},Terrasoft.Resources.ProcessSchemaDesigner.CompletedIterationsCountParameter={Caption:"Number of completed instances"},Terrasoft.Resources.ProcessSchemaDesigner.TerminatedIterationsCountParameter={Caption:"Number of terminated instances"},Terrasoft.Resources.ProcessSchemaDesigner.TotalIterationsCountParameter={Caption:"Total number of instances"},Terrasoft.Resources.ProcessSchemaDesigner.MultiInstanceExecutionMode={Sequential:"Sequential",Parallel:"Parallel"},Terrasoft.Resources.BaseSchemaManager={},Terrasoft.Resources.BaseSchemaManager.Exceptions={SchemaNotFoundMessage:"Schema by UId='{0}' from PackageUId='{1}' not found.",SchemaNotFoundByUIdMessage:"Schema by UId='{0}' not found."},Terrasoft.Resources.ProcessDiagram={},Terrasoft.Resources.ProcessDiagram.Messages={ProcessSchemaNotFound:"The process schema for process log with id = '{0}' not found."},Terrasoft.Resources.ApplicationInstallationPage={},Terrasoft.Resources.ApplicationInstallationPage.Messages={InstallingApplication:"Installing application",FileDownloadingFailed:"Downloading file to server finished with errors",ContinueWork:"You can close this page and continue with the bpm'online",WaitUntilComplete:"Please wait until the operation is complete",CreatingBackup:"Creating backup",BackupFailed:"Creating backup failed",ValidationFailed:"Packages validation failed. Configuration has not changed.",ApplicationInstallationFailed:"Application installation failed",RestoringFromBackup:"Restoring from backup",RestorationFromBackupFailed:"Restoration from backup failed",RestoredFromBackupSuccessful:"Backup restored successfully"},Terrasoft.Resources.Cron={ShortCronException:'Expression only has "{0}" parts.  At least 5 part are required.',LongCronException:'Expression has too many parts "{0}".  Expression must not have more than 7 parts.',ValueOutOfRangeException:'Cron parameter {0} "{1}" is out of range. Valid diapason from {2} to {3}.',InvalidSymbolsException:'Cron parameter {0} "{1}" contains invalid symbols.',DayOfNotImplementedException:'One of day of week "{0}" or day of month "{1}" parameter must be "?" symbol.'},Terrasoft.Resources.Cron.Parameters={Seconds:"seconds",Minutes:"minutes",Hours:"hours",DaysOfMonth:"days of month",Months:"months",DaysOfWeek:"days of week",Years:"years"},Terrasoft.Resources.Cron.Descriptor={At:"At",AtSpace:"At ",AtX0:"at {0}",AtX0MinutesPastTheHour:"at {0} minutes past the hour",AtX0SecondsPastTheMinute:"at {0} seconds past the minute",BetweenX0AndX1:"between {0} and {1}",ComaBetweenDayX0AndX1OfTheMonth:", between day {0} and {1} of the month",ComaEveryDay:", every day",ComaEveryHour:", every hour",ComaEveryMinute:", every minute",ComaEveryX0Days:", every {0} days",ComaEveryX0DaysOfTheWeek:", every {0} days of the week",ComaEveryX0Months:", every {0} months",ComaEveryX0Years:", every {0} years",ComaOnDayX0OfTheMonth:", on day {0} of the month",ComaOnlyInX0:", only in {0}",ComaOnlyOnX0:", only on {0}",ComaOnThe:", on the ",ComaOnTheLastDayOfTheMonth:", on the last day of the month",ComaOnTheLastWeekdayOfTheMonth:", on the last weekday of the month",ComaOnTheLastX0OfTheMonth:", on the last {0} of the month",ComaOnTheX0OfTheMonth:", on the {0} of the month",ComaX0ThroughX1:", {0} through {1}",CommaStartingX0:", starting {0}",EveryHour:"every hour",EveryMinute:"every minute",EveryMinuteBetweenX0AndX1:"Every minute between {0} and {1}",EverySecond:"every second",EveryX0Hours:"every {0} hours",EveryX0Minutes:"every {0} minutes",EveryX0Seconds:"every {0} seconds",Fifth:"fifth",First:"first",FirstWeekday:"first weekday",Forth:"forth",MinutesX0ThroughX1PastTheHour:"minutes {0} through {1} past the hour",Second:"second",SecondsX0ThroughX1PastTheMinute:"seconds {0} through {1} past the minute",SpaceAnd:" and",SpaceAndSpace:" and ",SpaceX0OfTheMonth:" {0} of the month",Third:"third",WeekdayNearestDayX0:"weekday nearest day {0}"},Terrasoft.Resources.EmailContentExporter={ButtonLinkExampleUrl:"http://example.com"},Terrasoft.Resources.MetaItem={WrongNameMessage:"Invalid value. Use symbols: a-z, A-Z, 0-9. &lt;/br&gt; Symbol: 0-9 cannot be first."},Terrasoft.Resources.ColorPicker={RecentColorLabel:"Recent"}),Ext.ns("Terrasoft.core.enums"),Terrasoft.QueryKind={GENERAL:0,LIMITED:1},Terrasoft.core.enums.QueryKind=Terrasoft.QueryKind,Terrasoft.FeatureState={DISABLED:0,ENABLED:1,ESTABLISHED:2},Terrasoft.core.enums.FeatureState=Terrasoft.FeatureState,Terrasoft.ComparisonType={BETWEEN:0,IS_NULL:1,IS_NOT_NULL:2,EQUAL:3,NOT_EQUAL:4,LESS:5,LESS_OR_EQUAL:6,GREATER:7,GREATER_OR_EQUAL:8,START_WITH:9,NOT_START_WITH:10,CONTAIN:11,NOT_CONTAIN:12,END_WITH:13,NOT_END_WITH:14,EXISTS:15,NOT_EXISTS:16},Terrasoft.core.enums.ComparisonType=Terrasoft.ComparisonType,Terrasoft.HttpStatusCode={OK:200,CREATED:201,ACCEPTED:202,BAD_REQUEST:400,UNAUTHORIZED:401,PAYMENT_REQUIRED:402,FORBIDDEN:403,NOT_FOUND:404,INTERNAL_SERVER_ERROR:500,NOT_IMPLEMENTED:501,BAD_GATEWAY:502,SERVICE_UNAVAILABLE:503},Terrasoft.core.enums.HttpStatusCode=Terrasoft.HttpStatusCode,Terrasoft.FilterType={NONE:0,COMPARE:1,IS_NULL:2,BETWEEN:3,IN:4,EXISTS:5,FILTER_GROUP:6},Terrasoft.core.enums.FilterType=Terrasoft.FilterType,Terrasoft.LogicalOperatorType={AND:0,OR:1},Terrasoft.core.enums.LogicalOperatorType=Terrasoft.LogicalOperatorType,Terrasoft.DataValueType={GUID:0,TEXT:1,INTEGER:4,FLOAT:5,MONEY:6,DATE_TIME:7,DATE:8,TIME:9,LOOKUP:10,ENUM:11,BOOLEAN:12,BLOB:13,IMAGE:14,CUSTOM_OBJECT:15,IMAGELOOKUP:16,COLLECTION:17,COLOR:18,LOCALIZABLE_STRING:19,ENTITY:20,ENTITY_COLLECTION:21,ENTITY_COLUMN_MAPPING_COLLECTION:22,HASH_TEXT:23,SECURE_TEXT:24,FILE:25,MAPPING:26,SHORT_TEXT:27,MEDIUM_TEXT:28,RICH_TEXT:43,MAXSIZE_TEXT:29,LONG_TEXT:30,PHONE_TEXT:42,WEB_TEXT:44,EMAIL_TEXT:45,FLOAT1:31,FLOAT2:32,FLOAT3:33,FLOAT4:34,LOCALIZABLE_PARAMETER_VALUES_LIST:35,METADATA_TEXT:36,STAGE_INDICATOR:37,OBJECT_LIST:38,COMPOSITE_OBJECT_LIST:39,FLOAT8:40,FILE_LOCATOR:41},Terrasoft.core.enums.DataValueType=Terrasoft.DataValueType,Terrasoft.ServerDataValueType={"23018567-a13c-4320-8687-fd6f9e3699bd":Terrasoft.DataValueType.GUID,"8b3f29bb-ea14-4ce5-a5c5-293a929b6ba2":Terrasoft.DataValueType.TEXT,"325a73b8-0f47-44a0-8412-7606f78003ac":Terrasoft.DataValueType.SHORT_TEXT,"26cba63c-daf1-4f36-b2ea-73c0d675d90c":Terrasoft.DataValueType.PHONE_TEXT,"26cba64c-daf1-4f36-b2ea-73c0d695d90c":Terrasoft.DataValueType.WEB_TEXT,"66cba64c-daf1-4f36-b8ea-73c0d695d90c":Terrasoft.DataValueType.EMAIL_TEXT,"ddb3a1ee-07e8-4d62-b7a9-d0e618b00fbd":Terrasoft.DataValueType.MEDIUM_TEXT,"79bccffa-8c8b-4863-b376-a69d2244182b":Terrasoft.DataValueType.RICH_TEXT,"c0f04627-4620-4bc0-84e5-9419dc8516b1":Terrasoft.DataValueType.MAXSIZE_TEXT,"5ca35f10-a101-4c67-a96a-383da6afacfc":Terrasoft.DataValueType.LONG_TEXT,"6b6b74e2-820d-490e-a017-2b73d4ccf2b0":Terrasoft.DataValueType.INTEGER,"57ee4c31-5ec4-45fa-b95d-3a2868aa89a8":Terrasoft.DataValueType.FLOAT,"07ba84ce-0bf7-44b4-9f2c-7b15032eb98c":Terrasoft.DataValueType.FLOAT1,"5cc8060d-6d10-4773-89fc-8c12d6f659a6":Terrasoft.DataValueType.FLOAT2,"3f62414e-6c25-4182-bcef-a73c9e396f31":Terrasoft.DataValueType.FLOAT3,"ff22e049-4d16-46ee-a529-92d8808932dc":Terrasoft.DataValueType.FLOAT4,"a4aaf398-3531-4a0d-9d75-a587f5b5b59e":Terrasoft.DataValueType.FLOAT8,"969093e2-2b4e-463b-883a-3d3b8c61f0cd":Terrasoft.DataValueType.MONEY,"d21e9ef4-c064-4012-b286-fa1a8171da44":Terrasoft.DataValueType.DATE_TIME,"603d4960-a1a2-45e9-b232-206a54421b01":Terrasoft.DataValueType.DATE,"04cc757b-8f06-482c-8a1a-0c0e171d2410":Terrasoft.DataValueType.TIME,"b295071f-7ea9-4e62-8d1a-919bf3732ff2":Terrasoft.DataValueType.LOOKUP,"90b65bf8-0ffc-4141-8779-2420877af907":Terrasoft.DataValueType.BOOLEAN,"95c6e6c4-2cc8-46be-a1cb-96f942655f86":Terrasoft.DataValueType.LOCALIZABLE_STRING,"84ed6865-9692-4c98-aaed-4d15b96a95c2":Terrasoft.DataValueType.CUSTOM_OBJECT,"ebd85d37-0abf-4bbf-bb32-97dc3dffcc8c":Terrasoft.DataValueType.ENTITY,"51fb23ba-3eb2-11e2-b7d5-b0c76188709b":Terrasoft.DataValueType.ENTITY_COLLECTION,"b53eaa2a-4bb7-4a6b-9f4f-58ccab293e31":Terrasoft.DataValueType.ENTITY_COLUMN_MAPPING_COLLECTION,"cffc4762-c5c7-44bc-8cc6-cb55aba6e06b":Terrasoft.DataValueType.LOCALIZABLE_PARAMETER_VALUES_LIST,"dafb71f9-ee9f-4e0b-a4d7-37aa15987155":Terrasoft.DataValueType.COLOR,"ecbcce18-2a17-4ead-829a-9d02fa9578a4":Terrasoft.DataValueType.HASH_TEXT,"3509b9dd-2c90-4540-b82e-8f6ae85d8248":Terrasoft.DataValueType.SECURE_TEXT,"ba40cfc5-f554-4c26-8f57-1bb29cf43c4e":Terrasoft.DataValueType.FILE,"fa6e6e49-b996-475e-a77e-73904e4c5a88":Terrasoft.DataValueType.IMAGE,"b7342b7a-5dde-40de-aa7c-24d2a57b3202":Terrasoft.DataValueType.BLOB,"b039feb0-ee7c-4884-8aa6-d6d45d84316f":Terrasoft.DataValueType.IMAGELOOKUP,"394e160f-c8e0-46fa-9c0d-75d97e9e9169":Terrasoft.DataValueType.METADATA_TEXT,"4b51a8b5-1ee9-4437-9d58-f35e083cbcdf":Terrasoft.DataValueType.OBJECT_LIST,"651ec16f-d140-46db-b9e2-825c985a8ac2":Terrasoft.DataValueType.COMPOSITE_OBJECT_LIST,"a33c9252-d401-453e-949d-169157067ed9":Terrasoft.DataValueType.FILE_LOCATOR,"190eb54a-5b4c-4a2a-8dda-8d0558cda835":Terrasoft.DataValueType.COLLECTION},Terrasoft.core.enums.ServerDataValueType=Terrasoft.ServerDataValueType,Terrasoft.ServerDataValueTypeName={ShortText:Terrasoft.DataValueType.SHORT_TEXT,PhoneText:Terrasoft.DataValueType.PHONE_TEXT,WebText:Terrasoft.DataValueType.WEB_TEXT,EmailText:Terrasoft.DataValueType.EMAIL_TEXT,MediumText:Terrasoft.DataValueType.MEDIUM_TEXT,LongText:Terrasoft.DataValueType.LONG_TEXT,RichText:Terrasoft.DataValueType.RICH_TEXT,MaxSizeText:Terrasoft.DataValueType.MAXSIZE_TEXT,Text:Terrasoft.DataValueType.TEXT,HashText:Terrasoft.DataValueType.HASH_TEXT,Integer:Terrasoft.DataValueType.INTEGER,Float:Terrasoft.DataValueType.FLOAT,Float1:Terrasoft.DataValueType.FLOAT1,Float2:Terrasoft.DataValueType.FLOAT2,Float3:Terrasoft.DataValueType.FLOAT3,Float4:Terrasoft.DataValueType.FLOAT4,Float8:Terrasoft.DataValueType.FLOAT8,Money:Terrasoft.DataValueType.MONEY,DateTime:Terrasoft.DataValueType.DATE_TIME,Date:Terrasoft.DataValueType.DATE,Time:Terrasoft.DataValueType.TIME,Boolean:Terrasoft.DataValueType.BOOLEAN,Image:Terrasoft.DataValueType.IMAGE,ImageLookup:Terrasoft.DataValueType.IMAGELOOKUP,File:Terrasoft.DataValueType.FILE,Color:Terrasoft.DataValueType.COLOR,Guid:Terrasoft.DataValueType.GUID,Binary:Terrasoft.DataValueType.BLOB,Lookup:Terrasoft.DataValueType.LOOKUP,MultiLookup:Terrasoft.DataValueType.GUID,ValueList:Terrasoft.DataValueType.INTEGER,Object:Terrasoft.DataValueType.CUSTOM_OBJECT,LocalizableStringDataValueType:Terrasoft.DataValueType.LOCALIZABLE_STRING,FileLocator:Terrasoft.DataValueType.FILE_LOCATOR},Terrasoft.core.enums.ServerDataValueTypeName=Terrasoft.ServerDataValueTypeName,Terrasoft.QueryOperationType={SELECT:0,INSERT:1,UPDATE:2,DELETE:3,BATCH:4,LISTSELECT:5,FILTEREDSELECT:6,LOOKUPSELECT:7,UPDATE_LOCALIZATION:8,SELECT_LOCALIZATION:9},Terrasoft.core.enums.QueryOperationType=Terrasoft.QueryOperationType,Terrasoft.ExpressionType={SCHEMA_COLUMN:0,FUNCTION:1,PARAMETER:2,SUBQUERY:3,ARITHMETIC_OPERATION:4},Terrasoft.core.enums.ExpressionType=Terrasoft.ExpressionType,Terrasoft.ArithmeticOperation={ADDITION:0,SUBTRACTION:1,MULTIPLICATION:2,DIVISION:3},Terrasoft.core.enums.ArithmeticOperation=Terrasoft.ArithmeticOperation,Terrasoft.FunctionType={NONE:0,MACROS:1,AGGREGATION:2,DATE_PART:3,LENGTH:4,WINDOW:5,DATE_ADD:6,DATE_DIFF:7},Terrasoft.core.enums.FunctionType=Terrasoft.FunctionType,Terrasoft.QueryMacrosType={NONE:0,CURRENT_USER:1,CURRENT_USER_CONTACT:2,YESTERDAY:3,TODAY:4,TOMORROW:5,PREVIOUS_WEEK:6,CURRENT_WEEK:7,NEXT_WEEK:8,PREVIOUS_MONTH:9,CURRENT_MONTH:10,NEXT_MONTH:11,PREVIOUS_QUARTER:12,CURRENT_QUARTER:13,NEXT_QUARTER:14,PREVIOUS_HALF_YEAR:15,CURRENT_HALF_YEAR:16,NEXT_HALF_YEAR:17,PREVIOUS_YEAR:18,CURRENT_YEAR:19,PREVIOUS_HOUR:20,CURRENT_HOUR:21,NEXT_HOUR:22,NEXT_YEAR:23,NEXT_N_DAYS:24,PREVIOUS_N_DAYS:25,NEXT_N_HOURS:26,PREVIOUS_N_HOURS:27,PRIMARY_COLUMN:34,PRIMARY_DISPLAY_COLUMN:35,PRIMARY_IMAGE_COLUMN:36,DAY_OF_YEAR_TODAY:37,DAY_OF_YEAR_TODAY_PLUS_DAYS_OFFSET:38,NEXT_N_DAYS_OF_YEAR:39,PREVIOUS_N_DAYS_OF_YEAR:40},Terrasoft.core.enums.QueryMacrosType=Terrasoft.QueryMacrosType,Terrasoft.DatePartType={NONE:0,DAY:1,WEEK:2,MONTH:3,YEAR:4,WEEK_DAY:5,HOUR:6,HOUR_MINUTE:7},Terrasoft.core.enums.DatePartType=Terrasoft.DatePartType,Terrasoft.DateDiffInterval={NONE:-1,YEAR:0,MONTH:1,DAY:2,HOUR:3,MINUTE:4,MILLISECOND:5},Terrasoft.core.enums.DateDiffInterval=Terrasoft.DateDiffInterval,Terrasoft.DayOfWeek={MONDAY:2,TUESDAY:4,WEDNESDAY:8,THURSDAY:16,FRIDAY:32,SATURDAY:64,SUNDAY:128},Terrasoft.core.enums.DayOfWeek=Terrasoft.DayOfWeek,Terrasoft.OrderDirection={NONE:0,ASC:1,DESC:2},Terrasoft.core.enums.OrderDirection=Terrasoft.OrderDirection,Terrasoft.AggregationType={NONE:0,COUNT:1,SUM:2,AVG:3,MIN:4,MAX:5},Terrasoft.core.enums.AggregationType=Terrasoft.AggregationType,Terrasoft.AggregationEvalType={NONE:0,ALL:1,DISTINCT:2},Terrasoft.core.enums.AggregationEvalType=Terrasoft.AggregationEvalType,Terrasoft.StringFilterType={START_WITH:0,CONTAIN:1},Terrasoft.core.enums.StringFilterType=Terrasoft.StringFilterType,Terrasoft.NumeralSystem={DECIMAL:10},Terrasoft.core.enums.NumeralSystem=Terrasoft.NumeralSystem,Terrasoft.Align={RIGHT:"right",CENTER:"center",LEFT:"left"},Terrasoft.core.enums.Align=Terrasoft.Align,Terrasoft.Valign={TOP:"top",MIDDLE:"middle",BOTTOM:"bottom"},Terrasoft.core.enums.Valign=Terrasoft.Valign,Terrasoft.ImageSources={ENTITY_COLUMN:0,IMAGE_LIST_SCHEMA:1,RESOURCE_MANAGER:2,SOURCE_CODE_SCHEMA:3,URL:4,SYS_SETTING:5,SYS_IMAGE:6,PROCESS_USERTASK_SCHEMA:7},Terrasoft.core.enums.ImageSources=Terrasoft.ImageSources,Terrasoft.BindingType={PROPERTY:0,METHOD:1,EVENT:2,COLLECTION:3},Terrasoft.core.enums.BindingType=Terrasoft.BindingType,Terrasoft.ViewModelColumnType={ENTITY_COLUMN:0,CALCULATED_COLUMN:1,VIRTUAL_COLUMN:2,RESOURCE_COLUMN:3},Terrasoft.core.enums.ViewModelColumnType=Terrasoft.ViewModelColumnType,Terrasoft.ViewModelSchemaItem={ATTRIBUTE:0,METHOD:1,GROUP:2,DETAIL:3,MODULE:4},Terrasoft.core.enums.ViewModelSchemaItem=Terrasoft.ViewModelSchemaItem,Terrasoft.ViewItemType={GRID_LAYOUT:0,TAB_PANEL:1,DETAIL:2,MODEL_ITEM:3,MODULE:4,BUTTON:5,LABEL:6,CONTAINER:7,MENU:8,MENU_ITEM:9,MENU_SEPARATOR:10,SECTION_VIEWS:11,SECTION_VIEW:12,GRID:13,SCHEDULE_EDIT:14,CONTROL_GROUP:15,RADIO_GROUP:16,DESIGN_VIEW:17,COLOR_BUTTON:18,IMAGE_TAB_PANEL:19,HYPERLINK:20,INFORMATION_BUTTON:21,TIP:22,COMPONENT:23,TIP_LABEL:24,PROGRESS_BAR:30,GRID_LAYOUT_EDIT:31,IFRAMECONTROL:32,EXTERNAL_WIDGET:33},Terrasoft.core.enums.ViewItemType=Terrasoft.ViewItemType,Terrasoft.ContentType={LONG_TEXT:0,SHORT_TEXT:1,DATE_TIME:2,ENUM:3,RICH_TEXT:4,LOOKUP:5,SEARCHABLE_TEXT:6},Terrasoft.core.enums.ContentType=Terrasoft.ContentType,Terrasoft.TextSize={STANDARD:0,LARGE:1},Terrasoft.core.enums.TextSize=Terrasoft.TextSize,Terrasoft.EntitySchemaColumnDefSource={NONE:0,CONST:1,SETTINGS:2,SYSTEM_VALUE:3,SEQUENCE:4},Terrasoft.core.enums.EntitySchemaColumnDefSource=Terrasoft.EntitySchemaColumnDefSource,Terrasoft.SystemValueType={CURRENT_TIME:"CurrentTime",CURRENT_DATE:"CurrentDate",CURRENT_DATE_TIME:"CurrentDateTime",CURRENT_USER:"CurrentUser",CURRENT_USER_CONTACT:"CurrentUserContact",CURRENT_USER_ACCOUNT:"CurrentUserAccount",CURRENT_WORKSPACE:"CurrentWorkspace",GENERATE_UID:"AutoGuid",GENERATE_SEQUENTIAL_UID:"SequentialGuid",CURRENT_MAINTAINER:"CurrentMaintainer"},Terrasoft.core.enums.SystemValueType=Terrasoft.SystemValueType,Terrasoft.SchemaType={MODULE:1,EDIT_VIEW_MODEL_SCHEMA:2,MODULE_VIEW_MODEL_SCHEMA:3,DETAIL_VIEW_MODEL_SCHEMA:4,GRID_DETAIL_VIEW_MODEL_SCHEMA:5,EDIT_CONTROLS_DETAIL_VIEW_MODEL_SCHEMA:6,UNIT_TEST_MODULE:7,GRID_EDIT_DETAIL_VIEW_MODEL_SCHEMA:8,ANGULAR_SCHEMA:9},Terrasoft.core.enums.SchemaType=Terrasoft.SchemaType,Terrasoft.ServerSchemaType={Module:Terrasoft.SchemaType.MODULE,EditViewModelSchema:Terrasoft.SchemaType.EDIT_VIEW_MODEL_SCHEMA,ModuleViewModelSchema:Terrasoft.SchemaType.MODULE_VIEW_MODEL_SCHEMA,DetailViewModelSchema:Terrasoft.SchemaType.DETAIL_VIEW_MODEL_SCHEMA,GridDetailViewModelSchema:Terrasoft.SchemaType.GRID_DETAIL_VIEW_MODEL_SCHEMA,EditControlsDetailViewModelSchema:Terrasoft.SchemaType.EDIT_CONTROLS_DETAIL_VIEW_MODEL_SCHEMA,UnitTestModule:Terrasoft.SchemaType.UNIT_TEST_MODULE,GridEditDetailViewModelSchema:Terrasoft.SchemaType.GRID_EDIT_DETAIL_VIEW_MODEL_SCHEMA,AngularSchema:Terrasoft.SchemaType.ANGULAR_SCHEMA},Terrasoft.core.enums.NullDate=new Date,Terrasoft.core.enums.NullDate.setFullYear(0,0,1),Terrasoft.core.enums.NullDate.setHours(0,0,0),Terrasoft.core.enums.NullDate=Terrasoft.NullDate,Terrasoft.EventName={ON_MESSAGE:"message",ON_CONNECTION_INITIALIZED:"opened",ON_CHANNEL_CLOSED:"closed",ON_ERROR:"error"},Terrasoft.core.enums.EventName=Terrasoft.EventName,Terrasoft.CaptionAlignType={LEFT:"left",MIDDLE:"middle",RIGHT:"right"},Terrasoft.core.enums.CaptionAlignType=Terrasoft.CaptionAlignType,Terrasoft.CaptionPositionType={ABOVE:"above",BELOW:"below",LEFT:"left",RIGHT:"right"},Terrasoft.core.enums.CaptionPositionType=Terrasoft.CaptionPositionType,Terrasoft.GridType={TILED:"tiled",LISTED:"listed"},Terrasoft.core.enums.GridType=Terrasoft.GridType,Terrasoft.GridCellType={TEXT:"text",TITLE:"title",LINK:"link",ICON:"icon"},Terrasoft.core.enums.GridCellType=Terrasoft.GridCellType,Terrasoft.GridCellViewType={ONELINE:"oneline",MULTILINE:"multiline"},Terrasoft.core.enums.GridCellViewType=Terrasoft.GridCellViewType,Terrasoft.GridIconType={ICON16:"grid-icon-16x16",ICON22:"grid-icon-22x22",ICON32:"grid-icon-32x32",ICON16LISTED:"grid-listed-icon-16x16",ICON22LISTED:"grid-listed-icon-22x22",ICON32LISTED:"grid-listed-icon-32x32"},Terrasoft.core.enums.GridIconType=Terrasoft.GridIconType,Terrasoft.GridKeyType={TEXT:"text",TITLE:"title",CAPTION:"caption",LABEL:"label",LINK:"link",ICON16:"grid-icon-16x16",ICON22:"grid-icon-22x22",ICON32:"grid-icon-32x32",ICON16LISTED:"grid-listed-icon-16x16",ICON22LISTED:"grid-listed-icon-22x22",ICON32LISTED:"grid-listed-icon-32x32"},Terrasoft.core.enums.GridKeyType=Terrasoft.GridKeyType,Terrasoft.ImageSize={DEFAULT:{width:72,height:72},IMAGE16X16:{width:16,height:16},IMAGE22X22:{width:22,height:22},IMAGE32X32:{width:32,height:32}},Terrasoft.core.enums.ImageSize=Terrasoft.ImageSize,Terrasoft.DateRate={MILLISECONDS_IN_DAY:864e5,MINUTES_IN_HOUR:60,MILLISECONDS_IN_MINUTE:6e4,MILLISECONDS_IN_SECOND:1e3},Terrasoft.core.enums.DateRate=Terrasoft.DateRate,Terrasoft.LogItemType={ERROR:0,DEBUG:1,INFO:2},Terrasoft.core.enums.LogItemType=Terrasoft.LogItemType,Terrasoft.SocketConnectionState={CONNECTING:0,OPEN:1,CLOSING:2,CLOSED:3,NOT_INITIALIZED:4},Terrasoft.core.enums.SocketConnectionState=Terrasoft.SocketConnectionState,Terrasoft.LoggerType={NONE:-1,CLIENT:0,SERVER:1,BOTH:2},Terrasoft.core.enums.LoggerType=Terrasoft.LoggerType,Terrasoft.LogMessageType={INFORMATION:0,WARNING:1,ERROR:2},Terrasoft.core.enums.LogMessageType=Terrasoft.LogMessageType,Terrasoft.MessageMode={PTP:"ptp",BROADCAST:"broadcast"},Terrasoft.core.enums.MessageMode=Terrasoft.MessageMode,Terrasoft.MessageDirectionType={PUBLISH:"publish",SUBSCRIBE:"subscribe",BIDIRECTIONAL:"bidirectional"},Terrasoft.core.enums.MessageDirectionType=Terrasoft.MessageDirectionType,Terrasoft.MenuItemType={ITEM:"Terrasoft.MenuItem",SEPARATOR:"Terrasoft.MenuSeparator",RADIO:"Terrasoft.RadioMenuItem",CHECK:"Terrasoft.CheckMenuItem",COLOR:"Terrasoft.ColorMenuItem",COLOR_PICKER:"Terrasoft.ColorPickerMenuItem"},Terrasoft.core.enums.MenuItemType=Terrasoft.MenuItemType,Terrasoft.MouseButton={LEFT:"Left",MIDDLE:"Middle",RIGHT:"Right"},Terrasoft.core.enums.MouseButton=Terrasoft.MouseButton,Terrasoft.ESQServerCacheLevels={SESSION:0,WORKSPACE:1,APPLICATION:2},Terrasoft.core.enums.ESQServerCacheLevels=Terrasoft.ESQServerCacheLevels,Terrasoft.ModificationStatus={NOT_MODIFIED:0,REMOVED:1,NEW:2,UPDATED:3},Terrasoft.core.enums.ModificationStatus=Terrasoft.ModificationStatus,Terrasoft.EntityChangeType={None:0,Inserted:1,Updated:2,Deleted:4},Terrasoft.core.enums.EntityChangeType=Terrasoft.EntityChangeType,Terrasoft.EntitySchemaColumnUsageType={General:0,Advanced:1,None:2},Terrasoft.core.enums.EntitySchemaColumnUsageType=Terrasoft.EntitySchemaColumnUsageType,Terrasoft.UserType={GENERAL:"General",SSP:"SSP",VIRTUAL:"Virtual"},Terrasoft.UserDataAccessType={GENERAL:"General",DATAINPUTRESTRICTED:"DataInputRestricted",MOBILE:"Mobile"},Terrasoft.core.enums.UserType=Terrasoft.UserType,Terrasoft.FlowElementGroup={UserTask:"UserTask",ServiceTask:"ServiceTask",StartEvent:"StartEvent",IntermediateEvent:"IntermediateEvent",EndEvent:"EndEvent",Gateway:"Gateway",Subprocess:"Subprocess"},Terrasoft.core.enums.FlowElementGroup=Terrasoft.FlowElementGroup,Ext.ns("Terrasoft.controls.TipEnums"),Terrasoft.TipDisplayMode={WIDE:"wide",NARROW:"narrow"},Terrasoft.controls.TipEnums.displayMode=Terrasoft.TipDisplayMode,Terrasoft.controls.TipEnums.visibilityChangeEvent={HIDE:"hide",HIDE_ON_DOCUMENT_MOUSE_DOWN:"hide_on_document_mousedown"},Terrasoft.SysPackageInstallType={SourceControl:0,Repository:1},Terrasoft.core.enums.SysPackageInstallType=Terrasoft.SysPackageInstallType,Terrasoft.ServerChannelSender={CONSOLE_COMMAND:"ConsoleCommand",BROADCAST_MESSAGE:"BroadcastMsg",COMMAND_SERVICE:"CommandService",PTP_MESSAGE:"PTPMsg"},Terrasoft.core.enums.ServerChannelSender=Terrasoft.ServerChannelSender,Terrasoft.ModificationForbidLevel={NONE:0,PACKAGE:1,ELEMENT:2},Terrasoft.core.enums.ModificationForbidLevel=Terrasoft.ModificationForbidLevel,Terrasoft.ColorEncoding={HEX:"HEX",RGB:"RGB"},Terrasoft.core.enums.ColorEncoding=Terrasoft.ColorEncoding,Terrasoft.PredictableState={INPROGRESS:0,EXACT:1,NOTEXACT:2,INSIGNIFICANCE:3},Terrasoft.core.enums.PredictableState=Terrasoft.PredictableState,Terrasoft.ProcessStatus={INACTIVE:0,RUNNING:1,COMPLETED:2,ERROR:3,CANCELED:4,CANCELLING:5},Terrasoft.core.enums.ProcessStatus=Terrasoft.ProcessStatus,Terrasoft.TextDirection={LTR:"ltr",RTL:"rtl",INHERIT:"inherit"},Terrasoft.core.enums.TextDirection=Terrasoft.TextDirection,Terrasoft.ScrollTypeInRtl={DEFAULT:"DEFAULT",NEGATIVE:"NEGATIVE",REVERSE:"REVERSE"},Terrasoft.core.enums.ScrollTypeInRtl=Terrasoft.ScrollTypeInRtl,Terrasoft.QuerySource={UNDEFINED:0,FILTER:1,FILTER_SUMMARY:2},Terrasoft.AdminUnitRoleSources={None:0,Self:1,ExplicitEntry:2,Delegated:4,FuncRoleFromOrgRole:8,UpHierarchy:16,AsManager:32,All:63},Terrasoft.core.enums.QuerySource=Terrasoft.QuerySource,Terrasoft.BusinessRuleActionSourceType={COLUMN_SOURCE:0,ATTRIBUTE_SOURCE:1,PARAMETER_SOURCE:2,DETAIL_SOURCE:3,TAB_SOURCE:4,MODULE_SOURCE:5,COUNTROL_GROUP_SOURCE:6},Terrasoft.core.enums.BusinessRuleActionSourceType=Terrasoft.BusinessRuleActionSourceType,Terrasoft.SysSettingsRightsOperationType={ALLOW_ALL:0,RESTRICT_ALL:1,ALLOW_BY_OPERATION:2},Terrasoft.core.enums.SysSettingsRightsOperationType=Terrasoft.SysSettingsRightsOperationType,Terrasoft.WorkspaceItemType={SqlScript:0,SchemaData:1,Assembly:2,EntitySchema:3,ClientUnitSchema:4,SourceCodeSchema:5,ProcessSchema:6,DcmSchema:7,ProcessUserTaskSchema:8,CampaignSchema:9,ServiceSchema:10},Terrasoft.core.enums.WorkspaceItemType=Terrasoft.WorkspaceItemType,Terrasoft.ProcessSuggestionsRequestStatus={Active:0,Success:1,Timeout:2,Error:3},Terrasoft.core.enums.ProcessSuggestionsRequestStatus=Terrasoft.ProcessSuggestionsRequestStatus,Terrasoft.ProcessSuggestionsResultTypes={Success:"Success",ServiceNotConfigured:"ServiceNotConfigured",NotEnoughValidInputData:"NotEnoughValidInputData",Error:"Error"},Terrasoft.core.enums.ProcessSuggestionsResultTypes=Terrasoft.ProcessSuggestionsResultTypes,Ext.define("Terrasoft.diagram.DiagramChangesParser",{alternateClassName:"Terrasoft.DiagramChangesParser",_log:function(e){Terrasoft.isDebug&&console.log(e)},_getCommand:function(e){return e.commandType},_getConnectionWaypointsValues:function(e){var t=Terrasoft.deepClone(e.waypoints);return t.pop(),t.shift(),t.map((function(e){return e.hasOwnProperty("original")&&!e.original&&delete e.original,e}))},_getConnectionItemValues:function(e,t){return e.name=t.name,e},_getElementItemValue:function(e){var t={id:e.id,caption:e.caption,parent:e.parent,type:e.type,size:{height:e.height,width:e.width},position:{rx:e.rx,ry:e.ry}};return e.defaultParamValues&&(t.defaultParamValues=e.defaultParamValues),e.source&&(t.source=e.source),t},_getLabelItemValue:function(e){return{id:e.id,parentUId:e.parent,x:e.rx,y:e.ry,nodeType:Terrasoft.diagram.UserHandlesConstraint.Label}},_findElementId:function(e,t){return e[1]||Object.keys(t)[0]},_applyWaypointsValues:function(e){var t=this._getConnectionWaypointsValues(e);Ext.isEmpty(t)||(e.polylinePointPositions=t)},_applyPortPositionsValues:function(e){var t=this._getPortPositions(Terrasoft.deepClone(e));Ext.isEmpty(t)||(e.portPositions=t)},_getCenterWaypoints:function(e){var t=Terrasoft.deepClone(e.waypoints).map((function(e){return delete e.original,e})),r=[];return r.push(t.shift(),t.pop()),r},_getPortPositions:function(e){var t,r=this._getConnectionWaypointsValues(e);if(!Ext.isEmpty(r)&&r.length>0){var n=this._getCenterWaypoints(e);t={source:{position:n[0],side:r[0]},target:{position:n[n.length-1],side:r[r.length-1]}}}else{var i=this._getCenterWaypoints(e);t={source:{position:i[0]},target:{position:i[i.length-1]}}}return t},_getChangeForConnectionUpdate:function(e,t,r){var n;switch(!0){case e.hasOwnProperty("waypoints"):n=[{name:t.name,polylinePointPositions:this._getConnectionWaypointsValues(e),portPositions:this._getPortPositions(e)}];break;default:n=[{name:t.name,itemValue:this._getConnectionItemValues(e,t,r)}]}return n},isSizeChange:function(e){return Object.keys(e).length>0&&(e.hasOwnProperty("width")||e.hasOwnProperty("height"))},isPositionChange:function(e){return e.hasOwnProperty("rx")||e.hasOwnProperty("ry")},isParentChange:function(e){return e.hasOwnProperty("parent")},_isCaptionChange:function(e){return e.hasOwnProperty("caption")},_tryApplySchemaChanges:function(e){var t=e.schemaChanges,r=e.type,n=e.operation,i=e.id,a=e.newValues;if("elements"===r&&"update"===n){if(a.hasOwnProperty("caption"))return!0;var s=t.add.elements.find((function(e){return e.itemValue.id===i}));if(s){if(this.isPositionChange(a))return s.itemValue.position=_objectSpread(_objectSpread({},s.itemValue.position),a),!0;this._log("Unknown changes: ".concat(JSON.stringify(a)))}}},_collectConnectionChanges:function(e,t){var r,n=t.newValues,i=t.item,a=t.items,s=t.id;switch(e){case"add":var o=n[s];this._applyWaypointsValues(o),this._applyPortPositionsValues(o),r=[{itemValue:o}];break;case"update":r=this._getChangeForConnectionUpdate(n,i,a);break;case"remove":r=[{name:i.name,itemValue:n[s]}];break;default:this._log("Unknown command: connection.".concat(e))}return r},_collectElementChanges:function(e,t){var r,n=t.newValues,i=t.item,a=t.id;switch(e){case"update":var s={itemName:i.name};this.isSizeChange(n)&&(s.size={width:n.width||i.width,height:n.height||i.height}),this.isPositionChange(n)&&(s.position={},n.hasOwnProperty("rx")&&(s.position.x=n.rx||i.position.X),n.hasOwnProperty("ry")&&(s.position.y=n.ry||i.position.Y)),this.isParentChange(n)&&(s.parent=n.parent),this._isCaptionChange(n)&&(s.caption=n.caption),r=[s];break;case"add":r=[{itemValue:this._getElementItemValue(n[a])}];break;case"remove":r=[{name:i.name,itemValue:n[a]}];break;default:this._log("Unknown command: element.".concat(e))}return r},_collectLabelChanges:function(e,t){var r,n=t.newValues,i=t.item,a=t.id;switch(e){case"update":var s={itemName:i.name};if(this.isPositionChange(n)){var o=s.position={};n.hasOwnProperty("rx")&&(o.x=n.rx),n.hasOwnProperty("ry")&&(o.y=n.ry),r=[s]}break;case"add":r=[{itemValue:this._getLabelItemValue(n[a])}];break;case"remove":r=[{name:i.name,itemValue:n[a]}];break;default:this._log("Unknown command: label.".concat(e))}return r},_getChangeForSchema:function(e,t,r,n){var i,a=t.path,s=t.newValues,o=a[0],l=this._findElementId(a,s),c=r.findByPath("uId",l);if(!c&&"add"!==e)return"remove"===e||this._tryApplySchemaChanges({schemaChanges:n,type:o,operation:e,id:l,newValues:s})||this._log("".concat(o,".").concat(e,": element was not found! ItemId: ").concat(l)),null;switch(o){case"connections":i=this._collectConnectionChanges(e,{newValues:s,item:c,items:r,id:l});break;case"elements":i=this._collectElementChanges(e,{newValues:s,item:c,id:l});break;case"labels":i=this._collectLabelChanges(e,{newValues:s,item:c,id:l});break;default:this._log("Not support type: ".concat(o)),this._log(t)}return{type:o,operation:e,values:i}},_applyChanges:function(e,t){var r=e[t.operation];if(r){var n=r[t.type];n=n?n.concat(t.values):t.values,r[t.type]=n}else r=_defineProperty({},t.type,t.values);e[t.operation]=r},getChangesForSchema:function(e,t){var r=this,n={};return e.forEach((function(e){var i=r._getCommand(e),a=r._getChangeForSchema(i,e,t,n);a&&a.values&&r._applyChanges(n,a)})),n}}),Ext.define("Terrasoft.exceptions.UnknownException",{alternateClassName:"Terrasoft.UnknownException",message:Terrasoft.Resources.Exception.UnknownException,toString:function(){return this.alternateClassName+": "+this.message},constructor:function(e){Ext.apply(this,e)}}),Ext.define("Terrasoft.exceptions.NotImplementedException",{extend:"Terrasoft.UnknownException",alternateClassName:"Terrasoft.NotImplementedException",message:Terrasoft.Resources.Exception.NotImplementedException}),Ext.define("Terrasoft.exceptions.ItemNotFoundException",{extend:"Terrasoft.UnknownException",alternateClassName:"Terrasoft.ItemNotFoundException",message:Terrasoft.Resources.Exception.ItemNotFoundException}),Ext.define("Terrasoft.exceptions.NullOrEmptyException",{extend:"Terrasoft.UnknownException",alternateClassName:"Terrasoft.NullOrEmptyException",message:Terrasoft.Resources.Exception.NullOrEmptyException}),Ext.define("Terrasoft.exceptions.ArgumentNullOrEmptyException",{extend:"Terrasoft.UnknownException",alternateClassName:"Terrasoft.ArgumentNullOrEmptyException",message:Terrasoft.Resources.Exception.ArgumentNullOrEmptyException,argumentName:null,toString:function(){return this.argumentName?this.alternateClassName+": "+Ext.String.format(Terrasoft.Resources.Exception.ArgumentNullOrEmptyExceptionWithArgumentName,this.argumentName):this.alternateClassName+": "+this.message}}),Ext.define("Terrasoft.exceptions.UnsupportedTypeException",{extend:"Terrasoft.UnknownException",alternateClassName:"Terrasoft.UnsupportedTypeException",message:Terrasoft.Resources.Exception.UnsupportedTypeException}),Ext.define("Terrasoft.exceptions.ItemAlreadyExistsException",{extend:"Terrasoft.UnknownException",alternateClassName:"Terrasoft.ItemAlreadyExistsException",message:Terrasoft.Resources.Exception.ItemAlreadyExistsException}),Ext.define("Terrasoft.exceptions.DataFieldIsRequiredException",{extend:"Terrasoft.UnknownException",alternateClassName:"Terrasoft.DataFieldIsRequiredException",fieldName:"",toString:function(){return Terrasoft.Resources.Exception.DataFieldIsRequiredException.DataField+' "'+this.fieldName+'" '+Terrasoft.Resources.Exception.DataFieldIsRequiredException.IsRequired}}),Ext.define("Terrasoft.exceptions.InvalidOperationException",{extend:"Terrasoft.UnknownException",alternateClassName:"Terrasoft.InvalidOperationException",message:Terrasoft.Resources.Exception.InvalidOperationException}),Ext.define("Terrasoft.exceptions.InvalidObjectState",{extend:"Terrasoft.UnknownException",alternateClassName:"Terrasoft.InvalidObjectState",message:Terrasoft.Resources.Exception.InvalidObjectState}),Ext.define("Terrasoft.exceptions.InvalidFormatException",{extend:"Terrasoft.UnknownException",alternateClassName:"Terrasoft.InvalidFormatException",message:Terrasoft.Resources.Exception.InvalidFormatException}),Ext.define("Terrasoft.exceptions.InvalidDateFormatException",{extend:"Terrasoft.InvalidFormatException",alternateClassName:"Terrasoft.InvalidDateFormatException",message:Terrasoft.Resources.Exception.InvalidDateFormatException}),Ext.define("Terrasoft.exceptions.UnauthorizedException",{extend:"Terrasoft.UnknownException",alternateClassName:"Terrasoft.UnauthorizedException",message:Terrasoft.Resources.Exception.UnauthorizedException}),Ext.define("Terrasoft.exceptions.QueryExecutionException",{extend:"Terrasoft.UnknownException",alternateClassName:"Terrasoft.QueryExecutionException",message:Terrasoft.Resources.Exception.QueryExecutionException,errorInfo:null,toString:function(){return this.errorInfo?this.errorInfo.errorCode+': "'+this.message+'" ':this.message}}),Ext.define("Terrasoft.exceptions.ModuleProcessingException",{extend:"Terrasoft.UnknownException",alternateClassName:"Terrasoft.ModuleProcessingException",message:Terrasoft.Resources.Exception.ModuleProcessingException,errorInfo:null,toString:function(){var e=this.callParent(arguments),t=this.errorInfo;return t&&(e+="\nmoduleId: "+t.moduleId+"\nmoduleName: "+t.moduleName),e}}),Ext.define("Terrasoft.exceptions.MobileException",{extend:"Terrasoft.UnknownException",alternateClassName:"Terrasoft.MobileException",errorInfo:null,toString:function(){for(var e=this.callParent(arguments),t=this.errorInfo;t;){var r=t.message;e+=r?"\n\n"+r:"",t=t.errorInfo}return e}}),Ext.define("Terrasoft.exceptions.FileSystemException",{extend:"Terrasoft.MobileException",alternateClassName:"Terrasoft.FileSystemException",code:null,toString:function(){var e=this.callParent(arguments),t=this.code?Ext.String.format(Terrasoft.Resources.Exception.FileSystemExceptionFormat,this.code)+"\n\n"+e:e;return t}}),Ext.define("Terrasoft.exceptions.FileException",{extend:"Terrasoft.MobileException",alternateClassName:"Terrasoft.FileException",name:null,toString:function(){var e=this.callParent(arguments),t=this.name?Ext.String.format(Terrasoft.Resources.Exception.FileExceptionFormat,this.name)+"\n\n"+e:e;return t}}),Ext.define("Terrasoft.exceptions.DirectoryException",{extend:"Terrasoft.MobileException",alternateClassName:"Terrasoft.DirectoryException",name:null,toString:function(){var e=this.callParent(arguments),t=this.name?Ext.String.format(Terrasoft.Resources.Exception.DirectoryExceptionFormat,this.name)+"\n\n"+e:e;return t}}),Ext.define("Terrasoft.exceptions.DirectoryNotFoundException",{extend:"Terrasoft.DirectoryException",alternateClassName:"Terrasoft.DirectoryNotFoundException"}),Ext.define("Terrasoft.exceptions.FileSystemEntryNotImplementedException",{extend:"Terrasoft.MobileException",alternateClassName:"Terrasoft.FileSystemEntryNotImplementedException",methodName:null,toString:function(){var e=this.callParent(arguments),t=this.methodName?Ext.String.format(Terrasoft.Resources.Exception.FileSystemEntryNotImplementedExceptionFormat,this.methodName)+"\n\n"+e:e;return t}}),Ext.ns("Terrasoft.utils.array"),Terrasoft.utils.array.areArraysEqual=function(e,t){return t=t||[],(e=e||[]).length===t.length&&JSON.stringify(e.sort())===JSON.stringify(t.sort())},Terrasoft.areArraysEqual=Terrasoft.utils.array.areArraysEqual,Terrasoft.utils.array.compact=function(e){return _.compact(e)},Terrasoft.compact=Terrasoft.utils.array.compact,Terrasoft.contains=function(e,t){return _.contains(e,t)},Terrasoft.utils.array.contains=Terrasoft.contains,Terrasoft.utils.array.difference=function(e,t){return _.difference(e,t)},Terrasoft.difference=Terrasoft.utils.array.difference,Terrasoft.each=function(e,t,r){if(Terrasoft.isArray(e)){for(var n=0,i=e.length;n!==i;n++)if(!1===t.call(r||e,e[n],n,e))return;return!0}if(e&&Ext.isFunction(e.each))return e.each(t,r),!0;for(var a in e)if(e.hasOwnProperty(a)&&!1===t.call(r||e,e[a],a,e))return;return!0},Terrasoft.utils.array.each=Terrasoft.each,Terrasoft.utils.array.find=function(e,t,r){return _.find(e,t,r)},Terrasoft.find=Terrasoft.utils.array.find,Terrasoft.utils.array.findItem=function(e,t){var r=_.findWhere(e,t);return r?{item:r,parent:e,index:e.indexOf(r)}:(Terrasoft.each(e,(function(e){return(Ext.isObject(e)||Terrasoft.isArray(e))&&(r=Terrasoft.findItem(e,t)),Ext.isEmpty(r)}),this),r)},Terrasoft.findItem=Terrasoft.utils.array.findItem,Terrasoft.utils.array.findWhere=function(e,t){return _.findWhere(e,t)},Terrasoft.findWhere=Terrasoft.utils.array.findWhere,Terrasoft.filter=function(e,t,r){return _.filter(e,t,r)},Terrasoft.utils.array.filter=Terrasoft.filter,Terrasoft.utils.array.isArray=function(e){return Ext.isArray(e)},Terrasoft.isArray=Terrasoft.utils.array.isArray,Terrasoft.utils.array.map=function(e,t,r){return _.map(e,t,r)},Terrasoft.map=Terrasoft.utils.array.map,Terrasoft.utils.array.rotateArray=function(e,t){if(Ext.isEmpty(e)||Ext.isEmpty(t))throw new Terrasoft.ArgumentNullOrEmptyException;for(var r=(e.length-t%e.length)%e.length,n=0;n<r;n++)for(var i=e.length-1;i>0;i--){var a=e[i];e[i]=e[i-1],e[i-1]=a}},Terrasoft.rotateArray=Terrasoft.utils.array.rotateArray,Terrasoft.utils.array.some=function(e,t,r){return _.some(e,t,r)},Terrasoft.some=Terrasoft.utils.array.some,Terrasoft.utils.array.sortedIndex=function(e,t,r,n){return _.sortedIndex(e,t,r,n)},Terrasoft.sortedIndex=Terrasoft.utils.array.sortedIndex,Terrasoft.utils.array.where=function(e,t){return _.where(e,t)},Terrasoft.where=Terrasoft.utils.array.where,Terrasoft.utils.array.without=function(e,t){return _.without(e,t)},Terrasoft.without=Terrasoft.utils.array.without,Terrasoft.utils.array.groupBy=function(e,t,r){return _.groupBy(e,t,r)},Terrasoft.groupBy=Terrasoft.utils.array.groupBy,Terrasoft.utils.array.reduce=function(e,t,r,n){return _.reduce(e,t,r,n)},Terrasoft.reduce=Terrasoft.utils.array.reduce,Terrasoft.utils.array.last=function(e){if(Ext.isEmpty(e))throw new Terrasoft.ArgumentNullOrEmptyException;return e[e.length-1]},Terrasoft.last=Terrasoft.utils.array.last,Terrasoft.utils.array.lastOrDefault=function(e){if(!Ext.isEmpty(e))return e[e.length-1]},Terrasoft.lastOrDefault=Terrasoft.utils.array.lastOrDefault,Terrasoft.utils.array.first=function(e){if(Ext.isEmpty(e))throw new Terrasoft.ArgumentNullOrEmptyException;return e[0]},Terrasoft.first=Terrasoft.utils.array.first,Terrasoft.utils.array.firstOrDefault=function(e,t){return Ext.isEmpty(e)?t:e[0]},Terrasoft.firstOrDefault=Terrasoft.utils.array.firstOrDefault,Terrasoft.getEnumerator=function(e){return{array:e,currentIndex:0,hasNext:function(){return this.currentIndex<this.array.length},next:function(){return this.array[this.currentIndex++]}}},Terrasoft.utils.array.getEnumerator=Terrasoft.getEnumerator,Terrasoft.eachAsync=function(e,t,r,n){if(Ext.isEmpty(e))r.call(n);else{var i=Terrasoft.getEnumerator(e),a={_break:!1,break:function(){return a._break=!0}};t.call(n,i.next(),(function e(){!a._break&&i.hasNext()?t.call(n,i.next(),e,a):Ext.callback(r,n,arguments)}),a)}},Terrasoft.utils.array.eachAsync=Terrasoft.eachAsync,Terrasoft.eachAsyncAll=function(e,t,r,n){if(Ext.isEmpty(e))Ext.callback(r,n);else{var i;Ext.isFunction(e[0])&&(i=n||[],n=r,r=t);var a=e.map((function(e){return new Promise((function(r){Terrasoft.checkContext(n)&&(Ext.isFunction(e)?e.apply(n,[function(e){return r(e)}].concat(i)):t.call(n,e,(function(e){return r(e)})))}))}));Promise.all(a).then((function(e){Terrasoft.checkContext(n)&&Ext.callback(r,n,[e])}))}},Terrasoft.utils.array.eachAsyncAll=Terrasoft.eachAsyncAll,Terrasoft.utils.array.append=function(e,t,r){if(!e)throw new Terrasoft.ArgumentNullOrEmptyException({argumentName:"array"});if(!Terrasoft.isArray(e))throw new Terrasoft.UnsupportedTypeException({message:"argumentName: array"});Ext.Array.from(t).forEach((function(t){Ext.Array.contains(e,t)&&r||e.push(t)}),this)},Terrasoft.append=Terrasoft.utils.array.append,Terrasoft.utils.array.appendIf=function(e,t){Terrasoft.append(e,t,!0)},Terrasoft.appendIf=Terrasoft.utils.array.appendIf,Terrasoft.utils.array.mergeSame=function(e,t,r,n){var i=[];return e.forEach((function(e){var a=Ext.Array.findBy(i,(function(r){return t.call(n,e,r)}),n);if(Ext.isEmpty(a))i.push(e);else{var s=r.call(n,a,e);if(!Ext.isEmpty(s)){var o=i.indexOf(a);i[o]=s}}})),i},Terrasoft.mergeSame=Terrasoft.utils.array.mergeSame,Terrasoft.getUniqueValue=function(e,t){var r,n,i=(e instanceof Terrasoft.Collection?e.getItems():e).map((function(e){return e.toLowerCase()})),a=0;do{r=t+ ++a,n=Terrasoft.contains(i,r.toLowerCase())}while(n);return r},Terrasoft.intersect=function(e,t){return e.filter((function(e){return-1!==t.indexOf(e)}))},Terrasoft.utils.array.flatten=function(e,t){return _.flatten(e,t)},Terrasoft.flatten=Terrasoft.utils.array.flatten,Ext.ns("Terrasoft.utils.date"),Terrasoft.utils.date.addDays=function(e,t){if(!(e instanceof Date))throw new Terrasoft.UnsupportedTypeException;if(t=parseInt(t,10),isNaN(t))throw new Terrasoft.UnsupportedTypeException;var r=new Date(e);return r.setDate(r.getDate()+t),r},Terrasoft.addDays=Terrasoft.utils.date.addDays,Terrasoft.utils.date.addMinutes=function(e,t){if(!(e instanceof Date))throw new Terrasoft.UnsupportedTypeException;if(t=parseInt(t,10),isNaN(t))throw new Terrasoft.UnsupportedTypeException;var r=new Date(e);return r.setMinutes(r.getMinutes()+t),r},Terrasoft.addMinutes=Terrasoft.utils.date.addMinutes,Terrasoft.utils.date.areDatesEqual=function(e,t){return!(!Ext.isDate(e)||!Ext.isDate(t))&&(e.getDate()===t.getDate()&&e.getMonth()===t.getMonth()&&e.getFullYear()===t.getFullYear())},Terrasoft.areDatesEqual=Terrasoft.utils.date.areDatesEqual,Terrasoft.utils.date.clearSeconds=function(e){if(!Ext.isDate(e))throw new Terrasoft.exceptions.UnsupportedTypeException;var t=new Date(e);return t=new Date(t.setMilliseconds(0)),t=new Date(t.setSeconds(0))},Terrasoft.clearSeconds=Terrasoft.utils.date.clearSeconds,Terrasoft.utils.date.clearTime=function(e){return Ext.Date.clearTime(e,!0)},Terrasoft.clearTime=Terrasoft.utils.date.clearTime,Terrasoft.utils.date.dateDiffDays=function(e,t){if(Ext.isDate(e)&&Ext.isDate(t)){var r=Date.UTC(e.getFullYear(),e.getMonth(),e.getDate()),n=Date.UTC(t.getFullYear(),t.getMonth(),t.getDate()),i=Terrasoft.DateRate.MILLISECONDS_IN_DAY;return Math.floor((n-r)/i)}throw new Terrasoft.exceptions.InvalidDateFormatException},Terrasoft.dateDiffDays=Terrasoft.utils.date.dateDiffDays,Terrasoft.utils.date.endOfDay=function(e){var t=Ext.Date.clone(e);return t.setHours(23),t.setMinutes(59),t.setSeconds(59),t.setMilliseconds(999),t},Terrasoft.endOfDay=Terrasoft.utils.date.endOfDay,Terrasoft.utils.date.endOfToday=function(){return Terrasoft.endOfDay(new Date)},Terrasoft.endOfToday=Terrasoft.utils.date.endOfToday,Terrasoft.utils.date.endOfMonth=function(e){return Terrasoft.endOfDay(Ext.Date.getLastDateOfMonth(e))},Terrasoft.endOfMonth=Terrasoft.utils.date.endOfMonth,Terrasoft.utils.date.endOfQuarter=function(e){var t=2,r=31;switch(Math.floor(e.getMonth()/3)){case 1:t=5,r=30;break;case 2:t=8,r=30;break;case 3:t=11,r=31}return Terrasoft.endOfDay(new Date(e.getFullYear(),t,r))},Terrasoft.endOfQuarter=Terrasoft.utils.date.endOfQuarter,Terrasoft.utils.date.endOfWeek=function(e){var t=e.getDay()+(1-Terrasoft.Resources.CultureSettings.startDay);return t=t?7-t:t,Terrasoft.endOfDay(Ext.Date.add(e,Ext.Date.DAY,t))},Terrasoft.endOfWeek=Terrasoft.utils.date.endOfWeek,Terrasoft.utils.date.endOfYear=function(e){return new Date(e.getFullYear(),11,31,23,59,59,999)},Terrasoft.endOfYear=Terrasoft.utils.date.endOfYear,Terrasoft.utils.date.getMinutesFromMidnight=function(e){return e.getHours()*Terrasoft.DateRate.MINUTES_IN_HOUR+e.getMinutes()},Terrasoft.getMinutesFromMidnight=Terrasoft.utils.date.getMinutesFromMidnight,Terrasoft.utils.date.isMidnight=function(e){return Ext.Date.isEqual(e,Terrasoft.clearTime(e))},Terrasoft.isMidnight=Terrasoft.utils.date.isMidnight,Terrasoft.utils.date.parseDate=function(e,t,r){var n=Ext.Date.parse(e,t||"c",r||!1);if(!Ext.isDate(n))throw new Terrasoft.exceptions.InvalidDateFormatException;return n},Terrasoft.parseDate=Terrasoft.utils.date.parseDate,Terrasoft.utils.date.startOfDay=function(e){return Ext.Date.clearTime(e,!0)},Terrasoft.startOfDay=Terrasoft.utils.date.startOfDay,Terrasoft.utils.date.startOfMonth=function(e){return Ext.Date.getFirstDateOfMonth(e)},Terrasoft.startOfMonth=Terrasoft.utils.date.startOfMonth,Terrasoft.utils.date.startOfQuarter=function(e){var t=0;switch(Math.floor(e.getMonth()/3)){case 1:t=3;break;case 2:t=6;break;case 3:t=9}return new Date(e.getFullYear(),t,1)},Terrasoft.startOfQuarter=Terrasoft.utils.date.startOfQuarter,Terrasoft.utils.date.startOfWeek=function(e){var t=e.getDay()+(1-Terrasoft.Resources.CultureSettings.startDay);return t=t?1-t:-6,Terrasoft.startOfDay(Ext.Date.add(e,Ext.Date.DAY,t))},Terrasoft.startOfWeek=Terrasoft.utils.date.startOfWeek,Terrasoft.utils.date.startOfYear=function(e){return new Date(e.getFullYear(),0,1)},Terrasoft.startOfYear=Terrasoft.utils.date.startOfYear,Terrasoft.utils.date.toLocaleDate=function(e,t,r){if(Ext.isDate(e)){var n=[];return t&&n.push(t),t&&r&&n.push(r),e.toLocaleDateString.apply(e,n)}throw new Terrasoft.exceptions.InvalidDateFormatException},Terrasoft.toLocaleDate=Terrasoft.utils.date.toLocaleDate,Terrasoft.utils.date.convertToTimeZone=function(e,t,r){if(Ext.isDate(e)){if(t){var n=0,i=t.match("[+-][0-9]{2}:[0-9]{2}");if(i){var a=i[0].split(":");n=60*+a[0],n+=+a[1]}return r&&(n-=r),Terrasoft.utils.date.convertByOffset(e,-n)}return e}throw new Terrasoft.exceptions.InvalidDateFormatException},Terrasoft.convertToTimeZone=Terrasoft.utils.date.convertToTimeZone,Terrasoft.utils.date.toLocalISOString=function(e){if(Ext.isDate(e)){var t=6e4*e.getTimezoneOffset();return new Date(e.getTime()-t).toISOString().slice(0,-1)}throw new Terrasoft.exceptions.InvalidDateFormatException},Terrasoft.toLocalISOString=Terrasoft.utils.date.toLocalISOString,Terrasoft.utils.date.toCultureDateTime=function(e){var t=Terrasoft.Resources,r=t&&t.CultureSettings,n=r&&r.dateFormat,i=r&&r.timeFormat;if(!Ext.isDate(e))throw new Terrasoft.exceptions.InvalidDateFormatException;if(!n||!i)return Terrasoft.toLocalISOString(e);var a=Ext.String.format("{0} {1}",n,i);return Ext.Date.format(new Date(e),a)},Terrasoft.toCultureDateTime=Terrasoft.utils.date.toCultureDateTime,Terrasoft.utils.date.convertByOffset=function(e,t){if(Ext.isDate(e))return t?new Date(e.getTime()+t*Terrasoft.DateRate.MILLISECONDS_IN_MINUTE):e;throw new Terrasoft.exceptions.InvalidDateFormatException},Terrasoft.convertByOffset=Terrasoft.utils.date.convertByOffset,Ext.ns("Terrasoft.utils.object"),Terrasoft.deepClone=function(e){if(!e||"object"!==_typeof(e))return e;if(e.constructor===Date){var t=new Date;return t.setTime(e.getTime()),t}var r=e.constructor===Array,n=r?[]:{};for(var i in e)if(!r||e.hasOwnProperty(i)){var a=e[i];n[i]=Terrasoft.utils.object.deepClone(a)}return n},Terrasoft.utils.object.deepClone=Terrasoft.deepClone,Terrasoft.utils.object.deleteEmptyItems=function(e){if(Ext.isArray(e)||Ext.isObject(e)){var t=Ext.isArray(e),r=Terrasoft.deepClone(e);return Terrasoft.each(r,(function(e,n){Ext.isEmpty(e)&&(t?r.splice(n,1):delete r[n])}),this),r}throw new Terrasoft.UnsupportedTypeException},Terrasoft.deleteEmptyItems=Terrasoft.utils.object.deleteEmptyItems,Terrasoft.utils.object.getPropertyValuesArray=function(e,t){if(Ext.isArray(e)&&Ext.isObject(t)){var r=[];return Terrasoft.each(e,(function(e){t.hasOwnProperty(e)&&r.push(t[e])}),this),r}throw new Terrasoft.UnsupportedTypeException},Terrasoft.getPropertyValuesArray=Terrasoft.utils.object.getPropertyValuesArray,Terrasoft.utils.object.invert=function(e){return _.invert(e)},Terrasoft.invert=Terrasoft.utils.object.invert,Terrasoft.utils.object.pick=function(){return _.pick.apply(this,arguments)},Terrasoft.pick=Terrasoft.utils.object.pick,Terrasoft.utils.object.isEmptyObject=function(e){return!e||0===Terrasoft.utils.object.keys(e).length},Terrasoft.isEmptyObject=Terrasoft.utils.object.isEmptyObject,Terrasoft.utils.object.keys=function(e){return _.keys(e)},Terrasoft.keys=Terrasoft.utils.object.keys,Terrasoft.utils.object.mapObjectToCollection=function(e){var t=[];return Terrasoft.each(e,(function(e,r){Terrasoft.each(e,(function(e,n){(t[n]?t[n]:t[n]={})[r]=e}))})),t},Terrasoft.mapObjectToCollection=Terrasoft.utils.object.mapObjectToCollection,Terrasoft.utils.object.serializeObject=function(e){var t=e.source,r=e.properties||Object.keys(t),n=e.valueConverter,i=e.format;return null==i&&(i=r.reduce((function(e,t){return""!==e&&(e+=";"),e+"{"+t+"}"}),"")),r.forEach((function(e){var r=new RegExp("\\{"+e+"\\}","gi"),a=t[e];a="function"==typeof n?n(a,e):a.toString(),i=i.replace(r,a)}),this),i},Terrasoft.serializeObject=Terrasoft.utils.object.serializeObject,Terrasoft.mapObject=function(e,t,r){return _.mapObject(e,t,r)},Terrasoft.utils.object.serialzieObject=function(e){var t=Ext.String.format(Terrasoft.Resources.ObsoleteMessages.ObsoleteMethodMessage,"Terrasoft.utils.object.serialzieObject","Terrasoft.utils.object.serializeObject");return console.log(t),Terrasoft.utils.object.serializeObject(e)},Terrasoft.serialzieObject=Terrasoft.utils.object.serialzieObject,Terrasoft.utils.object.isEqual=function(e,t){return _.isEqual(e,t)},Terrasoft.isEqual=Terrasoft.utils.object.isEqual,Terrasoft.utils.object.removeProperties=function(e,t){Ext.isObject(e)&&Ext.isArray(t)&&Terrasoft.each(t,(function(t){delete e[t]}))},Terrasoft.removeProperties=Terrasoft.utils.object.removeProperties,Terrasoft.findValueByPath=function(e,t){if(!Ext.isObject(e)||!Ext.isString(t))throw new Terrasoft.UnsupportedTypeException;for(var r=t.split("."),n=e,i=0;i<r.length;i++){if(!Ext.isObject(n)&&!Ext.isArray(n))return;if(n=n[r[i]],!Ext.isDefined(n))break}return n},Terrasoft.utils.object.findValueByPath=Terrasoft.findValueByPath,Terrasoft.get=Terrasoft.findValueByPath,Terrasoft.utils.object.filterObject=function(e,t){var r={};return Terrasoft.each(e,(function(e,n){_.every(t,(function(t,r){return _.has(e,r)&&e[r]===t}))&&(r[n]=e)})),r},Terrasoft.filterObject=Terrasoft.utils.object.filterObject,Terrasoft.utils.object.encodeHtmlObjectValues=function(e){return Terrasoft.each(e,(function(t,r){e[r]=Terrasoft.encodeHtml(t)}),this),e},Terrasoft.encodeHtmlObjectValues=Terrasoft.utils.object.encodeHtmlObjectValues,Terrasoft.filterObjectList=function(e,t,r){var n={};for(var i in e)e.hasOwnProperty(i)&&t.call(r||e,e[i],i,e)&&(n[i]=e[i]);return n},Terrasoft.sortObj=function(e,t){var r=[];Terrasoft.each(e,(function(e,t){r.push({key:t,item:e})}),this);var n=t;t&&!Ext.isFunction(t)?n=function(e){return e.item&&e.item[t]}:t||(n=function(e){return e.item}),r=_.sortBy(r,n);var i={};return r.forEach((function(e){i[e.key]=e.item})),i},Terrasoft.utils.object.omit=function(e,t){return _.omit(e,t)},Terrasoft.omit=Terrasoft.utils.object.omit,Ext.ns("Terrasoft.utils.dataValueType"),Terrasoft.convertToClientDataValueType=function(e){var t=Terrasoft.ServerDataValueType[e];if(null==t)throw new Terrasoft.ItemNotFoundException;return t},Terrasoft.utils.dataValueType.convertToClientDataValueType=Terrasoft.convertToClientDataValueType,Terrasoft.convertToServerDataValueType=function(e){var t=null;if(Terrasoft.each(Terrasoft.ServerDataValueType,(function(r,n){return e===r&&(t=n),null==t})),!t)throw new Terrasoft.ItemNotFoundException;return t},Terrasoft.utils.dataValueType.convertToServerDataValueType=Terrasoft.convertToServerDataValueType,Terrasoft.utils.dataValueType.getImageNameByDataValueType=function(e){var t;switch(e){case Terrasoft.DataValueType.TEXT:case Terrasoft.DataValueType.SHORT_TEXT:case Terrasoft.DataValueType.PHONE_TEXT:case Terrasoft.DataValueType.WEB_TEXT:case Terrasoft.DataValueType.EMAIL_TEXT:case Terrasoft.DataValueType.MEDIUM_TEXT:case Terrasoft.DataValueType.LONG_TEXT:case Terrasoft.DataValueType.RICH_TEXT:case Terrasoft.DataValueType.MAXSIZE_TEXT:case Terrasoft.DataValueType.SECURE_TEXT:case Terrasoft.DataValueType.HASH_TEXT:case Terrasoft.DataValueType.METADATA_TEXT:t="Text.svg";break;case Terrasoft.DataValueType.LOCALIZABLE_STRING:t="LocalizableString.svg";break;case Terrasoft.DataValueType.INTEGER:t="Integer.svg";break;case Terrasoft.DataValueType.FLOAT:case Terrasoft.DataValueType.FLOAT1:case Terrasoft.DataValueType.FLOAT2:case Terrasoft.DataValueType.FLOAT3:case Terrasoft.DataValueType.FLOAT4:case Terrasoft.DataValueType.FLOAT8:case Terrasoft.DataValueType.MONEY:t="Float.svg";break;case Terrasoft.DataValueType.DATE_TIME:case Terrasoft.DataValueType.DATE:case Terrasoft.DataValueType.TIME:t="DateTime.svg";break;case Terrasoft.DataValueType.BOOLEAN:t="Boolean.svg";break;case Terrasoft.DataValueType.LOOKUP:t="Lookup.svg";break;case Terrasoft.DataValueType.GUID:t="Guid.svg";break;case Terrasoft.DataValueType.FILE_LOCATOR:t="File.svg";break;case Terrasoft.DataValueType.COLLECTION:case Terrasoft.DataValueType.ENTITY_COLLECTION:case Terrasoft.DataValueType.ENTITY_COLUMN_MAPPING_COLLECTION:case Terrasoft.DataValueType.LOCALIZABLE_PARAMETER_VALUES_LIST:case Terrasoft.DataValueType.ENTITY:case Terrasoft.DataValueType.CUSTOM_OBJECT:case Terrasoft.DataValueType.COLOR:case Terrasoft.DataValueType.IMAGELOOKUP:case Terrasoft.DataValueType.COMPOSITE_OBJECT_LIST:case Terrasoft.DataValueType.OBJECT_LIST:t="Collection.svg";break;default:t="NoType.svg"}return t},Terrasoft.getImageNameByDataValueType=Terrasoft.utils.dataValueType.getImageNameByDataValueType,Terrasoft.utils.dataValueType.isDateDataValueType=function(e){var t=Terrasoft.utils.dataValueType.DateDataValueTypes;return Terrasoft.contains(t,e)},Terrasoft.isDateDataValueType=Terrasoft.utils.dataValueType.isDateDataValueType,Terrasoft.isInstanceOfClass=function(e,t){return e instanceof Ext.ClassManager.get(t)},Terrasoft.utils.dataValueType.isInstanceOfClass=Terrasoft.isInstanceOfClass,Terrasoft.utils.dataValueType.isLookupDataValueType=function(e){var t=[Terrasoft.DataValueType.LOOKUP,Terrasoft.DataValueType.ENUM];return Terrasoft.contains(t,e)},Terrasoft.isLookupDataValueType=Terrasoft.utils.dataValueType.isLookupDataValueType,Terrasoft.isNumberDataValueType=function(e){var t=Terrasoft.utils.dataValueType.NumberDataValueTypes;return Terrasoft.contains(t,e)},Terrasoft.isFloatDataValueType=function(e){var t=Terrasoft.utils.dataValueType.FloatDataValueTypes;return Terrasoft.contains(t,e)},Terrasoft.utils.dataValueType.NumberDataValueTypes=[Terrasoft.DataValueType.INTEGER,Terrasoft.DataValueType.MONEY,Terrasoft.DataValueType.FLOAT,Terrasoft.DataValueType.FLOAT1,Terrasoft.DataValueType.FLOAT2,Terrasoft.DataValueType.FLOAT3,Terrasoft.DataValueType.FLOAT4,Terrasoft.DataValueType.FLOAT8],Terrasoft.utils.dataValueType.FloatDataValueTypes=[Terrasoft.DataValueType.FLOAT,Terrasoft.DataValueType.FLOAT1,Terrasoft.DataValueType.FLOAT2,Terrasoft.DataValueType.FLOAT3,Terrasoft.DataValueType.FLOAT4,Terrasoft.DataValueType.FLOAT8],Terrasoft.utils.dataValueType.DateDataValueTypes=[Terrasoft.DataValueType.DATE,Terrasoft.DataValueType.DATE_TIME,Terrasoft.DataValueType.TIME],Terrasoft.utils.dataValueType.LookupMappingDataValueTypes=[Terrasoft.DataValueType.LOOKUP,Terrasoft.DataValueType.GUID,Terrasoft.DataValueType.ENUM],Terrasoft.utils.dataValueType.MoneyCompatibleDataValueTypes=[Terrasoft.DataValueType.MONEY,Terrasoft.DataValueType.FLOAT,Terrasoft.DataValueType.FLOAT1,Terrasoft.DataValueType.FLOAT2,Terrasoft.DataValueType.FLOAT3,Terrasoft.DataValueType.FLOAT4,Terrasoft.DataValueType.FLOAT8],Terrasoft.utils.dataValueType.TextDataValueTypes=[Terrasoft.DataValueType.TEXT,Terrasoft.DataValueType.SHORT_TEXT,Terrasoft.DataValueType.MEDIUM_TEXT,Terrasoft.DataValueType.MAXSIZE_TEXT,Terrasoft.DataValueType.LONG_TEXT,Terrasoft.DataValueType.LOCALIZABLE_STRING],Terrasoft.utils.dataValueType.ExtraTextDataValueTypes=[Terrasoft.DataValueType.PHONE_TEXT,Terrasoft.DataValueType.EMAIL_TEXT,Terrasoft.DataValueType.RICH_TEXT,Terrasoft.DataValueType.WEB_TEXT],Terrasoft.utils.dataValueType.AllTextDataValueTypes=[].concat(_toConsumableArray(Terrasoft.utils.dataValueType.TextDataValueTypes),_toConsumableArray(Terrasoft.utils.dataValueType.ExtraTextDataValueTypes));var _getTextDataValueTypes=function(){return Terrasoft.Features.getIsDisabled("DisableAdditionalFormatsForTextDataValueType")?Terrasoft.utils.dataValueType.AllTextDataValueTypes:Terrasoft.utils.dataValueType.TextDataValueTypes};Terrasoft.utils.dataValueType.isNumberDataValueType=Terrasoft.isNumberDataValueType,Terrasoft.utils.dataValueType.validateObjectClass=function(e,t){var r=Terrasoft.isInstanceOfClass(e,t);if(!r)throw new Terrasoft.UnsupportedTypeException({message:Ext.String.format(Terrasoft.Resources.Core.InvalidObjectClass,t)});return r},Terrasoft.validateObjectClass=Terrasoft.utils.dataValueType.validateObjectClass,Terrasoft.isTextDataValueType=function(e){var t=_getTextDataValueTypes();return Terrasoft.contains(t,e)},Terrasoft.utils.dataValueType.isExtraTextDataValueType=function(e){return Terrasoft.contains(Terrasoft.utils.dataValueType.ExtraTextDataValueTypes,e)},Terrasoft.utils.dataValueType.isTextDataValueType=Terrasoft.isTextDataValueType,Terrasoft.utils.dataValueType.isTextDataValueTypeWithExtraTypes=function(e){return Terrasoft.contains(Terrasoft.utils.dataValueType.AllTextDataValueTypes,e)},Terrasoft.isPhoneDataValueType=function(e){return e===Terrasoft.DataValueType.PHONE_TEXT},Terrasoft.isWebDataValueType=function(e){return e===Terrasoft.DataValueType.WEB_TEXT},Terrasoft.isEmailDataValueType=function(e){return e===Terrasoft.DataValueType.EMAIL_TEXT},Terrasoft.isRichTextDataValueType=function(e){return e===Terrasoft.DataValueType.RICH_TEXT},Terrasoft.utils.dataValueType.isBooleanDataValueType=function(e){return e===Terrasoft.DataValueType.BOOLEAN},Terrasoft.isBooleanDataValueType=Terrasoft.utils.dataValueType.isBooleanDataValueType,Terrasoft.utils.dataValueType.isGUIDDataValueType=function(e){return e===Terrasoft.DataValueType.GUID},Terrasoft.isGUIDDataValueType=Terrasoft.utils.dataValueType.isGUIDDataValueType,Terrasoft.utils.dataValueType.isLookupValidator=function(e){return Terrasoft.isGUIDDataValueType(e)||Terrasoft.isLookupDataValueType(e)},Terrasoft.isLookupValidator=Terrasoft.utils.dataValueType.isLookupValidator,Terrasoft.utils.dataValueType.isImageDataValueType=function(e){return Terrasoft.DataValueType.IMAGE===e},Terrasoft.isImageDataValueType=Terrasoft.utils.dataValueType.isImageDataValueType,Terrasoft.utils.dataValueType.isEntityDataValueType=function(e){return Terrasoft.DataValueType.ENTITY===e},Terrasoft.isEntityDataValueType=Terrasoft.utils.dataValueType.isEntityDataValueType,Terrasoft.utils.dataValueType.isEntityCollectionDataValueType=function(e){return Terrasoft.DataValueType.ENTITY_COLLECTION===e},Terrasoft.isEntityCollectionDataValueType=Terrasoft.utils.dataValueType.isEntityCollectionDataValueType,Terrasoft.utils.dataValueType.isCompositeObjectListDataValueType=function(e){return Terrasoft.DataValueType.COMPOSITE_OBJECT_LIST===e},Terrasoft.isCompositeObjectListDataValueType=Terrasoft.utils.dataValueType.isCompositeObjectListDataValueType,Terrasoft.utils.dataValueType.isObjectListDataValueType=function(e){return Terrasoft.DataValueType.OBJECT_LIST===e},Terrasoft.isObjectListDataValueType=Terrasoft.utils.dataValueType.isObjectListDataValueType,Terrasoft.utils.dataValueType.isEnumerableDataValueType=function(e){return Terrasoft.isObjectListDataValueType(e)||Terrasoft.isCompositeObjectListDataValueType(e)},Terrasoft.isEnumerableDataValueType=Terrasoft.utils.dataValueType.isEnumerableDataValueType,Terrasoft.utils.dataValueType.isIntegerDataValueType=function(e){return Terrasoft.DataValueType.INTEGER===e},Terrasoft.isIntegerDataValueType=Terrasoft.utils.dataValueType.isIntegerDataValueType,Terrasoft.utils.dataValueType.isValidForMappingOnTimeDataValueType=function(e){var t=[Terrasoft.DataValueType.DATE_TIME,Terrasoft.DataValueType.TIME];return Terrasoft.contains(t,e)},Terrasoft.isValidForMappingOnTimeDataValueType=Terrasoft.utils.dataValueType.isValidForMappingOnTimeDataValueType,Terrasoft.utils.dataValueType.isValidForMappingOnDateDataValueType=function(e){var t=[Terrasoft.DataValueType.DATE_TIME,Terrasoft.DataValueType.DATE];return Terrasoft.contains(t,e)},Terrasoft.isValidForMappingOnDateDataValueType=Terrasoft.utils.dataValueType.isValidForMappingOnDateDataValueType,Terrasoft.utils.dataValueType.isFileLocatorDataValueType=function(e){return Terrasoft.DataValueType.FILE_LOCATOR===e},Terrasoft.utils.dataValueType.isMoneyCompatibleDataValueType=function(e){var t=Terrasoft.utils.dataValueType.MoneyCompatibleDataValueTypes;return Terrasoft.contains(t,e)},Terrasoft.isFileLocatorDataValueType=Terrasoft.utils.dataValueType.isFileLocatorDataValueType,Terrasoft.isMoneyCompatibleDataValueType=Terrasoft.utils.dataValueType.isMoneyCompatibleDataValueType,Terrasoft.utils.dataValueType.findDataValueTypeValidator=function(e){return Terrasoft.DataValueType.TIME===e?Terrasoft.isValidForMappingOnTimeDataValueType:Terrasoft.DataValueType.DATE===e?Terrasoft.isValidForMappingOnDateDataValueType:Terrasoft.DataValueType.DATE_TIME===e?Terrasoft.isDateDataValueType:Terrasoft.isLookupValidator(e)?Terrasoft.isLookupValidator:Terrasoft.isIntegerDataValueType(e)?Terrasoft.isIntegerDataValueType:Terrasoft.isMoneyCompatibleDataValueType(e)?Terrasoft.isMoneyCompatibleDataValueType:Terrasoft.isTextDataValueType(e)?Terrasoft.isTextDataValueType:Terrasoft.isPhoneDataValueType(e)?Terrasoft.isPhoneDataValueType:Terrasoft.isWebDataValueType(e)?Terrasoft.isWebDataValueType:Terrasoft.isEmailDataValueType(e)?Terrasoft.isEmailDataValueType:Terrasoft.isRichTextDataValueType(e)?Terrasoft.isRichTextDataValueType:Terrasoft.isBooleanDataValueType(e)?Terrasoft.isBooleanDataValueType:Terrasoft.isImageDataValueType(e)?Terrasoft.isImageDataValueType:Terrasoft.isEntityDataValueType(e)?Terrasoft.isEntityDataValueType:Terrasoft.isEntityCollectionDataValueType(e)?Terrasoft.isEntityCollectionDataValueType:Terrasoft.DataValueType.COMPOSITE_OBJECT_LIST===e?Terrasoft.isCompositeObjectListDataValueType:Terrasoft.DataValueType.OBJECT_LIST===e?Terrasoft.isObjectListDataValueType:Terrasoft.isFileLocatorDataValueType(e)?Terrasoft.isFileLocatorDataValueType:null},Terrasoft.findDataValueTypeValidator=Terrasoft.utils.dataValueType.findDataValueTypeValidator,Terrasoft.utils.dataValueType.getSysSettingsValueTypeGroup=function(e){return Terrasoft.isLookupDataValueType(e)||Terrasoft.isGUIDDataValueType(e)?["Lookup"]:e===Terrasoft.DataValueType.DATE?["DateTime","Date"]:e===Terrasoft.DataValueType.TIME?["DateTime","Time"]:Terrasoft.isDateDataValueType(e)?["DateTime","Date","Time"]:Terrasoft.isBooleanDataValueType(e)?["Boolean"]:Terrasoft.isTextDataValueType(e)?["RichText","MaxSizeText","MediumText","ShortText","PhoneText","WebText","EmailText","Text","LongText"]:Terrasoft.isNumberDataValueType(e)?["Float","Integer","Money"]:["Lookup","Date","Time","DateTime","Float","Boolean","Integer","Money","RichText","MaxSizeText","MediumText","ShortText","PhoneText","WebText","EmailText","Text","LongText","Binary","SecureText"]},Terrasoft.getSysSettingsValueTypeGroup=Terrasoft.utils.dataValueType.getSysSettingsValueTypeGroup,Terrasoft.utils.dataValueType.getDataValueTypeCaption=function(e){var t=null;return Terrasoft.each(Terrasoft.DataValueType,(function(r,n){if(r===e)return t=Terrasoft.Resources.DataValueType[n],!1}),this),t},Terrasoft.getDataValueTypeCaption=Terrasoft.utils.dataValueType.getDataValueTypeCaption,Terrasoft.utils.dataValueType.getDataValueTypeName=function(e){var t=null;return Terrasoft.each(Terrasoft.DataValueType,(function(r,n){if(r===e)return t=n,!1}),this),t},Terrasoft.getDataValueTypeName=Terrasoft.utils.dataValueType.getDataValueTypeName,Terrasoft.utils.dataValueType.toDataValueTypeGroup=function(e){var t=[];return Terrasoft.isTextDataValueType(e)?t=_getTextDataValueTypes():Terrasoft.isNumberDataValueType(e)?t=Terrasoft.utils.dataValueType.NumberDataValueTypes:Terrasoft.isDateDataValueType(e)?t=Terrasoft.utils.dataValueType.DateDataValueTypes:Terrasoft.isLookupValidator(e)?t=Terrasoft.utils.dataValueType.LookupMappingDataValueTypes:t.push(e),t},Terrasoft.utils.dataValueType.getBaseDataValueType=function(e){var t;switch(!0){case Terrasoft.isTextDataValueType(e):t=Terrasoft.DataValueType.TEXT;break;case Terrasoft.isFloatDataValueType(e):t=Terrasoft.DataValueType.FLOAT;break;default:t=e}return t},Terrasoft.toDataValueTypeGroup=Terrasoft.utils.dataValueType.toDataValueTypeGroup,Terrasoft.getBaseDataValueType=Terrasoft.utils.dataValueType.getBaseDataValueType,Ext.ns("Terrasoft.utils.guid"),Terrasoft.generateGUID=function(e){var t=Ext.data.IdGenerator.get("uuid").generate();return Terrasoft.formatGUID(t,e)},Terrasoft.utils.guid.generateGUID=Terrasoft.generateGUID,Terrasoft.formatGUID=function(e,t){switch(t){case"N":return e.replace(/-/g,"");case"B":return"{"+e+"}";case"P":return"("+e+")";case"D":default:return e}},Terrasoft.isEmptyGUID=function(e){return new RegExp("^(0){8}-(0){4}-(0){4}-(0){4}-(0){12}$").test(e)},Terrasoft.utils.guid.isEmptyGUID=Terrasoft.isEmptyGUID,Terrasoft.isGUID=function(e){return new RegExp("^[a-f0-9]{8}-[a-f0-9]{4}-[a-f0-9]{4}-[a-f0-9]{4}-[a-f0-9]{12}$","i").test(e)},Terrasoft.utils.guid.isGUID=Terrasoft.isGUID,Terrasoft.utils.guid.ByteToHexMap=["00","01","02","03","04","05","06","07","08","09","0a","0b","0c","0d","0e","0f","10","11","12","13","14","15","16","17","18","19","1a","1b","1c","1d","1e","1f","20","21","22","23","24","25","26","27","28","29","2a","2b","2c","2d","2e","2f","30","31","32","33","34","35","36","37","38","39","3a","3b","3c","3d","3e","3f","40","41","42","43","44","45","46","47","48","49","4a","4b","4c","4d","4e","4f","50","51","52","53","54","55","56","57","58","59","5a","5b","5c","5d","5e","5f","60","61","62","63","64","65","66","67","68","69","6a","6b","6c","6d","6e","6f","70","71","72","73","74","75","76","77","78","79","7a","7b","7c","7d","7e","7f","80","81","82","83","84","85","86","87","88","89","8a","8b","8c","8d","8e","8f","90","91","92","93","94","95","96","97","98","99","9a","9b","9c","9d","9e","9f","a0","a1","a2","a3","a4","a5","a6","a7","a8","a9","aa","ab","ac","ad","ae","af","b0","b1","b2","b3","b4","b5","b6","b7","b8","b9","ba","bb","bc","bd","be","bf","c0","c1","c2","c3","c4","c5","c6","c7","c8","c9","ca","cb","cc","cd","ce","cf","d0","d1","d2","d3","d4","d5","d6","d7","d8","d9","da","db","dc","dd","de","df","e0","e1","e2","e3","e4","e5","e6","e7","e8","e9","ea","eb","ec","ed","ee","ef","f0","f1","f2","f3","f4","f5","f6","f7","f8","f9","fa","fb","fc","fd","fe","ff"],Terrasoft.convertGUIDToBytes=function(e){var t=0,r=[];for(e.toLowerCase().replace(/[0-9a-f]{2}/g,(function(e){t<16&&(r[t]=parseInt(e,16),t++)}));t<16;)r[t++]=0;return r},Terrasoft.utils.guid.convertGUIDToBytes=Terrasoft.convertGUIDToBytes,Terrasoft.convertBytesToGUID=function(e){var t=Terrasoft.utils.guid.ByteToHexMap,r=0;return t[e[r++]]+t[e[r++]]+t[e[r++]]+t[e[r++]]+"-"+t[e[r++]]+t[e[r++]]+"-"+t[e[r++]]+t[e[r++]]+"-"+t[e[r++]]+t[e[r++]]+"-"+t[e[r++]]+t[e[r++]]+t[e[r++]]+t[e[r++]]+t[e[r++]]+t[e[r++]]},Terrasoft.utils.guid.convertBytesToGUID=Terrasoft.convertBytesToGUID,Terrasoft.xorToGUID=function(e,t){var r=Terrasoft.convertGUIDToBytes(e),n=Terrasoft.convertGUIDToBytes(t);return Terrasoft.each(n,(function(e,t){r[t]^=e})),Terrasoft.convertBytesToGUID(r)},Terrasoft.utils.guid.xorToGUID=Terrasoft.xorToGUID,Ext.ns("Terrasoft.utils.enums"),Terrasoft.utils.enums.convertToServerAggregationType=function(e){return e&&e!==Terrasoft.AggregationType.NONE?(e-1).toString():Terrasoft.AggregationType.NONE.toString()},Terrasoft.convertToServerAggregationType=Terrasoft.utils.enums.convertToServerAggregationType,Ext.ns("Terrasoft.utils.uri"),Terrasoft.utils.uri.getQueryStrig=function(e){if(Ext.isString(e)){var t=e;(e=document.createElement("a")).href=t}var r="";return e instanceof HTMLAnchorElement&&(r=e.search||""),r.substring(1)},Terrasoft.getQueryStrig=Terrasoft.utils.uri.getQueryStrig,Terrasoft.utils.uri.encodeQueryParameters=function(e){var t=e.split(/\?(.*)/g);if(t.length>=2){for(var r,n,i,a=[],s=t[1].split(/[&;]/g),o=0;o<s.length;o++){var l=s[o].split(/[=;]/g);r=encodeURIComponent(decodeURIComponent(l[0])),i=(n=l[1]?encodeURIComponent(decodeURIComponent(l[1])):"")?r.concat("=",n):r,a.push(i)}return t[0]+(a.length>0?"?"+a.join("&"):"")}return e},Terrasoft.encodeQueryParameters=Terrasoft.utils.uri.encodeQueryParameters,Terrasoft.utils.uri.removeQueryParameters=function(e,t){var r=function(e){if(e instanceof HTMLAnchorElement){var t=e.attributes.getNamedItem("href"),r="";return t&&(r=t.nodeValue),r}return e}(e);if(Ext.isEmpty(r)||!Ext.isString(r))return"";var n=document.createElement("a");if(n.href=r,Ext.isEmpty(n.search))return r;var i=Terrasoft.getQueryStrig(n),a=Ext.urlDecode(i);Terrasoft.removeProperties(a,t),n.search=Ext.urlEncode(a);var s=n.href||"";return Ext.String.endsWith(s,"?")&&(s=s.replace(/\?$/,"")),n=null,s},Terrasoft.removeQueryParameters=Terrasoft.utils.uri.removeQueryParameters,Terrasoft.utils.uri.getQueryParameter=function(e,t,r){if(!e||!t)return null;var n=RegExp("[?&]"+t+"=([^&]*)").exec(e);return n&&(r?decodeURIComponent(n[1]):n[1])},Terrasoft.getQueryParameter=Terrasoft.utils.uri.getQueryParameter,Terrasoft.utils.uri.isUrl=function(e){return/(((^https?)|(^ftp)):\/\/([\-\w])+(\.[a-z]{2,4})*(:[0-9]+)?(\/[%\-\w]+(\.\w{2,})?)*(([\w\-\.\?\\\/+@&#;`~=%!]*)(\.\w{2,})?)*)\/?/i.test(e)},Terrasoft.isUrl=Terrasoft.utils.uri.isUrl,Terrasoft.utils.uri.getUrls=function(e){if(!Ext.isString(e))return[];return e.match(/(((https?)|(ftp)):\/\/([\-\w])+(\.[a-z]{2,4})*(:[0-9]+)?(\/[%\-\w]+(\.\w{2,})?)*(([\w-.?\/+@&#;`~=%!$-_+*'(),]*)(\.\w{2,})?)*)\/?/gi)||[]},Terrasoft.getUrls=Terrasoft.utils.uri.getUrls,Terrasoft.utils.uri.addProtocolPrefix=function(e){return new RegExp("((ftp|http|https|file)://)+","i").test(e)?e:"http://"+e},Terrasoft.addProtocolPrefix=Terrasoft.utils.uri.addProtocolPrefix,Terrasoft.utils.uri.isAValidUrlIgnoreProtocol=function(e){return new RegExp(/[-a-zA-Z0-9@:%_\+.~#?&//=]{2,256}\.[a-z]{2,4}\b(\/[-a-zA-Z0-9@:%_\+.~#?&//=]*)?/gi).test(e)},Terrasoft.utils.uri.isAValidNetworkPath=function(e){return new RegExp(/^\\(\\[^\s\\]+)+(\\)?$/gi).test(e)},Terrasoft.utils.uri.getUrlOrigin=function(e){var t=document.createElement("a");return t.href=e,t.origin},Terrasoft.getUrlOrigin=Terrasoft.utils.uri.getUrlOrigin,Terrasoft.getEmptyModuleUrl=function(){return"../core/hash/Terrasoft/amd/empty-module"},Terrasoft.utils.uri.getUrlDomain=function(e){var t=new RegExp("^(https?:\\/\\/)?((([\\da-z\\.-]+)\\.?([a-z\\.]{2,6})?([\\w \\.-]))|(((25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)(\\.|))){4})(:\\d{1,5})?","g").exec(e);return t&&t[0]},Terrasoft.getUrlDomain=Terrasoft.utils.uri.getUrlDomain,Terrasoft.utils.uri.getUrlHash=function(e){var t=document.createElement("a");return t.href=e,t.hash},Terrasoft.getUrlHash=Terrasoft.utils.uri.getUrlHash,Terrasoft.utils.uri.getConfigurationWebServiceBaseUrl=function(){return Terrasoft.CurrentUser&&Terrasoft.isCurrentUserSsp()&&Terrasoft.Features.getIsEnabled("EnableCustomPrefixRouteApi")?Terrasoft.utils.common.combinePath(Terrasoft.workspaceBaseUrl,"ssp"):Terrasoft.workspaceBaseUrl},Terrasoft.getConfigurationWebServiceBaseUrl=Terrasoft.utils.uri.getConfigurationWebServiceBaseUrl,Terrasoft.utils.uri.getUIHostUrl=function(){var e;if(Terrasoft.isAngularHost)return location.origin+location.pathname;var t=Terrasoft.workspaceBaseUrl+"/Nui/ViewModule.aspx";if(Terrasoft.Features.getIsEnabled("DisableKeepClassicUiQueryParam"))return t;var r=null===(e=location.search.match(/\bclassicui\b/i))||void 0===e?void 0:e[0];return t+(r?"?"+r:"")},Terrasoft.getUIHostUrl=Terrasoft.utils.uri.getUIHostUrl,Terrasoft.utils.uri.fixUrlInAngularHost=function(e){var t=e;Terrasoft.isAngularHost&&(/^https?\:\/\//.test(e)||(t=location.pathname+e),t=(t=t.replace(/ViewModule.aspx#/gi,"#")).replace(/shell\/ViewModule.aspx\?vm=/gi,"ViewModule.aspx?vm="));return t},Terrasoft.fixUrlInAngularHost=Terrasoft.utils.uri.fixUrlInAngularHost,Terrasoft.utils.uri.getAngularHostUrl=function(){return Terrasoft.workspaceBaseUrl+"/Shell/"},Terrasoft.getAngularHostUrl=Terrasoft.utils.uri.getAngularHostUrl,Ext.ns("Terrasoft.utils.file"),Terrasoft.utils.file.upload=function(e,t,r){e.upload=function(){this.showMask()}.bind(r),e.complete=t,e.data={},e.prepare=function(e,t){var r=t.data||{};Ext.apply(r,{totalFileLength:e.size,fileName:e.name})},e.headers={},Terrasoft.AjaxProvider.addCsrfTokenToHeaders(e.headers),FileAPI.upload(e)},Terrasoft.fileUpload=Terrasoft.utils.file.upload,Ext.ns("Terrasoft.utils.color"),Terrasoft.utils.color.hsv2rgb=function(e,t,r){if(!Ext.isNumber(e)||!Ext.isNumber(t)||!Ext.isNumber(r))throw new Terrasoft.UnsupportedTypeException;var n=Terrasoft.hsv2hsl(e,t,r),i=Ext.draw.Color.fromHSL(n[0],n[1],n[2]);return[Math.round(i.getRed()),Math.round(i.getGreen()),Math.round(i.getBlue())]},Terrasoft.hsv2rgb=Terrasoft.utils.color.hsv2rgb,Terrasoft.utils.color.hsv2hsl=function(e,t,r){if(!Ext.isNumber(e)||!Ext.isNumber(t)||!Ext.isNumber(r))throw new Terrasoft.UnsupportedTypeException;var n=(2-t)*r,i=t*r,a=n<=1?n:2-n;return[e,i=0!==a?i/a:0,n/=2]},Terrasoft.hsv2hsl=Terrasoft.utils.color.hsv2hsl,Terrasoft.utils.color.rgb2hex=function(e){if(Ext.isArray(e)&&(e=Ext.String.format("rgb({0}, {1}, {2})",e[0],e[1],e[2])),!Ext.isString(e))throw new Terrasoft.UnsupportedTypeException;return Ext.draw.Color.toHex(e)},Terrasoft.rgb2hex=Terrasoft.utils.color.rgb2hex,Terrasoft.utils.color.hex2rgb=function(e){if(!Terrasoft.isHexValue(e))throw new Terrasoft.UnsupportedTypeException;var t=Ext.draw.Color.fromString(e);return[parseInt(t.getRed()),parseInt(t.getGreen()),parseInt(t.getBlue())]},Terrasoft.hex2rgb=Terrasoft.utils.color.hex2rgb,Terrasoft.utils.color.rgb2hsv=function(e){if(Ext.isArray(e)&&(e=Ext.String.format("rgb({0}, {1}, {2})",e[0],e[1],e[2])),!Ext.isString(e))throw new Terrasoft.UnsupportedTypeException;var t=Ext.draw.Color.fromString(e).getHSL(),r=t[0];r=Ext.isDefined(r)?r:0;var n=Terrasoft.hsl2hsv(r,t[1],t[2]);return[n[0],n[1],n[2]]},Terrasoft.rgb2hsv=Terrasoft.utils.color.rgb2hsv,Terrasoft.utils.color.hsl2hsv=function(e,t,r){if(!Ext.isNumber(e)||!Ext.isNumber(t)||!Ext.isNumber(r))throw new Terrasoft.UnsupportedTypeException;var n=((r*=2)+(t*=r<=1?r:2-r))/2,i=r+t,a=0!==i?2*t/i:0;return[e=Ext.isDefined(e)?e:0,a,n]},Terrasoft.hsl2hsv=Terrasoft.utils.color.hsl2hsv,Terrasoft.utils.color.hex2hsv=function(e){return Terrasoft.rgb2hsv(Terrasoft.hex2rgb(e))},Terrasoft.hex2hsv=Terrasoft.utils.color.hex2hsv,Terrasoft.utils.color.hsv2hex=function(e,t,r){var n=Terrasoft.hsv2rgb(e,t,r);return Terrasoft.rgb2hex(n)},Terrasoft.hsv2hex=Terrasoft.utils.color.hsv2hex,Terrasoft.utils.color.rgbString2Array=function(e){if(!Ext.isString(e))throw new Terrasoft.UnsupportedTypeException;var t=e.substring(4,e.length-1).replace(/ /g,"").split(",");return t=t.map((function(e){return parseInt(e)}))},Terrasoft.rgbString2Array=Terrasoft.utils.color.rgbString2Array,Terrasoft.utils.color.isHexValue=function(e){if(!Ext.isString(e))return!1;return!!e.match(/^#+([a-fA-F0-9]{6}|[a-fA-F0-9]{3})$/)},Terrasoft.isHexValue=Terrasoft.utils.color.isHexValue,Terrasoft.utils.color.isRgbValue=function(e){return Ext.isString(e)&&0===e.indexOf("rgb")&&(e=Terrasoft.rgbString2Array(e)),!(!Ext.isArray(e)||e.length<3)&&e.every((function(e){return Ext.isNumber(e)&&e>=0&&e<=255}))},Terrasoft.isRgbValue=Terrasoft.utils.color.isRgbValue,Terrasoft.utils.color.checkIsColorByEncoding=function(e,t){var r,n=Terrasoft.ColorEncoding;switch(t){case n.HEX:r=Terrasoft.isHexValue(e);break;case n.RGB:r=Terrasoft.isRgbValue(e);break;default:throw new Terrasoft.UnsupportedTypeException}return r},Terrasoft.checkIsColorByEncoding=Terrasoft.utils.color.checkIsColorByEncoding,Terrasoft.utils.color.getColorByEncoding=function(e,t){var r,n=Terrasoft.ColorEncoding;switch(t){case n.HEX:r=Terrasoft.hsv2hex(e[0],e[1],e[2]);break;case n.RGB:r=Terrasoft.hsv2rgb(e[0],e[1],e[2]),r=Ext.String.format("rgb({0})",r.join(", "));break;default:throw new Terrasoft.UnsupportedTypeException}return r},Terrasoft.getColorByEncoding=Terrasoft.utils.color.getColorByEncoding,Terrasoft.utils.color.getHSVByEncoding=function(e,t){var r,n=Terrasoft.ColorEncoding;switch(t){case n.HEX:r=Terrasoft.hex2hsv(e);break;case n.RGB:r=Terrasoft.rgb2hsv(e);break;default:throw new Terrasoft.UnsupportedTypeException}return r},Terrasoft.getHSVByEncoding=Terrasoft.utils.color.getHSVByEncoding,Terrasoft.utils.color.getColorHue=function(e,t){var r=parseInt(e.substring(1,3),16),n=parseInt(e.substring(3,5),16),i=parseInt(e.substring(5,7),16);return r=parseInt(r*(100+t)/100),n=(n=parseInt(n*(100+t)/100))<255?n:255,i=(i=parseInt(i*(100+t)/100))<255?i:255,"#"+(1==(r=r<255?r:255).toString(16).length?"0"+r.toString(16):r.toString(16))+(1==n.toString(16).length?"0"+n.toString(16):n.toString(16))+(1==i.toString(16).length?"0"+i.toString(16):i.toString(16))},Terrasoft.getColorHue=Terrasoft.utils.color.getColorHue,Ext.ns("Terrasoft.utils.executionZone");var targetExecutionZoneKey=Symbol("targetExecutionZone");Terrasoft.utils.executionZone.attach=function(e,t){t&&(e[targetExecutionZoneKey]||Object.defineProperty(e,targetExecutionZoneKey,{get:function(){return t}}))},Terrasoft.utils.executionZone.safeExecute=function(e,t){var r=e[targetExecutionZoneKey];return r?r.run(t):t()},Ext.ns("Terrasoft.utils.sso"),Ext.define("Terrasoft.utils.sso.providers.SamlStartSsoClientProvider",{alternateClassName:"Terrasoft.SamlStartSsoClientProvider",singleton:!0,startSso:function(e){Terrasoft.SsoUtils.startSsoLogin(e.id)}}),Ext.ns("Terrasoft.utils.sso"),Ext.define("Terrasoft.utils.sso.providers.OpenIdStartSsoClientProvider",{alternateClassName:"Terrasoft.OpenIdStartSsoClientProvider",singleton:!0,_baseViewModulePath:Terrasoft.BaseViewModulePath||window.baseViewModulePath,_autoOpenIdLoginParamName:"autoOpenIdLogin",_autoOpenSsoLoginParamName:"autoSsoLogin",_getRootUrl:function(e){if(!e)return null;return Terrasoft.workspaceBaseUrl.replace(/\/$/,"")+("NETCOREAPP"===Terrasoft.appFramework?"/":"/0/")+e},_updateQueryStringParameter:function(e,t,r){var n=new RegExp("([?&])"+t+"=.*?(&|$)","i"),i=-1!==e.indexOf("?")?"&":"?";return e.match(n)?e.replace(n,"$1"+t+"="+r+"$2"):e+i+t+"="+r},_tryParse:function(e){try{return JSON.parse(e)}catch(e){return{}}},getRedirectUrlWithAutoOpenIdLogin:function(e){var t=Terrasoft.LoginModelUtils.getWindowQueryStringWithoutHash(window.location),r=window.location,n=Terrasoft.LoginModelUtils.containsIgnoreCase(r.pathname,t),i=Terrasoft.LoginModelUtils.containsIgnoreCase(t,Terrasoft.simpleLoginTag),a=t;if(n||i){if(Terrasoft.openIdRootUrl)return this._getRootUrl(Terrasoft.openIdRootUrl);a=this._getRootUrl(this._baseViewModulePath)}return a=e?this._updateQueryStringParameter(a,this._autoOpenSsoLoginParamName,e):this._updateQueryStringParameter(a,this._autoOpenIdLoginParamName,!0),r.hash&&(a+=r.hash),a},redirectToOpenIdAuthorizeEndpoint:function(e){var t={returnUrl:this.getRedirectUrlWithAutoOpenIdLogin(e),providerCode:e},r={url:Terrasoft.workspaceBaseUrl+"/ServiceModel/AuthService.svc/GetOpenIdAuthorizeUrl",jsonData:JSON.stringify(t),method:"POST",callback:function(e,t,r){var n=this._tryParse(r.responseText);if(t)window.location.replace(n);else{var i=n.Message;i&&Terrasoft.showErrorMessage(i)}},scope:this};Terrasoft.AjaxProvider.request(r)},startSso:function(e){var t={url:Terrasoft.workspaceBaseUrl+"/ServiceModel/AuthService.svc/Logout",method:"POST",callback:function(){this.redirectToOpenIdAuthorizeEndpoint(null==e?void 0:e.code)},scope:this};Terrasoft.AjaxProvider.request(t)}}),Ext.ns("Terrasoft.utils.twoFactorAuth"),Ext.define("Terrasoft.utils.twoFactorAuth.TwoFactorAuthUtils",{alternateClassName:"Terrasoft.TwoFactorAuthUtils",singleton:!0,_sendTextCodeEndpointUrl:"/ServiceModel/AuthService.svc/StartTextCodeAuthFlow",_isTextCodeDefaultProviderUrl:"/ServiceModel/AuthService.svc/GetAuthenticationSettings",sendTextCode:function(e,t,r,n){var i={UserName:e,UserPassword:t},a={url:Terrasoft.workspaceBaseUrl+this._sendTextCodeEndpointUrl,headers:{"Content-Type":"application/json",Accept:"application/json"},scope:n,callback:r,jsonData:JSON.stringify(i),securitySensitiveFields:["UserPassword"]};Terrasoft.AjaxProvider.request(a)},getAuthenticationSettings:function(e,t){if(Terrasoft.enabled2FAFlow){var r={url:Terrasoft.workspaceBaseUrl+this._isTextCodeDefaultProviderUrl,scope:t,callback:function(r,n,i){if(n){var a=JSON.parse(i.responseText);e.call(t,a)}},method:"POST"};Terrasoft.AjaxProvider.request(r)}else e.call(t,{})}}),Ext.ns("Terrasoft.utils.html");var sanitizationLevel={DEFAULT:0,TEXT_ONLY:1,NONE:2,ALLOW_TARGET_LINKS:3,HTML:4},_getSanitizeConfig=function(e){switch(e){case sanitizationLevel.DEFAULT:return{ADD_TAGS:["#comment","signature"],FORCE_BODY:!0};case sanitizationLevel.ALLOW_TARGET_LINKS:return{ADD_ATTR:["target"],FORCE_BODY:!0};case sanitizationLevel.TEXT_ONLY:return{ALLOWED_TAGS:["p","#text"]};case sanitizationLevel.HTML:return{ADD_TAGS:["head","#comment","signature"],WHOLE_DOCUMENT:!0};default:return{}}},_Terrasoft$process$en;function _createForOfIteratorHelper(e,t){var r;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(r=_unsupportedIterableToArray(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,i=function(){};return{s:i,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,s=!0,o=!1;return{s:function(){r=e[Symbol.iterator]()},n:function(){var e=r.next();return s=e.done,e},e:function(e){o=!0,a=e},f:function(){try{s||null==r.return||r.return()}finally{if(o)throw a}}}}function _unsupportedIterableToArray(e,t){if(e){if("string"==typeof e)return _arrayLikeToArray(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?_arrayLikeToArray(e,t):void 0}}function _arrayLikeToArray(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function _toConsumableArray(e){return _arrayWithoutHoles(e)||_iterableToArray(e)||_unsupportedIterableToArray(e)||_nonIterableSpread()}function _nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _unsupportedIterableToArray(e,t){if(e){if("string"==typeof e)return _arrayLikeToArray(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?_arrayLikeToArray(e,t):void 0}}function _iterableToArray(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}function _arrayWithoutHoles(e){if(Array.isArray(e))return _arrayLikeToArray(e)}function _arrayLikeToArray(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function _createForOfIteratorHelper(e,t){var r;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(r=_unsupportedIterableToArray(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,i=function(){};return{s:i,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,s=!0,o=!1;return{s:function(){r=e[Symbol.iterator]()},n:function(){var e=r.next();return s=e.done,e},e:function(e){o=!0,a=e},f:function(){try{s||null==r.return||r.return()}finally{if(o)throw a}}}}function _unsupportedIterableToArray(e,t){if(e){if("string"==typeof e)return _arrayLikeToArray(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?_arrayLikeToArray(e,t):void 0}}function _arrayLikeToArray(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function _typeof(e){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function asyncGeneratorStep(e,t,r,n,i,a,s){try{var o=e[a](s),l=o.value}catch(e){return void r(e)}o.done?t(l):Promise.resolve(l).then(n,i)}function _asyncToGenerator(e){return function(){var t=this,r=arguments;return new Promise((function(n,i){var a=e.apply(t,r);function s(e){asyncGeneratorStep(a,n,i,s,o,"next",e)}function o(e){asyncGeneratorStep(a,n,i,s,o,"throw",e)}s(void 0)}))}}function ownKeys(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function _objectSpread(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?ownKeys(Object(r),!0).forEach((function(t){_defineProperty(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):ownKeys(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function _defineProperty(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function ownKeys(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function _objectSpread(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?ownKeys(Object(r),!0).forEach((function(t){_defineProperty(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):ownKeys(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function _defineProperty(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function _toConsumableArray(e){return _arrayWithoutHoles(e)||_iterableToArray(e)||_unsupportedIterableToArray(e)||_nonIterableSpread()}function _nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _unsupportedIterableToArray(e,t){if(e){if("string"==typeof e)return _arrayLikeToArray(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?_arrayLikeToArray(e,t):void 0}}function _iterableToArray(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}function _arrayWithoutHoles(e){if(Array.isArray(e))return _arrayLikeToArray(e)}function _arrayLikeToArray(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function ownKeys(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function _objectSpread(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?ownKeys(Object(r),!0).forEach((function(t){_defineProperty(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):ownKeys(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function _defineProperty(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function _createForOfIteratorHelper(e,t){var r;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(r=_unsupportedIterableToArray(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,i=function(){};return{s:i,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,s=!0,o=!1;return{s:function(){r=e[Symbol.iterator]()},n:function(){var e=r.next();return s=e.done,e},e:function(e){o=!0,a=e},f:function(){try{s||null==r.return||r.return()}finally{if(o)throw a}}}}function _unsupportedIterableToArray(e,t){if(e){if("string"==typeof e)return _arrayLikeToArray(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?_arrayLikeToArray(e,t):void 0}}function _arrayLikeToArray(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function _toConsumableArray(e){return _arrayWithoutHoles(e)||_iterableToArray(e)||_unsupportedIterableToArray(e)||_nonIterableSpread()}function _nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _unsupportedIterableToArray(e,t){if(e){if("string"==typeof e)return _arrayLikeToArray(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?_arrayLikeToArray(e,t):void 0}}function _iterableToArray(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}function _arrayWithoutHoles(e){if(Array.isArray(e))return _arrayLikeToArray(e)}function _arrayLikeToArray(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function _typeof(e){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function _toConsumableArray(e){return _arrayWithoutHoles(e)||_iterableToArray(e)||_unsupportedIterableToArray(e)||_nonIterableSpread()}function _nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _unsupportedIterableToArray(e,t){if(e){if("string"==typeof e)return _arrayLikeToArray(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?_arrayLikeToArray(e,t):void 0}}function _iterableToArray(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}function _arrayWithoutHoles(e){if(Array.isArray(e))return _arrayLikeToArray(e)}function _arrayLikeToArray(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function _typeof(e){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}
/*!
 * HTMLMinifier v3.5.20 (https://kangax.github.io/html-minifier/)
 * Copyright 2010-2018 Juriy "kangax" Zaytsev
 * Licensed under the MIT license
 */function _toConsumableArray(e){return _arrayWithoutHoles(e)||_iterableToArray(e)||_unsupportedIterableToArray(e)||_nonIterableSpread()}function _nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _unsupportedIterableToArray(e,t){if(e){if("string"==typeof e)return _arrayLikeToArray(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?_arrayLikeToArray(e,t):void 0}}function _iterableToArray(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}function _arrayWithoutHoles(e){if(Array.isArray(e))return _arrayLikeToArray(e)}function _arrayLikeToArray(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function asyncGeneratorStep(e,t,r,n,i,a,s){try{var o=e[a](s),l=o.value}catch(e){return void r(e)}o.done?t(l):Promise.resolve(l).then(n,i)}function _asyncToGenerator(e){return function(){var t=this,r=arguments;return new Promise((function(n,i){var a=e.apply(t,r);function s(e){asyncGeneratorStep(a,n,i,s,o,"next",e)}function o(e){asyncGeneratorStep(a,n,i,s,o,"throw",e)}s(void 0)}))}}function _toConsumableArray(e){return _arrayWithoutHoles(e)||_iterableToArray(e)||_unsupportedIterableToArray(e)||_nonIterableSpread()}function _nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _unsupportedIterableToArray(e,t){if(e){if("string"==typeof e)return _arrayLikeToArray(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?_arrayLikeToArray(e,t):void 0}}function _iterableToArray(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}function _arrayWithoutHoles(e){if(Array.isArray(e))return _arrayLikeToArray(e)}function _arrayLikeToArray(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function _toConsumableArray(e){return _arrayWithoutHoles(e)||_iterableToArray(e)||_unsupportedIterableToArray(e)||_nonIterableSpread()}function _nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _unsupportedIterableToArray(e,t){if(e){if("string"==typeof e)return _arrayLikeToArray(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?_arrayLikeToArray(e,t):void 0}}function _iterableToArray(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}function _arrayWithoutHoles(e){if(Array.isArray(e))return _arrayLikeToArray(e)}function _arrayLikeToArray(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function asyncGeneratorStep(e,t,r,n,i,a,s){try{var o=e[a](s),l=o.value}catch(e){return void r(e)}o.done?t(l):Promise.resolve(l).then(n,i)}function _asyncToGenerator(e){return function(){var t=this,r=arguments;return new Promise((function(n,i){var a=e.apply(t,r);function s(e){asyncGeneratorStep(a,n,i,s,o,"next",e)}function o(e){asyncGeneratorStep(a,n,i,s,o,"throw",e)}s(void 0)}))}}function _toConsumableArray(e){return _arrayWithoutHoles(e)||_iterableToArray(e)||_unsupportedIterableToArray(e)||_nonIterableSpread()}function _nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _unsupportedIterableToArray(e,t){if(e){if("string"==typeof e)return _arrayLikeToArray(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?_arrayLikeToArray(e,t):void 0}}function _iterableToArray(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}function _arrayWithoutHoles(e){if(Array.isArray(e))return _arrayLikeToArray(e)}function _arrayLikeToArray(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function _defineProperty(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}Terrasoft.utils.html.decodeHtml=function(e){return Ext.util.Format.htmlDecode(e)},Terrasoft.decodeHtml=Terrasoft.utils.html.decodeHtml,Terrasoft.utils.html.encodeHtml=function(e){return Ext.util.Format.htmlEncode(e)},Terrasoft.encodeHtml=Terrasoft.utils.html.encodeHtml,Terrasoft.utils.html.decodeHtmlEntities=function(e){if(!Ext.isString(e)||""===e)return e;var t=document.createElement("textarea");t.innerHTML=e.replace(/</g,"&lt;").replace(/>/g,"&gt;");var r=t.value;return t=null,r},Terrasoft.decodeHtmlEntities=Terrasoft.utils.html.decodeHtmlEntities,Terrasoft.utils.html.stripTags=function(e){return Ext.util.Format.stripTags(e)},Terrasoft.stripTags=Terrasoft.utils.html.stripTags,Terrasoft.utils.html.unescape=function(e){return _.unescape(e)},Terrasoft.unescape=Terrasoft.utils.html.unescape,Terrasoft.utils.html.removeHtmlTags=function(e){if(Ext.isString(e)){e=(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=Terrasoft.decodeHtml(e)).replace(/<head>[\s\S]*<\/head>/,"")).replace(/<style>[\s\S]*<\/style>/,"")).replace(/<script>[\s\S]*<\/script>/,"")).replace(/<noscript>[\s\S]*<\/noscript>/,"")).replace(/<svg[\s\S]*<\/svg>/,"")).replace(/<form[\s\S]*<\/form>/,"")).replace(/(<([\s/]*(a|o:p|xml|abbr|acronym|address|applet|area|article|aside|audio|b|base|basefont|bdi|bdo|bgsound|blockquote|big|body|blink|br|button|canvas|caption|center|cite|code|col|colgroup|command|comment|datalist|dd|del|details|dfn|dir|div|dl|dt|em|embed|fieldset|figcaption|figure|font|form|footer|frame|frameset|h1|h2|h3|h4|h5|h6|head|header|hgroup|hr|html|i|iframe|img|input|ins|isindex|kbd|keygen|label|legend|li|link|main|map|marquee|mark|menu|meta|meter|nav|nobr|noembed|noframes|noscript|object|ol|optgroup|option|output|p|param|plaintext|pre|progress|q|rp|rt|ruby|s|samp|script|section|select|signature|small|span|source|strike|strong|style|sub|summary|sup|table|tbody|td|textarea|tfoot|th|thead|time|title|tr|tt|u|ul|var|video|wbr|xmp)(\b|\/)[^@>]*)>)/gi,"")).replace(/&nbsp;/g," ")).replace(/<![\s\S]*?>/g,"")).replace(/<!DOCTYPE[\s\S]*?>/g,"")}return e},Terrasoft.removeHtmlTags=Terrasoft.utils.html.removeHtmlTags,Terrasoft.utils.html.sanitizeHTML=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:sanitizationLevel.DEFAULT;if(!e)return"";if(!Terrasoft.enableSanitizeHtml||t===sanitizationLevel.NONE)return e;var r=_getSanitizeConfig(t);return DOMPurify.sanitize(e,r)},Terrasoft.sanitizationLevel=sanitizationLevel,Terrasoft.sanitizeHTML=Terrasoft.utils.html.sanitizeHTML,Ext.ns("Terrasoft.utils.string"),Terrasoft.utils.string.emptyString="",Terrasoft.emptyString=Terrasoft.utils.string.emptyString,Terrasoft.utils.string._tryWrapWordIntoLines=function(e,t,r,n,i){var a=r.pop()||[],s=r.length+1===i,o=a.reduce((function(e,t){return e+t.length}),0),l={isLastLine:s,maxLineLength:n,currentLineLength:o,remainderLineLength:n-o};return Terrasoft.utils.string._tryAddWordToLine(e,a,l,r)||Terrasoft.utils.string._tryAddWordToNextLine(e,a,l,t,r)||Terrasoft.utils.string._tryAddWordWrapBySyllable(e,a,l,t,r)},Terrasoft.utils.string._tryAddWordToLine=function(e,t,r,n){return e.length<=r.remainderLineLength+1&&(t.push(e),n.push(t),!0)},Terrasoft.utils.string._tryAddWordToNextLine=function(e,t,r,n,i){var a=r.isLastLine,s=r.currentLineLength;return!a&&0!==s&&(i.push(t),i.push([]),n.unshift(e),!0)},Terrasoft.utils.string._tryAddWordWrapBySyllable=function(e,t,r,n,i){var a=r.isLastLine,s=r.remainderLineLength,o=e.substring(0,s),l=e.substring(s,e.length);return a?(1===o.length?t.push("..."):t.push(o+"..."),i.push(t),!1):(t.push(o+"-"),n.unshift(l),i.push(t),i.push([]),!0)},Terrasoft.getFormattedString=function(e){var t=Array.prototype.slice.call(arguments,1),r=/\{(\d*)\}/gi;if(void 0===e)throw new Error("parameter string is not defined");return e.replace(r,(function(e,r){var n=parseInt(r,Terrasoft.NumeralSystem.DECIMAL);return t[n]||e}))},Terrasoft.getTypedStringValue=function(e,t,r){if(Ext.isNumber(t))switch(t){case Terrasoft.DataValueType.DATE:return Ext.isDate(e)?Ext.Date.format(e,Terrasoft.Resources.CultureSettings.dateFormat):"";case Terrasoft.DataValueType.TIME:return Ext.isDate(e)?Ext.Date.format(e,Terrasoft.Resources.CultureSettings.timeFormat):"";case Terrasoft.DataValueType.DATE_TIME:return Ext.isDate(e)?Ext.Date.format(e,Terrasoft.Resources.CultureSettings.dateFormat+" "+Terrasoft.Resources.CultureSettings.timeFormat):"";case Terrasoft.DataValueType.LOOKUP:case Terrasoft.DataValueType.MAPPING:return e?e.displayValue:"";case Terrasoft.DataValueType.MONEY:return Terrasoft.getFormattedNumberValue(e,{type:Terrasoft.DataValueType.MONEY});case Terrasoft.DataValueType.FLOAT:var n=r?r.decimalPrecision:null;return Terrasoft.getFormattedNumberValue(e,{decimalPrecision:n});case Terrasoft.DataValueType.INTEGER:return Terrasoft.getFormattedNumberValue(e,{type:Terrasoft.DataValueType.INTEGER});case Terrasoft.DataValueType.TEXT:case Terrasoft.DataValueType.SHORT_TEXT:case Terrasoft.DataValueType.MEDIUM_TEXT:case Terrasoft.DataValueType.LONG_TEXT:case Terrasoft.DataValueType.MAXSIZE_TEXT:case Terrasoft.DataValueType.GUID:case Terrasoft.DataValueType.COLOR:return e;case Terrasoft.DataValueType.BOOLEAN:return e?Terrasoft.Resources.CommonUtils.TrueStringValue:Terrasoft.Resources.CommonUtils.FalseStringValue;default:throw new Terrasoft.exceptions.UnsupportedTypeException({message:t+" is unsupported type"})}},Terrasoft.utils.string.getTypedStringValue=Terrasoft.getTypedStringValue,Terrasoft.utils.string.getUniformString=function(e,t){return e<=0?"":new Array(e+1).join(t)},Terrasoft.getUniformString=Terrasoft.utils.string.getUniformString,Terrasoft.utils.string.isUrl=function(e){var t=Ext.String.format(Terrasoft.Resources.ObsoleteMessages.ObsoleteMethodMessage,"Terrasoft.utils.isUrl","Terrasoft.utils.uri.isUrl");return console.log(t),Terrasoft.utils.uri.isUrl(e)},Terrasoft.utils.string.pad=function(e,t,r){return r=r||"0",(e=String(e)).length>=t?e:new Array(t-e.length+1).join(r)+e},Terrasoft.pad=Terrasoft.utils.string.pad,Terrasoft.utils.string.reverseStr=function(e){return e.split("").reverse().join("")},Terrasoft.reverseStr=Terrasoft.utils.string.reverseStr,Terrasoft.utils.string.toLowerCamelCase=function(e){return e.length>0?e.substr(0,1).toLowerCase()+e.substr(1):""},Terrasoft.toLowerCamelCase=Terrasoft.utils.string.toLowerCamelCase,Terrasoft.utils.string.toCamelCase=function(e){return e.length>0?e.substr(0,1).toUpperCase()+e.substr(1):""},Terrasoft.toCamelCase=Terrasoft.utils.string.toCamelCase,Terrasoft.utils.string.convertEolToUnix=function(e){var t=String.fromCharCode(13,10),r=String.fromCharCode(10);return(e||"").replace(new RegExp(t,"g"),r)},Terrasoft.convertEolToUnix=Terrasoft.utils.string.convertEolToUnix,Terrasoft.isJsonObject=function(e,t){if(null==e)return!1;var r=!1===t?Ext.global.JSON5.parse:Ext.JSON.decode;try{var n=r(e);return Ext.isArray(n)||Ext.isObject(n)}catch(e){return!1}},Terrasoft.utils.string.isJsonObject=Terrasoft.isJsonObject,Terrasoft.utils.string.includes=function(e,t){return-1!==e.indexOf(t)},Terrasoft.includes=Terrasoft.utils.string.includes,Terrasoft.utils.string.containsRtlChars=function(e){return/[\u0591-\u07FF\uFB1D-\uFDFD\uFE70-\uFEFC]/.test(e)},Terrasoft.containsRtlChars=Terrasoft.utils.string.containsRtlChars,Terrasoft.utils.string.getTextDirection=function(e){return!Terrasoft.getIsRtlMode()||Ext.isEmpty(e)?null:Terrasoft.containsRtlChars(e)?"rtl":"ltr"},Terrasoft.getTextDirection=Terrasoft.utils.string.getTextDirection,Terrasoft.utils.string.randomString=function(){return Math.random().toString(36).substring(2)},Terrasoft.utils.string.wrapTextIntoLines=function(e,t){for(var r=(t=t||{}).maxLinesCount,n=t.maxLineLength||10,i=t.textSeparator||" ",a=[],s=e.split(i).filter((function(e){return Terrasoft.isNotEmpty(e)}));s&&s.length>0;){var o=s.shift().trim();if(!Terrasoft.utils.string._tryWrapWordIntoLines(o,s,a,n,r))break}return a},Terrasoft.wrapTextIntoLines=Terrasoft.utils.string.wrapTextIntoLines,Terrasoft.randomString=Terrasoft.utils.string.randomString,Terrasoft.utils.string.decodeHtml=Terrasoft.decodeHtml,Terrasoft.utils.string.encodeHtml=Terrasoft.encodeHtml,Terrasoft.utils.string.decodeHtmlEntities=Terrasoft.decodeHtmlEntities,Terrasoft.utils.string.stripTags=Terrasoft.stripTags,Terrasoft.utils.string.unescape=Terrasoft.unescape,Terrasoft.utils.string.removeHtmlTags=Terrasoft.removeHtmlTags,Terrasoft.utils.string.sanitizeHTML=Terrasoft.sanitizeHTML,Terrasoft.endsWith=function(e,t){return-1!==e.indexOf(t,e.length-t.length)},Terrasoft.utils.string.endsWith=Terrasoft.endsWith,Ext.ns("Terrasoft.utils.sso"),Ext.define("Terrasoft.utils.SsoUtils",{alternateClassName:"Terrasoft.SsoUtils",singleton:!0,_logoutReasons:[{code:"unauthorized",isError:!0},{code:"logout"},{code:"samlprovidererror",isError:!0}],_useSsoParameterName:"use_sso",_startSsoParameterName:"start_sso",_errorCodeParameterName:"ErrorCode",_returnUrlHashParameterName:"ReturnUrlHash",_ssoLogoutCookieName:"SsoLogout",_openIdLogoutCookieName:"OpenIDLogout",_ssoLoginCookieName:"SsoRequested",_ssoSessionCookieName:"SsoSessionId",_startSsoEndpoint:"/ServiceModel/AuthService.svc/StartSsoLogin",_hasRequestParam:function(e){var t=this.getWindowLocation();return Terrasoft.includes(t.search,e)},getWindowLocation:function(){return Ext.getDoc().dom.location},_fixRedirectUrl:function(e){var t="";return(e.search&&e.search.replace("?","")||"").split("&").forEach((function(e){var r=e.split("=")[0];r!==this._useSsoParameterName&&r!==this._startSsoParameterName&&(t+=(t?"&":"?")+e)}),this),t},_getBaseUrl:function(){return Terrasoft.loaderBaseUrl.endsWith("/")?Terrasoft.loaderBaseUrl.slice(0,-1):Terrasoft.loaderBaseUrl},_clearOldSsoSession:function(){var e=Ext.util.Cookies.get(this._ssoSessionCookieName);if(e){var t={url:Terrasoft.workspaceBaseUrl+"/ServiceModel/AuthService.svc/ClearSsoSession",jsonData:JSON.stringify(e),headers:{"Content-Type":"application/json",Accept:"application/json"},method:"POST",callback:function(){},scope:this};Terrasoft.AjaxProvider.request(t)}Ext.util.Cookies.clear(this._ssoSessionCookieName)},initiateSsoLogin:function(){this._clearOldSsoSession();var e=this.getWindowLocation();if(this._hasRequestParam(this._errorCodeParameterName))e.search=this._fixRedirectUrl(e);else{if(this.isSsoUnauthorized())return""!=e.search&&(e.search=""),Ext.util.Cookies.clear(this._ssoLogoutCookieName),void Ext.util.Cookies.clear(this._openIdLogoutCookieName);if(this.getNeedStartSso()){var t=e.hash.replace("#","");e.search+=Ext.String.format("&{0}=true&{1}={2}",this._startSsoParameterName,this._returnUrlHashParameterName,t)}}},isUnauthorized:function(e,t){var r=Ext.util.Cookies.get(t);if(!r)return!1;var n=decodeURIComponent(r).replace(/\+/g," "),i=JSON.parse(n),a=Ext.Array.findBy(this._logoutReasons,(function(e){return e.code===i.reason}),this),s=!Ext.isEmpty(a);return s&&e&&!Ext.isEmpty(a.isError)&&(e.message=decodeURIComponent(escape(i.message))),s},isSsoUnauthorized:function(e){return this.isUnauthorized(e,this._ssoLogoutCookieName)},isOpenIdUnauthorized:function(e){return this.isUnauthorized(e,this._openIdLogoutCookieName)},getNeedStartSso:function(){if(this._hasRequestParam(this._errorCodeParameterName))return!1;var e=Ext.util.Cookies.get(this._ssoLoginCookieName),t=this._hasRequestParam(this._useSsoParameterName),r=this._hasRequestParam(this._returnUrlHashParameterName),n=!Ext.isEmpty(e);return(t||n)&&!r},getNeedShowLogin:function(){return this.getNeedShowSsoLogin()},getNeedShowSsoLogin:function(){var e=this.getNeedStartSso(),t={},r=this.isSsoUnauthorized(t);return r&&t.message&&(Terrasoft.authenticationException={message:t.message}),Ext.util.Cookies.clear(this._ssoLogoutCookieName),e&&!r},startSsoLogin:function(e,t){var r=window.location.hash.replace("#",""),n=new URL(this._getBaseUrl()+this._startSsoEndpoint);e&&n.searchParams.append("partnerIdp",e),r&&n.searchParams.append(this._returnUrlHashParameterName,r),this._clearOldSsoSession(),window.open(n.href,t||"_self")},getSsoLoginLinks:function(){var e=[];return Terrasoft.each(window.SsoIdentityProviders,(function(t){e.push(Ext.create("Terrasoft.Label",{caption:Terrasoft.Resources.LoginPage.SsoLogin+" ("+t.caption+")",markerValue:"ssoLogin_"+t.id,classes:{labelClass:["login-label-smallCaption","login-label-blue","login-label-help"]},tag:t.id,click:{bindTo:"onSsoLoginClick"}}))}),this),e}}),Ext.ns("Terrasoft.utils.number"),Terrasoft.utils.number.zerosRe=/^(0*)(\d*)$/,Terrasoft.utils.number.floatRe=/^(-?)(0*)(\d*)([,.]?)(\d*)$/,Terrasoft.utils.number.splitNumber=function(e){var t=Terrasoft.utils.number.floatRe.exec(e),r={};if(null===t)return null;r.isNegative=!!t[1];var n=t[2],i=t[3];return r.integer=""!==i?i:""!==n?"0":"",r.separator=t[4],r.decimal=t[5],r},Terrasoft.splitNumber=Terrasoft.utils.number.splitNumber,Terrasoft.utils.number.roundValue=function(e,t){var r=Math.pow(10,t||0);return Math.round(e*r)/r},Terrasoft.roundValue=Terrasoft.utils.number.roundValue,Terrasoft.utils.number.getFormattedNumberValue=function(e,t){var r=(t=t||{}).type||Terrasoft.DataValueType.FLOAT,n=Terrasoft.Resources.CultureSettings,i=t.numberGroupSizes||n.numberGroupSizes,a=void 0!==t.thousandSeparator?t.thousandSeparator:n.thousandSeparator;!1===t.useThousandSeparator&&(a="");var s=t.decimalSeparator||n.decimalSeparator,o=r===Terrasoft.DataValueType.MONEY,l=o?Terrasoft.SysValue.CURRENT_MONEY_DISPLAY_PRECISION:2,c=Ext.isNumber(t.decimalPrecision)?t.decimalPrecision:l;o?e=Terrasoft.utils.number.roundValue(Number(e),c):r===Terrasoft.DataValueType.INTEGER&&(c=0);var u=Terrasoft.numberToString(e);if(""===u)return"";var h=Terrasoft.splitNumber(u);if(null===h)return"";var f=h.isNegative,d=h.integer,p=h.decimal;if(""===d&&""===p)return"";var m="";return p=Terrasoft.discardZeros(p,c),f&&(""!==d&&"0"!==d||""!==p)&&(m+="-"),""!==a&&d&&d.length>i&&(d=Terrasoft.getIntegerFormattedValue(d,{thousandSeparator:a,numberGroupSizes:i})),m+=d,(o||r===Terrasoft.DataValueType.FLOAT)&&(p=Terrasoft.complementZeros(p,c)),p&&(m+=s+p),m},Terrasoft.getFormattedNumberValue=Terrasoft.utils.number.getFormattedNumberValue,Terrasoft.utils.number.getFormattedMoneyValue=function(e){var t={type:Terrasoft.DataValueType.MONEY};return Terrasoft.utils.number.getFormattedNumberValue(e||0,t)},Terrasoft.getFormattedMoneyValue=Terrasoft.utils.number.getFormattedMoneyValue,Terrasoft.utils.number.discardZeros=function(e,t){if(!e)return"";var r=e;if((t=Ext.isNumber(t)?t:Terrasoft.Resources.CultureSettings.decimalPrecision)>r.length)return r;r=r.slice(0,t);var n=Terrasoft.reverseStr,i=n(r),a=Terrasoft.utils.number.zerosRe.exec(i)[2];return a?n(a):""},Terrasoft.discardZeros=Terrasoft.utils.number.discardZeros,Terrasoft.utils.number.complementZeros=function(e,t){var r=e,n=r.length,i=Terrasoft.getUniformString;if(t=Ext.isNumber(t)?t:Terrasoft.Resources.CultureSettings.precision,!r)return i(t,"0");if(t===n)return r;n>t?r=r.slice(0,t):r+=i(t-n,"0");return r},Terrasoft.complementZeros=Terrasoft.utils.number.complementZeros,Terrasoft.utils.number.getIntegerFormattedValue=function(e,t){var r=(t=t||{}).numberGroupSizes||Terrasoft.Resources.CultureSettings.numberGroupSizes,n=t.thousandSeparator||Terrasoft.Resources.CultureSettings.thousandSeparator;if(!e)return"";for(var i,a=[],s=0,o=e.length;o>0;)(s=o-r)<0&&(s=0),i=e.slice(s,o),a.push(i),o-=r;return a.reverse(),a.join(n)},Terrasoft.getIntegerFormattedValue=Terrasoft.utils.number.getIntegerFormattedValue,Terrasoft.utils.number.numberToString=function(e,t){t=t||Terrasoft.Resources.CultureSettings.decimalSeparator;var r=String(e),n=/^([+|-]?)(\d*)(?:\.?)(\d*)(?:[e|E]{1})([+|-]?)(\d{0,3})$/.exec(r);if(n){var i=n[1],a=n[2],s=n[3],o=n[4],l=n[5];if(r=i,"-"===o){var c=Terrasoft.getUniformString(l-a.length,"0");r+=Ext.String.format("0{0}{1}{2}{3}",t,c,a,s)}else{var u=Terrasoft.getUniformString(l-s.length,"0");r+=Ext.String.format("{0}{1}{2}",a,s,u)}}return r},Terrasoft.numberToString=Terrasoft.utils.number.numberToString,Terrasoft.utils.number.parseNumber=function(e,t){var r=(t=t||{}).decimalSeparator||Terrasoft.Resources.CultureSettings.decimalSeparator,n=t.thousandSeparator||Terrasoft.Resources.CultureSettings.thousandSeparator,i=t.type||Terrasoft.DataValueType.FLOAT,a=null;if("number"==typeof e)a=e;else if("string"==typeof e&&""!==e){function s(e){var t=new RegExp(String.fromCharCode(160),"g"),r=String.fromCharCode(32);return e.replace(t,r)}n=Ext.String.escapeRegex(n),e=s(e),n=s(n);var o,l=new RegExp(n,"g"),c=e.replace(l,"");c=c.replace(r,"."),i===Terrasoft.DataValueType.INTEGER?o=parseInt(c,Terrasoft.NumeralSystem.DECIMAL):i===Terrasoft.DataValueType.FLOAT&&(o=parseFloat(c)),a=isNaN(o)?null:o}return a},Terrasoft.parseNumber=Terrasoft.utils.number.parseNumber,Terrasoft.utils.number.validateNumberRange=function(e,t,r){var n={invalidMessage:"",isValid:!1};return r>t?n.invalidMessage=Terrasoft.Resources.BaseViewModel.columnIncorrectMaxNumberValidationMessage:r<e?n.invalidMessage=Terrasoft.Resources.BaseViewModel.columnIncorrectMinNumberValidationMessage:n.isValid=!0,n},Terrasoft.validateNumberRange=Terrasoft.utils.number.validateNumberRange,Terrasoft.utils.number.truncateNumber=function(e){return Ext.isNumber(e)?require("numeral")(e).format("0.0a").replace(".0",""):e},Terrasoft.truncateNumber=Terrasoft.utils.number.truncateNumber,Ext.ns("Terrasoft.utils.common"),Terrasoft.abstractFn=function(){var e=arguments.callee,t=e.$name,r=e.$owner.$className,n=this.$className;throw new Terrasoft.NotImplementedException({message:Ext.String.format(Terrasoft.Resources.CommonUtils.InterfaceMemberNotImplementedInClass,r,t,n)})},Terrasoft.utils.common.addSchemaItems=function(e,t,r){var n=Terrasoft.findItem(e,{name:t});return Ext.isEmpty(n)?null:Ext.Array.push(n.parent,r)},Terrasoft.addSchemaItems=Terrasoft.utils.common.addSchemaItems,Terrasoft.utils.common.applySchemaItemProperties=function(e,t,r){var n=Terrasoft.findItem(e,{name:t});return Ext.isEmpty(n)?null:Ext.apply(n.item,r)},Terrasoft.applySchemaItemProperties=Terrasoft.utils.common.applySchemaItemProperties,Terrasoft.chain=function(){var e=this,t=regeneratorRuntime.mark(i),r=function(e){var t=Ext.isObject(e[0])&&Ext.isArray(e[1]);if(t){Terrasoft.utils.common.obsoleteChain(e[0],e[1]);var r=Ext.String.format(Terrasoft.Resources.ObsoleteMessages.MethodFormatObsolete,"Terrasoft.chain","Object, Function[]","Function, ..., Function [, Object]");window.console.log(r)}return t},n=function(t){var r=t[t.length-1],n=e;if(Ext.isObject(r))n=r,Array.prototype.pop.call(t);else if(!Ext.isFunction(r))throw new Terrasoft.UnsupportedTypeException;return n};function i(e){var r,i,a,s;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:r=n(e),i=_createForOfIteratorHelper(e),t.prev=2,i.s();case 4:if((a=i.n()).done){t.next=14;break}if(s=a.value,Ext.isFunction(s)){t.next=8;break}throw new Terrasoft.UnsupportedTypeException;case 8:if(Terrasoft.checkContext(r)){t.next=10;break}return t.abrupt("return");case 10:return t.next=12,s.bind(r);case 12:t.next=4;break;case 14:t.next=19;break;case 16:t.prev=16,t.t0=t.catch(2),i.e(t.t0);case 19:return t.prev=19,i.f(),t.finish(19);case 22:case"end":return t.stop()}}),t,null,[[2,16,19,22]])}function a(e){var t=arguments,r=t.length-1,i=n(arguments),a=-1,s=function e(){a++;var n=t[a];if(a<r&&!Ext.isFunction(n))throw new Terrasoft.UnsupportedTypeException;if(a<t.length){var s=Array.prototype.slice.call(arguments);if(s.unshift(e),!Terrasoft.checkContext(i))return;n.apply(i,s)}};s()}if(!r(arguments))if(Ext.isIE||Ext.isSafari)a.apply(void 0,arguments);else{var s=i(arguments);!function e(){var t=s.next();t.done||t.value.apply(t,[e].concat(Array.prototype.slice.call(arguments)))}()}},Terrasoft.checkContext=function(e){return!Terrasoft.Features.getIsEnabled("CheckContext")||(!e||!0!==e.destroyed||(Terrasoft.isDebug&&console.warn(Terrasoft.Resources.Core.ContextDestroyed),!1))},Terrasoft.utils.common.chain=Terrasoft.chain,Terrasoft.utils.common.chainForArray=function(e,t,r,n){if(Ext.isEmpty(e)||!Ext.isFunction(t))throw new Terrasoft.UnsupportedTypeException;var i=this,a=[];Terrasoft.each(e,(function(e,r,n){var s=t.call(i,e,r,n);Ext.isArray(s)?a.push.apply(a,s):Ext.isEmpty(s)||a.push(s)}),this),(Ext.isFunction(r)||Ext.isObject(r)&&Ext.isEmpty(n))&&a.push(r),Ext.isObject(n)&&a.push(n),Terrasoft.utils.common.chain.apply(i,a)},Terrasoft.chainForArray=Terrasoft.utils.common.chainForArray,Terrasoft.utils.common.collectionDifference=function(e,t,r,n){var i=e.clone();return e.each((function(e){t.each((function(t){r.call(n||this,e,t)&&i.remove(e)}))})),i},Terrasoft.collectionDifference=Terrasoft.utils.common.collectionDifference,Terrasoft.utils.common.combinePath=function(){return Array.prototype.slice.call(arguments).join("/")},Terrasoft.combinePath=Terrasoft.utils.common.combinePath,Terrasoft.convertStringToBlobArray=function(e){for(var t=[],r=0,n=0;n<e.length;n++){var i=e.charCodeAt(n);i<128?t[r++]=String.fromCharCode(i):i<2048?(t[r++]=String.fromCharCode(i>>6|192),t[r++]=String.fromCharCode(63&i|128)):(t[r++]=String.fromCharCode(i>>12|224),t[r++]=String.fromCharCode(i>>6&63|128),t[r++]=String.fromCharCode(63&i|128))}return t},Terrasoft.utils.common.debounce=function(e,t,r){return _.debounce(e,t,r)},Terrasoft.debounce=Terrasoft.utils.common.debounce,Terrasoft.utils.common.defer=function(e,t){return _.defer((function(){e.call(t||this)}))},Terrasoft.defer=Terrasoft.utils.common.defer,Terrasoft.utils.common.cancelDeferred=function(e){clearTimeout(e)},Terrasoft.cancelDeferred=Terrasoft.utils.common.cancelDeferred,Terrasoft.delay=function(e,t,r,n){Ext.callback(e,t,n,r||1)},Terrasoft.utils.common.delay=Terrasoft.delay,Terrasoft.emptyFn=Ext.emptyFn,Terrasoft.generateFilterKey=function(){return Terrasoft.generateGUID()},Terrasoft.utils.common.getItemByConfig=function(e){var t=e,r=e.className;return r&&(delete e.className,t=Ext.create(r,e)),t},Terrasoft.getItemByConfig=Terrasoft.utils.common.getItemByConfig,Terrasoft.utils.common.getMouseButton=function(e){var t=e.browserEvent||e,r=t.which;if(!r&&t.button){var n=t.button;1&n?r=1:4&n?r=2:2&n&&(r=3)}return{1:Terrasoft.MouseButton.LEFT,2:Terrasoft.MouseButton.MIDDLE,3:Terrasoft.MouseButton.RIGHT}[r]},Terrasoft.getMouseButton=Terrasoft.utils.common.getMouseButton,Terrasoft.utils.inputBox=function(e,t,r,n,i,a){var s=Terrasoft.MessageBox,o={caption:e||"",handler:t,buttons:r,scope:n,controlConfig:i,style:Terrasoft.MessageBoxStyles.BLUE};Ext.apply(o,a),s.prepare(o),s.show()},Terrasoft.showInputBox=Terrasoft.utils.inputBox,Terrasoft.utils.common.insertSchemaItemsAfter=function(e,t,r){var n=Terrasoft.findItem(e,{name:t});return Ext.isEmpty(n)?null:(n.index+=1,Ext.Array.insert(n.parent,n.index,r))},Terrasoft.insertSchemaItemsAfter=Terrasoft.utils.common.insertSchemaItemsAfter,Terrasoft.utils.common.isNull=function(e){return _.isNull(e)},Terrasoft.isNull=Terrasoft.utils.common.isNull,Terrasoft.utils.common.isUndefined=function(e){return _.isUndefined(e)},Terrasoft.utils.common.obsoleteChain=function(e,t){if(t&&!(t instanceof Array))throw new Terrasoft.UnsupportedTypeException({message:Terrasoft.Resources.chain.StepsArgumentUnsupportedTypeMessage});var r=-1;!function n(){++r!==t.length&&(e.next=n,(0,t[r])(e))}()},Terrasoft.require=function(e,t,r,n){var i="string"==typeof e?[e]:e,a=null==i?void 0:i.find((function(e){return(null==e?void 0:e.indexOf("data:"))>=0}));if(a)throw new Terrasoft.UnsupportedTypeException({message:"Dependency '".concat(a,"' is no supported.")});require(e,(function(){t.apply(r,arguments)}),n)},Terrasoft.utils.common.require=Terrasoft.require,Terrasoft.utils.common.round=function(e,t){return Ext.util.Format.round(e,t)},Terrasoft.utils.saveUserProfile=function(e,t,r,n,i){require.defined("profile")&&require("profile").addKey(e);var a=Terrasoft.encode({key:e,data:t?Terrasoft.encode(t):"",isDef:r});requirejs.undef("profile!"+e),Terrasoft.ServiceProvider.executeRequest("UserProfile",a,n,i)},Terrasoft.saveUserProfile=Terrasoft.utils.saveUserProfile,Terrasoft.getButtonConfig=function(e,t,r){return Terrasoft.checkArguments(arguments,["returnCode","caption"]),{className:"Terrasoft.Button",caption:t,markerValue:r||t,returnCode:e}},Terrasoft.getBlueButtonConfig=function(e,t,r){var n=Terrasoft.getButtonConfig(e,t,r);return n.style=Terrasoft.controls.ButtonEnums.style.BLUE,n},Terrasoft.utils.showConfirmation=function(e,t,r,n,i){var a=Terrasoft.MessageBox,s={caption:e||"",handler:t,buttons:r,scope:n,style:Terrasoft.MessageBoxStyles.BLUE};Ext.apply(s,i),a.prepare(s),a.show()},Terrasoft.showConfirmation=Terrasoft.utils.showConfirmation,Terrasoft.showInformation=function(e,t,r,n){var i=Terrasoft.MessageBox,a={buttons:["ok"],style:Terrasoft.MessageBoxStyles.BLUE,defaultButton:0},s={caption:e||"",handler:t,scope:r};Ext.apply(s,n,a),i.prepare(s),i.show()},Terrasoft.utils.showInformation=Terrasoft.showInformation,Terrasoft.showErrorMessage=function(e,t,r){Terrasoft.showInformation(e,t,r,{style:Terrasoft.MessageBoxStyles.RED})},Terrasoft.showMessage=function(e){Ext.isString(e)&&(e={caption:e});var t=Terrasoft.MessageBox;t.applyDefaultConfig(),Ext.apply(t,e),t.reConfigurateButtonItems(),t.setVisible(!0)},Terrasoft.utils.showMessage=Terrasoft.showMessage,Terrasoft.utils.common.throttle=function(e,t,r){return _.throttle(e,t,r)},Terrasoft.throttle=Terrasoft.utils.common.throttle,Terrasoft.utils.common.getIsRtlMode=function(){var e=Terrasoft.Resources,t=e&&e.CultureSettings,r=t&&t.isRightToLeft;return Boolean(r)},Terrasoft.getIsRtlMode=Terrasoft.utils.common.getIsRtlMode,Terrasoft.utils.common.getEntityColumnValueName=function(e){return Ext.isEmpty(e)?"":e.isLookup&&e.referenceSchema?Ext.String.format("{0}{1}",e.name,e.referenceSchema.primaryColumnName):e.name},Terrasoft.getEntityColumnValueName=Terrasoft.utils.common.getEntityColumnValueName,Terrasoft.utils.common.getIsPredictableColumn=function(e,t){if(Ext.isEmpty(e))return!1;var r=Terrasoft.getEntityColumnValueName(t),n=Terrasoft.configuration&&Terrasoft.configuration.PredictableEntities&&Terrasoft.configuration.PredictableEntities[e],i=n&&n.Models||{},a=Ext.Object.getValues(i),s=Ext.Array.findBy(a,(function(e){return e.output&&e.output.name===r}));return!Ext.isEmpty(s)},Terrasoft.getIsPredictableColumn=Terrasoft.utils.common.getIsPredictableColumn,Terrasoft.utils.common.getPredictableColumns=function(e,t){var r=Ext.Object.getValues(t);return Ext.Array.filter(r,(function(t){return Terrasoft.getIsPredictableColumn(e,t)}))},Terrasoft.getPredictableColumns=Terrasoft.utils.common.getPredictableColumns,Terrasoft.isEmpty=function(e,t){var r=Ext.isEmpty(e)||Terrasoft.isEmptyGUID(e);return!r&&t&&e instanceof Terrasoft.Collection&&(r=e.isEmpty()),r},Terrasoft.utils.common.isEmpty=Terrasoft.isEmpty,Terrasoft.isNotEmpty=function(e,t){return!Terrasoft.isEmpty(e,t)},Terrasoft.utils.common.isNotEmpty=Terrasoft.isNotEmpty,Terrasoft.safeDestroy=function(){var e=Array.prototype.slice.call(arguments);e.forEach((function(e){e&&!e.destroyed&&Ext.isFunction(e.destroy)&&e.destroy()}))},Terrasoft.utils.common.safeDestroy=Terrasoft.safeDestroy,Terrasoft.clearProperty=function(e,t){Terrasoft.safeDestroy(e[t]),e[t]=null},Terrasoft.utils.common.clearProperty=Terrasoft.clearProperty,Terrasoft.checkArguments=function(e,t,r){_.isArray(t)||(t=[t]);for(var n=t.length,i=0;i<n;i++){var a=e[i];if(Ext.isEmpty(a,r))throw new Terrasoft.ArgumentNullOrEmptyException({argumentName:t[i]})}},Terrasoft.utils.common.checkArguments=Terrasoft.checkArguments,Terrasoft.checkArgumentsDefined=function(e,t){_.isArray(t)||(t=[t]);for(var r=t.length,n=0;n<r;n++){var i=e[n];if(!Ext.isDefined(i))throw new Terrasoft.ArgumentNullOrEmptyException({argumentName:t[n]})}},Terrasoft.utils.common.checkArgumentsDefined=Terrasoft.checkArgumentsDefined,Terrasoft.utils.common.areArraysEqual=function(e,t){var r=Ext.String.format(Terrasoft.Resources.ObsoleteMessages.ObsoleteMethodMessage,"Terrasoft.utils.common.areArraysEqual","Terrasoft.utils.array.areArraysEqual");return console.log(r),Terrasoft.utils.array.areArraysEqual(e,t)},Terrasoft.utils.common.compact=function(e){var t=Ext.String.format(Terrasoft.Resources.ObsoleteMessages.ObsoleteMethodMessage,"Terrasoft.utils.common.compact","Terrasoft.utils.array.compact");return console.log(t),Terrasoft.utils.array.compact(e)},Terrasoft.utils.common.contains=function(e,t){var r=Ext.String.format(Terrasoft.Resources.ObsoleteMessages.ObsoleteMethodMessage,"Terrasoft.utils.common.contains","Terrasoft.utils.array.contains");return console.log(r),Terrasoft.utils.array.contains(e,t)},Terrasoft.utils.common.difference=function(e,t){var r=Ext.String.format(Terrasoft.Resources.ObsoleteMessages.ObsoleteMethodMessage,"Terrasoft.utils.common.difference","Terrasoft.utils.array.difference");return console.log(r),Terrasoft.utils.array.difference(e,t)},Terrasoft.utils.common.each=function(e,t,r){var n=Ext.String.format(Terrasoft.Resources.ObsoleteMessages.ObsoleteMethodMessage,"Terrasoft.utils.common.each","Terrasoft.utils.array.each");return console.log(n),Terrasoft.utils.array.each(e,t,r)},Terrasoft.utils.common.findItem=function(e,t){var r=Ext.String.format(Terrasoft.Resources.ObsoleteMessages.ObsoleteMethodMessage,"Terrasoft.utils.common.findItem","Terrasoft.utils.array.findItem");return console.log(r),Terrasoft.utils.array.findItem(e,t)},Terrasoft.utils.common.findWhere=function(e,t){var r=Ext.String.format(Terrasoft.Resources.ObsoleteMessages.ObsoleteMethodMessage,"Terrasoft.utils.common.findWhere","Terrasoft.utils.array.findWhere");return console.log(r),Terrasoft.utils.array.findWhere(e,t)},Terrasoft.utils.common.rotateArray=function(e,t){var r=Ext.String.format(Terrasoft.Resources.ObsoleteMessages.ObsoleteMethodMessage,"Terrasoft.utils.common.rotateArray","Terrasoft.utils.array.rotateArray");return console.log(r),Terrasoft.utils.array.rotateArray(e,t)},Terrasoft.utils.common.some=function(e,t,r){var n=Ext.String.format(Terrasoft.Resources.ObsoleteMessages.ObsoleteMethodMessage,"Terrasoft.utils.common.some","Terrasoft.utils.array.some instead");return console.log(n),Terrasoft.utils.array.some(e,t,r)},Terrasoft.utils.common.sortedIndex=function(e,t,r,n){var i=Ext.String.format(Terrasoft.Resources.ObsoleteMessages.ObsoleteMethodMessage,"Terrasoft.utils.common.sortedIndex","Terrasoft.utils.array.sortedIndex instead");return console.log(i),Terrasoft.utils.array.sortedIndex(e,t,r,n)},Terrasoft.utils.common.where=function(e,t){var r=Ext.String.format(Terrasoft.Resources.ObsoleteMessages.ObsoleteMethodMessage,"Terrasoft.utils.common.where","Terrasoft.utils.array.where");return console.log(r),Terrasoft.utils.array.where(e,t)},Terrasoft.utils.common.without=function(e,t){var r=Ext.String.format(Terrasoft.Resources.ObsoleteMessages.ObsoleteMethodMessage,"Terrasoft.utils.common.without","Terrasoft.utils.array.without");return console.log(r),Terrasoft.utils.array.without(e,t)},Terrasoft.utils.common.convertToClientDataValueType=function(e){var t=Ext.String.format(Terrasoft.Resources.ObsoleteMessages.ObsoleteMethodMessage,"Terrasoft.utils.common.convertToClientDataValueType","Terrasoft.utils.dataValueType.convertToClientDataValueType");return console.log(t),Terrasoft.utils.dataValueType.convertToClientDataValueType(e)},Terrasoft.utils.common.convertToServerDataValueType=function(e){var t=Ext.String.format(Terrasoft.Resources.ObsoleteMessages.ObsoleteMethodMessage,"Terrasoft.utils.common.convertToServerDataValueType","Terrasoft.utils.dataValueType.convertToServerDataValueType");return console.log(t),Terrasoft.utils.dataValueType.convertToServerDataValueType(e)},Terrasoft.utils.common.getImageNameByDataValueType=function(e){var t=Ext.String.format(Terrasoft.Resources.ObsoleteMessages.ObsoleteMethodMessage,"Terrasoft.utils.common.getImageNameByDataValueType","Terrasoft.utils.dataValueType.getImageNameByDataValueType");return console.log(t),Terrasoft.utils.dataValueType.getImageNameByDataValueType(e)},Terrasoft.utils.common.instanceOfClass=function(e,t){var r=Ext.String.format(Terrasoft.Resources.ObsoleteMessages.ObsoleteMethodMessage,"Terrasoft.utils.common.instanceOfClass","Terrasoft.utils.dataValueType.isInstanceOfClass");return console.log(r),Terrasoft.utils.dataValueType.isInstanceOfClass(e,t)},Terrasoft.instanceOfClass=Terrasoft.isInstanceOfClass,Terrasoft.utils.common.isDateDataValueType=function(e){var t=Ext.String.format(Terrasoft.Resources.ObsoleteMessages.ObsoleteMethodMessage,"Terrasoft.utils.common.isDateDataValueType","Terrasoft.utils.dataValueType.isDateDataValueType");return console.log(t),Terrasoft.utils.dataValueType.isDateDataValueType(e)},Terrasoft.utils.common.isLookupDataValueType=function(e){var t=Ext.String.format(Terrasoft.Resources.ObsoleteMessages.ObsoleteMethodMessage,"Terrasoft.utils.common.isLookupDataValueType","Terrasoft.utils.dataValueType.isLookupDataValueType");return console.log(t),Terrasoft.utils.dataValueType.isLookupDataValueType(e)},Terrasoft.utils.common.isNumberDataValueType=function(e){var t=Ext.String.format(Terrasoft.Resources.ObsoleteMessages.ObsoleteMethodMessage,"Terrasoft.utils.common.isNumberDataValueType","Terrasoft.utils.dataValueType.isNumberDataValueType");return console.log(t),Terrasoft.utils.dataValueType.isNumberDataValueType(e)},Terrasoft.utils.common.validateObjectClass=function(e,t){var r=Ext.String.format(Terrasoft.Resources.ObsoleteMessages.ObsoleteMethodMessage,"Terrasoft.utils.common.validateObjectClass","Terrasoft.utils.dataValueType.validateObjectClass");return console.log(r),Terrasoft.utils.dataValueType.validateObjectClass(e,t)},Terrasoft.utils.common.addDays=function(e,t){var r=Ext.String.format(Terrasoft.Resources.ObsoleteMessages.ObsoleteMethodMessage,"Terrasoft.utils.common.addDays","Terrasoft.utils.date.addDays");return console.log(r),Terrasoft.utils.date.addDays(e,t)},Terrasoft.utils.common.addMinutes=function(e,t){var r=Ext.String.format(Terrasoft.Resources.ObsoleteMessages.ObsoleteMethodMessage,"Terrasoft.utils.common.addMinutes","Terrasoft.utils.date.addMinutes");return console.log(r),Terrasoft.utils.date.addMinutes(e,t)},Terrasoft.utils.common.clearSeconds=function(e){var t=Ext.String.format(Terrasoft.Resources.ObsoleteMessages.ObsoleteMethodMessage,"Terrasoft.utils.common.clearSeconds","Terrasoft.utils.date.clearSeconds");return console.log(t),Terrasoft.utils.date.clearSeconds(e)},Terrasoft.utils.common.clearTime=function(e){var t=Ext.String.format(Terrasoft.Resources.ObsoleteMessages.ObsoleteMethodMessage,"Terrasoft.utils.common.clearTime","Terrasoft.utils.date.clearTime");return console.log(t),Terrasoft.utils.date.clearTime(e)},Terrasoft.utils.common.endOfDay=function(e){var t=Ext.String.format(Terrasoft.Resources.ObsoleteMessages.ObsoleteMethodMessage,"Terrasoft.utils.common.endOfDay","Terrasoft.utils.date.endOfDay");return console.log(t),Terrasoft.utils.date.endOfDay(e)},Terrasoft.utils.common.endOfMonth=function(e){var t=Ext.String.format(Terrasoft.Resources.ObsoleteMessages.ObsoleteMethodMessage,"Terrasoft.utils.common.endOfMonth","Terrasoft.utils.date.endOfMonth");return console.log(t),Terrasoft.utils.date.endOfMonth(e)},Terrasoft.utils.common.endOfQuarter=function(e){var t=Ext.String.format(Terrasoft.Resources.ObsoleteMessages.ObsoleteMethodMessage,"Terrasoft.utils.common.endOfQuarter","Terrasoft.utils.date.endOfQuarter");return console.log(t),Terrasoft.utils.date.endOfQuarter(e)},Terrasoft.utils.common.endOfWeek=function(e){var t=Ext.String.format(Terrasoft.Resources.ObsoleteMessages.ObsoleteMethodMessage,"Terrasoft.utils.common.endOfWeek","Terrasoft.utils.date.endOfWeek");return console.log(t),Terrasoft.utils.date.endOfWeek(e)},Terrasoft.utils.common.endOfYear=function(e){var t=Ext.String.format(Terrasoft.Resources.ObsoleteMessages.ObsoleteMethodMessage,"Terrasoft.utils.common.endOfYear","Terrasoft.utils.date.endOfYear");return console.log(t),Terrasoft.utils.date.endOfYear(e)},Terrasoft.utils.common.getMinutesFromMidnight=function(e){var t=Ext.String.format(Terrasoft.Resources.ObsoleteMessages.ObsoleteMethodMessage,"Terrasoft.utils.common.getMinutesFromMidnight","Terrasoft.utils.date.getMinutesFromMidnight");return console.log(t),Terrasoft.utils.date.getMinutesFromMidnight(e)},Terrasoft.utils.common.isDateEquals=function(e,t){var r=Ext.String.format(Terrasoft.Resources.ObsoleteMessages.ObsoleteMethodMessage,"Terrasoft.utils.common.isDateEquals","Terrasoft.utils.date.areDatesEqual");return console.log(r),Terrasoft.utils.date.areDatesEqual(e,t)},Terrasoft.isDateEquals=function(e,t){var r=Ext.String.format(Terrasoft.Resources.ObsoleteMessages.ObsoleteMethodMessage,"Terrasoft.isDateEquals","Terrasoft.areDatesEqual");return console.log(r),Terrasoft.areDatesEqual(e,t)},Terrasoft.utils.common.isMidnight=function(e){var t=Ext.String.format(Terrasoft.Resources.ObsoleteMessages.ObsoleteMethodMessage,"Terrasoft.utils.common.isMidnight","Terrasoft.utils.date.isMidnight");return console.log(t),Terrasoft.utils.date.isMidnight(e)},Terrasoft.utils.common.parseDate=function(e){var t=Ext.String.format(Terrasoft.Resources.ObsoleteMessages.ObsoleteMethodMessage,"Terrasoft.utils.common.parseDate","Terrasoft.utils.date.parseDate");return console.log(t),Terrasoft.utils.date.parseDate(e)},Terrasoft.utils.common.startOfDay=function(e){var t=Ext.String.format(Terrasoft.Resources.ObsoleteMessages.ObsoleteMethodMessage,"Terrasoft.utils.common.startOfDay","Terrasoft.utils.date.startOfDay");return console.log(t),Terrasoft.utils.date.startOfDay(e)},Terrasoft.utils.common.startOfMonth=function(e){var t=Ext.String.format(Terrasoft.Resources.ObsoleteMessages.ObsoleteMethodMessage,"Terrasoft.utils.common.startOfMonth","Terrasoft.utils.date.startOfMonth");return console.log(t),Terrasoft.utils.date.startOfMonth(e)},Terrasoft.utils.common.startOfQuarter=function(e){var t=Ext.String.format(Terrasoft.Resources.ObsoleteMessages.ObsoleteMethodMessage,"Terrasoft.utils.common.startOfQuarter","Terrasoft.utils.date.startOfQuarter");return console.log(t),Terrasoft.utils.date.startOfQuarter(e)},Terrasoft.utils.common.startOfWeek=function(e){var t=Ext.String.format(Terrasoft.Resources.ObsoleteMessages.ObsoleteMethodMessage,"Terrasoft.utils.common.startOfWeek","Terrasoft.utils.date.startOfWeek");return console.log(t),Terrasoft.utils.date.startOfWeek(e)},Terrasoft.utils.common.startOfYear=function(e){var t=Ext.String.format(Terrasoft.Resources.ObsoleteMessages.ObsoleteMethodMessage,"Terrasoft.utils.common.startOfYear","Terrasoft.utils.date.startOfYear");return console.log(t),Terrasoft.utils.date.startOfYear(e)},Terrasoft.utils.generateGUID=function(){var e=Ext.String.format(Terrasoft.Resources.ObsoleteMessages.ObsoleteMethodMessage,"Terrasoft.utils.generateGUID","Terrasoft.utils.guid.generateGUID");return console.log(e),Terrasoft.utils.guid.generateGUID()},Terrasoft.utils.isEmptyGUID=function(e){var t=Ext.String.format(Terrasoft.Resources.ObsoleteMessages.ObsoleteMethodMessage,"Terrasoft.utils.isEmptyGUID","Terrasoft.utils.guid.isEmptyGUID");return console.log(t),Terrasoft.utils.guid.isEmptyGUID(e)},Terrasoft.utils.isGUID=function(e){var t=Ext.String.format(Terrasoft.Resources.ObsoleteMessages.ObsoleteMethodMessage,"Terrasoft.utils.isGUID","Terrasoft.utils.guid.isGUID");return console.log(t),Terrasoft.utils.guid.isGUID(e)},Terrasoft.utils.common.deepClone=function(e){var t=Ext.String.format(Terrasoft.Resources.ObsoleteMessages.ObsoleteMethodMessage,"Terrasoft.utils.common.deepClone","Terrasoft.utils.object.deepClone");return console.log(t),Terrasoft.utils.object.deepClone(e)},Terrasoft.utils.common.deleteEmptyItems=function(e){var t=Ext.String.format(Terrasoft.Resources.ObsoleteMessages.ObsoleteMethodMessage,"Terrasoft.utils.common.deleteEmptyItems","Terrasoft.utils.object.deleteEmptyItems");return console.log(t),Terrasoft.utils.object.deleteEmptyItems(e)},Terrasoft.utils.common.getPropertyValuesArray=function(e,t){var r=Ext.String.format(Terrasoft.Resources.ObsoleteMessages.ObsoleteMethodMessage,"Terrasoft.utils.common.getPropertyValuesArray","Terrasoft.utils.object.getPropertyValuesArray");return console.log(r),Terrasoft.utils.object.getPropertyValuesArray(e,t)},Terrasoft.utils.common.invert=function(e){var t=Ext.String.format(Terrasoft.Resources.ObsoleteMessages.ObsoleteMethodMessage,"Terrasoft.utils.common.invert","Terrasoft.utils.object.invert");return console.log(t),Terrasoft.utils.object.invert(e)},Terrasoft.utils.common.isEmptyObject=function(e){var t=Ext.String.format(Terrasoft.Resources.ObsoleteMessages.ObsoleteMethodMessage,"Terrasoft.utils.common.isEmptyObject","Terrasoft.utils.object.isEmptyObject");return console.log(t),Terrasoft.utils.object.isEmptyObject(e)},Terrasoft.utils.common.keys=function(e){var t=Ext.String.format(Terrasoft.Resources.ObsoleteMessages.ObsoleteMethodMessage,"Terrasoft.utils.common.keys","Terrasoft.utils.object.keys");return console.log(t),Terrasoft.utils.object.keys(e)},Terrasoft.utils.common.mapObjectToCollection=function(e){var t=Ext.String.format(Terrasoft.Resources.ObsoleteMessages.ObsoleteMethodMessage,"Terrasoft.utils.common.mapObjectToCollection","Terrasoft.utils.object.mapObjectToCollection");return console.log(t),Terrasoft.utils.object.mapObjectToCollection(e)},Terrasoft.utils.common.serialzieObject=function(e){var t=Ext.String.format(Terrasoft.Resources.ObsoleteMessages.ObsoleteMethodMessage,"Terrasoft.utils.common.serialzieObject","Terrasoft.utils.object.serializeObject");return console.log(t),Terrasoft.utils.object.serializeObject(e)},Terrasoft.utils.common.decodeHtml=function(e){var t=Ext.String.format(Terrasoft.Resources.ObsoleteMessages.ObsoleteMethodMessage,"Terrasoft.utils.common.decodeHtml","Terrasoft.utils.object.serialzieObject");return console.log(t),Terrasoft.utils.html.decodeHtml(e)},Terrasoft.utils.common.encodeHtml=function(e){var t=Ext.String.format(Terrasoft.Resources.ObsoleteMessages.ObsoleteMethodMessage,"Terrasoft.utils.common.encodeHtml","Terrasoft.utils.html.encodeHtml");return console.log(t),Terrasoft.utils.html.encodeHtml(e)},Terrasoft.utils.getTypedStringValue=function(e,t){var r=Ext.String.format(Terrasoft.Resources.ObsoleteMessages.ObsoleteMethodMessage,"Terrasoft.utils.getTypedStringValue","Terrasoft.utils.string.getTypedStringValue");return console.log(r),Terrasoft.utils.string.getTypedStringValue(e,t)},Terrasoft.utils.common.getUniformString=function(e,t){var r=Ext.String.format(Terrasoft.Resources.ObsoleteMessages.ObsoleteMethodMessage,"Terrasoft.utils.common.getUniformString","Terrasoft.utils.string.getUniformString");return console.log(r),Terrasoft.utils.string.getUniformString(e,t)},Terrasoft.utils.isUrl=function(e){var t=Ext.String.format(Terrasoft.Resources.ObsoleteMessages.ObsoleteMethodMessage,"Terrasoft.utils.isUrl","Terrasoft.utils.uri.isUrl");return console.log(t),Terrasoft.utils.uri.isUrl(e)},Terrasoft.utils.pad=function(e,t,r){var n=Ext.String.format(Terrasoft.Resources.ObsoleteMessages.ObsoleteMethodMessage,"Terrasoft.utils.pad","Terrasoft.utils.string.pad");return console.log(n),Terrasoft.utils.string.pad(e,t,r)},Terrasoft.utils.common.reverseStr=function(e){var t=Ext.String.format(Terrasoft.Resources.ObsoleteMessages.ObsoleteMethodMessage,"Terrasoft.utils.common.reverseStr","Terrasoft.utils.string.reverseStr");return console.log(t),Terrasoft.utils.string.reverseStr(e)},Terrasoft.utils.common.toLowerCamelCase=function(e){var t=Ext.String.format(Terrasoft.Resources.ObsoleteMessages.ObsoleteMethodMessage,"Terrasoft.utils.common.toLowerCamelCase","Terrasoft.utils.string.toLowerCamelCase");return console.log(t),Terrasoft.utils.string.toLowerCamelCase(e)},Terrasoft.isCurrentUserSsp=function(){return Terrasoft.CurrentUser.userType===Terrasoft.UserType.SSP},Terrasoft.utils.common.isCurrentUserSsp=Terrasoft.isCurrentUserSsp,Terrasoft.isCurrentUserDataInputRestricted=function(){return Terrasoft.CurrentUser.dataAccessType===Terrasoft.UserDataAccessType.DATAINPUTRESTRICTED},Terrasoft.utils.common.isCurrentUserDataInputRestricted=Terrasoft.isCurrentUserDataInputRestricted,Ext.define("Terrasoft.mixins.CustomEventDomMixin",{alternateClassName:"Terrasoft.CustomEventDomMixin",statics:{appId:"",customEventName:"TSCustomEventChannel",eventObservers:{},customEventSubscriber:null,instanceIds:[]},_instanceId:"",constructor:function(){this._instanceId=Terrasoft.generateGUID("N"),Terrasoft.CustomEventDomMixin.instanceIds.push(this._instanceId)},init:function(e){if(this._instanceId=this._instanceId||Terrasoft.generateGUID("N"),Terrasoft.appendIf(Terrasoft.CustomEventDomMixin.instanceIds,this._instanceId),""===Terrasoft.CustomEventDomMixin.appId){Terrasoft.CustomEventDomMixin.appId=e||Terrasoft.generateGUID("N");var t=Terrasoft.RX,r=t.fromEvent,n=t.operators,i=n.filter,a=n.map,s=Terrasoft.CustomEventDomMixin.eventObservers,o=r(document,Terrasoft.CustomEventDomMixin.customEventName);Terrasoft.CustomEventDomMixin.customEventSubscriber=o.pipe(i((function(e){return e.detail.sender!==Terrasoft.CustomEventDomMixin.appId})),a((function(e){return e.detail}))).subscribe((function(e){var t=e.eventName;s[t]=s[t]||{},Terrasoft.each(Terrasoft.CustomEventDomMixin.instanceIds,(function(e){s[t][e]||(s[t][e]=new Terrasoft.RX.ReplaySubject(1))})),Terrasoft.each(s[t],(function(t){t.next(e.payload)}))}))}},publish:function(e,t){var r=new CustomEvent(Terrasoft.CustomEventDomMixin.customEventName,{detail:{eventName:e,sender:Terrasoft.CustomEventDomMixin.appId,payload:t}});document.dispatchEvent(r)},subscribe:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r=Terrasoft.CustomEventDomMixin.eventObservers;r[e]=r[e]||{};var n=r[e];return n[this._instanceId]||(n[this._instanceId]=t?new Terrasoft.RX.ReplaySubject(1):new Terrasoft.RX.Subject),n[this._instanceId].asObservable()},subscribeHandler:function(e,t,r){var n=arguments.length>3&&void 0!==arguments[3]&&arguments[3];this.subscribe(e,n).subscribe((function(){Terrasoft.utils.executionZone.safeExecute(r,t.bind.apply(t,[r].concat(Array.prototype.slice.call(arguments))))}))},subscribeOnSandbox:function(e,t){var r=this,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:function(e){return e},i=arguments.length>3?arguments[3]:void 0,a=Terrasoft.RX.operators.map;return this.subscribe(t).pipe(a((function(r){return e.publish(t,r,[e.id])})),a((function(e){return n.apply(i||r,[e])})),a((function(e){return r.publish(t,e)||e})))},publishOnSandbox:function(e,t){var r=this,n=Terrasoft.CustomEventDomMixin.prototype,i=new Terrasoft.RX.Subject,a=Terrasoft.RX.operators.tap;return e.publish=new Proxy(e.publish,{apply:function(e,r,n){var a=e.apply(r,n),s=n[0];return t===s&&i.next(n),a}}),i.pipe(a((function(e){n.publish.apply(r,_toConsumableArray(e))})))},destroy:function(){var e=this;Terrasoft.each(Terrasoft.CustomEventDomMixin.eventObservers,(function(t){var r=t[e._instanceId]||{};Terrasoft.each(r.observers,(function(e){e&&e.unsubscribe()}))})),Terrasoft.each(Terrasoft.CustomEventDomMixin.eventObservers,(function(t){delete t[e._instanceId]}));var t=Terrasoft.CustomEventDomMixin.instanceIds.indexOf(this._instanceId);t>-1&&Terrasoft.CustomEventDomMixin.instanceIds.splice(t,1)}}),Ext.util.CSS.createStyleSheet=function(e,t){var r,n=document,i=n.getElementsByTagName("head")[0],a=n.createElement("style");a.setAttribute("type","text/css"),t&&a.setAttribute("id",t);try{a.appendChild(n.createTextNode(e))}catch(t){a.cssText=e}return i.appendChild(a),r=a.styleSheet?a.styleSheet:a.sheet||n.styleSheets[n.styleSheets.length-1],this.cacheStyleSheet(r),r},Ext.ns("Terrasoft.utils.dom"),Terrasoft.utils.dom.getSelectedTextLength=function(e){var t="";if(null!=e.selectionStart&&null!=e.selectionEnd){var r=e.selectionStart,n=e.selectionEnd;t=e.value.substring(r,n)}else document.selection&&(t=document.selection.createRange().text);return t.length},Terrasoft.utils.dom.setAttributeToBody=function(e,t){var r=Ext.getBody();if(r){var n={};n[e]=t,r.set(n)}},Terrasoft.utils.dom.hasClassName=function(e,t){return-1!==e.className.indexOf(t)},Terrasoft.utils.dom.addClassName=function(e,t){var r=e.className.split(/\s/);-1===r.indexOf(t)&&(r.push(t),e.className=r.join(" "))},Terrasoft.utils.dom.removeClassName=function(e,t){var r=e.className.split(/\s/),n=r.indexOf(t);-1!==n&&(r.splice(n,1),e.className=r.join(" "))},Terrasoft.utils.dom.getCaretPosition=function(e){var t=null;if(document.selection){var r=document.selection.createRange();r.moveStart("textedit",-1),t=r.text.length}else t=e.selectionStart;return t},Terrasoft.utils.dom.setCaretPosition=function(e,t){if(e.setSelectionRange)e.focus(),e.setSelectionRange(t,t);else if(e.createTextRange){var r=e.createTextRange();r.collapse(!0),r.moveEnd("character",t),r.moveStart("character",t),r.select()}},Terrasoft.utils.dom.getVisibleDomItems=function(e,t){for(var r=[],n=t||[],i=0,a=e.length;i<a;i++){var s=e[i];-1===n.indexOf(s)&&(s.style&&"none"===s.style.display||r.push(s))}return r},Terrasoft.getVisibleDomItems=Terrasoft.utils.dom.getVisibleDomItems,Terrasoft.utils.dom.convertEmToPx=function(e){var t=/([+-]?\d*([.,]\d*)?)(px|em|%|en|ex|pt|in|cm|mm|pc)?$/i,r=_typeof(e),n=e;if("string"===r){var i=t.exec(e);if(!i)throw new Terrasoft.UnsupportedTypeException;var a=i[1];if(a=a.replace(",","."),n=parseFloat(a),isNaN(n))throw new Terrasoft.UnsupportedTypeException}else if("number"!==r)throw new Terrasoft.UnsupportedTypeException;var s=Ext.getBody().getStyle("fontSize"),o=t.exec(s);return parseFloat(o[1])*n},Terrasoft.convertEmToPx=Terrasoft.utils.dom.convertEmToPx,Terrasoft.utils.dom.getLineHeight=function(e){if(!e||!e.dom)throw new Terrasoft.ArgumentNullOrEmptyException;var t=e.dom,r=t.cloneNode();r.innerHTML="<br>",t.appendChild(r);var n=r.offsetHeight;r.innerHTML="<br><br>";var i=r.offsetHeight;return t.removeChild(r),i-n},Terrasoft.getLineHeight=Terrasoft.utils.dom.getLineHeight,Terrasoft.utils.dom.convertElementToCanvas=function(e,t,r,n){var i=document.getElementById(e);i?require(["html2canvas"],(function(e){e(i,t).then((function(e){r.call(n,e)}))})):r.call(n)},Terrasoft.convertElementToCanvas=Terrasoft.utils.dom.convertElementToCanvas,Terrasoft.utils.dom.getTopScroll=function(){return Ext.getBody().getScrollTop()},Terrasoft.getTopScroll=Terrasoft.utils.dom.getTopScroll,Terrasoft.utils.dom.setTopScroll=function(e){if(!Ext.isEmpty(e)){var t=Ext.getBody();t.setScrollTop(e),0===t.dom.scrollTop&&(document.documentElement.scrollTop=e)}},Terrasoft.setTopScroll=Terrasoft.utils.dom.setTopScroll,Terrasoft.utils.dom.scrollToEl=function(e,t,r){if(!Ext.isEmpty(e)){t=t||e.parent();var n=r?t:Ext.getBody(),i=t.getViewRegion(),a=i.top,s=i.bottom;if(e.getTop()<a||e.getBottom()>s){var o=e.getOffsetsTo(t);n.setScrollTop(o[1])}}},Terrasoft.scrollToEl=Terrasoft.utils.dom.scrollToEl,Terrasoft.utils.dom.removeStyleSheet=function(e){Ext.util.CSS.removeStyleSheet(e)},Terrasoft.removeStyleSheet=Terrasoft.utils.dom.removeStyleSheet,Terrasoft.utils.dom.updateStyleSheet=function(){Ext.util.CSS.updateRule.apply(Ext.util.CSS,arguments)},Terrasoft.updateStyleSheet=Terrasoft.utils.dom.updateStyleSheet,Terrasoft.utils.dom.refreshStyleSheetCache=function(){Ext.util.CSS.refreshCache()},Terrasoft.refreshStyleSheetCache=Terrasoft.utils.dom.refreshStyleSheetCache,Terrasoft.utils.dom.createStyleSheet=function(e,t){Ext.util.CSS.createStyleSheet(e,t)},Terrasoft.createStyleSheet=Terrasoft.utils.dom.createStyleSheet,Terrasoft.utils.dom.appendStyleSheet=function(e,t,r,n){if(Ext.util.CSS.getRule(e,!0))Terrasoft.updateStyleSheet(e,t,r);else{var i=Ext.String.format("{0} {{1}: {2};}",e,t,r);Terrasoft.createStyleSheet(i,n)}},Terrasoft.appendStyleSheet=Terrasoft.utils.dom.appendStyleSheet,Terrasoft.utils.dom.reCreateStyleSheet=function(e,t,r,n){Terrasoft.removeStyleSheet(n);var i=Ext.String.format("{0} {{1}: {2};}",e,t,r);Terrasoft.createStyleSheet(i,n)},Terrasoft.reCreateStyleSheet=Terrasoft.utils.dom.reCreateStyleSheet,Terrasoft.utils.dom.shadeColor=function(e,t){var r=t<0?0:255;t=t<0?-1*t:t;var n=e.slice(1,3),i=e.slice(3,5),a=e.slice(5),s=parseInt(n,16),o=parseInt(i,16),l=parseInt(a,16);s=Math.round((r-s)*t)+s,o=Math.round((r-o)*t)+o,l=Math.round((r-l)*t)+l,n=s.toString(16),i=o.toString(16),a=l.toString(16);var c=Terrasoft.pad(n,2,"0"),u=Terrasoft.pad(i,2,"0"),h=Terrasoft.pad(a,2,"0");return Ext.String.format("#{0}{1}{2}",c,u,h)},Terrasoft.shadeColor=Terrasoft.utils.dom.shadeColor,Terrasoft.utils.dom.download=function(e,t){var r=document.createElement("a");r.href=e,r.download=t,document.body.appendChild(r),r.click(),document.body.removeChild(r)},Terrasoft.download=Terrasoft.utils.dom.download,Terrasoft.utils.dom.getImageFile=function(e,t){var r=e.split(","),n=function(e){return e[0].split(":")[1].split(";")[0]}(r),i=function(e){var t;t=e[0].indexOf("base64")>=0?atob(e[1]):decodeURIComponent(e[1]);for(var r=new Uint8Array(t.length),n=t.length-1;n>=0;n--)r[n]=t.charCodeAt(n);return r}(r),a=new Date,s=Terrasoft.generateGUID(),o=new Blob([i],{type:n});return Ext.apply(o,{lastModified:a.valueOf(),lastModifiedDate:a.toString(),name:t||s.toString(),webkitRelativePath:""}),o},Terrasoft.getImageFile=Terrasoft.utils.dom.getImageFile,Terrasoft.utils.dom.getViewSize=function(){return Ext.getBody().getViewSize()},Terrasoft.getViewSize=Terrasoft.utils.dom.getViewSize,Terrasoft.utils.dom.getIsBodyElement=function(e){return"body"===e.nodeName.toLowerCase()},Terrasoft.getIsBodyElement=Terrasoft.utils.dom.getIsBodyElement,Terrasoft.utils.dom.scrollIntoView=function(e,t){e.scrollIntoViewIfNeeded?e.scrollIntoViewIfNeeded(t):e.scrollIntoView(t)},Terrasoft.scrollIntoView=Terrasoft.utils.dom.scrollIntoView,Terrasoft.utils.dom.toggleFullScreenMode=function(e){var t=Ext.select(e).first();if(!t)return console.warn("toggleFullScreenMode failed. Not found element by selector "+e),!1;var r=Ext.get("full-screen-overlay-el");if(!r){var n=Ext.DomHelper.insertBefore(t,{id:"full-screen-overlay-el",tag:"div"});r=Ext.get(n)}r.toggleCls("full-screen-overlay-el"),t.toggleCls("full-screen-el");var i=t.hasCls("full-screen-el");return Terrasoft.toggleFullScreenMode.fsKeyMap&&(Terrasoft.toggleFullScreenMode.fsKeyMap.destroy(),Terrasoft.toggleFullScreenMode.fsKeyMap=null),Terrasoft.toggleFullScreenMode.fsObserver&&(Terrasoft.toggleFullScreenMode.fsObserver.disconnect(),Terrasoft.toggleFullScreenMode.fsObserver=null),i&&(Terrasoft.toggleFullScreenMode.fsKeyMap=new Ext.util.KeyMap(Ext.getBody(),[{key:Ext.EventObject.ESC,fn:function(){Terrasoft.toggleFullScreenMode(e)}}]),Terrasoft.toggleFullScreenMode.fsObserver=Terrasoft.utils.dom._addFullScreenObserver("full-screen-el")),Terrasoft.utils.dom.setAttributeToBody("full-screen-enabled",i),i},Terrasoft.utils.dom._addFullScreenObserver=function(e){var t=new MutationObserver((function(t,r){var n,i=_createForOfIteratorHelper(t);try{for(i.s();!(n=i.n()).done;){var a=n.value;if("childList"===a.type)Terrasoft.find(a.removedNodes,(function(t){return t.classList&&t.classList.contains(e)}))&&(Terrasoft.utils.dom.setAttributeToBody("full-screen-enabled",!1),r.disconnect())}}catch(e){i.e(e)}finally{i.f()}})),r=Ext.select(".".concat(e)).first();return r?(t.observe(r.parent().dom,{childList:!0}),t):null},Terrasoft.toggleFullScreenMode=Terrasoft.utils.dom.toggleFullScreenMode,Terrasoft.utils.dom.getScrollPosition=function(e){if(!e||!e.getScroll||!e.dom)throw new Terrasoft.UnsupportedTypeException;var t=e.getScroll(),r=Math.abs(t.left),n=Terrasoft.getScrollTypeInRtl();Terrasoft.getIsRtlMode()&&n!==Terrasoft.ScrollTypeInRtl.DEFAULT&&(r=e.dom.scrollWidth-e.dom.clientWidth-r);return{left:r,top:t.top}},Terrasoft.getScrollPosition=Terrasoft.utils.dom.getScrollPosition,Terrasoft.utils.dom.getScrollTypeInRtl=function(){var e=Terrasoft.utils.dom.getScrollTypeInRtl;if(Ext.isDefined(e.cache))return e.cache;var t=Ext.DomHelper.createTemplate({tag:"div",dir:"rtl",style:{fontSize:"14px",width:"4px",height:"1px",position:"absolute",top:"-10000px",overflow:"scroll"}}).append(document.body);return t.appendChild(document.createTextNode("ABCD")),e=Terrasoft.ScrollTypeInRtl.REVERSE,t.scrollLeft>0?e=Terrasoft.ScrollTypeInRtl.DEFAULT:(t.scrollLeft=1,0===t.scrollLeft&&(e=Terrasoft.ScrollTypeInRtl.NEGATIVE)),document.body.removeChild(t),Terrasoft.utils.dom.getScrollTypeInRtl.cache=e,e},Terrasoft.getScrollTypeInRtl=Terrasoft.utils.dom.getScrollTypeInRtl,Terrasoft.focustFirstInput=function(e){var t=Ext.String.format(Terrasoft.Resources.ObsoleteMessages.ObsoleteMethodMessage,"Terrasoft.focustFirstInput","focusFirstInput");console.warn(t),Terrasoft.focusFirstInput(e)},Terrasoft.utils.dom.focustFirstInput=Terrasoft.focustFirstInput,Terrasoft.focusFirstInput=function(e){for(var t=Ext.query(e),r=_.find(t,(function(e){return Ext.get(e.id).isVisible()}),this);r&&r.childElementCount;)r=r.children[0];r&&r.focus()},Terrasoft.utils.dom.focusFirstInput=Terrasoft.focusFirstInput,Terrasoft.calculateStylesWidth=function(e){var t=0;if(e){var r=Terrasoft.deepClone(e);Ext.apply(r,{width:"0px"});var n=Ext.DomHelper.generateStyles(r),i=Ext.DomHelper.insertHtml("beforeEnd",document.body,'<div style="'.concat(n,'"></div>'));t=i.offsetWidth,document.body.removeChild(i)}return t},Terrasoft.utils.dom.calculateStylesWidth=Terrasoft.calculateStylesWidth,Terrasoft.calculateStylesHeight=function(e){var t=0;if(e){var r=Terrasoft.deepClone(e);Ext.apply(r,{height:"0px"});var n=Ext.DomHelper.generateStyles(r),i=Ext.DomHelper.insertHtml("beforeEnd",document.body,'<div style="'.concat(n,'"></div>'));t=i.offsetHeight,document.body.removeChild(i)}return t},Terrasoft.utils.dom.calculateStylesHeight=Terrasoft.calculateStylesHeight,Terrasoft.calculateBorderStyles=function(e){var t={};if(e){var r=Terrasoft.deepClone(e);Ext.apply(r,{width:"0px"});var n=Ext.DomHelper.generateStyles(r),i=Ext.DomHelper.insertHtml("beforeEnd",document.body,'<div style="'.concat(n,'"></div>'));["Top","Bottom","Left","Right"].map((function(e){t[e.toLowerCase()]={color:i.style["border".concat(e,"Color")],width:i.style["border".concat(e,"Width")],style:i.style["border".concat(e,"Style")]}})),document.body.removeChild(i)}return t},Terrasoft.utils.dom.calculateBorderStyles=Terrasoft.calculateBorderStyles,Terrasoft.isElementInViewport=function(e){var t=Ext.select(e).first(),r=t&&t.dom;if(!r)return!1;var n=window.scrollY||window.pageYOffset,i=window.scrollX||window.pageXOffset,a=r.getBoundingClientRect(),s=a.top+n,o=a.left+i,l=n,c=n+window.innerHeight,u=i,h=i+window.innerWidth,f=s,d=s+r.clientHeight,p=o,m=o+r.clientWidth;return(d>=l&&d<=c||f<=c&&f>=l)&&(m>=u&&m<=h||p<=h&&p>=u)},Terrasoft.utils.dom.isElementInViewport=Terrasoft.isElementInViewport,Ext.ns("Terrasoft.data.constants"),Terrasoft.data.constants.FloatRange={MAX_VALUE:69999999999999.99,MIN_VALUE:-69999999999999.99},Terrasoft.data.constants.MONEY_PRECISION=4,Terrasoft.data.constants.GUID_EMPTY="00000000-0000-0000-0000-000000000000",Terrasoft.GUID_EMPTY=Terrasoft.data.constants.GUID_EMPTY,Terrasoft.data.constants.DataValueTypeConfig={SHORT_TEXT:{value:Terrasoft.DataValueType.SHORT_TEXT,displayValue:Terrasoft.Resources.DataValueType.SHORT_TEXT},MEDIUM_TEXT:{value:Terrasoft.DataValueType.MEDIUM_TEXT,displayValue:Terrasoft.Resources.DataValueType.MEDIUM_TEXT},RICH_TEXT:{value:Terrasoft.DataValueType.RICH_TEXT,displayValue:Terrasoft.Resources.DataValueType.RICH_TEXT},MAXSIZE_TEXT:{value:Terrasoft.DataValueType.MAXSIZE_TEXT,displayValue:Terrasoft.Resources.DataValueType.MAXSIZE_TEXT},LONG_TEXT:{value:Terrasoft.DataValueType.LONG_TEXT,displayValue:Terrasoft.Resources.DataValueType.LONG_TEXT},PHONE_TEXT:{value:Terrasoft.DataValueType.PHONE_TEXT,displayValue:Terrasoft.Resources.DataValueType.PHONE_TEXT},WEB_TEXT:{value:Terrasoft.DataValueType.WEB_TEXT,displayValue:Terrasoft.Resources.DataValueType.WEB_TEXT},EMAIL_TEXT:{value:Terrasoft.DataValueType.EMAIL_TEXT,displayValue:Terrasoft.Resources.DataValueType.EMAIL_TEXT},FLOAT1:{value:Terrasoft.DataValueType.FLOAT1,displayValue:Terrasoft.Resources.DataValueType.FLOAT1},FLOAT2:{value:Terrasoft.DataValueType.FLOAT2,displayValue:Terrasoft.Resources.DataValueType.FLOAT2},FLOAT3:{value:Terrasoft.DataValueType.FLOAT3,displayValue:Terrasoft.Resources.DataValueType.FLOAT3},FLOAT4:{value:Terrasoft.DataValueType.FLOAT4,displayValue:Terrasoft.Resources.DataValueType.FLOAT4},FLOAT8:{value:Terrasoft.DataValueType.FLOAT8,displayValue:Terrasoft.Resources.DataValueType.FLOAT8},INTEGER:{value:Terrasoft.DataValueType.INTEGER,displayValue:Terrasoft.Resources.DataValueType.INTEGER},BOOLEAN:{value:Terrasoft.DataValueType.BOOLEAN,displayValue:Terrasoft.Resources.DataValueType.BOOLEAN},LOOKUP:{value:Terrasoft.DataValueType.LOOKUP,displayValue:Terrasoft.Resources.DataValueType.LOOKUP},DATE_TIME:{value:Terrasoft.DataValueType.DATE_TIME,displayValue:Terrasoft.Resources.DataValueType.DATE_TIME},MONEY:{value:Terrasoft.DataValueType.MONEY,displayValue:Terrasoft.Resources.DataValueType.MONEY},DATE:{value:Terrasoft.DataValueType.DATE,displayValue:Terrasoft.Resources.DataValueType.DATE},TIME:{value:Terrasoft.DataValueType.TIME,displayValue:Terrasoft.Resources.DataValueType.TIME},ENTITY:{value:Terrasoft.DataValueType.ENTITY,displayValue:Terrasoft.Resources.DataValueType.ENTITY},ENTITY_COLLECTION:{value:Terrasoft.DataValueType.ENTITY_COLLECTION,displayValue:Terrasoft.Resources.DataValueType.ENTITY_COLLECTION},LOCALIZABLE_STRING:{value:Terrasoft.DataValueType.LOCALIZABLE_STRING,displayValue:Terrasoft.Resources.DataValueType.LOCALIZABLE_STRING},METADATA_TEXT:{value:Terrasoft.DataValueType.METADATA_TEXT,displayValue:Terrasoft.Resources.DataValueType.METADATA_TEXT},GUID:{value:Terrasoft.DataValueType.GUID,displayValue:Terrasoft.Resources.DataValueType.GUID},OBJECT_LIST:{value:Terrasoft.DataValueType.OBJECT_LIST,displayValue:Terrasoft.Resources.DataValueType.OBJECT_LIST},COMPOSITE_OBJECT_LIST:{value:Terrasoft.DataValueType.COMPOSITE_OBJECT_LIST,displayValue:Terrasoft.Resources.DataValueType.COMPOSITE_OBJECT_LIST},FILE_LOCATOR:{value:Terrasoft.DataValueType.FILE_LOCATOR,displayValue:Terrasoft.Resources.DataValueType.FILE_LOCATOR}},Ext.define("Terrasoft.core.PrivateMemberWatcher",{alternateClassName:"Terrasoft.PrivateMemberWatcher",singleton:!0,_privateMembers:{},_classes:{},_violations:{},_getMixinParents:function(e,t){for(var r in e.mixins)if(r){var n=e.mixins[r];Ext.Array.include(t,n.$className),this._getParentsRecursive(n.$className,t)}},_getParentsRecursive:function(e,t){var r=Ext.ClassManager.get(e),n=r&&r.prototype;if(n){this._getMixinParents(n,t);var i=n.__proto__&&n.__proto__.$className;i&&(Ext.Array.include(t,i),this._getParentsRecursive(i,t))}},_getParents:function(e){var t=[];return this._getParentsRecursive(e,t),t},_getPrintMessage:function(e,t){return Ext.String.format("Overriding private member in {0}, defined in:\n{1}",e,t.sort().join("\n"))},_isPrivate:function(e,t){var r=0===t.indexOf("_")&&"__privateMembers"!==t;if(!r){var n=Ext.ClassManager.get(e),i=n&&n.prototype;if(i)r=(i.__privateMembers||[]).indexOf(t)>-1}return r},_validateMemberViolation:function(e,t,r,n){if(e.length>0){var i=Ext.Array.intersect(e,t);if(i.length>0){var a=r+"."+n;this._violations[a]=i,console.error(this._getPrintMessage(a,i))}}},printAll:function(){Terrasoft.each(this._violations,(function(e,t){console.error(this._getPrintMessage(t,e))}),this)},getViolations:function(){return this._violations},getOverridenDefine:function(e){var t=this;return function(r,n,i){var a=e.call(t,r,n,i);try{if(n){var s=t._classes[r]=t._getParents(r);Object.keys(n).filter((function(e){return t._isPrivate(r,e)})).map((function(e){var n=t._privateMembers[e]=t._privateMembers[e]||[];t._validateMemberViolation(n,s,r,e),Ext.Array.include(n,r)}))}}finally{return a}}}}),Ext.define=Terrasoft.PrivateMemberWatcher.getOverridenDefine(Ext.define),Ext.define("Terrasoft.core.BaseObject",{alternateClassName:"Terrasoft.BaseObject",mixins:{observable:"Ext.util.Observable"},listeners:null,instanceId:"",destroyed:!1,console:window.console,constructor:function(e){this._validateConfig(e),this._applyMixins(e);var t=this.initialConfig=e||{};Ext.apply(this,t),this.callParent(arguments),this.instanceId=Terrasoft.generateGUID(),this.mixins.observable.constructor.call(this),this.addEvents("destroyed")},_validateConfig:function(e){var t=this;Terrasoft.each(e,(function(e,r){if(void 0===t[r]){var n=t.getTypeInfo().fullTypeName,i=Ext.String.format("{0} {1} {2} {3}",Terrasoft.Resources.BaseObject.Property,r,Terrasoft.Resources.BaseObject.IsNotDefinedInClass,n);if(Terrasoft.isDebug)throw new Terrasoft.ItemNotFoundException({message:i});t.error(i)}}))},_applyMixins:function(e){var t=this;if(e&&e.hasOwnProperty("mixins")){var r=e.mixins;Terrasoft.each(r,(function(e,r){var n=Ext.isString(e)?Ext.ClassManager.get(e):e;t.self.mixin(r,n)})),delete e.mixins}},log:function(e,t){var r=this.console;if(r){var n;switch(t){case Terrasoft.LogMessageType.INFORMATION:n=r.info;break;case Terrasoft.LogMessageType.WARNING:n=r.warn;break;case Terrasoft.LogMessageType.ERROR:n=r.error;break;default:n=r.log}n.call?n.call(r,e):n(e)}},error:function(e){this.log(e,Terrasoft.LogMessageType.ERROR)},warning:function(e){this.log(e,Terrasoft.LogMessageType.WARNING)},getTypeInfo:function(){var e=this.$className,t=e.split(".");return{fullTypeName:e,alternateClassName:this.alternateClassName,typePath:Terrasoft.deepClone(t),typeName:t.pop()}},getParentMethod:function(e,t){var r,n=this.getParentMethod.caller;if(n&&((r=n.$previous)||(n=n.$owner?n:n.caller)&&(r=n.$owner.superclass[n.$name])),r&&arguments.length>0){var i=Array.prototype.slice.call(t||[]);r=Function.prototype.bind.apply(r,[e].concat(i))}return r},getSafeCallback:function(e,t){return e=Ext.isFunction(e)?e:Terrasoft.emptyFn,t?e.bind(t):e},destroy:function(){if(!0!==this.destroyed||this.singleton)this.onDestroy();else{var e=Terrasoft.Resources.Controls.BaseObject.ClassInstanceAlreadyDestroyed,t=Terrasoft.getFormattedString(e,this.alternateClassName);this.log(t,Terrasoft.LogMessageType.WARNING)}},onDestroy:function(){this.destroyed=!0,this.fireEvent("destroyed"),this.clearListeners()}}),Ext.define("Terrasoft.Designers.BaseSchemaDesigner",{extend:"Terrasoft.core.BaseObject",alternateClassName:"Terrasoft.BaseSchemaDesigner",id:null,renderTo:null,designContainer:null,sandbox:null,schemaUId:null,packageUId:null,constructor:function(){this.callParent(arguments),this.init()},init:function(){this.addEvents("loadcomplete"),this.id||(this.id="schema-designer"),this.onSandboxInitialized()},onSandboxInitialized:function(){var e=this.sandbox;e.registerMessages({GetElementData:{direction:Terrasoft.MessageDirectionType.SUBSCRIBE,mode:Terrasoft.MessageMode.PTP},SaveProperties:{direction:Terrasoft.MessageDirectionType.SUBSCRIBE,mode:Terrasoft.MessageMode.PTP},HidePropertyPage:{mode:Terrasoft.MessageMode.PTP,direction:Terrasoft.MessageDirectionType.SUBSCRIBE},ReRenderPropertiesPage:{direction:Terrasoft.MessageDirectionType.PUBLISH,mode:Terrasoft.MessageMode.PTP},SaveElementProperties:{direction:Terrasoft.MessageDirectionType.PUBLISH,mode:Terrasoft.MessageMode.PTP}}),e.subscribe("GetElementData",this.onGetElementData,this),e.subscribe("SaveProperties",this.onSaveProperties,this),e.subscribe("HidePropertyPage",this.onHidePropertyPage,this)},onGetElementData:function(){throw new Terrasoft.NotImplementedException},onSaveProperties:function(){},render:function(e){this.renderTo=e.renderTo,(this.designContainer=this.createDesignContainer()).render(this.renderTo)},createDesignContainer:function(){return Ext.create("Terrasoft.Container",{id:this.id+"-mainCt",classes:{wrapClassName:["schema-designer","ts-box-sizing"]},items:[]})},unregisterMessages:function(){var e=this.sandbox;e&&e.unRegisterMessages()},onDestroy:function(){this.unregisterMessages();var e=this.designContainer;e&&e.destroy(),this.callParent(arguments)},onHidePropertyPage:function(){throw new Terrasoft.NotImplementedException},setTitle:function(e,t){document.title=t}}),Ext.define("Terrasoft.Designers.BaseProcessSchemaDesigner",{extend:"Terrasoft.Designers.BaseSchemaDesigner",alternateClassName:"Terrasoft.BaseProcessSchemaDesigner",designerViewModelClassName:"Terrasoft.BaseProcessSchemaDesignerViewModel",designerViewModel:null,contentContainer:null,propertiesContainer:null,propertiesEditModule:"ProcessSchemaElementPropertiesEdit",focusEl:null,render:function(e){this.onBeforeDesignerRender(),this.renderDesignContainer(e.renderTo),this.initDesignerManagers(this.onAfterDesignerRender,this)},onBeforeDesignerRender:function(){this.maskId=Terrasoft.Mask.show({timeout:0})},initDesignerManagers:function(e,t){e.call(t)},onAfterDesignerRender:function(){this.designerViewModel.init()},renderDesignContainer:function(e){this.designContainer=this.createDesignContainer(),this.propertiesContainer=this.createPropertiesContainer(),this.designerViewModel=this.createDesignerViewModel(),this.initFocusElement(e);var t=this.designContainer,r=this.designerViewModel;t.render(e),t.bind(r),r.on("change:SchemaCaption",this.setTitle,this),r.on("change:IsShowPropertyPage",this.onIsShowPropertyPageChange,this),r.on("focusDesigner",this.onFocusDesigner,this),r.on("initialized",this.onDesignerViewModelInitialized,this)},createDesignContainer:function(){var e=this.callParent(arguments),t=this.contentContainer=Ext.create("Terrasoft.Container",{id:this.id+"-content",classes:{wrapClassName:["content","ts-box-sizing"]},items:[]});e.add(t);var r=this.createDiagramHeader(),n=this.diagramContainer=this.createDiagramContainer();return n.add(r),t.add(n),e},createDiagramHeader:function(){var e=this.createCaptionContainer(),t=this.createToolbarContainer(),r=this.createLoadStoragePanel(),n=this._createMessagePanel();return Ext.create("Terrasoft.Container",{id:this.id+"-diagram-header",classes:{wrapClassName:["header","ts-box-sizing"]},items:[e,t,r,n]})},createDiagramContainer:function(){return Ext.create("Terrasoft.Container",{id:this.id+"-diagram-ct",classes:{wrapClassName:["diagram","ts-box-sizing"]},items:[]})},createCaptionContainer:function(){var e=Ext.create("Terrasoft.TextEdit",{id:this.id+"-caption",value:{bindTo:"SchemaCaption"},listeners:{enterkeypressed:this.onCaptionEnterPressed},markerValue:"SchemaCaption",enabled:{bindTo:"IsSchemaCaptionEnabled"}});return Ext.create("Terrasoft.Container",{id:this.id+"-diagram-caption-ct",classes:{wrapClassName:["control-width-15 ts-box-sizing diagram-caption-ct"]},items:[e]})},createToolbarContainer:function(){return Ext.create("Terrasoft.Container",{id:this.id+"-toolbar",classes:{wrapClassName:["toolbar","ts-box-sizing"]},items:[]})},createLoadStoragePanel:function(){var e=Terrasoft.Resources.SchemaDesigner;return Ext.create("Terrasoft.Container",{className:"Terrasoft.Container",id:this.id+"-load-storage-panel",classes:{wrapClassName:["load-storage-panel"]},visible:{bindTo:"IsLoadStoragePanelVisible"},items:[{className:"Terrasoft.Label",id:this.id+"-load-storage-label",caption:e.LoadStorageLabel,classes:{labelClass:["t-label"]}},{className:"Terrasoft.Container",id:this.id+"-load-storage-buttons",classes:{wrapClassName:["load-storage-buttons"]},items:[{className:"Terrasoft.Button",id:this.id+"-load-btn",caption:e.LoadStorageButtonCaption,click:{bindTo:"onLoadStorageClick"}},{className:"Terrasoft.Button",id:this.id+"-discard-btn",caption:e.DiscardStorageButtonCaption,click:{bindTo:"onDiscardStorageClick"}}]}]})},_createMessagePanel:function(){return Ext.create("Terrasoft.Container",{className:"Terrasoft.Container",id:this.id+"-message-panel",classes:{wrapClassName:["message-panel"]},visible:{bindTo:"IsMessagePanelVisible"},items:[{className:"Terrasoft.Label",id:this.id+"-message-panel-label",caption:{bindTo:"MessagePanelMessage"},classes:{labelClass:["t-label"]}},{className:"Terrasoft.Container",id:this.id+"-message-panel-buttons",classes:{wrapClassName:["message-panel-buttons"]},items:[{className:"Terrasoft.Button",id:this.id+"-message-panel-btn",style:Terrasoft.controls.ButtonEnums.style.TRANSPARENT,markerValue:"CloseMessagePanel",imageConfig:{source:Terrasoft.ImageSources.RESOURCE_MANAGER,params:{resourceManagerName:"Terrasoft.Nui",resourceItemName:"ProcessSchemaDesigner.CloseButtonImage.svg"}},click:{bindTo:"hideMessagePanel"}}]}]})},createPropertiesContainer:function(){var e=Ext.create("Terrasoft.Container",{id:this.getPropertiesContainerId(),classes:{wrapClassName:["properties-ct","ts-box-sizing"]},resizable:!Terrasoft.getIsRtlMode(),resizeActionsCode:Terrasoft.ResizeAction.RESIZE_LEFT.code,resizerConfig:{minWidth:356}});return e.on("onsizechanged",this.onDesignContentSizeChanged),this.contentContainer.add(e),e},onDesignContentSizeChanged:function(){var e=document.createEvent("Event");e.initEvent("resize",!1,!0),window.dispatchEvent(e)},getDesignerViewModelConfig:function(){var e=this.getPropertiesContainerId();return{sandbox:this.sandbox,propertiesContainerId:e,id:this.id,values:{SchemaUId:this.schemaUId,PackageUId:this.packageUId,IsShowPropertyPage:!0,PropertiesEditModule:this.propertiesEditModule}}},createDesignerViewModel:function(){var e=this.getDesignerViewModelConfig();return Ext.create(this.designerViewModelClassName,e)},initFocusElement:function(e){this.focusEl=e.appendChild({tag:"input",id:"focusInput",style:{width:0,height:0,padding:0,border:0,position:"absolute"}})},getPropertiesContainerId:function(){return this.id+"-properties-ct"},onIsShowPropertyPageChange:function(){this.propertiesContainer.rendered&&(this.propertiesContainer.getWrapEl().toggleCls("properties-ct-collapsed"),this.onDesignContentSizeChanged())},onFocusDesigner:function(){this.focusDesigner()},onDesignerViewModelInitialized:function(){Terrasoft.Mask.hide(this.maskId),this.fireEvent("loadcomplete",this)},focusDesigner:function(){this.focusEl.focus()},onCaptionEnterPressed:function(e){e.fireEvent("blur")},onSandboxInitialized:function(){this.callParent(arguments),this.sandbox.requireModuleDescriptors([this.propertiesEditModule],(function(){require([this.propertiesEditModule])}),this)},onHidePropertyPage:function(){this.designerViewModel.onHidePropertyPage()},onGetElementData:function(e){return this.designerViewModel.getPropertiesPageData(e)},onDestroy:function(){this.designerViewModel&&this.designerViewModel.destroy(),this.callParent(arguments)},getSchemaPropertiesButtonConfig:function(){return{id:this.id+"-process-properties-btn",classes:{wrapperClass:"t-btn-image margin-right-0px t-btn-image-left schema-properties-button"},click:{bindTo:"onShowPropertyPage"},hint:Terrasoft.Resources.SchemaDesigner.ProcessPropertiesButtonHint,markerValue:"SchemaPropertiesButton"}},getHelpButtonConfig:function(){return{id:this.id+"-help-btn",classes:{wrapperClass:"t-btn-image margin-right-0px t-btn-image-left help-button"},click:{bindTo:"onHelpClick"},hint:Terrasoft.Resources.SchemaDesigner.HelpButtonHint,markerValue:"HelpButton"}},getESNFeedButtonConfig:function(){return{id:this.id+"-feed-btn",classes:{wrapperClass:"t-btn-image margin-right-0px t-btn-image-left feed-button"},click:{bindTo:"onESNFeedClick"},hint:Terrasoft.Resources.SchemaDesigner.FeedButtonHint,markerValue:"FeedButton"}}}),Ext.define("Terrasoft.Designers.ProcessSchemaDesignerLog",{extend:"Terrasoft.BaseSchemaDesigner",alternateClassName:"Terrasoft.ProcessSchemaDesignerLog",sysProcessLogId:null,designerViewModelClassName:"Terrasoft.ProcessSchemaDesignerLogViewModel",schemaDiagramClassName:"Terrasoft.ProcessSchemaDiagram",renderDesignContainer:function(){var e=this.designContainer=this.createDesignContainer(),t=this.designerViewModel=this.createDesignerViewModel();e.render(this.renderTo),e.bind(t),t.on("initialized",(function(){Terrasoft.Mask.hide(this.bodyMaskId),this.fireEvent("loadcomplete",this)}),this),t.on("change:SchemaCaption",this.setTitle,this)},createDesignerViewModel:function(){return Ext.create(this.designerViewModelClassName,{sandbox:this.sandbox,id:this.id,values:{SysProcessLogId:this.sysProcessLogId}})},render:function(){var e=_asyncToGenerator(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.bodyMaskId=Terrasoft.Mask.show({timeout:0}),this.renderTo=t.renderTo,this.renderDesignContainer(),e.next=5,Terrasoft.ProcessFlowElementSchemaManager.initializeAsync();case 5:this.onAfterDesignerRender();case 6:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),getDiagramConfig:function(){return{id:this.id,classes:{wrapClassName:["ej-diagram","ts-box-sizing"]},items:{bindTo:"Items"},readOnly:!0}},createDesignContainer:function(){var e=this.callParent(arguments),t=this.getDiagramConfig(),r=this.diagram=Ext.create(this.schemaDiagramClassName,t),n=Ext.create("Terrasoft.Container",{id:this.id+"-diagram-ct",classes:{wrapClassName:["diagram","ts-box-sizing"]},items:[r]}),i=Ext.create("Terrasoft.Container",{id:this.id+"-content",classes:{wrapClassName:["content","ts-box-sizing"]},items:[n]});return e.add(i),e},onDestroy:function(){this.designerViewModel&&this.designerViewModel.destroy(),this.callParent(arguments)},onAfterDesignerRender:function(){this.designerViewModel.init()}}),Ext.define("Terrasoft.Designers.ProcessSchemaDesignerLogNew",{extend:"Terrasoft.ProcessSchemaDesignerLog",alternateClassName:"Terrasoft.ProcessSchemaDesignerLogNew",schemaDiagramClassName:"Terrasoft.ProcessDiagramComponent",designerViewModelClassName:"Terrasoft.ProcessSchemaDesignerLogViewModelNew",getDiagramConfig:function(){var e=this.callParent(arguments),t=_objectSpread(_objectSpread({},e),{},{diagramConfig:{bindTo:"DiagramConfig"}});return t},onAfterDesignerRender:function(){this.callParent(arguments),this.diagram.initDiagram()}}),Ext.define("Terrasoft.Designers.DcmSchemaDesignerLogNew",{extend:"Terrasoft.ProcessSchemaDesignerLogNew",alternateClassName:"Terrasoft.DcmSchemaDesignerLogNew",getDiagramConfig:function(){var e=this.callParent(arguments);return _objectSpread(_objectSpread({},e),{},{readOnly:!1})}}),Ext.define("Terrasoft.Designers.PackageDependenciesDiagramNew",{extend:"Terrasoft.ProcessSchemaDesignerLogNew",alternateClassName:"Terrasoft.PackageDependenciesDiagramNew",designerViewModelClassName:"Terrasoft.PackageDependenciesDiagramViewModelNew",getDiagramConfig:function(){var e=this.callParent(arguments);return _objectSpread(_objectSpread({},e),{},{classes:_objectSpread(_objectSpread({},e.classes),{},{wrapClassName:[].concat(_toConsumableArray(e.classes.wrapClassName),["package-dependencies-diagram"])}),straightConnection:!0})}}),Ext.define("Terrasoft.core.mixins.ProcessSchemaDesignerCopyMixin",{alternateClassName:"Terrasoft.ProcessSchemaDesignerCopyMixin",lastPasteElementUId:null,lastPasteElementShift:0,_updateParameterUIds:function(e,t,r,n){var i=r.uId,a=n.uId;Terrasoft.each(e,(function(e){t[e]===i&&(t[e]=a)}),this)},_actualizeMultiInstanceOptions:function(e,t,r){if(e){this._updateParameterUIds(["inputCollectionParameterUId","outputCollectionParameterUId","completedIterationsCountParameterUId","terminatedIterationsCountParameterUId","totalIterationsCountParameterUId"],e,t,r)}},_actualizePerformerAssignmentOptions:function(e,t,r){if(e){this._updateParameterUIds(["performerParameterUId","roleParameterUId"],e,t,r)}},createItemCopy:function(e){var t=e.managerItemUId,r={};e.getSerializableObject(r);["uId","name","caption","parameters"].forEach((function(e){delete r[e]}));var n=this.elementSchemaManager.createInstance(t,r);n.uId=Terrasoft.generateGUID(),this.onGenerateItemNameAndCaption(n);var i="";if(e.caption){var a=e.caption.getValue();i=a?a+Terrasoft.Resources.SchemaDesigner.CopySuffixCaption:""}return n.caption=Ext.create("Terrasoft.LocalizableString",{cultureValues:i}),n},getPasteItemPosition:function(e){var t=e.tag;this.lastPasteElementUId!==t&&(this.lastPasteElementUId=t,this.lastPasteElementShift=0),this.lastPasteElementShift+=20;var r=this.lastPasteElementShift;return{x:e.offsetX+r,y:e.offsetY+r}},cloneParameters:function(e,t){if(t.parameters){var r=t.parameters.getRoots();if(!r.isEmpty()){var n=e.parentSchema.mappings;e.parameters.each((function(t){n.removeByKey(t.uId),e.parameters.remove(t)}));var i=e.multiInstanceOptions,a=e.performerAssignmentOptions;r.each((function(t){var r=t.clone();if(this._actualizeMultiInstanceOptions(i,t,r),this._actualizePerformerAssignmentOptions(a,t,r),!t.getIsDynamic()){var s=e.createMappingInfo(r.uId,r),o=n.find(t.uId);o&&(s.sourceParameterUId=o.sourceParameterUId),n.add(s.targetUId,s)}e.parameters.add(r.uId,r)}),this)}}},pasteElement:function(e){var t=e.tag,r=this.get("Items"),n=r.filter((function(e){return e.uId===t})).collection.getAt(0);if(this.elementSchemaManager.allowElementCopy(n)){var i=this.createItemCopy(n),a=this.getPasteItemPosition(e);i.position=i.getCenterPosition(a.x,a.y),r.add(i.name,i),this.cloneParameters(i,n),this.loadPropertiesPage(i.name)}}}),Ext.define("Terrasoft.core.mixins.BaseProcessSchemaDesignerValidationMixin",{alternateClassName:"Terrasoft.BaseProcessSchemaDesignerValidationMixin",validationErrorTypes:{default:0,duplicateFlows:1,linkedParameters:2,linkedSchemaParameters:3},showValidationMessage:function(e,t,r){if(Ext.isEmpty(e)){var n=this.get("Schema"),i=n.getValidationResults();Terrasoft.each(i,(function(e){var t=n.findItemByUId(e.uId);t&&this.fireEvent("itemIsValidChanged",t)}),this);var a=this.getProcessSchemaValidationMessage(i);this.showSchemaValidationMessageBox(a,t,r)}else this.showInformationDialog(e,(function(){t.call(r,!1)}))},validateSubProcessSchema:function(e,t){this.getProcessModuleUtilities((function(r){var n=[],i=this.get("Schema"),a=Terrasoft.process.constants;i.flowElements.each((function(e){var i=e.managerItemUId===a.SUBPROCESS_MANAGER_ITEM_UID,s=e.schemaUId&&!Terrasoft.isEmptyGUID(e.schemaUId);i&&(s?n.push((function(n){var i={schemaUId:e.schemaUId,hostProcessSchemaName:e.getDisplayValue()};r.getInvalidElements(i,(function(t){var r=t.message;e.setPropertyValue("isValid",!r),e.validationInfoCaption=r,n()}),t)})):e.setPropertyValue("validationInfoCaption",null))})),n.push((function(){e.call(t)})),n.push(this),Terrasoft.chain.apply(this,n)}),this)},_setElementInvalidState:function(e,t){var r=t.validationType,n=void 0===r?Terrasoft.ValidationType.ERROR:r,i=t.validationErrorType,a=void 0===i?this.validationErrorTypes.default:i,s=t.message,o=void 0===s?Terrasoft.Resources.ProcessSchemaDesigner.Messages.ProcessSchemaElementRequirePropertyValidation:s;e.isValid=!1,e.validationResults=e.validationResults||[],e.validationResults.push({validationType:n,validationErrorType:a,message:o})},_clearElementInvalidState:function(e,t){var r=e.validationResults.findIndex((function(e){return e.validationErrorType===t}));r>-1&&(e.validationResults.splice(r,1),e.isValid=!0,this.fireEvent("itemIsValidChanged",e))},_findWrongEntityColumnInReferenceSchema:function(e,t,r){var n=this.get("Schema").packageUId;Terrasoft.EntitySchemaManager.getPackageSchemaInstanceBySchemaUId(e,n,(function(e){var n=t.filter((function(t){var r=(t.dependentParameter||t.dependentElement).getValue(),n=/EntityColumn:{(.*?)}/i.exec(r)[1];return!e.columns.findByFn((function(e){return e.uId===n}))}));r(n)}),this)},_validateProcessParametersOnAbsentLinkedColumns:function(e){var t=this,r=this.get("Schema");Terrasoft.eachAsync(r.flowElements.getItems(),(function(e,n){var i=e.parameters&&e.findParameterByName("ResultEntity");if(!i)return n();var a=r.findLinksToSchemaParameter(i);if(!a.length)return n();var s=i.referenceSchemaUId;t._findWrongEntityColumnInReferenceSchema(s,a,(function(e){var i,a=_createForOfIteratorHelper(e);try{for(a.s();!(i=a.n()).done;){var s=i.value;s&&(s.dependentElement.uId===r.uId?t._setElementInvalidState(s.dependentElement,{validationErrorType:t.validationErrorTypes.linkedSchemaParameters,message:s.dependentParameter.getCaption()}):t._setElementInvalidState(s.dependentElement,{validationErrorType:t.validationErrorTypes.linkedParameters}))}}catch(e){a.e(e)}finally{a.f()}n()}))}),(function(){Ext.callback(e)}),this)},_setFlowElementInvalidState:function(e){var t=this.validationErrorTypes.duplicateFlows;e.validationResults.some((function(e){return e.validationErrorType===t}))||this._setElementInvalidState(e,{validationErrorType:t})},_validateProcessFlows:function(){var e=this,t=this.get("Schema").flowElements,r={};t.each((function(n){var i=n.sourceRefUId,a=n.targetRefUId;if(i&&a){e._clearElementInvalidState(n,"duplicateFlows");var s=i+a,o=r[s];if(o){var l=t.get(o);e._setFlowElementInvalidState(n),e._setFlowElementInvalidState(l)}r[s]=n.name}}))},validateProcessSchema:function(e,t){var r=this;Terrasoft.chain((function(e){Terrasoft.Features.getIsDisabled("ValidateProcessParametersOnAbsentLinkedColumns")?e():r._validateProcessParametersOnAbsentLinkedColumns(e)}),(function(e){r._validateProcessFlows(),r.validateSubProcessSchema(e,r)}),(function(){Ext.callback(e,t)}),this)},schemaCaptionValidator:function(e,t){var r={invalidMessage:""};if(Ext.isEmpty(e))r.invalidMessage=Terrasoft.Resources.BaseViewModel.columnRequiredValidationMessage;else{var n=t.size,i=e.length;if(i>n){var a=Terrasoft.Resources.BaseViewModel.columnIncorrectTextRangeValidationMessage;a+=" ("+i+"/"+n+")",r.invalidMessage=a}}return r},_getProcessSchemaValidationMessageTemplate:function(e){var t=Terrasoft.Resources.ProcessSchemaDesigner.Messages,r=this.validationErrorTypes;switch(e){case r.duplicateFlows:return t.SchemaInvalidElementsDuplicateFlowsMessageTemplate;case r.linkedParameters:return t.SchemaInvalidColumnsElementsParameterMessageTemplate;case r.linkedSchemaParameters:return t.SchemaInvalidColumnsProcessParametersMessageTemplate;default:return t.SchemaInvalidElementsMessageTemplate}},hasProcessSchemaValidationInfoErrorType:function(e,t){var r=this;return e.some((function(e){return(e.validationErrorType||r.validationErrorTypes.default)===t}))},_getProcessSchemaValidationMessageBlock:function(e,t){var r,n=[],i=_createForOfIteratorHelper(e);try{for(i.s();!(r=i.n()).done;){var a=r.value,s=a.validationResults;if(this.hasProcessSchemaValidationInfoErrorType(s,t))if(a.uId===this.$SchemaUId){var o,l=_createForOfIteratorHelper(a.validationResults);try{for(l.s();!(o=l.n()).done;){var c=o.value;n.push(" - "+c.message)}}catch(e){l.e(e)}finally{l.f()}}else n.push(" - "+a.displayValue)}}catch(e){i.e(e)}finally{i.f()}var u="";if(n.length){var h=this._getProcessSchemaValidationMessageTemplate(t);u=Terrasoft.getFormattedString(h,n.join("\n"))}return u},getProcessSchemaValidationMessage:function(e){var t=this;return Object.values(this.validationErrorTypes).map((function(r){return t._getProcessSchemaValidationMessageBlock(e,r)})).filter((function(e){return""!==e})).join("\n\n")},setValidationConfig:function(){this.addColumnValidator("SchemaCaption",this.schemaCaptionValidator),this.addColumnValidator("Schema",this.validateSchema)},addColumnValidator:function(e,t){this.validationConfig[e]=this.validationConfig[e]||[],this.validationConfig[e].push(t)},validateSchema:function(){var e={invalidMessage:""};return!0!==this.get("Schema").validate()&&(e.isCustomMessage=!0,e.invalidMessage=Terrasoft.Resources.ProcessSchemaDesigner.Messages.InvalidProcessSchemaMessage),e},showSchemaValidationMessageBox:function(e,t,r){var n=this.get("Schema"),i=Terrasoft.Resources.ProcessSchemaDesigner.Messages,a=n.typeCaption.toLowerCase(),s=Ext.String.format(i.SchemaValidationMessageCaption,a),o=Ext.String.format(i.SaveInvalidProcessButtonCaption,n.typeCaption),l=Terrasoft.getBlueButtonConfig("SaveProcess",o);Terrasoft.ProcessSchemaDesignerUtilities.showProcessMessageBox({caption:s,message:e,buttons:[l,Terrasoft.MessageBoxButtons.CANCEL],defaultButton:0,handler:function(e){var n="SaveProcess"===e;t.call(r,n)},scope:this})}}),Ext.define("Terrasoft.core.mixins.ProcessSchemaDesignerSearchMixin",{alternateClassName:"Terrasoft.ProcessSchemaDesignerSearchMixin",searchItem:function(){var e=this.get("SearchTextEditValue");if(e)if(e===this.get("SearchValue"))this.get("IsItemsFound")&&this.searchNextItem();else{this.set("SearchValue",e);var t=this.findItems(e);this.set("FoundItems",t)}else this.clearSearchResult(!0)},findItems:function(e){if(Ext.isEmpty(e))return new Terrasoft.Collection;var t=e.replace(Terrasoft.process.constants.PARAMETER_ESCAPE_REGEX,"\\$&"),r=new RegExp(t,"i"),n=this.get("Items").filterByFn((function(e){return this.filterItems(e,r)}),this);return n.sortByFn(this.sortByPosition.bind(this)),n},sortByPosition:function(e,t){var r=this.getItemAveragePosition(e),n=this.getItemAveragePosition(t),i=r.y-n.y,a=r.x-n.x;return Math.abs(i)<20&&(i=0),0!==i?i:a},filterItems:function(e,t){if(e instanceof Terrasoft.ProcessLaneSchema||e instanceof Terrasoft.ProcessLaneSetSchema||e instanceof Terrasoft.ProcessLabelSchema)return!1;if(-1!==e.name.search(t))return!0;var r=e.caption&&e.caption.getValue();return r&&-1!==r.search(t)},getItemAveragePosition:function(e){var t={x:0,y:0};if(e.position)return t.x=e.position.X,t.y=e.position.Y,t;if("Sequence flow"===e.typeCaption){var r=e.findSourceElement(),n=e.findTargetElement();t=this.getAveragePointBetween(r.position,n.position)}return t},clearSearchResult:function(e){this.set("FoundItems",null),this.set("SearchValue",""),e||this.set("IsSearchStarted",!1)},updateSearchInfo:function(){var e="",t="",r=this.get("FoundItems");if(this.get("IsSearchStarted")&&this.get("SearchValue")&&r){var n=r.getCount(),i=this.get("SearchItemIndex"),a=Ext.String.format(Terrasoft.Resources.SchemaDesigner.SearchInfoTemplate,i+1,n);this.get("IsItemsFound")?e=a:t=a}this.set("SearchInfo",e),this.set("SearchErrorInfo",t),this.updateFoundItemsHighlighter()},updateFoundItemsHighlighter:function(){var e,t=this.get("FoundItems");if(t&&!t.isEmpty()){var r=this.get("SearchItemIndex");e=t.getByIndex(r).name}this.fireEvent("updateItemsHighlighter",t,e,this)},searchNextItem:function(){var e=this.get("SearchItemIndex")+1;e>=this.get("FoundItems").getCount()&&(e=0),this.set("SearchItemIndex",e),this.selectSearchingItem()},searchPreviousItem:function(){var e=this.get("SearchItemIndex")-1;e<0&&(e=this.get("FoundItems").getCount()-1);this.set("SearchItemIndex",e),this.selectSearchingItem()},selectSearchingItem:function(){if(this.updateSearchInfo(),this.get("IsItemsFound")){var e=this.get("FoundItems"),t=this.get("SearchItemIndex"),r=e.getByIndex(t).name;this.get("Items").find(r)?(this.set("LastSelectedItemName",r),this.fireEvent("itemSelected",r),this.fireEvent("itemCenterViewBox",r),this.loadPropertiesPage(r)):(this.set("SearchValue",""),this.searchItem())}},onSearchTextEditValueChange:function(){this.get("IsSearchStarted")&&(this.set("SearchValue",""),this.searchItem())},onFoundItemsChange:function(e,t){var r=null!=t&&!t.isEmpty();if(this.set("IsItemsFound",r),r){var n=this.get("LastSelectedItemName"),i=t.find(n),a=i?t.indexOf(i):0;this.set("SearchItemIndex",a),this.selectSearchingItem()}else this.set("SearchItemIndex",-1),this.updateSearchInfo()},getAveragePointBetween:function(e,t){return{x:Math.abs(t.X-e.X)/2+e.X,y:Math.abs(t.Y-e.Y)/2+e.Y}},onSearchButtonClick:function(){this.set("IsSearchStarted",!0),this.searchItem()},onSearchNextButtonClick:function(){this.searchNextItem()},onSearchPreviousButtonClick:function(){this.searchPreviousItem()}}),Ext.define("Terrasoft.Designers.BaseSchemaDesignerUtilities",{extend:"Terrasoft.BaseObject",alternateClassName:"Terrasoft.BaseSchemaDesignerUtilities",singleton:!0,EXPORT_SCHEMA_METADATA_URL_TEMPLATE:"/ServiceModel/SchemaManagerService.svc/Export?managerName={0}&schemaUId={1}",SCHEMA_METADATA_URL_TEMPLATE:"/ClientApp/#/SchemaMetaDataDesigner/{0}/{1}/{2}",WINDOW_PARAMS_TEMPLATE:"resizable,width={0},height={1},left={2},top={3}",SCHEMA_SOURCECODE_URL_TEMPLATE:"/ClientApp/#/SourceCodeSchemaDesigner/{0}?showMetaItemSourceCode=true",COMPILATION_ERRORS_URL:"/CompilationErrors.aspx",_classNameToWorkspaceItemTypeMap:{"Terrasoft.manager.ClientUnitSchema":Terrasoft.WorkspaceItemType.ClientUnitSchema,"Terrasoft.manager.ProcessSchema":Terrasoft.WorkspaceItemType.ProcessSchema,"Terrasoft.Designers.DcmSchema":Terrasoft.WorkspaceItemType.DcmSchema,"Terrasoft.manager.CampaignSchema":Terrasoft.WorkspaceItemType.CampaignSchema},getSourceCodeFileName:function(e,t){return e+"."+t+".cs"},initWebSocket:function(){var e=Terrasoft.ServerChannel;e.getConnectionState()===Terrasoft.SocketConnectionState.CLOSED&&(e.reconnectCount=0,e.init())},_handlePublishResponse:function(e){!Ext.isEmpty(e)&&e.success?Terrasoft.showInformation(e.message):(Terrasoft.showErrorMessage(e.message),this.warning(e.message))},openOldUIBlankWindow:function(e){var t=screen.availLeft+(screen.availWidth-810)/2,r=screen.availTop+(screen.availHeight-600)/2,n=Ext.String.format(this.WINDOW_PARAMS_TEMPLATE,810,600,t,r);window.open(e,"_blank",n)},_openNewTab:function(e){window.open(e,"_blank")},_obsoleteGetRunningProcessCountBySysSchemaUId:function(e,t,r){var n=Ext.create("Terrasoft.EntitySchemaQuery",{rootSchemaName:"SysProcessData"});n.addAggregationSchemaColumn("Id",Terrasoft.AggregationType.COUNT,"Count");var i=n.createColumnFilterWithParameter(Terrasoft.ComparisonType.EQUAL,"[VwSysSchemaInWorkspace:Id:SysSchemaId].UId",e);n.filters.addItem(i),i=n.createColumnFilterWithParameter(Terrasoft.ComparisonType.EQUAL,"[VwSysSchemaInWorkspace:Id:SysSchemaId].SysWorkspace.Id",Terrasoft.SysValue.CURRENT_WORKSPACE.value),n.filters.addItem(i),n.getEntityCollection((function(e){if(e.success){var n=e.collection.first();n=n.get("Count"),t.call(r,n)}else{var i=e.errorInfo;t.call(r,null,i.message)}}),r)},_removeBodyElementByTag:function(e){var t;null===(t=Ext.getBody().query(e)[0])||void 0===t||t.remove()},_getNewErrorListDialogProxyElement:function(){var e="ts-error-list-dialog-proxy";return this._removeBodyElementByTag(e),document.createElement(e)},openMetaData:function(e){var t=this._classNameToWorkspaceItemTypeMap[e.$className],r=Ext.String.format(this.SCHEMA_METADATA_URL_TEMPLATE,e.uId,t,e.packageUId),n=Terrasoft.workspaceBaseUrl+r;this._openNewTab(n)},exportMetaData:function(e){var t=Ext.String.format(this.EXPORT_SCHEMA_METADATA_URL_TEMPLATE,e.managerName,e.uId),r=Terrasoft.workspaceBaseUrl+t,n=e.name+".md";Terrasoft.download(r,n)},openSourceCode:function(e){var t=Ext.String.format(this.SCHEMA_SOURCECODE_URL_TEMPLATE,e.uId),r=Terrasoft.workspaceBaseUrl+t;this._openNewTab(r)},openEntitySourceCode:function(e){var t=Ext.String.format(this.SCHEMA_SOURCECODE_URL_TEMPLATE,e.realUId),r=Terrasoft.workspaceBaseUrl+t;this._openNewTab(r)},openValidationErrors:function(e,t){var r=this._getNewErrorListDialogProxyElement();r.validationErrorMessage=e,r.validationErrorsList=t,Ext.getBody().appendChild(r)},openCompilationErrors:function(e){var t=this._getNewErrorListDialogProxyElement();t.errorsList=e,Ext.getBody().appendChild(t)},publish:function(e,t,r){r=r||this;var n=Terrasoft.Mask.show({caption:Terrasoft.Resources.SchemaDesigner.PublishingMaskCaption,timeout:0});e.publish((function(i,a,s){e.pingApplication((function(){Terrasoft.Mask.hide(n);var e=Terrasoft.deserialize(Terrasoft.deserialize(s.responseText));if(e&&!e.success)if(e.errors&&e.errors.length>0)this.openCompilationErrors(e.errors);else{var i=e&&e.errorInfo&&e.errorInfo.message;Terrasoft.showErrorMessage(i)}else Ext.callback(t,r),a&&this._handlePublishResponse(e);a&&this.initWebSocket(a)}),this)}),this)},openHelp:function(e,t){var r={contextHelpCode:t,callback:function(e){window.open(e)},scope:this};e.getUrl(r)},loadSysPackageByUId:function(e,t,r){var n=Ext.create("Terrasoft.EntitySchemaQuery",{rootSchemaName:"SysPackage",clientESQCacheParameters:{cacheItemName:e+"-SysPackageName"}});n.addColumn("Id"),n.addColumn("UId"),n.addColumn("Name"),n.addColumn("Maintainer"),n.addColumn("InstallType"),n.filters.add("UId",Terrasoft.createColumnFilterWithParameter(Terrasoft.ComparisonType.EQUAL,"UId",e)),n.filters.add("SysWorkspace",Terrasoft.createColumnFilterWithParameter(Terrasoft.ComparisonType.EQUAL,"SysWorkspace",Terrasoft.SysValue.CURRENT_WORKSPACE.value)),n.getEntityCollection((function(e){if(e.success){var n=e.collection.first();t.call(r,n)}else t.call(r,null,e.errorInfo.message)}),this)},getRunningProcessCountBySysSchemaUId:function(e,t,r,n){Terrasoft.Features.getIsEnabled("UseObsoleteRunningProcessCountRequest")?this._obsoleteGetRunningProcessCountBySysSchemaUId(e,t,r):Ext.create("Terrasoft.GetRunningProcessCountByUIdRequest",{countSpecifiedVersion:!0,schemaUId:e,managerName:n}).execute((function(e){if(e.success)t.call(r,e.count);else{var n=e.errorInfo;t.call(r,null,n.message)}}),r)},getIsPackageForeign:function(e,t,r){Terrasoft.chain((function(t){this.loadSysPackageByUId(e,t,this)}),(function(e,n,i){if(i)t.call(r,null,i);else{var a=!1;if(n){var s=n.get("Maintainer"),o=n.get("InstallType");a=s!==Terrasoft.SysValue.CURRENT_MAINTAINER.value||o!==Terrasoft.SysPackageInstallType.SourceControl}t.call(r,{isPackageForeign:a,sysPackage:n})}}),this)}}),Ext.define("BaseSchemaDesignerStorageMixin",{alternateClassName:"Terrasoft.BaseSchemaDesignerStorageMixin",SCHEMA_METADATA_TEMPLATE:'{"metaData": {"schema": {0}}}',localStore:null,getStorageLocationHref:function(){return window.location.href},saveLocationHrefToStorage:function(){var e=this.getStorageLocationHref();this.localStore.setItem(this.storageLocationHref,e)},saveSchemaMetaDataToStorage:function(){var e=this.get("Schema").serialize(),t=Ext.String.format(this.SCHEMA_METADATA_TEMPLATE,e);this.localStore.setItem(this.storageSchemaMetadata,t)},saveSchemaResourcesToStorage:function(){var e={};this.get("Schema").getLocalizableValues(e),this.localStore.setItem(this.storageSchemaResources,e)},saveSelectedItemNameToStorage:function(){var e=this.get("LoadedPropertiesItemName");this.localStore.setItem(this.storageLoadedPropertiesItemName,e)},getSchemaFromStorage:function(){var e=this.get("SchemaManagerItem"),t=this.localStore.getItem(this.storageSchemaMetadata),r=this.localStore.getItem(this.storageSchemaResources);if(!t||!r)return null;var n=Terrasoft.SchemaDesignerUtilities.createInstanceByMetaData({metaData:t,schemaClassName:e.instanceClassName});return n.loadLocalizableValuesByUIds(r),n},unloadCurrentPropertyPage:function(){var e=this.get("LoadedPropertiesItemName");if(e){var t=this.getPropertiesModuleId(e);this.set("LoadedPropertiesItemName",null),this.sandbox.unloadModule(t)}},getIsSchemaStored:function(){return this.getStorageLocationHref()===this.localStore.getItem(this.storageLocationHref)},init:function(){if(!Terrasoft.DomainCache){Terrasoft.StoreManager.registerStores([{levelName:"Domain",type:"Terrasoft.LocalStore",isCache:!0}])}this.localStore=Terrasoft.DomainCache},initLocalStorageSchema:function(){this.set("IsLoadStoragePanelVisible",this.getIsLoadStoragePanelVisible())},getIsLoadStoragePanelVisible:function(){return this.getIsSchemaStored()},saveSchemaToStorage:function(){return this.set("IsLoadStoragePanelVisible",!1),!!this.get("IsSchemaChanged")&&(this.saveLocationHrefToStorage(),this.saveSchemaMetaDataToStorage(),this.saveSchemaResourcesToStorage(),this.saveSelectedItemNameToStorage(),!0)},loadSchemaFromStorage:function(e,t){this.unloadCurrentPropertyPage();var r=this.get("SchemaManagerItem"),n=r.isNew();r.clearInstance(),this.clearSchemaItems();var i=this.getSchemaFromStorage();if(i){if(n){var a=this.schemaManager;a.items.remove(r),r=a.createManagerItem({uId:i.uId}),a.addItem(r),this.set("SchemaUId",i.uId),this.set("SchemaManagerItem",r)}r.setInstance(i);var s=n?Terrasoft.ModificationStatus.NEW:Terrasoft.ModificationStatus.UPDATED;r.setStatus(s),this.set("IsSchemaChanged",!0),this.initSchema(i,(function(){this.onAfterGetSchemaInstance(i,(function(){this.loadItems(i);var r=this.localStore.getItem(this.storageLoadedPropertiesItemName);this.findItemByKey(r)?(this.set("LastSelectedItemUId",null),this.selectItem(r),this.loadPropertiesPage(r)):(this.clearSelection(),this.loadSchemaPropertiesPage()),Ext.callback(e,t||this)}),this)}),this)}},initSchema:function(e,t,r){t.call(r)},clearSchemaStorageInfo:function(){this.set("IsLoadStoragePanelVisible",!1);var e=this.localStore;e.removeItem(this.storageLocationHref),e.removeItem(this.storageSchemaMetadata),e.removeItem(this.storageSchemaResources),e.removeItem(this.storageLoadedPropertiesItemName)}}),Ext.define("Terrasoft.diagram.BaseDiagramDataAdapter",{extend:"Terrasoft.BaseObject",alternateClassName:"Terrasoft.BaseDiagramDataAdapter",defaultParent:"root1",_getProcessSchema:function(e){return e.getItems().find((function(e){return Boolean(e.parentSchema)})).parentSchema},_getProcessCaption:function(e){return e.caption.getValue()},_getProcessId:function(e){return e.uId},_getElements:function(e,t){var r=this,n={};return Terrasoft.each(t,(function(t){var i=r.getElementConfig(e,t);i&&(n[i.id]=i)}),this),n},_getExecutedCountLabels:function(e){var t=this,r={};return e.filter((function(e){return e.nodeType!==Terrasoft.diagram.UserHandlesConstraint.Label})).each((function(n){var i=t.getExecutedCountLabels(n,e);i&&Ext.apply(r,i)})),r},_getLabels:function(e){var t=this,r={};return e.filter((function(e){return e.nodeType===Terrasoft.diagram.UserHandlesConstraint.Label})).each((function(n){var i=t.getLabelConfig(n,e);i&&Ext.apply(r,i)})),r},_getConnections:function(e){var t=this,r=["connection","conditionalConnection","defaultConnection"];return e.getItems().reduce((function(e,n){var i=t.getType(n);return r.includes(i)&&(e[n.uId]=t.getConnectionConfig(n)),e}),{})},_pointEqual:function(e,t){return Math.abs(e-t)<=2},_isConnectionStraight:function(e){if(!e||e.length<2)return!1;for(var t=0;t<e.length-1;t++){var r=e[t],n=e[t+1];if(!this._pointEqual(r.x,n.x)&&!this._pointEqual(r.y,n.y))return!1}return!0},_getConnectionHintForElement:function(e){return{"{X=0,Y=0}":"h","{X=0,Y=1}":"t","{X=0,Y=-1}":"b","{X=-1,Y=0}":"l","{X=1,Y=0}":"r","{X=-1,Y=1}":"t","{X=1,Y=1}":"t","{X=-1,Y=-1}":"b","{X=1,Y=-1}":"b"}[e]||"h"},_getConnectionHints:function(e){return[this._getConnectionHintForElement(e.sourcePort)+":"+this._getConnectionHintForElement(e.targetPort)]},_roundPoint:function(e){return e.x=Math.round(e.x),e.y=Math.round(e.y),e},_initializeOrthogonalSegments:function(e){if(!(e.length<=2)){var t=e.length-1;this._alignPoints(e[0],e[1]),this._alignPoints(e[t],e[t-1])}},_alignPoints:function(e,t){this._pointEqual(e.x,t.x)&&(t.x=e.x),this._pointEqual(e.y,t.y)&&(t.y=e.y)},_isElement:function(e){var t=Terrasoft.diagram.UserHandlesConstraint;return![t.Lane,t.Connector,t.LaneSet,t.Label].includes(e.nodeType)},hasEmbeddedLabel:Terrasoft.emptyFn,getType:function(){return"shape"},_createItemLabelConfig:function(e){return{parent:e.uId,backgroundType:e.executionCountLabelTag,fontColor:e.executionCountFontColor}},_createLabel:function(e){return{id:e.id,parent:e.parent,type:"label",rx:0,ry:e.offsetY||0,caption:e.caption,horizontalAlignment:"center",verticalAlignment:"center",backgroundStyle:{type:e.backgroundType,fill:e.fillColor,padding:4.5,filter:{name:"StatisticInfoShadow_filter",color:"#000",opacity:.4,offsetX:1,offsetY:2,blur:2}},tooltip:e.tooltipText,style:{fill:e.fontColor}}},addMultiInstanceLabels:function(e,t,r){if(Terrasoft.Features.getIsEnabled("ExecutionDiagramMultiInstanceLabels")&&e instanceof Terrasoft.ProcessActivitySchema&&e.getIsMultiInstanceModeEnabled()){var n=e.uId+"_miExecCount_completed_label";t[n]=this._createLabel(Ext.apply(r,{id:n,caption:e.completedCount.toString(),fillColor:e.executedMICompletedFillColor,offsetY:25,tooltipText:e.completedCountTooltipText}));var i=e.uId+"_miExecCount_failed_label";t[i]=this._createLabel(Ext.apply(r,{id:i,caption:e.failedCount.toString(),fillColor:e.executedMIFailedFillColor,offsetY:50,tooltipText:e.failedCountTooltipText}))}},getExecutedCountLabel:function(e){var t=Ext.String.format(Terrasoft.Resources.ObsoleteMessages.ObsoleteMethodMessage,"getExecutedCountLabel","getExecutedCountLabels");return console.warn(t),this.getExecutedCountLabels(e)},getExecutedCountLabels:function(e,t){var r={},n=e.uId+"_execCount_label",i=this._createItemLabelConfig(e);return r[n]=this._createLabel(Ext.apply(i,{id:n,caption:e.executedCount.toString(),fillColor:e.executionCountFillColor})),this.addMultiInstanceLabels(e,r,i),r},getElementConfig:function(e,t){return this._isElement(t)?{type:this.getType(t),parent:e.flowElements.find(t.parent)?t.containerUId:this.defaultParent,id:t.uId,itemName:t.name,caption:t.caption.getValue(),height:t.size.height,width:t.size.width,rx:t.position.X,ry:t.position.Y,markers:t.getMarkersConfig()}:null},getLabelConfig:function(e,t){var r={},n=t.findByPath("uId",e.parentUId);if(!(n.caption&&n.caption.getValue()))return null;var i=r[e.uId]={id:e.uId,type:"label",parent:e.parentUId,itemName:e.name};return Terrasoft.isNull(e.x)||(i.rx=e.x),Terrasoft.isNull(e.y)||(i.ry=e.y),r},getConnectionConfig:function(e){var t=this,r=e.getDiagramConfig(),n={type:this.getType(e),id:e.uId,itemName:e.name,caption:e.caption.getValue(),source:e.sourceRefUId,target:e.targetRefUId},i=[e.startPoint||r.sourcePoint].concat(_toConsumableArray(e.polylinePointPositions||[]),[e.endPoint||r.targetPoint]);return this._initializeOrthogonalSegments(i),i.forEach((function(e){return t._roundPoint(e)})),this._isConnectionStraight(i)?n.waypoints=i:i.length>1&&(n.hints={connectionStart:i.shift(),connectionEnd:i.pop(),preferredLayouts:this._getConnectionHints(r)}),n},getDiagramData:function(e){var t=this._getProcessSchema(e),r=this._getProcessCaption(t),n=this._getElements(t,e),i=this._getConnections(e),a=this._getLabels(e),s=this._getExecutedCountLabels(e);Ext.apply(a,s);return{caption:r,elements:n,connections:i,labels:a,documentation:"",id:this._getProcessId(t)}}}),Ext.define("Terrasoft.utils.TsDiagramModule.SvgUtils",{extend:"Terrasoft.BaseObject",alternateClassName:"Terrasoft.TsDiagramModule.SvgUtils",createFeFlood:function(e,t){return e.element(t,"feFlood")},createFeComposite:function(e,t){return e.element(t,"feComposite")},createShadowFilter:function(e,t){var r=t||{},n=r.name;if(Ext.isEmpty(n))throw Ext.create("Terrasoft.ArgumentNullOrEmptyException");if(e.getElementById(n))return"url(#"+n+")";var i=e.getElementsByTagName("defs")[0];if(null==i)throw Ext.create("Terrasoft.ItemNotFoundException");var a=e.filter({id:n,width:"200%",height:"200%"}),s=e.feOffset({result:"offsetResult",in:"SourceAlpha",dx:r.offsetX||0,dy:r.offsetY||0});a.appendChild(s);var o=e.feGaussianBlur({result:"blurResult",in:"offsetResult",stdDeviation:r.blur||0});a.appendChild(o);var l=this.createFeFlood(e,{"flood-color":r.color||"#000","flood-opacity":r.opacity||0,result:"colorResult"});a.appendChild(l);var c=this.createFeComposite(e,{operator:"in",in:"colorResult",in2:"blurResult",result:"shadowResult"});a.appendChild(c);var u=e.feBlend({in:"SourceGraphic",in2:"shadowResult",mode:"normal"});return a.appendChild(u),i.appendChild(a),"url(#"+n+")"},getSvgElTranslateValues:function(e,t){var r=e.transform.baseVal,n={};t.forEach((function(e){n[e]=0}),this);for(var i=0,a=r.numberOfItems;i<a;i++){var s=r.getItem(i);if(s.type===SVGTransform.SVG_TRANSFORM_TRANSLATE){for(var o=0,l=t.length;o<l;o++){var c=t[o];n[c]=s.matrix[c]||0}break}}return n}}),Ext.define("Terrasoft.mixins.ConnectorRemovalMixin",{extend:"Terrasoft.BaseObject",alternateClassName:"Terrasoft.ConnectorRemovalMixin",diagram:null,nameTable:null,init:function(e){this.diagram=e,this.nameTable=e.nameTable},removeConnector:function(e,t){var r=e.inEdges,n=e.outEdges;!e.segments&&t.deleteDependent&&(r&&r.length>0&&this.removeNullConnectorsReferences(r),n&&n.length>0&&this.removeNullConnectorsReferences(n))},disconnect:function(e,t,r){if(this.getByName(e.name)){var n=this.getEdgesAreNotEmpty(e.inEdges),i=this.getEdgesAreNotEmpty(e.outEdges);this.removeObviousRecursion(e),this.removeHiddenRecursion(e),this.removeTransitivity(e),t.deleteDependent&&t.adjustDependent&&!r?n&&i?this.reconnectInConnectorsToFirstOutConnector(e):n?this.removeInConnectorsReferences(e):i&&this.removeOutConnectorsReferences(e):this.deleteAllConnectors(e)}},getEdgesAreNotEmpty:function(e){return e&&e.length>0},getByName:function(e){return this.nameTable[e]},removeNullConnectorsReferences:function(e){for(var t=e.length-1;t>=0;t--){var r=this.getByName(e[t]);!r||r.sourceNode&&r.targetNode||this.diagram._remove(r,!0)}},removeObviousRecursion:function(e){for(var t=this.getNodeOuts(e),r=t.length-1;r>=0;r--){var n=t[r];n.targetNode.name===e.name&&this.deleteConnector(n.connector)}},removeHiddenRecursion:function(e){this.getNodeOuts(e).forEach((function(t){for(var r=this.getNodeOuts(t.targetNode),n=r.length-1;n>=0;n--){var i=r[n];i.targetNode.name===e.name&&this.deleteConnector(i.connector)}}),this)},removeTransitivity:function(e){for(var t=this.getConnectedNodes(e),r=t.incomingNodes.length-1;r>=0;r--)for(var n=t.outgoingNodes.length-1;n>=0;n--){var i=t.incomingNodes[r],a=t.outgoingNodes[n];if(this.getAreNodesConnected(i,a)){var s=this.getConnectorBetween(e,a);s&&this.deleteConnector(s)}}},reconnectInConnectorsToFirstOutConnector:function(e){var t=this.getInConnectors(e),r=e.outEdges[0],n=r?this.getByName(r):null;if(n)for(var i=this.getByName(n.targetNode),a=t.length-1;a>=0;a--){var s=t[a];s.targetNode=n.targetNode,s.targetPort=n.targetPort,i.inEdges.push(s.name),ej.datavisualization.Diagram.Util.dock(s,this.nameTable),ej.datavisualization.Diagram.DiagramContext.update(s,this.diagram)}else this.removeInConnectorsReferences(e);this.removeOutConnectorsReferences(e)},removeInConnectorsReferences:function(e){var t=this;this.removeConnectorsReferences(e.inEdges,(function(e){return t.getByName(e.sourceNode).outEdges}))},removeOutConnectorsReferences:function(e){var t=this;this.removeConnectorsReferences(e.outEdges,(function(e){return t.getByName(e.targetNode).inEdges}))},removeConnectorsReferences:function(e,t){if(0!==e.length)for(var r=e.length-1;r>=0;r--){var n=this.getByName(e[r]);Ext.Array.remove(t(n),n.name),this.clearConnector(n)}},deleteAllConnectors:function(e){this.removeInConnectorsReferences(e),this.removeOutConnectorsReferences(e)},clearConnector:function(e){e.sourceNode=null,e.sourcePort=null,e.targetNode=null,e.targetPort=null},deleteConnector:function(e){Ext.Array.remove(this.getByName(e.targetNode).inEdges,e.name),Ext.Array.remove(this.getByName(e.sourceNode).outEdges,e.name),this.clearConnector(e),this.diagram._remove(e,!0)},getConnectorBetween:function(e,t){for(var r=null,n=e.outEdges,i=t.inEdges,a=n.length-1;a>=0;a--)for(var s=i.length-1;s>=0;s--){var o=n[a];if(o===i[s]){r=this.getByName(o);break}}return r},getAreNodesConnected:function(e,t){return e.outEdges.some((function(e){return this.getByName(e).targetNode===t.name}),this)},getNodeOuts:function(e){for(var t=[],r=e.outEdges,n=r.length-1;n>=0;n--){var i=this.getByName(r[n]),a=this.getByName(i.targetNode);t.push({connector:i,targetNode:a})}return t},getConnectedNodes:function(e){var t,r={incomingNodes:[],outgoingNodes:[]},n=e.outEdges,i=e.inEdges;for(t=n.length-1;t>=0;t--){var a=this.getByName(n[t]);r.outgoingNodes.push(this.getByName(a.targetNode))}for(t=i.length-1;t>=0;t--){var s=this.getByName(i[t]);r.incomingNodes.push(this.getByName(s.sourceNode))}return r},getInConnectors:function(e){for(var t=[],r=e.inEdges.length-1;r>=0;r--)t.push(this.getByName(e.inEdges[r]));return t}}),Ext.define("Terrasoft.PackageDependenciesDiagramMixin",{alternateClassName:"Terrasoft.core.mixins.PackageDependenciesDiagramMixin",onMessageReceived:function(e){var t=Terrasoft.decode(e.browserEvent.data);"ReadMetaData"===t.message&&this.loadProcessSchema(t)},loadProcessSchema:function(e){var t=e.metaData,r=Terrasoft.SchemaDesignerUtilities.createInstanceByMetaData({metaData:t,schemaClassName:"Terrasoft.ProcessSchema",resources:e.resources});this.loadItems(r),this.fireEvent("initialized",this)},getLocationOrigin:function(){var e=window.location.origin;return e||(e=window.location.protocol+"//"+window.location.hostname+(window.location.port?":"+window.location.port:"")),e},sendMessage:function(e){var t=Terrasoft.encode(e),r=this.getLocationOrigin();window.parent.postMessage(t,r)},init:function(){Ext.EventManager.addListener(window,"message",this.onMessageReceived,this),this.sendMessage({message:"GetMetaData"})}}),Ext.define("Terrasoft.Designers.PackageDependenciesDiagram",{extend:"Terrasoft.ProcessSchemaDesignerLog",alternateClassName:"Terrasoft.PackageDependenciesDiagram",designerViewModelClassName:"Terrasoft.PackageDependenciesDiagramViewModel",createDesignerViewModel:function(){return Ext.create(this.designerViewModelClassName,{sandbox:this.sandbox,id:this.id})}}),Ext.define("Terrasoft.utils.builder.ObjectBuilder",{extend:"Terrasoft.BaseObject",alternateClassName:"Terrasoft.ObjectBuilder",tokensChain:null,result:null,contextStack:null,types:null,contextTypes:null,handlers:null,processingRules:null,startChainCallObject:null,constructor:function(){this.baseInit(),this.initTokensChainAndContext(),this.setInitialBuilderState(),this.initStartChainCallObject(),this.initTypes(),this.processingRules=this.getMatrixFromTypes(),this.initHandlers(),this.initRules(),this.callParent(arguments),this.postInit()},getStartSymbol:function(){return"e"},baseInit:function(){this.handlers=[],this.types=[],this.contextTypes=[],this.types.push(this.getStartSymbol())},initTokensChainAndContext:function(){this.tokensChain=[],this.contextStack=[]},setInitialBuilderState:function(){this.enterContext({type:this.getStartSymbol()})},getMatrixFromTypes:function(){var e=[];return this.types.forEach((function(t){e[t]=[],this.contextTypes.forEach((function(r){e[t][r]=0}),this)}),this),e},processTokens:function(){var e=this.tokensChain;(e=this.removeIgnoredTokens(e)).forEach((function(e){this.processTokenByRules(e)}),this)},removeIgnoredTokens:function(e){var t=0;return e.filter((function(e){var r=this.getIsTokenContext(e),n=this.getIsTokenBreakpoint(e);return t>0?(n?t--:r&&t++,!1):!e.condition||(r&&t++,!1)}),this)},processTokenByRules:function(e){if(0!==this.contextStack.length){var t=this.peekContext(),r=e.type,n=t.type,i=this.processingRules[r][n]||0;this.handlers[i].call(this,e,t)}},setResultToNewObject:function(e){var t={};this.result=t,e.value=t,this.enterContext(e)},setResultToNewArray:function(e){var t=[];this.result=t,e.value=t,this.enterContext(e)},throwError:function(e,t){throw Ext.String.format("Error. Token: {0}. Context: {1}.",e.type,t.type)},insertObjectToObject:function(e,t){var r=e.args[0],n={};e.value=n,t.value[r]=n,this.enterContext(e)},insertObjectToArray:function(e,t){var r=t.value,n={};e.value=n,r.push(n),this.enterContext(e)},insertArrayToObject:function(e,t){var r=t.value,n=[],i=e.args[0];e.value=n,r[i]=n,this.enterContext(e)},insertArrayToArray:function(e,t){var r=t.value,n=[];e.value=n,r.push(n),this.enterContext(e)},insertNodeToObject:function(e,t){var r=e.args[0],n=e.args[1];t.value[r]=n},insertNodeToArray:function(e,t){var r=e.args[0];t.value.push(r)},initStartChainCallObject:function(){var e=this.getStartChainCallConfig();this.setStartChainCallObject(e)},getStartChainCallConfig:function(){return{object:this.object,array:this.array,add:this.add,end:this.end}},initTypes:function(){this.registerTokenType("node"),this.registerTokenType("end"),this.registerTokenType("object"),this.registerTokenType("array"),this.registerTokenType("custom"),this.registerContextType("object"),this.registerContextType("array")},initHandlers:function(){this.registerHandler(this.throwError,0),this.registerHandler(this.setResultToNewObject,1),this.registerHandler(this.setResultToNewArray,2),this.registerHandler(this.insertObjectToObject,3),this.registerHandler(this.insertObjectToArray,4),this.registerHandler(this.insertArrayToObject,5),this.registerHandler(this.insertArrayToArray,6),this.registerHandler(this.exitContext,7),this.registerHandler(this.insertNodeToObject,8),this.registerHandler(this.insertNodeToArray,9)},initRules:function(){var e=this.getStartSymbol();this.registerRule("object","object",3),this.registerRule("object","array",4),this.registerRule("object",e,1),this.registerRule("array","object",5),this.registerRule("array","array",6),this.registerRule("array",e,2),this.registerRule("end","object",7),this.registerRule("end","array",7),this.registerRule("node","object",8),this.registerRule("node","array",9)},getIsTokenContext:function(e){var t=e.type;return Terrasoft.contains(this.contextTypes,t)},getIsTokenBreakpoint:function(e){return"end"===e.type},peekContext:function(){return Terrasoft.last(this.contextStack)},enterContext:function(e){this.contextStack.push(e)},exitContext:function(){this.contextStack.pop()},setStartChainCallObject:function(e){e.tokensChain=this.tokensChain,e.addToken=this.addToken,this.startChainCallObject=e},addToken:function(e,t){this.tokensChain.push({type:e,args:t,condition:this.condition})},registerTokenType:function(e){this.types.push(e)},registerContextType:function(e){this.contextTypes.push(e)},registerHandler:function(e,t){this.handlers[t]=e},registerRule:function(e,t,r){this.processingRules[e][t]=r},postInit:Terrasoft.emptyFn,start:function(e){return Ext.isEmpty(e)?this.startChainCallObject.condition=!1:this.startChainCallObject.condition=!e,this.startChainCallObject},object:function(){return this.addToken("object",arguments),this},array:function(){return this.addToken("array",arguments),this},add:function(){return this.addToken("node",arguments),this},end:function(){return this.addToken("end",arguments),this.condition=!1,this},getResult:function(){return this.processTokens(),this.result}}),Ext.define("Terrasoft.utils.common.ImageUrlBuilder",{alternateClassName:"Terrasoft.ImageUrlBuilder",statics:{urlParamsMap:function(){var e={};return e[Terrasoft.ImageSources.ENTITY_COLUMN]={s:"db",sn:"schemaName",scn:"columnName",id:"primaryColumnValue"},e[Terrasoft.ImageSources.IMAGE_LIST_SCHEMA]={s:"shm",sid:"schemaUId",r:"itemUId"},e[Terrasoft.ImageSources.RESOURCE_MANAGER]={s:"res",rm:"resourceManagerName",r:"resourceItemName"},e[Terrasoft.ImageSources.SOURCE_CODE_SCHEMA]={s:"scs",sn:"schemaName",r:"resourceItemName"},e[Terrasoft.ImageSources.SYS_SETTING]={sf:"terrasoft.axd",s:"nui-binary-syssetting",r:"resourceItemName"},e[Terrasoft.ImageSources.URL]=function(e){return e.url},e[Terrasoft.ImageSources.PROCESS_USERTASK_SCHEMA]={s:"puts",sn:"schemaName",r:"resourceItemName"},e}(),_isStaticContentImageConfig:function(e){if(!Terrasoft.useStaticFileContent)return!1;var t=e.params;if(t&&t.resourceItemExtension)return!0;if(Terrasoft.useAsyncStaticContentGeneration)return!1;var r=Ext.String.format('Image config for item "{1}" in schema "{0}" doesn\'t have property "resourceItemExtension". It is an obsolete logic and will be removed in future versions.',t.schemaName,t.resourceItemName);return console.warn(r),!1},_getUrlForStaticContentImage:function(e){var t=[];t.push(Terrasoft.workspaceBaseUrl),t.push(Terrasoft.app.config.staticFileContent.imagesRuntimePath);var r=e.params.schemaName+"-"+e.params.resourceItemName+e.params.resourceItemExtension;t.push(r);var n=e.params.hash?"?hash="+e.params.hash:Terrasoft.emptyString;return t.join("/")+n},getUrl:function(e){var t=e.source,r=this.urlParamsMap[t];if(Ext.isFunction(r))return r(e);var n=e.params;e.hash&&(n.hash=e.hash),n.hash=n.hash||"hash";var i=[],a=Terrasoft.workspaceBaseUrl+"/img";switch(i.push(a),t){case Terrasoft.core.enums.ImageSources.ENTITY_COLUMN:i.push("entity"),i.push(n.hash),i.push(n.schemaName),i.push(n.columnName),i.push(n.primaryColumnValue);break;case Terrasoft.core.enums.ImageSources.IMAGE_LIST_SCHEMA:i.push("image-list"),i.push(n.hash),i.push(n.schemaUId),i.push(n.itemUId);break;case Terrasoft.core.enums.ImageSources.RESOURCE_MANAGER:i.push("resource-manager"),i.push(n.hash),i.push(n.resourceManagerName),i.push(n.resourceItemName);break;case Terrasoft.core.enums.ImageSources.SOURCE_CODE_SCHEMA:if(this._isStaticContentImageConfig(e))return this._getUrlForStaticContentImage(e);i.push("source-code"),i.push(n.hash),i.push(n.schemaName),i.push(n.resourceItemName);break;case Terrasoft.core.enums.ImageSources.PROCESS_USERTASK_SCHEMA:i.push("process-usertask"),i.push(n.hash),i.push(n.schemaName),i.push(n.resourceItemName);break;case Terrasoft.core.enums.ImageSources.SYS_SETTING:var s=[],o=n.r,l=null;void 0!==o&&""!==o&&Terrasoft.hasOwnProperty("SysSettingsImageHash")&&(l=Terrasoft.SysSettingsImageHash[o]);var c=[];for(var u in r)"sf"===u?u in n?s.push(n[u]+"?"):s.push(r[u]+"?"):u in n?c.push(u+"="+n[u]):c.push(u+"="+r[u]);null!==l&&c.push("source_hash="+l),s.push(c.join("&")),i.push(s.join(""));break;case Terrasoft.core.enums.ImageSources.SYS_IMAGE:i.push("entity",n.hash,"SysImage","Data"),i.push(n.primaryColumnValue)}return i.join("/")},getDataUrlByBase64:function(e){var t=!1;try{t=/^<(svg|\?xml)\s/.test(atob(e))}catch(e){}return"".concat(t?"data:image/svg+xml;base64,":"data:image/*;base64,").concat(e)}}}),Ext.define("Terrasoft.core.BaseModule",{alternateClassName:"Terrasoft.BaseModule",extend:"Terrasoft.BaseObject",Ext:null,sandbox:null,Terrasoft:null,viewModel:null,viewModelClassName:"",viewGeneratorClassName:"",init:function(){this.setMaskState(),this.viewGenerator=Ext.create(this.viewGeneratorClassName),this.viewModel=Ext.create(this.viewModelClassName)},setMaskState:function(){Ext.getBody().set({maskState:"none"})},render:function(e){var t=this.viewGenerator.generateView();t.bind(this.viewModel),t.render(e)},destroy:function(){this.viewGenerator.destroyed||this.viewGenerator.destroy(),this.viewModel.destroyed||this.viewModel.destroy(),this.viewGenerator=null,this.viewModel=null}}),Ext.define("LocalStore",{extend:"Terrasoft.BaseObject",alternateClassName:"Terrasoft.LocalStore",quotaExceededErrorMessages:null,cacheGlobalKey:"terrasoftCaches",storeGlobalKey:"terrasoftStores",storeName:"",isCache:null,levelKeySeparator:"@",registerStore:function(){var e=this.isCache?this.cacheGlobalKey:this.storeGlobalKey,t=this.getLocalStorageItem(e);t||(t=[]),Terrasoft.contains(t,this.storeName)||(t.push(this.storeName),this.setLocalStorageItem(e,t))},registerStoreKeys:function(){this.getLocalStorageItem(this.storeName)||this.setLocalStorageItem(this.storeName,[])},setLocalStorageItem:function(e,t,r){if(Ext.isEmpty(e))throw new Terrasoft.ArgumentNullOrEmptyException({argumentName:"key"});Ext.isString(t)||(t=Ext.JSON.encode(t));try{localStorage.setItem(e,t)}catch(n){if(Terrasoft.contains(this.quotaExceededErrorMessages,n.name)){if(!0===r)throw new Terrasoft.Terrasoft.UnknownException({message:n.maessage});this.onQuotaExceededError(e,t)}}},clearCacheByName:function(e){var t=this.getLocalStorageItem(e);Terrasoft.each(t,(function(t){this.removeLocalStorageItem(e+this.levelKeySeparator+t)}),this),this.setLocalStorageItem(e,[])},getLocalStorageItem:function(e){var t,r=localStorage.getItem(e);try{t=null===r?void 0:Ext.JSON.decode(r)}catch(e){t=r}return t},removeLocalStorageItem:function(e){localStorage.removeItem(e)},addRecordKey:function(e){var t=this.getLocalStorageItem(this.storeName);Terrasoft.contains(t,e)||(t.push(e),this.setLocalStorageItem(this.storeName,t))},removeRecordKey:function(e){var t=this.getLocalStorageItem(this.storeName);Ext.Array.remove(t,e),this.setLocalStorageItem(this.storeName,t)},onQuotaExceededError:function(e,t){this.clearCaches(),this.setLocalStorageItem(e,t,!0)},clearCaches:function(){var e=this.getLocalStorageItem(this.cacheGlobalKey);Terrasoft.each(e,(function(e){this.clearCacheByName(e)}),this)},constructor:function(){if(this.quotaExceededErrorMessages=["QUOTA_EXCEEDED_ERR","NS_ERROR_DOM_QUOTA_REACHED","QuotaExceededError"],this.callParent(arguments),Ext.isEmpty(this.storeName))throw new Terrasoft.ArgumentNullOrEmptyException({argumentName:"storeName"});if(Ext.isEmpty(this.isCache))throw new Terrasoft.ArgumentNullOrEmptyException({argumentName:"isCache"});this.registerStore(),this.registerStoreKeys()},getStoreKey:function(e){if(Ext.isEmpty(e))throw new Terrasoft.ArgumentNullOrEmptyException({argumentName:"key"});return this.storeName+this.levelKeySeparator+e},setItem:function(e,t){var r=this.getStoreKey(e);this.setLocalStorageItem(r,t),this.addRecordKey(e)},getItem:function(e){var t=this.getStoreKey(e);return this.getLocalStorageItem(t)},removeItem:function(e){var t=this.getStoreKey(e);this.removeLocalStorageItem(t),this.removeRecordKey(e)},clear:function(){this.clearCacheByName(this.storeName)}}),Ext.define("Terrasoft.data.store.MemoryStore",{extend:"Terrasoft.core.BaseObject",alternateClassName:"Terrasoft.MemoryStore",storeName:"",isCache:null,storage:null,constructor:function(){this.callParent(arguments),this.storage={}},setItem:function(e,t){Terrasoft.checkArguments(arguments,"key"),this.storage[e]=t},getItem:function(e){return this.storage.hasOwnProperty(e)?this.storage[e]:void 0},removeItem:function(e){delete this.storage[e]}}),Ext.define("Terrasoft.data.store.StoreManager",{extend:"Terrasoft.BaseObject",alternateClassName:"Terrasoft.StoreManager",singleton:!0,stores:{},registerStore:function(e){if(!e)throw new Terrasoft.ArgumentNullOrEmptyException({argumentName:"storeConfig"});if(!e.type)throw new Terrasoft.ArgumentNullOrEmptyException({argumentName:"storeConfig.type"});var t=e.type,r=this.getStoreName(e),n=Ext.create(t,{storeName:r,isCache:e.isCache});return Terrasoft[r]=n,this.stores[r]=n,n},getStoreName:function(e){if(!e.levelName)throw new Terrasoft.ArgumentNullOrEmptyException({argumentName:"storeConfig.levelName"});var t=e.isCache?"Cache":"Store";return e.levelName+t},constructor:function(){this.callParent(arguments),Terrasoft.storesConfig&&this.registerStores(Terrasoft.storesConfig)},registerStores:function(e){for(var t=e.length,r=0;r<t;r+=1){var n=e[r];this.registerStore(n)}}},(function(){Terrasoft.StoreManager.registerStore({levelName:"ClientCore",type:"Terrasoft.MemoryStore",isCache:!0})})),Ext.define("Terrasoft.data.store.RingBuffer",{extend:"Terrasoft.core.BaseObject",alternateClassName:"Terrasoft.RingBuffer",_storage:null,_maxLength:0,_tail:0,_isOnlyUniqueItems:!1,constructor:function(e){Terrasoft.checkArguments(arguments,"config"),this._maxLength=e.maxLength,this._storage=new Array(this._maxLength),this._isOnlyUniqueItems=Boolean(e.isOnlyUniqueItems)},pushItem:function(e){Terrasoft.checkArgumentsDefined(arguments,"item"),this._isOnlyUniqueItems&&this.getIsItemExists(e)||(this._storage[this._tail++]=e,this._tail===this._maxLength&&(this._tail=0))},getIsItemExists:function(e){return Terrasoft.checkArgumentsDefined(arguments,"item"),Boolean(this._storage.indexOf(e)>=0)},clear:function(){this._storage.fill(void 0),this._tail=0}}),function(e){var t=function(){var e=[],t=(new Date).valueOf();function r(){return(new Date).valueOf()-t}function n(t,r){for(var n=e.length-1;n>=0;n--){var i=e[n];i.entryType===t&&(null!=r&&""!==r&&i.name!==r||e.splice(n,1))}}function i(t){for(var r=e.length-1;r>=0;r--){var n=e[r];if(n.name===t)return n}return null}return{now:function(){return r()},mark:function(t){e.push({startTime:r(),duration:0,entryType:"mark",name:t})},measure:function(t,n,a){var s=i(n),o=i(a),l=s?s.startTime:0,c=o?o.startTime:r();e.push({startTime:l,duration:c-l,entryType:"measure",name:t})},getEntriesByName:function(t){for(var r=[],n=0,i=e.length;n<i;n++){var a=e[n];a.name===t&&r.push({startTime:a.startTime,duration:a.duration,entryType:a.entryType,name:a.name})}return r},clearMeasures:function(e){n("measure",e)},clearMarks:function(e){n("mark",e)}}}(),r={},n=!1,i=!1,a=null,s=window.performance||{};["now","mark","measure","getEntriesByName","clearMeasures","clearMarks"].every((function(e){return s.hasOwnProperty(e)}),this)||(s=t);var o=e.console||{log:function(){}};function l(e){this.name=e,this.measurements=[],this.requiredCalculateProperties=["startTimeMarkName","endTimeMarkName","measureMarkName"]}function c(e){return r[e]}function u(e){var t=c(e);t&&(t.clear(),delete r[e])}function h(e,t,r){var i=[t||0],a=[(i=i.map((function(){return"\t"}))).join("")+e];n&&a.push(r||""),o.log.apply(o,a)}function f(e){if(!e)return"--:--:--";var t=new Date(e);return Ext.String.format("{0} m : {1} s : {2} ms",t.getMinutes(),t.getSeconds(),t.getMilliseconds())}function d(e){var t={hierarchy:{}};return E.each(r,(function(r,n){if(e.filterFn(r)){var i=n.split(e.namespaceSeparator),a=i.pop();r.introName=a;for(var s=t.hierarchy,o=0,l=i.length;o<l;o++){var c=i[o];s.hasOwnProperty(c)||(s[c]={}),s=s[c]}var u=s[a];u||(u=s[a]={}),u.mark=r}}),this),t}function p(e){var t={};return E.each(e,(function(e,r){t[r]=e}),this),t}function m(){E.each(r,(function(e){e.calculate()}),this)}function g(e,t){if(!e)return!0;var r=!0,n=_typeof(e);if("string"===n){var i=/avgDurationLimit:\s*(\d+)\s*/.exec(e);if(i){var a=parseInt(i[1],10);r=t.avgDuration>=a}else{r=new RegExp(e,"i").test(t.name)}}else if("function"===n){var s=t.copy();r=e.call(this,s)}return r}function T(e){return g.bind(this,e)}function y(e){if(n=!Ext.isIE,e){var t={showFlat:e.showFlat,showByNamespace:e,namespaceSeparator:e.namespaceSeparator||"_",filterFn:T(e.filter),showAllCalls:!0===e.showAllCalls,hightlightDurationOverflow:!0===e.hightlightDurationOverflow,durationLimit:e.durationLimit||0};m();var i=t.filterFn;if(t.showFlat)E.each(r,(function(e){i(e)&&e.log(t)}),this);else if(t.showByNamespace){!function e(t,r,n){var i=r,a=!1;for(var s in t){if(t.hasOwnProperty("mark")&&!a){var o=t.mark,l=p(n);l.showDisplayName=!1,l.indent=i-1,o.log(l),a=!0}if(t.hasOwnProperty(s)&&"mark"!==s){var c=t[s];h(s,i),e(c,i+1,n)}}}(d(t),0,t)}}else h("config is empty")}l.prototype={name:null,sessionName:null,measurements:null,requiredCalculateProperties:null,durationOverflowHighlightStyle:"color: #f00",clear:function(){for(var e,t=this.measurements;null!=(e=t.pop());)s.clearMarks(e.startTimeMarkName),s.clearMarks(e.endTimeMarkName),s.clearMeasures(e.measureMarkName)},isCalculated:function(){var e=this.measurements;return 0!==e.length&&0===e.filter((function(e){return!1===e.isCalculated}),this).length},isMeasureCalculatable:function(e){return this.requiredCalculateProperties.every((function(t){return e.hasOwnProperty(t)}),this)},isCalculatable:function(){return this.measurements.every((function(e){return this.isMeasureCalculatable(e)}),this)},calculate:function(){if(this.isStopped()&&!this.isCalculated()&&this.isCalculatable()){var e=this.measurements,t=e.length,r=0;e.forEach((function(e){var t=e.measureMarkName;s.measure(t,e.startTimeMarkName,e.endTimeMarkName);var n=s.getEntriesByName(t)[0],i=e.startTime=n.startTime,a=e.duration=n.duration;e.endTime=i+a,e.isCalculated=!0,r+=a}),this),this.avgDuration=Math.floor(r/t),this.time=r}},copy:function(){var e=new l(this.name);return e.avgDuration=this.avgDuration,e.time=this.time,this.measurements.forEach((function(t){var r=e.createMeasure();r.startTime=t.startTime,r.endTime=t.endTime,r.duration=t.duration,r.isCalculated=t.isCalculated,r.isStopped=t.isStopped,delete r.startTimeMarkName,delete r.endTimeMarkName,delete r.measureMarkName}),this),e},createMeasure:function(){var e=this.measurements,t=this.name,r=t+"_"+e.length,n={name:t,startTimeMarkName:r+"_start",endTimeMarkName:r+"_end",measureMarkName:r+"_measure",isStopped:!1,isCalculated:!1,duration:null,startTime:null,endTime:null};return e.push(n),n},getLastMeasure:function(){var e=this.measurements,t=e.length;return 0===t?null:e[t-1]},log:function(e){var t=e||{},r=t.indent||0,n=t.displayName||this.name;!1!==t.showDisplayName&&h(Ext.String.format("{0}:",n),r);(r++,this.sessionName)&&h(Ext.String.format("session: {0}",this.sessionName),r);if(this.isStopped()){var i=this.measurements;this.logMetric({indent:r,name:"avgDuration",value:this.avgDuration,hightlightOverflow:e.hightlightDurationOverflow,limit:e.durationLimit,highlightStyle:this.durationOverflowHighlightStyle}),this.logMetric({indent:r,name:"time",value:this.time}),this.logMetric({indent:r,template:"{0}: {1}{2}",name:"callsCount",value:i.length});var a=p(t);a.indent=r,this.logMeasurements(a)}else h("measurement is not finished",r)},logMeasurements:function(e){if(!0===e.showAllCalls){var t=e.indent,r=t+1;this.measurements.forEach((function(n,i){h("call №"+i,t),this.logMetric({indent:r,name:"duration",value:n.duration,hightlightOverflow:e.hightlightDurationOverflow,limit:e.durationLimit,highlightStyle:this.durationOverflowHighlightStyle}),this.logMetric({indent:r,template:"{0}: {1}{2}",name:"startTime",value:f(n.startTime)}),this.logMetric({indent:r,template:"{0}: {1}{2}",name:"endTime",value:f(n.endTime)})}),this)}},logMetric:function(e){var t=e.template||"{0}: {1}{2}ms",r=n?"%c":"",i=e.name,a=e.value,s=Ext.String.format(t,i,r,a),o="",l=!0===e.hightlightOverflow,c=e.limit||-1;l&&a>=c&&(o=e.highlightStyle||""),h(s,e.indent,o)},isStopped:function(){return!0===(this.getLastMeasure()||{}).isStopped}};var v={getMarksHierarchy:function(e){return m(),d(e)},startSession:function(e){i=!0,a=e},start:function(e){var t=c(e);if(t){if(!t.isStopped())return}else t=function(e){var t=c(e);return t||(t=r[e]=new l(e)),t}(e);i&&(t.sessionName=a);var n=t.createMeasure();s.mark(n.startTimeMarkName)},stop:function(e){var t=c(e);if(t&&!t.isStopped()){var r=t.getLastMeasure();s.mark(r.endTimeMarkName),r.isStopped=!0}},stopSession:function(){i=!1,a=null},clear:function(e){u(e)},clearAll:function(){E.each(r,(function(e,t){u(t)}),this)},getProfileInfo:function(e){var t=p(e||{});t.showFlat=!0,y(t)},getProfileInfoBySession:function(e,t){return function(e){if(e){var t=e.isObject||!1,n={showFlat:!0,namespaceSeparator:e.namespaceSeparator||"_",hightlightDurationOverflow:!1,durationLimit:e.durationLimit||0};m();var i={};return E.each(r,(function(r,a){r.sessionName&&r.sessionName===e.sessionName?(r.log(n),t&&(i[a]=r)):t&&(i[a]=r)}),this),i}}({sessionName:e,isObject:t||!1})},getHierarchyProfileInfo:function(e){var t=p(e||{});t.showFlat=!1,t.showByNamespace=!0,y(t)},setLogObject:function(e){o=e}},E=e.Terrasoft||{};!0!==E.enablePerformanceManager&&(v={start:function(){},startSession:function(){},stop:function(){},stopSession:function(){},clear:function(){},clearAll:function(){},getProfileInfo:function(){},getHierarchyProfileInfo:function(){},setLogObject:function(){},getProfileInfoBySession:function(){},getMarksHierarchy:function(){}}),v.startCounter=function(){},v.stopCounter=function(){},v.startAsyncCounter=function(){},v.stopAsyncCounter=function(){},v.setTimeStamp=function(){},v.clearTimeStamp=function(){},v.clearAllTimeStamps=function(){},v.getTimeStamp=function(){},v.getTimeSpan=function(){};var C=e.define;C&&C(v),e.performanceManager=v}(window),Ext.ns("Terrasoft.router"),Ext.define("Terrasoft.router.BaseNavigationProvider",{extend:"Terrasoft.BaseObject",alternateClassName:"Terrasoft.BaseNavigationProvider",hashRe:null,hashStorage:null,context:null,constructor:function(){this.callParent(arguments),this.addEvents("providerStateChanged"),this.hashRe=/-state\d*/,this.hashStorage={},this.init()},doStateChanged:function(){this.fireEvent("providerStateChanged",this.getHash())},init:function(){this.subscribe(this.context,"popstate",this.onPopState,this)},subscribe:function(e,t,r,n){function i(){r.apply(n,arguments)}e.addEventListener?e.addEventListener(t,i):e.attachEvent("on"+t,i)},onPopState:Terrasoft.emptyFn,getHash:function(){var e=this.context.location.href,t=(e=e.replace(this.hashRe,"")).indexOf("#");return t>=0?e.substr(t+1):""},getFullUrl:function(e){if(_.contains(e,"#"))return e;var t=this.context.location.href,r=t.indexOf("#");return""!==e&&(e="#"+e),(r>=0?t.substr(0,r):t)+e},back:function(){},forward:function(){},go:function(){}}),Ext.ns("Terrasoft.router"),Ext.define("Terrasoft.router.HistoryNavigationProvider",{extend:"Terrasoft.BaseNavigationProvider",alternateClassName:"Terrasoft.HistoryNavigationProvider",pushState:function(e,t,r){this.context.history.pushState(e,t,this.getFullUrl(r)),this.doStateChanged()},replaceState:function(e,t,r){this.context.history.replaceState(e,t,this.getFullUrl(r)),this.doStateChanged()},back:function(){this.go(-1)},forward:function(){this.go(1)},go:function(e){this.context.history.go(e)},onPopState:function(){this.doStateChanged()}}),Ext.ns("Terrasoft.router"),Terrasoft.isAngularHost&&Ext.define("Terrasoft.router.AngularHistoryNavigationProvider",{extend:"Terrasoft.BaseNavigationProvider",alternateClassName:"Terrasoft.AngularHistoryNavigationProvider",pushState:function(e,t,r){this.context.historyWrapper.pushState(e,t,this.getFullUrl(r)),this.doStateChanged()},replaceState:function(e,t,r){this.context.historyWrapper.replaceState(e,t,this.getFullUrl(r)),this.doStateChanged()},back:function(){this.go(-1)},forward:function(){this.go(1)},go:function(e){this.context.historyWrapper.go(e)},onPopState:function(){}}),Ext.ns("Terrasoft.router"),Ext.define("Terrasoft.router.HashNavigationProvider",{extend:"Terrasoft.BaseNavigationProvider",alternateClassName:"Terrasoft.HashNavigationProvider",init:function(){this.callParent(arguments),this.processHash()},pushState:function(e,t,r){var n=this.hashStorage[r],i=n?n+1:1;this.hashStorage[r]=i;var a="/"+r+"-state"+i;this.context.history.pushState(e,t,a),this.doStateChanged()},replaceState:function(e,t,r){var n=this.hashStorage[r],i="/"+r+"-state"+(n||1);this.context.history.replaceState(e,t,i),this.doStateChanged()},processHash:function(){var e=/(.*)-state(\d+)$/g.exec(this.context.location.hash);if(e&&e[1]&&e[2]){var t=e[1].replace("#","");this.hashStorage[t]=Number(e[2])}},back:function(){this.context.history.back()},forward:function(){this.go(1)},go:function(e){this.context.history.go(e)}}),Ext.ns("Terrasoft.router"),Ext.define("Terrasoft.router.IeFamilyHistoryNavigationProvider",{extend:"Terrasoft.HistoryNavigationProvider",alternateClassName:"Terrasoft.IeFamilyHistoryNavigationProvider",_lastHash:null,init:function(){this.callParent(arguments),this.subscribe(this.context,"hashchange",this.onHashChange,this)},onHashChange:function(){this.getHash()!==this._lastHash&&this.doStateChanged()},doStateChanged:function(){this.callParent(arguments),this._lastHash=this.getHash()}}),Ext.ns("Terrasoft.router"),Ext.define("Terrasoft.router.Router",{extend:"Terrasoft.BaseObject",alternateClassName:"Terrasoft.Router",singleton:!0,silentMode:!1,provider:null,context:window,_defaultProviderClassName:Terrasoft.isAngularHost?"Terrasoft.router.AngularHistoryNavigationProvider":"Terrasoft.router.HistoryNavigationProvider",_ieFamilyProviderClassName:"Terrasoft.IeFamilyHistoryNavigationProvider",constructor:function(){this.callParent(arguments),this.addEvents("stateChanged"),this.initProvider()},initProvider:function(){var e=this._getProviderClassName(),t=Ext.create(e,{context:this.context});t.on("providerStateChanged",this.onProviderStateChanged,this),this.provider=t},_getProviderClassName:function(){return Ext.isIEOrEdge?this._ieFamilyProviderClassName:this._defaultProviderClassName},onProviderStateChanged:function(e){Ext.isEmpty(e)&&this.warning("router: Empty navigation token"),!0!==this.silentMode?this.fireEvent("stateChanged",e,this):this.silentMode=!1},getHash:function(){return this.provider.getHash()},pushState:function(e,t,r,n){if(t)throw new Terrasoft.NotImplementedException({message:Terrasoft.Resources.Router.PageTitleNotImplementedMessage});void 0===e&&(e={}),this.silentMode=!0===n,this.provider.pushState(e,t,r)},replaceState:function(e,t,r,n){if(t)throw new Terrasoft.NotImplementedException({message:Terrasoft.Resources.Router.PageTitleNotImplementedMessage});void 0===e&&(e={}),this.silentMode=!0===n,this.provider.replaceState(e,t,r)},setContext:function(e){if(this.context!==e){var t=this.provider;"onpopstate"in e?(t.un("popstate",t.doStateChanged,t),t.subscribe(e,"popstate",t.doStateChanged,t)):"onhashchange"in e&&(t.un("hashchange",t.doStateChanged,t),t.subscribe(e,"hashchange",t.doStateChanged,t)),this.context=t.context=e}},back:function(){this.provider.back()},forward:function(){this.provider.go(1)},go:function(e){this.provider.go(e)},getState:function(){return this.context.history.state}}),Ext.ns("Terrasoft.cron"),Terrasoft.cron.Parameters={Seconds:0,Minutes:1,Hours:2,DayOfMonth:3,Month:4,DayOfWeek:5,Year:6},Ext.define("Terrasoft.manager.CronExpression",{alternateClassName:"Terrasoft.CronExpression",statics:{create:function(){return Terrasoft.CronExpression.from("0 * * ? * ? *")},from:function(e){var t=Ext.create("Terrasoft.CronExpression");return Ext.isArray(e)?t=Ext.create("Terrasoft.CronExpression",{parameters:e}):Ext.isString(e)&&(t=Ext.create("Terrasoft.CronExpression",{expression:e})),t},validate:function(e,t){var r={};try{r=Terrasoft.CronExpression.from(e).validate(t)}catch(e){r.error=e.message,r.isValid=!1}return r}},_cronParametersSeparator:" ",_cronParametersEnumeratorSymbol:",",_cronParameters:[],constructor:function(e){if(e){var t=e.expression,r=e.parameters,n=[];if(r)n=r;else if(t){var i=Ext.create("Terrasoft.CronExpressionParser"),a=i.parse(t);if(a)n=a;else n=i.getParsingInfo().parsingParameters}this.fillFromArray(n)}},setParameter:function(e,t){this._cronParameters[e]=t},setWeekDayOrdinalInfo:function(e,t){var r=Ext.String.format("{0}#{1}",e,t);this.setParameter(Terrasoft.cron.Parameters.DayOfWeek,r)},normalize:function(){var e=Ext.create("Terrasoft.CronExpressionParser").normalize(this._cronParameters);return Ext.create("Terrasoft.CronExpression",{parameters:e})},getParameter:function(e){return this._cronParameters[e]},getIsParameterDefault:function(e){var t=Terrasoft.CronExpression.create().getParameter(e);return this.getParameter(e)===t},getDayOfWeekOrdinalInfo:function(){var e=this.getParameter(Terrasoft.cron.Parameters.DayOfWeek).match(/(\d#\d)/),t=null;if(!Ext.isEmpty(e)){var r=e[1].split("#");t={dayOfWeek:r[0],order:r[1]}}return t},getLastWeekDay:function(){var e=this.getParameter(Terrasoft.cron.Parameters.DayOfWeek).match(/(\dL)/);if(Ext.isEmpty(e))throw new Terrasoft.ItemNotFoundException;return e[1].split("L")[0]},hasOnlyCalendarValues:function(){return/^\d+$/.test(this.getParameter(Terrasoft.cron.Parameters.DayOfMonth))},hasLastWeekDay:function(){return Terrasoft.includes(this.getParameter(Terrasoft.cron.Parameters.DayOfWeek),"L")},hasLastDayOfMonth:function(){return Terrasoft.includes(this.getParameter(Terrasoft.cron.Parameters.DayOfMonth),"L")},hasWorkDays:function(){return Terrasoft.includes(this.getParameter(Terrasoft.cron.Parameters.DayOfMonth),"W")},setStartTime:function(e){var t=e.getHours(),r=e.getMinutes();this.setParameter(Terrasoft.cron.Parameters.Hours,t.toString()),this.setParameter(Terrasoft.cron.Parameters.Minutes,r.toString())},getStartTime:function(){return new Date(0,0,0,this.getParameter(Terrasoft.cron.Parameters.Hours),this.getParameter(Terrasoft.cron.Parameters.Minutes))},setInterval:function(e,t,r){this.setParameter(e,Ext.String.format("{0}-{1}",t,r))},getInterval:function(e){var t=this.getParameter(e).match(/(.*)-(.*)/);return{start:Number(t[1]),end:Number(t[2])}},getIsParameterEmpty:function(e){return 0===Number(this.getParameter(e))},setIntervalWithPeriod:function(e,t){var r=Ext.String.format("{0}-{1}/{2}",t.start,t.end,t.period);this.setParameter(e,r)},getIntervalWithPeriod:function(e){var t=this.getParameter(e).match(/((.*)-(.*)(?=\/))\/(.*)/);return{start:Number(t[2]),end:Number(t[3]),period:Number(t[4])}},getRepetitionPeriod:function(e){var t=this.getParameter(e).match(/\/([^\/]+)/);return Ext.isEmpty(t)?null:parseInt(t[1],10)},setRepetitionPeriod:function(e,t){this.setParameter(e,Ext.String.format("*/{0}",t))},setWeekDays:function(e){this.setParameter(Terrasoft.cron.Parameters.DayOfWeek,e.join(this._cronParametersEnumeratorSymbol))},setLastWeekDay:function(e){var t=Ext.String.format("{0}L",e);this.setParameter(Terrasoft.cron.Parameters.DayOfWeek,t)},setLastDayOfMonth:function(){this.setParameter(Terrasoft.cron.Parameters.DayOfMonth,"L")},setDayOfMonth:function(e){this.setParameter(Terrasoft.cron.Parameters.DayOfMonth,e)},setWorkDayPositionInMonth:function(e){var t=Ext.String.format("{0}W",e);this.setParameter(Terrasoft.cron.Parameters.DayOfMonth,t)},setLastWorkDayInMonth:function(){this.setWorkDayPositionInMonth("L")},getWeekDays:function(){var e=this.getParameter(Terrasoft.cron.Parameters.DayOfWeek);return"*"===e?[1,2,3,4,5,6,7]:e.split(this._cronParametersEnumeratorSymbol).map((function(e){return Number(e)}),this)},fillFromArray:function(e){this._cronParameters=e.slice()},isValid:function(){return Terrasoft.CronExpression.validate(this.toString()).isValid},validate:function(e){var t=Ext.create("Terrasoft.CronExpressionParser");return t.parse(this.toString(),e)?{error:"",isValid:!0}:t.getParsingInfo()},toArray:function(){return this._cronParameters.slice()},toString:function(){return this._cronParameters.join(this._cronParametersSeparator)}}),Ext.define("Terrasoft.manager.CronExpressionParser",{alternateClassName:"Terrasoft.CronExpressionParser",_dayOfWeek:["SUN","MON","TUE","WED","THU","FRI","SAT"],_month:["JAN","FEB","MAR","APR","MAY","JUN","JUL","AUG","SEP","OCT","NOV","DEC"],_allowedSecondsValue:"0",_maximumYearValue:2099,_defaultYear:"*",_isYearRegex:/\d{4}$/,_replaceMultipleSpacesRegex:/\s\s+/g,_specialSymbolsRegexp:/^[^\*\-\,]+$/,_numberExtractorRegex:/\d+/g,_baseTimeSymbolsRegex:/^([\,\-\*\/]|\d)+$/,_dayOfMonthRegex:/^([\,\-\*\/\?LW]|\d)+$/,_dayOfWeekRegex:/^([\,\-\*\/\?L\#]|\d)+$/,_parametersSeparator:" ",_parsedExpression:null,_parsingParameters:null,_parsingInfo:null,_normalizeTimePrefix:function(e){return Ext.String.startsWith(e,"0/")?e.replace("0/","*/"):e},_normalizeDatePrefix:function(e){return Ext.String.startsWith(e,"1/")?e.replace("1/","*/"):e},_normalizeDays:function(e){for(var t=0;t<=6;t++){var r=this._dayOfWeek[t];e[5]=e[5].replace(r,t+1)}},_normalizeMonth:function(e){for(var t=0;t<12;t++){var r=this._month[t];e[4]=e[4].replace(r,t+1)}},_normalizeRanges:function(e){for(var t=0;t<e.length;t++)if("*/1"===e[t]&&(e[t]="*"),Terrasoft.includes(e[t],"/")&&this._specialSymbolsRegexp.test(e[t])){var r=null;switch(t){case 4:r="12";break;case 5:r="6";break;case 6:r=this._maximumYearValue;break;default:r=null}if(null!=r){var n=e[t].split("/");e[t]=Ext.String.format("{0}-{1}/{2}",n[0],r,n[1])}}},_normalizeTime:function(e){for(var t=0;t<=2;t++)e[t]=this._normalizeTimePrefix(e[t])},_normalizeDate:function(e){for(var t=3;t<=6;t++)e[t]=this._normalizeDatePrefix(e[t])},_normalizeExpression:function(e){this._normalizeTime(e),this._normalizeDate(e),this._normalizeDays(e),this._normalizeMonth(e),this._normalizeRanges(e)},_prepareExpressionParameters:function(e){var t=e.replace(this._replaceMultipleSpacesRegex,this._parametersSeparator).split(this._parametersSeparator);return t=t.filter((function(e){return!Ext.isEmpty(e)})),this._parsingParameters=t,t},_validateRange:function(e,t,r,n){if(e<t||e>r)throw Terrasoft.InvalidFormatException({message:Ext.String.format(Terrasoft.Resources.Cron.ValueOutOfRangeException,n,e,t,r)})},_validateNumberRanges:function(e,t,r,n){var i=this._extractNumbers(e);i&&i.forEach((function(e){this._validateRange(e,t,r,n)}),this)},_validateSymbols:function(e,t,r){if(!t.test(e))throw Terrasoft.InvalidFormatException({message:Ext.String.format(Terrasoft.Resources.Cron.InvalidSymbolsException,r,e)})},_extractNumbers:function(e){return e.match(this._numberExtractorRegex)},_validateSeconds:function(e){var t=Terrasoft.Resources.Cron.Parameters.Seconds;this._validateSymbols(e,this._baseTimeSymbolsRegex,t),this._validateNumberRanges(e,0,59,t)},_validateMinutes:function(e,t){"*"===e&&t&&(e="1"),t=t||{};var r=Terrasoft.Resources.Cron.Parameters.Minutes;this._validateSymbols(e,this._baseTimeSymbolsRegex,r),this._validateNumberRanges(e,t.min||0,t.max||59,r)},_validateHours:function(e){var t=Terrasoft.Resources.Cron.Parameters.Hours;this._validateSymbols(e,this._baseTimeSymbolsRegex,t),this._validateNumberRanges(e,0,23,t)},_validateDayOfMonth:function(e){var t=Terrasoft.Resources.Cron.Parameters.DaysOfMonth;this._validateSymbols(e,this._dayOfMonthRegex,t),this._validateNumberRanges(e,1,31,t)},_validateMonth:function(e){var t=Terrasoft.Resources.Cron.Parameters.Months;this._validateSymbols(e,this._baseTimeSymbolsRegex,t),this._validateNumberRanges(e,1,12,t)},_validateDayOfWeek:function(e){var t=Terrasoft.Resources.Cron.Parameters.DaysOfWeek;this._validateSymbols(e,this._dayOfWeekRegex,t),this._validateNumberRanges(e,1,7,t)},_validateYear:function(e){var t=Terrasoft.Resources.Cron.Parameters.Years;this._validateSymbols(e,this._baseTimeSymbolsRegex,t),this._validateNumberRanges(e,0,this._maximumYearValue,t)},_validateDayOfParameters:function(e,t){if("?"!==e&&"?"!==t)throw Terrasoft.InvalidFormatException({message:Ext.String.format(Terrasoft.Resources.Cron.DayOfNotImplementedException,e,t)})},_validateExpression:function(e,t){this._validateSeconds(e[0]),this._validateMinutes(e[1],t&&t.minutes),this._validateHours(e[2]),this._validateDayOfMonth(e[3]),this._validateMonth(e[4]),this._validateDayOfWeek(e[5]),this._validateYear(e[6]),this._validateDayOfParameters(e[3],e[5])},_normalizeLength:function(e){var t=e.length;switch(t){case 5:e.unshift(this._allowedSecondsValue),e.push(this._defaultYear);break;case 6:var r=e[5];this._isYearRegex.test(r)?e.unshift(this._allowedSecondsValue):e.push(this._defaultYear);break;default:if(t<5)throw new Terrasoft.InvalidFormatException({message:Ext.String.format(Terrasoft.Resources.Cron.ShortCronException,t)});if(t>7)throw new Terrasoft.InvalidFormatException({message:Ext.String.format(Terrasoft.Resources.Cron.LongCronException,t)})}},parse:function(e,t){var r=null;this._parsingInfo={isValid:!0,error:"",parsingParameters:[]};try{if(Ext.isEmpty(e))throw new Terrasoft.InvalidFormatException({message:Terrasoft.Resources.Exception.NullOrEmptyException});var n=this._prepareExpressionParameters(e.slice()),i=this.normalize(n);this._validateExpression(i,t),this._parsedExpression=i,r=this._parsedExpression,this._parsingInfo.parsingParameters=this._parsedExpression}catch(e){this._parsingInfo={isValid:!1,error:e.message,parsingParameters:this._parsingParameters}}return r},normalize:function(e){var t=e.slice();return this._normalizeLength(t),this._normalizeExpression(t),t},getCronObject:function(){return Ext.create("Terrasoft.CronExpression",{parameters:this.getCronParameters()})},getCronParameters:function(){return this._parsedExpression},getParsingInfo:function(){return this._parsingInfo},toString:function(){return this._parsedExpression.join(this._parametersSeparator)}}),Ext.define("Terrasoft.manager.CronExpressionDescriptor",{alternateClassName:"Terrasoft.CronExpressionDescriptor",statics:{describe:function(e,t){var r=null;e.isValid()&&(r=Ext.create("Terrasoft.CronExpressionDescriptor",{parameters:e.toArray(),use24HourTimeFormat:t&&t.use24HourTimeFormat}).tryGetFullDescription());return r}},resources:Terrasoft.Resources.Cron.Descriptor,_wordsSeparator:", ",_valueSeparator:",",_space:" ",_use24HourTimeFormat:null,_expressionParts:null,_dayNames:[],_convertNumberToDay:function(e){return this._dayNames[e-1]},_convertNumberToMonth:function(e){return Terrasoft.Resources.CultureSettings.monthNames[e-1]},_transformVerbosity:function(e){return e=(e=(e=e.replace(new RegExp(this.resources.ComaEveryMinute,"g"),"")).replace(new RegExp(this.resources.ComaEveryHour,"g"),"")).replace(new RegExp(this.resources.ComaEveryDay,"g"),"")},_generateBetweenSegmentDescription:function(e,t,r,n){var i="",a=e.split("-"),s=r.call(n,a[0]),o=r.call(n,a[1]);o=o.replace(":00",":59");var l=t.call(n,e);return i+=Ext.String.format(l,s,o)},_formatTime:function(e,t,r){var n="";this._use24HourTimeFormat||(n=e>=12?" PM":" AM",e>12&&(e-=12));var i="";return r&&(i=Ext.String.format(":{0}",Terrasoft.pad(r,2,"0"))),Ext.String.format("{0}:{1}{2}{3}",Terrasoft.pad(e,2,"0"),Terrasoft.pad(t,2,"0"),i,n)},_normalizeCronForDescription:function(){var e=this._expressionParts;e[3]=e[3].replace("?","*"),e[5]=e[5].replace("?","*")},_prepareDayNames:function(){var e=Terrasoft.Resources.DayNames;this._dayNames=[e.Sunday,e.Monday,e.Tuesday,e.Wednesday,e.Thursday,e.Friday,e.Saturday]},constructor:function(e){this.callParent(arguments),this._expressionParts=e.parameters,this._use24HourTimeFormat=Ext.isEmpty(e.use24HourTimeFormat)?this._getIsCurrentCultureIn24HourTimeFormat():e.use24HourTimeFormat,this._prepareDayNames()},_getIsCurrentCultureIn24HourTimeFormat:function(){return"en-US"!==Terrasoft.Resources.CultureSettings.currentCultureName},tryGetFullDescription:function(){var e;try{this._normalizeCronForDescription(),e=Ext.String.format("{0}{1}{2}{3}{4}",this.getTimeOfDayDescription(),this.getDayOfMonthDescription(),this.getDayOfWeekDescription(),this.getMonthDescription(),this.getYearDescription()),e=(e=this._transformVerbosity(e)).charAt(0).toLocaleUpperCase()+e.substr(1)}catch(e){throw new Terrasoft.InvalidFormatException({message:e.message})}return e},getTimeOfDayDescription:function(){var e=this._expressionParts[0],t=this._expressionParts[1],r=this._expressionParts[2],n="",i=/^[^\/*\-,]+$/,a=i.test(t),s=i.test(r),o=i.test(e),l=Terrasoft.includes(t,"-"),c=Terrasoft.includes(t,this._valueSeparator),u=Terrasoft.includes(r,this._valueSeparator),h=Terrasoft.includes(r,"-");if(a&&s&&o)n+=this.resources.AtSpace+this._formatTime(r,t,e);else if(l&&!c&&s){var f=t.split("-"),d=this._formatTime(r,f[0]),p=this._formatTime(r,f[1]);n+=Ext.String.format(this.resources.EveryMinuteBetweenX0AndX1,d,p)}else if(u&&!h&&a){var m=r.split(this._valueSeparator);n+=this.resources.At;for(var g=0;g<m.length;g++)n+=this._space+this._formatTime(m[g],t),g<m.length-2&&(n+=this._valueSeparator),g===m.length-2&&(n+=this.resources.SpaceAnd)}else{var T=this.getSecondsDescription(),y=this.getMinutesDescription(),v=this.getHoursDescription();n+=T,Ext.isEmpty(n)||(n+=this._wordsSeparator),n+=y,Ext.isEmpty(n)||(n+=this._wordsSeparator),n+=v}return n},getMinutesDescription:function(){return this._getSegmentDescription({expression:this._expressionParts[1],allDescription:this.resources.EveryMinute,getSingleItemDescription:function(e){return e},getIntervalDescriptionFormat:function(e){return Ext.String.format(this.resources.EveryX0Minutes,e)},getBetweenDescriptionFormat:function(){return this.resources.MinutesX0ThroughX1PastTheHour},getDescriptionFormat:function(e){return"0"===e?"":this.resources.AtX0MinutesPastTheHour},scope:this})},getSecondsDescription:function(){return this._getSegmentDescription({expression:this._expressionParts[0],allDescription:this.resources.EverySecond,getSingleItemDescription:function(e){return e},getIntervalDescriptionFormat:function(e){return Ext.String.format(this.resources.EveryX0Seconds,e)},getBetweenDescriptionFormat:function(){return this.resources.SecondsX0ThroughX1PastTheMinute},getDescriptionFormat:function(e){return"0"===e?"":this.resources.AtX0SecondsPastTheMinute},scope:this})},getHoursDescription:function(){return this._getSegmentDescription({expression:this._expressionParts[2],allDescription:this.resources.EveryHour,getSingleItemDescription:function(e){return this._formatTime(e,"0")},getIntervalDescriptionFormat:function(e){return Ext.String.format(this.resources.EveryX0Hours,e)},getBetweenDescriptionFormat:function(){return this.resources.BetweenX0AndX1},getDescriptionFormat:function(){return this.resources.AtX0},scope:this})},getDayOfWeekDescription:function(){return"*"===this._expressionParts[5]&&"*"!==this._expressionParts[3]?"":this._getSegmentDescription({expression:this._expressionParts[5],allDescription:this.resources.ComaEveryDay,getSingleItemDescription:function(e){var t=e;return Terrasoft.includes(e,"#")?t=e.slice(0,e.indexOf("#")):Terrasoft.includes(e,"L")&&(t=t.replace("L","")),this._convertNumberToDay(t)},getIntervalDescriptionFormat:function(e){return Ext.String.format(this.resources.ComaEveryX0DaysOfTheWeek,e)},getBetweenDescriptionFormat:function(){return this.resources.ComaX0ThroughX1},getDescriptionFormat:function(e){var t;if(Terrasoft.includes(e,"#")){var r=null;switch(e.substring(e.indexOf("#")+1)){case"1":r=this.resources.First;break;case"2":r=this.resources.Second;break;case"3":r=this.resources.Third;break;case"4":r=this.resources.Forth;break;case"5":r=this.resources.Fifth}t=Ext.String.format("{0}{1}{2}",this.resources.ComaOnThe,r,this.resources.SpaceX0OfTheMonth)}else t=Terrasoft.includes(e,"L")?this.resources.ComaOnTheLastX0OfTheMonth:this.resources.ComaOnlyOnX0;return t},scope:this})},getMonthDescription:function(){return this._getSegmentDescription({expression:this._expressionParts[4],allDescription:"",getSingleItemDescription:this._convertNumberToMonth,getIntervalDescriptionFormat:function(e){return Ext.String.format(this.resources.ComaEveryX0Months,e)},getBetweenDescriptionFormat:function(){return this.resources.ComaX0ThroughX1},getDescriptionFormat:function(){return this.resources.ComaOnlyInX0},scope:this})},getDayOfMonthDescription:function(){var e,t=this._expressionParts[3];switch(t){case"L":e=this.resources.ComaOnTheLastDayOfTheMonth;break;case"WL":case"LW":e=this.resources.ComaOnTheLastWeekdayOfTheMonth;break;default:var r=/(\d{1,2}W)|(W\d{1,2})/;if(r.test(t)){var n=Terrasoft.first(t.match(r)).replace("W",""),i=Ext.String.format(this.resources.WeekdayNearestDayX0,n),a="1"===n?this.resources.FirstWeekday:i;e=Ext.String.format(this.resources.ComaOnTheX0OfTheMonth,a)}else e=this._getSegmentDescription({expression:t,allDescription:this.resources.ComaEveryDay,getSingleItemDescription:function(e){return e},getIntervalDescriptionFormat:function(e){return"1"===e?this.resources.ComaEveryDay:this.resources.ComaEveryX0Days},getBetweenDescriptionFormat:function(){return this.resources.ComaBetweenDayX0AndX1OfTheMonth},getDescriptionFormat:function(){return this.resources.ComaOnDayX0OfTheMonth},scope:this})}return e},getYearDescription:function(){return this._getSegmentDescription({expression:this._expressionParts[6],allDescription:"",getSingleItemDescription:function(e){return e},getIntervalDescriptionFormat:function(e){return Ext.String.format(this.resources.ComaEveryX0Years,e)},getBetweenDescriptionFormat:function(){return this.resources.ComaX0ThroughX1},getDescriptionFormat:function(){return this.resources.ComaOnlyInX0},scope:this})},_getSegmentDescription:function(e){var t,r,n=e.expression,i=e.allDescription,a=e.getSingleItemDescription,s=e.getIntervalDescriptionFormat,o=e.getBetweenDescriptionFormat,l=e.getDescriptionFormat,c=e.scope,u=null;if(Ext.isEmpty(n))u="";else if("*"===n)u=i;else if(/^[^\/\-,]+$/.test(n))u=Ext.String.format(l.call(c,n),a.call(c,n));else if(Terrasoft.includes(n,"/")){if(r=n.split("/"),u=Ext.String.format(s.call(c,r[1]),a.call(c,r[1])),Terrasoft.includes(r[0],"-"))t=this._generateBetweenSegmentDescription(r[0],o,a,this),Ext.String.startsWith(t,this._wordsSeparator)||(u+=this._wordsSeparator),u+=t;else if(/^[^*,]+$/.test(r[0])){var h=Ext.String.format(l.call(c,r[0]),a.call(c,r[0]));h=h.replace(this._wordsSeparator,""),u+=Ext.String.format(this.resources.CommaStartingX0,h)}}else if(Terrasoft.includes(n,this._valueSeparator)){r=n.split(this._valueSeparator);for(var f="",d=0;d<r.length;d++)d>0&&r.length>2&&(f+=this._valueSeparator,d<r.length-1&&(f+=this._space)),d>0&&r.length>1&&(d===r.length-1||2===r.length)&&(f+=this.resources.SpaceAndSpace),Terrasoft.includes(r[d],"-")?f+=t=(t=this._generateBetweenSegmentDescription(r[d],(function(){return this.resources.ComaX0ThroughX1}),a,this)).replace(this._wordsSeparator,""):f+=a.call(c,r[d]);u=Ext.String.format(l.call(c,n),f)}else Terrasoft.includes(n,"-")&&(u=this._generateBetweenSegmentDescription(n,o,a,this));return u}}),Ext.define("Terrasoft.core.collections.BaseCollection",{extend:"Terrasoft.core.BaseObject",alternateClassName:"Terrasoft.BaseCollection",checkDuplicates:function(e){if(this.contains(e))throw new Terrasoft.ItemAlreadyExistsException({message:Terrasoft.Resources.Collection.ItemWithKey+' "'+e+'" '+Terrasoft.Resources.Collection.AlreadyExists})},isEmpty:Terrasoft.abstractFn,getCount:Terrasoft.abstractFn,get:Terrasoft.abstractFn,getByIndex:Terrasoft.abstractFn,indexOf:Terrasoft.abstractFn,find:Terrasoft.abstractFn,add:function(e){this.checkDuplicates(e)},remove:Terrasoft.abstractFn,removeByKey:Terrasoft.abstractFn,removeByIndex:Terrasoft.abstractFn,contains:Terrasoft.abstractFn,each:Terrasoft.abstractFn,eachKey:Terrasoft.abstractFn,clear:Terrasoft.abstractFn,onDestroy:function(){this.clear(),this.callParent(arguments)}}),Ext.define("Terrasoft.core.mixins.Sortable",{alternateClassName:"Terrasoft.Sortable",sortDirection:Terrasoft.OrderDirection.ASC,sortProperty:"Name",getDefaultSortFn:function(e){return function(t,r){var n=t[e],i=r[e];return n===i?0:null===n?1:null===i||n<i?-1:1}},generateSortFn:function(e,t,r){var n,i=(t||this.sortDirection)===Terrasoft.OrderDirection.ASC?1:-1;if(r)n=r;else{var a=e||this.sortProperty;n=this.getDefaultSortFn(a)}return function(e,t){return i*n(e,t)}},sort:function(e,t,r){return r=this.generateSortFn(e,t,r),this.sortByFn(r),this}}),Ext.define("Terrasoft.core.mixins.Filterable",{alternateClassName:"Terrasoft.Filterable",startWithRE:"^{test_string}",containRE:"{test_string}",filterType:Terrasoft.StringFilterType.START_WITH,sortByStartWith:function(e,t,r,n){if(e&&e.getCount()>0&&n===Terrasoft.StringFilterType.CONTAIN){var i=this.generateFilterFn(t,r,Terrasoft.StringFilterType.START_WITH),a=this.filterByFn(i);Terrasoft.each(a,(function(t,r){var n=e.indexOf(t);e.move(n,r)}),this)}},getDefaultFilterFn:function(e,t){return function(r){var n=r[e];return t.test(n)}},generateFilterFn:function(e,t,r){t=Ext.String.escapeRegex(t);var n=(r||this.filterType)===Terrasoft.StringFilterType.START_WITH?this.startWithRE:this.containRE;n=n.replace("{test_string}",t);var i=new RegExp(n,"i");return this.getDefaultFilterFn(e,i)},filter:function(e,t,r){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{sortByStartWith:!0};if(1===arguments.length&&Ext.isFunction(arguments[0]))return this.filterByFn(arguments[0]);var i=this.generateFilterFn(e,t,r),a=this.filterByFn(i);return(null==n?void 0:n.sortByStartWith)&&this.sortByStartWith(a,e,t,r),a}}),Ext.ns("Terrasoft.utils.common.json"),Terrasoft.utils.common.json.encode=function(e){try{return Ext.encode(e)}catch(e){throw new Terrasoft.UnknownException({message:Terrasoft.Resources.Json.EncodeExceptionMessage})}},Terrasoft.encode=Terrasoft.utils.common.json.encode,Terrasoft.utils.common.json.encodeDate=function(e){if(!Ext.isDate(e))throw new Terrasoft.UnknownException({message:Terrasoft.Resources.Json.EncodeExceptionMessage});try{return'"'+Terrasoft.pad(e.getFullYear(),4)+"-"+Terrasoft.pad(e.getMonth()+1,2)+"-"+Terrasoft.pad(e.getDate(),2)+"T"+Terrasoft.pad(e.getHours(),2)+":"+Terrasoft.pad(e.getMinutes(),2)+":"+Terrasoft.pad(e.getSeconds(),2)+"."+Terrasoft.pad(e.getMilliseconds(),3)+'"'}catch(e){throw new Terrasoft.UnknownException({message:Terrasoft.Resources.Json.EncodeExceptionMessage})}},Terrasoft.encodeDate=Terrasoft.utils.common.json.encodeDate,Terrasoft.utils.common.json.decode=function(e){if(!Ext.isString(e))return e;try{return Ext.decode(e)}catch(e){throw new Terrasoft.UnknownException({message:Terrasoft.Resources.Json.DecodeExceptionMessage})}},Terrasoft.decode=Terrasoft.utils.common.json.decode,Terrasoft.utils.common.json.decodeLocalizableString=function(e){var t=Ext.create("Terrasoft.LocalizableString");return Terrasoft.each(e,(function(e,r){t.setCultureValue(r,e)}),this),t},Terrasoft.decodeLocalizableString=Terrasoft.utils.common.json.decodeLocalizableString,Terrasoft.utils.common.json.deserializeObject=function(e){var t={};return Terrasoft.each(e,(function(r,n){var i=r;if(Ext.isObject(r)){var a=Terrasoft.utils.common.json.deserializeObject(r);i=Terrasoft.getItemByConfig(a)}else Ext.isArray(r)?(i=[],Terrasoft.each(r,(function(e,t){var r=Terrasoft.utils.common.json.deserializeObject(e);i[t]=Terrasoft.getItemByConfig(r)}))):"dateValue"===n&&(i=Terrasoft.parseDate(i),n="value",delete e.value);t[n]=i})),t},Terrasoft.utils.common.json.deserialize=function(e){var t=Ext.isString(e)?Terrasoft.decode(e):e;return Terrasoft.utils.common.json.deserializeObject({result:t}).result},Terrasoft.deserialize=Terrasoft.utils.common.json.deserialize,Terrasoft.utils.common.json.isItemConfig=function(e){return Ext.isObject(e)&&!Ext.isEmpty(e.name)},Terrasoft.isItemConfig=Terrasoft.utils.common.json.isItemConfig,Terrasoft.iterateChildItems=function(e,t,r){var n=!0;return Terrasoft.each(e,(function(i,a){if(Ext.isArray(i)||Ext.isObject(i)){var s=Ext.isArray(i)?i:[i];Terrasoft.each(s,(function(i){if(!this.isItemConfig(s[0]))return!1;var o=!1!==Terrasoft.iterateChildItems(i,t,r),l={item:i,propertyName:a,parent:e,childIterationResult:o};return n=!1!==t.call(r,l)&&o}),this)}return n}),this),n},Terrasoft.utils.common.json.iterateChildItems=Terrasoft.iterateChildItems,Ext.define("Terrasoft.core.mixins.Serializable",{alternateClassName:"Terrasoft.Serializable",getSerializableProperty:function(e){if(!Ext.isObject(e)&&!Ext.isArray(e))return e;if(Ext.isFunction(e.getSerializableObject)){var t={};return e.serializationInfo=this.serializationInfo,e.getSerializableObject(t,this.serializationInfo),delete e.serializationInfo,t}var r=Ext.isArray(e)?[]:{};return Terrasoft.each(e,(function(e,t){var n=!Ext.isEmpty(e)&&Ext.isFunction(e.getSerializableObject)?e:this;r[t]=n.getSerializableProperty(e)}),this),r},getSerializableObject:Terrasoft.abstractFn,serialize:function(e){var t={};return this.serializationInfo=e||this.serializationInfo||{},this.getSerializableObject(t,this.serializationInfo),delete this.serializationInfo,Terrasoft.encode(t)},getDefSerializationInfo:function(){return{serializeFilterManagerInfo:!1}},setSerializableProperty:function(e,t){var r=this[t];Ext.isEmpty(r)||Ext.isFunction(r)||(e[t]=this.getSerializableProperty(r))}}),Ext.define("Terrasoft.core.collections.Collection",{extend:"Terrasoft.core.collections.BaseCollection",alternateClassName:"Terrasoft.Collection",mixins:{sortable:"Terrasoft.Sortable",filterable:"Terrasoft.Filterable"},collection:null,observableEvents:["add","remove","dataLoaded","clear","move","replace","changed","sorted"],clone:function(){var e=new this.self;return e.collection=this.collection.clone(),e},getKey:null,sortByFn:function(e,t){_toConsumableArray(this.collection.keys);this.collection.sortBy(e.bind(t||window)),this.collection.each((function(e){delete e.$extCollectionIndex}))},filterByFn:function(e,t){var r=new this.self;return r.collection=this.collection.filterBy(e,t),r},findByFn:function(e,t){var r=this.getItems();return _.find(r,e,t)},map:function(e,t){var r=this.getItems(),n=new this.self;return Terrasoft.each(r,(function(r,i){var a=e.call(t,r,i);n.add(i,a)}),this),n},mapArray:function(e,t){var r=this.getItems(),n=[];return Terrasoft.each(r,(function(r,i){var a=e.call(t,r,i);n.push(a)}),this),n},mapArrayByPath:function(e){return this.mapArray((function(t){return Terrasoft.findValueByPath(t,e)}),this)},mapArrayByAttr:function(e){return this.mapArray((function(t){return t.get(e)}),this)},mapArrayByItemFn:function(e){return this.mapArray((function(t){return t[e]()}),this)},checkIndex:function(e){if(e<0||e>=this.getCount()){var t=Ext.String.format("{0} [{1}] {2}",Terrasoft.Resources.Collection.ItemWithIndex,e,Terrasoft.Resources.Collection.DoesNotExists);throw new Terrasoft.ItemNotFoundException({message:t})}},onReplaceItem:function(e){!1!==this.fireEvent("replace",e)&&(this.onCollectionRemove(e.removedItem,e.removedItemKey),this.onCollectionAdd(e.index,e.insertedItem,e.insertedItemKey))},constructor:function(){this.callParent(arguments),this.addEvents.apply(this,this.observableEvents);var e=this.collection=Ext.create("Ext.util.MixedCollection");e.on("add",this.onCollectionAdd,this),e.on("remove",this.onCollectionRemove,this),Ext.isFunction(this.getKey)&&(this.collection.getKey=this.getKey)},onCollectionAdd:function(e,t,r){this.fireEvent("add",t,e,r),this.fireEvent("changed")},onCollectionRemove:function(e,t){this.fireEvent("remove",e,t),this.fireEvent("changed")},onCollectionClear:function(e){this.fireEvent("clear",this,e),this.fireEvent("changed")},onCollectionMove:function(e,t,r){this.fireEvent("move",e,t,r)},isEmpty:function(){return 0===this.getCount()},getCount:function(){return this.collection.getCount()},getKeys:function(){return this.collection.keys},getItems:function(){return this.collection.items},get:function(e){if(!this.contains(e))throw new Terrasoft.ItemNotFoundException({message:Terrasoft.Resources.Collection.ItemWithKey+" "+e+" "+Terrasoft.Resources.Collection.DoesNotExists});return this.collection.getByKey(e)},getByIndex:function(e){var t=this.findByIndex(e);if(!t){var r=Terrasoft.Resources.Collection,n=r.ItemWithIndex+" ["+e+"] "+r.DoesNotExists,i=new Terrasoft.ItemNotFoundException({message:n});if(e!==this.getCount())throw i;this.warning(i.toString())}return t},findByIndex:function(e){return e<0||e>=this.getCount()?null:this.collection.getAt(e)},find:function(e){return this.collection.getByKey(e)},findByPath:function(e,t){return this.findByFn((function(r){var n=Terrasoft.findValueByPath(r,e);return _.isEqual(n,t)}),this)},filterByPath:function(e,t){return this.filterByFn((function(r){var n=Terrasoft.findValueByPath(r,e);return _.isEqual(n,t)}),this)},findByAttr:function(e,t){return this.filterByFn((function(r){return _.isEqual(r.get(e),t)}),this).first()},add:function(e,t,r){this.callParent(arguments);var n=this.collection,i=Ext.isNumber(r)?n.insert(r,e,t):n.add(e,t);return i},addIfNotExists:function(e,t,r){return this.contains(e)?null:this.add(e,t,r)},insert:function(e,t,r){return this.collection.insert(e,t,r)},indexOf:function(e){return this.collection.indexOf(e)},indexOfKey:function(e){return this.collection.indexOfKey(e)},remove:function(e){return this.removeByIndex(this.collection.indexOf(e))},removeByKey:function(e){return this.removeByIndex(this.collection.indexOfKey(e))},removeByIndex:function(e){return this.collection.removeAt(e)},contains:function(e){return this.collection.containsKey(e)},each:function(e,t){this.collection.each(e,t)},eachAsync:function(e,t,r){var n=this.getItems();Terrasoft.eachAsync(n,e,t,r)},eachKey:function(e,t){this.collection.eachKey(e,t)},clear:function(){var e=this.clone();this.collection.on("clear",(function t(){this.onCollectionClear(e),this.collection.un("clear",t,this)}),this),this.collection.clear()},loadAll:function(e,t){if(Ext.isArray(e))throw new Terrasoft.UnsupportedTypeException({message:Terrasoft.Resources.Collection.ArrayUnsupportedInputType});var r=this.collection;this.suspendEvents(!1);try{if(!(e instanceof Terrasoft.Collection)){var n=Ext.create("Terrasoft.Collection");return Terrasoft.each(e,(function(e,t){n.add(t,e)}),this),this.resumeEvents(),void this.loadAll(n,t)}e.eachKey((function(e,n){t&&"top"===t.mode?r.insert(0,e,n):r.add(e,n)}),this)}finally{this.resumeEvents()}this.fireEvent("dataLoaded",this,e,t),this.fireEvent("changed")},move:function(e,t){this.checkIndex(e),this.checkIndex(t);var r=this.collection,n=r.getAt(e),i=this.getKeys()[e];r.suspendEvents(),r.removeAt(e),r.insert(t,i,n),r.resumeEvents(),this.onCollectionMove(e,t,i)},replace:function(e,t,r){var n=this.collection,i=n.indexOf(e);if(-1!==i){var a=this.getKeys()[i],s=r||a;n.suspendEvents(),n.removeAt(i),n.insert(i,s,t),n.resumeEvents();var o={removedItem:e,removedItemKey:a,insertedItem:t,insertedItemKey:s,index:i};this.onReplaceItem(o)}},firstOrDefault:function(e,t){return e?this.filterByFn(e,t).first():this.first()},except:function(e,t,r){t=t||this.defaultEqualityFn;var n=Ext.create("Terrasoft.Collection"),i=this.getKeys(),a=this.getItems();return a.forEach((function(s,o){var l=i[o],c=a[o];e.any((function(e,n){return t.call(r,c,e,l,n)}),this)||n.add(l,c)}),this),n},defaultEqualityFn:function(e,t,r,n){return r===n||e===t},any:function(e,t){var r=this.getKeys();return this.getItems().some((function(n,i){var a=r[i];return e.call(t,n,a)}),this)},select:function(e,t){return this.selectKeyValue((function(r,n){return{key:n,value:e.call(t,r)}}),t)},selectKeyValue:function(e,t){var r=Ext.create("Terrasoft.Collection"),n=this.getKeys();return this.getItems().forEach((function(i,a){var s=n[a],o=e.call(t,i,s);o.value&&r.add(o.key,o.value)}),this),r},take:function(e){return this.getRange(0,e)},getRange:function(e,t){var r=Ext.create("Terrasoft.Collection"),n=this.getCount(),i=e+t;i>n&&(i=n);for(var a=this.getKeys(),s=this.getItems(),o=e;o<i;o++)r.add(a[o],s[o]);return r},first:function(){return this.collection.first()},last:function(){return this.collection.last()},reloadAll:function(e){this.clear(),this.loadAll(e)}}),Ext.define("Terrasoft.core.collections.ObjectCollectionItem",{extend:"Terrasoft.core.BaseObject",alternateClassName:"Terrasoft.ObjectCollectionItem",mixins:{serializable:"Terrasoft.Serializable"},parentCollection:null,setParentCollection:function(e){this.parentCollection=e},getSerializableObject:function(e,t){t.serializeFilterManagerInfo&&(e.className=this.alternateClassName)}}),Ext.define("Terrasoft.data.columns.BaseQueryColumn",{extend:"Terrasoft.ObjectCollectionItem",alternateClassName:"Terrasoft.BaseQueryColumn",caption:"",orderDirection:Terrasoft.OrderDirection.NONE,orderPosition:-1,expression:null,isVisible:!0,constructor:function(e){this.callParent(arguments),this.initExpression(e)},initExpression:Terrasoft.emptyFn,getSerializableObject:function(e){this.callParent(arguments),e.caption=this.caption,e.orderDirection=this.orderDirection,e.orderPosition=this.orderPosition,e.isVisible=this.isVisible,e.expression=this.getSerializableProperty(this.expression)}}),Ext.define("Terrasoft.core.collections.ObjectCollection",{extend:"Terrasoft.core.collections.Collection",alternateClassName:"Terrasoft.ObjectCollection",mixins:{serializable:"Terrasoft.Serializable"},items:null,itemKeyTemplate:"Item",itemKeyCounter:0,itemClass:"Terrasoft.ObjectCollectionItem",parentCollection:null,constructor:function(){this.callParent(arguments);var e=this.items;if(e)for(var t in e)e.hasOwnProperty(t)&&this.add(t,e[t]);this.items=null},getSerializableObject:function(e,t){t.serializeFilterManagerInfo&&(e.className=this.alternateClassName);var r=e.items={};this.eachKey((function(e,n){this.needSerializeItem(e,n,t)&&(r[e]=this.getSerializableProperty(n))}),this)},needSerializeItem:function(){return!0},getUniqueKey:function(){var e;do{e=this.itemKeyTemplate+this.itemKeyCounter,this.itemKeyCounter++}while(this.contains(e));return e},onCollectionAdd:function(e,t){this.setItemParentCollection(t,this),this.callParent(arguments)},onCollectionRemove:function(e){this.callParent(arguments),this.setItemParentCollection(e,null)},setParentCollection:function(e){this.parentCollection=e},setItemParentCollection:function(e,t){e.setParentCollection?e.setParentCollection(t):e.parentCollection=t},createItem:function(e){return Ext.create(this.itemClass,e)},addItem:function(e,t){return this.add(this.getUniqueKey(),e,t)},loadAll:function(e,t){if(Ext.isArray(e)){var r={};Terrasoft.each(e,(function(e){r[this.getUniqueKey()]=e}),this),this.loadAll(r,t)}else this.callParent(arguments)},clear:function(){var e=this.collection;e.each((function(e){this.setItemParentCollection(e,null)}),this),this.callParent(arguments)}}),Ext.ns("Terrasoft.data.model"),Ext.define("Terrasoft.data.model.BaseViewModelCollection",{extend:"Terrasoft.core.collections.ObjectCollection",alternateClassName:"Terrasoft.BaseViewModelCollection",deleteQuery:null,rowConfig:null,entitySchema:null,itemClass:"Terrasoft.BaseViewModel",constructor:function(){this.callParent(arguments),this.addEvents("itemChanged")},onItemChanged:function(e,t){this.fireEvent("itemChanged",e,t)},subscribeItemEvent:function(e){e.on("change",this.onItemChanged,this)},unsubscribeItemEvent:function(e){e.un("change",this.onItemChanged,this)},onCollectionAdd:function(e,t){this.callParent(arguments),this.subscribeItemEvent(t)},onCollectionRemove:function(e){this.callParent(arguments),this.unsubscribeItemEvent(e)},deleteItem:function(e,t,r){this.get(e).deleteEntity((function(n){n.rowsAffected>0&&this.removeByKey(e),Ext.isFunction(t)&&t.call(r||this,n)}),this)},createItem:function(e){return Ext.create(this.itemClass,{values:e,rowConfig:this.rowConfig})},generateItemPropertyValueIndex:function(e,t){for(var r=this.getItems().map((function(t){return t.get(e)})),n=1;r.indexOf(t+n)>-1;)n++;return n},loadFromColumnValues:function(e){var t=this.entitySchema.primaryColumnName;this.clear(),e.forEach((function(e){var r=e[t];if(!r)throw new Terrasoft.ItemNotFoundException({message:Terrasoft.Resources.BaseViewModelCollection.PrimaryColumnValueNotFound});var n=new Terrasoft.BaseViewModel({values:e});this.add(r,n)}),this)}}),Ext.ns("Terrasoft.core"),Terrasoft.core.enums.SysValue||(Terrasoft.core.enums.SysValue={CURRENT_USER:{value:"1B4B9325-66CC-DF11-9B2A-001D60E938C6",displayValue:"Default_user"},CURRENT_USER_CONTACT:{value:"DAD159F3-6C2D-446A-98D2-0F4D26662BBE",displayValue:"Мирный Евгений"},CURRENT_USER_TIMEZONE_OFFSET:0,CURRENT_USER_TIMEZONE_CODE:"UTC",CURRENT_USER_ACCOUNT:{value:"E308B781-3C5B-4ECB-89EF-5C1ED4DA488E",displayValue:"Ваша компания"},CURRENT_WORKSPACE:{value:"0C039963-C53D-E111-851E-00155D04C01D",displayValue:"TSBpm"},CURRENT_MAINTAINER:{value:"Terrasoft",displayValue:"Terrasoft"},CURRENT_MONEY_DISPLAY_PRECISION:2,CURRENT_USER_CULTURE:{displayValue:"ru-RU"},PRIMARY_CULTURE:{displayValue:"ru-RU"},MAX_ENTITY_SCHEMA_NAME_LENGTH:30}),Terrasoft.SysValue=Terrasoft.core.enums.SysValue,Ext.define("Terrasoft.core.LocalizableValue",{extend:"Terrasoft.core.BaseObject",alternateClassName:"Terrasoft.LocalizableValue",cultureValues:null,getCultureValue:function(e){return this.cultureValues?this.cultureValues.hasOwnProperty(e)?this.cultureValues[e]:this.cultureValues[Terrasoft.SysValue.PRIMARY_CULTURE.displayValue]:null},getValue:function(){var e=Terrasoft.SysValue.CURRENT_USER_CULTURE.displayValue;return this.getCultureValue(e)},hasValue:function(){return!Ext.isEmpty(this.getValue())},hasAnyCultureValue:function(){var e=this;return Object.keys(this.cultureValues).some((function(t){return!Ext.isEmpty(e.cultureValues[t])}))},setCultureValue:function(e,t){this.cultureValues[e]=t},setValue:function(e){var t=Terrasoft.SysValue.CURRENT_USER_CULTURE.displayValue,r=Terrasoft.SysValue.PRIMARY_CULTURE.displayValue;this.setCultureValue(t,e),Ext.isEmpty(e)&&t!==r&&this.setCultureValue(r,e)},clone:function(){return Ext.create(this.$className,{cultureValues:Terrasoft.deepClone(this.cultureValues)})},merge:function(e){var t=this.cultureValues;Terrasoft.each(e.cultureValues,(function(e,r){t[r]=t[r]||e}),this)},clear:function(){this.cultureValues={}}}),Ext.define("Terrasoft.core.LocalizableString",{extend:"Terrasoft.core.LocalizableValue",alternateClassName:"Terrasoft.LocalizableString",mixins:{serializable:"Terrasoft.Serializable"},getSerializableObject:function(e){Terrasoft.each(this.cultureValues,(function(t,r){e[r]=t}),this)},constructor:function(e){var t;if((e||""===e)&&(Ext.isObject(e)?t=e.cultureValues:(t=e,e={}),Ext.isString(t))){e.cultureValues={};var r=Terrasoft.SysValue.CURRENT_USER_CULTURE.displayValue;e.cultureValues[r]=t}this.cultureValues={},this.callParent(arguments)},toString:function(){return this.getValue()||""}}),Ext.define("Terrasoft.core.LocalizableImage",{alternateClassName:"Terrasoft.LocalizableImage",extend:"Terrasoft.LocalizableValue",constructor:function(e){if(e&&e.cultureValues){var t=e.cultureValues,r="string"==typeof t[Object.keys(t)[0]];r&&(e.cultureValues={},Terrasoft.each(t,(function(t,r){e.cultureValues[r]=JSON.parse(t)})))}this.cultureValues={},this.callParent(arguments)}}),Ext.define("Terrasoft.core.ErrorInfo",{alternateClassName:"Terrasoft.ErrorInfo",extend:"Terrasoft.BaseObject",toStringTemplate:"{0}. {1}",errorCode:null,message:null,stackTrace:null,toString:function(){return this.errorCode?Ext.String.format(this.toStringTemplate,this.errorCode,this.message):this.message}}),Ext.define("Terrasoft.ResourceMutex",{singleton:!0,_resources:[],locked:function(e){return this._resources.indexOf(e)>-1},lock:function(e){if(this.locked(e))throw new Terrasoft.InvalidOperationException;Ext.Array.include(this._resources,e)},release:function(e){this.locked(e)&&Ext.Array.remove(this._resources,e)}}),Ext.define("Terrasoft.core.BaseResponse",{alternateClassName:"Terrasoft.BaseResponse",extend:"Terrasoft.BaseObject",errorInfoClassName:"Terrasoft.ErrorInfo",isSuccess:function(){return Ext.Object.isEmpty(this.errorInfo)},initPropertyValue:function(e,t){if("errorInfo"===e&&t&&!Terrasoft.isInstanceOfClass(t,this.errorInfoClassName)){var r={errorCode:t.errorCode,message:t.message,stackTrace:t.stackTrace};t=Ext.create(this.errorInfoClassName,r)}return t},getResponsePropertyNames:function(){return["success","errorInfo"]},constructor:function(e){var t={};Terrasoft.each(e,(function(e,r){this[r]=null,t[r]=this.initPropertyValue(r,e)}),this),this.callParent([t]),this.success=this.isSuccess()},destroyPropertyValue:function(e){"errorInfo"===e&&Terrasoft.isInstanceOfClass(this.errorInfo,this.errorInfoClassName)&&this.errorInfo.destroy()},onDestroy:function(){var e=this.getResponsePropertyNames();Terrasoft.each(e,(function(e){this.destroyPropertyValue(e)}),this),this.callParent(arguments)}}),Ext.define("Terrasoft.core.BaseRequest",{alternateClassName:"Terrasoft.BaseRequest",extend:"Terrasoft.BaseObject",mixins:{serializable:"Terrasoft.Serializable"},requestTimeout:99999999999,serviceProvider:null,contractName:null,responseClassName:"Terrasoft.BaseResponse",getSerializableObject:Terrasoft.emptyFn,getRequestConfig:function(){return{responseClassName:this.responseClassName,serverMethod:this.contractName,data:this}},validate:function(){if(!this.contractName)throw new Terrasoft.NullOrEmptyException({message:"contractName"});return!0},constructor:function(){this.callParent(arguments),this.serviceProvider=Terrasoft.ServiceProvider},execute:function(e,t){this.validate();var r=this.getRequestConfig();this.serviceProvider.execute(r,e,t)},executeAsync:function(){this.validate();var e=this.getRequestConfig();return this.serviceProvider.executeAsync(e)}}),Ext.define("Terrasoft.process.ProcessStatisticInfoRequest",{extend:"Terrasoft.BaseRequest",alternateClassName:"Terrasoft.ProcessStatisticInfoRequest",contractName:"ProcessStatisticInfoRequest",sysProcessLogId:null,getSerializableObject:function(e){this.callParent(arguments),e.sysProcessLogId=this.sysProcessLogId}}),Ext.define("Terrasoft.process.ProcessMultiInstanceStatisticInfoRequest",{extend:"Terrasoft.BaseRequest",alternateClassName:"Terrasoft.ProcessMultiInstanceStatisticInfoRequest",contractName:"ProcessMultiInstanceStatisticInfoRequest",sysProcessLogId:null,getSerializableObject:function(e){this.callParent(arguments),e.sysProcessLogId=this.sysProcessLogId}}),Ext.define("Terrasoft.core.mixins.ProcessSchemaDesignerLogMixin",{alternateClassName:"Terrasoft.ProcessSchemaDesignerLogMixin",_showErrorMessage:function(e,t){Terrasoft.Mask.clearMasks("body"),Terrasoft.showErrorMessage(e,(function(){t&&!1===t.doCloseWindow||window.close()}),this)},getProcessSchemaUId:function(e,t){var r=this.get("SysProcessLogId"),n=Ext.create("Terrasoft.EntitySchemaQuery",{rootSchemaName:"SysSchema"});n.addColumn("UId"),n.filters.addItem(n.createColumnFilterWithParameter(Terrasoft.ComparisonType.EQUAL,"[VwSysProcessLog:SysSchema:Id].Id",r)),n.getEntityCollection((function(n){var i;if(n.success){var a=n.collection;if(a&&a.getCount()){var s=a.getByIndex(0).values.UId;e.call(t,s)}else{var o=Terrasoft.Resources.ProcessDiagram.Messages.ProcessSchemaNotFound;i=Ext.String.format(o,r),this._showErrorMessage(i)}}else i=n.errorInfo.message,this._showErrorMessage(i)}),this)},_executeStatisticsRequest:function(e,t,r){var n=this.get("SysProcessLogId");Ext.create(e,{sysProcessLogId:n}).execute((function(e){if(!e.success){var n=e.errorInfo,i=Ext.String.format("{0}: {1}\n{2}",n.errorCode,n.message,n.stackTrace);this.error(i)}t.call(r,e.statisticInfo)}),this)},getProcessStatisticInfo:function(e,t){this._executeStatisticsRequest("Terrasoft.ProcessStatisticInfoRequest",e,t)},getProcessMultiInstanceStatisticInfo:function(e,t){this._executeStatisticsRequest("Terrasoft.ProcessMultiInstanceStatisticInfoRequest",e,t)},initColumns:function(){this.columns.SysProcessLogId={dataValueType:Terrasoft.DataValueType.GUID}},init:function(){var e,t;Terrasoft.chain((function(e){this.getProcessSchemaUId(e,this)}),(function(e,t){this.set("SchemaUId",t),Terrasoft.ProcessSchemaManager.createManagerItem({uId:t}).getInstance(e,this)}),(function(t,r){e=r,this.getProcessStatisticInfo(t,this)}),(function(r,n){t=n,Terrasoft.Features.getIsEnabled("ExecutionDiagramMultiInstanceLabels")&&e.getContainsMultiInstanceElements()?this.getProcessMultiInstanceStatisticInfo(r,this):Ext.callback(r,this)}),(function(r,n){e.loadStatisticInfo(t),e.loadMultiInstanceStatisticInfo(n),this.loadItems(e),this.fireEvent("initialized",this),this.onSandboxInitialized()}),this)}}),Ext.define("Terrasoft.core.BaseServerChannelResponse",{alternateClassName:"Terrasoft.BaseServerChannelResponse",extend:"Terrasoft.BaseObject",sender:"",message:null,prepareMessage:function(e){var t=e.Body;try{return Terrasoft.decode(t)}catch(e){return t}},constructor:function(e){this.callParent(arguments);var t=e.message;this.message=this.prepareMessage(t),this.sender=t.Header.Sender},getMessage:function(){return this.message},getSender:function(){return this.sender},validateSender:function(e){return this.getSender()===e}}),Ext.define("Terrasoft.core.BuildPackageHierarchyResponse",{alternateClassName:"Terrasoft.BuildPackageHierarchyResponse",extend:"Terrasoft.BaseResponse",getResponsePropertyNames:function(){var e=this.callParent(arguments);return e.push("packageHierarchy"),e}}),Ext.define("Terrasoft.data.queries.BuildPackageHierarchyRequest",{extend:"Terrasoft.BaseRequest",alternateClassName:"Terrasoft.BuildPackageHierarchyRequest",responseClassName:"Terrasoft.BuildPackageHierarchyResponse",contractName:"SchemaDesignerRequest",getSerializableObject:function(e){e.buildPackageHierarchy=!0}}),Ext.define("Terrasoft.core.GetAvailablePackagesResponse",{alternateClassName:"Terrasoft.GetAvailablePackagesResponse",extend:"Terrasoft.BaseResponse",getResponsePropertyNames:function(){var e=this.callParent(arguments);return e.push("availablePackages"),e}}),Ext.define("Terrasoft.data.queries.GetAvailablePackagesRequest",{extend:"Terrasoft.BaseRequest",alternateClassName:"Terrasoft.GetAvailablePackagesRequest",responseClassName:"Terrasoft.GetAvailablePackagesResponse",contractName:"SchemaDesignerRequest",getSerializableObject:function(e){e.getAvailablePackages=!0}}),Ext.define("Terrasoft.data.queries.UpdatePackageSchemaDataRequest",{extend:"Terrasoft.BaseRequest",alternateClassName:"Terrasoft.UpdatePackageSchemaDataRequest",contractName:"UpdatePackageSchemaDataRequest",columns:null,forceUpdateColumns:null,entitySchemaName:null,recordList:null,packageUId:null,packageSchemaDataName:null,entitySchema:null,_createSerializedServerFilters:function(){if(!Ext.isEmpty(this.entitySchema)){var e=this.entitySchema.uId,t=this.entitySchema.primaryColumn,r=Terrasoft.convertToServerDataValueType(Terrasoft.DataValueType.GUID),n=this.recordList.map((function(n){var i=Ext.String.format('"{0}"',n);return{_isFilter:!0,_filterSchemaUId:e,uId:Terrasoft.generateGUID(),leftExpression:{expressionType:"SchemaColumn",metaPath:t.uId,caption:t.caption,dataValueType:{id:r,name:"Guid",isNumeric:!1,editor:{controlTypeName:"TextEdit",controlXType:"textedit"},useClientEncoding:!1}},comparisonType:"Equal",rightExpression:{expressionType:"Parameter",dataValueType:{id:r,name:"Guid",isNumeric:!1,editor:{controlTypeName:"TextEdit",controlXType:"textedit"},useClientEncoding:!1},parameterValues:[{displayValue:i,parameterValue:i}]}}}),this);return JSON.stringify({_isFilter:!1,uId:Terrasoft.generateGUID(),name:"FilterEdit",logicalOperation:"Or",items:n})}},validate:function(){if(Terrasoft.each(["entitySchemaName","packageSchemaDataName","packageUId"],(function(e){if(Ext.isEmpty(this[e]))throw new Terrasoft.NullOrEmptyException({message:e})}),this),!Ext.isArray(this.recordList))throw new Terrasoft.UnsupportedTypeException({message:"recordList"});return!0},getSerializableObject:function(e){e.entitySchemaName=this.entitySchemaName,e.recordList=this.recordList,e.packageUId=this.packageUId,e.packageSchemaDataName=this.packageSchemaDataName,e.serializedFilters=this._createSerializedServerFilters(),e.columns=this.columns,e.forceUpdateColumns=this.forceUpdateColumns},constructor:function(){this.columns=[],this.callParent(arguments)}}),Ext.define("Terrasoft.data.queries.DeletePackageSchemaDataRequest",{extend:"Terrasoft.BaseRequest",alternateClassName:"Terrasoft.DeletePackageSchemaDataRequest",contractName:"DeletePackageSchemaDataRequest",packageSchemaDataName:null,packageUId:null,validate:function(){return Terrasoft.each(["packageSchemaDataName","packageUId"],(function(e){if(Ext.isEmpty(this[e]))throw new Terrasoft.NullOrEmptyException({message:e})}),this),this.callParent(arguments)},getSerializableObject:function(e){e.packageSchemaDataName=this.packageSchemaDataName,e.packageUId=this.packageUId}}),Ext.define("Terrasoft.core.SchemaDesignerUtilitiesResponse",{alternateClassName:"Terrasoft.SchemaDesignerUtilitiesResponse",extend:"Terrasoft.BaseResponse",getResponsePropertyNames:function(){var e=this.callParent(arguments);return Ext.Array.push(e,["messages","packageHierarchy","dataValueTypeInfo","schemaHierarchy","maxEntitySchemaNameLength"]),e}}),Ext.define("Terrasoft.core.ClientUnitSchemaMessage",{alternateClassName:"Terrasoft.ClientUnitSchemaMessage",extend:"Terrasoft.BaseObject",mixins:{serializable:"Terrasoft.Serializable"},name:null,directionType:null,mode:null,getSerializableObject:function(e){e.directionType=this.directionType,e.mode=this.mode}}),Ext.define("Terrasoft.core.ParametrizedRequest",{alternateClassName:"Terrasoft.ParametrizedRequest",extend:"Terrasoft.BaseRequest",config:null,getSerializableObject:function(e){e.contractName=this.contractName,Terrasoft.each(this.config,(function(t,r){e[r]=t}))}}),Ext.ns("Terrasoft.core"),Ext.define("Terrasoft.core.ComponentManager",{alternateClassName:"Terrasoft.ComponentManager",extend:"Terrasoft.BaseObject",singleton:!0,defaultUnregisterInterval:1e3,defaultUnregisterComponentsCount:100,componentsToUnregister:[],unregisterComponentsCount:null,unregisterInterval:null,unregisterIntervalId:null,getCachedSetting:function(e){return Terrasoft.SysSettings&&Terrasoft.SysSettings.cachedSettings?Terrasoft.SysSettings.cachedSettings[e]:null},safeUnregister:function(){for(var e=this.componentsToUnregister.splice(0,this.getUnregisterComponentsCount());e.length;){var t=e.shift(),r=Ext.ComponentManager.get(t);r&&r.destroyed&&Ext.ComponentManager.all.removeAtKey(r.id)}},getUnregisterComponentsCount:function(){if(!Ext.isEmpty(this.unregisterComponentsCount))return this.unregisterComponentsCount;var e=this.getCachedSetting("UnregisterComponentsCount");return this.unregisterComponentsCount=e||this.defaultUnregisterComponentsCount,this.unregisterComponentsCount},getUnregisterInterval:function(){if(!Ext.isEmpty(this.unregisterInterval))return this.unregisterInterval;var e=this.getCachedSetting("UnregisterComponentsInterval");return this.unregisterInterval=e||this.defaultUnregisterInterval,this.unregisterInterval},unregister:function(e){-1===this.componentsToUnregister.indexOf(e.id)&&this.componentsToUnregister.push(e.id),Ext.isEmpty(this.unregisterIntervalId)&&(this.unregisterIntervalId=setInterval(this.safeUnregister.bind(this),this.getUnregisterInterval()))},register:function(e){Ext.ComponentManager.register(e)}}),Ext.define("Terrasoft.mixins.ValueConverter",{alternateClassName:"Terrasoft.ValueConverter",invertBooleanValue:function(e){return!e},toBoolean:function(e){return Boolean(e)},isEmptyValue:function(e){return Terrasoft.isEmpty(e,!0)},isNotEmptyValue:function(e){return!Terrasoft.isEmpty(e,!0)}}),Ext.ns("Terrasoft.model"),Ext.define("Terrasoft.model.BaseModel",{extend:"Terrasoft.core.BaseObject",alternateClassName:"Terrasoft.BaseModel",mixins:{ValueConverter:"Terrasoft.ValueConverter"},model:null,values:null,methods:null,bindMap:null,isTracking:!1,columns:null,changedValues:null,dependentProperties:null,canValidate:!1,columnChangeEventPrefix:"change:",_getChangeEventName:function(e){return"".concat(this.columnChangeEventPrefix).concat(e)},_canDefineAttributeProperty:function(e){return!Terrasoft.contains(e,".")&&!this.hasOwnProperty(e)},_getDefinePropertyName:function(e){return"$"+e},_getDefineAttributes:function(e){var t={};return Ext.isObject(e)?t=e:t[e]={},t},_defineAttributeProperty:function(e){var t=this._getDefineAttributes(e);_.keys(t).forEach((function(e){var t=this._getDefinePropertyName(e);this._canDefineAttributeProperty(t)&&Object.defineProperty(this,t,{get:function(){return this.get(e)},set:function(t){this.set(e,t,{})}})}),this)},_defineAttributesProperties:function(){_.keys(this.columns).forEach(this._defineAttributeProperty,this)},_addColumnValidationEvents:function(){var e=_.keys(this.columns).map((function(e){return"validate:"+e}));this.addEvents.apply(this,e)},constructor:function(e){this.callParent(arguments),this.model=new Backbone.Model,this.initModelColumns(),this.setInitialValue(),e&&(this.loadFromColumnValues(e.values,e.rowConfig),Ext.apply(this,e.methods)),this.model.on("change",this.onDataChange,this),this.addEvents("change"),this._defineAttributesProperties(),this._addColumnValidationEvents()},initModelColumns:function(){var e=this.getModelColumns();this.columns=e},setInitialValue:function(){var e=this.columns;Terrasoft.each(e,(function(e,t){void 0!==e.value&&this.set(t,e.value,null)}),this)},getModelColumns:function(){return _.clone(this.columns)||{}},loadFromColumnValues:function(e){e&&Terrasoft.each(e,(function(e,t){this.set(t,e,{silent:!0})}),this)},on:function(e,t,r){this.events[e]?this.callParent(arguments):(this.model.off(e,t,r),this.model.on(e,t,r))},un:function(e,t,r){this.events[e]?this.callParent(arguments):this.model.off(e,t,r)},onDataChange:function(e,t){var r=this,n=e&&e.changed;this.changedValues=this.changedValues||{},Terrasoft.each(n,(function(e,t){r.changedValues[t]=e})),this.fireEvent("change",this,t,n)},revertAttributeChanges:function(e){if(this.changedValues.hasOwnProperty(e)){var t=this.model.previous(e);this.set(e,t),delete this.changedValues[e]}},clearChangedValues:function(){this.changedValues={}},subscribeOnColumnChange:function(e,t,r){var n=this._getChangeEventName(e);this.on(n,t,r||this)},unsubscribeOnColumnChange:function(e,t,r){var n=this._getChangeEventName(e);this.un(n,t,r||this)},get:function(e){return this.isTracking&&(this.dependentProperties[e]=!0),this.model.get(e)},getPrevious:function(e){return this.model.previous(e)},getLookupValue:function(e,t){var r=this.columns[e];if(r&&(r.isLookup||t)){var n=this.get(e);return n&&n.value}throw new Terrasoft.UnsupportedTypeException},set:function(e,t,r){this.isTracking||(this._defineAttributeProperty(e),this.model.set(e,t,r))},trigger:function(e,t){this.model.trigger(e,this,t)},getColumnByName:function(e){return this.columns[e]},getIsChanged:function(){var e=this.changedValues=this.changedValues||{};return!Terrasoft.isEmptyObject(e)},isAttributeChanged:function(e){return!Ext.isEmpty(this.changedValues&&this.changedValues[e])},setTrackingState:function(e){this.isTracking!==e&&(this.isTracking=e,e&&(this.dependentProperties={}))},getBindMap:function(){return this.bindMap},addBindMap:function(e){if(!Ext.isObject(e))throw new Terrasoft.UnsupportedTypeException;var t=e.attributeName,r=e.propertyName;if(!Ext.isEmpty(t)&&!Ext.isEmpty(r)){this.bindMap=this.bindMap||new Terrasoft.Collection;var n=this.bindMap,i=n.find(t),a=i||{type:e.type};a[r]=t,i||n.add(t,a)}},getInitialValue:function(e){var t=(this.values||{})[e];if(!t){var r=this.getColumnByName(e);r&&(t=r.value)}return t},hasAttribute:function(e){return this.model.has(e)},onPrepareList:function(e,t){t.fireEvent("dataloaded",t)},getJSON:function(){return this.model.toJSON()}}),Ext.ns("Terrasoft.model"),Ext.define("Terrasoft.model.DataModel",{extend:"Terrasoft.BaseObject",alternateClassName:"Terrasoft.DataModel",name:null,schemaName:null,save:Terrasoft.abstractFn,load:Terrasoft.abstractFn,getAttributesConfig:Terrasoft.abstractFn}),Ext.define("Terrasoft.data.models.BaseEntitySchema",{extend:"Terrasoft.BaseObject",alternateClassName:"Terrasoft.BaseEntitySchema",columns:null,name:"",primaryColumnName:"",primaryColumn:null,primaryDisplayColumnName:"",primaryDisplayColumn:null,hierarchicalColumnName:"",hierarchicalColumn:null,administratedByRecords:!1,constructor:function(){this.callParent(arguments),this.primaryColumn=this.getColumnByName(this.primaryColumnName),this.primaryDisplayColumn=this.getColumnByName(this.primaryDisplayColumnName),this.hierarchicalColumn=this.getColumnByName(this.hierarchicalColumnName)},getColumnByName:function(e){return this.columns[e]},getColumnByUId:function(e){var t=this.findColumnByUId(e);if(!t){var r=Terrasoft.getFormattedString(Terrasoft.Resources.BaseEntitySchema.ColumnNotFondException,e,this.name);throw new Terrasoft.ItemNotFoundException({message:r})}return t},getReferenceColumnByEntitySchema:function(e){var t=this.getColumnByName(e);if(!t){var r=Terrasoft.filter(this.columns,(function(t){return t.referenceSchemaName===e}),this);t=1===r.length?r[0]:null}return t},isColumnExist:function(e){return e in this.columns},findColumnByUId:function(e){return Terrasoft.findWhere(this.columns,{uId:e})}}),Ext.define("Terrasoft.ViewModelResourcesMixin",{extend:"Terrasoft.core.BaseObject",resources:null,_setResourceColumns:function(){this.resources&&(Terrasoft.each(this.resources.localizableStrings,(function(e,t){this._createResourceColumn(t,e,Terrasoft.DataValueType.TEXT)}),this),Terrasoft.each(this.resources.localizableImages,(function(e,t){this._createResourceColumn(t,e,Terrasoft.DataValueType.IMAGE)}),this))},_createResourceColumn:function(e,t,r){var n={name:this._getResourceColumnPath(e,r),dataValueType:r,type:Terrasoft.ViewModelColumnType.RESOURCE_COLUMN,value:t};this.columns[n.name]=n},_getResourceColumnPath:function(e,t){return t===Terrasoft.DataValueType.TEXT?"Resources.Strings."+e:t===Terrasoft.DataValueType.IMAGE?"Resources.Images."+e:void 0}}),Ext.define("Terrasoft.core.mixins.RelatedEntityColumns",{alternateClassName:"Terrasoft.RelatedEntityColumns",_getLookupListColumnsByColumn:function(e){return(e.lookupListConfig||{}).columns||[]},_isEntityColumn:function(e){return e.type===Terrasoft.ViewModelColumnType.ENTITY_COLUMN},_getRelatedColumnName:function(e,t){return Ext.String.format("{0}.{1}",e,t)},_getIsDisabled:function(){return Terrasoft.Features.getIsDisabled("LoadLookupColumnsInEditGrid")},addRelatedEsqColumns:function(e,t){this._getIsDisabled()||Terrasoft.each(t,(function(t,r){this._isEntityColumn(t)&&((t.lookupListConfig||{}).columns||[]).forEach(function(t){var n=this._getRelatedColumnName(r,t);e.columns.contains(n)||e.addColumn(n)}.bind(this))}),this)},copyRelatedColumns:function(e,t){this._getIsDisabled()||Terrasoft.each(e,(function(e,r){if(this._isEntityColumn(e)){var n=this._getLookupListColumnsByColumn(e);if(0!==n.length){t[r]=t[r]||Terrasoft.deepClone(e);var i=t[r],a=i.lookupListConfig=i.lookupListConfig||{},s=a.columns=a.columns||[];a.columns=Ext.Array.merge(s,n)}}}),this)},setRelatedColumnsValues:function(e,t){this._getIsDisabled()||Terrasoft.each(t,(function(t){var r=(t.lookupListConfig||{}).columns||[];if(0!==r.length&&this._isEntityColumn(t)){var n=t.name,i=e.get(n);Ext.isEmpty(i)||Terrasoft.each(r,(function(t){var r=this._getRelatedColumnName(n,t);i[t]=e.get(r)}),this)}}),this)}}),Ext.define("Terrasoft.model.EntityDataModel",{extend:"Terrasoft.DataModel",alternateClassName:"Terrasoft.EntityDataModel",_deleteQuery:null,_insertQuery:null,_updateQuery:null,_globalNamespace:"Terrasoft",schema:null,primaryColumnValueConfig:null,isPrimary:!1,isNew:!0,_isEntityColumn:function(e){return e&&this._isCheckModelName(e)&&!Ext.isEmpty(e.columnPath)&&e.type===Terrasoft.ViewModelColumnType.ENTITY_COLUMN},_isColumnExists:function(e){return e&&this.schema.isColumnExist(e.columnPath)},_isCheckModelName:function(e){return!e.modelName||e.modelName&&e.modelName===this.name},_getColumnDataType:function(e){var t;e&&!Ext.isEmpty(e.dataValueType)?t=e.dataValueType:t=this.schema.getColumnByName(e.columnPath).dataValueType;return t},_getEntitySchema:function(e){if(!Ext.isEmpty(e)){var t=this._globalNamespace+"."+e;return Ext.ClassManager.get(t)}},_getRelatedColumnName:function(e,t){return e+"."+t},constructor:function(e){if(this.callParent(arguments),e){var t=e.schemaName,r=this.schema=e.schema||this._getEntitySchema(t);this.name=e.name||t,this.schemaName=r&&r.name}},getPrimaryColumnName:function(){var e=this.schema.primaryColumnName;return this.getAttributeName(e)},findPrimaryDisplayColumnName:function(){var e=this.schema.primaryDisplayColumnName;return e&&this.getAttributeName(e)||null},load:function(e,t,r){Ext.isEmpty(e.primaryColumnValue)?Ext.callback(t,r||this):(e.entitySchemaQuery||this.getEntitySchemaQuery(e.columns)).getEntity(e.primaryColumnValue,(function(e){this.isNew=!1;var n=e.entity;Ext.callback(t,r||this,[n])}),this)},copy:function(e,t,r){(e.entitySchemaQuery||this.getEntitySchemaQuery(e.columns)).getEntity(e.primaryColumnValue,(function(e){var n=e.entity;if(!n)throw new Terrasoft.ItemNotFoundException;Ext.callback(t,r||this,[n])}),this)},deleteEntity:function(e,t,r){if(null!==this.schema){var n=e.deleteQuery||this.getDeleteQuery();try{n.enablePrimaryColumnFilter(e.primaryColumnValue),n.execute((function(e){t.call(r||this,e)}),this)}finally{n.disablePrimaryColumnFilter()}}else t.call(r||this)},getSaveQuery:function(e){if(null===this.schema)throw new Terrasoft.exceptions.ArgumentNullOrEmptyException({argumentName:"schema"});var t=e.saveQuery;t||((Ext.isDefined(e.isNew)?e.isNew:this.isNew)?t=this.getInsertQuery():(t=this.getUpdateQuery(e.isForceUpdate)).enablePrimaryColumnFilter(e.primaryColumnValue));var r=t.columnValues;r.clear();var n=e.columns,i=e.changedValues;return Terrasoft.each(i,(function(e,t){var i=n[t];if(this._isEntityColumn(i)&&this._isColumnExists(i)){i.isLookup&&(e=e?e.value:null);var a=i.columnPath;r.setParameterValue(a,e,this._getColumnDataType(i))}}),this),t},save:function(e,t,r){(e.saveQuery||this.getSaveQuery(e)).execute((function(e){e.success&&(this.isNew=!1),Ext.callback(t,r||this,[e])}),this)},getEntitySchemaQuery:function(e){var t=Ext.create("Terrasoft.EntitySchemaQuery",{rootSchema:this.schema});return Terrasoft.each(e,(function(e,r){this._isEntityColumn(e)&&t.addColumn(e.columnPath,r)}),this),this.addRelatedEntityColumns(t,e),t},getEntityPrimaryImageColumnName:function(){return this.schema?this.schema.primaryImageColumnName:null},getInsertQuery:function(){return this._insertQuery=this._insertQuery||Ext.create("Terrasoft.InsertQuery",{rootSchema:this.schema})},getUpdateQuery:function(e){return this._updateQuery=this._updateQuery||Ext.create("Terrasoft.UpdateQuery",{rootSchema:this.schema,isForceUpdate:e||!1})},getDeleteQuery:function(){return this._deleteQuery=this._deleteQuery||Ext.create("Terrasoft.DeleteQuery",{rootSchema:this.schema})},getAttributesConfig:function(){var e={};return Terrasoft.each(this.schema.columns,(function(t,r){var n=Ext.apply({modelName:this.name},t),i=this.getAttributeName(r);e[i]=n}),this),e},addRelatedEntityColumns:function(e,t){Terrasoft.each(t,(function(t){var r=t.lookupListConfig,n=r&&r.columns;n&&this._isEntityColumn(t)&&Terrasoft.each(n,(function(r){var n=this._getRelatedColumnName(t.name,r);if(!e.columns.contains(n)){var i=this._getRelatedColumnName(t.columnPath,r);e.addColumn(i,n)}}),this)}),this)},getAttributeName:function(e){return this.isPrimary?e:this.name+"."+e}}),Ext.define("Terrasoft.core.collections.DataModelCollection",{extend:"Terrasoft.core.collections.ObjectCollection",alternateClassName:"Terrasoft.DataModelCollection",dataModelsConfig:null,init:function(e){this.dataModelsConfig=Ext.clone(e),Terrasoft.each(e,(function(e,t){this._add(t,e)}),this)},getAttributesConfig:function(){var e={};return this.each((function(t){e=Ext.apply(e,t.getAttributesConfig())}),this),e},findPrimary:function(){return this.findByPath("isPrimary",!0)},_add:function(e,t){var r=t.entitySchemaName,n=t.entitySchema;if(r||n){var i=new Terrasoft.EntityDataModel({schemaName:r,schema:n,name:e,primaryColumnValueConfig:t.primaryColumnValue,isPrimary:Boolean(t.isPrimary),isNew:!0});this.add(e,i)}}}),Ext.define("Terrasoft.controls.mixins.Bindable",{alternateClassName:"Terrasoft.Bindable",statics:{getBindingRuleBy$:function(e,t){if(Ext.isString(e)&&0===e.indexOf("$")){var r=e.split("$")[1];if(!t||t&&t[r])return{bindTo:r}}return e}},model:null,bindings:null,selectorsWereBind:!1,collectionLoadEventName:"dataLoaded",safeBind:!1,bindingContext:null,_isDisabledBinding:function(e){return e&&e.config&&!0===e.config.disabled},_subscribeForCollectionChanged:function(e,t,r){r.get(e.modelItem).on("changed",this._onCollectionChanged.bind(this,e,t,r),this),this._onCollectionChanged(e,t,r)},_onCollectionChanged:function(e,t,r){var n=e.config.changeMethod;if(n){var i=this[n],a=e.config.converter,s=Ext.isString(a)?r[a]:a,o=r.get(e.modelItem),l=this.callModelMethod(s,r,[o]);i.call(this,l)}},_isCollectionConverter:function(e,t){var r=!1;if(e.config.converter){var n=e.modelItem,i=this[n];if(i)r=i instanceof Terrasoft.Collection;else{var a=t.columns[n];r=a&&a.dataValueType===Terrasoft.DataValueType.COLLECTION}}return r},constructor:function(e){e&&this.initBindings(e)},initBindings:function(e){var t=this.getBindConfig(),r={};Terrasoft.each(e,(function(n,i){if(n=Terrasoft.Bindable.getBindingRuleBy$(n),Ext.isObject(n)&&n.bindTo){var a=this.initBinding(i,n,t);a&&(r[i]=a,delete e[i])}}),this),this.bindings=r},initBinding:function(e,t,r){var n={};n.modelItem=t.bindTo;var i=t.bindConfig,a={};return r&&(a=r[e]),n.config=Ext.apply(a,i),n},bind:function(e,t){(e=this.getBindingContext(e))&&(this.model=e,t=t||this.bindings,Terrasoft.each(t,(function(t,r){if(!this._isDisabledBinding(t)){var n=this.getBindingType(r,t,e);t.bindingType=n,n===Terrasoft.BindingType.EVENT&&this.subscribeForEvents(t,r,e),n===Terrasoft.BindingType.PROPERTY&&e.addBindMap({propertyName:r,type:t.bindingType,attributeName:t.modelItem})}}),this),Terrasoft.each(t,(function(t,r){t.bindingType===Terrasoft.BindingType.EVENT||this._isDisabledBinding(t)||(this.setControlInitialValue(t,e),this.subscribeForEvents(t,r,e))}),this),this.bindSelectors())},getBindingContext:function(e){if(this.bindingContext){if(!Terrasoft.isInstanceOfClass(e,"Terrasoft.BaseViewModel"))throw new Terrasoft.UnsupportedTypeException;for(var t=this.bindingContext.split("."),r=0;r<t.length;r++)if(e=e.get(t[r]),!Terrasoft.isInstanceOfClass(e,"Terrasoft.BaseViewModel"))throw new Terrasoft.UnsupportedTypeException}return e},bindSelectors:function(){this.model&&!this.selectorsWereBind&&(Terrasoft.each(this.selectors,(function(e,t){"wrapEl"!==t&&Ext.isObject(e)&&this.bindSelector(e)}),this),this.selectorsWereBind=!0)},bindSelector:function(e){var t=e.selector,r=Ext.DomQuery.select(t);Terrasoft.each(r,(function(t){var r=Ext.get(t);this.subscribeForElementDomEvents(r,e)}),this)},subscribeForElementDomEvents:function(e,t){var r=this.model;Terrasoft.each(t.events,(function(n,i){e.on(i,(function(){var i=[];Terrasoft.each(t.attributes,(function(t){i.push(e.getAttribute(t))}),this);var a=r[n.bindTo];this.callModelMethod(a,r,i)}),this)}),this)},getBindingType:function(e,t,r){var n;if(e in this.events)n=Terrasoft.BindingType.EVENT;else{var i=t.modelItem,a=r[i];if(Ext.isFunction(a))n=Terrasoft.BindingType.METHOD;else n=r.get(i)instanceof Terrasoft.Collection?Terrasoft.BindingType.COLLECTION:Terrasoft.BindingType.PROPERTY}return n},setControlInitialValue:function(e,t){var r=this.getBindingValue(e,t);Ext.isDate(r)&&(r=new Date(r)),this.setControlPropertyValue(e,r,t)},getBindingValue:function(e,t){var r,n=[];if(e.bindingType===Terrasoft.BindingType.METHOD){r=t[e.modelItem];var i=this.tag;i&&n.push(i)}else r=t.get,n.push(e.modelItem);return this.callModelMethod(r,t,n)},setControlPropertyValue:function(e,t,r){var n=e.config&&e.config.changeMethod;if(n){var i=this[n];if(e.bindingType!==Terrasoft.BindingType.METHOD){var a=e.config.converter,s=[];if(s.push(t),r){r.getColumnDataType&&s.push(r.getColumnDataType(e.modelItem));var o=r.columns[e.modelItem];o&&s.push(o)}if(a){var l=Ext.isString(a)?r[a]:a;t=this.callModelMethod(l,r,s)}}void 0===t&&(t=null),i.call(this,t)}},subscribeForEvents:function(e,t,r){switch(e.bindingType){case Terrasoft.BindingType.COLLECTION:this.subscribeForCollectionEvents(e,t,r);break;case Terrasoft.BindingType.EVENT:var n=r[e.modelItem];this.subscribeForControlEvent(t,n,r);break;case Terrasoft.BindingType.PROPERTY:this.subscribeForPropertyChangeEvent(e,t,r);break;case Terrasoft.BindingType.METHOD:this.subscribeForDependentPropertiesChangeEvents(e,t,r)}},subscribeForControlEvent:function(e,t,r,n){this.on(e,(function(e){var i=this,a=[],s=this.tag||(e?e.tag:null);return Terrasoft.each(arguments,(function(e){e&&(!0===e.isComponent||e.dom)||a.push(e)}),this),n&&(a=a.concat(n)),Ext.isEmpty(s)||a.push(s),Terrasoft.utils.executionZone.safeExecute(r,(function(){return i.callModelMethod(t,r,a)}))}))},subscribeForCollectionEvents:function(e,t,r){var n=e.config.changeMethod;if(n){var i=this[n],a=r.get(e.modelItem);e.config.converter?this._subscribeForCollectionChanged(e,t,r):(this[t]=a,a.on(this.collectionLoadEventName,i,this))}},subscribeForDependentPropertiesChangeEvents:function(e,t,r){var n=e.dependentProperties=this.getDependentProperties(e,r),i=e.handler=this.onModelDependentPropertiesChange=function(){var t=e.dependentProperties,n=this.getDependentProperties(e,r);if(!Terrasoft.areArraysEqual(n,t)){var i=Ext.Array.difference(t,n),a=Ext.Array.difference(n,t);this.toggleSubscriptionForModelEvents(r,i,a,this.onModelDependentPropertiesChange,this),e.dependentProperties=n}var s=this.getModelMethod(e,r),o=[],l=this.tag;l&&o.push(l);var c=this.callModelMethod(s,r,o);this.setControlPropertyValue(e,c,r)};this.toggleSubscriptionForModelEvents(r,null,n,i,this)},subscribeForPropertyChangeEvent:function(e,t,r,n){var i=e.config.changeEvent,a=e.config.converter,s=e.config.deprecatedChangeEvent,o=e.modelItem;if(i&&!this._isCollectionConverter(e,r)){this.on(i,(function(){var e=this[t];r.set(o,e,{changeEvent:i})}))}if(s){this.on(s,(function(){r.set(o,this[t],{changeEvent:s})}))}if(!n){var l=[o],c=function(n,i){a&&i instanceof Terrasoft.Collection?this._subscribeForCollectionChanged(e,t,r):this.setControlPropertyValue(e,i,r)};this.on("destroy",(function(){this.toggleSubscriptionForModelEvents(r,l,null,c,this)}),this),this.toggleSubscriptionForModelEvents(r,null,l,c,this)}},toggleSubscriptionForModelEvents:function(e,t,r,n,i){t&&t.length>0&&e.unsubscribeOnColumnChange(t.join(" change:"),n,i),r&&r.length>0&&e.subscribeOnColumnChange(r.join(" change:"),n,i)},getDependentProperties:function(e,t){t.setTrackingState(!0);try{var r=this.getModelMethod(e,t),n=this.tag?[this.tag]:[];this.callModelMethod(r,t,n)}finally{t.setTrackingState(!1)}return Terrasoft.keys(t.dependentProperties)},getModelMethod:function(e,t){return t[e.modelItem]},destroy:function(){Terrasoft.each(this.bindings,(function(e,t){this.unSubscribeForEvents(e,t,this.model)}),this),this.model=null},unSubscribeForEvents:function(e,t,r){switch(e.bindingType){case Terrasoft.BindingType.COLLECTION:this.unSubscribeForCollectionEvents(e,t,r);break;case Terrasoft.BindingType.EVENT:case Terrasoft.BindingType.PROPERTY:break;case Terrasoft.BindingType.METHOD:this.unSubscribeForDependentPropertiesChangeEvents(e,t,r)}},unSubscribeForCollectionEvents:function(e,t,r){if(r){var n=r.get(e.modelItem),i=this[e.config.changeMethod];this[t]=null,n.un(this.collectionLoadEventName,i,this),n.un("changed",this._onCollectionChanged.bind(this,e,t,r),this)}},unSubscribeForDependentPropertiesChangeEvents:function(e,t,r){r&&this.toggleSubscriptionForModelEvents(r,e.dependentProperties,null,e.handler,this)},callModelMethod:function(e,t,r){var n;return!0===this.safeBind?e&&(n=e.apply(t,r)):n=e.apply(t,r),n}}),Ext.define("Terrasoft.core.mixins.Droppable",{alternateClassName:"Terrasoft.Droppable",dropZoneHandlers:null,groupName:"draggable-group",dropZonePadding:-5,applyDropZoneAdditionalParameters:function(e){var t=this.dropZonePadding;e.setPadding(t,t,t,t),e.droppableInstance=this},initDropZones:function(){Ext.dd.DragDropManager.mode=1;var e=this.getDropZones();Terrasoft.each(e,(function(e){var t=e.initDDTarget(this.getGroupName(),this.getDropZoneInitDefaultConfig(),Ext.apply({},this.dropZoneHandlers));this.applyDropZoneAdditionalParameters(t)}),this)},getDropZones:function(){return[this.getWrapEl()]},getBindConfig:function(){return{groupName:{changeMethod:"setGroupName"}}},setGroupName:function(e){this.groupName=e},getGroupName:function(){return this.groupName},getDropZoneInitDefaultConfig:function(){return{}},clearDropZones:function(){var e=Ext.dd.DragDropManager.ids,t=this.getGroupName();if(e[t]){if(this.id===t)delete e[t];else{var r=Object.keys(Ext.dd.DragDropManager.ids[t]),n=Ext.Array.filter(r,(function(e){return Boolean(e.match(this.id))}),this);Terrasoft.each(n,(function(r){delete e[t][r]}),this)}Ext.dd.DragDropManager.refreshCache(t)}},onAfterRender:function(){this.isVisible()&&(this.clearDropZones(),this.initDropZones())},onAfterReRender:function(){this.isVisible()&&(this.clearDropZones(),this.initDropZones())},onDestroy:function(){this.rendered&&this.clearDropZones()}}),Ext.ns("Terrasoft.mixins.enums"),Terrasoft.mixins.enums.DragAction={MOVE:1,RESIZE_TOP:2,RESIZE_TOP_RIGHT:4,RESIZE_RIGHT:8,RESIZE_BOTTOM_RIGHT:16,RESIZE_BOTTOM:32,RESIZE_BOTTOM_LEFT:64,RESIZE_LEFT:128,RESIZE_TOP_LEFT:256,ALL:511},Terrasoft.DragAction=Terrasoft.mixins.enums.DragAction,Ext.define("Terrasoft.core.mixins.Draggable",{alternateClassName:"Terrasoft.Draggable",dragActionsCode:511,dropZoneHintClass:"drop-zone-hint",dropOverZoneHintClass:"dropover-zone-hint",showDropZoneHint:!0,showDropOverZoneHint:!1,dragCopy:!1,grabbedClassName:"draggable-item-grabbed",groupName:"draggable-group",dragZonePadding:0,init:Terrasoft.emptyFn,getDraggableElementIds:function(){var e=[];return Terrasoft.each(Terrasoft.DragAction,(function(t){var r=this.getActionDraggableConfig(t),n=r&&r.elementId;n&&e.push(n)}),this),e},applyDraggableCloneStyle:function(e,t){Ext.apply(e.style,t)},createDraggableClone:function(e,t,r){var n=Ext.dd.DragDropManager.dragCurrent;n.resetConstraints(!0),n.clearConstraints(),this.deleteDraggableClone();var i=this.getCloneId(),a=e.cloneNode(!0);a.classList.add(this.grabbedClassName);var s={position:"absolute",top:Ext.String.format("{0}px",r),left:Ext.String.format("{0}px",t)};return this.applyDraggableCloneStyle(a,s),a.id=i,n.setDragElId(i),a},getCloneId:function(){return this.id+"-draggable-clone"},appendDraggableClone:function(e){Ext.getBody().appendChild(e)},deleteDraggableClone:function(){var e=this.getCloneId(),t=Ext.get(e);t&&t.remove()},b4StartDrag:function(e,t){e=e||0,t=t||0;var r=this.getWrapEl();if(r){var n=this.createDraggableClone(r.dom,e,t);this.appendDraggableClone(n),r.setVisible(this.dragCopy)}this.showDropZoneHint&&this.setDropZoneHintVisible(!0)},b4DragOver:function(e,t){if(this.showDropOverZoneHint){var r=[];t.forEach((function(e){e.droppableInstance&&r.push(e.droppableInstance)}),this),r.length&&this.setDropOverZoneHintVisible(!0,r)}},b4DragOut:function(){this.showDropOverZoneHint&&this.setDropOverZoneHintVisible(!1)},getDefaultDraggableConfig:function(){var e=this.getWrapEl(),t={};return t[Terrasoft.DragAction.MOVE]={autoGenerateDraggableElement:!0,autoGenerateDraggableElementTpl:"<div id='{0}-draggable-item-move' class='draggable-item-move'>",elementId:e.id,getInitConfigMethod:Terrasoft.emptyFn,handlers:{b4StartDrag:"b4StartDrag",onInvalidDrop:"reRender",b4DragOver:"b4DragOver",b4DragOut:"b4DragOut"}},t[Terrasoft.DragAction.RESIZE_TOP]={autoGenerateDraggableElement:!0,autoGenerateDraggableElementTpl:"<div id='{0}-draggable-item-top' class='draggable-item-resize-top'></div>",elementId:Ext.String.format("{0}-draggable-item-top",this.id),getInitConfigMethod:Terrasoft.emptyFn,handlers:{onDrag:"onResizeTopElDrag",onInvalidDrop:"reRender"}},t[Terrasoft.DragAction.RESIZE_TOP_RIGHT]={autoGenerateDraggableElement:!0,autoGenerateDraggableElementTpl:"<div id='{0}-draggable-item-top-right' class='draggable-item-resize-top-right'></div>",elementId:Ext.String.format("{0}-draggable-item-top-right",this.id),getInitConfigMethod:Terrasoft.emptyFn,handlers:{onDrag:"onResizeTopRightElDrag",onInvalidDrop:"reRender"}},t[Terrasoft.DragAction.RESIZE_RIGHT]={autoGenerateDraggableElement:!0,autoGenerateDraggableElementTpl:"<div id='{0}-draggable-item-right' class='draggable-item-resize-right'></div>",elementId:Ext.String.format("{0}-draggable-item-right",this.id),getInitConfigMethod:Terrasoft.emptyFn,handlers:{onDrag:"onResizeRightElDrag",onInvalidDrop:"reRender"}},t[Terrasoft.DragAction.RESIZE_BOTTOM_RIGHT]={autoGenerateDraggableElement:!0,autoGenerateDraggableElementTpl:"<div id='{0}-draggable-item-bottom-right' class='draggable-item-resize-bottom-right'></div>",elementId:Ext.String.format("{0}-draggable-item-bottom-right",this.id),getInitConfigMethod:Terrasoft.emptyFn,handlers:{onDrag:"onResizeBottomRightElDrag",onInvalidDrop:"reRender"}},t[Terrasoft.DragAction.RESIZE_BOTTOM]={autoGenerateDraggableElement:!0,autoGenerateDraggableElementTpl:"<div id='{0}-draggable-item-bottom' class='draggable-item-resize-bottom'></div>",elementId:Ext.String.format("{0}-draggable-item-bottom",this.id),getInitConfigMethod:Terrasoft.emptyFn,handlers:{onDrag:"onResizeBottomElDrag",onInvalidDrop:"reRender"}},t[Terrasoft.DragAction.RESIZE_BOTTOM_LEFT]={autoGenerateDraggableElement:!0,autoGenerateDraggableElementTpl:"<div id='{0}-draggable-item-bottom-left' class='draggable-item-resize-bottom-left'></div>",elementId:Ext.String.format("{0}-draggable-item-bottom-left",this.id),getInitConfigMethod:Terrasoft.emptyFn,handlers:{onDrag:"onResizeBottomLeftElDrag",onInvalidDrop:"reRender"}},t[Terrasoft.DragAction.RESIZE_LEFT]={autoGenerateDraggableElement:!0,autoGenerateDraggableElementTpl:"<div id='{0}-draggable-item-left' class='draggable-item-resize-left'></div>",elementId:Ext.String.format("{0}-draggable-item-left",this.id),getInitConfigMethod:Terrasoft.emptyFn,handlers:{onDrag:"onResizeLeftElDrag",onInvalidDrop:"reRender"}},t[Terrasoft.DragAction.RESIZE_TOP_LEFT]={autoGenerateDraggableElement:!0,autoGenerateDraggableElementTpl:"<div id='{0}-draggable-item-top-left' class='draggable-item-resize-top-left'></div>",elementId:Ext.String.format("{0}-draggable-item-top-left",this.id),getInitConfigMethod:Terrasoft.emptyFn,handlers:{onDrag:"onResizeTopLeftElDrag",onInvalidDrop:"reRender"}},t},onResizeTopElDrag:function(e){this.animateSizeChanging({top:e.xy[1]})},onResizeBottomElDrag:function(e){this.animateSizeChanging({bottom:e.xy[1]})},onResizeRightElDrag:function(e){this.animateSizeChanging({right:e.xy[0]})},onResizeLeftElDrag:function(e){this.animateSizeChanging({left:e.xy[0]})},onResizeTopLeftElDrag:function(e){this.animateSizeChanging({left:e.xy[0],top:e.xy[1]})},onResizeTopRightElDrag:function(e){this.animateSizeChanging({right:e.xy[0],top:e.xy[1]})},onResizeBottomRightElDrag:function(e){this.animateSizeChanging({right:e.xy[0],bottom:e.xy[1]})},onResizeBottomLeftElDrag:function(e){this.animateSizeChanging({left:e.xy[0],bottom:e.xy[1]})},animateSizeChanging:function(e){var t=this.getWrapEl(),r=t.getRegion();Terrasoft.each(e,(function(e,t){r[t]=e}),this),t.setRegion(r)},getDraggableElementDefaultConfig:function(){return{isTarget:!1,instance:this}},initDraggableElement:function(e){var t=this.getActionDraggableConfig(e);if(t){var r=t&&t.elementId;t.autoGenerateDraggableElement&&this.generateDraggableElement(Ext.String.format(t.autoGenerateDraggableElementTpl,this.id));var n=this.bindConfigHandlers(t.handlers),i=Ext.get(r);if(i){var a=i.initDD(r,Ext.apply(this.getDraggableElementDefaultConfig(),t.getInitConfigMethod),n),s=this.dragZonePadding;s instanceof Array?a.setPadding.apply(a,s):a.setPadding(s,s,s,s);var o=this.getGroupName();Ext.isArray(o)?Terrasoft.each(o,(function(e){a.addToGroup(e)}),this):a.addToGroup(o)}}},getActionDraggableConfig:function(e){this.defaultDraggableConfig||(this.defaultDraggableConfig=this.getDefaultDraggableConfig());var t=this.defaultDraggableConfig||{},r=this.getDraggableConfig()||{};return Ext.Object.merge(t[e],r[e])},bindConfigHandlers:function(e){var t={};return Terrasoft.each(e,(function(e,r){var n=Ext.isFunction(e)?e:this[e];if(!n)throw new Terrasoft.NullOrEmptyException;if(!Ext.isFunction(n))throw new Terrasoft.UnsupportedTypeException;t[r]=n.bind(this)}),this),t},generateDraggableElement:function(e){this.getWrapEl().insertHtml("beforeEnd",e)},initDraggable:function(){Ext.dd.DragDropManager.notifyOccluded=!0,Terrasoft.each(Terrasoft.DragAction,(function(e){(this.dragActionsCode&e)===e&&this.initDraggableElement(e)}),this)},getBindConfig:function(){return{groupName:{changeMethod:"setGroupName"}}},setGroupName:function(e){this.groupName=e},getGroupName:function(){return this.groupName},getDraggableConfig:Terrasoft.emptyFn,getGroupDropZoneInstances:function(e){var t={},r=Ext.dd.DragDropManager.ids[e];return Terrasoft.each(r,(function(e){if(e.isTarget){var r=e.droppableInstance;r&&!t[r.id]&&(t[r.id]=r)}}),this),t},getDropZoneInstances:function(){var e={},t=this.getGroupName();return Ext.isArray(t)?Terrasoft.each(t,(function(t){Ext.apply(e,this.getGroupDropZoneInstances(t))}),this):Ext.isString(t)&&Ext.apply(e,this.getGroupDropZoneInstances(t)),e},setDropZoneHintVisible:function(e){var t=this.getDropZoneInstances();Terrasoft.each(t,(function(t){var r=t.getWrapEl();if(!r)return!0;e?r.addCls(this.dropZoneHintClass):r.removeCls(this.dropZoneHintClass)}),this)},setDropOverZoneHintVisible:function(e,t){t||(t=this.getDropZoneInstances()),Terrasoft.each(t,(function(t){var r=t.getWrapEl();e?r.addCls(this.dropOverZoneHintClass):r.removeCls(this.dropOverZoneHintClass)}),this)},getCurrentDraggableEl:function(){var e=Ext.dd.DragDropManager.dragCurrent;return e&&Ext.get(e.dragElId)},setDraggableElVisible:function(e){var t=this.getCurrentDraggableEl();t&&t.setVisible(e)},onAfterRender:function(){this.initDraggable()},onAfterReRender:function(){this.initDraggable(),this.deleteDraggableClone(),this.showDropZoneHint&&this.setDropZoneHintVisible(!1),this.showDropOverZoneHint&&this.setDropOverZoneHintVisible(!1)},onDestroy:function(){if(this.rendered){var e=Ext.dd.DragDropManager.ids,t=this.getDraggableElementIds(),r=this.getGroupName();Terrasoft.each(t,(function(t){delete e[t],Ext.isArray(r)?Terrasoft.each(r,(function(r){e[r]&&delete e[r][t]}),this):e[r]&&delete e[r][t]}),this)}}}),Ext.define("Terrasoft.core.mixins.Reorderable",{alternateClassName:"Terrasoft.Reorderable",reorderableElCls:"reorderable",reorderableElTpl:'<div id="{0}" class="{1}"></div>',reorderableIndex:null,zeroElClassName:"reorderable-zero-element",zeroElTpl:'<div id="{0}" class="{1}"></div>',viewModelItems:null,getDefaultItemConfig:function(e){var t=Ext.ClassManager.get(e).prototype.getBindConfig(),r={};return Terrasoft.each(Object.keys(t),(function(e){r[e]={bindTo:e}}),this),r},getItemConfig:function(e){var t=null;return Ext.isFunction(e.getViewConfig)&&(t=e.getViewConfig()),t},subscribeForCollectionEvents:function(e,t,r){var n=r.get(e.modelItem);"viewModelItems"===t&&(n.on("dataLoaded",this.onViewModelItemsLoad,this),n.on("add",this.onViewModelItemAdd,this),n.on("remove",this.onViewModelItemRemove,this),n.on("clear",this.onViewModelItemsClear,this))},unSubscribeForCollectionEvents:function(e,t,r){var n=r.get(e.modelItem);"viewModelItems"===t&&(n.un("dataLoaded",this.onViewModelItemsLoad,this),n.un("add",this.onViewModelItemAdd,this),n.un("remove",this.onViewModelItemRemove,this),n.un("clear",this.onViewModelItemsClear,this))},getBindConfig:function(){return{viewModelItems:{changeMethod:"onViewModelItemsLoad"},reorderableIndex:{changeMethod:"setReorderableIndex"}}},onViewModelItemsLoad:function(e){e.eachKey((function(e,t,r){this.onViewModelItemAdd(t,r,e)}),this)},onViewModelItemAdd:function(e,t){var r=this.getItemConfig(e),n=r.className;if(Ext.isEmpty(n))throw new Terrasoft.NullOrEmptyException;delete r.className;var i=Ext.create(n,r);i.bind(e),this.insert(i,t)},onViewModelItemsClear:function(){this.items.each((function(e){e.destroy()}),this),this.items.clear()},onViewModelItemRemove:function(e,t){var r=this.items.get(t);this.remove(r),r.destroy()},getReorderableId:function(){return this.id+"-reorderable"},removeReorderable:function(){var e=this.getReorderableId(),t=Ext.get(e);t&&t.remove()},showReorderable:function(){this.removeReorderable();var e=this.reorderableIndex;if(!Ext.isEmpty(e)){var t;-1===e?(t="beforeBegin",e=0):t="afterEnd";var r=this.getReorderableId(),n=Ext.String.format(this.reorderableElTpl,r,this.reorderableElCls),i=this.getItemByIndex(e);if(i)i.getWrapEl().insertHtml(t,n);else this.getRenderToEl().insertHtml("afterBegin",n)}},getItemByIndex:function(e){return this.items.getAt(e)},getZeroElementId:function(){return Ext.String.format("{0}-zero-element",this.wrapEl.id)},createZeroElement:function(){var e=this.getZeroElementId(),t=Ext.String.format(this.zeroElTpl,this.getZeroElementId(),this.zeroElClassName);this.insertZeroElement("afterBegin",t);var r=Ext.get(e).initDD(e,{isTarget:!0,instance:this,tag:e},{});if(Ext.isFunction(this.getGroupName)){var n=this.getGroupName();Ext.isArray(n)?Terrasoft.each(n,(function(e){r.addToGroup(e)}),this):r.addToGroup(n)}},insertZeroElement:function(e,t){this.wrapEl.insertHtml(e,t)},onAfterRender:function(){this.createZeroElement()},onAfterReRender:function(){this.createZeroElement()},onDestroy:function(){if(Ext.isFunction(this.getGroupName)&&this.rendered){var e=this.getZeroElementId(),t=Ext.dd.DragDropManager.ids,r=this.getGroupName();delete t[e],Ext.isArray(r)?Terrasoft.each(r,(function(r){delete t[r][e]}),this):t[r]&&delete t[r][e]}},setReorderableIndex:function(e){this.reorderableIndex!==e&&(this.reorderableIndex=e,Terrasoft.throttle(this.showReorderable(),500))}}),Ext.define("Terrasoft.controls.mixins.Tooltip",{alternateClassName:"Terrasoft.Tooltip",showTooltip:!1,tooltipText:"",tooltipClassName:"ts-component-tooltip",getTooltipClass:function(){return this.isTooltipEnabled()?this.tooltipClassName:""},getTooltipTextAttribute:function(){return this.isTooltipEnabled()?' data-tooltip-text="'+this.getEncodedTooltipText()+'" ':""},getEncodedTooltipText:function(){return Terrasoft.encodeHtml(this.tooltipText)},isTooltipEnabled:function(){return this.showTooltip&&!Ext.isEmpty(this.tooltipText)},addTooltipBindConfig:function(e){e.showTooltip={changeMethod:"setShowTooltip"},e.tooltipText={changeMethod:"setTooltipText"}},setShowTooltip:function(e){this.showTooltip!==e&&(this.showTooltip=e,this.updateTooltipTextAttr())},setTooltipText:function(e){this.tooltipText!==e&&(this.tooltipText=e,this.updateTooltipTextAttr())},updateTooltipTextAttr:function(){var e=this.getWrapEl();e&&e.dom&&(this.isTooltipEnabled()?(e.set({"data-tooltip-text":this.getEncodedTooltipText()}),e.addCls(this.tooltipClassName)):(e.dom.removeAttribute("data-tooltip-text"),e.removeCls(this.tooltipClassName)))}}),Ext.ns("Terrasoft.mixins.enums"),Terrasoft.AlignType={TOP:"top",LEFT:"left",BOTTOM:"bottom",RIGHT:"right",TOP_LEFT:"topLeft"},Terrasoft.mixins.enums.AlignType=Terrasoft.AlignType,Ext.define("Terrasoft.controls.mixins.Alignable",{extend:"Terrasoft.core.BaseObject",alternateClassName:"Terrasoft.Alignable",alignConfig:null,useAlignElContentBox:!0,initialAlignType:null,alignToEl:null,restrictAlignType:null,getSizes:function(e,t){var r=t.getBox(this.useAlignElContentBox),n=e.getBox(),i=Ext.getBody().getBox(),a=t.dom.getBoundingClientRect(),s=i.height,o=i.width,l={wrapElBox:n,alignToElBox:r,bodyBox:i},c={};c[Terrasoft.AlignType.TOP]=a.top,c[Terrasoft.AlignType.BOTTOM]=s-a.top-r.height,c[Terrasoft.AlignType.LEFT]=a.left,c[Terrasoft.AlignType.RIGHT]=o-a.left-r.width;var u=(n.width-r.width)/2,h=(n.height-r.height)/2;return l.availableSpaceBox=c,l.offsetData={x:{left:c[Terrasoft.AlignType.LEFT]-u,right:c[Terrasoft.AlignType.RIGHT]-u},y:{right:c[Terrasoft.AlignType.BOTTOM]-h,left:c[Terrasoft.AlignType.TOP]-h}},l},getAlignConfig:function(e,t){var r=this.getSizes(e,t),n=null,i=this.getPositionOptions(),a=this.getAlignOrder();return Terrasoft.each(a,(function(e){var t=i[e],a=this.getAlignData(t.alignConfig,r);if(Ext.apply(t,a),1===t.solutionWeight)return n=t,!1;(!n||t.solutionWeight>(n.solutionWeight||0))&&(n=t)}),this),n},checkAvailableSpace:function(e,t){var r=[Terrasoft.AlignType.LEFT,Terrasoft.AlignType.RIGHT].indexOf(t)>-1?"width":"height";return e.availableSpaceBox[t]>e.wrapElBox[r]},updateSideOffset:function(e,t,r){var n=t.offsetAxis,i=t.availableSpace;e.offset[n]=i;var a=r.wrapElBox["x"===n?"width":"height"];e.solutionWeight=(a-Math.abs(i))/a*100},calculateOffset:function(e,t,r){var n=r.offsetAxis,i=t.offsetData[n],a={offsetAxis:n};i.left<0&&(a.availableSpace=-1*i.left,this.updateSideOffset(e,a,t)),i.right<0&&(i.left<0?e.solutionWeight=0:(a.availableSpace=i.right,this.updateSideOffset(e,a,t)))},getPositionOptions:function(){var e=Terrasoft.getIsRtlMode();return{top:{className:"align-top",alignType:"bc-tc",alignConfig:{alignType:Terrasoft.AlignType.TOP,offsetAxis:"x"}},bottom:{className:"align-bottom",alignType:"tc-bc",alignConfig:{alignType:Terrasoft.AlignType.BOTTOM,offsetAxis:"x"}},right:{className:"align-right",alignType:e?"r-l":"l-r",alignConfig:{alignType:e?Terrasoft.AlignType.LEFT:Terrasoft.AlignType.RIGHT,offsetAxis:"y"}},left:{className:"align-left",alignType:e?"l-r":"r-l",alignConfig:{alignType:e?Terrasoft.AlignType.RIGHT:Terrasoft.AlignType.LEFT,offsetAxis:"y"}},topLeft:{className:"align-top-left",alignType:"tl-tl",alignConfig:{alignType:Terrasoft.AlignType.TOP_LEFT,offsetAxis:"x"}}}},getAlignOrder:function(){var e=[Terrasoft.AlignType.TOP,Terrasoft.AlignType.RIGHT,Terrasoft.AlignType.BOTTOM,Terrasoft.AlignType.LEFT];if(this.restrictAlignType&&(e=[this.restrictAlignType]),this.initialAlignType){var t=e.indexOf(this.initialAlignType);Terrasoft.rotateArray(e,t)}return e},getAlignData:function(e,t){var r={solutionWeight:0,offset:{x:null,y:null}};return this.checkAvailableSpace(t,e.alignType)&&(r.solutionWeight=1,this.calculateOffset(r,t,e)),r},applyAlignConfig:function(e,t,r){this.alignConfig&&Ext.isDefined(this.alignConfig.className)&&e.removeCls(this.alignConfig.className),e.addCls(r.className),this.alignConfig=r,e.alignTo(t,r.alignType,[r.offset.x,r.offset.y],!1)},getAlignToEl:function(){return this.alignToEl},adjustPosition:function(){var e=this.getAlignToEl(),t=this.getWrapEl();if(t&&e){var r=this.getAlignConfig(t,e);this.applyAlignConfig(t,e,r)}}}),Ext.ns("Terrasoft.controls.TipEnums"),Terrasoft.controls.TipEnums.displayEvent={CLICK:2,HOVER:1,NONE:-1},Terrasoft.TipDisplayEvent=Terrasoft.controls.TipEnums.displayEvent,Ext.define("Terrasoft.controls.mixins.ExpandableTip",{alternateClassName:"Terrasoft.ExpandableTip",extend:"Terrasoft.BaseObject",tips:null,tipClassName:"Terrasoft.Tip",hint:null,tipsConfig:null,getEventsConfig:function(e,t){return(t&Terrasoft.TipDisplayEvent.NONE)===Terrasoft.TipDisplayEvent.NONE?null:((t&Terrasoft.TipDisplayEvent.CLICK)===Terrasoft.TipDisplayEvent.CLICK&&(r={click:{fn:this.onAlignToElClick.bind(this,e)}}),(Ext.isEmpty(t)||(t&Terrasoft.TipDisplayEvent.HOVER)===Terrasoft.TipDisplayEvent.HOVER)&&(r=Ext.merge(r||{},{mouseenter:{fn:this.onAlignToElMouseEnter.bind(this,e)},mouseleave:{fn:this.onAlignToElMouseLeave.bind(this,e)},mousedown:{fn:this.onAlignToElMouseDown.bind(this,e),scope:this}})),r);var r},onAlignToElMouseDown:function(e,t){this.lastMouseDownEventXY=t.getXY(),this.getTipDisplaySourceEvent(e)===Terrasoft.TipDisplayEvent.HOVER&&this.isHideOnMouseDown(e)&&e.hide()},onBeforeTipVisibilityChange:function(e,t,r){if(t===Terrasoft.controls.TipEnums.visibilityChangeEvent.HIDE_ON_DOCUMENT_MOUSE_DOWN&&this.getTipDisplaySourceEvent(e)!==Terrasoft.TipDisplayEvent.CLICK&&!this.isHideOnMouseDown(e)&&r&&this.isEventWithin(r))return!1;t===Terrasoft.controls.TipEnums.visibilityChangeEvent.HIDE&&this.setTipDisplaySourceEvent(e,null)},getTipDisplaySourceEvent:function(e){return(this.tipsConfig[e.id]||{}).displaySourceEvent},setTipDisplaySourceEvent:function(e,t){this.tipsConfig[e.id].displaySourceEvent=t},isHideOnMouseDown:function(e){var t=!0,r=this.tipsConfig[e.id]||{};return Ext.isDefined(r.hideOnMouseDown)&&(t=Boolean(r.hideOnMouseDown)),t},onAlignToElClick:function(e){this.setTipDisplaySourceEvent(e,Terrasoft.TipDisplayEvent.CLICK),e.show()},onAlignToElMouseEnter:function(e,t){var r=t.getXY(),n=this.lastMouseDownEventXY;n&&r[0]===n[0]&&r[1]===n[1]||(this.setTipDisplaySourceEvent(e,Terrasoft.TipDisplayEvent.HOVER),e.show({delayed:!0}))},onAlignToElMouseLeave:function(e){this.getTipDisplaySourceEvent(e)===Terrasoft.TipDisplayEvent.HOVER&&e.hide({delayed:!0})},getHintConfig:function(e){return{tip:{className:this.tipClassName,displayMode:Terrasoft.TipDisplayMode.NARROW,content:e.hint,tag:e.tag,markerValue:e.hint},settings:{displayEvent:Terrasoft.TipDisplayEvent.HOVER}}},initTip:function(e){var t=e.tip;if(!t)throw new Terrasoft.ArgumentNullOrEmptyException({argumentName:"tipConfig.tip"});var r=!0===t.isComponent?t:Ext.create(t.className||this.tipClassName,t),n=e.settings||{};n.eventsConfig=this.getEventsConfig(r,n.displayEvent),this.tipsConfig[r.id]=n,this.tips.add(r),r.on("beforeVisibilityChange",this.onBeforeTipVisibilityChange,this)},initDomEvents:function(){0!==this.tips.getCount()&&this.tips.each(this.initTipEvents,this)},clearDomListeners:function(){0!==this.tips.getCount()&&this.tips.each((function(e){var t=this.tipsConfig[e.id];e.alignToEl&&t.eventsConfig&&e.alignToEl.un(t.eventsConfig)}),this)},getAlignEl:function(e,t){var r;return t?(r=this[t],Ext.isFunction(r)&&(r=r.call(this,e.tag))):r=this.getWrapEl(),r},initTipEvents:function(e){var t=this.tipsConfig[e.id],r=this.getAlignEl(e,t.alignEl);e.alignToEl=r,r&&t.eventsConfig&&r.on(t.eventsConfig)},initTips:function(e){var t=e.tips||[];this.initHint(e,t),delete e.tips,Terrasoft.each(t,this.initTip,this)},initHint:function(e,t){if(e.hint){var r=this.getHintConfig(e);t.push(r),delete e.hint}},constructor:function(e){this.tips=new Ext.util.MixedCollection,this.tipsConfig={},Ext.isEmpty(e)||this.initTips(e)},bind:function(e){this.tips.each((function(t){t.bind(e)}),this)},destroy:function(){this.tips.each((function(e){e.destroy()}),this)}}),Ext.ns("Terrasoft.controls.mixins.enums"),Terrasoft.controls.mixins.enums.ResizeAction={RESIZE_TOP:{code:1,value:"n"},RESIZE_TOP_RIGHT:{code:2,value:"ne"},RESIZE_RIGHT:{code:4,value:"e"},RESIZE_BOTTOM_RIGHT:{code:8,value:"se"},RESIZE_BOTTOM:{code:16,value:"s"},RESIZE_BOTTOM_LEFT:{code:32,value:"sw"},RESIZE_LEFT:{code:64,value:"w"},RESIZE_TOP_LEFT:{code:128,value:"nw"},ALL:{code:255,value:"all"}},Terrasoft.ResizeAction=Terrasoft.controls.mixins.enums.ResizeAction,Ext.define("Terrasoft.controls.mixins.Resizable",{alternateClassName:"Terrasoft.Resizable",extend:"Terrasoft.BaseObject",resizer:null,resizerConfig:null,resizeActionsCode:255,resizable:!1,getResizeActions:function(){var e=Ext.emptyString;return Terrasoft.each(Terrasoft.ResizeAction,(function(t){(this.resizeActionsCode&t.code)===t.code&&(e+=Ext.String.format("{0} ",t.value))}),this),e.trim()},initElementResizerEvents:function(){this.resizer.on("resize",this.onResize,this),this.resizer.on("resizedrag",this.onResizeDrag,this)},initElementStartSize:function(){var e=this.resizer,t={width:e.width,height:e.height};this.fireEvent("onsizeinit",t,this),this.setSize(t)},createResizer:function(){return Ext.create("Ext.resizer.Resizer",this.getResizerConfig())},getResizerConfig:function(){var e=this.getResizeActions(),t={target:this.id,handles:e};return Ext.apply(t,this.resizerConfig),t},onResize:function(e,t,r){this.fireEvent("onsizechanged",{width:t,height:r},this)},onResizeDrag:function(e,t,r){this.fireEvent("onresizedrag",{width:t,height:r},this)},initResizeEvents:function(){this.addEvents("onsizechanged","onresizedrag","onsizeinit")},initResizer:function(){this.resizable&&(this.resizer=this.createResizer(),this.initElementResizerEvents(),this.initElementStartSize())},setSize:function(e){this.resizer.resizeTo(e.width,e.height)},getSize:function(){return this.resizer.target.getSize()}}),Ext.define("Terrasoft.mixins.ReorderableContainerVMMixin",{alternateClassName:"Terrasoft.ReorderableContainerVMMixin",preInit:function(){this.initAttributes(),this.initEvents();var e=Ext.create("Terrasoft.BaseViewModelCollection",{itemClass:this.get("DefaultItemClassName")});this.set("ViewModelItems",e)},initEvents:function(){this.addEvents("beforeItemMove")},initAttributes:function(){var e=this.columns;e.Name=e.Name||{type:Terrasoft.core.enums.ViewModelColumnType.VIRTUAL_COLUMN,caption:"Name",dataValueType:Terrasoft.core.enums.DataValueType.TEXT},e.ReorderableIndex=e.ReorderableIndex||{type:Terrasoft.core.enums.ViewModelColumnType.VIRTUAL_COLUMN,caption:"ReorderableIndex",dataValueType:Terrasoft.core.enums.DataValueType.INTEGER},e.ViewModelItems=e.ViewModelItems||{type:Terrasoft.core.enums.ViewModelColumnType.VIRTUAL_COLUMN,caption:"ViewModelItems",dataValueType:Terrasoft.core.enums.DataValueType.COLLECTION},e.Schema=e.Schema||{type:Terrasoft.core.enums.ViewModelColumnType.VIRTUAL_COLUMN,dataValueType:Terrasoft.core.enums.DataValueType.CUSTOM_OBJECT},e.DefaultItemClassName=e.DefaultItemClassName||{type:Terrasoft.core.enums.ViewModelColumnType.VIRTUAL_COLUMN,dataValueType:Terrasoft.core.enums.DataValueType.TEXT}},getViewModelItems:function(){return this.get("ViewModelItems")},indexOf:function(e){return this.getViewModelItems().getKeys().indexOf(e)},onDragOver:function(e,t){this.clearReorderableIndex();var r=this.getDragOverData(e,t);return r.isValid&&this.set("ReorderableIndex",r.reorderableIndex),r.isValid},getDragOverData:function(e,t){var r=this.indexOf(t);return r<0?r=this.getLastIndex(e):r--,{reorderableIndex:r,isValid:!0}},onDragDrop:function(e){this.moveItem(e)},addItem:function(e){var t=e.get("Id");this.get("ViewModelItems").add(t,e)},moveItem:function(e){var t=this.getMoveData(e);return!0===t.cancel?-1:(this.set("ReorderableIndex",null),!1===this.fireEvent("beforeItemMove",this,t)?-1:(this.move(t),t.targetIndex))},getReorderableIndex:function(){return this.get("ReorderableIndex")},getMoveData:function(e){var t=this.getReorderableIndex();if(Ext.isEmpty(t))return{cancel:!0};var r=this.findViewModeCollectionByKey(e),n=r.get(e),i=n.get("Id"),a=this.indexOf(e);(-1===a||t<a&&a>0)&&(t+=1);var s=this.get("ViewModelItems"),o=r.indexOf(n);return{item:n,itemId:i,sourceCollection:r,sourceIndex:o,targetCollection:s,targetIndex:t}},move:function(e){return e.sourceCollection.removeByKey(e.itemId),e.targetCollection.insert(e.targetIndex,e.itemId,e.item),e.targetIndex},onDragOut:function(){this.set("ReorderableIndex",null)},findViewModeCollectionByKey:function(e){var t=null,r=this.get("ViewModelItems");return r.contains(e)&&(t=r),t},clearReorderableIndex:function(){this.set("ReorderableIndex",null)},getLastIndex:function(e){var t=this.getViewModelItems().getCount()-1,r=this.indexOf(e);return r>-1&&t===r&&t--,t}}),Ext.define("Terrasoft.mixins.ReorderableItemMixin",{alternateClassName:"Terrasoft.ReorderableItemMixin",extend:"Terrasoft.Draggable",init:function(){this.callParent(arguments),this.addEvents("beforeStartDrag","onDragEnter","onDragOver","onDragOut","onDragDrop","onInvalidDrop")},dragActionsCode:Terrasoft.DragAction.MOVE,dragCopy:!1,showDropZoneHint:!1,container:null,getDraggableConfig:function(){var e={};return e[Terrasoft.DragAction.MOVE]={handlers:{b4StartDrag:"b4StartDrag",onDragEnter:"onDragEnter",onDragOver:"onDragOver",onDragOut:"onDragOut",onDragDrop:"onDragDrop",onInvalidDrop:"onInvalidDrop"}},e},b4StartDrag:function(){this.callParent(arguments),this.fireEvent("beforeStartDrag",this)},onDragEnter:function(e,t){this.onDrag(e,t,"onDragEnter")},onDragOver:function(e,t){this.onDrag(e,t,"onDragOver")},onDrag:function(e,t,r){var n=Ext.get(this.getCloneId()),i=Ext.util.Region.getRegion(n),a=this.findContainer(t,i);if(a){this.container=a;var s=this.findDragOverItems(t,a);a[r].call(a,this.id,i,s)}},onInvalidDrop:function(){this.reRender(),this.fireEvent("onInvalidDrop")},onDragOut:function(){var e=this.container;e&&e.onDragOut()},onDragDrop:function(){this.reRender();var e=this.container;e&&e.onDragDrop(this.id)},getDraggableElementDefaultConfig:function(){return{isTarget:!0,instance:this,tag:this.tag}},applyDraggableCloneStyle:function(e){this.callParent(arguments);var t=this.wrapEl.getHeight(),r=this.wrapEl.getWidth();e.style.height=t+"px",e.style.width=r+"px"},findDragOverItems:function(e,t){var r=[],n=Ext.util.Region.getRegion(t.getWrapEl());return Terrasoft.each(e,(function(e){if(!e.droppableInstance){var t=Ext.util.Region.getRegion(e.getEl());n.intersect(t)&&r.push(e)}}),this),r},findContainer:function(e,t){var r=null;return Terrasoft.each(e,(function(e){var n=e.droppableInstance;if(n){var i=Ext.util.Region.getRegion(e.getEl()).intersect(t),a=(t.right-t.left)/2;if(i.right-i.left>a)return r=n,!1}}),this),r}}),Ext.define("Terrasoft.mixins.ToolsMixin",{alternateClassName:"Terrasoft.ToolsMixin",extend:"Terrasoft.BaseObject",toolRenderTplName:"<@tool>",tools:null,init:function(){if(!(this instanceof Terrasoft.AbstractContainer))throw new Terrasoft.exceptions.UnsupportedTypeException;var e=this.tools,t=this.tools=new Ext.util.MixedCollection(!1,this.getComponentId);t.on("add",this.onToolAdd,this),t.on("remove",this.onToolRemove,this),this.addToolItem(e)},onToolAdd:function(e,t){t.added(this)},onToolRemove:function(e){e.removed(this),this.safeRerender()},applyToolsElSelector:function(e){Ext.apply(e,{toolsEl:"#"+this.id+"-tools"})},getToolsRenderToEl:function(){return this.toolsEl},processToolItemTemplate:function(e){var t=new RegExp(this.toolRenderTplName,"gim");return e.replace(t,"{%this.renderTool(out, values, xindex - 1)%}")},initRenderData:function(e){e.tools=this.tools,e.renderTools=this.renderTools,e.renderTool=this.renderTool},getToolsRenderTemplateTree:function(){var e=[],t=this.tools;if(!t)return e;for(var r=0,n=t.length;r<n;r++){var i=t.getAt(r).generateHtml();e.push(i)}return e},renderTools:function(e,t){var r=t.self.getToolsRenderTemplateTree();Ext.DomHelper.generateMarkup(r,e)},renderTool:function(e,t){var r=t.generateHtml();e.push(r)},onDestroy:function(){this.destroyTools(),this.callParent(arguments)},destroyTools:function(){this.destroyItemsCollection(this.tools),this.tools=null},bind:function(e){this.tools.each((function(t){t.bind(e)}))},addToolItem:function(e){this.addToCollection(e,this.tools)},insertToolItem:function(e,t){this.insertIntoCollection(e,t,this.tools)},removeToolItem:function(e){this.removeFromCollection(e,this.tools)},indexOfToolItem:function(e){return this.indexOfCollection(e,this.tools)}}),Ext.define("Terrasoft.mixins.DraggableContentElement",{extend:"Terrasoft.core.mixins.Draggable",alternateClassName:"Terrasoft.DraggableContentElement",dragActionsCode:Terrasoft.DragAction.MOVE,showDropZoneHint:!1,groupName:null,addDraggableEvents:function(){this.addEvents("ondragover","ondragout","ondragdrop","oninvaliddrop")},setColumnHintVisible:function(e,t){var r=t||this.container,n=r&&r.getWrapEl();n&&(e?n.addCls(this.dropZoneHintClass):n.removeCls(this.dropZoneHintClass))},b4StartDrag:function(e,t){e=e||0,t=t||0;var r=this.getWrapEl();r&&r.setOpacity(.3,!0);var n=r&&r.down(".content-element-tools-wrap",!1);if(n){var i=n.down("#"+this.id+"-dragg-el-wrapperEl",!1),a=this.createDraggableClone(i.dom,e,t);this.appendDraggableClone(a),n&&n.setVisible(!1)}},onDragEnter:Terrasoft.emptyFn,onDragOver:function(e,t){var r=t.filter((function(e){return"column"===e.config.itemType&&e.droppableInstance}));if(r.length){var n=r.find((function(e){return e.cursorIsOver}));n=n||r[0],this.container||(this.container=n.droppableInstance,this.setColumnHintVisible(!0)),this.container.id!==n.droppableInstance.id&&(this.setColumnHintVisible(!1),this.container.model.onElementDragOut(),this.container=n.droppableInstance,this.setColumnHintVisible(!0));var i=this.container.model,a=this.container.id,s=t.filter((function(e){return"element"===e.config.itemType&&e.config.columnId===a})),o=s.length&&s.find((function(e){return e.cursorIsOver}));!o&&s.length&&(o=s.find((function(e){return e.config.isZero})));var l=o&&o.config.id;i.onElementDragOver(l)}},onDragOut:function(e,t){var r=t.find((function(e){return"column"===e.config.itemType&&e.droppableInstance}));r&&(r.droppableInstance.model.onElementDragOut(),this.setColumnHintVisible(!1,r.droppableInstance),this.container&&this.container.id===r.droppableInstance.id&&(this.container=null))},onDragDrop:function(e,t){this.reRender();var r=this.container&&this.container.id;t.find((function(e){return"column"===e.config.itemType&&e.config.columnId===r&&e.droppableInstance}))&&(this.container.model.onElementDragDrop(this.model),this.setColumnHintVisible(!1),this.container=null)},onInvalidDrop:function(){this.reRender(),this.fireEvent("oninvaliddrop")}}),Ext.define("Terrasoft.mixins.DraggableContentBlock",{extend:"Terrasoft.core.mixins.Draggable",alternateClassName:"Terrasoft.DraggableContentBlock",dragActionsCode:Terrasoft.DragAction.MOVE,showDropZoneHint:!0,groupName:null,addDraggableEvents:function(){this.addEvents("ondragover","ondragdrop","ondragout","oninvaliddrop")},initDraggable:function(){if(this.callParent(arguments),this.isSelectable){var e=this.getWrapEl(),t=e.initDDTarget(this.getGroupName(),{id:this.id,itemType:"block"},{});t.droppableInstance=this}},removeDropZone:function(){var e=this.getWrapEl(),t=e&&e.id,r=Ext.dd.DragDropManager.ids,n=this.getGroupName(),i=n&&r[n];i&&delete i[t]},getDraggableElementDefaultConfig:function(){return{isTarget:!1,instance:this,tag:this.tag}},b4StartDrag:function(e,t){e=e||0,t=t||0;var r=this.getWrapEl();r&&r.setOpacity(.3,!0);var n=r&&r.down(".content-block-tools-wrap",!1);if(n){var i=n.down("#"+this.id+"dragg-el-wrapperEl",!1);if(i){var a=this.createDraggableClone(i.dom,e,t);this.appendDraggableClone(a)}n.setVisible(!1)}this.showDropZoneHint&&this.setDropZoneHintVisible(!0)},onDragEnter:Terrasoft.emptyFn,onDragOver:function(e,t){if(t.find((function(e){return"sheet"===e.config.itemType&&e.droppableInstance}))){var r=t.filter((function(e){return"block"===e.config.itemType})),n=r.length&&r.find((function(e){return e.cursorIsOver}));!n&&r.length&&(n=r.find((function(e){return e.config.isZero})));var i=n&&n.config.id;this.fireEvent("ondragover",i)}},onDragOut:function(e,t){var r=t.find((function(e){return"sheet"===e.config.itemType&&e.droppableInstance}));r&&r.droppableInstance.model.onItemDragOut()},onDragDrop:function(e,t){this.reRender(),this.fireEvent("ondragdrop")},onInvalidDrop:function(){this.reRender(),this.fireEvent("oninvaliddrop")}}),Ext.define("Terrasoft.mixins.SelectableContentBlock",{alternateClassName:"Terrasoft.SelectableContentBlock",extend:"Terrasoft.BaseObject",isSelectable:!1,selected:!1,selectedClass:"t-content-block-focus",tools:null,toolsWrapClasses:["content-block-tools-wrap"],addSelectedClass:function(e){this.selected&&e.wrapClassName.push(this.selectedClass)},applySelectedBindConfig:function(e){Ext.apply(e,{selected:{changeEvent:"selectedChanged",changeMethod:"setSelected"}})},setSelected:function(e){if(this.selected!==e&&this.isSelectable){this.selected=e;var t=this.selectedClass,r=this.getWrapEl();r&&t&&this.rendered&&(e?r.addCls(t):r.removeCls(t))}},onClick:function(){this.setSelected(!0),this.fireEvent("selectedChanged",!0,this)},subscribeForDomEvents:function(){var e=this.getWrapEl();e&&e.on({click:{fn:this.onClick,scope:this}})},bindTools:function(){this.tools.each((function(e){e.bind(this.model)}),this)},initTools:function(){var e=this.tools,t=this.tools=new Ext.util.MixedCollection(!1,this.getComponentId);t.on("add",this.onToolAdd,this),t.on("remove",this.onToolRemove,this),this.addToolItem(e)},renderTool:function(e,t){var r=t.generateHtml();e.push(r)},addToolsToRenderData:function(e){e.tools=this.tools,e.renderTool=this.renderTool},applyToolsTplData:function(e){this.isSelectable&&Ext.apply(e,{toolsWrapClasses:this.toolsWrapClasses,hasTools:this.tools&&this.tools.getCount()})},applyToolsSelector:function(e){Ext.apply(e,{toolsEl:"#"+this.id+"-content-block-tools"})},onToolAdd:function(e,t){t.added(this)},onToolRemove:Terrasoft.emptyFn,addToolItem:function(e){if(e){var t=this.tools,r=Ext.isArray(e)?e:[e];this.fireEvent("beforeadd",this,r,t);for(var n=0,i=r.length;n<i;n++){var a=r[n];!0!==a.isComponent&&(a=r[n]=Ext.create(a.className||"Terrasoft.Component",a)),t.add(a)}this.fireEvent("add",this,r,t)}},indexOfToolItem:function(e){return this.indexOfCollection(e,this.tools)},destroyTools:function(){this.destroyItemsCollection(this.tools),this.tools=null}}),Ext.define("Terrasoft.mixins.ContentBlockMixin",{alternateClassName:"Terrasoft.ContentBlockMixin",getSelectors:function(){return{wrapEl:"#"+this.id+"-"+this.itemName}},applyTplClasses:function(e){Ext.Object.each(this.tplConfigClasses,(function(t,r){var n=e[t]||[];e[t]=n.concat(r)}))},getItemConfig:function(e){var t=null;return Ext.isFunction(e.getViewConfig)&&((t=e.getViewConfig()).id=e.$Id,Ext.isEmpty(t.id)&&this.log(Terrasoft.Resources.ContentBlock.PrimaryColumnIsEmpty,Terrasoft.LogMessageType.WARNING)),t},prepareBlockItems:function(e){if(!Ext.isArray(e))throw new Terrasoft.UnsupportedTypeException;for(var t=0,r=e.length;t<r;t++){var n=e[t],i=Terrasoft.instanceOfClass(n,"Terrasoft.BaseModel")?this.getItemConfig(n):n.item;!0===i.isComponent?e[t]=i:(e[t]=Ext.create(i.className||"Terrasoft.Component",i),Terrasoft.instanceOfClass(n,"Terrasoft.BaseModel")&&e[t].bind(n))}return e},applyBlockBindConfig:function(e){Ext.apply(e,{items:{changeMethod:"onCollectionDataLoaded"}})},onAddItem:function(e){this.add(e)},onUpdateItem:function(e,t){t.reRenderBlock&&this.allowRerender()&&this.reRender()},onDeleteItem:function(e){var t=e.$Id,r=this.items.get(t);this.remove(r),this.destroyItem(r)},clearItems:function(){this.items.each((function(e){this.remove(e),this.destroyItem(e)}),this)},onCollectionDataLoaded:function(e){this.clearItems(),e&&e.each((function(e){this.addToCollection(e,this.items)}),this)},subscribeCollection:function(e){e.on("dataLoaded",this.onCollectionDataLoaded,this),e.on("itemChanged",this.onUpdateItem,this),e.on("add",this.onAddItem,this),e.on("remove",this.onDeleteItem,this),e.on("clear",this.clearItems,this)},unSubscribeCollection:function(e){e.un("dataLoaded",this.onCollectionDataLoaded,this),e.un("itemChanged",this.onUpdateItem,this),e.un("add",this.onAddItem,this),e.un("remove",this.onDeleteItem,this),e.un("clear",this.clearItems,this)}}),Ext.ns("Terrasoft.exporters.enums"),Terrasoft.core.enums.ExportedItemType={SHEET:"sheet",BLOCKGROUP:"blockgroup",BLOCK:"block",TEXT:"text",IMAGE:"image",HTML:"html",SEPARATOR:"separator",BUTTON:"button"},Terrasoft.ExportedItemType=Terrasoft.core.enums.ExportedItemType,Ext.define("Terrasoft.exporters.BaseContentExporter",{extend:"Terrasoft.BaseObject",alternateClassName:"Terrasoft.BaseContentExporter",exportSheet:Terrasoft.abstractFn,exportBlockGroup:Terrasoft.abstractFn,exportBlock:Terrasoft.abstractFn,exportText:Terrasoft.abstractFn,exportImage:Terrasoft.abstractFn,exportButton:Terrasoft.abstractFn,exportHtml:Terrasoft.abstractFn,exportSeparator:Terrasoft.abstractFn,findSingleBlockByType:function(e,t){var r=e||{};return t&&r.ItemType===t?r:r.Items&&1===r.Items.length?this.findSingleBlockByType(r.Items[0],t):null},findSingleHtmlBlock:function(e){var t=null,r=this.findSingleBlockByType(e,this.ExportedItemType.BLOCK);return r&&(t=this.findSingleBlockByType(r,this.ExportedItemType.HTML)),t},exportItem:function(e){var t=null;switch(e.ItemType){case Terrasoft.ExportedItemType.SHEET:t=this.exportSheet(e);break;case Terrasoft.ExportedItemType.BLOCKGROUP:t=this.exportBlockGroup(e);break;case Terrasoft.ExportedItemType.BLOCK:t=this.exportBlock(e);break;case Terrasoft.ExportedItemType.TEXT:t=this.exportText(e);break;case Terrasoft.ExportedItemType.IMAGE:t=this.exportImage(e);break;case Terrasoft.ExportedItemType.HTML:t=this.exportHtml(e);break;case Terrasoft.ExportedItemType.SEPARATOR:t=this.exportSeparator(e);break;case Terrasoft.ExportedItemType.BUTTON:t=this.exportButton(e);break;default:throw Ext.create("Terrasoft.NotImplementedException")}return t},exportData:function(e){var t=Terrasoft.deepClone(e);return this.exportItem(t)}}),function(){Ext.ns("Terrasoft.utils");var e=function t(r,n,i){function a(o,l){if(!n[o]){if(!r[o]){var c="function"==typeof e&&e;if(!l&&c)return c(o,!0);if(s)return s(o,!0);var u=new Error("Cannot find module '"+o+"'");throw u.code="MODULE_NOT_FOUND",u}var h=n[o]={exports:{}};r[o][0].call(h.exports,(function(e){return a(r[o][1][e]||e)}),h,h.exports,t,r,n,i)}return n[o].exports}for(var s="function"==typeof e&&e,o=0;o<i.length;o++)a(i[o]);return a}({1:[function(e,t,r){"use strict";r.byteLength=function(e){var t=c(e),r=t[0],n=t[1];return 3*(r+n)/4-n},r.toByteArray=function(e){for(var t,r=c(e),n=r[0],s=r[1],o=new a(3*(n+(f=s))/4-f),l=0,u=0<s?n-4:n,h=0;h<u;h+=4)t=i[e.charCodeAt(h)]<<18|i[e.charCodeAt(h+1)]<<12|i[e.charCodeAt(h+2)]<<6|i[e.charCodeAt(h+3)],o[l++]=t>>16&255,o[l++]=t>>8&255,o[l++]=255&t;var f;return 2===s&&(t=i[e.charCodeAt(h)]<<2|i[e.charCodeAt(h+1)]>>4,o[l++]=255&t),1===s&&(t=i[e.charCodeAt(h)]<<10|i[e.charCodeAt(h+1)]<<4|i[e.charCodeAt(h+2)]>>2,o[l++]=t>>8&255,o[l++]=255&t),o},r.fromByteArray=function(e){for(var t,r=e.length,i=r%3,a=[],s=0,o=r-i;s<o;s+=16383)a.push(u(e,s,o<s+16383?o:s+16383));return 1===i?(t=e[r-1],a.push(n[t>>2]+n[t<<4&63]+"==")):2===i&&(t=(e[r-2]<<8)+e[r-1],a.push(n[t>>10]+n[t>>4&63]+n[t<<2&63]+"=")),a.join("")};for(var n=[],i=[],a="undefined"!=typeof Uint8Array?Uint8Array:Array,s="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",o=0,l=s.length;o<l;++o)n[o]=s[o],i[s.charCodeAt(o)]=o;function c(e){var t=e.length;if(0<t%4)throw new Error("Invalid string. Length must be a multiple of 4");var r=e.indexOf("=");return-1===r&&(r=t),[r,r===t?0:4-r%4]}function u(e,t,r){for(var i,a,s=[],o=t;o<r;o+=3)i=(e[o]<<16&16711680)+(e[o+1]<<8&65280)+(255&e[o+2]),s.push(n[(a=i)>>18&63]+n[a>>12&63]+n[a>>6&63]+n[63&a]);return s.join("")}i["-".charCodeAt(0)]=62,i["_".charCodeAt(0)]=63},{}],2:[function(e,t,r){},{}],3:[function(e,t,r){arguments[4][2][0].apply(r,arguments)},{dup:2}],4:[function(e,t,r){"use strict";var n=e("base64-js"),i=e("ieee754");r.Buffer=o,r.SlowBuffer=function(e){return+e!=e&&(e=0),o.alloc(+e)},r.INSPECT_MAX_BYTES=50;var a=2147483647;function s(e){if(a<e)throw new RangeError('The value "'+e+'" is invalid for option "size"');var t=new Uint8Array(e);return t.__proto__=o.prototype,t}function o(e,t,r){if("number"!=typeof e)return l(e,t,r);if("string"==typeof t)throw new TypeError('The "string" argument must be of type string. Received type number');return u(e)}function l(e,t,r){if("string"==typeof e)return function(e,t){if("string"==typeof t&&""!==t||(t="utf8"),!o.isEncoding(t))throw new TypeError("Unknown encoding: "+t);var r=0|d(e,t),n=s(r),i=n.write(e,t);return i!==r&&(n=n.slice(0,i)),n}(e,t);if(ArrayBuffer.isView(e))return h(e);if(null==e)throw TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+_typeof(e));if(L(e,ArrayBuffer)||e&&L(e.buffer,ArrayBuffer))return function(e,t,r){if(t<0||e.byteLength<t)throw new RangeError('"offset" is outside of buffer bounds');if(e.byteLength<t+(r||0))throw new RangeError('"length" is outside of buffer bounds');var n;return(n=void 0===t&&void 0===r?new Uint8Array(e):void 0===r?new Uint8Array(e,t):new Uint8Array(e,t,r)).__proto__=o.prototype,n}(e,t,r);if("number"==typeof e)throw new TypeError('The "value" argument must not be of type number. Received type number');var n=e.valueOf&&e.valueOf();if(null!=n&&n!==e)return o.from(n,t,r);var i=function(e){if(o.isBuffer(e)){var t=0|f(e.length),r=s(t);return 0===r.length||e.copy(r,0,0,t),r}return void 0!==e.length?"number"!=typeof e.length||F(e.length)?s(0):h(e):"Buffer"===e.type&&Array.isArray(e.data)?h(e.data):void 0}(e);if(i)return i;if("undefined"!=typeof Symbol&&null!=Symbol.toPrimitive&&"function"==typeof e[Symbol.toPrimitive])return o.from(e[Symbol.toPrimitive]("string"),t,r);throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+_typeof(e))}function c(e){if("number"!=typeof e)throw new TypeError('"size" argument must be of type number');if(e<0)throw new RangeError('The value "'+e+'" is invalid for option "size"')}function u(e){return c(e),s(e<0?0:0|f(e))}function h(e){for(var t=e.length<0?0:0|f(e.length),r=s(t),n=0;n<t;n+=1)r[n]=255&e[n];return r}function f(e){if(a<=e)throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+a.toString(16)+" bytes");return 0|e}function d(e,t){if(o.isBuffer(e))return e.length;if(ArrayBuffer.isView(e)||L(e,ArrayBuffer))return e.byteLength;if("string"!=typeof e)throw new TypeError('The "string" argument must be one of type string, Buffer, or ArrayBuffer. Received type '+_typeof(e));var r=e.length,n=2<arguments.length&&!0===arguments[2];if(!n&&0===r)return 0;for(var i=!1;;)switch(t){case"ascii":case"latin1":case"binary":return r;case"utf8":case"utf-8":return N(e).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*r;case"hex":return r>>>1;case"base64":return k(e).length;default:if(i)return n?-1:N(e).length;t=(""+t).toLowerCase(),i=!0}}function p(e,t,r){var n=e[t];e[t]=e[r],e[r]=n}function m(e,t,r,n,i){if(0===e.length)return-1;if("string"==typeof r?(n=r,r=0):2147483647<r?r=2147483647:r<-2147483648&&(r=-2147483648),F(r=+r)&&(r=i?0:e.length-1),r<0&&(r=e.length+r),r>=e.length){if(i)return-1;r=e.length-1}else if(r<0){if(!i)return-1;r=0}if("string"==typeof t&&(t=o.from(t,n)),o.isBuffer(t))return 0===t.length?-1:g(e,t,r,n,i);if("number"==typeof t)return t&=255,"function"==typeof Uint8Array.prototype.indexOf?i?Uint8Array.prototype.indexOf.call(e,t,r):Uint8Array.prototype.lastIndexOf.call(e,t,r):g(e,[t],r,n,i);throw new TypeError("val must be string, number or Buffer")}function g(e,t,r,n,i){var a,s=1,o=e.length,l=t.length;if(void 0!==n&&("ucs2"===(n=String(n).toLowerCase())||"ucs-2"===n||"utf16le"===n||"utf-16le"===n)){if(e.length<2||t.length<2)return-1;o/=s=2,l/=2,r/=2}function c(e,t){return 1===s?e[t]:e.readUInt16BE(t*s)}if(i){var u=-1;for(a=r;a<o;a++)if(c(e,a)===c(t,-1===u?0:a-u)){if(-1===u&&(u=a),a-u+1===l)return u*s}else-1!==u&&(a-=a-u),u=-1}else for(o<r+l&&(r=o-l),a=r;0<=a;a--){for(var h=!0,f=0;f<l;f++)if(c(e,a+f)!==c(t,f)){h=!1;break}if(h)return a}return-1}function T(e,t,r,n){r=Number(r)||0;var i=e.length-r;n?i<(n=Number(n))&&(n=i):n=i;var a=t.length;a/2<n&&(n=a/2);for(var s=0;s<n;++s){var o=parseInt(t.substr(2*s,2),16);if(F(o))return s;e[r+s]=o}return s}function y(e,t,r,n){return O(function(e){for(var t=[],r=0;r<e.length;++r)t.push(255&e.charCodeAt(r));return t}(t),e,r,n)}function v(e,t,r){return 0===t&&r===e.length?n.fromByteArray(e):n.fromByteArray(e.slice(t,r))}function E(e,t,r){r=Math.min(e.length,r);for(var n=[],i=t;i<r;){var a,s,o,l,c=e[i],u=null,h=239<c?4:223<c?3:191<c?2:1;if(i+h<=r)switch(h){case 1:c<128&&(u=c);break;case 2:128==(192&(a=e[i+1]))&&127<(l=(31&c)<<6|63&a)&&(u=l);break;case 3:a=e[i+1],s=e[i+2],128==(192&a)&&128==(192&s)&&2047<(l=(15&c)<<12|(63&a)<<6|63&s)&&(l<55296||57343<l)&&(u=l);break;case 4:a=e[i+1],s=e[i+2],o=e[i+3],128==(192&a)&&128==(192&s)&&128==(192&o)&&65535<(l=(15&c)<<18|(63&a)<<12|(63&s)<<6|63&o)&&l<1114112&&(u=l)}null===u?(u=65533,h=1):65535<u&&(u-=65536,n.push(u>>>10&1023|55296),u=56320|1023&u),n.push(u),i+=h}return function(e){var t=e.length;if(t<=C)return String.fromCharCode.apply(String,e);for(var r="",n=0;n<t;)r+=String.fromCharCode.apply(String,e.slice(n,n+=C));return r}(n)}r.kMaxLength=a,(o.TYPED_ARRAY_SUPPORT=function(){try{var e=new Uint8Array(1);return e.__proto__={__proto__:Uint8Array.prototype,foo:function(){return 42}},42===e.foo()}catch(e){return!1}}())||"undefined"==typeof console||"function"!=typeof console.error||console.error("This browser lacks typed array (Uint8Array) support which is required by `buffer` v5.x. Use `buffer` v4.x if you require old browser support."),Object.defineProperty(o.prototype,"parent",{enumerable:!0,get:function(){if(o.isBuffer(this))return this.buffer}}),Object.defineProperty(o.prototype,"offset",{enumerable:!0,get:function(){if(o.isBuffer(this))return this.byteOffset}}),"undefined"!=typeof Symbol&&null!=Symbol.species&&o[Symbol.species]===o&&Object.defineProperty(o,Symbol.species,{value:null,configurable:!0,enumerable:!1,writable:!1}),o.poolSize=8192,o.from=function(e,t,r){return l(e,t,r)},o.prototype.__proto__=Uint8Array.prototype,o.__proto__=Uint8Array,o.alloc=function(e,t,r){return i=t,a=r,c(n=e),n<=0?s(n):void 0!==i?"string"==typeof a?s(n).fill(i,a):s(n).fill(i):s(n);var n,i,a},o.allocUnsafe=function(e){return u(e)},o.allocUnsafeSlow=function(e){return u(e)},o.isBuffer=function(e){return null!=e&&!0===e._isBuffer&&e!==o.prototype},o.compare=function(e,t){if(L(e,Uint8Array)&&(e=o.from(e,e.offset,e.byteLength)),L(t,Uint8Array)&&(t=o.from(t,t.offset,t.byteLength)),!o.isBuffer(e)||!o.isBuffer(t))throw new TypeError('The "buf1", "buf2" arguments must be one of type Buffer or Uint8Array');if(e===t)return 0;for(var r=e.length,n=t.length,i=0,a=Math.min(r,n);i<a;++i)if(e[i]!==t[i]){r=e[i],n=t[i];break}return r<n?-1:n<r?1:0},o.isEncoding=function(e){switch(String(e).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},o.concat=function(e,t){if(!Array.isArray(e))throw new TypeError('"list" argument must be an Array of Buffers');if(0===e.length)return o.alloc(0);var r;if(void 0===t)for(r=t=0;r<e.length;++r)t+=e[r].length;var n=o.allocUnsafe(t),i=0;for(r=0;r<e.length;++r){var a=e[r];if(L(a,Uint8Array)&&(a=o.from(a)),!o.isBuffer(a))throw new TypeError('"list" argument must be an Array of Buffers');a.copy(n,i),i+=a.length}return n},o.byteLength=d,o.prototype._isBuffer=!0,o.prototype.swap16=function(){var e=this.length;if(e%2!=0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var t=0;t<e;t+=2)p(this,t,t+1);return this},o.prototype.swap32=function(){var e=this.length;if(e%4!=0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var t=0;t<e;t+=4)p(this,t,t+3),p(this,t+1,t+2);return this},o.prototype.swap64=function(){var e=this.length;if(e%8!=0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var t=0;t<e;t+=8)p(this,t,t+7),p(this,t+1,t+6),p(this,t+2,t+5),p(this,t+3,t+4);return this},o.prototype.toLocaleString=o.prototype.toString=function(){var e=this.length;return 0===e?"":0===arguments.length?E(this,0,e):function(e,t,r){var n=!1;if((void 0===t||t<0)&&(t=0),t>this.length)return"";if((void 0===r||r>this.length)&&(r=this.length),r<=0)return"";if((r>>>=0)<=(t>>>=0))return"";for(e||(e="utf8");;)switch(e){case"hex":return I(this,t,r);case"utf8":case"utf-8":return E(this,t,r);case"ascii":return b(this,t,r);case"latin1":case"binary":return S(this,t,r);case"base64":return v(this,t,r);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return x(this,t,r);default:if(n)throw new TypeError("Unknown encoding: "+e);e=(e+"").toLowerCase(),n=!0}}.apply(this,arguments)},o.prototype.equals=function(e){if(!o.isBuffer(e))throw new TypeError("Argument must be a Buffer");return this===e||0===o.compare(this,e)},o.prototype.inspect=function(){var e="",t=r.INSPECT_MAX_BYTES;return e=this.toString("hex",0,t).replace(/(.{2})/g,"$1 ").trim(),this.length>t&&(e+=" ... "),"<Buffer "+e+">"},o.prototype.compare=function(e,t,r,n,i){if(L(e,Uint8Array)&&(e=o.from(e,e.offset,e.byteLength)),!o.isBuffer(e))throw new TypeError('The "target" argument must be one of type Buffer or Uint8Array. Received type '+_typeof(e));if(void 0===t&&(t=0),void 0===r&&(r=e?e.length:0),void 0===n&&(n=0),void 0===i&&(i=this.length),t<0||r>e.length||n<0||i>this.length)throw new RangeError("out of range index");if(i<=n&&r<=t)return 0;if(i<=n)return-1;if(r<=t)return 1;if(this===e)return 0;for(var a=(i>>>=0)-(n>>>=0),s=(r>>>=0)-(t>>>=0),l=Math.min(a,s),c=this.slice(n,i),u=e.slice(t,r),h=0;h<l;++h)if(c[h]!==u[h]){a=c[h],s=u[h];break}return a<s?-1:s<a?1:0},o.prototype.includes=function(e,t,r){return-1!==this.indexOf(e,t,r)},o.prototype.indexOf=function(e,t,r){return m(this,e,t,r,!0)},o.prototype.lastIndexOf=function(e,t,r){return m(this,e,t,r,!1)},o.prototype.write=function(e,t,r,n){if(void 0===t)n="utf8",r=this.length,t=0;else if(void 0===r&&"string"==typeof t)n=t,r=this.length,t=0;else{if(!isFinite(t))throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");t>>>=0,isFinite(r)?(r>>>=0,void 0===n&&(n="utf8")):(n=r,r=void 0)}var i=this.length-t;if((void 0===r||i<r)&&(r=i),0<e.length&&(r<0||t<0)||t>this.length)throw new RangeError("Attempt to write outside buffer bounds");n||(n="utf8");for(var a,s,o,l,c,u,h=!1;;)switch(n){case"hex":return T(this,e,t,r);case"utf8":case"utf-8":return c=t,u=r,O(N(e,this.length-c),this,c,u);case"ascii":return y(this,e,t,r);case"latin1":case"binary":return y(this,e,t,r);case"base64":return this,o=t,l=r,O(k(e),this,o,l);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return a=t,s=r,O(function(e,t){for(var r,n,i,a=[],s=0;s<e.length&&!((t-=2)<0);++s)n=(r=e.charCodeAt(s))>>8,i=r%256,a.push(i),a.push(n);return a}(e,this.length-a),this,a,s);default:if(h)throw new TypeError("Unknown encoding: "+n);n=(""+n).toLowerCase(),h=!0}},o.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};var C=4096;function b(e,t,r){var n="";r=Math.min(e.length,r);for(var i=t;i<r;++i)n+=String.fromCharCode(127&e[i]);return n}function S(e,t,r){var n="";r=Math.min(e.length,r);for(var i=t;i<r;++i)n+=String.fromCharCode(e[i]);return n}function I(e,t,r){var n=e.length;(!t||t<0)&&(t=0),(!r||r<0||n<r)&&(r=n);for(var i="",a=t;a<r;++a)i+=M(e[a]);return i}function x(e,t,r){for(var n=e.slice(t,r),i="",a=0;a<n.length;a+=2)i+=String.fromCharCode(n[a]+256*n[a+1]);return i}function P(e,t,r){if(e%1!=0||e<0)throw new RangeError("offset is not uint");if(r<e+t)throw new RangeError("Trying to access beyond buffer length")}function w(e,t,r,n,i,a){if(!o.isBuffer(e))throw new TypeError('"buffer" argument must be a Buffer instance');if(i<t||t<a)throw new RangeError('"value" argument is out of bounds');if(r+n>e.length)throw new RangeError("Index out of range")}function D(e,t,r,n,i,a){if(r+n>e.length)throw new RangeError("Index out of range");if(r<0)throw new RangeError("Index out of range")}function _(e,t,r,n,a){return t=+t,r>>>=0,a||D(e,0,r,4),i.write(e,t,r,n,23,4),r+4}function A(e,t,r,n,a){return t=+t,r>>>=0,a||D(e,0,r,8),i.write(e,t,r,n,52,8),r+8}o.prototype.slice=function(e,t){var r=this.length;(e=~~e)<0?(e+=r)<0&&(e=0):r<e&&(e=r),(t=void 0===t?r:~~t)<0?(t+=r)<0&&(t=0):r<t&&(t=r),t<e&&(t=e);var n=this.subarray(e,t);return n.__proto__=o.prototype,n},o.prototype.readUIntLE=function(e,t,r){e>>>=0,t>>>=0,r||P(e,t,this.length);for(var n=this[e],i=1,a=0;++a<t&&(i*=256);)n+=this[e+a]*i;return n},o.prototype.readUIntBE=function(e,t,r){e>>>=0,t>>>=0,r||P(e,t,this.length);for(var n=this[e+--t],i=1;0<t&&(i*=256);)n+=this[e+--t]*i;return n},o.prototype.readUInt8=function(e,t){return e>>>=0,t||P(e,1,this.length),this[e]},o.prototype.readUInt16LE=function(e,t){return e>>>=0,t||P(e,2,this.length),this[e]|this[e+1]<<8},o.prototype.readUInt16BE=function(e,t){return e>>>=0,t||P(e,2,this.length),this[e]<<8|this[e+1]},o.prototype.readUInt32LE=function(e,t){return e>>>=0,t||P(e,4,this.length),(this[e]|this[e+1]<<8|this[e+2]<<16)+16777216*this[e+3]},o.prototype.readUInt32BE=function(e,t){return e>>>=0,t||P(e,4,this.length),16777216*this[e]+(this[e+1]<<16|this[e+2]<<8|this[e+3])},o.prototype.readIntLE=function(e,t,r){e>>>=0,t>>>=0,r||P(e,t,this.length);for(var n=this[e],i=1,a=0;++a<t&&(i*=256);)n+=this[e+a]*i;return(i*=128)<=n&&(n-=Math.pow(2,8*t)),n},o.prototype.readIntBE=function(e,t,r){e>>>=0,t>>>=0,r||P(e,t,this.length);for(var n=t,i=1,a=this[e+--n];0<n&&(i*=256);)a+=this[e+--n]*i;return(i*=128)<=a&&(a-=Math.pow(2,8*t)),a},o.prototype.readInt8=function(e,t){return e>>>=0,t||P(e,1,this.length),128&this[e]?-1*(255-this[e]+1):this[e]},o.prototype.readInt16LE=function(e,t){e>>>=0,t||P(e,2,this.length);var r=this[e]|this[e+1]<<8;return 32768&r?4294901760|r:r},o.prototype.readInt16BE=function(e,t){e>>>=0,t||P(e,2,this.length);var r=this[e+1]|this[e]<<8;return 32768&r?4294901760|r:r},o.prototype.readInt32LE=function(e,t){return e>>>=0,t||P(e,4,this.length),this[e]|this[e+1]<<8|this[e+2]<<16|this[e+3]<<24},o.prototype.readInt32BE=function(e,t){return e>>>=0,t||P(e,4,this.length),this[e]<<24|this[e+1]<<16|this[e+2]<<8|this[e+3]},o.prototype.readFloatLE=function(e,t){return e>>>=0,t||P(e,4,this.length),i.read(this,e,!0,23,4)},o.prototype.readFloatBE=function(e,t){return e>>>=0,t||P(e,4,this.length),i.read(this,e,!1,23,4)},o.prototype.readDoubleLE=function(e,t){return e>>>=0,t||P(e,8,this.length),i.read(this,e,!0,52,8)},o.prototype.readDoubleBE=function(e,t){return e>>>=0,t||P(e,8,this.length),i.read(this,e,!1,52,8)},o.prototype.writeUIntLE=function(e,t,r,n){e=+e,t>>>=0,r>>>=0,n||w(this,e,t,r,Math.pow(2,8*r)-1,0);var i=1,a=0;for(this[t]=255&e;++a<r&&(i*=256);)this[t+a]=e/i&255;return t+r},o.prototype.writeUIntBE=function(e,t,r,n){e=+e,t>>>=0,r>>>=0,n||w(this,e,t,r,Math.pow(2,8*r)-1,0);var i=r-1,a=1;for(this[t+i]=255&e;0<=--i&&(a*=256);)this[t+i]=e/a&255;return t+r},o.prototype.writeUInt8=function(e,t,r){return e=+e,t>>>=0,r||w(this,e,t,1,255,0),this[t]=255&e,t+1},o.prototype.writeUInt16LE=function(e,t,r){return e=+e,t>>>=0,r||w(this,e,t,2,65535,0),this[t]=255&e,this[t+1]=e>>>8,t+2},o.prototype.writeUInt16BE=function(e,t,r){return e=+e,t>>>=0,r||w(this,e,t,2,65535,0),this[t]=e>>>8,this[t+1]=255&e,t+2},o.prototype.writeUInt32LE=function(e,t,r){return e=+e,t>>>=0,r||w(this,e,t,4,4294967295,0),this[t+3]=e>>>24,this[t+2]=e>>>16,this[t+1]=e>>>8,this[t]=255&e,t+4},o.prototype.writeUInt32BE=function(e,t,r){return e=+e,t>>>=0,r||w(this,e,t,4,4294967295,0),this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e,t+4},o.prototype.writeIntLE=function(e,t,r,n){if(e=+e,t>>>=0,!n){var i=Math.pow(2,8*r-1);w(this,e,t,r,i-1,-i)}var a=0,s=1,o=0;for(this[t]=255&e;++a<r&&(s*=256);)e<0&&0===o&&0!==this[t+a-1]&&(o=1),this[t+a]=(e/s>>0)-o&255;return t+r},o.prototype.writeIntBE=function(e,t,r,n){if(e=+e,t>>>=0,!n){var i=Math.pow(2,8*r-1);w(this,e,t,r,i-1,-i)}var a=r-1,s=1,o=0;for(this[t+a]=255&e;0<=--a&&(s*=256);)e<0&&0===o&&0!==this[t+a+1]&&(o=1),this[t+a]=(e/s>>0)-o&255;return t+r},o.prototype.writeInt8=function(e,t,r){return e=+e,t>>>=0,r||w(this,e,t,1,127,-128),e<0&&(e=255+e+1),this[t]=255&e,t+1},o.prototype.writeInt16LE=function(e,t,r){return e=+e,t>>>=0,r||w(this,e,t,2,32767,-32768),this[t]=255&e,this[t+1]=e>>>8,t+2},o.prototype.writeInt16BE=function(e,t,r){return e=+e,t>>>=0,r||w(this,e,t,2,32767,-32768),this[t]=e>>>8,this[t+1]=255&e,t+2},o.prototype.writeInt32LE=function(e,t,r){return e=+e,t>>>=0,r||w(this,e,t,4,2147483647,-2147483648),this[t]=255&e,this[t+1]=e>>>8,this[t+2]=e>>>16,this[t+3]=e>>>24,t+4},o.prototype.writeInt32BE=function(e,t,r){return e=+e,t>>>=0,r||w(this,e,t,4,2147483647,-2147483648),e<0&&(e=4294967295+e+1),this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e,t+4},o.prototype.writeFloatLE=function(e,t,r){return _(this,e,t,!0,r)},o.prototype.writeFloatBE=function(e,t,r){return _(this,e,t,!1,r)},o.prototype.writeDoubleLE=function(e,t,r){return A(this,e,t,!0,r)},o.prototype.writeDoubleBE=function(e,t,r){return A(this,e,t,!1,r)},o.prototype.copy=function(e,t,r,n){if(!o.isBuffer(e))throw new TypeError("argument should be a Buffer");if(r||(r=0),n||0===n||(n=this.length),t>=e.length&&(t=e.length),t||(t=0),0<n&&n<r&&(n=r),n===r)return 0;if(0===e.length||0===this.length)return 0;if(t<0)throw new RangeError("targetStart out of bounds");if(r<0||r>=this.length)throw new RangeError("Index out of range");if(n<0)throw new RangeError("sourceEnd out of bounds");n>this.length&&(n=this.length),e.length-t<n-r&&(n=e.length-t+r);var i=n-r;if(this===e&&"function"==typeof Uint8Array.prototype.copyWithin)this.copyWithin(t,r,n);else if(this===e&&r<t&&t<n)for(var a=i-1;0<=a;--a)e[a+t]=this[a+r];else Uint8Array.prototype.set.call(e,this.subarray(r,n),t);return i},o.prototype.fill=function(e,t,r,n){if("string"==typeof e){if("string"==typeof t?(n=t,t=0,r=this.length):"string"==typeof r&&(n=r,r=this.length),void 0!==n&&"string"!=typeof n)throw new TypeError("encoding must be a string");if("string"==typeof n&&!o.isEncoding(n))throw new TypeError("Unknown encoding: "+n);if(1===e.length){var i=e.charCodeAt(0);("utf8"===n&&i<128||"latin1"===n)&&(e=i)}}else"number"==typeof e&&(e&=255);if(t<0||this.length<t||this.length<r)throw new RangeError("Out of range index");if(r<=t)return this;var a;if(t>>>=0,r=void 0===r?this.length:r>>>0,e||(e=0),"number"==typeof e)for(a=t;a<r;++a)this[a]=e;else{var s=o.isBuffer(e)?e:o.from(e,n),l=s.length;if(0===l)throw new TypeError('The value "'+e+'" is invalid for argument "value"');for(a=0;a<r-t;++a)this[a+t]=s[a%l]}return this};var R=/[^+/0-9A-Za-z-_]/g;function M(e){return e<16?"0"+e.toString(16):e.toString(16)}function N(e,t){var r;t=t||1/0;for(var n=e.length,i=null,a=[],s=0;s<n;++s){if(55295<(r=e.charCodeAt(s))&&r<57344){if(!i){if(56319<r){-1<(t-=3)&&a.push(239,191,189);continue}if(s+1===n){-1<(t-=3)&&a.push(239,191,189);continue}i=r;continue}if(r<56320){-1<(t-=3)&&a.push(239,191,189),i=r;continue}r=65536+(i-55296<<10|r-56320)}else i&&-1<(t-=3)&&a.push(239,191,189);if(i=null,r<128){if((t-=1)<0)break;a.push(r)}else if(r<2048){if((t-=2)<0)break;a.push(r>>6|192,63&r|128)}else if(r<65536){if((t-=3)<0)break;a.push(r>>12|224,r>>6&63|128,63&r|128)}else{if(!(r<1114112))throw new Error("Invalid code point");if((t-=4)<0)break;a.push(r>>18|240,r>>12&63|128,r>>6&63|128,63&r|128)}}return a}function k(e){return n.toByteArray(function(e){if((e=(e=e.split("=")[0]).trim().replace(R,"")).length<2)return"";for(;e.length%4!=0;)e+="=";return e}(e))}function O(e,t,r,n){for(var i=0;i<n&&!(i+r>=t.length||i>=e.length);++i)t[i+r]=e[i];return i}function L(e,t){return e instanceof t||null!=e&&null!=e.constructor&&null!=e.constructor.name&&e.constructor.name===t.name}function F(e){return e!=e}},{"base64-js":1,ieee754:105}],5:[function(e,t,r){t.exports={100:"Continue",101:"Switching Protocols",102:"Processing",200:"OK",201:"Created",202:"Accepted",203:"Non-Authoritative Information",204:"No Content",205:"Reset Content",206:"Partial Content",207:"Multi-Status",208:"Already Reported",226:"IM Used",300:"Multiple Choices",301:"Moved Permanently",302:"Found",303:"See Other",304:"Not Modified",305:"Use Proxy",307:"Temporary Redirect",308:"Permanent Redirect",400:"Bad Request",401:"Unauthorized",402:"Payment Required",403:"Forbidden",404:"Not Found",405:"Method Not Allowed",406:"Not Acceptable",407:"Proxy Authentication Required",408:"Request Timeout",409:"Conflict",410:"Gone",411:"Length Required",412:"Precondition Failed",413:"Payload Too Large",414:"URI Too Long",415:"Unsupported Media Type",416:"Range Not Satisfiable",417:"Expectation Failed",418:"I'm a teapot",421:"Misdirected Request",422:"Unprocessable Entity",423:"Locked",424:"Failed Dependency",425:"Unordered Collection",426:"Upgrade Required",428:"Precondition Required",429:"Too Many Requests",431:"Request Header Fields Too Large",451:"Unavailable For Legal Reasons",500:"Internal Server Error",501:"Not Implemented",502:"Bad Gateway",503:"Service Unavailable",504:"Gateway Timeout",505:"HTTP Version Not Supported",506:"Variant Also Negotiates",507:"Insufficient Storage",508:"Loop Detected",509:"Bandwidth Limit Exceeded",510:"Not Extended",511:"Network Authentication Required"}},{}],6:[function(e,t,r){t.exports=e("./lib/clean")},{"./lib/clean":7}],7:[function(e,t,r){(function(r){var n=e("./optimizer/level-0/optimize"),i=e("./optimizer/level-1/optimize"),a=e("./optimizer/level-2/optimize"),s=e("./optimizer/validator"),o=e("./options/compatibility"),l=e("./options/fetch"),c=e("./options/format").formatFrom,u=e("./options/inline"),h=e("./options/inline-request"),f=e("./options/inline-timeout"),d=e("./options/optimization-level").OptimizationLevel,p=e("./options/optimization-level").optimizationLevelFrom,m=e("./options/rebase"),g=e("./options/rebase-to"),T=e("./reader/input-source-map-tracker"),y=e("./reader/read-sources"),v=e("./writer/simple"),E=e("./writer/source-maps"),C=t.exports=function(e){e=e||{},this.options={compatibility:o(e.compatibility),fetch:l(e.fetch),format:c(e.format),inline:u(e.inline),inlineRequest:h(e.inlineRequest),inlineTimeout:f(e.inlineTimeout),level:p(e.level),rebase:m(e.rebase),rebaseTo:g(e.rebaseTo),returnPromise:!!e.returnPromise,sourceMap:!!e.sourceMap,sourceMapInlineSources:!!e.sourceMapInlineSources}};function b(e,t,o,l){var c="function"!=typeof o?o:null,u="function"==typeof l?l:"function"==typeof o?o:null,h={stats:{efficiency:0,minifiedSize:0,originalSize:0,startedAt:Date.now(),timeSpent:0},cache:{specificity:{}},errors:[],inlinedStylesheets:[],inputSourceMapTracker:T(),localOnly:!u,options:t,source:null,sourcesContent:{},validator:s(t.compatibility),warnings:[]};return c&&h.inputSourceMapTracker.track(void 0,c),(h.localOnly?function(e){return e()}:r.nextTick)((function(){return y(e,h,(function(e){var t,r,s,o,l,c,f,p,m=(h.options.sourceMap?E:v)((s=n(t=e,r=h),s=d.One in r.options.level?i(t,r):t,s=d.Two in r.options.level?a(t,r,!0):s),h),g=(l=h,(o=m).stats=(c=o.styles,f=l,p=Date.now()-f.stats.startedAt,delete f.stats.startedAt,f.stats.timeSpent=p,f.stats.efficiency=1-c.length/f.stats.originalSize,f.stats.minifiedSize=c.length,f.stats),o.errors=l.errors,o.inlinedStylesheets=l.inlinedStylesheets,o.warnings=l.warnings,o);return u?u(0<h.errors.length?h.errors:null,g):g}))}))}C.process=function(e,t){var r=t.to;return delete t.to,new C(Object.assign({returnPromise:!0,rebaseTo:r},t)).minify(e).then((function(e){return{css:e.styles}}))},C.prototype.minify=function(e,t,r){var n=this.options;return n.returnPromise?new Promise((function(r,i){b(e,n,t,(function(e,t){return e?i(e):r(t)}))})):b(e,n,t,r)}}).call(this,e("_process"))},{"./optimizer/level-0/optimize":9,"./optimizer/level-1/optimize":10,"./optimizer/level-2/optimize":29,"./optimizer/validator":57,"./options/compatibility":59,"./options/fetch":60,"./options/format":61,"./options/inline":64,"./options/inline-request":62,"./options/inline-timeout":63,"./options/optimization-level":65,"./options/rebase":67,"./options/rebase-to":66,"./reader/input-source-map-tracker":71,"./reader/read-sources":77,"./writer/simple":99,"./writer/source-maps":100,_process:112}],8:[function(e,t,r){t.exports={ASTERISK:"asterisk",BANG:"bang",BACKSLASH:"backslash",UNDERSCORE:"underscore"}},{}],9:[function(e,t,r){t.exports=function(e){return e}},{}],10:[function(e,t,r){var n=e("./shorten-hex"),i=e("./shorten-hsl"),a=e("./shorten-rgb"),s=e("./sort-selectors"),o=e("./tidy-rules"),l=e("./tidy-block"),c=e("./tidy-at-rule"),u=e("../hack"),h=e("../remove-unused"),f=e("../restore-from-optimizing"),d=e("../wrap-for-optimizing").all,p=e("../../options/optimization-level").OptimizationLevel,m=e("../../tokenizer/token"),g=e("../../tokenizer/marker"),T=e("../../utils/format-position"),y=e("../../utils/split"),v=e("../../writer/one-time").rules,E="ignore-property",C="@charset",b=new RegExp("^"+C,"i"),S=e("../../options/rounding-precision").DEFAULT,I=/(?:^|\s|\()(-?\d+)px/,x=/^(\-?[\d\.]+)(m?s)$/,P=/[0-9a-f]/i,w=/^(?:\-chrome\-|\-[\w\-]+\w|\w[\w\-]+\w|\-\-\S+)$/,D=/^@import/i,_=/^('.*'|".*")$/,A=/^['"][a-zA-Z][a-zA-Z\d\-_]+['"]$/,R=/^url\(/i,M=/^--\S+$/;function N(e){return e&&"-"==e[1][0]&&parseFloat(e[1])<0}function k(e,t,r){return-1===t.indexOf("#")&&-1==t.indexOf("rgb")&&-1==t.indexOf("hsl")||(t=t.replace(/rgb\((\-?\d+),(\-?\d+),(\-?\d+)\)/g,(function(e,t,r,n){return a(t,r,n)})).replace(/hsl\((-?\d+),(-?\d+)%?,(-?\d+)%?\)/g,(function(e,t,r,n){return i(t,r,n)})).replace(/(^|[^='"])#([0-9a-f]{6})/gi,(function(e,t,r,n,i){var a=i[n+e.length];return a&&P.test(a)?e:r[0]==r[1]&&r[2]==r[3]&&r[4]==r[5]?(t+"#"+r[0]+r[2]+r[4]).toLowerCase():(t+"#"+r).toLowerCase()})).replace(/(^|[^='"])#([0-9a-f]{3})/gi,(function(e,t,r){return t+"#"+r.toLowerCase()})).replace(/(rgb|rgba|hsl|hsla)\(([^\)]+)\)/g,(function(e,t,r){var n=r.split(",");return"hsl"==t&&3==n.length||"hsla"==t&&4==n.length||"rgb"==t&&3==n.length&&0<r.indexOf("%")||"rgba"==t&&4==n.length&&0<r.indexOf("%")?(-1==n[1].indexOf("%")&&(n[1]+="%"),-1==n[2].indexOf("%")&&(n[2]+="%"),t+"("+n.join(",")+")"):e})),r.colors.opacity&&-1==e.indexOf("background")&&(t=t.replace(/(?:rgba|hsla)\(0,0%?,0%?,0\)/g,(function(e){return-1<y(t,",").pop().indexOf("gradient(")?e:"transparent"})))),n(t)}function O(e,t,r){return I.test(t)?t.replace(I,(function(e,t){var n,i=parseInt(t);return 0===i?e:(r.properties.shorterLengthUnits&&r.units.pt&&3*i%4==0&&(n=3*i/4+"pt"),r.properties.shorterLengthUnits&&r.units.pc&&i%16==0&&(n=i/16+"pc"),r.properties.shorterLengthUnits&&r.units.in&&i%96==0&&(n=i/96+"in"),n&&(n=e.substring(0,e.indexOf(t))+n),n&&n.length<e.length?n:e)})):t}function L(e,t,r){return r.enabled&&-1!==t.indexOf(".")?t.replace(r.decimalPointMatcher,"$1$2$3").replace(r.zeroMatcher,(function(e,t,n,i){var a=r.units[i].multiplier,s=parseInt(t),o=isNaN(s)?0:s,l=parseFloat(n);return Math.round((o+l)*a)/a+i})):t}function F(e,t,r){var n,i,a,s,o,l,c,y,C,b,S,I,P,D,U,H,z,j,q,G,W,Y,K,Q,X,$,Z,J,ee,te,re,ne,ie,ae=r.options,se=ae.level[p.One],oe=d(t,!0);e:for(var le=0,ce=oe.length;le<ce;le++)if(i=(n=oe[le]).name,w.test(i)||(l=n.all[n.position],r.warnings.push("Invalid property name '"+i+"' at "+T(l[1][2][0])+". Ignoring."),n.unused=!0),0===n.value.length&&(l=n.all[n.position],r.warnings.push("Empty property '"+i+"' at "+T(l[1][2][0])+". Ignoring."),n.unused=!0),n.hack&&((n.hack[0]==u.ASTERISK||n.hack[0]==u.UNDERSCORE)&&!ae.compatibility.properties.iePrefixHack||n.hack[0]==u.BACKSLASH&&!ae.compatibility.properties.ieSuffixHack||n.hack[0]==u.BANG&&!ae.compatibility.properties.ieBangHack)&&(n.unused=!0),se.removeNegativePaddings&&0===i.indexOf("padding")&&(N(n.value[0])||N(n.value[1])||N(n.value[2])||N(n.value[3]))&&(n.unused=!0),!ae.compatibility.properties.ieFilters&&V(n)&&(n.unused=!0),!n.unused)if(n.block)F(e,n.value[0][1],r);else if(!M.test(i)){for(var ue=0,he=n.value.length;ue<he;ue++){if(a=n.value[ue][0],ie=s=n.value[ue][1],o=R.test(ie),a==m.PROPERTY_BLOCK){n.unused=!0,r.warnings.push("Invalid value token at "+T(s[0][1][2][0])+". Ignoring.");break}if(o&&!r.validator.isUrl(s)){n.unused=!0,r.warnings.push("Broken URL '"+s+"' at "+T(n.value[ue][2][0])+". Ignoring.");break}if(o?(s=se.normalizeUrls?s.replace(R,"url(").replace(/\\?\n|\\?\r\n/g,""):s,s=ae.compatibility.properties.urlQuotes?s:!/^url\(['"].+['"]\)$/.test(ne=s)||/^url\(['"].*[\*\s\(\)'"].*['"]\)$/.test(ne)||/^url\(['"]data:[^;]+;charset/.test(ne)?ne:ne.replace(/["']/g,"")):(re=s,_.test(re)?s=se.removeQuotes?(te=s,"content"==(ee=i)||-1<ee.indexOf("font-variation-settings")||-1<ee.indexOf("font-feature-settings")||-1<ee.indexOf("grid-")?te:A.test(te)?te.substring(1,te.length-1):te):s:(s=O(0,s=L(0,s=se.removeWhitespace?(J=s,-1<i.indexOf("filter")||-1==J.indexOf(" ")||0===J.indexOf("expression")||-1<J.indexOf(g.SINGLE_QUOTE)||-1<J.indexOf(g.DOUBLE_QUOTE)?J:(-1<(J=J.replace(/\s+/g," ")).indexOf("calc")&&(J=J.replace(/\) ?\/ ?/g,")/ ")),J.replace(/(\(;?)\s+/g,"$1").replace(/\s+(;?\))/g,"$1").replace(/, /g,","))):s,ae.precision),ae.compatibility),s=se.replaceTimeUnits?(Z=s,x.test(Z)?Z.replace(x,(function(e,t,r){var n;return"ms"==r?n=parseInt(t)/1e3+"s":"s"==r&&(n=1e3*parseFloat(t)+"ms"),n.length<e.length?n:e})):Z):s,s=se.replaceZeroUnits?-1==($=s).indexOf("0")?$:(-1<$.indexOf("-")&&($=$.replace(/([^\w\d\-]|^)\-0([^\.]|$)/g,"$10$2").replace(/([^\w\d\-]|^)\-0([^\.]|$)/g,"$10$2")),$.replace(/(^|\s)0+([1-9])/g,"$1$2").replace(/(^|\D)\.0+(\D|$)/g,"$10$2").replace(/(^|\D)\.0+(\D|$)/g,"$10$2").replace(/\.([1-9]*)0+(\D|$)/g,(function(e,t,r){return(0<t.length?".":"")+t+r})).replace(/(^|\D)0\.(\d)/g,"$1.$2")):s,ae.compatibility.properties.zeroUnits&&(Y=i,K=s=-1==(X=s).indexOf("0deg")?X:X.replace(/\(0deg\)/g,"(0)"),Q=ae.unitsRegexp,s=/^(?:\-moz\-calc|\-webkit\-calc|calc|rgb|hsl|rgba|hsla)\(/.test(K)||"flex"==Y||"-ms-flex"==Y||"-webkit-flex"==Y||"flex-basis"==Y||"-webkit-flex-basis"==Y||0<K.indexOf("%")&&("height"==Y||"max-height"==Y||"width"==Y||"max-width"==Y)?K:K.replace(Q,"$10$2").replace(Q,"$10$2")),ae.compatibility.properties.colors&&(s=k(i,s,ae.compatibility)))),j=i,q=s,G=e,(s=void 0===(W=(0,se.transform)(j,q,v(G)))?q:!1===W?E:W)===E){n.unused=!0;continue e}n.value[ue][1]=s}se.replaceMultipleZeros&&(H=void 0,4==(z=(U=n).value).length&&"0"===z[0][1]&&"0"===z[1][1]&&"0"===z[2][1]&&"0"===z[3][1]&&(H=-1<U.name.indexOf("box-shadow")?2:1),H&&(U.value.splice(H),U.dirty=!0)),"background"==i&&se.optimizeBackground?(D=void 0,1==(D=n.value).length&&"none"==D[0][1]&&(D[0][1]="0 0"),1==D.length&&"transparent"==D[0][1]&&(D[0][1]="0 0")):0===i.indexOf("border")&&0<i.indexOf("radius")&&se.optimizeBorderRadius?(I=void 0,3==(P=(S=n).value).length&&"/"==P[1][1]&&P[0][1]==P[2][1]?I=1:5==P.length&&"/"==P[2][1]&&P[0][1]==P[3][1]&&P[1][1]==P[4][1]?I=2:7==P.length&&"/"==P[3][1]&&P[0][1]==P[4][1]&&P[1][1]==P[5][1]&&P[2][1]==P[6][1]?I=3:9==P.length&&"/"==P[4][1]&&P[0][1]==P[5][1]&&P[1][1]==P[6][1]&&P[2][1]==P[7][1]&&P[3][1]==P[8][1]&&(I=4),I&&(S.value.splice(I),S.dirty=!0)):"filter"==i&&se.optimizeFilter&&ae.compatibility.properties.ieFilters?(1==(b=n).value.length&&(b.value[0][1]=b.value[0][1].replace(/progid:DXImageTransform\.Microsoft\.(Alpha|Chroma)(\W)/,(function(e,t,r){return t.toLowerCase()+r}))),b.value[0][1]=b.value[0][1].replace(/,(\S)/g,", $1").replace(/ ?= ?/g,"=")):"font-weight"==i&&se.optimizeFontWeight?(C=void 0,"normal"==(C=(y=n).value[0][1])?C="400":"bold"==C&&(C="700"),y.value[0][1]=C):"outline"==i&&se.optimizeOutline&&(c=void 0,1==(c=n.value).length&&"none"==c[0][1]&&(c[0][1]="0"))}f(oe),h(oe),function(e,t){var r,n;for(n=0;n<e.length;n++)(r=e[n])[0]==m.COMMENT&&(B(r,t),0===r[1].length&&(e.splice(n,1),n--))}(t,ae)}function B(e,t){e[1][2]==g.EXCLAMATION&&("all"==t.level[p.One].specialComments||t.commentsKept<t.level[p.One].specialComments)?t.commentsKept++:e[1]=[]}function V(e){var t;return("filter"==e.name||"-ms-filter"==e.name)&&(-1<(t=e.value[0][1]).indexOf("progid")||0===t.indexOf("alpha")||0===t.indexOf("chroma"))}t.exports=function e(t,r){var n,i,a,u=r.options,h=u.level[p.One],f=u.compatibility.selectors.ie7Hack,d=u.compatibility.selectors.adjacentSpace,g=u.compatibility.properties.spaceAfterClosingBrace,T=u.format,y=!1,v=!1;u.unitsRegexp=u.unitsRegexp||(n=u,i=["px","em","ex","cm","mm","in","pt","pc","%"],["ch","rem","vh","vm","vmax","vmin","vw"].forEach((function(e){n.compatibility.units[e]&&i.push(e)})),new RegExp("(^|\\s|\\(|,)0(?:"+i.join("|")+")(\\W|$)","g")),u.precision=u.precision||function(e){var t,r,n={matcher:null,units:{}},i=[];for(t in e)(r=e[t])!=S&&(n.units[t]={},n.units[t].value=r,n.units[t].multiplier=Math.pow(10,r),i.push(t));return 0<i.length&&(n.enabled=!0,n.decimalPointMatcher=new RegExp("(\\d)\\.($|"+i.join("|")+")($|W)","g"),n.zeroMatcher=new RegExp("(\\d*)(\\.\\d+)("+i.join("|")+")","g")),n}(h.roundingPrecision),u.commentsKept=u.commentsKept||0;for(var E=0,I=t.length;E<I;E++){var x=t[E];switch(x[0]){case m.AT_RULE:x[1]=(a=x,D.test(a[1])&&v?"":x[1]),x[1]=h.tidyAtRules?c(x[1]):x[1],y=!0;break;case m.AT_RULE_BLOCK:F(x[1],x[2],r),v=!0;break;case m.NESTED_BLOCK:x[1]=h.tidyBlockScopes?l(x[1],g):x[1],e(x[2],r),v=!0;break;case m.COMMENT:B(x,u);break;case m.RULE:x[1]=h.tidySelectors?o(x[1],!f,d,T,r.warnings):x[1],x[1]=1<x[1].length?s(x[1],h.selectorsSortingMethod):x[1],F(x[1],x[2],r),v=!0}(x[0]==m.COMMENT&&0===x[1].length||h.removeEmpty&&(0===x[1].length||x[2]&&0===x[2].length))&&(t.splice(E,1),E--,I--)}return h.cleanupCharsets&&y&&function(e){for(var t=!1,r=0,n=e.length;r<n;r++){var i=e[r];i[0]==m.AT_RULE&&b.test(i[1])&&(t||-1==i[1].indexOf(C)?(e.splice(r,1),r--,n--):(t=!0,e.splice(r,1),e.unshift([m.AT_RULE,i[1].replace(b,C)])))}}(t),t}},{"../../options/optimization-level":65,"../../options/rounding-precision":68,"../../tokenizer/marker":83,"../../tokenizer/token":84,"../../utils/format-position":87,"../../utils/split":96,"../../writer/one-time":98,"../hack":8,"../remove-unused":55,"../restore-from-optimizing":56,"../wrap-for-optimizing":58,"./shorten-hex":11,"./shorten-hsl":12,"./shorten-rgb":13,"./sort-selectors":14,"./tidy-at-rule":15,"./tidy-block":16,"./tidy-rules":17}],11:[function(e,t,r){var n={aliceblue:"#f0f8ff",antiquewhite:"#faebd7",aqua:"#0ff",aquamarine:"#7fffd4",azure:"#f0ffff",beige:"#f5f5dc",bisque:"#ffe4c4",black:"#000",blanchedalmond:"#ffebcd",blue:"#00f",blueviolet:"#8a2be2",brown:"#a52a2a",burlywood:"#deb887",cadetblue:"#5f9ea0",chartreuse:"#7fff00",chocolate:"#d2691e",coral:"#ff7f50",cornflowerblue:"#6495ed",cornsilk:"#fff8dc",crimson:"#dc143c",cyan:"#0ff",darkblue:"#00008b",darkcyan:"#008b8b",darkgoldenrod:"#b8860b",darkgray:"#a9a9a9",darkgreen:"#006400",darkgrey:"#a9a9a9",darkkhaki:"#bdb76b",darkmagenta:"#8b008b",darkolivegreen:"#556b2f",darkorange:"#ff8c00",darkorchid:"#9932cc",darkred:"#8b0000",darksalmon:"#e9967a",darkseagreen:"#8fbc8f",darkslateblue:"#483d8b",darkslategray:"#2f4f4f",darkslategrey:"#2f4f4f",darkturquoise:"#00ced1",darkviolet:"#9400d3",deeppink:"#ff1493",deepskyblue:"#00bfff",dimgray:"#696969",dimgrey:"#696969",dodgerblue:"#1e90ff",firebrick:"#b22222",floralwhite:"#fffaf0",forestgreen:"#228b22",fuchsia:"#f0f",gainsboro:"#dcdcdc",ghostwhite:"#f8f8ff",gold:"#ffd700",goldenrod:"#daa520",gray:"#808080",green:"#008000",greenyellow:"#adff2f",grey:"#808080",honeydew:"#f0fff0",hotpink:"#ff69b4",indianred:"#cd5c5c",indigo:"#4b0082",ivory:"#fffff0",khaki:"#f0e68c",lavender:"#e6e6fa",lavenderblush:"#fff0f5",lawngreen:"#7cfc00",lemonchiffon:"#fffacd",lightblue:"#add8e6",lightcoral:"#f08080",lightcyan:"#e0ffff",lightgoldenrodyellow:"#fafad2",lightgray:"#d3d3d3",lightgreen:"#90ee90",lightgrey:"#d3d3d3",lightpink:"#ffb6c1",lightsalmon:"#ffa07a",lightseagreen:"#20b2aa",lightskyblue:"#87cefa",lightslategray:"#778899",lightslategrey:"#778899",lightsteelblue:"#b0c4de",lightyellow:"#ffffe0",lime:"#0f0",limegreen:"#32cd32",linen:"#faf0e6",magenta:"#ff00ff",maroon:"#800000",mediumaquamarine:"#66cdaa",mediumblue:"#0000cd",mediumorchid:"#ba55d3",mediumpurple:"#9370db",mediumseagreen:"#3cb371",mediumslateblue:"#7b68ee",mediumspringgreen:"#00fa9a",mediumturquoise:"#48d1cc",mediumvioletred:"#c71585",midnightblue:"#191970",mintcream:"#f5fffa",mistyrose:"#ffe4e1",moccasin:"#ffe4b5",navajowhite:"#ffdead",navy:"#000080",oldlace:"#fdf5e6",olive:"#808000",olivedrab:"#6b8e23",orange:"#ffa500",orangered:"#ff4500",orchid:"#da70d6",palegoldenrod:"#eee8aa",palegreen:"#98fb98",paleturquoise:"#afeeee",palevioletred:"#db7093",papayawhip:"#ffefd5",peachpuff:"#ffdab9",peru:"#cd853f",pink:"#ffc0cb",plum:"#dda0dd",powderblue:"#b0e0e6",purple:"#800080",rebeccapurple:"#663399",red:"#f00",rosybrown:"#bc8f8f",royalblue:"#4169e1",saddlebrown:"#8b4513",salmon:"#fa8072",sandybrown:"#f4a460",seagreen:"#2e8b57",seashell:"#fff5ee",sienna:"#a0522d",silver:"#c0c0c0",skyblue:"#87ceeb",slateblue:"#6a5acd",slategray:"#708090",slategrey:"#708090",snow:"#fffafa",springgreen:"#00ff7f",steelblue:"#4682b4",tan:"#d2b48c",teal:"#008080",thistle:"#d8bfd8",tomato:"#ff6347",turquoise:"#40e0d0",violet:"#ee82ee",wheat:"#f5deb3",white:"#fff",whitesmoke:"#f5f5f5",yellow:"#ff0",yellowgreen:"#9acd32"},i={},a={};for(var s in n){var o=n[s];s.length<o.length?a[o]=s:i[s]=o}var l=new RegExp("(^| |,|\\))("+Object.keys(i).join("|")+")( |,|\\)|$)","ig"),c=new RegExp("("+Object.keys(a).join("|")+")([^a-f0-9]|$)","ig");function u(e,t,r,n){return t+i[r.toLowerCase()]+n}function h(e,t,r){return a[t.toLowerCase()]+r}t.exports=function(e){var t=-1<e.indexOf("#"),r=e.replace(l,u);return r!=e&&(r=r.replace(l,u)),t?r.replace(c,h):r}},{}],12:[function(e,t,r){function n(e,t,r){return r<0&&(r+=1),1<r&&(r-=1),r<1/6?e+6*(t-e)*r:r<.5?t:r<2/3?e+(t-e)*(2/3-r)*6:e}t.exports=function(e,t,r){var i=function(e,t,r){var i,a,s;if((e%=360)<0&&(e+=360),e=~~e/360,t<0?t=0:100<t&&(t=100),r<0?r=0:100<r&&(r=100),r=~~r/100,0==(t=~~t/100))i=a=s=r;else{var o=r<.5?r*(1+t):r+t-r*t,l=2*r-o;i=n(l,o,e+1/3),a=n(l,o,e),s=n(l,o,e-1/3)}return[~~(255*i),~~(255*a),~~(255*s)]}(e,t,r),a=i[0].toString(16),s=i[1].toString(16),o=i[2].toString(16);return"#"+(1==a.length?"0":"")+a+(1==s.length?"0":"")+s+(1==o.length?"0":"")+o}},{}],13:[function(e,t,r){t.exports=function(e,t,r){return"#"+("00000"+(Math.max(0,Math.min(parseInt(e),255))<<16|Math.max(0,Math.min(parseInt(t),255))<<8|Math.max(0,Math.min(parseInt(r),255))).toString(16)).slice(-6)}},{}],14:[function(e,t,r){var n=e("../../utils/natural-compare");function i(e,t){return n(e[1],t[1])}function a(e,t){return e[1]>t[1]?1:-1}t.exports=function(e,t){switch(t){case"natural":return e.sort(i);case"standard":return e.sort(a);case"none":case!1:return e}}},{"../../utils/natural-compare":94}],15:[function(e,t,r){t.exports=function(e){return e.replace(/\s+/g," ").replace(/url\(\s+/g,"url(").replace(/\s+\)/g,")").trim()}},{}],16:[function(e,t,r){var n=/^@media\W/;t.exports=function(e,t){var r,i;for(i=e.length-1;0<=i;i--)r=!t&&n.test(e[i][1]),e[i][1]=e[i][1].replace(/\n|\r\n/g," ").replace(/\s+/g," ").replace(/(,|:|\() /g,"$1").replace(/ \)/g,")").replace(/'([a-zA-Z][a-zA-Z\d\-_]+)'/,"$1").replace(/"([a-zA-Z][a-zA-Z\d\-_]+)"/,"$1").replace(r?/\) /g:null,")");return e}},{}],17:[function(e,t,r){var n=e("../../options/format").Spaces,i=e("../../tokenizer/marker"),a=e("../../utils/format-position"),s=/[\s"'][iI]\s*\]/,o=/([\d\w])([iI])\]/g,l=/="([a-zA-Z][a-zA-Z\d\-_]+)"([iI])/g,c=/="([a-zA-Z][a-zA-Z\d\-_]+)"(\s|\])/g,u=/^(?:(?:<!--|-->)\s*)+/,h=/='([a-zA-Z][a-zA-Z\d\-_]+)'([iI])/g,f=/='([a-zA-Z][a-zA-Z\d\-_]+)'(\s|\])/g,d=/[>\+~]/,p=/\s/;function m(e){var t,r,n,a,s=!1,o=!1;for(n=0,a=e.length;n<a;n++){if(r=e[n],t);else if(r==i.SINGLE_QUOTE||r==i.DOUBLE_QUOTE)o=!o;else{if(!(o||r!=i.CLOSE_CURLY_BRACKET&&r!=i.EXCLAMATION&&"<"!=r&&r!=i.SEMICOLON)){s=!0;break}if(!o&&0===n&&d.test(r)){s=!0;break}}t=r==i.BACK_SLASH}return s}function g(e,t){var r,a,l,c,u,h,f,m,g,T,y,v,E,C=[],b=0,S=!1,I=!1,x=s.test(e),P=t&&t.spaces[n.AroundSelectorRelation];for(v=0,E=e.length;v<E;v++){if(a=(r=e[v])==i.NEW_LINE_NIX,l=r==i.NEW_LINE_NIX&&e[v-1]==i.CARRIAGE_RETURN,h=f||m,T=!g&&!c&&0===b&&d.test(r),y=p.test(r),u&&h&&l)C.pop(),C.pop();else if(c&&h&&a)C.pop();else if(c)C.push(r);else if(r!=i.OPEN_SQUARE_BRACKET||h)if(r!=i.CLOSE_SQUARE_BRACKET||h)if(r!=i.OPEN_ROUND_BRACKET||h)if(r!=i.CLOSE_ROUND_BRACKET||h)if(r!=i.SINGLE_QUOTE||h)if(r!=i.DOUBLE_QUOTE||h)if(r==i.SINGLE_QUOTE&&h)C.push(r),f=!1;else if(r==i.DOUBLE_QUOTE&&h)C.push(r),m=!1;else{if(y&&S&&!P)continue;!y&&S&&P?(C.push(i.SPACE),C.push(r)):y&&(g||0<b)&&!h||y&&I&&!h||(l||a)&&(g||0<b)&&h||(T&&I&&!P?(C.pop(),C.push(r)):T&&!I&&P?(C.push(i.SPACE),C.push(r)):y?C.push(i.SPACE):C.push(r))}else C.push(r),m=!0;else C.push(r),f=!0;else C.push(r),b--;else C.push(r),b++;else C.push(r),g=!1;else C.push(r),g=!0;u=c,c=r==i.BACK_SLASH,S=T,I=y}return x?C.join("").replace(o,"$1 $2]"):C.join("")}t.exports=function(e,t,r,n,i){var s,o=[],d=[];function p(e,t){return i.push("HTML comment '"+t+"' at "+a(e[2][0])+". Removing."),""}for(var T=0,y=e.length;T<y;T++){var v=e[T],E=v[1];m(E=E.replace(u,p.bind(null,v)))?i.push("Invalid selector '"+v[1]+"' at "+a(v[2][0])+". Ignoring."):(E=-1==(s=E=g(E,n)).indexOf("'")&&-1==s.indexOf('"')?s:s.replace(h,"=$1 $2").replace(f,"=$1$2").replace(l,"=$1 $2").replace(c,"=$1$2"),r&&0<E.indexOf("nav")&&(E=E.replace(/\+nav(\S|$)/,"+ nav$1")),t&&-1<E.indexOf("*+html ")||t&&-1<E.indexOf("*:first-child+html ")||(-1<E.indexOf("*")&&(E=E.replace(/\*([:#\.\[])/g,"$1").replace(/^(\:first\-child)?\+html/,"*$1+html")),-1<d.indexOf(E)||(v[1]=E,d.push(E),o.push(v))))}return 1==o.length&&0===o[0][1].length&&(i.push("Empty selector '"+o[0][1]+"' at "+a(o[0][2][0])+". Ignoring."),o=[]),o}},{"../../options/format":61,"../../tokenizer/marker":83,"../../utils/format-position":87}],18:[function(e,t,r){var n=e("./invalid-property-error"),i=e("../wrap-for-optimizing").single,a=e("../../tokenizer/token"),s=e("../../tokenizer/marker"),o=e("../../utils/format-position");function l(e){var t,r;for(t=0,r=e.length;t<r;t++)if("inherit"==e[t][1])return!0;return!1}function c(e,t,r){var n=r[e];return n.doubleValues&&2==n.defaultValue.length?i([a.PROPERTY,[a.PROPERTY_NAME,e],[a.PROPERTY_VALUE,n.defaultValue[0]],[a.PROPERTY_VALUE,n.defaultValue[1]]]):n.doubleValues&&1==n.defaultValue.length?i([a.PROPERTY,[a.PROPERTY_NAME,e],[a.PROPERTY_VALUE,n.defaultValue[0]]]):i([a.PROPERTY,[a.PROPERTY_NAME,e],[a.PROPERTY_VALUE,n.defaultValue]])}function u(e,t){var r=t[e.name].components,n=[],s=e.value;if(s.length<1)return[];s.length<2&&(s[1]=s[0].slice(0)),s.length<3&&(s[2]=s[0].slice(0)),s.length<4&&(s[3]=s[1].slice(0));for(var o=r.length-1;0<=o;o--){var l=i([a.PROPERTY,[a.PROPERTY_NAME,r[o]]]);l.value=[s[o]],n.unshift(l)}return n}function h(e,t,r){for(var n,i,a,s=t[e.name],o=[c(s.components[0],0,t),c(s.components[1],0,t),c(s.components[2],0,t)],l=0;l<3;l++){var u=o[l];0<u.name.indexOf("color")?n=u:0<u.name.indexOf("style")?i=u:a=u}if(1==e.value.length&&"inherit"==e.value[0][1]||3==e.value.length&&"inherit"==e.value[0][1]&&"inherit"==e.value[1][1]&&"inherit"==e.value[2][1])return n.value=i.value=a.value=[e.value[0]],o;var h,f,d,p,m,g=e.value.slice(0);return 0<g.length&&(h=1<(f=g.filter((d=r,function(e){return"inherit"!=e[1]&&(d.isWidth(e[1])||d.isUnit(e[1])&&!d.isDynamicUnit(e[1]))&&!d.isStyleKeyword(e[1])&&!d.isColorFunction(e[1])}))).length&&("none"==f[0][1]||"auto"==f[0][1])?f[1]:f[0])&&(a.value=[h],g.splice(g.indexOf(h),1)),0<g.length&&(h=g.filter((p=r,function(e){return"inherit"!=e[1]&&p.isStyleKeyword(e[1])&&!p.isColorFunction(e[1])}))[0])&&(i.value=[h],g.splice(g.indexOf(h),1)),0<g.length&&(h=g.filter((m=r,function(e){return"invert"==e[1]||m.isColor(e[1])||m.isPrefixed(e[1])}))[0])&&(n.value=[h],g.splice(g.indexOf(h),1)),o}t.exports={animation:function(e,t,r){var i,a,s,u=c(e.name+"-duration",0,t),h=c(e.name+"-timing-function",0,t),f=c(e.name+"-delay",0,t),d=c(e.name+"-iteration-count",0,t),p=c(e.name+"-direction",0,t),m=c(e.name+"-fill-mode",0,t),g=c(e.name+"-play-state",0,t),T=c(e.name+"-name",0,t),y=[u,h,f,d,p,m,g,T],v=e.value,E=!1,C=!1,b=!1,S=!1,I=!1,x=!1,P=!1,w=!1;if(1==e.value.length&&"inherit"==e.value[0][1])return u.value=h.value=f.value=d.value=p.value=m.value=g.value=T.value=e.value,y;if(1<v.length&&l(v))throw new n("Invalid animation values at "+o(v[0][2][0])+". Ignoring.");for(a=0,s=v.length;a<s;a++)if(i=v[a],r.isTime(i[1])&&!E)u.value=[i],E=!0;else if(r.isTime(i[1])&&!b)f.value=[i],b=!0;else if(!r.isGlobal(i[1])&&!r.isTimingFunction(i[1])||C)if(!r.isAnimationIterationCountKeyword(i[1])&&!r.isPositiveNumber(i[1])||S)if(r.isAnimationDirectionKeyword(i[1])&&!I)p.value=[i],I=!0;else if(r.isAnimationFillModeKeyword(i[1])&&!x)m.value=[i],x=!0;else if(r.isAnimationPlayStateKeyword(i[1])&&!P)g.value=[i],P=!0;else{if(!r.isAnimationNameKeyword(i[1])&&!r.isIdentifier(i[1])||w)throw new n("Invalid animation value at "+o(i[2][0])+". Ignoring.");T.value=[i],w=!0}else d.value=[i],S=!0;else h.value=[i],C=!0;return y},background:function(e,t,r){var i=c("background-image",0,t),a=c("background-position",0,t),l=c("background-size",0,t),u=c("background-repeat",0,t),h=c("background-attachment",0,t),f=c("background-origin",0,t),d=c("background-clip",0,t),p=c("background-color",0,t),m=[i,a,l,u,h,f,d,p],g=e.value,T=!1,y=!1,v=!1,E=!1,C=!1;if(1==e.value.length&&"inherit"==e.value[0][1])return p.value=i.value=u.value=a.value=l.value=f.value=d.value=e.value,m;if(1==e.value.length&&"0 0"==e.value[0][1])return m;for(var b=g.length-1;0<=b;b--){var S=g[b];if(r.isBackgroundAttachmentKeyword(S[1]))h.value=[S],C=!0;else if(r.isBackgroundClipKeyword(S[1])||r.isBackgroundOriginKeyword(S[1]))y?(f.value=[S],v=!0):(d.value=[S],y=!0),C=!0;else if(r.isBackgroundRepeatKeyword(S[1]))E?u.value.unshift(S):(u.value=[S],E=!0),C=!0;else if(r.isBackgroundPositionKeyword(S[1])||r.isBackgroundSizeKeyword(S[1])||r.isUnit(S[1])||r.isDynamicUnit(S[1])){if(0<b){var I=g[b-1];I[1]==s.FORWARD_SLASH?l.value=[S]:1<b&&g[b-2][1]==s.FORWARD_SLASH?(l.value=[I,S],b-=2):(T||(a.value=[]),a.value.unshift(S),T=!0)}else T||(a.value=[]),a.value.unshift(S),T=!0;C=!0}else p.value[0][1]!=t[p.name].defaultValue&&"none"!=p.value[0][1]||!r.isColor(S[1])&&!r.isPrefixed(S[1])?(r.isUrl(S[1])||r.isFunction(S[1]))&&(i.value=[S],C=!0):(p.value=[S],C=!0)}if(y&&!v&&(f.value=d.value.slice(0)),!C)throw new n("Invalid background value at "+o(g[0][2][0])+". Ignoring.");return m},border:h,borderRadius:function(e,t){for(var r=e.value,i=-1,a=0,l=r.length;a<l;a++)if(r[a][1]==s.FORWARD_SLASH){i=a;break}if(0===i||i===r.length-1)throw new n("Invalid border-radius value at "+o(r[0][2][0])+". Ignoring.");var h=c(e.name,0,t);h.value=-1<i?r.slice(0,i):r.slice(0),h.components=u(h,t);var f=c(e.name,0,t);f.value=-1<i?r.slice(i+1):r.slice(0),f.components=u(f,t);for(var d=0;d<4;d++)h.components[d].multiplex=!0,h.components[d].value=h.components[d].value.concat(f.components[d].value);return h.components},font:function(e,t,r){var i,a,u,h,f=c("font-style",0,t),d=c("font-variant",0,t),p=c("font-weight",0,t),m=c("font-stretch",0,t),g=c("font-size",0,t),T=c("line-height",0,t),y=c("font-family",0,t),v=[f,d,p,m,g,T,y],E=e.value,C=0,b=!1,S=!1,I=!1,x=!1,P=!1;if(!E[C])throw new n("Missing font values at "+o(e.all[e.position][1][2][0])+". Ignoring.");if(1==E.length&&"inherit"==E[0][1])return f.value=d.value=p.value=m.value=g.value=T.value=y.value=E,v;if(1==E.length&&(r.isFontKeyword(E[0][1])||r.isGlobal(E[0][1])||r.isPrefixed(E[0][1])))return E[0][1]=s.INTERNAL+E[0][1],f.value=d.value=p.value=m.value=g.value=T.value=y.value=E,v;if(E.length<2||!function(e,t){var r,n,i;for(n=0,i=e.length;n<i;n++)if(r=e[n],t.isFontSizeKeyword(r[1])||t.isUnit(r[1])&&!t.isDynamicUnit(r[1])||t.isFunction(r[1]))return!0;return!1}(E,r)||!function(e,t){var r,n,i;for(n=0,i=e.length;n<i;n++)if(r=e[n],t.isIdentifier(r[1]))return!0;return!1}(E,r))throw new n("Invalid font values at "+o(e.all[e.position][1][2][0])+". Ignoring.");if(1<E.length&&l(E))throw new n("Invalid font values at "+o(E[0][2][0])+". Ignoring.");for(;C<4;){if(i=r.isFontStretchKeyword(E[C][1])||r.isGlobal(E[C][1]),a=r.isFontStyleKeyword(E[C][1])||r.isGlobal(E[C][1]),u=r.isFontVariantKeyword(E[C][1])||r.isGlobal(E[C][1]),h=r.isFontWeightKeyword(E[C][1])||r.isGlobal(E[C][1]),a&&!S)f.value=[E[C]],S=!0;else if(u&&!I)d.value=[E[C]],I=!0;else if(h&&!x)p.value=[E[C]],x=!0;else{if(!i||b){if(a&&S||u&&I||h&&x||i&&b)throw new n("Invalid font style / variant / weight / stretch value at "+o(E[0][2][0])+". Ignoring.");break}m.value=[E[C]],b=!0}C++}if(!(r.isFontSizeKeyword(E[C][1])||r.isUnit(E[C][1])&&!r.isDynamicUnit(E[C][1])))throw new n("Missing font size at "+o(E[0][2][0])+". Ignoring.");if(g.value=[E[C]],!0,!E[++C])throw new n("Missing font family at "+o(E[0][2][0])+". Ignoring.");for(E[C]&&E[C][1]==s.FORWARD_SLASH&&E[C+1]&&(r.isLineHeightKeyword(E[C+1][1])||r.isUnit(E[C+1][1])||r.isNumber(E[C+1][1]))&&(T.value=[E[C+1]],C++,C++),y.value=[];E[C];)P=E[C][1]!=s.COMMA&&(P?y.value[y.value.length-1][1]+=s.SPACE+E[C][1]:y.value.push(E[C]),!0),C++;if(0===y.value.length)throw new n("Missing font family at "+o(E[0][2][0])+". Ignoring.");return v},fourValues:u,listStyle:function(e,t,r){var n=c("list-style-type",0,t),i=c("list-style-position",0,t),a=c("list-style-image",0,t),s=[n,i,a];if(1==e.value.length&&"inherit"==e.value[0][1])return n.value=i.value=a.value=[e.value[0]],s;var o=e.value.slice(0),l=o.length,u=0;for(u=0,l=o.length;u<l;u++)if(r.isUrl(o[u][1])||"0"==o[u][1]){a.value=[o[u]],o.splice(u,1);break}for(u=0,l=o.length;u<l;u++)if(r.isListStylePositionKeyword(o[u][1])){i.value=[o[u]],o.splice(u,1);break}return 0<o.length&&(r.isListStyleTypeKeyword(o[0][1])||r.isIdentifier(o[0][1]))&&(n.value=[o[0]]),s},multiplex:function(e){return function(t,r,n){var i,o,l,u,h=[],f=t.value;for(i=0,l=f.length;i<l;i++)","==f[i][1]&&h.push(i);if(0===h.length)return e(t,r,n);var d=[];for(i=0,l=h.length;i<=l;i++){var p=0===i?0:h[i-1]+1,m=i<l?h[i]:f.length,g=c(t.name,0,r);g.value=f.slice(p,m),d.push(e(g,r,n))}var T=d[0];for(i=0,l=T.length;i<l;i++)for(T[i].multiplex=!0,o=1,u=d.length;o<u;o++)T[i].value.push([a.PROPERTY_VALUE,s.COMMA]),Array.prototype.push.apply(T[i].value,d[o][i].value);return T}},outline:h,transition:function(e,t,r){var i,a,s,u=c(e.name+"-property",0,t),h=c(e.name+"-duration",0,t),f=c(e.name+"-timing-function",0,t),d=c(e.name+"-delay",0,t),p=[u,h,f,d],m=e.value,g=!1,T=!1,y=!1,v=!1;if(1==e.value.length&&"inherit"==e.value[0][1])return u.value=h.value=f.value=d.value=e.value,p;if(1<m.length&&l(m))throw new n("Invalid animation values at "+o(m[0][2][0])+". Ignoring.");for(a=0,s=m.length;a<s;a++)if(i=m[a],r.isTime(i[1])&&!g)h.value=[i],g=!0;else if(r.isTime(i[1])&&!T)d.value=[i],T=!0;else if(!r.isGlobal(i[1])&&!r.isTimingFunction(i[1])||v){if(!r.isIdentifier(i[1])||y)throw new n("Invalid animation value at "+o(i[2][0])+". Ignoring.");u.value=[i],y=!0}else f.value=[i],v=!0;return p}}},{"../../tokenizer/marker":83,"../../tokenizer/token":84,"../../utils/format-position":87,"../wrap-for-optimizing":58,"./invalid-property-error":23}],19:[function(e,t,r){var n=e("./properties/understandable");function i(e){return function(t,r,i){return!(!n(t,r,i,0,!0)&&!t.isKeyword(e)(i))&&(!(!t.isVariable(r)||!t.isVariable(i))||t.isKeyword(e)(i))}}function a(e){return function(t,r,i){return!!(n(t,r,i,0,!0)||t.isKeyword(e)(i)||t.isGlobal(i))&&(!(!t.isVariable(r)||!t.isVariable(i))||t.isKeyword(e)(i)||t.isGlobal(i))}}function s(e,t,r){return i=t,a=r,!(!(n=e).isFunction(i)||!n.isFunction(a)||i.substring(0,i.indexOf("("))!==a.substring(0,a.indexOf("(")))||t===r;var n,i,a}function o(e,t,r){return!(!n(e,t,r,0,!0)&&!e.isUnit(r))&&(!(!e.isVariable(t)||!e.isVariable(r))||!(e.isUnit(t)&&!e.isUnit(r))&&(!!e.isUnit(r)||!e.isUnit(t)&&(!(!e.isFunction(t)||e.isPrefixed(t)||!e.isFunction(r)||e.isPrefixed(r))||s(e,t,r))))}function l(e){var t=a(e);return function(e,r,n){return o(e,r,n)||t(e,r,n)}}t.exports={generic:{color:function(e,t,r){return!(!n(e,t,r,0,!0)&&!e.isColor(r))&&(!(!e.isVariable(t)||!e.isVariable(r))||!(!e.colorOpacity&&(e.isRgbColor(t)||e.isHslColor(t)))&&!(!e.colorOpacity&&(e.isRgbColor(r)||e.isHslColor(r)))&&(!(!e.isColor(t)||!e.isColor(r))||s(e,t,r)))},components:function(e){return function(t,r,n,i){return e[i](t,r,n)}},image:function(e,t,r){return!(!n(e,t,r,0,!0)&&!e.isImage(r))&&(!(!e.isVariable(t)||!e.isVariable(r))||!!e.isImage(r)||!e.isImage(t)&&s(e,t,r))},propertyName:function(e,t,r){return!(!n(e,t,r,0,!0)&&!e.isIdentifier(r))&&(!(!e.isVariable(t)||!e.isVariable(r))||e.isIdentifier(r))},time:function(e,t,r){return!(!n(e,t,r,0,!0)&&!e.isTime(r))&&(!(!e.isVariable(t)||!e.isVariable(r))||!(e.isTime(t)&&!e.isTime(r))&&(!!e.isTime(r)||!e.isTime(t)&&(!(!e.isFunction(t)||e.isPrefixed(t)||!e.isFunction(r)||e.isPrefixed(r))||s(e,t,r))))},timingFunction:function(e,t,r){return!!(n(e,t,r,0,!0)||e.isTimingFunction(r)||e.isGlobal(r))&&(!(!e.isVariable(t)||!e.isVariable(r))||e.isTimingFunction(r)||e.isGlobal(r))},unit:o,unitOrNumber:function(e,t,r){return!!(n(e,t,r,0,!0)||e.isUnit(r)||e.isNumber(r))&&(!(!e.isVariable(t)||!e.isVariable(r))||!((e.isUnit(t)||e.isNumber(t))&&!e.isUnit(r)&&!e.isNumber(r))&&(!(!e.isUnit(r)&&!e.isNumber(r))||!e.isUnit(t)&&!e.isNumber(t)&&(!(!e.isFunction(t)||e.isPrefixed(t)||!e.isFunction(r)||e.isPrefixed(r))||s(e,t,r))))}},property:{animationDirection:a("animation-direction"),animationFillMode:i("animation-fill-mode"),animationIterationCount:function(e,t,r){return!!(n(e,t,r,0,!0)||e.isAnimationIterationCountKeyword(r)||e.isPositiveNumber(r))&&(!(!e.isVariable(t)||!e.isVariable(r))||e.isAnimationIterationCountKeyword(r)||e.isPositiveNumber(r))},animationName:function(e,t,r){return!!(n(e,t,r,0,!0)||e.isAnimationNameKeyword(r)||e.isIdentifier(r))&&(!(!e.isVariable(t)||!e.isVariable(r))||e.isAnimationNameKeyword(r)||e.isIdentifier(r))},animationPlayState:a("animation-play-state"),backgroundAttachment:i("background-attachment"),backgroundClip:a("background-clip"),backgroundOrigin:i("background-origin"),backgroundPosition:function(e,t,r){return!!(n(e,t,r,0,!0)||e.isBackgroundPositionKeyword(r)||e.isGlobal(r))&&(!(!e.isVariable(t)||!e.isVariable(r))||!(!e.isBackgroundPositionKeyword(r)&&!e.isGlobal(r))||o(e,t,r))},backgroundRepeat:i("background-repeat"),backgroundSize:function(e,t,r){return!!(n(e,t,r,0,!0)||e.isBackgroundSizeKeyword(r)||e.isGlobal(r))&&(!(!e.isVariable(t)||!e.isVariable(r))||!(!e.isBackgroundSizeKeyword(r)&&!e.isGlobal(r))||o(e,t,r))},bottom:l("bottom"),borderCollapse:i("border-collapse"),borderStyle:a("*-style"),clear:a("clear"),cursor:a("cursor"),display:a("display"),float:a("float"),left:l("left"),fontFamily:function(e,t,r){return n(e,t,r,0,!0)},fontStretch:a("font-stretch"),fontStyle:a("font-style"),fontVariant:a("font-variant"),fontWeight:a("font-weight"),listStyleType:a("list-style-type"),listStylePosition:a("list-style-position"),outlineStyle:a("*-style"),overflow:a("overflow"),position:a("position"),right:l("right"),textAlign:a("text-align"),textDecoration:a("text-decoration"),textOverflow:a("text-overflow"),textShadow:function(e,t,r){return!!(n(e,t,r,0,!0)||e.isUnit(r)||e.isColor(r)||e.isGlobal(r))&&(!(!e.isVariable(t)||!e.isVariable(r))||e.isUnit(r)||e.isColor(r)||e.isGlobal(r))},top:l("top"),transform:s,verticalAlign:l("vertical-align"),visibility:a("visibility"),whiteSpace:a("white-space"),zIndex:function(e,t,r){return!(!n(e,t,r,0,!0)&&!e.isZIndex(r))&&(!(!e.isVariable(t)||!e.isVariable(r))||e.isZIndex(r))}}}},{"./properties/understandable":40}],20:[function(e,t,r){var n=e("../wrap-for-optimizing").single,i=e("../../tokenizer/token");function a(e){var t=n([i.PROPERTY,[i.PROPERTY_NAME,e.name]]);return t.important=e.important,t.hack=e.hack,t.unused=!1,t}t.exports={deep:function(e){for(var t=a(e),r=e.components.length-1;0<=r;r--){var n=a(e.components[r]);n.value=e.components[r].value.slice(0),t.components.unshift(n)}return t.dirty=!0,t.value=e.value.slice(0),t},shallow:a}},{"../../tokenizer/token":84,"../wrap-for-optimizing":58}],21:[function(e,t,r){var n=e("./break-up"),i=e("./can-override"),a=e("./restore"),s=e("../../utils/override"),o={animation:{canOverride:i.generic.components([i.generic.time,i.generic.timingFunction,i.generic.time,i.property.animationIterationCount,i.property.animationDirection,i.property.animationFillMode,i.property.animationPlayState,i.property.animationName]),components:["animation-duration","animation-timing-function","animation-delay","animation-iteration-count","animation-direction","animation-fill-mode","animation-play-state","animation-name"],breakUp:n.multiplex(n.animation),defaultValue:"none",restore:a.multiplex(a.withoutDefaults),shorthand:!0,vendorPrefixes:["-moz-","-o-","-webkit-"]},"animation-delay":{canOverride:i.generic.time,componentOf:["animation"],defaultValue:"0s",intoMultiplexMode:"real",vendorPrefixes:["-moz-","-o-","-webkit-"]},"animation-direction":{canOverride:i.property.animationDirection,componentOf:["animation"],defaultValue:"normal",intoMultiplexMode:"real",vendorPrefixes:["-moz-","-o-","-webkit-"]},"animation-duration":{canOverride:i.generic.time,componentOf:["animation"],defaultValue:"0s",intoMultiplexMode:"real",keepUnlessDefault:"animation-delay",vendorPrefixes:["-moz-","-o-","-webkit-"]},"animation-fill-mode":{canOverride:i.property.animationFillMode,componentOf:["animation"],defaultValue:"none",intoMultiplexMode:"real",vendorPrefixes:["-moz-","-o-","-webkit-"]},"animation-iteration-count":{canOverride:i.property.animationIterationCount,componentOf:["animation"],defaultValue:"1",intoMultiplexMode:"real",vendorPrefixes:["-moz-","-o-","-webkit-"]},"animation-name":{canOverride:i.property.animationName,componentOf:["animation"],defaultValue:"none",intoMultiplexMode:"real",vendorPrefixes:["-moz-","-o-","-webkit-"]},"animation-play-state":{canOverride:i.property.animationPlayState,componentOf:["animation"],defaultValue:"running",intoMultiplexMode:"real",vendorPrefixes:["-moz-","-o-","-webkit-"]},"animation-timing-function":{canOverride:i.generic.timingFunction,componentOf:["animation"],defaultValue:"ease",intoMultiplexMode:"real",vendorPrefixes:["-moz-","-o-","-webkit-"]},background:{canOverride:i.generic.components([i.generic.image,i.property.backgroundPosition,i.property.backgroundSize,i.property.backgroundRepeat,i.property.backgroundAttachment,i.property.backgroundOrigin,i.property.backgroundClip,i.generic.color]),components:["background-image","background-position","background-size","background-repeat","background-attachment","background-origin","background-clip","background-color"],breakUp:n.multiplex(n.background),defaultValue:"0 0",restore:a.multiplex(a.background),shortestValue:"0",shorthand:!0},"background-attachment":{canOverride:i.property.backgroundAttachment,componentOf:["background"],defaultValue:"scroll",intoMultiplexMode:"real"},"background-clip":{canOverride:i.property.backgroundClip,componentOf:["background"],defaultValue:"border-box",intoMultiplexMode:"real",shortestValue:"border-box"},"background-color":{canOverride:i.generic.color,componentOf:["background"],defaultValue:"transparent",intoMultiplexMode:"real",multiplexLastOnly:!0,nonMergeableValue:"none",shortestValue:"red"},"background-image":{canOverride:i.generic.image,componentOf:["background"],defaultValue:"none",intoMultiplexMode:"default"},"background-origin":{canOverride:i.property.backgroundOrigin,componentOf:["background"],defaultValue:"padding-box",intoMultiplexMode:"real",shortestValue:"border-box"},"background-position":{canOverride:i.property.backgroundPosition,componentOf:["background"],defaultValue:["0","0"],doubleValues:!0,intoMultiplexMode:"real",shortestValue:"0"},"background-repeat":{canOverride:i.property.backgroundRepeat,componentOf:["background"],defaultValue:["repeat"],doubleValues:!0,intoMultiplexMode:"real"},"background-size":{canOverride:i.property.backgroundSize,componentOf:["background"],defaultValue:["auto"],doubleValues:!0,intoMultiplexMode:"real",shortestValue:"0 0"},bottom:{canOverride:i.property.bottom,defaultValue:"auto"},border:{breakUp:n.border,canOverride:i.generic.components([i.generic.unit,i.property.borderStyle,i.generic.color]),components:["border-width","border-style","border-color"],defaultValue:"none",overridesShorthands:["border-bottom","border-left","border-right","border-top"],restore:a.withoutDefaults,shorthand:!0,shorthandComponents:!0},"border-bottom":{breakUp:n.border,canOverride:i.generic.components([i.generic.unit,i.property.borderStyle,i.generic.color]),components:["border-bottom-width","border-bottom-style","border-bottom-color"],defaultValue:"none",restore:a.withoutDefaults,shorthand:!0},"border-bottom-color":{canOverride:i.generic.color,componentOf:["border-bottom","border-color"],defaultValue:"none"},"border-bottom-left-radius":{canOverride:i.generic.unit,componentOf:["border-radius"],defaultValue:"0",vendorPrefixes:["-moz-","-o-"]},"border-bottom-right-radius":{canOverride:i.generic.unit,componentOf:["border-radius"],defaultValue:"0",vendorPrefixes:["-moz-","-o-"]},"border-bottom-style":{canOverride:i.property.borderStyle,componentOf:["border-bottom","border-style"],defaultValue:"none"},"border-bottom-width":{canOverride:i.generic.unit,componentOf:["border-bottom","border-width"],defaultValue:"medium",oppositeTo:"border-top-width",shortestValue:"0"},"border-collapse":{canOverride:i.property.borderCollapse,defaultValue:"separate"},"border-color":{breakUp:n.fourValues,canOverride:i.generic.components([i.generic.color,i.generic.color,i.generic.color,i.generic.color]),componentOf:["border"],components:["border-top-color","border-right-color","border-bottom-color","border-left-color"],defaultValue:"none",restore:a.fourValues,shortestValue:"red",shorthand:!0},"border-left":{breakUp:n.border,canOverride:i.generic.components([i.generic.unit,i.property.borderStyle,i.generic.color]),components:["border-left-width","border-left-style","border-left-color"],defaultValue:"none",restore:a.withoutDefaults,shorthand:!0},"border-left-color":{canOverride:i.generic.color,componentOf:["border-color","border-left"],defaultValue:"none"},"border-left-style":{canOverride:i.property.borderStyle,componentOf:["border-left","border-style"],defaultValue:"none"},"border-left-width":{canOverride:i.generic.unit,componentOf:["border-left","border-width"],defaultValue:"medium",oppositeTo:"border-right-width",shortestValue:"0"},"border-radius":{breakUp:n.borderRadius,canOverride:i.generic.components([i.generic.unit,i.generic.unit,i.generic.unit,i.generic.unit]),components:["border-top-left-radius","border-top-right-radius","border-bottom-right-radius","border-bottom-left-radius"],defaultValue:"0",restore:a.borderRadius,shorthand:!0,vendorPrefixes:["-moz-","-o-"]},"border-right":{breakUp:n.border,canOverride:i.generic.components([i.generic.unit,i.property.borderStyle,i.generic.color]),components:["border-right-width","border-right-style","border-right-color"],defaultValue:"none",restore:a.withoutDefaults,shorthand:!0},"border-right-color":{canOverride:i.generic.color,componentOf:["border-color","border-right"],defaultValue:"none"},"border-right-style":{canOverride:i.property.borderStyle,componentOf:["border-right","border-style"],defaultValue:"none"},"border-right-width":{canOverride:i.generic.unit,componentOf:["border-right","border-width"],defaultValue:"medium",oppositeTo:"border-left-width",shortestValue:"0"},"border-style":{breakUp:n.fourValues,canOverride:i.generic.components([i.property.borderStyle,i.property.borderStyle,i.property.borderStyle,i.property.borderStyle]),componentOf:["border"],components:["border-top-style","border-right-style","border-bottom-style","border-left-style"],defaultValue:"none",restore:a.fourValues,shorthand:!0},"border-top":{breakUp:n.border,canOverride:i.generic.components([i.generic.unit,i.property.borderStyle,i.generic.color]),components:["border-top-width","border-top-style","border-top-color"],defaultValue:"none",restore:a.withoutDefaults,shorthand:!0},"border-top-color":{canOverride:i.generic.color,componentOf:["border-color","border-top"],defaultValue:"none"},"border-top-left-radius":{canOverride:i.generic.unit,componentOf:["border-radius"],defaultValue:"0",vendorPrefixes:["-moz-","-o-"]},"border-top-right-radius":{canOverride:i.generic.unit,componentOf:["border-radius"],defaultValue:"0",vendorPrefixes:["-moz-","-o-"]},"border-top-style":{canOverride:i.property.borderStyle,componentOf:["border-style","border-top"],defaultValue:"none"},"border-top-width":{canOverride:i.generic.unit,componentOf:["border-top","border-width"],defaultValue:"medium",oppositeTo:"border-bottom-width",shortestValue:"0"},"border-width":{breakUp:n.fourValues,canOverride:i.generic.components([i.generic.unit,i.generic.unit,i.generic.unit,i.generic.unit]),componentOf:["border"],components:["border-top-width","border-right-width","border-bottom-width","border-left-width"],defaultValue:"medium",restore:a.fourValues,shortestValue:"0",shorthand:!0},clear:{canOverride:i.property.clear,defaultValue:"none"},color:{canOverride:i.generic.color,defaultValue:"transparent",shortestValue:"red"},cursor:{canOverride:i.property.cursor,defaultValue:"auto"},display:{canOverride:i.property.display},float:{canOverride:i.property.float,defaultValue:"none"},font:{breakUp:n.font,canOverride:i.generic.components([i.property.fontStyle,i.property.fontVariant,i.property.fontWeight,i.property.fontStretch,i.generic.unit,i.generic.unit,i.property.fontFamily]),components:["font-style","font-variant","font-weight","font-stretch","font-size","line-height","font-family"],restore:a.font,shorthand:!0},"font-family":{canOverride:i.property.fontFamily,defaultValue:"user|agent|specific"},"font-size":{canOverride:i.generic.unit,defaultValue:"medium",shortestValue:"0"},"font-stretch":{canOverride:i.property.fontStretch,defaultValue:"normal"},"font-style":{canOverride:i.property.fontStyle,defaultValue:"normal"},"font-variant":{canOverride:i.property.fontVariant,defaultValue:"normal"},"font-weight":{canOverride:i.property.fontWeight,defaultValue:"normal",shortestValue:"400"},height:{canOverride:i.generic.unit,defaultValue:"auto",shortestValue:"0"},left:{canOverride:i.property.left,defaultValue:"auto"},"line-height":{canOverride:i.generic.unitOrNumber,defaultValue:"normal",shortestValue:"0"},"list-style":{canOverride:i.generic.components([i.property.listStyleType,i.property.listStylePosition,i.property.listStyleImage]),components:["list-style-type","list-style-position","list-style-image"],breakUp:n.listStyle,restore:a.withoutDefaults,defaultValue:"outside",shortestValue:"none",shorthand:!0},"list-style-image":{canOverride:i.generic.image,componentOf:["list-style"],defaultValue:"none"},"list-style-position":{canOverride:i.property.listStylePosition,componentOf:["list-style"],defaultValue:"outside",shortestValue:"inside"},"list-style-type":{canOverride:i.property.listStyleType,componentOf:["list-style"],defaultValue:"decimal|disc",shortestValue:"none"},margin:{breakUp:n.fourValues,canOverride:i.generic.components([i.generic.unit,i.generic.unit,i.generic.unit,i.generic.unit]),components:["margin-top","margin-right","margin-bottom","margin-left"],defaultValue:"0",restore:a.fourValues,shorthand:!0},"margin-bottom":{canOverride:i.generic.unit,componentOf:["margin"],defaultValue:"0",oppositeTo:"margin-top"},"margin-left":{canOverride:i.generic.unit,componentOf:["margin"],defaultValue:"0",oppositeTo:"margin-right"},"margin-right":{canOverride:i.generic.unit,componentOf:["margin"],defaultValue:"0",oppositeTo:"margin-left"},"margin-top":{canOverride:i.generic.unit,componentOf:["margin"],defaultValue:"0",oppositeTo:"margin-bottom"},outline:{canOverride:i.generic.components([i.generic.color,i.property.outlineStyle,i.generic.unit]),components:["outline-color","outline-style","outline-width"],breakUp:n.outline,restore:a.withoutDefaults,defaultValue:"0",shorthand:!0},"outline-color":{canOverride:i.generic.color,componentOf:["outline"],defaultValue:"invert",shortestValue:"red"},"outline-style":{canOverride:i.property.outlineStyle,componentOf:["outline"],defaultValue:"none"},"outline-width":{canOverride:i.generic.unit,componentOf:["outline"],defaultValue:"medium",shortestValue:"0"},overflow:{canOverride:i.property.overflow,defaultValue:"visible"},"overflow-x":{canOverride:i.property.overflow,defaultValue:"visible"},"overflow-y":{canOverride:i.property.overflow,defaultValue:"visible"},padding:{breakUp:n.fourValues,canOverride:i.generic.components([i.generic.unit,i.generic.unit,i.generic.unit,i.generic.unit]),components:["padding-top","padding-right","padding-bottom","padding-left"],defaultValue:"0",restore:a.fourValues,shorthand:!0},"padding-bottom":{canOverride:i.generic.unit,componentOf:["padding"],defaultValue:"0",oppositeTo:"padding-top"},"padding-left":{canOverride:i.generic.unit,componentOf:["padding"],defaultValue:"0",oppositeTo:"padding-right"},"padding-right":{canOverride:i.generic.unit,componentOf:["padding"],defaultValue:"0",oppositeTo:"padding-left"},"padding-top":{canOverride:i.generic.unit,componentOf:["padding"],defaultValue:"0",oppositeTo:"padding-bottom"},position:{canOverride:i.property.position,defaultValue:"static"},right:{canOverride:i.property.right,defaultValue:"auto"},"text-align":{canOverride:i.property.textAlign,defaultValue:"left|right"},"text-decoration":{canOverride:i.property.textDecoration,defaultValue:"none"},"text-overflow":{canOverride:i.property.textOverflow,defaultValue:"none"},"text-shadow":{canOverride:i.property.textShadow,defaultValue:"none"},top:{canOverride:i.property.top,defaultValue:"auto"},transform:{canOverride:i.property.transform,vendorPrefixes:["-moz-","-ms-","-webkit-"]},transition:{breakUp:n.multiplex(n.transition),canOverride:i.generic.components([i.property.transitionProperty,i.generic.time,i.generic.timingFunction,i.generic.time]),components:["transition-property","transition-duration","transition-timing-function","transition-delay"],defaultValue:"none",restore:a.multiplex(a.withoutDefaults),shorthand:!0,vendorPrefixes:["-moz-","-o-","-webkit-"]},"transition-delay":{canOverride:i.generic.time,componentOf:["transition"],defaultValue:"0s",intoMultiplexMode:"real",vendorPrefixes:["-moz-","-o-","-webkit-"]},"transition-duration":{canOverride:i.generic.time,componentOf:["transition"],defaultValue:"0s",intoMultiplexMode:"real",vendorPrefixes:["-moz-","-o-","-webkit-"]},"transition-property":{canOverride:i.generic.propertyName,componentOf:["transition"],defaultValue:"all",intoMultiplexMode:"placeholder",placeholderValue:"_",vendorPrefixes:["-moz-","-o-","-webkit-"]},"transition-timing-function":{canOverride:i.generic.timingFunction,componentOf:["transition"],defaultValue:"ease",intoMultiplexMode:"real",vendorPrefixes:["-moz-","-o-","-webkit-"]},"vertical-align":{canOverride:i.property.verticalAlign,defaultValue:"baseline"},visibility:{canOverride:i.property.visibility,defaultValue:"visible"},"white-space":{canOverride:i.property.whiteSpace,defaultValue:"normal"},width:{canOverride:i.generic.unit,defaultValue:"auto",shortestValue:"0"},"z-index":{canOverride:i.property.zIndex,defaultValue:"auto"}};function l(e,t){var r=s(o[e],{});return"componentOf"in r&&(r.componentOf=r.componentOf.map((function(e){return t+e}))),"components"in r&&(r.components=r.components.map((function(e){return t+e}))),"keepUnlessDefault"in r&&(r.keepUnlessDefault=t+r.keepUnlessDefault),r}var c={};for(var u in o){var h=o[u];if("vendorPrefixes"in h){for(var f=0;f<h.vendorPrefixes.length;f++){var d=h.vendorPrefixes[f],p=l(u,d);delete p.vendorPrefixes,c[d+u]=p}delete h.vendorPrefixes}}t.exports=s(o,c)},{"../../utils/override":95,"./break-up":18,"./can-override":19,"./restore":49}],22:[function(e,t,r){var n=e("../../tokenizer/token"),i=e("../../writer/one-time").rules,a=e("../../writer/one-time").value;t.exports=function e(t){var r,s,o,l,c,u,h,f=[];if(t[0]==n.RULE)for(r=!/[\.\+>~]/.test(i(t[1])),c=0,u=t[2].length;c<u;c++)(s=t[2][c])[0]==n.PROPERTY&&0!==(o=s[1][1]).length&&0!==o.indexOf("--")&&(l=a(s,c),f.push([o,l,(h=o,"list-style"==h?h:0<h.indexOf("-radius")?"border-radius":"border-collapse"==h||"border-spacing"==h||"border-image"==h?h:0===h.indexOf("border-")&&/^border\-\w+\-\w+$/.test(h)?h.match(/border\-\w+/)[0]:0===h.indexOf("border-")&&/^border\-\w+$/.test(h)?"border":0===h.indexOf("text-")||"-chrome-"==h?h:h.replace(/^\-\w+\-/,"").match(/([a-zA-Z]+)/)[0].toLowerCase()),t[2][c],o+":"+l,t[1],r]));else if(t[0]==n.NESTED_BLOCK)for(c=0,u=t[2].length;c<u;c++)f=f.concat(e(t[2][c]));return f}},{"../../tokenizer/token":84,"../../writer/one-time":98}],23:[function(e,t,r){function n(e){this.name="InvalidPropertyError",this.message=e,this.stack=(new Error).stack}(n.prototype=Object.create(Error.prototype)).constructor=n,t.exports=n},{}],24:[function(e,t,r){var n=e("../../tokenizer/marker"),i=e("../../utils/split"),a=/\/deep\//,s=/^::/,o=":not",l=[":dir",":lang",":not",":nth-child",":nth-last-child",":nth-last-of-type",":nth-of-type"],c=/[>\+~]/,u=[":after",":before",":first-letter",":first-line",":lang"],h=["::after","::before","::first-letter","::first-line"],f="double-quote",d="single-quote",p="root";function m(e){var t,r,i,a,s,o,l=[],u=[],h=p,m=0,g=!1,T=!1;for(s=0,o=e.length;s<o;s++)t=e[s],a=!i&&c.test(t),r=h==f||h==d,i?u.push(t):t==n.DOUBLE_QUOTE&&h==p?(u.push(t),h=f):t==n.DOUBLE_QUOTE&&h==f?(u.push(t),h=p):t==n.SINGLE_QUOTE&&h==p?(u.push(t),h=d):t==n.SINGLE_QUOTE&&h==d?(u.push(t),h=p):r?u.push(t):t==n.OPEN_ROUND_BRACKET?(u.push(t),m++):t==n.CLOSE_ROUND_BRACKET&&1==m&&g?(u.push(t),l.push(u.join("")),m--,g=!(u=[])):t==n.CLOSE_ROUND_BRACKET?(u.push(t),m--):t==n.COLON&&0===m&&g&&!T?(l.push(u.join("")),(u=[]).push(t)):t!=n.COLON||0!==m||T?t==n.SPACE&&0===m&&g||a&&0===m&&g?(l.push(u.join("")),g=!(u=[])):u.push(t):((u=[]).push(t),g=!0),i=t==n.BACK_SLASH,T=t==n.COLON;return 0<u.length&&g&&l.push(u.join("")),l}t.exports=function(e,t,r,c){var f,d,p,g,T,y,v,E=i(e,n.COMMA);for(d=0,p=E.length;d<p;d++)if(0===(f=E[d]).length||(v=f,a.test(v))||-1<f.indexOf(n.COLON)&&(y=c,!(function(e,t,r){var i,a,s,o;for(s=0,o=e.length;s<o;s++)if(a=-1<(i=e[s]).indexOf(n.OPEN_ROUND_BRACKET)?i.substring(0,i.indexOf(n.OPEN_ROUND_BRACKET)):i,-1===t.indexOf(a)&&-1===r.indexOf(a))return!1;return!0}(T=m(g=f),t,r)&&function(e){var t,r,i,a,s,o;for(s=0,o=e.length;s<o;s++){if(r=(a=-1<(i=(t=e[s]).indexOf(n.OPEN_ROUND_BRACKET)))?t.substring(0,i):t,a&&-1==l.indexOf(r))return!1;if(!a&&-1<l.indexOf(r))return!1}return!0}(T)&&(T.length<2||!function(e,t){var r,i,a,s,l,c,u,h,f=0;for(u=0,h=t.length;u<h&&(r=t[u],a=t[u+1]);u++)if(i=e.indexOf(r,f),f=s=e.indexOf(r,i+1),i+r.length==s&&(l=-1<r.indexOf(n.OPEN_ROUND_BRACKET)?r.substring(0,r.indexOf(n.OPEN_ROUND_BRACKET)):r,c=-1<a.indexOf(n.OPEN_ROUND_BRACKET)?a.substring(0,a.indexOf(n.OPEN_ROUND_BRACKET)):a,l!=o||c!=o))return!0;return!1}(g,T))&&(T.length<2||y&&function(e){var t,r,n,i,a=0;for(r=0,n=e.length;r<n;r++)if(i=t=e[r],s.test(i)?a+=-1<h.indexOf(t)?1:0:a+=-1<u.indexOf(t)?1:0,1<a)return!1;return!0}(T)))))return!1;return!0}},{"../../tokenizer/marker":83,"../../utils/split":96}],25:[function(e,t,r){var n=e("./is-mergeable"),i=e("./properties/optimize"),a=e("../level-1/sort-selectors"),s=e("../level-1/tidy-rules"),o=e("../../options/optimization-level").OptimizationLevel,l=e("../../writer/one-time").body,c=e("../../writer/one-time").rules,u=e("../../tokenizer/token");t.exports=function(e,t){for(var r=[null,[],[]],h=t.options,f=h.compatibility.selectors.adjacentSpace,d=h.level[o.One].selectorsSortingMethod,p=h.compatibility.selectors.mergeablePseudoClasses,m=h.compatibility.selectors.mergeablePseudoElements,g=h.compatibility.selectors.mergeLimit,T=h.compatibility.selectors.multiplePseudoMerging,y=0,v=e.length;y<v;y++){var E=e[y];E[0]==u.RULE?r[0]==u.RULE&&c(E[1])==c(r[1])?(Array.prototype.push.apply(r[2],E[2]),i(r[2],!0,!0,t),E[2]=[]):r[0]==u.RULE&&l(E[2])==l(r[2])&&n(c(E[1]),p,m,T)&&n(c(r[1]),p,m,T)&&r[1].length<g?(r[1]=s(r[1].concat(E[1]),!1,f,!1,t.warnings),r[1]=1<r.length?a(r[1],d):r[1],E[2]=[]):r=E:r=[null,[],[]]}}},{"../../options/optimization-level":65,"../../tokenizer/token":84,"../../writer/one-time":98,"../level-1/sort-selectors":14,"../level-1/tidy-rules":17,"./is-mergeable":24,"./properties/optimize":36}],26:[function(e,t,r){var n=e("./reorderable").canReorder,i=e("./reorderable").canReorderSingle,a=e("./extract-properties"),s=e("./rules-overlap"),o=e("../../writer/one-time").rules,l=e("../../options/optimization-level").OptimizationLevel,c=e("../../tokenizer/token");function u(e,t,r){var n,a,o,l,c,u,h,f;for(c=0,u=e.length;c<u;c++)for(a=(n=e[c])[5],h=0,f=t.length;h<f;h++)if(l=(o=t[h])[5],s(a,l,!0)&&!i(n,o,r))return!1;return!0}t.exports=function(e,t){for(var r=t.options.level[l.Two].mergeSemantically,i=t.cache.specificity,s={},h=[],f=e.length-1;0<=f;f--){var d=e[f];if(d[0]==c.NESTED_BLOCK){var p=o(d[1]),m=s[p];m||(m=[],s[p]=m),m.push(f)}}for(var g in s){var T=s[g];e:for(var y=T.length-1;0<y;y--){var v=T[y],E=e[v],C=T[y-1],b=e[C];t:for(var S=1;-1<=S;S-=2){for(var I=1==S,x=I?v+1:C-1,P=I?C:v,w=I?1:-1,D=I?E:b,_=I?b:E,A=a(D);x!=P;){var R=a(e[x]);if(x+=w,!(r&&u(A,R,i)||n(A,R,i)))continue t}_[2]=I?D[2].concat(_[2]):_[2].concat(D[2]),D[2]=[],h.push(_);continue e}}}return h}},{"../../options/optimization-level":65,"../../tokenizer/token":84,"../../writer/one-time":98,"./extract-properties":22,"./reorderable":47,"./rules-overlap":51}],27:[function(e,t,r){var n=e("./is-mergeable"),i=e("../level-1/sort-selectors"),a=e("../level-1/tidy-rules"),s=e("../../options/optimization-level").OptimizationLevel,o=e("../../writer/one-time").body,l=e("../../writer/one-time").rules,c=e("../../tokenizer/token");function u(e){return e.replace(/--[^ ,>\+~:]+/g,"")}function h(e,t){var r=u(l(e[1]));for(var n in t){var i=t[n],a=u(l(i[1]));(-1<a.indexOf(r)||-1<r.indexOf(a))&&delete t[n]}}t.exports=function(e,t){for(var r,u,f=t.options,d=f.level[s.Two].mergeSemantically,p=f.compatibility.selectors.adjacentSpace,m=f.level[s.One].selectorsSortingMethod,g=f.compatibility.selectors.mergeablePseudoClasses,T=f.compatibility.selectors.mergeablePseudoElements,y=f.compatibility.selectors.multiplePseudoMerging,v={},E=e.length-1;0<=E;E--){var C=e[E];if(C[0]==c.RULE){0<C[2].length&&!d&&(u=l(C[1]),/\.|\*| :/.test(u))&&(v={}),0<C[2].length&&d&&(r=void 0,-1<(r=l(C[1])).indexOf("__")||-1<r.indexOf("--"))&&h(C,v);var b=o(C[2]),S=v[b];S&&n(l(C[1]),g,T,y)&&n(l(S[1]),g,T,y)&&(0<C[2].length?(C[1]=a(S[1].concat(C[1]),!1,p,!1,t.warnings),C[1]=1<C[1].length?i(C[1],m):C[1]):C[1]=S[1].concat(C[1]),S[2]=[],v[b]=null),v[o(C[2])]=C}}}},{"../../options/optimization-level":65,"../../tokenizer/token":84,"../../writer/one-time":98,"../level-1/sort-selectors":14,"../level-1/tidy-rules":17,"./is-mergeable":24}],28:[function(e,t,r){var n=e("./reorderable").canReorder,i=e("./extract-properties"),a=e("./properties/optimize"),s=e("../../writer/one-time").rules,o=e("../../tokenizer/token");t.exports=function(e,t){var r,l=t.cache.specificity,c={},u=[];for(r=e.length-1;0<=r;r--)if(e[r][0]==o.RULE&&0!==e[r][2].length){var h=s(e[r][1]);c[h]=[r].concat(c[h]||[]),2==c[h].length&&u.push(h)}for(r=u.length-1;0<=r;r--){var f=c[u[r]];e:for(var d=f.length-1;0<d;d--){var p=f[d-1],m=e[p],g=f[d],T=e[g];t:for(var y=1;-1<=y;y-=2){for(var v=1==y,E=v?p+1:g-1,C=v?g:p,b=v?1:-1,S=v?m:T,I=v?T:m,x=i(S);E!=C;){var P=i(e[E]);E+=b;var w=v?n(x,P,l):n(P,x,l);if(!w&&!v)continue e;if(!w&&v)continue t}v?(Array.prototype.push.apply(S[2],I[2]),I[2]=S[2]):Array.prototype.push.apply(I[2],S[2]),a(I[2],!0,!0,t),S[2]=[]}}}}},{"../../tokenizer/token":84,"../../writer/one-time":98,"./extract-properties":22,"./properties/optimize":36,"./reorderable":47}],29:[function(e,t,r){var n=e("./merge-adjacent"),i=e("./merge-media-queries"),a=e("./merge-non-adjacent-by-body"),s=e("./merge-non-adjacent-by-selector"),o=e("./reduce-non-adjacent"),l=e("./remove-duplicate-font-at-rules"),c=e("./remove-duplicate-media-queries"),u=e("./remove-duplicates"),h=e("./remove-unused-at-rules"),f=e("./restructure"),d=e("./properties/optimize"),p=e("../../options/optimization-level").OptimizationLevel,m=e("../../tokenizer/token");t.exports=function e(t,r,g){var T,y,v=r.options.level[p.Two];if(function(t,r){for(var n=0,i=t.length;n<i;n++){var a=t[n];if(a[0]==m.NESTED_BLOCK){var s=/@(-moz-|-o-|-webkit-)?keyframes/.test(a[1][0][1]);e(a[2],r,!s)}}}(t,r),function e(t,r){for(var n=0,i=t.length;n<i;n++){var a=t[n];switch(a[0]){case m.RULE:d(a[2],!0,!0,r);break;case m.NESTED_BLOCK:e(a[2],r)}}}(t,r),v.removeDuplicateRules&&u(t,r),v.mergeAdjacentRules&&n(t,r),v.reduceNonAdjacentRules&&o(t,r),v.mergeNonAdjacentRules&&"body"!=v.mergeNonAdjacentRules&&s(t,r),v.mergeNonAdjacentRules&&"selector"!=v.mergeNonAdjacentRules&&a(t,r),v.restructureRules&&v.mergeAdjacentRules&&g&&(f(t,r),n(t,r)),v.restructureRules&&!v.mergeAdjacentRules&&g&&f(t,r),v.removeDuplicateFontRules&&l(t,r),v.removeDuplicateMediaBlocks&&c(t,r),v.removeUnusedAtRules&&h(t,r),v.mergeMedia)for(y=(T=i(t,r)).length-1;0<=y;y--)e(T[y][2],r,!1);return v.removeEmpty&&function e(t){for(var r=0,n=t.length;r<n;r++){var i=t[r],a=!1;switch(i[0]){case m.RULE:a=0===i[1].length||0===i[2].length;break;case m.NESTED_BLOCK:e(i[2]),a=0===i[2].length;break;case m.AT_RULE:a=0===i[1].length;break;case m.AT_RULE_BLOCK:a=0===i[2].length}a&&(t.splice(r,1),r--,n--)}}(t),t}},{"../../options/optimization-level":65,"../../tokenizer/token":84,"./merge-adjacent":25,"./merge-media-queries":26,"./merge-non-adjacent-by-body":27,"./merge-non-adjacent-by-selector":28,"./properties/optimize":36,"./reduce-non-adjacent":42,"./remove-duplicate-font-at-rules":43,"./remove-duplicate-media-queries":44,"./remove-duplicates":45,"./remove-unused-at-rules":46,"./restructure":50}],30:[function(e,t,r){var n=e("../../../tokenizer/marker");t.exports=function(e,t,r){var i,a,s,o=t.value.length,l=r.value.length,c=Math.max(o,l),u=Math.min(o,l)-1;for(s=0;s<c;s++)if(i=t.value[s]&&t.value[s][1]||i,a=r.value[s]&&r.value[s][1]||a,i!=n.COMMA&&a!=n.COMMA&&!e(i,a,s,s<=u))return!1;return!0}},{"../../../tokenizer/marker":83}],31:[function(e,t,r){var n=e("../compactable");function i(e,t){return e.components.filter(t)[0]}t.exports=function(e,t){var r,a=(r=t,function(e){return r.name===e.name});return i(e,a)||function(e,t){var r,a,s;if(n[e.name].shorthandComponents)for(a=0,s=e.components.length;a<s;a++)if(r=i(e.components[a],t))return r}(e,a)}},{"../compactable":21}],32:[function(e,t,r){t.exports=function(e){for(var t=e.value.length-1;0<=t;t--)if("inherit"==e.value[t][1])return!0;return!1}},{}],33:[function(e,t,r){var n=e("../compactable");function i(e,t){var r=n[e.name];return"components"in r&&-1<r.components.indexOf(t.name)}t.exports=function(e,t,r){return i(e,t)||!r&&!!n[e.name].shorthandComponents&&(a=t,e.components.some((function(e){return i(e,a)})));var a}},{"../compactable":21}],34:[function(e,t,r){var n=e("../../../tokenizer/marker");t.exports=function(e){return"font"!=e.name||-1==e.value[0][1].indexOf(n.INTERNAL)}},{"../../../tokenizer/marker":83}],35:[function(e,t,r){var n=e("./every-values-pair"),i=e("./has-inherit"),a=e("./populate-components"),s=e("../compactable"),o=e("../clone").deep,l=e("../restore-with-components"),c=e("../../restore-from-optimizing"),u=e("../../wrap-for-optimizing").single,h=e("../../../writer/one-time").body,f=e("../../../tokenizer/token");function d(e,t,r,n){var i,a,o,l=e[t];for(i in r)void 0!==l&&i==l.name||(a=s[i],o=r[i],l&&p(r,i,l)?delete r[i]:a.components.length>Object.keys(o).length||m(o)||g(o,i,n)&&T(o)&&(y(o)?v(e,o,i,n):I(e,o,i,n)))}function p(e,t,r){var n,i=s[t],a=s[r.name];if("overridesShorthands"in i&&-1<i.overridesShorthands.indexOf(r.name))return!0;if(a&&"componentOf"in a)for(n in e[t])if(-1<a.componentOf.indexOf(n))return!0;return!1}function m(e){var t,r;for(r in e){if(void 0!==t&&e[r].important!=t)return!0;t=e[r].important}return!1}function g(e,t,r){var i,o,l,c,h=s[t],d=[f.PROPERTY,[f.PROPERTY_NAME,t],[f.PROPERTY_VALUE,h.defaultValue]],p=u(d);for(a([p],r,[]),l=0,c=h.components.length;l<c;l++)if(i=e[h.components[l]],o=s[i.name].canOverride,!n(o.bind(null,r),p.components[l],i))return!1;return!0}function T(e){var t,r,n,i,a=null;for(r in e)if(n=e[r],"restore"in(i=s[r])){if(c([n.all[n.position]],l),t=i.restore(n,s).length,null!==a&&t!==a)return!1;a=t}return!0}function y(e){var t,r,n=null;for(t in e){if(r=i(e[t]),null!==n&&n!==r)return!0;n=r}return!1}function v(e,t,r,n){var d,p,m,g,T=function(e,t,r){var n,h,d,p,m,g,T=[],y={},v={},b=s[t],S=[f.PROPERTY,[f.PROPERTY_NAME,t],[f.PROPERTY_VALUE,b.defaultValue]],I=u(S);for(a([I],r,[]),m=0,g=b.components.length;m<g;m++)n=e[b.components[m]],i(n)?(h=n.all[n.position].slice(0,2),Array.prototype.push.apply(h,n.value),T.push(h),(d=o(n)).value=E(e,d.name),I.components[m]=d,y[n.name]=o(n)):((d=o(n)).all=n.all,I.components[m]=d,v[n.name]=n);return p=C(v,1),S[1].push(p),c([I],l),S=S.slice(0,2),Array.prototype.push.apply(S,I.value),T.unshift(S),[T,I,y]}(t,r,n),y=function(e,t,r){var n,l,c,h,d,p,m=[],g={},T={},y=s[t],v=[f.PROPERTY,[f.PROPERTY_NAME,t],[f.PROPERTY_VALUE,"inherit"]],E=u(v);for(a([E],r,[]),d=0,p=y.components.length;d<p;d++)n=e[y.components[d]],i(n)?g[n.name]=n:(l=n.all[n.position].slice(0,2),Array.prototype.push.apply(l,n.value),m.push(l),T[n.name]=o(n));return c=C(g,1),v[1].push(c),h=C(g,2),v[2].push(h),m.unshift(v),[m,E,T]}(t,r,n),v=T[0],b=y[0],I=h(v).length<h(b).length,x=I?v:b,P=I?T[1]:y[1],w=I?T[2]:y[2],D=t[Object.keys(t)[0]].all;for(d in P.position=D.length,P.shorthand=!0,P.dirty=!0,P.all=D,P.all.push(x[0]),e.push(P),t)(p=t[d]).unused=!0,p.name in w&&(m=w[p.name],g=S(x,d),m.position=D.length,m.all=D,m.all.push(g),e.push(m))}function E(e,t){var r=s[t];return"oppositeTo"in r?e[r.oppositeTo].value:[[f.PROPERTY_VALUE,r.defaultValue]]}function C(e,t){var r,n,i,a,s=[];for(a in e)i=(n=(r=e[a]).all[r.position])[t][n[t].length-1],Array.prototype.push.apply(s,i);return s.sort(b)}function b(e,t){var r=e[0],n=t[0],i=e[1],a=t[1];return r<n||r===n&&i<a?-1:1}function S(e,t){var r,n;for(r=0,n=e.length;r<n;r++)if(e[r][1][1]==t)return e[r]}function I(e,t,r,n){var i,l,c,h=s[r],d=[f.PROPERTY,[f.PROPERTY_NAME,r],[f.PROPERTY_VALUE,h.defaultValue]],p=u(d);p.shorthand=!0,p.dirty=!0,a([p],n,[]);for(var m=0,g=h.components.length;m<g;m++){var T=t[h.components[m]];p.components[m]=o(T),p.important=T.important,c=T.all}for(var y in t)t[y].unused=!0;i=C(t,1),d[1].push(i),l=C(t,2),d[2].push(l),p.position=c.length,p.all=c,p.all.push(d),e.push(p)}t.exports=function(e,t){var r,n,i,a,o,l,c,u={};if(!(e.length<3)){for(a=0,o=e.length;a<o;a++)if(i=e[a],r=s[i.name],!i.unused&&!i.hack&&!i.block&&(d(e,a,u,t),r&&r.componentOf))for(l=0,c=r.componentOf.length;l<c;l++)u[n=r.componentOf[l]]=u[n]||{},u[n][i.name]=i;d(e,a,u,t)}}},{"../../../tokenizer/token":84,"../../../writer/one-time":98,"../../restore-from-optimizing":56,"../../wrap-for-optimizing":58,"../clone":20,"../compactable":21,"../restore-with-components":48,"./every-values-pair":30,"./has-inherit":32,"./populate-components":39}],36:[function(e,t,r){var n=e("./merge-into-shorthands"),i=e("./override-properties"),a=e("./populate-components"),s=e("../restore-with-components"),o=e("../../wrap-for-optimizing").all,l=e("../../remove-unused"),c=e("../../restore-from-optimizing"),u=e("../../../options/optimization-level").OptimizationLevel;t.exports=function e(t,r,h,f){var d,p,m,g=f.options.level[u.Two],T=o(t,!1,g.skipProperties);for(a(T,f.validator,f.warnings),p=0,m=T.length;p<m;p++)(d=T[p]).block&&e(d.value[0][1],r,h,f);h&&g.mergeIntoShorthands&&n(T,f.validator),r&&g.overrideProperties&&i(T,h,f.options.compatibility,f.validator),c(T,s),l(T)}},{"../../../options/optimization-level":65,"../../remove-unused":55,"../../restore-from-optimizing":56,"../../wrap-for-optimizing":58,"../restore-with-components":48,"./merge-into-shorthands":35,"./override-properties":37,"./populate-components":39}],37:[function(e,t,r){var n=e("./has-inherit"),i=e("./every-values-pair"),a=e("./find-component-in"),s=e("./is-component-of"),o=e("./is-mergeable-shorthand"),l=e("./overrides-non-component-shorthand"),c=e("./vendor-prefixes").same,u=e("../compactable"),h=e("../clone").deep,f=e("../restore-with-components"),d=e("../clone").shallow,p=e("../../restore-from-optimizing"),m=e("../../../tokenizer/token"),g=e("../../../tokenizer/marker"),T=e("../../../writer/one-time").property;function y(e,t){for(var r=0;r<e.components.length;r++){var n=e.components[r],a=u[n.name],s=a&&a.canOverride||s.sameValue,o=d(n);if(o.value=[[m.PROPERTY_VALUE,a.defaultValue]],!i(s.bind(null,t),o,n))return!0}return!1}function v(e,t){t.unused=!0,S(t,x(e)),e.value=t.value}function E(e,t){t.unused=!0,e.multiplex=!0,e.value=t.value}function C(e,t){var r,n;t.multiplex?E(e,t):e.multiplex?v(e,t):(r=e,(n=t).unused=!0,r.value=n.value)}function b(e,t){t.unused=!0;for(var r=0,n=e.components.length;r<n;r++)C(e.components[r],t.components[r],e.multiplex)}function S(e,t){e.multiplex=!0,u[e.name].shorthand?function(e,t){var r,n,i;for(n=0,i=e.components.length;n<i;n++)(r=e.components[n]).multiplex||I(r,t)}(e,t):I(e,t)}function I(e,t){for(var r,n=u[e.name],i="real"==n.intoMultiplexMode,a="real"==n.intoMultiplexMode?e.value.slice(0):"placeholder"==n.intoMultiplexMode?n.placeholderValue:n.defaultValue,s=x(e),o=a.length;s<t;s++)if(e.value.push([m.PROPERTY_VALUE,g.COMMA]),Array.isArray(a))for(r=0;r<o;r++)e.value.push(i?a[r]:[m.PROPERTY_VALUE,a[r]]);else e.value.push(i?a:[m.PROPERTY_VALUE,a])}function x(e){for(var t=0,r=0,n=e.value.length;r<n;r++)e.value[r][1]==g.COMMA&&t++;return t+1}function P(e){var t=[m.PROPERTY,[m.PROPERTY_NAME,e.name]].concat(e.value);return T([t],0).length}function w(e,t,r){for(var n=0,i=t;0<=i&&(e[i].name!=r||e[i].unused||n++,!(1<n));i--);return 1<n}function D(e,t){for(var r=0,n=e.components.length;r<n;r++)if(!_(t.isUrl,e.components[r])&&_(t.isFunction,e.components[r]))return!0;return!1}function _(e,t){for(var r=0,n=t.value.length;r<n;r++)if(t.value[r][1]!=g.COMMA&&e(t.value[r][1]))return!0;return!1}function A(e,t){if(!e.multiplex&&!t.multiplex||e.multiplex&&t.multiplex)return!1;var r,n=e.multiplex?e:t,i=e.multiplex?t:e,s=h(n);p([s],f);var o=h(i);p([o],f);var l=P(s)+1+P(o);return e.multiplex?v(r=a(s,o),o):(r=a(o,s),S(o,x(s)),E(r,s)),p([o],f),l<=P(o)}function R(e){return e.name in u}function M(e,t){return!e.multiplex&&("background"==e.name||"background-image"==e.name)&&t.multiplex&&("background"==t.name||"background-image"==t.name)&&function(e){for(var t=function(e){for(var t=[],r=0,n=[],i=e.length;r<i;r++){var a=e[r];a[1]==g.COMMA?(t.push(n),n=[]):n.push(a)}return t.push(n),t}(e),r=0,n=t.length;r<n;r++)if(1==t[r].length&&"none"==t[r][0][1])return!0;return!1}(t.value)}t.exports=function(e,t,r,h){var f,d,p,m,g,T,v,E,I,P,N;e:for(I=e.length-1;0<=I;I--)if(R(d=e[I])&&!d.block){f=u[d.name].canOverride;t:for(P=I-1;0<=P;P--)if(R(p=e[P])&&!p.block&&!p.unused&&!d.unused&&(!p.hack||d.hack||d.important)&&(p.hack||p.important||!d.hack)&&(p.important!=d.important||p.hack[0]==d.hack[0])&&!(p.important==d.important&&(p.hack[0]!=d.hack[0]||p.hack[1]&&p.hack[1]!=d.hack[1])||n(d)||M(p,d)))if(d.shorthand&&s(d,p)){if(!d.important&&p.important)continue;if(!c([p],d.components))continue;if(!_(h.isFunction,p)&&D(d,h))continue;if(!o(d)){p.unused=!0;continue}m=a(d,p),f=u[p.name].canOverride,i(f.bind(null,h),p,m)&&(p.unused=!0)}else if(d.shorthand&&l(d,p)){if(!d.important&&p.important)continue;if(!c([p],d.components))continue;if(!_(h.isFunction,p)&&D(d,h))continue;for(N=(g=p.shorthand?p.components:[p]).length-1;0<=N;N--)if(T=g[N],v=a(d,T),f=u[T.name].canOverride,!i(f.bind(null,h),p,v))continue t;p.unused=!0}else if(t&&p.shorthand&&!d.shorthand&&s(p,d,!0)){if(d.important&&!p.important)continue;if(!d.important&&p.important){d.unused=!0;continue}if(w(e,I-1,p.name))continue;if(D(p,h))continue;if(!o(p))continue;if(m=a(p,d),i(f.bind(null,h),m,d)){var k=!r.properties.backgroundClipMerging&&-1<m.name.indexOf("background-clip")||!r.properties.backgroundOriginMerging&&-1<m.name.indexOf("background-origin")||!r.properties.backgroundSizeMerging&&-1<m.name.indexOf("background-size"),O=u[d.name].nonMergeableValue===d.value[0][1];if(k||O)continue;if(!r.properties.merging&&y(p,h))continue;if(m.value[0][1]!=d.value[0][1]&&(n(p)||n(d)))continue;if(A(p,d))continue;!p.multiplex&&d.multiplex&&S(p,x(d)),C(m,d),p.dirty=!0}}else if(t&&p.shorthand&&d.shorthand&&p.name==d.name){if(!p.multiplex&&d.multiplex)continue;if(!d.important&&p.important){d.unused=!0;continue e}if(d.important&&!p.important){p.unused=!0;continue}if(!o(d)){p.unused=!0;continue}for(N=p.components.length-1;0<=N;N--){var L=p.components[N],F=d.components[N];if(f=u[L.name].canOverride,!i(f.bind(null,h),L,F))continue e}b(p,d),p.dirty=!0}else if(t&&p.shorthand&&d.shorthand&&s(p,d)){if(!p.important&&d.important)continue;if(m=a(p,d),f=u[d.name].canOverride,!i(f.bind(null,h),m,d))continue;if(p.important&&!d.important){d.unused=!0;continue}if(1<u[d.name].restore(d,u).length)continue;C(m=a(p,d),d),d.dirty=!0}else if(p.name==d.name){if(E=!0,d.shorthand)for(N=d.components.length-1;0<=N&&E;N--)T=p.components[N],v=d.components[N],f=u[v.name].canOverride,E=E&&i(f.bind(null,h),T,v);else f=u[d.name].canOverride,E=i(f.bind(null,h),p,d);if(p.important&&!d.important&&E){d.unused=!0;continue}if(!p.important&&d.important&&E){p.unused=!0;continue}if(!E)continue;p.unused=!0}}}},{"../../../tokenizer/marker":83,"../../../tokenizer/token":84,"../../../writer/one-time":98,"../../restore-from-optimizing":56,"../clone":20,"../compactable":21,"../restore-with-components":48,"./every-values-pair":30,"./find-component-in":31,"./has-inherit":32,"./is-component-of":33,"./is-mergeable-shorthand":34,"./overrides-non-component-shorthand":38,"./vendor-prefixes":41}],38:[function(e,t,r){var n=e("../compactable");t.exports=function(e,t){return e.name in n&&"overridesShorthands"in n[e.name]&&-1<n[e.name].overridesShorthands.indexOf(t.name)}},{"../compactable":21}],39:[function(e,t,r){var n=e("../compactable"),i=e("../invalid-property-error");t.exports=function(e,t,r){for(var a,s,o,l=e.length-1;0<=l;l--){var c=e[l],u=n[c.name];if(u&&u.shorthand){c.shorthand=!0,c.dirty=!0;try{if(c.components=u.breakUp(c,n,t),u.shorthandComponents)for(s=0,o=c.components.length;s<o;s++)(a=c.components[s]).components=n[a.name].breakUp(a,n,t)}catch(e){if(!(e instanceof i))throw e;c.components=[],r.push(e.message)}0<c.components.length?c.multiplex=c.components[0].multiplex:c.unused=!0}}}},{"../compactable":21,"../invalid-property-error":23}],40:[function(e,t,r){var n=e("./vendor-prefixes").same;t.exports=function(e,t,r,i,a){return!(!n(t,r)||a&&e.isVariable(t)!==e.isVariable(r))}},{"./vendor-prefixes":41}],41:[function(e,t,r){var n=/(?:^|\W)(\-\w+\-)/g;function i(e){for(var t,r=[];null!==(t=n.exec(e));)-1==r.indexOf(t[0])&&r.push(t[0]);return r}t.exports={unique:i,same:function(e,t){return i(e).sort().join(",")==i(t).sort().join(",")}}},{}],42:[function(e,t,r){var n=e("./is-mergeable"),i=e("./properties/optimize"),a=e("../../utils/clone-array"),s=e("../../tokenizer/token"),o=e("../../writer/one-time").body,l=e("../../writer/one-time").rules;function c(e){for(var t=[],r=0;r<e.length;r++)t.push([e[r][1]]);return t}function u(e,t,r,n,s){for(var o=[],l=[],c=[],u=t.length-1;0<=u;u--)if(!r.filterOut(u,o)){var h=t[u].where,f=e[h],d=a(f[2]);o=o.concat(d),l.push(d),c.push(h)}i(o,!0,!1,s);for(var p=c.length,m=o.length-1,g=p-1;0<=g;)if((0===g||o[m]&&-1<l[g].indexOf(o[m]))&&-1<m)m--;else{var T=o.splice(m+1);r.callback(e[c[g]],T,p,g),g--}}t.exports=function(e,t){for(var r=t.options,i=r.compatibility.selectors.mergeablePseudoClasses,a=r.compatibility.selectors.mergeablePseudoElements,h=r.compatibility.selectors.multiplePseudoMerging,f={},d=[],p=e.length-1;0<=p;p--){var m=e[p];if(m[0]==s.RULE&&0!==m[2].length)for(var g=l(m[1]),T=1<m[1].length&&n(g,i,a,h),y=c(m[1]),v=T?[g].concat(y):[g],E=0,C=v.length;E<C;E++){var b=v[E];f[b]?d.push(b):f[b]=[],f[b].push({where:p,list:y,isPartial:T&&0<E,isComplex:T&&0===E})}}!function(e,t,r,n,i){function a(e,t){return c[e].isPartial&&0===t.length}function s(e,t,r,n){c[r-n-1].isPartial||(e[2]=t)}for(var o=0,l=t.length;o<l;o++){var c=r[t[o]];u(e,c,{filterOut:a,callback:s},0,i)}}(e,d,f,0,t),function(e,t,r,i){var a=r.compatibility.selectors.mergeablePseudoClasses,s=r.compatibility.selectors.mergeablePseudoElements,l=r.compatibility.selectors.multiplePseudoMerging,c={};function h(e){return c.data[e].where<c.intoPosition}function f(e,t,r,n){0===n&&c.reducedBodies.push(t)}e:for(var d in t){var p=t[d];if(p[0].isComplex){var m=p[p.length-1].where,g=e[m],T=[],y=n(d,a,s,l)?p[0].list:[d];c.intoPosition=m,c.reducedBodies=T;for(var v=0,E=y.length;v<E;v++){var C=t[y[v]];if(C.length<2)continue e;if(c.data=C,u(e,C,{filterOut:h,callback:f},0,i),o(T[T.length-1])!=o(T[0]))continue e}g[2]=T[0]}}}(e,f,r,t)}},{"../../tokenizer/token":84,"../../utils/clone-array":86,"../../writer/one-time":98,"./is-mergeable":24,"./properties/optimize":36}],43:[function(e,t,r){var n=e("../../tokenizer/token"),i=e("../../writer/one-time").all;t.exports=function(e){var t,r,a,s,o=[];for(a=0,s=e.length;a<s;a++)(t=e[a])[0]!=n.AT_RULE_BLOCK&&"@font-face"!=t[1][0][1]||(r=i([t]),-1<o.indexOf(r)?t[2]=[]:o.push(r))}},{"../../tokenizer/token":84,"../../writer/one-time":98}],44:[function(e,t,r){var n=e("../../tokenizer/token"),i=e("../../writer/one-time").all,a=e("../../writer/one-time").rules;t.exports=function(e){var t,r,s,o,l,c={};for(o=0,l=e.length;o<l;o++)(r=e[o])[0]==n.NESTED_BLOCK&&((t=c[s=a(r[1])+"%"+i(r[2])])&&(t[2]=[]),c[s]=r)}},{"../../tokenizer/token":84,"../../writer/one-time":98}],45:[function(e,t,r){var n=e("../../tokenizer/token"),i=e("../../writer/one-time").body,a=e("../../writer/one-time").rules;t.exports=function(e){for(var t,r,s,o,l={},c=[],u=0,h=e.length;u<h;u++)(r=e[u])[0]==n.RULE&&(l[t=a(r[1])]&&1==l[t].length?c.push(t):l[t]=l[t]||[],l[t].push(u));for(u=0,h=c.length;u<h;u++){o=[];for(var f=l[t=c[u]].length-1;0<=f;f--)r=e[l[t][f]],s=i(r[2]),-1<o.indexOf(s)?r[2]=[]:o.push(s)}}},{"../../tokenizer/token":84,"../../writer/one-time":98}],46:[function(e,t,r){var n=e("./properties/populate-components"),i=e("../wrap-for-optimizing").single,a=e("../restore-from-optimizing"),s=e("../../tokenizer/token"),o=/^(\-moz\-|\-o\-|\-webkit\-)?animation-name$/,l=/^(\-moz\-|\-o\-|\-webkit\-)?animation$/,c=/^@(\-moz\-|\-o\-|\-webkit\-)?keyframes /,u=/\s{0,31}!important$/,h=/^(['"]?)(.*)\1$/;function f(e){return e.replace(h,"$2").replace(u,"")}function d(e,t,r,n){var i,a,o,l,c,u={};for(l=0,c=e.length;l<c;l++)t(e[l],u);if(0!==Object.keys(u).length)for(i in function e(t,r,n,i){var a,o,l=r(n);for(a=0,o=t.length;a<o;a++)switch(t[a][0]){case s.RULE:l(t[a],i);break;case s.NESTED_BLOCK:e(t[a][2],r,n,i)}}(e,r,u,n),u)for(l=0,c=(a=u[i]).length;l<c;l++)(o=a[l])[o[0]==s.AT_RULE?1:2]=[]}function p(e,t){var r;e[0]==s.AT_RULE_BLOCK&&0===e[1][0][1].indexOf("@counter-style")&&(t[r=e[1][0][1].split(" ")[1]]=t[r]||[],t[r].push(e))}function m(e){return function(t,r){var s,o,l,c;for(l=0,c=t[2].length;l<c;l++)"list-style"==(s=t[2][l])[1][1]&&(o=i(s),n([o],r.validator,r.warnings),o.components[0].value[0][1]in e&&delete e[s[2][1]],a([o])),"list-style-type"==s[1][1]&&s[2][1]in e&&delete e[s[2][1]]}}function g(e,t){var r,n,i,a;if(e[0]==s.AT_RULE_BLOCK&&"@font-face"==e[1][0][1])for(i=0,a=e[2].length;i<a;i++)if("font-family"==(r=e[2][i])[1][1]){t[n=f(r[2][1].toLowerCase())]=t[n]||[],t[n].push(e);break}}function T(e){return function(t,r){var s,o,l,c,u,h,d,p;for(u=0,h=t[2].length;u<h;u++){if("font"==(s=t[2][u])[1][1]){for(o=i(s),n([o],r.validator,r.warnings),d=0,p=(l=o.components[6]).value.length;d<p;d++)(c=f(l.value[d][1].toLowerCase()))in e&&delete e[c];a([o])}if("font-family"==s[1][1])for(d=2,p=s.length;d<p;d++)(c=f(s[d][1].toLowerCase()))in e&&delete e[c]}}}function y(e,t){var r;e[0]==s.NESTED_BLOCK&&c.test(e[1][0][1])&&(t[r=e[1][0][1].split(" ")[1]]=t[r]||[],t[r].push(e))}function v(e){return function(t,r){var s,c,u,h,f,d,p;for(h=0,f=t[2].length;h<f;h++){if(s=t[2][h],l.test(s[1][1])){for(c=i(s),n([c],r.validator,r.warnings),d=0,p=(u=c.components[7]).value.length;d<p;d++)u.value[d][1]in e&&delete e[u.value[d][1]];a([c])}if(o.test(s[1][1]))for(d=2,p=s.length;d<p;d++)s[d][1]in e&&delete e[s[d][1]]}}}function E(e,t){var r;e[0]==s.AT_RULE&&0===e[1].indexOf("@namespace")&&(t[r=e[1].split(" ")[1]]=t[r]||[],t[r].push(e))}function C(e){var t=new RegExp(Object.keys(e).join("\\||")+"\\|","g");return function(r){var n,i,a,s,o,l;for(a=0,s=r[1].length;a<s;a++)for(o=0,l=(n=r[1][a][1].match(t)).length;o<l;o++)(i=n[o].substring(0,n[o].length-1))in e&&delete e[i]}}t.exports=function(e,t){d(e,p,m,t),d(e,g,T,t),d(e,y,v,t),d(e,E,C,t)}},{"../../tokenizer/token":84,"../restore-from-optimizing":56,"../wrap-for-optimizing":58,"./properties/populate-components":39}],47:[function(e,t,r){var n=e("./rules-overlap"),i=e("./specificities-overlap"),a=/align\-items|box\-align|box\-pack|flex|justify/,s=/^border\-(top|right|bottom|left|color|style|width|radius)/;function o(e,t,r){var o,p,m=e[0],g=e[1],T=e[2],y=e[5],v=e[6],E=t[0],C=t[1],b=t[2],S=t[5],I=t[6];return!("font"==m&&"line-height"==E||"font"==E&&"line-height"==m||a.test(m)&&a.test(E)||T==b&&c(m)==c(E)&&l(m)^l(E)||"border"==T&&s.test(b)&&("border"==m||m==b||g!=C&&u(m,E))||"border"==b&&s.test(T)&&("border"==E||E==T||g!=C&&u(m,E))||"border"==T&&"border"==b&&m!=E&&(h(m)&&f(E)||f(m)&&h(E))||!(T!=b||!(m!=E||T!=b||g!=C&&(p=C,!l(o=g)||!l(p)||o.split("-")[1]==p.split("-")[2]))||m!=E&&T==b&&m!=T&&E!=b||m!=E&&T==b&&g==C)&&(!I||!v||d(T)||d(b)||n(S,y,!1))&&i(y,S,r))}function l(e){return/^\-(?:moz|webkit|ms|o)\-/.test(e)}function c(e){return e.replace(/^\-(?:moz|webkit|ms|o)\-/,"")}function u(e,t){return e.split("-").pop()==t.split("-").pop()}function h(e){return"border-top"==e||"border-right"==e||"border-bottom"==e||"border-left"==e}function f(e){return"border-color"==e||"border-style"==e||"border-width"==e}function d(e){return"font"==e||"line-height"==e||"list-style"==e}t.exports={canReorder:function(e,t,r){for(var n=t.length-1;0<=n;n--)for(var i=e.length-1;0<=i;i--)if(!o(e[i],t[n],r))return!1;return!0},canReorderSingle:o}},{"./rules-overlap":51,"./specificities-overlap":52}],48:[function(e,t,r){var n=e("./compactable");t.exports=function(e){var t=n[e.name];return t&&t.shorthand?t.restore(e,n):e.value}},{"./compactable":21}],49:[function(e,t,r){var n=e("./clone").shallow,i=e("../../tokenizer/token"),a=e("../../tokenizer/marker");function s(e){for(var t=0,r=e.length;t<r;t++){var n=e[t][1];if("inherit"!=n&&n!=a.COMMA&&n!=a.FORWARD_SLASH)return!1}return!0}function o(e){var t=e.components,r=t[0].value[0],n=t[1].value[0],i=t[2].value[0],a=t[3].value[0];return r[1]==n[1]&&r[1]==i[1]&&r[1]==a[1]?[r]:r[1]==i[1]&&n[1]==a[1]?[r,n]:n[1]==a[1]?[r,n,i]:[r,n,i,a]}function l(e,t,r){var n,i,a;for(i=0,a=e.length;i<a;i++)if((n=e[i]).name==r&&n.value[0][1]==t[r].defaultValue)return!0;return!1}t.exports={background:function(e,t,r){var n,o,l=e.components,c=[];function u(e){Array.prototype.unshift.apply(c,e.value)}function h(e){var r=t[e.name];return r.doubleValues&&1==r.defaultValue.length?e.value[0][1]==r.defaultValue[0]&&(!e.value[1]||e.value[1][1]==r.defaultValue[0]):r.doubleValues&&1!=r.defaultValue.length?e.value[0][1]==r.defaultValue[0]&&(e.value[1]?e.value[1][1]:e.value[0][1])==r.defaultValue[1]:e.value[0][1]==r.defaultValue}for(var f=l.length-1;0<=f;f--){var d=l[f],p=h(d);if("background-clip"==d.name){var m=l[f-1],g=h(m);o=!(n=d.value[0][1]==m.value[0][1])&&(g&&!p||!g&&!p||!g&&p&&d.value[0][1]!=m.value[0][1]),n?u(m):o&&(u(d),u(m)),f--}else if("background-size"==d.name){var T=l[f-1],y=h(T);o=!(n=!y&&p)&&(y&&!p||!y&&!p),n?u(T):o?(u(d),c.unshift([i.PROPERTY_VALUE,a.FORWARD_SLASH]),u(T)):1==T.value.length&&u(T),f--}else{if(p||t[d.name].multiplexLastOnly&&!r)continue;u(d)}}return 0===c.length&&1==e.value.length&&"0"==e.value[0][1]&&c.push(e.value[0]),0===c.length&&c.push([i.PROPERTY_VALUE,t[e.name].defaultValue]),s(c)?[c[0]]:c},borderRadius:function(e,t){if(e.multiplex){for(var r=n(e),s=n(e),l=0;l<4;l++){var c=e.components[l],u=n(e);u.value=[c.value[0]],r.components.push(u);var h=n(e);h.value=[c.value[1]||c.value[0]],s.components.push(h)}var f=o(r),d=o(s);return f.length!=d.length||f[0][1]!=d[0][1]||1<f.length&&f[1][1]!=d[1][1]||2<f.length&&f[2][1]!=d[2][1]||3<f.length&&f[3][1]!=d[3][1]?f.concat([[i.PROPERTY_VALUE,a.FORWARD_SLASH]]).concat(d):f}return o(e)},font:function(e,t){var r,n=e.components,o=[],l=0,c=0;if(0===e.value[0][1].indexOf(a.INTERNAL))return e.value[0][1]=e.value[0][1].substring(a.INTERNAL.length),e.value;for(;l<4;)(r=n[l]).value[0][1]!=t[r.name].defaultValue&&Array.prototype.push.apply(o,r.value),l++;for(Array.prototype.push.apply(o,n[l].value),n[++l].value[0][1]!=t[n[l].name].defaultValue&&(Array.prototype.push.apply(o,[[i.PROPERTY_VALUE,a.FORWARD_SLASH]]),Array.prototype.push.apply(o,n[l].value)),l++;n[l].value[c];)o.push(n[l].value[c]),n[l].value[c+1]&&o.push([i.PROPERTY_VALUE,a.COMMA]),c++;return s(o)?[o[0]]:o},fourValues:o,multiplex:function(e){return function(t,r){if(!t.multiplex)return e(t,r,!0);var s,o,l=0,c=[],u={};for(s=0,o=t.components[0].value.length;s<o;s++)t.components[0].value[s][1]==a.COMMA&&l++;for(s=0;s<=l;s++){for(var h=n(t),f=0,d=t.components.length;f<d;f++){var p=t.components[f],m=n(p);h.components.push(m);for(var g=u[m.name]||0,T=p.value.length;g<T;g++){if(p.value[g][1]==a.COMMA){u[m.name]=g+1;break}m.value.push(p.value[g])}}var y=e(h,r,s==l);Array.prototype.push.apply(c,y),s<l&&c.push([i.PROPERTY_VALUE,a.COMMA])}return c}},withoutDefaults:function(e,t){for(var r=e.components,n=[],a=r.length-1;0<=a;a--){var o=r[a],c=t[o.name];(o.value[0][1]!=c.defaultValue||"keepUnlessDefault"in c&&!l(r,t,c.keepUnlessDefault))&&n.unshift(o.value[0])}return 0===n.length&&n.push([i.PROPERTY_VALUE,t[e.name].defaultValue]),s(n)?[n[0]]:n}}},{"../../tokenizer/marker":83,"../../tokenizer/token":84,"./clone":20}],50:[function(e,t,r){var n=e("./reorderable").canReorderSingle,i=e("./extract-properties"),a=e("./is-mergeable"),s=e("./tidy-rule-duplicates"),o=e("../../tokenizer/token"),l=e("../../utils/clone-array"),c=e("../../writer/one-time").body,u=e("../../writer/one-time").rules;function h(e,t){return t<e?1:-1}t.exports=function(e,t){var r,f,d,p=t.options,m=p.compatibility.selectors.mergeablePseudoClasses,g=p.compatibility.selectors.mergeablePseudoElements,T=p.compatibility.selectors.mergeLimit,y=p.compatibility.selectors.multiplePseudoMerging,v=t.cache.specificity,E={},C=[],b={},S=[];function I(e,t){var r=function(e){for(var t=[],r=0,n=e.length;r<n;r++)t.push(u(e[r][1]));return t.join("%")}(t);return b[r]=b[r]||[],b[r].push([e,t]),r}function x(e){var t,r=e.split("%"),n=[];for(var i in b){var a=i.split("%");for(t=a.length-1;0<=t;t--)if(-1<r.indexOf(a[t])){n.push(i);break}}for(t=n.length-1;0<=t;t--)delete b[n[t]]}function P(e){for(var t=[],r=[],n=e.length-1;0<=n;n--)a(u(e[n][1]),m,g,y)&&(r.unshift(e[n]),0<e[n][2].length&&-1==t.indexOf(e[n])&&t.push(e[n]));return 1<t.length?r:[]}function w(e,t){return e[1]>t[1]?1:e[1]==t[1]?0:-1}function D(e,t,r){return function e(t,r,n,i){var a=[[t,_(t,r,n)]];if(2<t.length&&0<i)for(var s=t.length-1;0<=s;s--){var o=Array.prototype.slice.call(t,0);o.splice(s,1),a=a.concat(e(o,r,n,i-1))}return a}(e,t,r,1).sort(w)}function _(e,t,r){for(var n=0,i=e.length-1;0<=i;i--)n+=e[i][2].length>r?u(e[i][1]).length:-1;return n-(e.length-1)*t+1}function A(t,r,n,i){var a,s,l,u,h=[];for(a=i.length-1;0<=a;a--){var f=i[a];for(s=f[2].length-1;0<=s;s--){var d=f[2][s];for(l=0,u=r.length;l<u;l++){var p=r[l],m=d[1][1],g=p[0],T=p[4];if(m==g&&c([d])==T){f[2].splice(s,1);break}}}}for(a=r.length-1;0<=a;a--)h.unshift(r[a][3]);var y=[o.RULE,n,h];e.splice(t,0,y)}function R(e,t){var r=t[4],n=E[r];n&&1<n.length&&(function(e,t){var r,n,i=[],a=[],s=t[4],o=P(E[s]);if(!(o.length<2)){e:for(var l in E){var c=E[l];for(r=o.length-1;0<=r;r--)if(-1==c.indexOf(o[r]))continue e;i.push(l)}if(i.length<2)return!1;for(r=i.length-1;0<=r;r--)for(n=C.length-1;0<=n;n--)if(C[n][4]==i[r]){a.unshift([C[n],o]);break}return M(e,a)}}(e,t)||function(e,t){var r=t[0],n=t[1],i=t[4],a=r.length+n.length+1,o=[],l=[],c=P(E[i]);if(!(c.length<2)){var u=D(c,a,1),h=u[0];if(0<h[1])return function(e,t,r){for(var n=r.length-1;0<=n;n--){var i=I(t,r[n][0]);if(1<b[i].length&&M(e,b[i])){x(i);break}}}(e,t,u);for(var f=h[0].length-1;0<=f;f--)o=h[0][f][1].concat(o),l.unshift(h[0][f]);A(e,[t],o=s(o),l)}}(e,t))}function M(e,t){for(var r,n=0,i=[],a=t.length-1;0<=a;a--)n+=(r=t[a][0])[4].length+(0<a?1:0),i.push(r);var o=D(t[0][1],n,i.length)[0];if(0<o[1])return!1;var l=[],c=[];for(a=o[0].length-1;0<=a;a--)l=o[0][a][1].concat(l),c.unshift(o[0][a]);for(A(e,i,l=s(l),c),a=i.length-1;0<=a;a--){r=i[a];var u=C.indexOf(r);delete E[r[4]],-1<u&&-1==S.indexOf(u)&&S.push(u)}return!0}function N(e,t,r){if(e[0]!=t[0])return!1;var n=t[4],i=E[n];return i&&-1<i.indexOf(r)}for(var k=e.length-1;0<=k;k--){var O,L,F,B,V,U=e[k];if(U[0]==o.RULE)O=!0;else{if(U[0]!=o.NESTED_BLOCK)continue;O=!1}var H=C.length,z=i(U);S=[];var j=[];for(L=z.length-1;0<=L;L--)for(F=L-1;0<=F;F--)if(!n(z[L],z[F],v)){j.push(L);break}for(L=z.length-1;0<=L;L--){var q=z[L],G=!1;for(F=0;F<H;F++){var W=C[F];-1==S.indexOf(F)&&(!n(q,W,v)&&!N(q,W,U)||E[W[4]]&&E[W[4]].length===T)&&(R(k+1,W),-1==S.indexOf(F)&&(S.push(F),delete E[W[4]])),G||(G=q[0]==W[0]&&q[1]==W[1])&&(V=F)}if(O&&!(-1<j.indexOf(L))){var Y=q[4];G&&C[V][5].length+q[5].length>T?(R(k+1,C[V]),C.splice(V,1),E[Y]=[U],G=!1):(E[Y]=E[Y]||[],E[Y].push(U)),G?C[V]=(r=C[V],f=q,d=void 0,(d=l(r))[5]=d[5].concat(f[5]),d):C.push(q)}}for(L=0,B=(S=S.sort(h)).length;L<B;L++){var K=S[L]-L;C.splice(K,1)}}for(var Q=e[0]&&e[0][0]==o.AT_RULE&&0===e[0][1].indexOf("@charset")?1:0;Q<e.length-1;Q++){var X=e[Q][0]===o.AT_RULE&&0===e[Q][1].indexOf("@import"),$=e[Q][0]===o.COMMENT;if(!X&&!$)break}for(k=0;k<C.length;k++)R(Q,C[k])}},{"../../tokenizer/token":84,"../../utils/clone-array":86,"../../writer/one-time":98,"./extract-properties":22,"./is-mergeable":24,"./reorderable":47,"./tidy-rule-duplicates":54}],51:[function(e,t,r){var n=/\-\-.+$/;function i(e){return e.replace(n,"")}t.exports=function(e,t,r){var n,a,s,o,l,c;for(s=0,o=e.length;s<o;s++)for(n=e[s][1],l=0,c=t.length;l<c;l++){if(n==(a=t[l][1]))return!0;if(r&&i(n)==i(a))return!0}return!1}},{}],52:[function(e,t,r){var n=e("./specificity");function i(e,t){var r;return e in t||(t[e]=r=n(e)),r||t[e]}t.exports=function(e,t,r){var n,a,s,o,l,c;for(s=0,o=e.length;s<o;s++)for(n=i(e[s][1],r),l=0,c=t.length;l<c;l++)if(a=i(t[l][1],r),n[0]===a[0]&&n[1]===a[1]&&n[2]===a[2])return!0;return!1}},{"./specificity":53}],53:[function(e,t,r){var n=e("../../tokenizer/marker"),i=/[a-zA-Z]/,a=/[\s,\(>~\+]/;t.exports=function(e){var t,r,s,o,l,c,u,h,f=[0,0,0],d=0,p=!1,m=!1;for(c=0,u=e.length;c<u;c++){if(t=e[c],r);else if(t!=n.SINGLE_QUOTE||o||s)if(t==n.SINGLE_QUOTE&&!o&&s)s=!1;else if(t!=n.DOUBLE_QUOTE||o||s)if(t==n.DOUBLE_QUOTE&&o&&!s)o=!1;else{if(s||o)continue;0<d&&!p||(t==n.OPEN_ROUND_BRACKET?d++:t==n.CLOSE_ROUND_BRACKET&&1==d?(d--,p=!1):t==n.CLOSE_ROUND_BRACKET?d--:"#"==t?f[0]++:"."==t||t==n.OPEN_SQUARE_BRACKET?f[1]++:":"!=t||m||(h=c,e.indexOf(":not(",h)===h)?":"==t?p=!0:(0===c||l)&&i.test(t)&&f[2]++:(f[1]++,p=!1))}else o=!0;else s=!0;m=":"==t,l=!(r=t==n.BACK_SLASH)&&a.test(t)}return f}},{"../../tokenizer/marker":83}],54:[function(e,t,r){function n(e,t){return e[1]>t[1]?1:-1}t.exports=function(e){for(var t=[],r=[],i=0,a=e.length;i<a;i++){var s=e[i];-1==r.indexOf(s[1])&&(r.push(s[1]),t.push(s))}return t.sort(n)}},{}],55:[function(e,t,r){t.exports=function(e){for(var t=e.length-1;0<=t;t--){var r=e[t];r.unused&&r.all.splice(r.position,1)}}},{}],56:[function(e,t,r){var n=e("./hack"),i=e("../tokenizer/marker");t.exports=function(e,t){var r,a,s,o,l,c;for(o=e.length-1;0<=o;o--)(r=e[o]).unused||(r.dirty||r.important||r.hack)&&(t?(a=t(r),r.value=a):a=r.value,r.important&&((l=r).value[l.value.length-1][1]+="!important"),r.hack&&((c=r).hack[0]==n.UNDERSCORE?c.name="_"+c.name:c.hack[0]==n.ASTERISK?c.name="*"+c.name:c.hack[0]==n.BACKSLASH?c.value[c.value.length-1][1]+="\\"+c.hack[1]:c.hack[0]==n.BANG&&(c.value[c.value.length-1][1]+=i.SPACE+"!ie")),"all"in r&&((s=r.all[r.position])[1][1]=r.name,s.splice(2,s.length-1),Array.prototype.push.apply(s,a)))}},{"../tokenizer/marker":83,"./hack":8}],57:[function(e,t,r){var n=new RegExp("^(\\-moz\\-|\\-webkit\\-)?calc\\([^\\)]+\\)$","i"),i=/[0-9]/,a=new RegExp("^(var\\(\\-\\-[^\\)]+\\)|[A-Z]+(\\-|[A-Z]|[0-9])+\\(.*?\\)|\\-(\\-|[A-Z]|[0-9])+\\(.*?\\))$","i"),s=/^hsl\(\s{0,31}[\-\.]?\d+\s{0,31},\s{0,31}\.?\d+%\s{0,31},\s{0,31}\.?\d+%\s{0,31}\)|hsla\(\s{0,31}[\-\.]?\d+\s{0,31},\s{0,31}\.?\d+%\s{0,31},\s{0,31}\.?\d+%\s{0,31},\s{0,31}\.?\d+\s{0,31}\)$/,o=/^(\-[a-z0-9_][a-z0-9\-_]*|[a-z][a-z0-9\-_]*)$/i,l=/^[a-z]+$/i,c=/^-([a-z0-9]|-)*$/i,u=/^rgb\(\s{0,31}[\d]{1,3}\s{0,31},\s{0,31}[\d]{1,3}\s{0,31},\s{0,31}[\d]{1,3}\s{0,31}\)|rgba\(\s{0,31}[\d]{1,3}\s{0,31},\s{0,31}[\d]{1,3}\s{0,31},\s{0,31}[\d]{1,3}\s{0,31},\s{0,31}[\.\d]+\s{0,31}\)$/,h=/^(cubic\-bezier|steps)\([^\)]+\)$/,f=["ms","s"],d=/^url\([\s\S]+\)$/i,p=new RegExp("^var\\(\\-\\-[^\\)]+\\)$","i"),m=/^#[0-9a-f]{8}$/i,g=/^#[0-9a-f]{4}$/i,T=/^#[0-9a-f]{6}$/i,y=/^#[0-9a-f]{3}$/i,v={"^":["inherit","initial","unset"],"*-style":["auto","dashed","dotted","double","groove","hidden","inset","none","outset","ridge","solid"],"*-timing-function":["ease","ease-in","ease-in-out","ease-out","linear","step-end","step-start"],"animation-direction":["alternate","alternate-reverse","normal","reverse"],"animation-fill-mode":["backwards","both","forwards","none"],"animation-iteration-count":["infinite"],"animation-name":["none"],"animation-play-state":["paused","running"],"background-attachment":["fixed","inherit","local","scroll"],"background-clip":["border-box","content-box","inherit","padding-box","text"],"background-origin":["border-box","content-box","inherit","padding-box"],"background-position":["bottom","center","left","right","top"],"background-repeat":["no-repeat","inherit","repeat","repeat-x","repeat-y","round","space"],"background-size":["auto","cover","contain"],"border-collapse":["collapse","inherit","separate"],bottom:["auto"],clear:["both","left","none","right"],color:["transparent"],cursor:["all-scroll","auto","col-resize","crosshair","default","e-resize","help","move","n-resize","ne-resize","no-drop","not-allowed","nw-resize","pointer","progress","row-resize","s-resize","se-resize","sw-resize","text","vertical-text","w-resize","wait"],display:["block","inline","inline-block","inline-table","list-item","none","table","table-caption","table-cell","table-column","table-column-group","table-footer-group","table-header-group","table-row","table-row-group"],float:["left","none","right"],left:["auto"],font:["caption","icon","menu","message-box","small-caption","status-bar","unset"],"font-size":["large","larger","medium","small","smaller","x-large","x-small","xx-large","xx-small"],"font-stretch":["condensed","expanded","extra-condensed","extra-expanded","normal","semi-condensed","semi-expanded","ultra-condensed","ultra-expanded"],"font-style":["italic","normal","oblique"],"font-variant":["normal","small-caps"],"font-weight":["100","200","300","400","500","600","700","800","900","bold","bolder","lighter","normal"],"line-height":["normal"],"list-style-position":["inside","outside"],"list-style-type":["armenian","circle","decimal","decimal-leading-zero","disc","decimal|disc","georgian","lower-alpha","lower-greek","lower-latin","lower-roman","none","square","upper-alpha","upper-latin","upper-roman"],overflow:["auto","hidden","scroll","visible"],position:["absolute","fixed","relative","static"],right:["auto"],"text-align":["center","justify","left","left|right","right"],"text-decoration":["line-through","none","overline","underline"],"text-overflow":["clip","ellipsis"],top:["auto"],"vertical-align":["baseline","bottom","middle","sub","super","text-bottom","text-top","top"],visibility:["collapse","hidden","visible"],"white-space":["normal","nowrap","pre"],width:["inherit","initial","medium","thick","thin"]},E=["%","ch","cm","em","ex","in","mm","pc","pt","px","rem","vh","vm","vmax","vmin","vw"];function C(e){return"auto"!=e&&(D("color")(e)||(r=e,y.test(r)||g.test(r)||T.test(r)||m.test(r))||b(e)||(t=e,l.test(t)));var t,r}function b(e){return A(e)||x(e)}function S(e){return n.test(e)}function I(e){return a.test(e)}function x(e){return s.test(e)}function P(e){return o.test(e)}function w(e){return"none"==e||"inherit"==e||O(e)}function D(e){return function(t){return-1<v[e].indexOf(t)}}function _(e){return F(e)==e.length}function A(e){return u.test(e)}function R(e){return c.test(e)}function M(e){return _(e)&&0<=parseFloat(e)}function N(e){return p.test(e)}function k(e){var t=F(e);return t==e.length&&0===parseInt(e)||-1<t&&-1<f.indexOf(e.slice(t+1))}function O(e){return d.test(e)}function L(e){return"auto"==e||_(e)||D("^")(e)}function F(e){var t,r,n,a=!1,s=!1;for(r=0,n=e.length;r<n;r++)if(t=e[r],0!==r||"+"!=t&&"-"!=t){if(0<r&&s&&("+"==t||"-"==t))return r-1;if("."!=t||a){if("."==t&&a)return r-1;if(i.test(t))continue;return r-1}a=!0}else s=!0;return r}t.exports=function(e){var t,r=E.slice(0).filter((function(t){return!(t in e.units)||!0===e.units[t]}));return{colorOpacity:e.colors.opacity,isAnimationDirectionKeyword:D("animation-direction"),isAnimationFillModeKeyword:D("animation-fill-mode"),isAnimationIterationCountKeyword:D("animation-iteration-count"),isAnimationNameKeyword:D("animation-name"),isAnimationPlayStateKeyword:D("animation-play-state"),isTimingFunction:(t=D("*-timing-function"),function(e){return t(e)||h.test(e)}),isBackgroundAttachmentKeyword:D("background-attachment"),isBackgroundClipKeyword:D("background-clip"),isBackgroundOriginKeyword:D("background-origin"),isBackgroundPositionKeyword:D("background-position"),isBackgroundRepeatKeyword:D("background-repeat"),isBackgroundSizeKeyword:D("background-size"),isColor:C,isColorFunction:b,isDynamicUnit:S,isFontKeyword:D("font"),isFontSizeKeyword:D("font-size"),isFontStretchKeyword:D("font-stretch"),isFontStyleKeyword:D("font-style"),isFontVariantKeyword:D("font-variant"),isFontWeightKeyword:D("font-weight"),isFunction:I,isGlobal:D("^"),isHslColor:x,isIdentifier:P,isImage:w,isKeyword:D,isLineHeightKeyword:D("line-height"),isListStylePositionKeyword:D("list-style-position"),isListStyleTypeKeyword:D("list-style-type"),isNumber:_,isPrefixed:R,isPositiveNumber:M,isRgbColor:A,isStyleKeyword:D("*-style"),isTime:k,isUnit:function(e,t){var r=F(t);return r==t.length&&0===parseInt(t)||-1<r&&-1<e.indexOf(t.slice(r+1))||"auto"==t||"inherit"==t}.bind(null,r),isUrl:O,isVariable:N,isWidth:D("width"),isZIndex:L}}},{}],58:[function(e,t,r){var n=e("./hack"),i=e("../tokenizer/marker"),a=e("../tokenizer/token"),s={ASTERISK:"*",BACKSLASH:"\\",BANG:"!",BANG_SUFFIX_PATTERN:/!\w+$/,IMPORTANT_TOKEN:"!important",IMPORTANT_TOKEN_PATTERN:new RegExp("!important$","i"),IMPORTANT_WORD:"important",IMPORTANT_WORD_PATTERN:new RegExp("important$","i"),SUFFIX_BANG_PATTERN:/!$/,UNDERSCORE:"_",VARIABLE_REFERENCE_PATTERN:/var\(--.+\)$/};function o(e){var t,r,n,i;for(t=2,r=e.length;t<r;t++)if((n=e[t])[0]==a.PROPERTY_VALUE&&(i=n[1],s.VARIABLE_REFERENCE_PATTERN.test(i)))return!0;return!1}function l(e){var t,r,o,l=function(e){if(e.length<3)return!1;var t=e[e.length-1];return!!s.IMPORTANT_TOKEN_PATTERN.test(t[1])||!(!s.IMPORTANT_WORD_PATTERN.test(t[1])||!s.SUFFIX_BANG_PATTERN.test(e[e.length-2][1]))}(e);l&&(r=(t=e)[t.length-1],o=t[t.length-2],s.IMPORTANT_TOKEN_PATTERN.test(r[1])?r[1]=r[1].replace(s.IMPORTANT_TOKEN_PATTERN,""):(r[1]=r[1].replace(s.IMPORTANT_WORD_PATTERN,""),o[1]=o[1].replace(s.SUFFIX_BANG_PATTERN,"")),0===r[1].length&&t.pop(),0===o[1].length&&t.pop());var c,u,h,f,d,p,m,g,T=(u=!1,h=(c=e)[1][1],f=c[c.length-1],h[0]==s.UNDERSCORE?u=[n.UNDERSCORE]:h[0]==s.ASTERISK?u=[n.ASTERISK]:f[1][0]!=s.BANG||f[1].match(s.IMPORTANT_WORD_PATTERN)?0<f[1].indexOf(s.BANG)&&!f[1].match(s.IMPORTANT_WORD_PATTERN)&&s.BANG_SUFFIX_PATTERN.test(f[1])?u=[n.BANG]:0<f[1].indexOf(s.BACKSLASH)&&f[1].indexOf(s.BACKSLASH)==f[1].length-s.BACKSLASH.length-1?u=[n.BACKSLASH,f[1].substring(f[1].indexOf(s.BACKSLASH)+1)]:0===f[1].indexOf(s.BACKSLASH)&&2==f[1].length&&(u=[n.BACKSLASH,f[1].substring(1)]):u=[n.BANG],u);return T[0]==n.ASTERISK||T[0]==n.UNDERSCORE?(g=e)[1][1]=g[1][1].substring(1):T[0]!=n.BACKSLASH&&T[0]!=n.BANG||(p=T,(m=(d=e)[d.length-1])[1]=m[1].substring(0,m[1].indexOf(p[0]==n.BACKSLASH?s.BACKSLASH:s.BANG)).trim(),0===m[1].length&&d.pop()),{block:e[2]&&e[2][0]==a.PROPERTY_BLOCK,components:[],dirty:!1,hack:T,important:l,name:e[1][1],multiplex:3<e.length&&function(e){var t,r,n;for(r=3,n=e.length;r<n;r++)if((t=e[r])[0]==a.PROPERTY_VALUE&&(t[1]==i.COMMA||t[1]==i.FORWARD_SLASH))return!0;return!1}(e),position:0,shorthand:!1,unused:!1,value:e.slice(2)}}t.exports={all:function(e,t,r){var n,i,s,c=[];for(s=e.length-1;0<=s;s--)(i=e[s])[0]==a.PROPERTY&&(!t&&o(i)||r&&-1<r.indexOf(i[1][1])||((n=l(i)).all=e,n.position=s,c.unshift(n)));return c},single:l}},{"../tokenizer/marker":83,"../tokenizer/token":84,"./hack":8}],59:[function(e,t,r){var n={"*":{colors:{opacity:!0},properties:{backgroundClipMerging:!0,backgroundOriginMerging:!0,backgroundSizeMerging:!0,colors:!0,ieBangHack:!1,ieFilters:!1,iePrefixHack:!1,ieSuffixHack:!1,merging:!0,shorterLengthUnits:!1,spaceAfterClosingBrace:!0,urlQuotes:!1,zeroUnits:!0},selectors:{adjacentSpace:!1,ie7Hack:!1,mergeablePseudoClasses:[":active",":after",":before",":empty",":checked",":disabled",":empty",":enabled",":first-child",":first-letter",":first-line",":first-of-type",":focus",":hover",":lang",":last-child",":last-of-type",":link",":not",":nth-child",":nth-last-child",":nth-last-of-type",":nth-of-type",":only-child",":only-of-type",":root",":target",":visited"],mergeablePseudoElements:["::after","::before","::first-letter","::first-line"],mergeLimit:8191,multiplePseudoMerging:!0},units:{ch:!0,in:!0,pc:!0,pt:!0,rem:!0,vh:!0,vm:!0,vmax:!0,vmin:!0,vw:!0}}};function i(e,t){for(var r in e){var n=e[r];"object"!=_typeof(n)||Array.isArray(n)?t[r]=r in t?t[r]:n:t[r]=i(n,t[r]||{})}return t}n.ie11=n["*"],n.ie10=n["*"],n.ie9=i(n["*"],{properties:{ieFilters:!0,ieSuffixHack:!0}}),n.ie8=i(n.ie9,{colors:{opacity:!1},properties:{backgroundClipMerging:!1,backgroundOriginMerging:!1,backgroundSizeMerging:!1,iePrefixHack:!0,merging:!1},selectors:{mergeablePseudoClasses:[":after",":before",":first-child",":first-letter",":focus",":hover",":visited"],mergeablePseudoElements:[]},units:{ch:!1,rem:!1,vh:!1,vm:!1,vmax:!1,vmin:!1,vw:!1}}),n.ie7=i(n.ie8,{properties:{ieBangHack:!0},selectors:{ie7Hack:!0,mergeablePseudoClasses:[":first-child",":first-letter",":hover",":visited"]}}),t.exports=function(e){return i(n["*"],function(e){if("object"==_typeof(e))return e;if(!/[,\+\-]/.test(e))return n[e]||n["*"];var t=e.split(","),r=t[0]in n?n[t.shift()]:n["*"];return e={},t.forEach((function(t){var r="+"==t[0],n=t.substring(1).split("."),i=n[0],a=n[1];e[i]=e[i]||{},e[i][a]=r})),i(r,e)}(e))}},{}],60:[function(e,t,r){var n=e("../reader/load-remote-resource");t.exports=function(e){return e||n}},{"../reader/load-remote-resource":74}],61:[function(e,t,r){var n=e("os").EOL,i=e("../utils/override"),a={AfterAtRule:"afterAtRule",AfterBlockBegins:"afterBlockBegins",AfterBlockEnds:"afterBlockEnds",AfterComment:"afterComment",AfterProperty:"afterProperty",AfterRuleBegins:"afterRuleBegins",AfterRuleEnds:"afterRuleEnds",BeforeBlockEnds:"beforeBlockEnds",BetweenSelectors:"betweenSelectors"},s={CarriageReturnLineFeed:"\r\n",LineFeed:"\n",System:n},o=" ",l="\t",c={AroundSelectorRelation:"aroundSelectorRelation",BeforeBlockBegins:"beforeBlockBegins",BeforeValue:"beforeValue"},u={breaks:h(!1),breakWith:s.System,indentBy:0,indentWith:o,spaces:f(!1),wrapAt:!1,semicolonAfterLastProperty:!1};function h(e){var t={};return t[a.AfterAtRule]=e,t[a.AfterBlockBegins]=e,t[a.AfterBlockEnds]=e,t[a.AfterComment]=e,t[a.AfterProperty]=e,t[a.AfterRuleBegins]=e,t[a.AfterRuleEnds]=e,t[a.BeforeBlockEnds]=e,t[a.BetweenSelectors]=e,t}function f(e){var t={};return t[c.AroundSelectorRelation]=e,t[c.BeforeBlockBegins]=e,t[c.BeforeValue]=e,t}function d(e){switch(e){case"windows":case"crlf":case s.CarriageReturnLineFeed:return s.CarriageReturnLineFeed;case"unix":case"lf":case s.LineFeed:return s.LineFeed;default:return n}}function p(e){switch(e){case"space":return o;case"tab":return l;default:return e}}t.exports={Breaks:a,Spaces:c,formatFrom:function(e){return void 0!==e&&!1!==e&&("object"==_typeof(e)&&"breakWith"in e&&(e=i(e,{breakWith:d(e.breakWith)})),"object"==_typeof(e)&&"indentBy"in e&&(e=i(e,{indentBy:parseInt(e.indentBy)})),"object"==_typeof(e)&&"indentWith"in e&&(e=i(e,{indentWith:p(e.indentWith)})),"object"==_typeof(e)||"object"==_typeof(e)?i(u,e):"string"==typeof e&&"beautify"==e?i(u,{breaks:h(!0),indentBy:2,spaces:f(!0)}):"string"==typeof e&&"keep-breaks"==e?i(u,{breaks:{afterAtRule:!0,afterBlockBegins:!0,afterBlockEnds:!0,afterComment:!0,afterRuleEnds:!0,beforeBlockEnds:!0}}):"string"==typeof e?i(u,e.split(";").reduce((function(e,t){var r=t.split(":"),n=r[0],i=r[1];return"breaks"==n||"spaces"==n?e[n]=i.split(",").reduce((function(e,t){var r=t.split("="),n=r[0],i=r[1];return e[n]=function(e){switch(e){case"false":case"off":return!1;case"true":case"on":return!0;default:return e}}(i),e}),{}):"indentBy"==n||"wrapAt"==n?e[n]=parseInt(i):"indentWith"==n?e[n]=p(i):"breakWith"==n&&(e[n]=d(i)),e}),{})):u)}}},{"../utils/override":95,os:109}],62:[function(e,t,r){(function(r){var n=e("url"),i=e("../utils/override");t.exports=function(e){return i((t=r.env.HTTP_PROXY||r.env.http_proxy)?{hostname:n.parse(t).hostname,port:parseInt(n.parse(t).port)}:{},e||{});var t}}).call(this,e("_process"))},{"../utils/override":95,_process:112,url:162}],63:[function(e,t,r){t.exports=function(e){return e||5e3}},{}],64:[function(e,t,r){t.exports=function(e){return Array.isArray(e)?e:!1===e?["none"]:void 0===e?["local"]:e.split(",")}},{}],65:[function(e,t,r){var n=e("./rounding-precision").roundingPrecisionFrom,i=e("../utils/override"),a={Zero:"0",One:"1",Two:"2"},s={};s[a.Zero]={},s[a.One]={cleanupCharsets:!0,normalizeUrls:!0,optimizeBackground:!0,optimizeBorderRadius:!0,optimizeFilter:!0,optimizeFontWeight:!0,optimizeOutline:!0,removeEmpty:!0,removeNegativePaddings:!0,removeQuotes:!0,removeWhitespace:!0,replaceMultipleZeros:!0,replaceTimeUnits:!0,replaceZeroUnits:!0,roundingPrecision:n(void 0),selectorsSortingMethod:"standard",specialComments:"all",tidyAtRules:!0,tidyBlockScopes:!0,tidySelectors:!0,transform:function(){}},s[a.Two]={mergeAdjacentRules:!0,mergeIntoShorthands:!0,mergeMedia:!0,mergeNonAdjacentRules:!0,mergeSemantically:!1,overrideProperties:!0,removeEmpty:!0,reduceNonAdjacentRules:!0,removeDuplicateFontRules:!0,removeDuplicateMediaBlocks:!0,removeDuplicateRules:!0,removeUnusedAtRules:!1,restructureRules:!1,skipProperties:[]};var o="*",l="all";function c(e,t){var r,n=i(s[e],{});for(r in n)"boolean"==typeof n[r]&&(n[r]=t);return n}function u(e){switch(e){case"false":case"off":return!1;case"true":case"on":return!0;default:return e}}function h(e,t){return e.split(";").reduce((function(e,r){var n=r.split(":"),a=n[0],s=u(n[1]);return o==a||l==a?e=i(e,c(t,s)):e[a]=s,e}),{})}t.exports={OptimizationLevel:a,optimizationLevelFrom:function(e){var t=i(s,{}),r=a.Zero,f=a.One,d=a.Two;return void 0===e?delete t[d]:("string"==typeof e&&(e=parseInt(e)),"number"==typeof e&&e===parseInt(d)||("number"==typeof e&&e===parseInt(f)?delete t[d]:"number"==typeof e&&e===parseInt(r)?(delete t[d],delete t[f]):("object"==_typeof(e)&&(e=function(e){var t,r,n=i(e,{});for(r=0;r<=2;r++)(t=""+r)in n&&(void 0===n[t]||!1===n[t])&&delete n[t],t in n&&!0===n[t]&&(n[t]={}),t in n&&"string"==typeof n[t]&&(n[t]=h(n[t],t));return n}(e)),f in e&&"roundingPrecision"in e[f]&&(e[f].roundingPrecision=n(e[f].roundingPrecision)),d in e&&"skipProperties"in e[d]&&"string"==typeof e[d].skipProperties&&(e[d].skipProperties=e[d].skipProperties.split(",")),(r in e||f in e||d in e)&&(t[r]=i(t[r],e[r])),f in e&&o in e[f]&&(t[f]=i(t[f],c(f,u(e[f][o]))),delete e[f][o]),f in e&&l in e[f]&&(t[f]=i(t[f],c(f,u(e[f].all))),delete e[f].all),f in e||d in e?t[f]=i(t[f],e[f]):delete t[f],d in e&&o in e[d]&&(t[d]=i(t[d],c(d,u(e[d][o]))),delete e[d][o]),d in e&&l in e[d]&&(t[d]=i(t[d],c(d,u(e[d].all))),delete e[d].all),d in e?t[d]=i(t[d],e[d]):delete t[d]))),t}}},{"../utils/override":95,"./rounding-precision":68}],66:[function(e,t,r){(function(r){var n=e("path");t.exports=function(e){return e?n.resolve(e):r.cwd()}}).call(this,e("_process"))},{_process:112,path:110}],67:[function(e,t,r){t.exports=function(e){return void 0===e||!!e}},{}],68:[function(e,t,r){var n=e("../utils/override"),i=/^\d+$/,a=["*","all"],s="off";function o(e){return{ch:e,cm:e,em:e,ex:e,in:e,mm:e,pc:e,pt:e,px:e,q:e,rem:e,vh:e,vmax:e,vmin:e,vw:e,"%":e}}t.exports={DEFAULT:s,roundingPrecisionFrom:function(e){return n(o(s),null==(t=e)||"boolean"==typeof t?{}:"number"==typeof t&&-1==t?o(s):"number"==typeof t?o(t):"string"==typeof t&&i.test(t)?o(parseInt(t)):"string"!=typeof t||t!=s?"object"!=_typeof(t)?t.split(",").reduce((function(e,t){var r=t.split("="),i=r[0],l=parseInt(r[1]);return(isNaN(l)||-1==l)&&(l=s),-1<a.indexOf(i)?e=n(e,o(l)):e[i]=l,e}),{}):t:o(s));var t}}},{"../utils/override":95}],69:[function(e,t,r){(function(r,n){var i=e("fs"),a=e("path"),s=e("./is-allowed-resource"),o=e("./match-data-uri"),l=e("./rebase-local-map"),c=e("./rebase-remote-map"),u=e("../tokenizer/token"),h=e("../utils/has-protocol"),f=e("../utils/is-data-uri-resource"),d=e("../utils/is-remote-resource"),p=/^\/\*# sourceMappingURL=(\S+) \*\/$/;function m(e){var t,r,n,i=[],a=g(e.sourceTokens[0]);for(n=e.sourceTokens.length;e.index<n;e.index++)if((t=g(r=e.sourceTokens[e.index]))!=a&&(i=[],a=t),i.push(r),e.processedTokens.push(r),r[0]==u.COMMENT&&p.test(r[1]))return T(r[1],t,i,e);return e.callback(e.processedTokens)}function g(e){return(e[0]==u.AT_RULE||e[0]==u.COMMENT?e[2][0]:e[1][0][2][0])[2]}function T(e,t,g,T){return D=e,_=T,A=function(e){return e&&(T.inputSourceMapTracker.track(t,e),function e(t,r){var n,i,a;for(i=0,a=t.length;i<a;i++)switch((n=t[i])[0]){case u.AT_RULE:y(n,r);break;case u.AT_RULE_BLOCK:e(n[1],r),e(n[2],r);break;case u.AT_RULE_BLOCK_SCOPE:y(n,r);break;case u.NESTED_BLOCK:e(n[1],r),e(n[2],r);break;case u.NESTED_BLOCK_SCOPE:case u.COMMENT:y(n,r);break;case u.PROPERTY:e(n,r);break;case u.PROPERTY_BLOCK:e(n[1],r);break;case u.PROPERTY_NAME:case u.PROPERTY_VALUE:y(n,r);break;case u.RULE:e(n[1],r),e(n[2],r);break;case u.RULE_SCOPE:y(n,r)}return t}(g,T.inputSourceMapTracker)),T.index++,m(T)},k=p.exec(D)[1],f(k)?(L=(O=o(k))[2]?O[2].split(/[=;]/)[2]:"us-ascii",B="utf8"==(F=O[3]?O[3].split(";")[1]:"utf8")?r.unescape(O[4]):O[4],(V=new n(B,F)).charset=L,M=JSON.parse(V.toString()),A(M)):d(k)?(x=function(e){var t;e?(t=JSON.parse(e),N=c(t,k),A(N)):A(null)},P=s(S=k,!0,(I=_).inline),w=!h(S),I.localOnly?(I.warnings.push('Cannot fetch remote resource from "'+S+'" as no callback given.'),x(null)):w?(I.warnings.push('Cannot fetch "'+S+'" as no protocol given.'),x(null)):P?void I.fetch(S,I.inlineRequest,I.inlineTimeout,(function(e,t){if(e)return I.warnings.push('Missing source map at "'+S+'" - '+e),x(null);x(t)})):(I.warnings.push('Cannot fetch "'+S+'" as resource is not allowed.'),x(null))):(R=a.resolve(_.rebaseTo,k),b=s(v=R,!1,(E=_).inline),(M=i.existsSync(v)&&i.statSync(v).isFile()?b?(C=i.readFileSync(v,"utf-8"),JSON.parse(C)):(E.warnings.push('Cannot fetch "'+v+'" as resource is not allowed.'),null):(E.warnings.push('Ignoring local source map at "'+v+'" as resource is missing.'),null))?(N=l(M,R,_.rebaseTo),A(N)):A(null));var v,E,C,b,S,I,x,P,w,D,_,A,R,M,N,k,O,L,F,B,V}function y(e,t){var r,n,i=e[1],a=e[2],s=[];for(r=0,n=a.length;r<n;r++)s.push(t.originalPositionFor(a[r],i.length));e[2]=s}t.exports=function(e,t,r){var n={callback:r,fetch:t.options.fetch,index:0,inline:t.options.inline,inlineRequest:t.options.inlineRequest,inlineTimeout:t.options.inlineTimeout,inputSourceMapTracker:t.inputSourceMapTracker,localOnly:t.localOnly,processedTokens:[],rebaseTo:t.options.rebaseTo,sourceTokens:e,warnings:t.warnings};return t.options.sourceMap&&0<e.length?m(n):r(e)}}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{},e("buffer").Buffer)},{"../tokenizer/token":84,"../utils/has-protocol":88,"../utils/is-data-uri-resource":89,"../utils/is-remote-resource":93,"./is-allowed-resource":72,"./match-data-uri":75,"./rebase-local-map":78,"./rebase-remote-map":79,buffer:4,fs:3,path:110}],70:[function(e,t,r){var n=e("../utils/split"),i=/^\(/,a=/\)$/,s=/^@import/i,o=/['"]\s*/,l=/\s*['"]/,c=/^url\(\s*/i,u=/\s*\)/i;t.exports=function(e){var t,r;return t=e.replace(s,"").trim().replace(c,"(").replace(u,")").replace(o,"").replace(l,""),[(r=n(t," "))[0].replace(i,"").replace(a,""),r.slice(1).join(" ")]}},{"../utils/split":96}],71:[function(e,t,r){var n=e("source-map").SourceMapConsumer;t.exports=function(){var e={};return{all:function(e){return e}.bind(null,e),isTracking:function(e,t){return t in e}.bind(null,e),originalPositionFor:function e(t,r,n,i){for(var a,s,o=r[0],l=r[1],c=r[2],u={line:o,column:l+n};!a&&u.column>l;)u.column--,a=t[c].originalPositionFor(u);return!a||a.column<0?r:null===a.line&&1<o&&0<i?e(t,[o-1,l,c],n,i-1):null!==a.line?[(s=a).line,s.column,s.source]:r}.bind(null,e),track:function(e,t,r){e[t]=new n(r)}.bind(null,e)}}},{"source-map":154}],72:[function(e,t,r){var n=e("path"),i=e("url"),a=e("../utils/is-remote-resource"),s=e("../utils/has-protocol"),o="http:";function l(e){return a(e)||i.parse(o+"//"+e).host==e}t.exports=function e(t,r,a){var c,u,h,f,d,p,m=!r;if(0===a.length)return!1;for(r&&!s(t)&&(t=o+t),c=r?i.parse(t).host:t,u=r?t:n.resolve(t),p=0;p<a.length;p++)f="!"==(h=a[p])[0],d=h.substring(1),m=f&&r&&l(d)?m&&!e(t,!0,[d]):!f||r||l(d)?f?m&&!0:"all"==h||(r&&"local"==h?m||!1:!(!r||"remote"!=h)||!(!r&&"remote"==h)&&(!r&&"local"==h||h===c||h===t||!(!r||0!==u.indexOf(h))||!r&&0===u.indexOf(n.resolve(h))||r!=l(d)&&m&&!0)):m&&!e(t,!1,[d]);return m}},{"../utils/has-protocol":88,"../utils/is-remote-resource":93,path:110,url:162}],73:[function(e,t,r){var n=e("fs"),i=e("path"),a=e("./is-allowed-resource"),s=e("../utils/has-protocol"),o=e("../utils/is-remote-resource");function l(e){var t,r,n,i=Object.keys(e.uriToSource);for(n=i.length;e.index<n;e.index++){if(t=i[e.index],!(r=e.uriToSource[t]))return c(t,e);e.sourcesContent[t]=r}return e.callback()}function c(e,t){var r;return o(e)?function(e,t,r){var n=a(e,!0,t.inline),i=!s(e);return t.localOnly?(t.warnings.push('Cannot fetch remote resource from "'+e+'" as no callback given.'),r(null)):i?(t.warnings.push('Cannot fetch "'+e+'" as no protocol given.'),r(null)):n?void t.fetch(e,t.inlineRequest,t.inlineTimeout,(function(n,i){n&&t.warnings.push('Missing original source at "'+e+'" - '+n),r(i)})):(t.warnings.push('Cannot fetch "'+e+'" as resource is not allowed.'),r(null))}(e,t,(function(r){return t.index++,t.sourcesContent[e]=r,l(t)})):(r=function(e,t){var r=a(e,!1,t.inline),s=i.resolve(t.rebaseTo,e);return n.existsSync(s)&&n.statSync(s).isFile()?r?n.readFileSync(s,"utf8"):(t.warnings.push('Cannot fetch "'+s+'" as resource is not allowed.'),null):(t.warnings.push('Ignoring local source map at "'+s+'" as resource is missing.'),null)}(e,t),t.index++,t.sourcesContent[e]=r,l(t))}t.exports=function(e,t){var r={callback:t,fetch:e.options.fetch,index:0,inline:e.options.inline,inlineRequest:e.options.inlineRequest,inlineTimeout:e.options.inlineTimeout,localOnly:e.localOnly,rebaseTo:e.options.rebaseTo,sourcesContent:e.sourcesContent,uriToSource:function(e){var t,r,n,i,a,s={};for(n in e)for(i=0,a=(t=e[n]).sources.length;i<a;i++)r=t.sources[i],n=t.sourceContentFor(r,!0),s[r]=n;return s}(e.inputSourceMapTracker.all()),warnings:e.warnings};return e.options.sourceMap&&e.options.sourceMapInlineSources?l(r):t()}},{"../utils/has-protocol":88,"../utils/is-remote-resource":93,"./is-allowed-resource":72,fs:3,path:110}],74:[function(e,t,r){var n=e("http"),i=e("https"),a=e("url"),s=e("../utils/is-http-resource"),o=e("../utils/is-https-resource"),l=e("../utils/override");t.exports=function e(t,r,c,u){var h,f=r.protocol||r.hostname,d=!1;h=l(a.parse(t),r||{}),void 0!==r.hostname&&(h.protocol=r.protocol||"http:",h.path=h.href),(f&&!o(f)||s(t)?n.get:i.get)(h,(function(n){var i=[];if(!d){if(n.statusCode<200||399<n.statusCode)return u(n.statusCode,null);if(299<n.statusCode)return e(a.resolve(t,n.headers.location),r,c,u);n.on("data",(function(e){i.push(e.toString())})),n.on("end",(function(){var e=i.join("");u(null,e)}))}})).on("error",(function(e){d||(d=!0,u(e.message,null))})).on("timeout",(function(){d||(d=!0,u("timeout",null))})).setTimeout(c)}},{"../utils/is-http-resource":90,"../utils/is-https-resource":91,"../utils/override":95,http:155,https:104,url:162}],75:[function(e,t,r){var n=/^data:(\S*?)?(;charset=[^;]+)?(;[^,]+?)?,(.+)/;t.exports=function(e){return n.exec(e)}},{}],76:[function(e,t,r){var n=/\\/g;t.exports=function(e){return e.replace(n,"/")}},{}],77:[function(e,t,r){(function(r,n){var i=e("fs"),a=e("path"),s=e("./apply-source-maps"),o=e("./extract-import-url-and-media"),l=e("./is-allowed-resource"),c=e("./load-original-sources"),u=e("./normalize-path"),h=e("./rebase"),f=e("./rebase-local-map"),d=e("./rebase-remote-map"),p=e("./restore-import"),m=e("../tokenizer/tokenize"),g=e("../tokenizer/token"),T=e("../tokenizer/marker"),y=e("../utils/has-protocol"),v=e("../utils/is-import"),E=e("../utils/is-remote-resource");function C(e,t,r){return t.source=void 0,t.sourcesContent[void 0]=e,t.stats.originalSize+=e.length,x(e,t,{inline:t.options.inline},r)}function b(e,t,r){var n,i,a,s,o,l,c,u;for(n in e)a=e[n],i=S(n),r.push(I(i)),t.sourcesContent[i]=a.styles,a.sourceMap&&(o=i,l=t,c="string"==typeof(s=a.sourceMap)?JSON.parse(s):s,u=E(o)?d(c,o):f(c,o||"uri:unknown",l.options.rebaseTo),l.inputSourceMapTracker.track(o,u));return r}function S(e){var t,r,n=a.resolve("");return E(e)?e:(t=a.isAbsolute(e)?e:a.resolve(e),r=a.relative(n,t),u(r))}function I(e){return p("url("+e+")","")+T.SEMICOLON}function x(e,t,r,s){var c,f,d,p,T,C={};return t.source?E(t.source)?(C.fromBase=t.source,C.toBase=t.source):(a.isAbsolute(t.source)?C.fromBase=a.dirname(t.source):C.fromBase=a.dirname(a.resolve(t.source)),C.toBase=t.options.rebaseTo):(C.fromBase=a.resolve(""),C.toBase=t.options.rebaseTo),c=m(e,t),c=h(c,t.options.rebase,t.validator,C),1!=(T=r.inline).length||"none"!=T[0]?(f=c,p=r,function e(t){var r,s,c,h,f,d,p,m,T;for(s=0,c=t.sourceTokens.length;s<c;s++){if((r=t.sourceTokens[s])[0]==g.AT_RULE&&v(r[1]))return t.sourceTokens.splice(0,s),f=t,d=o((h=r)[1]),p=d[0],m=d[1],T=h[2],E(p)?function(t,r,i,a){var s=l(t,!0,a.inline),o=t,c=t in a.externalContext.sourcesContent,u=!y(t);if(-1<a.inlinedStylesheets.indexOf(t))return a.warnings.push('Ignoring remote @import of "'+t+'" as it has already been imported.'),a.sourceTokens=a.sourceTokens.slice(1),e(a);if(a.localOnly&&a.afterContent)return a.warnings.push('Ignoring remote @import of "'+t+'" as no callback given and after other content.'),a.sourceTokens=a.sourceTokens.slice(1),e(a);if(u)return a.warnings.push('Skipping remote @import of "'+t+'" as no protocol given.'),a.outputTokens=a.outputTokens.concat(a.sourceTokens.slice(0,1)),a.sourceTokens=a.sourceTokens.slice(1),e(a);if(a.localOnly&&!c)return a.warnings.push('Skipping remote @import of "'+t+'" as no callback given.'),a.outputTokens=a.outputTokens.concat(a.sourceTokens.slice(0,1)),a.sourceTokens=a.sourceTokens.slice(1),e(a);if(!s&&a.afterContent)return a.warnings.push('Ignoring remote @import of "'+t+'" as resource is not allowed and after other content.'),a.sourceTokens=a.sourceTokens.slice(1),e(a);if(!s)return a.warnings.push('Skipping remote @import of "'+t+'" as resource is not allowed.'),a.outputTokens=a.outputTokens.concat(a.sourceTokens.slice(0,1)),a.sourceTokens=a.sourceTokens.slice(1),e(a);function h(s,l){return s?(a.errors.push('Broken @import declaration of "'+t+'" - '+s),n.nextTick((function(){a.outputTokens=a.outputTokens.concat(a.sourceTokens.slice(0,1)),a.sourceTokens=a.sourceTokens.slice(1),e(a)}))):(a.inline=a.externalContext.options.inline,a.isRemote=!0,a.externalContext.source=o,a.externalContext.sourcesContent[t]=l,a.externalContext.stats.originalSize+=l.length,x(l,a.externalContext,a,(function(t){return t=P(t,r,i),a.outputTokens=a.outputTokens.concat(t),a.sourceTokens=a.sourceTokens.slice(1),e(a)})))}return a.inlinedStylesheets.push(t),c?h(null,a.externalContext.sourcesContent[t]):a.fetch(t,a.inlineRequest,a.inlineTimeout,h)}(p,m,T,f):function(t,r,n,s){var o,c=a.resolve(""),h=a.isAbsolute(t)?a.resolve(c,"/"==t[0]?t.substring(1):t):a.resolve(s.rebaseTo,t),f=a.relative(c,h),d=l(t,!1,s.inline),p=u(f),m=p in s.externalContext.sourcesContent;if(-1<s.inlinedStylesheets.indexOf(h))s.warnings.push('Ignoring local @import of "'+t+'" as it has already been imported.');else if(m||i.existsSync(h)&&i.statSync(h).isFile())if(!d&&s.afterContent)s.warnings.push('Ignoring local @import of "'+t+'" as resource is not allowed and after other content.');else if(s.afterContent)s.warnings.push('Ignoring local @import of "'+t+'" as after other content.');else{if(d)return o=m?s.externalContext.sourcesContent[p]:i.readFileSync(h,"utf-8"),s.inlinedStylesheets.push(h),s.inline=s.externalContext.options.inline,s.externalContext.source=p,s.externalContext.sourcesContent[p]=o,s.externalContext.stats.originalSize+=o.length,x(o,s.externalContext,s,(function(t){return t=P(t,r,n),s.outputTokens=s.outputTokens.concat(t),s.sourceTokens=s.sourceTokens.slice(1),e(s)}));s.warnings.push('Skipping local @import of "'+t+'" as resource is not allowed.'),s.outputTokens=s.outputTokens.concat(s.sourceTokens.slice(0,1))}else s.errors.push('Ignoring local @import of "'+t+'" as resource is missing.');return s.sourceTokens=s.sourceTokens.slice(1),e(s)}(p,m,T,f);r[0]==g.AT_RULE||r[0]==g.COMMENT?t.outputTokens.push(r):(t.outputTokens.push(r),t.afterContent=!0)}return t.sourceTokens=[],t.callback(t.outputTokens)}({afterContent:!1,callback:s,errors:(d=t).errors,externalContext:d,fetch:d.options.fetch,inlinedStylesheets:p.inlinedStylesheets||d.inlinedStylesheets,inline:p.inline,inlineRequest:d.options.inlineRequest,inlineTimeout:d.options.inlineTimeout,isRemote:p.isRemote||!1,localOnly:d.localOnly,outputTokens:[],rebaseTo:d.options.rebaseTo,sourceTokens:f,warnings:d.warnings})):s(c)}function P(e,t,r){return t?[[g.NESTED_BLOCK,[[g.NESTED_BLOCK_SCOPE,"@media "+t,r]],e]]:e}t.exports=function(e,t,n){return a=t,o=function(e){return s(e,t,(function(){return c(t,(function(){return n(e)}))}))},"string"==typeof(i=e)?C(i,a,o):r.isBuffer(i)?C(i.toString(),a,o):Array.isArray(i)?(h=a,f=o,x(i.reduce((function(e,t){return"string"==typeof t?(r=t,(n=e).push(I(S(r))),n):b(t,h,e);var r,n}),[]).join(""),h,{inline:["all"]},f)):"object"==_typeof(i)?(u=o,x(b(i,l=a,[]).join(""),l,{inline:["all"]},u)):void 0;var i,a,o,l,u,h,f}}).call(this,{isBuffer:e("../../../is-buffer/index.js")},e("_process"))},{"../../../is-buffer/index.js":107,"../tokenizer/marker":83,"../tokenizer/token":84,"../tokenizer/tokenize":85,"../utils/has-protocol":88,"../utils/is-import":92,"../utils/is-remote-resource":93,"./apply-source-maps":69,"./extract-import-url-and-media":70,"./is-allowed-resource":72,"./load-original-sources":73,"./normalize-path":76,"./rebase":80,"./rebase-local-map":78,"./rebase-remote-map":79,"./restore-import":81,_process:112,fs:3,path:110}],78:[function(e,t,r){var n=e("path");t.exports=function(e,t,r){var i=n.resolve(""),a=n.resolve(i,t),s=n.dirname(a);return e.sources=e.sources.map((function(e){return n.relative(r,n.resolve(s,e))})),e}},{path:110}],79:[function(e,t,r){var n=e("path"),i=e("url");t.exports=function(e,t){var r=n.dirname(t);return e.sources=e.sources.map((function(e){return i.resolve(r,e)})),e}},{path:110,url:162}],80:[function(e,t,r){var n=e("./extract-import-url-and-media"),i=e("./restore-import"),a=e("./rewrite-url"),s=e("../tokenizer/token"),o=e("../utils/is-import"),l=/^\/\*# sourceMappingURL=(\S+) \*\/$/;function c(e,t,r){if(o(e[1])){var s=n(e[1]),l=a(s[0],r),c=s[1];e[1]=i(l,c)}}function u(e,t,r){var n,i,s,o,l,c;for(s=0,o=e.length;s<o;s++)for(l=2,c=(n=e[s]).length;l<c;l++)i=n[l][1],t.isUrl(i)&&(n[l][1]=a(i,r))}t.exports=function(e,t,r,n){return t?function e(t,r,n){var i,o,h,f,d,p;for(o=0,h=t.length;o<h;o++)switch((i=t[o])[0]){case s.AT_RULE:c(i,0,n);break;case s.AT_RULE_BLOCK:u(i[2],r,n);break;case s.COMMENT:f=i,d=n,p=void 0,(p=l.exec(f[1]))&&-1===p[1].indexOf("data:")&&(f[1]=f[1].replace(p[1],a(p[1],d,!0)));break;case s.NESTED_BLOCK:e(i[2],r,n);break;case s.RULE:u(i[2],r,n)}return t}(e,r,n):function(e,t,r){var n,i,a;for(i=0,a=e.length;i<a;i++)switch((n=e[i])[0]){case s.AT_RULE:c(n,0,r)}return e}(e,0,n)}},{"../tokenizer/token":84,"../utils/is-import":92,"./extract-import-url-and-media":70,"./restore-import":81,"./rewrite-url":82}],81:[function(e,t,r){t.exports=function(e,t){return("@import "+e+" "+t).trim()}},{}],82:[function(e,t,r){(function(r){var n=e("path"),i=e("url"),a="'",s=/^["']/,o=/["']$/,l=/[\(\)]/,c=/^url\(/i,u=/\)$/,h=/\s/,f="win32"==r.platform;function d(e,t){return t?(r=e,n.isAbsolute(r)&&!p(t.toBase)||p(e)||"#"==e[0]||/^\w+:\w+/.test(e)?e:0===e.indexOf("data:")?"'"+e+"'":p(t.toBase)?i.resolve(t.toBase,e):t.absolute?m((o=e,l=t,n.resolve(n.join(l.fromBase||"",o)).replace(l.toBase,""))):m((a=e,s=t,n.relative(s.toBase,n.join(s.fromBase||"",a))))):e;var r,a,s,o,l}function p(e){return/^[^:]+?:\/\//.test(e)||0===e.indexOf("//")}function m(e){return f?e.replace(/\\/g,"/"):e}function g(e){return-1<e.indexOf(a)?'"':-1<e.indexOf('"')?a:(r=e,h.test(r)||(t=e,l.test(t))?a:"");var t,r}t.exports=function(e,t,r){var n=e.replace(c,"").replace(u,"").trim(),i=n.replace(s,"").replace(o,"").trim(),l=n[0]==a||'"'==n[0]?n[0]:g(i);return r?d(i,t):"url("+l+d(i,t)+l+")"}}).call(this,e("_process"))},{_process:112,path:110,url:162}],83:[function(e,t,r){t.exports={ASTERISK:"*",AT:"@",BACK_SLASH:"\\",CARRIAGE_RETURN:"\r",CLOSE_CURLY_BRACKET:"}",CLOSE_ROUND_BRACKET:")",CLOSE_SQUARE_BRACKET:"]",COLON:":",COMMA:",",DOUBLE_QUOTE:'"',EXCLAMATION:"!",FORWARD_SLASH:"/",INTERNAL:"-clean-css-",NEW_LINE_NIX:"\n",OPEN_CURLY_BRACKET:"{",OPEN_ROUND_BRACKET:"(",OPEN_SQUARE_BRACKET:"[",SEMICOLON:";",SINGLE_QUOTE:"'",SPACE:" ",TAB:"\t",UNDERSCORE:"_"}},{}],84:[function(e,t,r){t.exports={AT_RULE:"at-rule",AT_RULE_BLOCK:"at-rule-block",AT_RULE_BLOCK_SCOPE:"at-rule-block-scope",COMMENT:"comment",NESTED_BLOCK:"nested-block",NESTED_BLOCK_SCOPE:"nested-block-scope",PROPERTY:"property",PROPERTY_BLOCK:"property-block",PROPERTY_NAME:"property-name",PROPERTY_VALUE:"property-value",RAW:"raw",RULE:"rule",RULE_SCOPE:"rule-scope"}},{}],85:[function(e,t,r){var n=e("./marker"),i=e("./token"),a=e("../utils/format-position"),s="block",o="comment",l="double-quote",c="rule",u="single-quote",h=["@charset","@import"],f=["@-moz-document","@document","@-moz-keyframes","@-ms-keyframes","@-o-keyframes","@-webkit-keyframes","@keyframes","@media","@supports"],d=/\/\* clean\-css ignore:end \*\/$/,p=/^\/\* clean\-css ignore:start \*\//,m=["@bottom-center","@bottom-left","@bottom-left-corner","@bottom-right","@bottom-right-corner","@left-bottom","@left-middle","@left-top","@right-bottom","@right-middle","@right-top","@top-center","@top-left","@top-left-corner","@top-right","@top-right-corner"],g=["@footnote","@footnotes","@left","@page-float-bottom","@page-float-top","@right"],T=/^\[\s{0,31}\d+\s{0,31}\]$/,y=/[\s\(]/,v=/[\s|\}]*$/;function E(e,t,r,n){var i=e[2];return r.inputSourceMapTracker.isTracking(i)?r.inputSourceMapTracker.originalPositionFor(e,t.length,n):e}function C(e){var t=e[0]==n.AT||e[0]==n.UNDERSCORE,r=e.join("").split(y)[0];return t&&-1<f.indexOf(r)?i.NESTED_BLOCK:t&&-1<h.indexOf(r)?i.AT_RULE:t?i.AT_RULE_BLOCK:i.RULE}function b(e){return e==i.RULE?i.RULE_SCOPE:e==i.NESTED_BLOCK?i.NESTED_BLOCK_SCOPE:e==i.AT_RULE_BLOCK?i.AT_RULE_BLOCK_SCOPE:void 0}t.exports=function(e,t){return function e(t,r,h,f){for(var y,S,I,x,P,w,D,_,A,R,M,N,k,O,L,F,B,V,U,H,z=[],j=z,q=[],G=[],W=h.level,Y=[],K=[],Q=[],X=0,$=!1,Z=!1,J=!1,ee=!1,te=!1,re=h.position;re.index<t.length;re.index++){var ne=t[re.index];if(D=W==u||W==l,_=ne==n.SPACE||ne==n.TAB,A=ne==n.NEW_LINE_NIX,R=ne==n.NEW_LINE_NIX&&t[re.index-1]==n.CARRIAGE_RETURN,M=ne==n.CARRIAGE_RETURN&&t[re.index+1]&&t[re.index+1]!=n.NEW_LINE_NIX,N=!Z&&W!=o&&!D&&ne==n.ASTERISK&&t[re.index-1]==n.FORWARD_SLASH,O=!$&&!D&&ne==n.FORWARD_SLASH&&t[re.index-1]==n.ASTERISK,k=W==o&&O,X=Math.max(X,0),x=0===K.length?[re.line,re.column,re.source]:x,L)K.push(ne);else if(k||W!=o)if(N||k||!J)if(N&&(W==s||W==c)&&1<K.length)G.push(x),K.push(ne),Q.push(K.slice(0,K.length-2)),K=K.slice(K.length-2),x=[re.line,re.column-1,re.source],Y.push(W),W=o;else if(N)Y.push(W),W=o,K.push(ne);else if(k&&(H=K,p.test(H.join("")+n.FORWARD_SLASH)))P=K.join("").trim()+ne,y=[i.COMMENT,P,[E(x,P,r)]],j.push(y),J=!0,x=G.pop()||null,K=Q.pop()||[];else if(k&&(U=K,d.test(U.join("")+n.FORWARD_SLASH)))F=(P=K.join("")+ne).lastIndexOf(n.FORWARD_SLASH+n.ASTERISK),w=P.substring(0,F),y=[i.RAW,w,[E(x,w,r)]],j.push(y),w=P.substring(F),x=[re.line,re.column-w.length+1,re.source],y=[i.COMMENT,w,[E(x,w,r)]],j.push(y),J=!1,W=Y.pop(),x=G.pop()||null,K=Q.pop()||[];else if(k)P=K.join("").trim()+ne,y=[i.COMMENT,P,[E(x,P,r)]],j.push(y),W=Y.pop(),x=G.pop()||null,K=Q.pop()||[];else if(O&&t[re.index+1]!=n.ASTERISK)r.warnings.push("Unexpected '*/' at "+a([re.line,re.column,re.source])+"."),K=[];else if(ne!=n.SINGLE_QUOTE||D)if(ne==n.SINGLE_QUOTE&&W==u)W=Y.pop(),K.push(ne);else if(ne!=n.DOUBLE_QUOTE||D)if(ne==n.DOUBLE_QUOTE&&W==l)W=Y.pop(),K.push(ne);else if(!N&&!k&&ne!=n.CLOSE_ROUND_BRACKET&&ne!=n.OPEN_ROUND_BRACKET&&W!=o&&!D&&0<X)K.push(ne);else if(ne!=n.OPEN_ROUND_BRACKET||D||W==o||ee)if(ne!=n.CLOSE_ROUND_BRACKET||D||W==o||ee)if(ne==n.SEMICOLON&&W==s&&K[0]==n.AT)P=K.join("").trim(),z.push([i.AT_RULE,P,[E(x,P,r)]]),K=[];else if(ne==n.COMMA&&W==s&&S)P=K.join("").trim(),S[1].push([b(S[0]),P,[E(x,P,r,S[1].length)]]),K=[];else if(ne==n.COMMA&&W==s&&C(K)==i.AT_RULE)K.push(ne);else if(ne==n.COMMA&&W==s)S=[C(K),[],[]],P=K.join("").trim(),S[1].push([b(S[0]),P,[E(x,P,r,0)]]),K=[];else if(ne==n.OPEN_CURLY_BRACKET&&W==s&&S&&S[0]==i.NESTED_BLOCK)P=K.join("").trim(),S[1].push([i.NESTED_BLOCK_SCOPE,P,[E(x,P,r)]]),z.push(S),Y.push(W),re.column++,re.index++,K=[],S[2]=e(t,r,h,!0),S=null;else if(ne==n.OPEN_CURLY_BRACKET&&W==s&&C(K)==i.NESTED_BLOCK)P=K.join("").trim(),(S=S||[i.NESTED_BLOCK,[],[]])[1].push([i.NESTED_BLOCK_SCOPE,P,[E(x,P,r)]]),z.push(S),Y.push(W),re.column++,re.index++,K=[],S[2]=e(t,r,h,!0),S=null;else if(ne==n.OPEN_CURLY_BRACKET&&W==s)P=K.join("").trim(),(S=S||[C(K),[],[]])[1].push([b(S[0]),P,[E(x,P,r,S[1].length)]]),j=S[2],z.push(S),Y.push(W),W=c,K=[];else if(ne==n.OPEN_CURLY_BRACKET&&W==c&&ee)q.push(S),S=[i.PROPERTY_BLOCK,[]],I.push(S),j=S[1],Y.push(W),W=c,ee=!1;else if(ne==n.OPEN_CURLY_BRACKET&&W==c&&(V=K.join("").trim(),-1<m.indexOf(V)||-1<g.indexOf(V)))P=K.join("").trim(),q.push(S),(S=[i.AT_RULE_BLOCK,[],[]])[1].push([i.AT_RULE_BLOCK_SCOPE,P,[E(x,P,r)]]),j.push(S),j=S[2],Y.push(W),W=c,K=[];else if(ne!=n.COLON||W!=c||ee)if(ne==n.SEMICOLON&&W==c&&I&&0<q.length&&0<K.length&&K[0]==n.AT)P=K.join("").trim(),S[1].push([i.AT_RULE,P,[E(x,P,r)]]),K=[];else if(ne==n.SEMICOLON&&W==c&&I&&0<K.length)P=K.join("").trim(),I.push([i.PROPERTY_VALUE,P,[E(x,P,r)]]),I=null,ee=!1,K=[];else if(ne==n.SEMICOLON&&W==c&&I&&0===K.length)I=null,ee=!1;else if(ne==n.SEMICOLON&&W==c&&0<K.length&&K[0]==n.AT)P=K.join(""),j.push([i.AT_RULE,P,[E(x,P,r)]]),ee=!1,K=[];else if(ne==n.SEMICOLON&&W==c&&te)te=!1,K=[];else if(ne==n.SEMICOLON&&W==c&&0===K.length);else if(ne==n.CLOSE_CURLY_BRACKET&&W==c&&I&&ee&&0<K.length&&0<q.length)P=K.join(""),I.push([i.PROPERTY_VALUE,P,[E(x,P,r)]]),I=null,j=(S=q.pop())[2],W=Y.pop(),ee=!1,K=[];else if(ne==n.CLOSE_CURLY_BRACKET&&W==c&&I&&0<K.length&&K[0]==n.AT&&0<q.length)P=K.join(""),S[1].push([i.AT_RULE,P,[E(x,P,r)]]),I=null,j=(S=q.pop())[2],W=Y.pop(),ee=!1,K=[];else if(ne==n.CLOSE_CURLY_BRACKET&&W==c&&I&&0<q.length)I=null,j=(S=q.pop())[2],W=Y.pop(),ee=!1;else if(ne==n.CLOSE_CURLY_BRACKET&&W==c&&I&&0<K.length)P=K.join(""),I.push([i.PROPERTY_VALUE,P,[E(x,P,r)]]),I=null,S=q.pop(),j=z,W=Y.pop(),ee=!1,K=[];else if(ne==n.CLOSE_CURLY_BRACKET&&W==c&&0<K.length&&K[0]==n.AT)S=I=null,P=K.join("").trim(),j.push([i.AT_RULE,P,[E(x,P,r)]]),j=z,W=Y.pop(),ee=!1,K=[];else if(ne==n.CLOSE_CURLY_BRACKET&&W==c&&Y[Y.length-1]==c)I=null,j=(S=q.pop())[2],W=Y.pop(),te=!(ee=!1),K=[];else if(ne==n.CLOSE_CURLY_BRACKET&&W==c)S=I=null,j=z,W=Y.pop(),ee=!1;else if(ne==n.CLOSE_CURLY_BRACKET&&W==s&&!f&&re.index<=t.length-1)r.warnings.push("Unexpected '}' at "+a([re.line,re.column,re.source])+"."),K.push(ne);else{if(ne==n.CLOSE_CURLY_BRACKET&&W==s)break;ne==n.OPEN_ROUND_BRACKET&&W==c&&ee?(K.push(ne),X++):ne==n.CLOSE_ROUND_BRACKET&&W==c&&ee&&1==X?(K.push(ne),P=K.join("").trim(),I.push([i.PROPERTY_VALUE,P,[E(x,P,r)]]),X--,K=[]):ne==n.CLOSE_ROUND_BRACKET&&W==c&&ee?(K.push(ne),X--):ne==n.FORWARD_SLASH&&t[re.index+1]!=n.ASTERISK&&W==c&&ee&&0<K.length?(P=K.join("").trim(),I.push([i.PROPERTY_VALUE,P,[E(x,P,r)]]),I.push([i.PROPERTY_VALUE,ne,[[re.line,re.column,re.source]]]),K=[]):ne==n.FORWARD_SLASH&&t[re.index+1]!=n.ASTERISK&&W==c&&ee?(I.push([i.PROPERTY_VALUE,ne,[[re.line,re.column,re.source]]]),K=[]):ne==n.COMMA&&W==c&&ee&&0<K.length?(P=K.join("").trim(),I.push([i.PROPERTY_VALUE,P,[E(x,P,r)]]),I.push([i.PROPERTY_VALUE,ne,[[re.line,re.column,re.source]]]),K=[]):ne==n.COMMA&&W==c&&ee?(I.push([i.PROPERTY_VALUE,ne,[[re.line,re.column,re.source]]]),K=[]):ne==n.CLOSE_SQUARE_BRACKET&&I&&1<I.length&&0<K.length&&(B=K,T.test(B.join("")+n.CLOSE_SQUARE_BRACKET))?(K.push(ne),P=K.join("").trim(),I[I.length-1][1]+=P,K=[]):(_||A&&!R)&&W==c&&ee&&I&&0<K.length||R&&W==c&&ee&&I&&1<K.length?(P=K.join("").trim(),I.push([i.PROPERTY_VALUE,P,[E(x,P,r)]]),K=[]):R&&W==c&&ee?K=[]:1==K.length&&R?K.pop():(0<K.length||!_&&!A&&!R&&!M)&&K.push(ne)}else P=K.join("").trim(),I=[i.PROPERTY,[i.PROPERTY_NAME,P,[E(x,P,r)]]],j.push(I),ee=!0,K=[];else K.push(ne),X--;else K.push(ne),X++;else Y.push(W),W=l,K.push(ne);else Y.push(W),W=u,K.push(ne);else K.push(ne);else K.push(ne);L=!L&&ne==n.BACK_SLASH,$=N,Z=k,re.line=R||A||M?re.line+1:re.line,re.column=R||A||M?0:re.column+1}return ee&&r.warnings.push("Missing '}' at "+a([re.line,re.column,re.source])+"."),ee&&0<K.length&&(P=K.join("").replace(v,""),I.push([i.PROPERTY_VALUE,P,[E(x,P,r)]]),K=[]),0<K.length&&r.warnings.push("Invalid character(s) '"+K.join("")+"' at "+a(x)+". Ignoring."),z}(e,t,{level:s,position:{source:t.source||void 0,line:1,column:0,index:0}},!1)}},{"../utils/format-position":87,"./marker":83,"./token":84}],86:[function(e,t,r){t.exports=function e(t){for(var r=t.slice(0),n=0,i=r.length;n<i;n++)Array.isArray(r[n])&&(r[n]=e(r[n]));return r}},{}],87:[function(e,t,r){t.exports=function(e){var t=e[0],r=e[1],n=e[2];return n?n+":"+t+":"+r:t+":"+r}},{}],88:[function(e,t,r){var n=/^\/\//;t.exports=function(e){return!n.test(e)}},{}],89:[function(e,t,r){var n=/^data:(\S*?)?(;charset=[^;]+)?(;[^,]+?)?,(.+)/;t.exports=function(e){return n.test(e)}},{}],90:[function(e,t,r){var n=/^http:\/\//;t.exports=function(e){return n.test(e)}},{}],91:[function(e,t,r){var n=/^https:\/\//;t.exports=function(e){return n.test(e)}},{}],92:[function(e,t,r){var n=/^@import/i;t.exports=function(e){return n.test(e)}},{}],93:[function(e,t,r){var n=/^(\w+:\/\/|\/\/)/;t.exports=function(e){return n.test(e)}},{}],94:[function(e,t,r){var n=/([0-9]+)/;function i(e){return""+parseInt(e)==e?parseInt(e):e}t.exports=function(e,t){var r,a,s,o,l=(""+e).split(n).map(i),c=(""+t).split(n).map(i);for(s=0,o=Math.min(l.length,c.length);s<o;s++)if((r=l[s])!=(a=c[s]))return a<r?1:-1;return l.length>c.length?1:l.length==c.length?0:-1}},{}],95:[function(e,t,r){t.exports=function e(t,r){var n,i,a,s={};for(n in t)a=t[n],Array.isArray(a)?s[n]=a.slice(0):s[n]="object"==_typeof(a)&&null!==a?e(a,{}):a;for(i in r)a=r[i],i in s&&Array.isArray(a)?s[i]=a.slice(0):s[i]=i in s&&"object"==_typeof(a)&&null!==a?e(s[i],a):a;return s}},{}],96:[function(e,t,r){var n=e("../tokenizer/marker");t.exports=function(e,t){var r,i=n.OPEN_ROUND_BRACKET,a=n.CLOSE_ROUND_BRACKET,s=0,o=0,l=0,c=e.length,u=[];if(-1==e.indexOf(t))return[e];if(-1==e.indexOf(i))return e.split(t);for(;o<c;)e[o]==i?s++:e[o]==a&&s--,0===s&&0<o&&o+1<c&&e[o]==t&&(u.push(e.substring(l,o)),l=o+1),o++;return l<o+1&&((r=e.substring(l))[r.length-1]==t&&(r=r.substring(0,r.length-1)),u.push(r)),u}},{"../tokenizer/marker":83}],97:[function(e,t,r){var n="",i=e("../options/format").Breaks,a=e("../options/format").Spaces,s=e("../tokenizer/marker"),o=e("../tokenizer/token");function l(e,t,r){return!e.spaceAfterClosingBrace&&("background"==(u=t)[1][1]||"transform"==u[1][1]||"src"==u[1][1])&&(l=t)[c=r][1][l[c][1].length-1]==s.CLOSE_ROUND_BRACKET||(a=t)[(o=r)+1]&&a[o+1][1]==s.FORWARD_SLASH||t[r][1]==s.FORWARD_SLASH||(n=t)[(i=r)+1]&&n[i+1][1]==s.COMMA||t[r][1]==s.COMMA;var n,i,a,o,l,c,u}function c(e,t){for(var r,a=e.store,o=0,l=t.length;o<l;o++)a(e,t[o]),o<l-1&&a(e,(r=e).format?s.COMMA+(d(r,i.BetweenSelectors)?r.format.breakWith:n)+r.indentWith:s.COMMA)}function u(e,t){for(var r=function(e){for(var t=e.length-1;0<=t&&e[t][0]==o.COMMENT;t--);return t}(t),n=0,i=t.length;n<i;n++)h(e,t,n,r)}function h(e,t,r,l){var h,d=e.store,y=t[r],v=y[2][0]==o.PROPERTY_BLOCK;h=e.format?!(!e.format.semicolonAfterLastProperty&&!v)||r<l:r<l||v;var E,C=r===l;switch(y[0]){case o.AT_RULE:d(e,y),d(e,T(e,i.AfterProperty,!1));break;case o.AT_RULE_BLOCK:c(e,y[1]),d(e,m(e,i.AfterRuleBegins,!0)),u(e,y[2]),d(e,g(e,i.AfterRuleEnds,!1,C));break;case o.COMMENT:d(e,y);break;case o.PROPERTY:d(e,y[1]),d(e,(E=e).format?s.COLON+(p(E,a.BeforeValue)?s.SPACE:n):s.COLON),f(e,y),d(e,h?T(e,i.AfterProperty,C):n);break;case o.RAW:d(e,y)}}function f(e,t){var r,n,a,c=e.store;if(t[2][0]==o.PROPERTY_BLOCK)c(e,m(e,i.AfterBlockBegins,!1)),u(e,t[2][1]),c(e,g(e,i.AfterBlockEnds,!1,!0));else for(r=2,n=t.length;r<n;r++)c(e,t[r]),r<n-1&&("filter"==(a=t)[1][1]||"-ms-filter"==a[1][1]||!l(e,t,r))&&c(e,s.SPACE)}function d(e,t){return e.format&&e.format.breaks[t]}function p(e,t){return e.format&&e.format.spaces[t]}function m(e,t,r){return e.format?(e.indentBy+=e.format.indentBy,e.indentWith=e.format.indentWith.repeat(e.indentBy),(r&&p(e,a.BeforeBlockBegins)?s.SPACE:n)+s.OPEN_CURLY_BRACKET+(d(e,t)?e.format.breakWith:n)+e.indentWith):s.OPEN_CURLY_BRACKET}function g(e,t,r,a){return e.format?(e.indentBy-=e.format.indentBy,e.indentWith=e.format.indentWith.repeat(e.indentBy),(d(e,i.AfterProperty)||r&&d(e,i.BeforeBlockEnds)?e.format.breakWith:n)+e.indentWith+s.CLOSE_CURLY_BRACKET+(a?n:(d(e,t)?e.format.breakWith:n)+e.indentWith)):s.CLOSE_CURLY_BRACKET}function T(e,t,r){return e.format?s.SEMICOLON+(r||!d(e,t)?n:e.format.breakWith+e.indentWith):s.SEMICOLON}t.exports={all:function e(t,r){var a,s,l,h,f=t.store;for(l=0,h=r.length;l<h;l++)switch(s=l==h-1,(a=r[l])[0]){case o.AT_RULE:f(t,a),f(t,T(t,i.AfterAtRule,s));break;case o.AT_RULE_BLOCK:c(t,a[1]),f(t,m(t,i.AfterRuleBegins,!0)),u(t,a[2]),f(t,g(t,i.AfterRuleEnds,!1,s));break;case o.NESTED_BLOCK:c(t,a[1]),f(t,m(t,i.AfterBlockBegins,!0)),e(t,a[2]),f(t,g(t,i.AfterBlockEnds,!0,s));break;case o.COMMENT:f(t,a),f(t,d(t,i.AfterComment)?t.format.breakWith:n);break;case o.RAW:f(t,a);break;case o.RULE:c(t,a[1]),f(t,m(t,i.AfterRuleBegins,!0)),u(t,a[2]),f(t,g(t,i.AfterRuleEnds,!1,s))}},body:u,property:h,rules:c,value:f}},{"../options/format":61,"../tokenizer/marker":83,"../tokenizer/token":84}],98:[function(e,t,r){var n=e("./helpers");function i(e,t){e.output.push("string"==typeof t?t:t[1])}function a(){return{output:[],store:i}}t.exports={all:function(e){var t=a();return n.all(t,e),t.output.join("")},body:function(e){var t=a();return n.body(t,e),t.output.join("")},property:function(e,t){var r=a();return n.property(r,e,t,!0),r.output.join("")},rules:function(e){var t=a();return n.rules(t,e),t.output.join("")},value:function(e){var t=a();return n.value(t,e),t.output.join("")}}},{"./helpers":97}],99:[function(e,t,r){var n=e("./helpers").all;function i(e,t){var r="string"==typeof t?t:t[1];(0,e.wrap)(e,r),s(e,r),e.output.push(r)}function a(e,t){e.column+t.length>e.format.wrapAt&&(s(e,e.format.breakWith),e.output.push(e.format.breakWith))}function s(e,t){var r=t.split("\n");e.line+=r.length-1,e.column=1<r.length?0:e.column+r.pop().length}t.exports=function(e,t){var r={column:0,format:t.options.format,indentBy:0,indentWith:"",line:1,output:[],spaceAfterClosingBrace:t.options.compatibility.properties.spaceAfterClosingBrace,store:i,wrap:t.options.format.wrapAt?a:function(){}};return n(r,e),{styles:r.output.join("")}}},{"./helpers":97}],100:[function(e,t,r){(function(r){var n=e("source-map").SourceMapGenerator,i=e("./helpers").all,a=e("../utils/is-remote-resource"),s="win32"==r.platform,o=/\//g;function l(e,t){var r="string"==typeof t,n=r?t:t[1],i=r?null:t[2];(0,e.wrap)(e,n),u(e,n,i),e.output.push(n)}function c(e,t){e.column+t.length>e.format.wrapAt&&(u(e,e.format.breakWith,!1),e.output.push(e.format.breakWith))}function u(e,t,r){var n=t.split("\n");r&&function(e,t){for(var r=0,n=t.length;r<n;r++)h(e,t[r])}(e,r),e.line+=n.length-1,e.column=1<n.length?0:e.column+n.pop().length}function h(e,t){var r=t[0],n=t[1],i=t[2],l=i,c=l||"$stdin";s&&l&&!a(l)&&(c=l.replace(o,"\\")),e.outputMap.addMapping({generated:{line:e.line,column:e.column},source:c,original:{line:r,column:n}}),e.inlineSources&&i in e.sourcesContent&&e.outputMap.setSourceContent(c,e.sourcesContent[i])}t.exports=function(e,t){var r={column:0,format:t.options.format,indentBy:0,indentWith:"",inlineSources:t.options.sourceMapInlineSources,line:1,output:[],outputMap:new n,sourcesContent:t.sourcesContent,spaceAfterClosingBrace:t.options.compatibility.properties.spaceAfterClosingBrace,store:l,wrap:t.options.format.wrapAt?c:function(){}};return i(r,e),{sourceMap:r.outputMap,styles:r.output.join("")}}}).call(this,e("_process"))},{"../utils/is-remote-resource":93,"./helpers":97,_process:112,"source-map":154}],101:[function(e,t,r){(function(e){function t(e){return Object.prototype.toString.call(e)}r.isArray=function(e){return Array.isArray?Array.isArray(e):"[object Array]"===t(e)},r.isBoolean=function(e){return"boolean"==typeof e},r.isNull=function(e){return null===e},r.isNullOrUndefined=function(e){return null==e},r.isNumber=function(e){return"number"==typeof e},r.isString=function(e){return"string"==typeof e},r.isSymbol=function(e){return"symbol"==_typeof(e)},r.isUndefined=function(e){return void 0===e},r.isRegExp=function(e){return"[object RegExp]"===t(e)},r.isObject=function(e){return"object"==_typeof(e)&&null!==e},r.isDate=function(e){return"[object Date]"===t(e)},r.isError=function(e){return"[object Error]"===t(e)||e instanceof Error},r.isFunction=function(e){return"function"==typeof e},r.isPrimitive=function(e){return null===e||"boolean"==typeof e||"number"==typeof e||"string"==typeof e||"symbol"==_typeof(e)||void 0===e},r.isBuffer=e.isBuffer}).call(this,{isBuffer:e("../../is-buffer/index.js")})},{"../../is-buffer/index.js":107}],102:[function(e,t,r){var n=Object.create||function(e){var t=function(){};return t.prototype=e,new t},i=Object.keys||function(e){var t=[];for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.push(r);return r},a=Function.prototype.bind||function(e){var t=this;return function(){return t.apply(e,arguments)}};function s(){this._events&&Object.prototype.hasOwnProperty.call(this,"_events")||(this._events=n(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0}((t.exports=s).EventEmitter=s).prototype._events=void 0,s.prototype._maxListeners=void 0;var o,l=10;try{var c={};Object.defineProperty&&Object.defineProperty(c,"x",{value:0}),o=0===c.x}catch(e){o=!1}function u(e){return void 0===e._maxListeners?s.defaultMaxListeners:e._maxListeners}function h(e,t,r,i){var a,s,o;if("function"!=typeof r)throw new TypeError('"listener" argument must be a function');if((s=e._events)?(s.newListener&&(e.emit("newListener",t,r.listener?r.listener:r),s=e._events),o=s[t]):(s=e._events=n(null),e._eventsCount=0),o){if("function"==typeof o?o=s[t]=i?[r,o]:[o,r]:i?o.unshift(r):o.push(r),!o.warned&&(a=u(e))&&0<a&&o.length>a){o.warned=!0;var l=new Error("Possible EventEmitter memory leak detected. "+o.length+' "'+String(t)+'" listeners added. Use emitter.setMaxListeners() to increase limit.');l.name="MaxListenersExceededWarning",l.emitter=e,l.type=t,l.count=o.length,"object"==("undefined"==typeof console?"undefined":_typeof(console))&&console.warn&&console.warn("%s: %s",l.name,l.message)}}else o=s[t]=r,++e._eventsCount;return e}function f(){if(!this.fired)switch(this.target.removeListener(this.type,this.wrapFn),this.fired=!0,arguments.length){case 0:return this.listener.call(this.target);case 1:return this.listener.call(this.target,arguments[0]);case 2:return this.listener.call(this.target,arguments[0],arguments[1]);case 3:return this.listener.call(this.target,arguments[0],arguments[1],arguments[2]);default:for(var e=new Array(arguments.length),t=0;t<e.length;++t)e[t]=arguments[t];this.listener.apply(this.target,e)}}function d(e,t,r){var n={fired:!1,wrapFn:void 0,target:e,type:t,listener:r},i=a.call(f,n);return i.listener=r,n.wrapFn=i}function p(e,t,r){var n=e._events;if(!n)return[];var i=n[t];return i?"function"==typeof i?r?[i.listener||i]:[i]:r?function(e){for(var t=new Array(e.length),r=0;r<t.length;++r)t[r]=e[r].listener||e[r];return t}(i):g(i,i.length):[]}function m(e){var t=this._events;if(t){var r=t[e];if("function"==typeof r)return 1;if(r)return r.length}return 0}function g(e,t){for(var r=new Array(t),n=0;n<t;++n)r[n]=e[n];return r}o?Object.defineProperty(s,"defaultMaxListeners",{enumerable:!0,get:function(){return l},set:function(e){if("number"!=typeof e||e<0||e!=e)throw new TypeError('"defaultMaxListeners" must be a positive number');l=e}}):s.defaultMaxListeners=l,s.prototype.setMaxListeners=function(e){if("number"!=typeof e||e<0||isNaN(e))throw new TypeError('"n" argument must be a positive number');return this._maxListeners=e,this},s.prototype.getMaxListeners=function(){return u(this)},s.prototype.emit=function(e){var t,r,n,i,a,s,o="error"===e;if(s=this._events)o=o&&null==s.error;else if(!o)return!1;if(o){if(1<arguments.length&&(t=arguments[1]),t instanceof Error)throw t;var l=new Error('Unhandled "error" event. ('+t+")");throw l.context=t,l}if(!(r=s[e]))return!1;var c="function"==typeof r;switch(n=arguments.length){case 1:!function(e,t,r){if(t)e.call(r);else for(var n=e.length,i=g(e,n),a=0;a<n;++a)i[a].call(r)}(r,c,this);break;case 2:!function(e,t,r,n){if(t)e.call(r,n);else for(var i=e.length,a=g(e,i),s=0;s<i;++s)a[s].call(r,n)}(r,c,this,arguments[1]);break;case 3:!function(e,t,r,n,i){if(t)e.call(r,n,i);else for(var a=e.length,s=g(e,a),o=0;o<a;++o)s[o].call(r,n,i)}(r,c,this,arguments[1],arguments[2]);break;case 4:!function(e,t,r,n,i,a){if(t)e.call(r,n,i,a);else for(var s=e.length,o=g(e,s),l=0;l<s;++l)o[l].call(r,n,i,a)}(r,c,this,arguments[1],arguments[2],arguments[3]);break;default:for(i=new Array(n-1),a=1;a<n;a++)i[a-1]=arguments[a];!function(e,t,r,n){if(t)e.apply(r,n);else for(var i=e.length,a=g(e,i),s=0;s<i;++s)a[s].apply(r,n)}(r,c,this,i)}return!0},s.prototype.on=s.prototype.addListener=function(e,t){return h(this,e,t,!1)},s.prototype.prependListener=function(e,t){return h(this,e,t,!0)},s.prototype.once=function(e,t){if("function"!=typeof t)throw new TypeError('"listener" argument must be a function');return this.on(e,d(this,e,t)),this},s.prototype.prependOnceListener=function(e,t){if("function"!=typeof t)throw new TypeError('"listener" argument must be a function');return this.prependListener(e,d(this,e,t)),this},s.prototype.removeListener=function(e,t){var r,i,a,s,o;if("function"!=typeof t)throw new TypeError('"listener" argument must be a function');if(!(i=this._events))return this;if(!(r=i[e]))return this;if(r===t||r.listener===t)0==--this._eventsCount?this._events=n(null):(delete i[e],i.removeListener&&this.emit("removeListener",e,r.listener||t));else if("function"!=typeof r){for(a=-1,s=r.length-1;0<=s;s--)if(r[s]===t||r[s].listener===t){o=r[s].listener,a=s;break}if(a<0)return this;0===a?r.shift():function(e,t){for(var r=t,n=r+1,i=e.length;n<i;r+=1,n+=1)e[r]=e[n];e.pop()}(r,a),1===r.length&&(i[e]=r[0]),i.removeListener&&this.emit("removeListener",e,o||t)}return this},s.prototype.removeAllListeners=function(e){var t,r,a;if(!(r=this._events))return this;if(!r.removeListener)return 0===arguments.length?(this._events=n(null),this._eventsCount=0):r[e]&&(0==--this._eventsCount?this._events=n(null):delete r[e]),this;if(0===arguments.length){var s,o=i(r);for(a=0;a<o.length;++a)"removeListener"!==(s=o[a])&&this.removeAllListeners(s);return this.removeAllListeners("removeListener"),this._events=n(null),this._eventsCount=0,this}if("function"==typeof(t=r[e]))this.removeListener(e,t);else if(t)for(a=t.length-1;0<=a;a--)this.removeListener(e,t[a]);return this},s.prototype.listeners=function(e){return p(this,e,!0)},s.prototype.rawListeners=function(e){return p(this,e,!1)},s.listenerCount=function(e,t){return"function"==typeof e.listenerCount?e.listenerCount(t):m.call(e,t)},s.prototype.listenerCount=m,s.prototype.eventNames=function(){return 0<this._eventsCount?Reflect.ownKeys(this._events):[]}},{}],103:[function(e,t,r){(function(e){!function(n){var i="object"==_typeof(r)&&r,a="object"==_typeof(t)&&t&&t.exports==i&&t,s="object"==_typeof(e)&&e;s.global!==s&&s.window!==s||(n=s);var o=/[\uD800-\uDBFF][\uDC00-\uDFFF]/g,l=/[\x01-\x7F]/g,c=/[\x01-\t\x0B\f\x0E-\x1F\x7F\x81\x8D\x8F\x90\x9D\xA0-\uFFFF]/g,u=/<\u20D2|=\u20E5|>\u20D2|\u205F\u200A|\u219D\u0338|\u2202\u0338|\u2220\u20D2|\u2229\uFE00|\u222A\uFE00|\u223C\u20D2|\u223D\u0331|\u223E\u0333|\u2242\u0338|\u224B\u0338|\u224D\u20D2|\u224E\u0338|\u224F\u0338|\u2250\u0338|\u2261\u20E5|\u2264\u20D2|\u2265\u20D2|\u2266\u0338|\u2267\u0338|\u2268\uFE00|\u2269\uFE00|\u226A\u0338|\u226A\u20D2|\u226B\u0338|\u226B\u20D2|\u227F\u0338|\u2282\u20D2|\u2283\u20D2|\u228A\uFE00|\u228B\uFE00|\u228F\u0338|\u2290\u0338|\u2293\uFE00|\u2294\uFE00|\u22B4\u20D2|\u22B5\u20D2|\u22D8\u0338|\u22D9\u0338|\u22DA\uFE00|\u22DB\uFE00|\u22F5\u0338|\u22F9\u0338|\u2933\u0338|\u29CF\u0338|\u29D0\u0338|\u2A6D\u0338|\u2A70\u0338|\u2A7D\u0338|\u2A7E\u0338|\u2AA1\u0338|\u2AA2\u0338|\u2AAC\uFE00|\u2AAD\uFE00|\u2AAF\u0338|\u2AB0\u0338|\u2AC5\u0338|\u2AC6\u0338|\u2ACB\uFE00|\u2ACC\uFE00|\u2AFD\u20E5|[\xA0-\u0113\u0116-\u0122\u0124-\u012B\u012E-\u014D\u0150-\u017E\u0192\u01B5\u01F5\u0237\u02C6\u02C7\u02D8-\u02DD\u0311\u0391-\u03A1\u03A3-\u03A9\u03B1-\u03C9\u03D1\u03D2\u03D5\u03D6\u03DC\u03DD\u03F0\u03F1\u03F5\u03F6\u0401-\u040C\u040E-\u044F\u0451-\u045C\u045E\u045F\u2002-\u2005\u2007-\u2010\u2013-\u2016\u2018-\u201A\u201C-\u201E\u2020-\u2022\u2025\u2026\u2030-\u2035\u2039\u203A\u203E\u2041\u2043\u2044\u204F\u2057\u205F-\u2063\u20AC\u20DB\u20DC\u2102\u2105\u210A-\u2113\u2115-\u211E\u2122\u2124\u2127-\u2129\u212C\u212D\u212F-\u2131\u2133-\u2138\u2145-\u2148\u2153-\u215E\u2190-\u219B\u219D-\u21A7\u21A9-\u21AE\u21B0-\u21B3\u21B5-\u21B7\u21BA-\u21DB\u21DD\u21E4\u21E5\u21F5\u21FD-\u2205\u2207-\u2209\u220B\u220C\u220F-\u2214\u2216-\u2218\u221A\u221D-\u2238\u223A-\u2257\u2259\u225A\u225C\u225F-\u2262\u2264-\u228B\u228D-\u229B\u229D-\u22A5\u22A7-\u22B0\u22B2-\u22BB\u22BD-\u22DB\u22DE-\u22E3\u22E6-\u22F7\u22F9-\u22FE\u2305\u2306\u2308-\u2310\u2312\u2313\u2315\u2316\u231C-\u231F\u2322\u2323\u232D\u232E\u2336\u233D\u233F\u237C\u23B0\u23B1\u23B4-\u23B6\u23DC-\u23DF\u23E2\u23E7\u2423\u24C8\u2500\u2502\u250C\u2510\u2514\u2518\u251C\u2524\u252C\u2534\u253C\u2550-\u256C\u2580\u2584\u2588\u2591-\u2593\u25A1\u25AA\u25AB\u25AD\u25AE\u25B1\u25B3-\u25B5\u25B8\u25B9\u25BD-\u25BF\u25C2\u25C3\u25CA\u25CB\u25EC\u25EF\u25F8-\u25FC\u2605\u2606\u260E\u2640\u2642\u2660\u2663\u2665\u2666\u266A\u266D-\u266F\u2713\u2717\u2720\u2736\u2758\u2772\u2773\u27C8\u27C9\u27E6-\u27ED\u27F5-\u27FA\u27FC\u27FF\u2902-\u2905\u290C-\u2913\u2916\u2919-\u2920\u2923-\u292A\u2933\u2935-\u2939\u293C\u293D\u2945\u2948-\u294B\u294E-\u2976\u2978\u2979\u297B-\u297F\u2985\u2986\u298B-\u2996\u299A\u299C\u299D\u29A4-\u29B7\u29B9\u29BB\u29BC\u29BE-\u29C5\u29C9\u29CD-\u29D0\u29DC-\u29DE\u29E3-\u29E5\u29EB\u29F4\u29F6\u2A00-\u2A02\u2A04\u2A06\u2A0C\u2A0D\u2A10-\u2A17\u2A22-\u2A27\u2A29\u2A2A\u2A2D-\u2A31\u2A33-\u2A3C\u2A3F\u2A40\u2A42-\u2A4D\u2A50\u2A53-\u2A58\u2A5A-\u2A5D\u2A5F\u2A66\u2A6A\u2A6D-\u2A75\u2A77-\u2A9A\u2A9D-\u2AA2\u2AA4-\u2AB0\u2AB3-\u2AC8\u2ACB\u2ACC\u2ACF-\u2ADB\u2AE4\u2AE6-\u2AE9\u2AEB-\u2AF3\u2AFD\uFB00-\uFB04]|\uD835[\uDC9C\uDC9E\uDC9F\uDCA2\uDCA5\uDCA6\uDCA9-\uDCAC\uDCAE-\uDCB9\uDCBB\uDCBD-\uDCC3\uDCC5-\uDCCF\uDD04\uDD05\uDD07-\uDD0A\uDD0D-\uDD14\uDD16-\uDD1C\uDD1E-\uDD39\uDD3B-\uDD3E\uDD40-\uDD44\uDD46\uDD4A-\uDD50\uDD52-\uDD6B]/g,h={"­":"shy","‌":"zwnj","‍":"zwj","‎":"lrm","⁣":"ic","⁢":"it","⁡":"af","‏":"rlm","​":"ZeroWidthSpace","⁠":"NoBreak","̑":"DownBreve","⃛":"tdot","⃜":"DotDot","\t":"Tab","\n":"NewLine"," ":"puncsp"," ":"MediumSpace"," ":"thinsp"," ":"hairsp"," ":"emsp13"," ":"ensp"," ":"emsp14"," ":"emsp"," ":"numsp"," ":"nbsp","  ":"ThickSpace","‾":"oline",_:"lowbar","‐":"dash","–":"ndash","—":"mdash","―":"horbar",",":"comma",";":"semi","⁏":"bsemi",":":"colon","⩴":"Colone","!":"excl","¡":"iexcl","?":"quest","¿":"iquest",".":"period","‥":"nldr","…":"mldr","·":"middot","'":"apos","‘":"lsquo","’":"rsquo","‚":"sbquo","‹":"lsaquo","›":"rsaquo",'"':"quot","“":"ldquo","”":"rdquo","„":"bdquo","«":"laquo","»":"raquo","(":"lpar",")":"rpar","[":"lsqb","]":"rsqb","{":"lcub","}":"rcub","⌈":"lceil","⌉":"rceil","⌊":"lfloor","⌋":"rfloor","⦅":"lopar","⦆":"ropar","⦋":"lbrke","⦌":"rbrke","⦍":"lbrkslu","⦎":"rbrksld","⦏":"lbrksld","⦐":"rbrkslu","⦑":"langd","⦒":"rangd","⦓":"lparlt","⦔":"rpargt","⦕":"gtlPar","⦖":"ltrPar","⟦":"lobrk","⟧":"robrk","⟨":"lang","⟩":"rang","⟪":"Lang","⟫":"Rang","⟬":"loang","⟭":"roang","❲":"lbbrk","❳":"rbbrk","‖":"Vert","§":"sect","¶":"para","@":"commat","*":"ast","/":"sol",undefined:null,"&":"amp","#":"num","%":"percnt","‰":"permil","‱":"pertenk","†":"dagger","‡":"Dagger","•":"bull","⁃":"hybull","′":"prime","″":"Prime","‴":"tprime","⁗":"qprime","‵":"bprime","⁁":"caret","`":"grave","´":"acute","˜":"tilde","^":"Hat","¯":"macr","˘":"breve","˙":"dot","¨":"die","˚":"ring","˝":"dblac","¸":"cedil","˛":"ogon","ˆ":"circ","ˇ":"caron","°":"deg","©":"copy","®":"reg","℗":"copysr","℘":"wp","℞":"rx","℧":"mho","℩":"iiota","←":"larr","↚":"nlarr","→":"rarr","↛":"nrarr","↑":"uarr","↓":"darr","↔":"harr","↮":"nharr","↕":"varr","↖":"nwarr","↗":"nearr","↘":"searr","↙":"swarr","↝":"rarrw","↝̸":"nrarrw","↞":"Larr","↟":"Uarr","↠":"Rarr","↡":"Darr","↢":"larrtl","↣":"rarrtl","↤":"mapstoleft","↥":"mapstoup","↦":"map","↧":"mapstodown","↩":"larrhk","↪":"rarrhk","↫":"larrlp","↬":"rarrlp","↭":"harrw","↰":"lsh","↱":"rsh","↲":"ldsh","↳":"rdsh","↵":"crarr","↶":"cularr","↷":"curarr","↺":"olarr","↻":"orarr","↼":"lharu","↽":"lhard","↾":"uharr","↿":"uharl","⇀":"rharu","⇁":"rhard","⇂":"dharr","⇃":"dharl","⇄":"rlarr","⇅":"udarr","⇆":"lrarr","⇇":"llarr","⇈":"uuarr","⇉":"rrarr","⇊":"ddarr","⇋":"lrhar","⇌":"rlhar","⇐":"lArr","⇍":"nlArr","⇑":"uArr","⇒":"rArr","⇏":"nrArr","⇓":"dArr","⇔":"iff","⇎":"nhArr","⇕":"vArr","⇖":"nwArr","⇗":"neArr","⇘":"seArr","⇙":"swArr","⇚":"lAarr","⇛":"rAarr","⇝":"zigrarr","⇤":"larrb","⇥":"rarrb","⇵":"duarr","⇽":"loarr","⇾":"roarr","⇿":"hoarr","∀":"forall","∁":"comp","∂":"part","∂̸":"npart","∃":"exist","∄":"nexist","∅":"empty","∇":"Del","∈":"in","∉":"notin","∋":"ni","∌":"notni","϶":"bepsi","∏":"prod","∐":"coprod","∑":"sum","+":"plus","±":"pm","÷":"div","×":"times","<":"lt","≮":"nlt","<⃒":"nvlt","=":"equals","≠":"ne","=⃥":"bne","⩵":"Equal",">":"gt","≯":"ngt",">⃒":"nvgt","¬":"not","|":"vert","¦":"brvbar","−":"minus","∓":"mp","∔":"plusdo","⁄":"frasl","∖":"setmn","∗":"lowast","∘":"compfn","√":"Sqrt","∝":"prop","∞":"infin","∟":"angrt","∠":"ang","∠⃒":"nang","∡":"angmsd","∢":"angsph","∣":"mid","∤":"nmid","∥":"par","∦":"npar","∧":"and","∨":"or","∩":"cap","∩︀":"caps","∪":"cup","∪︀":"cups","∫":"int","∬":"Int","∭":"tint","⨌":"qint","∮":"oint","∯":"Conint","∰":"Cconint","∱":"cwint","∲":"cwconint","∳":"awconint","∴":"there4","∵":"becaus","∶":"ratio","∷":"Colon","∸":"minusd","∺":"mDDot","∻":"homtht","∼":"sim","≁":"nsim","∼⃒":"nvsim","∽":"bsim","∽̱":"race","∾":"ac","∾̳":"acE","∿":"acd","≀":"wr","≂":"esim","≂̸":"nesim","≃":"sime","≄":"nsime","≅":"cong","≇":"ncong","≆":"simne","≈":"ap","≉":"nap","≊":"ape","≋":"apid","≋̸":"napid","≌":"bcong","≍":"CupCap","≭":"NotCupCap","≍⃒":"nvap","≎":"bump","≎̸":"nbump","≏":"bumpe","≏̸":"nbumpe","≐":"doteq","≐̸":"nedot","≑":"eDot","≒":"efDot","≓":"erDot","≔":"colone","≕":"ecolon","≖":"ecir","≗":"cire","≙":"wedgeq","≚":"veeeq","≜":"trie","≟":"equest","≡":"equiv","≢":"nequiv","≡⃥":"bnequiv","≤":"le","≰":"nle","≤⃒":"nvle","≥":"ge","≱":"nge","≥⃒":"nvge","≦":"lE","≦̸":"nlE","≧":"gE","≧̸":"ngE","≨︀":"lvnE","≨":"lnE","≩":"gnE","≩︀":"gvnE","≪":"ll","≪̸":"nLtv","≪⃒":"nLt","≫":"gg","≫̸":"nGtv","≫⃒":"nGt","≬":"twixt","≲":"lsim","≴":"nlsim","≳":"gsim","≵":"ngsim","≶":"lg","≸":"ntlg","≷":"gl","≹":"ntgl","≺":"pr","⊀":"npr","≻":"sc","⊁":"nsc","≼":"prcue","⋠":"nprcue","≽":"sccue","⋡":"nsccue","≾":"prsim","≿":"scsim","≿̸":"NotSucceedsTilde","⊂":"sub","⊄":"nsub","⊂⃒":"vnsub","⊃":"sup","⊅":"nsup","⊃⃒":"vnsup","⊆":"sube","⊈":"nsube","⊇":"supe","⊉":"nsupe","⊊︀":"vsubne","⊊":"subne","⊋︀":"vsupne","⊋":"supne","⊍":"cupdot","⊎":"uplus","⊏":"sqsub","⊏̸":"NotSquareSubset","⊐":"sqsup","⊐̸":"NotSquareSuperset","⊑":"sqsube","⋢":"nsqsube","⊒":"sqsupe","⋣":"nsqsupe","⊓":"sqcap","⊓︀":"sqcaps","⊔":"sqcup","⊔︀":"sqcups","⊕":"oplus","⊖":"ominus","⊗":"otimes","⊘":"osol","⊙":"odot","⊚":"ocir","⊛":"oast","⊝":"odash","⊞":"plusb","⊟":"minusb","⊠":"timesb","⊡":"sdotb","⊢":"vdash","⊬":"nvdash","⊣":"dashv","⊤":"top","⊥":"bot","⊧":"models","⊨":"vDash","⊭":"nvDash","⊩":"Vdash","⊮":"nVdash","⊪":"Vvdash","⊫":"VDash","⊯":"nVDash","⊰":"prurel","⊲":"vltri","⋪":"nltri","⊳":"vrtri","⋫":"nrtri","⊴":"ltrie","⋬":"nltrie","⊴⃒":"nvltrie","⊵":"rtrie","⋭":"nrtrie","⊵⃒":"nvrtrie","⊶":"origof","⊷":"imof","⊸":"mumap","⊹":"hercon","⊺":"intcal","⊻":"veebar","⊽":"barvee","⊾":"angrtvb","⊿":"lrtri","⋀":"Wedge","⋁":"Vee","⋂":"xcap","⋃":"xcup","⋄":"diam","⋅":"sdot","⋆":"Star","⋇":"divonx","⋈":"bowtie","⋉":"ltimes","⋊":"rtimes","⋋":"lthree","⋌":"rthree","⋍":"bsime","⋎":"cuvee","⋏":"cuwed","⋐":"Sub","⋑":"Sup","⋒":"Cap","⋓":"Cup","⋔":"fork","⋕":"epar","⋖":"ltdot","⋗":"gtdot","⋘":"Ll","⋘̸":"nLl","⋙":"Gg","⋙̸":"nGg","⋚︀":"lesg","⋚":"leg","⋛":"gel","⋛︀":"gesl","⋞":"cuepr","⋟":"cuesc","⋦":"lnsim","⋧":"gnsim","⋨":"prnsim","⋩":"scnsim","⋮":"vellip","⋯":"ctdot","⋰":"utdot","⋱":"dtdot","⋲":"disin","⋳":"isinsv","⋴":"isins","⋵":"isindot","⋵̸":"notindot","⋶":"notinvc","⋷":"notinvb","⋹":"isinE","⋹̸":"notinE","⋺":"nisd","⋻":"xnis","⋼":"nis","⋽":"notnivc","⋾":"notnivb","⌅":"barwed","⌆":"Barwed","⌌":"drcrop","⌍":"dlcrop","⌎":"urcrop","⌏":"ulcrop","⌐":"bnot","⌒":"profline","⌓":"profsurf","⌕":"telrec","⌖":"target","⌜":"ulcorn","⌝":"urcorn","⌞":"dlcorn","⌟":"drcorn","⌢":"frown","⌣":"smile","⌭":"cylcty","⌮":"profalar","⌶":"topbot","⌽":"ovbar","⌿":"solbar","⍼":"angzarr","⎰":"lmoust","⎱":"rmoust","⎴":"tbrk","⎵":"bbrk","⎶":"bbrktbrk","⏜":"OverParenthesis","⏝":"UnderParenthesis","⏞":"OverBrace","⏟":"UnderBrace","⏢":"trpezium","⏧":"elinters","␣":"blank","─":"boxh","│":"boxv","┌":"boxdr","┐":"boxdl","└":"boxur","┘":"boxul","├":"boxvr","┤":"boxvl","┬":"boxhd","┴":"boxhu","┼":"boxvh","═":"boxH","║":"boxV","╒":"boxdR","╓":"boxDr","╔":"boxDR","╕":"boxdL","╖":"boxDl","╗":"boxDL","╘":"boxuR","╙":"boxUr","╚":"boxUR","╛":"boxuL","╜":"boxUl","╝":"boxUL","╞":"boxvR","╟":"boxVr","╠":"boxVR","╡":"boxvL","╢":"boxVl","╣":"boxVL","╤":"boxHd","╥":"boxhD","╦":"boxHD","╧":"boxHu","╨":"boxhU","╩":"boxHU","╪":"boxvH","╫":"boxVh","╬":"boxVH","▀":"uhblk","▄":"lhblk","█":"block","░":"blk14","▒":"blk12","▓":"blk34","□":"squ","▪":"squf","▫":"EmptyVerySmallSquare","▭":"rect","▮":"marker","▱":"fltns","△":"xutri","▴":"utrif","▵":"utri","▸":"rtrif","▹":"rtri","▽":"xdtri","▾":"dtrif","▿":"dtri","◂":"ltrif","◃":"ltri","◊":"loz","○":"cir","◬":"tridot","◯":"xcirc","◸":"ultri","◹":"urtri","◺":"lltri","◻":"EmptySmallSquare","◼":"FilledSmallSquare","★":"starf","☆":"star","☎":"phone","♀":"female","♂":"male","♠":"spades","♣":"clubs","♥":"hearts","♦":"diams","♪":"sung","✓":"check","✗":"cross","✠":"malt","✶":"sext","❘":"VerticalSeparator","⟈":"bsolhsub","⟉":"suphsol","⟵":"xlarr","⟶":"xrarr","⟷":"xharr","⟸":"xlArr","⟹":"xrArr","⟺":"xhArr","⟼":"xmap","⟿":"dzigrarr","⤂":"nvlArr","⤃":"nvrArr","⤄":"nvHarr","⤅":"Map","⤌":"lbarr","⤍":"rbarr","⤎":"lBarr","⤏":"rBarr","⤐":"RBarr","⤑":"DDotrahd","⤒":"UpArrowBar","⤓":"DownArrowBar","⤖":"Rarrtl","⤙":"latail","⤚":"ratail","⤛":"lAtail","⤜":"rAtail","⤝":"larrfs","⤞":"rarrfs","⤟":"larrbfs","⤠":"rarrbfs","⤣":"nwarhk","⤤":"nearhk","⤥":"searhk","⤦":"swarhk","⤧":"nwnear","⤨":"toea","⤩":"tosa","⤪":"swnwar","⤳":"rarrc","⤳̸":"nrarrc","⤵":"cudarrr","⤶":"ldca","⤷":"rdca","⤸":"cudarrl","⤹":"larrpl","⤼":"curarrm","⤽":"cularrp","⥅":"rarrpl","⥈":"harrcir","⥉":"Uarrocir","⥊":"lurdshar","⥋":"ldrushar","⥎":"LeftRightVector","⥏":"RightUpDownVector","⥐":"DownLeftRightVector","⥑":"LeftUpDownVector","⥒":"LeftVectorBar","⥓":"RightVectorBar","⥔":"RightUpVectorBar","⥕":"RightDownVectorBar","⥖":"DownLeftVectorBar","⥗":"DownRightVectorBar","⥘":"LeftUpVectorBar","⥙":"LeftDownVectorBar","⥚":"LeftTeeVector","⥛":"RightTeeVector","⥜":"RightUpTeeVector","⥝":"RightDownTeeVector","⥞":"DownLeftTeeVector","⥟":"DownRightTeeVector","⥠":"LeftUpTeeVector","⥡":"LeftDownTeeVector","⥢":"lHar","⥣":"uHar","⥤":"rHar","⥥":"dHar","⥦":"luruhar","⥧":"ldrdhar","⥨":"ruluhar","⥩":"rdldhar","⥪":"lharul","⥫":"llhard","⥬":"rharul","⥭":"lrhard","⥮":"udhar","⥯":"duhar","⥰":"RoundImplies","⥱":"erarr","⥲":"simrarr","⥳":"larrsim","⥴":"rarrsim","⥵":"rarrap","⥶":"ltlarr","⥸":"gtrarr","⥹":"subrarr","⥻":"suplarr","⥼":"lfisht","⥽":"rfisht","⥾":"ufisht","⥿":"dfisht","⦚":"vzigzag","⦜":"vangrt","⦝":"angrtvbd","⦤":"ange","⦥":"range","⦦":"dwangle","⦧":"uwangle","⦨":"angmsdaa","⦩":"angmsdab","⦪":"angmsdac","⦫":"angmsdad","⦬":"angmsdae","⦭":"angmsdaf","⦮":"angmsdag","⦯":"angmsdah","⦰":"bemptyv","⦱":"demptyv","⦲":"cemptyv","⦳":"raemptyv","⦴":"laemptyv","⦵":"ohbar","⦶":"omid","⦷":"opar","⦹":"operp","⦻":"olcross","⦼":"odsold","⦾":"olcir","⦿":"ofcir","⧀":"olt","⧁":"ogt","⧂":"cirscir","⧃":"cirE","⧄":"solb","⧅":"bsolb","⧉":"boxbox","⧍":"trisb","⧎":"rtriltri","⧏":"LeftTriangleBar","⧏̸":"NotLeftTriangleBar","⧐":"RightTriangleBar","⧐̸":"NotRightTriangleBar","⧜":"iinfin","⧝":"infintie","⧞":"nvinfin","⧣":"eparsl","⧤":"smeparsl","⧥":"eqvparsl","⧫":"lozf","⧴":"RuleDelayed","⧶":"dsol","⨀":"xodot","⨁":"xoplus","⨂":"xotime","⨄":"xuplus","⨆":"xsqcup","⨍":"fpartint","⨐":"cirfnint","⨑":"awint","⨒":"rppolint","⨓":"scpolint","⨔":"npolint","⨕":"pointint","⨖":"quatint","⨗":"intlarhk","⨢":"pluscir","⨣":"plusacir","⨤":"simplus","⨥":"plusdu","⨦":"plussim","⨧":"plustwo","⨩":"mcomma","⨪":"minusdu","⨭":"loplus","⨮":"roplus","⨯":"Cross","⨰":"timesd","⨱":"timesbar","⨳":"smashp","⨴":"lotimes","⨵":"rotimes","⨶":"otimesas","⨷":"Otimes","⨸":"odiv","⨹":"triplus","⨺":"triminus","⨻":"tritime","⨼":"iprod","⨿":"amalg","⩀":"capdot","⩂":"ncup","⩃":"ncap","⩄":"capand","⩅":"cupor","⩆":"cupcap","⩇":"capcup","⩈":"cupbrcap","⩉":"capbrcup","⩊":"cupcup","⩋":"capcap","⩌":"ccups","⩍":"ccaps","⩐":"ccupssm","⩓":"And","⩔":"Or","⩕":"andand","⩖":"oror","⩗":"orslope","⩘":"andslope","⩚":"andv","⩛":"orv","⩜":"andd","⩝":"ord","⩟":"wedbar","⩦":"sdote","⩪":"simdot","⩭":"congdot","⩭̸":"ncongdot","⩮":"easter","⩯":"apacir","⩰":"apE","⩰̸":"napE","⩱":"eplus","⩲":"pluse","⩳":"Esim","⩷":"eDDot","⩸":"equivDD","⩹":"ltcir","⩺":"gtcir","⩻":"ltquest","⩼":"gtquest","⩽":"les","⩽̸":"nles","⩾":"ges","⩾̸":"nges","⩿":"lesdot","⪀":"gesdot","⪁":"lesdoto","⪂":"gesdoto","⪃":"lesdotor","⪄":"gesdotol","⪅":"lap","⪆":"gap","⪇":"lne","⪈":"gne","⪉":"lnap","⪊":"gnap","⪋":"lEg","⪌":"gEl","⪍":"lsime","⪎":"gsime","⪏":"lsimg","⪐":"gsiml","⪑":"lgE","⪒":"glE","⪓":"lesges","⪔":"gesles","⪕":"els","⪖":"egs","⪗":"elsdot","⪘":"egsdot","⪙":"el","⪚":"eg","⪝":"siml","⪞":"simg","⪟":"simlE","⪠":"simgE","⪡":"LessLess","⪡̸":"NotNestedLessLess","⪢":"GreaterGreater","⪢̸":"NotNestedGreaterGreater","⪤":"glj","⪥":"gla","⪦":"ltcc","⪧":"gtcc","⪨":"lescc","⪩":"gescc","⪪":"smt","⪫":"lat","⪬":"smte","⪬︀":"smtes","⪭":"late","⪭︀":"lates","⪮":"bumpE","⪯":"pre","⪯̸":"npre","⪰":"sce","⪰̸":"nsce","⪳":"prE","⪴":"scE","⪵":"prnE","⪶":"scnE","⪷":"prap","⪸":"scap","⪹":"prnap","⪺":"scnap","⪻":"Pr","⪼":"Sc","⪽":"subdot","⪾":"supdot","⪿":"subplus","⫀":"supplus","⫁":"submult","⫂":"supmult","⫃":"subedot","⫄":"supedot","⫅":"subE","⫅̸":"nsubE","⫆":"supE","⫆̸":"nsupE","⫇":"subsim","⫈":"supsim","⫋︀":"vsubnE","⫋":"subnE","⫌︀":"vsupnE","⫌":"supnE","⫏":"csub","⫐":"csup","⫑":"csube","⫒":"csupe","⫓":"subsup","⫔":"supsub","⫕":"subsub","⫖":"supsup","⫗":"suphsub","⫘":"supdsub","⫙":"forkv","⫚":"topfork","⫛":"mlcp","⫤":"Dashv","⫦":"Vdashl","⫧":"Barv","⫨":"vBar","⫩":"vBarv","⫫":"Vbar","⫬":"Not","⫭":"bNot","⫮":"rnmid","⫯":"cirmid","⫰":"midcir","⫱":"topcir","⫲":"nhpar","⫳":"parsim","⫽":"parsl","⫽⃥":"nparsl","♭":"flat","♮":"natur","♯":"sharp","¤":"curren","¢":"cent",$:"dollar","£":"pound","¥":"yen","€":"euro","¹":"sup1","½":"half","⅓":"frac13","¼":"frac14","⅕":"frac15","⅙":"frac16","⅛":"frac18","²":"sup2","⅔":"frac23","⅖":"frac25","³":"sup3","¾":"frac34","⅗":"frac35","⅜":"frac38","⅘":"frac45","⅚":"frac56","⅝":"frac58","⅞":"frac78","𝒶":"ascr","𝕒":"aopf","𝔞":"afr","𝔸":"Aopf","𝔄":"Afr","𝒜":"Ascr","ª":"ordf","á":"aacute","Á":"Aacute","à":"agrave","À":"Agrave","ă":"abreve","Ă":"Abreve","â":"acirc","Â":"Acirc","å":"aring","Å":"angst","ä":"auml","Ä":"Auml","ã":"atilde","Ã":"Atilde","ą":"aogon","Ą":"Aogon","ā":"amacr","Ā":"Amacr","æ":"aelig","Æ":"AElig","𝒷":"bscr","𝕓":"bopf","𝔟":"bfr","𝔹":"Bopf","ℬ":"Bscr","𝔅":"Bfr","𝔠":"cfr","𝒸":"cscr","𝕔":"copf","ℭ":"Cfr","𝒞":"Cscr","ℂ":"Copf","ć":"cacute","Ć":"Cacute","ĉ":"ccirc","Ĉ":"Ccirc","č":"ccaron","Č":"Ccaron","ċ":"cdot","Ċ":"Cdot","ç":"ccedil","Ç":"Ccedil","℅":"incare","𝔡":"dfr","ⅆ":"dd","𝕕":"dopf","𝒹":"dscr","𝒟":"Dscr","𝔇":"Dfr","ⅅ":"DD","𝔻":"Dopf","ď":"dcaron","Ď":"Dcaron","đ":"dstrok","Đ":"Dstrok","ð":"eth","Ð":"ETH","ⅇ":"ee","ℯ":"escr","𝔢":"efr","𝕖":"eopf","ℰ":"Escr","𝔈":"Efr","𝔼":"Eopf","é":"eacute","É":"Eacute","è":"egrave","È":"Egrave","ê":"ecirc","Ê":"Ecirc","ě":"ecaron","Ě":"Ecaron","ë":"euml","Ë":"Euml","ė":"edot","Ė":"Edot","ę":"eogon","Ę":"Eogon","ē":"emacr","Ē":"Emacr","𝔣":"ffr","𝕗":"fopf","𝒻":"fscr","𝔉":"Ffr","𝔽":"Fopf","ℱ":"Fscr","ﬀ":"fflig","ﬃ":"ffilig","ﬄ":"ffllig","ﬁ":"filig",fj:"fjlig","ﬂ":"fllig","ƒ":"fnof","ℊ":"gscr","𝕘":"gopf","𝔤":"gfr","𝒢":"Gscr","𝔾":"Gopf","𝔊":"Gfr","ǵ":"gacute","ğ":"gbreve","Ğ":"Gbreve","ĝ":"gcirc","Ĝ":"Gcirc","ġ":"gdot","Ġ":"Gdot","Ģ":"Gcedil","𝔥":"hfr","ℎ":"planckh","𝒽":"hscr","𝕙":"hopf","ℋ":"Hscr","ℌ":"Hfr","ℍ":"Hopf","ĥ":"hcirc","Ĥ":"Hcirc","ℏ":"hbar","ħ":"hstrok","Ħ":"Hstrok","𝕚":"iopf","𝔦":"ifr","𝒾":"iscr","ⅈ":"ii","𝕀":"Iopf","ℐ":"Iscr","ℑ":"Im","í":"iacute","Í":"Iacute","ì":"igrave","Ì":"Igrave","î":"icirc","Î":"Icirc","ï":"iuml","Ï":"Iuml","ĩ":"itilde","Ĩ":"Itilde","İ":"Idot","į":"iogon","Į":"Iogon","ī":"imacr","Ī":"Imacr","ĳ":"ijlig","Ĳ":"IJlig","ı":"imath","𝒿":"jscr","𝕛":"jopf","𝔧":"jfr","𝒥":"Jscr","𝔍":"Jfr","𝕁":"Jopf","ĵ":"jcirc","Ĵ":"Jcirc","ȷ":"jmath","𝕜":"kopf","𝓀":"kscr","𝔨":"kfr","𝒦":"Kscr","𝕂":"Kopf","𝔎":"Kfr","ķ":"kcedil","Ķ":"Kcedil","𝔩":"lfr","𝓁":"lscr","ℓ":"ell","𝕝":"lopf","ℒ":"Lscr","𝔏":"Lfr","𝕃":"Lopf","ĺ":"lacute","Ĺ":"Lacute","ľ":"lcaron","Ľ":"Lcaron","ļ":"lcedil","Ļ":"Lcedil","ł":"lstrok","Ł":"Lstrok","ŀ":"lmidot","Ŀ":"Lmidot","𝔪":"mfr","𝕞":"mopf","𝓂":"mscr","𝔐":"Mfr","𝕄":"Mopf","ℳ":"Mscr","𝔫":"nfr","𝕟":"nopf","𝓃":"nscr","ℕ":"Nopf","𝒩":"Nscr","𝔑":"Nfr","ń":"nacute","Ń":"Nacute","ň":"ncaron","Ň":"Ncaron","ñ":"ntilde","Ñ":"Ntilde","ņ":"ncedil","Ņ":"Ncedil","№":"numero","ŋ":"eng","Ŋ":"ENG","𝕠":"oopf","𝔬":"ofr","ℴ":"oscr","𝒪":"Oscr","𝔒":"Ofr","𝕆":"Oopf","º":"ordm","ó":"oacute","Ó":"Oacute","ò":"ograve","Ò":"Ograve","ô":"ocirc","Ô":"Ocirc","ö":"ouml","Ö":"Ouml","ő":"odblac","Ő":"Odblac","õ":"otilde","Õ":"Otilde","ø":"oslash","Ø":"Oslash","ō":"omacr","Ō":"Omacr","œ":"oelig","Œ":"OElig","𝔭":"pfr","𝓅":"pscr","𝕡":"popf","ℙ":"Popf","𝔓":"Pfr","𝒫":"Pscr","𝕢":"qopf","𝔮":"qfr","𝓆":"qscr","𝒬":"Qscr","𝔔":"Qfr","ℚ":"Qopf","ĸ":"kgreen","𝔯":"rfr","𝕣":"ropf","𝓇":"rscr","ℛ":"Rscr","ℜ":"Re","ℝ":"Ropf","ŕ":"racute","Ŕ":"Racute","ř":"rcaron","Ř":"Rcaron","ŗ":"rcedil","Ŗ":"Rcedil","𝕤":"sopf","𝓈":"sscr","𝔰":"sfr","𝕊":"Sopf","𝔖":"Sfr","𝒮":"Sscr","Ⓢ":"oS","ś":"sacute","Ś":"Sacute","ŝ":"scirc","Ŝ":"Scirc","š":"scaron","Š":"Scaron","ş":"scedil","Ş":"Scedil","ß":"szlig","𝔱":"tfr","𝓉":"tscr","𝕥":"topf","𝒯":"Tscr","𝔗":"Tfr","𝕋":"Topf","ť":"tcaron","Ť":"Tcaron","ţ":"tcedil","Ţ":"Tcedil","™":"trade","ŧ":"tstrok","Ŧ":"Tstrok","𝓊":"uscr","𝕦":"uopf","𝔲":"ufr","𝕌":"Uopf","𝔘":"Ufr","𝒰":"Uscr","ú":"uacute","Ú":"Uacute","ù":"ugrave","Ù":"Ugrave","ŭ":"ubreve","Ŭ":"Ubreve","û":"ucirc","Û":"Ucirc","ů":"uring","Ů":"Uring","ü":"uuml","Ü":"Uuml","ű":"udblac","Ű":"Udblac","ũ":"utilde","Ũ":"Utilde","ų":"uogon","Ų":"Uogon","ū":"umacr","Ū":"Umacr","𝔳":"vfr","𝕧":"vopf","𝓋":"vscr","𝔙":"Vfr","𝕍":"Vopf","𝒱":"Vscr","𝕨":"wopf","𝓌":"wscr","𝔴":"wfr","𝒲":"Wscr","𝕎":"Wopf","𝔚":"Wfr","ŵ":"wcirc","Ŵ":"Wcirc","𝔵":"xfr","𝓍":"xscr","𝕩":"xopf","𝕏":"Xopf","𝔛":"Xfr","𝒳":"Xscr","𝔶":"yfr","𝓎":"yscr","𝕪":"yopf","𝒴":"Yscr","𝔜":"Yfr","𝕐":"Yopf","ý":"yacute","Ý":"Yacute","ŷ":"ycirc","Ŷ":"Ycirc","ÿ":"yuml","Ÿ":"Yuml","𝓏":"zscr","𝔷":"zfr","𝕫":"zopf","ℨ":"Zfr","ℤ":"Zopf","𝒵":"Zscr","ź":"zacute","Ź":"Zacute","ž":"zcaron","Ž":"Zcaron","ż":"zdot","Ż":"Zdot","Ƶ":"imped","þ":"thorn","Þ":"THORN","ŉ":"napos","α":"alpha","Α":"Alpha","β":"beta","Β":"Beta","γ":"gamma","Γ":"Gamma","δ":"delta","Δ":"Delta","ε":"epsi","ϵ":"epsiv","Ε":"Epsilon","ϝ":"gammad","Ϝ":"Gammad","ζ":"zeta","Ζ":"Zeta","η":"eta","Η":"Eta","θ":"theta","ϑ":"thetav","Θ":"Theta","ι":"iota","Ι":"Iota","κ":"kappa","ϰ":"kappav","Κ":"Kappa","λ":"lambda","Λ":"Lambda","μ":"mu","µ":"micro","Μ":"Mu","ν":"nu","Ν":"Nu","ξ":"xi","Ξ":"Xi","ο":"omicron","Ο":"Omicron","π":"pi","ϖ":"piv","Π":"Pi","ρ":"rho","ϱ":"rhov","Ρ":"Rho","σ":"sigma","Σ":"Sigma","ς":"sigmaf","τ":"tau","Τ":"Tau","υ":"upsi","Υ":"Upsilon","ϒ":"Upsi","φ":"phi","ϕ":"phiv","Φ":"Phi","χ":"chi","Χ":"Chi","ψ":"psi","Ψ":"Psi","ω":"omega","Ω":"ohm","а":"acy","А":"Acy","б":"bcy","Б":"Bcy","в":"vcy","В":"Vcy","г":"gcy","Г":"Gcy","ѓ":"gjcy","Ѓ":"GJcy","д":"dcy","Д":"Dcy","ђ":"djcy","Ђ":"DJcy","е":"iecy","Е":"IEcy","ё":"iocy","Ё":"IOcy","є":"jukcy","Є":"Jukcy","ж":"zhcy","Ж":"ZHcy","з":"zcy","З":"Zcy","ѕ":"dscy","Ѕ":"DScy","и":"icy","И":"Icy","і":"iukcy","І":"Iukcy","ї":"yicy","Ї":"YIcy","й":"jcy","Й":"Jcy","ј":"jsercy","Ј":"Jsercy","к":"kcy","К":"Kcy","ќ":"kjcy","Ќ":"KJcy","л":"lcy","Л":"Lcy","љ":"ljcy","Љ":"LJcy","м":"mcy","М":"Mcy","н":"ncy","Н":"Ncy","њ":"njcy","Њ":"NJcy","о":"ocy","О":"Ocy","п":"pcy","П":"Pcy","р":"rcy","Р":"Rcy","с":"scy","С":"Scy","т":"tcy","Т":"Tcy","ћ":"tshcy","Ћ":"TSHcy","у":"ucy","У":"Ucy","ў":"ubrcy","Ў":"Ubrcy","ф":"fcy","Ф":"Fcy","х":"khcy","Х":"KHcy","ц":"tscy","Ц":"TScy","ч":"chcy","Ч":"CHcy","џ":"dzcy","Џ":"DZcy","ш":"shcy","Ш":"SHcy","щ":"shchcy","Щ":"SHCHcy","ъ":"hardcy","Ъ":"HARDcy","ы":"ycy","Ы":"Ycy","ь":"softcy","Ь":"SOFTcy","э":"ecy","Э":"Ecy","ю":"yucy","Ю":"YUcy","я":"yacy","Я":"YAcy","ℵ":"aleph","ℶ":"beth","ℷ":"gimel","ℸ":"daleth"},f=/["&'<>`]/g,d={'"':"&quot;","&":"&amp;","'":"&#x27;","<":"&lt;",">":"&gt;","`":"&#x60;"},p=/&#(?:[xX][^a-fA-F0-9]|[^0-9xX])/,m=/[\0-\x08\x0B\x0E-\x1F\x7F-\x9F\uFDD0-\uFDEF\uFFFE\uFFFF]|[\uD83F\uD87F\uD8BF\uD8FF\uD93F\uD97F\uD9BF\uD9FF\uDA3F\uDA7F\uDABF\uDAFF\uDB3F\uDB7F\uDBBF\uDBFF][\uDFFE\uDFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF]/,g=/&(CounterClockwiseContourIntegral|DoubleLongLeftRightArrow|ClockwiseContourIntegral|NotNestedGreaterGreater|NotSquareSupersetEqual|DiacriticalDoubleAcute|NotRightTriangleEqual|NotSucceedsSlantEqual|NotPrecedesSlantEqual|CloseCurlyDoubleQuote|NegativeVeryThinSpace|DoubleContourIntegral|FilledVerySmallSquare|CapitalDifferentialD|OpenCurlyDoubleQuote|EmptyVerySmallSquare|NestedGreaterGreater|DoubleLongRightArrow|NotLeftTriangleEqual|NotGreaterSlantEqual|ReverseUpEquilibrium|DoubleLeftRightArrow|NotSquareSubsetEqual|NotDoubleVerticalBar|RightArrowLeftArrow|NotGreaterFullEqual|NotRightTriangleBar|SquareSupersetEqual|DownLeftRightVector|DoubleLongLeftArrow|leftrightsquigarrow|LeftArrowRightArrow|NegativeMediumSpace|blacktriangleright|RightDownVectorBar|PrecedesSlantEqual|RightDoubleBracket|SucceedsSlantEqual|NotLeftTriangleBar|RightTriangleEqual|SquareIntersection|RightDownTeeVector|ReverseEquilibrium|NegativeThickSpace|longleftrightarrow|Longleftrightarrow|LongLeftRightArrow|DownRightTeeVector|DownRightVectorBar|GreaterSlantEqual|SquareSubsetEqual|LeftDownVectorBar|LeftDoubleBracket|VerticalSeparator|rightleftharpoons|NotGreaterGreater|NotSquareSuperset|blacktriangleleft|blacktriangledown|NegativeThinSpace|LeftDownTeeVector|NotLessSlantEqual|leftrightharpoons|DoubleUpDownArrow|DoubleVerticalBar|LeftTriangleEqual|FilledSmallSquare|twoheadrightarrow|NotNestedLessLess|DownLeftTeeVector|DownLeftVectorBar|RightAngleBracket|NotTildeFullEqual|NotReverseElement|RightUpDownVector|DiacriticalTilde|NotSucceedsTilde|circlearrowright|NotPrecedesEqual|rightharpoondown|DoubleRightArrow|NotSucceedsEqual|NonBreakingSpace|NotRightTriangle|LessEqualGreater|RightUpTeeVector|LeftAngleBracket|GreaterFullEqual|DownArrowUpArrow|RightUpVectorBar|twoheadleftarrow|GreaterEqualLess|downharpoonright|RightTriangleBar|ntrianglerighteq|NotSupersetEqual|LeftUpDownVector|DiacriticalAcute|rightrightarrows|vartriangleright|UpArrowDownArrow|DiacriticalGrave|UnderParenthesis|EmptySmallSquare|LeftUpVectorBar|leftrightarrows|DownRightVector|downharpoonleft|trianglerighteq|ShortRightArrow|OverParenthesis|DoubleLeftArrow|DoubleDownArrow|NotSquareSubset|bigtriangledown|ntrianglelefteq|UpperRightArrow|curvearrowright|vartriangleleft|NotLeftTriangle|nleftrightarrow|LowerRightArrow|NotHumpDownHump|NotGreaterTilde|rightthreetimes|LeftUpTeeVector|NotGreaterEqual|straightepsilon|LeftTriangleBar|rightsquigarrow|ContourIntegral|rightleftarrows|CloseCurlyQuote|RightDownVector|LeftRightVector|nLeftrightarrow|leftharpoondown|circlearrowleft|SquareSuperset|OpenCurlyQuote|hookrightarrow|HorizontalLine|DiacriticalDot|NotLessGreater|ntriangleright|DoubleRightTee|InvisibleComma|InvisibleTimes|LowerLeftArrow|DownLeftVector|NotSubsetEqual|curvearrowleft|trianglelefteq|NotVerticalBar|TildeFullEqual|downdownarrows|NotGreaterLess|RightTeeVector|ZeroWidthSpace|looparrowright|LongRightArrow|doublebarwedge|ShortLeftArrow|ShortDownArrow|RightVectorBar|GreaterGreater|ReverseElement|rightharpoonup|LessSlantEqual|leftthreetimes|upharpoonright|rightarrowtail|LeftDownVector|Longrightarrow|NestedLessLess|UpperLeftArrow|nshortparallel|leftleftarrows|leftrightarrow|Leftrightarrow|LeftRightArrow|longrightarrow|upharpoonleft|RightArrowBar|ApplyFunction|LeftTeeVector|leftarrowtail|NotEqualTilde|varsubsetneqq|varsupsetneqq|RightTeeArrow|SucceedsEqual|SucceedsTilde|LeftVectorBar|SupersetEqual|hookleftarrow|DifferentialD|VerticalTilde|VeryThinSpace|blacktriangle|bigtriangleup|LessFullEqual|divideontimes|leftharpoonup|UpEquilibrium|ntriangleleft|RightTriangle|measuredangle|shortparallel|longleftarrow|Longleftarrow|LongLeftArrow|DoubleLeftTee|Poincareplane|PrecedesEqual|triangleright|DoubleUpArrow|RightUpVector|fallingdotseq|looparrowleft|PrecedesTilde|NotTildeEqual|NotTildeTilde|smallsetminus|Proportional|triangleleft|triangledown|UnderBracket|NotHumpEqual|exponentiale|ExponentialE|NotLessTilde|HilbertSpace|RightCeiling|blacklozenge|varsupsetneq|HumpDownHump|GreaterEqual|VerticalLine|LeftTeeArrow|NotLessEqual|DownTeeArrow|LeftTriangle|varsubsetneq|Intersection|NotCongruent|DownArrowBar|LeftUpVector|LeftArrowBar|risingdotseq|GreaterTilde|RoundImplies|SquareSubset|ShortUpArrow|NotSuperset|quaternions|precnapprox|backepsilon|preccurlyeq|OverBracket|blacksquare|MediumSpace|VerticalBar|circledcirc|circleddash|CircleMinus|CircleTimes|LessGreater|curlyeqprec|curlyeqsucc|diamondsuit|UpDownArrow|Updownarrow|RuleDelayed|Rrightarrow|updownarrow|RightVector|nRightarrow|nrightarrow|eqslantless|LeftCeiling|Equilibrium|SmallCircle|expectation|NotSucceeds|thickapprox|GreaterLess|SquareUnion|NotPrecedes|NotLessLess|straightphi|succnapprox|succcurlyeq|SubsetEqual|sqsupseteq|Proportion|Laplacetrf|ImaginaryI|supsetneqq|NotGreater|gtreqqless|NotElement|ThickSpace|TildeEqual|TildeTilde|Fouriertrf|rmoustache|EqualTilde|eqslantgtr|UnderBrace|LeftVector|UpArrowBar|nLeftarrow|nsubseteqq|subsetneqq|nsupseteqq|nleftarrow|succapprox|lessapprox|UpTeeArrow|upuparrows|curlywedge|lesseqqgtr|varepsilon|varnothing|RightFloor|complement|CirclePlus|sqsubseteq|Lleftarrow|circledast|RightArrow|Rightarrow|rightarrow|lmoustache|Bernoullis|precapprox|mapstoleft|mapstodown|longmapsto|dotsquare|downarrow|DoubleDot|nsubseteq|supsetneq|leftarrow|nsupseteq|subsetneq|ThinSpace|ngeqslant|subseteqq|HumpEqual|NotSubset|triangleq|NotCupCap|lesseqgtr|heartsuit|TripleDot|Leftarrow|Coproduct|Congruent|varpropto|complexes|gvertneqq|LeftArrow|LessTilde|supseteqq|MinusPlus|CircleDot|nleqslant|NotExists|gtreqless|nparallel|UnionPlus|LeftFloor|checkmark|CenterDot|centerdot|Mellintrf|gtrapprox|bigotimes|OverBrace|spadesuit|therefore|pitchfork|rationals|PlusMinus|Backslash|Therefore|DownBreve|backsimeq|backprime|DownArrow|nshortmid|Downarrow|lvertneqq|eqvparsl|imagline|imagpart|infintie|integers|Integral|intercal|LessLess|Uarrocir|intlarhk|sqsupset|angmsdaf|sqsubset|llcorner|vartheta|cupbrcap|lnapprox|Superset|SuchThat|succnsim|succneqq|angmsdag|biguplus|curlyvee|trpezium|Succeeds|NotTilde|bigwedge|angmsdah|angrtvbd|triminus|cwconint|fpartint|lrcorner|smeparsl|subseteq|urcorner|lurdshar|laemptyv|DDotrahd|approxeq|ldrushar|awconint|mapstoup|backcong|shortmid|triangle|geqslant|gesdotol|timesbar|circledR|circledS|setminus|multimap|naturals|scpolint|ncongdot|RightTee|boxminus|gnapprox|boxtimes|andslope|thicksim|angmsdaa|varsigma|cirfnint|rtriltri|angmsdab|rppolint|angmsdac|barwedge|drbkarow|clubsuit|thetasym|bsolhsub|capbrcup|dzigrarr|doteqdot|DotEqual|dotminus|UnderBar|NotEqual|realpart|otimesas|ulcorner|hksearow|hkswarow|parallel|PartialD|elinters|emptyset|plusacir|bbrktbrk|angmsdad|pointint|bigoplus|angmsdae|Precedes|bigsqcup|varkappa|notindot|supseteq|precneqq|precnsim|profalar|profline|profsurf|leqslant|lesdotor|raemptyv|subplus|notnivb|notnivc|subrarr|zigrarr|vzigzag|submult|subedot|Element|between|cirscir|larrbfs|larrsim|lotimes|lbrksld|lbrkslu|lozenge|ldrdhar|dbkarow|bigcirc|epsilon|simrarr|simplus|ltquest|Epsilon|luruhar|gtquest|maltese|npolint|eqcolon|npreceq|bigodot|ddagger|gtrless|bnequiv|harrcir|ddotseq|equivDD|backsim|demptyv|nsqsube|nsqsupe|Upsilon|nsubset|upsilon|minusdu|nsucceq|swarrow|nsupset|coloneq|searrow|boxplus|napprox|natural|asympeq|alefsym|congdot|nearrow|bigstar|diamond|supplus|tritime|LeftTee|nvinfin|triplus|NewLine|nvltrie|nvrtrie|nwarrow|nexists|Diamond|ruluhar|Implies|supmult|angzarr|suplarr|suphsub|questeq|because|digamma|Because|olcross|bemptyv|omicron|Omicron|rotimes|NoBreak|intprod|angrtvb|orderof|uwangle|suphsol|lesdoto|orslope|DownTee|realine|cudarrl|rdldhar|OverBar|supedot|lessdot|supdsub|topfork|succsim|rbrkslu|rbrksld|pertenk|cudarrr|isindot|planckh|lessgtr|pluscir|gesdoto|plussim|plustwo|lesssim|cularrp|rarrsim|Cayleys|notinva|notinvb|notinvc|UpArrow|Uparrow|uparrow|NotLess|dwangle|precsim|Product|curarrm|Cconint|dotplus|rarrbfs|ccupssm|Cedilla|cemptyv|notniva|quatint|frac35|frac38|frac45|frac56|frac58|frac78|tridot|xoplus|gacute|gammad|Gammad|lfisht|lfloor|bigcup|sqsupe|gbreve|Gbreve|lharul|sqsube|sqcups|Gcedil|apacir|llhard|lmidot|Lmidot|lmoust|andand|sqcaps|approx|Abreve|spades|circeq|tprime|divide|topcir|Assign|topbot|gesdot|divonx|xuplus|timesd|gesles|atilde|solbar|SOFTcy|loplus|timesb|lowast|lowbar|dlcorn|dlcrop|softcy|dollar|lparlt|thksim|lrhard|Atilde|lsaquo|smashp|bigvee|thinsp|wreath|bkarow|lsquor|lstrok|Lstrok|lthree|ltimes|ltlarr|DotDot|simdot|ltrPar|weierp|xsqcup|angmsd|sigmav|sigmaf|zeetrf|Zcaron|zcaron|mapsto|vsupne|thetav|cirmid|marker|mcomma|Zacute|vsubnE|there4|gtlPar|vsubne|bottom|gtrarr|SHCHcy|shchcy|midast|midcir|middot|minusb|minusd|gtrdot|bowtie|sfrown|mnplus|models|colone|seswar|Colone|mstpos|searhk|gtrsim|nacute|Nacute|boxbox|telrec|hairsp|Tcedil|nbumpe|scnsim|ncaron|Ncaron|ncedil|Ncedil|hamilt|Scedil|nearhk|hardcy|HARDcy|tcedil|Tcaron|commat|nequiv|nesear|tcaron|target|hearts|nexist|varrho|scedil|Scaron|scaron|hellip|Sacute|sacute|hercon|swnwar|compfn|rtimes|rthree|rsquor|rsaquo|zacute|wedgeq|homtht|barvee|barwed|Barwed|rpargt|horbar|conint|swarhk|roplus|nltrie|hslash|hstrok|Hstrok|rmoust|Conint|bprime|hybull|hyphen|iacute|Iacute|supsup|supsub|supsim|varphi|coprod|brvbar|agrave|Supset|supset|igrave|Igrave|notinE|Agrave|iiiint|iinfin|copysr|wedbar|Verbar|vangrt|becaus|incare|verbar|inodot|bullet|drcorn|intcal|drcrop|cularr|vellip|Utilde|bumpeq|cupcap|dstrok|Dstrok|CupCap|cupcup|cupdot|eacute|Eacute|supdot|iquest|easter|ecaron|Ecaron|ecolon|isinsv|utilde|itilde|Itilde|curarr|succeq|Bumpeq|cacute|ulcrop|nparsl|Cacute|nprcue|egrave|Egrave|nrarrc|nrarrw|subsup|subsub|nrtrie|jsercy|nsccue|Jsercy|kappav|kcedil|Kcedil|subsim|ulcorn|nsimeq|egsdot|veebar|kgreen|capand|elsdot|Subset|subset|curren|aacute|lacute|Lacute|emptyv|ntilde|Ntilde|lagran|lambda|Lambda|capcap|Ugrave|langle|subdot|emsp13|numero|emsp14|nvdash|nvDash|nVdash|nVDash|ugrave|ufisht|nvHarr|larrfs|nvlArr|larrhk|larrlp|larrpl|nvrArr|Udblac|nwarhk|larrtl|nwnear|oacute|Oacute|latail|lAtail|sstarf|lbrace|odblac|Odblac|lbrack|udblac|odsold|eparsl|lcaron|Lcaron|ograve|Ograve|lcedil|Lcedil|Aacute|ssmile|ssetmn|squarf|ldquor|capcup|ominus|cylcty|rharul|eqcirc|dagger|rfloor|rfisht|Dagger|daleth|equals|origof|capdot|equest|dcaron|Dcaron|rdquor|oslash|Oslash|otilde|Otilde|otimes|Otimes|urcrop|Ubreve|ubreve|Yacute|Uacute|uacute|Rcedil|rcedil|urcorn|parsim|Rcaron|Vdashl|rcaron|Tstrok|percnt|period|permil|Exists|yacute|rbrack|rbrace|phmmat|ccaron|Ccaron|planck|ccedil|plankv|tstrok|female|plusdo|plusdu|ffilig|plusmn|ffllig|Ccedil|rAtail|dfisht|bernou|ratail|Rarrtl|rarrtl|angsph|rarrpl|rarrlp|rarrhk|xwedge|xotime|forall|ForAll|Vvdash|vsupnE|preceq|bigcap|frac12|frac13|frac14|primes|rarrfs|prnsim|frac15|Square|frac16|square|lesdot|frac18|frac23|propto|prurel|rarrap|rangle|puncsp|frac25|Racute|qprime|racute|lesges|frac34|abreve|AElig|eqsim|utdot|setmn|urtri|Equal|Uring|seArr|uring|searr|dashv|Dashv|mumap|nabla|iogon|Iogon|sdote|sdotb|scsim|napid|napos|equiv|natur|Acirc|dblac|erarr|nbump|iprod|erDot|ucirc|awint|esdot|angrt|ncong|isinE|scnap|Scirc|scirc|ndash|isins|Ubrcy|nearr|neArr|isinv|nedot|ubrcy|acute|Ycirc|iukcy|Iukcy|xutri|nesim|caret|jcirc|Jcirc|caron|twixt|ddarr|sccue|exist|jmath|sbquo|ngeqq|angst|ccaps|lceil|ngsim|UpTee|delta|Delta|rtrif|nharr|nhArr|nhpar|rtrie|jukcy|Jukcy|kappa|rsquo|Kappa|nlarr|nlArr|TSHcy|rrarr|aogon|Aogon|fflig|xrarr|tshcy|ccirc|nleqq|filig|upsih|nless|dharl|nlsim|fjlig|ropar|nltri|dharr|robrk|roarr|fllig|fltns|roang|rnmid|subnE|subne|lAarr|trisb|Ccirc|acirc|ccups|blank|VDash|forkv|Vdash|langd|cedil|blk12|blk14|laquo|strns|diams|notin|vDash|larrb|blk34|block|disin|uplus|vdash|vBarv|aelig|starf|Wedge|check|xrArr|lates|lbarr|lBarr|notni|lbbrk|bcong|frasl|lbrke|frown|vrtri|vprop|vnsup|gamma|Gamma|wedge|xodot|bdquo|srarr|doteq|ldquo|boxdl|boxdL|gcirc|Gcirc|boxDl|boxDL|boxdr|boxdR|boxDr|TRADE|trade|rlhar|boxDR|vnsub|npart|vltri|rlarr|boxhd|boxhD|nprec|gescc|nrarr|nrArr|boxHd|boxHD|boxhu|boxhU|nrtri|boxHu|clubs|boxHU|times|colon|Colon|gimel|xlArr|Tilde|nsime|tilde|nsmid|nspar|THORN|thorn|xlarr|nsube|nsubE|thkap|xhArr|comma|nsucc|boxul|boxuL|nsupe|nsupE|gneqq|gnsim|boxUl|boxUL|grave|boxur|boxuR|boxUr|boxUR|lescc|angle|bepsi|boxvh|varpi|boxvH|numsp|Theta|gsime|gsiml|theta|boxVh|boxVH|boxvl|gtcir|gtdot|boxvL|boxVl|boxVL|crarr|cross|Cross|nvsim|boxvr|nwarr|nwArr|sqsup|dtdot|Uogon|lhard|lharu|dtrif|ocirc|Ocirc|lhblk|duarr|odash|sqsub|Hacek|sqcup|llarr|duhar|oelig|OElig|ofcir|boxvR|uogon|lltri|boxVr|csube|uuarr|ohbar|csupe|ctdot|olarr|olcir|harrw|oline|sqcap|omacr|Omacr|omega|Omega|boxVR|aleph|lneqq|lnsim|loang|loarr|rharu|lobrk|hcirc|operp|oplus|rhard|Hcirc|orarr|Union|order|ecirc|Ecirc|cuepr|szlig|cuesc|breve|reals|eDDot|Breve|hoarr|lopar|utrif|rdquo|Umacr|umacr|efDot|swArr|ultri|alpha|rceil|ovbar|swarr|Wcirc|wcirc|smtes|smile|bsemi|lrarr|aring|parsl|lrhar|bsime|uhblk|lrtri|cupor|Aring|uharr|uharl|slarr|rbrke|bsolb|lsime|rbbrk|RBarr|lsimg|phone|rBarr|rbarr|icirc|lsquo|Icirc|emacr|Emacr|ratio|simne|plusb|simlE|simgE|simeq|pluse|ltcir|ltdot|empty|xharr|xdtri|iexcl|Alpha|ltrie|rarrw|pound|ltrif|xcirc|bumpe|prcue|bumpE|asymp|amacr|cuvee|Sigma|sigma|iiint|udhar|iiota|ijlig|IJlig|supnE|imacr|Imacr|prime|Prime|image|prnap|eogon|Eogon|rarrc|mdash|mDDot|cuwed|imath|supne|imped|Amacr|udarr|prsim|micro|rarrb|cwint|raquo|infin|eplus|range|rangd|Ucirc|radic|minus|amalg|veeeq|rAarr|epsiv|ycirc|quest|sharp|quot|zwnj|Qscr|race|qscr|Qopf|qopf|qint|rang|Rang|Zscr|zscr|Zopf|zopf|rarr|rArr|Rarr|Pscr|pscr|prop|prod|prnE|prec|ZHcy|zhcy|prap|Zeta|zeta|Popf|popf|Zdot|plus|zdot|Yuml|yuml|phiv|YUcy|yucy|Yscr|yscr|perp|Yopf|yopf|part|para|YIcy|Ouml|rcub|yicy|YAcy|rdca|ouml|osol|Oscr|rdsh|yacy|real|oscr|xvee|andd|rect|andv|Xscr|oror|ordm|ordf|xscr|ange|aopf|Aopf|rHar|Xopf|opar|Oopf|xopf|xnis|rhov|oopf|omid|xmap|oint|apid|apos|ogon|ascr|Ascr|odot|odiv|xcup|xcap|ocir|oast|nvlt|nvle|nvgt|nvge|nvap|Wscr|wscr|auml|ntlg|ntgl|nsup|nsub|nsim|Nscr|nscr|nsce|Wopf|ring|npre|wopf|npar|Auml|Barv|bbrk|Nopf|nopf|nmid|nLtv|beta|ropf|Ropf|Beta|beth|nles|rpar|nleq|bnot|bNot|nldr|NJcy|rscr|Rscr|Vscr|vscr|rsqb|njcy|bopf|nisd|Bopf|rtri|Vopf|nGtv|ngtr|vopf|boxh|boxH|boxv|nges|ngeq|boxV|bscr|scap|Bscr|bsim|Vert|vert|bsol|bull|bump|caps|cdot|ncup|scnE|ncap|nbsp|napE|Cdot|cent|sdot|Vbar|nang|vBar|chcy|Mscr|mscr|sect|semi|CHcy|Mopf|mopf|sext|circ|cire|mldr|mlcp|cirE|comp|shcy|SHcy|vArr|varr|cong|copf|Copf|copy|COPY|malt|male|macr|lvnE|cscr|ltri|sime|ltcc|simg|Cscr|siml|csub|Uuml|lsqb|lsim|uuml|csup|Lscr|lscr|utri|smid|lpar|cups|smte|lozf|darr|Lopf|Uscr|solb|lopf|sopf|Sopf|lneq|uscr|spar|dArr|lnap|Darr|dash|Sqrt|LJcy|ljcy|lHar|dHar|Upsi|upsi|diam|lesg|djcy|DJcy|leqq|dopf|Dopf|dscr|Dscr|dscy|ldsh|ldca|squf|DScy|sscr|Sscr|dsol|lcub|late|star|Star|Uopf|Larr|lArr|larr|uopf|dtri|dzcy|sube|subE|Lang|lang|Kscr|kscr|Kopf|kopf|KJcy|kjcy|KHcy|khcy|DZcy|ecir|edot|eDot|Jscr|jscr|succ|Jopf|jopf|Edot|uHar|emsp|ensp|Iuml|iuml|eopf|isin|Iscr|iscr|Eopf|epar|sung|epsi|escr|sup1|sup2|sup3|Iota|iota|supe|supE|Iopf|iopf|IOcy|iocy|Escr|esim|Esim|imof|Uarr|QUOT|uArr|uarr|euml|IEcy|iecy|Idot|Euml|euro|excl|Hscr|hscr|Hopf|hopf|TScy|tscy|Tscr|hbar|tscr|flat|tbrk|fnof|hArr|harr|half|fopf|Fopf|tdot|gvnE|fork|trie|gtcc|fscr|Fscr|gdot|gsim|Gscr|gscr|Gopf|gopf|gneq|Gdot|tosa|gnap|Topf|topf|geqq|toea|GJcy|gjcy|tint|gesl|mid|Sfr|ggg|top|ges|gla|glE|glj|geq|gne|gEl|gel|gnE|Gcy|gcy|gap|Tfr|tfr|Tcy|tcy|Hat|Tau|Ffr|tau|Tab|hfr|Hfr|ffr|Fcy|fcy|icy|Icy|iff|ETH|eth|ifr|Ifr|Eta|eta|int|Int|Sup|sup|ucy|Ucy|Sum|sum|jcy|ENG|ufr|Ufr|eng|Jcy|jfr|els|ell|egs|Efr|efr|Jfr|uml|kcy|Kcy|Ecy|ecy|kfr|Kfr|lap|Sub|sub|lat|lcy|Lcy|leg|Dot|dot|lEg|leq|les|squ|div|die|lfr|Lfr|lgE|Dfr|dfr|Del|deg|Dcy|dcy|lne|lnE|sol|loz|smt|Cup|lrm|cup|lsh|Lsh|sim|shy|map|Map|mcy|Mcy|mfr|Mfr|mho|gfr|Gfr|sfr|cir|Chi|chi|nap|Cfr|vcy|Vcy|cfr|Scy|scy|ncy|Ncy|vee|Vee|Cap|cap|nfr|scE|sce|Nfr|nge|ngE|nGg|vfr|Vfr|ngt|bot|nGt|nis|niv|Rsh|rsh|nle|nlE|bne|Bfr|bfr|nLl|nlt|nLt|Bcy|bcy|not|Not|rlm|wfr|Wfr|npr|nsc|num|ocy|ast|Ocy|ofr|xfr|Xfr|Ofr|ogt|ohm|apE|olt|Rho|ape|rho|Rfr|rfr|ord|REG|ang|reg|orv|And|and|AMP|Rcy|amp|Afr|ycy|Ycy|yen|yfr|Yfr|rcy|par|pcy|Pcy|pfr|Pfr|phi|Phi|afr|Acy|acy|zcy|Zcy|piv|acE|acd|zfr|Zfr|pre|prE|psi|Psi|qfr|Qfr|zwj|Or|ge|Gg|gt|gg|el|oS|lt|Lt|LT|Re|lg|gl|eg|ne|Im|it|le|DD|wp|wr|nu|Nu|dd|lE|Sc|sc|pi|Pi|ee|af|ll|Ll|rx|gE|xi|pm|Xi|ic|pr|Pr|in|ni|mp|mu|ac|Mu|or|ap|Gt|GT|ii);|&(Aacute|Agrave|Atilde|Ccedil|Eacute|Egrave|Iacute|Igrave|Ntilde|Oacute|Ograve|Oslash|Otilde|Uacute|Ugrave|Yacute|aacute|agrave|atilde|brvbar|ccedil|curren|divide|eacute|egrave|frac12|frac14|frac34|iacute|igrave|iquest|middot|ntilde|oacute|ograve|oslash|otilde|plusmn|uacute|ugrave|yacute|AElig|Acirc|Aring|Ecirc|Icirc|Ocirc|THORN|Ucirc|acirc|acute|aelig|aring|cedil|ecirc|icirc|iexcl|laquo|micro|ocirc|pound|raquo|szlig|thorn|times|ucirc|Auml|COPY|Euml|Iuml|Ouml|QUOT|Uuml|auml|cent|copy|euml|iuml|macr|nbsp|ordf|ordm|ouml|para|quot|sect|sup1|sup2|sup3|uuml|yuml|AMP|ETH|REG|amp|deg|eth|not|reg|shy|uml|yen|GT|LT|gt|lt)(?!;)([=a-zA-Z0-9]?)|&#([0-9]+)(;?)|&#[xX]([a-fA-F0-9]+)(;?)|&([0-9a-zA-Z]+)/g,T={aacute:"á",Aacute:"Á",abreve:"ă",Abreve:"Ă",ac:"∾",acd:"∿",acE:"∾̳",acirc:"â",Acirc:"Â",acute:"´",acy:"а",Acy:"А",aelig:"æ",AElig:"Æ",af:"⁡",afr:"𝔞",Afr:"𝔄",agrave:"à",Agrave:"À",alefsym:"ℵ",aleph:"ℵ",alpha:"α",Alpha:"Α",amacr:"ā",Amacr:"Ā",amalg:"⨿",amp:"&",AMP:"&",and:"∧",And:"⩓",andand:"⩕",andd:"⩜",andslope:"⩘",andv:"⩚",ang:"∠",ange:"⦤",angle:"∠",angmsd:"∡",angmsdaa:"⦨",angmsdab:"⦩",angmsdac:"⦪",angmsdad:"⦫",angmsdae:"⦬",angmsdaf:"⦭",angmsdag:"⦮",angmsdah:"⦯",angrt:"∟",angrtvb:"⊾",angrtvbd:"⦝",angsph:"∢",angst:"Å",angzarr:"⍼",aogon:"ą",Aogon:"Ą",aopf:"𝕒",Aopf:"𝔸",ap:"≈",apacir:"⩯",ape:"≊",apE:"⩰",apid:"≋",apos:"'",ApplyFunction:"⁡",approx:"≈",approxeq:"≊",aring:"å",Aring:"Å",ascr:"𝒶",Ascr:"𝒜",Assign:"≔",ast:"*",asymp:"≈",asympeq:"≍",atilde:"ã",Atilde:"Ã",auml:"ä",Auml:"Ä",awconint:"∳",awint:"⨑",backcong:"≌",backepsilon:"϶",backprime:"‵",backsim:"∽",backsimeq:"⋍",Backslash:"∖",Barv:"⫧",barvee:"⊽",barwed:"⌅",Barwed:"⌆",barwedge:"⌅",bbrk:"⎵",bbrktbrk:"⎶",bcong:"≌",bcy:"б",Bcy:"Б",bdquo:"„",becaus:"∵",because:"∵",Because:"∵",bemptyv:"⦰",bepsi:"϶",bernou:"ℬ",Bernoullis:"ℬ",beta:"β",Beta:"Β",beth:"ℶ",between:"≬",bfr:"𝔟",Bfr:"𝔅",bigcap:"⋂",bigcirc:"◯",bigcup:"⋃",bigodot:"⨀",bigoplus:"⨁",bigotimes:"⨂",bigsqcup:"⨆",bigstar:"★",bigtriangledown:"▽",bigtriangleup:"△",biguplus:"⨄",bigvee:"⋁",bigwedge:"⋀",bkarow:"⤍",blacklozenge:"⧫",blacksquare:"▪",blacktriangle:"▴",blacktriangledown:"▾",blacktriangleleft:"◂",blacktriangleright:"▸",blank:"␣",blk12:"▒",blk14:"░",blk34:"▓",block:"█",bne:"=⃥",bnequiv:"≡⃥",bnot:"⌐",bNot:"⫭",bopf:"𝕓",Bopf:"𝔹",bot:"⊥",bottom:"⊥",bowtie:"⋈",boxbox:"⧉",boxdl:"┐",boxdL:"╕",boxDl:"╖",boxDL:"╗",boxdr:"┌",boxdR:"╒",boxDr:"╓",boxDR:"╔",boxh:"─",boxH:"═",boxhd:"┬",boxhD:"╥",boxHd:"╤",boxHD:"╦",boxhu:"┴",boxhU:"╨",boxHu:"╧",boxHU:"╩",boxminus:"⊟",boxplus:"⊞",boxtimes:"⊠",boxul:"┘",boxuL:"╛",boxUl:"╜",boxUL:"╝",boxur:"└",boxuR:"╘",boxUr:"╙",boxUR:"╚",boxv:"│",boxV:"║",boxvh:"┼",boxvH:"╪",boxVh:"╫",boxVH:"╬",boxvl:"┤",boxvL:"╡",boxVl:"╢",boxVL:"╣",boxvr:"├",boxvR:"╞",boxVr:"╟",boxVR:"╠",bprime:"‵",breve:"˘",Breve:"˘",brvbar:"¦",bscr:"𝒷",Bscr:"ℬ",bsemi:"⁏",bsim:"∽",bsime:"⋍",bsol:"\\",bsolb:"⧅",bsolhsub:"⟈",bull:"•",bullet:"•",bump:"≎",bumpe:"≏",bumpE:"⪮",bumpeq:"≏",Bumpeq:"≎",cacute:"ć",Cacute:"Ć",cap:"∩",Cap:"⋒",capand:"⩄",capbrcup:"⩉",capcap:"⩋",capcup:"⩇",capdot:"⩀",CapitalDifferentialD:"ⅅ",caps:"∩︀",caret:"⁁",caron:"ˇ",Cayleys:"ℭ",ccaps:"⩍",ccaron:"č",Ccaron:"Č",ccedil:"ç",Ccedil:"Ç",ccirc:"ĉ",Ccirc:"Ĉ",Cconint:"∰",ccups:"⩌",ccupssm:"⩐",cdot:"ċ",Cdot:"Ċ",cedil:"¸",Cedilla:"¸",cemptyv:"⦲",cent:"¢",centerdot:"·",CenterDot:"·",cfr:"𝔠",Cfr:"ℭ",chcy:"ч",CHcy:"Ч",check:"✓",checkmark:"✓",chi:"χ",Chi:"Χ",cir:"○",circ:"ˆ",circeq:"≗",circlearrowleft:"↺",circlearrowright:"↻",circledast:"⊛",circledcirc:"⊚",circleddash:"⊝",CircleDot:"⊙",circledR:"®",circledS:"Ⓢ",CircleMinus:"⊖",CirclePlus:"⊕",CircleTimes:"⊗",cire:"≗",cirE:"⧃",cirfnint:"⨐",cirmid:"⫯",cirscir:"⧂",ClockwiseContourIntegral:"∲",CloseCurlyDoubleQuote:"”",CloseCurlyQuote:"’",clubs:"♣",clubsuit:"♣",colon:":",Colon:"∷",colone:"≔",Colone:"⩴",coloneq:"≔",comma:",",commat:"@",comp:"∁",compfn:"∘",complement:"∁",complexes:"ℂ",cong:"≅",congdot:"⩭",Congruent:"≡",conint:"∮",Conint:"∯",ContourIntegral:"∮",copf:"𝕔",Copf:"ℂ",coprod:"∐",Coproduct:"∐",copy:"©",COPY:"©",copysr:"℗",CounterClockwiseContourIntegral:"∳",crarr:"↵",cross:"✗",Cross:"⨯",cscr:"𝒸",Cscr:"𝒞",csub:"⫏",csube:"⫑",csup:"⫐",csupe:"⫒",ctdot:"⋯",cudarrl:"⤸",cudarrr:"⤵",cuepr:"⋞",cuesc:"⋟",cularr:"↶",cularrp:"⤽",cup:"∪",Cup:"⋓",cupbrcap:"⩈",cupcap:"⩆",CupCap:"≍",cupcup:"⩊",cupdot:"⊍",cupor:"⩅",cups:"∪︀",curarr:"↷",curarrm:"⤼",curlyeqprec:"⋞",curlyeqsucc:"⋟",curlyvee:"⋎",curlywedge:"⋏",curren:"¤",curvearrowleft:"↶",curvearrowright:"↷",cuvee:"⋎",cuwed:"⋏",cwconint:"∲",cwint:"∱",cylcty:"⌭",dagger:"†",Dagger:"‡",daleth:"ℸ",darr:"↓",dArr:"⇓",Darr:"↡",dash:"‐",dashv:"⊣",Dashv:"⫤",dbkarow:"⤏",dblac:"˝",dcaron:"ď",Dcaron:"Ď",dcy:"д",Dcy:"Д",dd:"ⅆ",DD:"ⅅ",ddagger:"‡",ddarr:"⇊",DDotrahd:"⤑",ddotseq:"⩷",deg:"°",Del:"∇",delta:"δ",Delta:"Δ",demptyv:"⦱",dfisht:"⥿",dfr:"𝔡",Dfr:"𝔇",dHar:"⥥",dharl:"⇃",dharr:"⇂",DiacriticalAcute:"´",DiacriticalDot:"˙",DiacriticalDoubleAcute:"˝",DiacriticalGrave:"`",DiacriticalTilde:"˜",diam:"⋄",diamond:"⋄",Diamond:"⋄",diamondsuit:"♦",diams:"♦",die:"¨",DifferentialD:"ⅆ",digamma:"ϝ",disin:"⋲",div:"÷",divide:"÷",divideontimes:"⋇",divonx:"⋇",djcy:"ђ",DJcy:"Ђ",dlcorn:"⌞",dlcrop:"⌍",dollar:"$",dopf:"𝕕",Dopf:"𝔻",dot:"˙",Dot:"¨",DotDot:"⃜",doteq:"≐",doteqdot:"≑",DotEqual:"≐",dotminus:"∸",dotplus:"∔",dotsquare:"⊡",doublebarwedge:"⌆",DoubleContourIntegral:"∯",DoubleDot:"¨",DoubleDownArrow:"⇓",DoubleLeftArrow:"⇐",DoubleLeftRightArrow:"⇔",DoubleLeftTee:"⫤",DoubleLongLeftArrow:"⟸",DoubleLongLeftRightArrow:"⟺",DoubleLongRightArrow:"⟹",DoubleRightArrow:"⇒",DoubleRightTee:"⊨",DoubleUpArrow:"⇑",DoubleUpDownArrow:"⇕",DoubleVerticalBar:"∥",downarrow:"↓",Downarrow:"⇓",DownArrow:"↓",DownArrowBar:"⤓",DownArrowUpArrow:"⇵",DownBreve:"̑",downdownarrows:"⇊",downharpoonleft:"⇃",downharpoonright:"⇂",DownLeftRightVector:"⥐",DownLeftTeeVector:"⥞",DownLeftVector:"↽",DownLeftVectorBar:"⥖",DownRightTeeVector:"⥟",DownRightVector:"⇁",DownRightVectorBar:"⥗",DownTee:"⊤",DownTeeArrow:"↧",drbkarow:"⤐",drcorn:"⌟",drcrop:"⌌",dscr:"𝒹",Dscr:"𝒟",dscy:"ѕ",DScy:"Ѕ",dsol:"⧶",dstrok:"đ",Dstrok:"Đ",dtdot:"⋱",dtri:"▿",dtrif:"▾",duarr:"⇵",duhar:"⥯",dwangle:"⦦",dzcy:"џ",DZcy:"Џ",dzigrarr:"⟿",eacute:"é",Eacute:"É",easter:"⩮",ecaron:"ě",Ecaron:"Ě",ecir:"≖",ecirc:"ê",Ecirc:"Ê",ecolon:"≕",ecy:"э",Ecy:"Э",eDDot:"⩷",edot:"ė",eDot:"≑",Edot:"Ė",ee:"ⅇ",efDot:"≒",efr:"𝔢",Efr:"𝔈",eg:"⪚",egrave:"è",Egrave:"È",egs:"⪖",egsdot:"⪘",el:"⪙",Element:"∈",elinters:"⏧",ell:"ℓ",els:"⪕",elsdot:"⪗",emacr:"ē",Emacr:"Ē",empty:"∅",emptyset:"∅",EmptySmallSquare:"◻",emptyv:"∅",EmptyVerySmallSquare:"▫",emsp:" ",emsp13:" ",emsp14:" ",eng:"ŋ",ENG:"Ŋ",ensp:" ",eogon:"ę",Eogon:"Ę",eopf:"𝕖",Eopf:"𝔼",epar:"⋕",eparsl:"⧣",eplus:"⩱",epsi:"ε",epsilon:"ε",Epsilon:"Ε",epsiv:"ϵ",eqcirc:"≖",eqcolon:"≕",eqsim:"≂",eqslantgtr:"⪖",eqslantless:"⪕",Equal:"⩵",equals:"=",EqualTilde:"≂",equest:"≟",Equilibrium:"⇌",equiv:"≡",equivDD:"⩸",eqvparsl:"⧥",erarr:"⥱",erDot:"≓",escr:"ℯ",Escr:"ℰ",esdot:"≐",esim:"≂",Esim:"⩳",eta:"η",Eta:"Η",eth:"ð",ETH:"Ð",euml:"ë",Euml:"Ë",euro:"€",excl:"!",exist:"∃",Exists:"∃",expectation:"ℰ",exponentiale:"ⅇ",ExponentialE:"ⅇ",fallingdotseq:"≒",fcy:"ф",Fcy:"Ф",female:"♀",ffilig:"ﬃ",fflig:"ﬀ",ffllig:"ﬄ",ffr:"𝔣",Ffr:"𝔉",filig:"ﬁ",FilledSmallSquare:"◼",FilledVerySmallSquare:"▪",fjlig:"fj",flat:"♭",fllig:"ﬂ",fltns:"▱",fnof:"ƒ",fopf:"𝕗",Fopf:"𝔽",forall:"∀",ForAll:"∀",fork:"⋔",forkv:"⫙",Fouriertrf:"ℱ",fpartint:"⨍",frac12:"½",frac13:"⅓",frac14:"¼",frac15:"⅕",frac16:"⅙",frac18:"⅛",frac23:"⅔",frac25:"⅖",frac34:"¾",frac35:"⅗",frac38:"⅜",frac45:"⅘",frac56:"⅚",frac58:"⅝",frac78:"⅞",frasl:"⁄",frown:"⌢",fscr:"𝒻",Fscr:"ℱ",gacute:"ǵ",gamma:"γ",Gamma:"Γ",gammad:"ϝ",Gammad:"Ϝ",gap:"⪆",gbreve:"ğ",Gbreve:"Ğ",Gcedil:"Ģ",gcirc:"ĝ",Gcirc:"Ĝ",gcy:"г",Gcy:"Г",gdot:"ġ",Gdot:"Ġ",ge:"≥",gE:"≧",gel:"⋛",gEl:"⪌",geq:"≥",geqq:"≧",geqslant:"⩾",ges:"⩾",gescc:"⪩",gesdot:"⪀",gesdoto:"⪂",gesdotol:"⪄",gesl:"⋛︀",gesles:"⪔",gfr:"𝔤",Gfr:"𝔊",gg:"≫",Gg:"⋙",ggg:"⋙",gimel:"ℷ",gjcy:"ѓ",GJcy:"Ѓ",gl:"≷",gla:"⪥",glE:"⪒",glj:"⪤",gnap:"⪊",gnapprox:"⪊",gne:"⪈",gnE:"≩",gneq:"⪈",gneqq:"≩",gnsim:"⋧",gopf:"𝕘",Gopf:"𝔾",grave:"`",GreaterEqual:"≥",GreaterEqualLess:"⋛",GreaterFullEqual:"≧",GreaterGreater:"⪢",GreaterLess:"≷",GreaterSlantEqual:"⩾",GreaterTilde:"≳",gscr:"ℊ",Gscr:"𝒢",gsim:"≳",gsime:"⪎",gsiml:"⪐",gt:">",Gt:"≫",GT:">",gtcc:"⪧",gtcir:"⩺",gtdot:"⋗",gtlPar:"⦕",gtquest:"⩼",gtrapprox:"⪆",gtrarr:"⥸",gtrdot:"⋗",gtreqless:"⋛",gtreqqless:"⪌",gtrless:"≷",gtrsim:"≳",gvertneqq:"≩︀",gvnE:"≩︀",Hacek:"ˇ",hairsp:" ",half:"½",hamilt:"ℋ",hardcy:"ъ",HARDcy:"Ъ",harr:"↔",hArr:"⇔",harrcir:"⥈",harrw:"↭",Hat:"^",hbar:"ℏ",hcirc:"ĥ",Hcirc:"Ĥ",hearts:"♥",heartsuit:"♥",hellip:"…",hercon:"⊹",hfr:"𝔥",Hfr:"ℌ",HilbertSpace:"ℋ",hksearow:"⤥",hkswarow:"⤦",hoarr:"⇿",homtht:"∻",hookleftarrow:"↩",hookrightarrow:"↪",hopf:"𝕙",Hopf:"ℍ",horbar:"―",HorizontalLine:"─",hscr:"𝒽",Hscr:"ℋ",hslash:"ℏ",hstrok:"ħ",Hstrok:"Ħ",HumpDownHump:"≎",HumpEqual:"≏",hybull:"⁃",hyphen:"‐",iacute:"í",Iacute:"Í",ic:"⁣",icirc:"î",Icirc:"Î",icy:"и",Icy:"И",Idot:"İ",iecy:"е",IEcy:"Е",iexcl:"¡",iff:"⇔",ifr:"𝔦",Ifr:"ℑ",igrave:"ì",Igrave:"Ì",ii:"ⅈ",iiiint:"⨌",iiint:"∭",iinfin:"⧜",iiota:"℩",ijlig:"ĳ",IJlig:"Ĳ",Im:"ℑ",imacr:"ī",Imacr:"Ī",image:"ℑ",ImaginaryI:"ⅈ",imagline:"ℐ",imagpart:"ℑ",imath:"ı",imof:"⊷",imped:"Ƶ",Implies:"⇒",in:"∈",incare:"℅",infin:"∞",infintie:"⧝",inodot:"ı",int:"∫",Int:"∬",intcal:"⊺",integers:"ℤ",Integral:"∫",intercal:"⊺",Intersection:"⋂",intlarhk:"⨗",intprod:"⨼",InvisibleComma:"⁣",InvisibleTimes:"⁢",iocy:"ё",IOcy:"Ё",iogon:"į",Iogon:"Į",iopf:"𝕚",Iopf:"𝕀",iota:"ι",Iota:"Ι",iprod:"⨼",iquest:"¿",iscr:"𝒾",Iscr:"ℐ",isin:"∈",isindot:"⋵",isinE:"⋹",isins:"⋴",isinsv:"⋳",isinv:"∈",it:"⁢",itilde:"ĩ",Itilde:"Ĩ",iukcy:"і",Iukcy:"І",iuml:"ï",Iuml:"Ï",jcirc:"ĵ",Jcirc:"Ĵ",jcy:"й",Jcy:"Й",jfr:"𝔧",Jfr:"𝔍",jmath:"ȷ",jopf:"𝕛",Jopf:"𝕁",jscr:"𝒿",Jscr:"𝒥",jsercy:"ј",Jsercy:"Ј",jukcy:"є",Jukcy:"Є",kappa:"κ",Kappa:"Κ",kappav:"ϰ",kcedil:"ķ",Kcedil:"Ķ",kcy:"к",Kcy:"К",kfr:"𝔨",Kfr:"𝔎",kgreen:"ĸ",khcy:"х",KHcy:"Х",kjcy:"ќ",KJcy:"Ќ",kopf:"𝕜",Kopf:"𝕂",kscr:"𝓀",Kscr:"𝒦",lAarr:"⇚",lacute:"ĺ",Lacute:"Ĺ",laemptyv:"⦴",lagran:"ℒ",lambda:"λ",Lambda:"Λ",lang:"⟨",Lang:"⟪",langd:"⦑",langle:"⟨",lap:"⪅",Laplacetrf:"ℒ",laquo:"«",larr:"←",lArr:"⇐",Larr:"↞",larrb:"⇤",larrbfs:"⤟",larrfs:"⤝",larrhk:"↩",larrlp:"↫",larrpl:"⤹",larrsim:"⥳",larrtl:"↢",lat:"⪫",latail:"⤙",lAtail:"⤛",late:"⪭",lates:"⪭︀",lbarr:"⤌",lBarr:"⤎",lbbrk:"❲",lbrace:"{",lbrack:"[",lbrke:"⦋",lbrksld:"⦏",lbrkslu:"⦍",lcaron:"ľ",Lcaron:"Ľ",lcedil:"ļ",Lcedil:"Ļ",lceil:"⌈",lcub:"{",lcy:"л",Lcy:"Л",ldca:"⤶",ldquo:"“",ldquor:"„",ldrdhar:"⥧",ldrushar:"⥋",ldsh:"↲",le:"≤",lE:"≦",LeftAngleBracket:"⟨",leftarrow:"←",Leftarrow:"⇐",LeftArrow:"←",LeftArrowBar:"⇤",LeftArrowRightArrow:"⇆",leftarrowtail:"↢",LeftCeiling:"⌈",LeftDoubleBracket:"⟦",LeftDownTeeVector:"⥡",LeftDownVector:"⇃",LeftDownVectorBar:"⥙",LeftFloor:"⌊",leftharpoondown:"↽",leftharpoonup:"↼",leftleftarrows:"⇇",leftrightarrow:"↔",Leftrightarrow:"⇔",LeftRightArrow:"↔",leftrightarrows:"⇆",leftrightharpoons:"⇋",leftrightsquigarrow:"↭",LeftRightVector:"⥎",LeftTee:"⊣",LeftTeeArrow:"↤",LeftTeeVector:"⥚",leftthreetimes:"⋋",LeftTriangle:"⊲",LeftTriangleBar:"⧏",LeftTriangleEqual:"⊴",LeftUpDownVector:"⥑",LeftUpTeeVector:"⥠",LeftUpVector:"↿",LeftUpVectorBar:"⥘",LeftVector:"↼",LeftVectorBar:"⥒",leg:"⋚",lEg:"⪋",leq:"≤",leqq:"≦",leqslant:"⩽",les:"⩽",lescc:"⪨",lesdot:"⩿",lesdoto:"⪁",lesdotor:"⪃",lesg:"⋚︀",lesges:"⪓",lessapprox:"⪅",lessdot:"⋖",lesseqgtr:"⋚",lesseqqgtr:"⪋",LessEqualGreater:"⋚",LessFullEqual:"≦",LessGreater:"≶",lessgtr:"≶",LessLess:"⪡",lesssim:"≲",LessSlantEqual:"⩽",LessTilde:"≲",lfisht:"⥼",lfloor:"⌊",lfr:"𝔩",Lfr:"𝔏",lg:"≶",lgE:"⪑",lHar:"⥢",lhard:"↽",lharu:"↼",lharul:"⥪",lhblk:"▄",ljcy:"љ",LJcy:"Љ",ll:"≪",Ll:"⋘",llarr:"⇇",llcorner:"⌞",Lleftarrow:"⇚",llhard:"⥫",lltri:"◺",lmidot:"ŀ",Lmidot:"Ŀ",lmoust:"⎰",lmoustache:"⎰",lnap:"⪉",lnapprox:"⪉",lne:"⪇",lnE:"≨",lneq:"⪇",lneqq:"≨",lnsim:"⋦",loang:"⟬",loarr:"⇽",lobrk:"⟦",longleftarrow:"⟵",Longleftarrow:"⟸",LongLeftArrow:"⟵",longleftrightarrow:"⟷",Longleftrightarrow:"⟺",LongLeftRightArrow:"⟷",longmapsto:"⟼",longrightarrow:"⟶",Longrightarrow:"⟹",LongRightArrow:"⟶",looparrowleft:"↫",looparrowright:"↬",lopar:"⦅",lopf:"𝕝",Lopf:"𝕃",loplus:"⨭",lotimes:"⨴",lowast:"∗",lowbar:"_",LowerLeftArrow:"↙",LowerRightArrow:"↘",loz:"◊",lozenge:"◊",lozf:"⧫",lpar:"(",lparlt:"⦓",lrarr:"⇆",lrcorner:"⌟",lrhar:"⇋",lrhard:"⥭",lrm:"‎",lrtri:"⊿",lsaquo:"‹",lscr:"𝓁",Lscr:"ℒ",lsh:"↰",Lsh:"↰",lsim:"≲",lsime:"⪍",lsimg:"⪏",lsqb:"[",lsquo:"‘",lsquor:"‚",lstrok:"ł",Lstrok:"Ł",lt:"<",Lt:"≪",LT:"<",ltcc:"⪦",ltcir:"⩹",ltdot:"⋖",lthree:"⋋",ltimes:"⋉",ltlarr:"⥶",ltquest:"⩻",ltri:"◃",ltrie:"⊴",ltrif:"◂",ltrPar:"⦖",lurdshar:"⥊",luruhar:"⥦",lvertneqq:"≨︀",lvnE:"≨︀",macr:"¯",male:"♂",malt:"✠",maltese:"✠",map:"↦",Map:"⤅",mapsto:"↦",mapstodown:"↧",mapstoleft:"↤",mapstoup:"↥",marker:"▮",mcomma:"⨩",mcy:"м",Mcy:"М",mdash:"—",mDDot:"∺",measuredangle:"∡",MediumSpace:" ",Mellintrf:"ℳ",mfr:"𝔪",Mfr:"𝔐",mho:"℧",micro:"µ",mid:"∣",midast:"*",midcir:"⫰",middot:"·",minus:"−",minusb:"⊟",minusd:"∸",minusdu:"⨪",MinusPlus:"∓",mlcp:"⫛",mldr:"…",mnplus:"∓",models:"⊧",mopf:"𝕞",Mopf:"𝕄",mp:"∓",mscr:"𝓂",Mscr:"ℳ",mstpos:"∾",mu:"μ",Mu:"Μ",multimap:"⊸",mumap:"⊸",nabla:"∇",nacute:"ń",Nacute:"Ń",nang:"∠⃒",nap:"≉",napE:"⩰̸",napid:"≋̸",napos:"ŉ",napprox:"≉",natur:"♮",natural:"♮",naturals:"ℕ",nbsp:" ",nbump:"≎̸",nbumpe:"≏̸",ncap:"⩃",ncaron:"ň",Ncaron:"Ň",ncedil:"ņ",Ncedil:"Ņ",ncong:"≇",ncongdot:"⩭̸",ncup:"⩂",ncy:"н",Ncy:"Н",ndash:"–",ne:"≠",nearhk:"⤤",nearr:"↗",neArr:"⇗",nearrow:"↗",nedot:"≐̸",NegativeMediumSpace:"​",NegativeThickSpace:"​",NegativeThinSpace:"​",NegativeVeryThinSpace:"​",nequiv:"≢",nesear:"⤨",nesim:"≂̸",NestedGreaterGreater:"≫",NestedLessLess:"≪",NewLine:"\n",nexist:"∄",nexists:"∄",nfr:"𝔫",Nfr:"𝔑",nge:"≱",ngE:"≧̸",ngeq:"≱",ngeqq:"≧̸",ngeqslant:"⩾̸",nges:"⩾̸",nGg:"⋙̸",ngsim:"≵",ngt:"≯",nGt:"≫⃒",ngtr:"≯",nGtv:"≫̸",nharr:"↮",nhArr:"⇎",nhpar:"⫲",ni:"∋",nis:"⋼",nisd:"⋺",niv:"∋",njcy:"њ",NJcy:"Њ",nlarr:"↚",nlArr:"⇍",nldr:"‥",nle:"≰",nlE:"≦̸",nleftarrow:"↚",nLeftarrow:"⇍",nleftrightarrow:"↮",nLeftrightarrow:"⇎",nleq:"≰",nleqq:"≦̸",nleqslant:"⩽̸",nles:"⩽̸",nless:"≮",nLl:"⋘̸",nlsim:"≴",nlt:"≮",nLt:"≪⃒",nltri:"⋪",nltrie:"⋬",nLtv:"≪̸",nmid:"∤",NoBreak:"⁠",NonBreakingSpace:" ",nopf:"𝕟",Nopf:"ℕ",not:"¬",Not:"⫬",NotCongruent:"≢",NotCupCap:"≭",NotDoubleVerticalBar:"∦",NotElement:"∉",NotEqual:"≠",NotEqualTilde:"≂̸",NotExists:"∄",NotGreater:"≯",NotGreaterEqual:"≱",NotGreaterFullEqual:"≧̸",NotGreaterGreater:"≫̸",NotGreaterLess:"≹",NotGreaterSlantEqual:"⩾̸",NotGreaterTilde:"≵",NotHumpDownHump:"≎̸",NotHumpEqual:"≏̸",notin:"∉",notindot:"⋵̸",notinE:"⋹̸",notinva:"∉",notinvb:"⋷",notinvc:"⋶",NotLeftTriangle:"⋪",NotLeftTriangleBar:"⧏̸",NotLeftTriangleEqual:"⋬",NotLess:"≮",NotLessEqual:"≰",NotLessGreater:"≸",NotLessLess:"≪̸",NotLessSlantEqual:"⩽̸",NotLessTilde:"≴",NotNestedGreaterGreater:"⪢̸",NotNestedLessLess:"⪡̸",notni:"∌",notniva:"∌",notnivb:"⋾",notnivc:"⋽",NotPrecedes:"⊀",NotPrecedesEqual:"⪯̸",NotPrecedesSlantEqual:"⋠",NotReverseElement:"∌",NotRightTriangle:"⋫",NotRightTriangleBar:"⧐̸",NotRightTriangleEqual:"⋭",NotSquareSubset:"⊏̸",NotSquareSubsetEqual:"⋢",NotSquareSuperset:"⊐̸",NotSquareSupersetEqual:"⋣",NotSubset:"⊂⃒",NotSubsetEqual:"⊈",NotSucceeds:"⊁",NotSucceedsEqual:"⪰̸",NotSucceedsSlantEqual:"⋡",NotSucceedsTilde:"≿̸",NotSuperset:"⊃⃒",NotSupersetEqual:"⊉",NotTilde:"≁",NotTildeEqual:"≄",NotTildeFullEqual:"≇",NotTildeTilde:"≉",NotVerticalBar:"∤",npar:"∦",nparallel:"∦",nparsl:"⫽⃥",npart:"∂̸",npolint:"⨔",npr:"⊀",nprcue:"⋠",npre:"⪯̸",nprec:"⊀",npreceq:"⪯̸",nrarr:"↛",nrArr:"⇏",nrarrc:"⤳̸",nrarrw:"↝̸",nrightarrow:"↛",nRightarrow:"⇏",nrtri:"⋫",nrtrie:"⋭",nsc:"⊁",nsccue:"⋡",nsce:"⪰̸",nscr:"𝓃",Nscr:"𝒩",nshortmid:"∤",nshortparallel:"∦",nsim:"≁",nsime:"≄",nsimeq:"≄",nsmid:"∤",nspar:"∦",nsqsube:"⋢",nsqsupe:"⋣",nsub:"⊄",nsube:"⊈",nsubE:"⫅̸",nsubset:"⊂⃒",nsubseteq:"⊈",nsubseteqq:"⫅̸",nsucc:"⊁",nsucceq:"⪰̸",nsup:"⊅",nsupe:"⊉",nsupE:"⫆̸",nsupset:"⊃⃒",nsupseteq:"⊉",nsupseteqq:"⫆̸",ntgl:"≹",ntilde:"ñ",Ntilde:"Ñ",ntlg:"≸",ntriangleleft:"⋪",ntrianglelefteq:"⋬",ntriangleright:"⋫",ntrianglerighteq:"⋭",nu:"ν",Nu:"Ν",num:"#",numero:"№",numsp:" ",nvap:"≍⃒",nvdash:"⊬",nvDash:"⊭",nVdash:"⊮",nVDash:"⊯",nvge:"≥⃒",nvgt:">⃒",nvHarr:"⤄",nvinfin:"⧞",nvlArr:"⤂",nvle:"≤⃒",nvlt:"<⃒",nvltrie:"⊴⃒",nvrArr:"⤃",nvrtrie:"⊵⃒",nvsim:"∼⃒",nwarhk:"⤣",nwarr:"↖",nwArr:"⇖",nwarrow:"↖",nwnear:"⤧",oacute:"ó",Oacute:"Ó",oast:"⊛",ocir:"⊚",ocirc:"ô",Ocirc:"Ô",ocy:"о",Ocy:"О",odash:"⊝",odblac:"ő",Odblac:"Ő",odiv:"⨸",odot:"⊙",odsold:"⦼",oelig:"œ",OElig:"Œ",ofcir:"⦿",ofr:"𝔬",Ofr:"𝔒",ogon:"˛",ograve:"ò",Ograve:"Ò",ogt:"⧁",ohbar:"⦵",ohm:"Ω",oint:"∮",olarr:"↺",olcir:"⦾",olcross:"⦻",oline:"‾",olt:"⧀",omacr:"ō",Omacr:"Ō",omega:"ω",Omega:"Ω",omicron:"ο",Omicron:"Ο",omid:"⦶",ominus:"⊖",oopf:"𝕠",Oopf:"𝕆",opar:"⦷",OpenCurlyDoubleQuote:"“",OpenCurlyQuote:"‘",operp:"⦹",oplus:"⊕",or:"∨",Or:"⩔",orarr:"↻",ord:"⩝",order:"ℴ",orderof:"ℴ",ordf:"ª",ordm:"º",origof:"⊶",oror:"⩖",orslope:"⩗",orv:"⩛",oS:"Ⓢ",oscr:"ℴ",Oscr:"𝒪",oslash:"ø",Oslash:"Ø",osol:"⊘",otilde:"õ",Otilde:"Õ",otimes:"⊗",Otimes:"⨷",otimesas:"⨶",ouml:"ö",Ouml:"Ö",ovbar:"⌽",OverBar:"‾",OverBrace:"⏞",OverBracket:"⎴",OverParenthesis:"⏜",par:"∥",para:"¶",parallel:"∥",parsim:"⫳",parsl:"⫽",part:"∂",PartialD:"∂",pcy:"п",Pcy:"П",percnt:"%",period:".",permil:"‰",perp:"⊥",pertenk:"‱",pfr:"𝔭",Pfr:"𝔓",phi:"φ",Phi:"Φ",phiv:"ϕ",phmmat:"ℳ",phone:"☎",pi:"π",Pi:"Π",pitchfork:"⋔",piv:"ϖ",planck:"ℏ",planckh:"ℎ",plankv:"ℏ",plus:"+",plusacir:"⨣",plusb:"⊞",pluscir:"⨢",plusdo:"∔",plusdu:"⨥",pluse:"⩲",PlusMinus:"±",plusmn:"±",plussim:"⨦",plustwo:"⨧",pm:"±",Poincareplane:"ℌ",pointint:"⨕",popf:"𝕡",Popf:"ℙ",pound:"£",pr:"≺",Pr:"⪻",prap:"⪷",prcue:"≼",pre:"⪯",prE:"⪳",prec:"≺",precapprox:"⪷",preccurlyeq:"≼",Precedes:"≺",PrecedesEqual:"⪯",PrecedesSlantEqual:"≼",PrecedesTilde:"≾",preceq:"⪯",precnapprox:"⪹",precneqq:"⪵",precnsim:"⋨",precsim:"≾",prime:"′",Prime:"″",primes:"ℙ",prnap:"⪹",prnE:"⪵",prnsim:"⋨",prod:"∏",Product:"∏",profalar:"⌮",profline:"⌒",profsurf:"⌓",prop:"∝",Proportion:"∷",Proportional:"∝",propto:"∝",prsim:"≾",prurel:"⊰",pscr:"𝓅",Pscr:"𝒫",psi:"ψ",Psi:"Ψ",puncsp:" ",qfr:"𝔮",Qfr:"𝔔",qint:"⨌",qopf:"𝕢",Qopf:"ℚ",qprime:"⁗",qscr:"𝓆",Qscr:"𝒬",quaternions:"ℍ",quatint:"⨖",quest:"?",questeq:"≟",quot:'"',QUOT:'"',rAarr:"⇛",race:"∽̱",racute:"ŕ",Racute:"Ŕ",radic:"√",raemptyv:"⦳",rang:"⟩",Rang:"⟫",rangd:"⦒",range:"⦥",rangle:"⟩",raquo:"»",rarr:"→",rArr:"⇒",Rarr:"↠",rarrap:"⥵",rarrb:"⇥",rarrbfs:"⤠",rarrc:"⤳",rarrfs:"⤞",rarrhk:"↪",rarrlp:"↬",rarrpl:"⥅",rarrsim:"⥴",rarrtl:"↣",Rarrtl:"⤖",rarrw:"↝",ratail:"⤚",rAtail:"⤜",ratio:"∶",rationals:"ℚ",rbarr:"⤍",rBarr:"⤏",RBarr:"⤐",rbbrk:"❳",rbrace:"}",rbrack:"]",rbrke:"⦌",rbrksld:"⦎",rbrkslu:"⦐",rcaron:"ř",Rcaron:"Ř",rcedil:"ŗ",Rcedil:"Ŗ",rceil:"⌉",rcub:"}",rcy:"р",Rcy:"Р",rdca:"⤷",rdldhar:"⥩",rdquo:"”",rdquor:"”",rdsh:"↳",Re:"ℜ",real:"ℜ",realine:"ℛ",realpart:"ℜ",reals:"ℝ",rect:"▭",reg:"®",REG:"®",ReverseElement:"∋",ReverseEquilibrium:"⇋",ReverseUpEquilibrium:"⥯",rfisht:"⥽",rfloor:"⌋",rfr:"𝔯",Rfr:"ℜ",rHar:"⥤",rhard:"⇁",rharu:"⇀",rharul:"⥬",rho:"ρ",Rho:"Ρ",rhov:"ϱ",RightAngleBracket:"⟩",rightarrow:"→",Rightarrow:"⇒",RightArrow:"→",RightArrowBar:"⇥",RightArrowLeftArrow:"⇄",rightarrowtail:"↣",RightCeiling:"⌉",RightDoubleBracket:"⟧",RightDownTeeVector:"⥝",RightDownVector:"⇂",RightDownVectorBar:"⥕",RightFloor:"⌋",rightharpoondown:"⇁",rightharpoonup:"⇀",rightleftarrows:"⇄",rightleftharpoons:"⇌",rightrightarrows:"⇉",rightsquigarrow:"↝",RightTee:"⊢",RightTeeArrow:"↦",RightTeeVector:"⥛",rightthreetimes:"⋌",RightTriangle:"⊳",RightTriangleBar:"⧐",RightTriangleEqual:"⊵",RightUpDownVector:"⥏",RightUpTeeVector:"⥜",RightUpVector:"↾",RightUpVectorBar:"⥔",RightVector:"⇀",RightVectorBar:"⥓",ring:"˚",risingdotseq:"≓",rlarr:"⇄",rlhar:"⇌",rlm:"‏",rmoust:"⎱",rmoustache:"⎱",rnmid:"⫮",roang:"⟭",roarr:"⇾",robrk:"⟧",ropar:"⦆",ropf:"𝕣",Ropf:"ℝ",roplus:"⨮",rotimes:"⨵",RoundImplies:"⥰",rpar:")",rpargt:"⦔",rppolint:"⨒",rrarr:"⇉",Rrightarrow:"⇛",rsaquo:"›",rscr:"𝓇",Rscr:"ℛ",rsh:"↱",Rsh:"↱",rsqb:"]",rsquo:"’",rsquor:"’",rthree:"⋌",rtimes:"⋊",rtri:"▹",rtrie:"⊵",rtrif:"▸",rtriltri:"⧎",RuleDelayed:"⧴",ruluhar:"⥨",rx:"℞",sacute:"ś",Sacute:"Ś",sbquo:"‚",sc:"≻",Sc:"⪼",scap:"⪸",scaron:"š",Scaron:"Š",sccue:"≽",sce:"⪰",scE:"⪴",scedil:"ş",Scedil:"Ş",scirc:"ŝ",Scirc:"Ŝ",scnap:"⪺",scnE:"⪶",scnsim:"⋩",scpolint:"⨓",scsim:"≿",scy:"с",Scy:"С",sdot:"⋅",sdotb:"⊡",sdote:"⩦",searhk:"⤥",searr:"↘",seArr:"⇘",searrow:"↘",sect:"§",semi:";",seswar:"⤩",setminus:"∖",setmn:"∖",sext:"✶",sfr:"𝔰",Sfr:"𝔖",sfrown:"⌢",sharp:"♯",shchcy:"щ",SHCHcy:"Щ",shcy:"ш",SHcy:"Ш",ShortDownArrow:"↓",ShortLeftArrow:"←",shortmid:"∣",shortparallel:"∥",ShortRightArrow:"→",ShortUpArrow:"↑",shy:"­",sigma:"σ",Sigma:"Σ",sigmaf:"ς",sigmav:"ς",sim:"∼",simdot:"⩪",sime:"≃",simeq:"≃",simg:"⪞",simgE:"⪠",siml:"⪝",simlE:"⪟",simne:"≆",simplus:"⨤",simrarr:"⥲",slarr:"←",SmallCircle:"∘",smallsetminus:"∖",smashp:"⨳",smeparsl:"⧤",smid:"∣",smile:"⌣",smt:"⪪",smte:"⪬",smtes:"⪬︀",softcy:"ь",SOFTcy:"Ь",sol:"/",solb:"⧄",solbar:"⌿",sopf:"𝕤",Sopf:"𝕊",spades:"♠",spadesuit:"♠",spar:"∥",sqcap:"⊓",sqcaps:"⊓︀",sqcup:"⊔",sqcups:"⊔︀",Sqrt:"√",sqsub:"⊏",sqsube:"⊑",sqsubset:"⊏",sqsubseteq:"⊑",sqsup:"⊐",sqsupe:"⊒",sqsupset:"⊐",sqsupseteq:"⊒",squ:"□",square:"□",Square:"□",SquareIntersection:"⊓",SquareSubset:"⊏",SquareSubsetEqual:"⊑",SquareSuperset:"⊐",SquareSupersetEqual:"⊒",SquareUnion:"⊔",squarf:"▪",squf:"▪",srarr:"→",sscr:"𝓈",Sscr:"𝒮",ssetmn:"∖",ssmile:"⌣",sstarf:"⋆",star:"☆",Star:"⋆",starf:"★",straightepsilon:"ϵ",straightphi:"ϕ",strns:"¯",sub:"⊂",Sub:"⋐",subdot:"⪽",sube:"⊆",subE:"⫅",subedot:"⫃",submult:"⫁",subne:"⊊",subnE:"⫋",subplus:"⪿",subrarr:"⥹",subset:"⊂",Subset:"⋐",subseteq:"⊆",subseteqq:"⫅",SubsetEqual:"⊆",subsetneq:"⊊",subsetneqq:"⫋",subsim:"⫇",subsub:"⫕",subsup:"⫓",succ:"≻",succapprox:"⪸",succcurlyeq:"≽",Succeeds:"≻",SucceedsEqual:"⪰",SucceedsSlantEqual:"≽",SucceedsTilde:"≿",succeq:"⪰",succnapprox:"⪺",succneqq:"⪶",succnsim:"⋩",succsim:"≿",SuchThat:"∋",sum:"∑",Sum:"∑",sung:"♪",sup:"⊃",Sup:"⋑",sup1:"¹",sup2:"²",sup3:"³",supdot:"⪾",supdsub:"⫘",supe:"⊇",supE:"⫆",supedot:"⫄",Superset:"⊃",SupersetEqual:"⊇",suphsol:"⟉",suphsub:"⫗",suplarr:"⥻",supmult:"⫂",supne:"⊋",supnE:"⫌",supplus:"⫀",supset:"⊃",Supset:"⋑",supseteq:"⊇",supseteqq:"⫆",supsetneq:"⊋",supsetneqq:"⫌",supsim:"⫈",supsub:"⫔",supsup:"⫖",swarhk:"⤦",swarr:"↙",swArr:"⇙",swarrow:"↙",swnwar:"⤪",szlig:"ß",Tab:"\t",target:"⌖",tau:"τ",Tau:"Τ",tbrk:"⎴",tcaron:"ť",Tcaron:"Ť",tcedil:"ţ",Tcedil:"Ţ",tcy:"т",Tcy:"Т",tdot:"⃛",telrec:"⌕",tfr:"𝔱",Tfr:"𝔗",there4:"∴",therefore:"∴",Therefore:"∴",theta:"θ",Theta:"Θ",thetasym:"ϑ",thetav:"ϑ",thickapprox:"≈",thicksim:"∼",ThickSpace:"  ",thinsp:" ",ThinSpace:" ",thkap:"≈",thksim:"∼",thorn:"þ",THORN:"Þ",tilde:"˜",Tilde:"∼",TildeEqual:"≃",TildeFullEqual:"≅",TildeTilde:"≈",times:"×",timesb:"⊠",timesbar:"⨱",timesd:"⨰",tint:"∭",toea:"⤨",top:"⊤",topbot:"⌶",topcir:"⫱",topf:"𝕥",Topf:"𝕋",topfork:"⫚",tosa:"⤩",tprime:"‴",trade:"™",TRADE:"™",triangle:"▵",triangledown:"▿",triangleleft:"◃",trianglelefteq:"⊴",triangleq:"≜",triangleright:"▹",trianglerighteq:"⊵",tridot:"◬",trie:"≜",triminus:"⨺",TripleDot:"⃛",triplus:"⨹",trisb:"⧍",tritime:"⨻",trpezium:"⏢",tscr:"𝓉",Tscr:"𝒯",tscy:"ц",TScy:"Ц",tshcy:"ћ",TSHcy:"Ћ",tstrok:"ŧ",Tstrok:"Ŧ",twixt:"≬",twoheadleftarrow:"↞",twoheadrightarrow:"↠",uacute:"ú",Uacute:"Ú",uarr:"↑",uArr:"⇑",Uarr:"↟",Uarrocir:"⥉",ubrcy:"ў",Ubrcy:"Ў",ubreve:"ŭ",Ubreve:"Ŭ",ucirc:"û",Ucirc:"Û",ucy:"у",Ucy:"У",udarr:"⇅",udblac:"ű",Udblac:"Ű",udhar:"⥮",ufisht:"⥾",ufr:"𝔲",Ufr:"𝔘",ugrave:"ù",Ugrave:"Ù",uHar:"⥣",uharl:"↿",uharr:"↾",uhblk:"▀",ulcorn:"⌜",ulcorner:"⌜",ulcrop:"⌏",ultri:"◸",umacr:"ū",Umacr:"Ū",uml:"¨",UnderBar:"_",UnderBrace:"⏟",UnderBracket:"⎵",UnderParenthesis:"⏝",Union:"⋃",UnionPlus:"⊎",uogon:"ų",Uogon:"Ų",uopf:"𝕦",Uopf:"𝕌",uparrow:"↑",Uparrow:"⇑",UpArrow:"↑",UpArrowBar:"⤒",UpArrowDownArrow:"⇅",updownarrow:"↕",Updownarrow:"⇕",UpDownArrow:"↕",UpEquilibrium:"⥮",upharpoonleft:"↿",upharpoonright:"↾",uplus:"⊎",UpperLeftArrow:"↖",UpperRightArrow:"↗",upsi:"υ",Upsi:"ϒ",upsih:"ϒ",upsilon:"υ",Upsilon:"Υ",UpTee:"⊥",UpTeeArrow:"↥",upuparrows:"⇈",urcorn:"⌝",urcorner:"⌝",urcrop:"⌎",uring:"ů",Uring:"Ů",urtri:"◹",uscr:"𝓊",Uscr:"𝒰",utdot:"⋰",utilde:"ũ",Utilde:"Ũ",utri:"▵",utrif:"▴",uuarr:"⇈",uuml:"ü",Uuml:"Ü",uwangle:"⦧",vangrt:"⦜",varepsilon:"ϵ",varkappa:"ϰ",varnothing:"∅",varphi:"ϕ",varpi:"ϖ",varpropto:"∝",varr:"↕",vArr:"⇕",varrho:"ϱ",varsigma:"ς",varsubsetneq:"⊊︀",varsubsetneqq:"⫋︀",varsupsetneq:"⊋︀",varsupsetneqq:"⫌︀",vartheta:"ϑ",vartriangleleft:"⊲",vartriangleright:"⊳",vBar:"⫨",Vbar:"⫫",vBarv:"⫩",vcy:"в",Vcy:"В",vdash:"⊢",vDash:"⊨",Vdash:"⊩",VDash:"⊫",Vdashl:"⫦",vee:"∨",Vee:"⋁",veebar:"⊻",veeeq:"≚",vellip:"⋮",verbar:"|",Verbar:"‖",vert:"|",Vert:"‖",VerticalBar:"∣",VerticalLine:"|",VerticalSeparator:"❘",VerticalTilde:"≀",VeryThinSpace:" ",vfr:"𝔳",Vfr:"𝔙",vltri:"⊲",vnsub:"⊂⃒",vnsup:"⊃⃒",vopf:"𝕧",Vopf:"𝕍",vprop:"∝",vrtri:"⊳",vscr:"𝓋",Vscr:"𝒱",vsubne:"⊊︀",vsubnE:"⫋︀",vsupne:"⊋︀",vsupnE:"⫌︀",Vvdash:"⊪",vzigzag:"⦚",wcirc:"ŵ",Wcirc:"Ŵ",wedbar:"⩟",wedge:"∧",Wedge:"⋀",wedgeq:"≙",weierp:"℘",wfr:"𝔴",Wfr:"𝔚",wopf:"𝕨",Wopf:"𝕎",wp:"℘",wr:"≀",wreath:"≀",wscr:"𝓌",Wscr:"𝒲",xcap:"⋂",xcirc:"◯",xcup:"⋃",xdtri:"▽",xfr:"𝔵",Xfr:"𝔛",xharr:"⟷",xhArr:"⟺",xi:"ξ",Xi:"Ξ",xlarr:"⟵",xlArr:"⟸",xmap:"⟼",xnis:"⋻",xodot:"⨀",xopf:"𝕩",Xopf:"𝕏",xoplus:"⨁",xotime:"⨂",xrarr:"⟶",xrArr:"⟹",xscr:"𝓍",Xscr:"𝒳",xsqcup:"⨆",xuplus:"⨄",xutri:"△",xvee:"⋁",xwedge:"⋀",yacute:"ý",Yacute:"Ý",yacy:"я",YAcy:"Я",ycirc:"ŷ",Ycirc:"Ŷ",ycy:"ы",Ycy:"Ы",yen:"¥",yfr:"𝔶",Yfr:"𝔜",yicy:"ї",YIcy:"Ї",yopf:"𝕪",Yopf:"𝕐",yscr:"𝓎",Yscr:"𝒴",yucy:"ю",YUcy:"Ю",yuml:"ÿ",Yuml:"Ÿ",zacute:"ź",Zacute:"Ź",zcaron:"ž",Zcaron:"Ž",zcy:"з",Zcy:"З",zdot:"ż",Zdot:"Ż",zeetrf:"ℨ",ZeroWidthSpace:"​",zeta:"ζ",Zeta:"Ζ",zfr:"𝔷",Zfr:"ℨ",zhcy:"ж",ZHcy:"Ж",zigrarr:"⇝",zopf:"𝕫",Zopf:"ℤ",zscr:"𝓏",Zscr:"𝒵",zwj:"‍",zwnj:"‌"},y={aacute:"á",Aacute:"Á",acirc:"â",Acirc:"Â",acute:"´",aelig:"æ",AElig:"Æ",agrave:"à",Agrave:"À",amp:"&",AMP:"&",aring:"å",Aring:"Å",atilde:"ã",Atilde:"Ã",auml:"ä",Auml:"Ä",brvbar:"¦",ccedil:"ç",Ccedil:"Ç",cedil:"¸",cent:"¢",copy:"©",COPY:"©",curren:"¤",deg:"°",divide:"÷",eacute:"é",Eacute:"É",ecirc:"ê",Ecirc:"Ê",egrave:"è",Egrave:"È",eth:"ð",ETH:"Ð",euml:"ë",Euml:"Ë",frac12:"½",frac14:"¼",frac34:"¾",gt:">",GT:">",iacute:"í",Iacute:"Í",icirc:"î",Icirc:"Î",iexcl:"¡",igrave:"ì",Igrave:"Ì",iquest:"¿",iuml:"ï",Iuml:"Ï",laquo:"«",lt:"<",LT:"<",macr:"¯",micro:"µ",middot:"·",nbsp:" ",not:"¬",ntilde:"ñ",Ntilde:"Ñ",oacute:"ó",Oacute:"Ó",ocirc:"ô",Ocirc:"Ô",ograve:"ò",Ograve:"Ò",ordf:"ª",ordm:"º",oslash:"ø",Oslash:"Ø",otilde:"õ",Otilde:"Õ",ouml:"ö",Ouml:"Ö",para:"¶",plusmn:"±",pound:"£",quot:'"',QUOT:'"',raquo:"»",reg:"®",REG:"®",sect:"§",shy:"­",sup1:"¹",sup2:"²",sup3:"³",szlig:"ß",thorn:"þ",THORN:"Þ",times:"×",uacute:"ú",Uacute:"Ú",ucirc:"û",Ucirc:"Û",ugrave:"ù",Ugrave:"Ù",uml:"¨",uuml:"ü",Uuml:"Ü",yacute:"ý",Yacute:"Ý",yen:"¥",yuml:"ÿ"},v={0:"�",128:"€",130:"‚",131:"ƒ",132:"„",133:"…",134:"†",135:"‡",136:"ˆ",137:"‰",138:"Š",139:"‹",140:"Œ",142:"Ž",145:"‘",146:"’",147:"“",148:"”",149:"•",150:"–",151:"—",152:"˜",153:"™",154:"š",155:"›",156:"œ",158:"ž",159:"Ÿ"},E=[1,2,3,4,5,6,7,8,11,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,127,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,143,144,145,146,147,148,149,150,151,152,153,154,155,156,157,158,159,64976,64977,64978,64979,64980,64981,64982,64983,64984,64985,64986,64987,64988,64989,64990,64991,64992,64993,64994,64995,64996,64997,64998,64999,65e3,65001,65002,65003,65004,65005,65006,65007,65534,65535,131070,131071,196606,196607,262142,262143,327678,327679,393214,393215,458750,458751,524286,524287,589822,589823,655358,655359,720894,720895,786430,786431,851966,851967,917502,917503,983038,983039,1048574,1048575,1114110,1114111],C=String.fromCharCode,b={}.hasOwnProperty,S=function(e,t){return b.call(e,t)},I=function(e,t){if(!e)return t;var r,n={};for(r in t)n[r]=S(e,r)?e[r]:t[r];return n},x=function(e,t){var r="";return 55296<=e&&e<=57343||1114111<e?(t&&D("character reference outside the permissible Unicode range"),"�"):S(v,e)?(t&&D("disallowed character reference"),v[e]):(t&&function(e,t){for(var r=-1,n=e.length;++r<n;)if(e[r]==t)return!0;return!1}(E,e)&&D("disallowed character reference"),65535<e&&(r+=C((e-=65536)>>>10&1023|55296),e=56320|1023&e),r+=C(e))},P=function(e){return"&#x"+e.toString(16).toUpperCase()+";"},w=function(e){return"&#"+e+";"},D=function(e){throw Error("Parse error: "+e)},_=function e(t,r){(r=I(r,e.options)).strict&&m.test(t)&&D("forbidden code point");var n=r.encodeEverything,i=r.useNamedReferences,a=r.allowUnsafeSymbols,s=r.decimal?w:P,d=function(e){return s(e.charCodeAt(0))};return n?(t=t.replace(l,(function(e){return i&&S(h,e)?"&"+h[e]+";":d(e)})),i&&(t=t.replace(/&gt;\u20D2/g,"&nvgt;").replace(/&lt;\u20D2/g,"&nvlt;").replace(/&#x66;&#x6A;/g,"&fjlig;")),i&&(t=t.replace(u,(function(e){return"&"+h[e]+";"})))):i?(a||(t=t.replace(f,(function(e){return"&"+h[e]+";"}))),t=(t=t.replace(/&gt;\u20D2/g,"&nvgt;").replace(/&lt;\u20D2/g,"&nvlt;")).replace(u,(function(e){return"&"+h[e]+";"}))):a||(t=t.replace(f,d)),t.replace(o,(function(e){var t=e.charCodeAt(0),r=e.charCodeAt(1);return s(1024*(t-55296)+r-56320+65536)})).replace(c,d)};_.options={allowUnsafeSymbols:!1,encodeEverything:!1,strict:!1,useNamedReferences:!1,decimal:!1};var A=function e(t,r){var n=(r=I(r,e.options)).strict;return n&&p.test(t)&&D("malformed character reference"),t.replace(g,(function(e,t,i,a,s,o,l,c,u){var h,f,d,p,m,g;return t?T[m=t]:i?(m=i,(g=a)&&r.isAttributeValue?(n&&"="==g&&D("`&` did not start a character reference"),e):(n&&D("named character reference was not terminated by a semicolon"),y[m]+(g||""))):s?(d=s,f=o,n&&!f&&D("character reference was not terminated by a semicolon"),h=parseInt(d,10),x(h,n)):l?(p=l,f=c,n&&!f&&D("character reference was not terminated by a semicolon"),h=parseInt(p,16),x(h,n)):(n&&D("named character reference was not terminated by a semicolon"),e)}))};A.options={isAttributeValue:!1,strict:!1};var R={version:"1.2.0",encode:_,decode:A,escape:function(e){return e.replace(f,(function(e){return d[e]}))},unescape:A};if("function"==typeof define&&"object"==_typeof(define.amd)&&define.amd)define((function(){return R}));else if(i&&!i.nodeType)if(a)a.exports=R;else for(var M in R)S(R,M)&&(i[M]=R[M]);else n.he=R}(this)}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],104:[function(e,t,r){var n=e("http"),i=e("url"),a=t.exports;for(var s in n)n.hasOwnProperty(s)&&(a[s]=n[s]);function o(e){if("string"==typeof e&&(e=i.parse(e)),e.protocol||(e.protocol="https:"),"https:"!==e.protocol)throw new Error('Protocol "'+e.protocol+'" not supported. Expected "https:"');return e}a.request=function(e,t){return e=o(e),n.request.call(this,e,t)},a.get=function(e,t){return e=o(e),n.get.call(this,e,t)}},{http:155,url:162}],105:[function(e,t,r){r.read=function(e,t,r,n,i){var a,s,o=8*i-n-1,l=(1<<o)-1,c=l>>1,u=-7,h=r?i-1:0,f=r?-1:1,d=e[t+h];for(h+=f,a=d&(1<<-u)-1,d>>=-u,u+=o;0<u;a=256*a+e[t+h],h+=f,u-=8);for(s=a&(1<<-u)-1,a>>=-u,u+=n;0<u;s=256*s+e[t+h],h+=f,u-=8);if(0===a)a=1-c;else{if(a===l)return s?NaN:1/0*(d?-1:1);s+=Math.pow(2,n),a-=c}return(d?-1:1)*s*Math.pow(2,a-n)},r.write=function(e,t,r,n,i,a){var s,o,l,c=8*a-i-1,u=(1<<c)-1,h=u>>1,f=23===i?Math.pow(2,-24)-Math.pow(2,-77):0,d=n?0:a-1,p=n?1:-1,m=t<0||0===t&&1/t<0?1:0;for(t=Math.abs(t),isNaN(t)||t===1/0?(o=isNaN(t)?1:0,s=u):(s=Math.floor(Math.log(t)/Math.LN2),t*(l=Math.pow(2,-s))<1&&(s--,l*=2),2<=(t+=1<=s+h?f/l:f*Math.pow(2,1-h))*l&&(s++,l/=2),u<=s+h?(o=0,s=u):1<=s+h?(o=(t*l-1)*Math.pow(2,i),s+=h):(o=t*Math.pow(2,h-1)*Math.pow(2,i),s=0));8<=i;e[r+d]=255&o,d+=p,o/=256,i-=8);for(s=s<<i|o,c+=i;0<c;e[r+d]=255&s,d+=p,s/=256,c-=8);e[r+d-p]|=128*m}},{}],106:[function(e,t,r){"function"==typeof Object.create?t.exports=function(e,t){e.super_=t,e.prototype=Object.create(t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}})}:t.exports=function(e,t){e.super_=t;var r=function(){};r.prototype=t.prototype,e.prototype=new r,e.prototype.constructor=e}},{}],107:[function(e,t,r){function n(e){return!!e.constructor&&"function"==typeof e.constructor.isBuffer&&e.constructor.isBuffer(e)}t.exports=function(e){return null!=e&&(n(e)||"function"==typeof(t=e).readFloatLE&&"function"==typeof t.slice&&n(t.slice(0,0))||!!e._isBuffer);var t}},{}],108:[function(e,t,r){var n={}.toString;t.exports=Array.isArray||function(e){return"[object Array]"==n.call(e)}},{}],109:[function(e,t,r){r.endianness=function(){return"LE"},r.hostname=function(){return"undefined"!=typeof location?location.hostname:""},r.loadavg=function(){return[]},r.uptime=function(){return 0},r.freemem=function(){return Number.MAX_VALUE},r.totalmem=function(){return Number.MAX_VALUE},r.cpus=function(){return[]},r.type=function(){return"Browser"},r.release=function(){return"undefined"!=typeof navigator?navigator.appVersion:""},r.networkInterfaces=r.getNetworkInterfaces=function(){return{}},r.arch=function(){return"javascript"},r.platform=function(){return"browser"},r.tmpdir=r.tmpDir=function(){return"/tmp"},r.EOL="\n",r.homedir=function(){return"/"}},{}],110:[function(e,t,r){(function(e){function t(e,t){for(var r=0,n=e.length-1;0<=n;n--){var i=e[n];"."===i?e.splice(n,1):".."===i?(e.splice(n,1),r++):r&&(e.splice(n,1),r--)}if(t)for(;r--;r)e.unshift("..");return e}function n(e,t){if(e.filter)return e.filter(t);for(var r=[],n=0;n<e.length;n++)t(e[n],n,e)&&r.push(e[n]);return r}r.resolve=function(){for(var r="",i=!1,a=arguments.length-1;-1<=a&&!i;a--){var s=0<=a?arguments[a]:e.cwd();if("string"!=typeof s)throw new TypeError("Arguments to path.resolve must be strings");s&&(r=s+"/"+r,i="/"===s.charAt(0))}return(i?"/":"")+(r=t(n(r.split("/"),(function(e){return!!e})),!i).join("/"))||"."},r.normalize=function(e){var a=r.isAbsolute(e),s="/"===i(e,-1);return(e=t(n(e.split("/"),(function(e){return!!e})),!a).join("/"))||a||(e="."),e&&s&&(e+="/"),(a?"/":"")+e},r.isAbsolute=function(e){return"/"===e.charAt(0)},r.join=function(){var e=Array.prototype.slice.call(arguments,0);return r.normalize(n(e,(function(e,t){if("string"!=typeof e)throw new TypeError("Arguments to path.join must be strings");return e})).join("/"))},r.relative=function(e,t){function n(e){for(var t=0;t<e.length&&""===e[t];t++);for(var r=e.length-1;0<=r&&""===e[r];r--);return r<t?[]:e.slice(t,r-t+1)}e=r.resolve(e).substr(1),t=r.resolve(t).substr(1);for(var i=n(e.split("/")),a=n(t.split("/")),s=Math.min(i.length,a.length),o=s,l=0;l<s;l++)if(i[l]!==a[l]){o=l;break}var c=[];for(l=o;l<i.length;l++)c.push("..");return(c=c.concat(a.slice(o))).join("/")},r.sep="/",r.delimiter=":",r.dirname=function(e){if("string"!=typeof e&&(e+=""),0===e.length)return".";for(var t=e.charCodeAt(0),r=47===t,n=-1,i=!0,a=e.length-1;1<=a;--a)if(47===(t=e.charCodeAt(a))){if(!i){n=a;break}}else i=!1;return-1===n?r?"/":".":r&&1===n?"/":e.slice(0,n)},r.basename=function(e,t){var r=function(e){"string"!=typeof e&&(e+="");var t,r=0,n=-1,i=!0;for(t=e.length-1;0<=t;--t)if(47===e.charCodeAt(t)){if(!i){r=t+1;break}}else-1===n&&(i=!1,n=t+1);return-1===n?"":e.slice(r,n)}(e);return t&&r.substr(-1*t.length)===t&&(r=r.substr(0,r.length-t.length)),r},r.extname=function(e){"string"!=typeof e&&(e+="");for(var t=-1,r=0,n=-1,i=!0,a=0,s=e.length-1;0<=s;--s){var o=e.charCodeAt(s);if(47===o){if(i)continue;r=s+1;break}-1===n&&(i=!1,n=s+1),46===o?-1===t?t=s:1!==a&&(a=1):-1!==t&&(a=-1)}return-1===t||-1===n||0===a||1===a&&t===n-1&&t===r+1?"":e.slice(t,n)};var i="b"==="ab".substr(-1)?function(e,t,r){return e.substr(t,r)}:function(e,t,r){return t<0&&(t=e.length+t),e.substr(t,r)}}).call(this,e("_process"))},{_process:112}],111:[function(e,t,r){(function(e){"use strict";!e.version||0===e.version.indexOf("v0.")||0===e.version.indexOf("v1.")&&0!==e.version.indexOf("v1.8.")?t.exports={nextTick:function(t,r,n,i){if("function"!=typeof t)throw new TypeError('"callback" argument must be a function');var a,s,o=arguments.length;switch(o){case 0:case 1:return e.nextTick(t);case 2:return e.nextTick((function(){t.call(null,r)}));case 3:return e.nextTick((function(){t.call(null,r,n)}));case 4:return e.nextTick((function(){t.call(null,r,n,i)}));default:for(a=new Array(o-1),s=0;s<a.length;)a[s++]=arguments[s];return e.nextTick((function(){t.apply(null,a)}))}}}:t.exports=e}).call(this,e("_process"))},{_process:112}],112:[function(e,t,r){var n,i,a=t.exports={};function s(){throw new Error("setTimeout has not been defined")}function o(){throw new Error("clearTimeout has not been defined")}function l(e){if(n===setTimeout)return setTimeout(e,0);if((n===s||!n)&&setTimeout)return n=setTimeout,setTimeout(e,0);try{return n(e,0)}catch(t){try{return n.call(null,e,0)}catch(t){return n.call(this,e,0)}}}!function(){try{n="function"==typeof setTimeout?setTimeout:s}catch(e){n=s}try{i="function"==typeof clearTimeout?clearTimeout:o}catch(e){i=o}}();var c,u=[],h=!1,f=-1;function d(){h&&c&&(h=!1,c.length?u=c.concat(u):f=-1,u.length&&p())}function p(){if(!h){var e=l(d);h=!0;for(var t=u.length;t;){for(c=u,u=[];++f<t;)c&&c[f].run();f=-1,t=u.length}c=null,h=!1,function(e){if(i===clearTimeout)return clearTimeout(e);if((i===o||!i)&&clearTimeout)return i=clearTimeout,clearTimeout(e);try{i(e)}catch(t){try{return i.call(null,e)}catch(t){return i.call(this,e)}}}(e)}}function m(e,t){this.fun=e,this.array=t}function g(){}a.nextTick=function(e){var t=new Array(arguments.length-1);if(1<arguments.length)for(var r=1;r<arguments.length;r++)t[r-1]=arguments[r];u.push(new m(e,t)),1!==u.length||h||l(p)},m.prototype.run=function(){this.fun.apply(null,this.array)},a.title="browser",a.browser=!0,a.env={},a.argv=[],a.version="",a.versions={},a.on=g,a.addListener=g,a.once=g,a.off=g,a.removeListener=g,a.removeAllListeners=g,a.emit=g,a.prependListener=g,a.prependOnceListener=g,a.listeners=function(e){return[]},a.binding=function(e){throw new Error("process.binding is not supported")},a.cwd=function(){return"/"},a.chdir=function(e){throw new Error("process.chdir is not supported")},a.umask=function(){return 0}},{}],113:[function(e,t,r){(function(e){!function(n){var i="object"==_typeof(r)&&r&&!r.nodeType&&r,a="object"==_typeof(t)&&t&&!t.nodeType&&t,s="object"==_typeof(e)&&e;s.global!==s&&s.window!==s&&s.self!==s||(n=s);var o,l,c=2147483647,u=36,h=/^xn--/,f=/[^\x20-\x7E]/,d=/[\x2E\u3002\uFF0E\uFF61]/g,p={overflow:"Overflow: input needs wider integers to process","not-basic":"Illegal input >= 0x80 (not a basic code point)","invalid-input":"Invalid input"},m=Math.floor,g=String.fromCharCode;function T(e){throw new RangeError(p[e])}function y(e,t){for(var r=e.length,n=[];r--;)n[r]=t(e[r]);return n}function v(e,t){var r=e.split("@"),n="";return 1<r.length&&(n=r[0]+"@",e=r[1]),n+y((e=e.replace(d,".")).split("."),t).join(".")}function E(e){for(var t,r,n=[],i=0,a=e.length;i<a;)55296<=(t=e.charCodeAt(i++))&&t<=56319&&i<a?56320==(64512&(r=e.charCodeAt(i++)))?n.push(((1023&t)<<10)+(1023&r)+65536):(n.push(t),i--):n.push(t);return n}function C(e){return y(e,(function(e){var t="";return 65535<e&&(t+=g((e-=65536)>>>10&1023|55296),e=56320|1023&e),t+g(e)})).join("")}function b(e,t){return e+22+75*(e<26)-((0!=t)<<5)}function S(e,t,r){var n=0;for(e=r?m(e/700):e>>1,e+=m(e/t);455<e;n+=u)e=m(e/35);return m(n+36*e/(e+38))}function I(e){var t,r,n,i,a,s,o,l,h,f,d,p=[],g=e.length,y=0,v=128,E=72;for((r=e.lastIndexOf("-"))<0&&(r=0),n=0;n<r;++n)128<=e.charCodeAt(n)&&T("not-basic"),p.push(e.charCodeAt(n));for(i=0<r?r+1:0;i<g;){for(a=y,s=1,o=u;g<=i&&T("invalid-input"),d=e.charCodeAt(i++),(u<=(l=d-48<10?d-22:d-65<26?d-65:d-97<26?d-97:u)||l>m((c-y)/s))&&T("overflow"),y+=l*s,!(l<(h=o<=E?1:E+26<=o?26:o-E));o+=u)s>m(c/(f=u-h))&&T("overflow"),s*=f;E=S(y-a,t=p.length+1,0==a),m(y/t)>c-v&&T("overflow"),v+=m(y/t),y%=t,p.splice(y++,0,v)}return C(p)}function x(e){var t,r,n,i,a,s,o,l,h,f,d,p,y,v,C,I=[];for(p=(e=E(e)).length,t=128,a=72,s=r=0;s<p;++s)(d=e[s])<128&&I.push(g(d));for(n=i=I.length,i&&I.push("-");n<p;){for(o=c,s=0;s<p;++s)t<=(d=e[s])&&d<o&&(o=d);for(o-t>m((c-r)/(y=n+1))&&T("overflow"),r+=(o-t)*y,t=o,s=0;s<p;++s)if((d=e[s])<t&&++r>c&&T("overflow"),d==t){for(l=r,h=u;!(l<(f=h<=a?1:a+26<=h?26:h-a));h+=u)C=l-f,v=u-f,I.push(g(b(f+C%v,0))),l=m(C/v);I.push(g(b(l,0))),a=S(r,y,n==i),r=0,++n}++r,++t}return I.join("")}if(o={version:"1.4.1",ucs2:{decode:E,encode:C},decode:I,encode:x,toASCII:function(e){return v(e,(function(e){return f.test(e)?"xn--"+x(e):e}))},toUnicode:function(e){return v(e,(function(e){return h.test(e)?I(e.slice(4).toLowerCase()):e}))}},"function"==typeof define&&"object"==_typeof(define.amd)&&define.amd)define("punycode",(function(){return o}));else if(i&&a)if(t.exports==i)a.exports=o;else for(l in o)o.hasOwnProperty(l)&&(i[l]=o[l]);else n.punycode=o}(this)}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],114:[function(e,t,r){"use strict";t.exports=function(e,t,r,i){t=t||"&",r=r||"=";var a={};if("string"!=typeof e||0===e.length)return a;var s=/\+/g;e=e.split(t);var o=1e3;i&&"number"==typeof i.maxKeys&&(o=i.maxKeys);var l,c,u=e.length;0<o&&o<u&&(u=o);for(var h=0;h<u;++h){var f,d,p,m,g=e[h].replace(s,"%20"),T=g.indexOf(r);d=0<=T?(f=g.substr(0,T),g.substr(T+1)):(f=g,""),p=decodeURIComponent(f),m=decodeURIComponent(d),l=a,c=p,Object.prototype.hasOwnProperty.call(l,c)?n(a[p])?a[p].push(m):a[p]=[a[p],m]:a[p]=m}return a};var n=Array.isArray||function(e){return"[object Array]"===Object.prototype.toString.call(e)}},{}],115:[function(e,t,r){"use strict";var n=function(e){switch(_typeof(e)){case"string":return e;case"boolean":return e?"true":"false";case"number":return isFinite(e)?e:"";default:return""}};t.exports=function(e,t,r,o){return t=t||"&",r=r||"=",null===e&&(e=void 0),"object"==_typeof(e)?a(s(e),(function(s){var o=encodeURIComponent(n(s))+r;return i(e[s])?a(e[s],(function(e){return o+encodeURIComponent(n(e))})).join(t):o+encodeURIComponent(n(e[s]))})).join(t):o?encodeURIComponent(n(o))+r+encodeURIComponent(n(e)):""};var i=Array.isArray||function(e){return"[object Array]"===Object.prototype.toString.call(e)};function a(e,t){if(e.map)return e.map(t);for(var r=[],n=0;n<e.length;n++)r.push(t(e[n],n));return r}var s=Object.keys||function(e){var t=[];for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.push(r);return t}},{}],116:[function(e,t,r){"use strict";r.decode=r.parse=e("./decode"),r.encode=r.stringify=e("./encode")},{"./decode":114,"./encode":115}],117:[function(e,t,r){"use strict";var n=e("process-nextick-args"),i=Object.keys||function(e){var t=[];for(var r in e)t.push(r);return t};t.exports=h;var a=e("core-util-is");a.inherits=e("inherits");var s=e("./_stream_readable"),o=e("./_stream_writable");a.inherits(h,s);for(var l=i(o.prototype),c=0;c<l.length;c++){var u=l[c];h.prototype[u]||(h.prototype[u]=o.prototype[u])}function h(e){if(!(this instanceof h))return new h(e);s.call(this,e),o.call(this,e),e&&!1===e.readable&&(this.readable=!1),e&&!1===e.writable&&(this.writable=!1),this.allowHalfOpen=!0,e&&!1===e.allowHalfOpen&&(this.allowHalfOpen=!1),this.once("end",f)}function f(){this.allowHalfOpen||this._writableState.ended||n.nextTick(d,this)}function d(e){e.end()}Object.defineProperty(h.prototype,"writableHighWaterMark",{enumerable:!1,get:function(){return this._writableState.highWaterMark}}),Object.defineProperty(h.prototype,"destroyed",{get:function(){return void 0!==this._readableState&&void 0!==this._writableState&&this._readableState.destroyed&&this._writableState.destroyed},set:function(e){void 0!==this._readableState&&void 0!==this._writableState&&(this._readableState.destroyed=e,this._writableState.destroyed=e)}}),h.prototype._destroy=function(e,t){this.push(null),this.end(),n.nextTick(t,e)}},{"./_stream_readable":119,"./_stream_writable":121,"core-util-is":101,inherits:106,"process-nextick-args":111}],118:[function(e,t,r){"use strict";t.exports=a;var n=e("./_stream_transform"),i=e("core-util-is");function a(e){if(!(this instanceof a))return new a(e);n.call(this,e)}i.inherits=e("inherits"),i.inherits(a,n),a.prototype._transform=function(e,t,r){r(null,e)}},{"./_stream_transform":120,"core-util-is":101,inherits:106}],119:[function(e,t,r){(function(r,n){"use strict";var i=e("process-nextick-args");t.exports=v;var a,s=e("isarray");v.ReadableState=y,e("events").EventEmitter;var o=function(e,t){return e.listeners(t).length},l=e("./internal/streams/stream"),c=e("safe-buffer").Buffer,u=n.Uint8Array||function(){},h=e("core-util-is");h.inherits=e("inherits");var f=e("util"),d=void 0;d=f&&f.debuglog?f.debuglog("stream"):function(){};var p,m=e("./internal/streams/BufferList"),g=e("./internal/streams/destroy");h.inherits(v,l);var T=["error","close","destroy","pause","resume"];function y(t,r){t=t||{};var n=r instanceof(a=a||e("./_stream_duplex"));this.objectMode=!!t.objectMode,n&&(this.objectMode=this.objectMode||!!t.readableObjectMode);var i=t.highWaterMark,s=t.readableHighWaterMark,o=this.objectMode?16:16384;this.highWaterMark=i||0===i?i:n&&(s||0===s)?s:o,this.highWaterMark=Math.floor(this.highWaterMark),this.buffer=new m,this.length=0,this.pipes=null,this.pipesCount=0,this.flowing=null,this.ended=!1,this.endEmitted=!1,this.reading=!1,this.sync=!0,this.needReadable=!1,this.emittedReadable=!1,this.readableListening=!1,this.resumeScheduled=!1,this.destroyed=!1,this.defaultEncoding=t.defaultEncoding||"utf8",this.awaitDrain=0,this.readingMore=!1,this.decoder=null,this.encoding=null,t.encoding&&(p||(p=e("string_decoder/").StringDecoder),this.decoder=new p(t.encoding),this.encoding=t.encoding)}function v(t){if(a=a||e("./_stream_duplex"),!(this instanceof v))return new v(t);this._readableState=new y(t,this),this.readable=!0,t&&("function"==typeof t.read&&(this._read=t.read),"function"==typeof t.destroy&&(this._destroy=t.destroy)),l.call(this)}function E(e,t,r,n,i){var a,s,o,l=e._readableState;return null===t?(l.reading=!1,function(e,t){if(!t.ended){if(t.decoder){var r=t.decoder.end();r&&r.length&&(t.buffer.push(r),t.length+=t.objectMode?1:r.length)}t.ended=!0,I(e)}}(e,l)):(i||(a=function(e,t){var r,n;return n=t,c.isBuffer(n)||n instanceof u||"string"==typeof t||void 0===t||e.objectMode||(r=new TypeError("Invalid non-string/buffer chunk")),r}(l,t)),a?e.emit("error",a):l.objectMode||t&&0<t.length?("string"==typeof t||l.objectMode||Object.getPrototypeOf(t)===c.prototype||(s=t,t=c.from(s)),n?l.endEmitted?e.emit("error",new Error("stream.unshift() after end event")):C(e,l,t,!0):l.ended?e.emit("error",new Error("stream.push() after EOF")):(l.reading=!1,l.decoder&&!r?(t=l.decoder.write(t),l.objectMode||0!==t.length?C(e,l,t,!1):P(e,l)):C(e,l,t,!1))):n||(l.reading=!1)),!(o=l).ended&&(o.needReadable||o.length<o.highWaterMark||0===o.length)}function C(e,t,r,n){t.flowing&&0===t.length&&!t.sync?(e.emit("data",r),e.read(0)):(t.length+=t.objectMode?1:r.length,n?t.buffer.unshift(r):t.buffer.push(r),t.needReadable&&I(e)),P(e,t)}Object.defineProperty(v.prototype,"destroyed",{get:function(){return void 0!==this._readableState&&this._readableState.destroyed},set:function(e){this._readableState&&(this._readableState.destroyed=e)}}),v.prototype.destroy=g.destroy,v.prototype._undestroy=g.undestroy,v.prototype._destroy=function(e,t){this.push(null),t(e)},v.prototype.push=function(e,t){var r,n=this._readableState;return n.objectMode?r=!0:"string"==typeof e&&((t=t||n.defaultEncoding)!==n.encoding&&(e=c.from(e,t),t=""),r=!0),E(this,e,t,!1,r)},v.prototype.unshift=function(e){return E(this,e,null,!0,!1)},v.prototype.isPaused=function(){return!1===this._readableState.flowing},v.prototype.setEncoding=function(t){return p||(p=e("string_decoder/").StringDecoder),this._readableState.decoder=new p(t),this._readableState.encoding=t,this};var b=8388608;function S(e,t){return e<=0||0===t.length&&t.ended?0:t.objectMode?1:e!=e?t.flowing&&t.length?t.buffer.head.data.length:t.length:(e>t.highWaterMark&&(t.highWaterMark=(b<=(r=e)?r=b:(r--,r|=r>>>1,r|=r>>>2,r|=r>>>4,r|=r>>>8,r|=r>>>16,r++),r)),e<=t.length?e:t.ended?t.length:(t.needReadable=!0,0));var r}function I(e){var t=e._readableState;t.needReadable=!1,t.emittedReadable||(d("emitReadable",t.flowing),t.emittedReadable=!0,t.sync?i.nextTick(x,e):x(e))}function x(e){d("emit readable"),e.emit("readable"),A(e)}function P(e,t){t.readingMore||(t.readingMore=!0,i.nextTick(w,e,t))}function w(e,t){for(var r=t.length;!t.reading&&!t.flowing&&!t.ended&&t.length<t.highWaterMark&&(d("maybeReadMore read 0"),e.read(0),r!==t.length);)r=t.length;t.readingMore=!1}function D(e){d("readable nexttick read 0"),e.read(0)}function _(e,t){t.reading||(d("resume read 0"),e.read(0)),t.resumeScheduled=!1,t.awaitDrain=0,e.emit("resume"),A(e),t.flowing&&!t.reading&&e.read(0)}function A(e){var t=e._readableState;for(d("flow",t.flowing);t.flowing&&null!==e.read(););}function R(e,t){return 0===t.length?null:(t.objectMode?r=t.buffer.shift():!e||e>=t.length?(r=t.decoder?t.buffer.join(""):1===t.buffer.length?t.buffer.head.data:t.buffer.concat(t.length),t.buffer.clear()):r=function(e,t,r){var n;return e<t.head.data.length?(n=t.head.data.slice(0,e),t.head.data=t.head.data.slice(e)):n=e===t.head.data.length?t.shift():r?function(e,t){var r=t.head,n=1,i=r.data;for(e-=i.length;r=r.next;){var a=r.data,s=e>a.length?a.length:e;if(s===a.length?i+=a:i+=a.slice(0,e),0==(e-=s)){s===a.length?(++n,r.next?t.head=r.next:t.head=t.tail=null):(t.head=r).data=a.slice(s);break}++n}return t.length-=n,i}(e,t):function(e,t){var r=c.allocUnsafe(e),n=t.head,i=1;for(n.data.copy(r),e-=n.data.length;n=n.next;){var a=n.data,s=e>a.length?a.length:e;if(a.copy(r,r.length-e,0,s),0==(e-=s)){s===a.length?(++i,n.next?t.head=n.next:t.head=t.tail=null):(t.head=n).data=a.slice(s);break}++i}return t.length-=i,r}(e,t),n}(e,t.buffer,t.decoder),r);var r}function M(e){var t=e._readableState;if(0<t.length)throw new Error('"endReadable()" called on non-empty stream');t.endEmitted||(t.ended=!0,i.nextTick(N,t,e))}function N(e,t){e.endEmitted||0!==e.length||(e.endEmitted=!0,t.readable=!1,t.emit("end"))}function k(e,t){for(var r=0,n=e.length;r<n;r++)if(e[r]===t)return r;return-1}v.prototype.read=function(e){d("read",e),e=parseInt(e,10);var t=this._readableState,r=e;if(0!==e&&(t.emittedReadable=!1),0===e&&t.needReadable&&(t.length>=t.highWaterMark||t.ended))return d("read: emitReadable",t.length,t.ended),0===t.length&&t.ended?M(this):I(this),null;if(0===(e=S(e,t))&&t.ended)return 0===t.length&&M(this),null;var n,i=t.needReadable;return d("need readable",i),(0===t.length||t.length-e<t.highWaterMark)&&d("length less than watermark",i=!0),t.ended||t.reading?d("reading or ended",i=!1):i&&(d("do read"),t.reading=!0,t.sync=!0,0===t.length&&(t.needReadable=!0),this._read(t.highWaterMark),t.sync=!1,t.reading||(e=S(r,t))),null===(n=0<e?R(e,t):null)?(t.needReadable=!0,e=0):t.length-=e,0===t.length&&(t.ended||(t.needReadable=!0),r!==e&&t.ended&&M(this)),null!==n&&this.emit("data",n),n},v.prototype._read=function(e){this.emit("error",new Error("_read() is not implemented"))},v.prototype.pipe=function(e,t){var n=this,a=this._readableState;switch(a.pipesCount){case 0:a.pipes=e;break;case 1:a.pipes=[a.pipes,e];break;default:a.pipes.push(e)}a.pipesCount+=1,d("pipe count=%d opts=%j",a.pipesCount,t);var l=t&&!1===t.end||e===r.stdout||e===r.stderr?v:c;function c(){d("onend"),e.end()}a.endEmitted?i.nextTick(l):n.once("end",l),e.on("unpipe",(function t(r,i){d("onunpipe"),r===n&&i&&!1===i.hasUnpiped&&(i.hasUnpiped=!0,d("cleanup"),e.removeListener("close",T),e.removeListener("finish",y),e.removeListener("drain",h),e.removeListener("error",g),e.removeListener("unpipe",t),n.removeListener("end",c),n.removeListener("end",v),n.removeListener("data",m),f=!0,!a.awaitDrain||e._writableState&&!e._writableState.needDrain||h())}));var u,h=(u=n,function(){var e=u._readableState;d("pipeOnDrain",e.awaitDrain),e.awaitDrain&&e.awaitDrain--,0===e.awaitDrain&&o(u,"data")&&(e.flowing=!0,A(u))});e.on("drain",h);var f=!1,p=!1;function m(t){d("ondata"),(p=!1)!==e.write(t)||p||((1===a.pipesCount&&a.pipes===e||1<a.pipesCount&&-1!==k(a.pipes,e))&&!f&&(d("false write response, pause",n._readableState.awaitDrain),n._readableState.awaitDrain++,p=!0),n.pause())}function g(t){d("onerror",t),v(),e.removeListener("error",g),0===o(e,"error")&&e.emit("error",t)}function T(){e.removeListener("finish",y),v()}function y(){d("onfinish"),e.removeListener("close",T),v()}function v(){d("unpipe"),n.unpipe(e)}return n.on("data",m),function(e,t,r){if("function"==typeof e.prependListener)return e.prependListener(t,r);e._events&&e._events[t]?s(e._events[t])?e._events[t].unshift(r):e._events[t]=[r,e._events[t]]:e.on(t,r)}(e,"error",g),e.once("close",T),e.once("finish",y),e.emit("pipe",n),a.flowing||(d("pipe resume"),n.resume()),e},v.prototype.unpipe=function(e){var t=this._readableState,r={hasUnpiped:!1};if(0===t.pipesCount)return this;if(1===t.pipesCount)return e&&e!==t.pipes||(e||(e=t.pipes),t.pipes=null,t.pipesCount=0,t.flowing=!1,e&&e.emit("unpipe",this,r)),this;if(!e){var n=t.pipes,i=t.pipesCount;t.pipes=null,t.pipesCount=0,t.flowing=!1;for(var a=0;a<i;a++)n[a].emit("unpipe",this,r);return this}var s=k(t.pipes,e);return-1===s||(t.pipes.splice(s,1),t.pipesCount-=1,1===t.pipesCount&&(t.pipes=t.pipes[0]),e.emit("unpipe",this,r)),this},v.prototype.addListener=v.prototype.on=function(e,t){var r=l.prototype.on.call(this,e,t);if("data"===e)!1!==this._readableState.flowing&&this.resume();else if("readable"===e){var n=this._readableState;n.endEmitted||n.readableListening||(n.readableListening=n.needReadable=!0,n.emittedReadable=!1,n.reading?n.length&&I(this):i.nextTick(D,this))}return r},v.prototype.resume=function(){var e,t=this._readableState;return t.flowing||(d("resume"),t.flowing=!0,this,(e=t).resumeScheduled||(e.resumeScheduled=!0,i.nextTick(_,this,e))),this},v.prototype.pause=function(){return d("call pause flowing=%j",this._readableState.flowing),!1!==this._readableState.flowing&&(d("pause"),this._readableState.flowing=!1,this.emit("pause")),this},v.prototype.wrap=function(e){var t=this,r=this._readableState,n=!1;for(var i in e.on("end",(function(){if(d("wrapped end"),r.decoder&&!r.ended){var e=r.decoder.end();e&&e.length&&t.push(e)}t.push(null)})),e.on("data",(function(i){d("wrapped data"),r.decoder&&(i=r.decoder.write(i)),r.objectMode&&null==i||(r.objectMode||i&&i.length)&&(t.push(i)||(n=!0,e.pause()))})),e)void 0===this[i]&&"function"==typeof e[i]&&(this[i]=function(t){return function(){return e[t].apply(e,arguments)}}(i));for(var a=0;a<T.length;a++)e.on(T[a],this.emit.bind(this,T[a]));return this._read=function(t){d("wrapped _read",t),n&&(n=!1,e.resume())},this},Object.defineProperty(v.prototype,"readableHighWaterMark",{enumerable:!1,get:function(){return this._readableState.highWaterMark}}),v._fromList=R}).call(this,e("_process"),"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./_stream_duplex":117,"./internal/streams/BufferList":122,"./internal/streams/destroy":123,"./internal/streams/stream":124,_process:112,"core-util-is":101,events:102,inherits:106,isarray:108,"process-nextick-args":111,"safe-buffer":143,"string_decoder/":159,util:2}],120:[function(e,t,r){"use strict";t.exports=a;var n=e("./_stream_duplex"),i=e("core-util-is");function a(e){if(!(this instanceof a))return new a(e);n.call(this,e),this._transformState={afterTransform:function(e,t){var r=this._transformState;r.transforming=!1;var n=r.writecb;if(!n)return this.emit("error",new Error("write callback called multiple times"));r.writechunk=null,(r.writecb=null)!=t&&this.push(t),n(e);var i=this._readableState;i.reading=!1,(i.needReadable||i.length<i.highWaterMark)&&this._read(i.highWaterMark)}.bind(this),needTransform:!1,transforming:!1,writecb:null,writechunk:null,writeencoding:null},this._readableState.needReadable=!0,this._readableState.sync=!1,e&&("function"==typeof e.transform&&(this._transform=e.transform),"function"==typeof e.flush&&(this._flush=e.flush)),this.on("prefinish",s)}function s(){var e=this;"function"==typeof this._flush?this._flush((function(t,r){o(e,t,r)})):o(this,null,null)}function o(e,t,r){if(t)return e.emit("error",t);if(null!=r&&e.push(r),e._writableState.length)throw new Error("Calling transform done when ws.length != 0");if(e._transformState.transforming)throw new Error("Calling transform done when still transforming");return e.push(null)}i.inherits=e("inherits"),i.inherits(a,n),a.prototype.push=function(e,t){return this._transformState.needTransform=!1,n.prototype.push.call(this,e,t)},a.prototype._transform=function(e,t,r){throw new Error("_transform() is not implemented")},a.prototype._write=function(e,t,r){var n=this._transformState;if(n.writecb=r,n.writechunk=e,n.writeencoding=t,!n.transforming){var i=this._readableState;(n.needTransform||i.needReadable||i.length<i.highWaterMark)&&this._read(i.highWaterMark)}},a.prototype._read=function(e){var t=this._transformState;null!==t.writechunk&&t.writecb&&!t.transforming?(t.transforming=!0,this._transform(t.writechunk,t.writeencoding,t.afterTransform)):t.needTransform=!0},a.prototype._destroy=function(e,t){var r=this;n.prototype._destroy.call(this,e,(function(e){t(e),r.emit("close")}))}},{"./_stream_duplex":117,"core-util-is":101,inherits:106}],121:[function(e,t,r){(function(r,n,i){"use strict";var a=e("process-nextick-args");function s(e){var t=this;this.next=null,this.entry=null,this.finish=function(){!function(e,t,r){var n=e.entry;for(e.entry=null;n;){var i=n.callback;t.pendingcb--,i(void 0),n=n.next}t.corkedRequestsFree?t.corkedRequestsFree.next=e:t.corkedRequestsFree=e}(t,e)}}t.exports=y;var o,l=!r.browser&&-1<["v0.10","v0.9."].indexOf(r.version.slice(0,5))?i:a.nextTick;y.WritableState=T;var c=e("core-util-is");c.inherits=e("inherits");var u,h={deprecate:e("util-deprecate")},f=e("./internal/streams/stream"),d=e("safe-buffer").Buffer,p=n.Uint8Array||function(){},m=e("./internal/streams/destroy");function g(){}function T(t,r){o=o||e("./_stream_duplex"),t=t||{};var n=r instanceof o;this.objectMode=!!t.objectMode,n&&(this.objectMode=this.objectMode||!!t.writableObjectMode);var i=t.highWaterMark,c=t.writableHighWaterMark,u=this.objectMode?16:16384;this.highWaterMark=i||0===i?i:n&&(c||0===c)?c:u,this.highWaterMark=Math.floor(this.highWaterMark),this.finalCalled=!1,this.needDrain=!1,this.ending=!1,this.ended=!1,this.finished=!1;var h=(this.destroyed=!1)===t.decodeStrings;this.decodeStrings=!h,this.defaultEncoding=t.defaultEncoding||"utf8",this.length=0,this.writing=!1,this.corked=0,this.sync=!0,this.bufferProcessing=!1,this.onwrite=function(e){!function(e,t){var r,n,i,s,o,c,u=e._writableState,h=u.sync,f=u.writecb;if((c=u).writing=!1,c.writecb=null,c.length-=c.writelen,c.writelen=0,t)r=e,i=h,s=t,o=f,--(n=u).pendingcb,i?(a.nextTick(o,s),a.nextTick(I,r,n),r._writableState.errorEmitted=!0,r.emit("error",s)):(o(s),r._writableState.errorEmitted=!0,r.emit("error",s),I(r,n));else{var d=b(u);d||u.corked||u.bufferProcessing||!u.bufferedRequest||C(e,u),h?l(E,e,u,d,f):E(e,u,d,f)}}(r,e)},this.writecb=null,this.writelen=0,this.bufferedRequest=null,this.lastBufferedRequest=null,this.pendingcb=0,this.prefinished=!1,this.errorEmitted=!1,this.bufferedRequestCount=0,this.corkedRequestsFree=new s(this)}function y(t){if(o=o||e("./_stream_duplex"),!(u.call(y,this)||this instanceof o))return new y(t);this._writableState=new T(t,this),this.writable=!0,t&&("function"==typeof t.write&&(this._write=t.write),"function"==typeof t.writev&&(this._writev=t.writev),"function"==typeof t.destroy&&(this._destroy=t.destroy),"function"==typeof t.final&&(this._final=t.final)),f.call(this)}function v(e,t,r,n,i,a,s){t.writelen=n,t.writecb=s,t.writing=!0,t.sync=!0,r?e._writev(i,t.onwrite):e._write(i,a,t.onwrite),t.sync=!1}function E(e,t,r,n){var i,a;r||(i=e,0===(a=t).length&&a.needDrain&&(a.needDrain=!1,i.emit("drain"))),t.pendingcb--,n(),I(e,t)}function C(e,t){t.bufferProcessing=!0;var r=t.bufferedRequest;if(e._writev&&r&&r.next){var n=t.bufferedRequestCount,i=new Array(n),a=t.corkedRequestsFree;a.entry=r;for(var o=0,l=!0;r;)(i[o]=r).isBuf||(l=!1),r=r.next,o+=1;i.allBuffers=l,v(e,t,!0,t.length,i,"",a.finish),t.pendingcb++,t.lastBufferedRequest=null,a.next?(t.corkedRequestsFree=a.next,a.next=null):t.corkedRequestsFree=new s(t),t.bufferedRequestCount=0}else{for(;r;){var c=r.chunk,u=r.encoding,h=r.callback;if(v(e,t,!1,t.objectMode?1:c.length,c,u,h),r=r.next,t.bufferedRequestCount--,t.writing)break}null===r&&(t.lastBufferedRequest=null)}t.bufferedRequest=r,t.bufferProcessing=!1}function b(e){return e.ending&&0===e.length&&null===e.bufferedRequest&&!e.finished&&!e.writing}function S(e,t){e._final((function(r){t.pendingcb--,r&&e.emit("error",r),t.prefinished=!0,e.emit("prefinish"),I(e,t)}))}function I(e,t){var r,n,i=b(t);return i&&(r=e,(n=t).prefinished||n.finalCalled||("function"==typeof r._final?(n.pendingcb++,n.finalCalled=!0,a.nextTick(S,r,n)):(n.prefinished=!0,r.emit("prefinish"))),0===t.pendingcb&&(t.finished=!0,e.emit("finish"))),i}c.inherits(y,f),T.prototype.getBuffer=function(){for(var e=this.bufferedRequest,t=[];e;)t.push(e),e=e.next;return t},function(){try{Object.defineProperty(T.prototype,"buffer",{get:h.deprecate((function(){return this.getBuffer()}),"_writableState.buffer is deprecated. Use _writableState.getBuffer instead.","DEP0003")})}catch(e){}}(),"function"==typeof Symbol&&Symbol.hasInstance&&"function"==typeof Function.prototype[Symbol.hasInstance]?(u=Function.prototype[Symbol.hasInstance],Object.defineProperty(y,Symbol.hasInstance,{value:function(e){return!!u.call(this,e)||this===y&&e&&e._writableState instanceof T}})):u=function(e){return e instanceof this},y.prototype.pipe=function(){this.emit("error",new Error("Cannot pipe, not readable"))},y.prototype.write=function(e,t,r){var n,i,s,o,l,c,u,h,f,m=this._writableState,T=!1,y=!m.objectMode&&(n=e,d.isBuffer(n)||n instanceof p);return y&&!d.isBuffer(e)&&(i=e,e=d.from(i)),"function"==typeof t&&(r=t,t=null),y?t="buffer":t||(t=m.defaultEncoding),"function"!=typeof r&&(r=g),m.ended?(this,h=r,f=new Error("write after end"),this.emit("error",f),a.nextTick(h,f)):(y||(this,s=m,l=r,u=!(c=!0),null===(o=e)?u=new TypeError("May not write null values to stream"):"string"==typeof o||void 0===o||s.objectMode||(u=new TypeError("Invalid non-string/buffer chunk")),u&&(this.emit("error",u),a.nextTick(l,u),c=!1),c))&&(m.pendingcb++,T=function(e,t,r,n,i,a){if(!r){var s=function(e,t,r){return e.objectMode||!1===e.decodeStrings||"string"!=typeof t||(t=d.from(t,r)),t}(t,n,i);n!==s&&(r=!0,i="buffer",n=s)}var o=t.objectMode?1:n.length;t.length+=o;var l=t.length<t.highWaterMark;if(l||(t.needDrain=!0),t.writing||t.corked){var c=t.lastBufferedRequest;t.lastBufferedRequest={chunk:n,encoding:i,isBuf:r,callback:a,next:null},c?c.next=t.lastBufferedRequest:t.bufferedRequest=t.lastBufferedRequest,t.bufferedRequestCount+=1}else v(e,t,!1,o,n,i,a);return l}(this,m,y,e,t,r)),T},y.prototype.cork=function(){this._writableState.corked++},y.prototype.uncork=function(){var e=this._writableState;e.corked&&(e.corked--,e.writing||e.corked||e.finished||e.bufferProcessing||!e.bufferedRequest||C(this,e))},y.prototype.setDefaultEncoding=function(e){if("string"==typeof e&&(e=e.toLowerCase()),!(-1<["hex","utf8","utf-8","ascii","binary","base64","ucs2","ucs-2","utf16le","utf-16le","raw"].indexOf((e+"").toLowerCase())))throw new TypeError("Unknown encoding: "+e);return this._writableState.defaultEncoding=e,this},Object.defineProperty(y.prototype,"writableHighWaterMark",{enumerable:!1,get:function(){return this._writableState.highWaterMark}}),y.prototype._write=function(e,t,r){r(new Error("_write() is not implemented"))},y.prototype._writev=null,y.prototype.end=function(e,t,r){var n=this._writableState;"function"==typeof e?(r=e,t=e=null):"function"==typeof t&&(r=t,t=null),null!=e&&this.write(e,t),n.corked&&(n.corked=1,this.uncork()),n.ending||n.finished||function(e,t,r){t.ending=!0,I(e,t),r&&(t.finished?a.nextTick(r):e.once("finish",r)),t.ended=!0,e.writable=!1}(this,n,r)},Object.defineProperty(y.prototype,"destroyed",{get:function(){return void 0!==this._writableState&&this._writableState.destroyed},set:function(e){this._writableState&&(this._writableState.destroyed=e)}}),y.prototype.destroy=m.destroy,y.prototype._undestroy=m.undestroy,y.prototype._destroy=function(e,t){this.end(),t(e)}}).call(this,e("_process"),"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{},e("timers").setImmediate)},{"./_stream_duplex":117,"./internal/streams/destroy":123,"./internal/streams/stream":124,_process:112,"core-util-is":101,inherits:106,"process-nextick-args":111,"safe-buffer":143,timers:160,"util-deprecate":164}],122:[function(e,t,r){"use strict";var n=e("safe-buffer").Buffer,i=e("util");t.exports=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.head=null,this.tail=null,this.length=0}return e.prototype.push=function(e){var t={data:e,next:null};0<this.length?this.tail.next=t:this.head=t,this.tail=t,++this.length},e.prototype.unshift=function(e){var t={data:e,next:this.head};0===this.length&&(this.tail=t),this.head=t,++this.length},e.prototype.shift=function(){if(0!==this.length){var e=this.head.data;return 1===this.length?this.head=this.tail=null:this.head=this.head.next,--this.length,e}},e.prototype.clear=function(){this.head=this.tail=null,this.length=0},e.prototype.join=function(e){if(0===this.length)return"";for(var t=this.head,r=""+t.data;t=t.next;)r+=e+t.data;return r},e.prototype.concat=function(e){if(0===this.length)return n.alloc(0);if(1===this.length)return this.head.data;for(var t,r,i=n.allocUnsafe(e>>>0),a=this.head,s=0;a;)t=i,r=s,a.data.copy(t,r),s+=a.data.length,a=a.next;return i},e}(),i&&i.inspect&&i.inspect.custom&&(t.exports.prototype[i.inspect.custom]=function(){var e=i.inspect({length:this.length});return this.constructor.name+" "+e})},{"safe-buffer":143,util:2}],123:[function(e,t,r){"use strict";var n=e("process-nextick-args");function i(e,t){e.emit("error",t)}t.exports={destroy:function(e,t){var r=this,a=this._readableState&&this._readableState.destroyed,s=this._writableState&&this._writableState.destroyed;return a||s?t?t(e):!e||this._writableState&&this._writableState.errorEmitted||n.nextTick(i,this,e):(this._readableState&&(this._readableState.destroyed=!0),this._writableState&&(this._writableState.destroyed=!0),this._destroy(e||null,(function(e){!t&&e?(n.nextTick(i,r,e),r._writableState&&(r._writableState.errorEmitted=!0)):t&&t(e)}))),this},undestroy:function(){this._readableState&&(this._readableState.destroyed=!1,this._readableState.reading=!1,this._readableState.ended=!1,this._readableState.endEmitted=!1),this._writableState&&(this._writableState.destroyed=!1,this._writableState.ended=!1,this._writableState.ending=!1,this._writableState.finished=!1,this._writableState.errorEmitted=!1)}}},{"process-nextick-args":111}],124:[function(e,t,r){t.exports=e("events").EventEmitter},{events:102}],125:[function(e,t,r){(((r=t.exports=e("./lib/_stream_readable.js")).Stream=r).Readable=r).Writable=e("./lib/_stream_writable.js"),r.Duplex=e("./lib/_stream_duplex.js"),r.Transform=e("./lib/_stream_transform.js"),r.PassThrough=e("./lib/_stream_passthrough.js")},{"./lib/_stream_duplex.js":117,"./lib/_stream_passthrough.js":118,"./lib/_stream_readable.js":119,"./lib/_stream_transform.js":120,"./lib/_stream_writable.js":121}],126:[function(e,t,r){"use strict";t.exports={ABSOLUTE:"absolute",PATH_RELATIVE:"pathRelative",ROOT_RELATIVE:"rootRelative",SHORTEST:"shortest"}},{}],127:[function(e,t,r){"use strict";var n=e("./constants");function i(e,t){var r=t.removeEmptyQueries&&e.extra.relation.minimumPort;return e.query.string[r?"stripped":"full"]}function a(e,t){return!e.extra.relation.minimumQuery||t.output===n.ABSOLUTE||t.output===n.ROOT_RELATIVE}function s(e,t){var r=t.removeDirectoryIndexes&&e.extra.resourceIsIndex,i=e.extra.relation.minimumResource&&t.output!==n.ABSOLUTE&&t.output!==n.ROOT_RELATIVE;return!!e.resource&&!i&&!r}t.exports=function(e,t){var r,o,l,c,u,h,f,d,p,m,g,T,y="";return y+=(o=t,l="",((r=e).extra.relation.maximumHost||o.output===n.ABSOLUTE)&&(r.extra.relation.minimumScheme&&o.schemeRelative&&o.output!==n.ABSOLUTE?l+="//":l+=r.scheme+"://"),l),y+=(u=t,!(c=e).auth||u.removeAuth||!c.extra.relation.maximumHost&&u.output!==n.ABSOLUTE?"":c.auth+"@"),y+=(f=t,(h=e).host.full&&(h.extra.relation.maximumAuth||f.output===n.ABSOLUTE)?h.host.full:""),y+=(d=e).port&&!d.extra.portIsDefault&&d.extra.relation.maximumHost?":"+d.port:"",y+=function(e,t){var r="",o=e.path.absolute.string,l=e.path.relative.string,c=s(e,t);if(e.extra.relation.maximumHost||t.output===n.ABSOLUTE||t.output===n.ROOT_RELATIVE)r=o;else if(l.length<=o.length&&t.output===n.SHORTEST||t.output===n.PATH_RELATIVE){if(""===(r=l)){var u=a(e,t)&&!!i(e,t);e.extra.relation.maximumPath&&!c?r="./":!e.extra.relation.overridesQuery||c||u||(r="./")}}else r=o;return"/"!==r||c||!t.removeRootTrailingSlash||e.extra.relation.minimumPort&&t.output!==n.ABSOLUTE||(r=""),r}(e,t),y+=s(p=e,t)?p.resource:"",(y+=a(m=e,g=t)?i(m,g):"")+((T=e).hash?T.hash:"")}},{"./constants":126}],128:[function(e,t,r){"use strict";var n=e("./constants"),i=e("./format"),a=e("./options"),s=e("./util/object"),o=e("./parse"),l=e("./relate");function c(e,t){this.options=a(t,{defaultPorts:{ftp:21,http:80,https:443},directoryIndexes:["index.html"],ignore_www:!1,output:c.SHORTEST,rejectedSchemes:["data","javascript","mailto"],removeAuth:!1,removeDirectoryIndexes:!0,removeEmptyQueries:!1,removeRootTrailingSlash:!0,schemeRelative:!0,site:void 0,slashesDenoteHost:!0}),this.from=o.from(e,this.options,null)}c.prototype.relate=function(e,t,r){if(s.isPlainObject(t)?(r=t,t=e,e=null):t||(t=e,e=null),r=a(r,this.options),e=e||r.site,!(e=o.from(e,r,this.from))||!e.href)throw new Error("from value not defined.");if(e.extra.hrefInfo.minimumPathOnly)throw new Error("from value supplied is not absolute: "+e.href);return!1===(t=o.to(t,r)).valid?t.href:(t=l(e,t,r),t=i(t,r))},c.relate=function(e,t,r){return(new c).relate(e,t,r)},s.shallowMerge(c,n),t.exports=c},{"./constants":126,"./format":127,"./options":129,"./parse":132,"./relate":139,"./util/object":141}],129:[function(e,t,r){"use strict";var n=e("./util/object");t.exports=function(e,t){if(n.isPlainObject(e)){var r={};for(var i in t)t.hasOwnProperty(i)&&(void 0!==e[i]?r[i]=(a=e[i],(s=t[i])instanceof Object&&a instanceof Object?s instanceof Array&&a instanceof Array?s.concat(a):n.shallowMerge(a,s):a):r[i]=t[i]);return r}var a,s;return t}},{"./util/object":141}],130:[function(e,t,r){"use strict";t.exports=function(e,t){if(t.ignore_www){var r=e.host.full;if(r){var n=r;0===r.indexOf("www.")&&(n=r.substr(4)),e.host.stripped=n}}}},{}],131:[function(e,t,r){"use strict";t.exports=function(e){var t=!(e.scheme||e.auth||e.host.full||e.port),r=t&&!e.path.absolute.string,n=r&&!e.resource,i=n&&!e.query.string.full.length,a=i&&!e.hash;e.extra.hrefInfo.minimumPathOnly=t,e.extra.hrefInfo.minimumResourceOnly=r,e.extra.hrefInfo.minimumQueryOnly=n,e.extra.hrefInfo.minimumHashOnly=i,e.extra.hrefInfo.empty=a}},{}],132:[function(e,t,r){"use strict";var n=e("./hrefInfo"),i=e("./host"),a=e("./path"),s=e("./port"),o=e("./query"),l=e("./urlstring"),c=e("../util/path");function u(e,t){var r=l(e,t);return!1===r.valid||(i(r,t),s(r,t),a(r,t),o(r,t),n(r)),r}t.exports={from:function(e,t,r){if(e){var n=u(e,t),i=c.resolveDotSegments(n.path.absolute.array);return n.path.absolute.array=i,n.path.absolute.string="/"+c.join(i),n}return r},to:u}},{"../util/path":142,"./host":130,"./hrefInfo":131,"./path":133,"./port":134,"./query":135,"./urlstring":136}],133:[function(e,t,r){"use strict";function n(e){if("/"===e)return[];var t=[];return e.split("/").forEach((function(e){""!==e&&t.push(e)})),t}t.exports=function(e,t){var r,i,a=e.path.absolute.string;if(a){var s=a.lastIndexOf("/");if(-1<s){if(++s<a.length){var o=a.substr(s);"."!==o&&".."!==o?(e.resource=o,a=a.substr(0,s)):a+="/"}e.path.absolute.string=a,e.path.absolute.array=n(a)}else"."===a||".."===a?(a+="/",e.path.absolute.string=a,e.path.absolute.array=n(a)):(e.resource=a,e.path.absolute.string=null);e.extra.resourceIsIndex=(r=e.resource,i=!1,t.directoryIndexes.every((function(e){return e!==r||!(i=!0)})),i)}}},{}],134:[function(e,t,r){"use strict";t.exports=function(e,t){var r=-1;for(var n in t.defaultPorts)if(n===e.scheme&&t.defaultPorts.hasOwnProperty(n)){r=t.defaultPorts[n];break}-1<r&&(r=r.toString(),null===e.port&&(e.port=r),e.extra.portIsDefault=e.port===r)}},{}],135:[function(e,t,r){"use strict";var n=Object.prototype.hasOwnProperty;function i(e,t){var r=0,i="";for(var a in e)if(""!==a&&!0===n.call(e,a)){var s=e[a];""===s&&t||(i+=1==++r?"?":"&",a=encodeURIComponent(a),i+=""!==s?a+"="+encodeURIComponent(s).replace(/%20/g,"+"):a)}return i}t.exports=function(e,t){e.query.string.full=i(e.query.object,!1),t.removeEmptyQueries&&(e.query.string.stripped=i(e.query.object,!0))}},{}],136:[function(e,t,r){"use strict";var n=e("url").parse;t.exports=function(e,t){return a=e,s=!0,t.rejectedSchemes.every((function(e){return s=!(0===a.indexOf(e+":"))})),s?((i=(r=n(e,!0,t.slashesDenoteHost)).protocol)&&i.indexOf(":")===i.length-1&&(i=i.substr(0,i.length-1)),r.host={full:r.hostname,stripped:null},r.path={absolute:{array:null,string:r.pathname},relative:{array:null,string:null}},r.query={object:r.query,string:{full:null,stripped:null}},r.extra={hrefInfo:{minimumPathOnly:null,minimumResourceOnly:null,minimumQueryOnly:null,minimumHashOnly:null,empty:null,separatorOnlyQuery:"?"===r.search},portIsDefault:null,relation:{maximumScheme:null,maximumAuth:null,maximumHost:null,maximumPort:null,maximumPath:null,maximumResource:null,maximumQuery:null,maximumHash:null,minimumScheme:null,minimumAuth:null,minimumHost:null,minimumPort:null,minimumPath:null,minimumResource:null,minimumQuery:null,minimumHash:null,overridesQuery:null},resourceIsIndex:null,slashes:r.slashes},r.resource=null,r.scheme=i,delete r.hostname,delete r.pathname,delete r.protocol,delete r.search,delete r.slashes,r):{href:e,valid:!1};var r,i,a,s}},{url:162}],137:[function(e,t,r){"use strict";var n=e("./findRelation"),i=e("../util/object"),a=e("../util/path");t.exports=function(e,t,r){var s,o,l,c;n.upToPath(e,t,r),e.extra.relation.minimumScheme&&(e.scheme=t.scheme),e.extra.relation.minimumAuth&&(e.auth=t.auth),e.extra.relation.minimumHost&&(e.host=i.clone(t.host)),e.extra.relation.minimumPort&&(o=t,(s=e).port=o.port,s.extra.portIsDefault=o.extra.portIsDefault),e.extra.relation.minimumScheme&&function(e,t){if(e.extra.relation.maximumHost||!e.extra.hrefInfo.minimumResourceOnly){var r=e.path.absolute.array,n="/";r?(e.extra.hrefInfo.minimumPathOnly&&0!==e.path.absolute.string.indexOf("/")&&(r=t.path.absolute.array.concat(r)),r=a.resolveDotSegments(r),n+=a.join(r)):r=[],e.path.absolute.array=r,e.path.absolute.string=n}else e.path=i.clone(t.path)}(e,t),n.pathOn(e,t,r),e.extra.relation.minimumResource&&(c=t,(l=e).resource=c.resource,l.extra.resourceIsIndex=c.extra.resourceIsIndex),e.extra.relation.minimumQuery&&(e.query=i.clone(t.query)),e.extra.relation.minimumHash&&(e.hash=t.hash)}},{"../util/object":141,"../util/path":142,"./findRelation":138}],138:[function(e,t,r){"use strict";t.exports={pathOn:function(e,t,r){var n=e.extra.hrefInfo.minimumQueryOnly,i=e.extra.hrefInfo.minimumHashOnly,a=e.extra.hrefInfo.empty,s=e.extra.relation.minimumPort,o=e.extra.relation.minimumScheme,l=s&&e.path.absolute.string===t.path.absolute.string,c=e.resource===t.resource||!e.resource&&t.extra.resourceIsIndex||r.removeDirectoryIndexes&&e.extra.resourceIsIndex&&!t.resource,u=l&&(c||n||i||a),h=r.removeEmptyQueries?"stripped":"full",f=e.query.string[h],d=t.query.string[h],p=u&&!!f&&f===d||(i||a)&&!e.extra.hrefInfo.separatorOnlyQuery,m=p&&e.hash===t.hash;e.extra.relation.minimumPath=l,e.extra.relation.minimumResource=u,e.extra.relation.minimumQuery=p,e.extra.relation.minimumHash=m,e.extra.relation.maximumPort=!o||o&&!l,e.extra.relation.maximumPath=!o||o&&!u,e.extra.relation.maximumResource=!o||o&&!p,e.extra.relation.maximumQuery=!o||o&&!m,e.extra.relation.maximumHash=!o||o&&!m,e.extra.relation.overridesQuery=l&&e.extra.relation.maximumResource&&!p&&!!d},upToPath:function(e,t,r){var n=e.extra.hrefInfo.minimumPathOnly,i=e.scheme===t.scheme||!e.scheme,a=i&&(e.auth===t.auth||r.removeAuth||n),s=r.ignore_www?"stripped":"full",o=a&&(e.host[s]===t.host[s]||n),l=o&&(e.port===t.port||n);e.extra.relation.minimumScheme=i,e.extra.relation.minimumAuth=a,e.extra.relation.minimumHost=o,e.extra.relation.minimumPort=l,e.extra.relation.maximumScheme=!i||i&&!a,e.extra.relation.maximumAuth=!i||i&&!o,e.extra.relation.maximumHost=!i||i&&!l}}},{}],139:[function(e,t,r){"use strict";var n=e("./absolutize"),i=e("./relativize");t.exports=function(e,t,r){return n(t,e,r),i(t,e,r),t}},{"./absolutize":137,"./relativize":140}],140:[function(e,t,r){"use strict";var n=e("../util/path");t.exports=function(e,t,r){if(e.extra.relation.minimumScheme){var i=(a=e.path.absolute.array,s=t.path.absolute.array,o=[],l=!0,c=-1,s.forEach((function(e,t){l&&(a[t]!==e?l=!1:c=t),l||o.push("..")})),a.forEach((function(e,t){c<t&&o.push(e)})),o);e.path.relative.array=i,e.path.relative.string=n.join(i)}var a,s,o,l,c}},{"../util/path":142}],141:[function(e,t,r){"use strict";t.exports={clone:function e(t){if(t instanceof Object){var r=t instanceof Array?[]:{};for(var n in t)t.hasOwnProperty(n)&&(r[n]=e(t[n]));return r}return t},isPlainObject:function(e){return!!e&&"object"==_typeof(e)&&e.constructor===Object},shallowMerge:function(e,t){if(e instanceof Object&&t instanceof Object)for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r]);return e}}},{}],142:[function(e,t,r){"use strict";t.exports={join:function(e){return 0<e.length?e.join("/")+"/":""},resolveDotSegments:function(e){var t=[];return e.forEach((function(e){".."!==e?"."!==e&&t.push(e):0<t.length&&t.splice(t.length-1,1)})),t}}},{}],143:[function(e,t,r){var n=e("buffer"),i=n.Buffer;function a(e,t){for(var r in e)t[r]=e[r]}function s(e,t,r){return i(e,t,r)}i.from&&i.alloc&&i.allocUnsafe&&i.allocUnsafeSlow?t.exports=n:(a(n,r),r.Buffer=s),a(i,s),s.from=function(e,t,r){if("number"==typeof e)throw new TypeError("Argument must not be a number");return i(e,t,r)},s.alloc=function(e,t,r){if("number"!=typeof e)throw new TypeError("Argument must be a number");var n=i(e);return void 0!==t?"string"==typeof r?n.fill(t,r):n.fill(t):n.fill(0),n},s.allocUnsafe=function(e){if("number"!=typeof e)throw new TypeError("Argument must be a number");return i(e)},s.allocUnsafeSlow=function(e){if("number"!=typeof e)throw new TypeError("Argument must be a number");return n.SlowBuffer(e)}},{buffer:4}],144:[function(e,t,r){var n=e("./util"),i=Object.prototype.hasOwnProperty,a="undefined"!=typeof Map;function s(){this._array=[],this._set=a?new Map:Object.create(null)}s.fromArray=function(e,t){for(var r=new s,n=0,i=e.length;n<i;n++)r.add(e[n],t);return r},s.prototype.size=function(){return a?this._set.size:Object.getOwnPropertyNames(this._set).length},s.prototype.add=function(e,t){var r=a?e:n.toSetString(e),s=a?this.has(e):i.call(this._set,r),o=this._array.length;s&&!t||this._array.push(e),s||(a?this._set.set(e,o):this._set[r]=o)},s.prototype.has=function(e){if(a)return this._set.has(e);var t=n.toSetString(e);return i.call(this._set,t)},s.prototype.indexOf=function(e){if(a){var t=this._set.get(e);if(0<=t)return t}else{var r=n.toSetString(e);if(i.call(this._set,r))return this._set[r]}throw new Error('"'+e+'" is not in the set.')},s.prototype.at=function(e){if(0<=e&&e<this._array.length)return this._array[e];throw new Error("No element indexed by "+e)},s.prototype.toArray=function(){return this._array.slice()},r.ArraySet=s},{"./util":153}],145:[function(e,t,r){var n=e("./base64");r.encode=function(e){for(var t,r,i="",a=(r=e)<0?1+(-r<<1):0+(r<<1);t=31&a,0<(a>>>=5)&&(t|=32),i+=n.encode(t),0<a;);return i},r.decode=function(e,t,r){var i,a,s,o,l=e.length,c=0,u=0;do{if(l<=t)throw new Error("Expected more digits in base 64 VLQ value.");if(-1===(a=n.decode(e.charCodeAt(t++))))throw new Error("Invalid base64 digit: "+e.charAt(t-1));i=!!(32&a),c+=(a&=31)<<u,u+=5}while(i);r.value=(o=(s=c)>>1,1==(1&s)?-o:o),r.rest=t}},{"./base64":146}],146:[function(e,t,r){var n="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".split("");r.encode=function(e){if(0<=e&&e<n.length)return n[e];throw new TypeError("Must be between 0 and 63: "+e)},r.decode=function(e){return 65<=e&&e<=90?e-65:97<=e&&e<=122?e-97+26:48<=e&&e<=57?e-48+52:43==e?62:47==e?63:-1}},{}],147:[function(e,t,r){r.GREATEST_LOWER_BOUND=1,r.LEAST_UPPER_BOUND=2,r.search=function(e,t,n,i){if(0===t.length)return-1;var a=function e(t,n,i,a,s,o){var l=Math.floor((n-t)/2)+t,c=s(i,a[l],!0);return 0===c?l:0<c?1<n-l?e(l,n,i,a,s,o):o==r.LEAST_UPPER_BOUND?n<a.length?n:-1:l:1<l-t?e(t,l,i,a,s,o):o==r.LEAST_UPPER_BOUND?l:t<0?-1:t}(-1,t.length,e,t,n,i||r.GREATEST_LOWER_BOUND);if(a<0)return-1;for(;0<=a-1&&0===n(t[a],t[a-1],!0);)--a;return a}},{}],148:[function(e,t,r){var n=e("./util");function i(){this._array=[],this._sorted=!0,this._last={generatedLine:-1,generatedColumn:0}}i.prototype.unsortedForEach=function(e,t){this._array.forEach(e,t)},i.prototype.add=function(e){var t,r,i,a,s,o;r=e,i=(t=this._last).generatedLine,a=r.generatedLine,s=t.generatedColumn,o=r.generatedColumn,i<a||a==i&&s<=o||n.compareByGeneratedPositionsInflated(t,r)<=0?this._last=e:this._sorted=!1,this._array.push(e)},i.prototype.toArray=function(){return this._sorted||(this._array.sort(n.compareByGeneratedPositionsInflated),this._sorted=!0),this._array},r.MappingList=i},{"./util":153}],149:[function(e,t,r){function n(e,t,r){var n=e[t];e[t]=e[r],e[r]=n}r.quickSort=function(e,t){!function e(t,r,i,a){if(i<a){var s=i-1;n(t,(u=i,h=a,Math.round(u+Math.random()*(h-u))),a);for(var o=t[a],l=i;l<a;l++)r(t[l],o)<=0&&n(t,s+=1,l);n(t,s+1,l);var c=s+1;e(t,r,i,c-1),e(t,r,c+1,a)}var u,h}(e,t,0,e.length-1)}},{}],150:[function(e,t,r){var n=e("./util"),i=e("./binary-search"),a=e("./array-set").ArraySet,s=e("./base64-vlq"),o=e("./quick-sort").quickSort;function l(e,t){var r=e;return"string"==typeof e&&(r=n.parseSourceMapInput(e)),null!=r.sections?new h(r,t):new c(r,t)}function c(e,t){var r=e;"string"==typeof e&&(r=n.parseSourceMapInput(e));var i=n.getArg(r,"version"),s=n.getArg(r,"sources"),o=n.getArg(r,"names",[]),l=n.getArg(r,"sourceRoot",null),c=n.getArg(r,"sourcesContent",null),u=n.getArg(r,"mappings"),h=n.getArg(r,"file",null);if(i!=this._version)throw new Error("Unsupported version: "+i);l&&(l=n.normalize(l)),s=s.map(String).map(n.normalize).map((function(e){return l&&n.isAbsolute(l)&&n.isAbsolute(e)?n.relative(l,e):e})),this._names=a.fromArray(o.map(String),!0),this._sources=a.fromArray(s,!0),this._absoluteSources=this._sources.toArray().map((function(e){return n.computeSourceURL(l,e,t)})),this.sourceRoot=l,this.sourcesContent=c,this._mappings=u,this._sourceMapURL=t,this.file=h}function u(){this.generatedLine=0,this.generatedColumn=0,this.source=null,this.originalLine=null,this.originalColumn=null,this.name=null}function h(e,t){var r=e;"string"==typeof e&&(r=n.parseSourceMapInput(e));var i=n.getArg(r,"version"),s=n.getArg(r,"sections");if(i!=this._version)throw new Error("Unsupported version: "+i);this._sources=new a,this._names=new a;var o={line:-1,column:0};this._sections=s.map((function(e){if(e.url)throw new Error("Support for url field in sections not implemented.");var r=n.getArg(e,"offset"),i=n.getArg(r,"line"),a=n.getArg(r,"column");if(i<o.line||i===o.line&&a<o.column)throw new Error("Section offsets must be ordered and non-overlapping.");return o=r,{generatedOffset:{generatedLine:i+1,generatedColumn:a+1},consumer:new l(n.getArg(e,"map"),t)}}))}l.fromSourceMap=function(e,t){return c.fromSourceMap(e,t)},l.prototype._version=3,l.prototype.__generatedMappings=null,Object.defineProperty(l.prototype,"_generatedMappings",{configurable:!0,enumerable:!0,get:function(){return this.__generatedMappings||this._parseMappings(this._mappings,this.sourceRoot),this.__generatedMappings}}),l.prototype.__originalMappings=null,Object.defineProperty(l.prototype,"_originalMappings",{configurable:!0,enumerable:!0,get:function(){return this.__originalMappings||this._parseMappings(this._mappings,this.sourceRoot),this.__originalMappings}}),l.prototype._charIsMappingSeparator=function(e,t){var r=e.charAt(t);return";"===r||","===r},l.prototype._parseMappings=function(e,t){throw new Error("Subclasses must implement _parseMappings")},l.GENERATED_ORDER=1,l.ORIGINAL_ORDER=2,l.GREATEST_LOWER_BOUND=1,l.LEAST_UPPER_BOUND=2,l.prototype.eachMapping=function(e,t,r){var i,a=t||null;switch(r||l.GENERATED_ORDER){case l.GENERATED_ORDER:i=this._generatedMappings;break;case l.ORIGINAL_ORDER:i=this._originalMappings;break;default:throw new Error("Unknown order of iteration.")}var s=this.sourceRoot;i.map((function(e){var t=null===e.source?null:this._sources.at(e.source);return{source:t=n.computeSourceURL(s,t,this._sourceMapURL),generatedLine:e.generatedLine,generatedColumn:e.generatedColumn,originalLine:e.originalLine,originalColumn:e.originalColumn,name:null===e.name?null:this._names.at(e.name)}}),this).forEach(e,a)},l.prototype.allGeneratedPositionsFor=function(e){var t=n.getArg(e,"line"),r={source:n.getArg(e,"source"),originalLine:t,originalColumn:n.getArg(e,"column",0)};if(r.source=this._findSourceIndex(r.source),r.source<0)return[];var a=[],s=this._findMapping(r,this._originalMappings,"originalLine","originalColumn",n.compareByOriginalPositions,i.LEAST_UPPER_BOUND);if(0<=s){var o=this._originalMappings[s];if(void 0===e.column)for(var l=o.originalLine;o&&o.originalLine===l;)a.push({line:n.getArg(o,"generatedLine",null),column:n.getArg(o,"generatedColumn",null),lastColumn:n.getArg(o,"lastGeneratedColumn",null)}),o=this._originalMappings[++s];else for(var c=o.originalColumn;o&&o.originalLine===t&&o.originalColumn==c;)a.push({line:n.getArg(o,"generatedLine",null),column:n.getArg(o,"generatedColumn",null),lastColumn:n.getArg(o,"lastGeneratedColumn",null)}),o=this._originalMappings[++s]}return a},r.SourceMapConsumer=l,(c.prototype=Object.create(l.prototype)).consumer=l,c.prototype._findSourceIndex=function(e){var t,r=e;if(null!=this.sourceRoot&&(r=n.relative(this.sourceRoot,r)),this._sources.has(r))return this._sources.indexOf(r);for(t=0;t<this._absoluteSources.length;++t)if(this._absoluteSources[t]==e)return t;return-1},c.fromSourceMap=function(e,t){var r=Object.create(c.prototype),i=r._names=a.fromArray(e._names.toArray(),!0),s=r._sources=a.fromArray(e._sources.toArray(),!0);r.sourceRoot=e._sourceRoot,r.sourcesContent=e._generateSourcesContent(r._sources.toArray(),r.sourceRoot),r.file=e._file,r._sourceMapURL=t,r._absoluteSources=r._sources.toArray().map((function(e){return n.computeSourceURL(r.sourceRoot,e,t)}));for(var l=e._mappings.toArray().slice(),h=r.__generatedMappings=[],f=r.__originalMappings=[],d=0,p=l.length;d<p;d++){var m=l[d],g=new u;g.generatedLine=m.generatedLine,g.generatedColumn=m.generatedColumn,m.source&&(g.source=s.indexOf(m.source),g.originalLine=m.originalLine,g.originalColumn=m.originalColumn,m.name&&(g.name=i.indexOf(m.name)),f.push(g)),h.push(g)}return o(r.__originalMappings,n.compareByOriginalPositions),r},c.prototype._version=3,Object.defineProperty(c.prototype,"sources",{get:function(){return this._absoluteSources.slice()}}),c.prototype._parseMappings=function(e,t){for(var r,i,a,l,c,h=1,f=0,d=0,p=0,m=0,g=0,T=e.length,y=0,v={},E={},C=[],b=[];y<T;)if(";"===e.charAt(y))h++,y++,f=0;else if(","===e.charAt(y))y++;else{for((r=new u).generatedLine=h,l=y;l<T&&!this._charIsMappingSeparator(e,l);l++);if(a=v[i=e.slice(y,l)])y+=i.length;else{for(a=[];y<l;)s.decode(e,y,E),c=E.value,y=E.rest,a.push(c);if(2===a.length)throw new Error("Found a source, but no line and column");if(3===a.length)throw new Error("Found a source and line, but no column");v[i]=a}r.generatedColumn=f+a[0],f=r.generatedColumn,1<a.length&&(r.source=m+a[1],m+=a[1],r.originalLine=d+a[2],d=r.originalLine,r.originalLine+=1,r.originalColumn=p+a[3],p=r.originalColumn,4<a.length&&(r.name=g+a[4],g+=a[4])),b.push(r),"number"==typeof r.originalLine&&C.push(r)}o(b,n.compareByGeneratedPositionsDeflated),this.__generatedMappings=b,o(C,n.compareByOriginalPositions),this.__originalMappings=C},c.prototype._findMapping=function(e,t,r,n,a,s){if(e[r]<=0)throw new TypeError("Line must be greater than or equal to 1, got "+e[r]);if(e[n]<0)throw new TypeError("Column must be greater than or equal to 0, got "+e[n]);return i.search(e,t,a,s)},c.prototype.computeColumnSpans=function(){for(var e=0;e<this._generatedMappings.length;++e){var t=this._generatedMappings[e];if(e+1<this._generatedMappings.length){var r=this._generatedMappings[e+1];if(t.generatedLine===r.generatedLine){t.lastGeneratedColumn=r.generatedColumn-1;continue}}t.lastGeneratedColumn=1/0}},c.prototype.originalPositionFor=function(e){var t={generatedLine:n.getArg(e,"line"),generatedColumn:n.getArg(e,"column")},r=this._findMapping(t,this._generatedMappings,"generatedLine","generatedColumn",n.compareByGeneratedPositionsDeflated,n.getArg(e,"bias",l.GREATEST_LOWER_BOUND));if(0<=r){var i=this._generatedMappings[r];if(i.generatedLine===t.generatedLine){var a=n.getArg(i,"source",null);null!==a&&(a=this._sources.at(a),a=n.computeSourceURL(this.sourceRoot,a,this._sourceMapURL));var s=n.getArg(i,"name",null);return null!==s&&(s=this._names.at(s)),{source:a,line:n.getArg(i,"originalLine",null),column:n.getArg(i,"originalColumn",null),name:s}}}return{source:null,line:null,column:null,name:null}},c.prototype.hasContentsOfAllSources=function(){return!!this.sourcesContent&&this.sourcesContent.length>=this._sources.size()&&!this.sourcesContent.some((function(e){return null==e}))},c.prototype.sourceContentFor=function(e,t){if(!this.sourcesContent)return null;var r=this._findSourceIndex(e);if(0<=r)return this.sourcesContent[r];var i,a=e;if(null!=this.sourceRoot&&(a=n.relative(this.sourceRoot,a)),null!=this.sourceRoot&&(i=n.urlParse(this.sourceRoot))){var s=a.replace(/^file:\/\//,"");if("file"==i.scheme&&this._sources.has(s))return this.sourcesContent[this._sources.indexOf(s)];if((!i.path||"/"==i.path)&&this._sources.has("/"+a))return this.sourcesContent[this._sources.indexOf("/"+a)]}if(t)return null;throw new Error('"'+a+'" is not in the SourceMap.')},c.prototype.generatedPositionFor=function(e){var t=n.getArg(e,"source");if((t=this._findSourceIndex(t))<0)return{line:null,column:null,lastColumn:null};var r={source:t,originalLine:n.getArg(e,"line"),originalColumn:n.getArg(e,"column")},i=this._findMapping(r,this._originalMappings,"originalLine","originalColumn",n.compareByOriginalPositions,n.getArg(e,"bias",l.GREATEST_LOWER_BOUND));if(0<=i){var a=this._originalMappings[i];if(a.source===r.source)return{line:n.getArg(a,"generatedLine",null),column:n.getArg(a,"generatedColumn",null),lastColumn:n.getArg(a,"lastGeneratedColumn",null)}}return{line:null,column:null,lastColumn:null}},r.BasicSourceMapConsumer=c,(h.prototype=Object.create(l.prototype)).constructor=l,h.prototype._version=3,Object.defineProperty(h.prototype,"sources",{get:function(){for(var e=[],t=0;t<this._sections.length;t++)for(var r=0;r<this._sections[t].consumer.sources.length;r++)e.push(this._sections[t].consumer.sources[r]);return e}}),h.prototype.originalPositionFor=function(e){var t={generatedLine:n.getArg(e,"line"),generatedColumn:n.getArg(e,"column")},r=i.search(t,this._sections,(function(e,t){return e.generatedLine-t.generatedOffset.generatedLine||e.generatedColumn-t.generatedOffset.generatedColumn})),a=this._sections[r];return a?a.consumer.originalPositionFor({line:t.generatedLine-(a.generatedOffset.generatedLine-1),column:t.generatedColumn-(a.generatedOffset.generatedLine===t.generatedLine?a.generatedOffset.generatedColumn-1:0),bias:e.bias}):{source:null,line:null,column:null,name:null}},h.prototype.hasContentsOfAllSources=function(){return this._sections.every((function(e){return e.consumer.hasContentsOfAllSources()}))},h.prototype.sourceContentFor=function(e,t){for(var r=0;r<this._sections.length;r++){var n=this._sections[r].consumer.sourceContentFor(e,!0);if(n)return n}if(t)return null;throw new Error('"'+e+'" is not in the SourceMap.')},h.prototype.generatedPositionFor=function(e){for(var t=0;t<this._sections.length;t++){var r=this._sections[t];if(-1!==r.consumer._findSourceIndex(n.getArg(e,"source"))){var i=r.consumer.generatedPositionFor(e);if(i)return{line:i.line+(r.generatedOffset.generatedLine-1),column:i.column+(r.generatedOffset.generatedLine===i.line?r.generatedOffset.generatedColumn-1:0)}}}return{line:null,column:null}},h.prototype._parseMappings=function(e,t){this.__generatedMappings=[],this.__originalMappings=[];for(var r=0;r<this._sections.length;r++)for(var i=this._sections[r],a=i.consumer._generatedMappings,s=0;s<a.length;s++){var l=a[s],c=i.consumer._sources.at(l.source);c=n.computeSourceURL(i.consumer.sourceRoot,c,this._sourceMapURL),this._sources.add(c),c=this._sources.indexOf(c);var u=null;l.name&&(u=i.consumer._names.at(l.name),this._names.add(u),u=this._names.indexOf(u));var h={source:c,generatedLine:l.generatedLine+(i.generatedOffset.generatedLine-1),generatedColumn:l.generatedColumn+(i.generatedOffset.generatedLine===l.generatedLine?i.generatedOffset.generatedColumn-1:0),originalLine:l.originalLine,originalColumn:l.originalColumn,name:u};this.__generatedMappings.push(h),"number"==typeof h.originalLine&&this.__originalMappings.push(h)}o(this.__generatedMappings,n.compareByGeneratedPositionsDeflated),o(this.__originalMappings,n.compareByOriginalPositions)},r.IndexedSourceMapConsumer=h},{"./array-set":144,"./base64-vlq":145,"./binary-search":147,"./quick-sort":149,"./util":153}],151:[function(e,t,r){var n=e("./base64-vlq"),i=e("./util"),a=e("./array-set").ArraySet,s=e("./mapping-list").MappingList;function o(e){e||(e={}),this._file=i.getArg(e,"file",null),this._sourceRoot=i.getArg(e,"sourceRoot",null),this._skipValidation=i.getArg(e,"skipValidation",!1),this._sources=new a,this._names=new a,this._mappings=new s,this._sourcesContents=null}o.prototype._version=3,o.fromSourceMap=function(e){var t=e.sourceRoot,r=new o({file:e.file,sourceRoot:t});return e.eachMapping((function(e){var n={generated:{line:e.generatedLine,column:e.generatedColumn}};null!=e.source&&(n.source=e.source,null!=t&&(n.source=i.relative(t,n.source)),n.original={line:e.originalLine,column:e.originalColumn},null!=e.name&&(n.name=e.name)),r.addMapping(n)})),e.sources.forEach((function(n){var a=n;null!==t&&(a=i.relative(t,n)),r._sources.has(a)||r._sources.add(a);var s=e.sourceContentFor(n);null!=s&&r.setSourceContent(n,s)})),r},o.prototype.addMapping=function(e){var t=i.getArg(e,"generated"),r=i.getArg(e,"original",null),n=i.getArg(e,"source",null),a=i.getArg(e,"name",null);this._skipValidation||this._validateMapping(t,r,n,a),null!=n&&(n=String(n),this._sources.has(n)||this._sources.add(n)),null!=a&&(a=String(a),this._names.has(a)||this._names.add(a)),this._mappings.add({generatedLine:t.line,generatedColumn:t.column,originalLine:null!=r&&r.line,originalColumn:null!=r&&r.column,source:n,name:a})},o.prototype.setSourceContent=function(e,t){var r=e;null!=this._sourceRoot&&(r=i.relative(this._sourceRoot,r)),null!=t?(this._sourcesContents||(this._sourcesContents=Object.create(null)),this._sourcesContents[i.toSetString(r)]=t):this._sourcesContents&&(delete this._sourcesContents[i.toSetString(r)],0===Object.keys(this._sourcesContents).length&&(this._sourcesContents=null))},o.prototype.applySourceMap=function(e,t,r){var n=t;if(null==t){if(null==e.file)throw new Error('SourceMapGenerator.prototype.applySourceMap requires either an explicit source file, or the source map\'s "file" property. Both were omitted.');n=e.file}var s=this._sourceRoot;null!=s&&(n=i.relative(s,n));var o=new a,l=new a;this._mappings.unsortedForEach((function(t){if(t.source===n&&null!=t.originalLine){var a=e.originalPositionFor({line:t.originalLine,column:t.originalColumn});null!=a.source&&(t.source=a.source,null!=r&&(t.source=i.join(r,t.source)),null!=s&&(t.source=i.relative(s,t.source)),t.originalLine=a.line,t.originalColumn=a.column,null!=a.name&&(t.name=a.name))}var c=t.source;null==c||o.has(c)||o.add(c);var u=t.name;null==u||l.has(u)||l.add(u)}),this),this._sources=o,this._names=l,e.sources.forEach((function(t){var n=e.sourceContentFor(t);null!=n&&(null!=r&&(t=i.join(r,t)),null!=s&&(t=i.relative(s,t)),this.setSourceContent(t,n))}),this)},o.prototype._validateMapping=function(e,t,r,n){if(t&&"number"!=typeof t.line&&"number"!=typeof t.column)throw new Error("original.line and original.column are not numbers -- you probably meant to omit the original mapping entirely and only map the generated position. If so, pass null for the original mapping instead of an object with empty or null values.");if((!(e&&"line"in e&&"column"in e&&0<e.line&&0<=e.column)||t||r||n)&&!(e&&"line"in e&&"column"in e&&t&&"line"in t&&"column"in t&&0<e.line&&0<=e.column&&0<t.line&&0<=t.column&&r))throw new Error("Invalid mapping: "+JSON.stringify({generated:e,source:r,original:t,name:n}))},o.prototype._serializeMappings=function(){for(var e,t,r,a,s=0,o=1,l=0,c=0,u=0,h=0,f="",d=this._mappings.toArray(),p=0,m=d.length;p<m;p++){if(e="",(t=d[p]).generatedLine!==o)for(s=0;t.generatedLine!==o;)e+=";",o++;else if(0<p){if(!i.compareByGeneratedPositionsInflated(t,d[p-1]))continue;e+=","}e+=n.encode(t.generatedColumn-s),s=t.generatedColumn,null!=t.source&&(a=this._sources.indexOf(t.source),e+=n.encode(a-h),h=a,e+=n.encode(t.originalLine-1-c),c=t.originalLine-1,e+=n.encode(t.originalColumn-l),l=t.originalColumn,null!=t.name&&(r=this._names.indexOf(t.name),e+=n.encode(r-u),u=r)),f+=e}return f},o.prototype._generateSourcesContent=function(e,t){return e.map((function(e){if(!this._sourcesContents)return null;null!=t&&(e=i.relative(t,e));var r=i.toSetString(e);return Object.prototype.hasOwnProperty.call(this._sourcesContents,r)?this._sourcesContents[r]:null}),this)},o.prototype.toJSON=function(){var e={version:this._version,sources:this._sources.toArray(),names:this._names.toArray(),mappings:this._serializeMappings()};return null!=this._file&&(e.file=this._file),null!=this._sourceRoot&&(e.sourceRoot=this._sourceRoot),this._sourcesContents&&(e.sourcesContent=this._generateSourcesContent(e.sources,e.sourceRoot)),e},o.prototype.toString=function(){return JSON.stringify(this.toJSON())},r.SourceMapGenerator=o},{"./array-set":144,"./base64-vlq":145,"./mapping-list":148,"./util":153}],152:[function(e,t,r){var n=e("./source-map-generator").SourceMapGenerator,i=e("./util"),a=/(\r?\n)/,s="$$$isSourceNode$$$";function o(e,t,r,n,i){this.children=[],this.sourceContents={},this.line=null==e?null:e,this.column=null==t?null:t,this.source=null==r?null:r,this.name=null==i?null:i,this[s]=!0,null!=n&&this.add(n)}o.fromStringWithSourceMap=function(e,t,r){var n=new o,s=e.split(a),l=0,c=function(){return e()+(e()||"");function e(){return l<s.length?s[l++]:void 0}},u=1,h=0,f=null;return t.eachMapping((function(e){if(null!==f){if(!(u<e.generatedLine)){var t=(r=s[l]||"").substr(0,e.generatedColumn-h);return s[l]=r.substr(e.generatedColumn-h),h=e.generatedColumn,d(f,t),void(f=e)}d(f,c()),u++,h=0}for(;u<e.generatedLine;)n.add(c()),u++;if(h<e.generatedColumn){var r=s[l]||"";n.add(r.substr(0,e.generatedColumn)),s[l]=r.substr(e.generatedColumn),h=e.generatedColumn}f=e}),this),l<s.length&&(f&&d(f,c()),n.add(s.splice(l).join(""))),t.sources.forEach((function(e){var a=t.sourceContentFor(e);null!=a&&(null!=r&&(e=i.join(r,e)),n.setSourceContent(e,a))})),n;function d(e,t){if(null===e||void 0===e.source)n.add(t);else{var a=r?i.join(r,e.source):e.source;n.add(new o(e.originalLine,e.originalColumn,a,t,e.name))}}},o.prototype.add=function(e){if(Array.isArray(e))e.forEach((function(e){this.add(e)}),this);else{if(!e[s]&&"string"!=typeof e)throw new TypeError("Expected a SourceNode, string, or an array of SourceNodes and strings. Got "+e);e&&this.children.push(e)}return this},o.prototype.prepend=function(e){if(Array.isArray(e))for(var t=e.length-1;0<=t;t--)this.prepend(e[t]);else{if(!e[s]&&"string"!=typeof e)throw new TypeError("Expected a SourceNode, string, or an array of SourceNodes and strings. Got "+e);this.children.unshift(e)}return this},o.prototype.walk=function(e){for(var t,r=0,n=this.children.length;r<n;r++)(t=this.children[r])[s]?t.walk(e):""!==t&&e(t,{source:this.source,line:this.line,column:this.column,name:this.name})},o.prototype.join=function(e){var t,r,n=this.children.length;if(0<n){for(t=[],r=0;r<n-1;r++)t.push(this.children[r]),t.push(e);t.push(this.children[r]),this.children=t}return this},o.prototype.replaceRight=function(e,t){var r=this.children[this.children.length-1];return r[s]?r.replaceRight(e,t):"string"==typeof r?this.children[this.children.length-1]=r.replace(e,t):this.children.push("".replace(e,t)),this},o.prototype.setSourceContent=function(e,t){this.sourceContents[i.toSetString(e)]=t},o.prototype.walkSourceContents=function(e){for(var t=0,r=this.children.length;t<r;t++)this.children[t][s]&&this.children[t].walkSourceContents(e);var n=Object.keys(this.sourceContents);for(t=0,r=n.length;t<r;t++)e(i.fromSetString(n[t]),this.sourceContents[n[t]])},o.prototype.toString=function(){var e="";return this.walk((function(t){e+=t})),e},o.prototype.toStringWithSourceMap=function(e){var t={code:"",line:1,column:0},r=new n(e),i=!1,a=null,s=null,o=null,l=null;return this.walk((function(e,n){t.code+=e,null!==n.source&&null!==n.line&&null!==n.column?(a===n.source&&s===n.line&&o===n.column&&l===n.name||r.addMapping({source:n.source,original:{line:n.line,column:n.column},generated:{line:t.line,column:t.column},name:n.name}),a=n.source,s=n.line,o=n.column,l=n.name,i=!0):i&&(r.addMapping({generated:{line:t.line,column:t.column}}),a=null,i=!1);for(var c=0,u=e.length;c<u;c++)10===e.charCodeAt(c)?(t.line++,t.column=0,c+1===u?(a=null,i=!1):i&&r.addMapping({source:n.source,original:{line:n.line,column:n.column},generated:{line:t.line,column:t.column},name:n.name})):t.column++})),this.walkSourceContents((function(e,t){r.setSourceContent(e,t)})),{code:t.code,map:r}},r.SourceNode=o},{"./source-map-generator":151,"./util":153}],153:[function(e,t,r){r.getArg=function(e,t,r){if(t in e)return e[t];if(3===arguments.length)return r;throw new Error('"'+t+'" is a required argument.')};var n=/^(?:([\w+\-.]+):)?\/\/(?:(\w+:\w+)@)?([\w.-]*)(?::(\d+))?(.*)$/,i=/^data:.+\,.+$/;function a(e){var t=e.match(n);return t?{scheme:t[1],auth:t[2],host:t[3],port:t[4],path:t[5]}:null}function s(e){var t="";return e.scheme&&(t+=e.scheme+":"),t+="//",e.auth&&(t+=e.auth+"@"),e.host&&(t+=e.host),e.port&&(t+=":"+e.port),e.path&&(t+=e.path),t}function o(e){var t=e,n=a(e);if(n){if(!n.path)return e;t=n.path}for(var i,o=r.isAbsolute(t),l=t.split(/\/+/),c=0,u=l.length-1;0<=u;u--)"."===(i=l[u])?l.splice(u,1):".."===i?c++:0<c&&(""===i?(l.splice(u+1,c),c=0):(l.splice(u,2),c--));return""===(t=l.join("/"))&&(t=o?"/":"."),n?(n.path=t,s(n)):t}function l(e,t){""===e&&(e="."),""===t&&(t=".");var r=a(t),n=a(e);if(n&&(e=n.path||"/"),r&&!r.scheme)return n&&(r.scheme=n.scheme),s(r);if(r||t.match(i))return t;if(n&&!n.host&&!n.path)return n.host=t,s(n);var l="/"===t.charAt(0)?t:o(e.replace(/\/+$/,"")+"/"+t);return n?(n.path=l,s(n)):l}r.urlParse=a,r.urlGenerate=s,r.normalize=o,r.join=l,r.isAbsolute=function(e){return"/"===e.charAt(0)||n.test(e)},r.relative=function(e,t){""===e&&(e="."),e=e.replace(/\/$/,"");for(var r=0;0!==t.indexOf(e+"/");){var n=e.lastIndexOf("/");if(n<0)return t;if((e=e.slice(0,n)).match(/^([^\/]+:\/)?\/*$/))return t;++r}return Array(r+1).join("../")+t.substr(e.length+1)};var c=!("__proto__"in Object.create(null));function u(e){return e}function h(e){if(!e)return!1;var t=e.length;if(t<9)return!1;if(95!==e.charCodeAt(t-1)||95!==e.charCodeAt(t-2)||111!==e.charCodeAt(t-3)||116!==e.charCodeAt(t-4)||111!==e.charCodeAt(t-5)||114!==e.charCodeAt(t-6)||112!==e.charCodeAt(t-7)||95!==e.charCodeAt(t-8)||95!==e.charCodeAt(t-9))return!1;for(var r=t-10;0<=r;r--)if(36!==e.charCodeAt(r))return!1;return!0}function f(e,t){return e===t?0:null===e?1:null===t?-1:t<e?1:-1}r.toSetString=c?u:function(e){return h(e)?"$"+e:e},r.fromSetString=c?u:function(e){return h(e)?e.slice(1):e},r.compareByOriginalPositions=function(e,t,r){var n=f(e.source,t.source);return 0!==n||0!=(n=e.originalLine-t.originalLine)||0!=(n=e.originalColumn-t.originalColumn)||r||0!=(n=e.generatedColumn-t.generatedColumn)||0!=(n=e.generatedLine-t.generatedLine)?n:f(e.name,t.name)},r.compareByGeneratedPositionsDeflated=function(e,t,r){var n=e.generatedLine-t.generatedLine;return 0!==n||0!=(n=e.generatedColumn-t.generatedColumn)||r||0!==(n=f(e.source,t.source))||0!=(n=e.originalLine-t.originalLine)||0!=(n=e.originalColumn-t.originalColumn)?n:f(e.name,t.name)},r.compareByGeneratedPositionsInflated=function(e,t){var r=e.generatedLine-t.generatedLine;return 0!==r||0!=(r=e.generatedColumn-t.generatedColumn)||0!==(r=f(e.source,t.source))||0!=(r=e.originalLine-t.originalLine)||0!=(r=e.originalColumn-t.originalColumn)?r:f(e.name,t.name)},r.parseSourceMapInput=function(e){return JSON.parse(e.replace(/^\)]}'[^\n]*\n/,""))},r.computeSourceURL=function(e,t,r){if(t=t||"",e&&("/"!==e[e.length-1]&&"/"!==t[0]&&(e+="/"),t=e+t),r){var n=a(r);if(!n)throw new Error("sourceMapURL could not be parsed");if(n.path){var i=n.path.lastIndexOf("/");0<=i&&(n.path=n.path.substring(0,i+1))}t=l(s(n),t)}return o(t)}},{}],154:[function(e,t,r){r.SourceMapGenerator=e("./lib/source-map-generator").SourceMapGenerator,r.SourceMapConsumer=e("./lib/source-map-consumer").SourceMapConsumer,r.SourceNode=e("./lib/source-node").SourceNode},{"./lib/source-map-consumer":150,"./lib/source-map-generator":151,"./lib/source-node":152}],155:[function(e,t,r){(function(t){var n=e("./lib/request"),i=e("./lib/response"),a=e("xtend"),s=e("builtin-status-codes"),o=e("url"),l=r;l.request=function(e,r){e="string"==typeof e?o.parse(e):a(e);var i=-1===t.location.protocol.search(/^https?:$/)?"http:":"",s=e.protocol||i,l=e.hostname||e.host,c=e.port,u=e.path||"/";l&&-1!==l.indexOf(":")&&(l="["+l+"]"),e.url=(l?s+"//"+l:"")+(c?":"+c:"")+u,e.method=(e.method||"GET").toUpperCase(),e.headers=e.headers||{};var h=new n(e);return r&&h.on("response",r),h},l.get=function(e,t){var r=l.request(e,t);return r.end(),r},l.ClientRequest=n,l.IncomingMessage=i.IncomingMessage,l.Agent=function(){},l.Agent.defaultMaxSockets=4,l.globalAgent=new l.Agent,l.STATUS_CODES=s,l.METHODS=["CHECKOUT","CONNECT","COPY","DELETE","GET","HEAD","LOCK","M-SEARCH","MERGE","MKACTIVITY","MKCOL","MOVE","NOTIFY","OPTIONS","PATCH","POST","PROPFIND","PROPPATCH","PURGE","PUT","REPORT","SEARCH","SUBSCRIBE","TRACE","UNLOCK","UNSUBSCRIBE"]}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./lib/request":157,"./lib/response":158,"builtin-status-codes":5,url:162,xtend:165}],156:[function(e,t,r){(function(e){r.fetch=o(e.fetch)&&o(e.ReadableStream),r.writableStream=o(e.WritableStream),r.abortController=o(e.AbortController),r.blobConstructor=!1;try{new Blob([new ArrayBuffer(1)]),r.blobConstructor=!0}catch(e){}var t;function n(){if(void 0!==t)return t;if(e.XMLHttpRequest){t=new e.XMLHttpRequest;try{t.open("GET",e.XDomainRequest?"/":"https://example.com")}catch(e){t=null}}else t=null;return t}function i(e){var t=n();if(!t)return!1;try{return t.responseType=e,t.responseType===e}catch(e){}return!1}var a=void 0!==e.ArrayBuffer,s=a&&o(e.ArrayBuffer.prototype.slice);function o(e){return"function"==typeof e}r.arraybuffer=r.fetch||a&&i("arraybuffer"),r.msstream=!r.fetch&&s&&i("ms-stream"),r.mozchunkedarraybuffer=!r.fetch&&a&&i("moz-chunked-arraybuffer"),r.overrideMimeType=r.fetch||!!n()&&o(n().overrideMimeType),r.vbArray=o(e.VBArray),t=null}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],157:[function(e,t,r){(function(r,n,i){var a=e("./capability"),s=e("inherits"),o=e("./response"),l=e("readable-stream"),c=e("to-arraybuffer"),u=o.IncomingMessage,h=o.readyStates,f=t.exports=function(e){var t,r=this;l.Writable.call(r),r._opts=e,r._body=[],r._headers={},e.auth&&r.setHeader("Authorization","Basic "+new i(e.auth).toString("base64")),Object.keys(e.headers).forEach((function(t){r.setHeader(t,e.headers[t])}));var n,s,o=!0;if("disable-fetch"===e.mode||"requestTimeout"in e&&!a.abortController)t=!(o=!1);else if("prefer-streaming"===e.mode)t=!1;else if("allow-wrong-content-type"===e.mode)t=!a.overrideMimeType;else{if(e.mode&&"default"!==e.mode&&"prefer-fast"!==e.mode)throw new Error("Invalid value for opts.mode");t=!0}r._mode=(n=t,s=o,a.fetch&&s?"fetch":a.mozchunkedarraybuffer?"moz-chunked-arraybuffer":a.msstream?"ms-stream":a.arraybuffer&&n?"arraybuffer":a.vbArray&&n?"text:vbarray":"text"),r._fetchTimer=null,r.on("finish",(function(){r._onFinish()}))};s(f,l.Writable),f.prototype.setHeader=function(e,t){var r=e.toLowerCase();-1===d.indexOf(r)&&(this._headers[r]={name:e,value:t})},f.prototype.getHeader=function(e){var t=this._headers[e.toLowerCase()];return t?t.value:null},f.prototype.removeHeader=function(e){delete this._headers[e.toLowerCase()]},f.prototype._onFinish=function(){var e=this;if(!e._destroyed){var t=e._opts,s=e._headers,o=null;"GET"!==t.method&&"HEAD"!==t.method&&(o=a.arraybuffer?c(i.concat(e._body)):a.blobConstructor?new n.Blob(e._body.map((function(e){return c(e)})),{type:(s["content-type"]||{}).value||""}):i.concat(e._body).toString());var l=[];if(Object.keys(s).forEach((function(e){var t=s[e].name,r=s[e].value;Array.isArray(r)?r.forEach((function(e){l.push([t,e])})):l.push([t,r])})),"fetch"===e._mode){var u=null;if(a.abortController){var f=new AbortController;u=f.signal,e._fetchAbortController=f,"requestTimeout"in t&&0!==t.requestTimeout&&(e._fetchTimer=n.setTimeout((function(){e.emit("requestTimeout"),e._fetchAbortController&&e._fetchAbortController.abort()}),t.requestTimeout))}n.fetch(e._opts.url,{method:e._opts.method,headers:l,body:o||void 0,mode:"cors",credentials:t.withCredentials?"include":"same-origin",signal:u}).then((function(t){e._fetchResponse=t,e._connect()}),(function(t){n.clearTimeout(e._fetchTimer),e._destroyed||e.emit("error",t)}))}else{var d=e._xhr=new n.XMLHttpRequest;try{d.open(e._opts.method,e._opts.url,!0)}catch(t){return void r.nextTick((function(){e.emit("error",t)}))}"responseType"in d&&(d.responseType=e._mode.split(":")[0]),"withCredentials"in d&&(d.withCredentials=!!t.withCredentials),"text"===e._mode&&"overrideMimeType"in d&&d.overrideMimeType("text/plain; charset=x-user-defined"),"requestTimeout"in t&&(d.timeout=t.requestTimeout,d.ontimeout=function(){e.emit("requestTimeout")}),l.forEach((function(e){d.setRequestHeader(e[0],e[1])})),e._response=null,d.onreadystatechange=function(){switch(d.readyState){case h.LOADING:case h.DONE:e._onXHRProgress()}},"moz-chunked-arraybuffer"===e._mode&&(d.onprogress=function(){e._onXHRProgress()}),d.onerror=function(){e._destroyed||e.emit("error",new Error("XHR error"))};try{d.send(o)}catch(t){return void r.nextTick((function(){e.emit("error",t)}))}}}},f.prototype._onXHRProgress=function(){(function(e){try{var t=e.status;return null!==t&&0!==t}catch(e){return!1}})(this._xhr)&&!this._destroyed&&(this._response||this._connect(),this._response._onXHRProgress())},f.prototype._connect=function(){var e=this;e._destroyed||(e._response=new u(e._xhr,e._fetchResponse,e._mode,e._fetchTimer),e._response.on("error",(function(t){e.emit("error",t)})),e.emit("response",e._response))},f.prototype._write=function(e,t,r){this._body.push(e),r()},f.prototype.abort=f.prototype.destroy=function(){this._destroyed=!0,n.clearTimeout(this._fetchTimer),this._response&&(this._response._destroyed=!0),this._xhr?this._xhr.abort():this._fetchAbortController&&this._fetchAbortController.abort()},f.prototype.end=function(e,t,r){"function"==typeof e&&(r=e,e=void 0),l.Writable.prototype.end.call(this,e,t,r)},f.prototype.flushHeaders=function(){},f.prototype.setTimeout=function(){},f.prototype.setNoDelay=function(){},f.prototype.setSocketKeepAlive=function(){};var d=["accept-charset","accept-encoding","access-control-request-headers","access-control-request-method","connection","content-length","cookie","cookie2","date","dnt","expect","host","keep-alive","origin","referer","te","trailer","transfer-encoding","upgrade","via"]}).call(this,e("_process"),"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{},e("buffer").Buffer)},{"./capability":156,"./response":158,_process:112,buffer:4,inherits:106,"readable-stream":125,"to-arraybuffer":161}],158:[function(e,t,r){(function(t,n,i){var a=e("./capability"),s=e("inherits"),o=e("readable-stream"),l=r.readyStates={UNSENT:0,OPENED:1,HEADERS_RECEIVED:2,LOADING:3,DONE:4},c=r.IncomingMessage=function(e,r,s,l){var c=this;if(o.Readable.call(c),c._mode=s,c.headers={},c.rawHeaders=[],c.trailers={},c.rawTrailers=[],c.on("end",(function(){t.nextTick((function(){c.emit("close")}))})),"fetch"===s){if(c._fetchResponse=r,c.url=r.url,c.statusCode=r.status,c.statusMessage=r.statusText,r.headers.forEach((function(e,t){c.headers[t.toLowerCase()]=e,c.rawHeaders.push(t,e)})),a.writableStream){var u=new WritableStream({write:function(e){return new Promise((function(t,r){c._destroyed?r():c.push(new i(e))?t():c._resumeFetch=t}))},close:function(){n.clearTimeout(l),c._destroyed||c.push(null)},abort:function(e){c._destroyed||c.emit("error",e)}});try{return void r.body.pipeTo(u).catch((function(e){n.clearTimeout(l),c._destroyed||c.emit("error",e)}))}catch(e){}}var h=r.body.getReader();!function e(){h.read().then((function(t){if(!c._destroyed){if(t.done)return n.clearTimeout(l),void c.push(null);c.push(new i(t.value)),e()}})).catch((function(e){n.clearTimeout(l),c._destroyed||c.emit("error",e)}))}()}else if(c._xhr=e,c._pos=0,c.url=e.responseURL,c.statusCode=e.status,c.statusMessage=e.statusText,e.getAllResponseHeaders().split(/\r?\n/).forEach((function(e){var t=e.match(/^([^:]+):\s*(.*)/);if(t){var r=t[1].toLowerCase();"set-cookie"===r?(void 0===c.headers[r]&&(c.headers[r]=[]),c.headers[r].push(t[2])):void 0!==c.headers[r]?c.headers[r]+=", "+t[2]:c.headers[r]=t[2],c.rawHeaders.push(t[1],t[2])}})),c._charset="x-user-defined",!a.overrideMimeType){var f=c.rawHeaders["mime-type"];if(f){var d=f.match(/;\s*charset=([^;])(;|$)/);d&&(c._charset=d[1].toLowerCase())}c._charset||(c._charset="utf-8")}};s(c,o.Readable),c.prototype._read=function(){var e=this._resumeFetch;e&&(this._resumeFetch=null,e())},c.prototype._onXHRProgress=function(){var e=this,t=e._xhr,r=null;switch(e._mode){case"text:vbarray":if(t.readyState!==l.DONE)break;try{r=new n.VBArray(t.responseBody).toArray()}catch(t){}if(null!==r){e.push(new i(r));break}case"text":try{r=t.responseText}catch(t){e._mode="text:vbarray";break}if(r.length>e._pos){var a=r.substr(e._pos);if("x-user-defined"===e._charset){for(var s=new i(a.length),o=0;o<a.length;o++)s[o]=255&a.charCodeAt(o);e.push(s)}else e.push(a,e._charset);e._pos=r.length}break;case"arraybuffer":if(t.readyState!==l.DONE||!t.response)break;r=t.response,e.push(new i(new Uint8Array(r)));break;case"moz-chunked-arraybuffer":if(r=t.response,t.readyState!==l.LOADING||!r)break;e.push(new i(new Uint8Array(r)));break;case"ms-stream":if(r=t.response,t.readyState!==l.LOADING)break;var c=new n.MSStreamReader;c.onprogress=function(){c.result.byteLength>e._pos&&(e.push(new i(new Uint8Array(c.result.slice(e._pos)))),e._pos=c.result.byteLength)},c.onload=function(){e.push(null)},c.readAsArrayBuffer(r)}e._xhr.readyState===l.DONE&&"ms-stream"!==e._mode&&e.push(null)}}).call(this,e("_process"),"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{},e("buffer").Buffer)},{"./capability":156,_process:112,buffer:4,inherits:106,"readable-stream":125}],159:[function(e,t,r){"use strict";var n=e("safe-buffer").Buffer,i=n.isEncoding||function(e){switch((e=""+e)&&e.toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":case"raw":return!0;default:return!1}};function a(e){var t;switch(this.encoding=function(e){var t=function(e){if(!e)return"utf8";for(var t;;)switch(e){case"utf8":case"utf-8":return"utf8";case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return"utf16le";case"latin1":case"binary":return"latin1";case"base64":case"ascii":case"hex":return e;default:if(t)return;e=(""+e).toLowerCase(),t=!0}}(e);if("string"!=typeof t&&(n.isEncoding===i||!i(e)))throw new Error("Unknown encoding: "+e);return t||e}(e),this.encoding){case"utf16le":this.text=l,this.end=c,t=4;break;case"utf8":this.fillLast=o,t=4;break;case"base64":this.text=u,this.end=h,t=3;break;default:return this.write=f,void(this.end=d)}this.lastNeed=0,this.lastTotal=0,this.lastChar=n.allocUnsafe(t)}function s(e){return e<=127?0:e>>5==6?2:e>>4==14?3:e>>3==30?4:e>>6==2?-1:-2}function o(e){var t=this.lastTotal-this.lastNeed,r=function(e,t,r){if(128!=(192&t[0]))return e.lastNeed=0,"�";if(1<e.lastNeed&&1<t.length){if(128!=(192&t[1]))return e.lastNeed=1,"�";if(2<e.lastNeed&&2<t.length&&128!=(192&t[2]))return e.lastNeed=2,"�"}}(this,e);return void 0!==r?r:this.lastNeed<=e.length?(e.copy(this.lastChar,t,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal)):(e.copy(this.lastChar,t,0,e.length),void(this.lastNeed-=e.length))}function l(e,t){if((e.length-t)%2!=0)return this.lastNeed=1,this.lastTotal=2,this.lastChar[0]=e[e.length-1],e.toString("utf16le",t,e.length-1);var r=e.toString("utf16le",t);if(r){var n=r.charCodeAt(r.length-1);if(55296<=n&&n<=56319)return this.lastNeed=2,this.lastTotal=4,this.lastChar[0]=e[e.length-2],this.lastChar[1]=e[e.length-1],r.slice(0,-1)}return r}function c(e){var t=e&&e.length?this.write(e):"";if(this.lastNeed){var r=this.lastTotal-this.lastNeed;return t+this.lastChar.toString("utf16le",0,r)}return t}function u(e,t){var r=(e.length-t)%3;return 0===r?e.toString("base64",t):(this.lastNeed=3-r,this.lastTotal=3,1===r?this.lastChar[0]=e[e.length-1]:(this.lastChar[0]=e[e.length-2],this.lastChar[1]=e[e.length-1]),e.toString("base64",t,e.length-r))}function h(e){var t=e&&e.length?this.write(e):"";return this.lastNeed?t+this.lastChar.toString("base64",0,3-this.lastNeed):t}function f(e){return e.toString(this.encoding)}function d(e){return e&&e.length?this.write(e):""}(r.StringDecoder=a).prototype.write=function(e){if(0===e.length)return"";var t,r;if(this.lastNeed){if(void 0===(t=this.fillLast(e)))return"";r=this.lastNeed,this.lastNeed=0}else r=0;return r<e.length?t?t+this.text(e,r):this.text(e,r):t||""},a.prototype.end=function(e){var t=e&&e.length?this.write(e):"";return this.lastNeed?t+"�":t},a.prototype.text=function(e,t){var r=function(e,t,r){var n=t.length-1;if(n<r)return 0;var i=s(t[n]);return 0<=i?(0<i&&(e.lastNeed=i-1),i):--n<r||-2===i?0:0<=(i=s(t[n]))?(0<i&&(e.lastNeed=i-2),i):--n<r||-2===i?0:0<=(i=s(t[n]))?(0<i&&(2===i?i=0:e.lastNeed=i-3),i):0}(this,e,t);if(!this.lastNeed)return e.toString("utf8",t);this.lastTotal=r;var n=e.length-(r-this.lastNeed);return e.copy(this.lastChar,0,n),e.toString("utf8",t,n)},a.prototype.fillLast=function(e){if(this.lastNeed<=e.length)return e.copy(this.lastChar,this.lastTotal-this.lastNeed,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal);e.copy(this.lastChar,this.lastTotal-this.lastNeed,0,e.length),this.lastNeed-=e.length}},{"safe-buffer":143}],160:[function(e,t,r){(function(t,n){var i=e("process/browser.js").nextTick,a=Function.prototype.apply,s=Array.prototype.slice,o={},l=0;function c(e,t){this._id=e,this._clearFn=t}r.setTimeout=function(){return new c(a.call(setTimeout,window,arguments),clearTimeout)},r.setInterval=function(){return new c(a.call(setInterval,window,arguments),clearInterval)},r.clearTimeout=r.clearInterval=function(e){e.close()},c.prototype.unref=c.prototype.ref=function(){},c.prototype.close=function(){this._clearFn.call(window,this._id)},r.enroll=function(e,t){clearTimeout(e._idleTimeoutId),e._idleTimeout=t},r.unenroll=function(e){clearTimeout(e._idleTimeoutId),e._idleTimeout=-1},r._unrefActive=r.active=function(e){clearTimeout(e._idleTimeoutId);var t=e._idleTimeout;0<=t&&(e._idleTimeoutId=setTimeout((function(){e._onTimeout&&e._onTimeout()}),t))},r.setImmediate="function"==typeof t?t:function(e){var t=l++,n=!(arguments.length<2)&&s.call(arguments,1);return o[t]=!0,i((function(){o[t]&&(n?e.apply(null,n):e.call(null),r.clearImmediate(t))})),t},r.clearImmediate="function"==typeof n?n:function(e){delete o[e]}}).call(this,e("timers").setImmediate,e("timers").clearImmediate)},{"process/browser.js":112,timers:160}],161:[function(e,t,r){var n=e("buffer").Buffer;t.exports=function(e){if(e instanceof Uint8Array){if(0===e.byteOffset&&e.byteLength===e.buffer.byteLength)return e.buffer;if("function"==typeof e.buffer.slice)return e.buffer.slice(e.byteOffset,e.byteOffset+e.byteLength)}if(n.isBuffer(e)){for(var t=new Uint8Array(e.length),r=e.length,i=0;i<r;i++)t[i]=e[i];return t.buffer}throw new Error("Argument must be a Buffer")}},{buffer:4}],162:[function(e,t,r){"use strict";var n=e("punycode"),i=e("./util");function a(){this.protocol=null,this.slashes=null,this.auth=null,this.host=null,this.port=null,this.hostname=null,this.hash=null,this.search=null,this.query=null,this.pathname=null,this.path=null,this.href=null}r.parse=v,r.resolve=function(e,t){return v(e,!1,!0).resolve(t)},r.resolveObject=function(e,t){return e?v(e,!1,!0).resolveObject(t):t},r.format=function(e){return i.isString(e)&&(e=v(e)),e instanceof a?e.format():a.prototype.format.call(e)},r.Url=a;var s=/^([a-z0-9.+-]+:)/i,o=/:[0-9]*$/,l=/^(\/\/?(?!\/)[^\?\s]*)(\?[^\s]*)?$/,c=["{","}","|","\\","^","`"].concat(["<",">",'"',"`"," ","\r","\n","\t"]),u=["'"].concat(c),h=["%","/","?",";","#"].concat(u),f=["/","?","#"],d=/^[+a-z0-9A-Z_-]{0,63}$/,p=/^([+a-z0-9A-Z_-]{0,63})(.*)$/,m={javascript:!0,"javascript:":!0},g={javascript:!0,"javascript:":!0},T={http:!0,https:!0,ftp:!0,gopher:!0,file:!0,"http:":!0,"https:":!0,"ftp:":!0,"gopher:":!0,"file:":!0},y=e("querystring");function v(e,t,r){if(e&&i.isObject(e)&&e instanceof a)return e;var n=new a;return n.parse(e,t,r),n}a.prototype.parse=function(e,t,r){if(!i.isString(e))throw new TypeError("Parameter 'url' must be a string, not "+_typeof(e));var a=e.indexOf("?"),o=-1!==a&&a<e.indexOf("#")?"?":"#",c=e.split(o);c[0]=c[0].replace(/\\/g,"/");var v=e=c.join(o);if(v=v.trim(),!r&&1===e.split("#").length){var E=l.exec(v);if(E)return this.path=v,this.href=v,this.pathname=E[1],E[2]?(this.search=E[2],this.query=t?y.parse(this.search.substr(1)):this.search.substr(1)):t&&(this.search="",this.query={}),this}var C=s.exec(v);if(C){var b=(C=C[0]).toLowerCase();this.protocol=b,v=v.substr(C.length)}if(r||C||v.match(/^\/\/[^@\/]+@[^@\/]+/)){var S="//"===v.substr(0,2);!S||C&&g[C]||(v=v.substr(2),this.slashes=!0)}if(!g[C]&&(S||C&&!T[C])){for(var I,x,P=-1,w=0;w<f.length;w++)-1!==(D=v.indexOf(f[w]))&&(-1===P||D<P)&&(P=D);for(-1!==(x=-1===P?v.lastIndexOf("@"):v.lastIndexOf("@",P))&&(I=v.slice(0,x),v=v.slice(x+1),this.auth=decodeURIComponent(I)),P=-1,w=0;w<h.length;w++){var D;-1!==(D=v.indexOf(h[w]))&&(-1===P||D<P)&&(P=D)}-1===P&&(P=v.length),this.host=v.slice(0,P),v=v.slice(P),this.parseHost(),this.hostname=this.hostname||"";var _="["===this.hostname[0]&&"]"===this.hostname[this.hostname.length-1];if(!_)for(var A=this.hostname.split(/\./),R=(w=0,A.length);w<R;w++){var M=A[w];if(M&&!M.match(d)){for(var N="",k=0,O=M.length;k<O;k++)127<M.charCodeAt(k)?N+="x":N+=M[k];if(!N.match(d)){var L=A.slice(0,w),F=A.slice(w+1),B=M.match(p);B&&(L.push(B[1]),F.unshift(B[2])),F.length&&(v="/"+F.join(".")+v),this.hostname=L.join(".");break}}}255<this.hostname.length?this.hostname="":this.hostname=this.hostname.toLowerCase(),_||(this.hostname=n.toASCII(this.hostname));var V=this.port?":"+this.port:"",U=this.hostname||"";this.host=U+V,this.href+=this.host,_&&(this.hostname=this.hostname.substr(1,this.hostname.length-2),"/"!==v[0]&&(v="/"+v))}if(!m[b])for(w=0,R=u.length;w<R;w++){var H=u[w];if(-1!==v.indexOf(H)){var z=encodeURIComponent(H);z===H&&(z=escape(H)),v=v.split(H).join(z)}}var j=v.indexOf("#");-1!==j&&(this.hash=v.substr(j),v=v.slice(0,j));var q=v.indexOf("?");if(-1!==q?(this.search=v.substr(q),this.query=v.substr(q+1),t&&(this.query=y.parse(this.query)),v=v.slice(0,q)):t&&(this.search="",this.query={}),v&&(this.pathname=v),T[b]&&this.hostname&&!this.pathname&&(this.pathname="/"),this.pathname||this.search){V=this.pathname||"";var G=this.search||"";this.path=V+G}return this.href=this.format(),this},a.prototype.format=function(){var e=this.auth||"";e&&(e=(e=encodeURIComponent(e)).replace(/%3A/i,":"),e+="@");var t=this.protocol||"",r=this.pathname||"",n=this.hash||"",a=!1,s="";this.host?a=e+this.host:this.hostname&&(a=e+(-1===this.hostname.indexOf(":")?this.hostname:"["+this.hostname+"]"),this.port&&(a+=":"+this.port)),this.query&&i.isObject(this.query)&&Object.keys(this.query).length&&(s=y.stringify(this.query));var o=this.search||s&&"?"+s||"";return t&&":"!==t.substr(-1)&&(t+=":"),this.slashes||(!t||T[t])&&!1!==a?(a="//"+(a||""),r&&"/"!==r.charAt(0)&&(r="/"+r)):a||(a=""),n&&"#"!==n.charAt(0)&&(n="#"+n),o&&"?"!==o.charAt(0)&&(o="?"+o),t+a+(r=r.replace(/[?#]/g,(function(e){return encodeURIComponent(e)})))+(o=o.replace("#","%23"))+n},a.prototype.resolve=function(e){return this.resolveObject(v(e,!1,!0)).format()},a.prototype.resolveObject=function(e){if(i.isString(e)){var t=new a;t.parse(e,!1,!0),e=t}for(var r=new a,n=Object.keys(this),s=0;s<n.length;s++){var o=n[s];r[o]=this[o]}if(r.hash=e.hash,""===e.href)return r.href=r.format(),r;if(e.slashes&&!e.protocol){for(var l=Object.keys(e),c=0;c<l.length;c++){var u=l[c];"protocol"!==u&&(r[u]=e[u])}return T[r.protocol]&&r.hostname&&!r.pathname&&(r.path=r.pathname="/"),r.href=r.format(),r}if(e.protocol&&e.protocol!==r.protocol){if(!T[e.protocol]){for(var h=Object.keys(e),f=0;f<h.length;f++){var d=h[f];r[d]=e[d]}return r.href=r.format(),r}if(r.protocol=e.protocol,e.host||g[e.protocol])r.pathname=e.pathname;else{for(var p=(e.pathname||"").split("/");p.length&&!(e.host=p.shift()););e.host||(e.host=""),e.hostname||(e.hostname=""),""!==p[0]&&p.unshift(""),p.length<2&&p.unshift(""),r.pathname=p.join("/")}if(r.search=e.search,r.query=e.query,r.host=e.host||"",r.auth=e.auth,r.hostname=e.hostname||e.host,r.port=e.port,r.pathname||r.search){var m=r.pathname||"",y=r.search||"";r.path=m+y}return r.slashes=r.slashes||e.slashes,r.href=r.format(),r}var v=r.pathname&&"/"===r.pathname.charAt(0),E=e.host||e.pathname&&"/"===e.pathname.charAt(0),C=E||v||r.host&&e.pathname,b=C,S=r.pathname&&r.pathname.split("/")||[],I=(p=e.pathname&&e.pathname.split("/")||[],r.protocol&&!T[r.protocol]);if(I&&(r.hostname="",r.port=null,r.host&&(""===S[0]?S[0]=r.host:S.unshift(r.host)),r.host="",e.protocol&&(e.hostname=null,e.port=null,e.host&&(""===p[0]?p[0]=e.host:p.unshift(e.host)),e.host=null),C=C&&(""===p[0]||""===S[0])),E)r.host=e.host||""===e.host?e.host:r.host,r.hostname=e.hostname||""===e.hostname?e.hostname:r.hostname,r.search=e.search,r.query=e.query,S=p;else if(p.length)S||(S=[]),S.pop(),S=S.concat(p),r.search=e.search,r.query=e.query;else if(!i.isNullOrUndefined(e.search))return I&&(r.hostname=r.host=S.shift(),(_=!!(r.host&&0<r.host.indexOf("@"))&&r.host.split("@"))&&(r.auth=_.shift(),r.host=r.hostname=_.shift())),r.search=e.search,r.query=e.query,i.isNull(r.pathname)&&i.isNull(r.search)||(r.path=(r.pathname?r.pathname:"")+(r.search?r.search:"")),r.href=r.format(),r;if(!S.length)return r.pathname=null,r.search?r.path="/"+r.search:r.path=null,r.href=r.format(),r;for(var x=S.slice(-1)[0],P=(r.host||e.host||1<S.length)&&("."===x||".."===x)||""===x,w=0,D=S.length;0<=D;D--)"."===(x=S[D])?S.splice(D,1):".."===x?(S.splice(D,1),w++):w&&(S.splice(D,1),w--);if(!C&&!b)for(;w--;w)S.unshift("..");!C||""===S[0]||S[0]&&"/"===S[0].charAt(0)||S.unshift(""),P&&"/"!==S.join("/").substr(-1)&&S.push("");var _,A=""===S[0]||S[0]&&"/"===S[0].charAt(0);return I&&(r.hostname=r.host=A?"":S.length?S.shift():"",(_=!!(r.host&&0<r.host.indexOf("@"))&&r.host.split("@"))&&(r.auth=_.shift(),r.host=r.hostname=_.shift())),(C=C||r.host&&S.length)&&!A&&S.unshift(""),S.length?r.pathname=S.join("/"):(r.pathname=null,r.path=null),i.isNull(r.pathname)&&i.isNull(r.search)||(r.path=(r.pathname?r.pathname:"")+(r.search?r.search:"")),r.auth=e.auth||r.auth,r.slashes=r.slashes||e.slashes,r.href=r.format(),r},a.prototype.parseHost=function(){var e=this.host,t=o.exec(e);t&&(":"!==(t=t[0])&&(this.port=t.substr(1)),e=e.substr(0,e.length-t.length)),e&&(this.hostname=e)}},{"./util":163,punycode:113,querystring:116}],163:[function(e,t,r){"use strict";t.exports={isString:function(e){return"string"==typeof e},isObject:function(e){return"object"==_typeof(e)&&null!==e},isNull:function(e){return null===e},isNullOrUndefined:function(e){return null==e}}},{}],164:[function(e,t,r){(function(e){function r(t){try{if(!e.localStorage)return!1}catch(t){return!1}var r=e.localStorage[t];return null!=r&&"true"===String(r).toLowerCase()}t.exports=function(e,t){if(r("noDeprecation"))return e;var n=!1;return function(){if(!n){if(r("throwDeprecation"))throw new Error(t);r("traceDeprecation")?console.trace(t):console.warn(t),n=!0}return e.apply(this,arguments)}}}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],165:[function(e,t,r){t.exports=function(){for(var e={},t=0;t<arguments.length;t++){var r=arguments[t];for(var i in r)n.call(r,i)&&(e[i]=r[i])}return e};var n=Object.prototype.hasOwnProperty},{}],166:[function(e,t,r){"use strict";var n=e("./utils").createMapFromString;function i(e){return n(e,!0)}var a,s=/([^\s"'<>/=]+)/,o=[/=/],l=[/"([^"]*)"+/.source,/'([^']*)'+/.source,/([^ \t\n\f\r"'`=<>]+)/.source],c="((?:"+(a="["+"A-Za-z\\xC0-\\xD6\\xD8-\\xF6\\xF8-\\u0131\\u0134-\\u013E\\u0141-\\u0148\\u014A-\\u017E\\u0180-\\u01C3\\u01CD-\\u01F0\\u01F4\\u01F5\\u01FA-\\u0217\\u0250-\\u02A8\\u02BB-\\u02C1\\u0386\\u0388-\\u038A\\u038C\\u038E-\\u03A1\\u03A3-\\u03CE\\u03D0-\\u03D6\\u03DA\\u03DC\\u03DE\\u03E0\\u03E2-\\u03F3\\u0401-\\u040C\\u040E-\\u044F\\u0451-\\u045C\\u045E-\\u0481\\u0490-\\u04C4\\u04C7\\u04C8\\u04CB\\u04CC\\u04D0-\\u04EB\\u04EE-\\u04F5\\u04F8\\u04F9\\u0531-\\u0556\\u0559\\u0561-\\u0586\\u05D0-\\u05EA\\u05F0-\\u05F2\\u0621-\\u063A\\u0641-\\u064A\\u0671-\\u06B7\\u06BA-\\u06BE\\u06C0-\\u06CE\\u06D0-\\u06D3\\u06D5\\u06E5\\u06E6\\u0905-\\u0939\\u093D\\u0958-\\u0961\\u0985-\\u098C\\u098F\\u0990\\u0993-\\u09A8\\u09AA-\\u09B0\\u09B2\\u09B6-\\u09B9\\u09DC\\u09DD\\u09DF-\\u09E1\\u09F0\\u09F1\\u0A05-\\u0A0A\\u0A0F\\u0A10\\u0A13-\\u0A28\\u0A2A-\\u0A30\\u0A32\\u0A33\\u0A35\\u0A36\\u0A38\\u0A39\\u0A59-\\u0A5C\\u0A5E\\u0A72-\\u0A74\\u0A85-\\u0A8B\\u0A8D\\u0A8F-\\u0A91\\u0A93-\\u0AA8\\u0AAA-\\u0AB0\\u0AB2\\u0AB3\\u0AB5-\\u0AB9\\u0ABD\\u0AE0\\u0B05-\\u0B0C\\u0B0F\\u0B10\\u0B13-\\u0B28\\u0B2A-\\u0B30\\u0B32\\u0B33\\u0B36-\\u0B39\\u0B3D\\u0B5C\\u0B5D\\u0B5F-\\u0B61\\u0B85-\\u0B8A\\u0B8E-\\u0B90\\u0B92-\\u0B95\\u0B99\\u0B9A\\u0B9C\\u0B9E\\u0B9F\\u0BA3\\u0BA4\\u0BA8-\\u0BAA\\u0BAE-\\u0BB5\\u0BB7-\\u0BB9\\u0C05-\\u0C0C\\u0C0E-\\u0C10\\u0C12-\\u0C28\\u0C2A-\\u0C33\\u0C35-\\u0C39\\u0C60\\u0C61\\u0C85-\\u0C8C\\u0C8E-\\u0C90\\u0C92-\\u0CA8\\u0CAA-\\u0CB3\\u0CB5-\\u0CB9\\u0CDE\\u0CE0\\u0CE1\\u0D05-\\u0D0C\\u0D0E-\\u0D10\\u0D12-\\u0D28\\u0D2A-\\u0D39\\u0D60\\u0D61\\u0E01-\\u0E2E\\u0E30\\u0E32\\u0E33\\u0E40-\\u0E45\\u0E81\\u0E82\\u0E84\\u0E87\\u0E88\\u0E8A\\u0E8D\\u0E94-\\u0E97\\u0E99-\\u0E9F\\u0EA1-\\u0EA3\\u0EA5\\u0EA7\\u0EAA\\u0EAB\\u0EAD\\u0EAE\\u0EB0\\u0EB2\\u0EB3\\u0EBD\\u0EC0-\\u0EC4\\u0F40-\\u0F47\\u0F49-\\u0F69\\u10A0-\\u10C5\\u10D0-\\u10F6\\u1100\\u1102\\u1103\\u1105-\\u1107\\u1109\\u110B\\u110C\\u110E-\\u1112\\u113C\\u113E\\u1140\\u114C\\u114E\\u1150\\u1154\\u1155\\u1159\\u115F-\\u1161\\u1163\\u1165\\u1167\\u1169\\u116D\\u116E\\u1172\\u1173\\u1175\\u119E\\u11A8\\u11AB\\u11AE\\u11AF\\u11B7\\u11B8\\u11BA\\u11BC-\\u11C2\\u11EB\\u11F0\\u11F9\\u1E00-\\u1E9B\\u1EA0-\\u1EF9\\u1F00-\\u1F15\\u1F18-\\u1F1D\\u1F20-\\u1F45\\u1F48-\\u1F4D\\u1F50-\\u1F57\\u1F59\\u1F5B\\u1F5D\\u1F5F-\\u1F7D\\u1F80-\\u1FB4\\u1FB6-\\u1FBC\\u1FBE\\u1FC2-\\u1FC4\\u1FC6-\\u1FCC\\u1FD0-\\u1FD3\\u1FD6-\\u1FDB\\u1FE0-\\u1FEC\\u1FF2-\\u1FF4\\u1FF6-\\u1FFC\\u2126\\u212A\\u212B\\u212E\\u2180-\\u2182\\u3007\\u3021-\\u3029\\u3041-\\u3094\\u30A1-\\u30FA\\u3105-\\u312C\\u4E00-\\u9FA5\\uAC00-\\uD7A3"+"_][A-Za-z\\xC0-\\xD6\\xD8-\\xF6\\xF8-\\u0131\\u0134-\\u013E\\u0141-\\u0148\\u014A-\\u017E\\u0180-\\u01C3\\u01CD-\\u01F0\\u01F4\\u01F5\\u01FA-\\u0217\\u0250-\\u02A8\\u02BB-\\u02C1\\u0386\\u0388-\\u038A\\u038C\\u038E-\\u03A1\\u03A3-\\u03CE\\u03D0-\\u03D6\\u03DA\\u03DC\\u03DE\\u03E0\\u03E2-\\u03F3\\u0401-\\u040C\\u040E-\\u044F\\u0451-\\u045C\\u045E-\\u0481\\u0490-\\u04C4\\u04C7\\u04C8\\u04CB\\u04CC\\u04D0-\\u04EB\\u04EE-\\u04F5\\u04F8\\u04F9\\u0531-\\u0556\\u0559\\u0561-\\u0586\\u05D0-\\u05EA\\u05F0-\\u05F2\\u0621-\\u063A\\u0641-\\u064A\\u0671-\\u06B7\\u06BA-\\u06BE\\u06C0-\\u06CE\\u06D0-\\u06D3\\u06D5\\u06E5\\u06E6\\u0905-\\u0939\\u093D\\u0958-\\u0961\\u0985-\\u098C\\u098F\\u0990\\u0993-\\u09A8\\u09AA-\\u09B0\\u09B2\\u09B6-\\u09B9\\u09DC\\u09DD\\u09DF-\\u09E1\\u09F0\\u09F1\\u0A05-\\u0A0A\\u0A0F\\u0A10\\u0A13-\\u0A28\\u0A2A-\\u0A30\\u0A32\\u0A33\\u0A35\\u0A36\\u0A38\\u0A39\\u0A59-\\u0A5C\\u0A5E\\u0A72-\\u0A74\\u0A85-\\u0A8B\\u0A8D\\u0A8F-\\u0A91\\u0A93-\\u0AA8\\u0AAA-\\u0AB0\\u0AB2\\u0AB3\\u0AB5-\\u0AB9\\u0ABD\\u0AE0\\u0B05-\\u0B0C\\u0B0F\\u0B10\\u0B13-\\u0B28\\u0B2A-\\u0B30\\u0B32\\u0B33\\u0B36-\\u0B39\\u0B3D\\u0B5C\\u0B5D\\u0B5F-\\u0B61\\u0B85-\\u0B8A\\u0B8E-\\u0B90\\u0B92-\\u0B95\\u0B99\\u0B9A\\u0B9C\\u0B9E\\u0B9F\\u0BA3\\u0BA4\\u0BA8-\\u0BAA\\u0BAE-\\u0BB5\\u0BB7-\\u0BB9\\u0C05-\\u0C0C\\u0C0E-\\u0C10\\u0C12-\\u0C28\\u0C2A-\\u0C33\\u0C35-\\u0C39\\u0C60\\u0C61\\u0C85-\\u0C8C\\u0C8E-\\u0C90\\u0C92-\\u0CA8\\u0CAA-\\u0CB3\\u0CB5-\\u0CB9\\u0CDE\\u0CE0\\u0CE1\\u0D05-\\u0D0C\\u0D0E-\\u0D10\\u0D12-\\u0D28\\u0D2A-\\u0D39\\u0D60\\u0D61\\u0E01-\\u0E2E\\u0E30\\u0E32\\u0E33\\u0E40-\\u0E45\\u0E81\\u0E82\\u0E84\\u0E87\\u0E88\\u0E8A\\u0E8D\\u0E94-\\u0E97\\u0E99-\\u0E9F\\u0EA1-\\u0EA3\\u0EA5\\u0EA7\\u0EAA\\u0EAB\\u0EAD\\u0EAE\\u0EB0\\u0EB2\\u0EB3\\u0EBD\\u0EC0-\\u0EC4\\u0F40-\\u0F47\\u0F49-\\u0F69\\u10A0-\\u10C5\\u10D0-\\u10F6\\u1100\\u1102\\u1103\\u1105-\\u1107\\u1109\\u110B\\u110C\\u110E-\\u1112\\u113C\\u113E\\u1140\\u114C\\u114E\\u1150\\u1154\\u1155\\u1159\\u115F-\\u1161\\u1163\\u1165\\u1167\\u1169\\u116D\\u116E\\u1172\\u1173\\u1175\\u119E\\u11A8\\u11AB\\u11AE\\u11AF\\u11B7\\u11B8\\u11BA\\u11BC-\\u11C2\\u11EB\\u11F0\\u11F9\\u1E00-\\u1E9B\\u1EA0-\\u1EF9\\u1F00-\\u1F15\\u1F18-\\u1F1D\\u1F20-\\u1F45\\u1F48-\\u1F4D\\u1F50-\\u1F57\\u1F59\\u1F5B\\u1F5D\\u1F5F-\\u1F7D\\u1F80-\\u1FB4\\u1FB6-\\u1FBC\\u1FBE\\u1FC2-\\u1FC4\\u1FC6-\\u1FCC\\u1FD0-\\u1FD3\\u1FD6-\\u1FDB\\u1FE0-\\u1FEC\\u1FF2-\\u1FF4\\u1FF6-\\u1FFC\\u2126\\u212A\\u212B\\u212E\\u2180-\\u2182\\u3007\\u3021-\\u3029\\u3041-\\u3094\\u30A1-\\u30FA\\u3105-\\u312C\\u4E00-\\u9FA5\\uAC00-\\uD7A30-9\\u0660-\\u0669\\u06F0-\\u06F9\\u0966-\\u096F\\u09E6-\\u09EF\\u0A66-\\u0A6F\\u0AE6-\\u0AEF\\u0B66-\\u0B6F\\u0BE7-\\u0BEF\\u0C66-\\u0C6F\\u0CE6-\\u0CEF\\u0D66-\\u0D6F\\u0E50-\\u0E59\\u0ED0-\\u0ED9\\u0F20-\\u0F29\\.\\-_\\u0300-\\u0345\\u0360\\u0361\\u0483-\\u0486\\u0591-\\u05A1\\u05A3-\\u05B9\\u05BB-\\u05BD\\u05BF\\u05C1\\u05C2\\u05C4\\u064B-\\u0652\\u0670\\u06D6-\\u06E4\\u06E7\\u06E8\\u06EA-\\u06ED\\u0901-\\u0903\\u093C\\u093E-\\u094D\\u0951-\\u0954\\u0962\\u0963\\u0981-\\u0983\\u09BC\\u09BE-\\u09C4\\u09C7\\u09C8\\u09CB-\\u09CD\\u09D7\\u09E2\\u09E3\\u0A02\\u0A3C\\u0A3E-\\u0A42\\u0A47\\u0A48\\u0A4B-\\u0A4D\\u0A70\\u0A71\\u0A81-\\u0A83\\u0ABC\\u0ABE-\\u0AC5\\u0AC7-\\u0AC9\\u0ACB-\\u0ACD\\u0B01-\\u0B03\\u0B3C\\u0B3E-\\u0B43\\u0B47\\u0B48\\u0B4B-\\u0B4D\\u0B56\\u0B57\\u0B82\\u0B83\\u0BBE-\\u0BC2\\u0BC6-\\u0BC8\\u0BCA-\\u0BCD\\u0BD7\\u0C01-\\u0C03\\u0C3E-\\u0C44\\u0C46-\\u0C48\\u0C4A-\\u0C4D\\u0C55\\u0C56\\u0C82\\u0C83\\u0CBE-\\u0CC4\\u0CC6-\\u0CC8\\u0CCA-\\u0CCD\\u0CD5\\u0CD6\\u0D02\\u0D03\\u0D3E-\\u0D43\\u0D46-\\u0D48\\u0D4A-\\u0D4D\\u0D57\\u0E31\\u0E34-\\u0E3A\\u0E47-\\u0E4E\\u0EB1\\u0EB4-\\u0EB9\\u0EBB\\u0EBC\\u0EC8-\\u0ECD\\u0F18\\u0F19\\u0F35\\u0F37\\u0F39\\u0F3E\\u0F3F\\u0F71-\\u0F84\\u0F86-\\u0F8B\\u0F90-\\u0F95\\u0F97\\u0F99-\\u0FAD\\u0FB1-\\u0FB7\\u0FB9\\u20D0-\\u20DC\\u20E1\\u302A-\\u302F\\u3099\\u309A\\xB7\\u02D0\\u02D1\\u0387\\u0640\\u0E46\\u0EC6\\u3005\\u3031-\\u3035\\u309D\\u309E\\u30FC-\\u30FE]*")+"\\:)?"+a+")",u=new RegExp("^<"+c),h=/^\s*(\/?)>/,f=new RegExp("^<\\/"+c+"[^>]*>"),d=/^<!DOCTYPE\s[^>]+>/i,p=!1;"x".replace(/x(.)?/g,(function(e,t){p=""===t}));var m=i("area,base,basefont,br,col,embed,frame,hr,img,input,isindex,keygen,link,meta,param,source,track,wbr"),g=i("a,abbr,acronym,applet,b,basefont,bdo,big,br,button,cite,code,del,dfn,em,font,i,iframe,img,input,ins,kbd,label,map,noscript,object,q,s,samp,script,select,small,span,strike,strong,sub,sup,svg,textarea,tt,u,var"),T=i("colgroup,dd,dt,li,option,p,td,tfoot,th,thead,tr,source"),y=i("checked,compact,declare,defer,disabled,ismap,multiple,nohref,noresize,noshade,nowrap,readonly,selected"),v=i("script,style"),E=i("address,article,aside,base,blockquote,body,caption,col,colgroup,dd,details,dialog,div,dl,dt,fieldset,figcaption,figure,footer,form,h1,h2,h3,h4,h5,h6,head,header,hgroup,hr,html,legend,li,menuitem,meta,ol,optgroup,option,param,rp,rt,source,style,summary,tbody,td,tfoot,th,thead,title,tr,track,ul"),C={};function b(e){var t,r=s.source+"(?:\\s*("+(t=e,o.concat(t.customAttrAssign||[]).map((function(e){return"(?:"+e.source+")"})).join("|")+")[ \\t\\n\\f\\r]*(?:")+l.join("|")+"))?";if(e.customAttrSurround){for(var n=[],i=e.customAttrSurround.length-1;0<=i;i--)n[i]="(?:("+e.customAttrSurround[i][0].source+")\\s*"+r+"\\s*("+e.customAttrSurround[i][1].source+"))";n.push("(?:"+r+")"),r="(?:"+n.join("|")+")"}return new RegExp("^\\s*"+r)}function S(e,t){for(var r,n,i,a,s=[],o=b(t);e;){if(n=e,r&&v(r)){var l=r.toLowerCase(),c=C[l]||(C[l]=new RegExp("([\\s\\S]*?)</"+l+"[^>]*>","i"));e=e.replace(c,(function(e,r){return"script"!==l&&"style"!==l&&"noscript"!==l&&(r=r.replace(/<!--([\s\S]*?)-->/g,"$1").replace(/<!\[CDATA\[([\s\S]*?)]]>/g,"$1")),t.chars&&t.chars(r),""})),O("</"+l+">",l)}else{var S,I=e.indexOf("<");if(0===I){if(/^<!--/.test(e)){var x=e.indexOf("--\x3e");if(0<=x){t.comment&&t.comment(e.substring(4,x)),e=e.substring(x+3),i="";continue}}if(/^<!\[/.test(e)){var P=e.indexOf("]>");if(0<=P){t.comment&&t.comment(e.substring(2,P+1),!0),e=e.substring(P+2),i="";continue}}var w=e.match(d);if(w){t.doctype&&t.doctype(w[0]),e=e.substring(w[0].length),i="";continue}var D=e.match(f);if(D){e=e.substring(D[0].length),D[0].replace(f,O),i="/"+D[1].toLowerCase();continue}var _=R(e);if(_){e=_.rest,N(_),i=_.tagName.toLowerCase();continue}}var A=R(e=0<=I?(S=e.substring(0,I),e.substring(I)):(S=e,""));a=A?A.tagName:(A=e.match(f))?"/"+A[1]:"",t.chars&&t.chars(S,i,a),i=""}if(e===n)throw new Error("Parse Error: "+e)}function R(e){var t=e.match(u);if(t){var r,n,i={tagName:t[1],attrs:[]};for(e=e.slice(t[0].length);!(r=e.match(h))&&(n=e.match(o));)e=e.slice(n[0].length),i.attrs.push(n);if(r)return i.unarySlash=r[1],i.rest=e.slice(r[0].length),i}}function M(e){if(0<=k(e))return O("",e),!0}function N(e){var n=e.tagName,i=e.unarySlash;if(t.html5&&("p"===r&&E(n)?O("",r):"tbody"===n?M("thead"):"tfoot"===n&&(M("tbody")||M("thead")),"col"===n&&k("colgroup")<0&&(r="colgroup",s.push({tag:r,attrs:[]}),t.start&&t.start(r,[],!1,""))),!t.html5&&!g(n))for(;r&&g(r);)O("",r);T(n)&&r===n&&O("",n);var a=m(n)||"html"===n&&"head"===r||!!i,o=e.attrs.map((function(e){var r,n,i,a,s,o;function l(t){return s=e[t],void 0!==(n=e[t+1])?'"':void 0!==(n=e[t+2])?"'":(void 0===(n=e[t+3])&&y(r)&&(n=r),"")}p&&-1===e[0].indexOf('""')&&(""===e[3]&&delete e[3],""===e[4]&&delete e[4],""===e[5]&&delete e[5]);var c=1;if(t.customAttrSurround)for(var u=0,h=t.customAttrSurround.length;u<h;u++,c+=7)if(r=e[c+1]){o=l(c+2),i=e[c],a=e[c+6];break}return!r&&(r=e[c])&&(o=l(c+1)),{name:r,value:n,customAssign:s||"=",customOpen:i||"",customClose:a||"",quote:o||""}}));a||(s.push({tag:n,attrs:o}),r=n,i=""),t.start&&t.start(n,o,a,i)}function k(e){var t,r=e.toLowerCase();for(t=s.length-1;0<=t&&s[t].tag.toLowerCase()!==r;t--);return t}function O(e,n){var i;if(0<=(i=n?k(n):0)){for(var a=s.length-1;i<=a;a--)t.end&&t.end(s[a].tag,s[a].attrs,i<a||!e);s.length=i,r=i&&s[i-1].tag}else"br"===n.toLowerCase()?t.start&&t.start(n,[],!0,""):"p"===n.toLowerCase()&&(t.start&&t.start(n,[],!1,"",!0),t.end&&t.end(n,[]))}t.partialMarkup||O()}r.HTMLParser=S,r.HTMLtoXML=function(e){var t="";return new S(e,{start:function(e,r,n){t+="<"+e;for(var i=0,a=r.length;i<a;i++)t+=" "+r[i].name+'="'+(r[i].value||"").replace(/"/g,"&#34;")+'"';t+=(n?"/":"")+">"},end:function(e){t+="</"+e+">"},chars:function(e){t+=e},comment:function(e){t+="\x3c!--"+e+"--\x3e"},ignore:function(e){t+=e}}),t},r.HTMLtoDOM=function(e,t){var r={html:!0,head:!0,body:!0,title:!0},n={link:"head",base:"head"};t?t=t.ownerDocument||t.getOwnerDocument&&t.getOwnerDocument()||t:"undefined"!=typeof DOMDocument?t=new DOMDocument:"undefined"!=typeof document&&document.implementation&&document.implementation.createDocument?t=document.implementation.createDocument("","",null):"undefined"!=typeof ActiveX&&(t=new ActiveXObject("Msxml.DOMDocument"));var i,a,s=[];if(!(t.documentElement||t.getDocumentElement&&t.getDocumentElement())&&t.createElement&&(i=t.createElement("html"),(a=t.createElement("head")).appendChild(t.createElement("title")),i.appendChild(a),i.appendChild(t.createElement("body")),t.appendChild(i)),t.getElementsByTagName)for(var o in r)r[o]=t.getElementsByTagName(o)[0];var l=r.body;return new S(e,{start:function(e,i,a){if(r[e])l=r[e];else{var o=t.createElement(e);for(var c in i)o.setAttribute(i[c].name,i[c].value);n[e]&&"boolean"!=typeof r[n[e]]?r[n[e]].appendChild(o):l&&l.appendChild&&l.appendChild(o),a||(s.push(o),l=o)}},end:function(){s.length-=1,l=s[s.length-1]},chars:function(e){l.appendChild(t.createTextNode(e))},comment:function(){},ignore:function(){}}),t}},{"./utils":168}],167:[function(e,t,r){"use strict";function n(){}function i(){}n.prototype.sort=function(e,t){t=t||0;for(var r=0,n=this.keys.length;r<n;r++){var i=this.keys[r],a=i.slice(1),s=e.indexOf(a,t);if(-1!==s){for(;s!==t&&(e.splice(s,1),e.splice(t,0,a)),t++,-1!==(s=e.indexOf(a,t)););return this[i].sort(e,t)}}return e},i.prototype={add:function(e){var t=this;e.forEach((function(r){var n="$"+r;t[n]||(t[n]=[],t[n].processed=0),t[n].push(e)}))},createSorter:function(){var e=this,t=new n;return t.keys=Object.keys(e).sort((function(t,r){var n=e[t].length,i=e[r].length;return n<i?1:i<n||t<r?-1:r<t?1:0})).filter((function(r){if(e[r].processed<e[r].length){var n=r.slice(1),a=new i;return e[r].forEach((function(t){for(var r;-1!==(r=t.indexOf(n));)t.splice(r,1);t.forEach((function(t){e["$"+t].processed++})),a.add(t.slice(0))})),t[r]=a.createSorter(),!0}return!1})),t}},t.exports=i},{}],168:[function(e,t,r){"use strict";function n(e,t){var r={};return e.forEach((function(e){r[e]=1})),t?function(e){return 1===r[e.toLowerCase()]}:function(e){return 1===r[e]}}r.createMap=n,r.createMapFromString=function(e,t){return n(e.split(/,/),t)}},{}],"html-minifier":[function(e,t,r){"use strict";var n=e("clean-css"),i=e("he").decode,a=e("./htmlparser").HTMLParser,s=e("relateurl"),o=e("./tokenchain"),l=e("uglify-js"),c=e("./utils");function u(e){return e&&e.replace(/^[ \n\r\t\f]+/,"").replace(/[ \n\r\t\f]+$/,"")}function h(e){return e&&e.replace(/[ \n\r\t\f\xA0]+/g,(function(e){return"\t"===e?"\t":e.replace(/(^|\xA0+)[^\xA0]+/g,"$1 ")}))}function f(e,t,r,n,i){var a="",s="";return t.preserveLineBreaks&&(e=e.replace(/^[ \n\r\t\f]*?[\n\r][ \n\r\t\f]*/,(function(){return a="\n",""})).replace(/[ \n\r\t\f]*?[\n\r][ \n\r\t\f]*$/,(function(){return s="\n",""}))),r&&(e=e.replace(/^[ \n\r\t\f\xA0]+/,(function(e){var r=!a&&t.conservativeCollapse;return r&&"\t"===e?"\t":e.replace(/^[^\xA0]+/,"").replace(/(\xA0+)[^\xA0]+/g,"$1 ")||(r?" ":"")}))),n&&(e=e.replace(/[ \n\r\t\f\xA0]+$/,(function(e){var r=!s&&t.conservativeCollapse;return r&&"\t"===e?"\t":e.replace(/[^\xA0]+(\xA0+)/g," $1").replace(/[^\xA0]+$/,"")||(r?" ":"")}))),i&&(e=h(e)),a+e+s}var d=c.createMapFromString,p=d("a,abbr,acronym,b,bdi,bdo,big,button,cite,code,del,dfn,em,font,i,ins,kbd,label,mark,math,nobr,object,q,rp,rt,rtc,ruby,s,samp,select,small,span,strike,strong,sub,sup,svg,textarea,time,tt,u,var"),m=d("a,abbr,acronym,b,big,del,em,font,i,ins,kbd,mark,nobr,rp,s,samp,small,span,strike,strong,sub,sup,time,tt,u,var"),g=d("comment,img,input,wbr");function T(e,t,r,n){var i=t&&!g(t);i&&!n.collapseInlineTagWhitespace&&(i="/"===t.charAt(0)?!p(t.slice(1)):!m(t));var a=r&&!g(r);return a&&!n.collapseInlineTagWhitespace&&(a="/"===r.charAt(0)?!m(r.slice(1)):!p(r)),f(e,n,i,a,t&&r)}function y(e,t){for(var r=e.length;r--;)if(e[r].name.toLowerCase()===t)return!0;return!1}var v=c.createMap(["text/javascript","text/ecmascript","text/jscript","application/javascript","application/x-javascript","application/ecmascript"]);function E(e){return""===(e=u(e.split(/;/,2)[0]).toLowerCase())||v(e)}function C(e){return""===(e=u(e).toLowerCase())||"text/css"===e}function b(e,t){if("style"!==e)return!1;for(var r=0,n=t.length;r<n;r++)if("type"===t[r].name.toLowerCase())return C(t[r].value);return!0}var S=d("allowfullscreen,async,autofocus,autoplay,checked,compact,controls,declare,default,defaultchecked,defaultmuted,defaultselected,defer,disabled,enabled,formnovalidate,hidden,indeterminate,inert,ismap,itemscope,loop,multiple,muted,nohref,noresize,noshade,novalidate,nowrap,open,pauseonexit,readonly,required,reversed,scoped,seamless,selected,sortable,truespeed,typemustmatch,visible"),I=d("true,false");function x(e,t,r){if("link"!==e)return!1;for(var n=0,i=t.length;n<i;n++)if("rel"===t[n].name&&t[n].value===r)return!0}var P=d("img,source");function w(e,t,r,n,i){if(function(e,t){var r=t.customEventAttributes;if(r){for(var n=r.length;n--;)if(r[n].test(e))return!0;return!1}return/^on[a-z]{3,}$/.test(e)}(t,n))return r=u(r).replace(/^javascript:\s*/i,""),n.minifyJS(r,!0);if("class"===t)return r=u(r),n.sortClassName?n.sortClassName(r):h(r);if(c=t,/^(?:a|area|link|base)$/.test(f=e)&&"href"===c||"img"===f&&/^(?:src|longdesc|usemap)$/.test(c)||"object"===f&&/^(?:classid|codebase|data|usemap)$/.test(c)||"q"===f&&"cite"===c||"blockquote"===f&&"cite"===c||("ins"===f||"del"===f)&&"cite"===c||"form"===f&&"action"===c||"input"===f&&("src"===c||"usemap"===c)||"head"===f&&"profile"===c||"script"===f&&("src"===c||"for"===c))return r=u(r),x(e,i,"canonical")?r:n.minifyURLs(r);if(o=t,/^(?:a|area|object|button)$/.test(l=e)&&"tabindex"===o||"input"===l&&("maxlength"===o||"tabindex"===o)||"select"===l&&("size"===o||"tabindex"===o)||"textarea"===l&&/^(?:rows|cols|tabindex)$/.test(o)||"colgroup"===l&&"span"===o||"col"===l&&"span"===o||("th"===l||"td"===l)&&("rowspan"===o||"colspan"===o))return u(r);if("style"===t)return(r=u(r))&&(/;$/.test(r)&&!/&#?[0-9a-zA-Z]+;$/.test(r)&&(r=r.replace(/\s*;$/,";")),r=n.minifyCSS(r,"inline")),r;if("srcset"===t&&P(e))r=u(r).split(/\s+,\s*|\s*,\s+/).map((function(e){var t=e,r="",i=e.match(/\s+([1-9][0-9]*w|[0-9]+(?:\.[0-9]+)?x)$/);if(i){t=t.slice(0,-i[0].length);var a=+i[1].slice(0,-1),s=i[1].slice(-1);1===a&&"x"===s||(r=" "+a+s)}return n.minifyURLs(t)+r})).join(", ");else if(function(e,t){if("meta"!==e)return!1;for(var r=0,n=t.length;r<n;r++)if("name"===t[r].name&&"viewport"===t[r].value)return!0}(e,i)&&"content"===t)r=r.replace(/\s+/g,"").replace(/[0-9]+\.[0-9]+/g,(function(e){return(+e).toString()}));else if(n.customAttrCollapse&&n.customAttrCollapse.test(t))r=r.replace(/\n+|\r+|\s{2,}/g,"");else if("script"===e&&"type"===t)r=u(r.replace(/\s*;\s*/g,";"));else if(a=e,s=i,"media"===t&&(x(a,s,"stylesheet")||b(a,s)))return r=u(r),n.minifyCSS(r,"media");var a,s,o,l,c,f;return r}function D(e){return"/* clean-css ignore:start */"+e+"/* clean-css ignore:end */"}function _(e,t){switch(t){case"inline":return"*{"+e+"}";case"media":return"@media "+e+"{a{top:0}}";default:return e}}var A=d("html,head,body,colgroup,tbody"),R=d("html,head,body,li,dt,dd,p,rb,rt,rtc,rp,optgroup,option,colgroup,caption,thead,tbody,tfoot,tr,td,th"),M=d("meta,link,script,style,template,noscript"),N=d("dt,dd"),k=d("address,article,aside,blockquote,details,div,dl,fieldset,figcaption,figure,footer,form,h1,h2,h3,h4,h5,h6,header,hgroup,hr,main,menu,nav,ol,p,pre,section,table,ul"),O=d("a,audio,del,ins,map,noscript,video"),L=d("rb,rt,rtc,rp"),F=d("rb,rtc,rp"),B=d("option,optgroup"),V=d("tbody,tfoot"),U=d("thead,tbody,tfoot"),H=d("td,th"),z=d("html,head,body"),j=d("html,body"),q=d("head,colgroup,caption"),G=d("dt,thead"),W=d("a,abbr,acronym,address,applet,area,article,aside,audio,b,base,basefont,bdi,bdo,bgsound,big,blink,blockquote,body,br,button,canvas,caption,center,cite,code,col,colgroup,command,content,data,datalist,dd,del,details,dfn,dialog,dir,div,dl,dt,element,em,embed,fieldset,figcaption,figure,font,footer,form,frame,frameset,h1,h2,h3,h4,h5,h6,head,header,hgroup,hr,html,i,iframe,image,img,input,ins,isindex,kbd,keygen,label,legend,li,link,listing,main,map,mark,marquee,menu,menuitem,meta,meter,multicol,nav,nobr,noembed,noframes,noscript,object,ol,optgroup,option,output,p,param,picture,plaintext,pre,progress,q,rb,rp,rt,rtc,ruby,s,samp,script,section,select,shadow,small,source,spacer,span,strike,strong,style,sub,summary,sup,table,tbody,td,template,textarea,tfoot,th,thead,time,title,tr,track,tt,u,ul,var,video,wbr,xmp"),Y=new RegExp("^(?:class|id|style|title|lang|dir|on(?:focus|blur|change|click|dblclick|mouse(?:down|up|over|move|out)|key(?:press|down|up)))$");function K(e,t){for(var r=t.length-1;0<=r;r--)if(t[r].name===e)return!0;return!1}function Q(e){return!/^(?:script|style|pre|textarea)$/.test(e)}function X(e){return!/^(?:pre|textarea)$/.test(e)}function $(e,t,r,n){var a,s,o,l,c,h,f,d,p=n.name(e.name),m=e.value;if(n.decodeEntities&&m&&(m=i(m,{isAttributeValue:!0})),!(n.removeRedundantAttributes&&(a=r,s=p,l=t,o=(o=m)?u(o.toLowerCase()):"","script"===a&&"language"===s&&"javascript"===o||"form"===a&&"method"===s&&"get"===o||"input"===a&&"type"===s&&"text"===o||"script"===a&&"charset"===s&&!y(l,"src")||"a"===a&&"name"===s&&y(l,"id")||"area"===a&&"shape"===s&&"rect"===o)||n.removeScriptTypeAttributes&&"script"===r&&"type"===p&&E(m)||n.removeStyleLinkTypeAttributes&&("style"===r||"link"===r)&&"type"===p&&C(m))&&(m&&(m=w(r,p,m,n,t)),!n.removeEmptyAttributes||(c=r,h=p,d=n,(f=m)&&!/^\s*$/.test(f)||!("function"==typeof d.removeEmptyAttributes?d.removeEmptyAttributes(h,c):"input"===c&&"value"===h||Y.test(h)))))return n.decodeEntities&&m&&(m=m.replace(/&(#?[0-9a-zA-Z]+;)/g,"&amp;$1")),{attr:e,name:p,value:m}}function Z(e,t,r,n,i){var a,s,o,l,c=e.name,u=e.value,h=e.attr,f=h.quote;return void 0===u||r.removeAttributeQuotes&&!~u.indexOf(i)&&/^[^ \t\n\f\r"'`=<>]+$/.test(u)?s=!n||t||/\/$/.test(u)?u+" ":u:(r.preventAttributesEscaping||(f=void 0===r.quoteCharacter?(u.match(/'/g)||[]).length<(u.match(/"/g)||[]).length?"'":'"':"'"===r.quoteCharacter?"'":'"',u='"'===f?u.replace(/"/g,"&#34;"):u.replace(/'/g,"&#39;")),s=f+u+f,n||r.removeTagWhitespace||(s+=" ")),void 0===u||r.collapseBooleanAttributes&&(o=c.toLowerCase(),l=u.toLowerCase(),S(o)||"draggable"===o&&!I(l))?(a=c,n||(a+=" ")):a=c+h.customAssign+s,h.customOpen+a+h.customClose}function J(e){return e}function ee(e){for(var t;t=Math.random().toString(36).replace(/^0\.[0-9]*/,""),~e.indexOf(t););return t}var te=d("script,style");r.minify=function(e,t){var r,c,d=Date.now();r=t||{},c={name:function(e){return e.toLowerCase()},canCollapseWhitespace:Q,canTrimWhitespace:X,html5:!0,ignoreCustomComments:[/^!/],ignoreCustomFragments:[/<%[\s\S]*?%>/,/<\?[\s\S]*?\?>/],includeAutoGeneratedTags:!0,log:J,minifyCSS:J,minifyJS:J,minifyURLs:J},Object.keys(r).forEach((function(e){var t=r[e];if("caseSensitive"===e)t&&(c.name=J);else if("log"===e)"function"==typeof t&&(c.log=t);else if("minifyCSS"===e&&"function"!=typeof t){if(!t)return;"object"!=_typeof(t)&&(t={}),c.minifyCSS=function(e,r){e=e.replace(/(url\s*\(\s*)("|'|)(.*?)\2(\s*\))/gi,(function(e,t,r,n,i){return t+r+c.minifyURLs(n)+r+i}));var i=new n(t).minify(_(e,r));return 0<i.errors.length?(i.errors.forEach(c.log),e):function(e,t){var r;switch(t){case"inline":r=e.match(/^\*\{([\s\S]*)\}$/);break;case"media":r=e.match(/^@media ([\s\S]*?)\s*{[\s\S]*}$/)}return r?r[1]:e}(i.styles,r)}}else if("minifyJS"===e&&"function"!=typeof t){if(!t)return;"object"!=_typeof(t)&&(t={}),(t.parse||(t.parse={})).bare_returns=!1,c.minifyJS=function(e,r){var n=e.match(/^\s*<!--.*/),i=n?e.slice(n[0].length).replace(/\n\s*-->\s*$/,""):e;t.parse.bare_returns=r;var a=l.minify(i,t);return a.error?(c.log(a.error),e):a.code.replace(/;$/,"")}}else if("minifyURLs"===e&&"function"!=typeof t){if(!t)return;"string"==typeof t?t={site:t}:"object"!=_typeof(t)&&(t={}),c.minifyURLs=function(e){try{return s.relate(e,t)}catch(t){return c.log(t),e}}}else c[e]=t}));var g=function e(t,r,s){r.collapseWhitespace&&(t=f(t,r,!0,!0));var l,c,d,g,y,v=[],C="",S="",I=[],x=[],P=[],w="",Y="",re=[],ne=[];t=t.replace(/<!-- htmlmin:ignore -->([\s\S]*?)<!-- htmlmin:ignore -->/g,(function(e,n){if(!d){d=ee(t);var i=new RegExp("^"+d+"([0-9]+)$");r.ignoreCustomComments?r.ignoreCustomComments=r.ignoreCustomComments.slice():r.ignoreCustomComments=[],r.ignoreCustomComments.push(i)}var a="\x3c!--"+d+re.length+"--\x3e";return re.push(n),a}));var ie=r.ignoreCustomFragments.map((function(e){return e.source}));if(ie.length){var ae=new RegExp("\\s*(?:"+ie.join("|")+")+\\s*","g");t=t.replace(ae,(function(e){var i,a;g||(g=ee(t),y=new RegExp("(\\s*)"+g+"([0-9]+)(\\s*)","g"),r.minifyCSS&&(r.minifyCSS=(a=r.minifyCSS,function(e,t){e=e.replace(y,(function(e,t,r){var n=ne[+r];return n[1]+g+r+n[2]}));var r=[];return(new n).minify(_(e,t)).warnings.forEach((function(t){var n=y.exec(t);if(n){var i=g+n[2];e=e.replace(i,D(i)),r.push(i)}})),e=a(e,t),r.forEach((function(t){e=e.replace(D(t),t)})),e})),r.minifyJS&&(r.minifyJS=(i=r.minifyJS,function(e,t){return i(e.replace(y,(function(e,t,r){var n=ne[+r];return n[1]+g+r+n[2]})),t)})));var s=g+ne.length;return ne.push(/^(\s*)[\s\S]*?(\s*)$/.exec(e)),"\t"+s+"\t"}))}function se(e,t){return r.canTrimWhitespace(e,t,X)}function oe(){for(var e=v.length-1;0<e&&!/^<[^/!]/.test(v[e]);)e--;v.length=Math.max(0,e)}function le(){for(var e=v.length-1;0<e&&!/^<\//.test(v[e]);)e--;v.length=Math.max(0,e)}function ce(e,t){for(var n=null;0<=e&&se(n);e--){var i=v[e],a=i.match(/^<\/([\w:-]+)>$/);if(a)n=a[1];else if(/>$/.test(i)||(v[e]=T(i,null,t,r)))break}}function ue(e){var t=v.length-1;if(1<v.length){var r=v[v.length-1];/^(?:<!|$)/.test(r)&&-1===r.indexOf(d)&&t--}ce(t,e)}return(r.sortAttributes&&"function"!=typeof r.sortAttributes||r.sortClassName&&"function"!=typeof r.sortClassName)&&function(t,r,n,i){var s=r.sortAttributes&&Object.create(null),l=r.sortClassName&&new o;function c(e){return e.map((function(e){return r.name(e.name)}))}function h(e,t){return!t||-1===e.indexOf(t)}function f(e){return h(e,n)&&h(e,i)}var d=r.log;if(r.log=J,r.sortAttributes=!1,r.sortClassName=!1,function e(t){var n,i;new a(t,{start:function(e,t){s&&(s[e]||(s[e]=new o),s[e].add(c(t).filter(f)));for(var a=0,h=t.length;a<h;a++){var d=t[a];l&&d.value&&"class"===r.name(d.name)?l.add(u(d.value).split(/[ \t\n\f\r]+/).filter(f)):r.processScripts&&"type"===d.name.toLowerCase()&&(n=e,i=d.value)}},end:function(){n=""},chars:function(t){r.processScripts&&te(n)&&-1<r.processScripts.indexOf(i)&&e(t)}})}(e(t,r)),r.log=d,s){var p=Object.create(null);for(var m in s)p[m]=s[m].createSorter();r.sortAttributes=function(e,t){var r=p[e];if(r){var n=Object.create(null),i=c(t);i.forEach((function(e,r){(n[e]||(n[e]=[])).push(t[r])})),r.sort(i).forEach((function(e,r){t[r]=n[e].shift()}))}}}if(l){var g=l.createSorter();r.sortClassName=function(e){return g.sort(e.split(/[ \n\f\r]+/)).join(" ")}}}(t,r,d,g),new a(t,{partialMarkup:s,html5:r.html5,start:function(e,t,n,i,a){"svg"===e.toLowerCase()&&((r=Object.create(r)).caseSensitive=!0,r.keepClosingSlash=!0,r.name=J),e=r.name(e),m(l=S=e)||(C=""),c=!1,I=t;var s,o,u=r.removeOptionalTags;if(u){var h=W(e);h&&function(e,t){switch(e){case"html":case"head":return!0;case"body":return!M(t);case"colgroup":return"col"===t;case"tbody":return"tr"===t}return!1}(w,e)&&oe(),w="",h&&function(e,t){switch(e){case"html":case"head":case"body":case"colgroup":case"caption":return!0;case"li":case"optgroup":case"tr":return t===e;case"dt":case"dd":return N(t);case"p":return k(t);case"rb":case"rt":case"rp":return L(t);case"rtc":return F(t);case"option":return B(t);case"thead":case"tbody":return V(t);case"tfoot":return"tbody"===t;case"td":case"th":return H(t)}return!1}(Y,e)&&(le(),u=!function(e,t){switch(t){case"colgroup":return"colgroup"===e;case"tbody":return U(e)}return!1}(Y,e)),Y=""}r.collapseWhitespace&&(x.length||ue(e),n||(se(e,t)&&!x.length||x.push(e),s=e,o=t,(!r.canCollapseWhitespace(s,o,Q)||P.length)&&P.push(e)));var f="<"+e,d=i&&r.keepClosingSlash;v.push(f),r.sortAttributes&&r.sortAttributes(e,t);for(var p=[],T=t.length,y=!0;0<=--T;){var E=$(t[T],t,e,r);E&&(p.unshift(Z(E,d,r,y,g)),y=!1)}0<p.length?(v.push(" "),v.push.apply(v,p)):u&&A(e)&&(w=e),v.push(v.pop()+(d?"/":"")+">"),a&&!r.includeAutoGeneratedTags&&(oe(),w="")},end:function(e,t,n){"svg"===e.toLowerCase()&&(r=Object.getPrototypeOf(r)),e=r.name(e),r.collapseWhitespace&&(x.length?e===x[x.length-1]&&x.pop():ue("/"+e),P.length&&e===P[P.length-1]&&P.pop());var i=!1;e===S&&(S="",i=!c),r.removeOptionalTags&&(i&&z(w)&&oe(),w="",!W(e)||!Y||G(Y)||"p"===Y&&O(e)||le(),Y=R(e)?e:""),r.removeEmptyElements&&i&&function(e,t){switch(e){case"textarea":return!1;case"audio":case"script":case"video":if(K("src",t))return!1;break;case"iframe":if(K("src",t)||K("srcdoc",t))return!1;break;case"object":if(K("data",t))return!1;break;case"applet":if(K("code",t))return!1}return!0}(e,t)?(oe(),Y=w=""):(n&&!r.includeAutoGeneratedTags?Y="":v.push("</"+e+">"),l="/"+e,p(e)?i&&(C+="|"):C="")},chars:function(t,n,a){if(n=""===n?"comment":n,a=""===a?"comment":a,r.decodeEntities&&t&&!te(S)&&(t=i(t)),r.collapseWhitespace){if(!x.length){if("comment"===n){var s=v[v.length-1];if(-1===s.indexOf(d)&&(s||(n=l),1<v.length&&(!s||!r.conservativeCollapse&&/ $/.test(C)))){var o=v.length-2;v[o]=v[o].replace(/\s+$/,(function(e){return t=e+t,""}))}}if(n)if("/nobr"===n||"wbr"===n){if(/^\s/.test(t)){for(var u=v.length-1;0<u&&0!==v[u].lastIndexOf("<"+n);)u--;ce(u-1,"br")}}else m("/"===n.charAt(0)?n.slice(1):n)&&(t=f(t,r,/(?:^|\s)$/.test(C)));!(t=n||a?T(t,n,a,r):f(t,r,!0,!0))&&/\s$/.test(C)&&n&&"/"===n.charAt(0)&&ce(v.length-1,a)}P.length||"html"===a||n&&a||(t=f(t,r,!1,!1,!0))}r.processScripts&&te(S)&&(t=function(t,r,n){for(var i=0,a=n.length;i<a;i++)if("type"===n[i].name.toLowerCase()&&-1<r.processScripts.indexOf(n[i].value))return e(t,r);return t}(t,r,I)),function(e,t){if("script"!==e)return!1;for(var r=0,n=t.length;r<n;r++)if("type"===t[r].name.toLowerCase())return E(t[r].value);return!0}(S,I)&&(t=r.minifyJS(t)),b(S,I)&&(t=r.minifyCSS(t)),r.removeOptionalTags&&t&&(("html"===w||"body"===w&&!/^\s/.test(t))&&oe(),w="",(j(Y)||q(Y)&&!/^\s/.test(t))&&le(),Y=""),l=/^\s*$/.test(t)?n:"comment",r.decodeEntities&&t&&!te(S)&&(t=t.replace(/&((?:Iacute|aacute|uacute|plusmn|Otilde|otilde|agrave|Agrave|Yacute|yacute|Oslash|oslash|atilde|Atilde|brvbar|ccedil|Ccedil|Ograve|curren|divide|eacute|Eacute|ograve|Oacute|egrave|Egrave|Ugrave|frac12|frac14|frac34|ugrave|oacute|iacute|Ntilde|ntilde|Uacute|middot|igrave|Igrave|iquest|Aacute|cedil|laquo|micro|iexcl|Icirc|icirc|acirc|Ucirc|Ecirc|ocirc|Ocirc|ecirc|ucirc|Aring|aring|AElig|aelig|acute|pound|raquo|Acirc|times|THORN|szlig|thorn|COPY|auml|ordf|ordm|Uuml|macr|uuml|Auml|ouml|Ouml|para|nbsp|euml|quot|QUOT|Euml|yuml|cent|sect|copy|sup1|sup2|sup3|iuml|Iuml|ETH|shy|reg|not|yen|amp|AMP|REG|uml|eth|deg|gt|GT|LT|lt)(?!;)|(?:#?[0-9a-zA-Z]+;))/g,"&amp$1").replace(/</g,"&lt;")),y&&r.collapseWhitespace&&x.length&&(t=t.replace(y,(function(e,t,r){return ne[+r][0]}))),C+=t,t&&(c=!0),v.push(t)},comment:function(t,n){var i,a,s=n?"<!":"\x3c!--",o=n?">":"--\x3e";t=/^\[if\s[^\]]+]|\[endif]$/.test(t)?s+(i=t,(a=r).processConditionalComments?i.replace(/^(\[if\s[^\]]+]>)([\s\S]*?)(<!\[endif])$/,(function(t,r,n,i){return r+e(n,a,!0)+i})):i)+o:r.removeComments?function(e,t){for(var r=0,n=t.ignoreCustomComments.length;r<n;r++)if(t.ignoreCustomComments[r].test(e))return!0;return!1}(t,r)?"\x3c!--"+t+"--\x3e":"":s+t+o,r.removeOptionalTags&&t&&(Y=w=""),v.push(t)},doctype:function(e){v.push(r.useShortDoctype?"<!doctype html>":h(e))},customAttrAssign:r.customAttrAssign,customAttrSurround:r.customAttrSurround}),r.removeOptionalTags&&(z(w)&&oe(),Y&&!G(Y)&&le()),r.collapseWhitespace&&ue("br"),function(e,t,r,n){var i,a=t.maxLineLength;if(a){for(var s="",o=[];e.length;){var l=s.length,c=e[0].indexOf("\n");c<0?s+=n(r(e.shift())):(s+=n(r(e[0].slice(0,c))),e[0]=e[0].slice(c+1)),0<l&&s.length>a?(o.push(s.slice(0,l)),s=s.slice(l)):0<=c&&(o.push(s),s="")}s&&o.push(s),i=o.join("\n")}else i=n(r(e.join("")));return t.collapseWhitespace?f(i,t,!0,!0):i}(v,r,y?function(e){return e.replace(y,(function(e,t,n,i){var a=ne[+n][0];return r.collapseWhitespace?("\t"!==t&&(a=t+a),"\t"!==i&&(a+=i),f(a,{preserveLineBreaks:r.preserveLineBreaks,conservativeCollapse:!r.trimCustomFragments},/^[ \n\r\t\f]/.test(a),/[ \n\r\t\f]$/.test(a))):a}))}:J,d?function(e){return e.replace(new RegExp("\x3c!--"+d+"([0-9]+)--\x3e","g"),(function(e,t){return re[+t]}))}:J)}(e,t=c);return t.log("minified in: "+(Date.now()-d)+"ms"),g}},{"./htmlparser":166,"./tokenchain":167,"./utils":168,"clean-css":6,he:103,relateurl:128,"uglify-js":"uglify-js"}],"uglify-js":[function(e,t,r){(function(e){!function(t){"use strict";function r(e){return e.split("")}function n(e,t){return 0<=t.indexOf(e)}function i(e,t){for(var r=t.length;0<=--r;)if(e(t[r]))return t[r]}function a(e){Object.defineProperty(e.prototype,"stack",{get:function(){var e=new Error(this.message);e.name=this.name;try{throw e}catch(e){return e.stack}}})}function s(e,t){this.message=e,this.defs=t}function o(e,t,r){!0===e&&(e={});var n=e||{};if(r)for(var i in n)if(C(n,i)&&!C(t,i))throw new s("`"+i+"` is not a supported option",t);for(var i in t)C(t,i)&&(n[i]=e&&C(e,i)?e[i]:t[i]);return n}function l(e,t){var r=0;for(var n in t)C(t,n)&&(e[n]=t[n],r++);return r}function c(){}function u(){return!1}function h(){return!0}function f(){return this}function d(){return null}((s.prototype=Object.create(Error.prototype)).constructor=s).prototype.name="DefaultsError",a(s);var p=function(){function e(e,a,s){var o,l=[],c=[];function u(){var u=a(e[o],o),h=u instanceof i;return h&&(u=u.v),u instanceof r?(u=u.v)instanceof n?c.push.apply(c,s?u.v.slice().reverse():u.v):c.push(u):u!==t&&(u instanceof n?l.push.apply(l,s?u.v.slice().reverse():u.v):l.push(u)),h}if(Array.isArray(e))if(s){for(o=e.length;0<=--o&&!u(););l.reverse(),c.reverse()}else for(o=0;o<e.length&&!u();++o);else for(o in e)if(C(e,o)&&u())break;return c.concat(l)}e.at_top=function(e){return new r(e)},e.splice=function(e){return new n(e)},e.last=function(e){return new i(e)};var t=e.skip={};function r(e){this.v=e}function n(e){this.v=e}function i(e){this.v=e}return e}();function m(e,t){if(e.indexOf(t)<0)return e.push(t)}function g(e,t){return e.replace(/\{(.+?)\}/g,(function(e,r){return t&&t[r]}))}function T(e,t){var r=e.indexOf(t);0<=r&&e.splice(r,1)}function y(e){Array.isArray(e)||(e=e.split(" "));var t=Object.create(null);return e.forEach((function(e){t[e]=!0})),t}function v(e,t){for(var r=e.length;0<=--r;)if(!t(e[r]))return!1;return!0}function E(){this._values=Object.create(null),this._size=0}function C(e,t){return Object.prototype.hasOwnProperty.call(e,t)}function b(e){for(var t,r=e.parent(-1),n=0;t=e.parent(n++);r=t){if("Call"==t.TYPE){if(t.expression===r)continue}else if(t instanceof be){if(t.left===r)continue}else if(t instanceof Se){if(t.condition===r)continue}else if(t instanceof ge){if(t.expression===r)continue}else if(t instanceof me){if(t.expressions[0]===r)continue}else{if(t instanceof P)return t.body===r;if(t instanceof Ce&&t.expression===r)continue}return!1}}function S(e,r,n,i){void 0===i&&(i=x);var a=r=r?r.split(/\s+/):[];i&&i.PROPS&&(r=r.concat(i.PROPS));var s=["return function AST_",e,"(props){","if(props){"];r.forEach((function(e){s.push("this.",e,"=props.",e,";")}));var o=i&&new i;(o&&o.initialize||n&&n.initialize)&&s.push("this.initialize();"),s.push("}}");var l=new Function(s.join(""))();if(o&&(l.prototype=o,l.BASE=i),i&&i.SUBCLASSES.push(l),(l.prototype.CTOR=l).PROPS=r||null,l.SELF_PROPS=a,l.SUBCLASSES=[],e&&(l.prototype.TYPE=l.TYPE=e),n)for(var c in n)C(n,c)&&(/^\$/.test(c)?l[c.substr(1)]=n[c]:l.prototype[c]=n[c]);return l.DEFMETHOD=function(e,t){this.prototype[e]=t},void 0!==t&&(t["AST_"+e]=l),l}E.prototype={set:function(e,t){return this.has(e)||++this._size,this._values["$"+e]=t,this},add:function(e,t){return this.has(e)?this.get(e).push(t):this.set(e,[t]),this},get:function(e){return this._values["$"+e]},del:function(e){return this.has(e)&&(--this._size,delete this._values["$"+e]),this},has:function(e){return"$"+e in this._values},each:function(e){for(var t in this._values)e(this._values[t],t.substr(1))},size:function(){return this._size},map:function(e){var t=[];for(var r in this._values)t.push(e(this._values[r],r.substr(1)));return t},clone:function(){var e=new E;for(var t in this._values)e._values[t]=this._values[t];return e._size=this._size,e},toObject:function(){return this._values}},E.fromObject=function(e){var t=new E;return t._size=l(t._values,e),t};var I=S("Token","type value line col pos endline endcol endpos nlb comments_before comments_after file raw",{},null),x=S("Node","start end",{_clone:function(e){if(e){var t=this.clone();return t.transform(new Ot((function(e){if(e!==t)return e.clone(!0)})))}return new this.CTOR(this)},clone:function(e){return this._clone(e)},$documentation:"Base class of all AST nodes",$propdoc:{start:"[AST_Token] The first token of this node",end:"[AST_Token] The last token of this node"},_walk:function(e){return e._visit(this)},walk:function(e){return this._walk(e)}},null);x.warn=function(e,t){x.warn_function&&x.warn_function(g(e,t))};var P=S("Statement",null,{$documentation:"Base class of all statements"}),w=S("Debugger",null,{$documentation:"Represents a debugger statement"},P),D=S("Directive","value quote",{$documentation:'Represents a directive, like "use strict";',$propdoc:{value:"[string] The value of this directive as a plain string (it's not an AST_String!)",quote:"[string] the original quote character"}},P),_=S("SimpleStatement","body",{$documentation:"A statement consisting of an expression, i.e. a = 1 + 2",$propdoc:{body:"[AST_Node] an expression node (should not be instanceof AST_Statement)"},_walk:function(e){return e._visit(this,(function(){this.body._walk(e)}))}},P);function A(e,t){var r=e.body;r instanceof P?r._walk(t):r.forEach((function(e){e._walk(t)}))}var R=S("Block","body",{$documentation:"A body of statements (usually braced)",$propdoc:{body:"[AST_Statement*] an array of statements"},_walk:function(e){return e._visit(this,(function(){A(this,e)}))}},P),M=S("BlockStatement",null,{$documentation:"A block statement"},R),N=S("EmptyStatement",null,{$documentation:"The empty statement (empty block or simply a semicolon)"},P),k=S("StatementWithBody","body",{$documentation:"Base class for all statements that contain one nested body: `For`, `ForIn`, `Do`, `While`, `With`",$propdoc:{body:"[AST_Statement] the body; this should always be present, even if it's an AST_EmptyStatement"}},P),O=S("LabeledStatement","label",{$documentation:"Statement with a label",$propdoc:{label:"[AST_Label] a label definition"},_walk:function(e){return e._visit(this,(function(){this.label._walk(e),this.body._walk(e)}))},clone:function(e){var t=this._clone(e);if(e){var r=t.label,n=this.label;t.walk(new rt((function(e){e instanceof J&&e.label&&e.label.thedef===n&&(e.label.thedef=r).references.push(e)})))}return t}},k),L=S("IterationStatement",null,{$documentation:"Internal class.  All loops inherit from it."},k),F=S("DWLoop","condition",{$documentation:"Base class for do/while statements",$propdoc:{condition:"[AST_Node] the loop condition.  Should not be instanceof AST_Statement"}},L),B=S("Do",null,{$documentation:"A `do` statement",_walk:function(e){return e._visit(this,(function(){this.body._walk(e),this.condition._walk(e)}))}},F),V=S("While",null,{$documentation:"A `while` statement",_walk:function(e){return e._visit(this,(function(){this.condition._walk(e),this.body._walk(e)}))}},F),U=S("For","init condition step",{$documentation:"A `for` statement",$propdoc:{init:"[AST_Node?] the `for` initialization code, or null if empty",condition:"[AST_Node?] the `for` termination clause, or null if empty",step:"[AST_Node?] the `for` update clause, or null if empty"},_walk:function(e){return e._visit(this,(function(){this.init&&this.init._walk(e),this.condition&&this.condition._walk(e),this.step&&this.step._walk(e),this.body._walk(e)}))}},L),H=S("ForIn","init object",{$documentation:"A `for ... in` statement",$propdoc:{init:"[AST_Node] the `for/in` initialization code",object:"[AST_Node] the object that we're looping through"},_walk:function(e){return e._visit(this,(function(){this.init._walk(e),this.object._walk(e),this.body._walk(e)}))}},L),z=S("With","expression",{$documentation:"A `with` statement",$propdoc:{expression:"[AST_Node] the `with` expression"},_walk:function(e){return e._visit(this,(function(){this.expression._walk(e),this.body._walk(e)}))}},k),j=S("Scope","variables functions uses_with uses_eval parent_scope enclosed cname",{$documentation:"Base class for all statements introducing a lexical scope",$propdoc:{variables:"[Object/S] a map of name -> SymbolDef for all variables/functions defined in this scope",functions:"[Object/S] like `variables`, but only lists function declarations",uses_with:"[boolean/S] tells whether this scope uses the `with` statement",uses_eval:"[boolean/S] tells whether this scope contains a direct call to the global `eval`",parent_scope:"[AST_Scope?/S] link to the parent scope",enclosed:"[SymbolDef*/S] a list of all symbol definitions that are accessed from this scope or any subscopes",cname:"[integer/S] current index for mangling variables (used internally by the mangler)"},clone:function(e){var t=this._clone(e);return this.variables&&(t.variables=this.variables.clone()),this.functions&&(t.functions=this.functions.clone()),this.enclosed&&(t.enclosed=this.enclosed.slice()),t},pinned:function(){return this.uses_eval||this.uses_with}},R),q=S("Toplevel","globals",{$documentation:"The toplevel scope",$propdoc:{globals:"[Object/S] a map of name -> SymbolDef for all undeclared names"},wrap_commonjs:function(e){var t=this.body,r="(function(exports){'$ORIG';})(typeof "+e+"=='undefined'?("+e+"={}):"+e+");";return(r=kt(r)).transform(new Ot((function(e){if(e instanceof D&&"$ORIG"==e.value)return p.splice(t)})))},wrap_enclose:function(e){"string"!=typeof e&&(e="");var t=e.indexOf(":");t<0&&(t=e.length);var r=this.body;return kt(["(function(",e.slice(0,t),'){"$ORIG"})(',e.slice(t+1),")"].join("")).transform(new Ot((function(e){if(e instanceof D&&"$ORIG"==e.value)return p.splice(r)})))}},j),G=S("Lambda","name argnames uses_arguments",{$documentation:"Base class for functions",$propdoc:{name:"[AST_SymbolDeclaration?] the name of this function",argnames:"[AST_SymbolFunarg*] array of function arguments",uses_arguments:"[boolean/S] tells whether this function accesses the arguments array"},_walk:function(e){return e._visit(this,(function(){this.name&&this.name._walk(e),this.argnames.forEach((function(t){t._walk(e)})),A(this,e)}))}},j),W=S("Accessor",null,{$documentation:"A setter/getter function.  The `name` property is always null."},G),Y=S("Function","inlined",{$documentation:"A function expression"},G),K=S("Defun","inlined",{$documentation:"A function definition"},G),Q=S("Jump",null,{$documentation:"Base class for “jumps” (for now that's `return`, `throw`, `break` and `continue`)"},P),X=S("Exit","value",{$documentation:"Base class for “exits” (`return` and `throw`)",$propdoc:{value:"[AST_Node?] the value returned or thrown by this statement; could be null for AST_Return"},_walk:function(e){return e._visit(this,this.value&&function(){this.value._walk(e)})}},Q),$=S("Return",null,{$documentation:"A `return` statement"},X),Z=S("Throw",null,{$documentation:"A `throw` statement"},X),J=S("LoopControl","label",{$documentation:"Base class for loop control statements (`break` and `continue`)",$propdoc:{label:"[AST_LabelRef?] the label, or null if none"},_walk:function(e){return e._visit(this,this.label&&function(){this.label._walk(e)})}},Q),ee=S("Break",null,{$documentation:"A `break` statement"},J),te=S("Continue",null,{$documentation:"A `continue` statement"},J),re=S("If","condition alternative",{$documentation:"A `if` statement",$propdoc:{condition:"[AST_Node] the `if` condition",alternative:"[AST_Statement?] the `else` part, or null if not present"},_walk:function(e){return e._visit(this,(function(){this.condition._walk(e),this.body._walk(e),this.alternative&&this.alternative._walk(e)}))}},k),ne=S("Switch","expression",{$documentation:"A `switch` statement",$propdoc:{expression:"[AST_Node] the `switch` “discriminant”"},_walk:function(e){return e._visit(this,(function(){this.expression._walk(e),A(this,e)}))}},R),ie=S("SwitchBranch",null,{$documentation:"Base class for `switch` branches"},R),ae=S("Default",null,{$documentation:"A `default` switch branch"},ie),se=S("Case","expression",{$documentation:"A `case` switch branch",$propdoc:{expression:"[AST_Node] the `case` expression"},_walk:function(e){return e._visit(this,(function(){this.expression._walk(e),A(this,e)}))}},ie),oe=S("Try","bcatch bfinally",{$documentation:"A `try` statement",$propdoc:{bcatch:"[AST_Catch?] the catch block, or null if not present",bfinally:"[AST_Finally?] the finally block, or null if not present"},_walk:function(e){return e._visit(this,(function(){A(this,e),this.bcatch&&this.bcatch._walk(e),this.bfinally&&this.bfinally._walk(e)}))}},R),le=S("Catch","argname",{$documentation:"A `catch` node; only makes sense as part of a `try` statement",$propdoc:{argname:"[AST_SymbolCatch] symbol for the exception"},_walk:function(e){return e._visit(this,(function(){this.argname._walk(e),A(this,e)}))}},R),ce=S("Finally",null,{$documentation:"A `finally` node; only makes sense as part of a `try` statement"},R),ue=S("Definitions","definitions",{$documentation:"Base class for `var` nodes (variable declarations/initializations)",$propdoc:{definitions:"[AST_VarDef*] array of variable definitions"},_walk:function(e){return e._visit(this,(function(){this.definitions.forEach((function(t){t._walk(e)}))}))}},P),he=S("Var",null,{$documentation:"A `var` statement"},ue),fe=S("VarDef","name value",{$documentation:"A variable declaration; only appears in a AST_Definitions node",$propdoc:{name:"[AST_SymbolVar] name of the variable",value:"[AST_Node?] initializer, or null of there's no initializer"},_walk:function(e){return e._visit(this,(function(){this.name._walk(e),this.value&&this.value._walk(e)}))}}),de=S("Call","expression args",{$documentation:"A function call expression",$propdoc:{expression:"[AST_Node] expression to invoke as function",args:"[AST_Node*] array of arguments"},_walk:function(e){return e._visit(this,(function(){this.expression._walk(e),this.args.forEach((function(t){t._walk(e)}))}))}}),pe=S("New",null,{$documentation:"An object instantiation.  Derives from a function call since it has exactly the same properties"},de),me=S("Sequence","expressions",{$documentation:"A sequence expression (comma-separated expressions)",$propdoc:{expressions:"[AST_Node*] array of expressions (at least two)"},_walk:function(e){return e._visit(this,(function(){this.expressions.forEach((function(t){t._walk(e)}))}))}}),ge=S("PropAccess","expression property",{$documentation:'Base class for property access expressions, i.e. `a.foo` or `a["foo"]`',$propdoc:{expression:"[AST_Node] the “container” expression",property:"[AST_Node|string] the property to access.  For AST_Dot this is always a plain string, while for AST_Sub it's an arbitrary AST_Node"}}),Te=S("Dot",null,{$documentation:"A dotted property access expression",_walk:function(e){return e._visit(this,(function(){this.expression._walk(e)}))}},ge),ye=S("Sub",null,{$documentation:'Index-style property access, i.e. `a["foo"]`',_walk:function(e){return e._visit(this,(function(){this.expression._walk(e),this.property._walk(e)}))}},ge),ve=S("Unary","operator expression",{$documentation:"Base class for unary expressions",$propdoc:{operator:"[string] the operator",expression:"[AST_Node] expression that this unary operator applies to"},_walk:function(e){return e._visit(this,(function(){this.expression._walk(e)}))}}),Ee=S("UnaryPrefix",null,{$documentation:"Unary prefix expression, i.e. `typeof i` or `++i`"},ve),Ce=S("UnaryPostfix",null,{$documentation:"Unary postfix expression, i.e. `i++`"},ve),be=S("Binary","operator left right",{$documentation:"Binary expression, i.e. `a + b`",$propdoc:{left:"[AST_Node] left-hand side expression",operator:"[string] the operator",right:"[AST_Node] right-hand side expression"},_walk:function(e){return e._visit(this,(function(){this.left._walk(e),this.right._walk(e)}))}}),Se=S("Conditional","condition consequent alternative",{$documentation:"Conditional expression using the ternary operator, i.e. `a ? b : c`",$propdoc:{condition:"[AST_Node]",consequent:"[AST_Node]",alternative:"[AST_Node]"},_walk:function(e){return e._visit(this,(function(){this.condition._walk(e),this.consequent._walk(e),this.alternative._walk(e)}))}}),Ie=S("Assign",null,{$documentation:"An assignment expression — `a = b + 5`"},be),xe=S("Array","elements",{$documentation:"An array literal",$propdoc:{elements:"[AST_Node*] array of elements"},_walk:function(e){return e._visit(this,(function(){this.elements.forEach((function(t){t._walk(e)}))}))}}),Pe=S("Object","properties",{$documentation:"An object literal",$propdoc:{properties:"[AST_ObjectProperty*] array of properties"},_walk:function(e){return e._visit(this,(function(){this.properties.forEach((function(t){t._walk(e)}))}))}}),we=S("ObjectProperty","key value",{$documentation:"Base class for literal object properties",$propdoc:{key:"[string|AST_SymbolAccessor] property name. For ObjectKeyVal this is a string. For getters and setters this is an AST_SymbolAccessor.",value:"[AST_Node] property value.  For getters and setters this is an AST_Accessor."},_walk:function(e){return e._visit(this,(function(){this.value._walk(e)}))}}),De=S("ObjectKeyVal","quote",{$documentation:"A key: value object property",$propdoc:{quote:"[string] the original quote character"}},we),_e=S("ObjectSetter",null,{$documentation:"An object setter property"},we),Ae=S("ObjectGetter",null,{$documentation:"An object getter property"},we),Re=S("Symbol","scope name thedef",{$propdoc:{name:"[string] name of this symbol",scope:"[AST_Scope/S] the current scope (not necessarily the definition scope)",thedef:"[SymbolDef/S] the definition of this symbol"},$documentation:"Base class for all symbols"}),Me=S("SymbolAccessor",null,{$documentation:"The name of a property accessor (setter/getter function)"},Re),Ne=S("SymbolDeclaration","init",{$documentation:"A declaration symbol (symbol in var, function name or argument, symbol in catch)"},Re),ke=S("SymbolVar",null,{$documentation:"Symbol defining a variable"},Ne),Oe=S("SymbolFunarg",null,{$documentation:"Symbol naming a function argument"},ke),Le=S("SymbolDefun",null,{$documentation:"Symbol defining a function"},Ne),Fe=S("SymbolLambda",null,{$documentation:"Symbol naming a function expression"},Ne),Be=S("SymbolCatch",null,{$documentation:"Symbol naming the exception in catch"},Ne),Ve=S("Label","references",{$documentation:"Symbol naming a label (declaration)",$propdoc:{references:"[AST_LoopControl*] a list of nodes referring to this label"},initialize:function(){this.references=[],this.thedef=this}},Re),Ue=S("SymbolRef",null,{$documentation:"Reference to some symbol (not definition/declaration)"},Re),He=S("LabelRef",null,{$documentation:"Reference to a label symbol"},Re),ze=S("This",null,{$documentation:"The `this` symbol"},Re),je=S("Constant",null,{$documentation:"Base class for all constants",getValue:function(){return this.value}}),qe=S("String","value quote",{$documentation:"A string literal",$propdoc:{value:"[string] the contents of this string",quote:"[string] the original quote character"}},je),Ge=S("Number","value literal",{$documentation:"A number literal",$propdoc:{value:"[number] the numeric value",literal:"[string] numeric value as string (optional)"}},je),We=S("RegExp","value",{$documentation:"A regexp literal",$propdoc:{value:"[RegExp] the actual regexp"}},je),Ye=S("Atom",null,{$documentation:"Base class for atoms"},je),Ke=S("Null",null,{$documentation:"The `null` atom",value:null},Ye),Qe=S("NaN",null,{$documentation:"The impossible value",value:NaN},Ye),Xe=S("Undefined",null,{$documentation:"The `undefined` value",value:void 0},Ye),$e=S("Hole",null,{$documentation:"A hole in an array",value:void 0},Ye),Ze=S("Infinity",null,{$documentation:"The `Infinity` value",value:1/0},Ye),Je=S("Boolean",null,{$documentation:"Base class for booleans"},Ye),et=S("False",null,{$documentation:"The `false` atom",value:!1},Je),tt=S("True",null,{$documentation:"The `true` atom",value:!0},Je);function rt(e){this.visit=e,this.stack=[],this.directives=Object.create(null)}rt.prototype={_visit:function(e,t){this.push(e);var r=this.visit(e,t?function(){t.call(e)}:c);return!r&&t&&t.call(e),this.pop(),r},parent:function(e){return this.stack[this.stack.length-2-(e||0)]},push:function(e){e instanceof G?this.directives=Object.create(this.directives):e instanceof D&&!this.directives[e.value]&&(this.directives[e.value]=e),this.stack.push(e)},pop:function(){this.stack.pop()instanceof G&&(this.directives=Object.getPrototypeOf(this.directives))},self:function(){return this.stack[this.stack.length-1]},find_parent:function(e){for(var t=this.stack,r=t.length;0<=--r;){var n=t[r];if(n instanceof e)return n}},has_directive:function(e){var t=this.directives[e];if(t)return t;var r=this.stack[this.stack.length-1];if(r instanceof j)for(var n=0;n<r.body.length;++n){var i=r.body[n];if(!(i instanceof D))break;if(i.value==e)return i}},loopcontrol_target:function(e){var t=this.stack;if(e.label){for(var r=t.length;0<=--r;)if((n=t[r])instanceof O&&n.label.name==e.label.name)return n.body}else for(r=t.length;0<=--r;){var n;if((n=t[r])instanceof L||e instanceof ee&&n instanceof ne)return n}},in_boolean_context:function(){for(var e,t=this.self(),r=0;e=this.parent(r);r++){if(e instanceof _||e instanceof Se&&e.condition===t||e instanceof F&&e.condition===t||e instanceof U&&e.condition===t||e instanceof re&&e.condition===t||e instanceof Ee&&"!"==e.operator&&e.expression===t)return!0;if(!(e instanceof be&&("&&"==e.operator||"||"==e.operator)||e instanceof Se||e.tail_node()===t))return!1;t=e}}};var nt="break case catch const continue debugger default delete do else finally for function if in instanceof new return switch throw try typeof var void while with",it="false null true",at="abstract boolean byte char class double enum export extends final float goto implements import int interface let long native package private protected public short static super synchronized this throws transient volatile yield "+it+" "+nt,st="return new delete throw else case";nt=y(nt),at=y(at),st=y(st),it=y(it);var ot=y(r("+-*&%=<>!?|~^")),lt=/^0x[0-9a-f]+$/i,ct=/^0[0-7]+$/,ut=y(["in","instanceof","typeof","new","void","delete","++","--","+","-","!","~","&","|","^","*","/","%",">>","<<",">>>","<",">","<=",">=","==","===","!=","!==","?","=","+=","-=","/=","*=","%=",">>=","<<=",">>>=","|=","^=","&=","&&","||"]),ht=y(r("  \n\r\t\f\v​           \u2028\u2029  　\ufeff")),ft=y(r("\n\r\u2028\u2029")),dt=y(r("[{(,;:")),pt=y(r("[]{}(),;:")),mt={letter:new RegExp("[\\u0041-\\u005A\\u0061-\\u007A\\u00AA\\u00B5\\u00BA\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02C1\\u02C6-\\u02D1\\u02E0-\\u02E4\\u02EC\\u02EE\\u0370-\\u0374\\u0376\\u0377\\u037A-\\u037D\\u037F\\u0386\\u0388-\\u038A\\u038C\\u038E-\\u03A1\\u03A3-\\u03F5\\u03F7-\\u0481\\u048A-\\u052F\\u0531-\\u0556\\u0559\\u0561-\\u0587\\u05D0-\\u05EA\\u05F0-\\u05F2\\u0620-\\u064A\\u066E\\u066F\\u0671-\\u06D3\\u06D5\\u06E5\\u06E6\\u06EE\\u06EF\\u06FA-\\u06FC\\u06FF\\u0710\\u0712-\\u072F\\u074D-\\u07A5\\u07B1\\u07CA-\\u07EA\\u07F4\\u07F5\\u07FA\\u0800-\\u0815\\u081A\\u0824\\u0828\\u0840-\\u0858\\u08A0-\\u08B2\\u0904-\\u0939\\u093D\\u0950\\u0958-\\u0961\\u0971-\\u0980\\u0985-\\u098C\\u098F\\u0990\\u0993-\\u09A8\\u09AA-\\u09B0\\u09B2\\u09B6-\\u09B9\\u09BD\\u09CE\\u09DC\\u09DD\\u09DF-\\u09E1\\u09F0\\u09F1\\u0A05-\\u0A0A\\u0A0F\\u0A10\\u0A13-\\u0A28\\u0A2A-\\u0A30\\u0A32\\u0A33\\u0A35\\u0A36\\u0A38\\u0A39\\u0A59-\\u0A5C\\u0A5E\\u0A72-\\u0A74\\u0A85-\\u0A8D\\u0A8F-\\u0A91\\u0A93-\\u0AA8\\u0AAA-\\u0AB0\\u0AB2\\u0AB3\\u0AB5-\\u0AB9\\u0ABD\\u0AD0\\u0AE0\\u0AE1\\u0B05-\\u0B0C\\u0B0F\\u0B10\\u0B13-\\u0B28\\u0B2A-\\u0B30\\u0B32\\u0B33\\u0B35-\\u0B39\\u0B3D\\u0B5C\\u0B5D\\u0B5F-\\u0B61\\u0B71\\u0B83\\u0B85-\\u0B8A\\u0B8E-\\u0B90\\u0B92-\\u0B95\\u0B99\\u0B9A\\u0B9C\\u0B9E\\u0B9F\\u0BA3\\u0BA4\\u0BA8-\\u0BAA\\u0BAE-\\u0BB9\\u0BD0\\u0C05-\\u0C0C\\u0C0E-\\u0C10\\u0C12-\\u0C28\\u0C2A-\\u0C39\\u0C3D\\u0C58\\u0C59\\u0C60\\u0C61\\u0C85-\\u0C8C\\u0C8E-\\u0C90\\u0C92-\\u0CA8\\u0CAA-\\u0CB3\\u0CB5-\\u0CB9\\u0CBD\\u0CDE\\u0CE0\\u0CE1\\u0CF1\\u0CF2\\u0D05-\\u0D0C\\u0D0E-\\u0D10\\u0D12-\\u0D3A\\u0D3D\\u0D4E\\u0D60\\u0D61\\u0D7A-\\u0D7F\\u0D85-\\u0D96\\u0D9A-\\u0DB1\\u0DB3-\\u0DBB\\u0DBD\\u0DC0-\\u0DC6\\u0E01-\\u0E30\\u0E32\\u0E33\\u0E40-\\u0E46\\u0E81\\u0E82\\u0E84\\u0E87\\u0E88\\u0E8A\\u0E8D\\u0E94-\\u0E97\\u0E99-\\u0E9F\\u0EA1-\\u0EA3\\u0EA5\\u0EA7\\u0EAA\\u0EAB\\u0EAD-\\u0EB0\\u0EB2\\u0EB3\\u0EBD\\u0EC0-\\u0EC4\\u0EC6\\u0EDC-\\u0EDF\\u0F00\\u0F40-\\u0F47\\u0F49-\\u0F6C\\u0F88-\\u0F8C\\u1000-\\u102A\\u103F\\u1050-\\u1055\\u105A-\\u105D\\u1061\\u1065\\u1066\\u106E-\\u1070\\u1075-\\u1081\\u108E\\u10A0-\\u10C5\\u10C7\\u10CD\\u10D0-\\u10FA\\u10FC-\\u1248\\u124A-\\u124D\\u1250-\\u1256\\u1258\\u125A-\\u125D\\u1260-\\u1288\\u128A-\\u128D\\u1290-\\u12B0\\u12B2-\\u12B5\\u12B8-\\u12BE\\u12C0\\u12C2-\\u12C5\\u12C8-\\u12D6\\u12D8-\\u1310\\u1312-\\u1315\\u1318-\\u135A\\u1380-\\u138F\\u13A0-\\u13F4\\u1401-\\u166C\\u166F-\\u167F\\u1681-\\u169A\\u16A0-\\u16EA\\u16EE-\\u16F8\\u1700-\\u170C\\u170E-\\u1711\\u1720-\\u1731\\u1740-\\u1751\\u1760-\\u176C\\u176E-\\u1770\\u1780-\\u17B3\\u17D7\\u17DC\\u1820-\\u1877\\u1880-\\u18A8\\u18AA\\u18B0-\\u18F5\\u1900-\\u191E\\u1950-\\u196D\\u1970-\\u1974\\u1980-\\u19AB\\u19C1-\\u19C7\\u1A00-\\u1A16\\u1A20-\\u1A54\\u1AA7\\u1B05-\\u1B33\\u1B45-\\u1B4B\\u1B83-\\u1BA0\\u1BAE\\u1BAF\\u1BBA-\\u1BE5\\u1C00-\\u1C23\\u1C4D-\\u1C4F\\u1C5A-\\u1C7D\\u1CE9-\\u1CEC\\u1CEE-\\u1CF1\\u1CF5\\u1CF6\\u1D00-\\u1DBF\\u1E00-\\u1F15\\u1F18-\\u1F1D\\u1F20-\\u1F45\\u1F48-\\u1F4D\\u1F50-\\u1F57\\u1F59\\u1F5B\\u1F5D\\u1F5F-\\u1F7D\\u1F80-\\u1FB4\\u1FB6-\\u1FBC\\u1FBE\\u1FC2-\\u1FC4\\u1FC6-\\u1FCC\\u1FD0-\\u1FD3\\u1FD6-\\u1FDB\\u1FE0-\\u1FEC\\u1FF2-\\u1FF4\\u1FF6-\\u1FFC\\u2071\\u207F\\u2090-\\u209C\\u2102\\u2107\\u210A-\\u2113\\u2115\\u2119-\\u211D\\u2124\\u2126\\u2128\\u212A-\\u212D\\u212F-\\u2139\\u213C-\\u213F\\u2145-\\u2149\\u214E\\u2160-\\u2188\\u2C00-\\u2C2E\\u2C30-\\u2C5E\\u2C60-\\u2CE4\\u2CEB-\\u2CEE\\u2CF2\\u2CF3\\u2D00-\\u2D25\\u2D27\\u2D2D\\u2D30-\\u2D67\\u2D6F\\u2D80-\\u2D96\\u2DA0-\\u2DA6\\u2DA8-\\u2DAE\\u2DB0-\\u2DB6\\u2DB8-\\u2DBE\\u2DC0-\\u2DC6\\u2DC8-\\u2DCE\\u2DD0-\\u2DD6\\u2DD8-\\u2DDE\\u2E2F\\u3005-\\u3007\\u3021-\\u3029\\u3031-\\u3035\\u3038-\\u303C\\u3041-\\u3096\\u309D-\\u309F\\u30A1-\\u30FA\\u30FC-\\u30FF\\u3105-\\u312D\\u3131-\\u318E\\u31A0-\\u31BA\\u31F0-\\u31FF\\u3400-\\u4DB5\\u4E00-\\u9FCC\\uA000-\\uA48C\\uA4D0-\\uA4FD\\uA500-\\uA60C\\uA610-\\uA61F\\uA62A\\uA62B\\uA640-\\uA66E\\uA67F-\\uA69D\\uA6A0-\\uA6EF\\uA717-\\uA71F\\uA722-\\uA788\\uA78B-\\uA78E\\uA790-\\uA7AD\\uA7B0\\uA7B1\\uA7F7-\\uA801\\uA803-\\uA805\\uA807-\\uA80A\\uA80C-\\uA822\\uA840-\\uA873\\uA882-\\uA8B3\\uA8F2-\\uA8F7\\uA8FB\\uA90A-\\uA925\\uA930-\\uA946\\uA960-\\uA97C\\uA984-\\uA9B2\\uA9CF\\uA9E0-\\uA9E4\\uA9E6-\\uA9EF\\uA9FA-\\uA9FE\\uAA00-\\uAA28\\uAA40-\\uAA42\\uAA44-\\uAA4B\\uAA60-\\uAA76\\uAA7A\\uAA7E-\\uAAAF\\uAAB1\\uAAB5\\uAAB6\\uAAB9-\\uAABD\\uAAC0\\uAAC2\\uAADB-\\uAADD\\uAAE0-\\uAAEA\\uAAF2-\\uAAF4\\uAB01-\\uAB06\\uAB09-\\uAB0E\\uAB11-\\uAB16\\uAB20-\\uAB26\\uAB28-\\uAB2E\\uAB30-\\uAB5A\\uAB5C-\\uAB5F\\uAB64\\uAB65\\uABC0-\\uABE2\\uAC00-\\uD7A3\\uD7B0-\\uD7C6\\uD7CB-\\uD7FB\\uF900-\\uFA6D\\uFA70-\\uFAD9\\uFB00-\\uFB06\\uFB13-\\uFB17\\uFB1D\\uFB1F-\\uFB28\\uFB2A-\\uFB36\\uFB38-\\uFB3C\\uFB3E\\uFB40\\uFB41\\uFB43\\uFB44\\uFB46-\\uFBB1\\uFBD3-\\uFD3D\\uFD50-\\uFD8F\\uFD92-\\uFDC7\\uFDF0-\\uFDFB\\uFE70-\\uFE74\\uFE76-\\uFEFC\\uFF21-\\uFF3A\\uFF41-\\uFF5A\\uFF66-\\uFFBE\\uFFC2-\\uFFC7\\uFFCA-\\uFFCF\\uFFD2-\\uFFD7\\uFFDA-\\uFFDC]"),digit:new RegExp("[\\u0030-\\u0039\\u0660-\\u0669\\u06F0-\\u06F9\\u07C0-\\u07C9\\u0966-\\u096F\\u09E6-\\u09EF\\u0A66-\\u0A6F\\u0AE6-\\u0AEF\\u0B66-\\u0B6F\\u0BE6-\\u0BEF\\u0C66-\\u0C6F\\u0CE6-\\u0CEF\\u0D66-\\u0D6F\\u0DE6-\\u0DEF\\u0E50-\\u0E59\\u0ED0-\\u0ED9\\u0F20-\\u0F29\\u1040-\\u1049\\u1090-\\u1099\\u17E0-\\u17E9\\u1810-\\u1819\\u1946-\\u194F\\u19D0-\\u19D9\\u1A80-\\u1A89\\u1A90-\\u1A99\\u1B50-\\u1B59\\u1BB0-\\u1BB9\\u1C40-\\u1C49\\u1C50-\\u1C59\\uA620-\\uA629\\uA8D0-\\uA8D9\\uA900-\\uA909\\uA9D0-\\uA9D9\\uA9F0-\\uA9F9\\uAA50-\\uAA59\\uABF0-\\uABF9\\uFF10-\\uFF19]"),non_spacing_mark:new RegExp("[\\u0300-\\u036F\\u0483-\\u0487\\u0591-\\u05BD\\u05BF\\u05C1\\u05C2\\u05C4\\u05C5\\u05C7\\u0610-\\u061A\\u064B-\\u065E\\u0670\\u06D6-\\u06DC\\u06DF-\\u06E4\\u06E7\\u06E8\\u06EA-\\u06ED\\u0711\\u0730-\\u074A\\u07A6-\\u07B0\\u07EB-\\u07F3\\u0816-\\u0819\\u081B-\\u0823\\u0825-\\u0827\\u0829-\\u082D\\u0900-\\u0902\\u093C\\u0941-\\u0948\\u094D\\u0951-\\u0955\\u0962\\u0963\\u0981\\u09BC\\u09C1-\\u09C4\\u09CD\\u09E2\\u09E3\\u0A01\\u0A02\\u0A3C\\u0A41\\u0A42\\u0A47\\u0A48\\u0A4B-\\u0A4D\\u0A51\\u0A70\\u0A71\\u0A75\\u0A81\\u0A82\\u0ABC\\u0AC1-\\u0AC5\\u0AC7\\u0AC8\\u0ACD\\u0AE2\\u0AE3\\u0B01\\u0B3C\\u0B3F\\u0B41-\\u0B44\\u0B4D\\u0B56\\u0B62\\u0B63\\u0B82\\u0BC0\\u0BCD\\u0C3E-\\u0C40\\u0C46-\\u0C48\\u0C4A-\\u0C4D\\u0C55\\u0C56\\u0C62\\u0C63\\u0CBC\\u0CBF\\u0CC6\\u0CCC\\u0CCD\\u0CE2\\u0CE3\\u0D41-\\u0D44\\u0D4D\\u0D62\\u0D63\\u0DCA\\u0DD2-\\u0DD4\\u0DD6\\u0E31\\u0E34-\\u0E3A\\u0E47-\\u0E4E\\u0EB1\\u0EB4-\\u0EB9\\u0EBB\\u0EBC\\u0EC8-\\u0ECD\\u0F18\\u0F19\\u0F35\\u0F37\\u0F39\\u0F71-\\u0F7E\\u0F80-\\u0F84\\u0F86\\u0F87\\u0F90-\\u0F97\\u0F99-\\u0FBC\\u0FC6\\u102D-\\u1030\\u1032-\\u1037\\u1039\\u103A\\u103D\\u103E\\u1058\\u1059\\u105E-\\u1060\\u1071-\\u1074\\u1082\\u1085\\u1086\\u108D\\u109D\\u135F\\u1712-\\u1714\\u1732-\\u1734\\u1752\\u1753\\u1772\\u1773\\u17B7-\\u17BD\\u17C6\\u17C9-\\u17D3\\u17DD\\u180B-\\u180D\\u18A9\\u1920-\\u1922\\u1927\\u1928\\u1932\\u1939-\\u193B\\u1A17\\u1A18\\u1A56\\u1A58-\\u1A5E\\u1A60\\u1A62\\u1A65-\\u1A6C\\u1A73-\\u1A7C\\u1A7F\\u1B00-\\u1B03\\u1B34\\u1B36-\\u1B3A\\u1B3C\\u1B42\\u1B6B-\\u1B73\\u1B80\\u1B81\\u1BA2-\\u1BA5\\u1BA8\\u1BA9\\u1C2C-\\u1C33\\u1C36\\u1C37\\u1CD0-\\u1CD2\\u1CD4-\\u1CE0\\u1CE2-\\u1CE8\\u1CED\\u1DC0-\\u1DE6\\u1DFD-\\u1DFF\\u20D0-\\u20DC\\u20E1\\u20E5-\\u20F0\\u2CEF-\\u2CF1\\u2DE0-\\u2DFF\\u302A-\\u302F\\u3099\\u309A\\uA66F\\uA67C\\uA67D\\uA6F0\\uA6F1\\uA802\\uA806\\uA80B\\uA825\\uA826\\uA8C4\\uA8E0-\\uA8F1\\uA926-\\uA92D\\uA947-\\uA951\\uA980-\\uA982\\uA9B3\\uA9B6-\\uA9B9\\uA9BC\\uAA29-\\uAA2E\\uAA31\\uAA32\\uAA35\\uAA36\\uAA43\\uAA4C\\uAAB0\\uAAB2-\\uAAB4\\uAAB7\\uAAB8\\uAABE\\uAABF\\uAAC1\\uABE5\\uABE8\\uABED\\uFB1E\\uFE00-\\uFE0F\\uFE20-\\uFE26]"),space_combining_mark:new RegExp("[\\u0903\\u093E-\\u0940\\u0949-\\u094C\\u094E\\u0982\\u0983\\u09BE-\\u09C0\\u09C7\\u09C8\\u09CB\\u09CC\\u09D7\\u0A03\\u0A3E-\\u0A40\\u0A83\\u0ABE-\\u0AC0\\u0AC9\\u0ACB\\u0ACC\\u0B02\\u0B03\\u0B3E\\u0B40\\u0B47\\u0B48\\u0B4B\\u0B4C\\u0B57\\u0BBE\\u0BBF\\u0BC1\\u0BC2\\u0BC6-\\u0BC8\\u0BCA-\\u0BCC\\u0BD7\\u0C01-\\u0C03\\u0C41-\\u0C44\\u0C82\\u0C83\\u0CBE\\u0CC0-\\u0CC4\\u0CC7\\u0CC8\\u0CCA\\u0CCB\\u0CD5\\u0CD6\\u0D02\\u0D03\\u0D3E-\\u0D40\\u0D46-\\u0D48\\u0D4A-\\u0D4C\\u0D57\\u0D82\\u0D83\\u0DCF-\\u0DD1\\u0DD8-\\u0DDF\\u0DF2\\u0DF3\\u0F3E\\u0F3F\\u0F7F\\u102B\\u102C\\u1031\\u1038\\u103B\\u103C\\u1056\\u1057\\u1062-\\u1064\\u1067-\\u106D\\u1083\\u1084\\u1087-\\u108C\\u108F\\u109A-\\u109C\\u17B6\\u17BE-\\u17C5\\u17C7\\u17C8\\u1923-\\u1926\\u1929-\\u192B\\u1930\\u1931\\u1933-\\u1938\\u19B0-\\u19C0\\u19C8\\u19C9\\u1A19-\\u1A1B\\u1A55\\u1A57\\u1A61\\u1A63\\u1A64\\u1A6D-\\u1A72\\u1B04\\u1B35\\u1B3B\\u1B3D-\\u1B41\\u1B43\\u1B44\\u1B82\\u1BA1\\u1BA6\\u1BA7\\u1BAA\\u1C24-\\u1C2B\\u1C34\\u1C35\\u1CE1\\u1CF2\\uA823\\uA824\\uA827\\uA880\\uA881\\uA8B4-\\uA8C3\\uA952\\uA953\\uA983\\uA9B4\\uA9B5\\uA9BA\\uA9BB\\uA9BD-\\uA9C0\\uAA2F\\uAA30\\uAA33\\uAA34\\uAA4D\\uAA7B\\uABE3\\uABE4\\uABE6\\uABE7\\uABE9\\uABEA\\uABEC]"),connector_punctuation:new RegExp("[\\u005F\\u203F\\u2040\\u2054\\uFE33\\uFE34\\uFE4D-\\uFE4F\\uFF3F]")};function gt(e){return 97<=e&&e<=122||65<=e&&e<=90||170<=e&&mt.letter.test(String.fromCharCode(e))}function Tt(e){return"string"==typeof e&&(e=e.charCodeAt(0)),55296<=e&&e<=56319}function yt(e){return"string"==typeof e&&(e=e.charCodeAt(0)),56320<=e&&e<=57343}function vt(e){return 48<=e&&e<=57}function Et(e){return!at[e]&&/^[a-z_$][a-z0-9_$]*$/i.test(e)}function Ct(e){return 36==e||95==e||gt(e)}function bt(e){var t,r,n,i=e.charCodeAt(0);return Ct(i)||vt(i)||8204==i||8205==i||(n=e,mt.non_spacing_mark.test(n)||mt.space_combining_mark.test(n))||(r=e,mt.connector_punctuation.test(r))||(t=i,mt.digit.test(String.fromCharCode(t)))}function St(e){return/^[a-z_$][a-z0-9_$]*$/i.test(e)}function It(e,t,r,n,i){this.message=e,this.filename=t,this.line=r,this.col=n,this.pos=i}function xt(e,t,r,n,i){throw new It(e,t,r,n,i)}function Pt(e,t,r){return e.type==t&&(null==r||e.value==r)}((It.prototype=Object.create(Error.prototype)).constructor=It).prototype.name="SyntaxError",a(It);var wt={};function Dt(e,t,r,n){var i={text:e,filename:t,pos:0,tokpos:0,line:1,tokline:0,col:0,tokcol:0,newline_before:!1,regex_allowed:!1,comments_before:[],directives:{},directive_stack:[]};function a(){return i.text.charAt(i.pos)}function s(e,t){var r=i.text.charAt(i.pos++);if(e&&!r)throw wt;return ft[r]?(i.newline_before=i.newline_before||!t,++i.line,i.col=0,t||"\r"!=r||"\n"!=a()||(++i.pos,r="\n")):++i.col,r}function o(e){for(;0<e--;)s()}function l(e){return i.text.substr(i.pos,e.length)==e}function c(){i.tokline=i.line,i.tokcol=i.col,i.tokpos=i.pos}var u=!1;function h(r,n,a){i.regex_allowed="operator"==r&&!At[n]||"keyword"==r&&st[n]||"punc"==r&&dt[n],"punc"==r&&"."==n?u=!0:a||(u=!1);var s={type:r,value:n,line:i.tokline,col:i.tokcol,pos:i.tokpos,endline:i.line,endcol:i.col,endpos:i.pos,nlb:i.newline_before,file:t};return/^(?:num|string|regexp)$/i.test(r)&&(s.raw=e.substring(s.pos,s.endpos)),a||(s.comments_before=i.comments_before,s.comments_after=i.comments_before=[]),i.newline_before=!1,new I(s)}function f(){for(;ht[a()];)s()}function d(e){xt(e,t,i.tokline,i.tokcol,i.tokpos)}function p(e){var t=!1,r=!1,n=!1,i="."==e,o=function(e){for(var t,r="",n=0;(t=a())&&e(t,n++);)r+=s();return r}((function(a,s){var o,l=a.charCodeAt(0);switch(l){case 120:case 88:return!n&&(n=!0);case 101:case 69:return!!n||!t&&(t=r=!0);case 45:return r||0==s&&!e;case 43:return r;case r=!1,46:return!(i||n||t)&&(i=!0)}return vt(o=l)||gt(o)}));e&&(o=e+o),ct.test(o)&&P.has_directive("use strict")&&d("Legacy octal literals are not allowed in strict mode");var l=function(e){if(lt.test(e))return parseInt(e.substr(2),16);if(ct.test(e))return parseInt(e.substr(1),8);var t=parseFloat(e);return t==e?t:void 0}(o);if(!isNaN(l))return h("num",l);d("Invalid syntax: "+o)}function m(e){var t=s(!0,e);switch(t.charCodeAt(0)){case 110:return"\n";case 114:return"\r";case 116:return"\t";case 98:return"\b";case 118:return"\v";case 102:return"\f";case 120:return String.fromCharCode(g(2));case 117:return String.fromCharCode(g(4));case 10:return"";case 13:if("\n"==a())return s(!0,e),""}return"0"<=t&&t<="7"?function(e){var t=a();return"0"<=t&&t<="7"&&(e+=s(!0))[0]<="3"&&"0"<=(t=a())&&t<="7"&&(e+=s(!0)),"0"===e?"\0":(0<e.length&&P.has_directive("use strict")&&d("Legacy octal escape sequences are not allowed in strict mode"),String.fromCharCode(parseInt(e,8)))}(t):t}function g(e){for(var t=0;0<e;--e){var r=parseInt(s(!0),16);isNaN(r)&&d("Invalid hex-character pattern in string"),t=t<<4|r}return t}var T=x("Unterminated string constant",(function(e){for(var t=s(),r="";;){var n=s(!0,!0);if("\\"==n)n=m(!0);else if(ft[n])d("Unterminated string constant");else if(n==t)break;r+=n}var i=h("string",r);return i.quote=e,i}));function y(e){var t,r=i.regex_allowed,n=function(){for(var e=i.text,t=i.pos,r=i.text.length;t<r;++t){var n=e[t];if(ft[n])return t}return-1}();return i.pos=-1==n?(t=i.text.substr(i.pos),i.text.length):(t=i.text.substring(i.pos,n),n),i.col=i.tokcol+(i.pos-i.tokpos),i.comments_before.push(h(e,t,!0)),i.regex_allowed=r,P}var v=x("Unterminated multiline comment",(function(){var e=i.regex_allowed,t=function(e,t){var r=i.text.indexOf("*/",i.pos);if(-1==r)throw wt;return r}(),r=i.text.substring(i.pos,t).replace(/\r\n|\r|\u2028|\u2029/g,"\n");return o(r.length+2),i.comments_before.push(h("comment2",r,!0)),i.regex_allowed=e,P}));function E(){for(var e,t,r=!1,n="",i=!1;null!=(e=a());)if(r)"u"!=e&&d("Expecting UnicodeEscapeSequence -- uXXXX"),bt(e=m())||d("Unicode char: "+e.charCodeAt(0)+" is not valid in identifier"),n+=e,r=!1;else if("\\"==e)i=r=!0,s();else{if(!bt(e))break;n+=s()}return nt[n]&&i&&(t=n.charCodeAt(0).toString(16).toUpperCase(),n="\\u"+"0000".substr(t.length)+t+n.slice(1)),n}var C=x("Unterminated regular expression",(function(e){for(var t,r=!1,n=!1;t=s(!0);)if(ft[t])d("Unexpected line terminator");else if(r)e+="\\"+t,r=!1;else if("["==t)n=!0,e+=t;else if("]"==t&&n)n=!1,e+=t;else{if("/"==t&&!n)break;"\\"==t?r=!0:e+=t}var i=E();try{var a=new RegExp(e,i);return a.raw_source=e,h("regexp",a)}catch(e){d(e.message)}}));function b(e){return h("operator",function e(t){if(!a())return t;var r=t+a();return ut[r]?(s(),e(r)):t}(e||s()))}function S(){switch(s(),a()){case"/":return s(),y("comment1");case"*":return s(),v()}return i.regex_allowed?C(""):b("/")}function x(e,t){return function(r){try{return t(r)}catch(r){if(r!==wt)throw r;d(e)}}}function P(e){if(null!=e)return C(e);for(n&&0==i.pos&&l("#!")&&(c(),o(2),y("comment5"));;){if(f(),c(),r){if(l("\x3c!--")){o(4),y("comment3");continue}if(l("--\x3e")&&i.newline_before){o(3),y("comment4");continue}}var t=a();if(!t)return h("eof");var m=t.charCodeAt(0);switch(m){case 34:case 39:return T(t);case 46:return s(),vt(a().charCodeAt(0))?p("."):h("punc",".");case 47:var g=S();if(g===P)continue;return g}if(vt(m))return p();if(pt[t])return h("punc",s());if(ot[t])return b();if(92==m||Ct(m))return v=E(),u?h("name",v):it[v]?h("atom",v):nt[v]?ut[v]?h("operator",v):h("keyword",v):h("name",v);break}var v;d("Unexpected character '"+t+"'")}return P.context=function(e){return e&&(i=e),i},P.add_directive=function(e){i.directive_stack[i.directive_stack.length-1].push(e),void 0===i.directives[e]?i.directives[e]=1:i.directives[e]++},P.push_directives_stack=function(){i.directive_stack.push([])},P.pop_directives_stack=function(){for(var e=i.directive_stack[i.directive_stack.length-1],t=0;t<e.length;t++)i.directives[e[t]]--;i.directive_stack.pop()},P.has_directive=function(e){return 0<i.directives[e]},P}var _t=y(["typeof","void","delete","--","++","!","~","-","+"]),At=y(["--","++"]),Rt=y(["=","+=","-=","/=","*=","%=",">>=","<<=",">>>=","|=","^=","&="]),Mt=function(e,t){for(var r=0;r<e.length;++r)for(var n=e[r],i=0;i<n.length;++i)t[n[i]]=r+1;return t}([["||"],["&&"],["|"],["^"],["&"],["==","===","!=","!=="],["<",">","<=",">=","in","instanceof"],[">>","<<",">>>"],["+","-"],["*","/","%"]],{}),Nt=y(["atom","num","string","regexp","name"]);function kt(e,t){t=o(t,{bare_returns:!1,expression:!1,filename:null,html5_comments:!0,shebang:!0,strict:!1,toplevel:null},!0);var r={input:"string"==typeof e?Dt(e,t.filename,t.html5_comments,t.shebang):e,token:null,prev:null,peeked:null,in_function:0,in_directives:!0,in_loop:0,labels:[]};function n(e,t){return Pt(r.token,e,t)}function a(){return r.peeked||(r.peeked=r.input())}function s(){return r.prev=r.token,r.peeked?(r.token=r.peeked,r.peeked=null):r.token=r.input(),r.in_directives=r.in_directives&&("string"==r.token.type||n("punc",";")),r.token}function l(){return r.prev}function c(e,t,n,i){var a=r.input.context();xt(e,a.filename,null!=t?t:a.tokline,null!=n?n:a.tokcol,null!=i?i:a.tokpos)}function u(e,t){c(t,e.line,e.col)}function h(e){null==e&&(e=r.token),u(e,"Unexpected token: "+e.type+" ("+e.value+")")}function f(e,t){if(n(e,t))return s();u(r.token,"Unexpected token "+r.token.type+" «"+r.token.value+"», expected "+e+" «"+t+"»")}function d(e){return f("punc",e)}function p(e){return e.nlb||!v(e.comments_before,(function(e){return!e.nlb}))}function m(){return!t.strict&&(n("eof")||n("punc","}")||p(r.token))}function g(e){n("punc",";")?s():e||m()||h()}function T(){d("(");var e=Xe(!0);return d(")"),e}function y(e){return function(){var t=r.token,n=e.apply(null,arguments),i=l();return n.start=t,n.end=i,n}}function E(){(n("operator","/")||n("operator","/="))&&(r.peeked=null,r.token=r.input(r.token.value.substr(1)))}r.token=s();var b=y((function(e){switch(E(),r.token.type){case"string":if(r.in_directives){var i=a();-1==r.token.raw.indexOf("\\")&&(Pt(i,"punc",";")||Pt(i,"punc","}")||p(i)||Pt(i,"eof"))?r.input.add_directive(r.token.value):r.in_directives=!1}var o=r.in_directives,u=S();return o?new D(u.body):u;case"num":case"regexp":case"operator":case"atom":return S();case"name":return Pt(a(),"punc",":")?function(){var e=ie(Ve);v(r.labels,(function(t){return t.name!=e.name}))||c("Label "+e.name+" defined twice"),d(":"),r.labels.push(e);var t=b();return r.labels.pop(),t instanceof L||e.references.forEach((function(t){t instanceof te&&(t=t.label.start,c("Continue label `"+e.name+"` refers to non-IterationStatement.",t.line,t.col,t.pos))})),new O({body:t,label:e})}():S();case"punc":switch(r.token.value){case"{":return new M({start:r.token,body:P(),end:l()});case"[":case"(":return S();case";":return r.in_directives=!1,s(),new N;default:h()}case"keyword":switch(r.token.value){case"break":return s(),I(ee);case"continue":return s(),I(te);case"debugger":return s(),g(),new w;case"do":s();var y=Ze(b);f("keyword","while");var C=T();return g(!0),new B({body:y,condition:C});case"while":return s(),new V({condition:T(),body:Ze(b)});case"for":return s(),function(){d("(");var e,t,r=null;return!n("punc",";")&&(r=n("keyword","var")?(s(),R(!0)):Xe(!0,!0),n("operator","in"))?(r instanceof he?1<r.definitions.length&&c("Only one variable declaration allowed in for..in loop",r.start.line,r.start.col,r.start.pos):Ye(r)||c("Invalid left-hand side in for..in loop",r.start.line,r.start.col,r.start.pos),s(),e=r,t=Xe(!0),d(")"),new H({init:e,object:t,body:Ze(b)})):function(e){d(";");var t=n("punc",";")?null:Xe(!0);d(";");var r=n("punc",")")?null:Xe(!0);return d(")"),new U({init:e,condition:t,step:r,body:Ze(b)})}(r)}();case"function":return!e&&r.input.has_directive("use strict")&&c("In strict mode code, functions can only be declared at top level or immediately within another function."),s(),x(K);case"if":return s(),function(){var e=T(),t=b(),r=null;return n("keyword","else")&&(s(),r=b()),new re({condition:e,body:t,alternative:r})}();case"return":0!=r.in_function||t.bare_returns||c("'return' outside of function"),s();var _=null;return n("punc",";")?s():m()||(_=Xe(!0),g()),new $({value:_});case"switch":return s(),new ne({expression:T(),body:Ze(A)});case"throw":return s(),p(r.token)&&c("Illegal newline after 'throw'"),_=Xe(!0),g(),new Z({value:_});case"try":return s(),function(){var e=P(),t=null,i=null;if(n("keyword","catch")){var a=r.token;s(),d("(");var o=ie(Be);d(")"),t=new le({start:a,argname:o,body:P(),end:l()})}if(n("keyword","finally")){a=r.token;s(),i=new ce({start:a,body:P(),end:l()})}return t||i||c("Missing catch/finally blocks"),new oe({body:e,bcatch:t,bfinally:i})}();case"var":s();var k=R();return g(),k;case"with":return r.input.has_directive("use strict")&&c("Strict mode may not include a with statement"),s(),new z({expression:T(),body:b()})}}h()}));function S(e){return new _({body:(e=Xe(!0),g(),e)})}function I(e){var t,n=null;m()||(n=ie(He,!0)),null!=n?((t=i((function(e){return e.name==n.name}),r.labels))||c("Undefined label "+n.name),n.thedef=t):0==r.in_loop&&c(e.TYPE+" not inside a loop or switch"),g();var a=new e({label:n});return t&&t.references.push(a),a}var x=function(e){var t=e===K,i=n("name")?ie(t?Le:Fe):null;t&&!i&&h(),!i||e===W||i instanceof Ne||h(l()),d("(");for(var a=[],o=!0;!n("punc",")");)o?o=!1:d(","),a.push(ie(Oe));s();var c=r.in_loop,u=r.labels;++r.in_function,r.in_directives=!0,r.input.push_directives_stack(),r.in_loop=0,r.labels=[];var f=P(!0);return r.input.has_directive("use strict")&&(i&&J(i),a.forEach(J)),r.input.pop_directives_stack(),--r.in_function,r.in_loop=c,r.labels=u,new e({name:i,argnames:a,body:f})};function P(e){d("{");for(var t=[];!n("punc","}");)n("eof")&&h(),t.push(b(e));return s(),t}function A(){d("{");for(var e,t=[],i=null,a=null;!n("punc","}");)n("eof")&&h(),n("keyword","case")?(a&&(a.end=l()),i=[],a=new se({start:(e=r.token,s(),e),expression:Xe(!0),body:i}),t.push(a),d(":")):n("keyword","default")?(a&&(a.end=l()),i=[],a=new ae({start:(e=r.token,s(),d(":"),e),body:i}),t.push(a)):(i||h(),i.push(b()));return a&&(a.end=l()),s(),t}var R=function(e){return new he({start:l(),definitions:function(e){for(var t=[];t.push(new fe({start:r.token,name:ie(ke),value:n("operator","=")?(s(),Xe(!1,e)):null,end:l()})),n("punc",",");)s();return t}(e),end:l()})};function k(e,t,i){for(var a=!0,o=[];!n("punc",e)&&(a?a=!1:d(","),!t||!n("punc",e));)n("punc",",")&&i?o.push(new $e({start:r.token,end:r.token})):o.push(Xe(!1));return s(),o}var F=y((function(){return d("["),new xe({elements:k("]",!t.strict,!0)})})),j=y((function(){return x(W)})),G=y((function(){d("{");for(var e=!0,i=[];!n("punc","}")&&(e?e=!1:d(","),t.strict||!n("punc","}"));){var a=r.token,o=a.type,c=Q();if("name"==o&&!n("punc",":")){var u=new Me({start:r.token,name:""+Q(),end:l()});if("get"==c){i.push(new Ae({start:a,key:u,value:j(),end:l()}));continue}if("set"==c){i.push(new _e({start:a,key:u,value:j(),end:l()}));continue}}d(":"),i.push(new De({start:a,quote:a.quote,key:""+c,value:Xe(!1),end:l()}))}return s(),new Pe({properties:i})}));function Q(){var e=r.token;switch(e.type){case"operator":nt[e.value]||h();case"num":case"string":case"name":case"keyword":case"atom":return s(),e.value;default:h()}}function X(e){var t=r.token.value;return new("this"==t?ze:e)({name:String(t),start:r.token,end:r.token})}function J(e){"arguments"!=e.name&&"eval"!=e.name||c("Unexpected "+e.name+" in strict mode",e.start.line,e.start.col,e.start.pos)}function ie(e,t){if(!n("name"))return t||c("Name expected"),null;var i=X(e);return r.input.has_directive("use strict")&&i instanceof Ne&&J(i),s(),i}function ue(e){for(var t=e.start,r=t.comments_before,n=C(t,"comments_before_length")?t.comments_before_length:r.length;0<=--n;){var i=r[n];if(/[@#]__PURE__/.test(i.value)){e.pure=i;break}}}var ve=function e(t,i){var a,o=t.start;if(n("punc","."))return s(),e(new Te({start:o,expression:t,property:(a=r.token,"name"!=a.type&&h(),s(),a.value),end:l()}),i);if(n("punc","[")){s();var c=Xe(!0);return d("]"),e(new ye({start:o,expression:t,property:c,end:l()}),i)}if(i&&n("punc","(")){s();var u=new de({start:o,expression:t,args:k(")"),end:l()});return ue(u),e(u,!0)}return t},we=function e(t){var i=r.token;if(n("operator")&&_t[i.value]){s(),E();var a=Re(Ee,i,e(t));return a.start=i,a.end=l(),a}for(var o=function e(t){if(n("operator","new"))return function(t){var i=r.token;f("operator","new");var a,o=e(!1);a=n("punc","(")?(s(),k(")")):[];var c=new pe({start:i,expression:o,args:a,end:l()});return ue(c),ve(c,t)}(t);var i=r.token;if(n("punc")){switch(i.value){case"(":s();var a=Xe(!0),o=i.comments_before.length;if([].unshift.apply(a.start.comments_before,i.comments_before),i.comments_before=a.start.comments_before,0==(i.comments_before_length=o)&&0<i.comments_before.length){var c=i.comments_before[0];c.nlb||(c.nlb=i.nlb,i.nlb=!1)}i.comments_after=a.start.comments_after,a.start=i,d(")");var u=l();return u.comments_before=a.end.comments_before,[].push.apply(a.end.comments_after,u.comments_after),u.comments_after=a.end.comments_after,a.end=u,a instanceof de&&ue(a),ve(a,t);case"[":return ve(F(),t);case"{":return ve(G(),t)}h()}if(n("keyword","function")){s();var p=x(Y);return p.start=i,p.end=l(),ve(p,t)}if(Nt[r.token.type])return ve(function(){var e,t=r.token;switch(t.type){case"name":e=X(Ue);break;case"num":e=new Ge({start:t,end:t,value:t.value});break;case"string":e=new qe({start:t,end:t,value:t.value,quote:t.quote});break;case"regexp":e=new We({start:t,end:t,value:t.value});break;case"atom":switch(t.value){case"false":e=new et({start:t,end:t});break;case"true":e=new tt({start:t,end:t});break;case"null":e=new Ke({start:t,end:t})}}return s(),e}(),t);h()}(t);n("operator")&&At[r.token.value]&&!p(r.token);)(o=Re(Ce,r.token,o)).start=i,o.end=r.token,s();return o};function Re(e,t,n){var i=t.value;switch(i){case"++":case"--":Ye(n)||c("Invalid use of "+i+" operator",t.line,t.col,t.pos);break;case"delete":n instanceof Ue&&r.input.has_directive("use strict")&&c("Calling delete on expression not allowed in strict mode",n.start.line,n.start.col,n.start.pos)}return new e({operator:i,expression:n})}var je=function(e){var t,i=r.token,a=(t=e,function e(t,i,a){var o=n("operator")?r.token.value:null;"in"==o&&a&&(o=null);var l=null!=o?Mt[o]:null;if(null!=l&&i<l){s();var c=e(we(!0),l,a);return e(new be({start:t.start,left:t,operator:o,right:c,end:c.end}),i,a)}return t}(we(!0),0,t));if(n("operator","?")){s();var o=Xe(!1);return d(":"),new Se({start:i,condition:a,consequent:o,alternative:Xe(!1,e),end:l()})}return a};function Ye(e){return e instanceof ge||e instanceof Ue}var Qe=function e(t){var i=r.token,a=je(t),o=r.token.value;if(n("operator")&&Rt[o]){if(Ye(a))return s(),new Ie({start:i,left:a,operator:o,right:e(t),end:l()});c("Invalid assignment")}return a},Xe=function(e,t){for(var i=r.token,o=[];o.push(Qe(t)),e&&n("punc",",");)s(),e=!0;return 1==o.length?o[0]:new me({start:i,expressions:o,end:a()})};function Ze(e){++r.in_loop;var t=e();return--r.in_loop,t}return t.expression?Xe(!0):function(){var e=r.token,i=[];for(r.input.push_directives_stack();!n("eof");)i.push(b(!0));r.input.pop_directives_stack();var a=l(),s=t.toplevel;return s?(s.body=s.body.concat(i),s.end=a):s=new q({start:e,body:i,end:a}),s}()}function Ot(e,t){rt.call(this),this.before=e,this.after=t}function Lt(e,t,r){this.name=t.name,this.orig=[t],this.init=r,this.eliminated=0,this.scope=e,this.references=[],this.replaced=0,this.global=!1,this.mangled_name=null,this.undeclared=!1,this.id=Lt.next_id++}function Ft(e,t){var r=e.names_in_use;return r||(e.names_in_use=r=Object.create(e.mangled_names||null),e.cname_holes=[],e.enclosed.forEach((function(e){e.unmangleable(t)&&(r[e.name]=!0)}))),r}function Bt(e){return e=o(e,{eval:!1,ie8:!1,keep_fnames:!1,reserved:[],toplevel:!1}),Array.isArray(e.reserved)||(e.reserved=[]),m(e.reserved,"arguments"),e.reserved.has=y(e.reserved),e}Ot.prototype=new rt,function(e){function t(e,t){return p(e,(function(e){return e.transform(t,!0)}))}e(x,c),e(O,(function(e,t){e.label=e.label.transform(t),e.body=e.body.transform(t)})),e(_,(function(e,t){e.body=e.body.transform(t)})),e(R,(function(e,r){e.body=t(e.body,r)})),e(B,(function(e,t){e.body=e.body.transform(t),e.condition=e.condition.transform(t)})),e(V,(function(e,t){e.condition=e.condition.transform(t),e.body=e.body.transform(t)})),e(U,(function(e,t){e.init&&(e.init=e.init.transform(t)),e.condition&&(e.condition=e.condition.transform(t)),e.step&&(e.step=e.step.transform(t)),e.body=e.body.transform(t)})),e(H,(function(e,t){e.init=e.init.transform(t),e.object=e.object.transform(t),e.body=e.body.transform(t)})),e(z,(function(e,t){e.expression=e.expression.transform(t),e.body=e.body.transform(t)})),e(X,(function(e,t){e.value&&(e.value=e.value.transform(t))})),e(J,(function(e,t){e.label&&(e.label=e.label.transform(t))})),e(re,(function(e,t){e.condition=e.condition.transform(t),e.body=e.body.transform(t),e.alternative&&(e.alternative=e.alternative.transform(t))})),e(ne,(function(e,r){e.expression=e.expression.transform(r),e.body=t(e.body,r)})),e(se,(function(e,r){e.expression=e.expression.transform(r),e.body=t(e.body,r)})),e(oe,(function(e,r){e.body=t(e.body,r),e.bcatch&&(e.bcatch=e.bcatch.transform(r)),e.bfinally&&(e.bfinally=e.bfinally.transform(r))})),e(le,(function(e,r){e.argname=e.argname.transform(r),e.body=t(e.body,r)})),e(ue,(function(e,r){e.definitions=t(e.definitions,r)})),e(fe,(function(e,t){e.name=e.name.transform(t),e.value&&(e.value=e.value.transform(t))})),e(G,(function(e,r){e.name&&(e.name=e.name.transform(r)),e.argnames=t(e.argnames,r),e.body=t(e.body,r)})),e(de,(function(e,r){e.expression=e.expression.transform(r),e.args=t(e.args,r)})),e(me,(function(e,r){e.expressions=t(e.expressions,r)})),e(Te,(function(e,t){e.expression=e.expression.transform(t)})),e(ye,(function(e,t){e.expression=e.expression.transform(t),e.property=e.property.transform(t)})),e(ve,(function(e,t){e.expression=e.expression.transform(t)})),e(be,(function(e,t){e.left=e.left.transform(t),e.right=e.right.transform(t)})),e(Se,(function(e,t){e.condition=e.condition.transform(t),e.consequent=e.consequent.transform(t),e.alternative=e.alternative.transform(t)})),e(xe,(function(e,r){e.elements=t(e.elements,r)})),e(Pe,(function(e,r){e.properties=t(e.properties,r)})),e(we,(function(e,t){e.value=e.value.transform(t)}))}((function(e,t){e.DEFMETHOD("transform",(function(e,r){var n,i;return e.push(this),e.before&&(n=e.before(this,t,r)),void 0===n&&(t(n=this,e),e.after&&void 0!==(i=e.after(n,r))&&(n=i)),e.pop(),n}))})),Lt.next_id=1,Lt.prototype={unmangleable:function(e){return e||(e={}),this.global&&!e.toplevel||this.undeclared||!e.eval&&this.scope.pinned()||e.keep_fnames&&(this.orig[0]instanceof Fe||this.orig[0]instanceof Le)},mangle:function(e){var t=e.cache&&e.cache.props;if(this.global&&t&&t.has(this.name))this.mangled_name=t.get(this.name);else if(!this.mangled_name&&!this.unmangleable(e)){var r;(r=this.redefined())?this.mangled_name=r.mangled_name||r.name:this.mangled_name=function(e,t,r){var n,i=Ft(e,t),a=e.cname_holes,s=Object.create(null),o=[e];r.references.forEach((function(e){var r=e.scope;do{if(!(o.indexOf(r)<0))break;for(var n in Ft(r,t))s[n]=!0;o.push(r)}while(r=r.parent_scope)}));for(var l=0,c=a.length;l<c;l++)if(n=Vt(a[l]),!s[n])return a.splice(l,1),e.names_in_use[n]=!0,n;for(;;)if(!i[n=Vt(++e.cname)]&&Et(n)&&!t.reserved.has[n]){if(!s[n])break;a.push(e.cname)}return e.names_in_use[n]=!0,n}(this.scope,e,this),this.global&&t&&t.set(this.name,this.mangled_name)}},redefined:function(){return this.defun&&this.defun.variables.get(this.name)}},q.DEFMETHOD("figure_out_scope",(function(e){e=o(e,{cache:null,ie8:!1});var t=this,r=t.parent_scope=null,n=null,i=new rt((function(t,i){if(t instanceof le){var a=r;return(r=new j(t)).init_scope_vars(a),i(),r=a,!0}if(t instanceof j){t.init_scope_vars(r),a=r;var s=n;return n=r=t,i(),r=a,n=s,!0}if(t instanceof z)for(var o=r;o;o=o.parent_scope)o.uses_with=!0;else if(t instanceof Re&&(t.scope=r),t instanceof Ve&&((t.thedef=t).references=[]),t instanceof Le)(t.scope=n.parent_scope.resolve()).def_function(t,n);else if(t instanceof Fe){var l=n.def_function(t,"arguments"==t.name?void 0:n);e.ie8&&(l.defun=n.parent_scope.resolve())}else t instanceof ke?(n.def_variable(t,"SymbolVar"==t.TYPE?null:void 0),n!==r&&(t.mark_enclosed(e),l=r.find_variable(t),t.thedef!==l&&(t.thedef=l),t.reference(e))):t instanceof Be&&(r.def_variable(t).defun=n)}));function a(r,n){var i=r.name,a=r.thedef.references,s=n.find_variable(i)||t.globals.get(i)||n.def_variable(r);a.forEach((function(t){t.thedef=s,t.reference(e)})),r.thedef=s,r.reference(e)}t.walk(i),t.globals=new E,i=new rt((function(r){if(r instanceof J)return r.label&&r.label.thedef.references.push(r),!0;if(r instanceof Ue){var n=r.name;if("eval"==n&&i.parent()instanceof de)for(var a=r.scope;a&&!a.uses_eval;a=a.parent_scope)a.uses_eval=!0;var s=r.scope.find_variable(n);return s?s.scope instanceof G&&"arguments"==n&&(s.scope.uses_arguments=!0):s=t.def_global(r),r.thedef=s,r.reference(e),!0}if(r instanceof Be){var o=r.definition().redefined();if(o)for(a=r.scope;a&&(m(a.enclosed,o),a!==o.scope);a=a.parent_scope);return!0}})),t.walk(i),e.ie8&&t.walk(new rt((function(e){if(e instanceof Be)return a(e,e.thedef.defun),!0;if(e instanceof Fe){var t=e.thedef;return 1==t.orig.length&&(a(e,e.scope.parent_scope),e.thedef.init=t.init),!0}})))})),q.DEFMETHOD("def_global",(function(e){var t=this.globals,r=e.name;if(t.has(r))return t.get(r);var n=new Lt(this,e);return n.undeclared=!0,n.global=!0,t.set(r,n),n})),j.DEFMETHOD("init_scope_vars",(function(e){this.variables=new E,this.functions=new E,this.uses_with=!1,this.uses_eval=!1,this.parent_scope=e,this.enclosed=[],this.cname=-1})),G.DEFMETHOD("init_scope_vars",(function(){j.prototype.init_scope_vars.apply(this,arguments),this.uses_arguments=!1,this.def_variable(new Oe({name:"arguments",start:this.start,end:this.end}))})),Re.DEFMETHOD("mark_enclosed",(function(e){for(var t=this.definition(),r=this.scope;r&&(m(r.enclosed,t),e.keep_fnames&&r.functions.each((function(e){m(t.scope.enclosed,e)})),r!==t.scope);r=r.parent_scope);})),Re.DEFMETHOD("reference",(function(e){this.definition().references.push(this),this.mark_enclosed(e)})),j.DEFMETHOD("find_variable",(function(e){return e instanceof Re&&(e=e.name),this.variables.get(e)||this.parent_scope&&this.parent_scope.find_variable(e)})),j.DEFMETHOD("def_function",(function(e,t){var r=this.def_variable(e,t);return(!r.init||r.init instanceof K)&&(r.init=t),this.functions.set(e.name,r),r})),j.DEFMETHOD("def_variable",(function(e,t){var r=this.variables.get(e.name);return r?(r.orig.push(e),r.init&&(r.scope!==e.scope||r.init instanceof Y)&&(r.init=t)):(r=new Lt(this,e,t),this.variables.set(e.name,r),r.global=!this.parent_scope),e.thedef=r})),G.DEFMETHOD("resolve",f),j.DEFMETHOD("resolve",(function(){return this.parent_scope})),q.DEFMETHOD("resolve",f),Re.DEFMETHOD("unmangleable",(function(e){var t=this.definition();return!t||t.unmangleable(e)})),Ve.DEFMETHOD("unmangleable",u),Re.DEFMETHOD("unreferenced",(function(){return!this.definition().references.length&&!this.scope.pinned()})),Re.DEFMETHOD("definition",(function(){return this.thedef})),Re.DEFMETHOD("global",(function(){return this.definition().global})),q.DEFMETHOD("mangle_names",(function(e){e=Bt(e);var t=-1;if(e.cache&&e.cache.props){var r=this.mangled_names=Object.create(null);e.cache.props.each((function(e){r[e]=!0}))}var n=[],i=new rt((function(r,i){if(r instanceof O){var s=t;return i(),t=s,!0}if(r instanceof j)return i(),e.cache&&r instanceof q&&r.globals.each(a),r.variables.each(a),!0;if(r instanceof Ve){for(var o;!Et(o=Vt(++t)););return r.mangled_name=o,!0}if(!e.ie8&&r instanceof le){var l=r.argname.definition(),c=l.redefined();return c&&(n.push(l),u(r.argname),l.references.forEach(u)),i(),c||a(l),!0}function u(t){t.thedef=c,t.reference(e),t.thedef=l}}));function a(t){e.reserved.has[t.name]||t.mangle(e)}this.walk(i),n.forEach(a)})),q.DEFMETHOD("find_colliding_names",(function(e){var t=e.cache&&e.cache.props,r=Object.create(null);return e.reserved.forEach(n),this.globals.each(i),this.walk(new rt((function(e){e instanceof j&&e.variables.each(i),e instanceof Be&&i(e.definition())}))),r;function n(e){r[e]=!0}function i(r){var i=r.name;if(r.global&&t&&t.has(i))i=t.get(i);else if(!r.unmangleable(e))return;n(i)}})),q.DEFMETHOD("expand_names",(function(e){Vt.reset(),Vt.sort(),e=Bt(e);var t=this.find_colliding_names(e),r=0;function n(n){if(!(n.global&&e.cache||n.unmangleable(e)||e.reserved.has[n.name])){var i=n.redefined();n.name=i?i.name:function(){for(var e;e=Vt(r++),t[e]||!Et(e););return e}(),n.orig.forEach((function(e){e.name=n.name})),n.references.forEach((function(e){e.name=n.name}))}}this.globals.each(n),this.walk(new rt((function(e){e instanceof j&&e.variables.each(n),e instanceof Be&&n(e.definition())})))})),x.DEFMETHOD("tail_node",f),me.DEFMETHOD("tail_node",(function(){return this.expressions[this.expressions.length-1]})),q.DEFMETHOD("compute_char_frequency",(function(e){e=Bt(e),Vt.reset();try{x.prototype.print=function(t,r){this._print(t,r),this instanceof Re&&!this.unmangleable(e)?Vt.consider(this.name,-1):e.properties&&(this instanceof Te?Vt.consider(this.property,-1):this instanceof ye&&function e(t){t instanceof qe?Vt.consider(t.value,-1):t instanceof Se?(e(t.consequent),e(t.alternative)):t instanceof me&&e(t.tail_node())}(this.property))},Vt.consider(this.print_to_string(),1)}finally{x.prototype.print=x.prototype._print}Vt.sort()}));var Vt=function(){var e=Object.create(null);function t(t){for(var r=[],n=0,i=t.length;n<i;n++){var a=t[n];r.push(a),e[a]=-.01*n}return r}var r,n,i=t("0123456789"),a=t("abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ$_");function s(e,t){return n[t]-n[e]}function o(e){var t="",n=54;for(e++;t+=r[--e%n],e=Math.floor(e/n),n=64,0<e;);return t}return o.consider=function(e,t){for(var r=e.length;0<=--r;)n[e[r]]+=t},o.sort=function(){r=a.sort(s).concat(i.sort(s))},(o.reset=function(){n=Object.create(e)})(),o}(),Ut=/^$|[;{][\s\n]*$/;function Ht(e){return"comment2"==e.type&&/@preserve|@license|@cc_on/i.test(e.value)}function zt(e){var t=!e;e=o(e,{ascii_only:!1,beautify:!1,braces:!1,comments:!1,ie8:!1,indent_level:4,indent_start:0,inline_script:!0,keep_quoted_props:!1,max_line_len:!1,preamble:null,preserve_line:!1,quote_keys:!1,quote_style:0,semicolons:!0,shebang:!0,source_map:null,webkit:!1,width:80,wrap_iife:!1},!0);var r=u;if(e.comments){var n=e.comments;if("string"==typeof e.comments&&/^\/.*\/[a-zA-Z]*$/.test(e.comments)){var i=e.comments.lastIndexOf("/");n=new RegExp(e.comments.substr(1,i-1),e.comments.substr(i+1))}r=n instanceof RegExp?function(e){return"comment5"!=e.type&&n.test(e.value)}:"function"==typeof n?function(e){return"comment5"!=e.type&&n(this,e)}:"some"===n?Ht:h}var a=0,s=0,l=1,f=0,d="",p=e.ascii_only?function(e,t){return e.replace(/[\u0000-\u001f\u007f-\uffff]/g,(function(e){var r=e.charCodeAt(0).toString(16);if(r.length<=2&&!t){for(;r.length<2;)r="0"+r;return"\\x"+r}for(;r.length<4;)r="0"+r;return"\\u"+r}))}:function(e){for(var t="",r=0,n=e.length;r<n;r++)Tt(e[r])&&!yt(e[r+1])||yt(e[r])&&!Tt(e[r-1])?t+="\\u"+e.charCodeAt(r).toString(16):t+=e[r];return t};function m(t,r){var n=function(t,r){var n=0,i=0;function a(){return"'"+t.replace(/\x27/g,"\\'")+"'"}function s(){return'"'+t.replace(/\x22/g,'\\"')+'"'}switch(t=t.replace(/[\\\b\f\n\r\v\t\x22\x27\u2028\u2029\0\ufeff]/g,(function(r,a){switch(r){case'"':return++n,'"';case"'":return++i,"'";case"\\":return"\\\\";case"\n":return"\\n";case"\r":return"\\r";case"\t":return"\\t";case"\b":return"\\b";case"\f":return"\\f";case"\v":return e.ie8?"\\x0B":"\\v";case"\u2028":return"\\u2028";case"\u2029":return"\\u2029";case"\ufeff":return"\\ufeff";case"\0":return/[0-9]/.test(t.charAt(a+1))?"\\x00":"\\0"}return r})),t=p(t),e.quote_style){case 1:return a();case 2:return s();case 3:return"'"==r?a():s();default:return i<n?a():s()}}(t,r);return e.inline_script&&(n=(n=(n=n.replace(/<\x2f(script)([>\/\t\n\f\r ])/gi,"<\\/$1$2")).replace(/\x3c!--/g,"\\x3c!--")).replace(/--\x3e/g,"--\\x3e")),n}var g,T,E=!1,C=0,b=!0,S=!1,I=!1,w=!1,D=!1,_=-1,A="",R=e.source_map&&[],M=R?function(e,t){R.forEach((function(r){r.line+=e,r.col+=t}))}:c,N=R?function(){R.forEach((function(t){try{e.source_map.add(t.token.file,t.line,t.col,t.token.line,t.token.col,t.name||"name"!=t.token.type?t.name:t.token.value)}catch(e){x.warn("Couldn't figure out mapping for {file}:{line},{col} → {cline},{ccol} [{name}]",{file:t.token.file,line:t.token.line,col:t.token.col,cline:t.line,ccol:t.col,name:t.name||""})}})),R=[]}:c;function k(e){var t=d.lastIndexOf("\n");C<t&&(C=t);var r=d.slice(0,C),n=d.slice(C);for(M(e,n.length-s),l+=e,f+=e,s=n.length,d=r;e--;)d+="\n";d+=n}var O=e.max_line_len?function(){b?s>e.max_line_len&&x.warn("Output exceeds {max_line_len} characters",e):(s>e.max_line_len&&k(1),b=!0,N())}:c,L=y("( [ + * / - , .");function F(t){var r=(t=String(t)).charAt(0);w&&r&&(w=!1,"\n"!=r&&(F("\n"),V())),D&&r&&(D=!1,/[\s;})]/.test(r)||B()),_=-1;var n=A.charAt(A.length-1);I&&(I=!1,(":"==n&&"}"==r||(!r||";}".indexOf(r)<0)&&";"!=n)&&(e.semicolons||L[r]?(d+=";",s++,f++):(O(),d+="\n",f++,l++,s=0,/^\s+$/.test(t)&&(I=!0)),e.beautify||(S=!1))),S&&((bt(n)&&(bt(r)||"\\"==r)||"/"==r&&r==n||("+"==r||"-"==r)&&r==A)&&(d+=" ",s++,f++),S=!1),g&&(R.push({token:g,name:T,line:l,col:s}),g=!1,b&&N()),d+=t,E="("==t[t.length-1],f+=t.length;var i=t.split(/\r?\n/),a=i.length-1;l+=a,s+=i[0].length,0<a&&(O(),s=i[a].length),A=t}var B=e.beautify?function(){F(" ")}:function(){S=!0},V=e.beautify?function(t){e.beautify&&F(function(t){return function e(t,r){if(r<=0)return"";if(1==r)return t;var n=e(t,r>>1);return n+=n,1&r?n+t:n}(" ",e.indent_start+a-t*e.indent_level)}(t?.5:0))}:c,U=e.beautify?function(e,t){!0===e&&(e=G());var r=a;a=e;var n=t();return a=r,n}:function(e,t){return t()},H=e.max_line_len||e.preserve_line?function(){O(),C=d.length,b=!1}:c,z=e.beautify?function(){if(_<0)return F("\n");"\n"!=d[_]&&(d=d.slice(0,_)+"\n"+d.slice(_),f++,l++),_++}:H,j=e.beautify?function(){F(";")}:function(){I=!0};function q(){I=!1,F(";")}function G(){return a+e.indent_level}function W(){return b||O(),d}function Y(){var e=d.lastIndexOf("\n");return/^ *$/.test(d.slice(e+1))}var K=[];return{get:W,toString:W,indent:V,indentation:function(){return a},current_width:function(){return s-a},should_break:function(){return e.width&&this.current_width()>=e.width},has_parens:function(){return E},newline:z,print:F,space:B,comma:function(){H(),F(","),H(),B()},colon:function(){F(":"),B()},last:function(){return A},semicolon:j,force_semicolon:q,to_utf8:p,print_name:function(e){var t;F((t=(t=e).toString(),t=p(t,!0)))},print_string:function(e,t,r){var n=m(e,t);!0===r&&-1===n.indexOf("\\")&&(Ut.test(d)||q(),q()),F(n)},encode_string:m,next_indent:G,with_indent:U,with_block:function(e){var t;return F("{"),z(),U(G(),(function(){t=e()})),V(),F("}"),t},with_parens:function(e){F("("),H();var t=e();return H(),F(")"),t},with_square:function(e){F("["),H();var t=e();return H(),F("]"),t},add_mapping:R?function(e,t){g=e,T=t}:c,option:function(t){return e[t]},prepend_comments:t?c:function(t){var n=this,i=t.start;if(i&&(!i.comments_before||i.comments_before._dumped!==n)){var a=i.comments_before;if(a||(a=i.comments_before=[]),a._dumped=n,t instanceof X&&t.value){var s=new rt((function(e){var t=s.parent();if(!(t instanceof X||t instanceof be&&t.left===e||"Call"==t.TYPE&&t.expression===e||t instanceof Se&&t.condition===e||t instanceof Te&&t.expression===e||t instanceof me&&t.expressions[0]===e||t instanceof ye&&t.expression===e||t instanceof Ce))return!0;var r=e.start.comments_before;r&&r._dumped!==n&&(r._dumped=n,a=a.concat(r))}));s.push(t),t.value.walk(s)}if(0==f){0<a.length&&e.shebang&&"comment5"==a[0].type&&(F("#!"+a.shift().value+"\n"),V());var o=e.preamble;o&&F(o.replace(/\r\n?|[\n\u2028\u2029]|\s*$/g,"\n"))}if(0!=(a=a.filter(r,t)).length){var l=Y();a.forEach((function(e,t){l||(e.nlb?(F("\n"),V(),l=!0):0<t&&B()),/comment[134]/.test(e.type)?(F("//"+e.value.replace(/[@#]__PURE__/g," ")+"\n"),V(),l=!0):"comment2"==e.type&&(F("/*"+e.value.replace(/[@#]__PURE__/g," ")+"*/"),l=!1)})),l||(i.nlb?(F("\n"),V()):B())}}},append_comments:t||r===u?c:function(e,t){var n=e.end;if(n){var i=n[t?"comments_before":"comments_after"];if(i&&i._dumped!==this&&(e instanceof P||v(i,(function(e){return!/comment[134]/.test(e.type)})))){i._dumped=this;var a=d.length;i.filter(r,e).forEach((function(e,r){D=!1,w?(F("\n"),V(),w=!1):e.nlb&&(0<r||!Y())?(F("\n"),V()):(0<r||!t)&&B(),/comment[134]/.test(e.type)?(F("//"+e.value.replace(/[@#]__PURE__/g," ")),w=!0):"comment2"==e.type&&(F("/*"+e.value.replace(/[@#]__PURE__/g," ")+"*/"),D=!0)})),d.length>a&&(_=a)}}},line:function(){return l},col:function(){return s},pos:function(){return f},push_node:function(e){K.push(e)},pop_node:e.preserve_line?function(){var e=K.pop();e.start&&e.start.line>l&&k(e.start.line-l)}:function(){K.pop()},parent:function(e){return K[K.length-2-(e||0)]}}}function jt(e,t){if(!(this instanceof jt))return new jt(e,t);Ot.call(this,this.before,this.after),this.options=o(e,{arguments:!t,booleans:!t,collapse_vars:!t,comparisons:!t,conditionals:!t,dead_code:!t,directives:!t,drop_console:!1,drop_debugger:!t,evaluate:!t,expression:!1,global_defs:!1,hoist_funs:!1,hoist_props:!t,hoist_vars:!1,ie8:!1,if_return:!t,inline:!t,join_vars:!t,keep_fargs:!0,keep_fnames:!1,keep_infinity:!1,loops:!t,negate_iife:!t,passes:1,properties:!t,pure_getters:!t&&"strict",pure_funcs:null,reduce_funcs:!t,reduce_vars:!t,sequences:!t,side_effects:!t,switches:!t,top_retain:null,toplevel:!(!e||!e.top_retain),typeofs:!t,unsafe:!1,unsafe_comps:!1,unsafe_Function:!1,unsafe_math:!1,unsafe_proto:!1,unsafe_regexp:!1,unsafe_undefined:!1,unused:!t,warnings:!1},!0);var r=this.options.global_defs;if("object"==_typeof(r))for(var n in r)/^@/.test(n)&&C(r,n)&&(r[n.slice(1)]=kt(r[n],{expression:!0}));!0===this.options.inline&&(this.options.inline=3);var i=this.options.pure_funcs;this.pure_funcs="function"==typeof i?i:i?function(e){return i.indexOf(e.expression.print_to_string())<0}:h;var a=this.options.top_retain;a instanceof RegExp?this.top_retain=function(e){return a.test(e.name)}:"function"==typeof a?this.top_retain=a:a&&("string"==typeof a&&(a=a.split(/,/)),this.top_retain=function(e){return 0<=a.indexOf(e.name)});var s=this.options.toplevel;this.toplevel="string"==typeof s?{funcs:/funcs/.test(s),vars:/vars/.test(s)}:{funcs:s,vars:s};var l=this.options.sequences;this.sequences_limit=1==l?800:0|l,this.warnings_produced={}}function qt(e,t){e.walk(new rt((function(e){return e instanceof me?qt(e.tail_node(),t):e instanceof qe?t(e.value):e instanceof Se&&(qt(e.consequent,t),qt(e.alternative,t)),!0})))}function Gt(e,t){var r=(t=o(t,{builtins:!1,cache:null,debug:!1,keep_quoted:!1,only_cache:!1,regex:null,reserved:null},!0)).reserved;Array.isArray(r)||(r=[]),t.builtins||function(e){function t(t){m(e,t)}["null","true","false","Infinity","-Infinity","undefined"].forEach(t),[Array,Boolean,Date,Error,Function,Math,Number,Object,RegExp,String].forEach((function(e){Object.getOwnPropertyNames(e).map(t),e.prototype&&Object.getOwnPropertyNames(e.prototype).map(t)}))}(r);var n,i=-1;t.cache?(n=t.cache.props).each((function(e){m(r,e)})):n=new E;var a,s=t.regex,l=!1!==t.debug;l&&(a=!0===t.debug?"":t.debug);var c=[],u=[];return e.walk(new rt((function(e){e instanceof De?d(e.key):e instanceof we?d(e.key.name):e instanceof Te?d(e.property):e instanceof ye?qt(e.property,d):e instanceof de&&"Object.defineProperty"==e.expression.print_to_string()&&qt(e.args[1],d)}))),e.transform(new Ot((function(e){e instanceof De?e.key=p(e.key):e instanceof we?e.key.name=p(e.key.name):e instanceof Te?e.property=p(e.property):!t.keep_quoted&&e instanceof ye?e.property=g(e.property):e instanceof de&&"Object.defineProperty"==e.expression.print_to_string()&&(e.args[1]=g(e.args[1]))})));function h(e){return!(0<=u.indexOf(e))&&!(0<=r.indexOf(e))&&(t.only_cache?n.has(e):!/^-?[0-9]+(\.[0-9]+)?(e[+-][0-9]+)?$/.test(e))}function f(e){return!(s&&!s.test(e))&&!(0<=r.indexOf(e))&&(n.has(e)||0<=c.indexOf(e))}function d(e){h(e)&&m(c,e),f(e)||m(u,e)}function p(e){if(!f(e))return e;var t=n.get(e);if(!t){if(l){var r="_$"+e+"$"+a+"_";h(r)&&(t=r)}if(!t)for(;!h(t=Vt(++i)););n.set(e,t)}return t}function g(e){return e.transform(new Ot((function(e){if(e instanceof me){var t=e.expressions.length-1;e.expressions[t]=g(e.expressions[t])}else e instanceof qe?e.value=p(e.value):e instanceof Se&&(e.consequent=g(e.consequent),e.alternative=g(e.alternative));return e})))}}!function(){function e(e,t){e.DEFMETHOD("_codegen",t)}var t=!1,r=null,n=null;function i(e,t){Array.isArray(e)?e.forEach((function(e){i(e,t)})):e.DEFMETHOD("needs_parens",t)}function a(e,r,n,i){var a=e.length-1;t=i,e.forEach((function(e,i){!0!==t||e instanceof D||e instanceof N||e instanceof _&&e.body instanceof qe||(t=!1),e instanceof N||(n.indent(),e.print(n),i==a&&r||(n.newline(),r&&n.newline())),!0===t&&e instanceof _&&e.body instanceof qe&&(t=!1)})),t=!1}function s(e,t){t.print("{"),t.with_indent(t.next_indent(),(function(){t.append_comments(e,!0)})),t.print("}")}function o(e,t,r){0<e.body.length?t.with_block((function(){a(e.body,!1,t,r)})):s(e,t)}function l(e,t,r){e.print(t),r&&(e.space(),r.print(e)),e.semicolon()}function h(e,t,r){var n=!1;r&&e.walk(new rt((function(e){return!!(n||e instanceof j)||(e instanceof be&&"in"==e.operator?n=!0:void 0)}))),e.print(t,n)}function f(e,t,r){r.option("quote_keys")?r.print_string(e):""+ +e==e&&0<=e?r.print(m(e)):(at[e]?!r.option("ie8"):St(e))?t&&r.option("keep_quoted_props")?r.print_string(e,t):r.print_name(e):r.print_string(e,t)}function d(e,t){t.option("braces")?g(e,t):!e||e instanceof N?t.force_semicolon():e.print(t)}function p(e,t){return 0<e.args.length||t.option("beautify")}function m(e){var t,r,n,i=e.toString(10).replace(/^0\./,".").replace("e+","e"),a=[i];return Math.floor(e)===e&&(e<0?a.push("-0x"+(-e).toString(16).toLowerCase()):a.push("0x"+e.toString(16).toLowerCase())),(t=/^\.0+/.exec(i))?(r=t[0].length,n=i.slice(r),a.push(n+"e-"+(n.length+r-1))):(t=/0+$/.exec(i))?(r=t[0].length,a.push(i.slice(0,-r)+"e"+r)):(t=/^(\d)\.(\d+)e(-?\d+)$/.exec(i))&&a.push(t[1]+t[2]+"e"+(t[3]-t[2].length)),function(e){for(var t=e[0],r=t.length,n=1;n<e.length;++n)e[n].length<r&&(r=(t=e[n]).length);return t}(a)}function g(e,t){!e||e instanceof N?t.print("{}"):e instanceof M?e.print(t):t.with_block((function(){t.indent(),e.print(t),t.newline()}))}function T(e,t){e.forEach((function(e){e.DEFMETHOD("add_source_map",t)}))}x.DEFMETHOD("print",(function(e,t){var i=this,a=i._codegen;function s(){e.prepend_comments(i),i.add_source_map(e),a(i,e),e.append_comments(i)}i instanceof j?r=i:!n&&i instanceof D&&"use asm"==i.value&&(n=r),e.push_node(i),t||i.needs_parens(e)?e.with_parens(s):s(),e.pop_node(),i===n&&(n=null)})),x.DEFMETHOD("_print",x.prototype.print),x.DEFMETHOD("print_to_string",(function(e){var t=zt(e);return this.print(t),t.get()})),i(x,u),i(Y,(function(e){return!(e.has_parens()||!b(e))||(!!(e.option("webkit")&&(t=e.parent())instanceof ge&&t.expression===this)||(!!(e.option("wrap_iife")&&(t=e.parent())instanceof de&&t.expression===this)||void 0));var t})),i(Pe,(function(e){return!e.has_parens()&&b(e)})),i(ve,(function(e){var t=e.parent();return t instanceof ge&&t.expression===this||t instanceof de&&t.expression===this})),i(me,(function(e){var t=e.parent();return t instanceof de||t instanceof ve||t instanceof be||t instanceof fe||t instanceof ge||t instanceof xe||t instanceof we||t instanceof Se})),i(be,(function(e){var t=e.parent();if(t instanceof de&&t.expression===this)return!0;if(t instanceof ve)return!0;if(t instanceof ge&&t.expression===this)return!0;if(t instanceof be){var r=t.operator,n=Mt[r],i=this.operator,a=Mt[i];if(a<n||n==a&&this===t.right)return!0}})),i(ge,(function(e){var t=e.parent();if(t instanceof pe&&t.expression===this){var r=!1;return this.walk(new rt((function(e){return!!(r||e instanceof j)||(e instanceof de?r=!0:void 0)}))),r}})),i(de,(function(e){var t=e.parent();if(t instanceof pe&&t.expression===this)return!0;if(e.option("webkit")){var r=e.parent(1);return this.expression instanceof Y&&t instanceof ge&&t.expression===this&&r instanceof Ie&&r.left===t}})),i(pe,(function(e){var t=e.parent();if(!p(this,e)&&(t instanceof ge||t instanceof de&&t.expression===this))return!0})),i(Ge,(function(e){var t=e.parent();if(t instanceof ge&&t.expression===this){var r=this.getValue();if(r<0||/^0/.test(m(r)))return!0}})),i([Ie,Se],(function(e){var t=e.parent();return t instanceof ve||t instanceof be&&!(t instanceof Ie)||t instanceof de&&t.expression===this||t instanceof Se&&t.condition===this||t instanceof ge&&t.expression===this||void 0})),e(D,(function(e,t){t.print_string(e.value,e.quote),t.semicolon()})),e(w,(function(e,t){t.print("debugger"),t.semicolon()})),k.DEFMETHOD("_do_print_body",(function(e){d(this.body,e)})),e(P,(function(e,t){e.body.print(t),t.semicolon()})),e(q,(function(e,t){a(e.body,!0,t,!0),t.print("")})),e(O,(function(e,t){e.label.print(t),t.colon(),e.body.print(t)})),e(_,(function(e,t){e.body.print(t),t.semicolon()})),e(M,(function(e,t){o(e,t)})),e(N,(function(e,t){t.semicolon()})),e(B,(function(e,t){t.print("do"),t.space(),g(e.body,t),t.space(),t.print("while"),t.space(),t.with_parens((function(){e.condition.print(t)})),t.semicolon()})),e(V,(function(e,t){t.print("while"),t.space(),t.with_parens((function(){e.condition.print(t)})),t.space(),e._do_print_body(t)})),e(U,(function(e,t){t.print("for"),t.space(),t.with_parens((function(){e.init?(e.init instanceof ue?e.init.print(t):h(e.init,t,!0),t.print(";"),t.space()):t.print(";"),e.condition?(e.condition.print(t),t.print(";"),t.space()):t.print(";"),e.step&&e.step.print(t)})),t.space(),e._do_print_body(t)})),e(H,(function(e,t){t.print("for"),t.space(),t.with_parens((function(){e.init.print(t),t.space(),t.print("in"),t.space(),e.object.print(t)})),t.space(),e._do_print_body(t)})),e(z,(function(e,t){t.print("with"),t.space(),t.with_parens((function(){e.expression.print(t)})),t.space(),e._do_print_body(t)})),G.DEFMETHOD("_do_print",(function(e,t){var r=this;t||e.print("function"),r.name&&(e.space(),r.name.print(e)),e.with_parens((function(){r.argnames.forEach((function(t,r){r&&e.comma(),t.print(e)}))})),e.space(),o(r,e,!0)})),e(G,(function(e,t){e._do_print(t)})),e($,(function(e,t){l(t,"return",e.value)})),e(Z,(function(e,t){l(t,"throw",e.value)})),e(ee,(function(e,t){l(t,"break",e.label)})),e(te,(function(e,t){l(t,"continue",e.label)})),e(re,(function(e,t){t.print("if"),t.space(),t.with_parens((function(){e.condition.print(t)})),t.space(),e.alternative?(function(e,t){var r=e.body;if(t.option("braces")||t.option("ie8")&&r instanceof B)return g(r,t);if(!r)return t.force_semicolon();for(;;)if(r instanceof re){if(!r.alternative)return g(e.body,t);r=r.alternative}else{if(!(r instanceof k))break;r=r.body}d(e.body,t)}(e,t),t.space(),t.print("else"),t.space(),e.alternative instanceof re?e.alternative.print(t):d(e.alternative,t)):e._do_print_body(t)})),e(ne,(function(e,t){t.print("switch"),t.space(),t.with_parens((function(){e.expression.print(t)})),t.space();var r=e.body.length-1;r<0?s(e,t):t.with_block((function(){e.body.forEach((function(e,n){t.indent(!0),e.print(t),n<r&&0<e.body.length&&t.newline()}))}))})),ie.DEFMETHOD("_do_print_body",(function(e){e.newline(),this.body.forEach((function(t){e.indent(),t.print(e),e.newline()}))})),e(ae,(function(e,t){t.print("default:"),e._do_print_body(t)})),e(se,(function(e,t){t.print("case"),t.space(),e.expression.print(t),t.print(":"),e._do_print_body(t)})),e(oe,(function(e,t){t.print("try"),t.space(),o(e,t),e.bcatch&&(t.space(),e.bcatch.print(t)),e.bfinally&&(t.space(),e.bfinally.print(t))})),e(le,(function(e,t){t.print("catch"),t.space(),t.with_parens((function(){e.argname.print(t)})),t.space(),o(e,t)})),e(ce,(function(e,t){t.print("finally"),t.space(),o(e,t)})),e(he,(function(e,t){t.print("var"),t.space(),e.definitions.forEach((function(e,r){r&&t.comma(),e.print(t)}));var r=t.parent();(r&&r.init!==e||!(r instanceof U||r instanceof H))&&t.semicolon()})),e(fe,(function(e,t){if(e.name.print(t),e.value){t.space(),t.print("="),t.space();var r=t.parent(1),n=r instanceof U||r instanceof H;h(e.value,t,n)}})),e(de,(function(e,t){e.expression.print(t),e instanceof pe&&!p(e,t)||((e.expression instanceof de||e.expression instanceof G)&&t.add_mapping(e.start),t.with_parens((function(){e.args.forEach((function(e,r){r&&t.comma(),e.print(t)}))})))})),e(pe,(function(e,t){t.print("new"),t.space(),de.prototype._codegen(e,t)})),e(me,(function(e,t){e.expressions.forEach((function(e,r){0<r&&(t.comma(),t.should_break()&&(t.newline(),t.indent())),e.print(t)}))})),e(Te,(function(e,t){var r=e.expression;r.print(t);var n=e.property;t.option("ie8")&&at[n]?(t.print("["),t.add_mapping(e.end),t.print_string(n),t.print("]")):(r instanceof Ge&&0<=r.getValue()&&(/[xa-f.)]/i.test(t.last())||t.print(".")),t.print("."),t.add_mapping(e.end),t.print_name(n))})),e(ye,(function(e,t){e.expression.print(t),t.print("["),e.property.print(t),t.print("]")})),e(Ee,(function(e,t){var r=e.operator;t.print(r),(/^[a-z]/i.test(r)||/[+-]$/.test(r)&&e.expression instanceof Ee&&/^[+-]/.test(e.expression.operator))&&t.space(),e.expression.print(t)})),e(Ce,(function(e,t){e.expression.print(t),t.print(e.operator)})),e(be,(function(e,t){var r=e.operator;e.left.print(t),">"==r[0]&&e.left instanceof Ce&&"--"==e.left.operator?t.print(" "):t.space(),t.print(r),("<"==r||"<<"==r)&&e.right instanceof Ee&&"!"==e.right.operator&&e.right.expression instanceof Ee&&"--"==e.right.expression.operator?t.print(" "):t.space(),e.right.print(t)})),e(Se,(function(e,t){e.condition.print(t),t.space(),t.print("?"),t.space(),e.consequent.print(t),t.space(),t.colon(),e.alternative.print(t)})),e(xe,(function(e,t){t.with_square((function(){var r=e.elements,n=r.length;0<n&&t.space(),r.forEach((function(e,r){r&&t.comma(),e.print(t),r===n-1&&e instanceof $e&&t.comma()})),0<n&&t.space()}))})),e(Pe,(function(e,t){0<e.properties.length?t.with_block((function(){e.properties.forEach((function(e,r){r&&(t.print(","),t.newline()),t.indent(),e.print(t)})),t.newline()})):s(e,t)})),e(De,(function(e,t){f(e.key,e.quote,t),t.colon(),e.value.print(t)})),we.DEFMETHOD("_print_getter_setter",(function(e,t){t.print(e),t.space(),f(this.key.name,this.quote,t),this.value._do_print(t,!0)})),e(_e,(function(e,t){e._print_getter_setter("set",t)})),e(Ae,(function(e,t){e._print_getter_setter("get",t)})),e(Re,(function(e,t){var r=e.definition();t.print_name(r?r.mangled_name||r.name:e.name)})),e($e,c),e(ze,(function(e,t){t.print("this")})),e(je,(function(e,t){t.print(e.getValue())})),e(qe,(function(e,r){r.print_string(e.getValue(),e.quote,t)})),e(Ge,(function(e,t){n&&e.start&&null!=e.start.raw?t.print(e.start.raw):t.print(m(e.getValue()))})),e(We,(function(e,t){var r=e.getValue(),n=r.toString();r.raw_source&&(n="/"+r.raw_source+n.slice(n.lastIndexOf("/"))),n=t.to_utf8(n),t.print(n);var i=t.parent();i instanceof be&&/^in/.test(i.operator)&&i.left===e&&t.print(" ")})),T([x,O,q],c),T([xe,M,le,je,w,ue,D,ce,Q,G,pe,Pe,k,Re,ne,ie,oe],(function(e){e.add_mapping(this.start)})),T([Ae,_e],(function(e){e.add_mapping(this.start,this.key.name)})),T([we],(function(e){e.add_mapping(this.start,this.key)}))}(),l(jt.prototype=new Ot,{option:function(e){return this.options[e]},exposed:function(e){if(e.global)for(var t=0,r=e.orig.length;t<r;t++)if(!this.toplevel[e.orig[t]instanceof Le?"funcs":"vars"])return!0;return!1},compress:function(e){e=e.resolve_defines(this),this.option("expression")&&e.process_expression(!0);for(var t=+this.options.passes||1,r=1/0,n=!1,i={ie8:this.option("ie8")},a=0;a<t;a++)if(e.figure_out_scope(i),(0<a||this.option("reduce_vars"))&&e.reset_opt_flags(this),e=e.transform(this),1<t){var s=0;if(e.walk(new rt((function(){s++}))),this.info("pass "+a+": last_count: "+r+", count: "+s),s<r)r=s,n=!1;else{if(n)break;n=!0}}return this.option("expression")&&e.process_expression(!1),e},info:function(){"verbose"==this.options.warnings&&x.warn.apply(x,arguments)},warn:function(e,t){if(this.options.warnings){var r=g(e,t);r in this.warnings_produced||(this.warnings_produced[r]=!0,x.warn.apply(x,arguments))}},clear_warnings:function(){this.warnings_produced={}},before:function(e,t,r){if(e._squeezed)return e;var n=e instanceof j;n&&(e.hoist_properties(this),e.hoist_declarations(this)),t(e,this),t(e,this);var i=e.optimize(this);return n&&(i.drop_unused(this),t(i,this)),i===e&&(i._squeezed=!0),i}}),function(e){function t(e,t){if(!((t=lt(t))instanceof x)){var r;if(e instanceof xe){var n=e.elements;if("length"==t)return m(n.length,e);"number"==typeof t&&t in n&&(r=n[t])}else if(e instanceof Pe){t=""+t;for(var i=e.properties,a=i.length;0<=--a;){if(!(i[a]instanceof De))return;r||i[a].key!==t||(r=i[a].value)}}return r instanceof Ue&&r.fixed_value()||r}}function r(e,n,i,a,s,o){var l=n.parent(s),c=ft(i,l);if(c)return c;if(!o&&l instanceof de&&l.expression===i&&!l.is_expr_pure(e)&&(!(a instanceof Y)||!(l instanceof pe)&&a.contains_this()))return!0;if(l instanceof xe)return r(e,n,l,l,s+1);if(l instanceof De&&i===l.value){var u=n.parent(s+1);return r(e,n,u,u,s+2)}if(l instanceof ge&&l.expression===i){var h=t(a,l.property);return!o&&r(e,n,l,h,s+1)}}function a(e){if(e instanceof ze)return!0;if(e instanceof Ue)return e.definition().orig[0]instanceof Fe;if(e instanceof ge){if((e=e.expression)instanceof Ue){if(e.is_immutable())return!1;e=e.fixed_value()}return!e||!!e.is_constant()||a(e)}return!1}function s(e,t){for(var r,n=0;(r=e.parent(n++))&&!(r instanceof j);)if(r instanceof le){r=r.argname.definition().scope;break}return r.find_variable(t)}function o(e,t,r){return r||(r={}),t&&(r.start||(r.start=t.start),r.end||(r.end=t.end)),new e(r)}function l(e,t){return 1==t.length?t[0]:o(me,e,{expressions:t.reduce(k,[])})}function m(e,t){switch(_typeof(e)){case"string":return o(qe,t,{value:e});case"number":return isNaN(e)?o(Qe,t):isFinite(e)?1/e<0?o(Ee,t,{operator:"-",expression:o(Ge,t,{value:-e})}):o(Ge,t,{value:e}):e<0?o(Ee,t,{operator:"-",expression:o(Ze,t)}):o(Ze,t);case"boolean":return o(e?tt:et,t);case"undefined":return o(Xe,t);default:if(null===e)return o(Ke,t,{value:null});if(e instanceof RegExp)return o(We,t,{value:e});throw new Error(g("Can't handle constant of type: {type}",{type:_typeof(e)}))}}function S(e,t){return t instanceof ge||e.has_directive("use strict")&&He(t)&&"eval"==t.name}function I(e,t,r,n){return t instanceof Ee&&"delete"==t.operator||"Call"==t.TYPE&&t.expression===r&&S(e,n)?l(r,[o(Ge,r,{value:0}),n]):n}function k(e,t){return t instanceof me?e.push.apply(e,t.expressions):e.push(t),e}function Z(e){if(null===e)return[];if(e instanceof M)return e.body;if(e instanceof N)return[];if(e instanceof P)return[e];throw new Error("Can't convert thing to statement array")}function _e(e){return null===e||e instanceof N||e instanceof M&&0==e.body.length}function Ae(e){return e instanceof L&&e.body instanceof M?e.body:e}function Me(e){for(;e instanceof ge;)e=e.expression;return e}function Ve(e){return"Call"==e.TYPE&&(e.expression instanceof Y||Ve(e.expression))}function He(e){return e instanceof Ue&&e.definition().undeclared}e(x,(function(e,t){return e})),x.DEFMETHOD("equivalent_to",(function(e){return this.TYPE==e.TYPE&&this.print_to_string()==e.print_to_string()})),j.DEFMETHOD("process_expression",(function(e,t){var r=this,n=new Ot((function(i){if(e&&i instanceof _)return o($,i,{value:i.body});if(!e&&i instanceof $){if(t){var a=i.value&&i.value.drop_side_effect_free(t,!0);return a?o(_,i,{body:a}):o(N,i)}return o(_,i,{body:i.value||o(Ee,i,{operator:"void",expression:o(Ge,i,{value:0})})})}if(i instanceof G&&i!==r)return i;if(i instanceof R){var s=i.body.length-1;0<=s&&(i.body[s]=i.body[s].transform(n))}else i instanceof re?(i.body=i.body.transform(n),i.alternative&&(i.alternative=i.alternative.transform(n))):i instanceof z&&(i.body=i.body.transform(n));return i}));r.transform(n)})),function(e){function n(e,t,r){r.assignments=0,r.chained=!1,r.direct_access=!1,r.escaped=!1,r.fixed=!r.scope.pinned()&&!t.exposed(r)&&!(r.init instanceof Y&&r.init!==r.scope)&&r.init,r.fixed instanceof K&&!v(r.references,(function(e){var t=e.scope;do{if(r.scope===t)return!0}while(t instanceof Y&&(t=t.parent_scope))}))&&(e.defun_ids[r.id]=!1),r.recursive_refs=0,r.references=[],r.should_replace=void 0,r.single_use=void 0}function i(e,t,r){r.variables.each((function(r){n(e,t,r),null===r.fixed?(r.safe_ids=e.safe_ids,h(e,r,!0)):r.fixed&&(e.loop_ids[r.id]=e.in_loop,h(e,r,!0))})),r.may_call_this=function(){r.may_call_this=c,r.contains_this()&&r.functions.each((function(t){t.init instanceof K&&!(t.id in e.defun_ids)&&(e.defun_ids[t.id]=!1)}))}}function a(e,t){if(t.id in e.defun_ids){var r=e.defun_ids[t.id];if(!r)return;var n=e.defun_visited[t.id];if(r===e.safe_ids){if(!n)return t.fixed}else n?t.init.enclosed.forEach((function(r){t.init.variables.get(r.name)!==r&&(f(e,r)||(r.fixed=!1))})):e.defun_ids[t.id]=!1}else{if(!e.in_loop)return e.defun_ids[t.id]=e.safe_ids,t.fixed;e.defun_ids[t.id]=!1}}function s(e,t){t.functions.each((function(t){t.init instanceof K&&!e.defun_visited[t.id]&&(e.defun_ids[t.id]=e.safe_ids,t.init.walk(e))}))}function l(e){e.safe_ids=Object.create(e.safe_ids)}function u(e){e.safe_ids=Object.getPrototypeOf(e.safe_ids)}function h(e,t,r){e.safe_ids[t.id]=r}function f(e,t){if("m"==t.single_use)return!1;if(e.safe_ids[t.id]){if(null==t.fixed){var r=t.orig[0];if(r instanceof Oe||"arguments"==r.name)return!1;t.fixed=o(Xe,r)}return!0}return t.fixed instanceof K}function d(e,t,r,n){return void 0===t.fixed||(null===t.fixed&&t.safe_ids?(t.safe_ids[t.id]=!1,delete t.safe_ids,!0):!!C(e.safe_ids,t.id)&&!!f(e,t)&&!1!==t.fixed&&!(null!=t.fixed&&(!n||t.references.length>t.assignments))&&(t.fixed instanceof K?n instanceof x&&t.fixed.parent_scope===r:v(t.orig,(function(e){return!(e instanceof Le||e instanceof Fe)}))))}function p(e,r,n,i,a,s,o){var l=e.parent(s);if(!a||!a.is_constant()){if(l instanceof Ie&&"="==l.operator&&i===l.right||l instanceof de&&(i!==l.expression||l instanceof pe)||l instanceof X&&i===l.value&&i.scope!==r.scope||l instanceof fe&&i===l.value)return!(1<o)||a&&a.is_constant_expression(n)||(o=1),void((!r.escaped||r.escaped>o)&&(r.escaped=o));if(l instanceof xe||l instanceof be&&ut[l.operator]||l instanceof Se&&i!==l.condition||l instanceof me&&i===l.tail_node())p(e,r,n,l,l,s+1,o);else if(l instanceof De&&i===l.value){var c=e.parent(s+1);p(e,r,n,c,c,s+2,o)}else if(l instanceof ge&&i===l.expression&&(p(e,r,n,l,a=t(a,l.property),s+1,o+1),a))return;0<s||l instanceof me&&i!==l.tail_node()||l instanceof _||(r.direct_access=!0)}}e(x,c);var m=new rt((function(e){if(e instanceof Re){var t=e.definition();t&&(e instanceof Ue&&t.references.push(e),t.fixed=!1)}}));e(W,(function(e,t,r){return l(e),i(e,r,this),t(),u(e),s(e,this),!0})),e(Ie,(function(e,t,n){var i=this,a=i.left;if(a instanceof Ue){var s=a.definition(),l=d(e,s,a.scope,i.right);if(s.assignments++,l){var c=s.fixed;if(c||"="==i.operator){var u="="==i.operator,f=u?i.right:i;if(!r(n,e,i,f,0))return s.references.push(a),u||(s.chained=!0),s.fixed=u?function(){return i.right}:function(){return o(be,i,{operator:i.operator.slice(0,-1),left:c instanceof x?c:c(),right:i.right})},h(e,s,!1),i.right.walk(e),h(e,s,!0),p(e,s,a.scope,i,f,0,1),!0}}}})),e(be,(function(e){if(ut[this.operator])return this.left.walk(e),l(e),this.right.walk(e),u(e),!0})),e(de,(function(e,t){e.find_parent(j).may_call_this();var r=this.expression;if(r instanceof Ue){var n=r.definition();if(n.fixed instanceof K){var i=a(e,n);if(i)return t(),i.walk(e),!0}}})),e(se,(function(e){return l(e),this.expression.walk(e),u(e),l(e),A(this,e),u(e),!0})),e(Se,(function(e){return this.condition.walk(e),l(e),this.consequent.walk(e),u(e),l(e),this.alternative.walk(e),u(e),!0})),e(ae,(function(e,t){return l(e),t(),u(e),!0})),e(K,(function(e,t,r){var n=this.name.definition().id;return e.defun_visited[n]||e.defun_ids[n]!==e.safe_ids||(e.defun_visited[n]=!0,this.inlined=!1,l(e),i(e,r,this),t(),u(e),s(e,this)),!0})),e(B,(function(e){var t=e.in_loop;return e.in_loop=this,l(e),this.body.walk(e),bt(this)&&(u(e),l(e)),this.condition.walk(e),u(e),e.in_loop=t,!0})),e(U,(function(e){this.init&&this.init.walk(e);var t=e.in_loop;return e.in_loop=this,l(e),this.condition&&this.condition.walk(e),this.body.walk(e),this.step&&(bt(this)&&(u(e),l(e)),this.step.walk(e)),u(e),e.in_loop=t,!0})),e(H,(function(e){this.init.walk(m),this.object.walk(e);var t=e.in_loop;return e.in_loop=this,l(e),this.body.walk(e),u(e),e.in_loop=t,!0})),e(Y,(function(e,t,r){var n,a=this;return a.inlined=!1,l(e),i(e,r,a),!a.name&&(n=e.parent())instanceof de&&n.expression===a&&a.argnames.forEach((function(t,r){var i=t.definition();void 0!==i.fixed||a.uses_arguments&&!e.has_directive("use strict")?i.fixed=!1:(i.fixed=function(){return n.args[r]||o(Xe,n)},e.loop_ids[i.id]=e.in_loop,h(e,i,!0))})),t(),u(e),s(e,a),!0})),e(re,(function(e){return this.condition.walk(e),l(e),this.body.walk(e),u(e),this.alternative&&(l(e),this.alternative.walk(e),u(e)),!0})),e(O,(function(e){return l(e),this.body.walk(e),u(e),!0})),e(Be,(function(){this.definition().fixed=!1})),e(Ue,(function(e,t,n){var i,s,o,l,c,u=this.definition();if(u.references.push(this),1==u.references.length&&!u.fixed&&u.orig[0]instanceof Le&&(e.loop_ids[u.id]=e.in_loop),void 0!==u.fixed&&f(e,u)?u.fixed&&((i=this.fixed_value())instanceof G&&Pt(e,u)?u.recursive_refs++:i&&(o=e,l=u,n.option("unused")&&!l.scope.pinned()&&l.references.length-l.recursive_refs==1&&o.loop_ids[l.id]===o.in_loop)?u.single_use=i instanceof G&&!i.pinned()||u.scope===this.scope&&i.is_constant_expression():u.single_use=!1,r(n,e,this,i,0,!!(s=i)&&(s.is_constant()||s instanceof G||s instanceof ze))&&(u.single_use?u.single_use="m":u.fixed=!1)):u.fixed=!1,p(e,u,this.scope,this,i,0,1),u.fixed instanceof K&&!((c=e.parent())instanceof de&&c.expression===this)){var h=a(e,u);h&&h.walk(e)}})),e(q,(function(e,t,r){return this.globals.each((function(t){n(e,r,t)})),l(e),i(e,r,this),t(),u(e),s(e,this),!0})),e(oe,(function(e){return l(e),A(this,e),u(e),this.bcatch&&(l(e),this.bcatch.walk(e),u(e)),this.bfinally&&this.bfinally.walk(e),!0})),e(ve,(function(e,t){var r=this;if("++"==r.operator||"--"==r.operator){var n=r.expression;if(n instanceof Ue){var i=n.definition(),a=d(e,i,n.scope,!0);if(i.assignments++,a){var s=i.fixed;if(s)return i.references.push(n),i.chained=!0,i.fixed=function(){return o(be,r,{operator:r.operator.slice(0,-1),left:o(Ee,r,{operator:"+",expression:s instanceof x?s:s()}),right:o(Ge,r,{value:1})})},h(e,i,!0),!0}}}})),e(fe,(function(e,t){var r=this,n=r.name.definition();if(r.value){if(d(e,n,r.name.scope,r.value))return n.fixed=function(){return r.value},e.loop_ids[n.id]=e.in_loop,h(e,n,!1),t(),h(e,n,!0),!0;n.fixed=!1}})),e(V,(function(e,t){var r=e.in_loop;return e.in_loop=this,l(e),t(),u(e),e.in_loop=r,!0}))}((function(e,t){e.DEFMETHOD("reduce_vars",t)})),q.DEFMETHOD("reset_opt_flags",(function(e){var t=new rt(e.option("reduce_vars")?function(r,n){return r._squeezed=!1,r._optimized=!1,r.reduce_vars(t,n,e)}:function(e){e._squeezed=!1,e._optimized=!1});t.defun_ids=Object.create(null),t.defun_visited=Object.create(null),t.in_loop=null,t.loop_ids=Object.create(null),t.safe_ids=Object.create(null),this.walk(t)})),Re.DEFMETHOD("fixed_value",(function(){var e=this.definition().fixed;return!e||e instanceof x?e:e()})),Ue.DEFMETHOD("is_immutable",(function(){var e=this.definition().orig;return 1==e.length&&e[0]instanceof Fe}));var Ye=y("Array Boolean clearInterval clearTimeout console Date decodeURI decodeURIComponent encodeURI encodeURIComponent Error escape eval EvalError Function isFinite isNaN JSON Math Number parseFloat parseInt RangeError ReferenceError RegExp Object setInterval setTimeout String SyntaxError TypeError unescape URIError");Ue.DEFMETHOD("is_declared",(function(e){return!this.definition().undeclared||e.option("unsafe")&&Ye[this.name]}));var nt,it,at=y("Infinity NaN undefined");function st(e,t){var i,s,c;!function(){var e=t.self(),r=0;do{if(e instanceof le||e instanceof ce)r++;else if(e instanceof L)i=!0;else{if(e instanceof j){c=e;break}e instanceof oe&&(s=!0)}}while(e=t.parent(r++))}();for(var h,f=10;h=!1,m(e),t.option("dead_code")&&y(e,t),t.option("if_return")&&g(e,t),0<t.sequences_limit&&(C(e,t),S(e,t)),t.option("join_vars")&&O(e),t.option("collapse_vars")&&d(e,t),h&&0<f--;);function d(e,t){if(c.pinned())return e;for(var l,f,d,m=[],g=e.length,T=new Ot((function(e){if(Q)return e;if(!K)return e!==E[C]?e:++C<E.length?le(e):(K=!0,(x=function e(t,r,n){var i=T.parent(r);return i instanceof Ie?n&&!(i.left instanceof ge||i.left.name in O)?e(i,r+1,n):t:i instanceof be?!n||ut[i.operator]&&i.left!==t?t:e(i,r+1,n):i instanceof de||i instanceof se?t:i instanceof Se?n&&i.condition===t?e(i,r+1,n):t:i instanceof ue?e(i,r+1,!0):i instanceof X?n?e(i,r+1,n):t:i instanceof re?n&&i.condition===t?e(i,r+1,n):t:i instanceof L?t:i instanceof me?e(i,r+1,i.tail_node()!==t):i instanceof _?e(i,r+1,!0):i instanceof ne||i instanceof ve||i instanceof fe?t:null}(e,0))===e&&(Q=!0),e);var r,n,i,a=T.parent();if(function(e,r){return r instanceof U?e!==r.init:e instanceof Ie?"="!=e.operator&&D.equivalent_to(e.left):e instanceof de?D instanceof ge&&D.equivalent_to(e.expression):e instanceof w||(e instanceof L?!(e instanceof U):e instanceof J||e instanceof oe||e instanceof z||!V&&e instanceof Ue&&!e.is_declared(t))}(e,a))return Q=!0,e;if(!P&&(r=e,(n=a)instanceof be?ut[n.operator]&&n.left!==r:(n instanceof Se||n instanceof re)&&n.condition!==r)&&(P=a),!Z||e instanceof Ne||!(N&&D.equivalent_to(e)||k&&(i=k(e,this))))return(function(e,r){if(e instanceof de)return!0;if(e instanceof X)return M||D instanceof ge||Ve(D);if(e instanceof Y)return t.option("ie8")&&e.name&&e.name.name in O;if(e instanceof ge)return M||e.expression.may_throw_on_access(t);if(e instanceof Ue)return Be(e,r)?!r||"="!=r.operator||r.left!==e:M&&Ve(e);if(e instanceof ze)return Be(e,r);if(e instanceof fe)return!!e.value&&(e.name.name in O||M&&Ve(e.name));var n=ft(e.left,e);return!(!n||!(n.name in O))||(n instanceof ge||void 0)}(e,a)||q(e))&&(x=e)instanceof j&&(Q=!0),le(e);if(P&&(i||!B||!V))return Q=!0,e;if(ft(e,a))return S&&$++,e;if($++,S&&b instanceof fe)return e;if(h=Q=!0,t.info("Collapsing {name} [{file}:{line},{col}]",{name:e.print_to_string(),file:e.start.file,line:e.start.line,col:e.start.col}),b instanceof Ce)return o(Ee,b,b);if(b instanceof fe){var s=b.name.definition();return s.references.length-s.replaced!=1||t.exposed(s)?o(Ie,b,{operator:"=",left:o(Ue,b.name,b.name),right:b.value}):(s.replaced++,I(t,a,e,b.value))}return b.write_only=!1,b}),(function(e){Q||(x===e&&(Q=!0),P===e&&(P=null))})),y=new Ot((function(e){return Q?e:K?e instanceof Ue&&e.name==ie.name?(--$||(Q=!0),ft(e,y.parent())?e:(ie.replaced++,S.replaced--,b.value.clone())):e instanceof ae||e instanceof j?e:void 0:e!==E[C]?e:++C<E.length?void 0:(K=!0,e)}));0<=--g;){0==g&&t.option("unused")&&ce();var E=[];for(he(e[g]);0<m.length;){E=m.pop();var C=0,b=E[E.length-1],S=null,x=null,P=null,D=pe(b),A=b instanceof Ie&&"="==b.operator&&b.right,M=D&&D.has_side_effects(t),N=D&&!M&&!a(D),k=A&&we(A);if(N||k){var O=Ae(b),B=(d=void 0,(d=Me(f=D))instanceof Ue&&d.definition().scope===c&&!(i&&(d.name in O&&O[d.name]!==f||b instanceof ve||b instanceof Ie&&"="!=b.operator)));M||(M=ke(b));var V=Fe(),q=b.may_throw(t)?s?function(e){return e.has_side_effects(t)}:He:u,W=b.name instanceof Oe,K=W,Q=!1,$=0,Z=!l||!K;if(!Z){for(var ee=t.self().argnames.lastIndexOf(b.name)+1;!Q&&ee<l.length;ee++)l[ee].transform(T);Z=!0}for(var te=g;!Q&&te<e.length;te++)e[te].transform(T);if(S){var ie=b.name.definition();if(Q&&ie.references.length-ie.replaced>$)$=!1;else{for(Q=!1,C=0,K=W,te=g;!Q&&te<e.length;te++)e[te].transform(y);S.single_use=!1}}$&&!Re(b)&&e.splice(g,1)}}}function le(e){if(e instanceof j)return e;if(e instanceof ne){e.expression=e.expression.transform(T);for(var t=0,r=e.body.length;!Q&&t<r;t++){var n=e.body[t];if(n instanceof se){if(!K){if(n!==E[C])continue;C++}if(n.expression=n.expression.transform(T),!V)break}}return Q=!0,e}}function ce(){var e,r=t.self();if(r instanceof Y&&!r.name&&!r.uses_arguments&&!r.pinned()&&(e=t.parent())instanceof de&&e.expression===r){var i=t.has_directive("use strict");i&&!n(i,r.body)&&(i=!1);var a=r.argnames.length;l=e.args.slice(a);for(var s=Object.create(null),u=a;0<=--u;){var h=r.argnames[u],f=e.args[u];l.unshift(o(fe,h,{name:h,value:f})),h.name in s||(s[h.name]=!0,f?f instanceof G&&f.pinned()?f=null:f.walk(new rt((function(e){if(!f)return!0;if(e instanceof Ue&&r.variables.has(e.name)){var t=e.definition().scope;if(t!==c)for(;t=t.parent_scope;)if(t===c)return!0;f=null}return e instanceof ze&&(i||!this.find_parent(j))?!(f=null):void 0}))):f=o(Xe,h).transform(t),f&&m.unshift([o(fe,h,{name:h,value:f})]))}}}function he(e){if(E.push(e),e instanceof Ie)m.push(E.slice()),he(e.right);else if(e instanceof be)he(e.left),he(e.right);else if(e instanceof de)he(e.expression),e.args.forEach(he);else if(e instanceof se)he(e.expression);else if(e instanceof Se)he(e.condition),he(e.consequent),he(e.alternative);else if(e instanceof ue)e.definitions.forEach(he);else if(e instanceof F)he(e.condition),e.body instanceof R||he(e.body);else if(e instanceof X)e.value&&he(e.value);else if(e instanceof U)e.init&&he(e.init),e.condition&&he(e.condition),e.step&&he(e.step),e.body instanceof R||he(e.body);else if(e instanceof H)he(e.object),e.body instanceof R||he(e.body);else if(e instanceof re)he(e.condition),e.body instanceof R||he(e.body),!e.alternative||e.alternative instanceof R||he(e.alternative);else if(e instanceof me)e.expressions.forEach(he);else if(e instanceof _)he(e.body);else if(e instanceof ne)he(e.expression),e.body.forEach(he);else if(e instanceof ve)"++"==e.operator||"--"==e.operator?m.push(E.slice()):he(e.expression);else if(e instanceof fe&&e.value){var t=e.name.definition();t.references.length>t.replaced&&m.push(E.slice()),he(e.value)}E.pop()}function pe(e){if(!(e instanceof fe))return e[e instanceof Ie?"left":"expression"];var r=e.name.definition();if(n(e.name,r.orig)){var i=r.references.length-r.replaced;return 1<r.orig.length-r.eliminated&&!(e.name instanceof Oe)||(1<i?function(e){var t=e.value;if(t instanceof Ue&&"arguments"!=t.name){var r=t.definition();if(!r.undeclared)return S=r}}(e):!t.exposed(r))?o(Ue,e.name,e.name):void 0}}function we(e){if(e instanceof Ue){var r=e.evaluate(t);return r===e?De:_e(r,De)}if(e instanceof ze)return De;if(e.is_truthy())return _e(!0,u);if(e.is_constant())return _e(e.evaluate(t),De);if(!(D instanceof Ue))return!1;if(!function e(r){return!(r instanceof xe)&&(r instanceof be&&ut[r.operator]?e(r.left)&&e(r.right):!(r instanceof de)&&(r instanceof Se?e(r.consequent)&&e(r.alternative):!(r instanceof Pe||r.has_side_effects(t))))}(e))return!1;var n,i=D.definition();return e.walk(new rt((function(e){if(n)return!0;e instanceof Ue&&e.definition()===i&&(n=!0)}))),!n&&De}function De(e){return A.equivalent_to(e)}function _e(e,r){return function(n,i){if(i.in_boolean_context()){if(e&&n.is_truthy()&&!n.has_side_effects(t))return!0;if(n.is_constant())return!n.evaluate(t)==!e}return r(n)}}function Ae(e){var n=Object.create(null);b instanceof fe&&(n[b.name.name]=D);var i=new rt((function(e){var a=Me(e);(a instanceof Ue||a instanceof ze)&&(n[a.name]=n[a.name]||r(t,i,e,e,0))}));return e.walk(i),n}function Re(r){if(r.name instanceof Oe){var n=t.self().argnames.indexOf(r.name),i=t.parent().args;return i[n]&&(i[n]=o(Ge,i[n],{value:0})),!0}var a=!1;return e[g].transform(new Ot((function(e,t,n){return a?e:e===r||e.body===r?(a=!0,e instanceof fe?(e.value=null,e):n?p.skip:null):void 0}),(function(e){if(e instanceof me)switch(e.expressions.length){case 0:return null;case 1:return e.expressions[0]}})))}function ke(e){return!(e instanceof ve)&&(r=e,r[r instanceof Ie?"right":"value"]).has_side_effects(t);var r}function Fe(){if(M)return!1;if(S)return!0;if(D instanceof Ue){var e=D.definition();if(e.references.length-e.replaced==(b instanceof fe?1:2))return!0}return!1}function Be(e,t){var r=O[e.name];if(r)return r!==D?!(t instanceof de):void(k=!1)}function Ve(e){var t=e.definition();return!(1==t.orig.length&&t.orig[0]instanceof Le||t.scope===c&&v(t.references,(function(e){return e.scope.resolve()===c})))}function He(e,t){if(e instanceof Ie)return He(e.left,!0);if(e instanceof ve)return He(e.expression,!0);if(e instanceof fe)return e.value&&He(e.value);if(t){if(e instanceof Te)return He(e.expression,!0);if(e instanceof ye)return He(e.expression,!0);if(e instanceof Ue)return e.definition().scope!==c}return!1}}function m(e){for(var t=[],r=0;r<e.length;){var n=e[r];n instanceof M?(h=!0,m(n.body),[].splice.apply(e,[r,1].concat(n.body)),r+=n.body.length):n instanceof N?(h=!0,e.splice(r,1)):n instanceof D?t.indexOf(n.value)<0?(r++,t.push(n.value)):(h=!0,e.splice(r,1)):r++}}function g(e,t){for(var r=t.self(),n=function(e){for(var t=0,r=e.length;0<=--r;){var n=e[r];if(n instanceof re&&n.body instanceof $&&1<++t)return!0}return!1}(e),i=r instanceof G,a=e.length;0<=--a;){var s=e[a],l=C(a),c=e[l];if(i&&!c&&s instanceof $){if(!s.value){h=!0,e.splice(a,1);continue}if(s.value instanceof Ee&&"void"==s.value.operator){h=!0,e[a]=o(_,s,{body:s.value.expression});continue}}if(s instanceof re){var u;if(g(u=Et(s.body))){u.label&&T(u.label.thedef.references,u),h=!0,(s=s.clone()).condition=s.condition.negate(t);var f=v(s.body,u);s.body=o(M,s,{body:Z(s.alternative).concat(y())}),s.alternative=o(M,s,{body:f}),e[a]=s.transform(t);continue}if(u&&!s.alternative&&s.body instanceof M&&c instanceof Q){var d=s.condition.negate(t);if(d.print_to_string().length<=s.condition.print_to_string().length){h=!0,(s=s.clone()).condition=d,e[l]=s.body,s.body=c,e[a]=s.transform(t);continue}}if(g(u=Et(s.alternative))){u.label&&T(u.label.thedef.references,u),h=!0,(s=s.clone()).body=o(M,s.body,{body:Z(s.body).concat(y())}),f=v(s.alternative,u),s.alternative=o(M,s.alternative,{body:f}),e[a]=s.transform(t);continue}}if(s instanceof re&&s.body instanceof $){var p=s.body.value;if(!p&&!s.alternative&&(i&&!c||c instanceof $&&!c.value)){h=!0,e[a]=o(_,s.condition,{body:s.condition});continue}if(p&&!s.alternative&&c instanceof $&&c.value){h=!0,(s=s.clone()).alternative=c,e.splice(a,1,s.transform(t)),e.splice(l,1);continue}if(p&&!s.alternative&&(!c&&i&&n||c instanceof $)){h=!0,(s=s.clone()).alternative=c||o($,s,{value:null}),e.splice(a,1,s.transform(t)),c&&e.splice(l,1);continue}var m=e[b(a)];if(t.option("sequences")&&i&&!s.alternative&&m instanceof re&&m.body instanceof $&&C(l)==e.length&&c instanceof _){h=!0,(s=s.clone()).alternative=o(M,c,{body:[c,o($,c,{value:null})]}),e.splice(a,1,s.transform(t)),e.splice(l,1);continue}}}function g(e){if(!e)return!1;var n,a=e instanceof J?t.loopcontrol_target(e):null;return e instanceof $&&i&&(!(n=e.value)||n instanceof Ee&&"void"==n.operator)||e instanceof te&&r===Ae(a)||e instanceof ee&&a instanceof M&&r===a}function y(){var t=e.slice(a+1);return e.length=a+1,t.filter((function(t){return!(t instanceof K&&(e.push(t),1))}))}function v(e,t){var r=Z(e).slice(0,-1);return t.value&&r.push(o(_,t.value,{body:t.value.expression})),r}function C(t){for(var r=t+1,n=e.length;r<n;r++){var i=e[r];if(!(i instanceof he&&E(i)))break}return r}function b(t){for(var r=t;0<=--r;){var n=e[r];if(!(n instanceof he&&E(n)))break}return r}}function y(e,t){for(var r,n=t.self(),i=0,a=0,s=e.length;i<s;i++){var o=e[i];if(o instanceof J){var l=t.loopcontrol_target(o);o instanceof ee&&!(l instanceof L)&&Ae(l)===n||o instanceof te&&Ae(l)===n?o.label&&T(o.label.thedef.references,o):e[a++]=o}else e[a++]=o;if(Et(o)){r=e.slice(i+1);break}}e.length=a,h=a!=s,r&&r.forEach((function(r){ot(t,r,e)}))}function E(e){return v(e.definitions,(function(e){return!e.value}))}function C(e,t){if(!(e.length<2)){for(var r=[],n=0,i=0,a=e.length;i<a;i++){var s=e[i];if(s instanceof _){r.length>=t.sequences_limit&&u();var c=s.body;0<r.length&&(c=c.drop_side_effect_free(t)),c&&k(r,c)}else s instanceof ue&&E(s)||s instanceof K||u(),e[n++]=s}u(),(e.length=n)!=a&&(h=!0)}function u(){if(r.length){var t=l(r[0],r);e[n++]=o(_,t,{body:t}),r=[]}}}function b(e,t){if(!(e instanceof M))return e;for(var r=null,n=0,i=e.body.length;n<i;n++){var a=e.body[n];if(a instanceof he&&E(a))t.push(a);else{if(r)return!1;r=a}}return r}function S(e,t){function r(e){i--,h=!0;var r=n.body;return l(r,[r,e]).transform(t)}for(var n,i=0,a=0;a<e.length;a++){var s=e[a];if(n)if(s instanceof X)s.value=r(s.value||o(Xe,s).transform(t));else if(s instanceof U){if(!(s.init instanceof ue)){var c=!1;n.body.walk(new rt((function(e){return!!(c||e instanceof j)||(e instanceof be&&"in"==e.operator?c=!0:void 0)}))),c||(s.init?s.init=r(s.init):(s.init=n.body,i--,h=!0))}}else s instanceof H?s.object=r(s.object):s instanceof re?s.condition=r(s.condition):(s instanceof ne||s instanceof z)&&(s.expression=r(s.expression));if(t.option("conditionals")&&s instanceof re){var u=[],f=b(s.body,u),d=b(s.alternative,u);if(!1!==f&&!1!==d&&0<u.length){var p=u.length;u.push(o(re,s,{condition:s.condition,body:f||o(N,s.body),alternative:d})),u.unshift(i,1),[].splice.apply(e,u),a+=p,i+=p+1,h=!(n=null);continue}}e[i++]=s,n=s instanceof _?s:null}e.length=i}function P(e,t){var r;if(t instanceof Ie?r=[t]:t instanceof me&&(r=t.expressions.slice()),r){if(e instanceof ue){var n=e.definitions[e.definitions.length-1];if(A(n.name,n.value,r))return r}for(var i=r.length-1;0<=--i;){var a=r[i];if(a instanceof Ie&&"="==a.operator&&a.left instanceof Ue){var s=r.slice(i+1);if(A(a.left,a.right,s))return r.slice(0,i+1).concat(s)}}}}function A(e,r,n){if(r instanceof Pe){var i=!1;do{var a=n[0];if(!(a instanceof Ie))break;if("="!=a.operator)break;if(!(a.left instanceof ge))break;var s=a.left.expression;if(!(s instanceof Ue))break;if(e.name!=s.name)break;if(!a.right.is_constant_expression(c))break;var l=a.left.property;if(l instanceof x&&(l=l.evaluate(t)),l instanceof x)break;l=""+l;var u=t.has_directive("use strict")?function(e){return e.key!=l&&e.key.name!=l}:function(e){return e.key.name!=l};if(!v(r.properties,u))break;r.properties.push(o(De,a,{key:l,value:a.right})),n.shift(),i=!0}while(n.length);return i}}function O(e){for(var t,r=0,n=-1,i=e.length;r<i;r++){var a=e[r],s=e[n];if(a instanceof ue)s&&s.TYPE==a.TYPE?(s.definitions=s.definitions.concat(a.definitions),h=!0):t&&t.TYPE==a.TYPE&&E(a)?(t.definitions=t.definitions.concat(a.definitions),h=!0):t=e[++n]=a;else if(a instanceof X)a.value=c(a.value);else if(a instanceof U)(o=P(s,a.init))?(h=!0,a.init=o.length?l(a.init,o):null,e[++n]=a):s instanceof he&&(!a.init||a.init.TYPE==s.TYPE)?(a.init&&(s.definitions=s.definitions.concat(a.init.definitions)),a.init=s,e[n]=a,h=!0):t&&a.init&&t.TYPE==a.init.TYPE&&E(a.init)?(t.definitions=t.definitions.concat(a.init.definitions),a.init=null,e[++n]=a,h=!0):e[++n]=a;else if(a instanceof H)a.object=c(a.object);else if(a instanceof re)a.condition=c(a.condition);else if(a instanceof _){var o;if(o=P(s,a.body)){if(h=!0,!o.length)continue;a.body=l(a.body,o)}e[++n]=a}else a instanceof ne||a instanceof z?a.expression=c(a.expression):e[++n]=a}function c(t){e[++n]=a;var r=P(s,t);if(!r)return t;h=!0;var i=t.tail_node();return r[r.length-1]!==i&&r.push(i.left),l(t,r)}e.length=n+1}}function ot(e,t,r){t instanceof K||e.warn("Dropping unreachable code [{file}:{line},{col}]",t.start),t.walk(new rt((function(t){return t instanceof ue?(e.warn("Declarations in unreachable code! [{file}:{line},{col}]",t.start),t.remove_initializers(),r.push(t),!0):t instanceof K?(r.push(t),!0):t instanceof j||void 0})))}function lt(e){return e instanceof je?e.getValue():e instanceof Ee&&"void"==e.operator&&e.expression instanceof je?void 0:e}function ct(e,t){return e.is_undefined||e instanceof Xe||e instanceof Ee&&"void"==e.operator&&!e.expression.has_side_effects(t)}(nt=function(e,t){e.DEFMETHOD("is_truthy",t)})(x,u),nt(xe,h),nt(Ie,(function(){return"="==this.operator&&this.right.is_truthy()})),nt(G,h),nt(Pe,h),nt(We,h),nt(me,(function(){return this.tail_node().is_truthy()})),nt(Ue,(function(){var e=this.fixed_value();return e&&e.is_truthy()})),function(e){function t(e){return/strict/.test(e.option("pure_getters"))}x.DEFMETHOD("may_throw_on_access",(function(e){return!e.option("pure_getters")||this._dot_throw(e)})),e(x,t),e(Ke,h),e(Xe,h),e(je,u),e(xe,u),e(Pe,(function(e){if(!t(e))return!1;for(var r=this.properties.length;0<=--r;)if(this.properties[r].value instanceof W)return!0;return!1})),e(G,u),e(Ce,u),e(Ee,(function(){return"void"==this.operator})),e(be,(function(e){return("&&"==this.operator||"||"==this.operator)&&(this.left._dot_throw(e)||this.right._dot_throw(e))})),e(Ie,(function(e){return"="==this.operator&&this.right._dot_throw(e)})),e(Se,(function(e){return this.consequent._dot_throw(e)||this.alternative._dot_throw(e)})),e(Te,(function(e){if(!t(e))return!1;var r=this.expression;return r instanceof Ue&&(r=r.fixed_value()),!(r instanceof G&&"prototype"==this.property)})),e(me,(function(e){return this.tail_node()._dot_throw(e)})),e(Ue,(function(e){if(this.is_undefined)return!0;if(!t(e))return!1;if(He(this)&&this.is_declared(e))return!1;if(this.is_immutable())return!1;var r=this.fixed_value();return!r||r._dot_throw(e)}))}((function(e,t){e.DEFMETHOD("_dot_throw",t)})),function(e){e(x,u),e(Ie,(function(e){return"="==this.operator&&this.right.is_boolean(e)}));var t=y("in instanceof == != === !== < <= >= >");e(be,(function(e){return t[this.operator]||ut[this.operator]&&this.left.is_boolean(e)&&this.right.is_boolean(e)})),e(Je,h);var r=y("every hasOwnProperty isPrototypeOf propertyIsEnumerable some");e(de,(function(e){if(!e.option("unsafe"))return!1;var t=this.expression;return t instanceof Te&&(r[t.property]||"test"==t.property&&t.expression instanceof We)})),e(Se,(function(e){return this.consequent.is_boolean(e)&&this.alternative.is_boolean(e)})),e(pe,u),e(me,(function(e){return this.tail_node().is_boolean(e)}));var n=y("! delete");e(Ee,(function(){return n[this.operator]}))}((function(e,t){e.DEFMETHOD("is_boolean",t)})),function(e){e(x,u);var t=y("- * / % & | ^ << >> >>>");e(Ie,(function(e){return t[this.operator.slice(0,-1)]||"="==this.operator&&this.right.is_number(e)})),e(be,(function(e){return t[this.operator]||"+"==this.operator&&this.left.is_number(e)&&this.right.is_number(e)}));var r=y(["charCodeAt","getDate","getDay","getFullYear","getHours","getMilliseconds","getMinutes","getMonth","getSeconds","getTime","getTimezoneOffset","getUTCDate","getUTCDay","getUTCFullYear","getUTCHours","getUTCMilliseconds","getUTCMinutes","getUTCMonth","getUTCSeconds","getYear","indexOf","lastIndexOf","localeCompare","push","search","setDate","setFullYear","setHours","setMilliseconds","setMinutes","setMonth","setSeconds","setTime","setUTCDate","setUTCFullYear","setUTCHours","setUTCMilliseconds","setUTCMinutes","setUTCMonth","setUTCSeconds","setYear","toExponential","toFixed","toPrecision"]);e(de,(function(e){if(!e.option("unsafe"))return!1;var t=this.expression;return t instanceof Te&&(r[t.property]||He(t.expression)&&"Math"==t.expression.name)})),e(Se,(function(e){return this.consequent.is_number(e)&&this.alternative.is_number(e)})),e(pe,u),e(Ge,h),e(me,(function(e){return this.tail_node().is_number(e)}));var n=y("+ - ~ ++ --");e(ve,(function(){return n[this.operator]}))}((function(e,t){e.DEFMETHOD("is_number",t)})),(it=function(e,t){e.DEFMETHOD("is_string",t)})(x,u),it(qe,h),it(Ee,(function(){return"typeof"==this.operator})),it(be,(function(e){return"+"==this.operator&&(this.left.is_string(e)||this.right.is_string(e))})),it(Ie,(function(e){return("="==this.operator||"+="==this.operator)&&this.right.is_string(e)})),it(me,(function(e){return this.tail_node().is_string(e)})),it(Se,(function(e){return this.consequent.is_string(e)&&this.alternative.is_string(e)}));var ut=y("&& ||"),ht=y("delete ++ --");function ft(e,t){return t instanceof ve&&ht[t.operator]?t.expression:t instanceof Ie&&t.left===e?e:void 0}function dt(e,t){return e.print_to_string().length>t.print_to_string().length?t:e}function pt(e,t,r){return(b(e)?function(e,t){return dt(o(_,e,{body:e}),o(_,t,{body:t})).body}:dt)(t,r)}function mt(e){for(var t in e)e[t]=y(e[t])}!function(e){function t(e,t){e.warn("global_defs "+t.print_to_string()+" redefined [{file}:{line},{col}]",t.start)}q.DEFMETHOD("resolve_defines",(function(e){return e.option("global_defs")?(this.figure_out_scope({ie8:e.option("ie8")}),this.transform(new Ot((function(r){var n=r._find_defs(e,"");if(n){for(var i,a=0,s=r;(i=this.parent(a++))&&i instanceof ge&&i.expression===s;)s=i;if(!ft(s,i))return n;t(e,r)}})))):this})),e(x,c),e(Te,(function(e,t){return this.expression._find_defs(e,"."+this.property+t)})),e(Ne,(function(e){this.global()&&C(e.option("global_defs"),this.name)&&t(e,this)})),e(Ue,(function(e,t){if(this.global()){var r=e.option("global_defs"),n=this.name+t;return C(r,n)?function e(t,r){if(t instanceof x)return o(t.CTOR,r,t);if(Array.isArray(t))return o(xe,r,{elements:t.map((function(t){return e(t,r)}))});if(t&&"object"==_typeof(t)){var n=[];for(var i in t)C(t,i)&&n.push(o(De,r,{key:i,value:e(t[i],r)}));return o(Pe,r,{properties:n})}return m(t,r)}(r[n],this):void 0}}))}((function(e,t){e.DEFMETHOD("_find_defs",t)}));var gt=["constructor","toString","valueOf"],Tt={Array:["indexOf","join","lastIndexOf","slice"].concat(gt),Boolean:gt,Function:gt,Number:["toExponential","toFixed","toPrecision"].concat(gt),Object:gt,RegExp:["test"].concat(gt),String:["charAt","charCodeAt","concat","indexOf","italics","lastIndexOf","match","replace","search","slice","split","substr","substring","toLowerCase","toUpperCase","trim"].concat(gt)};mt(Tt);var yt={Array:["isArray"],Math:["abs","acos","asin","atan","ceil","cos","exp","floor","log","round","sin","sqrt","tan","atan2","pow","max","min"],Number:["isFinite","isNaN"],Object:["create","getOwnPropertyDescriptor","getOwnPropertyNames","getPrototypeOf","isExtensible","isFrozen","isSealed","keys"],String:["fromCharCode"]};mt(yt),function(e){x.DEFMETHOD("evaluate",(function(e){if(!e.option("evaluate"))return this;var t=[],r=this._eval(e,t,1);return t.forEach((function(e){delete e._eval})),!r||r instanceof RegExp?r:"function"==typeof r||"object"==_typeof(r)?this:r}));var t=y("! ~ - + void");x.DEFMETHOD("is_constant",(function(){return this instanceof je?!(this instanceof We):this instanceof Ee&&this.expression instanceof je&&t[this.operator]})),e(P,(function(){throw new Error(g("Cannot evaluate a statement [{file}:{line},{col}]",this.start))})),e(G,f),e(x,f),e(je,(function(){return this.getValue()})),e(Y,(function(e){if(e.option("unsafe")){var t=function(){};return t.node=this,t.toString=function(){return"function(){}"},t}return this})),e(xe,(function(e,t,r){if(e.option("unsafe")){for(var n=[],i=0,a=this.elements.length;i<a;i++){var s=this.elements[i],o=s._eval(e,t,r);if(s===o)return this;n.push(o)}return n}return this})),e(Pe,(function(e,t,r){if(e.option("unsafe")){for(var n={},i=0,a=this.properties.length;i<a;i++){var s=this.properties[i],o=s.key;if(o instanceof Re)o=o.name;else if(o instanceof x&&(o=o._eval(e,t,r))===s.key)return this;if("function"==typeof Object.prototype[o])return this;if(!(s.value instanceof Y)&&(n[o]=s.value._eval(e,t,r),n[o]===s.value))return this}return n}return this}));var r=y("! typeof void");e(Ee,(function(e,t,n){var i=this.expression;if(e.option("typeofs")&&"typeof"==this.operator&&(i instanceof G||i instanceof Ue&&i.fixed_value()instanceof G))return"function";if(r[this.operator]||n++,(i=i._eval(e,t,n))===this.expression)return this;switch(this.operator){case"!":return!i;case"typeof":return i instanceof RegExp?this:_typeof(i);case"void":return;case"~":return~i;case"-":return-i;case"+":return+i}return this}));var n=y("&& || === !==");e(be,(function(e,t,r){n[this.operator]||r++;var i=this.left._eval(e,t,r);if(i===this.left)return this;var a,s=this.right._eval(e,t,r);if(s===this.right)return this;switch(this.operator){case"&&":a=i&&s;break;case"||":a=i||s;break;case"|":a=i|s;break;case"&":a=i&s;break;case"^":a=i^s;break;case"+":a=i+s;break;case"*":a=i*s;break;case"/":a=i/s;break;case"%":a=i%s;break;case"-":a=i-s;break;case"<<":a=i<<s;break;case">>":a=i>>s;break;case">>>":a=i>>>s;break;case"==":a=i==s;break;case"===":a=i===s;break;case"!=":a=i!=s;break;case"!==":a=i!==s;break;case"<":a=i<s;break;case"<=":a=i<=s;break;case">":a=s<i;break;case">=":a=s<=i;break;default:return this}return isNaN(a)&&e.find_parent(z)?this:a})),e(Se,(function(e,t,r){var n=this.condition._eval(e,t,r);if(n===this.condition)return this;var i=n?this.consequent:this.alternative,a=i._eval(e,t,r);return a===i?this:a})),e(Ue,(function(e,t,r){var n,i=this.fixed_value();if(!i)return this;if(0<=t.indexOf(i))n=i._eval();else{if(this._eval=f,n=i._eval(e,t,r),delete this._eval,n===i)return this;i._eval=function(){return n},t.push(i)}if(n&&"object"==_typeof(n)){var a=this.definition().escaped;if(a&&a<r)return this}return n}));var i={Array:Array,Math:Math,Number:Number,Object:Object,String:String},a={Math:["E","LN10","LN2","LOG2E","LOG10E","PI","SQRT1_2","SQRT2"],Number:["MAX_VALUE","MIN_VALUE","NaN","NEGATIVE_INFINITY","POSITIVE_INFINITY"]};mt(a),e(ge,(function(e,t,r){if(e.option("unsafe")){var n=this.property;if(n instanceof x&&(n=n._eval(e,t,r))===this.property)return this;var s,o=this.expression;if(He(o)){var l=a[o.name];if(!l||!l[n])return this;s=i[o.name]}else{if(!(s=o._eval(e,t,r+1))||s===o||!C(s,n))return this;if("function"==typeof s)switch(n){case"name":return s.node.name?s.node.name.name:"";case"length":return s.node.argnames.length;default:return this}}return s[n]}return this})),e(de,(function(e,t,r){var n=this.expression;if(e.option("unsafe")&&n instanceof ge){var a,s=n.property;if(s instanceof x&&(s=s._eval(e,t,r))===n.property)return this;var o=n.expression;if(He(o)){var l=yt[o.name];if(!l||!l[s])return this;a=i[o.name]}else{if((a=o._eval(e,t,r+1))===o||!a)return this;var c=Tt[a.constructor.name];if(!c||!c[s])return this}for(var u=[],h=0,f=this.args.length;h<f;h++){var d=this.args[h],p=d._eval(e,t,r);if(d===p)return this;u.push(p)}try{return a[s].apply(a,u)}catch(t){e.warn("Error evaluating {code} [{file}:{line},{col}]",{code:this.print_to_string(),file:this.start.file,line:this.start.line,col:this.start.col})}}return this})),e(pe,f)}((function(e,t){e.DEFMETHOD("_eval",t)})),function(e){function t(e){return o(Ee,e,{operator:"!",expression:e})}function r(e,r,n){var i=t(e);if(n){var a=o(_,r,{body:r});return dt(i,a)===a?r:i}return dt(i,r)}e(x,(function(){return t(this)})),e(P,(function(){throw new Error("Cannot negate a statement")})),e(Y,(function(){return t(this)})),e(Ee,(function(){return"!"==this.operator?this.expression:t(this)})),e(me,(function(e){var t=this.expressions.slice();return t.push(t.pop().negate(e)),l(this,t)})),e(Se,(function(e,t){var n=this.clone();return n.consequent=n.consequent.negate(e),n.alternative=n.alternative.negate(e),r(this,n,t)})),e(be,(function(e,n){var i=this.clone(),a=this.operator;if(e.option("unsafe_comps"))switch(a){case"<=":return i.operator=">",i;case"<":return i.operator=">=",i;case">=":return i.operator="<",i;case">":return i.operator="<=",i}switch(a){case"==":return i.operator="!=",i;case"!=":return i.operator="==",i;case"===":return i.operator="!==",i;case"!==":return i.operator="===",i;case"&&":return i.operator="||",i.left=i.left.negate(e,n),i.right=i.right.negate(e),r(this,i,n);case"||":return i.operator="&&",i.left=i.left.negate(e,n),i.right=i.right.negate(e),r(this,i,n)}return t(this)}))}((function(e,t){e.DEFMETHOD("negate",(function(e,r){return t.call(this,e,r)}))}));var vt=y("Boolean decodeURI decodeURIComponent Date encodeURI encodeURIComponent Error escape EvalError isFinite isNaN Number Object parseFloat parseInt RangeError ReferenceError String SyntaxError TypeError unescape URIError");function Et(e){return e&&e.aborts()}de.DEFMETHOD("is_expr_pure",(function(e){if(e.option("unsafe")){var t=this.expression;if(He(t)&&vt[t.name])return!0;if(t instanceof Te&&He(t.expression)){var r=yt[t.expression.name];return r&&r[t.property]}}return this.pure||!e.pure_funcs(this)})),x.DEFMETHOD("is_call_pure",u),Te.DEFMETHOD("is_call_pure",(function(e){if(e.option("unsafe")){var t,r=this.expression;return r instanceof xe?t=Tt.Array:r.is_boolean(e)?t=Tt.Boolean:r.is_number(e)?t=Tt.Number:r instanceof We?t=Tt.RegExp:r.is_string(e)?t=Tt.String:this.may_throw_on_access(e)||(t=Tt.Object),t&&t[this.property]}})),function(e){function t(e,t){for(var r=e.length;0<=--r;)if(e[r].has_side_effects(t))return!0;return!1}e(x,h),e(xe,(function(e){return t(this.elements,e)})),e(Ie,h),e(be,(function(e){return this.left.has_side_effects(e)||this.right.has_side_effects(e)})),e(R,(function(e){return t(this.body,e)})),e(de,(function(e){return!(this.is_expr_pure(e)||this.expression.is_call_pure(e)&&!this.expression.has_side_effects(e))||t(this.args,e)})),e(se,(function(e){return this.expression.has_side_effects(e)||t(this.body,e)})),e(Se,(function(e){return this.condition.has_side_effects(e)||this.consequent.has_side_effects(e)||this.alternative.has_side_effects(e)})),e(je,u),e(ue,(function(e){return t(this.definitions,e)})),e(Te,(function(e){return this.expression.may_throw_on_access(e)||this.expression.has_side_effects(e)})),e(N,u),e(re,(function(e){return this.condition.has_side_effects(e)||this.body&&this.body.has_side_effects(e)||this.alternative&&this.alternative.has_side_effects(e)})),e(O,(function(e){return this.body.has_side_effects(e)})),e(G,u),e(Pe,(function(e){return t(this.properties,e)})),e(we,(function(e){return this.value.has_side_effects(e)})),e(ye,(function(e){return this.expression.may_throw_on_access(e)||this.expression.has_side_effects(e)||this.property.has_side_effects(e)})),e(me,(function(e){return t(this.expressions,e)})),e(_,(function(e){return this.body.has_side_effects(e)})),e(ne,(function(e){return this.expression.has_side_effects(e)||t(this.body,e)})),e(Ne,u),e(Ue,(function(e){return!this.is_declared(e)})),e(ze,u),e(oe,(function(e){return t(this.body,e)||this.bcatch&&this.bcatch.has_side_effects(e)||this.bfinally&&this.bfinally.has_side_effects(e)})),e(ve,(function(e){return ht[this.operator]||this.expression.has_side_effects(e)})),e(fe,(function(e){return this.value}))}((function(e,t){e.DEFMETHOD("has_side_effects",t)})),function(e){function t(e,t){for(var r=e.length;0<=--r;)if(e[r].may_throw(t))return!0;return!1}e(x,h),e(je,u),e(N,u),e(G,u),e(Ne,u),e(ze,u),e(xe,(function(e){return t(this.elements,e)})),e(Ie,(function(e){return!!this.right.may_throw(e)||!(!e.has_directive("use strict")&&"="==this.operator&&this.left instanceof Ue)&&this.left.may_throw(e)})),e(be,(function(e){return this.left.may_throw(e)||this.right.may_throw(e)})),e(R,(function(e){return t(this.body,e)})),e(de,(function(e){return!!t(this.args,e)||!this.is_expr_pure(e)&&(!!this.expression.may_throw(e)||!(this.expression instanceof G)||t(this.expression.body,e))})),e(se,(function(e){return this.expression.may_throw(e)||t(this.body,e)})),e(Se,(function(e){return this.condition.may_throw(e)||this.consequent.may_throw(e)||this.alternative.may_throw(e)})),e(ue,(function(e){return t(this.definitions,e)})),e(Te,(function(e){return this.expression.may_throw_on_access(e)||this.expression.may_throw(e)})),e(re,(function(e){return this.condition.may_throw(e)||this.body&&this.body.may_throw(e)||this.alternative&&this.alternative.may_throw(e)})),e(O,(function(e){return this.body.may_throw(e)})),e(Pe,(function(e){return t(this.properties,e)})),e(we,(function(e){return this.value.may_throw(e)})),e($,(function(e){return this.value&&this.value.may_throw(e)})),e(me,(function(e){return t(this.expressions,e)})),e(_,(function(e){return this.body.may_throw(e)})),e(ye,(function(e){return this.expression.may_throw_on_access(e)||this.expression.may_throw(e)||this.property.may_throw(e)})),e(ne,(function(e){return this.expression.may_throw(e)||t(this.body,e)})),e(Ue,(function(e){return!this.is_declared(e)})),e(oe,(function(e){return this.bcatch?this.bcatch.may_throw(e):t(this.body,e)||this.bfinally&&this.bfinally.may_throw(e)})),e(ve,(function(e){return!("typeof"==this.operator&&this.expression instanceof Ue)&&this.expression.may_throw(e)})),e(fe,(function(e){return!!this.value&&this.value.may_throw(e)}))}((function(e,t){e.DEFMETHOD("may_throw",t)})),function(e){function t(e){for(var t=e.length;0<=--t;)if(!e[t].is_constant_expression())return!1;return!0}e(x,u),e(je,h),e(G,(function(e){var t=this,r=!0;return t.walk(new rt((function(i){if(!r)return!0;if(i instanceof Ue){if(t.inlined)return!(r=!1);var a=i.definition();if(n(a,t.enclosed)&&!t.variables.has(a.name)){if(e){var s=e.find_variable(i);if(a.undeclared?!s:s===a)return r="f",!0}r=!1}return!0}}))),r})),e(ve,(function(){return this.expression.is_constant_expression()})),e(be,(function(){return this.left.is_constant_expression()&&this.right.is_constant_expression()})),e(xe,(function(){return t(this.elements)})),e(Pe,(function(){return t(this.properties)})),e(we,(function(){return this.value.is_constant_expression()}))}((function(e,t){e.DEFMETHOD("is_constant_expression",t)})),function(e){function t(){var e=this.body.length;return 0<e&&Et(this.body[e-1])}e(P,d),e(Q,f),e(M,t),e(ie,t),e(re,(function(){return this.alternative&&Et(this.body)&&Et(this.alternative)&&this}))}((function(e,t){e.DEFMETHOD("aborts",t)}));var Ct=y(["use asm","use strict"]);function bt(e,t){var r=!1,n=new rt((function(t){return!!(r||t instanceof j)||(t instanceof J&&n.loopcontrol_target(t)===e?r=!0:void 0)}));return t instanceof O&&n.push(t),n.push(e),e.body.walk(n),r}e(D,(function(e,t){return!t.option("directives")||Ct[e.value]&&t.has_directive(e.value)===e?e:o(N,e)})),e(w,(function(e,t){return t.option("drop_debugger")?o(N,e):e})),e(O,(function(e,t){return e.body instanceof ee&&t.loopcontrol_target(e.body)===e.body?o(N,e):0==e.label.references.length?e.body:e})),e(R,(function(e,t){return st(e.body,t),e})),e(M,(function(e,t){switch(st(e.body,t),e.body.length){case 1:return e.body[0];case 0:return o(N,e)}return e})),e(G,(function(e,t){return st(e.body,t),t.option("side_effects")&&1==e.body.length&&e.body[0]===t.has_directive("use strict")&&(e.body.length=0),e})),j.DEFMETHOD("drop_unused",(function(e){if(e.option("unused")&&!e.has_directive("use asm")){var t=this;if(!t.pinned()){var r=!(t instanceof q)||e.toplevel.funcs,n=!(t instanceof q)||e.toplevel.vars,i=/keep_assign/.test(e.option("unused"))?u:function(t,r){var n;if(t instanceof Ie&&(t.write_only||"="==t.operator)?n=t.left:t instanceof ve&&t.write_only&&(n=t.expression),!/strict/.test(e.option("pure_getters")))return n instanceof Ue&&n;for(;n instanceof ge&&!n.expression.may_throw_on_access(e);)n instanceof ye&&r.unshift(n.property),n=n.expression;return n instanceof Ue&&v(n.definition().orig,(function(e){return!(e instanceof Fe)}))&&n},a=[],s=Object.create(null),c=Object.create(null),h=Object.create(null),f=Object.create(null);t instanceof q&&e.top_retain&&t.variables.each((function(t){!e.top_retain(t)||t.id in s||(s[t.id]=!0,a.push(t))}));var d=new E,m=new E,g=this,y=new rt((function(i,o){if(i instanceof G&&i.uses_arguments&&!y.has_directive("use strict")&&i.argnames.forEach((function(e){var t=e.definition();t.id in s||(s[t.id]=!0,a.push(t))})),i!==t){if(i instanceof K){var l=i.name.definition();return r||g!==t||l.id in s||(s[l.id]=!0,a.push(l)),m.add(l.id,i),!0}return i instanceof Oe&&g===t&&d.add(i.definition().id,i),i instanceof ue&&g===t?(i.definitions.forEach((function(t){var r=t.name.definition();t.name instanceof ke&&d.add(r.id,t),n||r.id in s||(s[r.id]=!0,a.push(r)),t.value&&(m.add(r.id,t.value),t.value.has_side_effects(e)&&t.value.walk(y),r.chained||t.name.fixed_value()!==t.value||(c[r.id]=t))})),!0):w(i,o)}}));t.walk(y),y=new rt(w);for(var C=0;C<a.length;C++){var b=m.get(a[C].id);b&&b.forEach((function(e){e.walk(y)}))}var S=e.option("keep_fnames")?u:e.option("ie8")?function(t){return!e.exposed(t)&&!t.references.length}:function(e){return!(e.id in s)||1<e.orig.length},x=new Ot((function(a,u,h){var f=x.parent();if(n){var m=[];if(P=i(a,m)){var y=(w=P.definition()).id in s,v=null;if(a instanceof Ie?(!y||a.left===P&&w.id in c&&c[w.id]!==a)&&(v=a.right):y||(v=o(Ge,a,{value:0})),v)return m.push(v),I(e,f,a,l(a,m.map((function(e){return e.transform(x)}))))}}if(g===t){if(a instanceof Y&&a.name&&S(a.name.definition())&&(a.name=null),a instanceof G&&!(a instanceof W))for(var E=!e.option("keep_fargs"),C=a.argnames,b=C.length;0<=--b;){var P;(P=C[b]).definition().id in s?E=!1:(P.__unused=!0,E&&(C.pop(),e[P.unreferenced()?"warn":"info"]("Dropping unused function argument {name} [{file}:{line},{col}]",B(P))))}var w;if(r&&a instanceof K&&a!==t&&!((w=a.name.definition()).id in s))return e[a.name.unreferenced()?"warn":"info"]("Dropping unused function {name} [{file}:{line},{col}]",B(a.name)),w.eliminated++,o(N,a);if(a instanceof ue&&!(f instanceof H&&f.init===a)){var D=[],A=[],R=[],k=[];switch(a.definitions.forEach((function(t){t.value&&(t.value=t.value.transform(x));var r=t.name.definition();if(!n||r.id in s){if(t.value&&r.id in c&&c[r.id]!==t&&(t.value=t.value.drop_side_effect_free(e)),t.name instanceof ke){var i=d.get(r.id);if(1<i.length&&(!t.value||r.orig.indexOf(t.name)>r.eliminated)){if(e.warn("Dropping duplicated definition of variable {name} [{file}:{line},{col}]",B(t.name)),t.value){var u=o(Ue,t.name,t.name);r.references.push(u);var h=o(Ie,t,{operator:"=",left:u,right:t.value});c[r.id]===t&&(c[r.id]=h),k.push(h.transform(x))}return T(i,t),void r.eliminated++}}t.value?(0<k.length&&(0<R.length?(k.push(t.value),t.value=l(t.value,k)):D.push(o(_,a,{body:l(a,k)})),k=[]),R.push(t)):A.push(t)}else if(r.orig[0]instanceof Be)(f=t.value&&t.value.drop_side_effect_free(e))&&k.push(f),t.value=null,A.push(t);else{var f;(f=t.value&&t.value.drop_side_effect_free(e))?(e.warn("Side effects in initialization of unused variable {name} [{file}:{line},{col}]",B(t.name)),k.push(f)):e[t.name.unreferenced()?"warn":"info"]("Dropping unused variable {name} [{file}:{line},{col}]",B(t.name)),r.eliminated++}})),(0<A.length||0<R.length)&&(a.definitions=A.concat(R),D.push(a)),0<k.length&&D.push(o(_,a,{body:l(a,k)})),D.length){case 0:return h?p.skip:o(N,a);case 1:return D[0];default:return h?p.splice(D):o(M,a,{body:D})}}if(a instanceof U)return u(a,this),a.init instanceof M&&(L=a.init,a.init=L.body.pop(),L.body.push(a)),a.init instanceof _?a.init=a.init.body:_e(a.init)&&(a.init=null),L?h?p.splice(L.body):L:a;if(a instanceof O&&a.body instanceof U){if(u(a,this),a.body instanceof M){var L=a.body;return a.body=L.body.pop(),L.body.push(a),h?p.splice(L.body):L}return a}if(a instanceof j){var F=g;return u(g=a,this),g=F,a}}function B(e){return{name:e.name,file:e.start.file,line:e.start.line,col:e.start.col}}}));t.transform(x)}}function P(e,t,r){e.id in s||(t&&r?(s[e.id]=!0,a.push(e)):(h[e.id]=t,f[e.id]=r))}function w(e,r){var n,o=[],l=i(e,o);if(l&&t.variables.get(l.name)===(n=l.definition())){if(o.forEach((function(e){e.walk(y)})),e instanceof Ie)if(e.right.walk(y),e.left===l)n.chained||l.fixed_value()!==e.right||(c[n.id]=e),e.write_only||P(n,!0,f[n.id]);else{var u=l.fixed_value();u&&u.is_constant()||P(n,h[n.id],!0)}return!0}if(e instanceof Ue)return(n=e.definition()).id in s||(s[n.id]=!0,a.push(n)),!0;if(e instanceof j){var d=g;return g=e,r(),g=d,!0}}})),j.DEFMETHOD("hoist_declarations",(function(e){if(!e.has_directive("use asm")){var t=e.option("hoist_funs"),r=e.option("hoist_vars"),n=this;if(r){var i=0;n.walk(new rt((function(e){return 1<i||e instanceof j&&e!==n||(e instanceof he?(i++,!0):void 0)}))),i<=1&&(r=!1)}if(t||r){var a=[],s=[],c=new E,u=0,h=new Ot((function(i){if(i!==n){if(i instanceof D)return a.push(i),o(N,i);if(t&&i instanceof K&&(h.parent()===n||!e.has_directive("use strict")))return s.push(i),o(N,i);if(r&&i instanceof he){i.definitions.forEach((function(e){c.set(e.name.name,e),++u}));var l=i.to_assignments(e),f=h.parent();if(f instanceof H&&f.init===i){if(l)return l;var d=i.definitions[0].name;return o(Ue,d,d)}return f instanceof U&&f.init===i?l:l?o(_,i,{body:l}):o(N,i)}return i instanceof j?i:void 0}}));if(n.transform(h),0<u){var f=[];if(c.each((function(e,t){n instanceof G&&!v(n.argnames,(function(e){return e.name!=t}))?c.del(t):((e=e.clone()).value=null,f.push(e),c.set(t,e))})),0<f.length){for(var d=0;d<n.body.length;){if(n.body[d]instanceof _){var p,m,g=n.body[d].body;if(g instanceof Ie&&"="==g.operator&&(p=g.left)instanceof Re&&c.has(p.name)){if((y=c.get(p.name)).value)break;y.value=g.right,T(f,y),f.push(y),n.body.splice(d,1);continue}if(g instanceof me&&(m=g.expressions[0])instanceof Ie&&"="==m.operator&&(p=m.left)instanceof Re&&c.has(p.name)){var y;if((y=c.get(p.name)).value)break;y.value=m.right,T(f,y),f.push(y),n.body[d].body=l(g,g.expressions.slice(1));continue}}if(n.body[d]instanceof N)n.body.splice(d,1);else{if(!(n.body[d]instanceof M))break;var C=[d,1].concat(n.body[d].body);n.body.splice.apply(n.body,C)}}f=o(he,n,{definitions:f}),s.push(f)}}n.body=a.concat(s,n.body)}}})),j.DEFMETHOD("var_names",(function(){var e=this._var_names;return e||(this._var_names=e=Object.create(null),this.enclosed.forEach((function(t){e[t.name]=!0})),this.variables.each((function(t,r){e[r]=!0}))),e})),j.DEFMETHOD("make_var_name",(function(e){for(var t=this.var_names(),r=e=e.replace(/(?:^[^a-z_$]|[^a-z0-9_$])/gi,"_"),n=0;t[r];n++)r=e+"$"+n;return t[r]=!0,r})),j.DEFMETHOD("hoist_properties",(function(e){if(e.option("hoist_props")&&!e.has_directive("use asm")){var t=this,r=t instanceof q&&e.top_retain||u,n=Object.create(null);t.transform(new Ot((function(e,i){if(e instanceof Ie&&"="==e.operator&&e.write_only&&d(e.left,e.right,1)){i(e,this);var a=new E,s=[],c=[];return e.right.properties.forEach((function(r){var n=m(e.left,r.key);c.push(o(fe,e,{name:n,value:null}));var i=o(Ue,e,{name:n.name,scope:t,thedef:n.definition()});i.reference({}),s.push(o(Ie,e,{operator:"=",left:i,right:r.value}))})),n[e.left.definition().id]=a,t.body.splice(t.body.indexOf(this.stack[1])+1,0,o(he,e,{definitions:c})),l(e,s)}if(e instanceof fe&&d(e.name,e.value,0)){i(e,this),a=new E;var u=[];return e.value.properties.forEach((function(t){u.push(o(fe,e,{name:m(e.name,t.key),value:t.value}))})),n[e.name.definition().id]=a,p.splice(u)}if(e instanceof ge&&e.expression instanceof Ue&&(a=n[e.expression.definition().id])){var h=a.get(lt(e.property)),f=o(Ue,e,{name:h.name,scope:e.expression.scope,thedef:h});return f.reference({}),f}function d(e,n,i){if(e.scope===t){var a=e.definition();if(a.assignments==i&&!a.direct_access&&1!=a.escaped&&a.references.length!=i&&!a.single_use&&!r(a)&&e.fixed_value()===n)return n instanceof Pe}}function m(e,r){var n=o(ke,e,{name:t.make_var_name(e.name+"_"+r),scope:t}),i=t.def_variable(n);return a.set(r,i),t.enclosed.push(i),n}})))}})),function(e){function t(e,t,r){var n=e.length;if(!n)return null;for(var i=[],a=!1,s=0;s<n;s++){var o=e[s].drop_side_effect_free(t,r);a|=o!==e[s],o&&(i.push(o),r=!1)}return a?i.length?i:null:e}e(x,f),e(W,d),e(xe,(function(e,r){var n=t(this.elements,e,r);return n&&l(this,n)})),e(Ie,(function(e){var t=this.left;return t.has_side_effects(e)||e.has_directive("use strict")&&t instanceof ge&&t.expression.is_constant()?this:(this.write_only=!0,Me(t).is_constant_expression(e.find_parent(j))?this.right.drop_side_effect_free(e):this)})),e(be,(function(e,t){var r=this.right.drop_side_effect_free(e);if(!r)return this.left.drop_side_effect_free(e,t);if(ut[this.operator]){if(r===this.right)return this;var n=this.clone();return n.right=r,n}var i=this.left.drop_side_effect_free(e,t);return i?l(this,[i,r]):this.right.drop_side_effect_free(e,t)})),e(de,(function(e,r){if(!this.is_expr_pure(e)){if(this.expression.is_call_pure(e)){var n=this.args.slice();return n.unshift(this.expression.expression),(n=t(n,e,r))&&l(this,n)}if(!(this.expression instanceof Y)||this.expression.name&&this.expression.name.definition().references.length)return this;var i=this.clone(),a=i.expression;return a.process_expression(!1,e),a.walk(new rt((function(t){return t instanceof $&&t.value?(t.value=t.value.drop_side_effect_free(e),!0):t instanceof j&&t!==a||void 0}))),i}this.pure&&e.warn("Dropping __PURE__ call [{file}:{line},{col}]",this.start);var s=t(this.args,e,r);return s&&l(this,s)})),e(Se,(function(e){var t=this.consequent.drop_side_effect_free(e),r=this.alternative.drop_side_effect_free(e);if(t===this.consequent&&r===this.alternative)return this;if(!t)return r?o(be,this,{operator:"||",left:this.condition,right:r}):this.condition.drop_side_effect_free(e);if(!r)return o(be,this,{operator:"&&",left:this.condition,right:t});var n=this.clone();return n.consequent=t,n.alternative=r,n})),e(je,d),e(Te,(function(e,t){return this.expression.may_throw_on_access(e)?this:this.expression.drop_side_effect_free(e,t)})),e(Y,(function(e){return this.name&&e.option("ie8")?this:null})),e(ve,(function(e,t){if(ht[this.operator])return this.write_only=!this.expression.has_side_effects(e),this;if("typeof"==this.operator&&this.expression instanceof Ue)return null;var r=this.expression.drop_side_effect_free(e,t);return t&&r&&Ve(r)?r===this.expression&&"!"==this.operator?this:r.negate(e,t):r})),e(Pe,(function(e,r){var n=t(this.properties,e,r);return n&&l(this,n)})),e(we,(function(e,t){return this.value.drop_side_effect_free(e,t)})),e(me,(function(e){var t=this.tail_node(),r=t.drop_side_effect_free(e);if(r===t)return this;var n=this.expressions.slice(0,-1);return r&&n.push(r),l(this,n)})),e(ye,(function(e,t){if(this.expression.may_throw_on_access(e))return this;var r=this.expression.drop_side_effect_free(e,t);if(!r)return this.property.drop_side_effect_free(e,t);var n=this.property.drop_side_effect_free(e);return n?l(this,[r,n]):r})),e(Ue,(function(e){return this.is_declared(e)?null:this})),e(ze,d)}((function(e,t){e.DEFMETHOD("drop_side_effect_free",t)})),e(_,(function(e,t){if(t.option("side_effects")){var r=e.body,n=r.drop_side_effect_free(t,!0);if(!n)return t.warn("Dropping side-effect-free statement [{file}:{line},{col}]",e.start),o(N,e);if(n!==r)return o(_,e,{body:n})}return e})),e(V,(function(e,t){return t.option("loops")?o(U,e,e).optimize(t):e})),e(B,(function(e,t){if(!t.option("loops"))return e;var r=e.condition.is_truthy()||e.condition.tail_node().evaluate(t);if(!(r instanceof x)){if(r)return o(U,e,{body:o(M,e.body,{body:[e.body,o(_,e.condition,{body:e.condition})]})}).optimize(t);if(!bt(e,t.parent()))return o(M,e.body,{body:[e.body,o(_,e.condition,{body:e.condition})]}).optimize(t)}return e.body instanceof _?o(U,e,{condition:l(e.condition,[e.body.body,e.condition]),body:o(N,e)}).optimize(t):e})),e(U,(function(e,t){if(!t.option("loops"))return e;if(t.option("side_effects")&&e.init&&(e.init=e.init.drop_side_effect_free(t)),e.condition){var r=e.condition.evaluate(t);if(!(r instanceof x))if(r)e.condition=null;else if(!t.option("dead_code")){var n=e.condition;e.condition=m(r,e.condition),e.condition=dt(e.condition.transform(t),n)}if(r instanceof x&&(r=e.condition.is_truthy()||e.condition.tail_node().evaluate(t)),r)!e.condition||r instanceof x||(e.body=o(M,e.body,{body:[o(_,e.condition,{body:e.condition}),e.body]}),e.condition=null);else if(t.option("dead_code")){var i=[];return ot(t,e.body,i),e.init instanceof P?i.push(e.init):e.init&&i.push(o(_,e.init,{body:e.init})),i.push(o(_,e.condition,{body:e.condition})),o(M,e,{body:i}).optimize(t)}}return function e(t,r){var n=t.body instanceof M?t.body.body[0]:t.body;if(r.option("dead_code")&&a(n)){var i=[];return t.init instanceof P?i.push(t.init):t.init&&i.push(o(_,t.init,{body:t.init})),t.condition&&i.push(o(_,t.condition,{body:t.condition})),ot(r,t.body,i),o(M,t,{body:i})}return n instanceof re&&(a(n.body)?(t.condition?t.condition=o(be,t.condition,{left:t.condition,operator:"&&",right:n.condition.negate(r)}):t.condition=n.condition.negate(r),s(n.alternative)):a(n.alternative)&&(t.condition?t.condition=o(be,t.condition,{left:t.condition,operator:"&&",right:n.condition}):t.condition=n.condition,s(n.body))),t;function a(e){return e instanceof ee&&r.loopcontrol_target(e)===r.self()}function s(n){n=Z(n),t.body instanceof M?(t.body=t.body.clone(),t.body.body=n.concat(t.body.body.slice(1)),t.body=t.body.transform(r)):t.body=o(M,t.body,{body:n}).transform(r),t=e(t,r)}}(e,t)})),e(re,(function(e,t){if(_e(e.alternative)&&(e.alternative=null),!t.option("conditionals"))return e;var r=e.condition.evaluate(t);if(!(t.option("dead_code")||r instanceof x)){var n=e.condition;e.condition=m(r,n),e.condition=dt(e.condition.transform(t),n)}if(t.option("dead_code")){if(r instanceof x&&(r=e.condition.is_truthy()||e.condition.tail_node().evaluate(t)),!r){t.warn("Condition always false [{file}:{line},{col}]",e.condition.start);var i=[];return ot(t,e.body,i),i.push(o(_,e.condition,{body:e.condition})),e.alternative&&i.push(e.alternative),o(M,e,{body:i}).optimize(t)}if(!(r instanceof x))return t.warn("Condition always true [{file}:{line},{col}]",e.condition.start),i=[],e.alternative&&ot(t,e.alternative,i),i.push(o(_,e.condition,{body:e.condition})),i.push(e.body),o(M,e,{body:i}).optimize(t)}var a=e.condition.negate(t),s=e.condition.print_to_string().length,l=a.print_to_string().length,c=l<s;if(e.alternative&&c){c=!1,e.condition=a;var u=e.body;e.body=e.alternative||o(N,e),e.alternative=u}if(_e(e.body)&&_e(e.alternative))return o(_,e.condition,{body:e.condition.clone()}).optimize(t);if(e.body instanceof _&&e.alternative instanceof _)return o(_,e,{body:o(Se,e,{condition:e.condition,consequent:e.body.body,alternative:e.alternative.body})}).optimize(t);if(_e(e.alternative)&&e.body instanceof _)return s===l&&!c&&e.condition instanceof be&&"||"==e.condition.operator&&(c=!0),c?o(_,e,{body:o(be,e,{operator:"||",left:a,right:e.body.body})}).optimize(t):o(_,e,{body:o(be,e,{operator:"&&",left:e.condition,right:e.body.body})}).optimize(t);if(e.body instanceof N&&e.alternative instanceof _)return o(_,e,{body:o(be,e,{operator:"||",left:e.condition,right:e.alternative.body})}).optimize(t);if(e.body instanceof X&&e.alternative instanceof X&&e.body.TYPE==e.alternative.TYPE)return o(e.body.CTOR,e,{value:o(Se,e,{condition:e.condition,consequent:e.body.value||o(Xe,e.body),alternative:e.alternative.value||o(Xe,e.alternative)}).transform(t)}).optimize(t);if(e.body instanceof re&&!e.body.alternative&&!e.alternative&&(e=o(re,e,{condition:o(be,e.condition,{operator:"&&",left:e.condition,right:e.body.condition}),body:e.body.body,alternative:null})),Et(e.body)&&e.alternative){var h=e.alternative;return e.alternative=null,o(M,e,{body:[e,h]}).optimize(t)}return Et(e.alternative)?(i=e.body,e.body=e.alternative,e.condition=c?a:e.condition.negate(t),e.alternative=null,o(M,e,{body:[e,i]}).optimize(t)):e})),e(ne,(function(e,t){if(!t.option("switches"))return e;var r,n=e.expression.evaluate(t);if(!(n instanceof x)){var i=e.expression;e.expression=m(n,i),e.expression=dt(e.expression.transform(t),i)}if(!t.option("dead_code"))return e;n instanceof x&&(n=e.expression.tail_node().evaluate(t));for(var a,s,l=[],c=[],u=0,h=e.body.length;u<h&&!s;u++){if((r=e.body[u])instanceof ae)a?E(r,c[c.length-1]):a=r;else if(!(n instanceof x)){if(!((y=r.expression.evaluate(t))instanceof x)&&y!==n){E(r,c[c.length-1]);continue}if(y instanceof x&&(y=r.expression.tail_node().evaluate(t)),y===n&&(s=r,a)){var f=c.indexOf(a);c.splice(f,1),E(a,c[f-1]),a=null}}if(Et(r)){var d=c[c.length-1];Et(d)&&d.body.length==r.body.length&&o(M,d,d).equivalent_to(o(M,r,r))&&(d.body=[])}c.push(r)}for(;u<h;)E(e.body[u++],c[c.length-1]);for(0<c.length&&(c[0].body=l.concat(c[0].body)),e.body=c;r=c[c.length-1];){var p=r.body[r.body.length-1];if(p instanceof ee&&t.loopcontrol_target(p)===e&&r.body.pop(),r.body.length||r instanceof se&&(a||r.expression.has_side_effects(t)))break;c.pop()===a&&(a=null)}if(0==c.length)return o(M,e,{body:l.concat(o(_,e.expression,{body:e.expression}))}).optimize(t);if(1==c.length&&(c[0]===s||c[0]===a)){var g=!1,T=new rt((function(t){if(g||t instanceof G||t instanceof _)return!0;t instanceof ee&&T.loopcontrol_target(t)===e&&(g=!0)}));if(e.walk(T),!g){var y,v=c[0].body.slice();return(y=c[0].expression)&&v.unshift(o(_,y,{body:y})),v.unshift(o(_,e.expression,{body:e.expression})),o(M,e,{body:v}).optimize(t)}}return e;function E(e,r){r&&!Et(r)?r.body=r.body.concat(e.body):ot(t,e,l)}})),e(oe,(function(e,t){if(st(e.body,t),e.bcatch&&e.bfinally&&v(e.bfinally.body,_e)&&(e.bfinally=null),t.option("dead_code")&&v(e.body,_e)){var r=[];return e.bcatch&&(ot(t,e.bcatch,r),r.forEach((function(e){e instanceof ue&&e.definitions.forEach((function(e){var t=e.name.definition().redefined();t&&(e.name=e.name.clone(),e.name.thedef=t)}))}))),e.bfinally&&(r=r.concat(e.bfinally.body)),o(M,e,{body:r}).optimize(t)}return e})),ue.DEFMETHOD("remove_initializers",(function(){this.definitions.forEach((function(e){e.value=null}))})),ue.DEFMETHOD("to_assignments",(function(e){var t=e.option("reduce_vars"),r=this.definitions.reduce((function(e,r){if(r.value){var n=o(Ue,r.name,r.name);e.push(o(Ie,r,{operator:"=",left:n,right:r.value})),t&&(n.definition().fixed=!1)}return(r=r.name.definition()).eliminated++,r.replaced--,e}),[]);return 0==r.length?null:l(this,r)})),e(ue,(function(e,t){return 0==e.definitions.length?o(N,e):e})),de.DEFMETHOD("lift_sequences",(function(e){if(!e.option("sequences"))return this;var t=this.expression;if(!(t instanceof me))return this;var r=t.tail_node();if(S(e,r)&&!(this instanceof pe))return this;var n=t.expressions.slice(0,-1),i=this.clone();return i.expression=r,n.push(i),l(this,n).optimize(e)})),e(de,(function(e,t){var r=e.lift_sequences(t);if(r!==e)return r;var n=e.expression,i=n;t.option("reduce_vars")&&i instanceof Ue&&(i=i.fixed_value());var a=i instanceof G;if(t.option("unused")&&a&&!i.uses_arguments&&!i.pinned()){for(var s=0,c=0,u=0,h=e.args.length;u<h;u++){var f=u>=i.argnames.length;if(f||i.argnames[u].__unused){if(T=e.args[u].drop_side_effect_free(t))e.args[s++]=T;else if(!f){e.args[s++]=o(Ge,e.args[u],{value:0});continue}}else e.args[s++]=e.args[u];c=s}e.args.length=c}if(t.option("unsafe"))if(He(n))switch(n.name){case"Array":if(1!=e.args.length)return o(xe,e,{elements:e.args}).optimize(t);break;case"Object":if(0==e.args.length)return o(Pe,e,{properties:[]});break;case"String":if(0==e.args.length)return o(qe,e,{value:""});if(e.args.length<=1)return o(be,e,{left:e.args[0],operator:"+",right:o(qe,e,{value:""})}).optimize(t);break;case"Number":if(0==e.args.length)return o(Ge,e,{value:0});if(1==e.args.length)return o(Ee,e,{expression:e.args[0],operator:"+"}).optimize(t);case"Boolean":if(0==e.args.length)return o(et,e);if(1==e.args.length)return o(Ee,e,{expression:o(Ee,e,{expression:e.args[0],operator:"!"}),operator:"!"}).optimize(t);break;case"RegExp":var d=[];if(v(e.args,(function(e){var r=e.evaluate(t);return d.unshift(r),e!==r})))try{return pt(t,e,o(We,e,{value:RegExp.apply(RegExp,d)}))}catch(r){t.warn("Error converting {expr} [{file}:{line},{col}]",{expr:e.print_to_string(),file:e.start.file,line:e.start.line,col:e.start.col})}}else if(n instanceof Te)switch(n.property){case"toString":if(0==e.args.length&&!n.expression.may_throw_on_access(t))return o(be,e,{left:o(qe,e,{value:""}),operator:"+",right:n.expression}).optimize(t);break;case"join":var p;if(n.expression instanceof xe&&!(0<e.args.length&&(p=e.args[0].evaluate(t))===e.args[0])){var g,T,y=[],E=[];return n.expression.elements.forEach((function(r){var n=r.evaluate(t);n!==r?E.push(n):(0<E.length&&(y.push(o(qe,e,{value:E.join(p)})),E.length=0),y.push(r))})),0<E.length&&y.push(o(qe,e,{value:E.join(p)})),0==y.length?o(qe,e,{value:""}):1==y.length?y[0].is_string(t)?y[0]:o(be,y[0],{operator:"+",left:o(qe,e,{value:""}),right:y[0]}):""==p?(g=y[0].is_string(t)||y[1].is_string(t)?y.shift():o(qe,e,{value:""}),y.reduce((function(e,t){return o(be,t,{operator:"+",left:e,right:t})}),g).optimize(t)):((T=e.clone()).expression=T.expression.clone(),T.expression.expression=T.expression.expression.clone(),T.expression.expression.elements=y,pt(t,e,T))}break;case"charAt":if(n.expression.is_string(t)){var C=e.args[0],b=C?C.evaluate(t):0;if(b!==C)return o(ye,n,{expression:n.expression,property:m(0|b,C||n)}).optimize(t)}break;case"apply":if(2==e.args.length&&e.args[1]instanceof xe)return(k=e.args[1].elements.slice()).unshift(e.args[0]),o(de,e,{expression:o(Te,n,{expression:n.expression,property:"call"}),args:k}).optimize(t);break;case"call":var S=n.expression;if(S instanceof Ue&&(S=S.fixed_value()),S instanceof G&&!S.contains_this())return(e.args.length?l(this,[e.args[0],o(de,e,{expression:n.expression,args:e.args.slice(1)})]):o(de,e,{expression:n.expression,args:[]})).optimize(t)}if(t.option("unsafe_Function")&&He(n)&&"Function"==n.name){if(0==e.args.length)return o(Y,e,{argnames:[],body:[]});if(v(e.args,(function(e){return e instanceof qe})))try{var I=kt(D="n(function("+e.args.slice(0,-1).map((function(e){return e.value})).join(",")+"){"+e.args[e.args.length-1].value+"})"),x={ie8:t.option("ie8")};I.figure_out_scope(x);var P,w=new jt(t.options);(I=I.transform(w)).figure_out_scope(x),I.compute_char_frequency(x),I.mangle_names(x),I.walk(new rt((function(e){return!!P||(e instanceof G?(P=e,!0):void 0)})));var D=zt();return M.prototype._codegen.call(P,P,D),e.args=[o(qe,e,{value:P.argnames.map((function(e){return e.print_to_string()})).join(",")}),o(qe,e.args[e.args.length-1],{value:D.get().replace(/^\{|\}$/g,"")})],e}catch(r){if(!(r instanceof It))throw r;t.warn("Error parsing code passed to new Function [{file}:{line},{col}]",e.args[e.args.length-1].start),t.warn(r.toString())}}var A=a&&i.body[0],R=t.option("inline")&&!e.is_expr_pure(t);if(R&&A instanceof $&&(!(F=A.value)||F.is_constant_expression())){F=F?F.clone(!0):o(Xe,e);var k=e.args.concat(F);return l(e,k).optimize(t)}if(a){var O,F,B,V,U=-1;if(R&&!i.uses_arguments&&!i.pinned()&&!(i.name&&i instanceof Y)&&(F=function(e){var r=i.body.length;if(t.option("inline")<3)return 1==r&&W(e);e=null;for(var n=0;n<r;n++){var a=i.body[n];if(a instanceof he){if(e&&!v(a.definitions,(function(e){return!e.value})))return!1}else{if(a instanceof N)continue;if(e)return!1;e=a}}return W(e)}(A))&&(n===i||t.option("unused")&&1==(O=n.definition()).references.length&&!Pt(t,O)&&i.is_constant_expression(n.scope))&&!e.pure&&!i.contains_this()&&function(){var e=Object.create(null);do{if((B=t.parent(++U))instanceof le)e[B.argname.name]=!0;else if(B instanceof L)V=[];else if(B instanceof Ue&&B.fixed_value()instanceof j)return!1}while(!(B instanceof j));var r=!(B instanceof q)||t.toplevel.vars,n=t.option("inline");return!(!function(e,t){for(var r=i.body.length,n=0;n<r;n++){var a=i.body[n];if(a instanceof he){if(!t)return!1;for(var s=a.definitions.length;0<=--s;){var o=a.definitions[s].name;if(e[o.name]||at[o.name]||B.var_names()[o.name])return!1;V&&V.push(o.definition())}}}return!0}(e,3<=n&&r)||!function(e,t){for(var r=0,n=i.argnames.length;r<n;r++){var a=i.argnames[r];if(!a.__unused){if(!t||e[a.name]||at[a.name]||B.var_names()[a.name])return!1;V&&V.push(a.definition())}}return!0}(e,2<=n&&r)||V&&0!=V.length&&Dt(i,V))}())return i._squeezed=!0,l(e,function(){var r=[],n=[];return function(t,r){for(var n=i.argnames.length,a=e.args.length;--a>=n;)r.push(e.args[a]);for(a=n;0<=--a;){var s=i.argnames[a],l=e.args[a];if(s.__unused||B.var_names()[s.name])l&&r.push(l);else{var c=o(ke,s,s);s.definition().orig.push(c),!l&&V&&(l=o(Xe,e)),K(t,r,c,l)}}t.reverse(),r.reverse()}(r,n),function(e,t){for(var r=t.length,n=0,a=i.body.length;n<a;n++){var s=i.body[n];if(s instanceof he)for(var l=0,c=s.definitions.length;l<c;l++){var u=s.definitions[l],h=u.name,f=h.definition().redefined();if(f&&((h=h.clone()).thedef=f),K(e,t,h,u.value),V&&v(i.argnames,(function(e){return e.name!=h.name}))){var d=i.variables.get(h.name),p=o(Ue,h,h);d.references.push(p),t.splice(r++,0,o(Ie,u,{operator:"=",left:p,right:o(Xe,h)}))}}}}(r,n),n.push(F),r.length&&(u=B.body.indexOf(t.parent(U-1))+1,B.body.splice(u,0,o(he,i,{definitions:r}))),n}()).optimize(t);if(t.option("side_effects")&&v(i.body,_e))return k=e.args.concat(o(Xe,e)),l(e,k).optimize(t)}if(t.option("drop_console")&&n instanceof ge){for(var H=n.expression;H.expression;)H=H.expression;if(He(H)&&"console"==H.name)return o(Xe,e).optimize(t)}if(t.option("negate_iife")&&t.parent()instanceof _&&Ve(e))return e.negate(t,!0);var z=e.evaluate(t);return z!==e?(z=m(z,e).optimize(t),pt(t,z,e)):e;function W(t){return t?t instanceof $?t.value?t.value.clone(!0):o(Xe,e):t instanceof _?o(Ee,t,{operator:"void",expression:t.body.clone(!0)}):void 0:o(Xe,e)}function K(t,r,n,i){var a=n.definition();B.variables.set(n.name,a),B.enclosed.push(a),B.var_names()[n.name]||(B.var_names()[n.name]=!0,t.push(o(fe,n,{name:n,value:null})));var s=o(Ue,n,n);a.references.push(s),i&&r.push(o(Ie,e,{operator:"=",left:s,right:i}))}})),e(pe,(function(e,t){var r=e.lift_sequences(t);if(r!==e)return r;if(t.option("unsafe")){var n=e.expression;if(He(n))switch(n.name){case"Object":case"RegExp":case"Function":case"Error":case"Array":return o(de,e,e).transform(t)}}return e})),e(me,(function(e,t){if(!t.option("side_effects"))return e;var r,n,i=[];r=b(t),n=e.expressions.length-1,e.expressions.forEach((function(e,a){a<n&&(e=e.drop_side_effect_free(t,r)),e&&(k(i,e),r=!1)}));var a=i.length-1;return function(){for(;0<a&&ct(i[a],t);)a--;a<i.length-1&&(i[a]=o(Ee,e,{operator:"void",expression:i[a]}),i.length=a+1)}(),0==a?(e=I(t,t.parent(),t.self(),i[0]))instanceof me||(e=e.optimize(t)):e.expressions=i,e})),ve.DEFMETHOD("lift_sequences",(function(e){if(e.option("sequences")&&this.expression instanceof me){var t=this.expression.expressions.slice(),r=this.clone();return r.expression=t.pop(),t.push(r),l(this,t).optimize(e)}return this})),e(Ce,(function(e,t){return e.lift_sequences(t)})),e(Ee,(function(e,t){var r,n=e.expression;if("delete"==e.operator&&!(n instanceof Ue||n instanceof ge||(r=n)instanceof Ze||r instanceof Qe||r instanceof Xe))return n instanceof me?((n=n.expressions.slice()).push(o(tt,e)),l(e,n).optimize(t)):l(e,[n,o(tt,e)]).optimize(t);var i=e.lift_sequences(t);if(i!==e)return i;if(t.option("side_effects")&&"void"==e.operator)return(n=n.drop_side_effect_free(t))?(e.expression=n,e):o(Xe,e).optimize(t);if(t.option("booleans")){if("!"==e.operator&&n.is_truthy())return l(e,[n,o(et,e)]).optimize(t);if(t.in_boolean_context())switch(e.operator){case"!":if(n instanceof Ee&&"!"==n.operator)return n.expression;n instanceof be&&(e=pt(t,e,n.negate(t,b(t))));break;case"typeof":return t.warn("Boolean expression always true [{file}:{line},{col}]",e.start),(n instanceof Ue?o(tt,e):l(e,[n,o(tt,e)])).optimize(t)}}if("-"==e.operator&&n instanceof Ze&&(n=n.transform(t)),n instanceof be&&("+"==e.operator||"-"==e.operator)&&("*"==n.operator||"/"==n.operator||"%"==n.operator))return o(be,e,{operator:n.operator,left:o(Ee,n.left,{operator:e.operator,expression:n.left}),right:n.right});if("-"!=e.operator||!(n instanceof Ge||n instanceof Ze)){var a=e.evaluate(t);if(a!==e)return pt(t,a=m(a,e).optimize(t),e)}return e})),be.DEFMETHOD("lift_sequences",(function(e){if(e.option("sequences")){if(this.left instanceof me){var t=this.left.expressions.slice();return(r=this.clone()).left=t.pop(),t.push(r),l(this,t).optimize(e)}if(this.right instanceof me&&!this.left.has_side_effects(e)){for(var r,n="="==this.operator&&this.left instanceof Ue,i=(t=this.right.expressions).length-1,a=0;a<i&&(n||!t[a].has_side_effects(e));a++);if(a==i)return t=t.slice(),(r=this.clone()).right=t.pop(),t.push(r),l(this,t).optimize(e);if(0<a)return(r=this.clone()).right=l(this.right,t.slice(a)),(t=t.slice(0,a)).push(r),l(this,t).optimize(e)}}return this}));var xt=y("== === != !== * & | ^");function Pt(e,t){for(var r,n=0;r=e.parent(n);n++)if(r instanceof G){var i=r.name;if(i&&i.definition()===t)break}return r}function wt(e,t){return e instanceof Ue||e.TYPE===t.TYPE}function Dt(e,t){var r=!1,i=new rt((function(e){return!!r||(e instanceof Ue&&n(e.definition(),t)?r=!0:void 0)})),a=new rt((function(t){if(r)return!0;if(t instanceof j&&t!==e){var n=a.parent();if(n instanceof de&&n.expression===t)return;return t.walk(i),!0}}));return e.walk(a),r}e(be,(function(e,t){function r(){return e.left.is_constant()||e.right.is_constant()||!e.left.has_side_effects(t)&&!e.right.has_side_effects(t)}function n(t){if(r()){t&&(e.operator=t);var n=e.left;e.left=e.right,e.right=n}}if(xt[e.operator]&&e.right.is_constant()&&!e.left.is_constant()&&(e.left instanceof be&&Mt[e.left.operator]>=Mt[e.operator]||n()),e=e.lift_sequences(t),t.option("comparisons"))switch(e.operator){case"===":case"!==":var i=!0;(e.left.is_string(t)&&e.right.is_string(t)||e.left.is_number(t)&&e.right.is_number(t)||e.left.is_boolean(t)&&e.right.is_boolean(t)||e.left.equivalent_to(e.right))&&(e.operator=e.operator.substr(0,2));case"==":case"!=":if(!i&&ct(e.left,t))e.left=o(Ke,e.left);else if(t.option("typeofs")&&e.left instanceof qe&&"undefined"==e.left.value&&e.right instanceof Ee&&"typeof"==e.right.operator){var a=e.right.expression;(a instanceof Ue?!a.is_declared(t):a instanceof ge&&t.option("ie8"))||(e.right=a,e.left=o(Xe,e.left).optimize(t),2==e.operator.length&&(e.operator+="="))}else if(e.left instanceof Ue&&e.right instanceof Ue&&e.left.definition()===e.right.definition()&&((u=e.left.fixed_value())instanceof xe||u instanceof G||u instanceof Pe))return o("="==e.operator[0]?tt:et,e);break;case"&&":case"||":var s=e.left;if(s.operator==e.operator&&(s=s.right),s instanceof be&&s.operator==("&&"==e.operator?"!==":"===")&&e.right instanceof be&&s.operator==e.right.operator&&(ct(s.left,t)&&e.right.left instanceof Ke||s.left instanceof Ke&&ct(e.right.left,t))&&!s.right.has_side_effects(t)&&s.right.equivalent_to(e.right.right)){var c=o(be,e,{operator:s.operator.slice(0,-1),left:o(Ke,e),right:s.right});return s!==e.left&&(c=o(be,e,{operator:e.operator,left:e.left.left,right:c})),c}}var u;if(t.option("booleans")&&"+"==e.operator&&t.in_boolean_context()){var h=e.left.evaluate(t),f=e.right.evaluate(t);if(h&&"string"==typeof h)return t.warn("+ in boolean context always true [{file}:{line},{col}]",e.start),l(e,[e.right,o(tt,e)]).optimize(t);if(f&&"string"==typeof f)return t.warn("+ in boolean context always true [{file}:{line},{col}]",e.start),l(e,[e.left,o(tt,e)]).optimize(t)}if(t.option("comparisons")&&e.is_boolean(t)){if(!(t.parent()instanceof be)||t.parent()instanceof Ie){var d=o(Ee,e,{operator:"!",expression:e.negate(t,b(t))});e=pt(t,e,d)}switch(e.operator){case">":n("<");break;case">=":n("<=")}}if("+"==e.operator){if(e.right instanceof qe&&""==e.right.getValue()&&e.left.is_string(t))return e.left;if(e.left instanceof qe&&""==e.left.getValue()&&e.right.is_string(t))return e.right;if(e.left instanceof be&&"+"==e.left.operator&&e.left.left instanceof qe&&""==e.left.left.getValue()&&e.right.is_string(t))return e.left=e.left.right,e.transform(t)}if(t.option("evaluate")){switch(e.operator){case"&&":if(!(h=E(e.left)))return t.warn("Condition left of && always false [{file}:{line},{col}]",e.start),I(t,t.parent(),t.self(),e.left).optimize(t);if(!(h instanceof x))return t.warn("Condition left of && always true [{file}:{line},{col}]",e.start),l(e,[e.left,e.right]).optimize(t);if(f=e.right.evaluate(t)){if(!(f instanceof x)&&("&&"==(p=t.parent()).operator&&p.left===t.self()||t.option("booleans")&&t.in_boolean_context()))return t.warn("Dropping side-effect-free && [{file}:{line},{col}]",e.start),e.left.optimize(t)}else{if(t.option("booleans")&&t.in_boolean_context())return t.warn("Boolean && always false [{file}:{line},{col}]",e.start),l(e,[e.left,o(et,e)]).optimize(t);e.falsy=!0}if("||"==e.left.operator&&!(g=e.left.right.evaluate(t)))return o(Se,e,{condition:e.left.left,consequent:e.right,alternative:e.left.right}).optimize(t);break;case"||":var p,g;if(!(h=E(e.left)))return t.warn("Condition left of || always false [{file}:{line},{col}]",e.start),l(e,[e.left,e.right]).optimize(t);if(!(h instanceof x))return t.warn("Condition left of || always true [{file}:{line},{col}]",e.start),I(t,t.parent(),t.self(),e.left).optimize(t);if(f=e.right.evaluate(t)){if(!(f instanceof x)){if(t.option("booleans")&&t.in_boolean_context())return t.warn("Boolean || always true [{file}:{line},{col}]",e.start),l(e,[e.left,o(tt,e)]).optimize(t);e.truthy=!0}}else if("||"==(p=t.parent()).operator&&p.left===t.self()||t.option("booleans")&&t.in_boolean_context())return t.warn("Dropping side-effect-free || [{file}:{line},{col}]",e.start),e.left.optimize(t);if("&&"==e.left.operator&&(g=e.left.right.evaluate(t))&&!(g instanceof x))return o(Se,e,{condition:e.left.left,consequent:e.left.right,alternative:e.right}).optimize(t)}var T=!0;switch(e.operator){case"+":if(e.left instanceof je&&e.right instanceof be&&"+"==e.right.operator&&e.right.left instanceof je&&e.right.is_string(t)&&(e=o(be,e,{operator:"+",left:o(qe,e.left,{value:""+e.left.getValue()+e.right.left.getValue(),start:e.left.start,end:e.right.left.end}),right:e.right.right})),e.right instanceof je&&e.left instanceof be&&"+"==e.left.operator&&e.left.right instanceof je&&e.left.is_string(t)&&(e=o(be,e,{operator:"+",left:e.left.left,right:o(qe,e.right,{value:""+e.left.right.getValue()+e.right.getValue(),start:e.left.right.start,end:e.right.end})})),e.left instanceof be&&"+"==e.left.operator&&e.left.is_string(t)&&e.left.right instanceof je&&e.right instanceof be&&"+"==e.right.operator&&e.right.left instanceof je&&e.right.is_string(t)&&(e=o(be,e,{operator:"+",left:o(be,e.left,{operator:"+",left:e.left.left,right:o(qe,e.left.right,{value:""+e.left.right.getValue()+e.right.left.getValue(),start:e.left.right.start,end:e.right.left.end})}),right:e.right.right})),e.right instanceof Ee&&"-"==e.right.operator&&e.left.is_number(t)){e=o(be,e,{operator:"-",left:e.left,right:e.right.expression});break}if(e.left instanceof Ee&&"-"==e.left.operator&&r()&&e.right.is_number(t)){e=o(be,e,{operator:"-",left:e.right,right:e.left.expression});break}case"*":T=t.option("unsafe_math");case"&":case"|":case"^":if(e.left.is_number(t)&&e.right.is_number(t)&&r()&&!(e.left instanceof be&&e.left.operator!=e.operator&&Mt[e.left.operator]>=Mt[e.operator])){var y=o(be,e,{operator:e.operator,left:e.right,right:e.left});e=e.right instanceof je&&!(e.left instanceof je)?pt(t,y,e):pt(t,e,y)}T&&e.is_number(t)&&(e.right instanceof be&&e.right.operator==e.operator&&(e=o(be,e,{operator:e.operator,left:o(be,e.left,{operator:e.operator,left:e.left,right:e.right.left,start:e.left.start,end:e.right.left.end}),right:e.right.right})),e.right instanceof je&&e.left instanceof be&&e.left.operator==e.operator&&(e.left.left instanceof je?e=o(be,e,{operator:e.operator,left:o(be,e.left,{operator:e.operator,left:e.left.left,right:e.right,start:e.left.left.start,end:e.right.end}),right:e.left.right}):e.left.right instanceof je&&(e=o(be,e,{operator:e.operator,left:o(be,e.left,{operator:e.operator,left:e.left.right,right:e.right,start:e.left.right.start,end:e.right.end}),right:e.left.left}))),e.left instanceof be&&e.left.operator==e.operator&&e.left.right instanceof je&&e.right instanceof be&&e.right.operator==e.operator&&e.right.left instanceof je&&(e=o(be,e,{operator:e.operator,left:o(be,e.left,{operator:e.operator,left:o(be,e.left.left,{operator:e.operator,left:e.left.right,right:e.right.left,start:e.left.right.start,end:e.right.left.end}),right:e.left.left}),right:e.right.right})))}}if(e.right instanceof be&&e.right.operator==e.operator&&(ut[e.operator]||"+"==e.operator&&(e.right.left.is_string(t)||e.left.is_string(t)&&e.right.right.is_string(t))))return e.left=o(be,e.left,{operator:e.operator,left:e.left,right:e.right.left}),e.right=e.right.right,e.transform(t);var v=e.evaluate(t);return v!==e?(v=m(v,e).optimize(t),pt(t,v,e)):e;function E(e){return!!e.truthy||!e.falsy&&(!!e.is_truthy()||e.evaluate(t))}})),e(Ue,(function(e,t){if(!t.option("ie8")&&He(e)&&(!e.scope.uses_with||!t.find_parent(z)))switch(e.name){case"undefined":return o(Xe,e).optimize(t);case"NaN":return o(Qe,e).optimize(t);case"Infinity":return o(Ze,e).optimize(t)}var r,n=t.parent();if(t.option("reduce_vars")&&ft(e,n)!==e){var i=e.definition(),a=e.fixed_value(),s=i.single_use&&!(n instanceof de&&n.is_expr_pure(t));if(s&&a instanceof G)if(i.scope===e.scope||t.option("reduce_funcs")&&1!=i.escaped&&!a.inlined){if(Pt(t,i))s=!1;else if((i.scope!==e.scope||i.orig[0]instanceof Oe)&&"f"==(s=a.is_constant_expression(e.scope)))for(var l=e.scope;(l instanceof K||l instanceof Y)&&(l.inlined=!0),l=l.parent_scope;);}else s=!1;if(s&&a){var c;if(i.single_use=!1,a instanceof K&&(a._squeezed=!0,(a=o(Y,a,a)).name=o(Fe,a.name,a.name)),0<i.recursive_refs){var u=(c=a.clone(!0)).name.definition(),h=c.variables.get(c.name.name),f=h&&h.orig[0];f instanceof Fe||(((f=o(Fe,c.name,c.name)).scope=c).name=f,h=c.def_function(f)),c.walk(new rt((function(e){if(e instanceof Ue){var t=e.definition();t===u?(e.thedef=h).references.push(e):t.single_use=!1}})))}else(c=a.optimize(t))===a&&(c=a.clone(!0));return c}if(a&&void 0===i.should_replace){var d;if(a instanceof ze)i.orig[0]instanceof Oe||!v(i.references,(function(e){return i.scope===e.scope}))||(d=a);else{var p=a.evaluate(t);p===a||!t.option("unsafe_regexp")&&p instanceof RegExp||(d=m(p,a))}if(d){var g,T=d.optimize(t).print_to_string().length;a.walk(new rt((function(e){if(e instanceof Ue&&(r=!0),r)return!0}))),g=r?function(){var e=d.optimize(t);return e===d?e.clone(!0):e}:(T=Math.min(T,a.print_to_string().length),function(){var e=dt(d.optimize(t),a);return e===d||e===a?e.clone(!0):e});var y=i.name.length,E=0;t.option("unused")&&!t.exposed(i)&&(E=(y+2+T)/(i.references.length-i.assignments)),i.should_replace=T<=y+E&&g}else i.should_replace=!1}if(i.should_replace)return i.should_replace()}return e})),e(Xe,(function(e,t){if(t.option("unsafe_undefined")){var r=s(t,"undefined");if(r){var n=o(Ue,e,{name:"undefined",scope:r.scope,thedef:r});return n.is_undefined=!0,n}}var i=ft(t.self(),t.parent());return i&&wt(i,e)?e:o(Ee,e,{operator:"void",expression:o(Ge,e,{value:0})})})),e(Ze,(function(e,t){var r=ft(t.self(),t.parent());return r&&wt(r,e)?e:!t.option("keep_infinity")||r&&!wt(r,e)||s(t,"Infinity")?o(be,e,{operator:"/",left:o(Ge,e,{value:1}),right:o(Ge,e,{value:0})}):e})),e(Qe,(function(e,t){var r=ft(t.self(),t.parent());return r&&!wt(r,e)||s(t,"NaN")?o(be,e,{operator:"/",left:o(Ge,e,{value:0}),right:o(Ge,e,{value:0})}):e}));var _t=y("+ - / * % >> << >>> | ^ &"),At=y("* | ^ &");function Rt(e,t){return e instanceof Ue&&(e=e.fixed_value()),!(!e||e instanceof G&&!(t.parent()instanceof pe)&&e.contains_this())}e(Ie,(function(e,t){var r;if(t.option("dead_code")&&e.left instanceof Ue&&(r=e.left.definition()).scope===t.find_parent(G)){var n,i=0,a=e;do{if(n=a,(a=t.parent(i++))instanceof X){if(s(i,a))break;if(Dt(r.scope,[r]))break;return"="==e.operator?e.right:(r.fixed=!1,o(be,e,{operator:e.operator.slice(0,-1),left:e.left,right:e.right}).optimize(t))}}while(a instanceof be&&a.right===n||a instanceof me&&a.tail_node()===n)}return"="==(e=e.lift_sequences(t)).operator&&e.left instanceof Ue&&e.right instanceof be&&(e.right.left instanceof Ue&&e.right.left.name==e.left.name&&_t[e.right.operator]?(e.operator=e.right.operator+"=",e.right=e.right.right):e.right.right instanceof Ue&&e.right.right.name==e.left.name&&At[e.right.operator]&&!e.right.left.has_side_effects(t)&&(e.operator=e.right.operator+"=",e.right=e.right.left)),e;function s(r,n){var i=e.right;e.right=o(Ke,i);var a=n.may_throw(t);e.right=i;for(var s,l=e.left.definition().scope;(s=t.parent(r++))!==l;)if(s instanceof oe){if(s.bfinally)return!0;if(a&&s.bcatch)return!0}}})),e(Se,(function(e,t){if(!t.option("conditionals"))return e;if(e.condition instanceof me){var r=e.condition.expressions.slice();return e.condition=r.pop(),r.push(e),l(e,r)}var n=e.condition.is_truthy()||e.condition.tail_node().evaluate(t);if(!n)return t.warn("Condition always false [{file}:{line},{col}]",e.start),l(e,[e.condition,e.alternative]).optimize(t);if(!(n instanceof x))return t.warn("Condition always true [{file}:{line},{col}]",e.start),l(e,[e.condition,e.consequent]).optimize(t);var i=n.negate(t,b(t));pt(t,n,i)===i&&(e=o(Se,e,{condition:i,consequent:e.alternative,alternative:e.consequent}));var a=e.condition,s=e.consequent,c=e.alternative;if(a instanceof Ue&&s instanceof Ue&&a.definition()===s.definition())return o(be,e,{operator:"||",left:a,right:c});var u,h=s.tail_node();if(h instanceof Ie){var f="="==h.operator,d=f?c.tail_node():c;if((f||s instanceof Ie)&&d instanceof Ie&&h.operator==d.operator&&h.left.equivalent_to(d.left)&&(!a.has_side_effects(t)||f&&!h.left.has_side_effects(t)))return o(Ie,e,{operator:h.operator,left:h.left,right:o(Se,e,{condition:a,consequent:v(s),alternative:v(c)})})}if(s instanceof de&&c.TYPE===s.TYPE&&0<s.args.length&&s.args.length==c.args.length&&s.expression.equivalent_to(c.expression)&&!a.has_side_effects(t)&&!s.expression.has_side_effects(t)&&"number"==typeof(u=function(){for(var e=s.args,t=c.args,r=0,n=e.length;r<n;r++)if(!e[r].equivalent_to(t[r])){for(var i=r+1;i<n;i++)if(!e[i].equivalent_to(t[i]))return;return r}}())){var p=s.clone();return p.args[u]=o(Se,e,{condition:a,consequent:s.args[u],alternative:c.args[u]}),p}if(s instanceof Se&&s.alternative.equivalent_to(c))return o(Se,e,{condition:o(be,e,{left:a,operator:"&&",right:s.condition}),consequent:s.consequent,alternative:c});if(s.equivalent_to(c))return l(e,[a,s]).optimize(t);if((s instanceof me||c instanceof me)&&s.tail_node().equivalent_to(c.tail_node()))return l(e,[o(Se,e,{condition:a,consequent:E(s),alternative:E(c)}),s.tail_node()]).optimize(t);if(s instanceof be&&"||"==s.operator&&s.right.equivalent_to(c))return o(be,e,{operator:"||",left:o(be,e,{operator:"&&",left:a,right:s.left}),right:c}).optimize(t);var m=t.option("booleans")&&t.in_boolean_context();return T(e.consequent)?y(e.alternative)?g(a):o(be,e,{operator:"||",left:g(a),right:e.alternative}):y(e.consequent)?T(e.alternative)?g(a.negate(t)):o(be,e,{operator:"&&",left:g(a.negate(t)),right:e.alternative}):T(e.alternative)?o(be,e,{operator:"||",left:g(a.negate(t)),right:e.consequent}):y(e.alternative)?o(be,e,{operator:"&&",left:g(a),right:e.consequent}):e;function g(e){return e.is_boolean(t)?e:o(Ee,e,{operator:"!",expression:e.negate(t)})}function T(e){return e instanceof tt||m&&e instanceof je&&e.getValue()||e instanceof Ee&&"!"==e.operator&&e.expression instanceof je&&!e.expression.getValue()}function y(e){return e instanceof et||m&&e instanceof je&&!e.getValue()||e instanceof Ee&&"!"==e.operator&&e.expression instanceof je&&e.expression.getValue()}function v(e){if(!(e instanceof me))return e.right;var t=e.expressions.slice();return t.push(t.pop().right),l(e,t)}function E(e){return e instanceof me?l(e,e.expressions.slice(0,-1)):o(Ge,e,{value:0})}})),e(Je,(function(e,t){if(!t.option("booleans"))return e;if(t.in_boolean_context())return o(Ge,e,{value:+e.value});var r=t.parent();return r instanceof be&&("=="==r.operator||"!="==r.operator)?(t.warn("Non-strict equality against boolean: {operator} {value} [{file}:{line},{col}]",{operator:r.operator,value:e.value,file:r.start.file,line:r.start.line,col:r.start.col}),o(Ge,e,{value:+e.value})):o(Ee,e,{operator:"!",expression:o(Ge,e,{value:1-e.value})})})),e(ye,(function(e,t){var r,n=e.expression,a=e.property;if(t.option("properties")){var s=a.evaluate(t);if(s!==a){"string"==typeof s&&("undefined"==s?s=void 0:(C=parseFloat(s)).toString()==s&&(s=C)),a=e.property=dt(a,m(s,a).transform(t));var c=""+s;if(St(c)&&c.length<=a.print_to_string().length+1)return o(Te,e,{expression:n,property:c}).optimize(t)}}if(t.option("arguments")&&n instanceof Ue&&"arguments"==n.name&&1==n.definition().orig.length&&(r=n.scope)instanceof G&&a instanceof Ge){var u=a.getValue(),h=r.argnames[u];if(h&&t.has_directive("use strict")){var f=h.definition();(!t.option("reduce_vars")||f.assignments||1<f.orig.length)&&(h=null)}else if(!h&&!t.option("keep_fargs")&&u<r.argnames.length+5)for(;u>=r.argnames.length;)h=o(Oe,r,{name:r.make_var_name("argument_"+r.argnames.length),scope:r}),r.argnames.push(h),r.enclosed.push(r.def_variable(h));if(h&&i((function(e){return e.name===h.name}),r.argnames)===h){var d=o(Ue,e,h);return d.reference({}),delete h.__unused,d}}if(ft(e,t.parent()))return e;if(s!==a){var p=e.flatten_object(c,t);p&&(n=e.expression=p.expression,a=e.property=p.property)}if(t.option("properties")&&t.option("side_effects")&&a instanceof Ge&&n instanceof xe){u=a.getValue();var g=n.elements,T=g[u];if(Rt(T,t)){for(var y=!0,v=[],E=g.length;--E>u;)(C=g[E].drop_side_effect_free(t))&&(v.unshift(C),y&&C.has_side_effects(t)&&(y=!1));for(T=T instanceof $e?o(Xe,T):T,y||v.unshift(T);0<=--E;){var C;(C=g[E].drop_side_effect_free(t))?v.unshift(C):u--}return y?(v.push(T),l(e,v).optimize(t)):o(ye,e,{expression:o(xe,n,{elements:v}),property:o(Ge,a,{value:u})})}}var b=e.evaluate(t);return b!==e?pt(t,b=m(b,e).optimize(t),e):e})),j.DEFMETHOD("contains_this",(function(){var e,t=this;return t.walk(new rt((function(r){return!!e||(r instanceof ze?e=!0:r!==t&&r instanceof j||void 0)}))),e})),ge.DEFMETHOD("flatten_object",(function(e,t){if(t.option("properties")){var r=this.expression;if(r instanceof Pe)for(var n=r.properties,i=n.length;0<=--i;){var a=n[i];if(""+a.key==e){if(!v(n,(function(e){return e instanceof De})))break;if(!Rt(a.value,t))break;return o(ye,this,{expression:o(xe,r,{elements:n.map((function(e){return e.value}))}),property:o(Ge,this,{value:i})})}}}})),e(Te,(function(e,t){if("arguments"!=e.property&&"caller"!=e.property||t.warn("Function.protoype.{prop} not supported [{file}:{line},{col}]",{prop:e.property,file:e.start.file,line:e.start.line,col:e.start.col}),ft(e,t.parent()))return e;if(t.option("unsafe_proto")&&e.expression instanceof Te&&"prototype"==e.expression.property){var r=e.expression.expression;if(He(r))switch(r.name){case"Array":e.expression=o(xe,e.expression,{elements:[]});break;case"Function":e.expression=o(Y,e.expression,{argnames:[],body:[]});break;case"Number":e.expression=o(Ge,e.expression,{value:0});break;case"Object":e.expression=o(Pe,e.expression,{properties:[]});break;case"RegExp":e.expression=o(We,e.expression,{value:/t/});break;case"String":e.expression=o(qe,e.expression,{value:""})}}var n=e.flatten_object(e.property,t);if(n)return n.optimize(t);var i=e.evaluate(t);return i!==e?pt(t,i=m(i,e).optimize(t),e):e})),e($,(function(e,t){return e.value&&ct(e.value,t)&&(e.value=null),e}))}((function(e,t){e.DEFMETHOD("optimize",(function(e){if(this._optimized)return this;if(e.has_directive("use asm"))return this;var r=t(this,e);return r._optimized=!0,r}))})),function(){function e(e){for(var t=!0,r=0;r<e.length;r++)t&&e[r]instanceof P&&e[r].body instanceof qe?e[r]=new D({start:e[r].start,end:e[r].end,value:e[r].body.value}):!t||e[r]instanceof P&&e[r].body instanceof qe||(t=!1);return e}var r={Program:function(t){return new q({start:i(t),end:a(t),body:e(t.body.map(l))})},FunctionDeclaration:function(t){return new K({start:i(t),end:a(t),name:l(t.id),argnames:t.params.map(l),body:e(l(t.body).body)})},FunctionExpression:function(t){return new Y({start:i(t),end:a(t),name:l(t.id),argnames:t.params.map(l),body:e(l(t.body).body)})},ExpressionStatement:function(e){return new _({start:i(e),end:a(e),body:l(e.expression)})},TryStatement:function(e){var t=e.handlers||[e.handler];if(1<t.length||e.guardedHandlers&&e.guardedHandlers.length)throw new Error("Multiple catch clauses are not supported.");return new oe({start:i(e),end:a(e),body:l(e.block).body,bcatch:l(t[0]),bfinally:e.finalizer?new ce(l(e.finalizer)):null})},Property:function(e){var t=e.key,r={start:i(t),end:a(e.value),key:"Identifier"==t.type?t.name:t.value,value:l(e.value)};return"init"==e.kind?new De(r):(r.key=new Me({name:r.key}),r.value=new W(r.value),"get"==e.kind?new Ae(r):"set"==e.kind?new _e(r):void 0)},ArrayExpression:function(e){return new xe({start:i(e),end:a(e),elements:e.elements.map((function(e){return null===e?new $e:l(e)}))})},ObjectExpression:function(e){return new Pe({start:i(e),end:a(e),properties:e.properties.map((function(e){return e.type="Property",l(e)}))})},SequenceExpression:function(e){return new me({start:i(e),end:a(e),expressions:e.expressions.map(l)})},MemberExpression:function(e){return new(e.computed?ye:Te)({start:i(e),end:a(e),property:e.computed?l(e.property):e.property.name,expression:l(e.object)})},SwitchCase:function(e){return new(e.test?se:ae)({start:i(e),end:a(e),expression:l(e.test),body:e.consequent.map(l)})},VariableDeclaration:function(e){return new he({start:i(e),end:a(e),definitions:e.declarations.map(l)})},Literal:function(e){var t=e.value,r={start:i(e),end:a(e)};if(null===t)return new Ke(r);var n=e.regex;if(n&&n.pattern)return r.value=new RegExp(n.pattern,n.flags),r.value.raw_source=n.pattern,new We(r);if(n)return r.value=e.regex&&e.raw?e.raw:t,new We(r);switch(_typeof(t)){case"string":return r.value=t,new qe(r);case"number":return r.value=t,new Ge(r);case"boolean":return new(t?tt:et)(r)}},Identifier:function(e){var t=o[o.length-2];return new("LabeledStatement"==t.type?Ve:"VariableDeclarator"==t.type&&t.id===e?ke:"FunctionExpression"==t.type?t.id===e?Fe:Oe:"FunctionDeclaration"==t.type?t.id===e?Le:Oe:"CatchClause"==t.type?Be:"BreakStatement"==t.type||"ContinueStatement"==t.type?He:Ue)({start:i(e),end:a(e),name:e.name})}};function n(e){if("Literal"==e.type)return null!=e.raw?e.raw:e.value+""}function i(e){var t=e.loc,r=t&&t.start,i=e.range;return new I({file:t&&t.source,line:r&&r.line,col:r&&r.column,pos:i?i[0]:e.start,endline:r&&r.line,endcol:r&&r.column,endpos:i?i[0]:e.start,raw:n(e)})}function a(e){var t=e.loc,r=t&&t.end,i=e.range;return new I({file:t&&t.source,line:r&&r.line,col:r&&r.column,pos:i?i[1]:e.end,endline:r&&r.line,endcol:r&&r.column,endpos:i?i[1]:e.end,raw:n(e)})}function s(e,n,s){var o="function From_Moz_"+e+"(M){\n";o+="return new U2."+n.name+"({\nstart: my_start_token(M),\nend: my_end_token(M)";var d="function To_Moz_"+e+"(M){\n";d+="return {\ntype: "+JSON.stringify(e),s&&s.split(/\s*,\s*/).forEach((function(e){var t=/([a-z0-9$_]+)(=|@|>|%)([a-z0-9$_]+)/i.exec(e);if(!t)throw new Error("Can't understand property map: "+e);var r=t[1],n=t[2],i=t[3];switch(o+=",\n"+i+": ",d+=",\n"+r+": ",n){case"@":o+="M."+r+".map(from_moz)",d+="M."+i+".map(to_moz)";break;case">":o+="from_moz(M."+r+")",d+="to_moz(M."+i+")";break;case"=":o+="M."+r,d+="M."+i;break;case"%":o+="from_moz(M."+r+").body",d+="to_moz_block(M)";break;default:throw new Error("Can't understand operator in propmap: "+e)}})),o+="\n})\n}",d+="\n}\n}",o=new Function("U2","my_start_token","my_end_token","from_moz","return("+o+")")(t,i,a,l),d=new Function("to_moz","to_moz_block","to_moz_scope","return("+d+")")(u,h,f),r[e]=o,c(n,d)}r.UpdateExpression=r.UnaryExpression=function(e){return new(("prefix"in e?e.prefix:"UnaryExpression"==e.type)?Ee:Ce)({start:i(e),end:a(e),operator:e.operator,expression:l(e.argument)})},s("EmptyStatement",N),s("BlockStatement",M,"body@body"),s("IfStatement",re,"test>condition, consequent>body, alternate>alternative"),s("LabeledStatement",O,"label>label, body>body"),s("BreakStatement",ee,"label>label"),s("ContinueStatement",te,"label>label"),s("WithStatement",z,"object>expression, body>body"),s("SwitchStatement",ne,"discriminant>expression, cases@body"),s("ReturnStatement",$,"argument>value"),s("ThrowStatement",Z,"argument>value"),s("WhileStatement",V,"test>condition, body>body"),s("DoWhileStatement",B,"test>condition, body>body"),s("ForStatement",U,"init>init, test>condition, update>step, body>body"),s("ForInStatement",H,"left>init, right>object, body>body"),s("DebuggerStatement",w),s("VariableDeclarator",fe,"id>name, init>value"),s("CatchClause",le,"param>argname, body%body"),s("ThisExpression",ze),s("BinaryExpression",be,"operator=operator, left>left, right>right"),s("LogicalExpression",be,"operator=operator, left>left, right>right"),s("AssignmentExpression",Ie,"operator=operator, left>left, right>right"),s("ConditionalExpression",Se,"test>condition, consequent>consequent, alternate>alternative"),s("NewExpression",pe,"callee>expression, arguments@args"),s("CallExpression",de,"callee>expression, arguments@args"),c(q,(function(e){return f("Program",e)})),c(K,(function(e){return{type:"FunctionDeclaration",id:u(e.name),params:e.argnames.map(u),body:f("BlockStatement",e)}})),c(Y,(function(e){return{type:"FunctionExpression",id:u(e.name),params:e.argnames.map(u),body:f("BlockStatement",e)}})),c(D,(function(e){return{type:"ExpressionStatement",expression:{type:"Literal",value:e.value}}})),c(_,(function(e){return{type:"ExpressionStatement",expression:u(e.body)}})),c(ie,(function(e){return{type:"SwitchCase",test:u(e.expression),consequent:e.body.map(u)}})),c(oe,(function(e){return{type:"TryStatement",block:h(e),handler:u(e.bcatch),guardedHandlers:[],finalizer:u(e.bfinally)}})),c(le,(function(e){return{type:"CatchClause",param:u(e.argname),guard:null,body:h(e)}})),c(ue,(function(e){return{type:"VariableDeclaration",kind:"var",declarations:e.definitions.map(u)}})),c(me,(function(e){return{type:"SequenceExpression",expressions:e.expressions.map(u)}})),c(ge,(function(e){var t=e instanceof ye;return{type:"MemberExpression",object:u(e.expression),computed:t,property:t?u(e.property):{type:"Identifier",name:e.property}}})),c(ve,(function(e){return{type:"++"==e.operator||"--"==e.operator?"UpdateExpression":"UnaryExpression",operator:e.operator,prefix:e instanceof Ee,argument:u(e.expression)}})),c(be,(function(e){return{type:"&&"==e.operator||"||"==e.operator?"LogicalExpression":"BinaryExpression",left:u(e.left),operator:e.operator,right:u(e.right)}})),c(xe,(function(e){return{type:"ArrayExpression",elements:e.elements.map(u)}})),c(Pe,(function(e){return{type:"ObjectExpression",properties:e.properties.map(u)}})),c(we,(function(e){var t,r={type:"Literal",value:e.key instanceof Me?e.key.name:e.key};return e instanceof De?t="init":e instanceof Ae?t="get":e instanceof _e&&(t="set"),{type:"Property",kind:t,key:r,value:u(e.value)}})),c(Re,(function(e){var t=e.definition();return{type:"Identifier",name:t?t.mangled_name||t.name:e.name}})),c(We,(function(e){var t=e.value.toString().match(/[gimuy]*$/)[0],r="/"+e.value.raw_source+"/"+t;return{type:"Literal",value:r,raw:r,regex:{pattern:e.value.raw_source,flags:t}}})),c(je,(function(e){var t=e.value;return"number"==typeof t&&(t<0||0===t&&1/t<0)?{type:"UnaryExpression",operator:"-",prefix:!0,argument:{type:"Literal",value:-t,raw:e.start.raw}}:{type:"Literal",value:t,raw:e.start.raw}})),c(Ye,(function(e){return{type:"Identifier",name:String(e.value)}})),Je.DEFMETHOD("to_mozilla_ast",je.prototype.to_mozilla_ast),Ke.DEFMETHOD("to_mozilla_ast",je.prototype.to_mozilla_ast),$e.DEFMETHOD("to_mozilla_ast",(function(){return null})),R.DEFMETHOD("to_mozilla_ast",M.prototype.to_mozilla_ast),G.DEFMETHOD("to_mozilla_ast",Y.prototype.to_mozilla_ast);var o=null;function l(e){o.push(e);var t=null!=e?r[e.type](e):null;return o.pop(),t}function c(e,t){e.DEFMETHOD("to_mozilla_ast",(function(){return e=t(this),r=this.start,n=this.end,null!=r.pos&&null!=n.endpos&&(e.range=[r.pos,n.endpos]),r.line&&(e.loc={start:{line:r.line,column:r.col},end:n.endline?{line:n.endline,column:n.endcol}:null},r.file&&(e.loc.source=r.file)),e;var e,r,n}))}function u(e){return null!=e?e.to_mozilla_ast():null}function h(e){return{type:"BlockStatement",body:e.body.map(u)}}function f(e,t){var r=t.body.map(u);return t.body[0]instanceof _&&t.body[0].body instanceof qe&&r.unshift(u(new N(t.body[0]))),{type:e,body:r}}x.from_mozilla_ast=function(e){var t=o;o=[];var r=l(e);return o=t,r.walk(new rt((function(e){if(e instanceof He){for(var t,r=0;(t=this.parent(r))&&!(t instanceof j);r++)if(t instanceof O&&t.label.name==e.name){e.thedef=t.label;break}if(!e.thedef){var n=e.start;xt("Undefined label "+e.name,n.file,n.line,n.col,n.pos)}}}))),r}}();var Wt="undefined"==typeof atob?function(t){return new e(t,"base64").toString()}:atob,Yt="undefined"==typeof btoa?function(t){return new e(t).toString("base64")}:btoa;function Kt(e){try{return JSON.parse(e)}catch(t){throw new Error("invalid input source map: "+e)}}function Qt(e,t,r){t[e]&&r.forEach((function(r){t[r]&&("object"!=_typeof(t[r])&&(t[r]={}),e in t[r]||(t[r][e]=t[e]))}))}function Xt(e){e&&("props"in e?e.props instanceof E||(e.props=E.fromObject(e.props)):e.props=new E)}function $t(e){return{props:e.props.toObject()}}t.Dictionary=E,t.minify=function(e,t){var r,n,i,a=x.warn_function;try{var s,l=(t=o(t,{compress:{},enclose:!1,ie8:!1,keep_fnames:!1,mangle:{},nameCache:null,output:{},parse:{},rename:void 0,sourceMap:!1,timings:!1,toplevel:!1,warnings:!1,wrap:!1},!0)).timings&&{start:Date.now()};void 0===t.rename&&(t.rename=t.compress&&t.mangle),Qt("ie8",t,["compress","mangle","output"]),Qt("keep_fnames",t,["compress","mangle"]),Qt("toplevel",t,["compress","mangle"]),Qt("warnings",t,["compress"]),t.mangle&&(t.mangle=o(t.mangle,{cache:t.nameCache&&(t.nameCache.vars||{}),eval:!1,ie8:!1,keep_fnames:!1,properties:!1,reserved:[],toplevel:!1},!0),t.mangle.properties&&("object"!=_typeof(t.mangle.properties)&&(t.mangle.properties={}),t.mangle.properties.keep_quoted&&(s=t.mangle.properties.reserved,Array.isArray(s)||(s=[]),t.mangle.properties.reserved=s),!t.nameCache||"cache"in t.mangle.properties||(t.mangle.properties.cache=t.nameCache.props||{})),Xt(t.mangle.cache),Xt(t.mangle.properties.cache)),t.sourceMap&&(t.sourceMap=o(t.sourceMap,{content:null,filename:null,includeSources:!1,root:null,url:null},!0));var c,u,h=[];if(t.warnings&&!x.warn_function&&(x.warn_function=function(e){h.push(e)}),l&&(l.parse=Date.now()),e instanceof q)u=e;else{"string"==typeof e&&(e=[e]),t.parse=t.parse||{},t.parse.toplevel=null;var f=t.sourceMap&&t.sourceMap.content;for(var d in"string"==typeof f&&"inline"!=f&&(f=Kt(f)),c=f&&Object.create(null),e)if(C(e,d)&&(t.parse.filename=d,t.parse.toplevel=kt(e[d],t.parse),c))if("inline"==f){var p=(n=e[r=d],(i=/\n\/\/# sourceMappingURL=data:application\/json(;.*?)?;base64,(.*)/.exec(n))?Wt(i[2]):(x.warn("inline source map not found: "+r),null));p&&(c[d]=Kt(p))}else c[d]=f;u=t.parse.toplevel}s&&function(e,t){function r(e){m(t,e)}e.walk(new rt((function(e){e instanceof De&&e.quote?r(e.key):e instanceof ye&&qt(e.property,r)})))}(u,s),t.wrap&&(u=u.wrap_commonjs(t.wrap)),t.enclose&&(u=u.wrap_enclose(t.enclose)),l&&(l.rename=Date.now()),t.rename&&(u.figure_out_scope(t.mangle),u.expand_names(t.mangle)),l&&(l.compress=Date.now()),t.compress&&(u=new jt(t.compress).compress(u)),l&&(l.scope=Date.now()),t.mangle&&u.figure_out_scope(t.mangle),l&&(l.mangle=Date.now()),t.mangle&&(u.compute_char_frequency(t.mangle),u.mangle_names(t.mangle)),l&&(l.properties=Date.now()),t.mangle&&t.mangle.properties&&(u=Gt(u,t.mangle.properties)),l&&(l.output=Date.now());var g={};if(t.output.ast&&(g.ast=u),!C(t.output,"code")||t.output.code){if(t.sourceMap)if(t.output.source_map=function(e){e=o(e,{file:null,root:null,orig:null,orig_line_diff:0,dest_line_diff:0},!0);var t=new MOZ_SourceMap.SourceMapGenerator({file:e.file,sourceRoot:e.root}),r=e.orig&&Object.create(null);if(r)for(var n in e.orig){var i=new MOZ_SourceMap.SourceMapConsumer(e.orig[n]);Array.isArray(e.orig[n].sources)&&i._sources.toArray().forEach((function(e){var r=i.sourceContentFor(e,!0);r&&t.setSourceContent(e,r)})),r[n]=i}return{add:function(n,i,a,s,o,l){var c=r&&r[n];if(c){var u=c.originalPositionFor({line:s,column:o});if(null===u.source)return;n=u.source,s=u.line,o=u.column,l=u.name||l}t.addMapping({name:l,source:n,generated:{line:i+e.dest_line_diff,column:a},original:{line:s+e.orig_line_diff,column:o}})},get:function(){return t},toString:function(){return JSON.stringify(t.toJSON())}}}({file:t.sourceMap.filename,orig:c,root:t.sourceMap.root}),t.sourceMap.includeSources){if(e instanceof q)throw new Error("original source content unavailable");for(var d in e)C(e,d)&&t.output.source_map.get().setSourceContent(d,e[d])}else t.output.source_map.get()._sourcesContents=null;delete t.output.ast,delete t.output.code;var T=zt(t.output);u.print(T),g.code=T.get(),t.sourceMap&&(g.map=t.output.source_map.toString(),"inline"==t.sourceMap.url?g.code+="\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,"+Yt(g.map):t.sourceMap.url&&(g.code+="\n//# sourceMappingURL="+t.sourceMap.url))}return t.nameCache&&t.mangle&&(t.mangle.cache&&(t.nameCache.vars=$t(t.mangle.cache)),t.mangle.properties&&t.mangle.properties.cache&&(t.nameCache.props=$t(t.mangle.properties.cache))),l&&(l.end=Date.now(),g.timings={parse:.001*(l.rename-l.parse),rename:.001*(l.compress-l.rename),compress:.001*(l.scope-l.compress),scope:.001*(l.mangle-l.scope),mangle:.001*(l.properties-l.mangle),properties:.001*(l.output-l.properties),output:.001*(l.end-l.output),total:.001*(l.end-l.start)}),h.length&&(g.warnings=h),g}catch(e){return{error:e}}finally{x.warn_function=a}},t.parse=kt,t.push_uniq=m,t.TreeTransformer=Ot,t.TreeWalker=rt}(void 0===r?r={}:r)}).call(this,e("buffer").Buffer)},{buffer:4}]},{},["html-minifier"]);Terrasoft.utils.minifier=e("html-minifier")}(),Ext.define("Terrasoft.exporters.EmailContentValidator",{alternateClassName:"Terrasoft.EmailContentValidator",deprecatedTags:["acronym","applet","basefont","big","center","dir","font","frame","frameset","isindex","noframes","s","strike","tt","u"],_validateDeprecatedTags:function(e,t){var r=[];if(Terrasoft.each(this.deprecatedTags,(function(t){e.getElementsByTagName(t).length>0&&r.push(t)}),this),r.length>0){var n=r.join('", "'),i=Ext.String.format(Terrasoft.Resources.EmailContentValidator.DeprecatedHtmlTags,n);t.add(i)}},validate:function(e,t,r){var n=Ext.create("Terrasoft.Collection"),i=(new DOMParser).parseFromString(e,"text/html");this._validateDeprecatedTags(i,n),t.call(r,n,i)}}),Ext.define("Terrasoft.controls.mixins.ClearIcon",{alternateClassName:"Terrasoft.ClearIcon",hasClearIcon:!1,clearIconClasses:null,clearIconNotVisibleClass:"clear-icon-not-visible",clearIconWrapClass:"base-edit-with-clear-icon",clearIconConfig:null,clearIconTpl:['<div id="{id}-clear-icon" class="{clearIconClasses}"></div>'],init:function(){this.clearIconClasses=this.clearIconClasses||[],this.addEvents("cleariconclick")},renderClearIcon:function(e,t){var r=t.self;if(r.hasClearIcon){var n=new Ext.Template(r.clearIconTpl).apply({id:r.id,clearIconClasses:r.combineClearIconClasses(),clearIconStyles:r.combineClearIconStyles()});e.push(n)}},combineSelectors:function(e){return e.clearIconEl="#"+this.id+"-clear-icon",e},combineClearIconClasses:function(){var e=["base-edit-clear-icon"];return Ext.isEmpty(this.clearIconClasses)||(e=Ext.Array.merge(e,this.clearIconClasses)),e.join(" ")},combineWrapClasses:function(e){var t=e.wrapClass||{};t.push(this.clearIconWrapClass),this.getIsHidden()&&t.push(this.clearIconNotVisibleClass)},combineClearIconStyles:function(){var e={};if(!Ext.isEmpty(this.clearIconConfig)){var t=Terrasoft.ImageUrlBuilder.getUrl(this.clearIconConfig);e.background='url("'+t+'") no-repeat center center'}return Ext.DomHelper.generateStyles(e)},initDomEvents:function(){this.hasClearIcon&&this.getClearIconEl().on("click",this.onClearIconClick,this)},getClearIconEl:function(){return this.clearIconEl},onClearIconClick:function(){this.enabled&&!this.readonly&&(this.setValue(null),this.fireEvent("cleariconclick",this))},setClearIconVisibility:function(){if(this.hasClearIcon&&this.rendered){var e=this.clearIconNotVisibleClass,t=this.getWrapEl();this.getIsHidden()?t.addCls(e):t.removeCls(e)}},getIsHidden:function(){var e=this.getInitValue();return Ext.isEmpty(e)||!this.enabled||this.readonly},clearDomListeners:function(){var e=this.getClearIconEl();e&&e.un("cleariconmouseover",this.onClearIconMouseOver,this)}}),Ext.define("Terrasoft.controls.mixins.PredictableIcon",{alternateClassName:"Terrasoft.PredictableIcon",_preparePredictableListEventName:"preparePredictableList",_predictIconClickEventName:"predictableIconClick",predictableState:{state:Terrasoft.PredictableState.INPROGRESS,value:""},predictableWrapClass:"predictable-edit",predictableIconTpl:'<div id="{id}-predictable-icon" class="predictable-icon" state="{predictableState}"></div>',predictableListViewItemTpl:'<span class="predictable-display-value cignificance-{2}">{0}</span><span class="predictable-value">{1}</span>',predictableIconEl:null,init:function(){this.addEvents(this._preparePredictableListEventName),this.addEvents(this._predictIconClickEventName)},onPredictableIconClick:function(){this.fireEvent(this._predictIconClickEventName),this.enabled&&!this.readonly&&this.predictableState.state!==Terrasoft.PredictableState.INPROGRESS&&(this.destroyPredictableListView(),this.createPredictableListView(),this.expandList(null,this._preparePredictableListEventName))},createPredictableListView:function(){this.listView=this.createListView(),this.listView.on("listViewItemRender",this.onPredictableListViewItemRender,this),this.listView.on("hide",this.onHidePredictableList,this)},valueChanged:function(e){if(this.enablePredictableIcon){var t=(this.predictableState.value||"").toLowerCase(),r=e&&e.value;Ext.isEmpty(t)||Terrasoft.isEmptyGUID(t)||this.setPredictableState({value:t,state:t!==r?Terrasoft.PredictableState.NOTEXACT:Terrasoft.PredictableState.EXACT})}},onHidePredictableList:function(){this.destroyPredictableListView()},onPredictableListViewItemRender:function(e){var t=Number(100*e.predictableValue).toFixed(0),r=e.significance?e.significance.toLowerCase():"";e.customHtml=Ext.String.format(this.predictableListViewItemTpl,e.displayValue,Ext.String.format("{0}%",t),r)},destroyPredictableListView:function(){this.listView&&(this.listView.destroy(),this.listView=null)},renderPredictableIcon:function(e,t){var r=t.self;if(r.enablePredictableIcon){var n=new Ext.Template(r.predictableIconTpl).apply({id:r.id,predictableState:r.predictableState.state});e.push(n)}},getBindConfig:function(){return{predictableState:{changeMethod:"setPredictableState"}}},initDomEvents:function(){this.getPredictableIconEl().on("click",this.onPredictableIconClick,this)},clearDomListeners:function(){this.getPredictableIconEl().un("click",this.onPredictableIconClick,this)},getPredictableIconEl:function(){var e=Ext.String.format("#{0}-predictable-icon",this.id);return this.predictableIconEl=this.predictableIconEl||Ext.select(e).first(),this.predictableIconEl},applyWrapStyles:function(){var e=this.getWrapEl();e&&(this.predictableState.state===Terrasoft.PredictableState.INPROGRESS?e.removeCls(this.predictableWrapClass):e.addCls(this.predictableWrapClass))},setPredictableState:function(e){if(!Ext.isEmpty(e)&&!Ext.Object.equals(this.predictableState,e)){this.predictableState=e;var t=this.getPredictableIconEl();Ext.isEmpty(t)||(t.set({state:this.predictableState.state}),this.applyWrapStyles())}}}),Ext.define("Terrasoft.controls.mixins.PasswordIcon",{alternateClassName:"Terrasoft.PasswordIcon",passwordIconClasses:[],passwordIconTpl:['<div id="{id}-password-icon-wrapper" class="base-edit-password-icon-wrapper">','<div id="{id}-password-icon" class="{passwordIconClasses}" style="{passwordIconStyles}"></div>',"</div>"],renderPasswordIcon:function(e,t){var r=t.self;if(r.usePasswordIcon()){var n=new Ext.Template(r.passwordIconTpl).apply({id:r.id,passwordIconClasses:r.combinePasswordIconClasses(),passwordIconStyles:r.combinePasswordIconStyles()});e.push(n)}},combinePasswordIconClasses:function(){var e=["base-edit-password-icon"];return Ext.isEmpty(this.passwordIconClasses)||(e=Ext.Array.merge(e,this.passwordIconClasses)),e.join(" ")},combinePasswordIconStyles:function(){var e={};if(!Ext.isEmpty(this.passwordIconConfig)){var t=Terrasoft.ImageUrlBuilder.getUrl(this.passwordIconConfig);e.background="url('"+t+"') no-repeat center center"}return Ext.DomHelper.generateStyles(e)},usePasswordIcon:function(){return this.protect&&!!Terrasoft.usePasswordIconForTextEdit},combineSelectors:function(e){var t=this.id;return e.passwordIconEl="#"+t+"-password-icon",e.passwordIconWrapperEl="#"+t+"-password-icon-wrapper",e},initPasswordIconEvents:function(){this.passwordIconWrapperEl.on("mousedown",this.onPasswordIconMouseDown,this),this.passwordIconWrapperEl.on("mouseup",this.onPasswordIconMouseUp,this)},onPasswordIconMouseDown:function(){this.enabled&&this.rendered&&(this.el.dom.type="text")},onPasswordIconMouseUp:function(){this.enabled&&this.rendered&&(this.el.dom.type="password")}}),Ext.define("Terrasoft.controls.mixins.SanitizeHtml",{alternateClassName:"Terrasoft.SanitizeHtml",_sanitizeHtml:!1,getSanitizeHtmlBindConfig:function(){return{sanitizeHtml:{changeMethod:"setSanitizeHtml"}}},setSanitizeHtml:function(e){this._sanitizeHtml=e},getSanitizedValue:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Terrasoft.sanitizationLevel.DEFAULT;return this._sanitizeHtml?Terrasoft.sanitizeHTML(e,t):e}}),Ext.define("Terrasoft.controls.InlineTextEditMacros",{alternateClassName:"Terrasoft.InlineTextEditMacros",value:null,displayValue:null,html:null,valueRegex:/(?:data-value=")(\S*?)"/g,displayValueRegex:/(?:alt=")(.*?)"/g,constructor:function(e){this.callParent(arguments);var t=e.html;t?(this.html=t,this.initFromHtml(t)):(this.value=e.value,this.displayValue=e.displayValue,this.html=this.toHtml())},initFromHtml:function(e){this.value=this.execAndReset(this.valueRegex,e)[1],this.displayValue=this.execAndReset(this.displayValueRegex,e)[1]},execAndReset:function(e,t){var r=e.exec(t);return e.lastIndex=0,r},toHtml:function(){return Ext.String.format('<img data-type="ProcessParameter" data-value="{1}" alt="{2}" />',this.id,this.value,this.displayValue)}}),Ext.define("Terrasoft.controls.mixins.LeftIcon",{alternateClassName:"Terrasoft.LeftIcon",enableLeftIcon:!1,leftIconClasses:[],editWithLeftIconClass:"base-edit-with-left-icon",leftIconConfig:null,leftIconTpl:'<div id="{id}-left-icon" class="{leftIconClasses}" style="{leftIconStyles}"></div>',renderLeftIcon:function(e,t){var r=t.self;if(r.useLeftIcon()){var n=new Ext.Template(r.leftIconTpl).apply({id:r.id,leftIconClasses:r.combineLeftIconClasses(),leftIconStyles:r.combineLeftIconStyles()});e.push(n)}},combineLeftIconClasses:function(){var e=["base-edit-left-icon"];return Ext.isEmpty(this.leftIconClasses)||(e=Ext.Array.merge(e,this.leftIconClasses)),e.join(" ")},combineLeftIconStyles:function(){var e={};if(!Ext.isEmpty(this.leftIconConfig)){var t=Terrasoft.ImageUrlBuilder.getUrl(this.leftIconConfig);e.background="url('"+t+"') no-repeat center center"}return Ext.DomHelper.generateStyles(e)},useLeftIcon:function(){return this.enableLeftIcon&&(!Ext.isEmpty(this.leftIconClasses)||!Ext.isEmpty(this.leftIconConfig))},initLeftIconEvents:Terrasoft.emptyFn,setImage:function(e){if(this.leftIconConfig!==e&&(this.leftIconConfig=e,this.rendered)){var t=this.useLeftIcon(),r=this.leftIconEl;if(r&&r.dom){var n=this.getWrapEl();if(t){n.addCls(this.editWithLeftIconClass);var i=this.combineLeftIconStyles();r.dom.setAttribute("style",i)}else r.destroy(),n.removeCls(this.editWithLeftIconClass)}else t&&this.reRender()}},getBindConfig:function(){return{leftIconConfig:{changeMethod:"setImage"}}}}),Ext.define("Terrasoft.controls.mixins.RightIcon",{alternateClassName:"Terrasoft.RightIcon",enableRightIcon:!1,rightIconClasses:[],rightIconConfig:null,rightIconTpl:['<div id="{id}-right-icon-wrapper" class="base-edit-right-icon-wrapper">','<div id="{id}-right-icon" class="{rightIconClasses}" style="{rightIconStyles}"></div>',"</div>"],init:function(){this.addEvents("rightIconClick","rightIconMouseOut","rightIconMouseOver")},renderRightIcon:function(e,t){var r=t.self;if(r.useRightIcon()){var n=new Ext.Template(r.rightIconTpl).apply({id:r.id,rightIconClasses:r.combineRightIconClasses(),rightIconStyles:r.combineRightIconStyles()});e.push(n)}},combineRightIconClasses:function(){var e=["base-edit-right-icon"];return Ext.isEmpty(this.rightIconClasses)||(e=Ext.Array.merge(e,this.rightIconClasses)),e.join(" ")},combineRightIconStyles:function(){var e={};if(!Ext.isEmpty(this.rightIconConfig)){var t=Terrasoft.ImageUrlBuilder.getUrl(this.rightIconConfig);e.background="url('"+t+"') no-repeat center center"}return Ext.DomHelper.generateStyles(e)},useRightIcon:function(){return this.enableRightIcon&&(!Ext.isEmpty(this.rightIconClasses)||!Ext.isEmpty(this.rightIconConfig))},getBindConfig:function(){return{enableRightIcon:{changeMethod:"setEnableRightIcon"}}},initRightIconEvents:function(){this.rightIconWrapperEl.on("click",this.onRightIconClick,this),this.rightIconWrapperEl.on("mouseover",this.onRightIconMouseOver,this),this.rightIconWrapperEl.on("mouseout",this.onRightIconMouseOut,this)},onRightIconClick:function(){this.enabled&&this.rendered&&this.fireEvent("rightIconClick",this)},onRightIconMouseOver:function(){this.enabled&&this.rendered&&this.fireEvent("rightIconMouseOver",this)},onRightIconMouseOut:function(){this.enabled&&this.rendered&&this.fireEvent("rightIconMouseOut",this)},setEnableRightIcon:function(e){this.enableRightIcon!==e&&(this.enableRightIcon=e,this.safeRerender())}}),Ext.define("Terrasoft.core.ImageApi",{extend:"Terrasoft.BaseObject",alternateClassName:"Terrasoft.ImageApi",singleton:!0,defaultChunkSize:524288,uploadWebServicePath:"ImageAPIService/upload",uploadFromUrlWebServicePath:"ImageAPIService/uploadFromUrl",uploadUsingDataUrlWebServicePath:"ImageAPIService/uploadUsingDataUrl",loadImageData:{},upload:function(e){if(!e||!e.file)throw new Terrasoft.NullOrEmptyException({message:Terrasoft.Resources.ImageApi.ImageFileNullOrEmptyMessage});var t=this.createImageData(e),r=t.file,n=t.imageId,i=[Terrasoft.workspaceBaseUrl,this.uploadWebServicePath].join("/");return FileAPI.upload({url:i,data:t.data,files:{file:r},headers:{BPMCSRF:Ext.util.Cookies.get("BPMCSRF")||""},chunkSize:t.chunkSize,progress:this.onLoadProgress.bind(this,n),complete:this.onLoadComplete.bind(this,n)}),n},uploadFromUrl:function(e){if(!e||!e.dataUrl)throw new Terrasoft.NullOrEmptyException({message:Terrasoft.Resources.ImageApi.ImageFileNullOrEmptyMessage});var t=this.createImageData(e).imageId,r=Terrasoft.combinePath(Terrasoft.workspaceBaseUrl,this.uploadFromUrlWebServicePath);Terrasoft.AjaxProvider.request({url:r,scope:this,jsonData:{imageId:t,dataUrl:e.dataUrl},callback:this.onLoadFromServiceComplete.bind(this,t)})},uploadUsingDataUrl:function(e){if(!e||!e.dataUrl)throw new Terrasoft.ArgumentNullOrEmptyException({argumentName:"dataUrl"});var t=this.createImageData(e).imageId,r=Terrasoft.combinePath(Terrasoft.workspaceBaseUrl,this.uploadUsingDataUrlWebServicePath);Terrasoft.AjaxProvider.request({url:r,scope:this,jsonData:{imageId:t,fileName:e.fileName,dataUrl:e.dataUrl},callback:this.onLoadFromServiceComplete.bind(this,t)})},uploadFromDom:function(e){if(!e||!e.image)throw new Terrasoft.ArgumentNullOrEmptyException({argumentName:"image"});var t=e.image,r=document.createElement("canvas");r.width=e.width||t.width,r.height=e.height||t.height,r.getContext("2d").drawImage(t,0,0);var n=r.toDataURL("image/png"),i=t.src.endsWith(".png")?t.src:t.src+".png";this.uploadUsingDataUrl(Ext.apply({fileName:i,dataUrl:n},e))},createImageData:function(e){var t=Terrasoft.generateGUID(),r=e.file||{},n=Ext.apply({chunkSize:this.defaultChunkSize},{imageId:t,scope:e.scope||this,data:{totalFileLength:r.size,fileId:t,mimeType:r.type}},e);return this.loadImageData[t]=n,n},onLoadProgress:function(e,t){var r=this.loadImageData[e],n=r.onProgress;n&&n.call(r.scope,e,t)},onLoadFromServiceComplete:function(e,t,r,n){var i=r?null:n;this.onLoadComplete(e,i,{response:n})},onLoadComplete:function(e,t,r){if(r.response){var n=Terrasoft.decode(r.response);n.error&&console.warn(n.error),t=t||!!n.error}var i=this.loadImageData[e];if(t){var a=i.onError;a&&a.call(i.scope,e,t,r)}else{var s=i.onComplete;s&&s.call(i.scope,e,Terrasoft.decode(r.response))}delete this.loadImageData[e]}}),Ext.define("Terrasoft.controls.mixins.FileUpload",{alternateClassName:"Terrasoft.FileUpload",fileUploadIdPrefix:"-fileupload",fileUploadInputFormEl:null,fileUploadInputEl:null,fileUploadFiles:null,fileUpload:!1,fileUploadMultiSelect:!0,fileApiWrapperCss:"js-fileapi-wrapper",fileTypeFilter:null,constructor:function(){this.callParent(arguments),this.fileTypeFilter=this.fileTypeFilter||[],this.fileUpload&&this.addEvents("filesSelected")},createHtmlConfig:function(){var e={tag:"input",id:this.id+this.fileUploadIdPrefix,type:"file",style:"display: none;"};Ext.isEmpty(this.markerValue)||(e["data-item-marker"]=this.markerValue);var t=this.fileTypeFilter;return t.length>0&&(e.accept=t.join(",")),this.fileUploadMultiSelect&&(e.multiple="multiple"),Ext.isIE11?{tag:"form",id:"form-"+this.id+this.fileUploadIdPrefix,style:"display: none",children:[e]}:e},addInputFile:function(e){var t=Ext.isIE11,r=this.createHtmlConfig(),n=e||this.getWrapEl(),i=FileAPI.Flash?n:Ext.getBody();t?(this.fileUploadInputFormEl=Ext.DomHelper.append(i,r,!0),this.fileUploadInputEl=this.fileUploadInputFormEl.child("input[type='file']")):this.fileUploadInputEl=Ext.DomHelper.append(i,r,!0),FileAPI.Flash&&(n.addCls(this.fileApiWrapperCss),FileAPI.Flash.mouseover({target:this.fileUploadInputEl.dom})),this.initInputFileEvents()},initInputFileEvents:function(){var e=this;this.on("click",this.onInputFileClick,this),this.fileUploadInputEl.dom.addEventListener?this.fileUploadInputEl.dom.addEventListener("change",(function(t){e.onInputFileChange(t,e)}),!1):this.fileUploadInputEl.dom.attachEvent?this.fileUploadInputEl.dom.attachEvent("onchange",(function(t){e.onInputFileChange(t,e)})):this.fileUploadInputEl.on("change",this.onInputFileChange,this)},onInputFileClick:function(e){Ext.EventManager.stopEvent(e),FileAPI.Flash||this.fileUploadInputEl.dom.click()},onInputFileChange:function(e,t){t||(t=this),Ext.EventManager.stopEvent(e);var r=FileAPI.getFiles(e);t.setFiles(r),Ext.isIE11?this.fileUploadInputFormEl.dom.reset():t.fileUploadInputEl.dom.value=null},setFiles:function(e){this.fileUploadFiles=e,this.fireEvent("filesSelected",this.fileUploadFiles)},getUploadImageData:function(e,t,r){FileAPI.readAsDataURL(e,(function(e){t.call(r||this,e.result)}))},destroy:function(){if(this.fileUploadInputEl&&this.fileUploadInputEl.dom){var e=this;this.un("click",this.onInputFileClick,this),this.fileUploadInputEl.dom.removeEventListener?this.fileUploadInputEl.dom.removeEventListener("change",(function(t){e.onInputFileChange(t,e)}),!1):this.fileUploadInputEl.dom.detachEvent?this.fileUploadInputEl.dom.detachEvent("onchange",(function(t){e.onInputFileChange(t,e)})):this.fileUploadInputEl.un("change",this.onInputFileChange,this),Ext.removeNode(this.fileUploadInputEl.dom),this.fileUploadInputFormEl&&Ext.removeNode(this.fileUploadInputFormEl.dom)}},addFileUploadBindConfig:function(e){e.fileUploadFiles={changeEvent:"filesSelected"}}}),Ext.define("Terrasoft.controls.Mask",{alternateClassName:"Terrasoft.Mask",extend:"Terrasoft.BaseObject",singleton:!0,mixins:{customEvent:"Terrasoft.mixins.CustomEventDomMixin"},defaultTimeout:500,defaultOpacity:.6,defaultBackgroundColor:"#ffffff",maskOpacityClass:"ts-mask-opacity",storage:{},defaultCaption:Terrasoft.Resources.Controls.Mask.Caption,defaultFrameVisible:!0,_defaultShowSpinner:!0,_className:"ts-mask-container",tpl:['<div class="{classNames}"','<tpl if="position">','style="{position}"',"</tpl> >",'<div class="{maskOpacityClass}" style="{opacityStyle}"></div>','<tpl if="showSpinnerEl">','<div class="{maskSpinnerClass}">','<div class="ts-mask-frame">','<div class="ts-mask-spinner">',"{progressSpinnerHtml}","</div>",'<div class="ts-mask-spinner-caption">',"<tpl>{caption}</tpl>","</div>","</div>","</div>","</tpl>","</div>"],_shellMaskId:null,_showShellMask:function(e){if(this._shellMaskId){if(!e.clearMasks)return null;this._hideShellMask()}return this._shellMaskId=Ext.id(),this.mixins.customEvent.publish("ShowBodyMask",e),this._shellMaskId},_hideShellMask:function(){this.mixins.customEvent.publish("HideBodyMask",this._shellMaskId),this._shellMaskId=null},show:function(e){Ext.isString(e)&&(e={selector:e});var t=this,r=(e=e||{}).selector;if(r||(r=e.selector="body"),window.useShellMask&&"body"===r&&!e.showHidden)return this._showShellMask(e);if(e.clearMasks)this.clearMasks(r);else if(this.isMaskExist(r))return null;var n=this.createMask(e);if(n.containerEl.set({maskState:"visible"}),e.showHidden){var i=n.opacity;n.opacity=0,this.renderMask(n.id);var a=n.el.child("div."+this.maskOpacityClass);n.timeoutId=setTimeout((function(){a.setOpacity(i)}),n.timeout)}else n.timeout?n.timeoutId=setTimeout((function(){t.renderMask(n.id)}),n.timeout):t.renderMask(n.id);return n.id},hide:function(e){if(this._shellMaskId&&this._shellMaskId===e)return this._hideShellMask();var t=this.storage[e];if(null!=t){var r=t.containerEl;if(r.set({maskState:"none"}),t.rendered&&!t.showHidden||clearTimeout(t.timeoutId),t.progressSpinner&&!t.progressSpinner.destroyed&&t.progressSpinner.destroy(),t.rendered){t.el.destroy();var n=t.parentStylePosition;"absolute"!==n&&"relative"!==n&&"fixed"!==n&&r.setStyle("position","")}delete this.storage[e]}},clearMasks:function(e){Terrasoft.each(this.storage,(function(t){t.containerEl.is(e)&&this.hide(t.id)}),this),this._shellMaskId&&"body"===e&&this._hideShellMask(this._shellMaskId)},clearAllMasks:function(){Terrasoft.each(this.storage,(function(e){this.hide(e.id)}),this),this._shellMaskId&&this._hideShellMask(this._shellMaskId)},createMask:function(e){var t={timeout:this.defaultTimeout,opacity:this.defaultOpacity,backgroundColor:this.defaultBackgroundColor,caption:this.defaultCaption,frameVisible:this.defaultFrameVisible,showSpinner:this._defaultShowSpinner},r=Ext.applyIf(e,t),n=Ext.id(null),i=Ext.select(r.selector);if(i.getCount()>1)throw new Terrasoft.UnknownException({message:Terrasoft.Resources.Controls.Mask.DuplicateContainerException});var a=i.item(0);if(!a)throw new Terrasoft.NullOrEmptyException({message:Terrasoft.Resources.Exception.NullOrEmptyException});var s,o=Ext.apply({containerEl:a,id:n},r);e.showSpinner?(e.caption&&(s="Terrasoft.CircleSpinner"),o.progressSpinner=o.progressSpinner||Terrasoft.getSpinner("ts-mask-spinner",s)):this._destroyProgressSpinner(o);return this.storage[n]=o,o},_destroyProgressSpinner:function(e){e.progressSpinner&&e.progressSpinner.destroy()},isMaskExist:function(e){var t=!1;return Terrasoft.each(this.storage,(function(r){if(r.containerEl.is(e))return t=!0,!1}),this),t},renderMask:function(e){var t=this.storage[e],r=t.containerEl,n=t.parentStylePosition=r.getStyle("position");"absolute"!==n&&"relative"!==n&&"fixed"!==n&&r.setStyle("position","relative");var i=t.tpl=new Ext.XTemplate(this.tpl.join(""),{}),a={opacity:t.opacity,backgroundColor:t.backgroundColor},s="ts-mask-spinner-wrap";t.frameVisible&&(s+=" ts-mask-spinner-frame-visible");var o=Ext.DomHelper.generateStyles(a),l="BODY"===r.dom.nodeName?"position: fixed":"",c=t.progressSpinner&&t.progressSpinner.generateHtml(),u=!1!==t.showSpinnerEl,h=this._className;t.additionalClass&&(h+=" "+t.additionalClass);var f=t.el=i.append(r,{opacityStyle:o,progressSpinnerHtml:c,caption:t.caption,position:l,showSpinnerEl:u,maskSpinnerClass:s,maskOpacityClass:this.maskOpacityClass,classNames:h},!0);t.showSpinner&&t.progressSpinner.show(),f.on("click",this.onMaskElClick),t.rendered=!0},updateCaption:function(e,t){if(this._shellMaskId!==e){var r=this.storage[e];if(r.caption=t,r.rendered){var n=r.el.query(".ts-mask-spinner-caption")[0];if(!n)throw new Terrasoft.exceptions.ItemNotFoundException({message:"Element with selector '.ts-mask-spinner-caption' not found"});n.innerText=t}}},onMaskElClick:function(e){e.stopPropagation()}}),Ext.ns("Terrasoft"),Ext.define("Terrasoft.controls.Component",{extend:"Terrasoft.core.BaseObject",alternateClassName:"Terrasoft.Component",mixins:{bindable:"Terrasoft.Bindable",expandableTip:"Terrasoft.ExpandableTip"},statics:{idGenerator:null,defaultComponentId:"t-comp",getIdGenerator:function(){return null===this.idGenerator&&(this.idGenerator=new Ext.data.SequentialIdGenerator({prefix:this.defaultComponentId,seed:0})),this.idGenerator},generateId:function(){return this.getIdGenerator().generate()}},id:null,tabIndex:1,wrapEl:null,styleRegexTemplate:'style\\s*=\\s*"{(\\w*)}"',cssRegexTemplate:'class\\s*=\\s*"{(\\w*)}"',rendered:!1,rendering:!1,uses:["Ext.Element","Ext.DomHelper","Ext.XTemplate","Ext.ComponentQuery","Ext.ComponentLoader","Ext.EventManager"],renderTpl:"{%this.renderComponent(out, values)%}",disabledClass:"",selectors:null,tpl:null,tplData:null,renderTo:null,styles:null,classes:null,visible:!0,enabled:!0,html:null,tag:"",isComponent:!0,markerValue:"",useMarkerValue:!1,maskVisible:!1,maskId:"",maskTimeout:null,ownerCt:null,ownerCtListeners:null,domAttributes:null,ownerCtPropertyName:null,observeMutations:null,mutationConfig:null,direction:null,constructor:function(e){this.useMarkerValue=Terrasoft.useMarkerValue,this.className=this.$className,this.mixins.expandableTip.constructor.call(this,e),this.mixins.bindable.constructor.call(this,e),this.callParent(arguments),this.addEvents("init","added","enabledchanged","visiblechanged","beforererender","afterrender","afterrerender","destroy","canExecute","mutate"),Ext.isEmpty(this.id)&&(this.id=Terrasoft.Component.generateId()),this.init(),this.fireEvent("init",this),Terrasoft.ComponentManager.register(this),this.renderTo&&this.render(this.renderTo,null)},initMutationObserver:function(){var e=document.getElementById(this.id);this.mutationObserver=new MutationObserver(function(e){Terrasoft.each(e,(function(e){this.fireEvent("mutate",e)}),this)}.bind(this)),this.mutationObserver.observe(e,this.mutationConfig)},getBubbleParent:function(){return this.ownerCt},applySelectors:function(e){var t=this;if(!this.rendered)throw new Terrasoft.UnknownException({message:Terrasoft.Resources.Controls.Component.ComponentIsNotRendered});if(!this.verifySelectors())throw new Terrasoft.NullOrEmptyException({message:Terrasoft.Resources.Controls.Component.RequiredSelectorsAreNotDefined});var r=this.selectors,n=r.wrapEl,i=Ext.getDom(e);i||(i=Ext.getBody().dom);var a=Ext.DomQuery.is(i,n)?Ext.get(i):this.selectNode(n,i);if(null==a)throw new Terrasoft.ItemNotFoundException;this.wrapEl=a;var s=a.dom;Terrasoft.each(r,(function(e,r){if("wrapEl"!==r){var n;n=Ext.isObject(e)?e.selector:e;var i=t.selectNode(n,s);t[r]=i}})),this.bindSelectors()},selectNode:function(e,t){if(!e||!t)throw new Terrasoft.ArgumentNullOrEmptyException;var r=Ext.DomQuery.selectNode(e,t);return!r&&Ext.DomQuery.is(t,e)&&(r=t),Ext.get(r)},generateRenderConfig:function(){var e={},t=e.tpl=this.generateRenderTemplate();return Ext.isEmpty(t)||(e.tplData={},this.initRenderData(e.tplData)),e},generateRenderTemplate:function(){var e=Ext.XTemplate.getTpl(this,"renderTpl");return this.initRenderTemplate(e),e},renderComponent:function(e,t){var r=t.self;if(r.html)Ext.DomHelper.generateMarkup(r.html,e);else{var n=r.getTpl(),i=r.getTplData();n=r.processTemplate(n,i);var a=new Ext.XTemplate(n);r.prepareTpl(a,i),a.applyOut(i,e)}},copySourceToTplData:function(e,t){var r=this[e]||{},n={};"classes"===e&&(n=this.classes||{}),Terrasoft.each(r,(function(r,i){var a=Terrasoft.deepClone(r);if("classes"===e)a=Ext.Array.merge(t[i]||[],n[i]||[]);else if(t[i])return;t[i]=Ext.isArray(a)?a:Ext.apply({},a)}))},processTpl:function(e,t,r,n){var i=new RegExp(e,"gm");return t.replace(i,(function(e,t){if(!t)return"";var i=r[t];return i?n(i):""}))},removeElementsBySelectors:function(e){var t=this;Terrasoft.each(this.selectors,(function(r,n){var i=t[n];null!=i&&(delete t[n],!0!==e&&i.destroy())}))},processTemplate:function(e,t){var r=e;return Ext.isArray(r)&&(r=r.join("")),this.copySourceToTplData("styles",t),this.copySourceToTplData("classes",t),r=this.processTpl(this.styleRegexTemplate,r,t,(function(e){return'style="'+(Ext.isString(e)?e:Ext.DomHelper.generateStyles(e))+'"'})),r=this.processTpl(this.cssRegexTemplate,r,t,(function(e){return'class="'+(Ext.isArray(e)?e.join(" "):e)+'"'})),r=this.encodeHtmlTemplate(r)},encodeHtmlTemplate:function(e){return Ext.isString(e)&&(e=(e=(e=e.replace(/\s+/g," ")).replace(/\\u/g,"&#92;u")).replace(/\\x/g,"&#92;x")),e},init:function(){this.on("afterrender",this.onAfterRender,this),this.on("afterrerender",this.onAfterReRender,this),this.on("beforererender",this.onBeforeReRender,this)},canExecute:function(e){var t=e.args,r=t[t.length-1];if(r&&r.isComeBack)return!0;Array.prototype.push.call(e.args,{isComeBack:!0}),Ext.apply(e,{scope:this});var n=this.fireEvent("canExecute",e);return n},onAfterRender:function(e,t){this.rendered=!0,this.rendering=!1,this.applySelectors(t),this.initDomEvents(),this.addWrapAttr(),this.setDomAttributes(this.domAttributes),this.observeMutations&&this.initMutationObserver()},onBeforeReRender:function(){this.selectorsWereBind=!1},addWrapMarkerValue:function(){if(this.useMarkerValue){var e=this.markerValue;if(!Ext.isEmpty(e)){var t=this.getWrapEl();t&&t.dom.setAttribute("data-item-marker",Terrasoft.encodeHtml(e))}}},addWrapAttr:function(){this.addWrapMarkerValue()},onAfterReRender:function(e,t){this.rendered=!0,this.rendering=!1,this.applySelectors(t),this.initDomEvents(),this.addWrapAttr(),this.setDomAttributes(this.domAttributes),this.observeMutations&&this.initMutationObserver()},verifySelectors:function(){var e=this.selectors,t=!1;return e&&e.wrapEl&&(t=!0),t},initDomEvents:function(){this.mixins.expandableTip.initDomEvents.call(this)},clearDomListeners:function(){var e=this;Terrasoft.each(this.selectors,(function(t,r){var n=e[r];null!=n&&Ext.EventManager.removeAll(n)})),this.selectorsWereBind=!1,this.mixins.expandableTip.clearDomListeners.call(this)},initRenderTemplate:function(e){e.renderComponent=this.renderComponent},initRenderData:function(e){e.self=this},getTpl:function(){return this.tpl||""},getTplData:function(){var e={id:this.id,self:this,tabIndex:this.tabIndex,direction:this.direction};return Ext.apply(e,this.tplData||{})},getBindConfig:function(){return{visible:{changeMethod:"setVisible"},enabled:{changeMethod:"setEnabled"},maskVisible:{changeMethod:"setMaskVisible"},markerValue:{changeMethod:"setMarkerValue",disabled:!this.useMarkerValue},domAttributes:{changeMethod:"setDomAttributes"},wrapStyle:{changeMethod:"setWrapStyle"}}},allowRerender:function(){return!0===this.visible&&!0===this.rendered},reRender:function(e,t){if(Ext.isEmpty(e)&&Ext.isEmpty(t)){this.rendering=!0,this.fireEvent("beforeRerender",this);var r=this.getWrapEl();if(Ext.isEmpty(r))this.ownerCt.allowRerender()&&this.ownerCt.reRender();else{this.clearDomListeners(),this.removeElementsBySelectors(!0);var n=this.generateHtml(),i=r.parent(),a=Ext.DomHelper.append(i,n);r.dom.parentNode.replaceChild(a,r.dom);var s=Ext.get(a);this.fireEvent("afterrerender",this,s)}}else this.deprecatedReRender(e,t)},safeRerender:function(){this.allowRerender()&&this.reRender.apply(this,arguments)},deprecatedReRender:function(e,t){var r;this.rendering=!0,this.fireEvent("beforeRerender",this);var n,i=this.getWrapEl(),a=null!==(r=null==i?void 0:i.dom)&&void 0!==r?r:{},s=a.previousSibling,o=this.ownerCt,l=o?o.getRenderToEl(this):null,c="beforeend",u=n=t?t.dom:o?l.dom:a.parentNode;if(null!=e){if(e<0)throw Terrasoft.ArgumentNullOrEmptyException();t?0===e?c="afterbegin":(u=Terrasoft.getVisibleDomItems(n.childNodes,[a])[e-1],c="afterend"):(s=0===e?null:Terrasoft.getVisibleDomItems(n.childNodes,[a])[e-1])===a&&(s=s.nextSibling)}t||(u=null==s?n:s,c=null==s?"afterbegin":"afterend"),this.clearDomListeners(),this.removeElementsBySelectors();var h=this.generateHtml();Ext.DomHelper.insertHtml(c,u,h),this.fireEvent("afterrerender",this,n)},onOwnerCtBeforeRerender:function(){this.fireEvent("beforererender",this),this.rendered&&(this.clearDomListeners(),this.removeElementsBySelectors(),this.rendered=!1)},onOwnerCtAfterRenderOrAfterRerender:function(e){if(!0===this.rendering&&this.visible){var t=this.ownerCt.getWrapEl();this.fireEvent(e,this,t)}},added:function(e){if(this.ownerCt=e,this.fireEvent("added",this,e),this.ownerCtListeners=e.on({beforererender:this.onOwnerCtBeforeRerender,afterrender:{fn:this.onOwnerCtAfterRenderOrAfterRerender.bind(this,"afterrender"),scope:this},afterrerender:this.onOwnerCtAfterRenderOrAfterRerender.bind(this,"afterrerender"),scope:this,destroyable:!0}),!0===e.rendered){var t=e.indexOf(this),r=e.getRenderToEl(this);this.render(r,t)}},removed:function(){this.ownerCt=null,this.ownerCtListeners.destroy()},prepareTpl:function(e,t){Terrasoft.each(t,(function(t,r){Ext.isFunction(t)&&(e[r]=t)}))},onDestroy:function(){var e=this.ownerCt;e&&(e.remove(this),this.ownerCt=null,this.ownerCtListeners.destroy()),this.fireEvent("destroy",this),this.mixins.bindable.destroy.call(this),this.mixins.expandableTip.destroy.call(this),Terrasoft.ComponentManager.unregister(this),this.clearListeners(),this.rendered&&(this.clearDomListeners(),this.removeElementsBySelectors()),this.rendered=!1,this.callParent(arguments),this.mutationObserver&&this.mutationObserver.disconnect()},getWrapEl:function(){return this.wrapEl},render:function(e,t){if(!e)throw new Terrasoft.ArgumentNullOrEmptyException;if(!e.dom)throw new Terrasoft.UnsupportedTypeException;if(!0!==this.rendered){if(!0===this.visible){var r=e.dom,n=this.generateHtml(),i="beforeend",a=r;if(null!=t){if(t<0)throw Terrasoft.ArgumentNullOrEmptyException();if(0===t)a=r,i="afterbegin";else{var s=r.childNodes;i="afterend",(a=s[t-1])||(0===s.length?(a=r,i="afterbegin"):a=s[s.length-1])}}Ext.DomHelper.insertHtml(i,a,n),this.fireEvent("afterrender",this,e)}}else{var o=Terrasoft.Resources.Controls.Component.ComponentIsAlreadyRendered,l=Terrasoft.getFormattedString(o,this.id);this.log(l,Terrasoft.LogMessageType.ERROR)}},generateHtml:function(){if(!0!==this.visible)return"";var e=[];this.rendering=!0;var t=this.generateRenderConfig();return t.tpl.applyOut(t.tplData,e),e.join("")},getOwnerCtViewItemsPropertyName:function(){return this.ownerCtPropertyName},setOwnerCtViewItemsPropertyName:function(e){this.ownerCtPropertyName=e},setDomAttributes:function(e){if(e&&!Ext.isEmpty(e["data-item-marker"]))throw new Terrasoft.InvalidOperationException;var t={};Terrasoft.each(Object.keys(this.domAttributes||{}),(function(e){t[e]=void 0}),this),Ext.apply(t,e),this.domAttributes=e,this.wrapEl&&this.wrapEl.set(t)},setWrapStyle:function(e){Ext.isObject(e)&&(this.styles=Ext.apply(this.styles||{},{wrapStyle:e}),this.safeRerender())},getDomAttributes:function(){return this.domAttributes},setEnabled:function(e){if(this.enabled!==e){this.enabled=e;var t=this.disabledClass,r=this.getWrapEl();r&&t&&this.rendered&&(e?r.removeCls(t):r.addCls(t)),this.fireEvent("enabledchanged",e,this)}},updateDirection:function(e){var t=Terrasoft.getTextDirection(e);this.direction=t},isVisible:function(){return!1!==this.visible&&!1!==this.rendered&&(!(this.ownerCt&&!this.ownerCt.isVisible())&&this.getWrapEl().isVisible(!0))},setVisible:function(e){if(this.visible!==e){if(this.visible=e,!0===e){var t,r=this.ownerCt,n=null;r?(t=r.getRenderToEl(this),n=r.indexOf(this)):t=this.renderTo,!1===this.rendered?t&&(-1===n&&(n=null),this.render(t,n)):this.reRender()}else if(!0===this.rendered){var i=this.getWrapEl();i&&(i.dom.style.display=e?"":"none")}this.fireEvent("visiblechanged",this,e)}},getRenderToEl:function(){return this.getWrapEl()},setMarkerValue:function(e){this.markerValue!==e&&(this.markerValue=e,this.rendered&&this.addWrapAttr())},setMaskVisible:function(e){if(this.maskVisible!==e&&this.rendered)if(this.maskVisible=e,e){var t=this.getMaskConfig();this.maskId=Terrasoft.Mask.show(t)}else Terrasoft.Mask.hide(this.maskId),this.maskId=null},getMaskEl:function(){return this.getWrapEl()},getMaskConfig:function(){var e={selector:"#"+this.getMaskEl().id,caption:"",frameVisible:!1};return null!==this.maskTimeout&&(e.timeout=this.maskTimeout),e},validateBindingContext:function(e){"Terrasoft.controls.Component"!==this.className&&this.model!==e&&this.log(Terrasoft.Resources.Controls.Component.BindingContextWarningMessage)},bind:function(e){this.mixins.bindable.bind.call(this,e),this.mixins.expandableTip.bind.call(this,this.model),this.validateBindingContext(e)},clearTimer:function(e){var t=this[e];return t&&(clearTimeout(t),this[e]=null),Boolean(t)},isEventWithin:function(e){var t=!1,r=this.getWrapEl();return r&&(t=e.within(r)),t}}),Ext.define("Terrasoft.util.Group",{extend:"Terrasoft.BaseObject",alternateClassName:"Terrasoft.Group",items:null,name:null,activeItem:null,constructor:function(e){if(!e.name)throw new Terrasoft.NullOrEmptyException({message:Terrasoft.Resources.GroupManager.EmptyGroupName});this.callParent(arguments),this.items=Ext.create("Terrasoft.Collection")},unSubscribeItem:function(e){e.un({activechanged:{fn:this.onItemActiveChanged,scope:this},destroy:{fn:this.onItemDestroy,scope:this}})},onDestroy:function(){this.callParent(arguments);var e=this.items;e.each((function(e){this.unSubscribeItem(e),e.group=null,e.groupName=null}),this),this.items.clear(),delete this.items,delete this.activeItem;var t=Terrasoft.util.GroupManager;t&&Terrasoft.util.GroupManager.removeGroup(this)},onItemActiveChanged:function(e,t){if(!1!==t){var r=this.activeItem;r&&r.setActive(!1),this.activeItem=e}},onItemDestroy:function(e){this.removeItem(e)},addItem:function(e){this.items.add(e.id,e),e.on({activechanged:{fn:this.onItemActiveChanged,scope:this},destroy:{fn:this.onItemDestroy,scope:this}}),e.groupName=this.name,e.group=this},removeItem:function(e){this.items.remove(e),this.activeItem===e&&(this.activeItem=null),e.group=null,e.groupName=null,this.unSubscribeItem(e)}}),Ext.define("Terrasoft.util.Groupable",{alternateClassName:"Terrasoft.Groupable",extend:"Terrasoft.BaseObject",group:null,groupName:null,constructor:function(){this.callParent(arguments),this.addEvents("activechanged"),this.setGroup(this.groupName)},setActive:function(e){this.group&&this.fireEvent("activechanged",this,e)},setGroup:function(e){var t=this.group;if(t){if(t.name===e)return;t.removeItem(this)}if(e){var r=Terrasoft.util.GroupManager;(t=r.findGroup(e))||(t=r.createGroup(e),r.addGrooup(t)),t.addItem(this)}}}),Terrasoft.util.GroupManager=function(){var e=Ext.create("Terrasoft.Collection");return{createGroup:function(e,t){var r=Ext.create("Terrasoft.Group",{name:e});return Ext.apply(r,t||{}),r},addGrooup:function(t){e.add(t.name,t)},removeGroup:function(t){e.remove(t)},getGroup:function(e){var t=this.findGroup(e);if(!t)throw new Terrasoft.ItemNotFoundException({message:Terrasoft.Resources.GroupManager.GroupWithNameNotFound+" - <"+e+">"});return t},findGroup:function(t){var r=e.find(t);return r||null},clear:function(){e.clear()},destroy:function(){e.destroy(),Terrasoft.util.GroupManager=null}}}(),Ext.define("Terrasoft.controls.AbstractContainer",{extend:"Terrasoft.controls.Component",alternateClassName:"Terrasoft.AbstractContainer",mixins:{resizable:"Terrasoft.Resizable"},detail:null,itemRenderTplName:"<@item>",renderTpl:"{%this.renderContainer(out, values)%}",items:null,selectors:null,defaultRenderTpl:null,backgroundColor:null,viewConfigItems:null,itemEventHandlers:null,itemsEventMap:null,onMappedItemEventFired:function(e,t){for(var r=[e],n=0;n<t.length;n++)r.push(t[n]);r.push(this),this.fireEvent.apply(this,r)},subscribeItemMappedEvents:function(e){Terrasoft.each(this.itemsEventMap,(function(t,r){if(e.events[r]){var n=e.id+r;this.itemEventHandlers[n]=function(){this.onMappedItemEventFired(t,arguments)}.bind(this),e.on(r,this.itemEventHandlers[n],this)}}),this)},unSubscribeItemMappedEvents:function(e){Terrasoft.each(this.itemsEventMap,(function(t,r){var n=e.id+r;this.itemEventHandlers[n]&&(e.un(r,this.itemEventHandlers[n],this),delete this.itemEventHandlers[n])}),this)},initItems:function(){this.viewConfigItems=this.items,this.initItemsCollection(),this.addViewConfigItems()},addViewConfigItems:function(){this.add(this.viewConfigItems)},initItemsCollection:function(){var e=this.items=new Ext.util.MixedCollection(!1,this.getComponentId);e.on("add",this.onItemAdd,this),e.on("remove",this.onItemRemove,this)},onItemAdd:function(e,t){t.added(this),this.subscribeItemMappedEvents(t)},onItemRemove:function(e){e.removed(this),this.unSubscribeItemMappedEvents(e),this.safeRerender()},prepareItems:function(e){if(!Ext.isArray(e))throw new Terrasoft.UnsupportedTypeException;for(var t=0,r=e.length;t<r;t++)e[t]=this.prepareItem(e[t]);return e},prepareItem:function(e){return!0===e.isComponent?e:Ext.create(e.className||"Terrasoft.Component",e)},getComponentId:function(e){return e.id},renderItem:function(e,t){var r=t.generateHtml();e.push(r)},renderContainer:function(e,t){var r=t.self;if(r.html)Ext.DomHelper.generateMarkup(r.html,e);else{var n=r.getTpl(),i=r.getTplData();r.applyViewItemsPropertiesElSelector(r.selectors),r.initRenderData(i),n=r.processTemplate(n,i),n=new Ext.XTemplate(n),r.prepareTpl(n,i),n.applyOut(i,e)}},processTemplate:function(){var e=this.callParent(arguments),t=new RegExp(this.itemRenderTplName,"gim");return e=e.replace(t,"{%this.renderItem(out, values, xindex - 1)%}"),e=this.processViewItemsPropertiesItemTemplate(e)},init:function(){this.callParent(arguments),this.initContainerEvents(),this.initItems(),this.initViewItemsProperties(),this.initResizeEvents()},getViewItemsPropertyNames:function(){return[]},initViewItemsProperties:function(){Terrasoft.each(this.getViewItemsPropertyNames(),(function(e){this.initViewItemsProperty(e)}),this)},initViewItemsProperty:function(e){var t=this[e],r=this[e]=new Ext.util.MixedCollection(!1,this.getComponentId);r.on("add",(function(t,r){this.onViewItemsPropertyAdd(e,t,r)}),this),r.on("remove",(function(e){this.onViewItemsPropertyRemove(e)}),this),this.addViewItemsPropertyItem(e,t)},onViewItemsPropertyAdd:function(e,t,r){var n=this.getViewItemsPropertyRenderToEl(e);r.added(this,n,t)},onViewItemsPropertyRemove:function(e){e.removed(this),this.safeRerender()},applyViewItemsPropertiesElSelector:function(e){Terrasoft.each(this.getViewItemsPropertyNames(),(function(t){this.applyViewItemsPropertyElSelector(e,t)}),this)},applyViewItemsPropertyElSelector:function(e,t){e[this.getViewItemsPropertyElName(t)]=Ext.String.format("#{0}-{1}",this.id,t)},getViewItemsPropertyElName:function(e){return Ext.String.format("{0}El",e)},getViewItemsPropertyRenderToEl:function(e){return this[this.getViewItemsPropertyElName(e)]},processViewItemsPropertiesItemTemplate:function(e){return Terrasoft.each(this.getViewItemsPropertyNames(),(function(t){e=this.processViewItemsPropertyItemTemplate(e,t)}),this),e},processViewItemsPropertyItemTemplate:function(e,t){var r=new RegExp(this.getViewItemsPropertyRenderTplName(t),"gim");return e.replace(r,"{%this.renderViewItemsPropertyItem(out, values, '"+t+"', xindex - 1)%}")},getViewItemsPropertyRenderTplName:function(e){return Ext.String.format("<@{0}-view-property-item>",e)},initRenderViewItemsPropertiesData:function(e){e.renderViewItemsProperty=this.renderViewItemsProperty,e.renderViewItemsPropertyItem=this.renderViewItemsPropertyItem,Terrasoft.each(this.getViewItemsPropertyNames(),(function(t){e[t]=this[t]}),this)},getViewItemsPropertyRenderTemplateTree:function(e){var t=[],r=this[e];if(!r)return t;for(var n=0,i=r.length;n<i;n++){var a=r.getAt(n).generateHtml();t.push(a)}return t},renderViewItemsProperty:function(e,t,r){var n=t.self.getViewItemsPropertyRenderTemplateTree(r);Ext.DomHelper.generateMarkup(n,e)},renderViewItemsPropertyItem:function(e,t){var r=t.generateHtml();e.push(r)},destroyViewItemsProperty:function(){Terrasoft.each(this.getViewItemsPropertyNames(),(function(e){this.destroyItemsCollection(this[e]),this[e]=null}),this)},bindViewItemsProperties:function(e){Terrasoft.each(this.getViewItemsPropertyNames(),(function(t){this.bindViewItemsProperty(e,t)}),this)},bindViewItemsProperty:function(e,t){var r=this[t];Ext.isEmpty(r)||r.each((function(t){t.bind(e)}))},addViewItemsPropertyItem:function(e,t){this.addToCollection(t,this[e],e)},insertViewItemsPropertyItem:function(e,t,r){this.insertIntoCollection(t,r,this[e])},removeViewItemsPropertyItem:function(e,t){this.removeFromCollection(t,this[e])},indexOfViewItemsPropertyItem:function(e,t){return this.indexOfCollection(t,this[e])},initContainerEvents:function(){this.itemEventHandlers=this.itemEventHandlers||{},this.addEvents("beforeadd","add","removed","beforeinsert","insert")},initRenderTemplate:function(e){this.callParent(arguments),e.renderContainer=this.renderContainer},initRenderData:function(e){this.callParent(arguments),e.items=this.items,e.renderItems=this.renderItems,e.renderItem=this.renderItem,this.initRenderViewItemsPropertiesData(e)},onAfterRender:function(){this.callParent(arguments),this.initResizer()},onAfterReRender:function(){this.callParent(arguments),this.initResizer()},getTpl:function(){var e=this.callParent(arguments);return e||(e=this.getDefaultRenderTemplate()),e},getDefaultRenderTemplate:function(){var e=this.selectors=this.selectors||{};return e.wrapEl||(e.wrapEl="#"+this.id),this.defaultRenderTpl},getItemsRenderTemplateTree:function(){var e=[],t=this.items;if(!t)return e;for(var r=0,n=t.length;r<n;r++){var i=t.getAt(r).generateHtml();e.push(i)}return e},renderItems:function(e,t){var r=t.self.getItemsRenderTemplateTree();Ext.DomHelper.generateMarkup(r,e)},addToCollection:function(e,t,r){if(e){var n=Ext.isArray(e)?e:[e];n=this.prepareItems(n,r),this.fireEvent("beforeadd",this,n,t);for(var i=0,a=n.length;i<a;i++){var s=n[i];Ext.isEmpty(r)||s.setOwnerCtViewItemsPropertyName(r),t.add(s)}this.fireEvent("add",this,n,t)}},insertIntoCollection:function(e,t,r){if(!Ext.isNumber(t))throw new Terrasoft.UnsupportedTypeException;var n=Ext.isArray(e)?e:[e];n=this.prepareItems(n),this.fireEvent("beforeinsert",this,n,t,r);for(var i=0,a=n.length;i<a;i++){var s=n[i];r.insert(t+i,s)}this.fireEvent("insert",this,n,t,r)},removeFromCollection:function(e,t){t.remove(e),this.fireEvent("removed",this,e,t)},indexOfCollection:function(e,t){var r=new Ext.util.Filter({filterFn:function(e){return!0===e.visible||!0===e.rendered}});return t.filter(r).indexOfKey(e.id)},destroyItemsCollection:function(e){e.clearListeners(),this.clearItemsCollection(e),e.destroy()},destroyItem:function(e){this.unSubscribeItemMappedEvents(e),e.destroy()},clearItemsCollection:function(e){e.each((function(e){this.destroyItem(e)}),this),e.clear()},onDestroy:function(){this.destroyViewItemsProperty(),this.destroyItems(),this.callParent(arguments)},destroyItems:function(){this.destroyItemsCollection(this.items),this.items=null},add:function(e){this.addToCollection(e,this.items)},insert:function(e,t){this.insertIntoCollection(e,t,this.items)},remove:function(e){var t=this.getItemViewItemsPropertyName(e);Ext.isEmpty(t)?this.removeFromCollection(e,this.items):this.removeViewItemsPropertyItem(t,e)},bind:function(){this.callParent(arguments),this.bindItems(this.model),this.bindViewItemsProperties(this.model)},bindItems:function(e){this.items.each((function(t){t.bind(e)}))},indexOf:function(e){var t=this.getItemViewItemsPropertyName(e);return Ext.isEmpty(t)?this.indexOfCollection(e,this.items):this.indexOfViewItemsPropertyItem(t,e)},getItemViewItemsPropertyName:function(e){return!Ext.isEmpty(e)&&Ext.isFunction(e.getOwnerCtViewItemsPropertyName)?e.getOwnerCtViewItemsPropertyName():null},getRenderToEl:function(e){var t=this.getItemViewItemsPropertyName(e);return Ext.isEmpty(t)?this.wrapEl:this.getViewItemsPropertyRenderToEl(t)},getMaskConfig:function(){return{selector:"#"+this.getMaskEl().id}},getBindConfig:function(){var e=this.callParent(arguments),t={backgroundColor:{changeMethod:"setBackgroundColor"}};return Ext.apply(t,e),t},setBackgroundColor:function(e){this.backgroundColor!==e&&(this.backgroundColor=e,this.styles=Ext.Object.merge(this.styles||{},{wrapStyles:{"background-color":e}}),this.safeRerender())},isEventWithin:function(e){var t=this.callParent(arguments);return!t&&this.items&&this.items.each((function(r){if(t=r.isEventWithin(e))return!1}),this),t}}),Ext.ns("Terrasoft.controls.TipEnums"),Terrasoft.controls.TipEnums.style={GREEN:"green",RED:"red",BLUE:"blue",WHITE:"white",YELLOW:"yellow"},Terrasoft.TipStyle=Terrasoft.controls.TipEnums.style,Ext.define("Terrasoft.controls.Tip",{extend:"Terrasoft.controls.AbstractContainer",alternateClassName:"Terrasoft.Tip",mixins:{alignable:"Terrasoft.Alignable"},closeOnMouseLeave:!1,wrapElPadding:1,tipSize:.6,disabledClass:"tip-disabled",toolsWrapClass:"tip-tools-wrap",defaultRenderTpl:['<div id="{id}-wrapEl" class="{wrapClass}" style="{wrapStyle}">','<span class="tip-anchor"></span>','<div class="tip-border">','<div id="{id}" class="tip-panel">','<tpl if="displayTools">','<div id="{id}-tip-tools" class="{toolsWrapClasses}">','<tpl for="tools">',"{%this.renderTool(out, values)%}","</tpl>","</div>","</tpl>",'<div id="{id}-content" class="tip-content"<tpl if="direction"> dir="{direction}"</tpl>>',"{content}</div>",'<tpl if="self.items.length">','<div id="{id}-items" class="tip-items" style="{itemsWrapStyles}">',"{%this.renderItems(out, values)%}","</div>","</tpl>","</div>","</div>","</div>"],visible:!1,showTimerId:null,hideTimerId:null,displayMode:null,style:null,tools:null,content:null,showDelay:1e3,hideDelay:200,initialAlignType:Terrasoft.AlignType.BOTTOM,hideOnScroll:!0,constructor:function(){this.callParent(arguments),this.renderTo=Ext.getBody(),this.addEvents("linkClicked","beforeVisibilityChange")},initTools:function(){this.tools=this.prepareItems(this.tools||[]),Terrasoft.each(this.tools,(function(e){e.added(this)}),this)},renderTool:function(e,t){var r=t.generateHtml();e.push(r)},delayedShow:function(){this.clearTimer("showTimerId"),this.setVisible(!0)},delayedHide:function(){this.clearTimer("hideTimerId"),this.setVisible(!1)},clearTimer:function(e){var t=this[e];return t&&(clearTimeout(t),this[e]=null),Boolean(t)},onMouseEnter:function(){this.closeOnMouseLeave=this.clearTimer("hideTimerId")},onMouseLeave:function(){this.closeOnMouseLeave&&(this.closeOnMouseLeave=!1,this.hide())},onContentClick:function(e){var t=Ext.get(e.target);if(!Ext.DomQuery.is(t.dom,"a")){var r=this.contentEl;t=t.findParentNode("a",r,!0)}if(t){var n={};Terrasoft.each(t.dom.attributes,(function(e){n[e.name]=e.value}),this),!1===this.fireEvent("linkClicked",n)&&e.stopEvent()}},applyTipStyles:function(e){var t={left:null,top:null},r=this.getTipEl();if(e&&e.offset&&(e.offset.x||e.offset.y)){var n=e.offset,i=this.getAlignToEl(),a=this.getWrapEl().getSize(),s=this.getCenterRegion(i,2),o=r.getConstrainVector(s),l=Terrasoft.convertEmToPx(this.tipSize)/2,c=Ext.isNumber(o[0])?o[0]:0,u=Ext.isNumber(o[1])?o[1]:0,h=c+a.width/2-l,f=u+a.height/2-l,d=r.getSize();t={left:n.x?this.getTipOffsetValue(a.width,h,d.width):null,top:n.y?this.getTipOffsetValue(a.height,f,d.height):null}}r.applyStyles(t)},getCenterRegion:function(e,t){var r=t/2,n=e.getBox(!0),i=n.height/2,a=n.width/2;return new Ext.util.Region(n.top+i-r,n.right-a+r,n.bottom-i+r,n.left+a-r)},getTipOffsetValue:function(e,t,r){var n=Terrasoft.convertEmToPx(this.wrapElPadding),i=r/2,a=Math.min(t,e-n-i),s=Math.max(n+i,a);return Ext.String.format("{0}px",s)},init:function(){this.callParent(arguments),this.initTools(),this.updateDirection(this.content)},initDomEvents:function(){this.callParent(arguments);var e=this.getWrapEl();e.on("mouseenter",this.onMouseEnter,this),e.on("mouseleave",this.onMouseLeave,this);var t=this.contentEl;t.on("click",this.onContentClick,this),Ext.EventManager.onWindowResize(this.onWindowResize,this);var r=Ext.getDoc();r.on("mousedown",this.onDocMouseDown,this);var n=Ext.getBody();n.on("wheel",this.onBodyMouseWheel,this)},clearDomListeners:function(){this.callParent(arguments);var e=this.getWrapEl();e.un("mouseenter",this.onMouseEnter,this),e.un("mouseleave",this.onMouseLeave,this);var t=this.contentEl;t.un("click",this.onContentClick,this),Ext.EventManager.removeResizeListener(this.onWindowResize,this);var r=Ext.getDoc();r.un("mousedown",this.onDocMouseDown,this);var n=Ext.getBody();n.un("wheel",this.onBodyMouseWheel,this)},onBodyMouseWheel:function(e){!this.isEventWithin(e)&&this.hideOnScroll&&this.hide()},onWindowResize:function(){this.hide()},onDocMouseDown:function(e){!1!==this.fireEvent("beforeVisibilityChange",this,Terrasoft.controls.TipEnums.visibilityChangeEvent.HIDE_ON_DOCUMENT_MOUSE_DOWN,e)&&(this.isEventWithin(e)||this.hide())},onAfterRender:function(){this.callParent(arguments),this.adjustPosition()},onAfterReRender:function(){this.callParent(arguments),this.adjustPosition()},initRenderData:function(e){this.callParent(arguments),e.tools=this.tools,e.renderTool=this.renderTool},getTplData:function(){var e=this.callParent(arguments),t=this.tools&&this.tools.length>0,r={content:this.content,wrapClass:this.getCombinedCssClasses(),toolsWrapClasses:[this.toolsWrapClass],displayTools:t};return e=Ext.apply(e,r),this.updateSelectors(),e},getCombinedCssClasses:function(){var e=["tip"];return e.push(this.getModeClass()),e.push(this.getStyleClass()),e},getModeClass:function(){return"tip-display-mode-"+(this.displayMode||Terrasoft.controls.TipEnums.displayMode.WIDE).toLowerCase()},getStyleClass:function(){return"tip-"+(this.style||Terrasoft.controls.TipEnums.style.GREEN).toLowerCase()},updateSelectors:function(){var e="#"+this.id;this.selectors={wrapEl:e+"-wrapEl",tipEl:e+"-wrapEl .tip-anchor",contentEl:e+"-content"}},getTipEl:function(){return this.tipEl},applyAlignConfig:function(e,t,r){this.mixins.alignable.applyAlignConfig.apply(this,arguments),this.applyTipStyles(r)},isContentEmpty:function(){return Ext.isEmpty(this.content)&&0===this.items.getCount()},onDestroy:function(){this.clearTimer("showTimerId"),this.clearTimer("hideTimerId"),this.callParent(arguments)},bind:function(){this.callParent(arguments),Terrasoft.each(this.tools,(function(e){e.bind(this.model)}),this)},setContent:function(e){e!==this.content&&(this.content=Terrasoft.sanitizeHTML(e,Terrasoft.sanitizationLevel.ALLOW_TARGET_LINKS),this.updateDirection(this.content),this.safeRerender())},setStyle:function(e){e!==this.style&&(this.style=e,this.safeRerender())},setVisible:function(e){if(e){var t=this.getAlignToEl();if(Ext.isEmpty(t)||!t.isVisible(!0))return;if(!this.enabled||this.isContentEmpty())return}this.callParent(arguments)},setShowDelay:function(e){e!==this.showDelay&&(this.showDelay=e)},getBindConfig:function(){var e=this.callParent(arguments),t={visible:{changeEvent:"visiblechanged",changeMethod:"setVisible"},content:{changeMethod:"setContent"},style:{changeMethod:"setStyle"},showDelay:{changeMethod:"setShowDelay"}};return Ext.apply(e,t),e},show:function(e){this.clearTimer("hideTimerId"),e&&e.delayed?this.showTimerId=Ext.defer(this.delayedShow,this.showDelay,this):this.delayedShow()},hide:function(e){this.fireEvent("beforeVisibilityChange",this,Terrasoft.controls.TipEnums.visibilityChangeEvent.HIDE,null),this.clearTimer("showTimerId"),e&&e.delayed?this.hideTimerId=Ext.defer(this.delayedHide,this.hideDelay,this):this.delayedHide()}}),Ext.define("Terrasoft.controls.Container",{extend:"Terrasoft.controls.AbstractContainer",alternateClassName:"Terrasoft.Container",defaultRenderTpl:['<div id="{id}" style="{wrapStyles}" class="{wrapClassName}">',"{%this.renderItems(out, values)%}","</div>"]}),Ext.define("Terrasoft.controls.BaseDiagram",{extend:"Terrasoft.Container",alternateClassName:"Terrasoft.BaseDiagram",items:null,initItems:Ext.emptyFn,prepareItems:Ext.emptyFn,destroyItems:Ext.emptyFn,constructor:function(){this.items=Ext.create("Terrasoft.Collection"),this.callParent(arguments)},getTplData:function(){var e=this.callParent(arguments);return this.selectors=this.getSelectors(),e},getSelectors:function(){return{wrapEl:"#diagram-"+this.id}},getBindConfig:function(){var e=this.callParent(arguments),t={items:{changeMethod:"onCollectionDataLoaded"}};return Ext.apply(t,e)},onCollectionDataLoaded:Ext.emptyFn,init:function(){this.callParent(arguments),this.addEvents("click","doubleClick","selectionChange","connectionChange","mouseUp","mouseMove","nodesCollectionChange","connectorsCollectionChange","connectorsNodesChange","textChange")}}),Ext.define("Terrasoft.controls.ControlGroup",{extend:"Terrasoft.Container",alternateClassName:"Terrasoft.ControlGroup",emptyCaptionClass:"ts-controlgroup-empty-caption",collapsedClass:"ts-controlgroup-collapsed",wrapClass:null,noLineClass:"no-line",caption:"",width:"",collapsed:!0,bottomLine:!1,captionInUppercase:!1,isHeaderVisible:!0,tools:null,getTpl:function(){var e="";return Ext.isIE&&(e="-ie"),['<div id="{id}-wrap" class="{wrapClass}" style="{wrapStyle}">','<tpl if="isHeaderVisible">','<div class="ts-controlgroup-caption-wrap">','<div id="{id}-wrap-marker" class="ts-controlgroup-marker-wrap">',Ext.String.format('<div id="{id}-marker" class="ts-controlgroup-marker{0}">',e),"</div>","</div>",'<span id="{id}-caption"<tpl if="direction"> dir="{direction}"</tpl>>',"{caption}","</span>",'<div id="{id}-tools" class="ts-controlgroup-tools ts-box-sizing">','<tpl for="tools">',"</span>{%this.renderTool(out, values)%}","</tpl>","</div>","</div>","</tpl>",'<div id="{id}" class="{wrapContainerClass}">','<tpl for="items">',"<@item>","</tpl>","</div>","</div>"]},initTools:function(){var e=this.tools,t=this.tools=new Ext.util.MixedCollection(!1,this.getComponentId);t.on("add",this.onToolAdd,this),t.on("remove",this.onToolRemove,this),this.addToolItem(e)},onToolAdd:function(e,t){t.added(this)},onToolRemove:function(){},getTplData:function(){var e=this.callParent(arguments),t={itemsLength:this.items.length};t.wrapContainerClass=this.getContainerClass();var r=["ts-controlgroup"];this.wrapClass&&r.push(this.wrapClass),this.collapsed&&r.push(this.collapsedClass),t.wrapClass=r;var n=this.caption;return n&&this.captionInUppercase&&(n=n.toUpperCase()),t.caption=n?Terrasoft.encodeHtml(n):"",e.direction=Terrasoft.getTextDirection(t.caption),t.isHeaderVisible=!1===this.isHeaderVisible?this.isHeaderVisible:!Ext.isEmpty(n)||this.tools.length>0,Ext.apply(t,e,{}),this.styles=this.getStyles(),this.selectors=this.getSelectors(),t},initRenderData:function(e){this.callParent(arguments),e.tools=this.tools,e.renderTool=this.renderTool},renderTool:function(e,t){var r=t.generateHtml();e.push(r)},getContainerClass:function(){var e=[];return e.push("ts-controlgroup-container"),this.caption||e.push(this.emptyCaptionClass),this.bottomLine||e.push(this.noLineClass),e.join(" ")},getSelectors:function(){return{el:"#"+this.id,toolsEl:"#"+this.id+"-tools",wrapEl:"#"+this.id+"-wrap",markerEl:"#"+this.id+"-marker",markerWrapEl:"#"+this.id+"-wrap-marker",captionEl:"#"+this.id+"-caption"}},getStyles:function(){var e={};return""!==this.width&&(e.wrapStyle={},e.wrapStyle.width=this.width),e},init:function(){this.callParent(arguments),this.addEvents("collapsedchanged"),this.initTools()},initDomEvents:function(){this.callParent(arguments);var e=this.markerWrapEl;e&&e.on("click",this.toggleCollapsed,this);var t=this.captionEl;t&&t.on("click",this.toggleCollapsed,this)},toggleCollapsed:function(){var e=!this.collapsed;this.setCollapsed(e)},setCollapsed:function(e){this.collapsed!==e&&(this.collapsed=e,this.rendered&&(e?this.wrapEl.addCls(this.collapsedClass):this.wrapEl.removeCls(this.collapsedClass),this.fireEvent("collapsedchanged",e)))},setWidth:function(e){this.width!==e&&(this.width=e,this.rendered&&this.wrapEl.setWidth(e))},setCaption:function(e){if(e&&this.captionInUppercase&&(e=e.toUpperCase()),this.caption!==e){var t=this.caption;this.caption=e,e&&t&&this.rendered?this.captionEl.dom.innerHTML=Terrasoft.encodeHtml(e):this.safeRerender()}},setIsHeaderVisible:function(e){this.isHeaderVisible!==e&&(this.isHeaderVisible=e,this.safeRerender())},getRenderToEl:function(e){return-1!==this.tools.indexOf(e)?this.toolsEl:this.el},getBindConfig:function(){var e=this.callParent(arguments),t={collapsed:{changeEvent:"collapsedchanged",changeMethod:"setCollapsed"},caption:{changeMethod:"setCaption"},isHeaderVisible:{changeMethod:"setIsHeaderVisible"}};return Ext.apply(t,e),t},getMaskEl:function(){return this.el},onDestroy:function(){this.destroyTools(),this.callParent(arguments)},destroyTools:function(){this.destroyItemsCollection(this.tools),this.tools=null},indexOf:function(e){var t=this.callParent(arguments);return-1===t&&(t=this.indexOfToolItem(e)),t},bind:function(){this.callParent(arguments),this.tools.each((function(e){e.bind(this.model)}),this)},addToolItem:function(e){this.addToCollection(e,this.tools)},insertToolItem:function(e,t){this.insertIntoCollection(e,t,this.tools)},removeToolItem:function(e){this.removeFromCollection(e,this.tools)},indexOfToolItem:function(e){return this.indexOfCollection(e,this.tools)}}),Ext.define("Terrasoft.controls.DraggableContainer",{extend:"Terrasoft.controls.Container",alternateClassName:"Terrasoft.DraggableContainer",mixins:{draggable:"Terrasoft.Draggable"},onAfterRender:function(){this.callParent(arguments),this.mixins.draggable.onAfterRender.apply(this,arguments)},onAfterReRender:function(){this.callParent(arguments),this.mixins.draggable.onAfterReRender.apply(this,arguments)},onDestroy:function(){this.mixins.draggable.onDestroy.apply(this,arguments),this.callParent(arguments)}}),Ext.define("Terrasoft.controls.DiagramDraggableContainer",{alternateClassName:"Terrasoft.DiagramDraggableContainer",extend:"Terrasoft.DraggableContainer",dragActionsCode:1,dragCopy:!0,showDropZoneHint:!0,clickPixelThresh:0,clickTimeThresh:0,dragItemTpl:['<div style="width:{width}px; height:{height}px; text-align:center;">','<svg xmlns="http://www.w3.org/2000/svg" xml:space="preserve" preserveAspectRatio="none" width="{width}px" height="{height}px" viewBox="0 0 {width} {height}">','<g class="ej-d-node" visibility="visible">','<image width="{width}" height="{height}" opacity="1" xlink:href="{imageUrl}" xmlns:xlink="http://www.w3.org/1999/xlink"></image>',"</g>","</svg>","</div>"],init:function(){this.callParent(arguments),this.addEvents("onDragDrop","onInvalidDrop","b4Drag","onDrag","onDragOver")},getDraggableConfig:function(){var e={};return e[Terrasoft.DragAction.MOVE]={handlers:{onDragDrop:function(e,t){var r=this.getDiagram(t),n=this.getMousePosition(e);n=this.applyDiagramWrapOffset(r,n),this.dropElement(r,n),this.reRender()},onInvalidDrop:function(){this.reRender()},b4Drag:function(e){var t=this.getCurrentDragObject(),r=this.tag.element,n=this.getMousePosition(e);this.shiftStartDragObjectPosition(t,r,n)},onDrag:function(e){var t=this.getMousePosition(e),r=this.tag.element,n=this.getNodeStyleCenterConfig(t,r),i=this.getCurrentDragObject();this.applyDragNodeStyle(i,n)},onDragOver:function(e,t){var r=this.getDiagram(t),n=this.tag.element;this.selectDragOverConnector(r,n)}}},e},getDiagram:function(e){return e[0].droppableInstance},getMousePosition:function(e){return{x:e.getPageX(),y:e.getPageY()}},applyDiagramWrapOffset:function(e,t){var r=e.getWrapEl().dom.getBoundingClientRect(),n=$("#"+e.renderToSelector);return{x:t.x-r.left+n.scrollLeft(),y:t.y-r.top+n.scrollTop()}},dropElement:function(e,t){var r=e.findContainerAtPosition(t);if(r){var n={element:this,containerName:r.name,localX:t.x,localY:t.y};if(r.nodeType!==Terrasoft.diagram.UserHandlesConstraint.Lane){var i=e.getItemBounds(r);n.localX-=i.x,n.localY-=i.y}if(!1===this.fireEvent("onDragDrop",n)){var a=e.getInstance(),s=a.selectionList[0],o=s&&s.toolsConstraint&Terrasoft.diagram.ToolsConstraint.ConnectionEditTool,l=a.selectedSegment;o&&l&&(e.dropNodeToConnector(s,l,a,t,!1),e.updateNodeConnectors(s,a,!0),Terrasoft.ProcessSchemaDiagram.updateSelectedConnector(null,a))}}},shiftStartDragObjectPosition:function(e,t,r){e.deltaX=t.width/2,e.deltaY=t.height/2,e.setDragElPos(r.x,r.y)},applyDragNodeStyle:function(e,t){var r=e.getDragEl();r.style.left=t.left,r.style.top=t.top},getCurrentDragObject:function(){return Ext.dd.DragDropManager.dragCurrent},getNodeStyleCenterConfig:function(e,t){return{left:e.x-t.width/2+"px",top:e.y-t.height/2+"px"}},getCurrentDragElementRect:function(){return this.getCurrentDragObject().getDragEl().querySelector("svg").getBoundingClientRect()},selectDragOverConnector:function(e,t){var r;if(t.toolsConstraint&Terrasoft.diagram.ToolsConstraint.ConnectionEditTool){var n=this.getCurrentDragElementRect(),i={x:n.left,y:n.top},a={x:(i=this.applyDiagramWrapOffset(e,i)).x,y:i.y,height:n.height,width:n.width};r=e.findSegmentAtRect(a)}var s=e.getInstance();Terrasoft.ProcessSchemaDiagram.updateSelectedConnector(r,s)},getItemHtml:function(){var e=this.tag.element,t=e.getDragImage(),r={imageUrl:Terrasoft.ImageUrlBuilder.getUrl(t),width:e.width,height:e.height};return new Ext.XTemplate(this.dragItemTpl).apply(r)},createDraggableClone:function(){var e=this.mixins.draggable.createDraggableClone.apply(this,arguments);return e.classList.remove("toolbar-item"),e.innerHTML=this.getItemHtml(),e}}),Ext.define("Terrasoft.controls.DroppableContainer",{extend:"Terrasoft.controls.Container",alternateClassName:"Terrasoft.DroppableContainer",mixins:{droppable:"Terrasoft.core.mixins.Droppable"},onAfterRender:function(){this.callParent(arguments),this.mixins.droppable.onAfterRender.apply(this,arguments)},onAfterReRender:function(){this.callParent(arguments),this.mixins.droppable.onAfterReRender.apply(this,arguments)},onDestroy:function(){this.mixins.droppable.onDestroy.apply(this,arguments),this.callParent(arguments)}}),Ext.ns("Terrasoft.enums.ReorderableContainer"),Terrasoft.enums.ReorderableContainer.Align={VERTICAL:"Vertical",HORIZONTAL:"Horizontal"},Ext.define("Terrasoft.controls.ReorderableContainer",{extend:"Terrasoft.controls.DroppableContainer",alternateClassName:"Terrasoft.ReorderableContainer",mixins:{reorderable:"Terrasoft.Reorderable"},wrapClassName:"reorderable-container",innerContainerClassName:"reorderable-inner-container",verticalAlignClassName:"vertical-align",horizontalClassName:"horizontal-align",itemClassName:"Terrasoft.DraggableContainer",dropGroupName:null,defaultRenderTpl:['<div id="{id}" style="{wrapStyles}" class="{wrapClassName}">','<div id="{id}-inner-container" style="{innerContainerStyles}" class="{innerContainerClassName}">',"{%this.renderItems(out, values)%}","</div>","</div>"],defaultItemConfig:null,align:Terrasoft.enums.ReorderableContainer.Align.VERTICAL,init:function(){this.callParent(arguments),this.addEvents("onDragEnter","onDragOver","onDragDrop","onDragOut")},onDragEnter:function(e,t,r){this.onDrag(e,t,r,"onDragEnter")},onDragOver:function(e,t,r){this.onDrag(e,t,r,"onDragOver")},onDrag:function(e,t,r,n){Terrasoft.each(r,(function(r){var i=this.getDragOverRegion(r);if(this.getIsDragElementOverItem(t,i)){var a=this.fireEvent(n,e,r.config.tag);return this.setInvalidDrag(e,a),!1}}),this)},setInvalidDrag:Terrasoft.emptyFn,getIsDragElementOverItem:function(e,t){var r;return this.align===Terrasoft.enums.ReorderableContainer.Align.HORIZONTAL&&(r=e.right>t.left&&e.right<t.right),this.align===Terrasoft.enums.ReorderableContainer.Align.VERTICAL&&(r=e.bottom>t.top&&e.bottom<t.bottom),r},getDragOverRegion:function(e){var t=e.getEl();return Ext.util.Region.getRegion(t)},onDragDrop:function(e){this.fireEvent("onDragDrop",e)},onDragOut:function(){this.fireEvent("onDragOut",this.tag)},getRenderToEl:function(){return this.innerContainerEl},getTplData:function(){var e=this.callParent(arguments);this.applyClasses(e);var t=this.getSelectors();return Ext.apply(this.selectors,t),e},getSelectors:function(){return{innerContainerEl:"#"+this.id+"-inner-container"}},applyClasses:function(e){var t=e.wrapClassName=e.wrapClassName||[];t.push(this.wrapClassName);var r=this.getAlignClassName(this.align);t.push(r),(e.innerContainerClassName=[]).push(this.innerContainerClassName)},getAlignClassName:function(e){var t="";return e===Terrasoft.enums.ReorderableContainer.Align.VERTICAL&&(t=this.verticalAlignClassName),e===Terrasoft.enums.ReorderableContainer.Align.HORIZONTAL&&(t=this.horizontalClassName),t},getDefaultItemConfig:function(){return this.defaultItemConfig||{}},onAfterRender:function(){this.callParent(arguments),this.mixins.reorderable.onAfterRender.apply(this,arguments)},onAfterReRender:function(){this.callParent(arguments),this.mixins.reorderable.onAfterReRender.apply(this,arguments)},onDestroy:function(){this.mixins.reorderable.onDestroy.apply(this,arguments),this.callParent(arguments)},bindItems:Terrasoft.emptyFn,getBindConfig:function(){var e=this.callParent(arguments),t=this.mixins.reorderable.getBindConfig.apply(this,arguments);return Ext.apply(e,t),Ext.apply(e,{align:{changeMethod:"setAlign"}}),e},getItemConfig:function(){var e=this.mixins.reorderable.getItemConfig.apply(this,arguments);return e||(e=this.getDefaultItemConfig(),Ext.applyIf(e,{className:this.itemClassName})),e},subscribeForCollectionEvents:function(e,t,r){if(this.callParent(arguments),this.mixins.reorderable.subscribeForCollectionEvents.apply(this,arguments),"viewModelItems"===t){var n=r.get(e.modelItem);n.on("move",this.onMoveItem,this)}},unSubscribeForCollectionEvents:function(e,t,r){if(this.callParent(arguments),this.mixins.reorderable.unSubscribeForCollectionEvents.apply(this,arguments),"viewModelItems"===t){var n=r.get(e.modelItem);n.un("move",this.onMoveItem,this)}},onMoveItem:function(e,t,r){var n=this.items,i=n.get(r);n.suspendEvents(),n.removeAt(e),n.insert(t,r,i),n.resumeEvents(),i.allowRerender()&&i.reRender(t)},getGroupName:function(){return this.dropGroupName},setAlign:function(e){if(this.align!==e){var t=this.getAlignClassName(this.align),r=this.getAlignClassName(e);if(this.align=e,this.rendered){var n=this.wrapEl.dom.classList;n.remove(t),n.add(r)}}},insertZeroElement:function(e,t){this.innerContainerEl.insertHtml("beforeEnd",t)},onViewModelItemRemove:function(){this.mixins.reorderable.onViewModelItemRemove.apply(this,arguments),this.applySelectors(this.wrapEl)}}),Ext.define("Terrasoft.controls.ContentColumn",{extend:"Terrasoft.controls.ReorderableContainer",alternateClassName:"Terrasoft.ContentColumn",mixins:{contentBlock:"Terrasoft.mixins.ContentBlockMixin",selectable:"Terrasoft.mixins.SelectableContentBlock"},itemName:"content-column",reorderableElTpl:'<div id="{0}" class="{1}"><div class="reorderable-arrow"></div></div>',tplConfigClasses:{contentColumnWrap:["content-column-wrap"],contentColumnPlaceholder:["content-column-placeholder"],contentColumnPlaceholderWrap:["content-column-placeholder-wrap"]},defaultRenderTpl:['<div id="{id}-content-column" class="{contentColumnWrap}" style="{wrapStyle}">\n\t\t\t<div class="content-column-element">\n\t\t\t<div id="{id}-inner-container" class="{innerContainerClassName}" style="{columnStyle}">{%this.renderItems(out, values)%}</div>\n\t\t\t</div>\n\t\t\t<div id="{id}-content-column-placeholder-wrap" class="{contentColumnPlaceholderWrap}">\n\t\t\t\t<div id="{id}" class="{contentColumnPlaceholder}">\n\t\t\t\t\t<span class="placeholder-image"></span>\n\t\t\t\t\t<br>\n\t\t\t\t\t<span>{placeholder}</span>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</div>'],placeholder:null,width:null,init:function(){this.callParent(arguments),this.addEvents("elementSelectedChange")},initDomEvents:function(){this.callParent(arguments),this.subscribeItemsEvents()},applyColumnWidth:function(){this.styles.wrapStyle=Ext.apply(this.styles.wrapStyle||{},{width:this.width+"%"})},applyWidthBindConfig:function(e){Ext.apply(e,{width:{changeEvent:"changed",changeMethod:"setWidth"}})},setWidth:function(e){this.width=e,this.safeRerender()},setColumnStyle:function(e){Ext.isObject(e)&&(this.styles=Ext.apply(this.styles||{},{columnStyle:e}),this.safeRerender())},addSelectedClass:function(e){this.selected&&e.contentColumnWrap.push(this.selectedClass)},getTplData:function(){var e=this.callParent(arguments);return this.selectors=this.getSelectors(),this.applyTplClasses(e),this.addSelectedClass(e),this.items&&0!==this.items.getCount()||e.contentColumnPlaceholderWrap.push("visible"),e.placeholder=this.placeholder,this.applyColumnWidth(),e},getSelectors:function(){var e={};return Ext.apply(e,{wrapEl:Ext.String.format("#{0}-{1}",this.id,this.itemName),innerContainerEl:Ext.String.format("#{0}-inner-container",this.id),placeholderEl:Ext.String.format("#{0}-{1}-placeholder-wrap",this.id,this.itemName)}),e},prepareItems:function(e){return this.mixins.contentBlock.prepareBlockItems.call(this,e)},getItemConfig:function(e){var t=this.callParent(arguments);return Ext.apply(t,this.mixins.contentBlock.getItemConfig.call(this,e)),t.tools=e.getToolsConfig(),t.columnId=this.id,t},setPlaceholderVisible:function(e){this.placeholderEl&&(e?this.placeholderEl.addCls("visible"):this.placeholderEl.removeCls("visible"))},onItemsChange:function(){this.setPlaceholderVisible(!this.items||0===this.items.getCount())},onAddItem:function(e,t){this.insert(e,t)},onItemAdd:function(e,t){this.callParent(arguments),t.on("selectedChanged",this.onSelectedChanged,this),this.onItemsChange()},onItemRemove:function(e,t){e.removed(this),this.unSubscribeItemMappedEvents(e),this.onItemsChange()},onSelectedChanged:function(e,t){e&&this.fireEvent("elementSelectedChange",t.id)},subscribeItemsEvents:function(){this.items.each((function(e){e.on("selectedChanged",this.onSelectedChanged,this)}),this)},unSubscribeItemsEvents:function(){this.items.each((function(e){e.un("selectedChanged",this.onSelectedChanged,this)}),this)},subscribeForCollectionEvents:function(e,t,r){if(r&&"items"===t){var n=r.get(e.modelItem);this.mixins.contentBlock.subscribeCollection.call(this,n)}},unSubscribeForCollectionEvents:function(e,t,r){if(r&&"items"===t){var n=r.get(e.modelItem);this.mixins.contentBlock.unSubscribeCollection.call(this,n)}},setPlaceholder:function(e){this.placeholder!==e&&(this.placeholder=e)},getBindConfig:function(){var e=this.callParent(arguments);return this.applyBlockBindConfig(e),this.applySelectedBindConfig(e),this.applyWidthBindConfig(e),Ext.apply(e,{columnStyle:{changeEvent:"changed",changeMethod:"setColumnStyle"},placeholder:{changeMethod:"setPlaceholder"}}),e},bind:function(){this.mixins.bindable.bind.apply(this,arguments)},getDropZoneInitDefaultConfig:function(){return{columnId:this.id,itemType:"column"}},createZeroElement:function(){this.mixins.reorderable.createZeroElement.apply(this,arguments);var e=this.getZeroElementId(),t=Ext.get(e);t.initDDTarget(this.getGroupName(),{columnId:this.id,itemType:"element",id:this.id,isZero:!0},{})},clearDropZones:function(){var e=this,t=Ext.dd.DragDropManager.ids,r=this.getGroupName(),n=Ext.dd.DragDropManager.ids[r],i=[];Ext.Object.each(n,(function(t,r){r.config.columnId===e.id&&i.push(t)})),Terrasoft.each(i,(function(e){delete t[r][e],t[e]&&delete t[e]}),this)},insertZeroElement:function(e,t){this.innerContainerEl.insertHtml(e,t)},onAfterRender:function(){this.callParent(arguments),this.isVisible()||(this.clearDropZones(),this.mixins.droppable.initDropZones.apply(this))},onDestroy:function(){this.unSubscribeItemsEvents(),this.callParent(arguments)}}),Ext.define("Terrasoft.controls.ContentMjColumn",{extend:"Terrasoft.controls.ContentColumn",alternateClassName:"Terrasoft.ContentMjColumn",tools:null,groupId:null,toolsWrapClasses:["column-grouping-control"],defaultRenderTpl:['<div id="{id}-content-column" class="{contentColumnWrap}" style="{wrapStyle}">\n\t\t\t<div class="content-column-element">\n\t\t\t\t<div id="{id}-inner-container" class="{innerContainerClassName}" style="{columnStyle}">{%this.renderItems(out, values)%}<div id="{id}-content-column-placeholder-wrap" class="{contentColumnPlaceholderWrap}">\n\t\t\t\t\t\t<div id="{id}" class="{contentColumnPlaceholder}">\n\t\t\t\t\t\t\t<span class="placeholder-image"></span>\n\t\t\t\t\t\t\t<br>\n\t\t\t\t\t\t\t<span>{placeholder}</span>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t\t<tpl if="hasTools">\n\t\t\t\t<div id="{id}-content-column-tools" class="{toolsWrapClasses}">\n\t\t\t\t\t<tpl for="tools">\n\t\t\t\t\t\t{%this.renderTool(out, values)%}\n\t\t\t\t\t</tpl>\n\t\t\t\t</div>\n\t\t\t</tpl>\n\t\t</div>'],init:function(){this.callParent(arguments),this.initTools()},getTplData:function(){var e=this.callParent(arguments);return this.applyToolsTplData(e),e.groupId=this.groupId,e},getSelectors:function(){var e=this.callParent(arguments);return Ext.apply(e,{toolsEl:"#"+this.id+"-content-column-tools"}),e},initRenderData:function(e){this.callParent(arguments),this.addToolsToRenderData(e)},setGroupingId:function(e){this.groupId=e,this.safeRerender()},onAddItem:function(e,t){this.insert(e,t)},onDestroy:function(){this.destroyTools(),this.callParent(arguments)},getBindConfig:function(){var e=this.callParent(arguments);return Ext.apply(e,{groupId:{changeMethod:"setGroupingId"}}),e},bind:function(){this.callParent(arguments),this.mixins.selectable.bindTools.apply(this)}}),Ext.define("Terrasoft.controls.ContentMjHero",{extend:"Terrasoft.controls.ContentColumn",alternateClassName:"Terrasoft.ContentMjHero",itemName:"content-mjhero",tplConfigClasses:{contentColumnWrap:["content-mjhero-wrap"],contentColumnPlaceholder:["content-mjhero-placeholder"],contentColumnPlaceholderWrap:["content-mjhero-placeholder-wrap"]},defaultRenderTpl:['<div id="{id}-content-mjhero" class="{contentColumnWrap}" style="{wrapStyle}">\n\t\t\t<div id="{id}-inner-container" class="{innerContainerClassName}" style="{columnStyle}">{%this.renderItems(out, values)%}</div>\n\t\t\t<div id="{id}-content-mjhero-placeholder-wrap" class="{contentColumnPlaceholderWrap}">\n\t\t\t\t<div id="{id}" class="{contentColumnPlaceholder}">\n\t\t\t\t\t<span class="placeholder-image"></span>\n\t\t\t\t\t<br>\n\t\t\t\t\t<span>{placeholder}</span>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</div>'],applyColumnWidth:Terrasoft.emptyFn}),Ext.define("Terrasoft.controls.ContentSheet",{extend:"Terrasoft.controls.DroppableContainer",alternateClassName:"Terrasoft.ContentSheet",mixins:{reorderable:"Terrasoft.core.mixins.Reorderable"},tools:null,reorderableElTpl:'<div id="{0}" class="{1}"><div class="reorderable-arrow"></div></div>',width:null,align:null,widthUnit:"px",backgroundColor:null,tplConfigClasses:{contentSheetWrap:["content-sheet-wrap"],contentSheetItems:["content-sheet-items"],contentSheetPlaceholder:["content-sheet-placeholder"],toolsWrapClasses:["content-sheet-tools-wrap"]},tplConfigStyles:null,alignSheetConfig:{left:{"margin-left":"0","margin-right":"auto"},center:{"margin-left":"auto","margin-right":"auto"},right:{"margin-left":"auto","margin-right":"20px"}},tpl:['<div id="{id}-content-sheet" class="{contentSheetWrap}" style="{contentSheetStyle}">','<div id="{id}-content-sheet-placeholder" class="{contentSheetPlaceholder}">',"{placeholder}","</div>",'<div id="{id}-content-sheet-items" class="{contentSheetItems}">',"{%this.renderItems(out, values)%}","</div>",'<div id="{id}-content-sheet-tools" class="{toolsWrapClasses}">','<tpl for="tools">',"{%this.renderTool(out, values)%}","</tpl>","</div>","</div>"],selectedClass:"content-sheet-selected",selected:null,placeholder:null,isFullWidth:!1,_setAlignSheetConfig:function(){Terrasoft.getIsRtlMode()&&(this.alignSheetConfig.right["margin-right"]="0",this.alignSheetConfig.left["margin-left"]="20px")},_setIsFullWidth:function(e){this.isFullWidth!==e&&(this.isFullWidth=e,this.rendered&&(this.isFullWidth?this.reRender():this.getWrapEl().setWidth(this.width)))},getRenderToEl:function(e){return-1!==this.tools.indexOf(e)?this.toolsEl:this.itemsEl},applyTplConfigProperties:function(e,t){Terrasoft.each(t,(function(t,r){e[r]=Terrasoft.deepClone(t)}),this)},applyTplClasses:function(e){this.applyTplConfigProperties(e,this.tplConfigClasses)},initTools:function(){var e=this.tools,t=this.tools=new Ext.util.MixedCollection(!1,this.getComponentId);t.on("add",this.onToolAdd,this),t.on("remove",this.onToolRemove,this),this.addToolItem(e)},addToolItem:function(e){this.addToCollection(e,this.tools)},insertToolItem:function(e,t){this.insertIntoCollection(e,t,this.tools)},removeToolItem:function(e){this.removeFromCollection(e,this.tools)},initRenderData:function(e){this.callParent(arguments),e.tools=this.tools,e.renderTool=this.renderTool},renderTool:function(e,t){var r=t.generateHtml();e.push(r)},bind:function(){this.mixins.bindable.bind.apply(this,arguments),this.tools.each((function(e){e.bind(this.model)}),this)},applyTplStyles:function(e){var t={};this.width&&!this.isFullWidth&&(t.width=this.width+this.widthUnit),this.align&&Ext.apply(t,this.alignSheetConfig[this.align]),this.backgroundColor&&(t["background-color"]=this.backgroundColor),e.contentSheetStyle=Ext.apply(this.tplConfigStyles,t),this.isFullWidth&&delete this.tplConfigStyles.width,this.applyTplConfigProperties(e,this.tplConfigStyles)},getTplData:function(){var e=this.selectors;e.wrapEl=Ext.String.format("#{0}-content-sheet",this.id),e.itemsEl=Ext.String.format("#{0}-content-sheet-items",this.id),e.toolsEl=Ext.String.format("#{0}-content-sheet-tools",this.id),e.placeholderEl=Ext.String.format("#{0}-content-sheet-placeholder",this.id);var t=this.callParent(arguments);return Ext.apply(t,{toolsWrapClasses:Terrasoft.deepClone(this.toolsWrapClasses),hasTools:this.tools&&this.tools.getCount()}),this.applyTplClasses(t),this.applyTplStyles(t),this.selected&&t.contentSheetWrap.push(this.selectedClass),this.items&&0!==this.items.getCount()||t.contentSheetPlaceholder.push("content-sheet-placeholder-visible"),t.placeholder=this.placeholder,t},setPlaceholderVisible:function(e){this.placeholderEl&&(e?this.placeholderEl.addCls("content-sheet-placeholder-visible"):this.placeholderEl.removeCls("content-sheet-placeholder-visible"))},onItemsChange:function(){this.setPlaceholderVisible(!this.items||0===this.items.getCount())},constructor:function(){this.tplConfigStyles={},this._setAlignSheetConfig(),this.callParent(arguments)},init:function(){this.selectors={wrapEl:""},this.callParent(arguments),this.tag=this.id,this.initTools(),this.addEvents("selectedChanged")},getBindConfig:function(){var e=this.mixins.reorderable.getBindConfig.apply(this,arguments),t=Ext.apply(e,this.callParent(arguments));return Ext.apply(t,{selected:{changeEvent:"selectedChanged",changeMethod:"setSelected"},placeholder:{changeMethod:"setPlaceholder"},width:{changeMethod:"setWidth"},isFullWidth:{changeMethod:"_setIsFullWidth"},backgroundColor:{changeMethod:"setBackgroundColor"},sheetAlign:{changeMethod:"setAlign"}})},destroyTools:function(){this.destroyItemsCollection(this.tools),this.tools=null},indexOfToolItem:function(e){return this.indexOfCollection(e,this.tools)},indexOf:function(e){var t=this.callParent(arguments);return-1===t&&(t=this.indexOfToolItem(e)),t},onToolAdd:function(e,t){t.added(this)},onToolRemove:Terrasoft.emptyFn,subscribeForCollectionEvents:function(){this.mixins.reorderable.subscribeForCollectionEvents.apply(this,arguments)},unSubscribeForCollectionEvents:function(e,t,r){r&&this.mixins.reorderable.unSubscribeForCollectionEvents.apply(this,arguments)},onItemAdd:function(){this.callParent(arguments),this.onItemsChange()},onItemRemove:function(e,t){e.removed(this),this.unSubscribeItemMappedEvents(e),this.onItemsChange()},setSelected:function(e){this.selected!==e&&(this.selected=e,this.fireEvent("selectedChanged",this.selected,this),this.rendered&&(e?this.wrapEl.addCls(this.selectedClass):this.wrapEl.removeCls(this.selectedClass)))},setPlaceholder:function(e){this.placeholder!==e&&(this.placeholder=e)},setWidth:function(e){this.width!==e&&(this.width=e,this.rendered&&!this.isFullWidth&&this.getWrapEl().setWidth(e))},setAlign:function(e){(e=this._getAlignByPageDirection(e),this.align!==e)&&(this.align=e,this.rendered&&this.getWrapEl().setStyle(this.alignSheetConfig[e]))},_getAlignByPageDirection:function(e){var t=e;if(!Terrasoft.getIsRtlMode())return t;switch(e){case"left":t="right";break;case"right":t="left"}return t},setBackgroundColor:function(e){this.backgroundColor!==e&&(this.backgroundColor=e,this.rendered&&this.getWrapEl().setStyle("background-color",e))},getDropZoneInitDefaultConfig:function(){return{itemType:"sheet"}},createZeroElement:function(){this.mixins.reorderable.createZeroElement.apply(this,arguments);var e=this.getZeroElementId(),t=Ext.get(e);t.initDDTarget(this.getGroupName(),{id:this.id,itemType:"block",isZero:!0},{})},clearDropZones:function(){var e=Ext.dd.DragDropManager.ids,t=this.getGroupName(),r=t&&e[t];r&&(Ext.Object.each(r,(function(t,n){n.config&&"block"===n.config.itemType&&(delete r[t],e[t]&&delete e[t])}),this),delete e[t])},onAfterRender:function(){this.callParent(arguments),this.mixins.reorderable.onAfterRender.apply(this,arguments)},onAfterReRender:function(){this.callParent(arguments),this.mixins.reorderable.onAfterReRender.apply(this,arguments)},onDestroy:function(){this.mixins.reorderable.onDestroy.apply(this,arguments),this.destroyTools(),this.callParent(arguments)}}),Ext.define("Terrasoft.controls.LazyContainer",{extend:"Terrasoft.controls.Container",alternateClassName:"Terrasoft.LazyContainer",renderDelay:0,addViewConfigItems:function(){setTimeout(this.lazyAddItems.bind(this),this.renderDelay)},lazyAddItems:function(){var e=this.rendered;this.rendered=!1,this.add(this.viewConfigItems),this.bindItems(this.model),e&&this.reRender()}}),Ext.define("Terrasoft.controls.SideBar",{alternateClassName:"Terrasoft.SideBar",extend:"Terrasoft.Component",statics:{styleSheetId:null,css:{bgColor:"#4d5a75",fontColor:"#ffffff",selectedFontColor:"#ffffff",selectedBgColor:"#f49d57"},styles:[".ts-sidebar-list > li, .ts-sidebar-item-text-hint {color: @SectionPanelFontColor;}",".ts-sidebar-list > li.ts-sidebar-selected-item,.ts-sidebar-item-text-hint"," {color: @SectionPanelSelectedFontColor;}",".ts-sidebar-list > li .ts-sidebar-spacer,.ts-sidebar-list,.left-panel"," {background-color: @SectionPanelBackgroundColor;}",".sectionPanelBackgroundColor > * {background-color: @SectionPanelBackgroundColor;}",".ts-sidebar-list > li.ts-sidebar-selected-item .vertical-strip,",".ts-sidebar-list > li.ts-sidebar-selected-item .ts-sidebar-spacer,",".ts-sidebar-item-text-hint"," {background-color: @SectionPanelSelectedBackgroundColor;}",".ts-sidebar-list[collapsed='false'] > li.ts-sidebar-selected-item,",".ts-sidebar-list[collapsed='false'] .ts-sidebar-item-wrapper:hover"," {background-color: @SelectedOpacityBgColor;}",".ts-sidebar-list[collapsed='true'] > li.ts-sidebar-selected-item"," {background-color: @SectionPanelSelectedBackgroundColor;}",".ts-sidebar-list[collapsed='true'] li:not(.ts-sidebar-selected-item) .ts-sidebar-item-wrapper:hover"," {background-color: rgba(@CollapsedHoverBgColor, 0.5);}"],generateStyleSheet:function(){Terrasoft.controls.SideBar.styleSheetId&&Terrasoft.removeStyleSheet(Terrasoft.controls.SideBar.styleSheetId);var e=this._getStyleSheetRule();Terrasoft.controls.SideBar.styleSheetId=Terrasoft.randomString(),Terrasoft.createStyleSheet(e,Terrasoft.controls.SideBar.styleSheetId)},_getStyleSheetRule:function(){var e=Terrasoft.controls.SideBar.css,t=Terrasoft.Resources.LessConstants,r=this._getAvailableColor(t.SectionPanelFontColor,e.fontColor),n=this._getAvailableColor(t.SectionPanelSelectedFontColor,e.selectedFontColor),i=this._getAvailableColor(t.SectionPanelSelectedBackgroundColor,e.selectedBgColor),a=this._getAvailableColor(t.SectionPanelBackgroundColor,e.bgColor),s=Terrasoft.getColorHue(a,-18),o=Terrasoft.hex2rgb(i),l=Terrasoft.controls.SideBar.styles.join("");return l=(l=(l=(l=(l=(l=l.replace(/@SectionPanelFontColor/g,r)).replace(/@SectionPanelSelectedFontColor/g,n)).replace(/@SectionPanelBackgroundColor/g,a)).replace(/@SectionPanelSelectedBackgroundColor/g,i)).replace(/@SelectedOpacityBgColor/g,s)).replace(/@CollapsedHoverBgColor/g,o)},_getAvailableColor:function(e,t){return Terrasoft.isHexValue(e)?e:t}},itemTplMap:["caption","imageUrl","href","domAttributes"],tpl:['<ul id="{id}-wrap" class="ts-sidebar-list ts-box-sizing" style="{wrapStyle}">',"{%this.renderItems(out, values)%}","</ul>"],itemTpl:['<tpl if="visible != false">','<li data-item-index="{itemIndex}"','<tpl if="isSelected == true">','class="ts-sidebar-selected-item"',"</tpl>",">",'<span class="vertical-strip"></span>','<tpl if="href"><a target="_self" class="sidebar-item-link" href="{href}"></tpl>','<div id="sidebar-item-wrapper-{itemIndex}" class="ts-sidebar-item-wrapper">','<div id="sidebar-item-image-{itemIndex}" class="ts-sidebar-item-image" data-item-marker="{caption}" style="background-image:url({imageUrl})" <tpl foreach="domAttributes">{$}="{.}"</tpl>></div>','<div id="sidebar-item-text-{itemIndex}" class="ts-sidebar-item-text"> {caption} ',"</div>","</div>",'<tpl if="href"></a></tpl>',"</li>","</tpl>"],itemContextTpl:['<tpl if="visible != false">',"{caption}","</tpl>"],captionHintTpl:['<div id="sidebar-item-text-{itemIndex}-hint" class="ts-sidebar-item-text-hint"> {caption}'," </div>"],items:null,selectedItemIndex:-1,maxWidth:"",minWidth:"",collapsed:!1,hintOpacityClass:"ts-sidebar-item-text-hint-opacity",init:function(){Terrasoft.controls.SideBar.generateStyleSheet(),this.callParent(arguments),this.addEvents("itemSelected")},getTplData:function(){var e=this.callParent(arguments);return e.renderItems=this.renderItems,e.collapsed=this.collapsed,this.styles=this.getStyles(),this.selectors={wrapEl:"#"+this.id+"-wrap"},e},getStyles:function(){var e={},t=e.wrapStyle={},r=this.maxWidth,n=this.minWidth;return r&&(t.maxWidth=r),n&&(t.minWidth=n),e},initDomEvents:function(){this.callParent(arguments);var e=this.getWrapEl();e.on("click",this.onMenuClick,this)},clearDomListeners:function(){this.wrapEl.un("click",this.onMenuClick,this),this.callParent(arguments)},initItemEvents:function(e,t){var r=Ext.String.format("#sidebar-item-wrapper-{0}",t),n=this.getWrapEl().down(r);n&&(n.on("mouseenter",this.onMouseEnter,this),n.on("mouseleave",this.onMouseLeave,this))},clearItemEvents:function(e,t){var r=Ext.String.format("#sidebar-item-wrapper-{0}",t),n=this.getWrapEl().down(r);n&&(n.un("mouseenter",this.onMouseEnter,this),n.un("mouseleave",this.onMouseLeave,this))},onMenuClick:function(e,t){if(!e.ctrlKey){var r=this.getParentElement("LI",t);if(r){var n=this.canExecute({method:this.onMenuClick,args:arguments});if(!1===n)return;var i=r.getAttribute("data-item-index");i=parseInt(i,10),this.selectedItemIndex!==i&&this.setSelectedItem(i);var a=this.items[i].tag;this.fireEvent("itemSelected",i,a)}}},onMouseEnter:function(e){this.collapsed&&this.showCaptionHint(e)},onMouseLeave:function(e){this.collapsed&&this.hideCaptionHint(e)},getParentElement:function(e,t){var r=Ext.get(t),n=this.getWrapEl();return r.findParent(e,n,!0)},showCaptionHint:function(e){var t=this.getParentElement("LI",e.target);if(t){var r=t.getAttribute("data-item-index");r=parseInt(r,10);var n={caption:this.getItemConfig(r).caption,itemIndex:r},i=this.generateItemHtml(n,this.captionHintTpl),a=Ext.getBody(),s=Ext.DomHelper.append(a,i);this.setElPosition(e,s)}},setElPosition:function(e,t){var r=Ext.get(e.target),n=Ext.get(t),i=r.getBox();n.setStyle({left:i.left+i.right+"px",top:i.top+"px"}),n.addCls(this.hintOpacityClass)},hideCaptionHint:function(e){var t=this.getParentElement("LI",e.target);if(t){var r=t.getAttribute("data-item-index");r=parseInt(r,10),this.removeHintEl(r)}},removeHintEl:function(e){var t=Ext.String.format("#sidebar-item-text-{0}-hint",e),r=Ext.get(Ext.DomQuery.selectNode(t));r&&r.remove()},onDestroy:function(){this.items.forEach((function(e,t){this.removeHintEl(t)}),this),this.callParent(arguments)},getItemsRenderTemplateTree:function(){for(var e,t,r,n,i=this.items,a=[],s=this.selectedItemIndex,o=0,l=i.length;o<l;o++)e=i[o],n=s===o,t=this.generateItemTplConfig(e,o,n),r=this.generateItemHtml(t),a.push(r);return a},generateItemTplConfig:function(e,t,r){var n=this._getItemTplData(e);return n.visible=e.visible,n.itemIndex=t,n.isSelected=r,n},_getItemTplData:function(e){for(var t={},r=this.itemTplMap,n=0,i=r.length;n<i;n++){var a=r[n],s=e[a];s=Ext.isObject(s)?Terrasoft.encodeHtmlObjectValues(s):Terrasoft.encodeHtml(s),t[a]=s}return t},renderItems:function(e,t){var r=t.self.getItemsRenderTemplateTree();Ext.DomHelper.generateMarkup(r,e)},generateItemHtml:function(e,t){return t=t||this.itemTpl,new Ext.XTemplate(t).apply(e)},onAfterRender:function(){this.callParent(arguments);var e=this.getWrapEl();e.unselectable()},onAfterReRender:function(){this.callParent(arguments);var e=this.getWrapEl();e.unselectable()},updateItems:function(e){this.items=Ext.Object.merge([],e),this.safeRerender()},updateItem:function(e,t){var r=this.items;e>r.length||e<0||(Ext.Object.merge(r[e],t),this.safeRerender())},setSelectedItem:function(e){var t=this.items.length;if(!(this.selectedItemIndex===e||e<0||e>t)){this.selectedItemIndex=e;var r=Ext.query(".ts-sidebar-selected-item")[0],n=Ext.query("li[data-item-index='"+e+"']")[0],i=Terrasoft.utils.dom;r&&i.removeClassName(r,"ts-sidebar-selected-item"),n&&i.addClassName(n,"ts-sidebar-selected-item")}},setMinMaxWidth:function(e,t){var r=t+"Width",n=this[r];void 0!==n&&n!==e&&(this[r]=e,this.rendered&&(this.getWrapEl().dom.style[r]=e))},getSelectedItemIndex:function(){return this.selectedItemIndex},getItemConfig:function(e){return e<0?null:this.items[e]},getItems:function(){return Terrasoft.deepClone(this.items)},getItemImageEl:function(e){var t,r=this.items;Terrasoft.each(r,(function(r,n){if(r.tag===e)return t=n,!1}),this);var n=null;if(Ext.isDefined(t)){var i=Ext.String.format("#sidebar-item-image-{0}",t);n=this.getWrapEl().down(i)}return n},getBindConfig:function(){var e=this.callParent(arguments),t={collapsed:{changeMethod:"setCollapsed"}};return Ext.apply(t,e),t},setCollapsed:function(e){this.collapsed!==e&&(this.collapsed=e)}}),Ext.define("Terrasoft.controls.TabPanel",{alternateClassName:"Terrasoft.TabPanel",extend:"Terrasoft.Container",_itemsElResizeObserver:null,_styleSheetId:null,scrollIndex:0,_initialMarginLeft:0,tpl:['<div id="{id}-wrap" class="{wrapClass}">','<div id="{id}-items-wrap" class="ts-tabpanel-wrap">','<tpl if="isScrollVisible">','<div id="{id}-scroll-left" class="{scrollLeftClass}"></div>',"</tpl>",'<ul id="{id}-tabpanel-items"  style="{ulCustomStyle}" class="ts-tabpanel-items {scrollAnimationClass} {ulCustomClass}">',"{%this.renderTabs(out, values)%}","</ul>",'<tpl if="isScrollVisible">','<div id="{id}-scroll-right" class="{scrollRightClass}"></div>',"</tpl>","</div>",'<div id="{id}-tools" class="ts-tabpanel-tools">',"{%this.renderItems(out, values)%}","</div>",'<tpl if="isCollapseButtonVisible">','<div id="{id}-collapse-button" class="ts-tabpanel-collapse-button"></div>',"</tpl>","</div>"],tabTpl:['<tpl if="visible">',"<li ",'<tpl if="id">',' id="{id}" ',"</tpl>",'data-item-index="{index}" class="ts-box-sizing {wrapClass}" style="{customItemStyle}"','<tpl if="markerValue">',' data-item-marker="{markerValue}"',"</tpl>",'<tpl if="direction"> dir="{direction}"</tpl>',">{caption}</li>","</tpl>"],alignLeftClassName:"ts-tab-align-left",alignRightClassName:"ts-tab-align-right",scrollLeftClass:"ts-tabpanel-scroll-left",scrollRightClass:"ts-tabpanel-scroll-right",scrollAnimationClass:"scroll-animation",tabTagName:"li",tabIndexElementSelector:"li[data-item-index='{0}']",activeTabName:null,tabs:null,isScrollVisible:!0,collapsed:!1,isCollapseButtonVisible:!1,collapsedClass:"ts-tabpanel-collapsed",defaultPrimaryColumnName:"Name",defaultPrimaryDisplayColumnName:"Caption",defaultVisibleColumnName:"Visible",defaultImageColumnName:"ImageSrc",defaultAlignColumnName:"Align",defaultMarkerValueColumnName:"MarkerValue",activeTabClass:"ts-tabpanel-active-item",imageTabClass:"ts-tab-image",setTabDisplayedByIndex:Ext.emptyFn,_getDirectionSign:function(e){var t="left"===e?-1:1;return Terrasoft.getIsRtlMode()?-1*t:t},getOuterWidth:function(e){return e.getWidth()+this.getTabMarginWidth(e)},getTabMarginWidth:function(e){return e.getMargin("lr")},getTabPositionConfig:function(e){var t=this.getVisibleTabsWrap().getBox(),r=e.getBox();return{leftOutside:r.left-t.left,rightOutside:t.right-r.right,width:this.getOuterWidth(e),domEl:e.dom}},_getTabVisibleInfo:function(e){var t=this.getVisibleTabsPositionConfig();if(0===t.length)return{};var r=this._getTabElIndex(e),n=t.shift(),i=t.pop();return{isHiddenAtBegin:this._getTabElIndex(n.domEl)>r,isHiddenAtEnd:(i&&this._getTabElIndex(i.domEl))<r}},_getFirstLeftHiddenTab:function(){var e=this._getFirstLeftHiddenTabPositionConfig();if(e)return Ext.get(e.domEl)},_getFirstRightHiddenTab:function(){var e=this._getFirstRightHiddenTabPositionConfig();if(e)return Ext.get(e.domEl)},_getFirstLeftHiddenTabPositionConfig:function(){return this.getTabsPostionConfigArray().filter((function(e){return e.leftOutside<0})).pop()},_getFirstRightHiddenTabPositionConfig:function(){return this.getTabsPostionConfigArray().filter((function(e){return e.rightOutside<0})).shift()},getVisibleTabsPositionConfig:function(){return this.getTabsPostionConfigArray().filter((function(e){return e.leftOutside>=0&&e.rightOutside>=0}))},getTabsPostionConfigArray:function(){var e=[],t=this.getTabsElements();return t?(t.each((function(t){var r=this.getTabPositionConfig(t);e.push(r)}),this),e):e},getLeftLimitPositionTabs:function(){var e=this.getTabsWidth(),t=this.getVisibleTabsWrap(),r=this._initialMarginLeft,n=-(e-r-t.getWidth(!0));return{max:r,min:Math.min(n,r)}},setLeftPositionTabs:function(e){var t=this.getTabsElementsLeft(),r=this.getLeftLimitPositionTabs(),n=t+e+this._initialMarginLeft;n=Math.min(n,r.max),n=Math.max(n,r.min),this.setTabsElementsLeft(n)},getTabsElementsLeft:function(){var e=this.getFirstTabEl();return parseInt(e.getAttribute("left")||this._initialMarginLeft,10)},setTabsElementsLeft:function(e){var t=this.getFirstVisibleTabEl();if(t){var r=Ext.String.format("{0}px",e),n=this._getMarginDirection();t.setStyle(n,r),t.set({left:e})}},_getMarginDirection:function(){return Terrasoft.getIsRtlMode()?"margin-right":"margin-left"},scrollToRight:function(e){var t=Terrasoft.getIsRtlMode()?"left":"right";this.scrollTo(e,t)},scrollToLeft:function(e){var t=Terrasoft.getIsRtlMode()?"right":"left";this.scrollTo(e,t)},scrollTo:function(e,t){if(e){var r=this.getTabPositionConfig(e),n=t+"Outside",i=this._getDirectionSign(t)*(r[n]-this._initialMarginLeft);this.setLeftPositionTabs(i),this.onAfterScroll(e)}},_destroyDomEvents:function(){this._itemsElResizeObserver&&this._itemsElResizeObserver.disconnect();var e=this.getWrapEl();e&&e.un("click",this.onTabClick);var t=this.getScrollLeftEl(),r=this.getScrollRightEl();if(this.isScrollVisible&&t&&r&&(t.un("click",this.onScrollLeftElementClick),r.un("click",this.onScrollRightElementClick)),this.isCollapseButtonVisible){var n=this.collapseEl;n&&n.un("click",this.toggleCollapsed)}},_generateCssRules:function(){var e=Ext.String.format("{0}-stylesheet",this.id);this.styleSheetId&&this._clearStyleSheet();var t=this.getVisibleTabsWrap(),r=t&&t.getWidth();if(r){var n=Ext.String.format("#{0}-wrap .ts-tabpanel-items li { max-width: {1}px; }",this.id,.8*r-this._initialMarginLeft);Terrasoft.createStyleSheet(n,e),this.styleSheetId=e}},_clearStyleSheet:function(){this.styleSheetId&&(Terrasoft.removeStyleSheet(this.styleSheetId),this.styleSheetId=null)},_getTabElIndex:function(e){return e&&parseInt(e.getAttribute("data-item-index"),10)},getTabByName:function(e){var t=this;return this.tabs.filter((function(r){return t.getTabName(r)===e})).first()},getTabDomElementByIndex:function(e){var t=this.wrapEl;if(!t)return null;var r=Ext.String.format(this.tabIndexElementSelector,e);return t.query(r)[0]},getActiveTabDomElement:function(){var e=this.wrapEl;if(!e)return null;var t=Ext.String.format(".{0}",this.activeTabClass);return e.query(t)[0]},getTabName:function(e){var t=e.primaryColumnName||this.defaultPrimaryColumnName;return e.get(t)},getTabCaption:function(e){var t=e.primaryDisplayColumnName||this.defaultPrimaryDisplayColumnName;return e.get(t)},_getTabVisibility:function(e){var t=e.get(this.defaultVisibleColumnName);return!!Ext.isEmpty(t)||t},getTabMarkerValue:function(e){var t=this.defaultMarkerValueColumnName;return e.get(t)},showNextTab:function(){var e=this._getFirstRightHiddenTab();this.scrollToLeft(e)},showPreviousTab:function(){var e=this._getFirstLeftHiddenTab();this.scrollToRight(e)},_scrollToActiveTabDelay:20,_delayedScrollToActiveTabFn:null,init:function(){this.callParent(arguments),this._delayedScrollToActiveTabFn=Terrasoft.debounce(this.scrollToActiveTab,this._scrollToActiveTabDelay),this.addEvents("activeTabChange","tabRender","collapsedchanged","scrollIndexChanged"),this.selectors={wrapEl:""}},initDomEvents:function(){this.callParent(arguments);var e=this.getWrapEl(),t=this.getScrollLeftEl(),r=this.getScrollRightEl();if(e.on("click",this.onTabClick,this,{delegate:"li"}),this.isScrollVisible&&(t.on("click",this.onScrollLeftElementClick,this),r.on("click",this.onScrollRightElementClick,this)),this.isCollapseButtonVisible){var n=this.collapseEl;n&&n.on("click",this.toggleCollapsed,this)}this.itemsEl&&(this._itemsElResizeObserver=this._itemsElResizeObserver||new window.ResizeObserver(this.onResizeItemsElContainer.bind(this)),this._itemsElResizeObserver.observe(this.itemsEl.dom))},onResizeItemsElContainer:function(){Terrasoft.defer(this._generateCssRules,this)},initMaxLeftPosition:function(){var e=this.getFirstTabEl(),t=e&&e.getMargin("l");this._initialMarginLeft=t||0},getTplData:function(){var e=this.isScrollVisible,t=this.isCollapseButtonVisible,r=this.callParent(arguments);return r.renderTabs=this.renderTabs,r.isScrollVisible=e,r.isCollapseButtonVisible=t,r.wrapClass=["ts-tabpanel"],r.scrollLeftClass=this.scrollLeftClass,r.scrollAnimationClass=this.scrollAnimationClass,r.scrollRightClass=this.scrollRightClass,e&&r.wrapClass.push("ts-tabpanel-scroll-visible"),t&&(r.wrapClass.push("ts-tabpanel-collapse-visible"),this.collapsed&&r.wrapClass.push(this.collapsedClass)),this.selectors.wrapEl="#"+this.id+"-wrap",this.selectors.itemsWrapEl="#"+this.id+"-items-wrap",this.selectors.toolsEl="#"+this.id+"-tools",this.selectors.itemsEl="#"+this.id+"-tabpanel-items",this.selectors.scrollLeftEl="#"+this.id+"-scroll-left",this.selectors.scrollRightEl="#"+this.id+"-scroll-right",this.selectors.collapseEl="#"+this.id+"-collapse-button",this.selectors.visibleItemsWrapEl="#"+this.id+"-tabpanel-items",r},getBindConfig:function(){var e=this.callParent(arguments),t={tabs:{changeMethod:"onTabsCollectionDataChange"},activeTabName:{changeMethod:"onActiveTabNameChange",changeEvent:"activeTabChange"},isScrollVisible:{changeMethod:"onIsScrollVisibleChange"},collapsed:{changeEvent:"collapsedchanged",changeMethod:"setCollapsed"},scrollIndex:{changeEvent:"scrollIndexChanged",changeMethod:"setScrollIndex"}};return Ext.apply(t,e),t},reRenderPanel:function(){this.safeRerender()},onTabClick:function(e){var t=e.target,r=this.tabs,n=t.getAttribute("data-item-index"),i=r.getByIndex(n),a=this.getTabName(i);this.setActiveTab(a),this._delayedScrollToActiveTabFn()},onScrollLeftElementClick:function(){this.showPreviousTab()},onScrollRightElementClick:function(){this.showNextTab()},onTabsCollectionDataChange:function(){this.reRenderPanel()},getVisibleTabsWrap:function(){return this.visibleItemsWrapEl},scrollToEl:function(e){if(e){var t=this._getTabVisibleInfo(e);t.isHiddenAtBegin&&this.scrollToLeft(e),t.isHiddenAtEnd&&this.scrollToRight(e)}},getTabsElements:function(){return this.wrapEl&&this.wrapEl.select(this.tabTagName)},getFirstTabEl:function(){var e=this.wrapEl&&this.wrapEl.select(this.tabTagName+":first-child");return e&&e.first()},getFirstVisibleTabEl:function(){var e=this.wrapEl&&this.wrapEl.select(this.tabTagName+":visible");return e&&e.first()},getLastTabEl:function(){return this.wrapEl&&this.wrapEl.select(this.tabTagName+":last-child").first()},getScrollLeftEl:function(){return Terrasoft.getIsRtlMode()?this.scrollRightEl:this.scrollLeftEl},getScrollRightEl:function(){return Terrasoft.getIsRtlMode()?this.scrollLeftEl:this.scrollRightEl},onActiveTabNameChange:function(e){this.setActiveTab(e),this._delayedScrollToActiveTabFn()},onIsScrollVisibleChange:function(e){this.isScrollVisible=e,this.rendered&&this.reRender()},onAfterScroll:function(e){var t=this._getTabElIndex(e);this.setScrollIndex(t)},onAfterRender:function(){this.callParent(arguments),this.initMaxLeftPosition()},onAfterReRender:function(){this.callParent(arguments),this.initMaxLeftPosition();var e=this.tabs.getCount();if(0!==e){var t=this.getActiveTabIndex();t>0&&this._delayedScrollToActiveTabFn()}},scrollToActiveTab:function(){var e=this.getActiveTabIndex(),t=this.getTabElementByIndex(e);this.scrollToEl(t)},getActiveTabIndex:function(){return this.getTabIndexByName(this.activeTabName)},getTabIndexByName:function(e){var t=this.tabs;if(!e||!t)return-1;var r=this.getTabByName(e);return t.indexOf(r)},subscribeForCollectionEvents:function(e,t,r){this.callParent(arguments);var n=r.get(e.modelItem);n.on("dataLoaded",this.onTabsCollectionDataChange,this),n.on("add",this.onAddTab,this),n.on("remove",this.onTabRemove,this),n.on("clear",this.onTabsCollectionDataChange,this),n.on("itemChanged",this.onTabChange,this)},unSubscribeForCollectionEvents:function(e,t,r){this.callParent(arguments);var n=r.get(e.modelItem);n.un("dataLoaded",this.onTabsCollectionDataChange,this),n.un("add",this.onAddTab,this),n.un("remove",this.onTabRemove,this),n.un("clear",this.onTabsCollectionDataChange,this),n.un("itemChanged",this.onTabChange,this)},renderTabs:function(e,t){var r=t.self;if(r.tabs){var n=r.getTabsRenderTemplateTree();Ext.DomHelper.generateMarkup(n,e)}},getTabsRenderTemplateTree:function(){for(var e=this.tabs,t=[],r=0,n=e.getCount();r<n;r++){var i=e.getByIndex(r),a=this.getTabTplConfig(i,r),s={html:this.generateTabHtml(a),tab:i,index:r,tabs:e};this.fireEvent("tabRender",s),t.push(s.html)}return t},getTabTplConfig:function(e,t){var r=this.activeTabName,n=Terrasoft.encodeHtml(this.getImage(e)),i=this.getAlignClass(e),a=[],s=null;n&&(s=Ext.String.format("background-image: url({0})",n),a.push(this.imageTabClass)),i&&a.push(i),this.getTabName(e)===r&&a.push(this.activeTabClass);var o=Terrasoft.encodeHtml(this.getTabCaption(e))||"&nbsp",l=Terrasoft.encodeHtml(this.getTabMarkerValue(e)),c=e.get("Id");return{wrapClass:a.join(" "),caption:o,visible:this._getTabVisibility(e),markerValue:l,index:t,imageSrc:n,customItemStyle:s,direction:Terrasoft.getTextDirection(o),id:c}},generateTabHtml:function(e){return new Ext.XTemplate(this.tabTpl).apply(e)},toggleCollapsed:function(){var e=!this.collapsed;this.setCollapsed(e)},setCollapsed:function(e){this.collapsed!==e&&(this.collapsed=e,this.rendered&&(e?this.wrapEl.addCls(this.collapsedClass):this.wrapEl.removeCls(this.collapsedClass),this.fireEvent("collapsedchanged",e)))},getTabElementByIndex:function(e){var t=this.wrapEl;if(!t)return null;var r=Ext.String.format(this.tabIndexElementSelector,e);return t.select(r).first()},setScrollIndex:function(e){var t=this.scrollIndex!==e;return t&&(this.scrollIndex=e,this.fireEvent("scrollIndexChanged",e,this)),t},restoreTabPanelScroll:function(e){var t=this.getTabElementByIndex(e);this.scrollToLeft(t)},tabDisplayed:function(e){var t=this.getTabElementByIndex(e);if(!t)return!1;var r=this.getTabPositionConfig(t);return r.leftOutside>=0&&r.rightOutside>=0},scrollToTab:function(e){e=e||0;var t=this.getTabElementByIndex(e);this.scrollToLeft(t)},onDestroy:function(){this.callParent(arguments),this._destroyDomEvents(),this._clearStyleSheet()},onAddTab:function(){this.reRenderPanel()},onTabRemove:function(){this.reRenderPanel()},onTabChange:function(){this.reRenderPanel()},getAlignClass:function(e){var t=e.get(this.defaultAlignColumnName);return t===Terrasoft.Align.LEFT?this.alignLeftClassName:t===Terrasoft.Align.RIGHT?this.alignRightClassName:Terrasoft.emptyString},getImage:function(e){return e.get(this.defaultImageColumnName)},setActiveTab:function(e){var t=this.activeTabName;this.activeTabName=e;var r=this.tabs,n=this.getTabByName(e);if(n&&t!==e){var i=this.getTabByName(t),a=this.getActiveTabDomElement();a&&this.toggleCssClasses(a,i,!1);var s=r.indexOf(n),o=this.getTabDomElementByIndex(s);o&&(this.toggleCssClasses(o,n,!0),this.fireEvent("activeTabChange",n,s,r))}},toggleCssClasses:function(e,t,r){var n=this.activeTabClass,i=Ext.fly(e);r?i.hasCls(n)||i.toggleCls(n):i.hasCls(n)&&i.toggleCls(n)},getRenderToEl:function(){return this.toolsEl},getScrollIndex:function(){return this.scrollIndex},getTabsWidth:function(){for(var e=0,t=this.getTabsElements(),r=0;r<t.getCount();r++){var n=t.item(r);e+=this.getOuterWidth(n)}return e-Math.abs(this.getTabsElementsLeft())+this._initialMarginLeft||0}}),Ext.define("Terrasoft.controls.ImageTabPanel",{alternateClassName:"Terrasoft.ImageTabPanel",extend:"Terrasoft.TabPanel",backgroundImage:null,tabTpl:['<li data-item-index="{index}" class="ts-box-sizing {wrapClass}" style="{customItemStyle}"','<tpl if="markerValue">',' data-item-marker="{markerValue}"',"</tpl>",'><span data-item-index="{index}">{caption}</span></li>'],defaultIsRequiredColumnName:"IsRequired",defaultActiveTabImageColumnName:"ActiveTabImage",defaultDefaultTabImageColumnName:"DefaultTabImage",requiredClass:"ts-imagetabpanel-required",imageTabPanelWrapClass:"ts-imagetabpanel",imageTabClass:"",getTplData:function(){var e=this.callParent(arguments);return e.wrapClass=e.wrapClass+" "+this.imageTabPanelWrapClass,this.backgroundImage&&(e.ulCustomClass="ts-imagetabpanel-backgroundImage",e.ulCustomStyle="background-image: url("+Terrasoft.ImageUrlBuilder.getUrl(this.backgroundImage)+");"),e},getTabTplConfig:function(e){var t=this.callParent(arguments),r=Terrasoft.encodeHtml(this.getImage(e));return t.customItemStyle="background-image: url("+r+");",this.getIsRequired(e)&&(t.wrapClass=t.wrapClass+" "+this.requiredClass),t},toggleCssClasses:function(e,t,r){this.callParent(arguments);var n=Ext.fly(e),i=Terrasoft.getFormattedString("url({0})",this.getTabImage(t,r));n.setStyle("background-image",i)},getImage:function(e){var t=this.getTabName(e);return this.getTabImage(e,t===this.activeTabName)},getIsRequired:function(e){var t=e.isRequiredColumnName||this.defaultIsRequiredColumnName;return e.get(t)},getTabImage:function(e,t){var r=this.getTabImageColumnName(e,t);return e.get(r)},getTabImageColumnName:function(e,t){var r=e.activeTabImageColumnName||this.defaultActiveTabImageColumnName,n=e.defaultTabImageColumnName||this.defaultDefaultTabImageColumnName;return t?r:n},toggleRequiredCss:function(e){var t=this.getIsRequired(e),r=this.tabs.indexOf(e),n=this.getTabDomElementByIndex(r),i=this.requiredClass,a=Ext.fly(n);t?a.hasCls(i)||a.toggleCls(i):a.hasCls(i)&&a.toggleCls(i)},getBindConfig:function(){var e=this.callParent(arguments),t={backgroundImage:{changeMethod:"onBackgroundImageChange"}};return Ext.apply(e,t),e},onBackgroundImageChange:function(e){this.backgroundImage=e,this.reRenderPanel()}}),Ext.define("Terrasoft.controls.GridLayout",{extend:"Terrasoft.controls.Container",alternateClassName:"Terrasoft.GridLayout",layoutItems:null,maxRowsCount:0,maxColumnsCount:24,equalColumnsCount:24,columnsMultiplier:1,rowHeight:"0px",fixedColumnHeight:32,fixedColumnHeightCssClass:"fixed-col-height",spacerCssClass:"grid-layout-spacer",itemDomIdSuffix:"-item-",collapseEmptyRow:!1,isViewMode:!1,cellsIntersectionErrorMessageTemplate:Terrasoft.Resources.GridLayout.ColumnsWidthIntersected,rowClassTemplate:"grid-layout-row ts-box-sizing {rowClassName}",columnClassTemplate:"grid-layout-column ts-box-sizing {columnClassName}",allowOverlap:!1,_checkLayoutItem:function(e){if(!e.hasOwnProperty("item")||Ext.isEmpty(e.item)){var t=Terrasoft.Resources.GridLayout.ItemConfigIsEmpty,r=Terrasoft.getFormattedString(t,this.id,e.row.toString(),e.column.toString());throw new Terrasoft.NullOrEmptyException({message:r})}},_preparePosition:function(e){var t=this.getLayoutItemList(),r=_.filter(t,(function(t){return this.isIntersect(t,e)}),this);if(!_.isEmpty(r)){var n=_.max(r,(function(e){return e.row+(e.rowSpan||1)}));e.row=n.row+n.rowSpan;var i={},a=this.layoutItems;_.keys(a).reverse().forEach((function(t){if((t=Number(t))>=e.row){var r=t+e.rowSpan+1;i[r]={},_.keys(a[t]).forEach((function(e){i[r][e]=a[t][e],i[r][e].row=r}),this)}else i[t]=a[t]}),this),this.layoutItems=i}},separateItemsFromLayout:function(e){var t=[],r=this.columnsMultiplier;return Terrasoft.each(e,(function(e){this._checkLayoutItem(e),t.push(e.item),e.itemId=e.item.id,delete e.item,e.rowSpan=e.rowSpan||1,e.colSpan=e.colSpan||1,e.column=r*e.column,e.colSpan=r*e.colSpan,this.allowOverlap&&this._preparePosition(e),this.addLayoutItem(e)}),this),t},getLayoutItemList:function(){var e=Ext.Object.getValues(this.layoutItems),t=Ext.Array.map(e,(function(e){return Ext.Object.getValues(e)}));return 0===t.length?[]:t.reduce((function(e,t){return e.concat(t)}))},generateRow:function(e){for(var t=[],r=e.minRow;r<e.maxRow;r++){for(var n=null,i=e.minColumn;i<e.maxColumn;i++){var a=this.getLayoutItem({row:r,column:i});if(a){var s=r+a.rowSpan,o=this.calculateRowHeight({minRow:r,maxRow:s,minColumn:e.minColumn,maxColumn:e.maxColumn});n=this.getRowHtmlConfig(),e.withoutChildrens||(n.children=this.generateColumn({minRow:r,maxRow:r+o,minColumn:e.minColumn,maxColumn:e.maxColumn})),r+=o-1;break}}n||((n=this.getRowHtmlConfig()).children=[this.getSpacerHtmlConfig()]),t.push(n)}return t},_setColumnStyle:function(e,t,r,n){t.hasOwnProperty("style")||(t.style={});var i=n&&n.rowSpan||t["data-rowspan"];e>0&&(t.style.height=i*e+r),n&&n.useFixedColumnHeight&&(t.style.height=i*this.fixedColumnHeight+r,t.cls+=this.fixedColumnHeightCssClass)},_getDefaultColumnConfig:function(e,t,r){return(e=this.getColumnHtmlConfig(1,1)).children=[this.getSpacerHtmlConfig()],this._setColumnStyle(t,e,r),e},_getValueRangeConfig:function(e,t,r){return{minRow:e.minRow,maxRow:e.maxRow,minColumn:t,maxColumn:t+r}},generateColumn:function(e){for(var t=[],r=parseInt(this.rowHeight,10),n=this.rowHeight.replace(r,""),i=e.minColumn;i<e.maxColumn;i++){for(var a=null,s=e.minRow;s<e.maxRow;s++){var o=this.getLayoutItem({row:s,column:i});if(o){var l=this._getValueRangeConfig(e,i,o.colSpan),c=this.getColumnWidth(l),u=this._getValueRangeConfig(e,i,c),h=Ext.apply(Terrasoft.deepClone(u),{withoutChildrens:!0}),f=this.generateRow(h),d=1===f.length&&e.maxColumn-e.minColumn===c?this.maxColumnsCount:c;a=this.getColumnHtmlConfig(d,o.rowSpan),f.length>1?a.children=this.generateRow(u):(a.html=this.getLayoutItemHtmlConfig(o),a.cls+=" {itemCell}",a["data-column"]=o.column,a["data-row"]=o.row,this._setColumnStyle(r,a,n,o),o&&o.hasOwnProperty("itemId")&&o.itemId&&(a.id=this.id+this.itemDomIdSuffix+o.itemId)),i+=c-1;break}}a?t.push(a):t.push(this._getDefaultColumnConfig(a,r,n))}return t=this.postProcessColumns(t)},getColumnWidth:function(e){for(var t=e.maxColumn-e.minColumn,r=!1,n=e.minRow;n<e.maxRow;n++){for(var i=e.minColumn;i<e.maxColumn;i++){var a=this.getLayoutItem({row:n,column:i});if(a){var s=a.colSpan;i+s>e.maxColumn&&(e.maxColumn=i+s,t=e.maxColumn-e.minColumn,r=!0)}}!0===r&&(n=e.minRow-1,r=!1)}return t},postProcessColumns:function(e){var t=0;return Ext.Array.each(e,(function(e){t+=parseInt(e["data-colspan"],10)}),this),Ext.Array.each(e,(function(e){e.hasOwnProperty("style")||(e.style={}),e.style.width=100*e["data-colspan"]/t+"%",e.style=Ext.DomHelper.generateStyles(e.style)}),this),e},getLayoutItem:function(e){var t=e.row,r=e.column;return this.layoutItems[t]&&this.layoutItems[t][r]||null},calculateRowHeight:function(e){for(var t=e.maxRow-e.minRow,r=e.minRow;r<e.maxRow;r++)for(var n=e.minColumn;n<e.maxColumn;n++){var i=this.getLayoutItem({row:r,column:n});if(i){var a=r+i.rowSpan;a>e.maxRow&&(e.maxRow=a,t=e.maxRow-e.minRow)}}return t},getRowHtmlConfig:function(){return{tag:"div",cls:this.rowClassTemplate,children:[]}},getColumnHtmlConfig:function(e,t){return{tag:"div",cls:this.columnClassTemplate,"data-colspan":e,"data-rowspan":t,children:[]}},getLayoutItemHtmlConfig:function(e){var t=e&&e.hasOwnProperty("itemId")?e.itemId:"";return Ext.isEmpty(t)?"":'{%parent.renderItem(out, values, "'+t+'")%}'},getSpacerHtmlConfig:function(){return'<div class="grid-layout-columns '+this.spacerCssClass+' {spacerClassName}" style="width:100%;"></div>'},init:function(){this.layoutItems=this.layoutItems||{},this.callParent(arguments)},getTplData:function(){var e=this.callParent(arguments);return e.wrapClassName=this.getTplDataClasses(),e},getTplDataClasses:function(){var e=["grid-layout","ts-box-sizing"];return this.collapseEmptyRow&&e.push("collapse-empty-row"),e},prepareItems:function(e){return this.columnsMultiplier=this.maxColumnsCount/this.equalColumnsCount,e=this.separateItemsFromLayout(e),this.checkCellsIntersection(),this.maxRowsCount=this.getRowsCount(),this.callParent([e])},getRowsCount:function(){var e=Ext.Object.getKeys(this.layoutItems),t=Ext.Array.map(e,(function(e){return parseInt(e,10)}));return Ext.Array.max(t)+1},addLayoutItem:function(e){var t=e.row,r=e.column;this.layoutItems[t]=this.layoutItems[t]||{},this.layoutItems[t][r]=e},isIntersect:function(e,t){return e.column<t.column+t.colSpan&&t.column<e.column+e.colSpan&&e.row<t.row+t.rowSpan&&t.row<e.row+e.rowSpan},handleCellsIntersectionError:function(e,t){var r=Terrasoft.getFormattedString(this.cellsIntersectionErrorMessageTemplate,this.id,e.itemId,t.itemId);this.log(r,Terrasoft.LogMessageType.ERROR)},checkCellsIntersection:function(){var e=this.getLayoutItemList();Ext.Array.sort(e,function(e,t){this.isIntersect(e,t)&&this.handleCellsIntersectionError(e,t)}.bind(this))},renderItem:function(e,t,r){var n=t.items.getByKey(r);this.callParent([e,n])},renderItems:function(e,t){var r=t.self,n=r.generateRow({minRow:0,maxRow:r.maxRowsCount,minColumn:0,maxColumn:r.maxColumnsCount}),i=Ext.DomHelper.markup(n);(i=new Ext.XTemplate(i)).applyOut(t,e,r)},getRenderToEl:function(e){var t=this.getWrapEl();return t?t.select("#"+this.id+this.itemDomIdSuffix+e.id).first():null}}),Ext.define("Terrasoft.controls.ContentBlock",{extend:"Terrasoft.controls.GridLayout",alternateClassName:"Terrasoft.ContentBlock",mixins:{draggable:"Terrasoft.mixins.DraggableContentBlock",selectable:"Terrasoft.mixins.SelectableContentBlock",contentBlock:"Terrasoft.mixins.ContentBlockMixin"},itemName:"content-block",defaultModelNames:{primaryColumn:"Id",column:"Column",row:"Row",colSpan:"ColSpan",rowSpan:"RowSpan"},tplConfigClasses:{wrapClassName:["content-block-wrap"],captionLabelClasses:["content-block-label"],selectButtonClasses:["content-block-select-button"]},spacerCssClass:"content-block-spacer",rowClassTemplate:"content-block-row ts-box-sizing {rowClassName}",columnClassTemplate:"content-block-column ts-box-sizing {columnClassName}",selectButtonTitle:Terrasoft.Resources.ContentBlock.SelectBlockButtonTitle,caption:null,groupMenu:null,defaultRenderTpl:['<div id="{id}-content-block" class="{wrapClassName}">\n\t\t\t<tpl if="caption">\n\t\t\t\t{%this.renderGroupMenu(out, values)%}\n\t\t\t\t<span id="{id}-content-block-label" class="{captionLabelClasses}">{caption}</span>\n\t\t\t</tpl>\n\t\t\t<div id="{id}-content-block-body" style="{wrapStyle}">\n\t\t\t\t<div id="{id}-content-block-select" class="{selectButtonClasses}" title="{selectButtonTitle}"></div>\n\t\t\t\t{%this.renderItems(out, values)%}\n\t\t\t\t<tpl if="hasTools">\n\t\t\t\t\t<div id="{id}-content-block-tools" class="{toolsWrapClasses}">\n\t\t\t\t\t\t<tpl for="tools">\n\t\t\t\t\t\t\t{%this.renderTool(out, values)%}\n\t\t\t\t\t\t</tpl>\n\t\t\t\t\t</div>\n\t\t\t\t</tpl>\n\t\t\t</div>\n\t\t</div>'],init:function(){this.callParent(arguments),this.initTools(),this.initGroupMenu(),this.addEvents("elementSelectedChange")},initRenderData:function(e){this.callParent(arguments),this.addToolsToRenderData(e),e.groupMenu=this.groupMenu,e.renderGroupMenu=this.renderGroupMenu},getTplData:function(){var e=this.callParent(arguments);return this.selectors=this.getSelectors(),this.applyToolsSelector(this.selectors),this.applyTplClasses(e),this.applyToolsTplData(e),this.addSelectedClass(e),e.selectButtonTitle=this.selectButtonTitle,e},initDomEvents:function(){this.callParent(arguments),this.mixins.selectable.subscribeForDomEvents.apply(this),this.subscribeItemsEvents()},getLayoutItemConfig:function(e){var t=this.columnsMultiplier;return Terrasoft.instanceOfClass(e,"Terrasoft.BaseModel")?{itemId:e.get(this.defaultModelNames.primaryColumn),row:e.get(this.defaultModelNames.row),rowSpan:e.get(this.defaultModelNames.rowSpan)||1,column:t*e.get(this.defaultModelNames.column),colSpan:t*(e.get(this.defaultModelNames.colSpan)||1)}:{itemId:e.item.id,row:e.row,rowSpan:e.rowSpan||1,column:t*e.column,colSpan:t*(e.colSpan||1)}},fillLayoutItems:function(e){Terrasoft.each(e,(function(e){var t=this.getLayoutItemConfig(e);this.addLayoutItem(t)}),this)},getRenderToEl:function(e){return-1!==this.tools.indexOf(e)?this.toolsEl:this.callParent(arguments)},getSpacerHtmlConfig:function(){return'<div class="content-block-columns '+this.spacerCssClass+' {spacerClassName}" style="width:100%;"></div>'},prepareItems:function(e){if(!Ext.isArray(e))throw new Terrasoft.UnsupportedTypeException;return this.columnsMultiplier=this.maxColumnsCount/this.equalColumnsCount,this.fillLayoutItems(e),this.maxRowsCount=this.getRowsCount(),this.mixins.contentBlock.prepareBlockItems.call(this,e)},add:function(){this.callParent(arguments),this.checkCellsIntersection()},removeItemFromLayout:function(e){var t=this.layoutItems;Terrasoft.each(t,(function(t){Terrasoft.each(t,(function(r,n){r.itemId===e&&delete t[n]}),this)}),this)},onDeleteItem:function(e){var t=e.get(this.defaultModelNames.primaryColumn);this.mixins.contentBlock.onDeleteItem.apply(this,[e]),this.removeItemFromLayout(t)},clearItems:function(){this.mixins.contentBlock.clearItems.apply(this),this.layoutItems={}},initGroupMenu:function(){var e=this.groupMenu,t=e&&e.className;this.groupMenu=Ext.create(t||"Terrasoft.Component",e),this.groupMenu.added(this)},renderGroupMenu:Terrasoft.emptyFn,onAfterRender:function(){this.callParent(arguments),this.mixins.draggable.onAfterRender.apply(this,arguments)},onAfterReRender:function(){this.callParent(arguments),this.mixins.draggable.onAfterReRender.apply(this,arguments)},onCollectionDataLoaded:function(e){this.mixins.contentBlock.onCollectionDataLoaded.apply(this,[e]),e&&this.checkCellsIntersection()},onUpdateItem:function(e,t){var r=e.get(this.defaultModelNames.primaryColumn);this.removeItemFromLayout(r),this.fillLayoutItems({item:e}),this.checkCellsIntersection(),this.mixins.contentBlock.onUpdateItem.apply(this,[e,t])},onItemAdd:function(){this.callParent(arguments),this.safeRerender()},onSelectedChanged:function(e,t){e&&this.fireEvent("elementSelectedChange",t.id)},subscribeItemsEvents:function(){this.items.each((function(e){e.on("selectedChanged",this.onSelectedChanged,this)}),this)},unSubscribeItemsEvents:function(){this.items.each((function(e){e.un("selectedChanged",this.onSelectedChanged,this)}),this)},subscribeForCollectionEvents:function(e,t,r){var n=r.get(e.modelItem);this.subscribeCollection(n)},unSubscribeForCollectionEvents:function(e,t,r){if(r){var n=r.get(e.modelItem);this.unSubscribeCollection(n)}},constructor:function(){this.callParent(arguments),this.mixins.draggable.addDraggableEvents.apply(this,arguments)},getBindConfig:function(){var e=this.callParent(arguments);return this.applyBlockBindConfig(e),this.applySelectedBindConfig(e),e},indexOf:function(e){var t=this.callParent(arguments);return-1===t&&(t=this.indexOfToolItem(e)),t},bind:function(){this.mixins.bindable.bind.apply(this,arguments),this.mixins.selectable.bindTools.apply(this),this.groupMenu&&this.groupMenu.bind(this.model)},onDestroy:function(){this.mixins.selectable.destroyTools.apply(this),this.mixins.draggable.onDestroy.apply(this,arguments),this.unSubscribeItemsEvents(),this.callParent(arguments)}}),Ext.define("Terrasoft.controls.ContentSection",{extend:"Terrasoft.controls.AbstractContainer",alternateClassName:"Terrasoft.ContentSection",mixins:{contentBlock:"Terrasoft.mixins.ContentBlockMixin",selectable:"Terrasoft.mixins.SelectableContentBlock"},itemName:"content-section",reverseColumnOrder:null,reverseOrderClass:"section-reverse-order",tplConfigClasses:{wrapClassName:["content-section-wrap"]},defaultRenderTpl:['<div id="{id}-content-section" class="{wrapClassName}" style="{wrapStyle}">{%this.renderItems(out, values)%}</div>'],getTplData:function(){var e=this.callParent(arguments);return this.selectors=this.getSelectors(),this.applyTplClasses(e),this.addSelectedClass(e),this.addReverseOrderClass(e),e},getItemConfig:function(e){var t=e.getViewConfig();return Ext.apply(t,this.mixins.contentBlock.getItemConfig.call(this,e)),t.tools=e.getToolsConfig(),t},getSelectors:function(){return{wrapEl:"#"+this.id+"-"+this.itemName}},prepareItems:function(e){return this.mixins.contentBlock.prepareBlockItems.call(this,e)},setReverseOrder:function(e){if(this.reverseColumnOrder!==e){this.reverseColumnOrder=e;var t=this.reverseOrderClass,r=this.getWrapEl();r&&t&&this.rendered&&(e?r.addCls(t):r.removeCls(t))}},addReverseOrderClass:function(e){this.reverseColumnOrder&&e.wrapClassName.push(this.reverseOrderClass)},onDeleteItem:function(e){this.mixins.contentBlock.onDeleteItem.apply(this,[e])},onAddItem:function(e,t,r){var n=this.prepareItems([e]);this.items.insert(t,r,n[0])},clearItems:function(){this.mixins.contentBlock.clearItems.apply(this)},onCollectionDataLoaded:function(e){this.mixins.contentBlock.onCollectionDataLoaded.apply(this,[e])},onUpdateItem:function(e,t){this.mixins.contentBlock.onUpdateItem.apply(this,[e,t])},subscribeForCollectionEvents:function(e,t,r){var n=r.get(e.modelItem);this.subscribeCollection(n)},unSubscribeForCollectionEvents:function(e,t,r){if(r){var n=r.get(e.modelItem);this.unSubscribeCollection(n)}},applySectionBindConfig:function(e){Ext.apply(e,{reverseColumnOrder:{changeEvent:"changed",changeMethod:"setReverseOrder"}})},getBindConfig:function(){var e=this.callParent(arguments);return this.applyBlockBindConfig(e),this.applySelectedBindConfig(e),this.applySectionBindConfig(e),e},bind:function(){this.mixins.bindable.bind.apply(this,arguments)}}),Ext.define("Terrasoft.controls.BaseContentElement",{extend:"Terrasoft.controls.AbstractContainer",alternateClassName:"Terrasoft.BaseContentElement",mixins:{draggable:"Terrasoft.mixins.DraggableContentElement"},selected:!1,columnId:null,container:null,tools:null,toolsWrapClasses:["content-element-tools-wrap"],contentWrapClasses:["content-element-wrap"],selectedClass:"t-content-focus",defaultRenderTpl:['<div id="{id}-content-element" style="{wrapStyle}" class="{wrapClassName}">',"{%this.renderItems(out, values)%}",'<tpl if="hasTools">','<div id="{id}-content-element-tools" class="{toolsWrapClasses}">','<tpl for="tools">',"{%this.renderTool(out, values)%}","</tpl>","</div>","</tpl>","</div>"],initTools:function(){var e=this.tools,t=this.tools=new Ext.util.MixedCollection(!1,this.getComponentId);t.on("add",this.onToolAdd,this),t.on("remove",this.onToolRemove,this),this.addToolItem(e)},renderTool:function(e,t){var r=t.generateHtml();e.push(r)},initRenderData:function(e){this.callParent(arguments),e.tools=this.tools,e.renderTool=this.renderTool},onClick:function(e){this.setSelected(!0),e.stopPropagation()},initDomEvents:function(){this.callParent(arguments);var e=this.getWrapEl();e&&e.on({click:{fn:this.onClick,scope:this}})},getTplData:function(){var e=this.callParent(arguments);return this.selectors=this.getSelectors(),Ext.apply(e,{wrapClassName:this.getWrapClasses()}),Ext.apply(e,{toolsWrapClasses:this.toolsWrapClasses,hasTools:this.tools&&this.tools.getCount()}),e},getWrapClasses:function(){var e=[];return this.contentWrapClasses&&e.push(this.contentWrapClasses),this.selected&&e.push(this.selectedClass),e},getSelectors:function(){return{toolsEl:"#"+this.id+"-content-element-tools",wrapEl:"#"+this.id+"-content-element"}},init:function(){this.callParent(arguments),this.initTools()},getRenderToEl:function(e){return-1!==this.tools.indexOf(e)?this.toolsEl:this.getWrapEl()},added:function(e){if(this.ownerCt=e,this.fireEvent("added",this,e),this.ownerCtListeners=e.on({beforererender:this.onOwnerCtBeforeRerender,afterrender:{fn:this.onOwnerCtAfterRenderOrAfterRerender.bind(this,"afterrender"),scope:this,single:!0},afterrerender:this.onOwnerCtAfterRenderOrAfterRerender.bind(this,"afterrerender"),scope:this,destroyable:!0}),!0===e.rendered){var t=e.indexOf(this)+1,r=e.getRenderToEl(this);r&&this.render(r,t)}},destroyTools:function(){this.destroyItemsCollection(this.tools),this.tools=null},indexOfToolItem:function(e){return this.indexOfCollection(e,this.tools)},onToolAdd:function(e,t){t.added(this)},onToolRemove:Terrasoft.emptyFn,constructor:function(){this.callParent(arguments),this.mixins.draggable.addDraggableEvents.apply(this)},getDraggableConfig:function(){var e={};return e[Terrasoft.DragAction.MOVE]={autoGenerateDraggableElement:!1,elementId:this.id+"-dragg-el-wrapperEl",handlers:{b4StartDrag:"b4StartDrag",onDragEnter:"onDragEnter",onDragOver:"onDragOver",onDragOut:"onDragOut",onDragDrop:"onDragDrop",onInvalidDrop:"onInvalidDrop"}},e},getDraggableElementDefaultConfig:function(){return{isTarget:!1,instance:this,tag:this.tag,columnId:this.columnId}},initDraggable:function(){this.mixins.draggable.initDraggable.apply(this,arguments);var e=this.getWrapEl();e.initDDTarget(this.getGroupName(),{columnId:this.columnId,itemType:"element",id:this.id},{})},setSelected:function(e){if(this.selected!==e){this.selected=e;var t=this.selectedClass,r=this.getWrapEl();r&&t&&this.rendered&&(e?r.addCls(t):r.removeCls(t)),this.fireEvent("selectedChanged",e,this)}},getBindConfig:function(){var e=this.callParent(arguments),t={selected:{changeEvent:"selectedChanged",changeMethod:"setSelected"}};return Ext.apply(t,e),t},indexOf:function(e){var t=this.callParent(arguments);return-1===t&&(t=this.indexOfToolItem(e)),t},bind:function(){this.callParent(arguments),this.tools.each((function(e){e.bind(this.model)}),this)},addToolItem:function(e){this.addToCollection(e,this.tools)},insertToolItem:function(e,t){this.insertIntoCollection(e,t,this.tools)},removeToolItem:function(e){this.removeFromCollection(e,this.tools)},onAfterRender:function(){this.callParent(arguments),this.mixins.draggable.onAfterRender.apply(this,arguments)},onAfterReRender:function(){this.callParent(arguments),this.mixins.draggable.onAfterReRender.apply(this,arguments)},onDestroy:function(){this.destroyTools(),this.mixins.draggable.onDestroy.apply(this,arguments),this.callParent(arguments)}}),Ext.define("Terrasoft.controls.ContentImageElement",{extend:"Terrasoft.controls.BaseContentElement",alternateClassName:"Terrasoft.ContentImageElement",imageConfig:null,contentWrapClasses:["content-image-element-wrap"],imageElClasses:"ts-content-image-element-full-size-element",imageTools:null,imageToolsContainerClass:["content-image-element-tools-container"],placeholderClass:"content-image-element-placeholder",placeholder:"",alt:"",title:"",width:null,height:null,align:null,defaultAlign:Terrasoft.Align.LEFT,defaultRenderTpl:['<div id="{id}-content-image-element-wrap" class="{wrapClassName}">\n\t\t\t<div style="{wrapStyle}">\n\t\t\t\t<tpl if="hasImage">\n\t\t\t\t\t<img id="{id}-content-image-element" class="{imageElClasses}" style="{imageStyles}" src="{imageSrc}"\n\t\t\t\t\t\t<tpl if="hasTitle"> title="{title}"</tpl> alt="{alt}" width="{width}" height="{height}" />\n\t\t\t\t<tpl else>\n\t\t\t\t\t<div id="{id}-content-image-placeholder" class="{placeholderClass}">\n\t\t\t\t\t\t<span>{placeholder}</span>\n\t\t\t\t\t</div>\n\t\t\t\t</tpl>\n\t\t\t\t<tpl if="hasTools">\n\t\t\t\t\t<div id="{id}-content-element-tools" class="{toolsWrapClasses}">\n\t\t\t\t\t\t<tpl for="tools">\n\t\t\t\t\t\t\t{%this.renderTool(out, values)%}\n\t\t\t\t\t\t</tpl>\n\t\t\t\t\t</div>\n\t\t\t\t</tpl>\n\t\t\t\t<div id="{id}-content-image-element-tools" class="{imageToolsContainerClass}">\n\t\t\t\t\t<tpl for="imageTools">\n\t\t\t\t\t\t{%this.renderTool(out, values)%}\n\t\t\t\t\t</tpl>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</div>'],_getMaxWidth:function(e){if(e.self.styles&&e.self.styles.wrapStyle){var t=e.self.width?Ext.String.format("{0}px",this.width):"100%",r=Terrasoft.calculateStylesWidth(e.self.styles.wrapStyle);return"100%"===t?e.self.height>0?null:"100%":Ext.String.format("calc({0} - {1}px)",t,r)}},_getWidth:function(e){if(this.width){var t=Terrasoft.calculateStylesWidth(e.self.styles.wrapStyle);return t>0?Ext.String.format("calc({0} - {1}px)",this.width,t):Ext.String.format("{0}px",this.width)}return this.height>0?"auto":"100%"},_createImageStyles:function(e){return Ext.DomHelper.generateStyles({width:this._getMaxWidth(e),height:"100%"})},_createWrapperStyles:function(e){var t=Ext.apply({},{width:this._getWidth(e),height:this.height?Ext.String.format("{0}px",this.height):"auto"},e.self.styles.wrapStyle);return Ext.DomHelper.generateStyles(t)},initRenderData:function(e){this.callParent(arguments),e.imageTools=this.imageTools},initTools:function(){this.callParent();var e=this.imageTools;(this.imageTools=new Ext.util.MixedCollection(!1,this.getComponentId)).on("add",this.onToolAdd,this),this.addToCollection(e,this.imageTools)},destroyTools:function(){this.callParent(),this.destroyItemsCollection(this.imageTools),this.imageTools=null},getSelectors:function(){return{toolsEl:"#"+this.id+"-content-image-element-tools",wrapEl:"#"+this.id+"-content-image-element-wrap",imageEl:"#"+this.id+"-content-image-element",placeholderEl:"#"+this.id+"-content-image-placeholder"}},applyContentAlign:function(e){e.wrapClassName.push("content-image-element-align-"+this.align)},getTplData:function(){var e=this.callParent(arguments),t=this.imageConfig&&(!Ext.isEmpty(this.imageConfig.url)||!Ext.isEmpty(this.imageConfig.imageSrc)),r=!Ext.isEmpty(this.title),n=t?Terrasoft.ImageUrlBuilder.getUrl(this.imageConfig):"";return Ext.apply(e,{imageElClasses:this.imageElClasses,imageSrc:n,imageToolsContainerClass:this.imageToolsContainerClass,placeholder:Terrasoft.encodeHtml(this.placeholder),placeholderClass:this.placeholderClass,hasImage:t,imageStyles:this._createImageStyles(e),wrapStyle:this._createWrapperStyles(e),width:this.width||"auto",height:this.height||"auto",alt:this.alt,title:this.title,hasTitle:r}),this.applyContentAlign(e),e},getBindConfig:function(){var e=this.callParent(arguments),t={imageConfig:{changeMethod:"setImage"},placeholder:{changeMethod:"setPlaceholder"},width:{changeMethod:"setWidth"},height:{changeMethod:"setHeight"},align:{changeMethod:"setAlign"},alt:{changeMethod:"setAlt"},title:{changeMethod:"setTitle"}};return Ext.apply(t,e),t},bind:function(){this.callParent(arguments),this.imageTools.each((function(e){e.bind(this.model)}),this)},setPlaceholder:function(e){Terrasoft.isEqual(this.placeholder,e)||(this.placeholder=e,Ext.isEmpty(this.imageConfig)&&this.safeRerender())},setImage:function(e){Ext.Object.equals(e,this.imageConfig)||(this.imageConfig=e,this.safeRerender())},setAlt:function(e){Terrasoft.isEqual(this.alt,e)||(this.alt=e,this.safeRerender())},setTitle:function(e){Terrasoft.isEqual(this.title,e)||(this.title=e,this.safeRerender())},setAlign:function(e){var t=[Terrasoft.core.enums.Align.LEFT,Terrasoft.core.enums.Align.CENTER,Terrasoft.core.enums.Align.RIGHT];if(e=e||this.defaultAlign,!Terrasoft.contains(t,e))throw new Terrasoft.UnsupportedTypeException;Terrasoft.isEqual(this.align,e)||(this.align=e,this.safeRerender())},setHeight:function(e){Terrasoft.isEqual(this.height,e)||(this.height=e,this.safeRerender())},setWidth:function(e){Terrasoft.isEqual(this.width,e)||(this.width=e,this.safeRerender())}}),Ext.define("Terrasoft.controls.ContentMjImage",{extend:"Terrasoft.controls.ContentImageElement",alternateClassName:"Terrasoft.ContentMjImage",contentWrapClasses:["content-mjimage-wrap"],imageElClasses:"content-mjimage-image",defaultAlign:Terrasoft.Align.CENTER,imageBorderStyles:["border-radius","border-top","border-right","border-bottom","border-left"],defaultRenderTpl:['<div id="{id}-content-mjimage-wrap" class="{wrapClassName}">\n\t\t\t<div style="{wrapStyle}" class="{wrapStylesClassName}">\n\t\t\t\t<tpl if="hasImage">\n\t\t\t\t\t<img id="{id}-content-mjimage" class="{imageElClasses}" style="{imageStyles}" src="{imageSrc}"\n\t\t\t\t\t\t<tpl if="hasTitle"> title="{title}"</tpl> alt="{alt}" width="{width}" height="{height}" />\n\t\t\t\t<tpl else>\n\t\t\t\t\t<div id="{id}-content-image-placeholder" class="{placeholderClass}">\n\t\t\t\t\t\t<span class="placeholder-image"></span>\n\t\t\t\t\t\t<br>\n\t\t\t\t\t\t<span>{placeholder}</span>\n\t\t\t\t\t</div>\n\t\t\t\t</tpl>\n\t\t\t\t<tpl if="hasTools">\n\t\t\t\t\t<div id="{id}-content-element-tools" class="{toolsWrapClasses}">\n\t\t\t\t\t\t<tpl for="tools">\n\t\t\t\t\t\t\t{%this.renderTool(out, values)%}\n\t\t\t\t\t\t</tpl>\n\t\t\t\t\t</div>\n\t\t\t\t</tpl>\n\t\t\t\t<div id="{id}-content-image-element-tools" class="{imageToolsContainerClass}">\n\t\t\t\t\t<tpl for="imageTools">\n\t\t\t\t\t\t{%this.renderTool(out, values)%}\n\t\t\t\t\t</tpl>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</div>'],_applyStyleIfIsDefined:function(e,t,r){e.self.styles&&e.self.styles.wrapStyle&&Ext.isDefined(e.self.styles.wrapStyle[r])&&(t[r]=e.self.styles.wrapStyle[r])},_applyBoxedStyles:function(e,t,r){var n=!0;Terrasoft.each(r,(function(e){return"none"===e.style&&(n=!1),n}),this),n&&(t["box-sizing"]="border-box",t["min-height"]=this._calculateMinHeight(e))},_applyMjmlBorderBug:function(e,t){var r=Terrasoft.calculateBorderStyles(t);if(this._applyBoxedStyles(e,t,r),this.align!==Terrasoft.Align.LEFT){var n=("none"!==r.right.style&&Terrasoft.parseNumber(r.right.width)||0)+("none"!==r.left.style&&Terrasoft.parseNumber(r.left.width)||0);switch(this.align){case Terrasoft.Align.CENTER:case Terrasoft.Align.RIGHT:t["margin-right"]=Ext.String.format("{0}px",-n);break;default:return}}},_calculateWidth:function(e){var t=Terrasoft.calculateBorderStyles(e.self.styles.wrapStyle),r=(Terrasoft.parseNumber(t.right.width)||0)+(Terrasoft.parseNumber(t.left.width)||0),n=Math.max(this.width,r);return Ext.String.format("{0}px",r+n)},_calculateMinHeight:function(e){if(!this.height)return"auto";var t=Terrasoft.calculateBorderStyles(e.self.styles.wrapStyle),r=Terrasoft.parseNumber(t.top.width)||0,n=Terrasoft.parseNumber(t.bottom.width)||0;return Ext.String.format("{0}px",r+n+this.height)},applyContentAlign:function(e){(e=Ext.apply(e,{wrapStylesClassName:["content-mjimage-wrap-styles"]})).wrapStylesClassName.push("content-image-element-align-"+this.align)},getSelectors:function(){return{toolsEl:"#"+this.id+"-content-image-element-tools",wrapEl:"#"+this.id+"-content-mjimage-wrap",imageEl:"#"+this.id+"-content-mjimage",placeholderEl:"#"+this.id+"-content-image-placeholder"}},getTplData:function(){var e=this.callParent(arguments);return Ext.isEmpty(e.imageSrc)&&e.wrapStylesClassName.push("empty-image"),Ext.apply(e,{imageStyles:this.createImageStyles(e),wrapStyle:this.createWrapperStyles(e),width:this.width||"100%"}),e},createImageStyles:function(e){var t={width:this.width?this._calculateWidth(e):"100%",height:this.height?Ext.String.format("{0}px",this.height):"auto"};return Terrasoft.each(this.imageBorderStyles,(function(r){this._applyStyleIfIsDefined(e,t,r)}),this),this._applyMjmlBorderBug(e,t),Ext.DomHelper.generateStyles(t)},createWrapperStyles:function(e){var t=Ext.apply({},{width:"100%",height:"auto","border-radius":0,border:"none"},e.self.styles.wrapStyle);return Ext.DomHelper.generateStyles(t)}}),Ext.define("Terrasoft.controls.ContentTextElement",{extend:"Terrasoft.controls.BaseContentElement",alternateClassName:"Terrasoft.ContentTextElement",width:null,height:null,align:null,defaultRenderTpl:['<div id = "{id}-content-element" style="{alignStyle}" class="{wrapClassName}">\n\t\t\t<div style="{wrapStyle}"  class="text-element-wrap">\n\t\t\t\t{%this.renderItems(out, values)%}\n\t\t\t\t<tpl if="hasTools">\n\t\t\t\t\t<div id="{id}-content-element-tools" class="{toolsWrapClasses}">\n\t\t\t\t\t\t<tpl for="tools">\n\t\t\t\t\t\t\t{%this.renderTool(out, values)%}\n\t\t\t\t\t\t</tpl>\n\t\t\t\t\t</div>\n\t\t\t\t</tpl>\n\t\t\t</div>\n\t\t</div>'],getTplData:function(){var e=this.callParent(arguments),t="flex-start";return this.align===Terrasoft.core.enums.Align.RIGHT&&(t="flex-end"),this.align===Terrasoft.core.enums.Align.CENTER&&(t="center"),e.alignStyle="display: flex;flex-direction: row;justify-content:"+t,e},getBindConfig:function(){var e=this.callParent(arguments),t={align:{changeMethod:"setAlign"}};return Ext.apply(t,e),t},setAlign:function(e){var t=[Terrasoft.core.enums.Align.LEFT,Terrasoft.core.enums.Align.CENTER,Terrasoft.core.enums.Align.RIGHT];if(e=e||Terrasoft.Align.LEFT,!Terrasoft.contains(t,e))throw new Terrasoft.UnsupportedTypeException;Terrasoft.isEqual(this.align,e)||(this.align=e,this.safeRerender())}}),Ext.define("Terrasoft.controls.ContentButtonElement",{extend:"Terrasoft.controls.BaseContentElement",alternateClassName:"Terrasoft.ContentButtonElement",align:null,padding:null,defaultRenderTpl:['<div id="{id}-content-button-align-wrap" align="{align}" class="{wrapClassName}">\n\t\t\t<div id="{id}-content-button-padding-wrap" style="display:inline-block;{padding}">\n\t\t\t\t<div id="{id}-content-button" align="center" class="content-button" style="{wrapStyle}">\n\t\t\t\t\t{%this.renderItems(out, values)%}\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t\t<tpl if="hasTools">\n\t\t\t\t<div id="{id}-content-element-tools" class="{toolsWrapClasses}">\n\t\t\t\t\t<tpl for="tools">\n\t\t\t\t\t\t{%this.renderTool(out, values)%}\n\t\t\t\t\t</tpl>\n\t\t\t\t</div>\n\t\t\t</tpl>\n\t\t</div>'],getTpl:function(){var e=this.callParent(arguments);return e[0].replace("{align}",this.align),e},getSelectors:function(){return{wrapEl:"#"+this.id+"-content-button-align-wrap"}},getTplData:function(){var e=this.callParent(arguments);return Ext.apply(e,{align:this.align,padding:Ext.DomHelper.generateStyles(this.padding)}),e.wrapClassName.push("content-button-align-wrap"),e},getBindConfig:function(){var e=this.callParent(arguments),t={align:{changeMethod:"setAlign"},padding:{changeMethod:"setPadding"}};return Ext.apply(t,e),t},setAlign:function(e){_.isEqual(this.align,e)||(this.align=e,this.safeRerender())},setPadding:function(e){_.isEqual(this.padding,e)||(this.padding=e,this.safeRerender())}}),Ext.define("Terrasoft.controls.ContentMjButtonElement",{extend:"Terrasoft.controls.ContentButtonElement",alternateClassName:"Terrasoft.ContentMjButtonElement",buttonStyle:null,defaultRenderTpl:['<div id="{id}-content-button-align-wrap" align="{align}" class="{wrapClassName}">\n\t\t\t<div id="{id}-content-button-padding-wrap" class="content-button-container" style="{wrapStyle}">\n\t\t\t\t<div id="{id}-content-button" align="center" class="mjml-content-button" style="{buttonStyle}">\n\t\t\t\t\t{%this.renderItems(out, values)%}\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t\t<tpl if="hasTools">\n\t\t\t\t<div id="{id}-content-element-tools" class="{toolsWrapClasses}">\n\t\t\t\t\t<tpl for="tools">\n\t\t\t\t\t\t{%this.renderTool(out, values)%}\n\t\t\t\t\t</tpl>\n\t\t\t\t</div>\n\t\t\t</tpl>\n\t\t</div>'],getBindConfig:function(){var e=this.callParent(arguments),t={buttonStyle:{changeMethod:"setButtonStyle"}};return Ext.apply(t,e),t},setButtonStyle:function(e){Ext.isObject(e)&&(this.styles=Ext.apply(this.styles||{},{buttonStyle:e}),this.safeRerender())}}),Ext.define("Terrasoft.controls.ContentHTMLElement",{extend:"Terrasoft.controls.BaseContentElement",alternateClassName:"Terrasoft.ContentHTMLElement",content:null,htmlTools:null,htmlToolsWrapClasses:["content-html-element-tools-wrap"],contentWrapClasses:["content-html-element-wrap"],placeholderClass:"content-html-element-placeholder",placeholder:"",defaultRenderTpl:['<div id="{id}-content-html-element" style="{wrapStyle}" class="{wrapClassName}">','<tpl if="hasContent">',"{content}","<tpl else>",'<div class="{placeholderClass}"><span>{placeholder}</span></div>',"</tpl>",'<div class="content-cover"></div>','<tpl if="hasTools">','<div id="{id}-content-element-tools" class="{toolsWrapClasses}">\n\t\t\t\t\t<tpl for="tools">\n\t\t\t\t\t\t{%this.renderTool(out, values)%}\n\t\t\t\t\t</tpl>\n\t\t\t\t</div>',"</tpl>",'<div id="{id}-content-html-element-tools" class="{htmlToolsWrapClasses}">','<tpl for="htmlTools">',"{%this.renderTool(out, values)%}","</tpl>","</div>","</div>"],initRenderData:function(e){this.callParent(arguments),e.htmlTools=this.htmlTools},initTools:function(){this.callParent();var e=this.htmlTools;(this.htmlTools=new Ext.util.MixedCollection(!1,this.getComponentId)).on("add",this.onToolAdd,this),this.addToCollection(e,this.htmlTools)},destroyTools:function(){this.callParent(),this.destroyItemsCollection(this.htmlTools),this.htmlTools=null},getSelectors:function(){return{toolsEl:"#"+this.id+"-content-html-element-tools",wrapEl:"#"+this.id+"-content-html-element"}},getTplData:function(){var e=this.callParent(arguments),t=this.content,r=!Ext.isEmpty(t);return Ext.apply(e,{hasContent:r,content:t,placeholder:Terrasoft.encodeHtml(this.placeholder),placeholderClass:this.placeholderClass,htmlToolsWrapClasses:this.htmlToolsWrapClasses}),e},getBindConfig:function(){var e=this.callParent(arguments),t={content:{changeMethod:"setContent"},placeholder:{changeMethod:"setPlaceholder"}};return Ext.apply(t,e),t},bind:function(){this.callParent(arguments),this.htmlTools.each((function(e){e.bind(this.model)}),this)},setPlaceholder:function(e){e!==this.placeholder&&(this.placeholder=e,Ext.isEmpty(this.content)&&this.allowRerender()&&this.reRender())},setContent:function(e){e!==this.content&&(this.content=e,this.safeRerender())}}),Ext.define("Terrasoft.controls.ContentSeparatorElement",{extend:"Terrasoft.controls.BaseContentElement",alternateClassName:"Terrasoft.ContentSeparatorElement",separatorStyle:null,defaultRenderTpl:['<div id="{id}-content-separator-element" style="{wrapStyle}" class="{wrapClassName}">\n\t\t\t<div class="content-separator" style="{separatorStyle}"></div>\n\t\t\t<tpl if="hasTools">\n\t\t\t\t<div id="{id}-content-element-tools" class="{toolsWrapClasses}">\n\t\t\t\t\t<tpl for="tools">\n\t\t\t\t\t\t{%this.renderTool(out, values)%}\n\t\t\t\t\t</tpl>\n\t\t\t\t</div>\n\t\t\t</tpl>\n\t\t</div>'],getSelectors:function(){return{wrapEl:"#"+this.id+"-content-separator-element"}},setThickness:function(e){this.separatorStyle["border-top-width"]=e,this.safeRerender()},setColor:function(e){this.separatorStyle["border-top-color"]=e,this.safeRerender()},setStyle:function(e){this.separatorStyle["border-top-style"]=e,this.safeRerender()},getBindConfig:function(){var e=this.callParent(arguments),t={thickness:{changeMethod:"setThickness"},style:{changeMethod:"setStyle"},color:{changeMethod:"setColor"}};return Ext.apply(e,t),e},getTplData:function(){var e=this.callParent(arguments);return Ext.apply(e,{separatorStyle:this.separatorStyle}),e},constructor:function(){this.callParent(arguments),this.separatorStyle={}}}),Ext.define("Terrasoft.controls.ContentMjDivider",{extend:"Terrasoft.controls.ContentSeparatorElement",alternateClassName:"Terrasoft.ContentMjDivider",contentWrapClasses:["content-mjdivider-wrap content-element-wrap"],setWidth:function(e){Ext.isEmpty(e)?delete this.separatorStyle.width:this.separatorStyle.width=e,this.safeRerender()},getBindConfig:function(){var e=this.callParent(arguments),t={width:{changeMethod:"setWidth"}};return Ext.apply(e,t),e}}),Ext.define("Terrasoft.controls.ContentMjRawElement",{extend:"Terrasoft.controls.BaseContentElement",alternateClassName:"Terrasoft.ContentMjRawElement",content:null,contentWrapClasses:["content-mjraw-element-wrap"],placeholderClass:"content-mjraw-placeholder",placeholder:"",defaultRenderTpl:['<div id="{id}-content-mjraw-element" class="{wrapClassName}">','<tpl if="hasContent">','<iframe id="{id}-iframe" frameBorder="0" hspace="0" vspace="0" scrolling="no" marginheight="0" marginwidth="0">\n\t\t\t\t</iframe>','<div id="{id}-overlay" class="overlay"></div>',"<tpl else>",'<div class="{placeholderClass}"><span>{placeholder}</span></div>',"</tpl>",'<tpl if="hasTools">','<div id="{id}-content-element-tools" class="{toolsWrapClasses}">\n\t\t\t\t\t<tpl for="tools">\n\t\t\t\t\t\t{%this.renderTool(out, values)%}\n\t\t\t\t\t</tpl>\n\t\t\t\t</div>',"</tpl>","</div>"],_setIframeContent:function(){if(this.content){var e=this.getWrapEl().child("iframe");e.on("load",this._onIframeLoad,this),e.setHeight(0);var t=e.dom.contentWindow.document;t.open(),t.write(this.content),t.close()}},_onIframeLoad:function(){this._adjustIframeHeight()},_adjustIframeHeight:function(){if(this.content){var e=this.getWrapEl().child("iframe"),t=e.dom.contentWindow.document.body,r=t.getBoundingClientRect();e.setHeight(r?r.bottom+"px":t.scrollHeight+"px")}},getSelectors:function(){return{wrapEl:"#"+this.id+"-content-mjraw-element"}},getTplData:function(){var e=this.callParent(arguments),t=!Ext.isEmpty(this.content);return Ext.apply(e,{hasContent:t,content:this.content,placeholder:Terrasoft.encodeHtml(this.placeholder),placeholderClass:this.placeholderClass}),e},initDomEvents:function(){this.callParent(arguments);var e=this.getWrapEl();if(e){var t=e.child("#"+this.id+"-overlay");t&&t.on({click:{fn:this.onClick,scope:this}})}},getBindConfig:function(){var e=this.callParent(arguments),t={content:{changeMethod:"setContent"},placeholder:{changeMethod:"setPlaceholder"}};return Ext.apply(t,e),t},setPlaceholder:function(e){e!==this.placeholder&&(this.placeholder=e,Ext.isEmpty(this.content)&&this.allowRerender()&&this.reRender())},setContent:function(e){e!==this.content&&(this.content=e,this.safeRerender())},onAfterRender:function(){this.callParent(arguments),this._setIframeContent(),this._adjustIframeHeight()},onAfterReRender:function(){this.callParent(arguments),this._setIframeContent(),this._adjustIframeHeight()}}),Ext.define("Terrasoft.controls.ContentSpacerElement",{extend:"Terrasoft.controls.BaseContentElement",alternateClassName:"Terrasoft.ContentSpacerElement",selected:!1,contentWrapClasses:["content-spacer-element-wrap"],selectedClass:"t-content-focus",defaultRenderTpl:['<div id="{id}-content-spacer-element" style="{wrapStyle}" class="{wrapClassName}">\n\t\t\t<tpl if="hasTools">\n\t\t\t\t<div id="{id}-content-element-tools" class="{toolsWrapClasses}">\n\t\t\t\t\t<tpl for="tools">\n\t\t\t\t\t\t{%this.renderTool(out, values)%}\n\t\t\t\t\t</tpl>\n\t\t\t\t</div>\n\t\t\t</tpl>\n\t\t</div>'],getTplData:function(){var e=this.callParent(arguments);return Ext.apply(e,{wrapClassName:this.getWrapClasses()}),e},getSelectors:function(){return{wrapEl:"#"+this.id+"-content-spacer-element"}},getWrapClasses:function(){var e=[];return this.contentWrapClasses&&e.push(this.contentWrapClasses),this.selected&&e.push(this.selectedClass),e}}),Ext.define("Terrasoft.controls.ContentNavbarElement",{extend:"Terrasoft.controls.BaseContentElement",alternateClassName:"Terrasoft.ContentNavbarElement",mixins:{contentBlock:"Terrasoft.mixins.ContentBlockMixin"},itemName:"content-navbar-element",contentWrapClasses:["content-navbar-element-wrap"],defaultRenderTpl:['<div id="{id}-content-navbar-element" class="{wrapClassName}" style="{wrapStyle}">{%this.renderItems(out, values)%}','<tpl if="hasTools">','<div id="{id}-content-element-tools" class="{toolsWrapClasses}">\n\t\t\t\t\t<tpl for="tools">\n\t\t\t\t\t\t{%this.renderTool(out, values)%}\n\t\t\t\t\t</tpl>\n\t\t\t\t</div>',"</tpl>","</div>"],init:function(){this.callParent(arguments),this.addEvents("elementSelectedChange")},initDomEvents:function(){this.callParent(arguments),this.subscribeItemsEvents()},getBindConfig:function(){var e=this.callParent(arguments);return this.applyBlockBindConfig(e),e},bind:function(){this.mixins.bindable.bind.apply(this,arguments),this.tools.each((function(e){e.bind(this.model)}),this)},getSelectors:function(){var e={};return Ext.apply(e,{wrapEl:Ext.String.format("#{0}-{1}",this.id,this.itemName)}),e},addToolItem:function(e){if(e){var t=this.tools,r=Ext.isArray(e)?e:[e];this.fireEvent("beforeadd",this,r,t);for(var n=0,i=r.length;n<i;n++){var a=r[n];!0!==a.isComponent&&(a=r[n]=Ext.create(a.className||"Terrasoft.Component",a)),t.add(a)}this.fireEvent("add",this,r,t)}},onAddItem:function(e,t){this.insert(e,t)},onItemAdd:function(e,t){this.callParent(arguments),t.on("selectedChanged",this.onSelectedChanged,this)},onSelectedChanged:function(e,t){e&&this.fireEvent("elementSelectedChange",t.id)},subscribeItemsEvents:function(){this.items.each((function(e){e.on("selectedChanged",this.onSelectedChanged,this)}),this)},unSubscribeItemsEvents:function(){this.items.each((function(e){e.un("selectedChanged",this.onSelectedChanged,this)}),this)},subscribeForCollectionEvents:function(e,t,r){if(r&&"items"===t){var n=r.get(e.modelItem);this.mixins.contentBlock.subscribeCollection.call(this,n)}},unSubscribeForCollectionEvents:function(e,t,r){if(r&&"items"===t){var n=r.get(e.modelItem);this.mixins.contentBlock.unSubscribeCollection.call(this,n)}},prepareItems:function(e){return this.mixins.contentBlock.prepareBlockItems.call(this,e)},onDestroy:function(){this.unSubscribeItemsEvents(),this.callParent(arguments)}}),Ext.define("Terrasoft.controls.ContentBlockGroup",{extend:"Terrasoft.controls.AbstractContainer",alternateClassName:"Terrasoft.ContentBlockGroup",mixins:{draggable:"Terrasoft.mixins.DraggableContentBlock",selectable:"Terrasoft.mixins.SelectableContentBlock",contentBlock:"Terrasoft.mixins.ContentBlockMixin"},itemName:"content-block-group",tplConfigClasses:{wrapClassName:["content-block-group-wrap"]},defaultRenderTpl:['<div id="{id}-content-block-group" style="{wrapStyles}" class="{wrapClassName}">',"{%this.renderItems(out, values)%}",'<tpl if="hasTools">','<div id="{id}-content-block-tools" class="{toolsWrapClasses}">','<tpl for="tools">',"{%this.renderTool(out, values)%}","</tpl>","</div>","</tpl>","</div>"],init:function(){this.callParent(arguments),this.initTools()},initRenderData:function(e){this.callParent(arguments),this.addToolsToRenderData(e)},getTplData:function(){var e=this.callParent(arguments);return this.selectors=this.getSelectors(),this.applyToolsSelector(this.selectors),this.applyTplClasses(e),this.applyToolsTplData(e),this.addSelectedClass(e),e},initDomEvents:function(){this.callParent(arguments),this.mixins.selectable.subscribeForDomEvents.apply(this)},getRenderToEl:function(e){return-1!==this.tools.indexOf(e)?this.toolsEl:this.callParent(arguments)},prepareItems:function(e){return this.mixins.contentBlock.prepareBlockItems.call(this,e)},onAfterRender:function(){this.callParent(arguments),this.mixins.draggable.onAfterRender.apply(this,arguments)},onAfterReRender:function(){this.callParent(arguments),this.mixins.draggable.onAfterReRender.apply(this,arguments)},onItemAdd:function(){this.callParent(arguments),this.safeRerender()},subscribeForCollectionEvents:function(e,t,r){var n=r.get(e.modelItem);this.subscribeCollection(n)},unSubscribeForCollectionEvents:function(e,t,r){if(r){var n=r.get(e.modelItem);this.unSubscribeCollection(n)}},constructor:function(){this.callParent(arguments),this.mixins.draggable.addDraggableEvents.apply(this,arguments)},getBindConfig:function(){var e=this.callParent(arguments);return this.applyBlockBindConfig(e),this.applySelectedBindConfig(e),e},indexOf:function(e){var t=this.callParent(arguments);return-1===t&&(t=this.indexOfToolItem(e)),t},bind:function(){this.mixins.bindable.bind.apply(this,arguments),this.mixins.selectable.bindTools.apply(this)},onDestroy:function(){this.mixins.selectable.destroyTools.apply(this),this.mixins.draggable.onDestroy.apply(this,arguments),this.removeDropZone(),this.callParent(arguments)}}),Ext.define("Terrasoft.controls.ContentMjBlock",{extend:"Terrasoft.controls.AbstractContainer",alternateClassName:"Terrasoft.ContentMjBlock",mixins:{draggable:"Terrasoft.mixins.DraggableContentBlock",selectable:"Terrasoft.mixins.SelectableContentBlock",contentBlock:"Terrasoft.mixins.ContentBlockMixin"},itemName:"content-mjblock",tplConfigClasses:{wrapClassName:["content-mjblock-wrap"],captionLabelClasses:["content-block-label"],selectButtonClasses:["content-block-select-button"]},selectButtonTitle:Terrasoft.Resources.ContentBlock.SelectBlockButtonTitle,caption:null,dragCopy:!0,hasSelectBtn:!0,groupMenu:null,defaultRenderTpl:['<div id="{id}-content-mjblock" class="{wrapClassName}">\n\t\t\t<tpl if="caption">\n\t\t\t\t{%this.renderGroupMenu(out, values)%}\n\t\t\t\t<span id="{id}-content-mjblock-label" class="{captionLabelClasses}">{caption}</span>\n\t\t\t</tpl>\n\t\t\t<tpl if="hasSelectBtn">\n\t\t\t\t<div id="{id}-content-block-select" class="{selectButtonClasses}" title="{selectButtonTitle}"></div>\n\t\t\t</tpl>\n\t\t\t<div style="{wrapStyle}">\n\t\t\t\t{%this.renderItems(out, values)%}\n\t\t\t</div>\n\t\t\t<tpl if="hasTools">\n\t\t\t\t<div id="{id}-content-block-tools" class="{toolsWrapClasses}">\n\t\t\t\t\t<tpl for="tools">\n\t\t\t\t\t\t{%this.renderTool(out, values)%}\n\t\t\t\t\t</tpl>\n\t\t\t\t</div>\n\t\t\t</tpl>\n\t\t</div>'],init:function(){this.callParent(arguments),this.initTools(),this.initGroupMenu()},initRenderData:function(e){this.callParent(arguments),this.addToolsToRenderData(e),e.groupMenu=this.groupMenu,e.renderGroupMenu=this.renderGroupMenu},initDomEvents:function(){this.callParent(arguments),this.mixins.selectable.subscribeForDomEvents.apply(this)},getTplData:function(){var e=this.callParent(arguments);return this.selectors=this.getSelectors(),e.hasSelectBtn=this.hasSelectBtn,this.applyToolsSelector(this.selectors),this.applyTplClasses(e),this.applyToolsTplData(e),this.addSelectedClass(e),e.selectButtonTitle=this.selectButtonTitle,e},getRenderToEl:function(e){return-1!==this.tools.indexOf(e)?this.toolsEl:this.callParent(arguments)},prepareItems:function(e){return this.mixins.contentBlock.prepareBlockItems.call(this,e)},initGroupMenu:function(){var e=this.groupMenu,t=e&&e.className;this.groupMenu=Ext.create(t||"Terrasoft.Component",e),this.groupMenu.added(this)},renderGroupMenu:function(){},onAfterRender:function(){this.callParent(arguments),this.mixins.draggable.onAfterRender.apply(this,arguments)},onAfterReRender:function(){this.callParent(arguments),this.mixins.draggable.onAfterReRender.apply(this,arguments)},onItemAdd:function(){this.callParent(arguments),this.safeRerender()},subscribeForCollectionEvents:function(e,t,r){var n=r.get(e.modelItem);this.subscribeCollection(n)},unSubscribeForCollectionEvents:function(e,t,r){if(r){var n=r.get(e.modelItem);this.unSubscribeCollection(n)}},constructor:function(){this.callParent(arguments),this.mixins.draggable.addDraggableEvents.apply(this,arguments)},getBindConfig:function(){var e=this.callParent(arguments);return this.applyBlockBindConfig(e),this.applySelectedBindConfig(e),e},indexOf:function(e){var t=this.callParent(arguments);return-1===t&&(t=this.indexOfToolItem(e)),t},bind:function(){this.mixins.bindable.bind.apply(this,arguments),this.mixins.selectable.bindTools.apply(this),this.groupMenu&&this.groupMenu.bind(this.model)},onDestroy:function(){this.mixins.selectable.destroyTools.apply(this),this.mixins.draggable.onDestroy.apply(this,arguments),this.removeDropZone(),this.callParent(arguments)}}),Ext.define("Terrasoft.controls.ContentMjGroup",{extend:"Terrasoft.controls.AbstractContainer",alternateClassName:"Terrasoft.ContentMjGroup",mixins:{contentBlock:"Terrasoft.mixins.ContentBlockMixin"},itemName:"content-mjgroup",tools:null,width:null,toolsWrapClasses:["mjgroup-grouping-control"],tplConfigClasses:{wrapClassName:["content-mjgroup-wrap"],groupClassName:["content-mjgroup"]},defaultRenderTpl:['<div id="{id}-content-mjgroup" class="{wrapClassName}" style="{wrapStyle}">\n\t\t\t<div id="{id}-inner-container" class="{groupClassName}">{%this.renderItems(out, values)%}</div>\n\t\t\t<tpl if="hasTools">\n\t\t\t\t<div id="{id}-content-mjgroup-tools" class="{toolsWrapClasses}">\n\t\t\t\t\t<tpl for="tools">\n\t\t\t\t\t\t{%this.renderTool(out, values)%}\n\t\t\t\t\t</tpl>\n\t\t\t\t</div>\n\t\t\t</tpl>\n\t\t</div>'],init:function(){this.callParent(arguments),this.initTools()},extendWrapStyles:function(){this.styles.wrapStyle=Ext.apply(this.styles.wrapStyle||{},{direction:"ltr"})},getTplData:function(){var e=this.callParent(arguments);return this.selectors=this.getSelectors(),this.extendWrapStyles(e),this.applyTplClasses(e),this.applyToolsTplData(e),this.applyGroupWidth(),e},applyToolsTplData:function(e){Ext.apply(e,{toolsWrapClasses:this.toolsWrapClasses,hasTools:this.tools&&this.tools.getCount()})},getRenderToEl:function(){return this.innerContainerEl},getSelectors:function(){return{wrapEl:"#"+this.id+"-"+this.itemName,toolsEl:"#"+this.id+"-content-mjgroup-tools",innerContainerEl:Ext.String.format("#{0}-inner-container",this.id)}},applyGroupWidth:function(){this.styles.wrapStyle=Ext.apply(this.styles.wrapStyle||{},{width:this.width+"%"})},applyWidthBindConfig:function(e){Ext.apply(e,{width:{changeEvent:"changed",changeMethod:"setWidth"}})},addToolsToRenderData:function(e){e.tools=this.tools,e.renderTool=this.renderTool},initRenderData:function(e){this.callParent(arguments),this.addToolsToRenderData(e)},setWidth:function(e){this.width=e,this.safeRerender()},prepareItems:function(e){return this.mixins.contentBlock.prepareBlockItems.call(this,e)},onDeleteItem:function(e){this.mixins.contentBlock.onDeleteItem.apply(this,[e])},onAddItem:function(e,t,r){var n=this.prepareItems([e]);this.items.insert(t,r,n[0])},clearItems:function(){this.mixins.contentBlock.clearItems.apply(this)},onCollectionDataLoaded:function(e){this.mixins.contentBlock.onCollectionDataLoaded.apply(this,[e])},onUpdateItem:function(e,t){this.mixins.contentBlock.onUpdateItem.apply(this,[e,t])},subscribeForCollectionEvents:function(e,t,r){var n=r.get(e.modelItem);this.subscribeCollection(n)},unSubscribeForCollectionEvents:function(e,t,r){if(r){var n=r.get(e.modelItem);this.unSubscribeCollection(n)}},getBindConfig:function(){var e=this.callParent(arguments);return this.applyBlockBindConfig(e),this.applyWidthBindConfig(e),e},destroyTools:function(){this.destroyItemsCollection(this.tools),this.tools=null},onDestroy:function(){this.destroyTools(),this.callParent(arguments)},addToolItem:function(e){if(e){var t=this.tools,r=Ext.isArray(e)?e:[e];this.fireEvent("beforeadd",this,r,t);for(var n=0,i=r.length;n<i;n++){var a=r[n];!0!==a.isComponent&&(a=r[n]=Ext.create(a.className||"Terrasoft.Component",a)),t.add(a)}this.fireEvent("add",this,r,t)}},bindTools:function(){this.tools.each((function(e){e.bind(this.model)}),this)},initTools:function(){var e=this.tools,t=this.tools=new Ext.util.MixedCollection(!1,this.getComponentId);t.on("add",this.onToolAdd,this),t.on("remove",this.onToolRemove,this),this.addToolItem(e)},onToolAdd:function(e,t){t.added(this)},onToolRemove:Terrasoft.emptyFn,renderTool:function(e,t){var r=t.generateHtml();e.push(r)},bind:function(){this.mixins.bindable.bind.apply(this,arguments),this.bindTools()}}),Ext.define("Terrasoft.controls.ContentNavbarLink",{extend:"Terrasoft.controls.AbstractContainer",alternateClassName:"Terrasoft.ContentNavbarLink",selected:!1,contentWrapClasses:["content-navbar-link-wrap"],selectedClass:"t-content-focus",defaultRenderTpl:['<div id="{id}-content-navbar-link" class="{wrapClassName}" style="{wrapStyle}">{%this.renderItems(out, values)%}',"</div>"],getSelectors:function(){return{wrapEl:"#"+this.id+"-content-navbar-link"}},getWrapClasses:function(){var e=[];return this.contentWrapClasses&&e.push(this.contentWrapClasses),this.selected&&e.push(this.selectedClass),e},getTplData:function(){var e=this.callParent(arguments);return this.selectors=this.getSelectors(),Ext.apply(e,{wrapClassName:this.getWrapClasses()}),e},onClick:function(e){this.setSelected(!0),e.stopPropagation()},initDomEvents:function(){this.callParent(arguments);var e=this.getWrapEl();e&&e.on({click:{fn:this.onClick,scope:this}})},setSelected:function(e){if(this.selected!==e){this.selected=e;var t=this.selectedClass,r=this.getWrapEl();r&&t&&this.rendered&&(e?r.addCls(t):r.removeCls(t)),this.fireEvent("selectedChanged",e,this)}},getBindConfig:function(){var e=this.callParent(arguments),t={selected:{changeEvent:"selectedChanged",changeMethod:"setSelected"}};return Ext.apply(t,e),t}}),Ext.ns("Terrasoft.controls.ScheduleItem"),Terrasoft.controls.ScheduleItem.Status={NEW:1,DONE:2,OVERDUE:3},Terrasoft.ScheduleItemStatus=Terrasoft.controls.ScheduleItem.Status,Ext.define("Terrasoft.controls.ScheduleItem.ScheduleItem",{alternateClassName:"Terrasoft.ScheduleItem",extend:"Terrasoft.Component",timeItemHeight:2.2,multiDayItemHeight:21,scheduler:null,viewModelCollectionItemId:"",itemId:null,startDate:null,dueDate:null,title:null,status:Terrasoft.ScheduleItemStatus.NEW,top:0,left:0,rightSpace:2,width:100,timeScale:null,background:null,fontColor:null,isItalic:!1,isBold:!1,isUnderline:!1,isSelected:!1,shortDayNames:Terrasoft.Resources.CultureSettings.shortDayNames,itemTask:null,clickHandlerTimeout:300,tpl:['<div tabindex="0" id="{id}-scheduleritem" style="{schedulerItemStyle}" class="{scheduleItemClass}">','<div id="{id}-scheduleritem-resize-top" class="{scheduleItemResizeTopClass}"></div>',"{%this.prepareSchedulerItem(out, values)%}",'<div id="{id}-scheduleritem-resize-bottom" class="{scheduleItemResizeBottomClass}"></div>',"</div>"],oneDayItemConfig:{classes:{scheduleItemClass:["scheduleritem"],scheduleItemResizeTopClass:["scheduleritem-resize-top"],scheduleItemResizeBottomClass:["scheduleritem-resize-bottom"],scheduleItemStatusClass:["scheduleritem-selected","scheduleritem-new","scheduleritem-done","scheduleritem-overdue"],scheduleItemCaptionClass:["scheduleritem-caption"],scheduleItemTitleClass:["scheduleritem-title"]}},multiDayItemConfig:{classes:{scheduleItemClass:["multi-day-item"],scheduleItemResizeTopClass:["multi-day-item-resize-right"],scheduleItemResizeBottomClass:["multi-day-item-resize-left"],scheduleItemCaptionClass:["multi-day-item-caption"],scheduleItemTitleClass:["multi-day-item-title"],scheduleItemStatusClass:["scheduleritem-selected","scheduleritem-new","scheduleritem-done","scheduleritem-overdue"],scheduleItemLeftCaptionClass:["multi-day-item-left-caption"]}},bindInitialValueConfig:{onItemIdChange:"itemId",onTitleChange:"title",onStartDateChange:"startDate",onDueDateChange:"dueDate",onStatusChange:"status",onBackgroundChange:"background",onFontColorChange:"fontColor",onIsBoldChange:"isBold",onIsItalicChange:"isItalic",onIsUnderlineChange:"isUnderline",setMarkerValue:"markerValue"},getNewDateByScale:function(e,t,r){if(e.getMinutes()%r==0)return t;var n=Terrasoft.DateRate.MILLISECONDS_IN_MINUTE;return t-=e,t/=n,t=(e-=0)+(t=(t=Math.floor(t/r)+1)*r*n),t=new Date(t)},getElementBox:function(e){return Ext.get(e).getBox()},getItemCaption:function(){var e="",t=this.startDate,r=this.dueDate;if(this.isMultiDayItem()){var n=Terrasoft.addDays(this.scheduler.getDueDate(),1),i=!Terrasoft.areDatesEqual(r,n)&&n<r,a=new Date(r-1),s=a.getDate(),o=a.getDay();e=i?Ext.String.format("{0}, {1}",s,this.shortDayNames[o]):""}else{var l=t.getMinutes(),c=r.getMinutes(),u=this.getTimeScale();if(l%u!=0||c%u!=0){var h=Ext.Date.format(t,Terrasoft.Resources.CultureSettings.timeFormat),f=Ext.Date.format(r,Terrasoft.Resources.CultureSettings.timeFormat);e=Ext.String.format("{0}-{1}",h,f)}}return e},getLeftCaption:function(){var e=this.getStartDate(),t=this.scheduler.getStartDate(),r=!Terrasoft.areDatesEqual(e,t)&&e<t,n=e.getDate(),i=e.getDay();return r?Ext.String.format("{0}, {1}",n,this.shortDayNames[i]):""},getIsTheSameDay:function(e,t){return Terrasoft.areDatesEqual(e,t)},getDayColumnId:function(e){var t=String(e.getDate());t=1===t.length?Ext.String.format("0{0}",t):t;var r=String(e.getMonth()+1);r=1===r.length?Ext.String.format("0{0}",r):r;var n=e.getFullYear();return Ext.String.format("-day-{0}-{1}-{2}",t,r,n)},getRenderTo:function(){var e=this.startDate,t=this.dueDate;if(e&&t){if(this.isMultiDayItem())return this.scheduler.multiDayItemArea;e=new Date(this.startDate);var r=this.getDayColumnId(e),n=Ext.String.format("[id*='{0}']",r),i=Ext.select(n,!1);if(i){var a=i.elements;if(a.length>0)return Ext.get(a[0])}}},getTimeScale:function(){return this.scheduler.getTimeScale()},isMultiDayItem:function(){return!Terrasoft.areDatesEqual(this.startDate,this.dueDate)},updateItemSelectionStyle:function(){var e=this.isSelected,t="scheduleritem-";switch(this.status){case 2:t+="done";break;case 3:t+="overdue";break;default:t+="new"}var r=this.getWrapEl();if(r&&r.dom){var n=r.child("div").next();n.addCls(t),e?n.addCls("scheduleritem-selected"):n.removeCls("scheduleritem-selected"),n.setStyle({backgroundColor:e?"":this.background,color:e?"":this.fontColor})}},onScheduleItemDoubleClick:function(e,t){this.setSelected(e,t),this.scheduler.fireEvent("scheduleItemDoubleClick",this)},onScheduleItemClick:function(e,t){var r=this.canExecute({method:this.onScheduleItemClick,args:arguments});if(!1!==r){this.setSelected(e,t);var n=this.getWrapEl();n&&(this.scheduler.fireEvent("scheduleItemClick",{targetId:n.id}),n.focus())}else{var i=e.browserEvent;Ext.EventManager.stopEvent(i)}},onScheduleItemTitleMouseOver:function(){var e=this.getWrapEl();this.scheduler.fireEvent("scheduleItemTitleMouseOver",{targetId:e.id},{recordId:this.itemId})},onScheduleItemTitleClick:function(e,t){this.setSelected(e,t);var r=this.getWrapEl();this.scheduler.fireEvent("scheduleItemTitleClick",{targetId:r.id},{recordId:this.itemId})},onScheduleItemTitleDoubleClick:function(e){e.stopEvent()},onKeyDown:function(e){switch(e.keyCode){case e.ENTER:return e.preventDefault(),this.onEnterKeyPressed(e),!1;case e.TAB:return e.preventDefault(),this.onTabKeyPressed(e),!1;case e.UP:return e.preventDefault(),this.onUpKeyPressed(e),!1;case e.DOWN:return e.preventDefault(),this.onDownKeyPressed(e),!1;case e.LEFT:return e.preventDefault(),this.onLeftKeyPressed(e),!1;case e.RIGHT:return e.preventDefault(),this.onRightKeyPressed(e),!1}},onEnterKeyPressed:function(){_.isEmpty(this.scheduler.selectedItems)||this.scheduler.fireEvent("scheduleItemDoubleClick",this)},onTabKeyPressed:function(e){var t=this.scheduler.selectedItems[0];if(t){var r=this.scheduler.getSortedCollection(),n=Terrasoft.findWhere(r,{itemId:t}),i=r.indexOf(n),a=r[i+(e.shiftKey?-1:1)];a&&(this.scheduler.setSelectedItems([a.itemId]),a.focus())}},onUpKeyPressed:function(e){this._changeItemTime(e,this.scheduler.selectedItems[0],-1)},onDownKeyPressed:function(e){this._changeItemTime(e,this.scheduler.selectedItems[0],1)},onLeftKeyPressed:function(e){this._changeItemDay(e,this.scheduler.selectedItems[0],-1)},onRightKeyPressed:function(e){this._changeItemDay(e,this.scheduler.selectedItems[0],1)},_changeItemTime:function(e,t,r){var n=Terrasoft.findWhere(this.scheduler.collection,{itemId:t});if(n&&!n.isMultiDayItem()){var i;e.ctrlKey?i=Ext.Date.HOUR:(i=Ext.Date.MINUTE,r*=this.scheduler.getTimeScale());var a=n.startDate,s=n.dueDate,o=e.shiftKey?a:Ext.Date.add(a,i,r),l=Ext.Date.add(s,i,r);Terrasoft.areDatesEqual(a,o)&&Terrasoft.areDatesEqual(s,l)&&n._changeDates(o,l)}},_changeItemDay:function(e,t,r){var n=Terrasoft.findWhere(this.scheduler.collection,{itemId:t});if(n){var i=e.shiftKey&&n.isMultiDayItem()?n.startDate:Ext.Date.add(n.startDate,Ext.Date.DAY,r),a=Ext.Date.add(n.dueDate,Ext.Date.DAY,r);n._changeDates(i,a)}},_changeDates:function(e,t){var r=this.scheduler.startDate,n=Ext.Date.add(this.scheduler.dueDate,Ext.Date.DAY,1);e>=r&&t<=n&&(this.startDate=e,t>this.startDate&&(this.dueDate=t),this.fireEvent("changeStartDate",this.startDate,this),this.fireEvent("changeDueDate",this.dueDate,this),this.scheduler.fireEvent("change",this),this.reRender(),this.focus())},focus:function(){var e=this.getWrapEl();e&&e.focus()},subscribeTitleEvents:function(){var e=this.getTitleEl();e.on("mouseover",this.onScheduleItemTitleMouseOver,this),e.on("click",Terrasoft.debounce(this.onScheduleItemTitleClick,this.clickHandlerTimeout,!0),this),e.on("dblclick",this.onScheduleItemTitleDoubleClick,this)},unSubscribeTitleEvents:function(){var e=this.getTitleEl();e&&(e.un("mouseover",this.onScheduleItemTitleMouseOver,this),e.un("click",this.onScheduleItemTitleClick,this),e.un("dblclick",this.onScheduleItemTitleDoubleClick,this))},init:function(){this.callParent(arguments),this.selectors={wrapEl:""},this.addEvents("changeTitle","changeStartDate","changeDueDate","changeStatus")},getTitleEl:function(){var e=this.titleEl,t=this.multiDayItemTitleEl;return e||(t||void 0)},initDomEvents:function(){this.callParent(arguments);var e=this.getWrapEl();e.on("click",Terrasoft.debounce(this.onScheduleItemClick,this.clickHandlerTimeout,!0),this),e.on("dblclick",this.onScheduleItemDoubleClick,this),this.subscribeTitleEvents(),e.on("keydown",this.onKeyDown,this)},onDestroy:function(){var e=this.getWrapEl();e&&(e.un("click",this.onScheduleItemClick,this),e.un("dblclick",this.onScheduleItemDoubleClick,this),e.un("keydown",this.onKeyDown,this)),this.unSubscribeTitleEvents(),this.callParent(arguments)},getBindConfig:function(){var e=this.callParent(arguments),t={itemId:{changeMethod:"onItemIdChange"},title:{changeMethod:"onTitleChange",changeEvent:"changeTitle"},startDate:{changeMethod:"onStartDateChange",changeEvent:"changeStartDate"},dueDate:{changeMethod:"onDueDateChange",changeEvent:"changeDueDate"},status:{changeMethod:"onStatusChange",changeEvent:"changeStatus"},background:{changeMethod:"onBackgroundChange"},fontColor:{changeMethod:"onFontColorChange"},isBold:{changeMethod:"onIsBoldChange"},isItalic:{changeMethod:"onIsItalicChange"},isUnderline:{changeMethod:"onIsUnderlineChange"}};return Ext.apply(t,e),t},setControlInitialValue:function(e,t){var r=this.getBindingValue(e,t);Ext.isDate(r)&&(r=new Date(r));var n=e.config.changeMethod,i=this.bindInitialValueConfig;i.hasOwnProperty(n)&&(this[i[n]]=r)},onItemIdChange:function(e){this.itemId=e},onTitleChange:function(e){this.title=e,this.show()},onStartDateChange:function(e){this.startDate=e,this.calculateItemPosition([e]),this.show()},onDueDateChange:function(e){this.dueDate=e,this.calculateItemPosition([e]),this.show()},calculateItemPosition:function(e){var t=this.scheduler;t.itemPositionProcess(e),this.isMultiDayItem()&&t.multiDayItemPositionProcess()},onStatusChange:function(e){this.setStatus(e),this.show()},onBackgroundChange:function(e){this.background=e,this.show()},onFontColorChange:function(e){this.fontColor=e,this.show()},onIsBoldChange:function(e){this.isBold=e,this.show()},onIsItalicChange:function(e){this.isItalic=e,this.show()},onIsUnderlineChange:function(e){this.isUnderline=e,this.show()},getTplData:function(){var e=this.callParent(arguments);this.selectors.wrapEl=Ext.String.format("#{0}-scheduleritem",this.id);var t=this.isMultiDayItem(),r=t?this.multiDayItemConfig.classes:this.oneDayItemConfig.classes,n={},i=this.selectors;if(i.titleEl=Ext.String.format("#{0}-scheduleritem .scheduleritem-title",this.id),i.multiDayItemTitleEl=Ext.String.format("#{0}-scheduleritem .multi-day-item-title",this.id),t)i.resizeLeft=".multi-day-item-resize-left",i.resizeRight=".multi-day-item-resize-right",n.top=Ext.String.format("{0}px",this.top),n.left=Ext.String.format("{0}px",this.left),n.width=Ext.String.format("{0}px",this.width-this.rightSpace);else{i.resizeTop=i.wrapEl+"-resize-top",i.resizeBottom=i.wrapEl+"-resize-bottom";var a=new Date(this.startDate);this.top=this.getTimePosition(a),n.top=Ext.String.format("{0}em",this.top),Terrasoft.getIsRtlMode()?n.right=Ext.String.format("{0}%",this.left):n.left=Ext.String.format("{0}%",this.left),n.width=Ext.String.format("{0}%",this.width-this.rightSpace),n.height=Ext.String.format("{0}em",this.getHeight())}return e.scheduleItemClass=r.scheduleItemClass,e.scheduleItemResizeTopClass=r.scheduleItemResizeTopClass,e.scheduleItemResizeBottomClass=r.scheduleItemResizeBottomClass,e.scheduleItemStatusClass=r.scheduleItemStatusClass,e.scheduleItemCaptionClass=r.scheduleItemCaptionClass,e.scheduleItemLeftCaptionClass=r.scheduleItemLeftCaptionClass,e.scheduleItemTitleClass=r.scheduleItemTitleClass,e.schedulerItemStyle=n,e.prepareSchedulerItem=function(e,t){var r=Terrasoft.encodeHtml,n=t.self,i=n.status,a=n.isSelected,s=t.scheduleItemStatusClass,o=t.scheduleItemCaptionClass,l=t.scheduleItemLeftCaptionClass,c=t.scheduleItemTitleClass,u=n.getHeight()>n.timeItemHeight?n.getItemCaption():"",h=r(n.title),f=r(n.markerValue),d="",p=n.background,m=n.fontColor;d=m&&!a?d+"color: "+m+"; ":d,d=n.isBold?d+"font-weight: bold; ":d,d=n.isItalic?d+"font-style: italic; ":d,d=n.isUnderline?d+"text-decoration: underline; ":d,p&&a?e.push('<div style="background: '+p+';" class="'+s[i]+" "+s[0]+'">'):p&&!a?e.push('<div style="background: '+p+';" class="'+s[i]+'">'):!p&&a?e.push('<div class="'+s[i]+" "+s[0]+'">'):e.push('<div class="'+s[i]+'">'),n.isMultiDayItem()&&e.push('<div class="'+l+'">'+n.getLeftCaption()+"</div>"),e.push('<div class="'+o+'">'+u+"</div>"),d=0===d.length?"":Ext.String.format(' style="{0}" ',d),f=f?Ext.String.format(' data-item-marker="{0}"',f):"",h=Ext.String.format('<div class="{0}"{1}{2}>{3}</div>',c,d,f,h),e.push(h),e.push("</div>")},e},onAfterRender:function(){this.callParent(arguments),this.initDd();var e=this.getWrapEl();e.unselectable()},onAfterReRender:function(){this.callParent(arguments),this.initDd();var e=this.getWrapEl();e.unselectable()},show:function(){var e=this.getRenderTo();e?(this.visible=!0,this.rendered?this.reRender(null,e):this.render(e)):this.setVisible(!1)},getTimePosition:function(e,t){var r=this.timeItemHeight,n=Terrasoft.getMinutesFromMidnight(e);return this.getTimeItemNumber(n,t)*r},getTimeItemNumber:function(e,t){var r=this.getTimeScale();return(t?e/r:Math.floor(e/r))-60*this.scheduler.startHour/r},getHeight:function(){var e=this.timeItemHeight;return this.getTimeItemCount()*e},getTimeItemCount:function(){var e=Terrasoft.DateRate.MILLISECONDS_IN_MINUTE,t=this.getTimeScale(),r=1/(t*e),n=(this.startDate.getTime()-this.startDate.getTimezoneOffset()*e)/(t*e),i=(this.dueDate.getTime()-this.dueDate.getTimezoneOffset()*e)/(t*e);n=Math.abs(Math.round(n)-n)<r?Math.round(n):n,i=Math.abs(Math.round(i)-i)<r?Math.round(i):i;var a=Math.ceil(i)-Math.floor(n);return a>0?a:1},getWidth:function(){return this.width},getTop:function(){return this.top},getViewModelCollectionItemId:function(){return this.viewModelCollectionItemId},getItemId:function(){return this.itemId},getStartDate:function(){return this.startDate},getDueDate:function(){return this.dueDate},getIsSelected:function(){return this.isSelected},setSelected:function(e,t){e&&e.stopEvent(e);var r=this.scheduler;r.unSelectItems(),this.isSelected=!0,r.getSelectedItems(),!0!==t&&r.fireEvent("changeSelectedItems"),this.updateItemSelectionStyle(!0)},setNotSelected:function(e){this.isSelected=!1,!0!==e&&this.scheduler.fireEvent("changeSelectedItems"),this.updateItemSelectionStyle(!1)},setViewModelCollectionItemId:function(e){this.viewModelCollectionItemId=e,this.tag=e},setTitle:function(e){this.title!==e&&(this.title=e,this.fireEvent("changeTitle",this.title,this),this.scheduler.fireEvent("change",this))},setStatus:function(e){if(e!==Terrasoft.ScheduleItemStatus.NEW&&e!==Terrasoft.ScheduleItemStatus.DONE&&e!==Terrasoft.ScheduleItemStatus.OVERDUE)throw new Terrasoft.NotImplementedException({message:Terrasoft.Resources.Controls.ScheduleEdit.SchedulerItemStatusIsNotValid});this.status!==e&&(this.status=e,this.fireEvent("changeStatus",this.status,this),this.scheduler.fireEvent("change",this))},updateDuration:function(e,t){var r,n=[],i=this.isMultiDayItem(),a=this.scheduler;if(t&&!i)r=Terrasoft.addDays(e,1),n.push(this.startDate);else if(!t&&i)r=Terrasoft.addMinutes(e,this.getTimeScale()),n.push(e);else{var s,o=this.getTimeScale(),l=new Date(this.startDate);if(e=this.getNewDateByScale(l,e,o),Ext.Date.isEqual(l,e))return i&&a.multiDayItemPositionProcess(),this.show(),!0;n.push(e),Terrasoft.areDatesEqual(e,l)||n.push(l),s=((r=new Date(this.dueDate))-l)/Terrasoft.DateRate.MILLISECONDS_IN_MINUTE,r=Terrasoft.addMinutes(e,s)}return this.startDate=e,this.dueDate=new Date(r),this.fireEvent("changeStartDate",this.startDate,this),this.fireEvent("changeDueDate",this.dueDate,this),a.fireEvent("change",this),!0},setStartDate:function(e){var t=this.startDate;if(Ext.Date.isEqual(t,e))return!1;var r=[];if(r.push(e),Terrasoft.areDatesEqual(e,t)||r.push(t),this.dueDate-e<0)throw new Terrasoft.NullOrEmptyException({message:Terrasoft.Resources.Controls.ScheduleEdit.DaysCountShouldBeGreaterThenZero});return this.startDate=e,this.fireEvent("changeStartDate",this.startDate,this),this.scheduler.fireEvent("change",this),!0},setDueDate:function(e){var t=this.dueDate;if(Ext.Date.isEqual(t,e))return!1;var r=[];if(r.push(e),Terrasoft.areDatesEqual(e,t)||r.push(t),e-this.startDate<0)throw new Terrasoft.NullOrEmptyException({message:Terrasoft.Resources.Controls.ScheduleEdit.DaysCountShouldBeGreaterThenZero});var n=this.isMultiDayItem();return n||1!==Math.abs(e.getDate()-t.getDate())||0!==e.getHours()||0!==e.getMinutes()?n&&(e=Terrasoft.addDays(e,1)):e=new Date(e-1),this.dueDate=e,this.fireEvent("changeDueDate",this.dueDate,this),this.scheduler.fireEvent("change",this),!0},setLeft:function(e){this.left!==e&&(this.left=e)},setWidth:function(e){this.width!==e&&(this.width=e)},setTop:function(e){this.top!==e&&(this.top=e)},initScheduleItemDDTicksOnMove:function(e){var t=Ext.get(e.getEl()),r=e.config.item,n=r.scheduler,i=n.id,a=Ext.getElementById(i+"-scheduler-day-column-area"),s=Terrasoft.getIsRtlMode()?a.lastChild:a.firstChild,o=Terrasoft.getIsRtlMode()?a.firstChild:a.lastChild,l=r.getElementBox(s),c=r.getElementBox(o),u=l.left;e.minX=e.initPageX=u;var h=Ext.getScrollbarSize(),f=c.right-t.getWidth(),d=h.width?f+h.width:f;e.maxX=d;var p=l.width;e.setXTicks(u,p);var m=Ext.get(i+"-scheduler-day-row-area").dom,g=r.getElementBox(m.lastChild),T=r.getElementBox(m.firstChild).top,y=Ext.isIE?t.getHeight()/2:t.getHeight(),v=g.bottom-y;e.minY=e.initPageY=T,e.maxY=v;var E=g.height;e.setYTicks(T,E);var C=Ext.get(i+"-scroll-area").getBox(),b=e.yTicks,S=C.top,I=C.bottom;b=Ext.Array.filter(b,(function(e){if(e<=I&&e>=S)return!0}));var x=n.multiDayItemArea.getBox(),P=this.getYTicksForMultiDayItemArea(x);e.yTicks=Ext.Array.merge(P,b)},getYTicksForMultiDayItemArea:function(e){var t=[],r=this.multiDayItemHeight,n=Terrasoft.MultiDayItemAreaLayoutSizes,i=e.top+n.MULTI_DAY_ITEM_PADDING_TOP,a=e.bottom-n.MULTI_DAY_ITEM_PADDING_BOTTOM;for(t.push(i);i<a;)i=i+r+n.BORDER_HEIGHT,t.push(i);return t},initScheduleItemDDTicksOnHorizontalResize:function(e,t){var r=e.config.item,n=r.scheduler.id,i=Ext.get(n+"-scheduler-day-column-area");e.setYConstraint(0,0,0);var a=Terrasoft.MultiDayItemAreaLayoutSizes.BORDER_WIDTH,s=this._getConstraintResizeParams(r,i,a,t);e.setXConstraint(s.xLeft,s.xRight,s.tickWidth)},_getConstraintResizeParams:function(e,t,r,n){var i=e.getWrapEl().getBox();return Terrasoft.getIsRtlMode()?n===Terrasoft.DDAction.RESIZE_LEFT?this._getConstraintResizeParamsLeft(i,e.getElementBox(t.dom.lastChild),r):this._getConstraintResizeParamsRight(i,e.getElementBox(t.dom.firstChild),r):n===Terrasoft.DDAction.RESIZE_LEFT?this._getConstraintResizeParamsLeft(i,e.getElementBox(t.dom.firstChild),r):this._getConstraintResizeParamsRight(i,e.getElementBox(t.dom.lastChild),r)},_getConstraintResizeParamsLeft:function(e,t,r){var n,i,a=t.width;return n=e.left-t.left,n+=Math.ceil(n/a)*r,i=e.width-a,{xLeft:n,xRight:i+=Math.ceil(i/a)*r,tickWidth:a}},_getConstraintResizeParamsRight:function(e,t,r){var n,i,a=t.width;return n=e.width-a,n+=Math.ceil(n/a)*r,i=t.right-e.right,{xLeft:n,xRight:i+=Math.ceil(i/a)*r,tickWidth:a}},initScheduleItemDDTicksOnResizeTop:function(e){var t=e.config.item,r=t.scheduler.id,n=Ext.get(r+"-scheduler-day-row-area"),i=t.getElementBox(n.dom.firstChild);e.setXConstraint(0,0,0);var a=i.top,s=i.height,o=t.getWrapEl().getBottom(),l=Ext.isIE?o:o-s;e.minY=e.initPageY=a,e.maxY=l,e.setYTicks(a,s)},initScheduleItemDDTicksOnResizeBottom:function(e){var t=e.config.item,r=t.scheduler.id,n=Ext.get(r+"-scheduler-day-row-area").dom,i=t.getElementBox(n.firstChild),a=t.getElementBox(n.lastChild),s=i.height;e.setXConstraint(0,0,0);var o=t.getWrapEl().getTop()+s,l=Ext.isIE?a.bottom+5:a.bottom;e.minY=e.initPageY=o,e.maxY=l,e.setYTicks(o,s)},ddItemOverride:{b4StartDrag:function(){var e=this.config.item;e.unSubscribeTitleEvents();var t=e.scheduler,r=this.el=Ext.get(this.id);this.elStyle={width:r.getStyle("width"),left:r.getStyle("left")};var n={"z-index":"12"};e.isMultiDayItem()||(n.width="100%",n.left="0"),r.setStyle(n),t.itemDDEl={item:this,action:Terrasoft.DDAction.MOVE},e.initScheduleItemDDTicksOnMove(this);var i=e.getWrapEl();e.setSelected();var a=i.getXY(),s=t.multiDayItemArea.getBox();this.isMultidayItem=this.pointInsideRegion(a,s)},onDrag:function(e){var t,r=this.config.item,n=r.scheduler,i=n.multiDayItemArea.getBox(),a=Ext.get(n.id+"-scroll-area").getBox(),s=Ext.get(this.getEl()),o=e.getX(),l=e.getY();t=this.pointInsideRegion([o,l],i);var c=this.pointInsideRegion([o,l],a);if(t!==this.isMultidayItem){this.isMultidayItem=t;var u=this.xTickSize,h=this.yTickSize,f=t&&!r.isMultiDayItem(),d=c&&r.isMultiDayItem();if(f){var p=this.deltaY;this.deltaY=p-h*Math.floor(p/h),s.setStyle("position","fixed"),s.setHeight(r.multiDayItemHeight),s.setWidth(u)}else if(d){s.setWidth(u);var m=this.deltaX;this.deltaX=m-u*Math.floor(m/u),r.initScheduleItemDDTicksOnMove(this)}}o=this.x=this.getTick(o-this.deltaX,this.xTicks),l=this.y=this.getTick(l-this.deltaY,this.yTicks),s.setXY([o,l])},onInvalidDrop:function(){this.el.setStyle({"z-index":"10",width:this.elStyle.width,left:this.elStyle.left}),this.x=null,this.y=null,this.invalidDrop=!0},endDrag:function(){var e=this.config.item;e.subscribeTitleEvents(),!0===this.invalidDrop&&(e.reRender(),delete this.invalidDrop)},_isTargetDisconnected:function(e){var t=e&&e.target;return!(t&&document.body.contains(t))},onDragDrop:function(e){if(!this._isTargetDisconnected(e)){var t=e.getX(),r=e.getY();if(this.x&&this.y||(this.y=this.getTick(r-this.deltaY,this.yTicks),this.x=this.getTick(t-this.deltaX,this.xTicks)),Terrasoft.getIsRtlMode()&&this.el.dom){var n=this.el.getWidth(),i=this.getTick(t+n-this.deltaX,this.xTicks);this.x=t+n-this.deltaX<=this.xTicks[this.xTicks.length-1]?i-this.xTickSize:i}var a=this.config.item,s=a.scheduler,o=s.multiDayItemArea.getBox(),l=[this.x+this.xTickSize/2,this.y+this.yTickSize/2],c=this.pointInsideFewDayItemArea=this.pointInsideRegion([t,r],o),u=this.DDMInstance,h=u.ids.day,f=u.ids.time,d=this.pointInsideDays(l,h),p=c?{hour:0,minute:0}:this.pointInsideTimes(l,f);if(d&&p){var m=new Date(d.year,d.month,d.day,p.hour,p.minute);a.updateDuration(m,c),s.itemDDEl=null,a.focus()}else this.onInvalidDrop()}},pointInsideInterval:function(e,t){var r=e[0];return t.left<r&&r<t.right},pointInsideDays:function(e,t){var r=this,n=!1;return Terrasoft.each(t,(function(t){var i=t.getEl(),a=Ext.util.Region.getRegion(i);if(r.pointInsideFewDayItemArea?r.pointInsideInterval(e,a):r.pointInsideRegion(e,a)){var s=r.dateRe.exec(i.id);return(n={day:s[1],month:s[2],year:s[3]}).month=n.month-1,1===n.month.length&&(n.month+="0"),!1}}),this),n},pointInsideTimes:function(e,t){var r=this,n=null;return Terrasoft.each(t,(function(t){var i=t.getEl(),a=Ext.util.Region.getRegion(i);if(r.pointInsideRegion(e,a)){var s=r.timeRe.exec(i.id);n={hour:s[1],minute:s[2]}}}),this),n},pointInsideRegion:function(e,t){var r=e[0],n=e[1];return!(r<t.left||r>t.right||n<t.top||n>t.bottom)},dateRe:new RegExp("(\\d{2})-(\\d{2})-(\\d{4})$"),timeRe:new RegExp("(\\d{1,2})-(\\d{1,2})$")},ddItemResizeTopOverride:{b4StartDrag:function(){var e=this.config.item,t=this.el=Ext.get(this.id),r=this.elParent=t.parent();Ext.isIE8&&(this.position={top:r.getTop(),bottom:r.getBottom()}),r.setStyle({"z-index":"11",width:"100%",left:0}),e.scheduler.itemDDEl={item:this,action:Terrasoft.DDAction.RESIZE_TOP},e.initScheduleItemDDTicksOnResizeTop(this),e.setSelected()},onDrag:function(e){var t=this.elParent,r=t.getRegion(),n=this.position;Ext.isIE8&&(r.top=n.top,r.bottom=n.bottom,t.setRegion(r)),this.y=this.getTick(e.getY()-this.deltaY,this.yTicks),r.top=this.y,Ext.isIE8&&(r.bottom=n.bottom),t.setRegion(r)},onDragDrop:function(){var e=Ext.get(this.id),t=e.getXY();if(!this.y){var r=e.getY();this.y=this.getTick(r-this.deltaY,this.yTicks)}t[1]=this.y===this.minY?this.y:this.y+this.yTickSize/2;var n=this.DDMInstance.ids.time,i=this.pointInsideTimes(t,n),a=this.config.item,s=new Date(a.getStartDate());s=new Date(s.getFullYear(),s.getMonth(),s.getDate(),i.hour,i.minute),a.setStartDate(s)&&(a.scheduler.itemDDEl=null)},pointInsideTimes:function(e,t){var r=this,n=null;return Terrasoft.each(t,(function(t){var i=t.getEl(),a=Ext.util.Region.getRegion(i);if(r.pointInsideRegion(e,a)){var s=r.timeRe.exec(i.id);n={hour:s[1],minute:s[2]}}}),this),n},pointInsideRegion:function(e,t){var r=e[0],n=e[1];return!(r<t.left||r>t.right||n<t.top||n>t.bottom)},dateRe:new RegExp("(\\d{2})-(\\d{2})-(\\d{4})$"),timeRe:new RegExp("(\\d{1,2})-(\\d{1,2})$")},ddItemResizeBottomOverride:{b4StartDrag:function(){var e=this.config.item,t=this.el=Ext.get(this.id),r=this.elParent=t.parent();this.position={top:r.getTop(),bottom:r.getBottom()},r.setStyle({"z-index":"11",width:"100%",left:0}),e.scheduler.itemDDEl={item:this,action:Terrasoft.DDAction.RESIZE_BOTTOM},e.initScheduleItemDDTicksOnResizeBottom(this),e.setSelected()},onDrag:function(e){var t=this.elParent,r=t.getRegion(),n=this.position;Ext.isIE8&&(r.top=n.top,r.bottom=n.bottom,t.setRegion(r)),this.y=this.getTick(e.getY()-this.deltaY,this.yTicks),r.bottom=this.y,Ext.isIE8&&(r.top=n.top),t.setRegion(r)},onDragDrop:function(e){if(!this.y){var t=e.getY();this.y=this.getTick(t-this.deltaY,this.yTicks)}var r=e.getXY(),n=this.y-this.yTickSize/2,i=this.y+this.yTickSize/2;this.y>=this.maxY?r[1]=n:r[1]=Ext.isIE?n+this.yTickSize:i;var a=this.DDMInstance.ids.time,s=this.pointInsideTimes(r,a),o=this.config.item,l=new Date(o.getDueDate());l=new Date(l.getFullYear(),l.getMonth(),l.getDate(),s.hour,s.minute);var c=o.getTimeScale();this.maxY-this.yTickSize<this.y&&(l=Terrasoft.addMinutes(l,c)),o.setDueDate(l)&&((o=this.config.item).scheduler.itemDDEl=null)},pointInsideTimes:function(e,t){var r=this,n=null;return Terrasoft.each(t,(function(t){var i=t.getEl(),a=Ext.util.Region.getRegion(i);if(r.pointInsideRegion(e,a)){var s=r.timeRe.exec(i.id);n={hour:s[1],minute:s[2]}}}),this),n},pointInsideRegion:function(e,t){var r=e[0],n=e[1];return!(r<t.left||r>t.right||n<t.top||n>t.bottom)},dateRe:new RegExp("(\\d{2})-(\\d{2})-(\\d{4})$"),timeRe:new RegExp("(\\d{1,2})-(\\d{1,2})$")},ddItemResizeLeftOverride:{b4StartDrag:function(){var e=this.config.item,t=this.el=Ext.get(this.id),r=this.elParent=t.parent();Ext.isIE8&&(this.position={top:r.getTop(),bottom:r.getBottom(),left:r.getLeft(),right:r.getRight()}),r.setStyle({"z-index":"11"}),e.scheduler.itemDDEl={item:this,action:Terrasoft.DDAction.RESIZE_LEFT},e.initScheduleItemDDTicksOnHorizontalResize(this,Terrasoft.DDAction.RESIZE_LEFT),e.setSelected()},onDrag:function(e){var t=this.elParent,r=t.getRegion(),n=this.position;Ext.isIE8&&(r.left=n.left,r.right=n.right,t.setRegion(r)),this.x=this.getTick(e.getX()-this.deltaX,this.xTicks),r.left=this.x,Ext.isIE8&&(r.right=n.right),t.setRegion(r)},endDrag:function(e){var t=e.xy,r=this.config.item;t[0]<this.minX&&r.allowRerender()&&this.config.item.reRender()},onDragDrop:function(){var e=this.DDMInstance.ids.day,t=this.pointInsideDays(this.x+this.xTickSize/2,e),r=this.config.item,n=new Date(t.year,t.month,t.day,0,0);(Terrasoft.getIsRtlMode()?r.setDueDate:r.setStartDate).call(r,n)&&(r.scheduler.itemDDEl=null)},pointInsideDays:function(e,t){var r=this,n=null;return Terrasoft.each(t,(function(t){var i=t.getEl(),a=Ext.util.Region.getRegion(i);if(r.pointInsideRegion(e,a)){var s=r.dateRe.exec(i.id);(n={day:s[1],month:s[2],year:s[3]}).month=n.month-1,1===n.month.length&&(n.month+="0")}}),this),n},pointInsideRegion:function(e,t){return t.left<e&&e<t.right},dateRe:new RegExp("(\\d{2})-(\\d{2})-(\\d{4})$"),timeRe:new RegExp("(\\d{1,2})-(\\d{1,2})$")},ddItemResizeRightOverride:{b4StartDrag:function(){var e=this.config.item,t=this.el=Ext.get(this.id),r=this.elParent=t.parent();Ext.isIE8&&(this.position={top:r.getTop(),bottom:r.getBottom(),left:r.getLeft(),right:r.getRight()}),r.setStyle({"z-index":"11"}),e.scheduler.itemDDEl={item:this,action:Terrasoft.DDAction.RESIZE_RIGHT},e.initScheduleItemDDTicksOnHorizontalResize(this,Terrasoft.DDAction.RESIZE_RIGHT),e.setSelected()},onDrag:function(e){var t=this.elParent,r=t.getRegion();this.x=this.getTick(e.getX(),this.xTicks),r.right=this.x+this.deltaX,t.setRegion(r)},endDrag:function(e){var t=e.xy,r=this.config.item;t[0]>this.maxX&&r.allowRerender()&&this.config.item.reRender()},onDragDrop:function(){var e=this.DDMInstance.ids.day,t=this.pointInsideDays(this.x-this.xTickSize/2,e),r=this.config.item,n=new Date(t.year,t.month,t.day,0,0);(Terrasoft.getIsRtlMode()?r.setStartDate:r.setDueDate).call(r,n)&&(r.scheduler.itemDDEl=null)},pointInsideDays:function(e,t){var r=this,n=null;return Terrasoft.each(t,(function(t){var i=t.getEl(),a=Ext.util.Region.getRegion(i);if(r.pointInsideRegion(e,a)){var s=r.dateRe.exec(i.id);(n={day:s[1],month:s[2],year:s[3]}).month=n.month-1,1===n.month.length&&(n.month+="0")}}),this),n},pointInsideRegion:function(e,t){return t.left<e&&e<t.right},dateRe:new RegExp("(\\d{2})-(\\d{2})-(\\d{4})$"),timeRe:new RegExp("(\\d{1,2})-(\\d{1,2})$")},initDd:function(){Ext.dd.DragDropManager.notifyOccluded=!0;var e=this.getWrapEl().initDD("item",{isTarget:!1,item:this},this.ddItemOverride);if(e.addToGroup("multi-day-item"),e.addToGroup("day-item"),e.addToGroup("time-item"),this.isMultiDayItem()){var t,r,n=this.resizeLeft,i=this.resizeRight;t=Terrasoft.getIsRtlMode()?n.initDD("item-resize-left",{isTarget:!1,item:this},this.ddItemResizeRightOverride):n.initDD("item-resize-left",{isTarget:!1,item:this},this.ddItemResizeLeftOverride),r=Terrasoft.getIsRtlMode()?i.initDD("item-resize-right",{isTarget:!1,item:this},this.ddItemResizeLeftOverride):i.initDD("item-resize-right",{isTarget:!1,item:this},this.ddItemResizeRightOverride),t.addToGroup("multi-day-item"),r.addToGroup("multi-day-item")}else{var a=this.resizeTop.initDD("item-resize-top",{isTarget:!1,item:this},this.ddItemResizeTopOverride);a.addToGroup("day-item"),a.addToGroup("time-item");var s=this.resizeBottom.initDD("item-resize-bottom",{isTarget:!1,item:this},this.ddItemResizeBottomOverride);s.addToGroup("day-item"),s.addToGroup("time-item")}},getElBoxByDate:function(e){return Ext.select("div[id*='"+this.getDayColumnId(e)+"']").first().getBox()}}),Ext.define("Terrasoft.controls.ScheduleFloatingItem.ScheduleFloatingItem",{alternateClassName:"Terrasoft.ScheduleFloatingItem",extend:"Terrasoft.Component",caption:"",contentEl:null,width:320,scheduleEdit:null,styles:{wrapElStyle:{}},tpl:['<div id="{id}-schedule-floating-item" class="schedule-floating-item schedule-item" style="{wrapElStyle}">','<div id="{id}-header" class="scheduler-item-caption">','<label id="{id}-caption">{caption}</label>',"</div>",'<div id="{id}-content" class="content"></div>',"</div>"],init:function(){var e=this.id;this.selectors={wrapEl:"#"+e+"-schedule-floating-item",captionEl:"#"+e+"-caption",contentEl:"#"+e+"-content"},this.addEvents("ready"),this.callParent(arguments)},initDomEvents:function(){this.getWrapEl().on("click",this.onClick,this)},getTplData:function(){var e=this.callParent(arguments);return Ext.apply(this.styles.wrapElStyle,{width:this.width+"px","margin-left":"-"+Math.floor(this.width/2)+"px"}),Ext.apply(e,{caption:Terrasoft.encodeHtml(this.caption)}),e},getBindConfig:function(){var e=this.callParent(arguments),t={caption:{changeMethod:"setCaption"},width:{changeMethod:"setWidth"}};return Ext.apply(t,e),t},onAfterRender:function(){this.callParent(arguments),this.fireEvent("ready",this,this.contentEl.id)},onClick:function(e){e.stopEvent()},setWidth:function(e){if(this.width!==e){if(this.rendered)this.getWrapEl().setStyle({width:e+"px","margin-left":"-"+Math.floor(e/2)+"px"});this.width=e}},setCaption:function(e){this.caption!==e&&(this.rendered&&(this.captionEl.dom.innerHTML=Terrasoft.encodeHtml(e)),this.caption=e)},onDestroy:function(){var e=this.getWrapEl();e&&e.un("click",this.onClick,this),this.callParent(arguments)}}),Ext.ns("Terrasoft.controls.ScheduleEdit"),Terrasoft.controls.ScheduleEdit.TimeScale={ONE_MINUTE:1,FIVE_MINUTES:5,TEN_MINUTES:10,FIFTEEN_MINUTES:15,THIRTY_MINUTES:30,SIXTY_MINUTES:60},Terrasoft.TimeScale=Terrasoft.controls.ScheduleEdit.TimeScale,Terrasoft.controls.ScheduleEdit.DDAction={MOVE:0,RESIZE_TOP:1,RESIZE_BOTTOM:2,RESIZE_RIGHT:3,RESIZE_LEFT:4},Terrasoft.controls.ScheduleEdit.MultiDayItemAreaLayoutSizes={BORDER_WIDTH:3,BORDER_HEIGHT:1,MULTI_DAY_ITEM_PADDING_BOTTOM:1,MULTI_DAY_ITEM_PADDING_TOP:1},Terrasoft.MultiDayItemAreaLayoutSizes=Terrasoft.controls.ScheduleEdit.MultiDayItemAreaLayoutSizes,Terrasoft.DDAction=Terrasoft.controls.ScheduleEdit.DDAction,Ext.define("Terrasoft.controls.ScheduleEdit.ScheduleEdit",{extend:"Terrasoft.controls.Component",alternateClassName:"Terrasoft.ScheduleEdit",timeItemHeight:2.2,timezoneItemWidth:3.5,mainTimezoneItemWidth:3.5,startDate:null,dueDate:null,period:null,timeScale:null,bottomPadding:5,timezone:null,showDayImages:!1,selectedDays:[],weekImageConfig:[{dayImageClass:"schedule-edit-day-image-sunday"},{dayImageClass:"schedule-edit-day-image-monday"},{dayImageClass:"schedule-edit-day-image-tuesday"},{dayImageClass:"schedule-edit-day-image-wednesday"},{dayImageClass:"schedule-edit-day-image-thursday"},{dayImageClass:"schedule-edit-day-image-friday"},{dayImageClass:"schedule-edit-day-image-saturday"}],dayImageConfig:{dayImageClass:"schedule-edit-day-image",selectedDayImageClass:"schedule-edit-selected-day-image"},collection:[],activityCollection:null,schedulerDayList:[],selectedItems:[],selection:null,innerSelection:null,floatingItemsCollection:null,scheduleFloatingItems:null,displayStartHour:null,startHour:0,dueHour:24,isScrollVisible:!1,itemDDEl:null,tpl:['<div id="{id}-scheduler" class="{schedulerAreaClass}">','<div id="{id}-title-area" class="{titleAreaClass}" style="{titleAreaStyle}">','<div style="{timezoneTitleAreaStyle}" class="{timezoneTitleAreaClass}">',"</div>",'<div style="{dayTitleAreaStyle}" class="{dayTitleAreaClass}">{%this.prepareDayTitle(out, values)%}',"</div>","</div>",'<div style="{multiDayItemAreaStyle}" class="{multiDayItemAreaClass}">','<div style="{timezoneTitleAreaStyle}" class="{timezoneTitleAreaClass}">',"{%this.prepareTimezoneTitle(out, values)%}","</div>",'<div style="{dayTitleAreaStyle}" class="{dayTitleAreaClass}">',"</div>","</div>",'<div id="{id}-scroll-area" class="{scrollAreaClass}" style="{gridScrollStyle}">','<div id="{id}-grid-area" style="{timeGridStyle}" class="{gridAreaClass}">','<div class="{timeColumnAreaClass}">','<div id="{id}-time-marker" style="top:0em" class="time-marker"></div>',"{%this.prepareTimeColumn(out, values)%}","</div>",'<div class="{dayGridAreaClass}">','<div style="{dayColumnAreaStyle}" class="{dayColumnAreaClass}" id="{id}-scheduler-day-column-area">',"{%this.prepareDayColumn(out, values)%}","</div>",'<div class="{dayRowAreaClass}" id="{id}-scheduler-day-row-area">',"{%this.prepareDayRow(out, values)%}","</div>","</div>","</div>","</div>","</div>"],schedulerConfig:{classes:{schedulerAreaClass:["scheduler-area"],titleAreaClass:["title-area"],multiDayItemAreaClass:["multi-day-item-area"],gridAreaClass:["grid-area"],timezoneTitleAreaClass:["timezone-title-area"],dayTitleAreaClass:["day-title-area"],timeColumnAreaClass:["time-column-area"],dayGridAreaClass:["day-grid-area"],dayColumnAreaClass:["day-column-area"],dayRowAreaClass:["day-row-area"],dayTitleClass:["day-title","today-title","holiday-title"],dayColumnClass:["day-column","holiday-column"],timezoneTitleClass:["main-timezone-title","single-main-timezone-title","timezone-title"],timeColumnClass:["main-time-column","time-column"],scrollAreaClass:["scroll-area","ts-box-sizing"]},styles:{titleAreaStyle:{"z-index":"20"},multiDayItemAreaStyle:{height:""},timeGridStyle:{height:""},timezoneTitleAreaStyle:{width:""},dayTitleAreaStyle:{"padding-left":""},dayColumnAreaStyle:{"padding-left":""},dayItemWidthStyle:{width:""},gridScrollStyle:{height:"auto","overflow-y":"auto","overflow-x":"hidden"}},mainTimezoneHourTpl:{minutes5:'<div class="hour-cell"><div class="hour-cell-content">{hourNumber}</div></div><div class="minute-cell"></div><div class="minute-cell"></div><div class="minute-cell"><div class="minute-cell-content">15</div></div><div class="minute-cell"></div><div class="minute-cell"></div><div class="minute-cell"><div class="minute-cell-content">30</div></div><div class="minute-cell"></div><div class="minute-cell"></div><div class="minute-cell"><div class="minute-cell-content">45</div></div><div class="minute-cell"></div><div class="minute-cell"></div>',minutes10:'<div class="hour-cell"><div class="hour-cell-content">{hourNumber}</div></div><div class="minute-cell"></div><div class="minute-cell"></div><div class="minute-cell"><div class="minute-cell-content">30</div></div><div class="minute-cell"></div><div class="minute-cell"></div>',minutes15:'<div class="hour-cell"><div class="hour-cell-content">{hourNumber}</div></div><div class="minute-cell"></div><div class="minute-cell"><div class="minute-cell-content">30</div></div><div class="minute-cell"></div>',minutes30:'<div class="hour-cell"><div class="hour-cell-content">{hourNumber}</div></div><div class="minute-cell"></div>',minutes60:'<div class="hour-cell"><div class="hour-cell-content">{hourNumber}</div></div>'},timezoneHourTpl:{minutes5:'<div class="hour-cell"><div class="hour-cell-content">{hourNumber}</div></div><div class="minute-cell"></div><div class="minute-cell"></div><div class="minute-cell"></div><div class="minute-cell"></div><div class="minute-cell"></div><div class="minute-cell"></div><div class="minute-cell"></div><div class="minute-cell"></div><div class="minute-cell"></div><div class="minute-cell"></div><div class="minute-cell"></div>',minutes10:'<div class="hour-cell"><div class="hour-cell-content">{hourNumber}</div></div><div class="minute-cell"></div><div class="minute-cell"></div><div class="minute-cell"></div><div class="minute-cell"></div><div class="minute-cell"></div>',minutes15:'<div class="hour-cell"><div class="hour-cell-content">{hourNumber}</div></div><div class="minute-cell"></div><div class="minute-cell"></div><div class="minute-cell"></div>',minutes30:'<div class="hour-cell"><div class="hour-cell-content">{hourNumber}</div></div><div class="minute-cell"></div>',minutes60:'<div class="hour-cell"><div class="hour-cell-content">{hourNumber}</div></div>'},dayHourTpl:{minutes5:'<div id="{hourId}-00" class="hour-row"></div><div id="{hourId}-05" class="minute-row"></div><div id="{hourId}-10" class="minute-row"></div><div id="{hourId}-15" class="minute-row"></div><div id="{hourId}-20" class="minute-row"></div><div id="{hourId}-25" class="minute-row"></div><div id="{hourId}-30" class="minute-row"></div><div id="{hourId}-35" class="minute-row"></div><div id="{hourId}-40" class="minute-row"></div><div id="{hourId}-45" class="minute-row"></div><div id="{hourId}-50" class="minute-row"></div><div id="{hourId}-55" class="minute-row"></div>',minutes10:'<div id="{hourId}-00" class="hour-row"></div><div id="{hourId}-10" class="minute-row"></div><div id="{hourId}-20" class="minute-row"></div><div id="{hourId}-30" class="minute-row"></div><div id="{hourId}-40" class="minute-row"></div><div id="{hourId}-50" class="minute-row"></div>',minutes15:'<div id="{hourId}-00" class="hour-row"></div><div id="{hourId}-15" class="minute-row"></div><div id="{hourId}-30" class="minute-row"></div><div id="{hourId}-45" class="minute-row"></div>',minutes30:'<div id="{hourId}-00" class="hour-row"></div><div id="{hourId}-30" class="minute-row"></div>',minutes60:'<div id="{hourId}-00" class="hour-row"></div>'}},itemBindingConfig:{itemId:{bindTo:"Id"},title:{bindTo:"Title"},dueDate:{bindTo:"DueDate"},status:{bindTo:"Status"},startDate:{bindTo:"StartDate"},background:{bindTo:"Background"},fontColor:{bindTo:"FontColor"},isBold:{bindTo:"IsBold"},isItalic:{bindTo:"IsItalic"},isUnderline:{bindTo:"IsUnderline"},markerValue:{bindTo:"MarkerValue"}},floatingItemBindingConfig:null,selectionKeyPressSymbols:"",ddDayOverride:{},ddTimeOverride:{},keyMap:null,timeMarkerUpdateRate:12e3,timeMarkerUpdateTimer:null,_paddingDirection:"padding-left",initTimeMarkerUpdateTimer:function(){var e=this;this.timeMarkerUpdateTimer=setInterval((function(){e.updateTimeMarker()}),this.getTimeMarkerUpdateTimerInterval())},clearTimeMarkerUpdateTimer:function(){this.timeMarkerUpdateTimer&&clearInterval(this.timeMarkerUpdateTimer)},getTimeMarkerUpdateTimerInterval:function(){return this.timeScale*this.timeMarkerUpdateRate},getTimeGridHeight:function(e){var t=Terrasoft.DateRate.MINUTES_IN_HOUR;return(this.dueHour-this.startHour)*t/e*this.timeItemHeight},unSelectItems:function(){var e=this.collection;this.selectedItems=[];for(var t=0,r=e.length;t<r;t++)e[t].getIsSelected()&&e[t].setNotSelected()},scrollToStartPosition:function(e){var t,r=0,n=Terrasoft.ClientCoreCache,i=this.getTimeScale();if(n){var a="ScheduleEditScrollTopOnScale"+i;t=n.getItem(a)}if(t>=0)r=t;else{var s=this.displayStartHour,o=Ext.get(this.id+"-time-"+s);if(!o)return;var l=e.getConstrainVector(o);l&&(r=l[1])}this._silentScrollTop(r)},_silentScrollTop:function(e){var t=this.scrollEl;t.getScrollTop()!==e&&(this._destroyScrollListeners(),t.scroll("bottom",e,!1),Terrasoft.defer(this._initScrollListeners,this))},prepareScrollArea:function(e){var t=this.scrollEl,r=t.getBox().top,n=Ext.Element.getViewportHeight()-r-this.bottomPadding,i=Ext.get(this.id+"-title-area");t.setHeight(n),!0===e&&this.scrollToStartPosition(t);var a=Ext.getScrollbarSize();this.isScrollVisible=t.isScrollable();var s=this.isScrollVisible?"hidden":"auto";if(t.setStyle({"overflow-x":s}),Ext.isWebKit){var o=Ext.get(this.id+"-grid-area"),l=this.isScrollVisible?Ext.String.format("{0}px",a.width-12):0;o.setStyle({"padding-right":l})}if(!Terrasoft.getIsRtlMode()){var c=this.isScrollVisible?Ext.String.format("{0}px",a.width):0;i.setStyle({"padding-right":c})}},getDayColumnId:function(e,t){var r=String(t.getDate());r=1===r.length?"0"+r:r;var n=String(t.getMonth()+1);return[e,"day",r,n=1===n.length?"0"+n:n,t.getFullYear()].join("-")},getDayItemWidth:function(e){return Number(100/e)},getTimezoneAreaWidth:function(e){if(!e)throw new Terrasoft.NullOrEmptyException({message:Terrasoft.Resources.Controls.ScheduleEdit.IsNullTimeZoneParameter});if(0===e.length)throw new Terrasoft.NullOrEmptyException({message:Terrasoft.Resources.Controls.ScheduleEdit.IsNullTimeZoneParameter});return Number((e.length-1)*this.timezoneItemWidth+this.mainTimezoneItemWidth)},getDayCount:function(e,t){var r=Ext.Date.clearTime(t)-Ext.Date.clearTime(e),n=Terrasoft.DateRate.MILLISECONDS_IN_DAY;return Math.floor(r/n)+1},getIsDayOff:function(e){var t=e.getDay();return 0===t||6===t},getTimeItemNumber:function(e,t){var r=this.timeScale,n=this.timeItemHeight,i=Terrasoft.DateRate.MINUTES_IN_HOUR;return(t?e*n/r:Math.floor(e/r)*n)-this.startHour*i*n/r},getIsDayToday:function(e){if(!e)return!1;var t=new Date(Ext.Date.now());return Ext.Date.isEqual(Ext.Date.clearTime(t),Ext.Date.clearTime(e))},getImageConfig:function(e){var t=e.getDay(),r=this.dayImageConfig,n=this.weekImageConfig;if(n[t]){var i=n[t],a={dayImageClass:r.dayImageClass,selectedDayImageClass:r.selectedDayImageClass};return i.dayImageClass&&(a.dayImageClass+=" "+i.dayImageClass),i.selectedDayImageClass&&(a.selectedDayImageClass+=" "+i.selectedDayImageClass),a}return r},getTitleImage:function(e,t){if(!e)return"";var r=this.isDayImageVisible?"block":"none",n=this.getImageConfig(e);return'<div day-image-date="'+e+'" class="'+(t?n.dayImageClass+" "+n.selectedDayImageClass:n.dayImageClass)+'" style="display:'+r+'"></div>'},getDayTitle:function(e){if(!e)return"";var t=Terrasoft.Resources.CultureSettings.shortDayNames[e.getDay()];return e.getDate()+", "+t},getTimePosition:function(e,t){var r=Terrasoft.getMinutesFromMidnight(e);return this.getTimeItemNumber(r,t)},getSchedulerDayList:function(){for(var e=[],t=new Date(this.startDate),r=new Date(this.dueDate);t<=r;)e.push(t),t=Terrasoft.addDays(t,1);return e},renderSchedulerItems:function(){var e=this.getSchedulerDayList();this.itemPositionProcess(e),this.multiDayItemPositionProcess(),this.renderScheduleFloatingItems()},getSortedCollection:function(){var e=_.clone(this.collection);return e.sort(this.sortScheduleItemListByStartDate),e},itemPositionProcess:function(e){var t=this.sortScheduleItemList(this.collection);if(0!==t.length)for(var r=Terrasoft.DateRate.MINUTES_IN_HOUR,n=0;n<e.length;n++){var i,a=this.getDayItemArray(e[n],t),s=this.timeScale,o=(this.dueHour-this.startHour)*r/s,l=[],c=a.length;for(i=0;i<o;i++)l[i]=[];var u=[];for(i=0;i<c;i++){var h=a[i],f=h.getStartDate(),d=Terrasoft.getMinutesFromMidnight(f),p=h.getTimeItemNumber(d,!1);u[i]=this.getTimeItemCount(h.startDate,h.dueDate);var m=u[i]+p,g=l[p].length;h.setWidth(100),h.setLeft(0);for(var T=0;T<=g;T++)if(null==l[p][T]){for(var y=p;y<m;y++)l[y][T]=i;break}}var v=0,E=0;for(i=0;i<o;i++)0!==l[i].length?(v<l[i].length&&(v=l[i].length,i===o-2&&v<l[o-1].length&&(v=l[o-1].length)),this.getIsArraysCrossed(l[i],l[i+1])&&i!==o-1||(this.itemPositionRenderProcess(a,l,u,E,i,v),E=i+1,v=0)):E=i+1}},itemPositionRenderProcess:function(e,t,r,n,i,a){for(var s=[],o=n;o<=i;o++)for(var l=t[o],c=0;c<l.length;c++){var u=l[c];if(null!=u){var h=e[u];null==s[u]&&(s[u]=h);var f=100/a,d=f;if(c<l.length-1)d*=this.getItemAdditionalWidthIndex(t,o,r[u],c+1);else d*=a-c;var p=h.getWidth();h.setWidth(p>d?d:p),h.setLeft(f*c)}}for(o=0;o<s.length;o++)null!=s[o]&&s[o].show()},getItemAdditionalWidthIndex:function(e,t,r,n){for(var i=1,a=n;a<e[t].length;a++){for(var s=t+r>e.length?e.length:t+r,o=t;o<s;o++)if(null!=e[o][a])return i;i+=1}return i},getIsArraysCrossed:function(e,t){if(t&&e)for(var r=0;r<e.length;r++)if(t.indexOf(e[r])>=0)return!0;return!1},getDayItemArray:function(e,t){for(var r=[],n=0;n<t.length;n++){var i=t[n].getStartDate();Terrasoft.areDatesEqual(e,i)&&!t[n].isMultiDayItem()&&r.push(t[n])}return r},getIsTheSameDay:function(e,t){return e.getDate()===t.getDate()&&e.getMonth()===t.getMonth()&&e.getFullYear()===t.getFullYear()},sortScheduleItemList:function(e){var t=[];return Terrasoft.each(e,(function(e){e.isMultiDayItem()||t.push(e)})),t.sort(this.sortScheduleItemListByStartDate),t},sortScheduleItemListByStartDate:function(e,t){var r=0,n=e.startDate,i=e.dueDate-n,a=t.startDate,s=t.dueDate-a;return n===a&&i===s?r=0:n>a?r=1:n<a||i>s?r=-1:i<s&&(r=1),r},renderScheduleFloatingItems:function(){this.scheduleFloatingItems.each((function(e){this.renderScheduleFloatingItem(e)}),this)},renderScheduleFloatingItem:function(e){if(this.rendered&&this.visible){var t=this.getWrapEl();e.render(t)}},onScheduleFloatingItemAdd:function(e){this.renderScheduleFloatingItem(e)},onScheduleFloatingItemsDataLoaded:function(){this.renderScheduleFloatingItems()},onScheduleFloatingItemRemove:function(e){this.destroyKeyMap(),e.destroy()},onScheduleFloatingItemsClear:function(){this.scheduleFloatingItems.each((function(e){e.destroy()}),this)},init:function(){this.callParent(arguments);var e=this.scheduleFloatingItems=Ext.create("Terrasoft.Collection");e.on("add",this.onScheduleFloatingItemAdd,this),e.on("dataLoaded",this.onScheduleFloatingItemsDataLoaded,this),e.on("remove",this.onScheduleFloatingItemRemove,this),e.on("clear",this.onScheduleFloatingItemsClear,this),this.selection={},this.showDayImages=!1,this.selectors={wrapEl:"",daysEl:".day-column-area",dayTimesEl:".day-row-area",scrollEl:"",multiDayItemArea:".multi-day-item-area",dayGridAreaEl:".day-grid-area",timeColumnArea:".time-column-area",timeMarkerEl:""},this.addEvents("change","scheduleItemDoubleClick","scheduleItemClick","scheduleItemTitleClick","scheduleItemTitleMouseOver","selectionChanged","selectionKeyPress","floatingItemReady","selectionKeyPressSymbolsUpdate","changeSelectedItems","selectedDaysChanged","dayImageClick"),this.initTimeMarkerUpdateTimer(),this._initRtlProperties()},_initRtlProperties:function(){Terrasoft.getIsRtlMode()&&(this._paddingDirection="padding-right",this.schedulerConfig.styles.dayTitleAreaStyle={"padding-right":""},this.schedulerConfig.styles.dayColumnAreaStyle={"padding-right":""})},initDomEvents:function(){var e=this.getWrapEl();e.on("click",this.unSelectItems,this),e.on("mousedown",this.onMouseDown,this),Ext.EventManager.on(window,"resize",this.prepareScrollArea,this),this._initScrollListeners()},_initScrollListeners:function(){var e=this.scrollEl;e&&(Ext.isIE||e.on("scroll",this.onScroll,this),e.on("scroll",this.saveScrollPosition,this))},saveScrollPosition:function(){var e=Terrasoft.ClientCoreCache,t=this.scrollEl;if(e&&t){var r="ScheduleEditScrollTopOnScale"+this.getTimeScale(),n=t.getScrollTop();e.setItem(r,n)}},onSelectionKeyPress:function(e,t){t=Ext.isNumber(t)?t:e.getKey(),!1!==this.canExecute({method:this.onSelectionKeyPress,args:[e,t]})?e.isSpecialKey()&&t!==Ext.EventObject.ENTER||(this.selectionKeyPressSymbols+=String.fromCharCode(t),1===this.selectionKeyPressSymbols.length&&this.fireEvent("selectionKeyPress",this,e),this.fireEvent("selectionKeyPressSymbolsUpdate")):Ext.EventManager.stopEvent(e.browserEvent)},onMouseDown:function(e){var t=this.getWrapEl(),r=Ext.get(e.target);if(!r.findParent(".schedule-floating-item",t,!0))if(r.findParent(".day-title",t,!0)||r.findParent(".holiday-title",t,!0)||r.findParent(".today-title",t,!0)){var n=r.getAttribute("day-image-date");if(null!==n){var i=new Date(n);this.fireEvent("dayImageClick",i)}}else{if(Terrasoft.getMouseButton(e)===Terrasoft.MouseButton.LEFT){var a=e.getPoint();if(this.checkSelectionRegion(a)){t.on("mousemove",this.onMouseMove,this),t.on("mouseup",this.onMouseUp,this);var s=this.innerSelection={},o=this.getDateByPoint(a);s.startDate=o;var l=this.getTimeScale();s.dueDate=Ext.Date.add(o,Ext.Date.MINUTE,l),this.floatingItemsCollection&&this.floatingItemsCollection.clear(),this.clearSelection(),this.selectionKeyPressSymbols="",this.renderSelection(s)}}else{this.innerSelection&&(t.un("mousemove",this.onMouseMove,this),t.un("mouseup",this.onMouseUp,this),this.innerSelection=null)}}},clearSelection:function(){var e=this.selectionEl;e&&(e.clearListeners(),e.destroy(),this.selectionEl=null)},checkSelectionRegion:function(e){return!!this.dayGridAreaEl.getRegion().contains(e)&&!this.timeColumnArea.getRegion().contains(e)},onMouseUp:function(){this.setSelection(this.innerSelection),this.innerSelection=null;var e=this.getWrapEl();e.un("mousemove",this.onMouseMove,this),e.un("mouseup",this.onMouseUp,this);var t=this.selectionEl;t.focus(),t.on("keypress",this.onSelectionKeyPress,this)},onMouseMove:function(e){var t=e.getPoint();if(this.checkSelectionRegion(t)){var r=this.innerSelection,n=this.getDateByPoint(t),i=this.getTimeScale();r.dueDate=Terrasoft.addMinutes(n,i),this.renderSelection(r)}},getDateByPoint:function(e){var t=this.getTimeElByPoint(e),r=this.getDayElByPoint(e),n=new RegExp("-time-(\\d{1,2})-(\\d{1,2})$"),i=new RegExp("-day-(\\d{2})-(\\d{2})-(\\d{4})$"),a=n.exec(t.id),s=i.exec(r.id),o={hour:a[1],minute:a[2],day:s[1],month:s[2],year:s[3]};return o.month=o.month-1,new Date(o.year,o.month,o.day,o.hour,o.minute)},getDayElByPoint:function(e){return this.getChildElementByPoint(this.daysEl,e)},getTimeElByPoint:function(e){return this.getChildElementByPoint(this.dayTimesEl,e)},getChildElementByPoint:function(e,t){var r=e.select(">*"),n=null;return r.each((function(e){return!e.getRegion().contains(t)||(n=Ext.get(e),!1)}),this),n},renderSelection:function(e){if(this.rendered){var t=this.normalizeSelection(e);if(t){var r=Terrasoft.Resources.CultureSettings,n=t.startDate,i=t.dueDate;Terrasoft.isMidnight(i)&&(i=Terrasoft.addMinutes(i,-1));var a=this.id,s=this.getDayColumnId(a,n),o=this.getDayColumnId(a,i),l=Ext.get(s);if(s===o){var c=this.timeItemHeight,u=this.getTimePosition(n)+.1,h=this.getTimeItemCount(n,i)*c-.1,f=Ext.Date.format(n,r.timeFormat)+"-"+Ext.Date.format(i,r.timeFormat);if(this.selectionEl)this.selectionEl.setStyle({top:u+"em",height:h+"em"}),this.selectionEl.child("label").setHTML(f);else this.selectionEl=l.createChild({tag:"div",id:this.id+"-selection",cls:"schedule-edit-selection ts-box-sizing",style:{top:u+"em",height:h+"em"},tabindex:0,children:[{tag:"label",html:f}]})}}}},normalizeSelection:function(e){if(!e)return null;var t=Ext.Date.clone(e.startDate),r=Ext.Date.clone(e.dueDate);if(t>=r){t=Ext.Date.clone(r);var n=this.getTimeScale();t=Terrasoft.addMinutes(t,-1*n),r=Ext.Date.clone(e.startDate),r=Terrasoft.addMinutes(r,n)}return{startDate:t,dueDate:r}},getSelection:function(){return this.normalizeSelection(this.selection)},setSelection:function(e){(e=Terrasoft.deepClone(e))&&e.dueDate&&(Terrasoft.isMidnight(e.dueDate)&&(e.dueDate=Terrasoft.addMinutes(e.dueDate,-1)),e.dueDate.setDate(e.startDate.getDate()));var t=this.normalizeSelection(e),r=Terrasoft.deepClone(t);Ext.Object.equals(this.selection,r)||(this.selection=r,this.fireEvent("selectionChanged",this,Terrasoft.deepClone(r)),this.renderSelection(this.selection))},setDayImageVisibility:function(e){this.isDayImageVisible=e,Ext.select('div[class*="schedule-edit-day-image"]').setStyle({display:e?"block":"none"})},updateTimeMarker:function(){var e=new Date(Ext.Date.now());if(this.timeMarkerEl){var t=e.getHours();if(t>=this.startHour&&t<this.dueHour){var r=this.getTimePosition(e,!0);this.timeMarkerEl.setTop(r+"em")}}},setSelectedDays:function(e){if(e=e||[],!Ext.Array.equals(this.selectedDays,e)){var t=this.dayImageConfig.selectedDayImageClass;Ext.select('div[class*="schedule-edit-selected-day-image"]').removeCls(t);for(var r=0,n=e.length;r<n;r++)this.selectDay(e[r],!0);this.selectedDays=e,this.fireEvent("selectedDaysChanged")}},selectDay:function(e,t){var r=this.dayImageConfig.selectedDayImageClass,n=this.getDayImageElement(e);n&&(t?Ext.get(n).addCls(r):Ext.get(n).removeCls(r))},getDayImageElement:function(e){var t=Ext.select('div[day-image-date="'+e+'"]');return t.elements.length?t.elements[0]:null},getTimeItemCount:function(e,t){var r=Terrasoft.DateRate.MINUTES_IN_HOUR,n=this.getTimeScale(),i=Math.floor(this._differenceMinutes(t,e)),a=0===e.getMinutes()?r:e.getMinutes(),s=(0===t.getMinutes()?r:t.getMinutes())%n>0||a%n>0?1:0,o=Math.floor(i/n)+s;return 0===o?1:o},_differenceMinutes:function(e,t){var r=Math.abs(t.getTimezoneOffset()-e.getTimezoneOffset()),n=Math.abs(t-e)/1e3/60-r;return Math.max(n,0)},destroyScheduleFloatingItems:function(){var e=this.scheduleFloatingItems;e.clear(),e.un("dataLoaded",this.onScheduleFloatingItemsDataLoaded,this),e.un("add",this.onScheduleFloatingItemAdd,this),e.un("remove",this.onScheduleFloatingItemRemove,this),e.un("clear",this.onScheduleFloatingItemsClear,this),e.destroy(),this.scheduleFloatingItems=null},onDestroy:function(){this.clear(),this.destroyScheduleFloatingItems();var e=this.getWrapEl();e&&e.un("click",this.unSelectItems,this),Ext.EventManager.un(window,"resize",this.prepareScrollArea,this),this._destroyScrollListeners(),this.clearTimeMarkerUpdateTimer(),this.callParent(arguments)},_destroyScrollListeners:function(){var e=this.scrollEl;e&&(Ext.dd.ScrollManager.unregister(e),Ext.isIE||e.un("scroll",this.onScroll,this),e.un("scroll",this.saveScrollPosition,this))},onScroll:function(){var e=this.itemDDEl;if(e){var t=e.item,r=e.action;if(t){var n=t.config.item;switch(r){case Terrasoft.DDAction.MOVE:n.initScheduleItemDDTicksOnMove(t);break;case Terrasoft.DDAction.RESIZE_TOP:n.initScheduleItemDDTicksOnResizeTop(t);break;case Terrasoft.DDAction.RESIZE_BOTTOM:n.initScheduleItemDDTicksOnResizeBottom(t);break;case Terrasoft.DDAction.RESIZE_LEFT:case Terrasoft.DDAction.RESIZE_RIGHT:n.initScheduleItemDDTicksOnHorizontalResize(t,r)}}}},initDd:function(){var e=this.scrollEl;e&&Ext.dd.ScrollManager.register(e),Ext.dd.DragDropManager.notifyOccluded=!0,this.clearTimes();var t=this.daysEl;if(t){var r=this.dayTimesEl;Ext.select("[class*='column']",!1,t.dom).each((function(e){var t=e.initDDTarget("day",{},this.ddDayOverride);t.addToGroup("day-item"),t.addToGroup("multi-day-item")}),this),Ext.select("[class*='row']",!1,r.dom).each((function(e){var t=e.initDDTarget("time",{},this.ddDayOverride);t.setPadding(5,5,5,5),t.addToGroup("time-item"),t.addToGroup("multi-day-item")}),this),Ext.select(".multi-day-item-area",!1).first().initDDTarget("multiDay",{},this.ddDayOverride).addToGroup("multi-day-item")}},clearTimes:function(){var e=Ext.dd.DragDropManager.ids;e.day&&(e.day=null),e["day-item"]&&(e["day-item"]=null),e.time&&(e.time=null),e["time-item"]&&(e["time-item"]=null),e["multi-day-item"]&&(e["multi-day-item"]=null),e["item-resize-left"]&&(e["item-resize-left"]=null),e["item-resize-right"]&&(e["item-resize-right"]=null),e["item-resize-bottom"]&&(e["item-resize-bottom"]=null),e["item-resize-top"]&&(e["item-resize-top"]=null)},updateSelectors:function(){this.updateSelector("wrap","scheduler"),this.updateSelector("scroll","scroll-area"),this.updateSelector("timeMarker","time-marker")},updateSelector:function(e,t){this.selectors||(this.selectors={}),this.selectors[e+"El"]="#"+this.id+"-"+t},getTplData:function(){var e=this.callParent(arguments),t=this.selectedDays||[],r=this.schedulerConfig,n=r.classes,i=r.styles,a=this.timeScale;i.timeGridStyle.height=this.getTimeGridHeight(a)+"em";var s=this.timezone,o=this.getTimezoneAreaWidth(s);i.timezoneTitleAreaStyle.width=Number(o)+"em",i.dayTitleAreaStyle[this._paddingDirection]=o+"em",i.dayColumnAreaStyle[this._paddingDirection]=o+"em";var l=this.getSchedulerDayList(),c=l.length,u=this.getDayItemWidth(c);return i.dayItemWidthStyle.width=u+"%",e.schedulerAreaClass=n.schedulerAreaClass,e.titleAreaClass=n.titleAreaClass,e.multiDayItemAreaClass=n.multiDayItemAreaClass,e.gridAreaClass=n.gridAreaClass,e.timezoneTitleAreaClass=n.timezoneTitleAreaClass,e.dayTitleAreaClass=n.dayTitleAreaClass,e.timeColumnAreaClass=n.timeColumnAreaClass,e.dayGridAreaClass=n.dayGridAreaClass,e.dayColumnAreaClass=n.dayColumnAreaClass,e.dayRowAreaClass=n.dayRowAreaClass,e.dayTitleClass=n.dayTitleClass,e.timezoneTitleClass=n.timezoneTitleClass,e.dayColumnClass=n.dayColumnClass,e.timeColumnClass=n.timeColumnClass,e.scrollAreaClass=n.scrollAreaClass,e.multiDayItemAreaStyle=i.multiDayItemAreaStyle,e.timeGridStyle=i.timeGridStyle,e.timezoneTitleAreaStyle=i.timezoneTitleAreaStyle,e.dayTitleAreaStyle=i.dayTitleAreaStyle,e.dayColumnAreaStyle=i.dayColumnAreaStyle,e.dayItemWidthStyle=i.dayItemWidthStyle,e.gridScrollStyle=i.gridScrollStyle,e.titleAreaStyle=i.titleAreaStyle,e.prepareDayTitle=function(e,r){for(var n=r.self,i=n.getSchedulerDayList(),a=r.dayTitleClass,s=r.dayItemWidthStyle.width,o=0;o<i.length;o++){for(var l=i[o],c=n.getDayTitle(l),u=!1,h=0,f=t.length;h<f;h++){var d=t[h];if(Ext.Date.isEqual(d,l)){u=!0;break}}var p=n.getTitleImage(l,u),m=0;n.getIsDayToday(l)?m=1:n.getIsDayOff(l)&&(m=2),e.push("<div style='width: "+s+"' class='"+a[m]+"'>"+c+p+"</div>")}},e.prepareTimezoneTitle=function(e,t){for(var r,n=t.self.timezone,i=n.length,a=t.timezoneTitleClass,s=i-1;s>=0;s--)r=n[s].timezoneTitle,s>0?e.push("<div class='"+a[2]+"'>"+r+"</div>"):e.push("<div class='"+(i>1?a[0]:a[1])+"'>"+(i>1?r:"")+"</div>")},e.prepareTimeColumn=function(e,t){for(var r=t.self,n="minutes"+r.timeScale,i=r.schedulerConfig,a=i.timezoneHourTpl,s=i.mainTimezoneHourTpl,o=a[n],l=s[n],c=r.timezone.length,u=t.timeColumnClass,h=c-1;h>=0;h--){e.push("<div class='"+(h>0?u[1]:u[0])+"'>");for(var f=r.startHour;f<r.dueHour;f++){var d=h>0?o:l;d=d.replace("{hourNumber}",f),e.push(d)}e.push("</div>")}},e.prepareDayColumn=function(e,t){for(var r=t.self,n=r.getSchedulerDayList(),i=t.dayColumnClass,a=t.dayItemWidthStyle.width,s=0;s<n.length;s++){var o=n[s],l=0;r.getIsDayOff(o)&&(l=1);var c=r.getDayColumnId(t.id,o);e.push("<div id='"+c+"' style='width:"+a+"' class='"+i[l]+"'>"),e.push("</div>")}},e.prepareDayRow=function(e,t){for(var r=t.self,n="minutes"+r.timeScale,i=r.schedulerConfig.dayHourTpl[n],a=r.startHour;a<r.dueHour;a++){var s=t.id+"-time-"+a,o=new RegExp("{hourId}","ig"),l=i.replace(o,s);e.push(l)}},this.updateSelectors(),e},getBindConfig:function(){var e=this.callParent(arguments),t={activityCollection:{changeMethod:"onCollectionDataLoaded"},period:{changeMethod:"onPeriodChange"},timeScale:{changeMethod:"onTimeScaleChange"},selectedItems:{changeEvent:"changeSelectedItems",changeMethod:"setSelectedItems"},selectedDays:{changeEvent:"selectedDaysChanged",changeMethod:"setSelectedDays"},selection:{changeEvent:"selectionChanged",changeMethod:"setSelection"},floatingItemsCollection:{changeMethod:"onFloatingItemsCollectionDataLoaded"},selectionKeyPressSymbols:{changeEvent:"selectionKeyPressSymbolsUpdate"},isDayImageVisible:{changeMethod:"setDayImageVisibility"}};return Ext.apply(t,e),t},onPeriodChange:function(e){this.setPeriod(e.startDate,e.dueDate)},onTimeScaleChange:function(e){this.setTimeScale(e),this.clearTimeMarkerUpdateTimer(),this.initTimeMarkerUpdateTimer()},onCollectionDataLoaded:function(e){Terrasoft.each(this.collection,(function(e){e.destroy()})),this.collection=[],this.activityCollection=e,this.activityCollection.eachKey((function(e,t,r){this.onAddItem(t,r,e,!0)}),this),this.rendered&&this.reRender()},onFloatingItemsCollectionDataLoaded:function(e){this.floatingItemsCollection=e;var t=Ext.create("Terrasoft.Collection");e.each((function(e){var r=this.createScheduleFloatingItem(e);t.add(r)}),this),this.scheduleFloatingItems.loadAll(t)},onAddItem:function(e,t,r,n){var i=this,a=e.values.StartDate,s=e.values.DueDate,o=!Terrasoft.areDatesEqual(a,s),l=a.getHours(),c=s.getMinutes()>0?s.getHours()+1:s.getHours();if(!((l<this.startHour||l>this.dueHour||c<this.startHour||c>this.dueHour)&&!o||a>s)){var u=Terrasoft.deepClone(this.itemBindingConfig);u.scheduler=this;var h=Ext.create("Terrasoft.ScheduleItem",u);h.setViewModelCollectionItemId(r),h.bind(e),h.on("canExecute",(function(e){return i.fireEvent("canExecute",e)})),this.collection.push(h),!0!==n&&(this.itemPositionProcess([h.getStartDate()]),this.multiDayItemPositionProcess())}},getItemIntersectViewInterval:function(e){var t=this.startDate,r=this.dueDate,n=e.getStartDate(),i=e.getDueDate();e.isMultiDayItem()&&0===i.getHours()&&0===i.getMinutes()&&0===i.getSeconds()&&(i=Terrasoft.addDays(i,-1));var a=Terrasoft.areDatesEqual(n,r)||n<=r&&n>=t,s=Terrasoft.areDatesEqual(i,r)||i<=r&&i>=t;return a||s||n<t&&i>r},getMultiDayItemSortedArray:function(){var e=[];Terrasoft.each(this.collection,(function(t){t.isMultiDayItem()&&e.push(t)}));for(var t,r,n,i,a=e.sort((function(e,t){var r=e.dueDate-e.startDate,n=t.dueDate-t.startDate;return e.startDate===t.startDate&&r===n?0:e.startDate>t.startDate?1:e.startDate<t.startDate||r>n?-1:r<n?1:0})),s=[],o=0,l=a.length;o<l;o++)if(t=a[o],this.getItemIntersectViewInterval(t)){for(var c=0,u=s.length;c<u;c++)if(r=(n=s[c])[n.length-1],i=t.startDate,r.dueDate<=i){n.push(t);break}s[c]||(n=s[c]=[]).push(t)}return s},multiDayItemPositionProcess:function(){var e=this.getMultiDayItemSortedArray(),t=e.length;if(this.rendered&&!(t<=0)){var r,n=this.multiDayItemArea,i=this.collection[0].multiDayItemHeight,a=Terrasoft.MultiDayItemAreaLayoutSizes;n.setHeight(i*t+a.MULTI_DAY_ITEM_PADDING_TOP+a.MULTI_DAY_ITEM_PADDING_BOTTOM+a.BORDER_HEIGHT*(t-1));for(var s=0;s<t;s++)for(var o=e[s],l=0,c=o.length;l<c;l++){var u=o[l],h=u.multiDayItemHeight;u.setWidth(this.getMultiDayItemWidth(u)),r=h*s+a.MULTI_DAY_ITEM_PADDING_TOP+s*a.BORDER_HEIGHT,u.setTop(r),u.setLeft(this.getMultiDayItemLeft(u)),u.show()}this.prepareScrollArea()}},getMultiDayItemWidth:function(e){var t=e.getStartDate(),r=e.getDueDate(),n=this.getStartDate(),i=Terrasoft.addDays(this.getDueDate(),1);i=Terrasoft.clearTime(i);var a=new Date(n>t?n:t),s=Ext.select("div[id*='"+e.getDayColumnId(a)+"']").first().getBox(),o=new Date(i<r?i:r);o=this._getRealDueDate(o);var l=Ext.select("div[id*='"+e.getDayColumnId(o)+"']").first().getBox();return Terrasoft.getIsRtlMode()?s.right-l.left:l.right-s.left},getMultiDayItemLeft:function(e){var t=this.multiDayItemArea.getBox();return(Terrasoft.getIsRtlMode()?this._getDueDateElBox(e):this._getStartDateElBox(e)).left-t.left+Terrasoft.MultiDayItemAreaLayoutSizes.BORDER_WIDTH},_getDueDateElBox:function(e){var t=e.getDueDate(),r=this.getDueDate(),n=r<t?r:this._getRealDueDate(t);return e.getElBoxByDate(n)},_getStartDateElBox:function(e){var t=e.getStartDate(),r=this.getStartDate(),n=r>t?r:t;return e.getElBoxByDate(n)},_getRealDueDate:function(e){return e.getHours()+e.getMinutes()+e.getSeconds()===0&&(e=Terrasoft.addDays(e,-1)),e},onDeleteItem:function(e,t){var r,n=this.collection;for(r=0;r<n.length;r++)if(t===n[r].getViewModelCollectionItemId()){var i=n[r].getStartDate();n[r].destroy(),n.splice(r,1),this.itemPositionProcess([i]),this.multiDayItemPositionProcess()}var a=this.selectedItems;for(r=0;r<a.length;r++)t===a[r]&&(a.splice(r,1),this.fireEvent("changeSelectedItems"))},clear:function(){for(var e=this.collection,t=0;t<e.length;t++)e[t].destroy();this.collection=[]},subscribeForCollectionEvents:function(e,t,r){this.callParent(arguments);var n=r.get(e.modelItem);switch(t){case"activityCollection":n.on("add",this.onAddItem,this),n.on("remove",this.onDeleteItem,this),n.on("clear",this.clear,this);break;case"floatingItemsCollection":n.on("add",this.onAddFloatingItem,this),n.on("remove",this.onDeleteFloatingItem,this),n.on("clear",this.onClearFloatingItems,this)}},unSubscribeForCollectionEvents:function(e,t,r){this.callParent(arguments);var n=r.get(e.modelItem);switch(t){case"activityCollection":n.un("add",this.onAddItem,this),n.un("remove",this.onDeleteItem,this),n.un("clear",this.clear,this);break;case"floatingItemsCollection":n.un("add",this.onAddFloatingItem,this),n.un("remove",this.onDeleteFloatingItem,this),n.un("clear",this.onClearFloatingItems,this)}},createScheduleFloatingItem:function(e){var t=Terrasoft.deepClone(this.floatingItemBindingConfig)||{};t.scheduleEdit=this;var r=Ext.create("Terrasoft.ScheduleFloatingItem",t);return r.on("ready",this.onFloatingItemReady,this),r.bind(e),r},onFloatingItemReady:function(){var e={renderToItem:arguments[0],renderTo:arguments[1]};this.keyMap=this.createEscKeyMap(),this.fireEvent("floatingItemReady",e)},onAddFloatingItem:function(e){var t=this.createScheduleFloatingItem(e);this.scheduleFloatingItems.add(t)},onDeleteFloatingItem:function(e){var t=this.scheduleFloatingItems;t.each((function(r){r.model.instanceId===e.instanceId&&t.remove(r)}))},onClearFloatingItems:function(){var e=this.scheduleFloatingItems;e.each((function(t){e.remove(t)}))},onAfterRender:function(){this.callParent(arguments),this.prepareScrollArea(!0),this.initDd(),this.renderSchedulerItems();var e=this.getWrapEl();e.unselectable(),this.updateTimeMarker()},onAfterReRender:function(){this.callParent(arguments),this.prepareScrollArea(!0),this.initDd(),this.renderSchedulerItems();var e=this.getWrapEl();e.unselectable(),this.updateTimeMarker()},getStartDate:function(){return this.startDate},getDueDate:function(){return this.dueDate},getTimeScale:function(){return this.timeScale},getSelectedItems:function(){for(var e=this.collection,t=[],r=0,n=e.length;r<n;r++)e[r].getIsSelected()&&t.push(e[r].viewModelCollectionItemId);return this.selectedItems=t,t},setSelectedItems:function(e){Ext.isArray(e)&&!Ext.Array.equals(e,this.selectedItems)&&(e=Ext.Array.clone(e),Terrasoft.each(this.collection,(function(t){var r=Terrasoft.contains(e,t.viewModelCollectionItemId);t.isSelected?r||t.setNotSelected(!0):r&&t.setSelected(null,!0)})),this.selectedItems=e,this.fireEvent("changeSelectedItems"))},setPeriod:function(e,t){if(!e)throw new Terrasoft.NullOrEmptyException({message:Terrasoft.Resources.Controls.ScheduleEdit.IsNullStartDateParameter});if(!t)throw new Terrasoft.NullOrEmptyException({message:Terrasoft.Resources.Controls.ScheduleEdit.IsNullEndDateParameter});if(Ext.Date.clearTime(t)-Ext.Date.clearTime(e)<0)throw new Terrasoft.NullOrEmptyException({message:Terrasoft.Resources.Controls.ScheduleEdit.DaysCountShouldBeGreaterThenZero});this.startDate===e&&this.dueDate===t||(this.startDate=e,this.dueDate=t,this.safeRerender())},setTimeScale:function(e){if(!e)throw new Terrasoft.NullOrEmptyException({message:Terrasoft.Resources.Controls.ScheduleEdit.IsNullTimeScaleParameter});this.timeScale!==e&&(this.timeScale=e,this.safeRerender())},onEscKeyPressed:function(){this.floatingItemsCollection&&this.floatingItemsCollection.clear()},createEscKeyMap:function(){return new Ext.util.KeyMap(Ext.getBody(),[{key:Ext.EventObject.ESC,defaultEventAction:"preventDefault",scope:this,fn:this.onEscKeyPressed}])},destroyKeyMap:function(){this.keyMap&&(this.keyMap.destroy(),this.keyMap=null)}}),Ext.define("Terrasoft.controls.Label",{extend:"Terrasoft.controls.Component",alternateClassName:"Terrasoft.Label",tpl:['<label {inputId} id = {id} class = "{labelClass}" style = "{labelStyle}" title="{hint}"','<tpl if="direction">dir="{direction}"</tpl>>{caption}',"</label>"],noWordWrapClass:"t-label-nowordwrap",isMultiline:!1,labelClass:"t-label",requiredClass:"t-label-is-required",caption:"",highlightText:"",highlightTag:"b",width:"",font:"",wordWrap:!0,inputId:"",isRequired:!1,disabledClass:"t-label-disabled",init:function(){this.callParent(arguments),this.addEvents("click"),this.updateDirection(this.caption)},getTplData:function(){var e=this.callParent(arguments),t={labelClass:this.getLabelClass(),caption:this.getInnerHtml()},r=this.inputId;return t.inputId=r?'for = "'+Terrasoft.encodeHtml(r)+'"':"",Ext.apply(t,e,{}),this.styles=Ext.Object.merge(this.styles||{},this.getStyles()),this.selectors=this.getSelectors(),t},getBindConfig:function(){var e=this.callParent(arguments),t={caption:{changeMethod:"setCaption"},isRequired:{changeMethod:"setRequired"},highlightText:{changeMethod:"setHighlightText"}};return Ext.apply(t,e),t},getLabelClass:function(){var e=[];return e.push(this.labelClass),!1===this.wordWrap&&e.push(this.noWordWrapClass),!0===this.isRequired&&e.push(this.requiredClass),!1===this.enabled&&e.push(this.disabledClass),e.join(" ")},getInnerHtml:function(){var e=Terrasoft.encodeHtml(this.caption);this.isMultiline&&(e=e.replace(/\n/g,"<br />"));var t=this.highlightText,r=this.highlightTag;if(!r||!t||!this.caption)return e;if(Ext.isString(t)){var n=Ext.String.format("<{0}>{1}</{0}>",r,t);return e.split(t).join(n)}return Terrasoft.each(t,(function(t){var n=Ext.String.format("<{0}>{1}</{0}>",r,t);e=e.split(t).join(n)})),e},getStyles:function(){var e={labelStyle:{}},t=e.labelStyle,r=this.font,n=this.width;return r&&(t.font=r),n&&(t.width=n),e},getSelectors:function(){return{wrapEl:"#"+this.id,el:"#"+this.id}},setWordWrap:function(e){this.wordWrap!==e&&(this.wordWrap=e,this.safeRerender())},initDomEvents:function(){this.callParent(arguments);var e=this.getWrapEl();e.on("click",this.onClick,this)},onClick:function(e){if(this.enabled){var t=this.canExecute({method:this.onClick,args:arguments}),r=e.browserEvent,n=t&&this.fireEvent("click",this);!1===n&&Ext.EventManager.stopEvent(r)}},setWidth:function(e){this.width!==e&&(this.width=e,this.safeRerender())},setCaption:function(e){if(this.caption!==e){this.caption=Ext.isObject(e)?e.displayValue:e,this.updateDirection(this.caption);var t=this.getWrapEl();t&&t.dom&&this.safeRerender()}},setRequired:function(e){if(this.isRequired!==e&&(this.isRequired=e,this.rendered)){var t=this.getWrapEl();e?t.addCls(this.requiredClass):t.removeCls(this.requiredClass)}},setHighlightText:function(e){if(!this.isEqualHighlightText(e)){this.highlightText=e;var t=this.getWrapEl();t&&t.dom&&(t.dom.innerHTML=this.getInnerHtml())}},isEqualHighlightText:function(e){return Ext.isArray(e)&&Ext.Array.equals(this.highlightText,e),this.highlightText===e},setFont:function(e){this.font!==e&&(this.font=e,this.safeRerender())},setInputId:function(e){this.inputId!==e&&(this.inputId=e,this.safeRerender())}}),Ext.define("Terrasoft.controls.TipLabel",{extend:"Terrasoft.Label",alternateClassName:"Terrasoft.TipLabel",tpl:['<div id="{id}-wrap" class="{wrapClass}">','<span id="{id}-tip-wrap" class="{tipWrapClass}">','<span id="{id}-tip" class="{tipClass}"></span>',"</span>",'<label id="{id}" class="{labelClass}">{caption}</label>',"</div>"],tipClass:"t-label-tip",tipWrapClass:"t-label-tip-wrap",wrapClass:"tip-label-wrap",getTplData:function(){var e=this.callParent(arguments),t={tipClass:[this.tipClass],wrapClass:[this.wrapClass],tipWrapClass:[this.tipWrapClass]};return Ext.apply(t,e,{}),t},getSelectors:function(){var e=this.id,t=this.callParent(arguments);return Ext.apply(t,{el:"#"+e,wrapEl:"#"+e+"-wrap",tipEl:"#"+e+"-tip"}),t},onClick:function(e){!1===this.fireEvent("click",this)&&e.stopEvent()},setCaption:function(e){this.caption!==e&&(this.caption=e,this.safeRerender())},addWrapAttr:function(){var e=this.markerValue;if(!Ext.isEmpty(e)){e=Terrasoft.encodeHtml(e);var t=this.el;t&&t.dom.setAttribute("data-item-marker",e);var r=this.tipEl;r&&r.dom.setAttribute("data-tip-marker",e)}},setRequired:function(e){this.callParent(arguments),this.rendered&&this.el&&(e?this.el.addCls(this.requiredClass):this.el.removeCls(this.requiredClass))}}),Ext.ns("Terrasoft.controls.HyperlinkEnums"),Terrasoft.controls.HyperlinkEnums.target={BLANK:"_blank",SELF:"_self",PARENT:"_parent",TOP:"_top"},Ext.define("Terrasoft.controls.Hyperlink",{extend:"Terrasoft.Label",alternateClassName:"Terrasoft.Hyperlink",tpl:['<a id={id} name="{name}" href="{href}" ','target="{target}" class="{hyperlinkClass}" style="{hyperlinkStyle}" title="{hint}" type="{type}"','<tpl if="direction"> dir="{direction}"</tpl>>{caption}',"</a>"],hyperlinkClass:"label-link",name:"",href:"",target:"",type:"",init:function(){this.callParent(arguments),this.addEvents("linkMouseOver"),this.updateDirection(this.name)},initDomEvents:function(){this.callParent(arguments);var e=this.getWrapEl();e.on("mouseover",this.onLinkMouseOver,this)},onLinkMouseOver:function(e,t){this.fireEvent("linkmouseover",{targetId:this.getTargetId(t)})},getTargetId:function(e){return e.id||Ext.get(e).id},getTplData:function(){var e=this.callParent(arguments),t=Terrasoft.encodeHtml,r=Terrasoft.fixUrlInAngularHost(this.href),n={name:t(this.name),hint:t(this.hint),href:r,target:this.target||"_blank",type:this.type,hyperlinkClass:this.getHyperlinkClass(),hyperlinkStyle:this.getHyperlinkStyle()};return Ext.apply(e,n),e},getHyperlinkClass:function(){var e=[],t=this.getLabelClass();return e.push(this.hyperlinkClass),t+" "+e.join(" ")},onClick:function(e){var t=this.canExecute({method:this.onClick,args:arguments});if(!1!==t){var r=e.browserEvent;!1===this.fireEvent("click",this,e)&&Ext.EventManager.preventDefault(r)}},getHyperlinkStyle:function(){var e={},t=this.font,r=this.width;return t&&(e.font=t),r&&(e.width=r),e},clearDomListeners:function(){this.callParent(arguments);var e=this.getWrapEl();e&&(e.un("click",this.onClick,this),e.un("mouseover",this.onLinkMouseOver,this))},getBindConfig:function(){var e=this.callParent(arguments),t={name:{changeMethod:"setName"},href:{changeMethod:"setHref"},target:{changeMethod:"setTarget"},type:{changeMethod:"setType"}};return Ext.apply(t,e),t},setName:function(e){this.name!==e&&(this.name=e,this.updateDirection(this.name),this.safeRerender())},setHref:function(e){this.href!==e&&(this.href=Ext.isObject(e)?e.url:e,this.safeRerender())},setTarget:function(e){this.target!==e&&(this.target=e,this.safeRerender())},setType:function(e){this.type===e||Ext.isEmpty(this.href)||(this.type=e,this.safeRerender())},setAttributes:function(e){e&&(e.name&&(this.name=e.name),e.href&&(this.href=e.href),e.target&&(this.target=e.target),e.type&&(this.type=e.type),this.safeRerender())}}),Ext.define("Terrasoft.controls.BaseMenuItem",{extend:"Terrasoft.Component",alternateClassName:"Terrasoft.BaseMenuItem",mixins:{fileUpload:"Terrasoft.FileUpload"},progressSpinner:null,fileUpload:!1,fileTypeFilter:[],fileUploadMultiSelect:!1,filesSelected:Ext.emptyFn,parentMenu:null,isInteractive:!0,selectedClass:"menu-item-selected",disabledClass:"menu-item-disabled",baseMenuItemImageClass:"menu-item-image",baseMenuItemArrowClass:"menu-item-arrow",baseMenuItemMarkerClass:"menu-marker",baseMenuItemClass:"menu-item",tpl:['<li id="{id}" class="{itemClass}" style="{itemStyle}"<tpl if="tag"> data-tag="{tag}"</tpl><tpl if="direction"> dir="{direction}"</tpl>>','<tpl if="hasImage">','<span id="{imageId}" class="{imageClass}" style="{imageStyle}"></span>',"</tpl>","{caption}",'<tpl if="showProgress">',"{%this.renderLoadingProgress(out, values)%}","</tpl>",'<tpl if="showArrow && !showProgress">','\t<span id="{arrowId}" class="{arrowClass}" style="{arrowStyle}">','<span class="{markerClass}"></span>',"</span>","</tpl>","</li>"],caption:"",imageConfig:null,renderLoadingProgress:function(e,t){var r=t.self.getProgressSpinner().generateHtml();Ext.DomHelper.generateMarkup(r,e)},getProgressSpinner:function(){return Ext.isEmpty(this.progressSpinner)&&(this.progressSpinner=Terrasoft.getSpinner("menu-item-progress")),this.progressSpinner},onMouseOver:function(){this.enabled&&(this.applyMenuSelection(),this.isInteractive&&this.parentMenu.setSelectedItem(this))},onMouseOut:function(){var e=this.menu;if(null!=e){if(e.allowRerender())return;this.applyMenuDeselection()}else this.isInteractive&&this.applyMenuDeselection()},init:function(){this.callParent(),this.addEvents("click"),this.fileUpload&&this.mixins.fileUpload.constructor.call(this),this.on("click",this.onItemClick,this)},updateSelectors:function(e){var t=this.selectors;return t||(t=this.selectors={}),e.hasImage?t.imageEl="#"+this.id+"-menu-item-image":delete t.imageEl,e.showArrow&&!e.showProgress?t.arrowEl="#"+this.id+"-menu-item-arrow":delete t.arrowEl,t.wrapEl="#"+this.id,t.el=t.wrapEl,t},prepareTplDataStylesAndClasses:function(e){e.itemClass=[this.baseMenuItemClass],e.itemStyle=[],e.imageClass=[this.baseMenuItemImageClass],e.imageStyle=[],e.arrowClass=[this.baseMenuItemArrowClass],e.arrowStyle=[],e.markerClass=this.baseMenuItemMarkerClass;var t=this.disabledClass;!this.enabled&&t&&e.itemClass.push(t);var r=this.imageConfig;if(r){var n=Terrasoft.ImageUrlBuilder.getUrl(r);e.imageStyle.push("background-image: url("+n+");")}},getTplData:function(){var e=this.callParent(arguments);e.renderLoadingProgress=this.renderLoadingProgress,e.imageId=this.id+"-menu-item-image",e.arrowId=this.id+"-menu-item-arrow",e.tag=this.tag,e.showProgress=!1,e.showArrow=!1,e.caption=Terrasoft.encodeHtml(this.caption),e.direction=Terrasoft.getTextDirection(e.caption);var t=this.imageConfig;return e.hasImage=!!t,this.prepareTplDataStylesAndClasses(e),e.itemClass=e.itemClass.join(" "),e.itemStyle=e.itemStyle.join(" "),e.imageClass=e.imageClass.join(" "),e.imageStyle=e.imageStyle.join(" "),e.arrowClass=e.arrowClass.join(" "),e.arrowStyle=e.arrowStyle.join(" "),this.updateSelectors(e),this.tplData=e,e},initDomEvents:function(){this.callParent(arguments);var e=this.getWrapEl();e.on({click:{fn:this.onClick,scope:this},mouseover:{fn:this.onMouseOver,scope:this},mouseout:{fn:this.onMouseOut,scope:this}})},onClick:function(e){if(this.enabled){e.stopPropagation();var t=this.canExecute({method:this.onClick,args:arguments});!1!==t&&this.fireEvent("click",this)}},onItemClick:function(){var e=this.parentMenu;(e.focusMenuTree(),this.menu)||e.getRootMenu().hide();this.isInteractive&&this.process()},process:function(){this.applyMenuSelection(),this.parentMenu.setSelectedItem(this)},applyMenuSelection:function(){var e=this.selectedClass;e&&this.getWrapEl().addCls(e)},applyMenuDeselection:function(){this.getWrapEl().removeCls(this.selectedClass)},getIndex:function(){var e=this.parentMenu;return e?e.items.indexOf(this):null},onDestroy:function(){var e=this.progressSpinner;e&&e.destroy(),this.fileUpload&&this.mixins.fileUpload.destroy.call(this),delete this.parentMenu,this.callParent(arguments)},getBindConfig:function(){var e=this.callParent(arguments),t={caption:{changeMethod:"setCaption"}};return Ext.apply(t,e),t},setCaption:function(e){this.caption!==e&&(this.caption=e,this.rendered&&this.reRender())},onHideMenu:function(){this.rendered=!1},added:function(){this.parentMenu.on("hide",this.onHideMenu,this)},onAfterRender:function(){this.callParent(arguments),this.fileUpload&&this.mixins.fileUpload.addInputFile.call(this),Ext.isEmpty(this.progressSpinner)||this.progressSpinner.show()},onAfterReRender:function(){this.callParent(arguments),this.fileUpload&&this.mixins.fileUpload.addInputFile.call(this),Ext.isEmpty(this.progressSpinner)||this.progressSpinner.show()}}),Ext.define("Terrasoft.controls.MenuSeparator",{extend:"Terrasoft.BaseMenuItem",alternateClassName:"Terrasoft.MenuSeparator",tpl:['<li id="{id}-menu-separator" class="menu-separator <tpl if="isFirst">menu-separator-first</tpl>">','<tpl if="image">','<span id="{id}-menu-separator-image" ','class="<tpl if="isFirst">menu-separator-first-image<tpl else>menu-separator-image</tpl>"','\tstyle="background-image: url({image});"></span>',"</tpl>",'<tpl if="isFirst">',"{caption}",'<tpl elseif="caption">','<div id="{id}-menu-separator-header" class="menu-separator-header">{caption}</div>',"<tpl else>",'<div id="{id}-menu-separator-header" class="menu-separator-header menu-separator-no-caption"></div>',"</tpl>","</li>"],isInteractive:!1,selectedClass:null,getTplData:function(){var e=this.callParent(arguments);e.isFirst=0===this.getIndex();var t=this.caption||"";e.caption=Terrasoft.encodeHtml(t.toUpperCase());var r=this.imageConfig;return r&&(e.image=Terrasoft.ImageUrlBuilder.getUrl(this.imageConfig)),this.updateSelectors(e),this.tplData=e,e},updateSelectors:function(e){var t=this.selectors;return t||(t=this.selectors={}),e.image?t.imageEl="#"+this.id+"-menu-separator-image":delete t.imageEl,e.isFirst?delete t.headerEl:t.headerEl="#"+this.id+"-menu-separator-header",t.wrapEl="#"+this.id+"-menu-separator",t.el=t.headerEl||t.wrapEl,t}}),Ext.define("Terrasoft.controls.MenuItem",{extend:"Terrasoft.BaseMenuItem",alternateClassName:"Terrasoft.MenuItem",menu:null,showProgress:!1,handler:null,onMouseOver:function(){this.callParent(arguments),this.menu&&this.enabled&&this.showMenu()},init:function(){this.callParent(arguments),this.initSubMenu();var e=this.menu;e&&e.on("afterrender",this.onSubMenuAfterRender,this)},initSubMenu:function(){var e=this.menu;e&&(e.isRootMenu=!1,this.parentMenu&&(e.rootMenu=this.parentMenu.getRootMenu()),e instanceof Terrasoft.Menu||(this.menu=Ext.create("Terrasoft.Menu",e)))},renderSubMenuLoading:function(){var e=this.menu;e&&e.isMenuLoading&&(this.showProgress=!0,this.reRender(null))},onSubMenuAfterRender:function(){this.rendered&&this.showProgress&&(this.showProgress=!1,this.reRender(null))},getTplData:function(){var e=this.callParent(arguments);return e.showProgress=this.showProgress,e.showArrow=this.menu&&!this.showProgress,this.updateSelectors(e),this.tplData=e,e},initDomEvents:function(){this.callParent(arguments);var e=this.getWrapEl();e.on({mouseover:{fn:this.onMouseOver,scope:this}})},onDestroy:function(){var e=this.menu;e&&(e.un("afterrender",this.onSubMenuAfterRender,this),e.destroy()),delete this.menu,this.callParent(arguments)},process:function(e){if(this.callParent(arguments),this.menu&&this.enabled)this.showMenu();else{var t=this.handler;t?t(this.parentMenu,this):e&&this.fireEvent("click",this)}},showMenu:function(){var e=this.wrapEl.getBox();e.x+=1,e.right-=1,e.width-=2,this.menu.show(e,!0),Ext.Function.defer(this.renderSubMenuLoading,300,this)},applyMenuDeselection:function(){this.callParent(arguments);var e=this.menu;e&&e.isMenuLoading&&(e.isMenuLoading=!1,this.showProgress=!1,this.reRender(null))},bind:function(){this.callParent(arguments);var e=this.menu;e&&e.bind(this.model)}}),Ext.define("Terrasoft.controls.RadioMenuItem",{extend:"Terrasoft.BaseMenuItem",alternateClassName:"Terrasoft.RadioMenuItem",mixins:{groupable:Terrasoft.Groupable},enabledClass:"menu-item-enabled",disabledClass:"menu-item-disabled",selectedClass:"menu-item-selected",radioGroupSelectedClass:"menu-radio-selected",selected:!1,groupName:"",init:function(){if(this.callParent(arguments),Ext.isEmpty(this.groupName))throw new Terrasoft.NullOrEmptyException({message:Terrasoft.Resources.Controls.RadioControlShouldHaveGroupName});this.mixins.groupable.constructor.call(this),this.selected&&this.setActive(!0),this.addEvents("selectedchanged"),this.on("selectedchanged",this.onSelectedChanged,this)},prepareTplDataStylesAndClasses:function(e){this.callParent(arguments),e.itemClass.push("menu-radio"),e.itemClass.push("menu-item-"+(this.enabled?"enabled":"disabled")),this.selected&&e.itemClass.push(this.radioGroupSelectedClass),e.hasImage=!0},onSelectedChanged:function(e){if(this.enabled&&this.rendered){var t=this.radioGroupSelectedClass;!0===e?this.wrapEl.addCls(t):this.wrapEl.removeCls(t)}},setActive:function(e){this.mixins.groupable.setActive.call(this,e),this.selected=e,this.fireEvent("selectedchanged",e,this)},setSelected:function(e){e!==this.selected&&this.setActive(e)},process:function(){this.callParent(arguments),this.setSelected(!this.selected)},setEnabled:function(e){if(this.enabled!==e){this.enabled=e;var t=this.disabledClass,r=this.enabledClass,n=this.getWrapEl();n&&(e?(n.removeCls(t),n.addCls(r)):(n.addCls(t),n.removeCls(r))),this.fireEvent("enabledchanged",e,this)}}}),Ext.define("Terrasoft.controls.CheckMenuItem",{extend:"Terrasoft.BaseMenuItem",alternateClassName:"Terrasoft.CheckMenuItem",checkedClass:"menu-check-item-checked",checked:!1,menu:null,init:function(){this.callParent(arguments),this.imageConfig=Terrasoft.CheckMenuItem.checkedImage,this.addEvents("checked","unchecked","checkedChanged"),this.on("checked",this.onChecked,this),this.on("unchecked",this.onUnchecked,this)},prepareTplDataStylesAndClasses:function(e){this.callParent(arguments),this.checked&&e.itemClass.push(this.checkedClass),e.hasImage=!0,e.imageConfig=this.checked},onChecked:function(){this.wrapEl.addCls(this.checkedClass)},onUnchecked:function(){this.wrapEl.removeCls(this.checkedClass)},setChecked:function(e){this.checked!==e&&(this.checked=e,this.fireEvent(e?"checked":"unchecked",this),this.fireEvent("checkedChanged",e,this))},process:function(){this.callParent(arguments),this.setChecked(!this.checked)}}),Ext.ns("Terrasoft.controls.ColorMenuItemConstants"),Terrasoft.controls.ColorMenuItemConstants.defaultColors=["#000000","#999999","#ffffff","#dfdfdf","#ef7e63","#c73920","#eba793","#7f2910","#8ecb60","#589928","#d1e9bd","#2c6018","#64b8df","#3a8bb1","#d4ebf6","#286581","#6483c3","#46639f","#d1dcf0","#2b467e","#5bc8c4","#4ca6a3","#bfe8e7","#327b78","#f8d162","#d3ae46","#fbe8b2","#a8882e","#fbad43","#cc8930","#fdd6a1","#a16a1f","#8e8eb7","#5e5684","#e1deed","#3c365b"],Ext.define("Terrasoft.controls.ColorMenuItem",{extend:"Terrasoft.controls.BaseMenuItem",alternateClassName:"Terrasoft.ColorMenuItem",value:"#000000",simpleMode:!0,wrapClass:"ts-menu-color-item",containerClass:"ts-menu-color-container",paletteClass:"ts-menu-color-palette",colorItemClass:"ts-menu-color-color",simpleModeColors:["#ffffff","#fff94f","#98ff49","#4afffa","#a3c2ff","#c69bff","#ff7f62","#ffc659","#d1d1d1"],colors:Terrasoft.controls.ColorMenuItemConstants.defaultColors,tpl:['<li id="{id}-menu-color-item" class="{wrapClass}" style="{wrapStyle}">','<div id="{id}-menu-color-item-container" class="{containerClass}">','<tpl if="simpleMode">',"{%this.generateColorPalette(values, out)%}","</tpl>",'<tpl if="!simpleMode">',"{%this.generateItemsGroupHtml(values, out)%}","</tpl>","</div>","</li>"],getTplData:function(){var e={id:this.id,tabIndex:this.tabIndex,generateColorItems:this.generateColorItems,simpleMode:this.simpleMode,containerClass:this.containerClass,paletteClass:this.paletteClass,colorItemClass:this.colorItemClass,simpleModeColors:this.simpleModeColors,colors:this.colors,generateItemsHtml:this.generateItemsHtml,generateItemsGroupHtml:this.generateItemsGroupHtml,generateColorPalette:this.generateColorPalette,self:this};return this.updateSelectors(),e.wrapClass=[this.wrapClass],Ext.apply(e,e)},generateColorPalette:function(e,t){for(var r=e.id,n=e.simpleModeColors,i="",a=1,s=n.length;a<=s;a+=1){var o=e.paletteClass,l=n[a-1];"#ffffff"===l&&(o+=" ts-menu-color-cell-IV-white ts-box-sizing"),i+=Terrasoft.getFormattedString('<div id="{0}-menu-color-item-palette-{1}" class="{2}" style="background-color:{3};"></div>',r,a,o,l)}t.push(i)},generateItemsGroupHtml:function(e,t){for(var r=e.self,n=r.colors,i=e.paletteClass,a="",s=1,o=n.length;s<o;s+=4){var l=r.getItemsHtml(s);a+=Terrasoft.getFormattedString('<div class="{0}">{1}</div>',i,l)}t.push(a)},getItemsHtml:function(e){for(var t="",r=["ts-menu-color-cell-I","ts-menu-color-cell-II","ts-menu-color-cell-III","ts-menu-color-cell-IV"],n=this.colors,i=this.id,a=0;a<4;a+=1){var s=e+a-1,o=[this.colorItemClass];o.push(r[a]),"#ffffff"===n[s]&&(o.push("ts-menu-color-cell-IV-white"),o.push("ts-box-sizing"));var l="background:"+n[s];t+=Terrasoft.getFormattedString('<div id="{0}-menu-color-item-color-{1}" class="{2}" style="{3}"></div>',i,e+a,o.join(" "),l)}return t},updateSelectors:function(){var e=this.selectors={};return e.wrapEl="#"+this.id+"-menu-color-item",e.containerEl="#"+this.id+"-menu-color-item-container",e.el=e.wrapEl,e},initDomEvents:function(){this.callParent(arguments),this.wrapEl.un("mouseover",this.onMouseOver,this),this.wrapEl.un("mouseout",this.onMouseOut,this);var e=this.containerEl;e.on("click",this.onColorItemClick,this),this.correctParentMenuStyles()},correctParentMenuStyles:function(){var e=this.parentMenu.wrapEl.dom.getAttribute("class");e+=" ts-menu-color",this.parentMenu.wrapEl.dom.setAttribute("class",e)},onColorItemClick:function(e){var t=e.target.id.split("-"),r=t[t.length-1];if(parseInt(r,10)){var n=this.simpleMode?this.simpleModeColors[r-1]:this.colors[r-1];this.value=n,this.fireEvent("colorselected",this,n)}}}),Ext.define("Terrasoft.controls.ColorPickerMenuItem",{extend:"Terrasoft.controls.BaseMenuItem",alternateClassName:"Terrasoft.ColorPickerMenuItem",defaultValue:"#ffffff",value:null,hueValue:0,saturationValue:1,brightnessValue:1,wrapClass:"ts-menu-color-picker-item",containerClass:"ts-menu-color-picker-container",colorPickerMainBlockClass:"ts-menu-color-picker-main-block",colorPickerBlockClass:"ts-menu-color-picker-block",colorPickerBlockCircleClass:"ts-menu-color-picker-block-circle",colorPickerLineClass:"ts-menu-color-picker-line",colorPickerHueLineClass:"ts-menu-color-picker-hue-line",colorPickerPreviewBlockClass:"ts-menu-color-picker-preview-block",colorPickerPreviewClass:"ts-menu-color-picker-preview",colorPickerHuePointerClass:"ts-menu-color-picker-hue-pointer",colorPickerValuesBlockClass:"ts-menu-color-picker-values-block",colorPickerHexBlockClass:"ts-menu-color-picker-hex-block",colorPickerRgbBlockClass:"ts-menu-color-picker-rgb-block",colorPickerCoverClass:"ts-menu-color-picker-cover",buttons:null,markerValue:"color-picker-menu-item",tpl:['<li id="{id}-menu-color-picker-item" class="{wrapClass}" style="{wrapStyle}"','<tpl if="markerValue">',' data-item-marker="{markerValue}"',"</tpl>",">",'<div id="{id}-menu-color-picker-cover" class="{colorPickerCoverClass}"></div>','<div id="{id}-menu-color-picker-container" class="{containerClass}">','<div id="{id}-menu-picker-buttons-container" class="ts-menu-color-picker-buttons">',"</div>",'<div id="{id}-menu-color-picker-main-block" class="{colorPickerMainBlockClass}">','<div id="{id}-menu-picker-block" class="{colorPickerBlockClass}">','<div id="{id}-menu-picker-block-circle" class="{colorPickerBlockCircleClass}"></div>',"</div>",'<div id="{id}-menu-picker-line" class="{colorPickerLineClass}">','<div id="{id}-menu-picker-hue-line" class="{colorPickerHueLineClass}">','<div id="{id}-menu-picker-hue-pointer" class="{colorPickerHuePointerClass}">',"</div>","</div>","</div>",'<div id="{id}-menu-picker-preview-block" class="{colorPickerPreviewBlockClass}">','<div id="{id}-menu-picker-preview" class="{colorPickerPreviewClass}">',"</div>",'<div id="{id}-menu-picker-values-block" class="{colorPickerValuesBlockClass}">','<div id="{id}-menu-picker-hex-block" class="{colorPickerHexBlockClass}">',"<label>","HEX","</label>",'<input id="{id}-menu-picker-hex-field" maxlength="7" spellcheck="false"/>',"</div>",'<div id="{id}-menu-picker-rgb-block" class="{colorPickerRgbBlockClass}">',"<div>","<label>","R","</label>",'<input id="{id}-menu-picker-red-value" maxlength="3"/>',"</div>","<div>","<label>","G","</label>",'<input id="{id}-menu-picker-green-value" maxlength="3"/>',"</div>","<div>","<label>","B","</label>",'<input id="{id}-menu-picker-blue-value" maxlength="3"/>',"</div>","</div>","</div>","</div>","</div>",'<tpl if="recentColors && recentColors.length">\n\t\t\t\t\t<div class="recent-colors-container" >\n\t\t\t\t\t\t<label class="recent-colors-label">\n\t\t\t\t\t\t\t{recentColorLabel}\n\t\t\t\t\t\t</label>\n\t\t\t\t\t\t<div class="recent-colors">\n\t\t\t\t\t\t\t<tpl for="recentColors">\n\t\t\t\t\t\t\t\t<button class="recent-color" data-color="{.}" style="background-color: {.}"></button>\n\t\t\t\t\t\t\t</tpl>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t</tpl>',"</div>","</li>"],colorEncoding:Terrasoft.ColorEncoding.HEX,recentColors:null,useStore:!0,recentColorStore:null,setPreviewColor:function(e){this.colorPickerPreviewEl.setStyle("background-color",e)},createButtons:function(){var e=Ext.get(this.id+"-menu-picker-buttons-container");this.buttons=this.buttons||{},this.buttons.buttonOk=Ext.create("Terrasoft.Button",{style:Terrasoft.controls.ButtonEnums.style.BLUE,caption:Terrasoft.Resources.Controls.Button.ButtonCaptionApply,renderTo:e,markerValue:"apply-color"}),this.buttons.buttonOk.on("click",this.onApplyButtonClick,this),this.buttons.cancelButton=Ext.create("Terrasoft.Button",{style:Terrasoft.controls.ButtonEnums.style.DEFAULT,caption:Terrasoft.Resources.Controls.Button.ButtonCaptionCancel,renderTo:e}),this.buttons.cancelButton.on("click",this.onCancelButtonClick,this)},updateBlockCircleStyle:function(){var e=this.colorPickerBlockCirclekEl,t=this.colorPickerBlockEl,r=e.getWidth()/2,n=t.getWidth()-r,i=t.getHeight()-r,a=Math.ceil(n*this.getSaturationValue());a=a<=0?0-r:a;var s=Math.ceil(Math.abs(this.getBrightnessValue()*i-i));s=s<=0?0-r:s,e.setLeft(a),e.setTop(s)},setDefValue:function(){var e=Terrasoft.ColorEncoding;switch(this.colorEncoding){case e.HEX:this.setValue(this.defaultValue);break;case e.RGB:var t=Terrasoft.hex2rgb(this.defaultValue),r=Ext.String.format("rgb({0})",t.join(", "));this.setValue(r);break;default:throw new Terrasoft.UnsupportedTypeException}},checkValue:function(e){return Terrasoft.checkIsColorByEncoding(e,this.colorEncoding)},isClickInsideWrapEL:function(e){var t=this.wrapEl,r=e.getPageX(),n=e.getPageY(),i=t.getX(),a=t.getY(),s=r>i&&r<i+t.getWidth(),o=n>a&&n<a+t.getHeight();return s&&o},_initRecentColorStore:function(){this.useStore&&!this.recentColorStore&&(this.recentColorStore=new Terrasoft.LocalStore({storeName:"RecentColors",isCache:!0}))},getBindConfig:function(){var e=this.callParent(arguments);return Ext.apply(e,{recentColors:{changeMethod:"setRecentColors",changeEvent:"recentColorsChanged"}}),e},setRecentColors:function(e){this.recentColors=e},init:function(){this.callParent(arguments),this.initRecentColors(),this.getValue()||this.setDefValue()},initRecentColors:function(){this.useStore&&(this._initRecentColorStore(),this.recentColors=(this.recentColorStore.getItem("recentColors")||[]).slice(0,17),this.fireEvent("recentColorsChanged"))},onRecentColorClick:function(e,t){var r=t.dataset.color;if(!this.checkValue(r))if(this.colorEncoding===Terrasoft.ColorEncoding.HEX)r=Terrasoft.rgb2hex(r);else{var n=Terrasoft.hex2rgb(r);r=Ext.String.format("rgb({0})",n.join(", "))}this.setValue(r),this.onApplyButtonClick()},onApplyButtonClick:function(){this.fireEvent("colorselected",this,this.getValue()),this.updateRecentColors(),this.onItemClick()},updateRecentColors:function(){this.recentColors=this.recentColors||[],this.recentColors.unshift(this.getValue()),this.recentColors=_.uniq(this.recentColors.map((function(e){return e.toLowerCase()}))),this.fireEvent("recentColorsChanged"),this.useStore&&this.recentColorStore.setItem("recentColors",this.recentColors)},onCancelButtonClick:function(){this.onItemClick()},getTplData:function(){var e=this.callParent(arguments);this.initRecentColors();var t={id:this.id,self:this,containerClass:this.containerClass,colorPickerMainBlockClass:this.colorPickerMainBlockClass,colorPickerBlockClass:this.colorPickerBlockClass,colorPickerBlockCircleClass:this.colorPickerBlockCircleClass,colorPickerLineClass:this.colorPickerLineClass,colorPickerPreviewBlockClass:this.colorPickerPreviewBlockClass,colorPickerPreviewClass:this.colorPickerPreviewClass,colorPickerHueLineClass:this.colorPickerHueLineClass,colorPickerHuePointerClass:this.colorPickerHuePointerClass,colorPickerValuesBlockClass:this.colorPickerValuesBlockClass,colorPickerHexBlockClass:this.colorPickerHexBlockClass,colorPickerRgbBlockClass:this.colorPickerRgbBlockClass,colorPickerCoverClass:this.colorPickerCoverClass,markerValue:this.markerValue,recentColors:this.recentColors,recentColorLabel:Terrasoft.Resources.ColorPicker.RecentColorLabel};return this.updateSelectors(),t.wrapClass=[this.wrapClass],Ext.apply(e,t)},updateSelectors:function(){var e=this.selectors={};return e.wrapEl="#"+this.id+"-menu-color-picker-item",e.containerEl="#"+this.id+"-menu-color-picker-container",e.colorPickerBlockEl="#"+this.id+"-menu-picker-block",e.colorPickerBlockCirclekEl="#"+this.id+"-menu-picker-block-circle",e.colorPickerHueLineEl="#"+this.id+"-menu-picker-hue-line",e.colorPickerPreviewBlockEl="#"+this.id+"-menu-picker-preview-block",e.colorPickerPreviewEl="#"+this.id+"-menu-picker-preview",e.colorPickerHuePointerEl="#"+this.id+"-menu-picker-hue-pointer",e.colorPickerHexFieldEl="#"+this.id+"-menu-picker-hex-field",e.colorPickerRgbFieldEl="#"+this.id+"-menu-picker-rgb-block",e.colorPickerRedFieldEl="#"+this.id+"-menu-picker-red-value",e.colorPickerGreenFieldEl="#"+this.id+"-menu-picker-green-value",e.colorPickerBlueFieldEl="#"+this.id+"-menu-picker-blue-value",e.colorPickerCover="#"+this.id+"-menu-color-picker-cover",e.el=e.wrapEl,e},initDomEvents:function(){this.callParent(arguments),this.wrapEl.un("mouseover",this.onMouseOver,this),this.wrapEl.un("mouseout",this.onMouseOut,this),this.un("click",this.onItemClick,this),this.colorPickerBlockEl.on("mousedown",this.onBlockMouseEvent,this),this.colorPickerHueLineEl.on("mousedown",this.onHueLineMouseEvent,this),this.on("needChangeFieldsValue",this.updateFieldValues,this),this.colorPickerHexFieldEl.on("keyup",this.updateStateByHexFieldChanged,this),this.colorPickerRgbFieldEl.on("keyup",this.updateStateByRgbFieldChanged,this),this.colorPickerCover.on("mousedown",this.onCoverMouseDown,this),this.wrapEl.select(".recent-color").on("click",this.onRecentColorClick,this),Ext.EventManager.on(window,"mousemove",this.onDocumentMouseMove,this),Ext.EventManager.on(window,"mouseup",this.unselectElements,this),Ext.EventManager.on(document,"keydown",this.onKeyDownEventHandler,this)},onHideMenu:function(){this.callParent(arguments),this.colorPickerBlockEl.un("mousedown",this.onBlockMouseEvent,this),this.colorPickerHueLineEl.un("mousedown",this.onHueLineMouseEvent,this),this.un("needChangeFieldsValue",this.updateFieldValues,this),this.colorPickerHexFieldEl.un("keyup",this.updateStateByHexFieldChanged,this),this.colorPickerRgbFieldEl.un("keyup",this.updateStateByRgbFieldChanged,this),this.colorPickerCover.un("mousedown",this.onCoverMouseDown,this),Ext.EventManager.un(window,"mousemove",this.onDocumentMouseMove,this),Ext.EventManager.un(window,"mouseup",this.unselectElements,this),Ext.EventManager.un(document,"keydown",this.onKeyDownEventHandler,this),this.wrapEl.select(".recent-color").un("click",this.onRecentColorClick,this)},unselectElements:function(){this.colorPickerBlockEl.selected=!1,this.colorPickerHueLineEl.selected=!1},onDestroy:function(){Ext.EventManager.un(window,"mousemove",this.onDocumentMouseMove,this),Ext.EventManager.un(window,"mouseup",this.unselectElements,this),Ext.EventManager.un(document,"keydown",this.onKeyDownEventHandler,this),this.callParent(arguments)},onAfterRender:function(){this.callParent(arguments),this.createButtons(),this.updateState()},onAfterReRender:function(){this.callParent(arguments),this.createButtons(),this.updateState()},updateState:function(){this.updateHSVColorValues(),this.updateHuePointerPosition(),this.updateBlockCircleStyle(),this.setPreviewColor(this.getValue()),this.setBlockClearColor(),this.updateFieldValues()},updateStateByHexFieldChanged:function(){var e=this.colorPickerHexFieldEl.dom.value;Terrasoft.isHexValue(e)&&(this.updateStateByHsvValue(Terrasoft.hex2hsv(e)),this.updateRgbFields(Terrasoft.hex2rgb(e)))},updateStateByRgbFieldChanged:function(){var e=this.getRgbFieldsValue();Terrasoft.isRgbValue(e)&&(this.updateStateByHsvValue(Terrasoft.rgb2hsv(e)),this.updateHexField(e))},updateStateByHsvValue:function(e){var t=Terrasoft.getColorByEncoding(e,this.colorEncoding);this.setHueValue(e[0]),this.setSaturationValue(e[1]),this.setBrightnessValue(e[2]),this.setValue(t),this.updateHuePointerPosition(),this.updateBlockCircleStyle(),this.setPreviewColor(t),this.setBlockClearColor()},getRgbFieldsValue:function(){var e=this.colorPickerRedFieldEl.dom.value,t=this.colorPickerGreenFieldEl.dom.value,r=this.colorPickerBlueFieldEl.dom.value;return[parseInt(e,10),parseInt(t,10),parseInt(r,10)]},updateFieldValues:function(){var e=Terrasoft.hsv2rgb(this.getHueValue(),this.getSaturationValue(),this.getBrightnessValue());this.updateHexField(e),this.updateRgbFields(e)},updateHexField:function(e){this.colorPickerHexFieldEl.dom.value=Terrasoft.rgb2hex(e)},updateRgbFields:function(e){this.colorPickerRedFieldEl.dom.value=e[0],this.colorPickerGreenFieldEl.dom.value=e[1],this.colorPickerBlueFieldEl.dom.value=e[2]},setBlockClearColor:function(){var e=Terrasoft.hsv2hex(this.getHueValue(),1,1);this.colorPickerBlockEl.setStyle("background-color",e)},updateHSVColorValues:function(){var e=Terrasoft.getHSVByEncoding(this.getValue(),this.colorEncoding);this.setHueValue(e[0]),this.setSaturationValue(e[1]),this.setBrightnessValue(e[2])},onKeyUpEventHandler:function(e){this.onKeyDownEventHandler(e)},onKeyDownEventHandler:function(e){var t=e.getKey();t===e.ENTER?this.onApplyButtonClick():t===e.ESC&&(e.stopPropagation(),this.onCancelButtonClick())},onCoverMouseDown:function(e){this.isClickInsideWrapEL(e)||this.onCancelButtonClick()},onDocumentMouseMove:function(e){var t=this.colorPickerBlockEl.selected,r=this.colorPickerHueLineEl.selected;t?this.onBlockMouseEvent(e):r&&this.onHueLineMouseEvent(e)},onBlockMouseEvent:function(e){var t=this.colorPickerBlockEl,r=this.colorPickerBlockCirclekEl;t.selected=!0;var n=r.getWidth()/2;this.updateCirclePositionByClick(e),this.setSaturationValue((r.getLocalX()+n)/t.getWidth()),this.setBrightnessValue(Math.abs((r.getLocalY()+n)/t.getHeight()-1));var i=[this.getHueValue(),this.getSaturationValue(),this.getBrightnessValue()],a=Terrasoft.getColorByEncoding(i,this.colorEncoding);this.setPreviewColor(a),this.setValue(a),this.fireEvent("needChangeFieldsValue")},updateCirclePositionByClick:function(e){var t=this.colorPickerBlockEl,r=this.colorPickerBlockCirclekEl,n=r.getWidth()/2,i=e.getPageX()-t.getX()-n;i=(i=i<0-n?0-n:i)>t.getWidth()-n?t.getWidth()-n:i;var a=e.getPageY()-t.getY()-n;a=(a=a>t.getHeight()-n?t.getHeight()-n:a)<0-n?0-n:a,r.setLeft(i),r.setTop(a)},onHueLineMouseEvent:function(e){this.colorPickerHueLineEl.selected=!0;var t=this.getConvertedHueValue(e);this.setHueValue(t);var r=[t,this.getSaturationValue(),this.getBrightnessValue()],n=Terrasoft.getColorByEncoding(r,this.colorEncoding);this.updateHuePointerPosition(),this.setPreviewColor(n),this.setBlockClearColor(),this.setValue(n),this.fireEvent("needChangeFieldsValue")},updateHuePointerPosition:function(){var e=Math.ceil(this.getHueValue()/2),t=this.colorPickerHuePointerEl,r=this.colorPickerHueLineEl.getHeight()-t.getHeight();e=(e=e>r?r:e)<0?0:e,t.setTop(e)},getConvertedHueValue:function(e){var t=this.colorPickerHueLineEl,r=t.getHeight(),n=e.getPageY()-t.getTop(),i=2*(n=(n=n<0?0:n)>r?r:n);return i>=360?359:i},setHueValue:function(e){Ext.isDefined(e)&&e!==this.hueValue&&(this.hueValue=e)},setSaturationValue:function(e){Ext.isDefined(e)&&e!==this.saturationValue&&(this.saturationValue=e)},setBrightnessValue:function(e){Ext.isDefined(e)&&e!==this.brightnessValue&&(this.brightnessValue=e)},getHueValue:function(){return this.hueValue},getSaturationValue:function(){return this.saturationValue},getBrightnessValue:function(){return this.brightnessValue},getValue:function(){return this.value},setValue:function(e){Ext.isDefined(e)&&e!==this.value&&(this.value=e)},setButtonValue:function(e){this.checkValue(e)?this.value=e:this.setDefValue()}}),Ext.define("Terrasoft.controls.BaseSpinner",{alternateClassName:"Terrasoft.BaseSpinner",extend:"Terrasoft.Component",tpl:['<div id="{spinnerId}" class="','{extraComponentClasses}">','<tpl if="componentStyle">style="{componentStyle}"</tpl>',"</div>"],extraComponentClasses:"",width:"",getComponentStyle:function(){var e=this.width;if(!Ext.isEmpty(e)){if(!Ext.isString(e))throw new Terrasoft.UnsupportedTypeException({message:Terrasoft.Resources.Controls.BaseSpinner.SpinnersWidthPropertyShouldBeAString});return"font-size: "+e+";"}return""},getTplData:function(){var e=this.callParent(arguments);e.extraComponentClasses=this.extraComponentClasses,e.spinnerId=this.getSpinnerId(),e.selectors=this.updateSelectors();var t=this.getComponentStyle();return Ext.isEmpty(t)||(e.componentStyle=t),this.tplData=e,e},getSpinnerId:function(){return this.id+"-spinner"},updateSelectors:function(){var e=this.selectors;return e||(e=this.selectors={}),e.el=e.wrapEl="#"+this.getSpinnerId(),e},onAfterRender:function(){this.callParent(arguments),this.show()},onAfterReRender:function(){this.callParent(arguments),this.show()},show:Terrasoft.emptyFn}),Ext.define("Terrasoft.controls.BaseAnimationSpinner",{extend:"Terrasoft.BaseSpinner",alternateClassName:"Terrasoft.BaseAnimationSpinner",spinner:null,spinnerClass:"animation-spinner",getTplData:function(){var e=this.callParent(arguments);return e.extraComponentClasses=[this.spinnerClass,e.extraComponentClasses],e},show:function(){Ext.isEmpty(this.spinner)||(this.spinner.destroy(),this.spinner=null);var e=this.getSpinnerId(),t=document.getElementById(e),r=this.getAnimationData();if(!Ext.isEmpty(t)&&!Ext.isEmpty(r)){var n={container:t,renderer:"svg",loop:!0,autoplay:!0,animationData:r};this.spinner=lottie.loadAnimation(n)}},onDestroy:function(){this.spinner&&this.spinner.destroy(),this.callParent(arguments)},getAnimationData:Terrasoft.emptyFn}),Ext.define("Terrasoft.controls.BubbleSpinner",{extend:"Terrasoft.BaseAnimationSpinner",alternateClassName:"Terrasoft.BubbleSpinner",getAnimationData:function(){return{v:"5.1.16",fr:30,ip:0,op:60,w:16,h:16,nm:"Comp 15",ddd:0,assets:[],layers:[{ddd:0,ind:1,ty:4,nm:"Shape Layer 1",sr:1,ks:{o:{a:1,k:[{i:{x:[.565],y:[.779]},o:{x:[.181],y:[0]},n:["0p565_0p779_0p181_0"],t:0,s:[0],e:[80]},{i:{x:[.841],y:[1]},o:{x:[.384],y:[1.463]},n:["0p841_1_0p384_1p463"],t:16,s:[80],e:[100]},{i:{x:[.667],y:[1]},o:{x:[.333],y:[0]},n:["0p667_1_0p333_0"],t:46,s:[100],e:[0]},{t:60}],ix:11},r:{a:0,k:0,ix:10},p:{a:0,k:[8,8,0],ix:2},a:{a:0,k:[0,0,0],ix:1},s:{a:1,k:[{i:{x:[.667,.667,.667],y:[.656,.656,-12.091]},o:{x:[.333,.333,.333],y:[0,0,0]},n:["0p667_0p656_0p333_0","0p667_0p656_0p333_0","0p667_-12p091_0p333_0"],t:0,s:[0,0,100],e:[40,40,100]},{i:{x:[.667,.667,.667],y:[1.972,1.972,2.231]},o:{x:[.333,.333,.333],y:[-1.031,-1.031,9.818]},n:["0p667_1p972_0p333_-1p031","0p667_1p972_0p333_-1p031","0p667_2p231_0p333_9p818"],t:16,s:[40,40,100],e:[30,30,100]},{i:{x:[.667,.667,.667],y:[.382,.382,-6.782]},o:{x:[.333,.333,.333],y:[.446,.446,-1.129]},n:["0p667_0p382_0p333_0p446","0p667_0p382_0p333_0p446","0p667_-6p782_0p333_-1p129"],t:28,s:[30,30,100],e:[50,50,100]},{i:{x:[.667,.667,.667],y:[1,1,1]},o:{x:[.333,.333,.333],y:[.393,.393,14.856]},n:["0p667_1_0p333_0p393","0p667_1_0p333_0p393","0p667_1_0p333_14p856"],t:39,s:[50,50,100],e:[110,110,100]},{t:60}],ix:6}},ao:0,shapes:[{d:1,ty:"el",s:{a:0,k:[11,11],ix:2},p:{a:0,k:[0,0],ix:3},nm:"Ellipse Path 1",mn:"ADBE Vector Shape - Ellipse",hd:!1},{ty:"st",c:{a:0,k:[.831372559071,.831372559071,.831372559071,1],ix:3},o:{a:0,k:100,ix:4},w:{a:1,k:[{i:{x:[.833],y:[.833]},o:{x:[.167],y:[.167]},n:["0p833_0p833_0p167_0p167"],t:0,s:[5],e:[14]},{i:{x:[.833],y:[.833]},o:{x:[.167],y:[.167]},n:["0p833_0p833_0p167_0p167"],t:39,s:[14],e:[2]},{t:49}],ix:5},lc:1,lj:1,ml:4,nm:"Stroke 1",mn:"ADBE Vector Graphic - Stroke",hd:!1}],ip:0,op:90,st:0,bm:0}],markers:[]}}}),Ext.define("Terrasoft.controls.CircleSpinner",{extend:"Terrasoft.BaseAnimationSpinner",alternateClassName:"Terrasoft.CircleSpinner",getAnimationData:function(){return{assets:[],v:"4.1.7",ddd:0,layers:[{ddd:0,ind:0,ty:4,nm:"Main 27",ks:{o:{k:50},r:{k:0},p:{k:[30,30,0]},a:{k:[0,0,0]},s:{k:[100,100,100]}},shapes:[{ty:"gr",it:[{ind:0,ty:"sh",closed:!0,ks:{k:{i:[[14.092,0],[0,-14.092],[-14.092,0],[0,14.092]],o:[[-14.092,0],[0,14.092],[14.092,0],[0,-14.092]],v:[[-.016,-25.547],[-25.531,-.031],[-.016,25.484],[25.5,-.031]]}},nm:"Path 1"},{ty:"st",fillEnabled:!0,c:{k:[255,83,11,255]},o:{k:100},w:{k:1.4},lc:2,lj:1,ml:4,nm:"Stroke 1"},{ty:"tr",p:{k:[0,0]},a:{k:[0,0]},s:{k:[100,100]},r:{k:0},o:{k:100},sk:{k:0},sa:{k:0}}],nm:"Ellipse 1"},{ty:"tm",s:{k:[{i:{x:[.431],y:[1]},o:{x:[.887],y:[0]},n:["0p431_1_0p887_0"],t:125.346,s:[100],e:[0]},{t:167.889282511678}]},e:{k:[{i:{x:[.612],y:[1]},o:{x:[.835],y:[0]},n:["0p612_1_0p835_0"],t:126.181,s:[100],e:[0]},{t:169.557251261678}]},o:{k:0},m:1,nm:"Trim Paths 1"}],bounds:{l:-27,t:-27,b:27,r:27},ip:123.678345011678,op:199,st:123.678345011678},{ddd:0,ind:1,ty:4,nm:"Main 26",ks:{o:{k:80},r:{k:0},p:{k:[30,30,0]},a:{k:[0,0,0]},s:{k:[98,98,100]}},shapes:[{ty:"gr",it:[{ind:0,ty:"sh",closed:!0,ks:{k:{i:[[11.122,0],[0,-11.122],[-11.122,0],[0,11.122]],o:[[-11.122,0],[0,11.122],[11.122,0],[0,-11.122]],v:[[-.016,-20.153],[-20.153,-.016],[-.016,20.122],[20.122,-.016]]}},nm:"Path 1"},{ty:"st",fillEnabled:!0,c:{k:[255,83,11,255]},o:{k:100},w:{k:2.5},lc:2,lj:1,ml:4,nm:"Stroke 1"},{ty:"tr",p:{k:[0,0]},a:{k:[0,0]},s:{k:[100,100]},r:{k:0},o:{k:100},sk:{k:0},sa:{k:0}}],nm:"Ellipse 1"},{ty:"tm",s:{k:[{i:{x:[.113],y:[1]},o:{x:[.569],y:[0]},n:["0p113_1_0p569_0"],t:119.507,s:[0],e:[100]},{t:162.050110005839}]},e:{k:[{i:{x:[.165],y:[1]},o:{x:[.388],y:[0]},n:["0p165_1_0p388_0"],t:126,s:[0],e:[100]},{t:169.000305318339}]},o:{k:0},m:1,nm:"Trim Paths 1"}],bounds:{l:-22,t:-22,b:22,r:22},ip:117.839172505839,op:192.914247580914,st:117.839172505839},{ddd:0,ind:2,ty:4,nm:"Main 25",ks:{o:{k:100},r:{k:0},p:{k:[30,30,0]},a:{k:[0,0,0]},s:{k:[100,100,100]}},shapes:[{ty:"gr",it:[{ind:0,ty:"sh",closed:!0,ks:{k:{i:[[14.152,0],[0,-14.152],[-14.152,0],[0,14.152]],o:[[-14.152,0],[0,14.152],[14.152,0],[0,-14.152]],v:[[0,-25.641],[-25.625,-.016],[0,25.609],[25.625,-.016]]}},nm:"Path 1"},{ty:"st",fillEnabled:!0,c:{k:[255,83,11,255]},o:{k:100},w:{k:1.7},lc:2,lj:1,ml:4,nm:"Stroke 1"},{ty:"tr",p:{k:[0,0]},a:{k:[0,0]},s:{k:[100,100]},r:{k:0},o:{k:100},sk:{k:0},sa:{k:0}}],nm:"Ellipse 1"},{ty:"tm",s:{k:[{i:{x:[.431],y:[1]},o:{x:[.887],y:[0]},n:["0p431_1_0p887_0"],t:113.668,s:[100],e:[0]},{t:156.2109375}]},e:{k:[{i:{x:[.612],y:[1]},o:{x:[.835],y:[0]},n:["0p612_1_0p835_0"],t:114.503,s:[100],e:[0]},{t:157.87890625}]},o:{k:0},m:1,nm:"Trim Paths 1"}],bounds:{l:-27,t:-27,b:27,r:27},ip:112,op:187.075075075075,st:112},{ddd:0,ind:3,ty:4,nm:"Main 24",ks:{o:{k:50},r:{k:0},p:{k:[30,30,0]},a:{k:[0,0,0]},s:{k:[100,100,100]}},shapes:[{ty:"gr",it:[{ind:0,ty:"sh",closed:!0,ks:{k:{i:[[14.092,0],[0,-14.092],[-14.092,0],[0,14.092]],o:[[-14.092,0],[0,14.092],[14.092,0],[0,-14.092]],v:[[-.016,-25.547],[-25.531,-.031],[-.016,25.484],[25.5,-.031]]}},nm:"Path 1"},{ty:"st",fillEnabled:!0,c:{k:[54,178,238,255]},o:{k:100},w:{k:1.4},lc:2,lj:1,ml:4,nm:"Stroke 1"},{ty:"tr",p:{k:[0,0]},a:{k:[0,0]},s:{k:[100,100]},r:{k:0},o:{k:100},sk:{k:0},sa:{k:0}}],nm:"Ellipse 1"},{ty:"tm",s:{k:[{i:{x:[.431],y:[1]},o:{x:[.887],y:[0]},n:["0p431_1_0p887_0"],t:69.346,s:[100],e:[0]},{t:111.889282511678}]},e:{k:[{i:{x:[.612],y:[1]},o:{x:[.835],y:[0]},n:["0p612_1_0p835_0"],t:70.181,s:[100],e:[0]},{t:113.557251261678}]},o:{k:0},m:1,nm:"Trim Paths 1"}],bounds:{l:-27,t:-27,b:27,r:27},ip:67.6783450116783,op:143,st:67.6783450116783},{ddd:0,ind:4,ty:4,nm:"Main 23",ks:{o:{k:80},r:{k:0},p:{k:[30,30,0]},a:{k:[0,0,0]},s:{k:[98,98,100]}},shapes:[{ty:"gr",it:[{ind:0,ty:"sh",closed:!0,ks:{k:{i:[[11.122,0],[0,-11.122],[-11.122,0],[0,11.122]],o:[[-11.122,0],[0,11.122],[11.122,0],[0,-11.122]],v:[[-.016,-20.153],[-20.153,-.016],[-.016,20.122],[20.122,-.016]]}},nm:"Path 1"},{ty:"st",fillEnabled:!0,c:{k:[54,178,238,255]},o:{k:100},w:{k:2.5},lc:2,lj:1,ml:4,nm:"Stroke 1"},{ty:"tr",p:{k:[0,0]},a:{k:[0,0]},s:{k:[100,100]},r:{k:0},o:{k:100},sk:{k:0},sa:{k:0}}],nm:"Ellipse 1"},{ty:"tm",s:{k:[{i:{x:[.113],y:[1]},o:{x:[.569],y:[0]},n:["0p113_1_0p569_0"],t:63.507,s:[0],e:[100]},{t:106.050110005839}]},e:{k:[{i:{x:[.165],y:[1]},o:{x:[.388],y:[0]},n:["0p165_1_0p388_0"],t:70,s:[0],e:[100]},{t:113.000305318339}]},o:{k:0},m:1,nm:"Trim Paths 1"}],bounds:{l:-22,t:-22,b:22,r:22},ip:61.8391725058392,op:136.914247580914,st:61.8391725058392},{ddd:0,ind:5,ty:4,nm:"Main 22",ks:{o:{k:100},r:{k:0},p:{k:[30,30,0]},a:{k:[0,0,0]},s:{k:[100,100,100]}},shapes:[{ty:"gr",it:[{ind:0,ty:"sh",closed:!0,ks:{k:{i:[[14.152,0],[0,-14.152],[-14.152,0],[0,14.152]],o:[[-14.152,0],[0,14.152],[14.152,0],[0,-14.152]],v:[[0,-25.641],[-25.625,-.016],[0,25.609],[25.625,-.016]]}},nm:"Path 1"},{ty:"st",fillEnabled:!0,c:{k:[54,178,238,255]},o:{k:100},w:{k:1.7},lc:2,lj:1,ml:4,nm:"Stroke 1"},{ty:"tr",p:{k:[0,0]},a:{k:[0,0]},s:{k:[100,100]},r:{k:0},o:{k:100},sk:{k:0},sa:{k:0}}],nm:"Ellipse 1"},{ty:"tm",s:{k:[{i:{x:[.431],y:[1]},o:{x:[.887],y:[0]},n:["0p431_1_0p887_0"],t:57.668,s:[100],e:[0]},{t:100.2109375}]},e:{k:[{i:{x:[.612],y:[1]},o:{x:[.835],y:[0]},n:["0p612_1_0p835_0"],t:58.503,s:[100],e:[0]},{t:101.87890625}]},o:{k:0},m:1,nm:"Trim Paths 1"}],bounds:{l:-27,t:-27,b:27,r:27},ip:56,op:131.075075075075,st:56},{ddd:0,ind:6,ty:4,nm:"Main 6",ks:{o:{k:50},r:{k:0},p:{k:[30,30,0]},a:{k:[0,0,0]},s:{k:[100,100,100]}},shapes:[{ty:"gr",it:[{ind:0,ty:"sh",closed:!0,ks:{k:{i:[[14.092,0],[0,-14.092],[-14.092,0],[0,14.092]],o:[[-14.092,0],[0,14.092],[14.092,0],[0,-14.092]],v:[[-.016,-25.547],[-25.531,-.031],[-.016,25.484],[25.5,-.031]]}},nm:"Path 1"},{ty:"st",fillEnabled:!0,c:{k:[104,210,22,255]},o:{k:100},w:{k:1.4},lc:2,lj:1,ml:4,nm:"Stroke 1"},{ty:"tr",p:{k:[0,0]},a:{k:[0,0]},s:{k:[100,100]},r:{k:0},o:{k:100},sk:{k:0},sa:{k:0}}],nm:"Ellipse 1"},{ty:"tm",s:{k:[{i:{x:[.431],y:[1]},o:{x:[.887],y:[0]},n:["0p431_1_0p887_0"],t:13.346,s:[100],e:[0]},{t:55.8892825116783}]},e:{k:[{i:{x:[.612],y:[1]},o:{x:[.835],y:[0]},n:["0p612_1_0p835_0"],t:14.181,s:[100],e:[0]},{t:57.5572512616783}]},o:{k:0},m:1,nm:"Trim Paths 1"}],bounds:{l:-27,t:-27,b:27,r:27},ip:11.6783450116783,op:87,st:11.6783450116783},{ddd:0,ind:7,ty:4,nm:"Main 5",ks:{o:{k:80},r:{k:0},p:{k:[30,30,0]},a:{k:[0,0,0]},s:{k:[98,98,100]}},shapes:[{ty:"gr",it:[{ind:0,ty:"sh",closed:!0,ks:{k:{i:[[11.122,0],[0,-11.122],[-11.122,0],[0,11.122]],o:[[-11.122,0],[0,11.122],[11.122,0],[0,-11.122]],v:[[-.016,-20.153],[-20.153,-.016],[-.016,20.122],[20.122,-.016]]}},nm:"Path 1"},{ty:"st",fillEnabled:!0,c:{k:[104,210,22,255]},o:{k:100},w:{k:2.5},lc:2,lj:1,ml:4,nm:"Stroke 1"},{ty:"tr",p:{k:[0,0]},a:{k:[0,0]},s:{k:[100,100]},r:{k:0},o:{k:100},sk:{k:0},sa:{k:0}}],nm:"Ellipse 1"},{ty:"tm",s:{k:[{i:{x:[.113],y:[1]},o:{x:[.569],y:[0]},n:["0p113_1_0p569_0"],t:7.507,s:[0],e:[100]},{t:50.0501100058392}]},e:{k:[{i:{x:[.165],y:[1]},o:{x:[.388],y:[0]},n:["0p165_1_0p388_0"],t:14,s:[0],e:[100]},{t:57.0003053183392}]},o:{k:0},m:1,nm:"Trim Paths 1"}],bounds:{l:-22,t:-22,b:22,r:22},ip:5.83917250583917,op:80.9142475809143,st:5.83917250583917},{ddd:0,ind:8,ty:4,nm:"Main 4",ks:{o:{k:100},r:{k:0},p:{k:[30,30,0]},a:{k:[0,0,0]},s:{k:[100,100,100]}},shapes:[{ty:"gr",it:[{ind:0,ty:"sh",closed:!0,ks:{k:{i:[[14.152,0],[0,-14.152],[-14.152,0],[0,14.152]],o:[[-14.152,0],[0,14.152],[14.152,0],[0,-14.152]],v:[[0,-25.641],[-25.625,-.016],[0,25.609],[25.625,-.016]]}},nm:"Path 1"},{ty:"st",fillEnabled:!0,c:{k:[104,210,22,255]},o:{k:100},w:{k:1.7},lc:2,lj:1,ml:4,nm:"Stroke 1"},{ty:"tr",p:{k:[0,0]},a:{k:[0,0]},s:{k:[100,100]},r:{k:0},o:{k:100},sk:{k:0},sa:{k:0}}],nm:"Ellipse 1"},{ty:"tm",s:{k:[{i:{x:[.431],y:[1]},o:{x:[.887],y:[0]},n:["0p431_1_0p887_0"],t:1.668,s:[100],e:[0]},{t:44.2109375}]},e:{k:[{i:{x:[.612],y:[1]},o:{x:[.835],y:[0]},n:["0p612_1_0p835_0"],t:2.503,s:[100],e:[0]},{t:45.87890625}]},o:{k:0},m:1,nm:"Trim Paths 1"}],bounds:{l:-27,t:-27,b:27,r:27},ip:0,op:75.0750750750751,st:0}],ip:0,op:168,fr:25,w:60,h:60}}}),Ext.define("Terrasoft.controls.ProgressSpinner",{extend:"Terrasoft.BaseSpinner",alternateClassName:"Terrasoft.ProgressSpinner",tpl:['<div id="{spinnerId}" class="',"x-loading-spinner",'<tpl if="isIE"> ie</tpl>',' {extraComponentClasses}"',' style="{extraStyle}" ','<tpl if="componentStyle">style="{componentStyle}"</tpl>>','<tpl if="!isIE">','<span id="{id}-progress-top" class="x-loading-top"></span>','<span id="{id}-progress-right" class="x-loading-right"></span>','<span id="{id}-progress-bottom" class="x-loading-bottom"></span>','<span id="{id}-progress-left" class="x-loading-left"></span>',"</tpl>","</div>"],extraStyle:"background-image: url('data:image/gif;base64,R0lGODlhEAAQAPQAAP///6qqqvn5+dfX1/T09MHBwdLS0qqqqsfHx7W1teLi4ujo6LCwsN3d3aurq7u7u8zMzAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACH+GkNyZWF0ZWQgd2l0aCBhamF4bG9hZC5pbmZvACH5BAAKAAAAIf8LTkVUU0NBUEUyLjADAQAAACwAAAAAEAAQAAAFdyAgAgIJIeWoAkRCCMdBkKtIHIngyMKsErPBYbADpkSCwhDmQCBethRB6Vj4kFCkQPG4IlWDgrNRIwnO4UKBXDufzQvDMaoSDBgFb886MiQadgNABAokfCwzBA8LCg0Egl8jAggGAA1kBIA1BAYzlyILczULC2UhACH5BAAKAAEALAAAAAAQABAAAAV2ICACAmlAZTmOREEIyUEQjLKKxPHADhEvqxlgcGgkGI1DYSVAIAWMx+lwSKkICJ0QsHi9RgKBwnVTiRQQgwF4I4UFDQQEwi6/3YSGWRRmjhEETAJfIgMFCnAKM0KDV4EEEAQLiF18TAYNXDaSe3x6mjidN1s3IQAh+QQACgACACwAAAAAEAAQAAAFeCAgAgLZDGU5jgRECEUiCI+yioSDwDJyLKsXoHFQxBSHAoAAFBhqtMJg8DgQBgfrEsJAEAg4YhZIEiwgKtHiMBgtpg3wbUZXGO7kOb1MUKRFMysCChAoggJCIg0GC2aNe4gqQldfL4l/Ag1AXySJgn5LcoE3QXI3IQAh+QQACgADACwAAAAAEAAQAAAFdiAgAgLZNGU5joQhCEjxIssqEo8bC9BRjy9Ag7GILQ4QEoE0gBAEBcOpcBA0DoxSK/e8LRIHn+i1cK0IyKdg0VAoljYIg+GgnRrwVS/8IAkICyosBIQpBAMoKy9dImxPhS+GKkFrkX+TigtLlIyKXUF+NjagNiEAIfkEAAoABAAsAAAAABAAEAAABWwgIAICaRhlOY4EIgjH8R7LKhKHGwsMvb4AAy3WODBIBBKCsYA9TjuhDNDKEVSERezQEL0WrhXucRUQGuik7bFlngzqVW9LMl9XWvLdjFaJtDFqZ1cEZUB0dUgvL3dgP4WJZn4jkomWNpSTIyEAIfkEAAoABQAsAAAAABAAEAAABX4gIAICuSxlOY6CIgiD8RrEKgqGOwxwUrMlAoSwIzAGpJpgoSDAGifDY5kopBYDlEpAQBwevxfBtRIUGi8xwWkDNBCIwmC9Vq0aiQQDQuK+VgQPDXV9hCJjBwcFYU5pLwwHXQcMKSmNLQcIAExlbH8JBwttaX0ABAcNbWVbKyEAIfkEAAoABgAsAAAAABAAEAAABXkgIAICSRBlOY7CIghN8zbEKsKoIjdFzZaEgUBHKChMJtRwcWpAWoWnifm6ESAMhO8lQK0EEAV3rFopIBCEcGwDKAqPh4HUrY4ICHH1dSoTFgcHUiZjBhAJB2AHDykpKAwHAwdzf19KkASIPl9cDgcnDkdtNwiMJCshACH5BAAKAAcALAAAAAAQABAAAAV3ICACAkkQZTmOAiosiyAoxCq+KPxCNVsSMRgBsiClWrLTSWFoIQZHl6pleBh6suxKMIhlvzbAwkBWfFWrBQTxNLq2RG2yhSUkDs2b63AYDAoJXAcFRwADeAkJDX0AQCsEfAQMDAIPBz0rCgcxky0JRWE1AmwpKyEAIfkEAAoACAAsAAAAABAAEAAABXkgIAICKZzkqJ4nQZxLqZKv4NqNLKK2/Q4Ek4lFXChsg5ypJjs1II3gEDUSRInEGYAw6B6zM4JhrDAtEosVkLUtHA7RHaHAGJQEjsODcEg0FBAFVgkQJQ1pAwcDDw8KcFtSInwJAowCCA6RIwqZAgkPNgVpWndjdyohACH5BAAKAAkALAAAAAAQABAAAAV5ICACAimc5KieLEuUKvm2xAKLqDCfC2GaO9eL0LABWTiBYmA06W6kHgvCqEJiAIJiu3gcvgUsscHUERm+kaCxyxa+zRPk0SgJEgfIvbAdIAQLCAYlCj4DBw0IBQsMCjIqBAcPAooCBg9pKgsJLwUFOhCZKyQDA3YqIQAh+QQACgAKACwAAAAAEAAQAAAFdSAgAgIpnOSonmxbqiThCrJKEHFbo8JxDDOZYFFb+A41E4H4OhkOipXwBElYITDAckFEOBgMQ3arkMkUBdxIUGZpEb7kaQBRlASPg0FQQHAbEEMGDSVEAA1QBhAED1E0NgwFAooCDWljaQIQCE5qMHcNhCkjIQAh+QQACgALACwAAAAAEAAQAAAFeSAgAgIpnOSoLgxxvqgKLEcCC65KEAByKK8cSpA4DAiHQ/DkKhGKh4ZCtCyZGo6F6iYYPAqFgYy02xkSaLEMV34tELyRYNEsCQyHlvWkGCzsPgMCEAY7Cg04Uk48LAsDhRA8MVQPEF0GAgqYYwSRlycNcWskCkApIyEAOwAAAAAAAAAAAA==')",getTplData:function(){var e=this.callParent(arguments);return e.isIE=Ext.isIE,e.extraStyle=Ext.isIE?this.extraStyle:"",this.tplData=e,e},getSpinnerId:function(){return this.id+"-progress-wrap"}}),Ext.ns("Terrasoft.utils.controls"),Terrasoft.utils.controls.getControlConfigByDataValueType=function(e){var t;switch(e){case Terrasoft.DataValueType.TEXT:t={className:"Terrasoft.TextEdit"};break;case Terrasoft.DataValueType.INTEGER:t={className:"Terrasoft.IntegerEdit"};break;case Terrasoft.DataValueType.FLOAT:t={className:"Terrasoft.FloatEdit"};break;case Terrasoft.DataValueType.MONEY:t={className:"Terrasoft.FloatEdit",decimalPrecision:2};break;case Terrasoft.DataValueType.DATE:t={className:"Terrasoft.DateEdit"};break;case Terrasoft.DataValueType.TIME:t={className:"Terrasoft.TimeEdit"};break;case Terrasoft.DataValueType.LOOKUP:t={className:"Terrasoft.LookupEdit"};break;case Terrasoft.DataValueType.ENUM:t={className:"Terrasoft.ComboBoxEdit"};break;case Terrasoft.DataValueType.BOOLEAN:t={className:"Terrasoft.CheckBoxEdit"};break;case Terrasoft.DataValueType.GUID:case Terrasoft.DataValueType.DATE_TIME:case Terrasoft.DataValueType.BLOB:t=null}return Ext.apply({},t)},Terrasoft.getControlConfigByDataValueType=Terrasoft.utils.controls.getControlConfigByDataValueType,Terrasoft.utils.controls.getSpinner=function(e,t){var r=null!=t?t:"Terrasoft.BubbleSpinner";return Ext.create(r,{extraComponentClasses:e})},Terrasoft.getSpinner=Terrasoft.utils.controls.getSpinner,Ext.define("Terrasoft.controls.Menu",{extend:"Terrasoft.Component",alternateClassName:"Terrasoft.Menu",preventDefaultsKeys:[Ext.EventObject.UP,Ext.EventObject.RIGHT,Ext.EventObject.DOWN,Ext.EventObject.LEFT],stopPropagationKeys:[Ext.EventObject.ESC,Ext.EventObject.ENTER,Ext.EventObject.SPACE,Ext.EventObject.UP,Ext.EventObject.RIGHT,Ext.EventObject.DOWN,Ext.EventObject.LEFT],isRootMenu:!0,rootMenu:null,scrollStep:64,menuDocumentOffset:10,progressSpinner:null,scrollBarVisibleClass:"menu-scrollbar-visible",isMenuLoading:!1,outSideOffset:40,outSideOffsetIE:1,defaultAlignType:"tl-bl?",defaultPrimaryColumnName:"Id",defaultCaptionName:"Caption",defaultFileUploadName:"fileUpload",defaultFileTypeFilterName:"fileTypeFilter",defaultFileUploadMultiSelectName:"fileUploadMultiSelect",defaultFilesSelectedName:"filesSelected",defaultImageConfigName:"ImageConfig",defaultTypeName:"Type",defaultTagName:"Tag",defaultMarkerValueName:"MarkerValue",defaultVisibleName:"Visible",defaultEnabledName:"Enabled",defaultItemsName:"Items",defaultClickEventName:"Click",defaultCanExecuteName:"canExecute",defaultScrollWrapperClass:"menu-scroll-wrap menu",defaultUlClass:"menu-wrap menu",defaultDirectionName:"direction",tpl:['<tpl if="hasScrolling">','<div id="{id}-scroll-wrap" class="{scrollWrapperClass}" style="{scrollWrapperStyle}">',"</tpl>",'<tpl if="needContent">',"{%this.renderContent(out, values)%}","</tpl>",'<tpl if="hasScrolling">','<div id="{id}-scroll-up" class="menu-scrollbar menu-scrollbar-top">','<span class="menu-scroll-marker menu-scroll-marker-top"></span>',"</div>",'<div id="{id}-scroll-down" class="menu-scrollbar menu-scrollbar-bottom menu-scrollbar-visible">','<span class="menu-scroll-marker menu-scroll-marker-bottom"></span>',"</div>","</div>","</tpl>"],contentTpl:['<ul id="{id}-list" class="{ulClass}" style="{ulStyle}">','<tpl if="isRootMenu">','<input id="{id}-focusEl" class="menu-focus-el">',"</tpl>",'<tpl if="isMenuLoading && isRootMenu">','<li class="menu-loading">',"{%this.renderProgressSpinner(out, values)%}","{loadingCaption}","</li>","<tpl else>","{%this.renderItems(out, values)%}","</tpl>","</ul>"],styles:{ulStyle:{},scrollWrapperStyle:{}},items:null,scrollWrapperClass:"",ulClass:"",selectedItem:null,alignType:null,offset:null,renderContent:function(e,t){var r=t.self,n=new Ext.XTemplate(r.contentTpl);n.renderItems=r.renderItems,n.renderProgressSpinner=r.renderProgressSpinner,n.html=r.processTemplate(r.contentTpl,t),n.applyOut(t,e)},renderItems:function(e,t){var r=t.self.getItemsHtml();Ext.DomHelper.generateMarkup(r,e)},renderProgressSpinner:function(e,t){var r=t.self.getProgressSpinner().generateHtml();Ext.DomHelper.generateMarkup(r,e)},getActiveMenu:function(){var e=this.selectedItem;return e&&e.menu&&e.menu.rendered?e.menu.getActiveMenu():this},isElementInMenuTreeBranch:function(e){var t=e.dom?e:Ext.get(e);if(this.wrapEl.contains(t))return!0;var r=this.selectedItem;if(!r)return!1;var n=r.menu;return!(!n||!n.rendered)&&n.isElementInMenuTreeBranch(t)},navigate:function(e){var t=this.selectedItem;switch(e){case Ext.EventObject.SPACE:case Ext.EventObject.ENTER:t&&t.process(!0);break;case Ext.EventObject.ESC:case Ext.EventObject.LEFT:this.hide();break;case Ext.EventObject.RIGHT:t&&t.menu?t.showMenu():this.setSelectedItemByIndex(0);break;case Ext.EventObject.UP:this.selectNextMenuItem(!0);break;case Ext.EventObject.DOWN:this.selectNextMenuItem(!1)}},selectNextMenuItem:function(e){var t=this.getNextSelectableItem(e);t&&(this.scrollToItem(t),this.setSelectedItem(t))},getNextSelectableItem:function(e){var t=this.selectedItem,r=this.items.getCount();if(0===r)return null;t||(t=e?this.getItemByIndex(0):this.getItemByIndex(r-1));for(var n=t.getIndex(),i=0;i<=r;i++){n=e?0===n?r-1:n-1:n===r-1?0:n+1;var a=this.getItemByIndex(n);if(a.isInteractive&&!1!==a.enabled&&a.visible)return a}return null},onDocumentMouseDown:function(e,t){var r=this.getRootMenu();r.isElementInMenuTreeBranch(t)||r.hide()},onScrollButtonClick:function(e,t){e.stopPropagation();var r=t.className.indexOf("menu-scroll-marker")>=0?t.parentNode:t;if(Ext.get(r).hasCls(this.scrollBarVisibleClass)){var n=-1!==r.id.indexOf("up"),i=this.scrollStep,a=n?i:-1*i;this.scroll(a)}},onMouseWheel:function(e){e.stopPropagation(),e.preventDefault(),this.scroll(e.browserEvent.wheelDelta)},canScrollUp:function(){return this.ulEl.getTop()<this.scrollWrapEl.getTop()},canScrollDown:function(){return this.ulEl.getBottom()>this.scrollWrapEl.getBottom()},addScrollBars:function(){var e=[];this.tplData.hasScrolling=!0,this.tplData.needContent=!1,new Ext.XTemplate(this.tpl).applyOut(this.tplData,e),Ext.DomHelper.insertHtml("beforeend",Ext.getBody().dom,e.join("")),this.updateSelectors(this.tplData);var t=Ext.get(Ext.DomQuery.selectNode(this.selectors.scrollWrapEl)),r=Ext.get(Ext.DomQuery.selectNode(this.selectors.ulEl)),n=Ext.get(Ext.DomQuery.selectNode(this.selectors.scrollUpEl));r.removeCls("menu"),r.setStyle({left:"0px",top:0+n.getHeight()+"px"}),t.insertFirst(r),this.applySelectors()},setScrollButtonVisibility:function(e,t){var r=this.scrollBarVisibleClass;t?e.addCls(r):e.removeCls(r)},fixRendering:function(){var e=this.wrapEl,t={},r=Ext.getBody();t.bodyScroll=r.getScroll(),t.buttonBox=this.buttonBox||{width:0,height:0,x:0,y:0,right:0,bottom:0},t.viewSize=r.getViewSize(),t.viewSize.bottom=t.bodyScroll.top+t.viewSize.height,t.viewSize.right=t.bodyScroll.left+t.viewSize.width,t.menuSize=e.getBox(),t.position={x:t.buttonBox.x,y:t.buttonBox.bottom};var n=t.position;this.fixX(t),this.fixY(t);var i=Terrasoft.getIsRtlMode()?-3:3;this.wrapEl.moveTo(n.x+i,n.y+2)},fixX:function(e){var t,r=e.position,n=e.buttonBox,i=e.menuSize,a=this.isRootMenu,s=Ext.getScrollbarSize(),o=Terrasoft.getIsRtlMode(),l=o?n.left:n.right;a?t=(o?i.left:i.right)<e.viewSize.width:t=l+i.width+s.width<e.viewSize.width;var c=i.width<n.x;if(t||!c){var u=o&&c?n.left-i.width:n.right;r.x=a?r.x:u}else r.x=a?l-i.width:n.x-i.width},fixY:function(e){var t=this.menuDocumentOffset,r=e.position,n=e.buttonBox,i=e.viewSize,a=e.bodyScroll,s=e.menuSize,o=s.height<n.y-a.top,l=i.height-(n.y+n.height-a.top)>s.height,c=i.bottom-n.bottom,u=n.y-a.top>c,h=!0,f=!1,d=0;l||(o?(r.y=e.buttonBox.y-e.menuSize.height,h=!1):(this.addScrollBars(),f=!0,u?(r.y=e.bodyScroll.top+t,d=e.buttonBox.y-e.bodyScroll.top-t,h=!1):d=e.viewSize.bottom-e.buttonBox.bottom-t));var p=this.outSideOffset;Ext.isIE&&(p+=this.outSideOffsetIE),this.isRootMenu||(h&&(r.y-=p),d+=p),d&&f&&this.wrapEl.setHeight(d)},focus:function(){Terrasoft.delay((function(){this.visible&&this.rendered&&this.isRootMenu&&this.focusEl.focus()}),this,50)},renderLoading:function(){this.isRootMenu&&this.isMenuLoading&&this.forceRender()},loadData:function(e){this.isMenuLoading&&(this.isMenuLoading=!1,e.forEach((function(e){this.addItem(e,null,!0)}),this),this.forceRender())},forceRender:function(){this.rendered?(this.reRender(null),this.afterRenderOrRerender()):this.render(Ext.getBody())},init:function(){this.callParent(arguments),this.addEvents("add","remove","prepareMenu","hide"),this.initItems()},initItems:function(){var e=this.items||[];if(!Ext.isArray(e))throw new Terrasoft.NullOrEmptyException({message:Terrasoft.Resources.Controls.Menu.MenuItemsPropertyShouldBeAnArray});this.items=new Terrasoft.Collection;for(var t=0,r=e.length;t<r;t++){var n=e[t];this.addItem(n)}},initItem:function(e){var t=e instanceof Terrasoft.BaseMenuItem;if(e.parentMenu=this,!t){var r=e.alternateClassName||e.className||"Terrasoft.MenuItem";e=Ext.create(r,e)}return e},initScrollEvents:function(){this.scrollWrapEl&&(this.scrollUpEl.on("click",this.onScrollButtonClick,this),this.scrollDownEl.on("click",this.onScrollButtonClick,this),this.wrapEl.on("mousewheel",this.onMouseWheel,this))},initDomEvents:function(){if(this.isRootMenu){var e=Ext.getDoc(),t=this.focusEl;e.on("mousedown",this.onDocumentMouseDown,this),t.on("keydown",this.onKeyDown,this),t.on("focus",(function(e){e.preventDefault()}),this)}},clearDomListeners:function(){if(this.wrapEl.un("keydown",this.onKeyDown,this),this.isRootMenu){var e=this.focusEl;Ext.getDoc().un("mousedown",this.onDocumentMouseDown,this),e.un("keydown",this.onKeyDown,this),Ext.EventManager.removeAll(e)}this.scrollWrapEl&&(this.scrollUpEl.un("click",this.onScrollButtonClick,this),this.scrollDownEl.un("click",this.onScrollButtonClick,this),this.wrapEl.un("mousewheel",this.onMouseWheel,this))},onKeyDown:function(e){var t=e.keyCode;-1!==this.preventDefaultsKeys.indexOf(t)&&e.preventDefault(),-1!==this.stopPropagationKeys.indexOf(t)&&e.stopPropagation(),this.getActiveMenu().navigate(t)},getTplData:function(){var e=this.callParent(arguments);e.hasScrolling=!1,e.loadingCaption=Terrasoft.Resources.Controls.Menu.Loading,e.isMenuLoading=this.isMenuLoading,e.items=this.items,e.needContent=!0,e.isRootMenu=this.isRootMenu,e.renderContent=this.renderContent;var t=this.scrollWrapperClass?this.defaultScrollWrapperClass+" "+this.scrollWrapperClass:this.defaultScrollWrapperClass,r=this.ulClass?this.defaultUlClass+" "+this.ulClass:this.defaultUlClass;return e.scrollWrapperClass=t,e.ulClass=r,this.updateSelectors(e),this.tplData=e,e},updateSelectors:function(e){var t=this.selectors=this.selectors||{};return t.ulEl="#"+this.id+"-list",e.hasScrolling?(t.scrollWrapEl="#"+this.id+"-scroll-wrap",t.scrollUpEl="#"+this.id+"-scroll-up",t.scrollDownEl="#"+this.id+"-scroll-down"):(delete t.scrollWrapEl,delete t.scrollUpEl,delete t.scrollDownEl),t.wrapEl=t.scrollWrapEl||t.ulEl,t.el=t.wrapEl,this.isRootMenu?t.focusEl="#"+this.id+"-focusEl":delete t.focusEl,t},getProgressSpinner:function(){return Ext.isEmpty(this.progressSpinner)&&(this.progressSpinner=Terrasoft.getSpinner("menu-progress")),this.progressSpinner},getItemsHtml:function(){var e=this.items,t=[];return e.each((function(e){var r=e.generateHtml();t.push(r)}),this),t},adjustPosition:function(){var e=this.parentEl;if(e){var t=this.getWrapEl(),r=e.getBox(),n=t.getBox(),i=Ext.getBody().getViewSize(),a=Ext.getScrollbarSize(),s=r.x+n.width+a.width,o=this.alignType,l=0;Ext.isEmpty(o)&&(o=this.defaultAlignType,s>i.width&&(l=i.width-s));var c=this.offset||[l,3];t.alignTo(e,o,c,!1,!1)}},_showAnimation:function(){this.getWrapEl().setStyle("opacity",1),Ext.isEmpty(this.progressSpinner)||this.progressSpinner.show()},onAfterRender:function(){this.callParent(arguments),this.afterRenderOrRerender(),this.adjustPosition(),this.removeUnnecessarySeparators(),this._showAnimation()},onAfterReRender:function(){this.callParent(arguments),this.afterRenderOrRerender(),this.adjustPosition(),this.removeUnnecessarySeparators(),this._showAnimation()},afterRenderOrRerender:function(){this.fixRendering(),this.initScrollEvents(),this.isMenuLoading||this.items.each((function(e){e.visible&&e.fireEvent("afterrender",this,this.wrapEl)}),this),this.isRootMenu&&this.focusMenuTree()},removeUnnecessarySeparators:function(){for(var e=Ext.get(this.id+"-list"),t=e.select("li"),r=t.getCount(),n=[],i=0;i<r;i+=1){var a=Ext.get(t.elements[i]);if(a&&a.hasCls("menu-separator")){var s=Ext.get(t.elements[i+1]);if(s){if(!s.hasCls("menu-separator"))continue}else n.push(a);n.push(a)}}t.removeElement(n,!0);var o=e.child("li");if(o&&o.hasCls("menu-separator")){var l=o.dom.innerText||o.dom.textContent;(l=Ext.String.trim(l)).length?(o.setHTML(l),o.addCls("menu-separator-first")):t.removeElement(o,!0)}},show:function(e,t,r){if(!0!==this.rendered||!this.visible){if(t&&(this.isRootMenu=!1),this.setSelectedItem(null),this.isMenuLoading=!1,this.buttonBox=e||this.buttonBox,this.parentEl=r,!1===this.fireEvent("prepareMenu",this))return this.isMenuLoading=!0,void Ext.Function.defer(this.renderLoading,300,this);this.forceRender()}},hide:function(){if(!1!==this.rendered){var e=this.getWrapEl();Ext.EventManager.purgeElement(e),this.clearDomListeners(),this.removeElementsBySelectors(),this.rendered=!1,this.fireEvent("hide",this);var t=this.selectedItem;if(t){var r=t.menu;r&&r.hide()}}},focusMenuTree:function(){this.getRootMenu().focus()},addItem:function(e,t,r){var n=this.items;return e=this.initItem(e),t||0===t?n.collection.insert(t,e.id,e):n.add(e.id,e),this.rendered&&!r&&e.render(this.ulEl,t),this.fireEvent("add",this,e),e.added(),this.model&&this.bindItem(e,this.model),e},removeItem:function(e){this.items.remove(e),e.destroy(),this.fireEvent("remove",this,e)},removeByIndex:function(e){var t=this.getItemByIndex(e);this.removeItem(t)},moveItem:function(e,t){var r=this.items;if(t>=r.getCount()||t<0)throw new Terrasoft.NullOrEmptyException({message:Terrasoft.Resources.Controls.Menu.IndexOutOfRange});r.remove(e),r.add(e.id,e,t),this.rendered&&this.visible&&this.reRender()},moveUp:function(e){var t=this.items.indexOf(e)-1;this.moveItem(e,t)},moveDown:function(e){var t=this.items.indexOf(e)+1;this.moveItem(e,t)},getRootMenu:function(){return this.rootMenu||this},getItemByIndex:function(e){var t=this.items;if(!t)throw new Terrasoft.NullOrEmptyException({message:Terrasoft.Resources.Controls.Menu.MenuHasNoItems});if(e<0||e>=t.getCount())throw new Terrasoft.ItemNotFoundException({message:Terrasoft.Resources.Controls.Menu.IndexOutOfRange});return t.getByIndex(e)},setSelectedItem:function(e){var t=this.selectedItem;if(t!==e){var r=this.selectedItem=e;if(r&&this.selectedItem.applyMenuSelection(this),t){var n=t.menu;r&&t.menu&&n.hide(),t.applyMenuDeselection(this)}}},setSelectedItemByIndex:function(e){var t=this.getItemByIndex(e);this.setSelectedItem(t)},scroll:function(e){var t=this.ulEl,r=this.scrollWrapEl,n=Number(t.dom.style.top.replace("px","")),i=e>0,a=Math.abs(e),s=0+this.scrollUpEl.getHeight(),o=-1*(t.getHeight()-r.getHeight()+this.scrollDownEl.getHeight()),l=i?n+a:n-a;i&&l>s?l=s:!i&&l<o&&(l=o),l!==n&&t.setStyle({top:l+"px"}),this.setScrollButtonVisibility(this.scrollUpEl,this.canScrollUp()),this.setScrollButtonVisibility(this.scrollDownEl,this.canScrollDown())},scrollToItem:function(e){if(!this.scrollWrapEl)return!1;var t=this.scrollUpEl,r=this.scrollDownEl,n=e.wrapEl,i=t.getBottom(),a=r.getTop(),s=n.getTop(),o=n.getBottom(),l=o>a&&s>i;(l||s<i&&o<a)&&this.scroll(l?a-o:i-s)},onDestroy:function(){var e=this.progressSpinner;e&&e.destroy();var t=this.items;t&&(t.each((function(e){e.destroy()}),this),t.destroy(),delete this.items),this.callParent(arguments)},bind:function(){this.callParent(arguments),this.items.each((function(e){this.bindItem(e,this.model)}),this)},bindItem:function(e,t){e.model||e.bind(t)},getBindConfig:function(){var e=this.callParent(arguments),t={items:{changeMethod:"onCollectionDataLoaded"}};return Ext.apply(t,e),t},subscribeForCollectionEvents:function(e,t,r){var n=r.get(e.modelItem);this.subscribeCollection(n)},subscribeCollection:function(e){e.on("dataLoaded",this.onCollectionDataLoaded,this),e.on("itemChanged",this.onUpdateItem,this),e.on("add",this.onAddItem,this),e.on("remove",this.onDeleteItem,this),e.on("clear",this.clearItems,this),e.each((function(e){var t=e.get(this.defaultItemsName);t instanceof Terrasoft.BaseViewModelCollection&&this.subscribeCollection(t)}),this)},unSubscribeForCollectionEvents:function(e,t,r){if(r){var n=r.get(e.modelItem);this.unSubscribeCollection(n)}},unSubscribeCollection:function(e){e.un("dataLoaded",this.onCollectionDataLoaded,this),e.un("itemChanged",this.onUpdateItem,this),e.un("add",this.onAddItem,this),e.un("remove",this.onDeleteItem,this),e.un("clear",this.clearItems,this),e.each((function(e){var t=e.get(this.defaultItemsName);t instanceof Terrasoft.BaseViewModelCollection&&this.unSubscribeCollection(t)}),this)},onCollectionDataLoaded:function(e){this.clearItems(),e&&e.each((function(e){this.onAddItem(e)}),this)},onUpdateItem:function(e){var t=e.get(this.defaultPrimaryColumnName),r=this.items.get(t),n=this.items.indexOf(r);this.removeItem(r);var i=this.getMenuItemConfig(e);this.addItem(i,n)},onAddItem:function(e){var t=this.getMenuItemConfig(e);this.addItem(t)},onDeleteItem:function(e){var t=e.get(this.defaultPrimaryColumnName),r=this.items.get(t);this.removeItem(r)},clearItems:function(){this.items&&this.items.each((function(e){this.removeItem(e)}),this)},getMenuItemConfig:function(e){var t=e.get(this.defaultPrimaryColumnName);Ext.isEmpty(t)&&this.log(Terrasoft.Resources.Controls.Menu.MenuPrimaryColumnIsEmpty,Terrasoft.LogMessageType.WARNING);var r=e.get(this.defaultVisibleName),n=e.get(this.defaultEnabledName),i={id:t,caption:e.get(this.defaultCaptionName),imageConfig:e.get(this.defaultImageConfigName),className:e.get(this.defaultTypeName),tag:e.get(this.defaultTagName),visible:!!Ext.isEmpty(r)||r,enabled:!!Ext.isEmpty(n)||n,markerValue:e.get(this.defaultMarkerValueName),direction:e.get(this.defaultDirectionName)},a=e.get(this.defaultClickEventName),s=e.get(this.defaultCanExecuteName);a&&(i.click=a),s&&(i[this.defaultCanExecuteName]=s);var o=e.get(this.defaultFileUploadName);o&&(i.fileUpload=o,i.fileTypeFilter=e.get(this.defaultFileTypeFilterName),i.fileUploadMultiSelect=e.get(this.defaultFileUploadMultiSelectName),i.filesSelected=e.get(this.defaultFilesSelectedName));var l=e.get(this.defaultItemsName);if(l){var c=this.getBindConfig(),u=this.initBinding("items",l,c);u&&u.modelItem?i.menu={items:l}:i.menu={items:this.getMenuConfig(l)}}return i},getMenuConfig:function(e){var t=[];return e.each((function(e){t.push(this.getMenuItemConfig(e))}),this),t}}),Ext.define("Terrasoft.controls.mixins.MenuMixin",{alternateClassName:"Terrasoft.MenuMixin",menu:null,menuClass:"Terrasoft.Menu",showMenu:function(e){var t=this.menu,r=(e=e||this.getWrapEl()).getBox();r.y-=3,r.bottom+=3,r.height+=6,t.show(r,null,e),this.initScrollTrackEvents()},initScrollTrackEvents:function(){var e=this.getWrapEl();this.prevPosition=e.getRegion(),this.debounceWindowScroll=this.debounceWindowScroll||Terrasoft.debounce(this.onWindowScroll,50),Ext.EventManager.addListener(window,"scroll",this.debounceWindowScroll,this),Ext.isIE11||Ext.isChrome||Ext.isSafari?Ext.EventManager.addListener(window,"mousewheel",this.debounceWindowScroll,this):Ext.isGecko&&Ext.EventManager.addListener(window,"DOMMouseScroll",this.debounceWindowScroll,this)},unsubscribeWindowScroll:function(){this.debounceWindowScroll&&(Ext.EventManager.removeListener(window,"scroll",this.debounceWindowScroll,this),Ext.isIE11||Ext.isChrome||Ext.isSafari?Ext.EventManager.removeListener(window,"mousewheel",this.debounceWindowScroll,this):Ext.isGecko&&Ext.EventManager.removeListener(window,"DOMMouseScroll",this.debounceWindowScroll,this))},onWindowScroll:function(){var e=this.prevPosition;if(!this.getWrapEl().getRegion().equals(e)){var t=this.menu;Ext.isEmpty(t)||t.hide()}},init:function(){this.addEvents("prepareMenu","hideMenu"),this.initMenu()},initMenu:function(){var e=this.menu;if(e&&!(e instanceof Terrasoft.Menu)){var t=Ext.apply({markerValue:this.markerValue},e);this.menu=Ext.create(this.menuClass,t),this.menu.on("add",this.onMenuItemsChange,this),this.menu.on("remove",this.onMenuItemsChange,this),this.menu.on("prepareMenu",this.onPrepareMenu,this),this.menu.on("hide",this.onHideMenu,this)}},onPrepareMenu:function(){this.fireEvent("prepareMenu")},onHideMenu:function(){this.fireEvent("hideMenu"),this.unsubscribeWindowScroll()},onMenuItemsChange:function(){var e=this.menuWrapEl,t=this.menu.items.getCount();!this.destroyed&&(e&&0===t||!e&&1===t)&&this.reRender()},addMenu:function(e){this.menu||(this.menu=e,this.initMenu(),this.reRender(null))},removeMenu:function(e){var t=this.menu;t&&(this.menu.un("add",this.onMenuItemsChange,this),this.menu.un("remove",this.onMenuItemsChange,this),this.menu.un("prepareMenu",this.onPrepareMenu,this),this.menu.un("hide",this.onHideMenu,this),t.destroy(),this.menu=null,e||this.reRender(null))},bindMenu:function(e){this.menu&&this.menu.bind(e)}}),Ext.ns("Terrasoft.controls.ButtonEnums"),Terrasoft.controls.ButtonEnums.iconAlign={LEFT:"left",RIGHT:"right",TOP:"top",DEFAULT:"left"},Terrasoft.controls.ButtonEnums.style={DEFAULT:"default",GREEN:"green",RED:"red",BLUE:"blue",GREY:"grey",TRANSPARENT:"transparent"},Ext.define("Terrasoft.controls.Button",{extend:"Terrasoft.controls.Component",alternateClassName:"Terrasoft.Button",mixins:{groupable:"Terrasoft.Groupable",fileUpload:"Terrasoft.FileUpload",tooltip:"Terrasoft.Tooltip",menuMixin:"Terrasoft.MenuMixin"},handler:null,caption:null,returnCode:null,name:null,prefix:"t-btn",disabledClass:"t-btn-disabled",pressedClass:"t-btn-pressed",downClass:"t-btn-down",focusClass:"t-btn-focus",loading:!1,loadingClass:"t-btn-loading",tpl:['<tpl if="hasWrapper">','<span id="{id}-wrapperEl" class="{wrapperClass}" style="{wrapperStyle}" tabindex="{tabIndex}" title="{hint}"'," {extraComponentAttributes}>","</tpl>",'<tpl if="hasInnerWrapper">','<span id="{id}-innerWrapperEl" class="{innerWrapperClass}" style="{innerWrapperStyle}">',"</tpl>",'<tpl if="hasImage && !imageAfterText">','<span id="{id}-imageEl" class="{imageClass}" style="{imageStyle}"></span>',"</tpl>",'<tpl if="text">','<span id="{id}-textEl" class="{textClass}" style="{textStyle}"','<tpl if="!hasWrapper">','tabindex="{tabIndex}" {extraComponentAttributes}',"</tpl>",">","{text}",'<tpl if="loading">','<div class="ts-mask-spinner">{progressSpinnerHtml}</div>',"</tpl>","</span>","</tpl>",'<tpl if="hasImage && imageAfterText">','<span id="{id}-imageEl" class="{imageClass}" style="{imageStyle}"></span>',"</tpl>",'<tpl if="menu">','<span id="{id}-menuWrapEl" class="{menuWrapClass}">&nbsp;</span>','<span id="{id}-menuEl" class="{menuClass}" style="{menuStyle}" {menuAttribute}>','<span id="{id}-markerEl" class="{markerClass}" style="{markerStyle}"></span>',"</span>","</tpl>",'<tpl if="hasInnerWrapper"></span></tpl>','<tpl if="hasWrapper"></span></tpl>'],clickDebounceTimeout:0,onAfterRender:function(){this.callParent(arguments),this.fileUpload&&this.mixins.fileUpload.addInputFile.call(this),this.loading&&this.progressSpinner.show()},onAfterReRender:function(){this.callParent(arguments),this.fileUpload&&this.mixins.fileUpload.addInputFile.call(this),this.loading&&this.progressSpinner.show()},checkButtonState:function(){var e=this.getTemplateConfigKey();if(!Terrasoft.Button.templateConfigs[e])throw new Terrasoft.ItemNotFoundException({message:Terrasoft.Resources.Controls.Button.ButtonHasNoTemplateFor+" "+e})},reRender:function(){this.checkButtonState(),this.allowRerender()&&this.callParent(arguments)},getTplData:function(){var e=this.callParent(arguments),t=this.getTemplateConfigKey(),r=Terrasoft.Button.templateConfigs[t];if(!r)throw new Terrasoft.ItemNotFoundException({message:Terrasoft.Resources.Controls.Button.ButtonHasNoTemplateFor+" "+t});e=Ext.apply(e,r,Terrasoft.Button.templateConfigDefaults);var n=[this.getStyleClass(),this.getEnabledClass(),this.getPressedClass(),this.getTooltipClass(),this.getLoadingClass()].join(" ");e.extraComponentAttributes+=this.getContextHelpAttribute()+this.getTagAttribute()+this.getTooltipTextAttribute();var i,a=this.width;if(a){var s="width: "+(a=isNaN(a)?a:a+"px");e.hasWrapper?e.wrapperStyle+=s:e.textStyle+=s}this.imageConfig&&(i=Terrasoft.ImageUrlBuilder.getUrl(this.imageConfig)),e.hasImage=i&&(this.canUseRightAlignImageWithMenu||!(this.menu&&this.iconAlign===Terrasoft.controls.ButtonEnums.iconAlign.RIGHT)),e.imageStyle=i?"background-image: url("+i+");":null,e.hasExtraComponentClasses&&(e.hasWrapper?(e.wrapperClass+=" "+n,e.wrapperStyle=String(e.wrapperStyle)):e.textClass+=" "+n),e.extraComponentStyle=this.getExtraComponentStyle()||"";var o=/t-btn-image-[lefttopright]/;o.test(e.imageClass)||(e.imageClass+=" "+(e.iconAlignClass||this.getIconAlignClass())),e.prefix=this.prefix;var l=this.hasMenu();return e.menu=l?this.menu:null,e.text=Terrasoft.encodeHtml(this.caption),e.loading=this.loading,this.loading&&(e.progressSpinnerHtml=this.progressSpinner.generateHtml()),this.updateSelectors(e),e},style:Terrasoft.controls.ButtonEnums.style.DEFAULT,iconAlign:Terrasoft.controls.ButtonEnums.iconAlign.DEFAULT,imageConfig:null,margin:null,width:null,tag:null,fontStyle:null,contextHelpId:null,pressed:!1,canUseRightAlignImageWithMenu:!1,statics:{templateConfigDefaults:{width:null,extraComponentStyle:"",extraComponentClasses:"",extraComponentAttributes:"",hasExtraComponentClasses:!0,wrapperClass:"t-btn-wrapper",wrapperStyle:"",hasWrapper:!0,hasInnerWrapper:!1,innerWrapperClass:"t-btn-innerWrapper",innerWrapperStyle:"",imageAfterText:!1,imageStyle:"",imageClass:"t-btn-image",textClass:"t-btn-text t-btn-left",textStyle:"",isTextElWrapper:!1,menuClass:"t-btn-menu",menuStyle:"",markerClass:"t-btn-marker",markerStyle:"",menuWrapClass:"t-btn-menuWrap"},templateConfigs:{textMenurightIcon:"textMenu",textMenurightIconWidth:"TextMenuWidth",rightIcon:"leftIcon",topIcon:{iconAlignClass:"t-btn-image-left",imageClass:"t-btn-image margin-right-0px",wrapperClass:"t-btn-wrapper t-btn-no-text-padding"},NoTextNoIconNoMenu:{hasWrapper:!0,hasInnerWrapper:!1,hasImage:!1,text:!1,menu:!1,wrapperClass:"",hasExtraComponentClasses:!1},leftIconCustomImageSize:{},leftIcon:{imageClass:"t-btn-image margin-right-0px",wrapperClass:"t-btn-wrapper t-btn-no-text-padding"},text:{hasWrapper:!1,isTextElWrapper:!0,textClass:"t-btn-wrapper t-btn-text"},menu:{menuClass:"t-btn-menu margin-left-0px",wrapperClass:"t-btn-wrapper t-btn-no-text-padding"},textMenu:{wrapperClass:"t-btn-wrapper wrapper-with-centered-right-menu"},menuleftIcon:{wrapperClass:"t-btn-wrapper wrapper-with-centered-right-menu t-btn-no-text-padding",imageClass:"t-btn-image margin-right-0px"},menutopIcon:{wrapperClass:"t-btn-wrapper wrapper-with-centered-right-menu t-btn-no-text-padding",imageClass:"t-btn-image margin-right-0px t-btn-image-left"},textleftIcon:{wrapperClass:"t-btn-wrapper absolute-vertical-centered padding-left-34px",imageClass:"t-btn-image left-12px"},texttopIcon:{},textrightIcon:{wrapperClass:"t-btn-wrapper wrapper-with-centered-right-image"},textMenuleftIcon:{wrapperClass:"t-btn-wrapper wrapper-with-centered-right-menu t-btn-no-text-padding"},textMenutopIcon:{wrapperClass:"t-btn-wrapper wrapper-with-centered-right-menu"},textWidth:{hasWrapper:!1,isTextElWrapper:!0,textClass:"t-btn-wrapper t-btn-text"},menuWidth:{wrapperClass:"t-btn-wrapper t-btn-wrap-width-fix",hasInnerWrapper:!0,menuClass:"t-btn-menu margin-left-0px"},textMenuWidth:{wrapperClass:"t-btn-wrapper t-btn-wrap-width-fix",hasInnerWrapper:!0,innerWrapperClass:"t-btn-innerWrapper wrapper-with-centered-right-menu padding-right-14px",menuClass:"right-0px"},leftIconWidth:{imageClass:"t-btn-image t-btn-image-left-width",wrapperClass:"t-btn-wrapper t-btn-no-text-padding"},menuleftIconWidth:{wrapperClass:"t-btn-wrapper t-btn-wrap-width-fix",hasInnerWrapper:!0,menuClass:"t-btn-menu margin-left-0px"},textleftIconWidth:{wrapperClass:"t-btn-wrapper t-btn-wrap-width-fix",hasInnerWrapper:!0,innerWrapperClass:"t-btn-innerWrapper wrapper-with-centered-left-image"},texttopIconWidth:{hasInnerWrapper:!0},textrightIconWidth:{wrapperClass:"t-btn-wrapper t-btn-wrap-width-fix",hasInnerWrapper:!0,innerWrapperClass:"t-btn-innerWrapper absolute-vertical-centered padding-right-22px",imageClass:"t-btn-image right-0px"},textMenuleftIconWidth:{wrapperClass:"t-btn-wrapper t-btn-wrap-width-fix",hasInnerWrapper:!0,innerWrapperClass:"t-btn-innerWrapper absolute-vertical-centered padding-right-14px wrapper-with-centered-left-image",menuClass:"right-0px"},textMenutopIconWidth:{hasInnerWrapper:!0,wrapperClass:"t-btn-wrapper",innerWrapperClass:"t-btn-innerWrapper wrapper-with-centered-right-menu padding-right-12px",menuClass:"right-12px",innerWrapperStyle:"padding-right: 12px;"}},getStyleCaption:function(e){var t="ButtonStyle"+Ext.String.capitalize(e);return Terrasoft.Resources.Controls.Button[t]}},init:function(){this.callParent(arguments),this.addEvents("click","imageClick"),this.mixins.fileUpload.constructor.call(this),this.mixins.groupable.constructor.call(this),this.mixins.menuMixin.init.call(this)},getExtraComponentStyle:function(){var e=this.margin;return e?"margin: "+e+";":null},initDomEvents:function(){this.callParent(arguments);var e=this.getWrapEl();e&&e.on({click:{fn:this.onClick,scope:this},focus:{fn:this.onFocus,scope:this},blur:{fn:this.onBlur,scope:this},keydown:{fn:this.onKeyDown,scope:this},mousedown:{fn:this.onMouseDown,scope:this},mouseup:{fn:this.onMouseUp,scope:this}});var t=this.menuWrapEl;t&&t.on("click",this.onMenuClick,this);var r=this.imageEl;r&&r.on("click",this.onImageClick,this)},onImageClick:function(e){if(this.hasListener("imageClick")){if(e.stopEvent(),!this.enabled)return;this.fireEvent("imageClick",this)}},updateSelectors:function(e){this.updateSelector(e.text,"text"),this.updateSelector(e.hasWrapper,"wrapper"),this.updateSelector(e.hasInnerWrapper,"innerWrapper"),this.updateSelector(e.hasImage,"image"),this.updateSelector(e.menu,"menu"),this.updateSelector(e.menu,"marker"),this.updateSelector(e.menu,"menuWrap");var t=this.selectors;return e.hasWrapper?t.wrapEl=t.wrapperEl:t.wrapEl=t.textEl,t.el=t.wrapEl,t},updateSelector:function(e,t){var r=this.selectors;r||(r=this.selectors={}),e?r[t+"El"]="#"+this.id+"-"+t+"El":delete r[t+"El"]},getTemplateConfigKey:function(){var e="";return this.caption&&(e+="Text"),this.hasMenu()&&(e+="Menu"),this.imageConfig&&(e+=this.iconAlign+"Icon"),this.width&&(e+="Width"),e.length>0&&(e=e[0].toLowerCase()+e.substring(1)),""===e?"NoTextNoIconNoMenu":e},getIconAlignClass:function(){var e=this.iconAlign||Terrasoft.controls.ButtonEnums.iconAlign.DEFAULT;return this.prefix+"-image-"+e.toLowerCase()},getStyleClass:function(){var e=this.style;return this.prefix+"-style-"+(e?e.toLowerCase():Terrasoft.controls.ButtonEnums.style.DEFAULT)},getEnabledClass:function(){return this.enabled?"":this.disabledClass},getPressedClass:function(){return this.pressed?this.pressedClass:""},getContextHelpAttribute:function(){var e=this.contextHelpId;return e?" data-contexthelpid = '"+e.toString()+"' ":""},getTagAttribute:function(){var e=this.tag;return e?" data-tag = '"+e.toString()+"' ":""},onMouseDown:function(){this.enabled&&!this.loading&&this.getWrapEl().addCls(this.downClass)},onMouseUp:function(){this.enabled&&!this.loading&&this.getWrapEl().removeCls(this.downClass)},onKeyDown:function(e){if(this.enabled&&!this.loading){var t=e.keyCode;t!==e.ENTER&&t!==e.SPACE||this.onClick(e)}},onFocus:function(){this.getWrapEl().addCls(this.focusClass),this.focused=!0},onBlur:function(){this.getWrapEl().removeCls(this.focusClass),this.focused=!1},onClick:function(e){if(e.stopEvent(),this.enabled&&!this.loading){var t=this.canExecute({method:this.onClick,args:arguments});if(!1!==t){this.clickDebounceTimeout&&(this.setEnabled(!1),setTimeout(function(){this.setEnabled(!0)}.bind(this),this.clickDebounceTimeout));var r=this.hasMenu();if(this.handler||this.hasListener("click")){if(this.handler){var n=Terrasoft.Resources.ObsoleteMessages.ObsoleteMethodMessage;this.log(Ext.String.format(n,"handler","click event")),this.handler()}r=!1===this.fireEvent("click",this,null,null,null)&&r}r&&this.showMenu()}}},onMenuClick:function(e){e.stopEvent(),this.enabled&&!this.loading&&this.showMenu()},setCaption:function(e){if(this.caption!==e)if(""!==e){var t=this.textEl;this.caption=e,t?t.dom.innerHTML=e:this.reRender(null)}else this.removeCaption()},setPressed:function(e){if(this.pressed!==e){this.pressed=e;var t=this.getWrapEl();t&&(!0===e?t.addCls(this.pressedClass):t.removeCls(this.pressedClass))}},removeCaption:function(){this.caption&&(this.caption=null,this.reRender(null))},setImage:function(e,t){this.imageConfig!==e&&(this.imageConfig=e,(t||Ext.isEmpty(this.iconAlign))&&(this.iconAlign=t||Terrasoft.controls.ButtonEnums.iconAlign.DEFAULT),this.reRender(null))},removeImage:function(){this.imageConfig&&(this.imageConfig=null,this.reRender(null))},setIconAlign:function(e){this.iconAlign!==e&&this.imageConfig&&(this.iconAlign=e||Terrasoft.controls.ButtonEnums.iconAlign.DEFAULT,this.reRender(null))},setWidth:function(e){this.width!==e&&(this.width=e,this.reRender(null))},setStyle:function(e){if(this.style!==e){var t=this.getStyleClass();if(this.style=e,this.rendered){var r=this.getWrapEl();r&&(r.removeCls(t),r.addCls(this.getStyleClass()))}}},setFontStyle:function(e){var t=this.textEl;t&&t.applyStyles(e)},clearDomListeners:function(){this.callParent(arguments),this.unsubscribeWindowScroll()},getWidth:function(){return this.width},onDestroy:function(){this.removeMenu(!0),this.fileUpload&&this.mixins.fileUpload.destroy.call(this),this.progressSpinner&&this.progressSpinner.destroy(),this.callParent(arguments)},focus:function(){this.getWrapEl().dom.focus()},getBindConfig:function(){var e=this.callParent(arguments),t={caption:{changeMethod:"setCaption"},pressed:{changeMethod:"setPressed"},imageConfig:{changeMethod:"setImage"},style:{changeMethod:"setStyle"},loading:{changeMethod:"setLoading"}};return this.mixins.fileUpload.addFileUploadBindConfig.call(this,t),this.mixins.tooltip.addTooltipBindConfig.call(this,t),Ext.apply(t,e),t},bind:function(){this.callParent(arguments),this.mixins.menuMixin.bindMenu.call(this,this.model)},hasMenu:function(){return this.menu&&this.menu.items&&this.menu.items.getCount()>0},setLoading:function(e){e=Boolean(e),this.loading!==e&&(this.loading=e,this.rendered&&(this.loading?(this.createProgressSpinner(),this.pressed=!0):this.pressed=!1,this.safeRerender()))},createProgressSpinner:function(){this.progressSpinner||(this.progressSpinner=Terrasoft.getSpinner("ts-mask-spinner"))},getLoadingClass:function(){return this.loading?this.loadingClass:""}}),Ext.define("Terrasoft.controls.CheckBoxEdit",{extend:"Terrasoft.controls.Component",alternateClassName:"Terrasoft.CheckBoxEdit",focused:!1,disabledClass:"t-checkboxedit-disabled",checkedClass:"t-checkboxedit-checked",focusedClass:"t-checkboxedit-focus",defaultWrapClassName:"t-checkboxedit-wrap",hiddenInputClassName:"t-checkboxedit",checked:!1,value:"",tpl:['<span id="{id}-wrapEl" class="{wrapClass}" style="{wrapStyle}">','<input id="{id}-el" value="{value}" class="{hiddenInputClass}" style="{hiddenInputStyle}"','type="{hiddenInputType}" tabindex="{tabIndex}"','<tpl if="name">',' name="{name}"',"</tpl>",'<tpl if="!enabled">',' disabled="disabled"',"</tpl>",">","</span>"],classes:{wrapClass:null,hiddenInputClass:null},styles:{wrapStyle:null,hiddenInputStyle:null},init:function(){this.callParent(arguments),this.addEvents("focus","blur","click","checkedchanged","keypress","keydown","keyup"),this.on("focus",this.onFocus,this),this.on("blur",this.onBlur,this),this.on("click",this.onClick,this),this.on("checkedchanged",this.onCheckedChanged,this)},onDomEvent:function(e){var t=e.type;"click"===t&&(e.stopPropagation(),e.preventDefault()),this.enabled&&this.rendered&&this.visible&&this.fireEvent(t,this,e)},initDomEvents:function(){if(this.callParent(arguments),this.rendered){var e=this.el,t=this.getWrapEl();e.on("focus",this.onDomEvent,this),e.on("blur",this.onDomEvent,this),e.on("click",this.onDomEvent,this),t.on("click",this.onDomEvent,this),e.on("keypress",this.onDomEvent,this),e.on("keydown",this.onDomEvent,this),e.on("keyup",this.onDomEvent,this)}},prepareTplClasses:function(){var e=this.classes,t={wrapClass:[this.defaultWrapClassName],hiddenInputClass:[this.hiddenInputClassName]};return this.checked&&t.wrapClass.push(this.checkedClass),this.enabled||t.wrapClass.push(this.disabledClass),e&&e.wrapClass&&(Ext.isArray(e.wrapClass)?t.wrapClass=t.wrapClass.concat(e.wrapClass):t.wrapClass.push(e.wrapClass)),e&&e.hiddenInputClass&&(Ext.isArray(e.hiddenInputClass)?t.hiddenInputClass=t.hiddenInputClass.concat(e.hiddenInputClass):t.hiddenInputClass.push(e.hiddenInputClass)),t},getTplData:function(){var e=this.callParent(arguments);return e.hiddenInputType="checkbox",e.enabled=this.enabled,e.value=this.value,Ext.apply(e,this.prepareTplClasses()),this.updateSelectors(e),e},updateSelectors:function(){var e=this.selectors=this.selectors||{};return e.wrapEl="#"+this.id+"-wrapEl",e.el="#"+this.id+"-el",e},onFocus:function(){this.focused=!0,this.wrapEl.addCls(this.focusedClass)},onBlur:function(){this.focused=!1,this.wrapEl.removeCls(this.focusedClass)},onClick:function(){this.enabled&&(this.focus(),this.setChecked(!this.checked))},onCheckedChanged:function(e){if(this.visible&&this.rendered){var t=this.checkedClass;!0===e?this.wrapEl.addCls(t):this.wrapEl.removeCls(t)}},focus:function(){this.rendered&&!this.focused&&this.el.focus()},setEnabled:function(e){if(this.enabled!==e&&(this.callParent(arguments),this.rendered)){var t=this.el;Ext.isEmpty(t)||(!0===e?t.dom.removeAttribute("disabled"):t.dom.setAttribute("disabled","disabled"))}},setChecked:function(e){this.checked!==e&&(this.checked=e,this.fireEvent("checkedchanged",e,this))},getValue:function(){return this.checked},getBindConfig:function(){var e=this.callParent(arguments),t={checked:{changeEvent:"checkedchanged",changeMethod:"setChecked"}};return Ext.apply(t,e),t}}),Ext.define("Terrasoft.controls.ToggleEdit",{extend:"Terrasoft.controls.CheckBoxEdit",alternateClassName:"Terrasoft.ToggleEdit",defaultWrapClassName:"toggle-wrap",hiddenInputClassName:"toggle-input",tpl:['<span id="{id}-wrapEl" class="{wrapClass}" style="{wrapStyle}">','<input id="{id}-el" value="{value}" class="{hiddenInputClass}" style="{hiddenInputStyle}"','type="{hiddenInputType}" tabindex="{tabIndex}"','<tpl if="!enabled">',' disabled="disabled"',"</tpl>",">",'<span class="toggle-label"></span>','<span class="toggle-handle"></span>',"</span>"]}),Ext.define("Terrasoft.controls.mixins.Expandable",{alternateClassName:"Terrasoft.Expandable",container:null,offset:null,renderTo:null,useAutoWidth:!1,containerConfig:null,expanded:!1,alignType:null,defaultAlignType:"tl-bl?",getContainerWrapEl:function(){return this.container?this.container.getWrapEl():null},createContainer:function(){var e=this.getContainerConfig()||{};e.classes=e.classes||{wrapClassName:[]},e.classes.wrapClassName=Ext.Array.merge(e.classes.wrapClassName,["expandable","ts-box-sizing"]);var t=Ext.create("Terrasoft.Container",e);return t.on("afterrender",this.adjustContainerPlacement,this),t.on("afterrerender",this.adjustContainerPlacement,this),t},adjustContainerPlacement:function(){this.adjustHeight(),this.useAutoWidth&&this.adjustWidth(),this.adjustPosition()},init:function(){this.addEvents("show","hide","expandedchanged")},destroy:function(){var e=this.container;e&&e.destroy()},adjustHeight:Terrasoft.emptyFn,adjustWidth:function(){if(this.useAutoWidth){var e=this.getAlignEl(),t=this.getContainerWrapEl();if(e&&t&&e.dom&&t.dom){var r=e.getStyle("width"),n=Ext.util.Format.parseBox(r),i=this.getOffset();t.setStyle("width",n.right-i[0]-1+"px")}}},adjustPosition:function(){var e=this.getAlignEl(),t=this.getContainerWrapEl();if(e&&t&&e.dom&&t.dom){var r=this.getOffset(),n=this.alignType||this.defaultAlignType;t.anchorTo(e,n,r,!1,!1),t.removeAnchor()}},getAlignEl:function(){return this.getWrapEl()},getContainerConfig:function(){return this.containerConfig},getContainer:function(){return this.container},getOffset:function(){return this.offset||[1,1]},setExpanded:function(e){this.expanded!==e&&(this.expanded=e,e?this.show():this.hide(),this.fireEvent("expandedchanged",e))},getBindConfig:function(){return{expanded:{changeMethod:"setExpanded",changeEvent:"expandedchanged"}}},show:function(){null===this.container&&(this.container=this.createContainer());var e=this.container;e.visible=!0,e.rendered?e.reRender():e.render(this.renderTo||Ext.getBody()),this.fireEvent("show",{containerId:e.id})},hide:function(){null!==this.container&&(this.container.setVisible(!1),this.fireEvent("hide"))}}),Ext.define("Terrasoft.controls.mixins.ExpandableList",{alternateClassName:"Terrasoft.ExpandableList",timerId:0,maskTimerId:null,isShowAllList:!1,enableLocalFilter:!0,list:null,listView:null,typedValue:"",filterComparisonType:null,minSearchCharsCount:0,searchDelay:0,maxListItemCount:0,maxItemsInView:0,maskDelay:0,listViewConfig:null,listConfig:null,listPrepareEventName:"prepareList",loadNextPageEventName:"loadNextPage",listOffset:null,clearTimer:function(e){null!==this[e]&&(clearTimeout(this[e]),this[e]=null)},init:function(){this.addEvents(this.listPrepareEventName,this.loadNextPageEventName)},destroy:function(){this.list=null;var e=this.listView;e&&e.destroy()},expandList:function(e,t){null===this.listView&&this.createListView(),e=void 0===e?"":e,this.clearTimer("maskTimerId"),this.fireEvent(t||this.listPrepareEventName,e,this.list)||(this.maskTimerId=Ext.defer(this.showLoadMask,this.maskDelay,this));var r=this.getEl();r&&r.focus()},createListView:function(){var e=this.listViewConfig||{},t=this.markerValue;t&&(e.markerValue=t),this.iconsVisible&&(e.iconsVisible=this.iconsVisible),this.maxItemsInView>0&&(e.maxItemsInView=this.maxItemsInView);var r=Ext.create("Terrasoft.ListView",e);return r.on("select",this.onListElementSelected,this),r.on("listViewItemRender",this.onListViewItemRender,this),r.on("loadNextPage",this.onLoadNextPage,this),r.on("hide",this.onHideList,this),this.listView=r,r},onHideList:function(){this.typedValue=""},onLoadNextPage:function(){this.listView.collectionItemsCount=this.list.collection.getCount();var e=this.typedValue,t={list:this.list,filterValue:e,listView:this.listView};this.fireEvent(this.loadNextPageEventName,t)},onListViewItemRender:function(e){this.fireEvent("listViewItemRender",e)},onListElementSelected:function(e){Ext.isEmpty(e)||(this.setValue(e),this.listView.hide())},onFocus:function(){var e=this.getEl();e&&e.dom&&e.dom.value&&e.dom.select()},onBlur:function(){this.enabled&&this.rendered&&(this.focused=!1,this.fireEvent("blur",this),this.fireEvent("focusChanged",this))},onKeyDown:function(e,t){if(this.enabled){t&&!e.isNavKeyPress()&&(this.typedValue=this.getTypedValue());var r=e.getKey(),n=this.listView;if(n&&n.visible)switch(r){case e.DOWN:n.fireEvent("listPressDown");break;case e.UP:n.fireEvent("listPressUp");break;case e.ESC:e.stopPropagation(),this.collapseList()}}},showLoadMask:function(){var e=this.getWrapEl();if(null===this.listView)this.createListView();else if(this.listView.showProgressSpinner&&this.listView.visible&&this.listView.listItems.length<1)return;this.listView.show({alignEl:e,showProgressSpinner:!0,offset:this.listOffset,listItems:[]})},getListViewConfig:function(){return{alignEl:this.getWrapEl(),showProgressSpinner:!1,selectedValue:this.selectedItem,offset:this.listOffset}},loadList:function(e){if(this.clearTimer("maskTimerId"),!1!==this.isVisible()){var t=this.listView,r=!this.isShowAllList;if(this.setListValue(e),t){if(this.processSelectedItem(),this.fireEvent("selectSuggestion"),r){if(!this.getIfNeedFilter())return;e=this.filterList(e)}this.processList(e),this.toggleShowAllListIfTrue()}else this.fireEvent("selectSuggestion")}},setListValue:function(e){this.list=e},processSelectedItem:function(){var e=this.listView,t=e.map.value,r=this.selectedItem?e.convertItemToInitialConfig(this.selectedItem):null;r&&r[t]||this.setSelectedItem(null)},processList:function(e){var t,r=this.listView;e.getCount()>0?(r.loadList(e),t=this.getListViewConfig(),r.show(t)):r.hide()},getIfNeedFilter:function(){var e=this.listView;return!(this.typedValue.length<this.minSearchCharsCount)||(e.visible&&e.hide(),!1)},toggleShowAllListIfTrue:function(){this.isShowAllList&&(this.isShowAllList=!1)},filterList:function(e){var t=this.getFilterComparisonType(),r=Terrasoft.Features.getIsDisabled("DisableExpandableListClientSortByStartWith");return this.enableLocalFilter?e=e.filter(this.listView.map.displayValue,this.typedValue,t,{sortByStartWith:r}):r&&e.sortByStartWith(e,this.listView.map.displayValue,this.typedValue,t),e},getFilterComparisonType:function(){return Ext.isNumber(this.filterComparisonType)?this.filterComparisonType:1===Terrasoft.SysSettings.getCachedSysSetting("StringColumnSearchComparisonType")?Terrasoft.StringFilterType.CONTAIN:Terrasoft.StringFilterType.START_WITH},setSelectedItem:function(e){this.selectedItem=e},setShowAllList:function(){this.isShowAllList=!0},collapseList:function(){var e=this.listView;null!==e&&e.visible&&e.hide()},getBindConfig:function(){return{list:{changeMethod:"loadList"}}},initBinding:function(e,t){var r={};return"value"===e&&t.getValue&&(r.getValue=t.getValue),r},getModelMethod:function(e,t){return e.getValue?t[e.getValue]:t[e.modelItem]},subscribeForEvents:function(e,t,r){if("value"===t){var n=this.bindings;if(!n[this.listPrepareEventName]){var i=n.value.modelItem,a=r.columns[i]||{},s="Terrasoft.LookupEdit"===this.alternateClassName;if(a.isLookup||a.dataValueType===Terrasoft.DataValueType.LOOKUP){var o=[i,s];this.subscribeForControlEvent(this.listPrepareEventName,r[r.defLoadLookupDataMethod],r,o),this.subscribeForControlEvent(this.loadNextPageEventName,r[r.loadLookupDataMethod],r,o)}}e.getValue&&(this.subscribeForPropertyChangeEvent(e,t,r,!0),this.subscribeForDependentPropertiesChangeEvents(e,t,r))}},isEventWithinList:function(e){return!(!e||!this.listView)&&this.listView.isEventWithin(e)}}),Ext.define("Terrasoft.controls.ListView",{extend:"Terrasoft.Component",alternateClassName:"Terrasoft.ListView",listItems:[],listEls:[],selectedItem:null,selectedCssClass:"listview-selected",progressSpinner:null,showProgressSpinner:!1,progressSpinnerCaption:Terrasoft.Resources.Controls.ProgressSpinner.Caption,hasIcons:!1,rowHeight:"40px",correctTopPosition:1,indexOfLastLoadedItem:null,map:{value:"value",displayValue:"displayValue",imageClass:"imageClass",imageConfig:"imageConfig",customHtml:"customHtml",markerValue:"markerValue",isSeparatorItem:"isSeparatorItem",direction:"direction"},alignEl:null,offset:null,useDefSelection:!1,defaultOffset:null,maxItems:15,minItems:3,minWidth:"0px",maxWidth:"0px",styles:{wrapStyle:{}},iconsVisible:!1,bodyScrollLock:!1,bodyScrollTop:0,constructor:function(){this.callParent(arguments),this.addEvents("listPressDown","listPressUp","listPressEnter","listViewItemRender","loadNextPage")},init:function(){this.callParent(arguments),this.defaultOffset=[1,1]},initDomEvents:function(){if(!Ext.isEmpty(this.listItems)){var e=this.getWrapEl(),t=Ext.get(this.id),r=this.listEls=t.select("li, div");e.on("mousedown",this.onWrapElMouseDown,this),e.on("scroll",this.onWrapElScroll,this),r.on("click",this.onSelected,this),r.on("mouseover",this.onMouseOver,this),r.on("mouseout",this.onMouseOut,this),this.on("listPressDown",this.onPressDown,this),this.on("listPressUp",this.onPressUp,this),this.on("listPressEnter",this.onPressEnter,this),Ext.getDoc().on("scroll",this.onDocumentScroll,this);var n=Ext.getBody();n.on("wheel",this.onBodyMouseWheel,this),this.bodyScrollTop=n.getScrollTop()}},clearDomListeners:function(){this.callParent(arguments),this.unSubscribeDocEvents()},unSubscribeDocEvents:function(){Ext.getDoc().un("scroll",this.onDocumentScroll,this),Ext.getBody().un("wheel",this.onBodyMouseWheel,this)},onBodyMouseWheel:function(e){this.isEventWithin(e)||(this.hide(),this.unSubscribeDocEvents())},onDocumentScroll:function(){var e=Ext.getBody();this.bodyScrollLock&&e.setScrollTop(this.bodyScrollTop),this.bodyScrollTop=e.getScrollTop()},onWrapElScroll:function(e){var t=e.currentTarget;this.getIsScrolledToBottom(t)&&this.loadMoreElements()},getIsScrolledToBottom:function(e){return e.clientHeight+Math.ceil(e.scrollTop)>=e.scrollHeight},loadMoreElements:function(){this.indexOfLastLoadedItem=this.listEls.elements.length-1,this.fireEvent("loadNextPage")},onWrapElMouseDown:function(e){e.stopEvent()},getTargetElement:function(e){return"LI"===e.tagName?e:e.parentNode},onSelected:function(e,t){e.stopEvent();for(var r,n=this.getTargetElement(t).getAttribute("data-value"),i=this.listItems,a=0,s=i.length;a<s;a++)if((r=i[a]).value==n){this.fireEvent("select",r);break}},onMouseOver:function(e,t){e.stopEvent();var r=this.selectedItem,n=Ext.get(this.getTargetElement(t));r&&r.removeCls("listview-selected"),n.addCls("listview-selected"),this.selectedItem=n},onMouseOut:function(e){e.stopEvent(),this.selectedItem&&this.selectedItem.hasCls("listview-selected")&&this.selectedItem.removeCls("listview-selected"),this.selectedItem=null},onPressDown:function(){this.changeSelected("down")},onPressUp:function(){this.changeSelected("up")},onPressEnter:function(){var e=this.getListItemsData();1===e.length&&this.selectElement();var t=Ext.getDom(this.selectedItem),r=null;if(t)for(var n,i=t.getAttribute("data-value"),a=0,s=e.length;a<s;a++)if((n=e[a]).value==i){r=n;break}return this.fireEvent("select",r),!0},onAfterRender:function(){this.callParent(arguments),this.adjustMaxHeight(),this._showAnimation()},onAfterReRender:function(){this.callParent(arguments),this.adjustMaxHeight(),this._showAnimation()},_showAnimation:function(){this.getWrapEl().setStyle("opacity",1)},tpl:['<div id="{id}" class="{wrapClass}" style="{wrapStyle}">','<tpl if="listItems">',"<ul>",'<tpl for="listItems">','<tpl if="values.isSeparatorItem">','<div data-value="{value}" data-item-marker="{markerValue}">{customHtml}</div>','<tpl elseif="values.primaryImageVisible">','<li data-value="{value}" data-item-marker="{markerValue}" dir="{direction}">','<div class="listview-left-icon-container">','<tpl if="values.primaryImage">','<img class="listview-left-icon" src={imageUrl}>',"</tpl>","</div>",'<div class="listview-text-container">{customHtml}</div>',"</li>","<tpl else>","<li",'<tpl if="values.imageConfig">',' class="listview-icon"',"</tpl>",'<tpl if="values.imageConfig">'," style=\"background-image: url('","{[Terrasoft.ImageUrlBuilder.getUrl(values.imageConfig)]}","'); \"","</tpl>",' data-value="{value}" data-item-marker="{markerValue}" dir="{direction}"',">",'<tpl if="values.customHtml">',"{customHtml}","<tpl else>","{[Terrasoft.Resources.Core.NotFilledIn]}","</tpl>","</li>","</tpl>","</tpl>","</ul>","</tpl>",'<tpl if="showProgressSpinner">','<div class="listview-progress">','<div class="listview-progress-spinner">{progressSpinner}</div>','<div class="listview-progress-caption">{progressSpinnerCaption}</div>',"</div>","</tpl>","</div>"],getTplData:function(){var e=this.callParent(arguments);this.combineCssStyles();var t={listItems:this.getListItems(),showProgressSpinner:this.showProgressSpinner,progressSpinner:this.getProgressSpinner(),progressSpinnerCaption:Terrasoft.encodeHtml(this.progressSpinnerCaption),wrapClass:this.combineCssClasses()};return Ext.apply(t,e,{}),this.getSelectors(),this.selectedItem=null,t},combineCssClasses:function(){var e=["listview","listview-scroll"];return this.hasIcons&&e.push("listview-with-icons"),this.indexOfLastLoadedItem&&e.push("no-transition"),e},combineCssStyles:function(){var e=this.styles.wrapStyle,t=parseInt(this.minWidth,10)-2,r=parseInt(this.maxWidth,10)-2,n=this.alignEl?this.alignEl.getBox():{};t>0?e["min-width"]=this.minWidth+"px":n.width&&(e["min-width"]=n.width-2+"px"),r>0&&(e["max-width"]=this.maxWidth-2+"px"),this.maxItems&&(e["max-height"]=this.adjustHeight()+"px"),this.styles.wrapStyle=e},getSelectors:function(){return this.selectors={wrapEl:"#"+this.id,el:"#"+this.id},this.selectors},getListItems:function(){var e=this.listItems;return Terrasoft.each(this.listItems,(function(e){this.fireEvent("listViewItemRender",e);var t=e.customHtml;e.customHtml=t||Terrasoft.encodeHtml(e.displayValue),e.imageConfig&&(this.hasIcons=!0);var r=Ext.isEmpty(e.markerValue)?e.displayValue:e.markerValue;e.markerValue=Terrasoft.encodeHtml(Terrasoft.sanitizeHTML(r,Terrasoft.sanitizationLevel.TEXT_ONLY)),e.direction=Terrasoft.getIsRtlMode()?"rtl":"ltr"}),this),e},getListItemsData:function(){return this.listItems},getProgressSpinner:function(){var e=this.progressSpinner;return e||(e=this.progressSpinner=Terrasoft.getSpinner("listview-progress-container")),e.generateHtml()},adjustPosition:function(){var e=this.alignEl,t=this.getWrapEl();if(e&&t&&e.dom&&t.dom){var r=this,n=this.offset||this.defaultOffset;t.anchorTo(e,"tl-bl?",n,!1,!1,(function(){r.correctListTopPosition.call(r)})),t.removeAnchor(),this.scrollToSelectedItem()}},correctListTopPosition:function(){var e=this.getWrapEl(),t=e.dom,r=t.offsetTop,n=t.offsetHeight,i=this.alignEl.dom,a=i.offsetTop,s=i.offsetHeight,o=e.getStyle("top"),l=Ext.util.Format.parseBox(o).top;r===a+s?(l+=this.correctTopPosition,e.setStyle("top",l+"px")):r+n===a&&(l-=this.correctTopPosition,e.setStyle("top",l+"px"))},adjustMaxItems:function(){var e=this.listItems.length,t=this.maxItems-1,r=e<t?e:t;return this.showProgressSpinner&&(t+=r<t?1:-1),t},adjustMaxHeight:function(){var e=this.alignEl;if(e){this.adjustPosition();var t=e.getViewRegion(),r=this.getWrapEl().getViewRegion(),n=Ext.getBody().getViewRegion();if(r.top>n.top&&r.bottom<n.bottom&&r.left>n.left&&r.right<n.right)this.adjustPosition();else{var i=r.bottom-r.top,a=t.top-n.top||0,s=n.bottom-t.bottom||0,o=a>s?a:s,l=parseInt(this.rowHeight,10);i<o&&(o=i);var c=Math.floor(o/l);i>o&&(c-=1);var u=c*l;this.wrapEl.setHeight(u),this.adjustPosition()}}},adjustHeight:function(){return this.adjustMaxItems()*parseInt(this.rowHeight,10)},selectElement:function(){var e=this.selectedValue;if(e){for(var t=this.getWrapEl(),r=Ext.select("li",!0,t.dom).elements,n=r.length,i=0;i<n;i++)if(r[i].dom.getAttribute("data-value")==e.value){r[i].addCls("listview-selected"),this.selectedItem=r[i];break}this.scrollToSelectedItem()}else this.changeSelected("down")},changeSelected:function(e){if(!(this.listItems.length<1)){var t=this.getWrapEl(),r=Ext.select("li",!1,t.dom),n=r.getCount(),i=Ext.select("."+this.selectedCssClass,!1,t.dom).first();if(!i)return"up"===e?i=r.last():"down"===e&&(i=r.first()),i.addCls(this.selectedCssClass),this.selectedItem=i,void this.scrollToSelectedItem();i.removeCls(this.selectedCssClass);var a=r.indexOf(i);a=((a+="down"===e?1:-1)+n)%n,(i=r.item(a)).addCls(this.selectedCssClass),this.selectedItem=i,this.scrollToSelectedItem()}},scrollToSelectedItem:function(){var e=this.listEls.item&&this.listEls.item(this.indexOfLastLoadedItem),t=this.selectedItem||e;if(this.indexOfLastLoadedItem=null,t){var r=this.getWrapEl(),n=r.getConstrainVector(t),i=0;n&&(i=n[1]),r.scroll("bottom",i,!1)}},loadList:function(e){var t=this;if(!Ext.isEmpty(this.map)){this.collection=e;var r=e.getItems(),n=[];Terrasoft.each(r,(function(e){var r=t.convertItemToMapConfig(e);n.push(r)}),this),this.listItems=n}},convertItemToMapConfig:function(e){var t,r,n={},i=this.map;for(t in e)if(e.hasOwnProperty(t)){for(r in i)if(i.hasOwnProperty(r)&&t===i[r]){n[r]=e[t];break}t!==i[r]&&(n[t]=e[t]),this.convertImageConfig(e,n)}return n},convertImageConfig:function(e,t){e.imageConfig||(t.primaryImageVisible=this.iconsVisible&&!e.customHtml,t.primaryImageVisible&&(t.primaryImage=e.Image&&e.Image.value,t.imageConfig={source:Terrasoft.ImageSources.SYS_IMAGE,params:{primaryColumnValue:e.Image&&e.Image.value?e.Image.value:""}},t.imageUrl=Terrasoft.ImageUrlBuilder.getUrl(t.imageConfig)))},convertItemToInitialConfig:function(e){var t,r,n={},i=this.map;for(t in e)if(e.hasOwnProperty(t)){for(r in i)if(i.hasOwnProperty(r)&&t===r){n[i[r]]=e[t];break}t!==r&&(n[t]=e[t])}return n},show:function(e){var t=this;Terrasoft.each(e,(function(e,r){t[r]=e})),this.listItems.length<1&&!1===this.showProgressSpinner||(this.selectedItem=null,this.visible=!0,this.rendered?this.reRender():this.render(this.renderTo||Ext.getBody()),this.useDefSelection&&this.selectElement(),this.bodyScrollLock=!0,this.showProgressSpinner&&this.progressSpinner.show(),this.fireEvent("show"))},hide:function(){this.indexOfLastLoadedItem=null,this.selectedItem=null,this.selectedValue=null,this.bodyScrollLock=!1,this.setVisible(!1),this.fireEvent("hide")},onDestroy:function(){this.progressSpinner&&(this.progressSpinner.destroy(),delete this.progressSpinner),Ext.isEmpty(this.listEls)||this.listEls.each((function(e){e.removeAllListeners(),e.destroy()}),this),this.callParent(arguments)}}),Ext.define("Terrasoft.controls.RadioButton",{extend:"Terrasoft.CheckBoxEdit",alternateClassName:"Terrasoft.RadioButton",disabledClass:"t-radio-disabled",checkedClass:"t-radio-checked",focusedClass:"t-radio-focus",init:function(){this.callParent(arguments),this.checked&&this.setChecked(!0)},onClick:function(){this.checked||this.callParent(arguments)},prepareTplClasses:function(){var e={wrapClass:["t-radio-wrap"],hiddenInputClass:["t-radio"]},t=e.wrapClass;return this.checked&&t.push(this.checkedClass),this.enabled||t.push(this.disabledClass),Ext.isIE&&t.push("ie"),e},getTplData:function(){var e=this.callParent(arguments);return e.hiddenInputType="radio",Ext.apply(e,this.prepareTplClasses()),e},setControlPropertyValue:function(e,t,r){var n=e.config.changeEvent;if("checkedchanged"===n){var i=this.tag,a=i===t;this.callParent([e,a,r])}else this.callParent(arguments)},subscribeForPropertyChangeEvent:function(e,t,r){var n=e.config.changeEvent;if("checkedchanged"===n){var i=e.modelItem,a=this.tag,s=function(e){e&&r.set(i,a)};this.on(n,s);var o=[i],l=function(t,n){this.setControlPropertyValue(e,n,r)};this.toggleSubscriptionForModelEvents(r,null,o,l,this)}else this.callParent(arguments)},setChecked:function(e){e!==this.checked&&(this.checked=e,this.fireEvent("checkedchanged",e,this))}}),Ext.define("Terrasoft.controls.mixins.VoiceToTextButton",{alternateClassName:"Terrasoft.VoiceToTextButton",enableVoiceToTextButton:!1,voiceToTextClasses:[],currentUserCulture:Terrasoft.currentUserCultureName,voiceToTextTpl:['<div id="{id}-voice-to-text-wrapper" class="base-edit-voice-to-text-wrapper">','<div id="{id}-voice-to-text" class="{voiceToTextClasses}">','<ts-voice-to-text-button id="{id}-voice-to-text-component" language="{currentUserCulture}" ></ts-voice-to-text-button>',"</div></div>"],newValueFormatTpl:"{0}. {1}",init:function(){require(["voice-to-text-component"],(function(){})),this.addEvents("speechRecognitionFinished")},renderVoiceToTextButton:function(e,t){var r=t.self;if(r.useVoiceToTextButton()){var n=new Ext.Template(r.voiceToTextTpl).apply({id:r.id,currentUserCulture:r.currentUserCulture||Terrasoft.currentUserCultureName,voiceToTextClasses:r.combineVoiceToTextButtonClasses()});e.push(n)}},combineVoiceToTextButtonClasses:function(){var e=["base-edit-voice-to-text"];return Ext.isEmpty(this.voiceToTextClasses)||(e=Ext.Array.merge(e,this.voiceToTextClasses)),e.join(" ")},useVoiceToTextButton:function(){return this.enableVoiceToTextButton&&Terrasoft.Features.getIsEnabled("UseVoiceToText")},getBindConfig:function(){return{enableVoiceToTextButton:{changeMethod:"setEnableVoiceToTextButton"}}},initVoiceToTextButtonEvents:function(){var e=this.voiceToTextEl;e&&e.on("speechRecognitionFinished",this.onSpeechRecognitionFinished,this)},clearVoiceToTextButtonEvents:function(){var e=this.voiceToTextEl;e&&e.un("speechRecognitionFinished",this.onSpeechRecognitionFinished,this)},combineSelectors:function(e){var t=this.id;return e.voiceToTextEl="#"+t+"-voice-to-text-component",e.voiceToTextWrapperEl="#"+t+"-voice-to-text-wrapper",e},onSpeechRecognitionFinished:function(e){if(this.enabled&&this.rendered){var t=e.browserEvent.detail;this.fireEvent("speechRecognitionFinished",t,this)}},setEnableVoiceToTextButton:function(e){this.enableVoiceToTextButton!==e&&(this.enableVoiceToTextButton=e,this.safeRerender())},formatVoiceValue:function(e,t){return t=Ext.String.capitalize(t),e?Ext.String.format(this.newValueFormatTpl,e,t):t}}),Ext.define("Terrasoft.controls.BaseEdit",{extend:"Terrasoft.controls.Component",alternateClassName:"Terrasoft.BaseEdit",mixins:{clearIcon:"Terrasoft.ClearIcon",predictableIcon:"Terrasoft.PredictableIcon",voiceToTextButton:"Terrasoft.VoiceToTextButton",passwordIcon:"Terrasoft.PasswordIcon"},el:null,isLinkMode:!1,openLinkInNewTab:!1,disableInputDrop:!1,_validationEventName:null,inputType:"text",validationInfo:null,tpl:['<div id="{id}-wrap" class="{wrapClass}" style="{wrapStyle}">',"{%this.renderLeftIcon(out, values)%}",'<tpl if="showValueAsLink">','<div id="{id}-link-wrap" class="{linkWrapClass}" >','<a id="{id}-link-el" class="{linkClass}" href="{href}" style="{linkStyle}"','<tpl if="direction"> dir="{direction}"</tpl>','<tpl if="openLinkInNewTab"> target="_blank"</tpl>'," >{value}</a>","</div>","</tpl>",'<input id="{id}-el" class="{editInputClass}" type="{inputType}" placeholder="{placeholder}" {disabled}','<tpl if="direction"> dir="{direction}"</tpl>',' {readonly} value="{value}" style="{inputStyle}" tabindex="{tabIndex}" autocomplete="{autocomplete}">','<tpl if="hasClearIcon">',"{%this.renderClearIcon(out, values)%}","</tpl>",'<div id="{id}-disabled-el-icon" class="{disabledElIconClass}"></div>',"{%this.renderRightIcon(out, values)%}","{%this.renderPasswordIcon(out, values)%}","{%this.renderVoiceToTextButton(out, values)%}",'<span id="{id}-validation" class="{validationClass}" style="{validationStyle}">{validationText}</span>',"{%this.renderPredictableIcon(out, values)%}","</div>"],autocomplete:"off",value:"",width:"",height:"",placeholder:"",fontSize:"",fontFamily:"",readonly:!1,disabledClass:"base-edit-disabled",readonlyClass:"base-edit-readonly",errorClass:"base-edit-error",focusClass:"base-edit-focus",bigSize:!1,isRequired:!1,focused:!1,href:"",showValueAsLink:!1,hasClearIcon:!1,enablePredictableIcon:!1,linkWrapClass:"base-edit-link-wrap",notVisibleClass:"base-edit-input-not-visible",internalSetFocused:function(e){this.rendered&&(e?this.setCaretToLastPosition():this.getEl().blur())},_setColumnRequiredIfVisible:function(e){e.isRequiredOnPage=Boolean(this.isRequired&&this.isVisible())},_setTooltipValidationMessage:function(e){var t=this.validationEl.dom;t&&t.setAttribute("title",e)},_subscribeOnValueColumnChange:function(e,t,r){var n=e.config.validationMethod;if(n){var i=this[n];r.validationInfo.on("change:"+e.modelItem,(function(e,t){i.call(this,t)}),this);var a=r.validationInfo.get(e.modelItem);a&&i.call(this,a)}},_unsubscribeOnColumnValidation:function(){this.model&&this._validationEventName&&this.model.un(this._validationEventName,this._setColumnRequiredIfVisible,this)},_subscribeOnColumnValidation:function(e,t,r){var n=r.columns||[],i=e.modelItem,a=n[i];a&&(this._validationEventName="validate:"+i,r.on(this._validationEventName,this._setColumnRequiredIfVisible.bind(this,a),this))},init:function(){this.callParent(arguments),this.validationInfo||(this.validationInfo={isValid:!0,invalidMessage:""}),this.addEvents("keypress","keydown","keyup","focus","blur","change","enterkeypressed","editenterkeypressed","linkmodechange","linkclick","linkmouseover"),this.enableBubble("editenterkeypressed"),this.on({focus:{fn:this.applyHighlight,scope:this},blur:{fn:this.onWrapBlur,scope:this},linkmodechange:{fn:this.onLinkModeChange,scope:this}}),this.hasClearIcon&&this.mixins.clearIcon.init.call(this),this.enablePredictableIcon&&this.mixins.predictableIcon.init.call(this),this.canUseVoiceToTextButton()&&this.mixins.voiceToTextButton.init.call(this)},canUseVoiceToTextButton:function(){return Ext.isFunction(this.useVoiceToTextButton)&&this.useVoiceToTextButton()},getTplData:function(){var e=this.callParent(arguments),t=this.getInitValue();e.renderLeftIcon=this.renderLeftIcon||Ext.emptyFn,e.renderRightIcon=this.renderRightIcon||Ext.emptyFn,e.renderPasswordIcon=this.renderPasswordIcon||Ext.emptyFn,e.renderClearIcon=this.renderClearIcon||Ext.emptyFn,e.renderPredictableIcon=this.renderPredictableIcon,e.renderVoiceToTextButton=this.renderVoiceToTextButton||Ext.emptyFn,e.direction=Terrasoft.getTextDirection(t);var r={inputType:this.inputType,disabled:this.getDisabled(),readonly:this.getReadonly(),placeholder:Terrasoft.encodeHtml(this.placeholder),value:t,hasClearIcon:this.hasClearIcon,showValueAsLink:this.showValueAsLink,openLinkInNewTab:this.openLinkInNewTab,href:this.href,autocomplete:this.autocomplete};return Ext.apply(r,e,{}),Ext.apply(r,this.combineClasses(),{}),this.styles=this.combineStyles(),this.selectors=this.combineSelectors(),r},combineClasses:function(){var e={wrapClass:["base-edit","ts-box-sizing"],validationClass:["base-edit-validation"],disabledElIconClass:["base-edit-disabled-el-icon"],editInputClass:["base-edit-input","ts-box-sizing"]},t=e.wrapClass;return this.validationInfo.isValid||t.push("base-edit-error"),this.bigSize&&t.push("base-edit-big"),this.useLeftIcon&&this.useLeftIcon()&&t.push(this.editWithLeftIconClass),this.useRightIcon&&this.useRightIcon()&&t.push("base-edit-with-right-icon"),this.usePasswordIcon&&this.usePasswordIcon()&&t.push("base-edit-with-password-icon"),this.useVoiceToTextButton&&this.useVoiceToTextButton()&&t.push("base-edit-with-voice-to-text-icon"),this.enablePredictableIcon&&this.predictableState&&this.predictableState.state!==Terrasoft.PredictableState.INPROGRESS&&t.push(this.predictableWrapClass),this.hasClearIcon&&this.combineWrapClasses(e),this.enabled||t.push(this.disabledClass),this.readonly&&t.push(this.readonlyClass),this.combineLinkClasses(e)},combineLinkClasses:function(e){if(this.showValueAsLink){var t=e.linkWrapClass=[];t.push(this.linkWrapClass);var r=e.editInputClass;(e.linkClass=[]).push("base-edit-link"),this.hasLinkValue()?r.push(this.notVisibleClass):t.push(this.notVisibleClass)}return e},combineStyles:function(){var e={wrapStyle:{},inputStyle:{},validationStyle:{}},t=this.width?this.width:"",r=this.height?this.height:"",n=this.fontSize,i=this.fontFamily,a=e.wrapStyle,s=e.inputStyle,o=e.validationStyle;return t&&(a.width=t),r&&(a.height=r),n&&(s.fontSize=n),i&&(s.fontFamily=i),this.validationInfo.isValid||(o.display="block"),e},combineSelectors:function(){var e=this.id,t={wrapEl:"#"+e+"-wrap",el:"#"+e+"-el",validationEl:"#"+e+"-validation",disabledElIconEl:"#"+e+"-disabled-el-icon"};return this.useLeftIcon&&this.useLeftIcon()&&(t.leftIconEl="#"+e+"-left-icon"),this.hasClearIcon&&this.mixins.clearIcon.combineSelectors.call(this,t),this.useRightIcon&&this.useRightIcon()&&(t.rightIconEl="#"+e+"-right-icon",t.rightIconWrapperEl="#"+e+"-right-icon-wrapper"),this.usePasswordIcon&&this.usePasswordIcon()&&this.mixins.passwordIcon.combineSelectors.call(this,t),this.canUseVoiceToTextButton()&&this.mixins.voiceToTextButton.combineSelectors.call(this,t),this.showValueAsLink&&(t.linkEl="#"+e+"-link-el",t.linkWrapEl="#"+e+"-link-wrap"),t},initDomEvents:function(){this.callParent(arguments);var e=this.validationInfo,t=this.getEl();t.on({focus:{fn:this.onFocus,scope:this},blur:{fn:this.onBlur,scope:this},keydown:{fn:this.onKeyDown,scope:this},keypress:{fn:this.onKeyPress,scope:this},keyup:{fn:this.onKeyUp,scope:this}}),this.disableInputDrop&&(t.on("dragover",this.onDragOver,this),t.on("drop",this.onDrop,this)),Ext.supports.Placeholder||this.emulatePlaceholder(),this.useLeftIcon&&this.useLeftIcon()&&this.initLeftIconEvents(),this.useRightIcon&&this.useRightIcon()&&this.initRightIconEvents(),this.usePasswordIcon&&this.usePasswordIcon()&&this.initPasswordIconEvents(),this.canUseVoiceToTextButton()&&(this.on("speechRecognitionFinished",this.voiceToTextRecognitionFinished,this),this.mixins.voiceToTextButton.initVoiceToTextButtonEvents.call(this)),this.enablePredictableIcon&&this.mixins.predictableIcon.initDomEvents.call(this),this.mixins.clearIcon.initDomEvents.call(this),e.isValid||this.showValidationMessage(e.invalidMessage),this.subscribeLinkEvent()},voiceToTextRecognitionFinished:function(e,t){var r=this.getValue(),n=this.formatVoiceValue(r,e);this.setValue(n)},onDrop:function(e){return e.preventDefault(),!1},onDragOver:function(e){e.preventDefault();var t=e.browserEvent&&e.browserEvent.dataTransfer;t&&(t.dropEffect="none")},onAfterRender:function(){this.callParent(arguments),this.setClearIconVisibility(),this.internalSetFocused(this.focused)},onAfterReRender:function(){this.callParent(arguments),this.setClearIconVisibility()},subscribeLinkEvent:function(){if(this.showValueAsLink){this.getWrapEl().on("click",this.onClick,this);var e=this.getLinkEl();e.on("click",this.onLinkClick,this),e.on("mouseover",this.onLinkMouseOver,this)}},onLinkMouseOver:function(e,t){this.fireEvent("linkmouseover",{targetId:t.id})},onLinkClick:function(e){!1===this.fireEvent("linkclick",this,this.href)&&e.stopEvent()},onLinkModeChange:function(e,t){if(!this.isLinkMode||!this.readonly){var r=this.getEl(),n=this.getLinkWrapEl();t?(n.removeCls(this.notVisibleClass),r.addCls(this.notVisibleClass)):(n.addCls(this.notVisibleClass),r.removeCls(this.notVisibleClass))}},setValidationInfo:function(e){this.validationInfo!==e&&(this.validationInfo=e,this.rendered&&this.setMarkOut())},setLinkValue:function(e){var t=Terrasoft.sanitizeHTML(e&&e.url||"",Terrasoft.sanitizationLevel.TEXT_ONLY);if(e&&this.href!==t){var r=Terrasoft.encodeHtml(e.caption)||"";if(this.href=t,this.rendered&&this.showValueAsLink){var n=this.getLinkEl();n.set({href:this.href}),n.setHTML(r),this.setLinkMode(!Ext.isEmpty(this.href)&&!Ext.isEmpty(r))}}},setShowValueAsLink:function(e){this.showValueAsLink!==e&&(this.showValueAsLink=e,this.safeRerender())},setOpenLinkInNewTab:function(e){this.openLinkInNewTab!==e&&(this.openLinkInNewTab=e,this.safeRerender())},verifySelectors:function(){var e=this.callParent(arguments);return e=!!this.selectors.el&&e},getInitValue:function(){return Terrasoft.encodeHtml(this.value||"")},getDisabled:function(){return this.enabled?"":"readonly = 'readonly'"},getReadonly:function(){return this.readonly?"readonly = 'readonly'":""},applyHighlight:function(){this.getWrapEl().addCls(this.focusClass)},removeHighlight:function(){this.getWrapEl().removeCls(this.focusClass)},setLinkMode:function(e){this.showValueAsLink&&(this.isLinkMode=e,this.fireEvent("linkmodechange",this,e))},onWrapBlur:function(){this.removeHighlight(),this.setLinkMode(!Ext.isEmpty(this.href)),this.setFocused(!1)},onFocus:function(){this.enabled&&this.rendered&&(this.focused=!0,this.fireEvent("focus",this),this.fireEvent("focusChanged",this))},onBlur:function(){if(this.enabled&&this.rendered){var e=this.getTypedValue();this.changeValue(e),this.focused=!1,this.fireEvent("blur",this),this.fireEvent("focusChanged",this)}},onClick:function(e){if(this.enabled&&!this.readonly){var t=this.getLinkEl();t&&!e.within(t.el)&&(this.setLinkMode(!1),this.focused||this.setFocused(!0))}},setMarkOut:function(){if(this.rendered){var e=this.getValidationEl();if(e){var t=this.getWrapEl(),r=this.errorClass,n=this.validationInfo;e.setStyle("width",""),n.isValid?(t.removeCls(r),this.showValidationMessage("")):(t.addCls(r),this.showValidationMessage(n.invalidMessage));var i=t.getWidth();e.getWidth()>i&&e.setWidth(i),e.setVisible(!n.isValid)}}},onKeyDown:function(e){if(this.enabled){var t=e.getKey();t===e.ENTER&&this.onEnterKeyPressed(),this.fireEvent("keydown",this,e),t===e.ESC&&(e.stopPropagation(),this.setFocused(!1))}},onKeyPress:function(e){this.enabled&&this.fireEvent("keypress",this,e)},onKeyUp:function(e){this.enabled&&this.fireEvent("keyup",this,e)},emulatePlaceholder:function(){var e=this,t=this.getEl(),r=t.getAttribute("placeholder");!this.getValue()&&r&&(t.dom.value=r,t.addCls("base-edit-placeholder"));this.on("focus",(function(){var t=e.getEl(),n=e.getValue();t.hasCls("base-edit-placeholder")&&(n===r&&(t.dom.value=""),t.removeCls("base-edit-placeholder"))}),this),this.on("blur",(function(){var t=e.getEl();!e.getValue()&&r&&(t.dom.value=r,t.addCls("base-edit-placeholder"))}),this)},onEnterKeyPressed:function(){var e=this.getTypedValue(),t=this.changeValue(e);this.fireEvent("enterkeypressed",this),t||this.fireEvent("editenterkeypressed",this)},changeValue:function(e){var t=e!==this.getValue();return t&&(this.value=e,this.fireEvent("change",e,this),this.setClearIconVisibility()),t},setDomValue:function(e){var t=this.getEl();Ext.isEmpty(t)||(t.dom.value=e)},onDestroy:function(){this.mixins.clearIcon.destroy.call(this),this.mixins.predictableIcon.destroy.call(this),this._unsubscribeOnColumnValidation(),this.callParent(arguments)},subscribeForEvents:function(e,t,r){this.callParent(arguments),"value"===t&&r.canValidate&&(this._subscribeOnValueColumnChange(e,t,r),this._subscribeOnColumnValidation(e,t,r))},hasLinkValue:function(){return!Ext.isEmpty(this.href)&&!Ext.isEmpty(this.getInitValue())},getBindConfig:function(){var e=this.callParent(arguments),t={value:{changeEvent:"change",changeMethod:"setValue",validationMethod:"setValidationInfo"},isRequired:{changeMethod:"setRequired"},readonly:{changeMethod:"setReadonly"},focused:{changeEvent:"focusChanged",changeMethod:"setFocused"},placeholder:{changeMethod:"setPlaceholder"},showValueAsLink:{changeMethod:"setShowValueAsLink"},openLinkInNewTab:{changeMethod:"setOpenLinkInNewTab"},href:{changeMethod:"setLinkValue"}};return Ext.apply(e,t),Ext.apply(e,this.mixins.predictableIcon.getBindConfig()),e},getEl:function(){return this.el},getLinkEl:function(){return this.linkEl},getLinkWrapEl:function(){return this.linkWrapEl},getValidationEl:function(){return this.validationEl},showValidationMessage:function(e){this.validationEl.update(e),this._setTooltipValidationMessage(e)},setValue:function(e){var t=this.changeValue(e);return this.rendered&&t&&(e=e||"",this.setDomValue(e),this.setElementDirection(this.getEl(),this.value),this.setElementDirection(this.getLinkEl(),this.value)),t},setElementDirection:function(e,t){if(e&&e.dom){var r=Terrasoft.getTextDirection(t);r&&e.dom.setAttribute("dir",r)}},getValue:function(){return this.value},getTypedValue:function(){return this.rendered?this.getEl().dom.value:null},getLeftIconEl:function(){if(this.useLeftIcon&&this.useLeftIcon())return this.leftIconEl},getRightIconEl:function(){if(this.useRightIcon&&this.useRightIcon())return this.rightIconEl},getPasswordIconEl:function(){if(this.usePasswordIcon&&this.usePasswordIcon())return this.passwordIconEl},showLeftIcon:function(e){this.useLeftIcon&&this.useLeftIcon()&&this.enableLeftIcon!==e&&(this.enableLeftIcon=e,this.safeRerender())},showRightIcon:function(e){this.useRightIcon&&this.useRightIcon()&&this.enableRightIcon!==e&&(this.enableRightIcon=e,this.safeRerender())},setRequired:function(e){this.isRequired!==e&&(this.isRequired=e)},setReadonly:function(e){if(this.readonly=e,this.rendered){var t=this.getEl(),r=this.getWrapEl();e?(r.addCls(this.readonlyClass),t.set({readonly:"readonly"})):(r.removeCls(this.readonlyClass),t.set({readonly:void 0}))}},setEnabled:function(e){if(this.callParent(arguments),this.enabled=e,this.rendered){var t=this.getEl(),r=this.getWrapEl();Ext.isEmpty(r)||(e?(r.removeCls(this.disabledClass),t.dom.removeAttribute("readonly")):(r.addCls(this.disabledClass),t.set({readonly:"readonly"})))}},setWidth:function(e){this.width!==e&&(this.width=e,this.rendered&&this.getWrapEl().setWidth(e))},getWidth:function(){return this.rendered?this.getWrapEl().getWidth():this.width},setHeight:function(e){this.height!==e&&(this.height=e,this.rendered&&this.getWrapEl().setHeight(e))},getHeight:function(){return this.rendered?this.getWrapEl().getHeight():this.height},clearDomListeners:function(){this.callParent(arguments);var e=this.getEl();e&&(e.un("keydown",this.onKeyDown,this),e.un("keypress",this.onKeyPress,this),e.un("keyup",this.onKeyUp,this),e.un("blur",this.onBlur,this),e.un("focus",this.onFocus,this),this.disableInputDrop&&(e.un("dragover",this.onDragOver,this),e.un("drop",this.onDrop,this)));var t=this.getWrapEl();t&&t.un("click",this.onClick,this);var r=this.getLinkEl();r&&(r.un("click",this.onLinkClick,this),r.un("linkmouseover",this.onLinkMouseOver,this)),this.mixins.clearIcon.clearDomListeners.call(this),this.enablePredictableIcon&&this.mixins.predictableIcon.clearDomListeners.call(this),this.canUseVoiceToTextButton()&&(this.un("speechRecognitionFinished",this.voiceToTextRecognitionFinished,this),this.mixins.voiceToTextButton.clearVoiceToTextButtonEvents.call(this))},setFocused:function(e){this.focused!==e&&Ext.isBoolean(e)&&(this.focused=e,this.internalSetFocused(e))},setCaretToLastPosition:function(){var e=this.getEl(),t=e.getValue(),r=0;t.length>0&&(r=t.length),Terrasoft.utils.dom.setCaretPosition(e.dom,r)},setPlaceholder:function(e){if(this.placeholder!==e&&(this.placeholder=e,this.rendered)){var t=this.getEl();Ext.supports.Placeholder?t.set({placeholder:this.placeholder||void 0}):t.hasCls("base-edit-placeholder")&&(t.dom.value=this.placeholder||"")}}}),Ext.define("Terrasoft.controls.InlineTextEdit",{extend:"Terrasoft.controls.BaseEdit",alternateClassName:"Terrasoft.InlineTextEdit",mixins:{sanitizeHtml:"Terrasoft.SanitizeHtml"},editor:null,errorClass:"inline-text-edit-error",placeholderClassName:"inline-text-edit-placeholder",styles:{wrapStyles:null,elStyles:null,validationStyle:null},classes:{wrapClasses:["inline-text-edit-wrap"],elClasses:["inline-text-edit-el"],validationClasses:["inline-text-edit-validation"]},tpl:['<div id="{id}-inline-text-edit-wrap" style="{wrapStyles}" class="{wrapClasses}" data-placeholder="{placeholder}">','<div tabindex="0" id="{id}-inline-text-edit-el" style="{elStyles}" class="{elClasses}" contenteditable = "{canEdit}">',"{value}","</div>",'<span id="{id}-validation" class="{validationClasses}" style="{validationStyle}">',"{validationText}","</span>","</div>"],selectedText:null,ckeditorDefaultConfig:{allowedContent:!0,keystrokes:[[1114187,"link"]]},colorBtn:null,styleEditDomId:null,colorRegExp:null,hasFullScreen:!1,hasTableEdit:!1,hasMacrosButton:!0,showEmailTemplateLinkButton:!1,preventEnterPress:!1,sanitizationLevel:Terrasoft.sanitizationLevel.DEFAULT,useDefaultFontFamily:!0,defaultFontFamily:null,_initReadOnlyMode:function(){!this.editor.readOnly!==this.enabled&&this.setEnabled(this.enabled)},_onDialogDefinition:function(e){var t=e.data.name,r=e.data.definition;if("link"===t){var n=this;r.onFocus=function(){var e=this.getContentElement("info","linkType"),t=Ext.get(e.domId);n.createColorButton(t,this)}}},_getStylesEdit:function(e){if(!Ext.isEmpty(e)){var t=e.getContentElement("advanced","advStyles");this.styleEditDomId=t.domId}return Ext.get(this.styleEditDomId).select("input").first()},_getSelectedTextColor:function(){var e=this.editor.getSelection(),t=e&&e.getStartElement();if(this.editor.elementPath(t)){var r="",n=e&&e.getRanges()[0];if(n)for(var i=new CKEDITOR.dom.walker(n),a=n.collapsed?n.startContainer:i.next();a&&!r;)a.type!==CKEDITOR.NODE_ELEMENT&&(a=a.getParent()),r=CKEDITOR.tools.convertRgbToHex(a.getComputedStyle("color")||""),a=i.next();return r}},_preventEnterButtonPressed:function(e){var t=e.data.keyCode;13!==t&&t!==CKEDITOR.SHIFT+13||e.cancel()},_setDefaultFontFamily:function(e,t){if(!Terrasoft.SysSettings||!this.useDefaultFontFamily)return Ext.callback(e,t||this);Terrasoft.SysSettings.querySysSettingsItem("CKEditorDefaultFont",(function(r){this.defaultFontFamily=r,this.el&&this.el.setStyle("font-family",r),Ext.callback(e,t||this)}),this)},_addDefaultStyles:function(e){if(!this.useDefaultFontFamily||Ext.isEmpty(this.defaultFontFamily)||Ext.isEmpty(e))return e;var t=Ext.String.format("<font face='{0}'>",this.defaultFontFamily);return 0===e.indexOf(t)?e:Ext.String.format("<font face='{0}'>{1}</font>",this.defaultFontFamily,e)},init:function(){this.callParent(arguments),this.colorRegExp=new RegExp(/color(\s?):(\s?)#(?:[0-9a-fA-F]{2}){2,4}/),this.addEvents("macrobuttonclicked","emailtemplatelinkclicked","selectedtextchanged","selectedtextсhanged","editorInstanceReady")},onEnterKeyPressed:Terrasoft.emptyFn,onSelectionChange:function(){var e=this.editor.getSelection();if(!Ext.isEmpty(e)){var t=e.getSelectedText();this.updateSelectedText(t)}},onContentDom:function(){this.el.on("click",this.onSelectionChange,this),this.el.on("keyup",this.onSelectionChange,this)},onMacroButtonClicked:function(e){this.fireEvent("macrobuttonclicked",this,e.data)},onEmailTemplateLinkClicked:function(e){this.fireEvent("emailtemplatelinkclicked",this,e.data)},updateSelectedText:function(e){e!==this.selectedText&&(this.selectedText=e,this.fireEvent("selectedtextсhanged",this.selectedText,this),this.fireEvent("selectedtextchanged",this.selectedText,this))},onInstanceReady:function(){this._initReadOnlyMode(),this.fireEvent("editorInstanceReady",this)},getLinkColor:function(e){var t=this._getStylesEdit(e).dom.value.match(this.colorRegExp),r="#0000EE";t&&t.length>0&&(r=t[0].replace(new RegExp(/color(\s?):(\s?)/),""));return r},createColorButton:function(e,t){this.colorBtn&&this.colorBtn.destroy();var r=this.getLinkColor(t),n=Ext.create("Terrasoft.Container",{classes:{wrapClassName:["link-color-button-wrap"]},items:[]}),i=Ext.create("Terrasoft.ColorButton",{markerValue:"LinkColorButton",menuItemClassName:Terrasoft.MenuItemType.COLOR_PICKER,defaultValue:r});i.on("change",this.onColorSelected,this);var a=Terrasoft.Resources.ExternalLibraries.CKEditor.ColorButtonCaption||"Link color";n.add(Ext.create("Terrasoft.Label",{markerValue:"LinkColorLabel",caption:a})),n.add(i),this.colorBtn=n,n.render(e)},onColorSelected:function(e){var t=this._getStylesEdit(),r="{0}color: {1}{2}",n=t.dom.value;n=this.colorRegExp.test(n)?n.replace(this.colorRegExp,Ext.String.format(r,"",e,"")):Ext.isEmpty(n)?Ext.String.format(r,"",e,";"):n.replace(new RegExp(";$"),"")+Ext.String.format(r,";",e,";"),t.dom.value=n},initInlineEditor:function(){if(this.el){this._setDefaultFontFamily();var e=this.ckeditorDefaultConfig;e.showEmailTemplateLinkButton=this.showEmailTemplateLinkButton,e.sanitizationLevel=this.sanitizationLevel,this.showEmailTemplateLinkButton&&(this.ckeditorDefaultConfig.removeButtons+=",Link"),this.editor=CKEDITOR.inline(this.el.id,e),this.subscribeEditorEvents(),this.initEditor(),this.initExtraPluginsToolbar()}},subscribeEditorEvents:function(){this.editor.on("contentDom",this.onContentDom,this),this.editor.on("instanceReady",this.onInstanceReady,this),this.editor.on("key",this.onKey,this),CKEDITOR.on("dialogDefinition",this._onDialogDefinition,this)},initExtraPluginsToolbar:function(){this.showEmailTemplateLinkButton&&this.createButton("bpmonlineemailtemplatelink",this.onEmailTemplateLinkClicked),this.hasMacrosButton&&this.createButton("bpmonlinemacros",this.onMacroButtonClicked),this.hasTableEdit&&this.createButton("bpmonlinetable",Terrasoft.emptyFn),this.hasFullScreen&&this.createButton("maximaze",this.toggleMaximize),this.editor.on("BpmonlineTextColorClick",this.onBpmonlineTextColorClick,this)},onBpmonlineTextColorClick:function(e){var t=new Terrasoft.Menu({items:[{className:Terrasoft.MenuItemType.COLOR_PICKER,defaultValue:this._getSelectedTextColor()||"#444444"}]});t.items.first().on("colorSelected",this.onTextColorSelected,this);var r=e.data,n=Ext.get(r);t.show(null,null,n)},onTextColorSelected:function(e,t){Terrasoft.defer((function(){var e=this.editor;if(e.fire("saveSnapshot"),e.removeStyle(new CKEDITOR.style(e.config.colorButton_foreStyle,{color:"inherit"})),t){var r=e.config.colorButton_foreStyle;r.childRule=function(e){return!(e.is("a")||e.getElementsByTag("a").count())||"false"===e.getAttribute("contentEditable")||e.getAttribute("data-nostyle")},e.applyStyle(new CKEDITOR.style(r,{color:t}))}e.fire("saveSnapshot")}),this)},getFullscreenContainer:function(){return this.getWrapEl().parent().parent()},toggleMaximize:function(){this.getFullscreenContainer().toggleCls("maximized");var e=this.editor.focusManager;e.blur(),e.focus(),this.editor.fire("toggle_maximized")},createButton:function(e,t,r){var n=e+"click";r=r||[e],this.editor.on(n,t,this);var i=this.editor.config;i.toolbar.push({name:e,items:r}),i.toolbarGroups.push({name:e}),i.extraPlugins+=","+e},initEditor:function(){var e=this.editor.config;e.toolbar=[],e.toolbarGroups=[],e.extraPlugins=""},destroyInlineEditor:function(){if(this.editor){if(this.editor.loaded)this.editor.destroy();else{var e=CKEDITOR.instances[this.editor.name];e.on("loaded",(function(){this.destroy()}),e)}this.colorBtn&&this.colorBtn.destroy(),this.editor=null}},onKey:function(e){this.preventEnterPress&&this._preventEnterButtonPressed(e)},getTplData:function(){var e=this.callParent(arguments),t=Terrasoft.encodeHtml(this.placeholder);return Ext.apply(e,{canEdit:!this.readonly,value:this.value,placeholder:t}),Ext.isEmpty(this.value)&&(e.wrapClasses=[this.placeholderClassName]),this.validationInfo.isValid||e.wrapClasses.push(this.errorClass),e},combineClasses:function(){var e=this.callParent(arguments);return Ext.apply(e,this.classes)},combineSelectors:function(){return{wrapEl:"#"+this.id+"-inline-text-edit-wrap",el:"#"+this.id+"-inline-text-edit-el",validationEl:"#"+this.id+"-validation"}},initDomEvents:function(){this.callParent(arguments),this.el&&this.el.on({focus:{fn:this.onFocus,scope:this},blur:{fn:this.onBlur,scope:this}});var e=this.validationInfo;e.isValid||this.showValidationMessage(e.invalidMessage)},clearDomListeners:function(){this.callParent(arguments),this.el&&(this.el.un("click",this.onSelectionChange,this),this.el.un("keyup",this.onSelectionChange,this))},getBindConfig:function(){var e=this.callParent(arguments),t=this.getSanitizeHtmlBindConfig();return Ext.apply(e,{selectedText:{changeEvent:"selectedtextchanged",deprecatedChangeEvent:"selectedtextсhanged",changeMethod:"setSelectedText"}},t),e},setMarkOut:function(){if(this.rendered&&this.validationEl){var e="";if(this.validationInfo.isValid)this.wrapEl.removeCls(this.errorClass);else{this.wrapEl.addCls(this.errorClass),e=this.validationInfo.invalidMessage,this.validationEl.setStyle("width","");var t=this.wrapEl.getWidth();this.validationEl.getWidth()>t&&this.validationEl.setWidth(t)}this.showValidationMessage(e),this.validationEl.setVisible(!this.validationInfo.isValid)}},updateValue:function(e){var t=!1;return this.value!==e&&(this.value=this._addDefaultStyles(e),this.fireEvent("change",this),t=!0),t},isEditorDataEmpty:function(){var e=this.editor.getData();return Ext.isEmpty(e)},setPlaceholderVisible:function(e){e?this.wrapEl.addCls(this.placeholderClassName):this.wrapEl.removeCls(this.placeholderClassName)},onFocus:function(){this.rendered&&!this.focused&&(this.isEditorDataEmpty()&&this.setPlaceholderVisible(!1),this.focused=!0)},onBlur:function(){if(this.rendered){this.focused=!1,this.isEditorDataEmpty()&&this.setPlaceholderVisible(!0);var e=this.editor.getData();this.updateValue(e),this.fireEvent("blur",this)}},onAfterRender:function(){this.callParent(arguments),this.destroyInlineEditor(),this.initInlineEditor()},onAfterReRender:function(){this.callParent(arguments),this.destroyInlineEditor(),this.initInlineEditor()},onDestroy:function(){this.destroyInlineEditor(),this.callParent(arguments)},setValue:function(e){if(this.value!==e){if(this.editor){var t=Terrasoft.sanitizeHTML(e,this.sanitizationLevel);this.editor.setData(t)}this.updateValue(e)}},setReadonly:function(e){this.readonly!==e&&(this.readonly=e,this.rendered&&this.reRender())},setPlaceholder:function(e){this.placeholder!==e&&(this.placeholder=e,this.rendered&&this.reRender())},insertContent:function(e){this.editor.insertText(e)},setSelectedText:function(e){if(e&&e!==this.selectedText&&this.editor){var t=CKEDITOR.dom.element.createFromHtml(e);Ext.isFunction(t.getChildCount)&&t.getChildCount()>0?this.setHtmlText(e):this.setText(e)}},setText:function(e){var t=this.editor,r=t.getSelection(),n=r&&r.getSelectedText();if(!Ext.isEmpty(n)){var i=r.getRanges();if(!Ext.isEmpty(i)&&i.length>0){var a=i[0];Ext.isEmpty(a)||a.deleteContents()}}this.insertContent(e),this.updateSelectedText(e);var s=t.getData();this.updateValue(s);var o=this.isEditorDataEmpty();this.setPlaceholderVisible(o)},setHtmlText:function(e){var t=this.editor,r=t.getSelection(),n=r.getRanges(!0);if(1===n.length){var i=CKEDITOR.dom.element.createFromHtml(e),a=n[0];a.collapsed||a.deleteContents(),a.insertNode(i),a.selectNodeContents(i),r.selectRanges(n)}t.updateElement(),t.focus()},setEnabled:function(e){this.callParent(arguments),this.editor&&this.editor.instanceReady&&this.editor.setReadOnly(!e)}}),Ext.define("Terrasoft.controls.NumberEdit",{extend:"Terrasoft.BaseEdit",alternateClassName:"Terrasoft.NumberEdit",baseCharsRe:null,numberRe:null,decimalSeparatorsRe:null,useThousandSeparator:!0,thousandSeparator:Terrasoft.Resources.CultureSettings.thousandSeparator,numberGroupSizes:Terrasoft.Resources.CultureSettings.numberGroupSizes,init:function(){this.callParent(arguments);var e=Ext.String.escapeRegex(this.thousandSeparator);this.thousandSeparatorRe=new RegExp(e,"g"),this.displayNumberConfig={decimalPrecision:this.decimalPrecision,decimalSeparator:this.decimalSeparator,useThousandSeparator:this.useThousandSeparator,thousandSeparator:this.thousandSeparator,numberGroupSizes:this.numberGroupSizes}},onFocus:function(){if(this.callParent(arguments),this.enabled){var e=this.getEl();e&&e.dom&&e.dom.value&&e.dom.select(),!1!==this.validationInfo.isValid&&this.formatDomValue()}},formatDomValue:function(){var e=this.getTypedValue(),t=this.getEl(),r=t&&t.dom;if(!Ext.isEmpty(e)&&r){e=e.replace(this.thousandSeparatorRe,"");var n=this.parseNumber(e),i=Terrasoft.deepClone(this.displayNumberConfig);Ext.apply(i,{thousandSeparator:""}),r.value=Terrasoft.getFormattedNumberValue(n,i)}},onEnterKeyPressed:function(){if(this.enabled){var e=this.getTypedValue(),t=this.parseNumber(e),r=this.changeValue(t);this.fireEvent("enterkeypressed",this),r||this.fireEvent("editenterkeypressed",this)}},onBlur:function(){if(this.enabled){var e=this.getEl(),t=this.getTypedValue(),r=this.parseNumber(t);e.dom.value=this.getFormattedNumberValue(r),this.changeValue(r),this.focused=!1,this.fireEvent("blur",this),this.fireEvent("focusChanged",this)}},getTplData:function(){var e=this.callParent(arguments),t=this.getTplValue();return e.value=t,e.wrapClass.push("number-edit-align"),e.editInputClass.push("number-edit-input-align"),e},getTplValue:function(){var e=this.value;return Ext.isEmpty(e)?"":!0===this.validationInfo.isValid?(this.value=this.parseNumber(e),this.getFormattedNumberValue(e)):void 0},onKeyPress:function(e,t){if(this.callParent(arguments),!this.readonly&&this.enabled){var r=Ext.isGecko&&e.isSpecialKey();if(!r){e.preventDefault();var n=e.getKey(),i=String.fromCharCode(n),a=this.baseCharsRe&&!this.baseCharsRe.test(i);if(!a){var s=e.getTarget(),o=Terrasoft.utils.dom.getSelectedTextLength(s);t===Terrasoft.DataValueType.FLOAT&&this.decimalSeparatorsRe.test(i)&&(i=this.decimalSeparator);var l=s.value,c=Terrasoft.utils.dom.getCaretPosition(s),u="",h="";Ext.isIE&&!Ext.isIE11?(u=l.slice(0,c-o),h=l.slice(c),c-=o):(u=l.slice(0,c),h=l.slice(c+o));var f=u+i+h;(a=this.numberRe&&!this.numberRe.test(f))||(c+=1,s.value=f,Terrasoft.utils.dom.setCaretPosition(s,c))}}}},setValue:function(e){var t=this.parseNumber(e),r=this.changeValue(t);if(this.rendered&&r){var n=!0===this.focused?e:this.getFormattedNumberValue(e);this.setDomValue(n)}},parseNumber:function(e){return Terrasoft.parseNumber(e,this.displayNumberConfig)},getFormattedNumberValue:function(e){var t=Ext.apply({},this.displayNumberConfig);return Terrasoft.getFormattedNumberValue(e,t)}}),Ext.define("Terrasoft.controls.FloatEdit",{extend:"Terrasoft.NumberEdit",alternateClassName:"Terrasoft.FloatEdit",baseCharsRe:/[-1234567890.,]/,decimalSeparatorsRe:/[,.]/,decimalSeparator:Terrasoft.Resources.CultureSettings.decimalSeparator,decimalPrecision:2,init:function(){this.callParent(arguments),this.numberRe=new RegExp("^-?\\d*[,.]?\\d{0,"+this.decimalPrecision+"}$")},onKeyPress:function(e){this.callParent([e,Terrasoft.DataValueType.FLOAT])}}),Ext.define("Terrasoft.controls.IntegerEdit",{extend:"Terrasoft.NumberEdit",alternateClassName:"Terrasoft.IntegerEdit",baseCharsRe:/[-1234567890]/,numberRe:/^-?\d*$/,init:function(){this.callParent(arguments),this.displayNumberConfig.type=Terrasoft.DataValueType.INTEGER},onKeyPress:function(e){this.callParent([e,Terrasoft.DataValueType.INTEGER])}}),Ext.define("Terrasoft.controls.PhoneEdit",{alternateClassName:"Terrasoft.PhoneEdit",extend:"Terrasoft.BaseEdit",mixins:{leftIcon:"Terrasoft.LeftIcon",rightIcon:"Terrasoft.RightIcon"},enableLeftIcon:!0,enableRightIcon:!0,inputType:"tel",direction:"ltr",init:function(){this.callParent(arguments),this.mixins.rightIcon.init.apply(this,arguments)},getBindConfig:function(){var e=this.callParent(arguments),t=this.mixins.leftIcon.getBindConfig(),r=this.mixins.rightIcon.getBindConfig();return Ext.apply(e,t),Ext.apply(e,r),e}}),Ext.define("Terrasoft.controls.TextEdit",{extend:"Terrasoft.BaseEdit",alternateClassName:"Terrasoft.TextEdit",mixins:{leftIcon:"Terrasoft.LeftIcon",rightIcon:"Terrasoft.RightIcon"},enableLeftIcon:!0,enableRightIcon:!0,enableVoiceToTextButton:!0,value:"",protect:!1,injectionValue:"",init:function(){this.callParent(arguments),this.mixins.rightIcon.init.apply(this,arguments)},useVoiceToTextButton:function(){return this.callParent(arguments)&&Terrasoft.Features.getIsEnabled("UseVoiceToTextForTextEdit")},getTplData:function(){var e=this.callParent(arguments);return e.inputType=this.getInputType(),e},getBindConfig:function(){var e=this.callParent(arguments),t={injectionValue:{changeMethod:"setInjectionValue"}};Ext.apply(e,t);var r=this.mixins.rightIcon.getBindConfig();return Ext.apply(e,r),e},getInputType:function(){return this.protect?"password":"text"},setInjectionValue:function(e){if(Ext.isString(e)){var t=this.getEl().dom.selectionStart,r=this.getEl().dom.selectionEnd,n=this.value.slice(0,t)+e+this.value.slice(r);this.setValue(n)}}}),Ext.define("Terrasoft.controls.ComboBoxEdit",{extend:"Terrasoft.controls.BaseEdit",alternateClassName:"Terrasoft.ComboBoxEdit",mixins:{expandableList:"Terrasoft.ExpandableList",rightIcon:"Terrasoft.RightIcon",leftIcon:"Terrasoft.LeftIcon"},disableInputDrop:!0,iconsVisible:!1,enableRightIcon:!0,enableLeftIcon:!0,rightIconClasses:["combobox-edit-right-icon"],minSearchCharsCount:0,searchDelay:100,maskDelay:0,value:null,_getIconElement:function(e){return e?e.parent().select(".combobox-edit-left-icon").first():this.leftIconEl},initDomEvents:function(){this.callParent(arguments),this.on("rightIconClick",this.onMarkerWrapClick,this);var e=this.getEl();e.on("click",this.onClick,this);var t=Ext.getDoc();t.on("mousedown",this.onMouseDownCollapse,this)},onListElementSelected:function(e){this.mixins.expandableList.onListElementSelected.call(this,e)},onFocus:function(){this.callParent(arguments),this.mixins.expandableList.onFocus.call(this)},onBlur:function(){this.mixins.expandableList.onBlur.call(this)},onMouseDownCollapse:function(e){var t=e.within(this.getWrapEl()),r=this.listView,n=null===r||e.within(r.getWrapEl());if(!t&&!n&&(r.hide(),!this.value)){var i=this.getEl();if(i){var a=i.dom;a&&(a.value="")}}},init:function(){this.iconsVisible&&(this.leftIconClasses=["combobox-edit-left-icon"]),this.callParent(arguments),this.mixins.expandableList.init.call(this),this.addEvents("click")},onMarkerWrapClick:function(){if(this.enabled&&!this.readonly){var e=this.listView;null!==e&&e.visible?e.hide():(this.setShowAllList(),this.expandList())}},onClick:function(){this.fireEvent("click"),this.onMarkerWrapClick()},onKeyDown:function(e){if(this.enabled&&!this.readonly){var t=!1;this.mixins.expandableList.onKeyDown.call(this,e,!0);var r=e.getKey(),n=this.listView;switch(r){case e.DOWN:null!==n&&n.visible||(this.setShowAllList(),this.expandList());break;case e.ENTER:null!==n&&n.visible&&(t=n.fireEvent("listPressEnter"))}this.isListElementSelected=t,t||this.fireEvent("keyDown",e,this)}},changeValue:function(e){var t,r=this.value;return(t=null!==r&&null!==e?r.value!==e.value||r.displayValue!==e.displayValue:r!==e)&&(this.value=e,this.fireEvent("change",this.value,this),this.setClearIconVisibility()),t},onKeyUp:function(e){if(this.clearTimer("timerId"),this.enabled&&!this.readonly){var t=this.getTypedValue(),r=e.getKey();r!==e.DELETE&&r!==e.BACKSPACE||""!==t||(this.setValue(null),this.collapseList()),e.isNavKeyPress()||(t!==this.typedValue&&(this.typedValue=t,this.changeValue(null),this.removeIcon()),t.length>=this.minSearchCharsCount&&""!==t&&(this.timerId=Ext.defer((function(){this.expandList(t)}),this.searchDelay,this))),this.isListElementSelected||this.fireEvent("keyUp",e,this)}},getInitValue:function(){var e=this.value,t=e?Terrasoft.getTypedStringValue(e,Terrasoft.DataValueType.LOOKUP):"";return t?Terrasoft.encodeHtml(t):""},getBindConfig:function(){var e=this.callParent(arguments),t=this.mixins.expandableList.getBindConfig(),r=this.mixins.leftIcon.getBindConfig();return Ext.apply(e,t),Ext.apply(e,r),e},subscribeForEvents:function(e,t,r){this.callParent(arguments),this.mixins.expandableList.subscribeForEvents.call(this,e,t,r)},initBinding:function(e,t,r){var n=this.callParent(arguments),i=this.mixins.expandableList.initBinding.call(this,e,t,r);return Ext.apply(n,i)},getModelMethod:function(e,t){return this.mixins.expandableList.getModelMethod.call(this,e,t)},setValue:function(e){this.mixins.predictableIcon.valueChanged.call(this,e);var t=this.changeValue(e);if(this.setSelectedItem(e),this.allowRerender()&&t){var r=this.getEl(),n=e?e.displayValue:"";r.dom.value=n,this.setElementDirection(r,n),this.iconsVisible&&(e?this.addIcon(e,r):this.removeIcon())}},addIcon:function(e,t){if(e){e.imageUrl||this.setImageConfig(e);var r=this._getIconElement(t);r&&(r.dom.style["background-image"]="url("+e.imageUrl+")",r.addCls("combobox-edit-left-icon"))}},removeIcon:function(){this.leftIconEl&&(this.leftIconEl.dom.style["background-image"]=null)},onAfterRender:function(){this.callParent(arguments),this.addIcon(this.value)},onAfterReRender:function(){this.callParent(arguments),this.iconsVisible&&this.addIcon(this.value)},setImageConfig:function(e){e.primaryImageValue&&(e.imageConfig={source:Terrasoft.ImageSources.SYS_IMAGE,params:{primaryColumnValue:e.primaryImageValue}},e.imageUrl=Terrasoft.ImageUrlBuilder.getUrl(e.imageConfig))},clearDomListeners:function(){this.callParent(arguments);var e=this.getEl();e&&e.un("click",this.onClick,this)},isEventWithin:function(e){var t=this.callParent(arguments);return t||(t=this.isEventWithinList(e)),t},onDestroy:function(){this.mixins.expandableList.destroy.call(this),this.callParent(arguments)}}),Ext.define("Terrasoft.controls.MemoEdit",{extend:"Terrasoft.controls.BaseEdit",alternateClassName:"Terrasoft.MemoEdit",spellcheck:!0,maxlength:0,memoEditClasses:" memo-edit-core ",memoEditClassesIE:" is-ie ",memoEditScrollClasses:" memo-edit-scroll memo-edit-height ",memoEditTextareaClasses:" memo-edit-height base-edit-input memo-edit-area ",resize:!1,updateScrollHeightDelay:20,enableVoiceToTextButton:!0,_delayedUpdateScrollHeightFn:null,tpl:['<div id="{id}-wrap" class="{wrapClass}" data-resize="{resize}" style="{wrapStyle}">','<div id="{id}-scroll" class="{scrollClass}">','<textarea id="{id}-virtual" class="{textareaClasses} virtual" style="{inputStyle}">{value}</textarea>','<textarea id="{id}-el" class="{textareaClasses}" style="{inputStyle}" tabindex="{tabIndex}" ','placeholder="{placeholder}" {spellcheck} {disabled} {readonly} {maxlength}>{value}</textarea>','<div id="{id}-disabled-el-icon" class="{disabledElIconClass}"></div>',"{%this.renderVoiceToTextButton(out, values)%}","</div>",'<span id="{id}-validation" class="{validationClass}" style="{validationStyle}">{validationText}</span>',"</div>"],init:function(){this.callParent(arguments),this._delayedUpdateScrollHeightFn=Terrasoft.debounce(this.updateScrollHeight.bind(this),this.updateScrollHeightDelay)},getTplData:function(){var e=this.callParent(arguments);return e.spellcheck=this.spellcheck?"":'spellcheck="false"',e.maxlength=this.maxlength>0?'maxlength="'+this.maxlength+'"':"",this.selectors.scrollEl="#"+this.id+"-scroll",e.wrapClass.push(this.memoEditClasses),e.scrollClass=[this.memoEditScrollClasses],e.textareaClasses=[this.memoEditTextareaClasses],e.resize=this.resize&&!Ext.isIE,Ext.isIE&&e.wrapClass.push(this.memoEditClassesIE),e},getVirtualEl:function(){return Ext.get(this.id+"-virtual")},combineStyles:function(){var e=this.callParent(arguments);return e.inputStyle.resize=this.resize?"":"none",e.wrapStyle.padding="0px",e},initDomEvents:function(){this.callParent(arguments);var e=this.getEl();e.on("input",this.onInput,this)},onAfterRender:function(){this.callParent(arguments),this.initHeightWrap(),this.initScroll(),Terrasoft.isAngularHost?this._delayedUpdateScrollHeightFn():this.updateScrollHeight()},onAfterReRender:function(){this.callParent(arguments),this.initHeightWrap(),this.initScroll(),Terrasoft.isAngularHost?this._delayedUpdateScrollHeightFn():this.updateScrollHeight()},onInput:function(){Ext.isIEOrEdge?this._delayedUpdateScrollHeightFn():this.updateScrollHeight()},initHeightWrap:function(){var e=this.getWrapEl(),t=String(this.height);if(Ext.String.endsWith(t,"%")){var r=Ext.get(e.dom.parentNode).getBox();e.setHeight(r.height)}},initScroll:function(){var e=this.getWrapEl(),t=this.getEl(),r=this.scrollEl,n=parseInt(e.dom.style.height,10);(n=isNaN(n)?0:n)&&(this.enableScroll(),r.setHeight(n),t.setHeight(n))},getCalculatedMaxHeight:function(){var e=this.getWrapEl(),t=this.getVirtualEl(),r=this.getEl();t.dom.value=r.dom.value;var n=parseInt(t.getStyle("min-height"),10),i=isNaN(n)?0:n,a=parseInt(e.dom.style.height,10);a=isNaN(a)?0:a;var s=t.dom.scrollHeight;return Math.max(s,i,a)},enableScroll:function(e){var t=this.getWrapEl();!1===e?t.removeCls("is-scrolling"):t.addCls("is-scrolling")},updateScrollHeight:function(){if(!this.height&&(!this.resize||Ext.isIE)){this.enableScroll(!1);var e=this.getEl(),t=this.getWrapEl(),r=this.scrollEl;if(0===t.getHeight())return;var n=this.getCalculatedMaxHeight();r.setHeight(n),e.setHeight(n)}},setValue:function(){var e=this.callParent(arguments);e&&this.allowRerender()&&this.updateScrollHeight()},getBindConfig:function(){var e=this.callParent(arguments);return Ext.apply(e,{maxlength:{changeMethod:"setMaxlength"}}),e},setMaxlength:function(e){this.maxlength!==e&&(this.maxlength=e,this.rendered&&this.getEl().set({maxlength:this.maxlength}))}}),Ext.define("Terrasoft.controls.FormulaInlineTextEdit",{extend:"Terrasoft.controls.MemoEdit",alternateClassName:"Terrasoft.FormulaInlineTextEdit",selectedText:null,initDomEvents:function(){this.callParent(arguments);var e=this.getEl();e.on("select",this.onSelectionChange,this)},clearDomListeners:function(){this.callParent(arguments);var e=this.getEl();e.un("select",this.onSelectionChange,this)},onInput:function(){this.onSelectionChange()},onSelectionChange:function(){var e=this.getSelectedText();this.updateSelectedText(e)},getSelectedText:function(){var e=this.getEl().dom;return this.getTypedValue().slice(e.selectionStart,e.selectionEnd)},updateSelectedText:function(e){e!==this.selectedText&&(this.selectedText=e,this.fireEvent("selectedtextchanged",this.selectedText,this))},getBindConfig:function(){var e=this.callParent(arguments);return Ext.apply(e,{selectedText:{changeEvent:"selectedtextchanged",changeMethod:"setSelectedText"}}),e},setSelectedText:function(e){if(e!==this.selectedText&&this.rendered){var t=this.getTypedValue(),r=this.getEl().dom;r.focus();var n=r.selectionStart,i=r.selectionEnd,a=[t.slice(0,n),e,t.slice(i)].join("");this.setValue(a),r.selectionStart=n+e.length,r.selectionEnd=n+e.length,this.updateSelectedText(e)}},updateScrollHeight:Terrasoft.emptyFn}),Ext.ns("Terrasoft.controls.DatePickerEnums"),Terrasoft.controls.DatePickerEnums={DAYS:"days",MONTHS:"months",YEARS:"years",FIRSTDAYINMONTH:1,MONTHSINYEAR:12,YEARSTODISPLAY:12,DAYSINWEEK:7,ROWSNUMBER:3,LINESTODISPLAYFROMSECONDLINE:5,LINESTODISPLAY:6,DATEFORMAT:Terrasoft.Resources.CultureSettings.dateFormat},Ext.define("Terrasoft.controls.DatePicker",{alternateClassName:"Terrasoft.DatePicker",extend:"Terrasoft.Component",date:null,currentDate:null,displayedDate:null,templateConfig:{data:{day:"data-day",month:"data-month",year:"data-year"},notCurrentClass:"ts-datepicker-not-current",selectedClass:"ts-datepicker-selected",dayClass:"ts-datepicker-day",monthClass:"ts-datepicker-month",yearClass:"ts-datepicker-year",daysPanelClass:"ts-datepicker-days-panel",monthsPanelClass:"ts-datepicker-months-panel",yearsPanelClass:"ts-datepicker-years-panel",daysWeekClass:"ts-datepicker-day-name",mainConfig:{firstItemClass:"ts-datepicker-first-item",lastItemClass:"ts-datepicker-last-item",selectedClass:"ts-datepicker-selected",currentDateClass:"ts-datepicker-current"}},tpl:['<div id="{id}-wrap" class="ts-datepicker-container" style="{wrapStyle}">','<div id = "{id}-date" class="ts-datepicker-item ts-datepicker-date">{currentDate}</div>','<div class="ts-datepicker-item ts-datepicker-panel {panelClass}">','<div class="ts-datepicker-item ts-datepicker-arrow ts-datepicker-left-arrow">&nbsp;</div>','<div id="{id}-display-mode" class="ts-datepicker-item ts-datepicker-display">','<tpl for="switchInfo">',"<span>{.}</span>","</tpl>","</div>",'<div class = "ts-datepicker-item ts-datepicker-arrow ts-datepicker-right-arrow">&nbsp;</div>',"</div>","{%this.generateTemplateContent(out, values)%}","</div>"],daysTpl:["{% var itemClass %}",'<tpl for="shortDayNames">','{% if (xindex === 1) { itemClass = " " + parent.firstItemClass } %}','{% else if (xindex === 7) { itemClass = " " + parent.lastItemClass } %}','{% else { itemClass = "" } %}','<div class = "ts-datepicker-day-name ts-datepicker-item{[ itemClass ]}">{.}</div>',"</tpl>","{% var itemClass, monthClass, selectedClass, currentDateClass %}",'<tpl for="daysToDisplay">','{% if (xindex % 7 === 1 || xindex === 1) { itemClass = " " + parent.firstItemClass } %}','{% else if (xindex % 7 === 0 && xindex >= 7) { itemClass = " " + parent.lastItemClass } %}','{% else { itemClass = "" } %}','{% if (values.notCurrentMonth) { monthClass = " "+ parent.notCurrentMonth } %}','{% else { monthClass = "" } %}','{% if (values.isSelectedDate) { selectedClass = " "+ parent.selectedClass } %}','{% else { selectedClass = "" } %}','{% if (values.isCurrentDate) { currentDateClass = " "+ parent.currentDateClass } %}','{% else { currentDateClass = "" } %}','<div class = "ts-datepicker-day ts-datepicker-item','{[ itemClass ]}{[ monthClass ]}{[ selectedClass ]}{[ currentDateClass ]}"','data-day="{day}" data-month="{month}" data-year="{year}">{day}</div>',"</tpl>"],monthsTpl:["{% var itemClass, selectedClass, currentMonthClass %}",'<tpl for="monthNames">','{% if (xindex % 3 === 1 || xindex === 1) { itemClass = " " + parent.firstItemClass } %}','{% else if (xindex % 3 === 0 && xindex >= 3) { itemClass = " " + parent.lastItemClass } %}','{% else { itemClass = "" } %}',"{% if (xindex - 1 === parent.selectedMonth && parent.year === parent.selectedYear)",'{ selectedClass = " "+ parent.selectedClass } %}','{% else { selectedClass = "" } %}',"{% if (xindex - 1 === parent.currentMonth && parent.year === parent.currentYear)",'{ currentMonthClass = " "+ parent.currentDateClass } %}','{% else { currentMonthClass = "" } %}','<div class = "ts-datepicker-month ts-datepicker-item','{[ itemClass ]}{[ selectedClass ]}{[ currentMonthClass ]}"','data-month="{[ xindex - 1]}" data-year="{[ parent.year ]}">{.}</div>',"</tpl>"],yearsTpl:["{% var itemClass, selectedClass, currentYearClass %}",'<tpl for="years">','{% if (xindex % 3 === 1 || xindex === 1) { itemClass = " " + parent.firstItemClass } %}','{% else if (xindex % 3 === 0 && xindex >= 3) { itemClass = " " + parent.lastItemClass } %}','{% else { itemClass = "" } %}','{% if (values === parent.selectedYear) { selectedClass = " "+ parent.selectedClass } %}','{% else { selectedClass = "" } %}','{% if (values === parent.currentYear) { currentYearClass = " "+ parent.currentDateClass } %}','{% else { currentYearClass = "" } %}','<div class = "ts-datepicker-year ts-datepicker-item','{[ itemClass ]}{[ selectedClass ]}{[ currentYearClass ]}" data-year="{.}">{.}</div>',"</tpl>"],parentEl:null,startDay:Terrasoft.Resources.CultureSettings.startDay,displayMode:Terrasoft.controls.DatePickerEnums.DAYS,todayMessage:Terrasoft.Resources.CultureSettings.todayMessage,shortDayNames:Terrasoft.Resources.CultureSettings.shortDayNames,monthNames:Terrasoft.Resources.CultureSettings.monthNames,switchDisplayMode:function(e,t,r){e.stopPropagation&&e.stopPropagation();var n=r.isReverse?-1:1,i=Terrasoft.controls.DatePickerEnums,a=[i.DAYS,i.MONTHS,i.YEARS],s=a.indexOf(this.displayMode);(s+=n)<a.length&&(this.displayMode=a[s],this.reRender())},switchToNeighbor:function(e,t,r){e.stopPropagation();var n,i=r.isReverse?-1:1,a=this.displayMode,s=Terrasoft.controls.DatePickerEnums,o=this.displayedDate;if(a===s.DAYS){var l=o.getMonth();l+=i,o.setDate(s.FIRSTDAYINMONTH),o.setMonth(l)}else a===s.MONTHS?(n=o.getFullYear(),n+=i,o.setFullYear(n)):(n=o.getFullYear()+10*i,o.setFullYear(n));this.reRender()},selectDate:function(e,t){e.stopPropagation(),t=Ext.get(t);var r,n,i,a=this.displayMode,s=Terrasoft.controls.DatePickerEnums,o=this.templateConfig,l=o.data;if(a===s.DAYS){var c=t.hasCls(o.dayClass),u=t.hasCls(o.selectedClass);(c||u)&&(r=t.getAttribute(l.year),n=t.getAttribute(l.month),i=t.getAttribute(l.day),this.changeDate(r,n,i),this.fireEvent("dateSelected",this))}else a===s.MONTHS?t.hasCls(o.monthClass)&&(r=t.getAttribute(l.year),n=t.getAttribute(l.month),this.changeDate(r,n),this.switchDisplayMode(this,t.dom,{isReverse:!0}),this.fireEvent("monthSelected",this)):t.hasCls(o.yearClass)&&(r=t.getAttribute(l.year),this.changeDate(r),this.setDisplayMode(s.DAYS),this.fireEvent("yearSelected",this))},changeDate:function(e,t,r){var n=this.displayedDate,i=n.getDate();n.setDate(Terrasoft.controls.DatePickerEnums.FIRSTDAYINMONTH),n.setFullYear(e),void 0!==t&&n.setMonth(t),void 0!==r?n.setDate(r):n.setDate(i),this.setDate(n)},switchToCurrentDate:function(e){e.stopPropagation();var t=this.currentDate,r=this.displayMode,n=Terrasoft.controls.DatePickerEnums,i=!1;r!==n.DAYS&&(this.displayMode=n.DAYS,i=!0),Terrasoft.areDatesEqual(t,this.displayedDate)||(this.setDisplayedDate(t),this.setDate(t),i=!0),this.rendered&&i&&this.reRender(),this.fireEvent("currentDateSelected",this)},getDaysToDisplay:function(){var e=this.displayedDate,t=this.date,r=this.currentDate,n=Terrasoft.controls.DatePickerEnums,i=n.DAYSINWEEK,a=Ext.Date.getDaysInMonth(e),s=this.startDay+i-Ext.Date.getFirstDayOfMonth(e),o=i-(s=s>i?s-i:s);Math.ceil((a-s)/i)+1<=n.LINESTODISPLAYFROMSECONDLINE&&(o+=i);var l=n.LINESTODISPLAY*i-o-a,c=[];c.push(o),c.push(a),c.push(l);var u,h,f,d,p,m,g,T,y=[];y.push(this.getMonthInfo(e,-1)),y.push(this.getMonthInfo(e)),y.push(this.getMonthInfo(e,1));for(var v=[],E=n.ROWSNUMBER,C=0;C<E;C++){u=0===C?y[C].daysInMonth-o+1:1,m=1!==C,f=y[C].month,d=y[C].year,p=c[C];for(var b=0;b<p;b++)g=(h=u+b)===r.getDate()&&f===r.getMonth()&&d===r.getFullYear(),T=h===t.getDate()&&f===t.getMonth(),v.push({day:h,month:f,year:d,notCurrentMonth:m,isCurrentDate:g,isSelectedDate:T})}return v},getYearsToDisplay:function(e){for(var t=Terrasoft.controls.DatePickerEnums.YEARSTODISPLAY,r=e+10-e%10-(t-1),n=[],i=0;i<t;i++,r++)n.push(r);return n},getShiftedDays:function(e,t){var r=e.length;if(Ext.isEmpty(t)||t>r)return e;var n=e.slice(0,t);return e.slice(t,r).concat(n)},getDatePickerSelectors:function(){var e=Terrasoft.controls.DatePickerEnums,t={wrapEl:"#"+this.id+"-wrap",monthEl:"#"+this.id+"-display-mode > span",dateEl:"#"+this.id+"-date",rightArrowEl:".ts-datepicker-right-arrow",leftArrowEl:".ts-datepicker-left-arrow"};return this.displayMode===e.DAYS?t.yearEl="#"+this.id+"-display-mode > span + span":this.selectors&&this.selectors.yearEl&&delete this.selectors.yearEl,t},getDaysInfoMessage:function(){var e=this.displayedDate,t=e.getMonth(),r=[];return r.push(this.monthNames[t]+" "),r.push(e.getFullYear()),r},getCurrentDayString:function(){var e=[],t=Ext.Date.format(this.currentDate,Terrasoft.controls.DatePickerEnums.DATEFORMAT);return e.push(this.todayMessage),e.push(t),e.join(" ")},generateTemplateContent:function(e,t){var r,n=Terrasoft.controls.DatePickerEnums,i=t.self,a=i.displayMode;r=a===n.DAYS?new Ext.XTemplate(i.daysTpl):a===n.MONTHS?new Ext.XTemplate(i.monthsTpl):new Ext.XTemplate(i.yearsTpl),i.prepareTpl(r,t),r.applyOut(t,e)},adjustPosition:function(){var e=this.parentEl;if(e){var t=this.getWrapEl();t.anchorTo(e,"tl-bl?",[1,1],!1,!1),t.removeAnchor()}},onAfterRender:function(){this.callParent(arguments),this.adjustPosition()},onAfterReRender:function(){this.callParent(arguments),this.adjustPosition()},getMonthInfo:function(e,t){var r=Terrasoft.deepClone(e),n=Terrasoft.controls.DatePickerEnums;return r.setDate(n.FIRSTDAYINMONTH),Ext.isEmpty(t)||(r.setDate(n.FIRSTDAYINMONTH),r.setMonth(r.getMonth()+t)),{year:r.getFullYear(),month:r.getMonth(),daysInMonth:Ext.Date.getDaysInMonth(r)}},init:function(){this.callParent(arguments),Ext.isEmpty(this.date)&&(this.date=new Date),Ext.isEmpty(this.displayedDate)&&(this.displayedDate=Terrasoft.deepClone(this.date)),this.currentDate=new Date,this.addEvents("dateSelected","monthSelected","yearSelected","currentDateSelected")},initDomEvents:function(){this.callParent(arguments),this.monthEl.on("click",this.switchDisplayMode,this),this.rightArrowEl.on("click",this.switchToNeighbor,this),this.leftArrowEl.on("click",this.switchToNeighbor,this,{isReverse:!0}),this.dateEl.on("click",this.switchToCurrentDate,this),this.wrapEl.on("click",this.selectDate,this);var e=this.yearEl;Ext.isEmpty(e)||this.yearEl.on("click",this.setYearsDisplayMode,this)},setYearsDisplayMode:function(e){e.stopPropagation(),this.setDisplayMode(Terrasoft.controls.DatePickerEnums.YEARS)},setDisplayMode:function(e){this.displayMode=e,this.reRender()},_appendDaysDisplayModeTplData:function(e){e.shortDayNames=this.getShiftedDays(this.shortDayNames,this.startDay),e.daysToDisplay=this.getDaysToDisplay(this.displayedDate),e.notCurrentMonth=this.templateConfig.notCurrentClass,e.switchInfo=this.getDaysInfoMessage(),e.panelClass=this.templateConfig.daysPanelClass},_appendMonthsDisplayModeTplData:function(e){var t=this.displayedDate.getFullYear();e.monthNames=this.monthNames,e.year=e.switchInfo=t,e.currentMonth=this.currentDate.getMonth(),e.selectedMonth=this.date.getMonth(),e.panelClass=this.templateConfig.monthsPanelClass},_appendYearsDisplayModeTplData:function(e){var t=this.getYearsToDisplay(this.displayedDate.getFullYear()),r=t[0],n=t[t.length-1],i=Terrasoft.getIsRtlMode()?[n,r]:[r,n];e.years=t,e.switchInfo=i.join("-"),e.panelClass=this.templateConfig.yearsPanelClass},getTplData:function(){var e=this.callParent(arguments),t=Terrasoft.controls.DatePickerEnums,r=this.date,n=this.currentDate,i=this.templateConfig;switch(this.displayMode){case t.DAYS:this._appendDaysDisplayModeTplData(e);break;case t.MONTHS:this._appendMonthsDisplayModeTplData(e);break;case t.YEARS:this._appendYearsDisplayModeTplData(e)}e.currentYear=n.getFullYear(),e.selectedYear=r.getFullYear(),e.currentDate=this.getCurrentDayString();var a=i.mainConfig;for(var s in a)e[s]=a[s];return e.generateTemplateContent=this.generateTemplateContent,this.selectors=this.getDatePickerSelectors(),this.styles=this.getDatePickerStyles(),e},getDatePickerStyles:function(){var e={},t=this.parentEl;if(!Ext.isEmpty(t)){var r=e.wrapStyle={},n=t.getBox();r.top=n.bottom+"px",r.left=n.x+"px"}return e},setDate:function(e){this.date=Terrasoft.deepClone(e),this.safeRerender()},setDisplayedDate:function(e){this.displayedDate=Terrasoft.deepClone(e),this.safeRerender()},getDate:function(){return this.date},show:function(e){this.visible=!0,this.parentEl=e,this.renderTo||(this.renderTo=Ext.getBody()),this.rendered?this.reRender():this.render(this.renderTo)},setVisible:function(e){if(this.visible!==e){var t=Terrasoft.controls.DatePickerEnums.DAYS;this.displayMode!==t&&e&&(this.displayMode=t),this.callParent(arguments)}}}),Ext.define("Terrasoft.controls.DateEdit",{extend:"Terrasoft.BaseEdit",alternateClassName:"Terrasoft.DateEdit",mixins:{rightIcon:"Terrasoft.RightIcon"},enableRightIcon:!0,rightIconClasses:["ts-date-edit-right-icon"],datePicker:null,value:null,format:Terrasoft.Resources.CultureSettings.dateFormat,getTplData:function(){var e=this.callParent(arguments);e.value=Ext.Date.format(this.value,this.format);var t=e.wrapClass;return t.push("date-edit"),e.direction=Terrasoft.getIsRtlMode()?"ltr":null,e},createDatePicker:function(){var e=this.datePicker=Ext.create("Terrasoft.DatePicker",{renderTo:Ext.getBody(),parentEl:this.wrapEl,date:this.value});e.on("dateSelected",this.onDateSelected,this),e.on("currentDateSelected",this.onDateSelected,this)},tryParseDate:function(e,t,r){try{return Terrasoft.parseDate(e,t,r)}catch(e){return console.warn(e&&e.message),null}},initDomEvents:function(){this.callParent(arguments),this.on("rightIconClick",this.onButtonClick,this);var e=Ext.getDoc();e.on("mousedown",this.onMouseDownCollapse,this)},onMouseDownCollapse:function(e){var t=e.within(this.getWrapEl()),r=this.datePicker,n=null===r||e.within(r.getWrapEl());t||n||r.setVisible(!1)},onButtonClick:function(){if(!this.readonly){var e=this.datePicker;if(e){var t=this.value;if(t&&(e.setDisplayedDate(t),e.setDate(t)),e.visible)e.setVisible(!1);else{var r=this.getWrapEl();e.show(r)}}else this.createDatePicker()}},subscribeForPropertyChangeEvent:function(e,t,r){var n=e.config.changeEvent;if("change"===n){var i=e.modelItem,a=function(e){var t=r.get(i),n=r.getColumnDataType(i),a=e?new Date(e):new Date;e?n===Terrasoft.DataValueType.DATE_TIME&&Ext.isDate(t)&&a.setHours(t.getHours(),t.getMinutes(),t.getSeconds(),t.getMilliseconds()):a=e,r.set(i,a)};this.on(n,a);var s=[i],o=function(t,n){""===n?n="invalid value":null===n&&(n=""),this.setControlPropertyValue(e,n,r)};this.toggleSubscriptionForModelEvents(r,null,s,o,this)}else this.callParent(arguments)},onKeyDown:function(e){if(this.enabled){this.callParent(arguments);var t=e.getKey(),r=this.datePicker;t===e.DOWN?r?r.show(this.getWrapEl()):this.createDatePicker():t===e.TAB&&r&&this.datePicker.setVisible(!1)}},onFocus:function(){this.callParent();var e=this.getEl();e&&e.dom&&e.dom.value&&e.dom.select()},onDateSelected:function(){var e=this.datePicker;this.enabled&&this.setValue(e.getDate()),e.setVisible(!1),this.getEl().focus()},changeValue:function(e){var t=this.getCorrectValue(e),r=this.isChanged(t);return r&&(this.value=t,this.fireEvent("change",t,this)),r},getCorrectValue:function(e){var t=null;if(Ext.isDate(e)&&(t=e),Ext.isString(e)){var r=this.value;t=""===e?null:this.parseDate(e)||"",Ext.isDate(r)&&Ext.isDate(t)&&t.setHours(r.getHours(),r.getMinutes(),r.getSeconds(),r.getMilliseconds())}return t},isChanged:function(e){var t,r=this.value;return t=Ext.isDate(r)&&Ext.isDate(e)?!Ext.Date.isEqual(r,e):e!==r,t},getFormattedValue:function(){return Terrasoft.utils.string.getTypedStringValue(this.value,Terrasoft.DataValueType.DATE)},onDestroy:function(){var e=this.datePicker;null!==e&&(e.un("dateSelected",this.onDateSelected,this),e.un("currentDateSelected",this.onDateSelected,this),e.destroy()),this.callParent(arguments)},setValue:function(e){var t=this.changeValue(e);if(this.rendered){var r=this.getFormattedValue(),n=this.getEl().dom;n.value=r,n.title=r}return t},onBlur:function(){if(this.enabled&&this.rendered){var e=this.getTypedValue();this.setValue(e),this.focused=!1,this.fireEvent("blur",this),this.fireEvent("focusChanged",this)}},onEnterKeyPressed:function(){var e=this.getTypedValue(),t=this.setValue(e);this.fireEvent("enterkeypressed",this),t||this.fireEvent("editenterkeypressed",this)},parseDate:function(e){var t=this.getDateFormat(e);return this.tryParseDate(e,t,!0)||this.tryParseDate(e,this.format,!0)||this.tryParseDate(e,this.format,!1)},getDateFormat:function(e){var t=this.format;if(/^(\d{6}||\d{8})$/.test(e)){var r=new RegExp("\\.","g"),n=t.replace(r,"");return e.replace(r,"").length<=6?n.replace("Y","y"):n.replace("y","Y")}return t},isEventWithin:function(e){var t=this.callParent(arguments);return!t&&this.datePicker&&(t=this.datePicker.isEventWithin(e)),t}}),Ext.define("Terrasoft.controls.TimeEdit",{extend:"Terrasoft.ComboBoxEdit",alternateClassName:"Terrasoft.TimeEdit",interval:15,startMinute:0,dueMinute:1440,timeFormat:Terrasoft.Resources.CultureSettings.timeFormat,alternativeTimeFormats:null,timeToFocus:"",constructor:function(){this.alternativeTimeFormats=["Gi","Hi","H:i"],this.callParent(arguments)},tryParseDate:function(e,t,r){for(var n=[t].concat(this.alternativeTimeFormats||[]),i=n.length,a=0;a<i;a++){var s=n[a],o=this.parseDate(e,s,r);if(Ext.isDate(o))return o}return null},parseDate:function(e,t,r){try{return Terrasoft.parseDate(e,t,r)}catch(e){return null}},init:function(){this.callParent(arguments);var e=this.value;if(null!==e&&!Ext.isDate(e))throw new Terrasoft.UnsupportedTypeException({message:Terrasoft.Resources.Controls.InvalidValue})},formatValue:function(e){return Ext.Date.format(e,this.timeFormat)},getTplData:function(){var e=this.callParent(arguments),t=this.value;Ext.isDate(t)&&(e.value=this.formatValue(t)),e.direction=Terrasoft.getIsRtlMode()?"ltr":null;var r=e.wrapClass;return r.push("time-edit"),e},expandList:function(){var e=this.list;null===e&&(e=this.createCollection());var t=this.getTypedValue()||this.timeToFocus;this.fireEvent(this.listPrepareEventName,t,this.list)||(this.maskTimerId=Ext.defer(this.showLoadMask,this.maskDelay,this));var r=""!==t?Ext.Date.parse(t,this.timeFormat):null;if(r){var n=this.findNearestItemValue(r);this.setSelectedItem(n)}else this.setSelectedItem(null);this.loadList(e),this.getEl().focus();var i=this.listView;i&&i.selectElement()},findNearestItemValue:function(e){var t=Math.round((60*e.getHours()+e.getMinutes())/this.interval);return Terrasoft.findWhere(this.list.getItems(),{value:t.toString()})},createCollection:function(){var e=this.startMinute,t=0,r=0,n=this.dueMinute,i=this.interval,a=Ext.create("Terrasoft.Collection"),s=new Date;this.listView=this.createListView();for(var o=this.listView.map,l=0;e<n;){t=Math.floor(e/60),r=e%60;var c={};s.setHours(t,r),c[o.displayValue]=this.formatValue(s),c[o.value]=String(l),a.add(l,c),e+=i,l+=1}return this.list=a,a},changeValue:function(e){var t=this.getCorrectValue(e),r=this.isChanged(t);return r&&(this.value=t,this.fireEvent("change",t,this)),r},getCorrectValue:function(e){var t=null;if(Ext.isDate(e)&&(t=e),Ext.isString(e)){var r=this.value,n=""===e?null:"";t=this.tryParseDate(e,this.timeFormat)||n,Ext.isDate(r)&&Ext.isDate(t)&&t.setFullYear(r.getFullYear(),r.getMonth(),r.getDate())}return t},isChanged:function(e){var t,r=this.value;return t=Ext.isDate(r)&&Ext.isDate(e)?r.getHours()!==e.getHours()||r.getMinutes()!==e.getMinutes():e!==r,t},onBlur:function(){if(this.enabled&&this.rendered){var e=this.getTypedValue();this.setValue(e),this.focused=!1,this.fireEvent("blur",this),this.fireEvent("focusChanged",this),!Ext.isIE&&this.listView&&this.listView.hide()}},onListElementSelected:function(e){this.callParent([e.displayValue])},onKeyUp:function(e){if(this.enabled){var t=this.getTypedValue(),r=e.getKey();r!==e.DELETE&&r!==e.BACKSPACE||""!==t||this.collapseList(),e.isNavKeyPress()||t.length>=this.minSearchCharsCount&&""!==t&&(this.typedValue=t,this.expandList(t)),this.isListElementSelected||this.fireEvent("keyUp",e,this)}},subscribeForPropertyChangeEvent:function(e,t,r){var n=e.config.changeEvent;if("change"===n){var i=e.modelItem,a=function(e){var t=r.get(i),n=r.getColumnDataType(i),a=!e||Ext.isDate(e)?e:new Date(e);a&&n===Terrasoft.DataValueType.DATE_TIME&&Ext.isDate(t)&&a.setFullYear(t.getFullYear(),t.getMonth(),t.getDate()),r.set(i,a)};this.on(n,a);var s=[i],o=function(t,n){""===n?n="invalid value":null===n&&(n=""),this.setControlPropertyValue(e,n,r)};this.toggleSubscriptionForModelEvents(r,null,s,o,this)}else this.callParent(arguments)},onKeyDown:function(e){if(this.enabled){this.callParent(arguments);var t=e.getKey();if(t===e.ENTER){var r=this.getTypedValue();this.setValue(r)}Ext.isIE&&t===e.TAB&&this.listView.hide()}},setValue:function(e){if(this.changeValue(e),this.rendered){var t=this.formatValue(this.value),r=this.getEl().dom;r.value=t,r.title=t}},onMouseDownCollapse:function(e){var t=e.within(this.getWrapEl()),r=this.listView,n=null===r||e.within(r.getWrapEl());t||n||r.hide()}}),Ext.define("Terrasoft.controls.mixins.DraggableGridMixin",{alternateClassName:"Terrasoft.DraggableGridMixin",extend:"Terrasoft.Draggable",dragActionsCode:0,dragCopy:!0,showDropZoneHint:!1,dragDropGroupName:null,dragItemHTML:new Ext.Template("<span>{0}</span>"),dragCloneItemCss:"drag-element",dragItemClasess:null,isTarget:!1,getGroupName:function(){return this.dragDropGroupName},getDraggableConfig:function(e){var t={};return t[Terrasoft.DragAction.MOVE]={autoGenerateDraggableElement:!1,elementId:this.id+this.collectionItemPrefix+e.Id,handlers:{b4StartDrag:"b4StartDrag",onDragDrop:"onDragDrop",onDragOver:"onDragOver",onInvalidDrop:"onInvalidDrop",alignElWithMouse:"alignElWithMouse"}},t},b4StartDrag:function(){var e=Ext.dd.DragDropManager.dragCurrent.id,t=e.replace(this.id,"").replace(this.collectionItemPrefix,"");this.setActiveRow(t);var r=Ext.get(e);if(r){var n=this.createDraggableClone(r.dom);this.appendDraggableClone(n),r.setVisible(this.dragCopy)}this.showDropZoneHint&&this.setDropZoneHintVisible(!0)},onDragDrop:function(e,t){var r=this.collection.find(this.activeRow);this.fireEvent("dragDrop",e,t,r),this.reRender({byCollection:!0})},onDragOver:function(e,t){this.fireEvent("dragOver",e,t)},onInvalidDrop:function(e,t){this.fireEvent("invalidDrop",e,t),this.reRender({byCollection:!0})},alignElWithMouse:function(e,t,r){var n=this.getDragElementCoordinate(e,t,r),i=Ext.DomHelper.generateStyles({position:"absolute",right:"auto",left:n.left+"px",top:n.top+"px"});e.setAttribute("style",i)},getDragElementCoordinate:function(e,t,r){return{left:t-e.offsetWidth/2,top:r-e.offsetHeight/2}},getDraggableElementDefaultConfig:function(){return{isTarget:this.isTarget,instance:this}},getActionDraggableConfig:function(e,t){this.defaultDraggableConfig||(this.defaultDraggableConfig=this.getDefaultDraggableConfig());var r=this.defaultDraggableConfig||{},n=this.getDraggableConfig(t)||{};return Ext.Object.merge(r[e],n[e])},initDraggableElement:function(e){(this.collection||0!==this.collection.getCount()||this.dragDropGroupName)&&this.collection.each((function(t){var r=this.getActionDraggableConfig(e,t);if(r){var n=this.id+this.collectionItemPrefix+t.get("Id"),i=Ext.get(n);if(i){if(r.autoGenerateDraggableElement)this.generateDraggableElement(n,Ext.String.format(r.autoGenerateDraggableElementTpl,this.id));else if(i.dom&&i.dom.childNodes)for(var a=i.dom.childNodes,s=0;s<a.length;s++)a[s].id=n+"-draggable-item-move",a[s].classList.add("draggable-item-move");var o=this.bindConfigHandlers(r.handlers),l=i.initDD(n,Ext.apply(this.getDraggableElementDefaultConfig(),r.getInitConfigMethod),o),c=this.getGroupName();Ext.isArray(c)?Terrasoft.each(c,(function(e){l.addToGroup(e)}),this):l.addToGroup(c)}}}),this)},generateDraggableElement:function(e,t){var r=Ext.get(e);r&&r.insertHtml("beforeEnd",t)},getDraggableElementIds:function(){if(0!==this.collection.getCount()){var e=[];return this.collection.each((function(t){var r=this.id+this.collectionItemPrefix+t.get("Id");r&&e.push(r)}),this),e}},createDraggableClone:function(){var e=this.callParent(arguments);e.classList.remove("grid-pad"),e.classList.add(this.dragCloneItemCss),this.dragItemClasess&&Ext.isArray(this.dragItemClasess)&&Terrasoft.each(this.dragItemClasess,(function(t){e.classList.add(t)}));var t=this.model.get("ActiveRow"),r=this.collection.find(t);return r&&this.dragItemHTML&&(e.innerHTML=Ext.String.format(this.dragItemHTML.html,r.get(r.primaryDisplayColumnName))),e}}),Ext.define("Terrasoft.controls.mixins.HierarchicalGridMixin",{alternateClassName:"Terrasoft.HierarchicalGridMixin",_toggleFoldingOnExpandHierarchyLevelChange:!1,hierarchical:!1,expandHierarchyLevels:null,autoExpandHierarchyLevels:!1,forceUpdateExpandHierarchyLevels:!1,hierarchicalPlus:new Ext.Template('<div id="{id}" class="{cls}"></div>'),hierarchicalMinus:new Ext.Template('<div id="{id}" class="{cls}"></div>'),hierarchicalPlusCss:"grid-toggle-plus",hierarchicalMinusCss:"grid-toggle-minus",hierarchicalEmptyCss:"grid-toggle-empty",hierarchicalTogglePrefix:"-toggle-",hierarchicalChildrenPrefix:"-children-",hierarchicalColumnName:"Parent",useLevelRendering:!1,toggleRows:null,baseOffset:32,contentOffset:32,checkboxOffset:32,_getMarginOffset:function(e){var t=this.contentOffset*e.level+e.marginLeftOffset,r=Terrasoft.getIsRtlMode()?"right":"left";return Ext.String.format("margin-{0}: {1}px",r,t)},_getPaddingOffset:function(e){var t=this.contentOffset*e.level+e.paddingLeftOffset,r=Terrasoft.getIsRtlMode()?"right":"left";return Ext.String.format("padding-{0}:  {1}px",r,t)},_getParentId:function(e){var t=this.collection.get(e).get(this.hierarchicalColumnName);return Ext.isObject(t)?t.value:t},filterRowsByParent:function(e){var t=this.hierarchicalColumnName;return this.rows.filter((function(r){return r.hasOwnProperty(t)&&r[t]===e}),this)},addHierarchicalOptions:function(e,t){var r=e.get(this.hierarchicalColumnName);if(t[this.hierarchicalColumnName]=r,"listed"===this.type&&r){var n=this.getDomRow(r),i=parseInt(n.getAttribute("level"),10);t.rowLevel=i+1}},deleteItemHierarchicalToggle:function(e){var t=this.getWrapEl().select('[id*="'+this.hierarchicalTogglePrefix+'"]'),r=e.get(this.primaryColumnName),n=this.id+this.hierarchicalTogglePrefix+r;if(t.each((function(e){if(n===e.dom.id)return Ext.removeNode(e.dom),!1}),this),this.hierarchical){var i=e.get(this.hierarchicalColumnName),a=this.collection.find(i),s=[];if(this.getAllItemChildren(s,i),Ext.isEmpty(i)||Ext.isEmpty(a)||s.length>0)return;this.removeExpandHierarchyLevel(i),this.deleteItemHierarchicalToggle(a)}},toggleHierarchyFolding:function(e,t){var r,n=this.getWrapEl(),i=Ext.get(this.id+this.hierarchicalTogglePrefix+e),a=Ext.select('[class~="'+this.id+this.hierarchicalChildrenPrefix+e+'"]',n);i&&i.hasCls(this.hierarchicalPlusCss)?(this.expandHierarchy(i,a,e),this.addExpandHierarchyLevel(e),r=!0):i&&i.hasCls(this.hierarchicalMinusCss)&&(this.collapseHierarchy(i,a),this.removeExpandHierarchyLevel(e),r=!1),t||this.fireEvent("updateExpandHierarchyLevels",e,r)},expandHierarchy:function(e,t,r){if(e.removeCls(this.hierarchicalPlusCss),e.addCls(this.hierarchicalMinusCss),!Ext.isEmpty(t)){if(r&&Ext.isEmpty(t.elements)&&this.useLevelRendering){var n=this.getDomRow(r),i=[],a={},s=n.getAttribute("level")||0;a.rowLevel=parseInt(s,10)+1,a.levelRows=this.filterRowsByParent(r),this.renderHierarchicalListedLevel(i,a),Ext.DomHelper.insertAfter(n,Ext.DomHelper.markup([i]))}t.each((function(e){e.removeCls(this.hiddenCss)}),this)}},collapseHierarchy:function(e,t){e.removeCls(this.hierarchicalMinusCss),e.addCls(this.hierarchicalPlusCss),t.each((function(e){if("listed"===this.type){var t=Ext.dom.Query.selectNode('[class~="'+this.hierarchicalMinusCss+'"]',e.dom);t&&t.click()}e.addCls(this.hiddenCss)}),this)},addExpandHierarchyLevel:function(e){var t=Ext.Array.clone(this.expandHierarchyLevels),r=e.toString();Terrasoft.contains(t,r)||t.push(r),this.expandHierarchyLevels=t},removeExpandHierarchyLevel:function(e){var t=Ext.Array.clone(this.expandHierarchyLevels),r=e.toString();Terrasoft.contains(t,r)&&(t=Terrasoft.without(t,r)),this.expandHierarchyLevels=t},setExpandHierarchyLevel:function(e){var t=this;Terrasoft.areArraysEqual(this.expandHierarchyLevels,e)||(this._toggleFoldingOnExpandHierarchyLevelChange&&_.difference(this.expandHierarchyLevels,e).forEach((function(e){return t.toggleHierarchyFolding(e,!0)})),e.forEach(this.addExpandHierarchyLevel,this),this.safeRerender())},resetExpandHierarchyLevel:function(){this.expandHierarchyLevels=[]},renderTiledHierarchicalGrid:function(e,t){for(var r=t.rows||this.rows,n=e.length,i=t[this.hierarchicalColumnName],a=this.multiSelect,s=0,o=r.length;s<o;s+=1){var l=r[s],c=l[this.hasNestingColumnName];t.row=l,t[this.hierarchicalColumnName]=l[this.primaryColumnName];var u,h,f,d=(l[this.primaryColumnName]||s).toString(),p=this.rowsStyles[d],m=this.getDefaultRowHtmlConfig(l);if(l.hasOwnProperty(this.hierarchicalColumnName)||i){if(l[this.hierarchicalColumnName]===i){var g=this.id+this.hierarchicalChildrenPrefix+l[this.hierarchicalColumnName];Ext.apply(m,{tag:"div",cls:"grid-row "+g,children:[{tag:"div",cls:"grid-row grid-pad "+this.theoreticallyActiveRowCss,style:Ext.DomHelper.generateStyles(p),id:this.id+this.collectionItemPrefix+d,children:[{tag:"div",cls:a?"grid-fixed-col-2":"grid-fixed-col",html:""}]}]}),Terrasoft.contains(this.expandHierarchyLevels,i.toString())||(m.cls+=" "+this.hiddenCss),this.renderColumns(m.children[0].children,t),u=this.renderTiledHierarchicalGrid(m.children[0].children,t),h=this.hierarchicalEmptyCss,(u>0||c)&&(h=this.hierarchicalPlusCss),Terrasoft.contains(this.expandHierarchyLevels,d.toString())&&(h=this.hierarchicalMinusCss),m.children[0].children[0].html=this.hierarchicalPlus.apply({id:this.id+this.hierarchicalTogglePrefix+l[this.primaryColumnName],cls:h+" grid-listed-row-control"}),a?(f=this.createCheckbox({classes:{wrapClass:["grid-listed-row-control"]},value:d}),Terrasoft.contains(this.selectedRows,d)&&(m.children[0].cls+=" "+this.selectedRowCss,f.setChecked(!0)),m.children[0].children[0].html+=f.generateHtml(),this.checkboxes.push(f)):this.activeRow===d&&(m.children[0].cls+=" "+this.activeRowCss),e.push(m)}}else Ext.apply(m,{tag:"div",cls:"grid-row grid-pad "+this.theoreticallyActiveRowCss,style:Ext.DomHelper.generateStyles(p),id:this.id+this.collectionItemPrefix+d,children:[{tag:"div",cls:a?"grid-fixed-col-2":"grid-fixed-col",html:""}]}),this.renderColumns(m.children,t),u=this.renderTiledHierarchicalGrid(m.children,t),h=this.hierarchicalEmptyCss,(u>0||c)&&(h=this.hierarchicalPlusCss),Terrasoft.contains(this.expandHierarchyLevels,d.toString())&&(h=this.hierarchicalMinusCss),m.children[0].html=this.hierarchicalPlus.apply({id:this.id+this.hierarchicalTogglePrefix+l[this.primaryColumnName],cls:h+" grid-listed-row-control"}),a?(f=this.createCheckbox({classes:{wrapClass:["grid-listed-row-control"]},value:d}),Terrasoft.contains(this.selectedRows,d)&&(m.cls+=" "+this.selectedRowCss,f.setChecked(!0)),m.children[0].html+=f.generateHtml(),this.checkboxes.push(f)):this.activeRow===d&&(m.cls+=" "+this.activeRowCss),e.push(m)}return e.length-n},renderListedHierarchicalGrid:function(e,t){var r=t.rowLevel||0,n=t.rows||this.rows,i=e.length,a=this.hierarchicalColumnName;if(this.useLevelRendering&&Terrasoft.isEmptyObject(t)){var s=this.getHierarchicalListedTopLevelItems();return this.renderHierarchicalChildItems(e,s,r),e.length-i}for(var o=t[a],l=0,c=n.length;l<c;l+=1){var u=n[l];t.row=u,t[a]=u[this.primaryColumnName];var h=(u[this.primaryColumnName]||l).toString();if(!u.hasOwnProperty(a)&&!o||u[a]===o){var f=this.getDefaultRowHtmlConfig(u);this.applyHierarchicalRowDefaultOptions(f,{id:h,level:r}),this.renderColumns(f.children,t),e.push(f),t.rowLevel=r+1;var d=this.renderListedHierarchicalGrid(e,t),p=u[this.hasNestingColumnName];f.children.unshift({tag:"div",cls:"grid-fixed-col",html:""});var m=this.baseOffset;this.multiSelect&&(m=this.baseOffset+this.checkboxOffset,this.processListedHierarchicalMultiSelectGrid(f,h)),this.multiSelect||this.activeRow!==h||(f.cls+=" "+this.activeRowCss);var g=Terrasoft.contains(this.expandHierarchyLevels,h);if(this.addToggleCssToListedHierarchicalGrid(f,{isHierarchicalPlusCss:d>0||p,isHierarchicalMinusCss:g,row:u}),this.addOffsetToListedHierarchicalGridRow(f,{level:r,marginLeftOffset:6,paddingLeftOffset:m}),r>0){var T=this.id+this.hierarchicalChildrenPrefix+u[this.hierarchicalColumnName];f.cls+=" "+T,Terrasoft.contains(this.expandHierarchyLevels,o.toString())||(f.cls+=" "+this.hiddenCss)}}}return e.length-i},renderHierarchicalChildItems:function(e,t,r){var n={};Terrasoft.each(t,(function(t){var i=this.filterRowsByParent(t.Id);n.rowLevel=r,n.levelRows=[t];var a=[];this.renderHierarchicalListedLevel(a,n),Terrasoft.contains(this.expandHierarchyLevels,t.Id)?(this.addToggleCssToListedHierarchicalGrid(a[0],{isHierarchicalPlusCss:!1,isHierarchicalMinusCss:!0,row:t}),e.push(a),this.renderHierarchicalChildItems(e,i,r+1)):e.push(a)}),this)},getHierarchicalListedTopLevelItems:function(){var e=this.hierarchicalColumnName;return this.rows.filter((function(t){return!t.hasOwnProperty(e)&&Ext.isEmpty(t[e])}))},renderHierarchicalListedLevel:function(e,t){var r=t.levelRows,n=t.rowLevel||0,i=this.rows,a=this.hierarchicalColumnName;Terrasoft.each(r,(function(r,s){var o=r.Id;t.row=r,t[a]=r[this.primaryColumnName];var l=(r[this.primaryColumnName]||s).toString(),c=this.getDefaultRowHtmlConfig(r);this.applyHierarchicalRowDefaultOptions(c,{id:l,level:n}),this.renderColumns(c.children,t),e.push(c),c.children.unshift({tag:"div",cls:"grid-fixed-col",html:""});var u=this.baseOffset;this.multiSelect&&(u=this.baseOffset+this.checkboxOffset,this.processListedHierarchicalMultiSelectGrid(c,l)),this.multiSelect||this.activeRow!==l||(c.cls+=" "+this.activeRowCss);var h={};h[a]=o;var f=Terrasoft.findWhere(i,h),d=r[this.hasNestingColumnName];if(this.addToggleCssToListedHierarchicalGrid(c,{isHierarchicalPlusCss:!Ext.isEmpty(f)||d,isHierarchicalMinusCss:!1,row:r}),this.addOffsetToListedHierarchicalGridRow(c,{level:n,marginLeftOffset:6,paddingLeftOffset:u}),n>0){var p=this.id+this.hierarchicalChildrenPrefix+r[a];c.cls+=" "+p}}),this)},addOffsetToListedHierarchicalGridRow:function(e,t){var r=e&&e.children;if(r&&r.length>1){var n=r[0],i=r[1];n.style=this._getMarginOffset(t),i.style=this._getPaddingOffset(t)}},addToggleCssToListedHierarchicalGrid:function(e,t){var r=e&&e.children;if(r&&r.length>0){var n=r[0],i=this.hierarchicalEmptyCss;t.isHierarchicalPlusCss&&(i=this.hierarchicalPlusCss),t.isHierarchicalMinusCss&&(i=this.hierarchicalMinusCss);var a=this.id+this.hierarchicalTogglePrefix+t.row[this.primaryColumnName],s=this.hierarchicalPlus.apply({id:a,cls:Ext.String.format("{0} grid-listed-row-control",i)});n.html=-1===n.html.indexOf(a)?s+n.html:s}},processListedHierarchicalMultiSelectGrid:function(e,t){var r=e&&e.children;if(r&&r.length>0){var n=r[0];n.cls="grid-fixed-col-2";var i=this.createCheckbox({classes:{wrapClass:["grid-listed-row-control"]},value:t});Terrasoft.contains(this.selectedRows,t)&&(e.cls+=" "+this.selectedRowCss,i.setChecked(!0)),n.html=i.generateHtml()+n.html,this.checkboxes.push(i)}},applyHierarchicalRowDefaultOptions:function(e,t){var r=t.id,n=this.rowsStyles[r],i=Ext.String.format("{0} {1}",this.listedRowsCss,this.theoreticallyActiveRowCss),a=this.id+this.collectionItemPrefix+r;Ext.apply(e,{tag:"div",cls:i,style:Ext.DomHelper.generateStyles(n),id:a,children:[],level:t.level})},expandHierarchyToActiveRow:function(e){var t=e&&this.collection&&this.collection.contains(e),r=this.autoExpandHierarchyLevels&&this.hierarchical&&this.hierarchicalColumnName;if(t&&r)for(var n=this._getParentId(e);n;)Terrasoft.contains(this.expandHierarchyLevels,n)||this.toggleHierarchyFolding(n),n=this._getParentId(n)}}),Ext.define("Terrasoft.controls.Grid",{extend:"Terrasoft.controls.Component",alternateClassName:"Terrasoft.Grid",mixins:{draggable:"Terrasoft.DraggableGridMixin",hierarchical:"Terrasoft.HierarchicalGridMixin"},type:null,multiSelect:!1,listedZebra:!1,rows:null,rowsStyles:null,cellsClasses:null,collection:null,columnsConfig:null,captionsConfig:null,listedConfig:null,tiledConfig:null,activeRowActions:null,isRowActionsVisible:!0,rowDataItemMarkerColumnName:null,captionPrefix:"-caption-",selectedRowCss:"grid-row-selected",sortIndicatorUp:'<div class="grid-sort-arrow grid-sort-arrow-up"></div>',sortIndicatorDown:'<div class="grid-sort-arrow grid-sort-arrow-down"></div>',sortColumnIndex:null,sortColumnDirection:Terrasoft.core.enums.OrderDirection.ASC,primaryColumnName:"Id",primaryDisplayColumnName:null,collectionItemPrefix:"-item-",internalColumns:["caption","label"],checkboxes:null,progressSpinner:null,selectedRows:null,theoreticallyActiveRowCss:"grid-active-selectable",activeRow:null,activeRowCss:"grid-row-selected",actionsRowPrefix:"-actions-item-",actionsRowTpl:new Ext.Template('<div id="{id}" class="grid-row-actions"></div>'),hiddenCss:"grid-row-hidden",actionItems:null,theoreticallyActiveRows:null,watchRowInViewport:0,watchRowHistory:null,translate:Terrasoft.Resources.Grid,isEmpty:!1,isEmptyCaption:null,isEmptyHtmlConfig:null,isEmptyCss:"grid-empty",isLoading:!1,isLoadingHtmlConfig:null,useRowActionsExternal:!1,rowActionsExternalPrefix:"-external-actions-item-",rowActionsExternalCss:"grid-row-actions-external",useListedLookupImages:!1,bottomSpinnerSpaceTpl:new Ext.Template('<span class="grid-bottom-spinner-space"></span>'),isLoadingSpinners:null,hasNestingColumnName:"",spinnerRowPrefix:"-spinner-row-",captionsCss:"grid-captions",listedRowsCss:"grid-listed-row",colsCss:"grid-cols",isEmptyRowVisible:!0,disabledClass:"grid-disabled",emptyMessageControl:null,scrollEl:null,scrollElId:null,allowScrollToActiveRow:!1,scrollParent:!1,defaultImageColumnName:null,canChangeMultiSelectWithGridClick:!0,_updateExpandHierarchyLevels:function(){this.collection&&this.collection.each((function(e){var t=[];this.getAllItemChildren(t,e.get(this.primaryColumnName)),0===t.length&&this.removeExpandHierarchyLevel(e.get(this.primaryColumnName))}),this)},_spanCellTemplate:['<span grid-data-type="{type}"','<tpl if="direction"> dir="{direction}"</tpl>','<tpl if="title"> title="{title}"</tpl>',">{text}</span>"],_spanCellXTemplate:null,reRender:function(e){if(this.initDefaultCollectionItemPrefix(),e&&e.byCollection&&this.rows){var t=this.rows.map((function(e){return e.Id})),r=this.collection;r=r&&r.filter((function(e,r){return!Ext.Array.contains(t,r)})),this.callParent(arguments),this.onCollectionDataLoaded(null,r,null)}else this.callParent(arguments)},constructor:function(e){this.rows=e.rows||[],this.rowsStyles=e.rowsStyles||{},this.cellsClasses=e.cellsClasses||{},this.listedConfig=e.listedConfig||null,this.tiledConfig=e.tiledConfig||null,this.columnsConfig=this.initColumnsConfig(e),this.captionsConfig=this.initCaptionsConfig(e),this.activeRowActions=e.activeRowActions||[],this.watchRowInViewport=this.watchRowInViewport||Math.abs(this.watchRowInViewport),this.watchRowHistory=[],this.primaryColumnName=e.primaryColumnName||this.primaryColumnName,this.hierarchicalColumnName=e.hierarchicalColumnName||this.hierarchicalColumnName,this.isEmptyCaption=e.isEmptyCaption||this.translate.isEmptyCaption,this.isEmptyHtmlConfig={tag:"div",cls:"grid-status-message-empty",html:this.isEmptyCaption},this.isLoadingHtmlConfig={tag:"div",cls:"grid-status-message-loading"},this.hasNestingColumnName=e.hasNestingColumnName||this.hasNestingColumnName,this.callParent(arguments)},addLookupImageInfo:function(e,t,r){if("listed"!==this.type||this.useListedLookupImages){e.keyImgExtension=e.keyImgExtension||{};var n=t.entitySchema,i=t.columns[r],a=i?i.columnPath:r;if(n&&a===n.primaryDisplayColumnName){n.primaryImageColumnName=n.primaryImageColumnName||this.defaultImageColumnName;var s=n.primaryImageColumnName;if(!s)return;t.get(s)&&(e.keyImgExtension[r]=t.getSchemaImageUrl(s,Terrasoft.ImageSize.IMAGE32X32))}else{i=t.columns[r];var o=t.get(r);if(Boolean(i&&i.isLookup&&o)){var l=t[t.defGetLookupImageUrlMethod];e.keyImgExtension[r]=l.call(t,r,Terrasoft.ImageSize.IMAGE32X32)}}}},addHasNestingInfo:function(e,t){this.hasNestingColumnName=t.defHasNestingColumnName||this.hasNestingColumnName;var r=this.hasNestingColumnName,n=t.get(r);e[r]=parseInt(n,10)},getIconSize:function(e){var t=Terrasoft.ImageSize.DEFAULT;switch(e){case Terrasoft.GridKeyType.ICON16:case Terrasoft.GridKeyType.ICON16LISTED:t=Terrasoft.ImageSize.IMAGE16X16;break;case Terrasoft.GridKeyType.ICON22LISTED:case Terrasoft.GridKeyType.ICON22:t=Terrasoft.ImageSize.IMAGE22X22;break;case Terrasoft.GridKeyType.ICON32LISTED:case Terrasoft.GridKeyType.ICON32:t=Terrasoft.ImageSize.IMAGE32X32}return t},insertItem:function(e,t){this.theoreticallyActiveRows=null;var r=[this.getRow(e)],n=[];this.renderGrid(n,{rows:r});for(var i="",a=0,s=n.length;a<s;a+=1)i+=Ext.DomHelper.createHtml(n[a]);var o={mode:"bottom"};if(0===t)o.mode="top";else if(t&&Number(t)>0){var l=this.collection.getByIndex(t-1);o.target=l.get(this.primaryColumnName),o.mode="after"}this.addRows(i,o)},init:function(){this.callParent(arguments),this.addEvents("selectRow","unSelectRow","openRecord","sortColumn","activeRowAction","watchedRowInViewport","afterRowRender","updateExpandHierarchyLevels","linkClick","linkMiddleClick","linkMouseOver","getEmptyMessageConfig","dragOver","dragDrop","invalidDrop","multiSelectChanged","enterkeypressed","loadMore"),this.selectors={wrapEl:""},this.classes={wrapEl:["grid"]},this.actionItems=[],this.checkboxes=[],this.selectedRows=[],this.expandHierarchyLevels=[],this.initDefaultCollectionItemPrefix()},initDefaultCollectionItemPrefix:function(){this.collectionItemPrefix="-item-"},onCollectionDataLoaded:function(e,t,r){if(this.theoreticallyActiveRows=null,!this.rows.length)return this.collection=this.collection||e,this.prepareCollectionData(),void this.safeRerender();if(!Ext.Object.isEmpty(t)&&this.rendered){var n=[],i={rows:n};if(t.each((function(e){this.prepareCollectionItem(e);var t=this.getRow(e);n.push(t),r&&("top"!==r.mode?this.rows.push(t):this.rows.splice(0,0,t))}),this),this.hierarchical&&!t.isEmpty()){var a=t.getByIndex(0).get(this.hierarchicalColumnName);if(i[this.hierarchicalColumnName]=a,"listed"===this.type&&a){var s=this.getDomRow(a),o=parseInt(s.getAttribute("level"),10);i.rowLevel=o+1}}var l=[];this.renderGrid(l,i);for(var c="",u=0,h=l.length;u<h;u+=1)c+=Ext.DomHelper.createHtml(l[u]);Ext.Object.isEmpty(r)&&(r={mode:"bottom"}),this.addRows(c,r),this.checkNeedLoadData()}},onAddItem:function(e){this.insertItem(e)},onReplaceItem:function(e){return this.onDeleteItem(e.removedItem),this.insertItem(e.insertedItem,e.index),!1},onUpdateItem:function(e){if(this.rendered){this.theoreticallyActiveRows=null;var t=this.getRow(e);this.updateRow(t);var r=[];r.push(t);var n={rows:r};this.hierarchical&&(this.addAllItemChildren(e,r),this.addHierarchicalOptions(e,n));var i=[];this.renderGrid(i,n);for(var a="",s=0,o=i.length;s<o;s+=1)a+=Ext.DomHelper.createHtml(i[s]);var l=e.get(this.primaryColumnName),c=this.getDomRow(l),u=c.insertSibling(a,"after");try{c.replaceWith(u)}catch(e){}this.initCheckboxesEvents(),this.initActionItems(),this.initLinkEvents()}},updateRow:function(e){for(var t=this.primaryColumnName,r=e[t],n=this.rows,i=0;i<n.length;i++)if(n[i][t]===r)return void(n[i]=e)},addAllItemChildren:function(e,t){var r=[];this.getAllItemChildren(r,e.get(this.primaryColumnName)),Ext.each(r,(function(r){var n=r.get(this.primaryColumnName),i=this.id+this.collectionItemPrefix+n;this.deleteItemRowActions(n),this.deleteItemCheckbox(n),this.deleteRow(i),this.deleteItemHierarchicalToggle(e),t.push(this.getRow(r))}),this)},getAllItemChildren:function(e,t){this.collection.each((function(r){var n=r.get(this.hierarchicalColumnName);if(t===n){var i=r.get(this.primaryColumnName);e.push(r),this.getAllItemChildren(e,i)}}),this)},getAllItemChilds:function(e,t){this.log(Ext.String.format(Terrasoft.Resources.ObsoleteMessages.ObsoleteMethodMessage,"getAllItemChilds","getAllItemChildren")),this.getAllItemChildren(e,t)},onDeleteItem:function(e){if(this.rendered){this.theoreticallyActiveRows=null;var t=e.get(this.primaryColumnName),r=this.id+this.collectionItemPrefix+t;if(this.multiSelect){var n=Ext.Array.clone(this.selectedRows),i=Terrasoft.without(n,t);this.setSelectedRows(i)}else t===this.activeRow&&this.setActiveRow(null);this.deleteItemRowActions(t),this.deleteItemCheckbox(t),this.deleteRow(r),this.deleteItemFromRows(t),this.deleteItemHierarchicalToggle(e)}},deleteItemFromRows:function(e){this.rows=Ext.Array.filter(this.rows,(function(t){return t.Id!==e}),this)},deleteItemRowActions:function(e){var t=this.id+this.actionsRowPrefix+e;this.actionItems.forEach((function(e){t===e.renderTo.id&&e.destroy()}),this)},deleteItemCheckbox:function(e){var t=_.findIndex(this.checkboxes,(function(t){return t.value===e}));if(-1!==t){var r=this.checkboxes.splice(t,1);r.length>0&&r[0].destroy()}},deleteRow:function(e){this.theoreticallyActiveRows=null;var t=Ext.get(e);t&&Ext.removeNode(t.dom)},addRows:function(e,t){if(this.rendered){switch(t.mode){case"top":this.addRowsTop(e);break;case"after":this.addRowsAfter(e,t);break;case"child":this.addRowsChild(e,t);break;case"bottom":this.addRowsBottom(e,t)}this.initCheckboxesEvents(),this.initActionItems(),this.initDraggable(),this.initLinkEvents()}},initLinkEvents:function(){var e=this.getWrapEl().select("a:not([id])");e.addListener("mouseover",this.onLinkMouseOver,this),e.each((function(e){e.dom.id=e.id=Terrasoft.Component.generateId()}),this)},onLinkMouseOver:function(e,t){var r=Ext.get(t),n=this.getWrapEl().dom,i=this.getRowId(t),a=r.findParent("a",n,!0);if(a&&i){var s={rowId:i,columnName:a.getAttribute("data-column"),targetId:a.getAttribute("id")};this.fireEvent("linkMouseOver",s)}},addRowsTop:function(e){var t,r,n=this.type,i=this.getWrapEl();if("tiled"===n)r=i,t="afterBegin";else if("listed"===n){r=i.select("."+this.captionsCss).first(),t="afterEnd"}r&&Ext.DomHelper.insertHtml(t,r.dom,e)},addRowsAfter:function(e,t){var r=this.getWrapEl(),n=t.target,i=Ext.get(this.id+this.collectionItemPrefix+n,r),a=this.type,s=this.hierarchical;if("tiled"===a&&s){var o=i.parent('[class*="-children-"]');o&&(i=o)}i&&Ext.DomHelper.insertHtml("afterEnd",i.dom,e)},addRowsChild:function(e,t){if(this.hierarchical){var r=this.getWrapEl(),n=t.target,i="beforeEnd",a=Ext.get(this.id+this.collectionItemPrefix+n,r),s=this.type;if("tiled"===s&&a){var o=a.select(".grid-row-actions").first();o&&(a=o,i="afterEnd")}else"listed"===s&&(i="afterEnd");a&&Ext.DomHelper.insertHtml(i,a.dom,e)}},addRowsBottom:function(e,t){var r=this.getWrapEl().select('[class="grid-bottom-spinner-space"]').item(0),n="beforeBegin";t.hasOwnProperty("spinner")&&t.spinner&&(n="afterBegin"),Ext.DomHelper.insertHtml(n,r.dom,e)},prepareCollectionData:function(){this.collection.each((function(e){this.prepareCollectionItem(e);var t=this.getRow(e);this.rows.push(t)}),this)},prepareCollectionItem:function(e){this.primaryColumnName=this.primaryColumnName||e.primaryColumnName,this.primaryDisplayColumnName=this.primaryDisplayColumnName||e.primaryDisplayColumnName;var t=this.getRowStyle(e),r=this.getCellsClasses(e);this.rowsStyles[e.get(this.primaryColumnName)]=t,Ext.apply(this.cellsClasses,r)},clear:function(){this.onDestroy(!0),this.rows=[],this.rowsStyles={},this.cellsClasses={},this.theoreticallyActiveRows=null,this.watchRowHistory=[];var e=this.getWrapEl();e&&this.rendered&&this.bottomSpinnerSpaceTpl.append(e)},_onMouseDown:function(){document.getSelection().removeAllRanges()},initDomEvents:function(){this.callParent(arguments);var e=this.getWrapEl();e.on("click",this.onGridClick,this),e.on("dblclick",this.onGridDoubleClick,this),e.on("mousedown",this._onMouseDown,this),this.debounceWindowScroll=this.debounceWindowScroll||Terrasoft.debounce(this.onWindowScroll,150);var t=this.getScrollElement(this.scrollElId);Ext.EventManager.addListener(t,"scroll",this.debounceWindowScroll,this),Ext.isIE11||Ext.isChrome||Ext.isSafari||Ext.isOpera?Ext.EventManager.addListener(t,"mousewheel",this.debounceWindowScroll,this):Ext.isGecko?Ext.EventManager.addListener(t,"DOMMouseScroll",this.debounceWindowScroll,this):Ext.EventManager.addListener(t,"onmousewheel",this.debounceWindowScroll,this),e.un("keydown",this.onKeyDown,this),e.on("keydown",this.onKeyDown,this)},onWindowScroll:function(){this.watchRowInViewport&&this.checkWatchedRow()},checkWatchedRow:function(){var e=this._getWatchRow();if(e){var t=e.dom.id;if(this.elementInViewport(e)){if(Ext.Array.indexOf(this.watchRowHistory,t)>=0)return;this.watchRowHistory.push(t),this.fireEvent("watchedRowInViewport",t)}}},checkNeedLoadData:function(){if(!this.watchRowInViewport)return!1;var e=this._getWatchRow((function(e){return e.length-1}));if(!e)return!1;var t=e.id;return!!this.elementInViewport(e)&&this.fireEvent("watchedRowInViewport",t)},_getWatchRow:function(e){e=e||Terrasoft.emptyFn;var t=this.hierarchical?this.getRootDomRows():this.getDomRows();if(!t||!this.isVisible())return null;var r=e.call(this,t)||t.length-this.watchRowInViewport;return!t.length||r<0?null:Ext.get(t[r])},elementInViewport:function(e){if(!e)return!1;if(!document.body.contains(e.dom))return!1;var t=Ext.getBody().getViewRegion();return e.getViewRegion().bottom<=t.bottom},getRowId:function(e){var t,r=Ext.get(e),n=this.getWrapEl().dom,i=r.findParent('[class*="'+this.theoreticallyActiveRowCss+'"]',n,!0);return i&&(t=i.id.replace(this.id+this.collectionItemPrefix,"")),t},onGridClick:function(e,t){if(this.enabled){var r=!0,n=this.type,i=Ext.get(t),a=this.getWrapEl().dom,s=this.getRowId(t),o=i.findParent("a",a,!0);if(o&&s&&(r=!1,this.handleLinkClick(s,o,e)),this.hierarchical&&r){var l=Ext.dom.Query.select('[id*="'+this.hierarchicalTogglePrefix+'"]',a);Terrasoft.each(l,(function(n){if(t===n){e.stopEvent(),r=!1;var i=n.id.replace(this.id+this.hierarchicalTogglePrefix,"");return this.toggleHierarchyFolding(i),!1}}),this)}if("listed"===n&&r){var c=i.findParent('[id*="'+this.id+this.captionPrefix+'"]',a,!0);if(c){e.stopEvent(),r=!1;var u=c.id.replace(this.id+this.captionPrefix,"");this.fireEvent("sortColumn",u)}}s&&r&&(e.stopEvent(),r=!1,this.hierarchical||!this.multiSelect&&!this.canChangeMultiSelectWithGridClick||!this.multiSelect&&!e.ctrlKey&&!e.shiftKey?this.setActiveRow(s):this.selectMultiRows(e,s))}else e.stopEvent()},_getRowsId:function(){var e=this;return this.collection.getItems().map((function(t){return t.get(e.primaryColumnName)}))},selectMultiRows:function(e,t){var r=this.activeRow;this.multiSelect||this.setMultiSelect(!0),Terrasoft.defer((function(){if(e.shiftKey){var n=this._getRowsId(),i=n.indexOf(t);if(!r){var a=Number.MAX_VALUE;this.selectedRows.forEach((function(e){var t=n.indexOf(e),s=Math.abs(t-i);a>s&&(a=s,r=e)}),this)}var s=n.indexOf(r);if(s>-1&&i>-1)(s>i?n.slice(i,s+1):n.slice(s,i+1)).forEach((function(e){this.selectRowWithCheckbox(e,!0)}),this)}else{var o=_.contains(this.selectedRows,t);e.ctrlKey&&r&&r!==t&&this.selectRowWithCheckbox(r,!0),this.selectRowWithCheckbox(t,!o)}}),this)},handleLinkClick:function(e,t,r){var n=t.getAttribute("href"),i=t.getAttribute("data-column"),a=Terrasoft.getMouseButton(r);a===Terrasoft.MouseButton.LEFT&&!1===this.fireEvent("linkClick",e,i,n)&&r.stopEvent(),a===Terrasoft.MouseButton.MIDDLE&&!1===this.fireEvent("linkMiddleClick",e,i,n)&&r.stopEvent()},getDomRows:function(e){if(!e){var t=this.getWrapEl();t&&t.dom&&(e=t.dom)}return this.theoreticallyActiveRows&&this.theoreticallyActiveRows.length||!e||(this.theoreticallyActiveRows=Ext.dom.Query.select('[class*="'+this.theoreticallyActiveRowCss+'"]',e)),this.theoreticallyActiveRows},getRootDomRows:function(e){if(!e){var t=this.getWrapEl();t&&t.dom&&(e=t.dom)}var r=[];if(e){var n=Ext.String.format("#{0}> .{1}:not([class*='{2}'])",e.id,this.theoreticallyActiveRowCss,this.hierarchicalChildrenPrefix);r=Ext.dom.Query.select(n)}return r},getDomRow:function(e){if(this.rendered&&e)return this.getWrapEl().getById(this.id+this.collectionItemPrefix+e)},onGridDoubleClick:function(e){if(this.enabled&&!this.multiselect){var t=this.getWrapEl().dom,r=Ext.dom.Query.select('[class*="'+this.theoreticallyActiveRowCss+'"]',t),n=_.find(r,(function(t){return e.within(t)}));if(n){e.stopEvent();var i=n.id.replace(this.id+this.collectionItemPrefix,"");this.fireEvent("openRecord",i)}}else e.stopEvent()},onAfterRender:function(){this.callParent(arguments),this.initCheckboxesEvents(),this.initActionItems(),this.initLinkEvents(),this.initRowActionsExternal();var e=this.loadEmptyMessageConfig();Ext.Object.isEmpty(e)||this.displayIsEmpty(e),this.mixins.draggable.onAfterRender.apply(this,arguments),this._observeNeedLoadData()},onAfterReRender:function(){this.callParent(arguments),this.initCheckboxesEvents(),this.initActionItems(),this.initLinkEvents(),this.initRowActionsExternal();var e=this.loadEmptyMessageConfig();Ext.Object.isEmpty(e)||this.displayIsEmpty(e),this.mixins.draggable.onAfterReRender.apply(this,arguments),this._observeNeedLoadData()},onBeforeReRender:function(){this.forceUpdateExpandHierarchyLevels&&this._updateExpandHierarchyLevels(),this.callParent(arguments),this.onDestroy(!0)},initCheckboxesEvents:function(){var e=this;this.checkboxes.forEach((function(t){t.rendering&&(t.init(),t.onAfterRender(),t.on("click",e.onCheckboxClick,e))}),e)},initActionItems:function(){(this.multiSelect?this.selectedRows:this.activeRow?[this.activeRow]:[]).forEach((function(e){this.addRowActions(e)}),this)},initRowActionsExternal:function(){this.useRowActionsExternal&&this.getDomRows().forEach((function(e){var t=e.id.replace(this.id+this.collectionItemPrefix,""),r=Ext.get(e).select("#"+this.id+this.rowActionsExternalPrefix+t+" div").item(0);t&&r&&this.fireEvent("afterRowRender",t,r)}),this)},onCheckboxClick:function(e){var t=e.value,r=e.checked;this.changeRowChecked(t,r)},changeRowChecked:function(e,t){this.setRowSelected(e,t),t?(this.addRowActions(e),this.fireEvent("selectRow",e)):(this.removeRowActions(e),this.fireEvent("unSelectRow",e)),this.fireEvent("rowsSelectionChanged")},selectRowWithCheckbox:function(e,t){t&&_.contains(this.selectedRows,e)||e&&(this.changeRowChecked(e,t),_.filter(this.checkboxes,{value:e}).forEach((function(e){e.setChecked(t)}),this),t?(this.activateRow(e),this.activeRow=e):(this.deactivateRow(e),this.activeRow=null))},setSelectedRows:function(e){if(Ext.isArray(e)){for(var t=Ext.Array.clone(this.selectedRows),r=e.length,n=this.selectedRows,i=n.length,a=0;a<i;a++){var s=n[a];Terrasoft.contains(e,s)||(this.unselectRow(s),t=Terrasoft.without(t,s))}for(a=0;a<r;a++){var o=e[a];Terrasoft.contains(n,o)||(this.selectRow(o),t.push(o))}this.selectedRows=t,this.fireEvent("rowsSelectionChanged")}},selectRow:function(e){this.rendered&&(this.setCheckboxChecked(e,!0),this.addRowActions(e)),this.fireEvent("selectRow",e)},unselectRow:function(e){this.rendered&&(this.setCheckboxChecked(e,!1),this.removeRowActions(e)),this.fireEvent("unSelectRow",e)},setCheckboxChecked:function(e,t){if(this.multiSelect)for(var r=this.checkboxes,n=0,i=r.length;n<i;n+=1){var a=r[n];a.value===e&&(a.setChecked(t),this.setRowSelected(e,t))}},setRowSelected:function(e,t){var r=Ext.Array.clone(this.selectedRows),n=this.getWrapEl().dom,i=this.id+this.collectionItemPrefix+e,a=Ext.get(Ext.dom.Query.selectNode("#"+i,n));t?(a&&a.addCls(this.selectedRowCss),r.push(e)):(a&&a.removeCls(this.selectedRowCss),r=Terrasoft.without(this.selectedRows,e)),this.selectedRows=r},setActiveRow:function(e){var t=Ext.isObject(e)?e.value:e,r=this.activeRow;if(r||t){var n=t!==r;if(n&&t){var i=r&&this.canExecute({method:this.setActiveRow,args:arguments});if(!1===i)return}n&&(this.deactivateRow(r),this.activateRow(t),this.activeRow=t,this.expandHierarchyToActiveRow(t),this.scrollPageToActiveRow(e),this.fireEvent("unSelectRow",r),this.fireEvent("selectRow",this.activeRow))}},scrollPageToActiveRow:function(e){var t=e&&e.value;if(this.rendered&&t&&e.scrollPageToActiveRow){var r=this.getDomRow(t);r&&Terrasoft.setTopScroll(r.getTop())}},activateRow:function(e){if(this.rendered&&e){var t=this.getDomRow(e);if(t){if(this.allowScrollToActiveRow){var r=this.getWrapEl();Terrasoft.utils.dom.scrollToEl(t,r,this.scrollParent)}t.addCls(this.activeRowCss),this.addRowActions(e)}}},deactivateRow:function(e){if(this.rendered&&e){var t=this.getDomRow(e);t&&(t.removeCls(this.activeRowCss),this.removeRowActions(e))}},addRowActions:function(e){if(!this.multiSelect&&this.activeRowActions.length&&this.isRowActionsVisible){var t=Ext.get(this.id+this.actionsRowPrefix+e);if(t)t.removeCls(this.hiddenCss);else{var r=this.createActionsRow(e);r&&this.renderRowActions(r,e)}}},createActionsRow:function(e){var t=Ext.get(this.id+this.collectionItemPrefix+e);if(t){var r=this.type,n=this.hierarchical,i="beforeEnd",a=t.dom,s=this.actionsRowTpl.apply({id:this.id+this.actionsRowPrefix+e});if(this.useRowActionsExternal){var o=t.select("#"+this.id+this.rowActionsExternalPrefix+e);o.getCount()&&(i="beforeBegin",a=o.first().dom)}if("tiled"===r&&n){var l=t.child('[class*="'+this.hierarchicalChildrenPrefix+'"]',!0);l&&(i="beforeBegin",a=l)}var c=Ext.DomHelper.insertHtml(i,a,s);return Ext.get(c)}},removeRowActions:function(e){if(this.activeRowActions.length){var t=Ext.get(this.id+this.actionsRowPrefix+e);t&&t.addCls(this.hiddenCss)}},renderRowActions:function(e,t){var r=Ext.clone(this.activeRowActions),n=this;function i(e,r){n.onActionItemClick(r.tag,t)}function a(){n.onActionItemClick(this.tag,t)}for(var s=0,o=r.length;s<o;s+=1){var l=r[s];if(l.renderTo=e,l.hasOwnProperty("menu")&&l.menu.hasOwnProperty("items")){var c=l.menu.items;c&&!c.bindTo&&Terrasoft.each(c,(function(e){e.hasOwnProperty("handler")||(e.handler=i)}))}else Ext.merge(l,{listeners:{click:a}});var u=Ext.create(l.className,l);if(this.collection){var h=this.collection.get(t);u.bind(h)}u.setEnabled(this.enabled),this.actionItems.push(u)}},onActionItemClick:function(e,t){this.fireEvent("activeRowAction",e,t)},createCheckbox:function(e){return Ext.create("Terrasoft.CheckBoxEdit",e)},generateHtmlTpl:function(e,t){var r={tag:"div",id:"grid-"+this.id+"-wrap",tabindex:0,cls:e.join(" "),children:[]};if(this.isEmpty){var n=this.loadEmptyMessageConfig();Ext.Object.isEmpty(n)&&r.children.push(this.isEmptyHtmlConfig),r.cls+=" "+this.isEmptyCss}else"listed"===t&&r.children.push(this.renderCaptionsRow()),this.renderGrid(r.children,{});return r.children.push(this.bottomSpinnerSpaceTpl.apply()),r},generateCollectionItemPrefix:function(){return Terrasoft.Features.getIsEnabled("GenerateGridItemPrefixWithGuid")?Ext.String.format("-{0}{1}",Terrasoft.generateGUID(),this.collectionItemPrefix):this.collectionItemPrefix},generateHtml:function(){if(!0!==this.visible)return this.tpl="","";this.collectionItemPrefix=this.generateCollectionItemPrefix(),this.selectors.wrapEl="#grid-"+this.id+"-wrap";var e=this.hierarchical,t=this.multiSelect,r=this.type,n=this.classes.wrapEl,i=this.listedZebra;Ext.Array.remove(n,"grid-tiled"),Ext.Array.remove(n,"grid-listed"),Ext.Array.remove(n,"grid-listed-zebra"),"tiled"===r?n.push("grid-tiled"):"listed"===r&&(n.push("grid-listed"),i&&n.push("grid-listed-zebra")),Ext.Array.remove(n,"grid-hierarchical"),e&&n.push("grid-hierarchical"),Ext.Array.remove(n,"grid-multiselect"),t&&n.push("grid-multiselect"),Ext.Array.remove(n,this.disabledClass),this.enabled||n.push(this.disabledClass);var a=this.generateHtmlTpl(n,r);return this.tpl=Ext.DomHelper.markup(a),this.callParent(arguments)},renderGrid:function(e,t){var r=this.hierarchical,n=this.type;r?"listed"===n?this.renderListedHierarchicalGrid(e,t):"tiled"===n&&this.renderTiledHierarchicalGrid(e,t):"listed"===n?this.renderListedGrid(e,t):"tiled"===n&&this.renderTiledGrid(e,t)},renderTiledGrid:function(e,t){for(var r=t.rows||this.rows,n=0,i=r.length;n<i;n+=1){var a=r[n];t.row=a;var s=(a[this.primaryColumnName]||n).toString(),o=this.rowsStyles[s],l=this.getDefaultRowHtmlConfig(a);if(Ext.apply(l,{tag:"div",cls:"grid-row grid-pad "+this.theoreticallyActiveRowCss,style:Ext.DomHelper.generateStyles(o),id:this.id+this.collectionItemPrefix+s,children:[]}),this.multiSelect){var c=this.createCheckbox({value:s});Terrasoft.contains(this.selectedRows,s)&&(l.cls+=" "+this.selectedRowCss,c.setChecked(!0)),l.children.push({tag:"div",cls:"grid-fixed-col",html:c.generateHtml()}),this.checkboxes.push(c)}else this.activeRow===s&&(l.cls+=" "+this.activeRowCss);this.renderColumns(l.children,t),this.useRowActionsExternal&&l.children.push({tag:"div",id:this.id+this.rowActionsExternalPrefix+s,cls:this.rowActionsExternalCss,children:[{tag:"div",cls:this.colsCss+"-24"}]}),e.push(l)}},getDefaultRowHtmlConfig:function(e){var t={},r=this.rowDataItemMarkerColumnName||this.primaryDisplayColumnName;if(r){var n=e[r];Ext.isEmpty(n)||Ext.apply(t,{"data-item-marker":this.encodeHtml(n)})}return t},renderListedGrid:function(e,t){for(var r=t.rows||this.rows,n=0,i=r.length;n<i;n+=1){var a=r[n];t.row=a;var s=(a[this.primaryColumnName]||n).toString(),o=this.rowsStyles[s],l=this.getDefaultRowHtmlConfig(a);if(Ext.apply(l,{tag:"div",cls:this.listedRowsCss+" "+this.theoreticallyActiveRowCss,style:Ext.DomHelper.generateStyles(o),id:this.id+this.collectionItemPrefix+s,children:[]}),this.renderColumns(l.children,t),this.multiSelect){l.children.unshift({tag:"div",cls:"grid-fixed-col",html:""});var c=l.children[0],u=this.createCheckbox({classes:{wrapClass:["grid-listed-row-control"]},value:s});Terrasoft.contains(this.selectedRows,s)&&(l.cls+=" "+this.selectedRowCss,u.setChecked(!0)),c.html=u.generateHtml()+l.children[0].html,this.checkboxes.push(u)}else this.activeRow===s&&(l.cls+=" "+this.activeRowCss);e.push(l)}},renderColumns:function(e,t){for(var r=this.getColumnsConfig(),n=0,i=r.length;n<i;n+=1){var a=r[n];Ext.isArray(a)?(t.column=a,this.renderRow(e,t)):Ext.isObject(a)&&(t.cell=a,this.renderCell(e,t))}},getColumnsConfig:function(){var e=this[this.type+"Config"];return e?e.columnsConfig:this.columnsConfig},getCaptionsConfig:function(){var e=this[this.type+"Config"];return e?e.captionsConfig:this.captionsConfig},initColumnsConfig:function(e){var t=this[e.type+"Config"],r=(t?t.columnsConfig:e.columnsConfig)||[];return e.columnsConfig||(e.columnsConfig=r),r},initCaptionsConfig:function(e){var t=this[e.type+"Config"],r=(t?t.captionsConfig:e.captionsConfig)||[];return e.captionsConfig||(e.captionsConfig=r),r},renderRowCell:function(e,t,r){return e.cell=t,r.cls.indexOf("grid-module")<0&&(r.cls+=" grid-module"),this.renderCell(r.children,e)},renderVerticalGridCells:function(e,t,r,n){return Terrasoft.each(e,(function(e){t+=this.renderRowCell(r,e,n)}),this),t},renderRow:function(e,t){for(var r=0,n={tag:"div",cls:"grid-row",children:[]},i=0,a=t.column.length,s=0;s<a;s+=1){var o=t.column[s],l=Terrasoft.deepClone(t);Ext.isArray(o)?this.isVertical?(i=o.length,r=this.renderVerticalGridCells(o,r,l,n)):(l.column=o,this.renderRow(n.children,l),r+=1):Ext.isObject(o)&&(r+=this.renderRowCell(l,o,n))}!1===this.isEmptyRowVisible&&(!this.isVertical&&a>r||this.isVertical&&i>r)||r>0&&e.push(n)},renderCell:function(e,t){var r=0,n=t.cell,i=t.row,a=this.getDataKey(t.cell.link),s={},o=this.colsCss+"-"+n.cols;n.classes&&Ext.isArray(n.classes)&&(o+=" "+n.classes.join(" "));var l={tag:"div",cls:o,html:"",children:[],"grid-cell-type":[]};n.minHeight&&(s["min-height"]=n.minHeight),n.maxHeight&&(s["max-height"]=n.maxHeight,s.overflow="hidden"),l.style=Ext.DomHelper.generateStyles(s);var c=n.key;if(Ext.isArray(c))for(var u=0,h=c.length;u<h;u+=1){var f=c[u];r+=this.formatCellContent(l,i,f,a)}else Ext.isObject(c)&&(r+=this.formatCellContent(l,i,c,a));return l["grid-cell-type"]=Ext.Array.intersect(l["grid-cell-type"]),l["grid-cell-type"].length>0?l["grid-cell-type"]=l["grid-cell-type"].join(" "):delete l["grid-cell-type"],r>0?(e.push(l),1):(l.html="",e.push(l),0)},encodeHtml:function(e){return e=Terrasoft.encodeHtml(e),Ext.isString(e)&&(e=(e=(e=(e=(e=e.replace(/{/g,"&#123;")).replace(/}/g,"&#125;")).replace(/\\/g,"&#92;")).replace(/&amp;laquo;/g,"«")).replace(/&amp;raquo;/g,"»")),e},formatCellLink:function(e,t,r){var n='<a href="{0}" target="{1}" title="{2}" data-column="{3}">{4}</a>';if(e.customUrlsExists){return e.customUrls.forEach((function(e,t){r=r.replace(this.encodeHtml(e),Ext.String.format("url_occurrence_{0}",t))}),this),e.customUrls.forEach((function(t,i){r=r.replace(Ext.String.format("url_occurrence_{0}",i),Ext.String.format(n,t,e.target,this.encodeHtml(t),"",t))}),this),r}return Ext.String.format(n,this.encodeHtml(e.url),e.target,this.encodeHtml(e.title),t,r)},formatCellImage:function(e,t){return Ext.String.format('<img src="{0}" class="{1}">',e,this.encodeHtml(t))},formatCellSpan:function(e,t){var r=this._getSpanCellXTemplate(),n=Terrasoft.removeHtmlTags(t),i=this.encodeHtml(n),a=null;return Terrasoft.getIsRtlMode()&&(a=Terrasoft.containsRtlChars(t)?a:"ltr"),r.apply({type:e,text:i,direction:a})},_getSpanCellXTemplate:function(){return this._spanCellXTemplate=this._spanCellXTemplate||new Ext.XTemplate(this._spanCellTemplate),this._spanCellXTemplate},formatCellLabel:function(e){return Ext.String.format('<span class="grid-label">{0}</span>',this.encodeHtml(e))},formatCellContent:function(e,t,r,n){var i,a=0,s=this.getDataKey(r.name),o=r.type||"text",l=this.type,c=t[s],u="";t.hasOwnProperty("keyImgExtension")&&t.keyImgExtension.hasOwnProperty(s)&&"label"!==o&&"caption"!==o?u=t.keyImgExtension[s]:o.indexOf("icon")>-1&&t.hasOwnProperty(s)&&(u=t[s]),n&&t.hasOwnProperty(n)&&(i=t[n]);var h,f,d=Ext.Array.contains(this.internalColumns,o),p=new RegExp("\\d+x\\d+","i");if(!c&&!u&&!d)return a;if(-1===o.indexOf("icon")&&u){var m=r.lookupImageType||"grid-icon-fixed-32x32";f=p.exec(m)[0],e.cls+=" icon-spacer-"+f,h=this.formatCellImage(u,m),e.html+=i?this.formatCellLink(i,this.encodeHtml(s),h):h}var g=this.cellsClasses[s],T=o;if("text"===o)g&&g.typeClass&&(T=g.typeClass,e["grid-cell-type"].push(g.typeClass)),"tiled"===l&&0===e.html.length&&(this.multiSelect||this.hierarchical)&&(e.style="padding-top: 5px;"),h=this.formatCellSpan(T,c),e.html+=i?this.formatCellLink(i,this.encodeHtml(s),h):h,a+=1;else if("caption"===o)"tiled"===l&&0===e.html.length&&(this.multiSelect||this.hierarchical)&&(e.style="padding-top: 6px;"),e.html+=this.formatCellLabel(s);else if("label"===o)h=this.formatCellLabel(s),e.html+=i?this.formatCellLink(i,this.encodeHtml(s),h):h,a+=1;else if(o.indexOf("grid-icon")>-1&&u)h=this.formatCellImage(u,o),e.html+=i?this.formatCellLink(i,this.encodeHtml(s),h):h,f=p.exec(o)[0],e.cls+=" icon-spacer-"+f,a+=1;else if(u&&(o.indexOf("flag-icon")>-1||o.indexOf("listed-icon")>-1))h=this.formatCellImage(u,o),e.html+=i?this.formatCellLink(i,this.encodeHtml(s),h):h,a+=1;else if("title"===o)g&&g.typeClass&&(T=g.typeClass,e["grid-cell-type"].push(g.typeClass)),h=this.formatCellSpan(T,c),e.html+=i?this.formatCellLink(i,this.encodeHtml(s),h):h,e.cls+=" grid-header",a+=1;else if("link"===o){var y=Ext.DomHelper.createHtml({tag:"a",target:c.target||"_blank",html:this.encodeHtml(c.caption),href:c.url,"data-column":this.encodeHtml(s)});e.html+=y,a+=1}return s===this.primaryDisplayColumnName&&(e.cls+=" grid-primary-column"),a},getDataKey:function(e){if(Ext.isObject(e)&&e.bindTo){var t=this.columnBindings[e.bindTo];t&&(e=t.modelItem)}return e},renderCaptionsRow:function(){for(var e=this.getCaptionsConfig(),t=this.getColumnsConfig(),r=Terrasoft.core.enums.OrderDirection.ASC,n=Terrasoft.core.enums.OrderDirection.DESC,i={tag:"div",cls:this.captionsCss,children:[]},a=0,s=e.length;a<s;a+=1){var o=e[a],l="";(this.sortColumnIndex===a||o.sortColumnDirection)&&(this.captionsConfig[a].sortColumnDirection&&(this.sortColumnIndex=a,this.sortColumnDirection=o.sortColumnDirection,delete this.captionsConfig[a].sortColumnDirection),this.sortColumnDirection===r?l=this.sortIndicatorUp:this.sortColumnDirection===n&&(l=this.sortIndicatorDown));var c={tag:"div",cls:this.colsCss+"-"+o.cols,html:"<label title='"+o.name+"'>"+o.name+"</label>"+l,id:this.id+this.captionPrefix+a,"data-item-marker":o.name},u=t[a];if(u){var h,f=u.key;Ext.isArray(f)?h=this.getDataKey(f[0].name):Ext.isObject(f)&&(h=this.getDataKey(f.name));var d=this.cellsClasses[h];d&&d.typeClass&&(c["grid-caption-type"]=d.typeClass)}i.children.push(c)}return i},setSortColumnIndex:function(e){this.sortColumnIndex!==e&&null!=e&&(this.updateSortColumn(e,this.sortColumnDirection),this.sortColumnIndex=e)},setSortColumnDirection:function(e){this.sortColumnDirection!==e&&null!=e&&(this.updateSortColumn(this.sortColumnIndex,e),this.sortColumnDirection=e)},removeSortColumnIndicator:function(){if(this.rendered){var e=this.sortColumnIndex,t=this.getWrapEl();if(null!=e){var r=t.select('[id="'+this.id+this.captionPrefix+e+'"]').first();if(r){var n=r.getHTML(),i=new RegExp(this.sortIndicatorDown,"igm"),a=new RegExp(this.sortIndicatorUp,"igm"),s=n.replace(i,"");s=s.replace(a,""),r.setHTML(s)}}}},addSortColumnIndicator:function(e,t){if(this.rendered){var r=this.getWrapEl().select('[id="'+this.id+this.captionPrefix+e+'"]').item(0);if(r){var n=r.getHTML(),i="";t===Terrasoft.core.enums.OrderDirection.ASC?i=this.sortIndicatorUp:t===Terrasoft.core.enums.OrderDirection.DESC&&(i=this.sortIndicatorDown);var a=n+i;r.setHTML(a)}}},updateSortColumn:function(e,t){this.rendered&&(this.removeSortColumnIndicator(),this.addSortColumnIndicator(e,t))},setIsEmpty:function(e){this.isEmpty!==e&&(this.isEmpty=e,this.displayIsEmpty())},displayIsEmpty:function(e){if(this.rendered){var t=this.getWrapEl();if(this.isEmpty)if(this.clear(),t.addCls(this.isEmptyCss),Ext.Object.isEmpty(e)&&(e=this.loadEmptyMessageConfig()),Ext.Object.isEmpty(e)){var r=t.select('[class="grid-bottom-spinner-space"]').item(0),n=Ext.DomHelper.createHtml(this.isEmptyHtmlConfig);Ext.DomHelper.insertHtml("beforeBegin",r.dom,n)}else this.emptyMessageControl=Ext.create(e.className,Ext.apply({},e,{renderTo:t}));else{var i=t.select('[class*="grid-status-message"]').item(0);i&&(t.removeCls(this.isEmptyCss),i.destroy())}}},loadEmptyMessageConfig:function(){var e={};return this.fireEvent("getEmptyMessageConfig",e),e&&e.className?Ext.clone(e):{}},setIsLoading:function(e){var t,r;if(Ext.isObject(e))t=e.state,r=e.options;else if(t=e,r={mode:"bottom"},this.isLoading===t)return;this.isLoading=t,this.displayIsLoading(r)},displayIsLoading:function(e){if(this.rendered)if(this.isLoading){var t=this.createSpinnerRow(e);if(!t)return;e.spinner=!0,this.addRows(t,e),this.progressSpinner.show()}else{var r=this.createProgressSpinnerId(e);this.deleteRow(r)}},createSpinnerRow:function(e){var t=this.getWrapEl(),r=this.createProgressSpinnerId(e);if(!t.select("#"+r).getCount()){var n,i=this.type,a=e.mode;return"tiled"===i&&"bottom"!==a?(n={tag:"div",cls:"grid-row grid-pad",id:r,children:[{tag:"div",cls:"grid-row grid-module"}]}).children[0].html=this.createProgressSpinner():"listed"===i&&"bottom"!==a?(n={tag:"div",cls:this.listedRowsCss,id:r}).html=this.createProgressSpinner():((n=this.isLoadingHtmlConfig).id=r,n.html=this.createProgressSpinner()),Ext.DomHelper.markup(n)}},createProgressSpinner:function(){return this.progressSpinner=this.progressSpinner||Terrasoft.getSpinner("grid-loading-spinner"),this.progressSpinner.generateHtml()},createProgressSpinnerId:function(e){var t=Terrasoft.compact([e.mode,e.target]).join("-");return[this.id,this.spinnerRowPrefix,t].join("")},onDestroy:function(e){var t;this.progressSpinner&&!this.progressSpinner.destroyed&&this.progressSpinner.destroy(),this.dragDropGroupName&&this.mixins.draggable.onDestroy.apply(this,arguments),this.checkboxes&&this.checkboxes.length>0&&(this.checkboxes.forEach((function(e){e.destroy()}),this),this.checkboxes=[]),this.actionItems&&this.actionItems.length>0&&(this.actionItems.forEach((function(e){!0!==e.destroyed&&e.destroy()}),this),this.actionItems=[]),this.emptyMessageControl&&(this.emptyMessageControl.destroy(),this.emptyMessageControl=null);var r=this.getWrapEl();if(!e&&(r&&(r.un("click",this.onGridClick,this),r.un("dblclick",this.onGridDoubleClick,this),r.un("mousedown",this._onMouseDown,this),r.un("keydown",this.onKeyDown,this)),this.debounceWindowScroll)){var n=this.getScrollElement();Ext.EventManager.removeListener(n,"scroll",this.debounceWindowScroll,this),Ext.isIE11||Ext.isChrome||Ext.isSafari||Ext.isOpera?Ext.EventManager.removeListener(n,"mousewheel",this.debounceWindowScroll,this):Ext.isGecko?Ext.EventManager.removeListener(n,"DOMMouseScroll",this.debounceWindowScroll,this):Ext.EventManager.removeListener(n,"onmousewheel",this.debounceWindowScroll,this)}r&&r.setHTML(""),e||this.callParent(arguments),null===(t=this._needLoadDataObserver)||void 0===t||t.disconnect()},columnBindings:null,getRow:function(e){var t=this,r=this.columnBindings,n={},i=this.primaryColumnName,a=this.hierarchicalColumnName;n[i]=e.get(i);var s=this.primaryDisplayColumnName;if(s&&(n[s]=e.get(s)),this.hierarchical){var o=e.get(a);o&&(Ext.isObject(o)&&o.hasOwnProperty("value")?n[a]=o.value:Ext.isString(o)&&(n[a]=o))}return Terrasoft.each(r,(function(r,i){if(!r.bindingType){var a=t.getBindingType(i,r,e);r.bindingType=a}var s=t.getBindingValue(r,e),o=r.modelItem,l=e.getColumnDataType(o),c=s;if(l!==Terrasoft.DataValueType.CUSTOM_OBJECT&&r.bindingType===Terrasoft.BindingType.PROPERTY){t.addLookupImageInfo(n,e,o),t.addHasNestingInfo(n,e,o);var u=e.columns[o];if(r.imageSize||l===Terrasoft.DataValueType.IMAGELOOKUP){var h=e.defGetLookupImageUrlMethod;c=e[h].call(e,o,r.imageSize)}else if(u&&u.isNotFound)c=t.translate.columnNotFound;else{var f=t.getColumnPrecision(e,o);c=Terrasoft.getTypedStringValue(s,l,{decimalPrecision:f})}}n[o]=c})),n},getColumnPrecision:function(e,t){var r=e.getColumnByName(t);return Ext.isEmpty(r)?null:r.precision},getRowStyle:function(e){var t={};return e.hasOwnProperty("customStyle")&&(t=e.customStyle),t},getCellsClasses:function(e){var t={},r=this.columnBindings;return Terrasoft.each(r,(function(r){var n=r.modelItem,i=e.columns[n];if(i&&i.isNotFound)t[n]={typeClass:"columnNotFound"};else switch(e.getColumnDataType(n)){case Terrasoft.DataValueType.INTEGER:case Terrasoft.DataValueType.FLOAT:case Terrasoft.DataValueType.MONEY:t[n]={typeClass:"number"}}}),this),t},resetColumnBindings:function(e){this.columnBindings={},this.initColumnBindings(e)},initColumnBindings:function(e){var t=this,r=this.columnBindings;Terrasoft.each(e,(function(e){Ext.isArray(e)?t.initColumnBindings(e):Terrasoft.each(e,(function(e,n){if(Ext.isArray(e))t.initColumnBindings(e);else if(Ext.isObject(e)&&e.bindTo){var i=t.initBinding(n,e);if(i){i.config.isColumnConfig=!0;var a=Terrasoft.GridKeyType;n.type!==a.ICON16&&n.type!==a.ICON22&&n.type!==a.ICON32&&n.type!==a.ICON16LISTED&&n.type!==a.ICON22LISTED&&n.type!==a.ICON32LISTED||(i.imageSize=t.getIconSize(n.type)),r[e.bindTo]=i}}}))}))},initBindings:function(e){this.callParent(arguments),this.columnBindings={};var t=e.columnsConfig;this.initColumnBindings(t)},getBindConfig:function(){var e=this.callParent(arguments),t={collection:{changeMethod:"onCollectionDataLoaded"},selectedRows:{changeEvent:"rowsSelectionChanged",changeMethod:"setSelectedRows"},activeRow:{changeEvent:"selectRow",changeMethod:"setActiveRow"},isRowActionsVisible:{changeMethod:"setIsRowActionsVisible"},isEmpty:{changeMethod:"setIsEmpty"},isLoading:{changeMethod:"setIsLoading"},multiSelect:{changeMethod:"setMultiSelect"},sortColumnIndex:{changeEvent:"sortColumn",changeMethod:"setSortColumnIndex"},sortColumnDirection:{changeMethod:"setSortColumnDirection"},type:{changeMethod:"setType"},expandHierarchyLevels:{changeEvent:"updateExpandHierarchyLevels",changeMethod:"setExpandHierarchyLevel"},isEmptyRowVisible:{changeMethod:"setIsEmptyRowVisible"},listedZebra:{changeMethod:"setListedZebra"},hierarchical:{changeMethod:"setHierarchical"},canChangeMultiSelectWithGridClick:{changeMethod:"setCanChangeMultiSelectWithGridClick"}};return Ext.apply(t,e),t},setHierarchical:function(e){this.hierarchical!==e&&(this.hierarchical=e,this.safeRerender())},setListedZebra:function(e){this.listedZebra!==e&&(this.listedZebra=e,this.activeRow=null,this.selectedRows=[],this.init(),this.safeRerender())},setIsEmptyRowVisible:function(e){this.isEmptyRowVisible!==e&&(this.isEmptyRowVisible=e)},setIsRowActionsVisible:function(e){this.isRowActionsVisible!==e&&(this.isRowActionsVisible=e)},setMultiSelect:function(e){this.multiSelect!==e&&(this.multiSelect=e,e||(this.checkboxes=[],this.setSelectedRows(this.selectedRows.slice(0,1))),this.safeRerender({byCollection:!0}),this.fireEvent("multiSelectChanged",e))},setCanChangeMultiSelectWithGridClick:function(e){this.canChangeMultiSelectWithGridClick=e},setType:function(e){this.type!==e&&(this.type=e,this.activeRow=null,this.selectedRows=[],this.init(),this.safeRerender())},setControlPropertyValue:function(e,t,r){e.config&&e.config.isColumnConfig?this.onUpdateRow(r):this.callParent(arguments)},subscribeForCollectionEvents:function(e,t,r){this.callParent(arguments);var n=r.get(e.modelItem);n.on("dataLoaded",this.onCollectionDataLoaded,this),n.on("add",this.onAddItem,this),n.on("remove",this.onDeleteItem,this),n.on("itemChanged",this.onUpdateItem,this),n.on("clear",this.clear,this),n.on("replace",this.onReplaceItem,this)},unSubscribeForCollectionEvents:function(e,t,r){if(r){this.callParent(arguments);var n=r.get(e.modelItem);n.un("dataLoaded",this.onCollectionDataLoaded,this),n.un("add",this.onAddItem,this),n.un("remove",this.onDeleteItem,this),n.un("itemChanged",this.onUpdateItem,this),n.un("clear",this.clear,this)}},setEnabled:function(e){this.enabled!==e&&(this.callParent(arguments),this.checkboxes.forEach((function(t){t.setEnabled(e)}),this),this.actionItems.forEach((function(t){t.setEnabled(e)}),this))},getScrollElement:function(e){return e&&Ext.isString(e)&&(this.scrollEl=Ext.get(e)),this.scrollEl=this.scrollEl||window},onKeyDown:function(e){var t=!1;if(this._canHandleEvent(e))switch(e.keyCode){case e.ENTER:t=this.onEnterPressed(e);break;case e.DOWN:t=this.gotToNextRow(1);break;case e.UP:t=this.goToPreviousRow(1);break;case e.PAGE_DOWN:t=this.gotToNextRow(15);break;case e.PAGE_UP:t=this.goToPreviousRow(15);break;case e.END:t=this.gotToNextRow(0);break;case e.HOME:t=this.goToPreviousRow(0)}if(t)return e.preventDefault(),!1},onEnterPressed:function(){return this.fireEvent("enterkeypressed"),!0},gotToNextRow:function(e){if(this.activeRow){var t=this._getRowsId(),r=t.indexOf(this.activeRow),n=t.length-1;if(r<n){var i=(e?t[r+e]:t[n])||t[n];this.setActiveRow(i),this.focus();var a=this.getDomRow(i);Terrasoft.scrollIntoView(a.dom,!1)}return!(r+e>n||0===e)||!this.fireEvent("loadMore")}},goToPreviousRow:function(e){if(this.activeRow){var t=this._getRowsId(),r=t.indexOf(this.activeRow);if(r>0){var n=t[0],i=e?t[r-e]:n;return i=i||n,this.setActiveRow(i),this.focus(),this._scrollToRow(i),!0}}},_scrollToRow:function(e){for(var t=this.getDomRow(e);window.scrollY>0&&!this._isElementVisible(t.dom);)window.scrollBy(0,-1)},_isElementVisible:function(e){var t=e.getBoundingClientRect();if(t.top<0)return!1;var r=document.elementFromPoint(t.left+5,t.top+5);do{if(!r||r===e)return!0;r=r.parentNode}while(r);return!1},_canHandleEvent:function(e){return this.getWrapEl().id===e.target.id},_observeNeedLoadData:function(){var e,t,r=this;this._needLoadDataObserver&&(this._needLoadDataObserver.disconnect(),this._needLoadDataObserver=null);var n=null===(e=this.getWrapEl())||void 0===e||null===(t=e.dom)||void 0===t?void 0:t.querySelector(".grid-bottom-spinner-space");null!==n&&(this._needLoadDataObserver=new IntersectionObserver((function(e){var t=null==e?void 0:e.some((function(e){return e.isIntersecting})),n=r.rows.length>0;t&&n&&r.checkNeedLoadData()})),this._needLoadDataObserver.observe(n))},focus:function(){this.rendered&&this.getWrapEl().dom.focus({preventScroll:!0})}}),Ext.define("Terrasoft.controls.AudioGrid",{extend:"Terrasoft.Grid",alternateClassName:"Terrasoft.AudioGrid",init:function(){this.callParent(arguments),this.addEvents("audioClick")},onGridClick:function(e,t){if(this.enabled){var r=Ext.get(t),n=this.getWrapEl().dom,i=this.getRowId(t),a=r.findParent("audio",n,!0);a&&i?this.fireEvent("audioClick",i):this.callParent(arguments)}else e.stopEvent()}}),Ext.define("Terrasoft.controls.mixins.GridCellFormatter",{alternateClassName:"Terrasoft.GridCellFormatter",_spanCellXTemplate:null,dimensionsPattern:new RegExp("\\d+x\\d+","i"),_getColumnType:function(e){return e.type||"text"},_getCellImage:function(e,t,r){var n=Terrasoft.includes(t,"icon")&&e.hasOwnProperty(r);return e.hasOwnProperty("keyImgExtension")&&e.keyImgExtension.hasOwnProperty(r)&&"label"!==t?e.keyImgExtension[r]:n?e[r]:Terrasoft.emptyString},_getLinkData:function(e,t){return t&&e.hasOwnProperty(t)?e[t]:null},_getCellHint:function(e,t,r){return e?Terrasoft.emptyString:t.cellsHintConfig&&t.cellsHintConfig[r]},_getSpanCellXTemplate:function(){return this._spanCellXTemplate=this._spanCellXTemplate||new Ext.XTemplate(this._spanCellTemplate),this._spanCellXTemplate},formatCellContent:function(e,t,r,n,i){var a=this.getDataKey(r.name,i.columnBindings),s=this._getColumnType(r),o=t[a],l=this._getCellImage(t,s,a),c=this._getLinkData(t,n),u=this._getCellHint(c,t,a),h=Ext.Array.contains(this.internalColumns,s);if(!o&&!l&&!h)return 0;var f={name:a,cellData:o,cellImage:l,cellHint:u,linkData:c,cell:e,type:s,renderOptions:i,column:r};return a===this.primaryDisplayColumnName&&(e.cls+=" grid-primary-column"),!Terrasoft.includes(s,"icon")&&l&&this.appendIconHtml(f),this.appendCellHtml(f,s,l)},getDataKey:function(e,t){if(Ext.isObject(e)&&e.bindTo){var r=t[e.bindTo];if(r)return r.modelItem}return e},formatCellLink:function(e,t,r){var n='<a href="{0}" target="{1}" title="{2}" data-column="{3}">{4}</a>';if(e.customUrlsExists){return e.customUrls.forEach((function(e,t){r=r.replace(this.encodeHtml(e),Ext.String.format("url_occurrence_{0}",t))}),this),e.customUrls.forEach((function(t,i){r=r.replace(Ext.String.format("url_occurrence_{0}",i),Ext.String.format(n,t,e.target,this.encodeHtml(t),"",t))}),this),r}return Ext.String.format(n,this.encodeHtml(e.url),e.target,this.encodeHtml(e.title),t,r)},formatCellImage:function(e,t){return Ext.String.format('<img src="{0}" class="{1}">',e,this.encodeHtml(t))},formatCellSpan:function(e,t,r){var n=this._getSpanCellXTemplate(),i=Terrasoft.removeHtmlTags(t),a=Terrasoft.removeHtmlTags(r),s=this.encodeHtml(i),o=null;Terrasoft.getIsRtlMode()&&(o=Terrasoft.containsRtlChars(t)?o:"ltr");var l={type:e,text:s,direction:o,title:this.encodeHtml(a)};return n.apply(l)},formatCellLabel:function(e){return Ext.String.format('<span class="grid-label">{0}</span>',this.encodeHtml(e))},encodeHtml:function(e){var t=Terrasoft.encodeHtml(e);return Ext.isString(t)&&(t=(t=(t=(t=(t=t.replace(/{/g,"&#123;")).replace(/}/g,"&#125;")).replace(/\\/g,"&#92;")).replace(/&amp;laquo;/g,"«")).replace(/&amp;raquo;/g,"»")),t},appendCellHtml:function(e,t,r){var n={text:this.appendTextCellHtml,label:this.appendLabelHtml,title:this.appendTitleHtml,link:this.appendLinkHtml,caption:this.appendCaptionHtml}[t];if(Ext.isFunction(n))return n.call(this,e),"caption"===t?0:1;if(!r)return 0;var i={"grid-icon":this.appendGridIconHtml,"flag-icon":this.appendFlagIconHtml,"listed-icon":this.appendListedIconHtml};for(var a in i){if(Terrasoft.includes(t,a))return i[a].call(this,e),1}return 0},appendTextCellHtml:function(e){var t=e.name,r=e.cell,n=e.cellData,i=e.cellHint,a=e.linkData,s=e.renderOptions,o=s.cellsClasses[t],l=this.type,c=e.type;o&&o.typeClass&&(c=o.typeClass,r["grid-cell-type"].push(o.typeClass)),"tiled"===l&&0===r.html.length&&(s.multiSelect||this.hierarchical)&&(r.style="padding-top: 5px;");var u=this.formatCellSpan(c,n,i),h=a?this.formatCellLink(a,this.encodeHtml(t),u):u;r.html+=h},appendCaptionHtml:function(e){var t=e.renderOptions,r=e.cell,n=e.name,i=this.type,a=t.multiSelect||this.hierarchical;"tiled"===i&&0===r.html.length&&a&&(r.style="padding-top: 6px;"),r.html+=this.formatCellLabel(n)},appendLabelHtml:function(e){var t=e.linkData,r=e.name,n=e.cell,i=this.formatCellLabel(r),a=t?this.formatCellLink(t,this.encodeHtml(r),i):i;n.html+=a},appendTitleHtml:function(e){var t=e.name,r=e.cellData,n=e.cellHint,i=e.linkData,a=e.cell,s=e.type,o=e.renderOptions.cellsClasses[t],l=s;o&&o.typeClass&&(l=o.typeClass,a["grid-cell-type"].push(o.typeClass));var c=this.formatCellSpan(l,r,n),u=i?this.formatCellLink(i,this.encodeHtml(t),c):c;a.html+=u,a.cls+=" grid-header"},appendLinkHtml:function(e){var t=e.cellData,r=e.cell,n=e.name,i=Ext.DomHelper.createHtml({tag:"a",target:t.target||"_blank",html:this.encodeHtml(t.caption),href:t.url,"data-column":this.encodeHtml(n)});r.html+=i},appendGridIconHtml:function(e){this.appendFlagIconHtml(e);var t=this.dimensionsPattern.exec(e.type)[0];e.cell.cls+=" icon-spacer-"+t},appendFlagIconHtml:function(e){var t=e.cellImage,r=e.linkData,n=this.formatCellImage(t,e.type),i=r?this.formatCellLink(r,this.encodeHtml(e.name),n):n;e.cell.html+=i},appendListedIconHtml:function(e){var t=e.linkData,r=this.formatCellImage(e.cellImage,e.type),n=t?this.formatCellLink(t,this.encodeHtml(e.name),r):r;e.cell.html+=n},appendIconHtml:function(e){var t=e.cell,r=e.linkData,n=e.column.lookupImageType||"grid-icon-fixed-32x32",i=this.dimensionsPattern.exec(n)[0];t.cls+=Ext.String.format(" icon-spacer-{0}",i);var a=this.formatCellImage(e.cellImage,n),s=r?this.formatCellLink(r,this.encodeHtml(e.name),a):a;t.html+=s}}),Ext.define("Terrasoft.controls.GridHtmlGenerator",{extend:"Terrasoft.core.BaseObject",alternateClassName:"Terrasoft.GridHtmlGenerator",mixins:["Terrasoft.GridCellFormatter"],gridId:null,rowsStyles:null,primaryColumnName:null,rowDataItemMarkerColumnName:null,primaryDisplayColumnName:null,collectionItemPrefix:null,type:null,listedConfig:null,tiledConfig:null,columnsConfig:null,captionsConfig:null,isEmptyRowVisible:!1,isVertical:null,colsCss:null,internalColumns:["caption","label"],hierarchical:null,theoreticallyActiveRowCss:null,listedRowsCss:null,selectedRowCss:null,activeRowCss:null,useRowActionsExternal:!1,rowActionsExternalPrefix:"-external-actions-item-",rowActionsExternalCss:"grid-row-actions-external",_spanCellTemplate:null,captionPrefix:"-caption-",className:null,captionsCss:"grid-captions",renderVerticalGridCells:function(e,t,r,n,i){return Terrasoft.each(e,(function(e){t+=this.renderRowCell(r,e,n,i)}),this),t},renderRowCell:function(e,t,r,n){return e.cell=t,r.cls.indexOf("grid-module")<0&&(r.cls+=" grid-module"),this.renderCell(r.children,e,n)},_isNotNeedAppendEmptyRow:function(e,t,r){var n=this.isVertical;if(!1===this.isEmptyRowVisible){if(!n&&t>e)return!0;if(n&&r>e)return!0}return!1},createCheckbox:function(e){return Ext.create("Terrasoft.CheckBoxEdit",e)},getDefaultCellHtmlConfig:function(e){var t=e.cell;return{tag:"div",cls:[this.colsCss+"-"+t.cols].join(" "),html:"",children:[],"grid-cell-type":[]}},renderCell:function(e,t,r){var n=0,i=t.cell,a=t.row,s=this.getDataKey(t.cell.link,r.columnBindings),o={},l=this.getDefaultCellHtmlConfig(t);i.minHeight&&(o["min-height"]=i.minHeight),i.maxHeight&&(o["max-height"]=i.maxHeight,o.overflow="hidden"),l.style=Ext.DomHelper.generateStyles(o);var c=i.key;if(Ext.isArray(c))for(var u=0,h=c.length;u<h;u+=1){var f=c[u];n+=this.formatCellContent(l,a,f,s,r)}return Ext.isObject(c)&&(n+=this.formatCellContent(l,a,c,s,r)),l["grid-cell-type"]=Ext.Array.intersect(l["grid-cell-type"]),l["grid-cell-type"].length>0?l["grid-cell-type"]=l["grid-cell-type"].join(" "):delete l["grid-cell-type"],n>0?(e.push(l),1):(l.html="",e.push(l),0)},getDefaultRowHtmlConfig:function(e){var t={},r=this.rowDataItemMarkerColumnName||this.primaryDisplayColumnName;if(r){var n=e[r];Ext.isEmpty(n)||Ext.apply(t,{"data-item-marker":this.encodeHtml(n)})}return t},renderColumns:function(e,t,r){for(var n=this.getColumnsConfig(),i=0,a=n.length;i<a;i++){t.columnIndex=i;var s=n[i];Ext.isArray(s)&&(t.column=s,this.renderRow(e,t,r)),Ext.isObject(s)&&(t.cell=s,this.renderCell(e,t,r))}},getColumnsConfig:function(){var e=this[this.type+"Config"];return e?e.columnsConfig:this.columnsConfig},getCaptionsConfig:function(){var e=this[this.type+"Config"];return e?e.captionsConfig:this.captionsConfig},renderRow:function(e,t,r){for(var n=0,i={tag:"div",cls:"grid-row",children:[]},a=0,s=t.column.length,o=0;o<s;o++){var l=t.column[o],c=Terrasoft.deepClone(t);Ext.isArray(l)&&(this.isVertical?(a=l.length,n=this.renderVerticalGridCells(l,n,c,i,r)):(c.column=l,this.renderRow(i.children,c,r),n+=1)),Ext.isObject(l)&&(n+=this.renderRowCell(c,l,i,r))}this._isNotNeedAppendEmptyRow(n,s,a)||n>0&&e.push(i)},generateDefaultContentWrapConfig:function(){return{tag:"div",cls:"grid-scroll",children:[{tag:"div",cls:"grid-content",children:[]}]}},generateWrapHtmlConfig:function(e){return{tag:"div",id:Ext.String.format("grid-{0}-wrap",this.gridId),cls:e.join(" "),children:[]}},generateContentWrapConfig:function(e){return this.generateDefaultContentWrapConfig(e)},getGridContentConfig:function(e){return e.children[0]},getHorizontalScrollEl:function(e){return e.getWrapEl()},getVerticalScrollEl:function(e){return e.getWrapEl()},appendGridContent:Terrasoft.abstractFn,renderGrid:Terrasoft.abstractFn,initDomEvents:Terrasoft.emptyFn}),Ext.define("Terrasoft.controls.ListedGridHtmlGenerator",{extend:"Terrasoft.GridHtmlGenerator",alternateClassName:"Terrasoft.ListedGridHtmlGenerator",listedRowsCss:"grid-listed-row",getDefaultCaptionCellHtmlConfig:function(e,t,r){return{tag:"div",cls:[this.colsCss+"-"+e.cols].join(" "),html:"<label>"+e.name+"</label>"+t,id:this.gridId+this.captionPrefix+r,"data-item-marker":e.name}},renderCaptionsRow:function(e){var t=this.getCaptionsConfig(),r=this.getColumnsConfig(),n=Terrasoft.core.enums.OrderDirection.ASC,i=Terrasoft.core.enums.OrderDirection.DESC,a={tag:"div",cls:this.captionsCss,children:[]};return Terrasoft.each(t,(function(t,s){var o="";(e.sortColumnIndex===s||t.sortColumnDirection)&&(e.sortColumnDirection===n&&(o=e.sortIndicatorUp),e.sortColumnDirection===i&&(o=e.sortIndicatorDown));var l=this.getDefaultCaptionCellHtmlConfig(t,o,s,e),c=r[s];this.appendCaptionRow(c,l,e,a)}),this),a},appendCaptionRow:function(e,t,r,n){if(e){var i,a=e.key;Ext.isArray(a)&&(i=this.getDataKey(a[0].name,r.columnBindings)),Ext.isObject(a)&&(i=this.getDataKey(a.name,r.columnBindings));var s=r.cellsClasses[i];s&&s.typeClass&&(t["grid-caption-type"]=s.typeClass)}n.children.push(t)},renderContent:function(e,t,r){for(var n=t.rows||r.rows,i=0,a=n.length;i<a;i+=1){var s=n[i];t.row=s;var o=(s[this.primaryColumnName]||i).toString(),l=this.rowsStyles[o],c=this.getDefaultRowHtmlConfig(s);Ext.apply(c,{tag:"div",cls:this.listedRowsCss+" "+this.theoreticallyActiveRowCss,style:Ext.DomHelper.generateStyles(l),id:this.gridId+this.collectionItemPrefix+o,children:[]}),this.renderColumns(c.children,t,r),r.multiSelect?this.appendCheckboxes(c,o,r):r.activeRow===o&&(c.cls+=" "+this.activeRowCss),e.push(c)}},appendCheckboxes:function(e,t,r){e.children.unshift({tag:"div",cls:"grid-fixed-col",html:""});var n=e.children[0],i=this.createCheckbox({classes:{wrapClass:["grid-listed-row-control"]},value:t});Terrasoft.contains(r.selectedRows,t)&&(e.cls+=" "+this.selectedRowCss,i.setChecked(!0)),n.html=i.generateHtml()+e.children[0].html,r.checkboxes.push(i)},appendGridContent:function(e,t,r){e.push(this.renderCaptionsRow(r)),this.renderContent(e,t,r)},renderGrid:function(e,t,r){this.appendGridContent(e,t,r)}}),Ext.define("Terrasoft.controls.TiledGridHtmlGenerator",{extend:"Terrasoft.GridHtmlGenerator",alternateClassName:"Terrasoft.TiledGridHtmlGenerator",appendCheckboxes:function(e,t,r){var n=this.createCheckbox({value:r});Terrasoft.contains(e.selectedRows,r)&&(t.cls+=" "+this.selectedRowCss,n.setChecked(!0)),t.children.push({tag:"div",cls:"grid-fixed-col",html:n.generateHtml()}),e.checkboxes.push(n)},appendGridContent:function(e,t,r){for(var n=t.rows||r.rows,i=0,a=n.length;i<a;i+=1){var s=n[i];t.row=s;var o=(s[this.primaryColumnName]||i).toString(),l=this.rowsStyles[o],c=this.getDefaultRowHtmlConfig(s);Ext.apply(c,{tag:"div",cls:"grid-row grid-pad "+this.theoreticallyActiveRowCss,style:Ext.DomHelper.generateStyles(l),id:this.gridId+this.collectionItemPrefix+o,children:[]}),r.multiSelect?this.appendCheckboxes(r,c,o):r.activeRow===o&&(c.cls+=" "+this.activeRowCss),this.renderColumns(c.children,t,r),this.useRowActionsExternal&&c.children.push({tag:"div",id:this.gridId+this.rowActionsExternalPrefix+o,cls:this.rowActionsExternalCss,children:[{tag:"div",cls:this.colsCss+"-24"}]}),e.push(c)}},renderGrid:function(e,t,r){this.appendGridContent(e,t,r)}}),Ext.define("Terrasoft.controls.BaseViewGrid",{alternateClassName:"Terrasoft.BaseViewGrid",extend:"Terrasoft.Grid",_type:null,_defaultType:"listed",_gridHtmlGenerator:null,_horizontalScrollValue:null,gridCellViewType:Terrasoft.GridCellViewType.ONELINE,_progressSpinnerHeight:35,visibleColumns:24,listedGridHtmlGeneratorClassName:"Terrasoft.ListedGridHtmlGenerator",tiledGridHtmlGeneratorClassName:"Terrasoft.TiledGridHtmlGenerator",loadMoreBtnTpl:new Ext.XTemplate('<div class="load-more-grid-btn-wrap" style="display:<tpl if="loadMoreBtnVisible">block<tpl else>none</tpl>;">','<span class="{loadMoreBtnCssClass}"',' data-item-marker="load-more-grid-btn">{loadMoreBtnCaption}</span></div>'),loadMoreBtnVisible:!1,loadMoreBtnCaption:"",loadMoreBtnCssClass:"load-more-grid-btn",_setSortingByCaptions:function(){for(var e=this.getCaptionsConfig(),t=0,r=e.length;t<r;t+=1){var n=e[t];(this.sortColumnIndex===t||n.sortColumnDirection)&&this.captionsConfig[t].sortColumnDirection&&(this.sortColumnIndex=t,this.sortColumnDirection=n.sortColumnDirection,delete this.captionsConfig[t].sortColumnDirection)}},_getGridHtmlGeneratorClassName:function(){return this.type?this.type===Terrasoft.GridType.TILED?this.tiledGridHtmlGeneratorClassName:this.listedGridHtmlGeneratorClassName:null},_destroyHtmlGenerator:function(){this._gridHtmlGenerator.destroy(),this._gridHtmlGenerator=null},_getGridHtmlGeneratorConfig:function(e){var t={};return t.gridId=this.id,t.columnsConfig=e.columnsConfig||this.columnsConfig,t.captionsConfig=e.captionsConfig||this.captionsConfig,t.internalColumns=this.internalColumns||[],t.theoreticallyActiveRowCss=this.theoreticallyActiveRowCss,t.rowActionsExternalCss=this.rowActionsExternalCss,t.colsCss=this.colsCss,t.collectionItemPrefix=this.collectionItemPrefix,t._spanCellTemplate=this._spanCellTemplate,t.primaryColumnName=e.primaryColumnName||this.primaryColumnName,t.selectedRowCss=this.selectedRowCss,t.activeRowCss=this.activeRowCss,t.useRowActionsExternal=e.useRowActionsExternal,t.rowsStyles=e.rowsStyles||this.rowsStyles,t.rowDataItemMarkerColumnName=this.rowDataItemMarkerColumnName,t.primaryDisplayColumnName=e.primaryDisplayColumnName||this.primaryDisplayColumnName,t.type=e.type||this.type,t.listedConfig=e.listedConfig||this.listedConfig,t.tiledConfig=e.tiledConfig||this.tiledConfig,t.isEmptyRowVisible=e.isEmptyRowVisible,t.isVertical=e.isVertical,t.hierarchical=e.hierarchical,t.rowActionsExternalPrefix=this.rowActionsExternalPrefix,t.captionPrefix=this.captionPrefix,t},_setGridHtmlGenerator:function(e){var t=this._gridHtmlGenerator,r=this._getGridHtmlGeneratorClassName(),n=Boolean(t),i=n&&(t.alternateClassName||t.$className);if(t&&i!==r&&this._destroyHtmlGenerator(),!n){var a=this._getGridHtmlGeneratorConfig(e);r&&(this._gridHtmlGenerator=Ext.create(r,a))}},_getContentWrapConfig:function(){return{tag:"div",cls:"grid-scroll",children:[{tag:"div",id:Ext.String.format("grid-{0}-content",this.id),cls:"grid-content",children:[]}]}},_applyGridCellViewTypeAttr:function(e){var t=this.getWrapEl();t&&t.set({"cell-view-type":e})},_applyEmptyGridHtmlConfig:function(e){var t=this.loadEmptyMessageConfig();Ext.Object.isEmpty(t)&&e.children.push(this.isEmptyHtmlConfig),e.cls+=Ext.String.format(" {0}",this.isEmptyCss),e.children.push(this.bottomSpinnerSpaceTpl.apply(this))},_renderHierarchicalGrid:function(e,t){var r=this.type;switch(r){case"listed":this.renderListedHierarchicalGrid(e,t);break;case"tiled":this.renderTiledHierarchicalGrid(e,t);break;default:this.log(Ext.String.format("Rendering grid. Hierarchical grid type: {0} not supported.",r),Terrasoft.LogMessageType.WARNING)}},_gerRenderOptions:function(){return{rows:this.rows,columnBindings:this.columnBindings,checkboxes:this.checkboxes,multiSelect:this.multiSelect,selectedRows:this.selectedRows,activeRow:this.activeRow,cellsClasses:this.cellsClasses,sortColumnIndex:this.sortColumnIndex,sortColumnDirection:this.sortColumnDirection,sortIndicatorUp:this.sortIndicatorUp,sortIndicatorDown:this.sortIndicatorDown,visibleColumns:this.visibleColumns}},setIsLoading:function(){if(this.callParent(arguments),this._setGridHtmlGenerator(this),this.isLoading&&this._gridHtmlGenerator){var e=this._gridHtmlGenerator.getVerticalScrollEl(this);if(e){var t=e.getScrollTop();e.setScrollTop(t+this._progressSpinnerHeight)}}},init:function(){this.callParent(arguments),this.addEvents("loadMoreBtnClick"),this.selectors.loadMoreEl=Ext.String.format(".{0}",this.loadMoreBtnCssClass),this.selectors.loadMoreWrapEl=Ext.String.format(".{0}-wrap",this.loadMoreBtnCssClass)},generateHtmlTpl:function(e,t){if(this._setGridHtmlGenerator(this),!this._gridHtmlGenerator)return null;var r=this._gridHtmlGenerator.generateWrapHtmlConfig(e);return this.isEmpty?this._applyEmptyGridHtmlConfig(r):this.applyGridHtmlConfig(t,r),r},applyGridHtmlConfig:function(e,t){"listed"===e&&(this.hierarchical?t.children.push(this.renderCaptionsRow()):this._setSortingByCaptions()),this.appendRootContent(t)},appendRootContent:function(e){this.hierarchical?this.appendHierarchicalRootContent(e):this.appendDefaultRootContent(e)},appendHierarchicalRootContent:function(e){this.appendGridContent(e.children,{}),e.children.push(this.bottomSpinnerSpaceTpl.apply())},appendDefaultRootContent:function(e){var t=this.generateContentWrapConfig(),r=this.getGridContentConfig(t);this.appendGridContent(r.children,{}),r.children.push(this.bottomSpinnerSpaceTpl.apply(this)),r.children.push(this.loadMoreBtnTpl.apply(this)),e.children.push(t)},getGridContentConfig:function(e){return this._setGridHtmlGenerator(this),this._gridHtmlGenerator?this._gridHtmlGenerator.getGridContentConfig(e):null},initDomEvents:function(){this.callParent(arguments),this.loadMoreEl&&this.loadMoreEl.on("click",this.onLoadMoreBtnClick,this),this._setGridHtmlGenerator(this),this._gridHtmlGenerator&&this._gridHtmlGenerator.initDomEvents()},onLoadMoreBtnClick:function(e){this.fireEvent("loadMoreBtnClick",e)},setWatchRowInViewport:function(e){this.watchRowInViewport=Ext.isNumber(e)?e:0,this.watchRowInViewport&&this.checkNeedLoadData()},setLoadMoreBtnVisible:function(e){this.loadMoreBtnVisible=Boolean(e),this.loadMoreWrapEl&&this.loadMoreWrapEl.setStyle({display:this.loadMoreBtnVisible?"block":"none"})},setLoadMoreBtnCaption:function(e){this.loadMoreBtnCaption!==e&&(this.loadMoreBtnCaption=e||"",this.loadMoreEl&&this.loadMoreEl.setHTML(this.loadMoreBtnCaption))},renderGrid:function(e,t){this.appendGridContent(e,t)},appendGridContent:function(e,t){if(this.hierarchical)this._renderHierarchicalGrid(e,t);else if(this._setGridHtmlGenerator(this),this._gridHtmlGenerator){var r=this._gerRenderOptions();this._gridHtmlGenerator.appendGridContent(e,t,r)}},generateContentWrapConfig:function(){if(this._setGridHtmlGenerator(this),!this._gridHtmlGenerator)return null;var e=this._gerRenderOptions();return this._gridHtmlGenerator.generateContentWrapConfig(e)},onDestroy:function(){var e=this._gridHtmlGenerator;e&&this._destroyHtmlGenerator(),this.callParent(arguments),this.loadMoreEl&&this.loadMoreEl.un("click",this.onLoadMoreBtnClick,this)},horizontalScrollTo:function(e){if(this._setGridHtmlGenerator(this),this._gridHtmlGenerator){var t=this._gridHtmlGenerator.getHorizontalScrollEl(this);t&&t.scrollTo("left",e)}},setHorizontalScrollValue:function(e){this._horizontalScrollValue=e,this.horizontalScrollTo(e)},setGridCellViewType:function(e){e&&e!==this.gridCellViewType&&(this.gridCellViewType=e,this._applyGridCellViewTypeAttr(e))},onAfterReRender:function(){this.callParent(arguments);var e=parseInt(this._horizontalScrollValue,10);isNaN(e)||this.horizontalScrollTo(e),this._applyGridCellViewTypeAttr(this.gridCellViewType)},onAfterRender:function(){this.callParent(arguments),this._applyGridCellViewTypeAttr(this.gridCellViewType)},getBindConfig:function(){var e=this.callParent(arguments),t={horizontalScrollValue:{changeMethod:"setHorizontalScrollValue"},gridCellViewType:{changeMethod:"setGridCellViewType"},loadMoreBtnVisible:{changeMethod:"setLoadMoreBtnVisible"},loadMoreBtnCaption:{changeMethod:"setLoadMoreBtnCaption"},watchRowInViewport:{changeMethod:"setWatchRowInViewport"}};return Ext.apply(t,e),t},getRow:function(e){var t=this.callParent(arguments);return e&&Ext.isFunction(e.getRowCellsHintConfig)&&(t.cellsHintConfig=e.getRowCellsHintConfig()),t},getDefineProperties:function(){return{type:{get:function(){return this._type||this._defaultType},set:function(e){this._type=e}}}},constructor:function(){Object.defineProperties(this,this.getDefineProperties()),this.callParent(arguments)}}),Ext.define("Terrasoft.controls.GridLayoutEditItem",{extend:"Terrasoft.controls.DraggableContainer",alternateClassName:"Terrasoft.GridLayoutEditItem",gridLayoutEditId:null,tplConfig:{classes:{wrapClasses:["grid-layout-edit-item-wrap"],elClasses:["grid-layout-edit-item-el"],contentWrapClasses:["grid-layout-edit-item-content-wrap"],textWrapClasses:["grid-layout-edit-item-content-text-wrap"],imageWrapClasses:["grid-layout-edit-item-content-image-wrap"],imageClasses:["grid-layout-edit-item-content-image"],actionsWrapClasses:["grid-layout-edit-item-actions-wrap"]},selectorSuffixes:{wrap:"grid-layout-edit-item-wrap",gridCell:"grid-layout-edit-cell",gridTable:"grid-layout-edit-table"},styles:{width:"0px",height:"0px",top:"0px"}},tpl:['<div id="{id}-grid-layout-edit-item-wrap" class="{wrapClasses}" data-selected-item="{selected}" data-group-name="{groupName}"','style="{wrapStyles}">','<div id="{id}-grid-layout-edit-item-el" class="{elClasses}">','<div id="{id}-grid-layout-edit-item-content" class="{contentWrapClasses}">','<tpl if="hasImage">','<div class="{imageWrapClasses}">','<img class="{imageClasses}" src="{imageUrl}"/>',"</div>","</tpl>",'<tpl if="showContent">','<div class="{textWrapClasses}">',"{content}","</div>","</tpl>","</div>",'<tpl if="hasActions">','<div id="{id}-grid-layout-edit-item-actions" class="{actionsWrapClasses}">',"{%this.renderItems(out, values)%}","</div>","</tpl>","</div>","</div>"],cellBorderLineSize:1,itemId:null,column:null,colSpan:null,row:null,rowSpan:null,content:null,markerValue:null,selected:null,oldPosition:null,imageConfig:null,dragActionsCode:511,groupName:null,_cellsSort:function(e){e.sort((function(e,t){var r=Ext.get(e.id),n=Ext.get(t.id),i=parseInt(r.getAttribute("data-row-index"),10),a=parseInt(n.getAttribute("data-row-index"),10);return i===a?parseInt(r.getAttribute("data-column-index"),10)>parseInt(n.getAttribute("data-column-index"),10)?1:-1:i>a?1:-1}))},onActionItemClick:function(e,t){this.getGridLayoutEditInstance().fireEvent("itemActionClick",e,t)},generateActionItemId:function(){return this.id+"-action-item-"+Terrasoft.generateGUID()},addItemActionsHandlers:function(){var e=this;function t(){e.onActionItemClick(this.tag,e.itemId)}Terrasoft.each(this.items,(function(e){if(e.id=this.generateActionItemId(),e.hasOwnProperty("menu")&&e.menu.hasOwnProperty("items")){var r=e.menu.items;Terrasoft.each(r,(function(e){e.id=this.generateActionItemId(),e.hasOwnProperty("handler")||(e.onClick=t)}),this)}else e.onClick=t}),this)},applyTplConfigProperties:function(e,t){Terrasoft.each(this.tplConfig[t],(function(t,r){e[r]=t}),this)},applyTplClasses:function(e){this.applyTplConfigProperties(e,"classes")},applyTplStyles:function(e){this.applyTplConfigProperties(e,"styles")},getTplData:function(){this.selectors.wrapEl=Ext.String.format("#{0}-{1}",this.id,this.tplConfig.selectorSuffixes.wrap);var e=this.callParent(arguments);this.applyTplClasses(e),this.applyTplStyles(e);var t=this.getItemBox();return e.wrapStyles=Ext.apply(this.tplConfig.styles,t),e.selected=this.selected,e.hasActions=this.items&&this.items.getCount(),e.hasImage=!!this.imageConfig,e.showContent=!0,this.imageConfig&&(e.imageUrl=Terrasoft.ImageUrlBuilder.getUrl(this.imageConfig)),e.content=Terrasoft.encodeHtml(this.content),e.groupName=this.groupName||"",e},getBindConfig:function(){var e=this.callParent(arguments),t={itemId:{changeMethod:"onItemIdChange"},content:{changeMethod:"onContentChange"},column:{changeMethod:"onAfterColumnChange",changeEvent:"afterColumnChange"},colSpan:{changeMethod:"onAfterColSpanChange",changeEvent:"afterColSpanChange"},row:{changeMethod:"onAfterRowChange",changeEvent:"afterRowChange"},rowSpan:{changeMethod:"onAfterRowSpanChange",changeEvent:"afterRowSpanChange"},dragActionsCode:{changeMethod:"setDragActionsCode"},imageConfig:{changeMethod:"setImageConfig"},groupName:{changeMethod:"setGroupName"}};return Ext.apply(t,e),t},onItemIdChange:function(e){this.itemId=e},onContentChange:function(e){this.content=e,this.show()},onBeforeRowChange:function(e){this.oldPosition.row=e},onBeforeRowSpanChange:function(e){this.oldPosition.rowSpan=e},onBeforeColumnChange:function(e){this.oldPosition.column=e},onBeforeColSpanChange:function(e){this.oldPosition.colSpan=e},revertPositionChanges:function(){Ext.apply(this,this.oldPosition),this.fireEvent("afterRowChange",this.row),this.fireEvent("afterRowSpanChange",this.rowSpan),this.fireEvent("afterColumnChange",this.column),this.fireEvent("afterColSpanChange",this.colSpan)},onAfterColumnChange:function(e){this.setColumn(e)},onAfterColSpanChange:function(e){this.setColSpan(e)},onAfterRowChange:function(e){this.setRow(e)},onAfterRowSpanChange:function(e){this.setRowSpan(e)},setImageConfig:function(e){this.imageConfig=e,this.show()},setDragActionsCode:function(e){this.dragActionsCode!==e&&(this.dragActionsCode=e,this.show())},getCell:function(e,t){var r=Ext.String.format("{0}-{1}-{2}-{3}",this.gridLayoutEditId,this.tplConfig.selectorSuffixes.gridCell,e,t);return Ext.get(r)},getGridLayoutEditTableEl:function(){return Ext.get(this.gridLayoutEditId+"-"+this.tplConfig.selectorSuffixes.gridTable)},onAfterRender:function(){this.callParent(arguments),this.applyPositionChange()},onAfterReRender:function(){this.callParent(arguments),this.applyPositionChange()},onDestroy:function(){var e=this.getWrapEl();this.rendered&&(e.un("mousedown",this.onItemClick,this),e.un("dblclick",this.onItemDblClick,this)),this.un("beforeRowChange",this.onBeforeRowChange,this),this.un("beforeRowSpanChange",this.onBeforeRowSpanChange,this),this.un("beforeColumnChange",this.onBeforeColumnChange,this),this.un("beforeColSpanChange",this.onBeforeColSpanChange,this),this.callParent(arguments)},getDraggableConfig:function(){var e={};return e[Terrasoft.DragAction.MOVE]={handlers:{b4StartDrag:"b4StartDrag",onDragDrop:"onMoveDragDrop",onDragOver:"onMoveDragOver",onInvalidDrop:"show"}},e[Terrasoft.DragAction.RESIZE_TOP]={handlers:{b4StartDrag:"b4StartDrag",onDragDrop:"onResizeTopDragDrop",onDragOver:"onResizeTopDragOver",onInvalidDrop:"show"}},e[Terrasoft.DragAction.RESIZE_TOP_RIGHT]={handlers:{b4StartDrag:"b4StartDrag",onDragDrop:"onResizeTopRightDragDrop",onDragOver:"onResizeTopRightDragOver",onInvalidDrop:"show"}},e[Terrasoft.DragAction.RESIZE_RIGHT]={handlers:{b4StartDrag:"b4StartDrag",onDragDrop:"onResizeRightDragDrop",onDragOver:"onResizeRightDragOver",onInvalidDrop:"show"}},e[Terrasoft.DragAction.RESIZE_BOTTOM_RIGHT]={handlers:{b4StartDrag:"b4StartDrag",onDragDrop:"onResizeBottomRightDragDrop",onDragOver:"onResizeBottomRightDragOver",onInvalidDrop:"show"}},e[Terrasoft.DragAction.RESIZE_BOTTOM]={handlers:{b4StartDrag:"b4StartDrag",onDragDrop:"onResizeBottomDragDrop",onDragOver:"onResizeBottomDragOver",onInvalidDrop:"show"}},e[Terrasoft.DragAction.RESIZE_BOTTOM_LEFT]={handlers:{b4StartDrag:"b4StartDrag",onDragDrop:"onResizeBottomLeftDragDrop",onDragOver:"onResizeBottomLeftDragOver",onInvalidDrop:"show"}},e[Terrasoft.DragAction.RESIZE_LEFT]={handlers:{b4StartDrag:"b4StartDrag",onDragDrop:"onResizeLeftDragDrop",onDragOver:"onResizeLeftDragOver",onInvalidDrop:"show"}},e[Terrasoft.DragAction.RESIZE_TOP_LEFT]={handlers:{b4StartDrag:"b4StartDrag",onDragDrop:"onResizeTopLeftDragDrop",onDragOver:"onResizeTopLeftDragOver",onInvalidDrop:"show"}},e},getIntersectionPositionByEvent:function(e){var t={column:0,row:0},r=document.elementFromPoint(e.xy[0],e.xy[1]);return r&&(t.column=parseInt(r.getAttribute("data-column-index"),10),t.row=parseInt(r.getAttribute("data-row-index"),10)),t},getIntersectionPosition:function(e){this._cellsSort(e);var t=Ext.get(e[0].id);return{row:parseInt(t.getAttribute("data-row-index"),10),column:parseInt(t.getAttribute("data-column-index"),10)}},b4StartDrag:function(){var e=Ext.dd.DragDropManager.dragCurrent;e.resetConstraints(!0),e.clearConstraints(),this.setDraggableConstraints(e),this.getGridLayoutEditInstance().setSelection({row:this.row,rowSpan:this.rowSpan,column:this.column,colSpan:this.colSpan}),this.wrapEl.setVisible(!1)},setDraggableConstraints:function(e){e.constrainTo(this.getGridLayoutEditTableEl())},updatePosition:function(e){var t=e.row,r=e.column;this.fireEvent("beforeRowChange",this.row,this),this.row=t,this.fireEvent("afterRowChange",this.row,this),this.fireEvent("beforeColumnChange",this.column,this),this.column=r,this.fireEvent("afterColumnChange",this.column,this),this.actualizeGridSize()},onMoveDragDrop:function(e,t){this.getGridLayoutEditInstance().setSelection();var r=this.getIntersectionPosition(t);this.updatePosition(r)},onMoveDragOver:function(e,t){var r={rowSpan:this.rowSpan,colSpan:this.colSpan},n=this.getIntersectionPosition(t);r.column=n.column,r.row=n.row,this.showDropHint(r)},onResizeTopDragDrop:function(e,t){this.getGridLayoutEditInstance().setSelection();var r=this.getIntersectionPosition(t);this.updateHeight(r.row)},onResizeTopDragOver:function(e,t){var r=this.getIntersectionPosition(t),n={column:this.column,row:r.row,rowSpan:this.row-r.row+this.rowSpan,colSpan:this.colSpan};this.showDropHint(n)},onResizeTopRightDragDrop:function(e,t){this.getGridLayoutEditInstance().setSelection();var r=this.getIntersectionPosition(t);this.updateWidth(r.column,!0,!0),this.updateHeight(r.row)},onResizeTopRightDragOver:function(e,t){var r=this.getIntersectionPosition(t),n={column:this.column,row:r.row,rowSpan:this.row-r.row+this.rowSpan,colSpan:r.column-this.column+1};this.showDropHint(n)},onResizeRightDragDrop:function(e,t){this.getGridLayoutEditInstance().setSelection();var r=this.getIntersectionPosition(t);this.updateWidth(r.column,!0)},onResizeRightDragOver:function(e,t){var r=this.getIntersectionPosition(t),n={column:this.column,row:this.row,rowSpan:this.rowSpan,colSpan:r.column-this.column+1};this.showDropHint(n)},onResizeBottomRightDragDrop:function(e,t){this.getGridLayoutEditInstance().setSelection();var r=this.getIntersectionPosition(t);this.updateHeight(r.row,!0,!0),this.updateWidth(r.column,!0)},onResizeBottomRightDragOver:function(e,t){var r=this.getIntersectionPosition(t),n={column:this.column,row:this.row,rowSpan:r.row-this.row+1,colSpan:r.column-this.column+1};this.showDropHint(n)},onResizeBottomDragDrop:function(e,t){this.getGridLayoutEditInstance().setSelection();var r=this.getIntersectionPosition(t);this.updateHeight(r.row,!0)},onResizeBottomDragOver:function(e,t){var r=this.getIntersectionPosition(t),n={column:this.column,row:this.row,rowSpan:r.row-this.row+1,colSpan:this.colSpan};this.showDropHint(n)},onResizeBottomLeftDragDrop:function(e,t){this.getGridLayoutEditInstance().setSelection();var r=this.getIntersectionPosition(t);this.updateHeight(r.row,!0,!0),this.updateWidth(r.column)},onResizeBottomLeftDragOver:function(e,t){var r=this.getIntersectionPosition(t),n={column:r.column,row:this.row,rowSpan:r.row-this.row+1,colSpan:this.column-r.column+this.colSpan};this.showDropHint(n)},onResizeLeftDragDrop:function(e,t){this.getGridLayoutEditInstance().setSelection();var r=this.getIntersectionPosition(t);this.updateWidth(r.column)},onResizeLeftDragOver:function(e,t){var r=this.getIntersectionPosition(t),n={column:r.column,row:this.row,rowSpan:this.rowSpan,colSpan:this.column-r.column+this.colSpan};this.showDropHint(n)},onResizeTopLeftDragDrop:function(e,t){this.getGridLayoutEditInstance().setSelection();var r=this.getIntersectionPosition(t);this.updateHeight(r.row,!1,!0),this.updateWidth(r.column)},onResizeTopLeftDragOver:function(e,t){var r=this.getIntersectionPosition(t),n={column:r.column,row:r.row,rowSpan:this.row-r.row+this.rowSpan,colSpan:this.column-r.column+this.colSpan};this.showDropHint(n)},showDropHint:function(e){var t=this.getGridLayoutEditInstance(),r=t.selection;r&&r.row===e.row&&r.rowSpan===e.rowSpan&&r.column===e.column&&r.colSpan===e.colSpan||(t.setSelection(),t.setSelection(e))},getGridLayoutEditInstance:function(){return Ext.getCmp(this.gridLayoutEditId)},actualizeGridSize:function(){this.getGridLayoutEditInstance().updateSize(this)},getGroupName:function(){return[this.getGridLayoutEditInstance().getGroupName()]},setSelected:function(e){this.selected=e,this.wrapEl.dom.setAttribute("data-selected-item",e)},onItemClick:function(e){e.stopEvent(),this.setSelected(!0);var t=this.getGridLayoutEditInstance();t.selectItem(this.itemId,e.ctrlKey),t.setSelection(),t.fireEvent("itemClick",this,this.itemId,this.gridLayoutEditId),e.stopPropagation()},onItemDblClick:function(e){e.stopEvent();var t=this.getGridLayoutEditInstance();t.setSelection(),t.fireEvent("itemDblClick",this,this.itemId,this.gridLayoutEditId)},setTplConfig:function(){var e=Terrasoft.getIsRtlMode()?"right":"left";this.tplConfig.styles[e]="0px"},calculateColSpan:function(e,t){var r=t?e-this.column+1:this.column-e+this.colSpan;return Math.max(1,r)},constructor:function(){this.setTplConfig(),this.callParent(arguments)},init:function(){this.addItemActionsHandlers(),this.callParent(arguments),this.selectors={wrapEl:""},this.oldPosition={row:0,column:0,rowSpan:0,colSpan:0},this.addEvents("beforeColumnChange","beforeColSpanChange","beforeRowChange","beforeRowSpanChange","afterColumnChange","afterColSpanChange","afterRowChange","afterRowSpanChange"),this.on("beforeRowChange",this.onBeforeRowChange,this),this.on("beforeRowSpanChange",this.onBeforeRowSpanChange,this),this.on("beforeColumnChange",this.onBeforeColumnChange,this),this.on("beforeColSpanChange",this.onBeforeColSpanChange,this)},initDomEvents:function(){var e=this.wrapEl;e.on("mousedown",this.onItemClick,this),e.on("dblclick",this.onItemDblClick,this)},getWidth:function(){var e=this.getGridLayoutEditInstance(),t=2*this.getMarginWidth();return this.colSpan*e.getCellWidth()-t+e.getCellWidthType()},getHeight:function(){var e=this.getCell(this.row,this.column),t=this.getCell(this.getBottomRow(),this.column),r=0;return e&&t&&(r=t.getBottom()-e.getTop()-this.cellBorderLineSize*(0===this.row?2:1)),r+"px"},getTop:function(){var e=this.getCell(this.row,this.column),t=this.getGridLayoutEditTableEl(),r=0;return e&&t&&(r=e.getTop()-t.getTop()+this.cellBorderLineSize*(0===this.row?1:0)),r+"px"},getLeft:function(){var e=this.getGridLayoutEditInstance(),t=this.getMarginWidth();return this.column*e.getCellWidth()+t+e.getCellWidthType()},getMarginWidth:function(){return 100/this.getGridLayoutEditInstance().tableEl.getWidth()},getItemBox:function(){var e={width:this.getWidth(),height:this.getHeight(),top:this.getTop()};return e[Terrasoft.getIsRtlMode()?"right":"left"]=this.getLeft(),e},getRow:function(){return this.row},getBottomRow:function(){return this.row+this.rowSpan-1},getRowSpan:function(){return this.rowSpan},getColumn:function(){return this.column},getRightColumn:function(){return this.column+this.colSpan-1},getColSpan:function(){return this.colSpan},show:function(){var e=this.renderTo;e&&e.isVisible()&&(this.visible=!0,this.rendered?this.reRender(null,this.renderTo):this.render(this.renderTo))},setRow:function(e,t){if(this.row!==e){var r=Ext.isEmpty(this.row)?e:this.row;this.fireEvent("beforeRowChange",r,this),this.row=e,this.fireEvent("afterRowChange",this.row,this),t||this.actualizeGridSize()}},setRowSpan:function(e,t){if(this.rowSpan!==e){var r=Ext.isEmpty(this.rowSpan)?e:this.rowSpan;this.fireEvent("beforeRowSpanChange",r,this),this.rowSpan=e,this.fireEvent("afterRowSpanChange",e,this),t||this.actualizeGridSize()}},updateHeight:function(e,t,r){var n=t?e-this.row+1:this.row-e+this.rowSpan;if(!t){var i=Ext.isEmpty(this.row)?e:this.row;this.fireEvent("beforeRowChange",i,this),this.row=e,this.fireEvent("afterRowChange",this.row,this)}n=n>=1?n:1;var a=Ext.isEmpty(this.rowSpan)?n:this.rowSpan;this.fireEvent("beforeRowSpanChange",a,this),this.rowSpan=n,this.fireEvent("afterRowSpanChange",this.rowSpan,this),r||this.actualizeGridSize()},setColumn:function(e,t){if(this.column!==e){var r=Ext.isEmpty(this.column)?e:this.column;this.fireEvent("beforeColumnChange",r,this),this.column=e,this.fireEvent("afterColumnChange",this.column,this),t||this.actualizeGridSize()}},setColSpan:function(e,t){if(this.colSpan!==e){var r=Ext.isEmpty(this.colSpan)?e:this.colSpan;this.fireEvent("beforeColSpanChange",r,this),this.colSpan=e,this.fireEvent("afterColSpanChange",e,this),t||this.actualizeGridSize()}},updateWidth:function(e,t,r){var n=this.calculateColSpan(e,t);if(!t){var i=Ext.isEmpty(this.column)?e:this.column;this.fireEvent("beforeColumnChange",i,this),this.column=e,this.fireEvent("afterColumnChange",this.column,this)}var a=Ext.isEmpty(this.colSpan)?n:this.colSpan;this.fireEvent("beforeColSpanChange",a,this),this.colSpan=n,this.fireEvent("afterColSpanChange",this.colSpan,this),r||this.actualizeGridSize()},applyPositionChange:function(){this.getGridLayoutEditInstance().fireEvent("itemPositionChanged",this.itemId,Ext.apply({},this.oldPosition)),this.oldPosition.row=this.row,this.oldPosition.column=this.column,this.oldPosition.rowSpan=this.rowSpan,this.oldPosition.colSpan=this.colSpan},setDomAttributes:function(e){if(e&&!Ext.isEmpty(e["data-selected-item"]))throw new Terrasoft.InvalidOperationException;this.callParent(arguments)},setGroupName:function(e){this.groupName!==e&&(this.groupName=e,this.safeRerender())}}),Ext.ns("Terrasoft.control.enums"),Terrasoft.GridLayoutEditSelectionType={FULL:0,VERTICAL:1,HORIZONTAL:2},Ext.define("Terrasoft.controls.GridLayoutEdit",{alternateClassName:"Terrasoft.GridLayoutEdit",extend:"Terrasoft.Component",mixins:{droppable:"Terrasoft.Droppable"},tplConfig:{classes:{gridLayoutEditWrap:["grid-layout-edit-wrap"],gridLayoutEditTable:["grid-layout-edit-table"],gridLayoutEditRow:["grid-layout-edit-row"],gridLayoutEditCell:["grid-layout-edit-cell"],selectionBorderClasses:{top:"grid-layout-edit-selection-border-top",bottom:"grid-layout-edit-selection-border-bottom",left:"grid-layout-edit-selection-border-left",right:"grid-layout-edit-selection-border-right"}},selectorSuffixes:{wrap:"grid-layout-edit-wrap",table:"grid-layout-edit-table",row:"grid-layout-edit-row",cell:"grid-layout-edit-cell"},styles:{},rowTpl:'<div id="{0}-grid-layout-edit-row-{1}" data-row-index="{1}" class="grid-layout-edit-row">{2}</div>',cellTpl:'<div id="{0}-grid-layout-edit-cell-{1}-{2}" data-row-index={1} data-column-index={2} data-selected={3} class="grid-layout-edit-cell" style="{4}"></div>'},tpl:['<div id="{id}-grid-layout-edit-wrap" class="{gridLayoutEditWrap}">','<div id="{id}-grid-layout-edit-table" class="{gridLayoutEditTable}">',"{%this.prepareTableTplData(out, values)%}","</div>","</div>"],itemBindingConfig:null,itemClassName:"Terrasoft.GridLayoutEditItem",gridLayoutEditItemsCollection:null,rows:null,minRows:1,maxRows:500,autoHeight:!1,columns:null,minColumns:1,maxColumns:24,autoWidth:!1,allowItemsIntersection:!0,changePositionForIntersectedItems:!1,items:null,itemConfig:null,selection:null,selectedItems:null,selectionType:Terrasoft.GridLayoutEditSelectionType.FULL,useManualSelection:!0,multipleSelection:!1,useSelectionBorder:!0,itemActions:null,cellWidth:5,cellHeight:5,fixedCellWidth:!1,dropZonePadding:0,checkBitmapIntersection:function(e,t){for(var r=0,n=e.length;r<n;r++)if((e[r]&t[r])>0)return!0;return!1},isItemIntersected:function(e){var t=this.getItemsBitmap([e]),r=this.getItemBitmap(e);return this.checkBitmapIntersection(t,r)},calculateBitMask:function(e,t,r){var n=r-e;return Math.pow(2,n)-1-(Math.pow(2,n-t)-1)},rowHasItem:function(e,t,r){return e>=t&&e<t+r},getItemBitmap:function(e){for(var t=[],r=this.columns||1,n=e.column,i=e.row,a=e.colSpan||1,s=i,o=i+(e.rowSpan||1);s<o;s++){var l=this.calculateBitMask(n,a,r);t[s]=l}return t},getItemsBitmap:function(e){var t=[],r=this.columns||1,n=this.rows||1,i=this.gridLayoutEditItemsCollection.getItems();return Terrasoft.each(i,(function(i){if(-1===e.indexOf(i))for(var a=i.oldPosition,s=0;s<n;s++){var o=0;t[s]||(t[s]=o),this.rowHasItem(s,a.row,a.rowSpan)&&(o=this.calculateBitMask(a.column,a.colSpan,r),t[s]=t[s]|o)}}),this),t},getMaxSelection:function(e){return e.column=this.getMaxColumnPosition(e.column,e.colSpan),e.row=this.getMaxRowPosition(e.row,e.rowSpan),e},getMaxColumnPosition:function(e,t){return this.getMaxItemPosition(e,t,this.columns)},getMaxRowPosition:function(e,t){return this.getMaxItemPosition(e,t,this.rows)},getMaxItemPosition:function(e,t,r){return e+t>r?r-t:e},applyTplConfigProperties:function(e,t){Terrasoft.each(this.tplConfig[t],(function(t,r){e[r]=t}),this)},applyTplClasses:function(e){this.applyTplConfigProperties(e,"classes")},applyTplStyles:function(e){this.applyTplConfigProperties(e,"styles")},prepareTableTplData:function(e,t){for(var r=t.self,n=r.getCellStyle(),i=0;i<r.rows;i++){for(var a=[],s=0;s<r.columns;s++){var o=Ext.String.format(Terrasoft.deepClone(r.tplConfig.cellTpl),r.id,i,s,0,n);a.push(o)}var l=Ext.String.format(Terrasoft.deepClone(r.tplConfig.rowTpl),r.id,i,a.join(""));e.push(l)}},validateProperty:function(e,t){if(!Ext.isNumber(e))throw new Terrasoft.UnsupportedTypeException({message:Ext.String.format(Terrasoft.Resources.Controls.GridLayoutEdit.PropertyIsNotANumber,t)});if(e<=0)throw new Terrasoft.UnsupportedTypeException({message:Ext.String.format(Terrasoft.Resources.Controls.GridLayoutEdit.PropertyIsLessThan,t,"0")})},getTplData:function(){this.selectors.wrapEl=Ext.String.format("#{0}-"+this.tplConfig.selectorSuffixes.wrap,this.id),this.selectors.tableEl=Ext.String.format("#{0}-"+this.tplConfig.selectorSuffixes.table,this.id);var e=this.callParent(arguments);return this.applyTplClasses(e),this.applyTplStyles(e),e.prepareTableTplData=this.prepareTableTplData,e},getBindConfig:function(){return Ext.apply(this.callParent(arguments),{items:{changeMethod:"onItemsLoad"},rows:{changeMethod:"setRows",changeEvent:"rowsChanged"},columns:{changeMethod:"setColumns",changeEvent:"columnsChanged"},selection:{changeMethod:"setSelection",changeEvent:"selectionChanged"},selectedItems:{changeEvent:"selectedItemsChange"},allowItemsIntersection:{changeMethod:"setAllowItemsIntersection"}})},onItemsLoad:function(e){e.eachKey((function(e,t,r){this.onItemAdd(t,r,e)}),this),this.rendered&&this.reRender()},onItemAdd:function(e,t,r){var n=Ext.apply(this.itemConfig||{},{gridLayoutEditId:this.id}),i=Ext.apply(n,this.itemBindingConfig);this.itemActions&&(i.items=Terrasoft.deepClone(this.itemActions));var a=Ext.create(this.itemClassName,i);this.gridLayoutEditItemsCollection.add(r,a),a.bind(e),this.allowItemsIntersection||(this.isItemIntersected(a)?e.parentCollection.removeByKey(r):(this.updateSize(a,!0),this.setSelection()))},onItemsClear:function(){this.gridLayoutEditItemsCollection.each((function(e){e.destroy()}),this),this.gridLayoutEditItemsCollection.clear(),this.updateSize(),this.selectedItems=[],this.fireEvent("selectedItemsChange",this.selectedItems,this)},onItemRemove:function(e,t){var r=this.gridLayoutEditItemsCollection.get(t);r.destroy(),this.gridLayoutEditItemsCollection.removeByKey(t),this.updateSize(r,!0),this.selectedItems=Ext.Array.remove(this.selectedItems,t),this.fireEvent("selectedItemsChange",this.selectedItems,this)},subscribeForCollectionEvents:function(e,t,r){this.callParent(arguments);var n=r.get(e.modelItem);"items"===t&&(n.on("dataLoaded",this.onItemsLoad,this),n.on("add",this.onItemAdd,this),n.on("remove",this.onItemRemove,this),n.on("clear",this.onItemsClear,this))},unSubscribeForCollectionEvents:function(e,t,r){this.callParent(arguments);var n=r.get(e.modelItem);"items"===t&&(n.un("dataLoaded",this.onItemsLoad,this),n.un("add",this.onItemAdd,this),n.un("remove",this.onItemRemove,this),n.un("clear",this.onItemsClear,this))},showItem:function(e){e.renderTo=this.tableEl,e.show()},showItems:function(){this.gridLayoutEditItemsCollection&&this.gridLayoutEditItemsCollection.each((function(e){this.showItem(e)}),this)},postRender:function(){this.validateProperty(this.rows,"rows"),this.validateProperty(this.columns,"columns"),this.showItems()},getDefaultItemBindingConfig:function(){var e={},t=Ext.ClassManager.get(this.itemClassName).prototype.getBindConfig();return Terrasoft.each(Object.keys(t),(function(t){e[t]={bindTo:t}}),this),e},getDropZones:function(){var e=[];this.cellElements={};var t=this.getWrapEl(),r=Ext.query(Ext.String.format("[id|='{0}-{1}']",this.id,this.tplConfig.selectorSuffixes.cell),t.dom);return Terrasoft.each(r,(function(t){var r=Ext.get(t);e.push(r),this.cellElements[r.id]=r}),this),e},getItemsMaxRow:function(){var e=this.minRows;return this.gridLayoutEditItemsCollection.each((function(t){var r=t.getBottomRow()+2;e=e<r?r:e}),this),e>this.maxRows?this.maxRows:e},getItemsMaxColumn:function(){var e=this.minColumns;return this.gridLayoutEditItemsCollection.each((function(t){var r=t.getRightColumn()+2;e=e<r?r:e}),this),e>this.maxColumns?this.maxColumns:e},updateHeight:function(){var e=!1;if(this.autoHeight){var t=this.getItemsMaxRow();this.rows!==t&&(this.setRows(t),e=!0)}return e},updateWidth:function(){var e=!1;if(this.autoWidth){var t=this.getItemsMaxColumn();this.columns!==t&&(this.setColumns(t),e=!0)}return e},getGroupName:function(){return this.id},getEventCellPosition:function(e){var t,r=e.getTarget();return r&&(t={row:parseInt(r.getAttribute("data-row-index"),10),column:parseInt(r.getAttribute("data-column-index"),10)}),t},onTableElClick:function(e){var t=this.getEventCellPosition(e);this.fireEvent("cellClick",t)},onTableElDblClick:function(e){var t=this.getEventCellPosition(e);this.fireEvent("cellDblClick",t)},getRangeBetweenPoints:function(e,t){var r=e.row,n=t.row;r>n&&(n=r,r=t.row);var i=e.column,a=t.column;return i>a&&(a=i,i=t.column),{row:r,rowSpan:n-r+1,column:i,colSpan:a-i+1}},setSelection:function(e){if(e){switch(this.selectionType){case Terrasoft.GridLayoutEditSelectionType.HORIZONTAL:e.rowSpan=1;break;case Terrasoft.GridLayoutEditSelectionType.VERTICAL:e.colSpan=1}e=this.getMaxSelection(e),this.setCellRangeSelected(e,1)}else{this.removeSelectionBorderClasses();var t=Ext.String.format('.{0} [data-selected="1"]',this.tplConfig.selectorSuffixes.table);Ext.select(t,this.tableEl).each((function(e){this.setCellSelected(e.dom,0)}),this)}this.selection=e,this.fireEvent("selectionChanged",this.selection)},isCellSelected:function(e){return parseInt(e.getAttribute("data-selected"),10)},setCellSelected:function(e,t){e.setAttribute("data-selected",t)},getUpNeighbourCell:function(e,t){var r=Ext.String.format("{0}-{1}-{2}-{3}",this.id,this.tplConfig.selectorSuffixes.cell,e-1,t);return Ext.get(r)},getLeftNeighbourCell:function(e,t){var r=Ext.String.format("{0}-{1}-{2}-{3}",this.id,this.tplConfig.selectorSuffixes.cell,e,t-1);return Ext.get(r)},setSelectionBorder:function(e,t,r,n){if(this.useSelectionBorder){var i=this.tplConfig.classes.selectionBorderClasses;if(r===e.row)if(0===r)t.addCls(i.top);else{var a=this.getUpNeighbourCell(r,n);a&&a.addCls(i.bottom)}if(r===e.row+e.rowSpan-1&&t.addCls(i.bottom),n===e.column)if(0===n)t.addCls(i.left);else{var s=this.getLeftNeighbourCell(r,n);s&&s.addCls(i.right)}n===e.column+e.colSpan-1&&t.addCls(i.right)}},removeSelectionBorderClasses:function(){if(this.useSelectionBorder){var e=this.tplConfig.classes.selectionBorderClasses,t=Ext.Object.getValues(e);Terrasoft.each(t,(function(e){Ext.select("."+e,this.tableEl).each((function(t){t.removeCls(e)}),this)}),this)}},setCellRangeSelected:function(e,t){if(this.rendered)for(var r=e.row;r<e.row+e.rowSpan;r++)for(var n=e.column;n<e.column+e.colSpan;n++){var i=Ext.String.format("{0}-{1}-{2}-{3}",this.id,this.tplConfig.selectorSuffixes.cell,r,n),a=this.cellElements[i];a&&(this.setSelectionBorder(e,a,r,n),this.setCellSelected(a.dom,t))}},onMouseDown:function(e){this.selectItem(),this.setSelection(),this.selectionMode=this.useManualSelection,this.selectionStartPosition=this.getEventCellPosition(e)},onMouseUp:function(e){if(this.selectionMode){var t=this.getEventCellPosition(e),r=this.getRangeBetweenPoints(this.selectionStartPosition,t);this.setSelection(r),this.selectionStartPosition=null,this.selectionMode=!1,this.fireEvent("selectionEnded",e,r,this)}},onMouseMove:function(e){if(this.selectionMode){var t=this.getEventCellPosition(e),r=this.getRangeBetweenPoints(this.selectionStartPosition,t);this.setSelection(),this.setSelection(r)}},getCellWidth:function(){return this.fixedCellWidth?this.cellWidth:100/this.columns},getCellWidthType:function(){return this.fixedCellWidth?"em":"%"},getCellStyle:function(){return Ext.String.format("width: {0}{1}",this.getCellWidth(),this.getCellWidthType())},init:function(){this.callParent(arguments),this.selectors={wrapEl:"",tableEl:""},this.gridLayoutEditItemsCollection=Ext.create("Terrasoft.Collection"),this.rows=this.autoHeight?this.getItemsMaxRow():this.rows,this.columns=this.autoWidth?this.getItemsMaxColumn():this.columns,this.itemBindingConfig=this.itemBindingConfig||this.getDefaultItemBindingConfig(),this.selectedItems=[],this.addEvents("cellClick","cellDblClick","selectionChanged","selectedItemsChange","itemClick","itemDblClick","rowsChanged","columnsChanged","itemActionClick","selectionEnded","itemPositionChanged")},initDomEvents:function(){var e=this.tableEl;e.on("click",this.onTableElClick,this),e.on("dblclick",this.onTableElDblClick,this),e.on("mousemove",this.onMouseMove,this),e.on("mousedown",this.onMouseDown,this),e.on("mouseup",this.onMouseUp,this)},onAfterRender:function(){this.callParent(arguments),this.postRender(),this.mixins.droppable.onAfterRender.apply(this,arguments)},onAfterReRender:function(){this.callParent(arguments),this.postRender(),this.mixins.droppable.onAfterReRender.apply(this,arguments)},onDestroy:function(){this.onItemsClear(),this.gridLayoutEditItemsCollection.destroy(),this.gridLayoutEditItemsCollection=null,this.mixins.droppable.onDestroy.apply(this,arguments);var e=this.tableEl;this.rendered&&(e.un("click",this.onTableElClick,this),e.un("dblclick",this.onTableElDblClick,this),e.un("mousemove",this.onMouseMove,this),e.un("mousedown",this.onMouseDown,this),e.un("mouseup",this.onMouseUp,this)),this.callParent(arguments)},setRows:function(e){e&&this.rows!==e&&(this.rows=parseInt(e,10),this.fireEvent("rowsChanged",this.rows),this.safeRerender())},setAllowItemsIntersection:function(e){this.allowItemsIntersection=Boolean(e)},addRow:function(){this.setRows(this.rows+1)},removeRow:function(){this.setRows(this.rows-1)},setColumns:function(e){e&&this.columns!==e&&(this.columns=parseInt(e,10),this.fireEvent("columnsChanged",this.columns),this.safeRerender())},addColumn:function(){this.setColumns(this.columns+1)},removeColumn:function(){this.setColumns(this.columns-1)},changeItemsPositions:function(e){var t=e.row,r=e.oldPosition.row,n=this.gridLayoutEditItemsCollection.getItems();Terrasoft.each(n,(function(n){if(n.id!==e.id){var i=n.row;i>r&&i-1>=r&&i<=t?n.setRow(i-1,!0):i<r&&i+1<=r&&i>=t&&n.setRow(i+1,!0),this.showItem(n)}}),this)},updateSize:function(e,t){var r=!1;if(!this.allowItemsIntersection&&!t&&e&&this.isItemIntersected(e))1===this.columns&&this.changePositionForIntersectedItems?this.changeItemsPositions(e):e.revertPositionChanges(),this.showItem(e);else{var n=this.updateHeight(),i=this.updateWidth();(n||i)&&this.allowRerender()?(r=!0,this.reRender()):e&&!e.destroyed&&this.showItem(e)}return r},selectItem:function(e,t){this.multipleSelection&&t?(this.selectedItems=Terrasoft.deepClone(this.selectedItems),this.selectedItems.push(e)):(this.gridLayoutEditItemsCollection.filterByFn((function(t){return t.selected&&t.itemId!==e}),this).each((function(e){e.setSelected(!1)}),this),this.selectedItems=e?[e]:[]);this.fireEvent("selectedItemsChange",this.selectedItems,this)}}),Ext.define("Terrasoft.controls.GridLayoutTableEditItem",{alternateClassName:"Terrasoft.GridLayoutTableEditItem",extend:"Terrasoft.GridLayoutEditItem",gridLayoutTableEditTplConfig:{classes:{wrapClasses:["grid-layout-table-edit-item-wrap"],textWrapClasses:["grid-layout-table-edit-item-content-text-wrap"],imageWrapClasses:["grid-layout-table-edit-item-content-image-wrap"]},selectorSuffixes:{gridCell:"grid-layout-table-edit-grid-cell",gridTable:"grid-layout-table-edit-grid"}},init:function(){this.callParent(arguments),this.mergeTplConfigs(this.gridLayoutTableEditTplConfig)},mergeTplConfigs:function(e){this.tplConfig=Ext.merge(this.tplConfig,e)},getTop:function(){var e=this.getGridLayoutEditInstance(),t=this.row*e.cellHeight;return Ext.String.format("calc({0}em + {1}px)",t,this.cellBorderLineSize)}}),Ext.define("Terrasoft.controls.GridLayoutTableEdit",{alternateClassName:"Terrasoft.GridLayoutTableEdit",extend:"Terrasoft.GridLayoutEdit",selectorSuffixRegexTemplate:"{(\\w*)}",columnsCaptionsConfig:null,rowsCaptionsConfig:null,rowsCaptionsHeaderConfig:null,fixedCellWidth:!0,cellWidth:3.4,cellHeight:3.5,itemClassName:"Terrasoft.GridLayoutTableEditItem",tplConfig:{classes:{controlWrapClasses:["grid-layout-table-edit-wrap"],rowsCaptionsWrapClasses:["grid-layout-table-edit-rows-captions-wrap"],rowsCaptionsHeaderClasses:["grid-layout-table-edit-rows-captions-header"],rowsCaptionsHeaderCellClasses:["grid-layout-table-edit-rows-captions-header-cell"],rowsCaptionsClasses:["grid-layout-table-edit-rows-captions"],rowsCaptionsRowClasses:["grid-layout-table-edit-rows-captions-row"],rowsCaptionsCellClasses:["grid-layout-table-edit-rows-captions-cell"],rightWrapClasses:["grid-layout-table-edit-right-wrap"],columnsHeaderClasses:["grid-layout-table-edit-columns-header"],columnsHeaderRowClasses:["grid-layout-table-edit-columns-header-row"],columnsHeaderCellClasses:["grid-layout-table-edit-columns-header-cell"],gridClasses:["grid-layout-table-edit-grid"],gridRowClasses:["grid-layout-table-edit-grid-row"],gridCellClasses:["grid-layout-table-edit-grid-cell"],selectionBorderClasses:{top:"grid-layout-table-edit-selection-border-top",bottom:"grid-layout-table-edit-selection-border-bottom",left:"grid-layout-table-edit-selection-border-left",right:"grid-layout-table-edit-selection-border-right"}},selectorSuffixes:{wrap:"grid-layout-table-edit-wrapper",table:"grid-layout-table-edit-grid",row:"grid-layout-table-edit-grid-row",cell:"grid-layout-table-edit-grid-cell",rightWrap:"grid-layout-table-edit-right-wrap",columnsHeader:"grid-layout-table-edit-columns-header",columnsHeaderRow:"grid-layout-table-edit-columns-header-row",columnsHeaderCell:"grid-layout-table-edit-columns-header-cell",rowsCaptionsWrap:"grid-layout-table-edit-rows-captions-wrap",rowsCaptionsHeader:"grid-layout-table-edit-rows-captions-header",rowsCaptionsHeaderCell:"grid-layout-table-edit-rows-captions-header-cell",rowsCaptions:"grid-layout-table-edit-rows-captions",rowsCaptionsRow:"grid-layout-table-edit-rows-captions-row",rowsCaptionsCell:"grid-layout-table-edit-rows-captions-cell"},styles:{},rowsCaptionsHeaderCellTpl:['<div id="{id}-{rowsCaptionsHeaderCell}-{colIndex}" class="{rowsCaptionsHeaderCellClasses}">{caption}</div>'],rowsCaptionsRowTpl:['<div id="{id}-{rowsCaptionsRow}-{rowIndex}" class="{rowsCaptionsRowClasses}">{rowCell}</div>'],rowsCaptionsCellTpl:['<div id="{id}-{rowsCaptionsCell}-{rowIndex}-{colIndex}" class="{rowsCaptionsCellClasses}">',"{caption}</div>"],columnsHeaderRowTpl:['<div id="{id}-{columnsHeaderRow}" class="{columnsHeaderRowClasses}" ','style="width:calc({rowWidth} + {scrollbarSize}px);">{rowCells}</div>'],columnsHeaderCellTpl:['<div id="{id}-{columnsHeaderCell}-{columnIndex}" ','class="{columnsHeaderCellClasses}" style="{cellStyle}">{caption}</div>'],gridTpl:['<div id="{id}-{table}" class="{gridClasses}">{rows}</div>'],gridRowTpl:['<div id="{id}-{row}-{rowIndex}" data-row-index="{rowIndex}" ','has-columns-captions="{isHasColumnsCaptions}" has-rows-captions="{isHasRowsCaptions}" category="{isCategory}"','class="{gridRowClasses}" style="width:{rowWidth};">{rowCells}</div>'],gridCellTpl:['<div id="{id}-{cell}-{rowIndex}-{colIndex}" data-row-index="{rowIndex}" ','data-column-index="{colIndex}" data-selected="0" class="{gridCellClasses}" ','style="{cellStyle}"></div>']},tpl:['<div id="{id}-{wrap}" class="{controlWrapClasses}">','<tpl if="isHasRowsCaptions">','<div id="{id}-{rowsCaptionsWrap}" class="{rowsCaptionsWrapClasses}">','<div id="{id}-{rowsCaptionsHeader}" class="{rowsCaptionsHeaderClasses}">',"{%this.prepareRowsCaptionsHeaderTplData(out, values)%}","</div>",'<div id="{id}-{rowsCaptions}" class="{rowsCaptionsClasses}">',"{%this.prepareRowsCaptionsTplData(out, values)%}","</div>","</div>","</tpl>",'<div id="{id}-{rightWrap}" class="{rightWrapClasses}">','<tpl if="isHasColumnsCaptions">','<div id="{id}-{columnsHeader}" class="{columnsHeaderClasses}">',"{%this.prepareColumnsHeaderTplData(out, values)%}","</div>","</tpl>","{%this.prepareGridTplData(out, values)%}","</div>"],templatesCache:null,currentScrollTop:0,currentScrollLeft:0,getTplData:function(){var e=this.callParent(arguments),t=this.selectors,r=this.tplConfig.selectorSuffixes,n=Ext.String.format("#{0}-",this.id);return t.rowsCaptionsWrapEl=n+r.rowsCaptions,t.columnsCaptionsWrapEl=n+r.columnsHeader,t.gridEl=n+r.table,this.applyTplConfigProperties(e,"selectorSuffixes"),e.isHasRowsCaptions=this.hasRowsCaptions(),e.isHasColumnsCaptions=this.hasColumnsCaptions(),e.prepareColumnsHeaderTplData=this.prepareColumnsHeaderTplData,e.prepareGridTplData=this.prepareGridTplData,e.prepareRowsCaptionsHeaderTplData=this.prepareRowsCaptionsHeaderTplData,e.prepareRowsCaptionsTplData=this.prepareRowsCaptionsTplData,e},prepareColumnsHeaderTplData:function(e,t){for(var r,n,i=t.self,a=i.getCellStyle(),s=[],o=i.getTemplateByHtmlTpl("columnsHeaderCellTpl",t),l=0;l<i.columns;l++)n=i.columnsCaptionsConfig[l]?i.columnsCaptionsConfig[l].caption:"",r=o.apply({id:i.id,columnIndex:l,cellStyle:a,caption:n}),s.push(r);var c=i.getTemplateByHtmlTpl("columnsHeaderRowTpl",t);e.push(c.apply({id:i.id,rowWidth:i.getRowWidth.call(i),scrollbarSize:Ext.getScrollbarSize().width,rowCells:s.join("")}))},prepareRowsCaptionsHeaderTplData:function(e,t){var r=t.self;if(r.hasRowsCaptions()){var n=r.rowsCaptionsHeaderConfig?r.rowsCaptionsHeaderConfig.caption:"",i=r.getTemplateByHtmlTpl("rowsCaptionsHeaderCellTpl",t);e.push(i.apply({id:r.id,colIndex:0,caption:n}))}},prepareRowsCaptionsTplData:function(e,t){var r,n,i,a=t.self,s=[];if(a.hasRowsCaptions()){for(var o=a.getTemplateByHtmlTpl("rowsCaptionsCellTpl",t),l=a.getTemplateByHtmlTpl("rowsCaptionsRowTpl",t),c=0;c<a.rows;c++)i=a.rowsCaptionsConfig[c]?a.rowsCaptionsConfig[c].caption:"",n=o.apply({id:a.id,rowIndex:c,colIndex:0,caption:i}),r=l.apply({id:a.id,rowIndex:c,rowCell:n}),s.push(r);e.push(s.join(""))}},prepareGridTplData:function(e,t){var r=t.self;e.push(r.generateGrid.call(r,t))},generateRowCells:function(e,t,r){for(var n=[],i=0;i<this.columns;i++){var a=r.cellTemplate.apply({id:this.id,rowIndex:e,colIndex:i,cellStyle:r.cellStyle});n.push(a)}return n},generateRow:function(e,t,r){var n=this.generateRowCells(e,t,r);return r.rowTemplate.apply({id:this.id,rowIndex:e,rowWidth:r.rowWidth,isHasRowsCaptions:r.isHasRowsCaptions,isHasColumnsCaptions:r.isHasColumnsCaptions,rowCells:n.join("")})},generateGrid:function(e){var t=this.getTemplateByHtmlTpl("gridTpl",e),r={};r.isHasColumnsCaptions=this.hasColumnsCaptions()?"1":"0",r.isHasRowsCaptions=this.hasRowsCaptions()?"1":"0",r.rowTemplate=this.getTemplateByHtmlTpl("gridRowTpl",e),r.rowWidth=this.getRowWidth(),r.cellTemplate=this.getTemplateByHtmlTpl("gridCellTpl",e),r.cellStyle=this.getCellStyle();for(var n=[],i=0;i<this.rows;i++)n.push(this.generateRow(i,e,r));return t.apply({id:this.id,rows:n.join("")})},getTemplateByHtmlTpl:function(e,t){var r=this.templatesCache[e];if(!Ext.isEmpty(r))return r;var n=this.tplConfig[e];Ext.isArray(n)&&(n=n.join("")),n=this.processTpl(this.cssRegexTemplate,n,t,(function(e){return'class="'+(Ext.isArray(e)?e.join(" "):e)+'"'}));var i=new RegExp(this.selectorSuffixRegexTemplate,"gm");n=(n=n.replace(i,(function(e,r){if(Ext.isEmpty(r))return"";var n=t[r];return Ext.isEmpty(n)?e:n}))).replace(/\s+/g," ");var a=new Ext.Template(n);return this.templatesCache[e]=a,a},onGridScroll:function(){var e=this.gridEl;this.hasColumnsCaptions()&&Ext.get(this.id+"-"+this.tplConfig.selectorSuffixes.columnsHeader).setScrollLeft(e.getScrollLeft());this.hasRowsCaptions()&&this.rowsCaptionsWrapEl.setScrollTop(e.getScrollTop())},init:function(){this.callParent(arguments),this.templatesCache={}},onRowCaptionsMouseWheel:function(e){e&&e.stopEvent();var t=this.gridEl,r=e.browserEvent,n=r.wheelDelta||-20*r.detail;t.setScrollTop(t.getScrollTop()-n)},getRowWidth:function(){return this.columns*this.cellWidth+this.getCellWidthType()},getBindConfig:function(){return Ext.apply(this.callParent(arguments),{columnsCaptionsConfig:{changeMethod:"setColumnsCaptionsConfig"},rowsCaptionsConfig:{changeMethod:"setRowsCaptionsConfig"}})},setColumnsCaptionsConfig:function(e){this.columnsCaptionsConfig=e||{}},setRowsCaptionsConfig:function(e){this.rowsCaptionsConfig=e||{}},initDomEvents:function(){this.callParent(arguments);var e=this.hasColumnsCaptions(),t=this.hasRowsCaptions();if(e||t){var r=this.gridEl;Ext.EventManager.addListener(r.dom,"scroll",this.onGridScroll,this)}if(t){var n=this.rowsCaptionsWrapEl;Ext.EventManager.addListener(n.dom,"mousewheel",this.onRowCaptionsMouseWheel,this)}},clearDomListeners:function(){if(this.callParent(arguments),this.rendered){var e=this.hasColumnsCaptions(),t=this.hasRowsCaptions();if(e||t){var r=this.gridEl;Ext.EventManager.removeListener(r.dom,"scroll",this.onGridScroll,this)}if(t){var n=this.rowsCaptionsWrapEl;Ext.EventManager.removeListener(n.dom,"mousewheel",this.onRowCaptionsMouseWheel,this)}}},hasRowsCaptions:function(){return!Ext.isEmpty(this.rowsCaptionsConfig)},hasColumnsCaptions:function(){return!Ext.isEmpty(this.columnsCaptionsConfig)},onAfterReRender:function(){this.callParent(arguments),this.restoreScrollPosition()},onBeforeReRender:function(){this.callParent(arguments),this.saveScrollPosition()},saveScrollPosition:function(){var e=this.gridEl;this.currentScrollTop=e.getScrollTop(),this.currentScrollLeft=e.getScrollLeft()},restoreScrollPosition:function(){var e=this.gridEl;e.setScrollTop(this.currentScrollTop),e.setScrollLeft(this.currentScrollLeft)}}),Ext.define("Terrasoft.FileContentUrlBuilder",{singleton:!0,getUrl:function(e,t){var r=[Terrasoft.workspaceBaseUrl,"Terrasoft.Configuration/Pkg",e,"Files",t].join("/");return r+="?hash="+(((Terrasoft.configuration.FileContentDescriptors||{})[e+"/"+t]||{}).Hash||Terrasoft.configurationContentHash||"empty")},prepareUrlForRequireJs:function(e){return e.endsWith(".js")&&-1===e.indexOf("?")?e+"?hash=empty":e}}),Terrasoft.getFileContentUrl=Terrasoft.FileContentUrlBuilder.getUrl,Terrasoft.prepareUrlForRequireJs=Terrasoft.FileContentUrlBuilder.prepareUrlForRequireJs,Ext.define("Terrasoft.SchemaUrlBuilder",{_mainUrl:null,singleton:!0,getMainUrl:function(){return this._mainUrl||(this._mainUrl=[Terrasoft.workspaceBaseUrl,Terrasoft.app.config.staticFileContent.schemasRuntimePath].join("/")),this._mainUrl},getUrl:function(e){return[this.getMainUrl(),e].join("/")}}),Ext.define("Terrasoft.ResourceUrlBuilder",{_mainUrl:null,singleton:!0,getMainUrl:function(){return this._mainUrl||(this._mainUrl=[Terrasoft.workspaceBaseUrl,Terrasoft.app.config.staticFileContent.resourcesRuntimePath,Terrasoft.currentUserCultureName].join("/")),this._mainUrl},getUrl:function(e){return[this.getMainUrl(),e].join("/")}}),Ext.define("Terrasoft.utils.common.ImageDecorator",{alternateClassName:"Terrasoft.ImageDecorator",decorations:null,source:null,crossOrigin:"use-credentials",contextType:"2d",initImage:function(){var e=new Image;e.crossOrigin=this.crossOrigin,e.onload=this.onLoadImage.bind(this,e),e.src=this.source},onLoadImage:function(e){var t=this.getInstanceCanvas(),r=this.getContext(t);r.save(),Ext.isArray(this.decorations)&&Terrasoft.each(this.decorations,function(n){n.apply(this,[t,r,e])}.bind(this)),r.restore(),this.destroyCanvas(t)},getContext:function(e){return e.getContext(this.contextType)},getInstanceCanvas:function(){var e=Ext.getDoc().dom;return Ext.DomHelper.append(e.body,{tag:"canvas",style:"display: none"})},destroyCanvas:function(e){e.remove()},addDecor:function(e){Ext.isArray(this.decorations)||(this.decorations=[]),this.decorations.push(e)},getBinaryUrl:function(e,t){this.addDecor((function(r){var n=r.toDataURL();e.apply(t||this,[n])}))},checkFillingParameters:function(e){return Terrasoft.each(e,(function(e,t){if(Ext.isEmpty(e))throw new Terrasoft.ArgumentNullOrEmptyException({argumentsName:t})})),!0},resizeImage:function(e){var t=e.width,r=e.height;this.addDecor((function(e){e.width=t,e.height=r}))},arcImage:function(e){var t=e.x,r=e.y,n=e.radius,i=e.start,a=e.end,s=e.route||!0;this.addDecor((function(e,o){o.beginPath(),o.arc(t,r,n,i*Math.PI,a*Math.PI,s||!0),o.closePath(),o.clip()}))},roundImage:function(e){e.start=0,e.end=2,this.arcImage(e)},drawImage:function(e){var t=e.x,r=e.y;this.addDecor((function(e,n,i){n.drawImage(i,t,r,e.width,e.height)}))},round:function(e){this.checkFillingParameters(e);var t=e.radius,r=2*t,n={x:e.roundX||t,y:e.roundX||t,radius:t},i={width:e.resizeWidth||r,height:e.resizeHeight||r},a={x:e.drawX||0,y:e.drawY||0};this.source=e.source,this.resizeImage(i),this.roundImage(n),this.drawImage(a)},execute:function(e,t){this.getBinaryUrl(e,t),this.initImage()}}),Ext.define("Terrasoft.utils.common.ResourceUtility",{alternateClassName:"Terrasoft.ResourceUtility",singleton:!0,constructor:function(){return this.initResourceCaches(),this.callParent(arguments)},resourceCaches:null,initResourceCaches:function(){Ext.isEmpty(Terrasoft.ResourceCache)&&Terrasoft.StoreManager.registerStore({levelName:"Resource",type:"Terrasoft.LocalStore",isCache:!0}),this.resourceCaches=Terrasoft.ResourceCache},getResourceCaches:function(e){return this.resourceCaches.getItem(e)},setResourceCaches:function(e,t){this.resourceCaches.setItem(e,t)},getParametersKey:function(e){return Object.keys(e).map((function(t){return e[t]})).join("_")},getDataUrl:function(e){var t=Terrasoft.ImageUrlBuilder.getUrl(e),r=e.callback,n=e.scope||this,i=e.filter,a=e.params&&e.params.primaryColumnValue,s=Object.getOwnPropertyNames(i),o=i[s],l=[a,s,this.getParametersKey(o)].join("_"),c=this.getResourceCaches(l);if(o.source=t,Ext.isEmpty(c)){var u=Ext.create("Terrasoft.ImageDecorator");u[s](o),u.execute((function(e){this.setResourceCaches(l,e),r.apply(n,[e])}),this)}else r.apply(n,[c])}}),Ext.ns("Terrasoft.filter.enums"),Terrasoft.filter.enums.FilterMacrosType={HOUR_PREVIOUS:0,HOUR_CURRENT:1,HOUR_NEXT:2,HOUR_EXACT:3,HOUR_PREVIOUS_N:4,HOUR_NEXT_N:5,DAY_YESTERDAY:6,DAY_TODAY:7,DAY_TOMORROW:8,DAY_OF_MONTH:9,DAY_OF_WEEK:10,DAY_PREVIOUS_N:11,DAY_NEXT_N:12,WEEK_PREVIOUS:13,WEEK_CURRENT:14,WEEK_NEXT:15,MONTH_PREVIOUS:16,MONTH_CURRENT:17,MONTH_NEXT:18,MONTH_EXACT:19,QUARTER_PREVIOUS:20,QUARTER_CURRENT:21,QUARTER_NEXT:22,HALF_YEAR_PREVIOUS:23,HALF_YEAR_CURRENT:24,HALF_YEAR_NEXT:25,YEAR_PREVIOUS:26,YEAR_CURRENT:27,YEAR_NEXT:28,YEAR_EXACT:29,CONTACT_CURRENT:30,USER_CURRENT:31,DAY_OF_YEAR_TODAY:32,DAY_OF_YEAR_TODAY_PLUS_DAYS_OFFSET:33,NEXT_N_DAYS_OF_YEAR:34,PREVIOUS_N_DAYS_OF_YEAR:35},Terrasoft.FilterMacrosType=Terrasoft.filter.enums.FilterMacrosType,Terrasoft.filter.enums.ParameterizedFilterMacrosTypes=[Terrasoft.FilterMacrosType.HOUR_PREVIOUS_N,Terrasoft.FilterMacrosType.HOUR_NEXT_N,Terrasoft.FilterMacrosType.DAY_PREVIOUS_N,Terrasoft.FilterMacrosType.DAY_NEXT_N,Terrasoft.FilterMacrosType.DAY_OF_YEAR_TODAY_PLUS_DAYS_OFFSET,Terrasoft.FilterMacrosType.NEXT_N_DAYS_OF_YEAR,Terrasoft.FilterMacrosType.PREVIOUS_N_DAYS_OF_YEAR],Terrasoft.ParameterizedFilterMacrosTypes=Terrasoft.filter.enums.ParameterizedFilterMacrosTypes,Terrasoft.filter.enums.MacrosTypeConfig={},Terrasoft.MacrosTypeConfig=Terrasoft.filter.enums.MacrosTypeConfig,Terrasoft.MacrosTypeConfig[Terrasoft.FilterMacrosType.DAY_OF_YEAR_TODAY]={caption:Terrasoft.Resources.FilterMacros.DayOfYearToday,groupCaption:Terrasoft.Resources.FilterMacros.MacrosTypeGroupDayOfYear,functionType:Terrasoft.FunctionType.MACROS,queryMacrosType:Terrasoft.QueryMacrosType.DAY_OF_YEAR_TODAY,datePartType:Terrasoft.DatePartType.DAY},Terrasoft.MacrosTypeConfig[Terrasoft.FilterMacrosType.DAY_OF_YEAR_TODAY_PLUS_DAYS_OFFSET]={caption:Terrasoft.Resources.FilterMacros.DayOfYearTodayPlusDaysOffset,groupCaption:Terrasoft.Resources.FilterMacros.MacrosTypeGroupDayOfYear,functionType:Terrasoft.FunctionType.MACROS,queryMacrosType:Terrasoft.QueryMacrosType.DAY_OF_YEAR_TODAY_PLUS_DAYS_OFFSET,datePartType:Terrasoft.DatePartType.DAY,value:{dataValueType:Terrasoft.DataValueType.INTEGER,minValue:-365,maxValue:365},comparisonType:{isEnabled:!1,defaultValue:Terrasoft.ComparisonType.EQUAL}},Terrasoft.MacrosTypeConfig[Terrasoft.FilterMacrosType.NEXT_N_DAYS_OF_YEAR]={caption:Terrasoft.Resources.FilterMacros.NextNDaysOfYear,groupCaption:Terrasoft.Resources.FilterMacros.MacrosTypeGroupDayOfYear,functionType:Terrasoft.FunctionType.MACROS,queryMacrosType:Terrasoft.QueryMacrosType.NEXT_N_DAYS_OF_YEAR,datePartType:Terrasoft.DatePartType.DAY,value:{dataValueType:Terrasoft.DataValueType.INTEGER,minValue:0,maxValue:365},comparisonType:{isEnabled:!1,defaultValue:Terrasoft.ComparisonType.EQUAL}},Terrasoft.MacrosTypeConfig[Terrasoft.FilterMacrosType.PREVIOUS_N_DAYS_OF_YEAR]={caption:Terrasoft.Resources.FilterMacros.PreviousNDaysOfYear,groupCaption:Terrasoft.Resources.FilterMacros.MacrosTypeGroupDayOfYear,functionType:Terrasoft.FunctionType.MACROS,queryMacrosType:Terrasoft.QueryMacrosType.PREVIOUS_N_DAYS_OF_YEAR,datePartType:Terrasoft.DatePartType.DAY,value:{dataValueType:Terrasoft.DataValueType.INTEGER,minValue:0,maxValue:365},comparisonType:{isEnabled:!1,defaultValue:Terrasoft.ComparisonType.EQUAL}},Terrasoft.MacrosTypeConfig[Terrasoft.FilterMacrosType.HOUR_PREVIOUS]={caption:Terrasoft.Resources.FilterMacros.HourPrevious,groupCaption:Terrasoft.Resources.FilterMacros.MacrosTypeGroupHour,functionType:Terrasoft.FunctionType.MACROS,queryMacrosType:Terrasoft.QueryMacrosType.PREVIOUS_HOUR,datePartType:Terrasoft.DatePartType.NONE},Terrasoft.MacrosTypeConfig[Terrasoft.FilterMacrosType.HOUR_CURRENT]={caption:Terrasoft.Resources.FilterMacros.HourCurrent,groupCaption:Terrasoft.Resources.FilterMacros.MacrosTypeGroupHour,functionType:Terrasoft.FunctionType.MACROS,queryMacrosType:Terrasoft.QueryMacrosType.CURRENT_HOUR,datePartType:Terrasoft.DatePartType.NONE},Terrasoft.MacrosTypeConfig[Terrasoft.FilterMacrosType.HOUR_NEXT]={caption:Terrasoft.Resources.FilterMacros.HourNext,groupCaption:Terrasoft.Resources.FilterMacros.MacrosTypeGroupHour,functionType:Terrasoft.FunctionType.MACROS,queryMacrosType:Terrasoft.QueryMacrosType.NEXT_HOUR,datePartType:Terrasoft.DatePartType.NONE},Terrasoft.MacrosTypeConfig[Terrasoft.FilterMacrosType.HOUR_EXACT]={caption:Terrasoft.Resources.FilterMacros.HourExact,groupCaption:Terrasoft.Resources.FilterMacros.MacrosTypeGroupHour,functionType:Terrasoft.FunctionType.DATE_PART,queryMacrosType:Terrasoft.QueryMacrosType.NONE,datePartType:Terrasoft.DatePartType.HOUR_MINUTE,value:{dataValueType:Terrasoft.DataValueType.TIME}},Terrasoft.MacrosTypeConfig[Terrasoft.FilterMacrosType.HOUR_PREVIOUS_N]={caption:Terrasoft.Resources.FilterMacros.HourPreviousN,groupCaption:Terrasoft.Resources.FilterMacros.MacrosTypeGroupHour,functionType:Terrasoft.FunctionType.MACROS,queryMacrosType:Terrasoft.QueryMacrosType.PREVIOUS_N_HOURS,datePartType:Terrasoft.DatePartType.NONE,value:{dataValueType:Terrasoft.DataValueType.INTEGER}},Terrasoft.MacrosTypeConfig[Terrasoft.FilterMacrosType.HOUR_NEXT_N]={caption:Terrasoft.Resources.FilterMacros.HourNextN,groupCaption:Terrasoft.Resources.FilterMacros.MacrosTypeGroupHour,functionType:Terrasoft.FunctionType.MACROS,queryMacrosType:Terrasoft.QueryMacrosType.NEXT_N_HOURS,datePartType:Terrasoft.DatePartType.NONE,value:{dataValueType:Terrasoft.DataValueType.INTEGER}},Terrasoft.MacrosTypeConfig[Terrasoft.FilterMacrosType.DAY_YESTERDAY]={caption:Terrasoft.Resources.FilterMacros.DayYesterday,groupCaption:Terrasoft.Resources.FilterMacros.MacrosTypeGroupDay,functionType:Terrasoft.FunctionType.MACROS,queryMacrosType:Terrasoft.QueryMacrosType.YESTERDAY,datePartType:Terrasoft.DatePartType.NONE},Terrasoft.MacrosTypeConfig[Terrasoft.FilterMacrosType.DAY_TODAY]={caption:Terrasoft.Resources.FilterMacros.DayToday,groupCaption:Terrasoft.Resources.FilterMacros.MacrosTypeGroupDay,functionType:Terrasoft.FunctionType.MACROS,queryMacrosType:Terrasoft.QueryMacrosType.TODAY,datePartType:Terrasoft.DatePartType.NONE},Terrasoft.MacrosTypeConfig[Terrasoft.FilterMacrosType.DAY_TOMORROW]={caption:Terrasoft.Resources.FilterMacros.DayTomorrow,groupCaption:Terrasoft.Resources.FilterMacros.MacrosTypeGroupDay,functionType:Terrasoft.FunctionType.MACROS,queryMacrosType:Terrasoft.QueryMacrosType.TOMORROW,datePartType:Terrasoft.DatePartType.NONE},Terrasoft.MacrosTypeConfig[Terrasoft.FilterMacrosType.DAY_OF_MONTH]={caption:Terrasoft.Resources.FilterMacros.DayOfMonth,groupCaption:Terrasoft.Resources.FilterMacros.MacrosTypeGroupDay,functionType:Terrasoft.FunctionType.DATE_PART,queryMacrosType:Terrasoft.QueryMacrosType.NONE,datePartType:Terrasoft.DatePartType.DAY,value:{dataValueType:Terrasoft.DataValueType.INTEGER,minValue:1,maxValue:31}},Terrasoft.MacrosTypeConfig[Terrasoft.FilterMacrosType.DAY_OF_WEEK]={caption:Terrasoft.Resources.FilterMacros.DayOfWeek,groupCaption:Terrasoft.Resources.FilterMacros.MacrosTypeGroupDay,functionType:Terrasoft.FunctionType.DATE_PART,queryMacrosType:Terrasoft.QueryMacrosType.NONE,datePartType:Terrasoft.DatePartType.WEEK_DAY,value:{dataValueType:Terrasoft.DataValueType.INTEGER,displayValueRange:Terrasoft.Resources.CultureSettings.shortDayNames}},Terrasoft.MacrosTypeConfig[Terrasoft.FilterMacrosType.DAY_PREVIOUS_N]={caption:Terrasoft.Resources.FilterMacros.DayPreviousN,groupCaption:Terrasoft.Resources.FilterMacros.MacrosTypeGroupDay,functionType:Terrasoft.FunctionType.MACROS,queryMacrosType:Terrasoft.QueryMacrosType.PREVIOUS_N_DAYS,datePartType:Terrasoft.DatePartType.NONE,value:{dataValueType:Terrasoft.DataValueType.INTEGER}},Terrasoft.MacrosTypeConfig[Terrasoft.FilterMacrosType.DAY_NEXT_N]={caption:Terrasoft.Resources.FilterMacros.DayNextN,groupCaption:Terrasoft.Resources.FilterMacros.MacrosTypeGroupDay,functionType:Terrasoft.FunctionType.MACROS,queryMacrosType:Terrasoft.QueryMacrosType.NEXT_N_DAYS,datePartType:Terrasoft.DatePartType.NONE,value:{dataValueType:Terrasoft.DataValueType.INTEGER}},Terrasoft.MacrosTypeConfig[Terrasoft.FilterMacrosType.WEEK_PREVIOUS]={caption:Terrasoft.Resources.FilterMacros.WeekPrevious,groupCaption:Terrasoft.Resources.FilterMacros.MacrosTypeGroupWeek,functionType:Terrasoft.FunctionType.MACROS,queryMacrosType:Terrasoft.QueryMacrosType.PREVIOUS_WEEK,datePartType:Terrasoft.DatePartType.NONE},Terrasoft.MacrosTypeConfig[Terrasoft.FilterMacrosType.WEEK_CURRENT]={caption:Terrasoft.Resources.FilterMacros.WeekCurrent,groupCaption:Terrasoft.Resources.FilterMacros.MacrosTypeGroupWeek,functionType:Terrasoft.FunctionType.MACROS,queryMacrosType:Terrasoft.QueryMacrosType.CURRENT_WEEK,datePartType:Terrasoft.DatePartType.NONE},Terrasoft.MacrosTypeConfig[Terrasoft.FilterMacrosType.WEEK_NEXT]={caption:Terrasoft.Resources.FilterMacros.WeekNext,groupCaption:Terrasoft.Resources.FilterMacros.MacrosTypeGroupWeek,functionType:Terrasoft.FunctionType.MACROS,queryMacrosType:Terrasoft.QueryMacrosType.NEXT_WEEK,datePartType:Terrasoft.DatePartType.NONE},Terrasoft.MacrosTypeConfig[Terrasoft.FilterMacrosType.MONTH_PREVIOUS]={caption:Terrasoft.Resources.FilterMacros.MonthPrevious,groupCaption:Terrasoft.Resources.FilterMacros.MacrosTypeGroupMonth,functionType:Terrasoft.FunctionType.MACROS,queryMacrosType:Terrasoft.QueryMacrosType.PREVIOUS_MONTH,datePartType:Terrasoft.DatePartType.NONE},Terrasoft.MacrosTypeConfig[Terrasoft.FilterMacrosType.MONTH_CURRENT]={caption:Terrasoft.Resources.FilterMacros.MonthCurrent,groupCaption:Terrasoft.Resources.FilterMacros.MacrosTypeGroupMonth,functionType:Terrasoft.FunctionType.MACROS,queryMacrosType:Terrasoft.QueryMacrosType.CURRENT_MONTH,datePartType:Terrasoft.DatePartType.NONE},Terrasoft.MacrosTypeConfig[Terrasoft.FilterMacrosType.MONTH_NEXT]={caption:Terrasoft.Resources.FilterMacros.MonthNext,groupCaption:Terrasoft.Resources.FilterMacros.MacrosTypeGroupMonth,functionType:Terrasoft.FunctionType.MACROS,queryMacrosType:Terrasoft.QueryMacrosType.NEXT_MONTH,datePartType:Terrasoft.DatePartType.NONE},Terrasoft.MacrosTypeConfig[Terrasoft.FilterMacrosType.MONTH_EXACT]={caption:Terrasoft.Resources.FilterMacros.MonthExact,groupCaption:Terrasoft.Resources.FilterMacros.MacrosTypeGroupMonth,functionType:Terrasoft.FunctionType.DATE_PART,queryMacrosType:Terrasoft.QueryMacrosType.NONE,datePartType:Terrasoft.DatePartType.MONTH,value:{dataValueType:Terrasoft.DataValueType.INTEGER,displayValueRange:Terrasoft.Resources.CultureSettings.monthNames}},Terrasoft.MacrosTypeConfig[Terrasoft.FilterMacrosType.QUARTER_PREVIOUS]={caption:Terrasoft.Resources.FilterMacros.QuarterPrevious,groupCaption:Terrasoft.Resources.FilterMacros.MacrosTypeGroupQuarter,functionType:Terrasoft.FunctionType.MACROS,queryMacrosType:Terrasoft.QueryMacrosType.PREVIOUS_QUARTER,datePartType:Terrasoft.DatePartType.NONE},Terrasoft.MacrosTypeConfig[Terrasoft.FilterMacrosType.QUARTER_CURRENT]={caption:Terrasoft.Resources.FilterMacros.QuarterCurrent,groupCaption:Terrasoft.Resources.FilterMacros.MacrosTypeGroupQuarter,functionType:Terrasoft.FunctionType.MACROS,queryMacrosType:Terrasoft.QueryMacrosType.CURRENT_QUARTER,datePartType:Terrasoft.DatePartType.NONE},Terrasoft.MacrosTypeConfig[Terrasoft.FilterMacrosType.QUARTER_NEXT]={caption:Terrasoft.Resources.FilterMacros.QuarterNext,groupCaption:Terrasoft.Resources.FilterMacros.MacrosTypeGroupQuarter,functionType:Terrasoft.FunctionType.MACROS,queryMacrosType:Terrasoft.QueryMacrosType.NEXT_QUARTER,datePartType:Terrasoft.DatePartType.NONE},Terrasoft.MacrosTypeConfig[Terrasoft.FilterMacrosType.HALF_YEAR_PREVIOUS]={caption:Terrasoft.Resources.FilterMacros.HalfYearPrevious,groupCaption:Terrasoft.Resources.FilterMacros.MacrosTypeGroupHalfYear,functionType:Terrasoft.FunctionType.MACROS,queryMacrosType:Terrasoft.QueryMacrosType.PREVIOUS_HALF_YEAR,datePartType:Terrasoft.DatePartType.NONE},Terrasoft.MacrosTypeConfig[Terrasoft.FilterMacrosType.HALF_YEAR_CURRENT]={caption:Terrasoft.Resources.FilterMacros.HalfYearCurrent,groupCaption:Terrasoft.Resources.FilterMacros.MacrosTypeGroupHalfYear,functionType:Terrasoft.FunctionType.MACROS,queryMacrosType:Terrasoft.QueryMacrosType.CURRENT_HALF_YEAR,datePartType:Terrasoft.DatePartType.NONE},Terrasoft.MacrosTypeConfig[Terrasoft.FilterMacrosType.HALF_YEAR_NEXT]={caption:Terrasoft.Resources.FilterMacros.HalfYearNext,groupCaption:Terrasoft.Resources.FilterMacros.MacrosTypeGroupHalfYear,functionType:Terrasoft.FunctionType.MACROS,queryMacrosType:Terrasoft.QueryMacrosType.NEXT_HALF_YEAR,datePartType:Terrasoft.DatePartType.NONE},Terrasoft.MacrosTypeConfig[Terrasoft.FilterMacrosType.YEAR_PREVIOUS]={caption:Terrasoft.Resources.FilterMacros.YearPrevious,groupCaption:Terrasoft.Resources.FilterMacros.MacrosTypeGroupYear,functionType:Terrasoft.FunctionType.MACROS,queryMacrosType:Terrasoft.QueryMacrosType.PREVIOUS_YEAR,datePartType:Terrasoft.DatePartType.NONE},Terrasoft.MacrosTypeConfig[Terrasoft.FilterMacrosType.YEAR_CURRENT]={caption:Terrasoft.Resources.FilterMacros.YearCurrent,groupCaption:Terrasoft.Resources.FilterMacros.MacrosTypeGroupYear,functionType:Terrasoft.FunctionType.MACROS,queryMacrosType:Terrasoft.QueryMacrosType.CURRENT_YEAR,datePartType:Terrasoft.DatePartType.NONE},Terrasoft.MacrosTypeConfig[Terrasoft.FilterMacrosType.YEAR_NEXT]={caption:Terrasoft.Resources.FilterMacros.YearNext,groupCaption:Terrasoft.Resources.FilterMacros.MacrosTypeGroupYear,functionType:Terrasoft.FunctionType.MACROS,queryMacrosType:Terrasoft.QueryMacrosType.NEXT_YEAR,datePartType:Terrasoft.DatePartType.NONE},Terrasoft.MacrosTypeConfig[Terrasoft.FilterMacrosType.YEAR_EXACT]={caption:Terrasoft.Resources.FilterMacros.YearExact,groupCaption:Terrasoft.Resources.FilterMacros.MacrosTypeGroupYear,functionType:Terrasoft.FunctionType.DATE_PART,queryMacrosType:Terrasoft.QueryMacrosType.NONE,datePartType:Terrasoft.DatePartType.YEAR,value:{dataValueType:Terrasoft.DataValueType.INTEGER}},Terrasoft.MacrosTypeConfig[Terrasoft.FilterMacrosType.CONTACT_CURRENT]={caption:Terrasoft.Resources.FilterMacros.ContactCurrent,functionType:Terrasoft.FunctionType.MACROS,queryMacrosType:Terrasoft.QueryMacrosType.CURRENT_USER_CONTACT,datePartType:Terrasoft.DatePartType.NONE},Terrasoft.MacrosTypeConfig[Terrasoft.FilterMacrosType.USER_CURRENT]={caption:Terrasoft.Resources.FilterMacros.UserCurrent,functionType:Terrasoft.FunctionType.MACROS,queryMacrosType:Terrasoft.QueryMacrosType.CURRENT_USER,datePartType:Terrasoft.DatePartType.NONE},Terrasoft.filter.enums.DatePartTypeFilterMacrosType={},Terrasoft.DatePartTypeFilterMacrosType=Terrasoft.filter.enums.DatePartTypeFilterMacrosType,Terrasoft.DatePartTypeFilterMacrosType[Terrasoft.DatePartType.DAY]=Terrasoft.FilterMacrosType.DAY_OF_MONTH,Terrasoft.DatePartTypeFilterMacrosType[Terrasoft.DatePartType.MONTH]=Terrasoft.FilterMacrosType.MONTH_EXACT,Terrasoft.DatePartTypeFilterMacrosType[Terrasoft.DatePartType.YEAR]=Terrasoft.FilterMacrosType.YEAR_EXACT,Terrasoft.DatePartTypeFilterMacrosType[Terrasoft.DatePartType.WEEK_DAY]=Terrasoft.FilterMacrosType.DAY_OF_WEEK,Terrasoft.DatePartTypeFilterMacrosType[Terrasoft.DatePartType.HOUR_MINUTE]=Terrasoft.FilterMacrosType.HOUR_EXACT,Terrasoft.filter.enums.QueryMacrosTypeFilterMacrosType={},Terrasoft.QueryMacrosTypeFilterMacrosType=Terrasoft.filter.enums.QueryMacrosTypeFilterMacrosType,Terrasoft.QueryMacrosTypeFilterMacrosType[Terrasoft.QueryMacrosType.DAY_OF_YEAR_TODAY]=Terrasoft.FilterMacrosType.DAY_OF_YEAR_TODAY,Terrasoft.QueryMacrosTypeFilterMacrosType[Terrasoft.QueryMacrosType.DAY_OF_YEAR_TODAY_PLUS_DAYS_OFFSET]=Terrasoft.FilterMacrosType.DAY_OF_YEAR_TODAY_PLUS_DAYS_OFFSET,Terrasoft.QueryMacrosTypeFilterMacrosType[Terrasoft.QueryMacrosType.NEXT_N_DAYS_OF_YEAR]=Terrasoft.FilterMacrosType.NEXT_N_DAYS_OF_YEAR,Terrasoft.QueryMacrosTypeFilterMacrosType[Terrasoft.QueryMacrosType.PREVIOUS_N_DAYS_OF_YEAR]=Terrasoft.FilterMacrosType.PREVIOUS_N_DAYS_OF_YEAR,Terrasoft.QueryMacrosTypeFilterMacrosType[Terrasoft.QueryMacrosType.PREVIOUS_HOUR]=Terrasoft.FilterMacrosType.HOUR_PREVIOUS,Terrasoft.QueryMacrosTypeFilterMacrosType[Terrasoft.QueryMacrosType.CURRENT_HOUR]=Terrasoft.FilterMacrosType.HOUR_CURRENT,Terrasoft.QueryMacrosTypeFilterMacrosType[Terrasoft.QueryMacrosType.NEXT_HOUR]=Terrasoft.FilterMacrosType.HOUR_NEXT,Terrasoft.QueryMacrosTypeFilterMacrosType[Terrasoft.QueryMacrosType.PREVIOUS_N_HOURS]=Terrasoft.FilterMacrosType.HOUR_PREVIOUS_N,Terrasoft.QueryMacrosTypeFilterMacrosType[Terrasoft.QueryMacrosType.NEXT_N_HOURS]=Terrasoft.FilterMacrosType.HOUR_NEXT_N,Terrasoft.QueryMacrosTypeFilterMacrosType[Terrasoft.QueryMacrosType.YESTERDAY]=Terrasoft.FilterMacrosType.DAY_YESTERDAY,Terrasoft.QueryMacrosTypeFilterMacrosType[Terrasoft.QueryMacrosType.TODAY]=Terrasoft.FilterMacrosType.DAY_TODAY,Terrasoft.QueryMacrosTypeFilterMacrosType[Terrasoft.QueryMacrosType.TOMORROW]=Terrasoft.FilterMacrosType.DAY_TOMORROW,Terrasoft.QueryMacrosTypeFilterMacrosType[Terrasoft.QueryMacrosType.PREVIOUS_N_DAYS]=Terrasoft.FilterMacrosType.DAY_PREVIOUS_N,Terrasoft.QueryMacrosTypeFilterMacrosType[Terrasoft.QueryMacrosType.NEXT_N_DAYS]=Terrasoft.FilterMacrosType.DAY_NEXT_N,Terrasoft.QueryMacrosTypeFilterMacrosType[Terrasoft.QueryMacrosType.PREVIOUS_WEEK]=Terrasoft.FilterMacrosType.WEEK_PREVIOUS,Terrasoft.QueryMacrosTypeFilterMacrosType[Terrasoft.QueryMacrosType.CURRENT_WEEK]=Terrasoft.FilterMacrosType.WEEK_CURRENT,Terrasoft.QueryMacrosTypeFilterMacrosType[Terrasoft.QueryMacrosType.NEXT_WEEK]=Terrasoft.FilterMacrosType.WEEK_NEXT,Terrasoft.QueryMacrosTypeFilterMacrosType[Terrasoft.QueryMacrosType.PREVIOUS_MONTH]=Terrasoft.FilterMacrosType.MONTH_PREVIOUS,Terrasoft.QueryMacrosTypeFilterMacrosType[Terrasoft.QueryMacrosType.CURRENT_MONTH]=Terrasoft.FilterMacrosType.MONTH_CURRENT,Terrasoft.QueryMacrosTypeFilterMacrosType[Terrasoft.QueryMacrosType.NEXT_MONTH]=Terrasoft.FilterMacrosType.MONTH_NEXT,Terrasoft.QueryMacrosTypeFilterMacrosType[Terrasoft.QueryMacrosType.PREVIOUS_QUARTER]=Terrasoft.FilterMacrosType.QUARTER_PREVIOUS,Terrasoft.QueryMacrosTypeFilterMacrosType[Terrasoft.QueryMacrosType.CURRENT_QUARTER]=Terrasoft.FilterMacrosType.QUARTER_CURRENT,Terrasoft.QueryMacrosTypeFilterMacrosType[Terrasoft.QueryMacrosType.NEXT_QUARTER]=Terrasoft.FilterMacrosType.QUARTER_NEXT,Terrasoft.QueryMacrosTypeFilterMacrosType[Terrasoft.QueryMacrosType.PREVIOUS_HALF_YEAR]=Terrasoft.FilterMacrosType.HALF_YEAR_PREVIOUS,Terrasoft.QueryMacrosTypeFilterMacrosType[Terrasoft.QueryMacrosType.CURRENT_HALF_YEAR]=Terrasoft.FilterMacrosType.HALF_YEAR_CURRENT,Terrasoft.QueryMacrosTypeFilterMacrosType[Terrasoft.QueryMacrosType.NEXT_HALF_YEAR]=Terrasoft.FilterMacrosType.HALF_YEAR_NEXT,Terrasoft.QueryMacrosTypeFilterMacrosType[Terrasoft.QueryMacrosType.PREVIOUS_YEAR]=Terrasoft.FilterMacrosType.YEAR_PREVIOUS,Terrasoft.QueryMacrosTypeFilterMacrosType[Terrasoft.QueryMacrosType.CURRENT_YEAR]=Terrasoft.FilterMacrosType.YEAR_CURRENT,Terrasoft.QueryMacrosTypeFilterMacrosType[Terrasoft.QueryMacrosType.NEXT_YEAR]=Terrasoft.FilterMacrosType.YEAR_NEXT,Terrasoft.QueryMacrosTypeFilterMacrosType[Terrasoft.QueryMacrosType.CURRENT_USER]=Terrasoft.FilterMacrosType.USER_CURRENT,Terrasoft.QueryMacrosTypeFilterMacrosType[Terrasoft.QueryMacrosType.CURRENT_USER_CONTACT]=Terrasoft.FilterMacrosType.CONTACT_CURRENT,Ext.define("Terrasoft.controls.FilterEdit.Filter.Input",{alternateClassName:"Terrasoft.FilterEdit.Filter.Input",filter:null,instance:null,type:null,renderTo:null,value:null,input:null,applyButton:null,applyButtonSrc:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAA2ZpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMC1jMDYxIDY0LjE0MDk0OSwgMjAxMC8xMi8wNy0xMDo1NzowMSAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wTU09Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9tbS8iIHhtbG5zOnN0UmVmPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvc1R5cGUvUmVzb3VyY2VSZWYjIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtcE1NOk9yaWdpbmFsRG9jdW1lbnRJRD0ieG1wLmRpZDpFMUU3Q0JEREI2QThFMTExOEY5MzgxMkQ3RTk0QTU5QiIgeG1wTU06RG9jdW1lbnRJRD0ieG1wLmRpZDo5MkVCNTRDQTdDRDAxMUUyOTRGRkI4NEVGNkEzNkIxNyIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDo5MkVCNTRDOTdDRDAxMUUyOTRGRkI4NEVGNkEzNkIxNyIgeG1wOkNyZWF0b3JUb29sPSJBZG9iZSBQaG90b3Nob3AgQ1M1LjEgV2luZG93cyI+IDx4bXBNTTpEZXJpdmVkRnJvbSBzdFJlZjppbnN0YW5jZUlEPSJ4bXAuaWlkOjA5NkMxNjlGNDM3QkUyMTFCNjM4Q0NBQzEzQTU4Mzg5IiBzdFJlZjpkb2N1bWVudElEPSJ4bXAuZGlkOkUxRTdDQkREQjZBOEUxMTE4RjkzODEyRDdFOTRBNTlCIi8+IDwvcmRmOkRlc2NyaXB0aW9uPiA8L3JkZjpSREY+IDwveDp4bXBtZXRhPiA8P3hwYWNrZXQgZW5kPSJyIj8+GsX69wAAAFlJREFUeNrEk0sKACAIBfX+h37RQijR/BTkUpxZ6JMB0E3xT8EEuSsQqCVYgbJgg/UOIM0sbAnIkZiwJ9BDLmydUQ8fYS8H1la5GiRk4CiJ0VX+/8IbwRBgANeePuFy2+PsAAAAAElFTkSuQmCC",cancelButton:null,cancelButtonSrc:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAA2ZpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMC1jMDYxIDY0LjE0MDk0OSwgMjAxMC8xMi8wNy0xMDo1NzowMSAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wTU09Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9tbS8iIHhtbG5zOnN0UmVmPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvc1R5cGUvUmVzb3VyY2VSZWYjIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtcE1NOk9yaWdpbmFsRG9jdW1lbnRJRD0ieG1wLmRpZDpFMUU3Q0JEREI2QThFMTExOEY5MzgxMkQ3RTk0QTU5QiIgeG1wTU06RG9jdW1lbnRJRD0ieG1wLmRpZDpDRjM3QkI4QTdDRDAxMUUyOEJDMjlGNUQ2QTJCMDRCNyIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDpDRjM3QkI4OTdDRDAxMUUyOEJDMjlGNUQ2QTJCMDRCNyIgeG1wOkNyZWF0b3JUb29sPSJBZG9iZSBQaG90b3Nob3AgQ1M1LjEgV2luZG93cyI+IDx4bXBNTTpEZXJpdmVkRnJvbSBzdFJlZjppbnN0YW5jZUlEPSJ4bXAuaWlkOjA5NkMxNjlGNDM3QkUyMTFCNjM4Q0NBQzEzQTU4Mzg5IiBzdFJlZjpkb2N1bWVudElEPSJ4bXAuZGlkOkUxRTdDQkREQjZBOEUxMTE4RjkzODEyRDdFOTRBNTlCIi8+IDwvcmRmOkRlc2NyaXB0aW9uPiA8L3JkZjpSREY+IDwveDp4bXBtZXRhPiA8P3hwYWNrZXQgZW5kPSJyIj8+iOUPRQAAAGlJREFUeNrEU1EKQCEIS+/sKTy00UdQ4WbQg+dnbsNtJBHRXkbb43wr4O6lnxOjFaDabQJmJgg43yYGXpCJIPIYQTWeV2Rk2sJKQGQqkFm4Flg9s2BpjZmFskaWNhJRFt7NTn7/jV2AAQAHiUpVoQIdeQAAAABJRU5ErkJggg==",buttonWidth:34,constructor:function(e){this.filter=e.filter,this.instance=this.filter.instance,this.type=e.dataValueType?e.dataValueType:this.instance.dataValueType,this.value=e.value,this.renderTo=e.renderTo?e.renderTo:this.filter.getRightEl(),this.setValueCallBack=e.setValue?e.setValue:this.filter.setValue,this.filter.filterEdit.on("clickOutside",this.onClickOutside,this),this.renderInput()},renderInput:function(){switch(this.filter.beforeOpenInput=this.renderTo.getHTML(),this.renderTo.setHTML(""),this.type){case Terrasoft.DataValueType.INTEGER:this.renderInteger();break;case Terrasoft.DataValueType.FLOAT:case Terrasoft.DataValueType.MONEY:this.renderFloat();break;case Terrasoft.DataValueType.GUID:case Terrasoft.DataValueType.TEXT:case Terrasoft.DataValueType.SHORT_TEXT:case Terrasoft.DataValueType.MEDIUM_TEXT:case Terrasoft.DataValueType.LONG_TEXT:case Terrasoft.DataValueType.MAXSIZE_TEXT:this.renderText();break;case Terrasoft.DataValueType.DATE_TIME:case Terrasoft.DataValueType.DATE:this.renderDate();break;case Terrasoft.DataValueType.TIME:this.renderTime();break;default:throw new Terrasoft.UnsupportedTypeException({message:Terrasoft.Resources.FilterEdit.DataValueTypeException})}},renderTime:function(){var e=this;this.input=Ext.create("Terrasoft.TimeEdit",{value:this.value,renderTo:this.renderTo,listeners:{enterkeypressed:function(t){e.setValue(t.value)},keydown:function(t,r){e.onKeyDown(t,r)}}}),this.input.getEl().focus(),this.renderApplyButton(),this.renderCancelButton()},renderDate:function(){var e=this;this.input=Ext.create("Terrasoft.DateEdit",{value:this.value,renderTo:this.renderTo,listeners:{enterkeypressed:function(t){e.setValue(t.value)},keydown:function(t,r){e.onKeyDown(t,r)}}}),this.input.getEl().focus(),this.renderApplyButton(),this.renderCancelButton()},renderText:function(){var e=this;this.input=Ext.create("Terrasoft.TextEdit",{value:this.value,renderTo:this.renderTo,listeners:{enterkeypressed:function(t){e.setValue(t.value)},keydown:function(t,r){e.onKeyDown(t,r)}}}),this.input.getEl().focus(),this.renderApplyButton(),this.renderCancelButton()},renderInteger:function(){var e=this;this.input=Ext.create("Terrasoft.IntegerEdit",{value:this.value,renderTo:this.renderTo,listeners:{enterkeypressed:function(t){e.setValue(t.value)},keydown:function(t,r){e.onKeyDown(t,r)}}}),this.input.getEl().focus(),this.renderApplyButton(),this.renderCancelButton()},renderFloat:function(){var e=this;this.input=Ext.create("Terrasoft.FloatEdit",{value:this.value,renderTo:this.renderTo,listeners:{enterkeypressed:function(t){e.setValue(t.value)},keydown:function(t,r){e.onKeyDown(t,r)}}}),this.input.getEl().focus(),this.renderApplyButton(),this.renderCancelButton()},renderApplyButton:function(){var e=this;this.applyButton=Ext.create("Terrasoft.controls.Button",{width:this.buttonWidth,style:Terrasoft.controls.ButtonEnums.style.BLUE,renderTo:this.renderTo,iconAlign:Terrasoft.controls.ButtonEnums.iconAlign.LEFT,imageConfig:{source:Terrasoft.ImageSources.URL,url:this.applyButtonSrc},listeners:{click:function(){e.setValue(e.input.value)}}})},renderCancelButton:function(){var e=this;this.cancelButton=Ext.create("Terrasoft.controls.Button",{width:this.buttonWidth,renderTo:this.renderTo,iconAlign:Terrasoft.controls.ButtonEnums.iconAlign.LEFT,imageConfig:{source:Terrasoft.ImageSources.URL,url:this.cancelButtonSrc},listeners:{click:function(){e.close()}}})},onKeyDown:function(e,t){27===t.keyCode&&(t.stopPropagation(),this.close())},onClickOutside:function(){this.setValue(this.input.value)},setValue:function(e){this.setValueCallBack.call(this.filter,e),this.close(),this.filter.filterEdit.beforeOpenInput=null},close:function(){this.destroy(),this.filter.filterEdit.beforeOpenInput=null,this.renderTo.setHTML(this.filter.beforeOpenInput),this.filter.macrosParameterDisplay(!0),this.filter.muteRightExpressionEvent=!1,this.filter.muteMacrosEvent=!1,this.filter.muteMacrosParameterEvent=!1},destroy:function(){this.input&&(this.input.destroy(),this.input=null),this.applyButton&&(this.applyButton.destroy(),this.applyButton=null),this.filter.filterEdit.un("clickOutside",this.onClickOutside,this),this.cancelButton&&(this.cancelButton.un("click",this.close,this),this.cancelButton.destroy(),this.cancelButton=null)}}),Ext.define("Terrasoft.controls.FilterEditItem",{alternateClassName:"Terrasoft.FilterEdit.Item",translate:Terrasoft.Resources.FilterEdit,filterManager:null,filterEdit:null,id:null,instance:null,enabled:!0,idPrefix:null,cssClass:{enableWrapper:"t-checkboxedit-wrap",enable:"t-checkboxedit",disable:"filteredit-disabled",checked:"t-checkboxedit-checked",del:"filteredit-item-delete"},wrapEl:null,deleteEl:null,allowedManageOperations:null,constructor:function(e){this.callParent(arguments),this.filterManager=e.filterManager,this.filterEdit=e.filterEdit,this.init(e),this.allowedManageOperations=this.getAllowedManageOperations()},getAllowedManageOperations:function(){return{}},init:Terrasoft.emptyFn,generateCheckboxConfig:function(e){var t={tag:"span",cls:this.cssClass.enableWrapper,"data-item-marker":this.getCheckboxItemMarker(),children:[{tag:"input",cls:this.cssClass.enable,type:"checkbox"}]};return this.enabled&&(t.cls+=" "+this.cssClass.checked),e.push(t),Terrasoft.deepClone(t)},getCheckboxItemMarker:Terrasoft.emptyFn,generateDeleteConfig:function(e){var t={tag:"span",cls:this.cssClass.del};return e.push(t),Terrasoft.deepClone(t)},getWrapEl:function(){return this.wrapEl||(this.wrapEl=Ext.get(this.id)),this.wrapEl},getEnableWrapEl:function(){if(!this.enableWrapEl){var e=this.getWrapEl();this.enableWrapEl=e.child("."+this.cssClass.enableWrapper)}return this.enableWrapEl},onEnableElClick:function(e){e.stopEvent();var t=this.enabled;this.setEnabled(!t)},enableFilter:function(){this.getWrapEl().removeCls(this.cssClass.disable),this.getEnableWrapEl().addCls(this.cssClass.checked),this.filterManager.setEnableFilterValueByKey(this.instance.key,!0)},disableFilter:function(){this.getWrapEl().addCls(this.cssClass.disable),this.getEnableWrapEl().removeCls(this.cssClass.checked),this.filterManager.setEnableFilterValueByKey(this.instance.key,!1)},setEnabled:function(e){this.enabled!==e&&(this.enabled=e,e?this.enableFilter():this.disableFilter())}}),Ext.define("Terrasoft.controls.FilterEdit.Filter",{extend:"Terrasoft.FilterEdit.Item",alternateClassName:"Terrasoft.FilterEdit.Filter",comparisonTranslate:Terrasoft.Resources.ComparisonType,aggregationTranslate:Terrasoft.Resources.AggregationOperation,generateTo:null,idPrefix:{rule:"-filteredit-rule-",macros:"-macros-",macrosParameter:"-macros-parameter-",cancelMacros:"cancel-macros"},cssClass:{rule:"filteredit-rule",aggregativeRule:"filteredit-aggregative-rule",del:"filteredit-rule-delete",welcomeInput:"filteredit-rule-right-welcomeinput",enableWrapper:"t-checkboxedit-wrap",enable:"t-checkboxedit",checked:"t-checkboxedit-checked",disable:"filteredit-disabled",left:"filteredit-rule-left",leftDisabled:"filteredit-rule-left-disabled",aggregation:"filteredit-rule-aggregation",comparison:"filteredit-rule-comparison",comparisonDisabled:"filteredit-rule-comparison-disabled",rightWrapper:"filteredit-rule-right-wrapper",right:"filteredit-rule-right",rightDisabled:"filteredit-rule-right-disabled",macros:"filteredit-rule-macros",macrosParameter:"filteredit-rule-macros-parameter",macrosSelection:"filteredit-rule-macros-selection",selected:"filteredit-selected"},leftEl:null,aggregationEl:null,comparisonEl:null,rightEl:null,rightWrapperEl:null,allowedMacrosTypes:null,macrosEl:null,macrosParameterEl:null,macrosSelectionEl:null,macrosParameterPlaceholder:"<?>",aggregationList:null,rightExpressionMenu:null,macrosParameterList:null,comparisonList:null,muteRightExpressionEvent:!1,muteMacrosEvent:!1,muteMacrosParameterEvent:!1,beforeOpenInput:null,constructor:function(){this.callParent(arguments),this.id=this.filterEdit.id+this.idPrefix.rule+this.instance.key,this.generateHtmlConfig()},init:function(e){var t=e.filter;this.instance=t,this.enabled=e.filter.isEnabled,this.generateTo=e.generateTo,this._applyFilterManagerSettings(t,e.filterManager),this._setFilterDefaultComparisonType(),this.allowedMacrosTypes=this.filterManager.provider.getAllowedMacrosTypes(this.instance)},_getMacrosType:function(){var e=this.instance,t=e&&e.rightExpression;return t&&t.macrosType},_getComparisonTypeSettings:function(e){var t={};if(e){var r=this._getMacrosConfig(e);r&&r.comparisonType&&(t=r.comparisonType)}return t},_setFilterDefaultComparisonType:function(){var e=this.instance,t=this._getMacrosType();if(t){var r=this._getComparisonTypeSettings(t),n=r&&r.defaultValue;n&&(e.comparisonType=n)}},_isEnableComparisonType:function(){var e=this._getMacrosType();if(e){var t=this._getComparisonTypeSettings(e);return t&&t.isEnabled}},_getMacrosConfig:function(e){var t={},r=Terrasoft.GetQueryMacrosTypeFilterMacrosType(e);return r&&(t=Terrasoft.getMacrosTypeConfig(r)||t),t},_applyFilterManagerSettings:function(e,t){if(t&&t.config){var r=t.config;if(r.columnsConfig){var n=r.columnsConfig[t.rootSchemaName];if(n){var i=n[e.leftExpression.columnPath];i&&Object.assign(e,i)}}}},getAllowedManageOperations:function(){var e=this.filterManager;if(!e)return{canViewEnabled:!0,canEditEnabled:!0,canEditLeftExpression:!0,canEditRightExpression:!0,canEditComparisonType:!0,canRemove:!0,canSelect:!0};var t=e.getAllowedFilterManageOperations(this.instance),r=this._isEnableComparisonType();return void 0!==r&&(t.canEditComparisonType=r),t},generateLeftExpressionConfig:function(e){var t=this.instance,r=Terrasoft.encodeHtml(t.leftExpressionCaption),n=this.allowedManageOperations,i=[this.cssClass.left];n.canEditLeftExpression||i.push(this.cssClass.leftDisabled);var a={tag:"span",cls:i.join(" "),html:r,"data-item-marker":r};e.push(a)},generateComparisonConfig:function(e){var t=this.instance,r=this.filterEdit.ComparisonTypeFlipped[t.comparisonType],n=Terrasoft.Resources.ComparisonType[r],i=this.allowedManageOperations.canEditComparisonType,a=[this.cssClass.comparison];i||a.push(this.cssClass.comparisonDisabled);var s={tag:"span",cls:a.join(" "),html:n,"data-item-marker":n,children:[]},o={tag:"span"};t.dataValueType===Terrasoft.DataValueType.BOOLEAN&&(o.cls="unselectable"),s.children.push(o),e.push(s)},generateRightExpressionConfig:function(e){var t=this.instance,r=this.filterEdit.filterManager.getRightExpressionDisplayValue(t),n=Terrasoft.encodeHtml(r),i=[this.cssClass.right];this.allowedManageOperations.canEditRightExpression||i.push(this.cssClass.rightDisabled),r||i.push(this.cssClass.welcomeInput);var a=[{tag:"span",cls:i.join(" "),html:r?n:this.translate.WELCOME_INPUT,"data-item-marker":n}];if(this.getIsRightExpressionMenuAllowed()){var s=this.filterManager.provider.getRightExpressionMacrosDisplayValues(t);s.hasOwnProperty("macrosCaption")&&(a=this.generateRightExpressionMacrosHtmlConfig(s))}var o={tag:"span",cls:this.cssClass.rightWrapper,children:a};e.push(o)},generateRightExpressionMacrosHtmlConfig:function(e){var t=[];if(t.push({tag:"a",href:"#",cls:this.cssClass.macros,html:Terrasoft.encodeHtml(e.macrosCaption),"data-item-marker":Terrasoft.encodeHtml(e.macrosCaption)}),e.hasOwnProperty("macrosParameterCaption")){var r=e.macrosParameterCaption,n=Ext.isEmpty(r)?this.macrosParameterPlaceholder:r,i=Terrasoft.encodeHtml(n);Ext.isNumber(i)&&(i=i.toString()),t.push({tag:"a",href:"#",cls:this.cssClass.macrosParameter,html:i})}return t},getCheckboxItemMarker:function(){var e=this.instance;return Terrasoft.encodeHtml(e.leftExpressionCaption)},generateHtmlConfig:function(){var e=this.instance.isAggregative,t=this.cssClass,r=[];this.allowedManageOperations.canViewEnabled&&this.generateCheckboxConfig(r),e?this.generateAggregateFilterHtmlConfig(r):this.generateSimpleFilterHtmlConfig(r);var n={tag:"div",id:this.id,cls:e?t.aggregativeRule:t.rule,children:r};this.filterEdit.selectedFilters.hasOwnProperty(this.id)&&(n.cls+=" "+this.cssClass.selected),this.enabled||(n.cls+=" "+this.cssClass.disable),this.generateTo.push(n)},generateSimpleFilterHtmlConfig:function(e){var t=this.instance,r=t.filterType===Terrasoft.FilterType.IS_NULL,n=t.filterType===Terrasoft.FilterType.EXISTS,i=this.allowedManageOperations;this.generateLeftExpressionConfig(e),this.generateComparisonConfig(e),r||n||this.generateRightExpressionConfig(e),i.canRemove&&this.generateDeleteConfig(e)},generateAggregateFilterHtmlConfig:function(e){var t=this.instance,r=this.cssClass;this.generateLeftExpressionConfig(e);var n=this.filterManager.getAggregationOperation(t),i=[r.aggregation];this.allowedManageOperations.canEditComparisonType||i.push(r.comparisonDisabled),e.push({tag:"a",href:"#",cls:i.join(" "),children:[{tag:"span"}],html:n,"data-item-marker":n}),t.filterType!==Terrasoft.FilterType.IS_NULL&&t.filterType!==Terrasoft.FilterType.EXISTS&&(this.generateComparisonConfig(e),this.generateRightExpressionConfig(e)),this.allowedManageOperations.canRemove&&this.generateDeleteConfig(e);var a=this.getAggregateFilterSubFilters(),s={filterEdit:this.filterEdit,filterManager:this.filterManager,groupType:a.logicalOperation,groupFilters:a,groupAggregative:!0,deletable:!1,generateTo:e},o=Ext.create("Terrasoft.FilterEdit.Group",s);this.filterEdit.renderedGroups[o.id]=o},getAggregateFilterSubFilters:function(){var e=this.instance;return e.filterType===Terrasoft.FilterType.EXISTS&&e.subFilters?e.subFilters:e.leftExpression.subFilters?e.leftExpression.subFilters:this.filterEdit.createEmptyFilterGroup()},getLeftEl:function(){if(!this.leftEl){var e=this.getWrapEl();this.leftEl=e.child("."+this.cssClass.left)}return this.leftEl},getAggregationEl:function(){if(!this.aggregationEl){var e=this.getWrapEl();this.aggregationEl=e.child("."+this.cssClass.aggregation)}return this.aggregationEl},getComparisonEl:function(){if(!this.comparisonEl){var e=this.getWrapEl();this.comparisonEl=e.child("."+this.cssClass.comparison)}return this.comparisonEl},getRightEl:function(){if(!this.rightEl){var e=this.getWrapEl();this.rightEl=e.child("."+this.cssClass.rightWrapper+" > ."+this.cssClass.right)}return this.rightEl},getMacrosEl:function(){if(!this.macrosEl){var e=this.getWrapEl();this.macrosEl=e.child("."+this.cssClass.rightWrapper+" > ."+this.cssClass.macros)}return this.macrosEl},getMacrosParameterEl:function(){if(!this.macrosParameterEl){var e=this.getWrapEl();this.macrosParameterEl=e.child("."+this.cssClass.rightWrapper+" > ."+this.cssClass.macrosParameter)}return this.macrosParameterEl},getDeleteEl:function(){if(!this.deleteEl){var e=this.getWrapEl();this.deleteEl=e.child("."+this.cssClass.del)}return this.deleteEl},initDomEvents:function(){this.initSelectDomEvent(),this.initEditLeftExpressionDomEvent(),this.initEditComparisonTypeDomEvent(),this.initEditRightExpressionDomEvent(),this.initEditEnabledDomEvent(),this.initRemoveFilterDomEvent(),this.id===this.filterEdit.openMacrosParameter&&this.openMacrosParameter()},initSelectDomEvent:function(){this.allowedManageOperations.canSelect&&this.getWrapEl().on("click",this.onWrapElClick,this)},initEditLeftExpressionDomEvent:function(){if(this.allowedManageOperations.canEditLeftExpression){this.getLeftEl().on("click",this.onLeftElClick,this);var e=this.getAggregationEl();e&&e.on("click",this.onAggregationElClick,this)}},initEditComparisonTypeDomEvent:function(){if(this.allowedManageOperations.canEditComparisonType){var e=this.getComparisonEl();e&&e.on("click",this.onComparisonElClick,this)}},initEditRightExpressionDomEvent:function(){if(this.allowedManageOperations.canEditRightExpression){var e=this.getRightEl();e&&e.on("click",this.onRightElClick,this);var t=this.getMacrosEl();t&&t.on("click",this.onMacrosElClick,this);var r=this.getMacrosParameterEl();r&&r.on("click",this.onMacrosParameterElClick,this)}},initEditEnabledDomEvent:function(){if(this.allowedManageOperations.canEditEnabled){var e=this.getEnableWrapEl();e&&e.on("click",this.onEnableElClick,this)}},initRemoveFilterDomEvent:function(){this.allowedManageOperations.canRemove&&this.getDeleteEl().on("click",this.onDeleteElClick,this)},onWrapElClick:function(e){e.stopEvent();var t=e.ctrlKey?[this]:this;this.filterEdit.setSelectedFilters(t),this.filterEdit.fireEvent("selectedFiltersChange",this,this.filterEdit.selectedFilters),this.closeOpenedInput()},onLeftElClick:function(e){e.stopEvent(),this.filterManager.addFilter(this.instance.parentCollection,this.instance)},onAggregationElClick:function(e){e.stopEvent(),this.showAggregationList(),this.closeOpenedInput()},onComparisonElClick:function(e){e.stopEvent(),this.instance.dataValueType!==Terrasoft.DataValueType.BOOLEAN&&(this.showComparisonList(),this.closeOpenedInput())},onRightElClick:function(e){if(e.stopEvent(),!this.muteRightExpressionEvent){if(this.closeOpenedInput(),this.getIsRightExpressionMenuAllowed())return this.muteRightExpressionEvent=!0,void this.showRightExpressionMenu();this.instance.dataValueType===Terrasoft.DataValueType.LOOKUP?this.filterManager.getLookupFilterValue(this.instance):this.instance.dataValueType===Terrasoft.DataValueType.BOOLEAN?this.filterManager.toggleFilterBooleanValue(this.instance):(this.muteRightExpressionEvent=!0,this.filterEdit.openedInput=Ext.create("Terrasoft.FilterEdit.Filter.Input",{filter:this,value:this.filterManager.getRightExpressionValue(this.instance)}))}},onMacrosElClick:function(e){e.stopEvent(),this.muteMacrosEvent||(this.closeOpenedInput(),this.showRightExpressionMenu())},onMacrosParameterElClick:function(e){e&&e.stopEvent(),this.muteMacrosParameterEvent||(this.closeOpenedInput(),this.openMacrosParameter())},onDeleteElClick:function(e){e.stopEvent(),this.filterEdit.clearSelected(),this.filterManager.deleteItem(this.instance)},onAggregationSelect:function(e){this.filterManager.setAggregationOperation(this.instance,e)},onMacrosSelect:function(e,t){var r=this.instance,n=this.filterManager,i=this.filterEdit,a=t.id.replace(this.id+this.idPrefix.macros,"");if(a!==this.idPrefix.cancelMacros)return i.openMacrosParameter=this.id,void n.provider.setRightExpressionValue(r,null,parseInt(a,10));if(!this.muteMacrosEvent){var s=[Terrasoft.QueryMacrosType.CURRENT_USER,Terrasoft.QueryMacrosType.CURRENT_USER_CONTACT];if(r.dataValueType===Terrasoft.DataValueType.LOOKUP||r.rightExpression&&Terrasoft.contains(s,r.rightExpression.macrosType))n.getLookupFilterValue(r);else if(r.dataValueType===Terrasoft.DataValueType.BOOLEAN)n.toggleFilterBooleanValue(r);else{this.closeOpenedInput(),this.macrosParameterDisplay(!1),this.muteRightExpressionEvent=!0,this.muteMacrosEvent=!0;var o=this.filterManager.getRightExpressionValue(this.instance);Ext.isObject(o)&&(o=null),i.openedInput=Ext.create("Terrasoft.FilterEdit.Filter.Input",{renderTo:this.getMacrosEl(),filter:this,value:o})}}},onMacrosParameterSelect:function(e,t){var r,n,i=this.filterManager.provider.getFilterMacrosConfig(this.instance),a=t.id.replace(this.id+this.idPrefix.macrosParameter,""),s=a.split("-",2);i&&(r=i.filterMacrosType,n=a),s.length>1&&(r=s[0],n=s[1]),this.filterManager.provider.setRightExpressionValue(this.instance,parseInt(n,10),parseInt(r,10))},onComparisonSelect:function(e){var t=this.filterEdit.ComparisonTypeTranslateFlipped[e],r=Terrasoft.ComparisonType[t];this.filterManager.setComparisonType(this.instance,r)},openMacrosParameter:function(){this.filterEdit.openMacrosParameter=null;var e=this.filterManager.provider.getFilterMacrosConfig(this.instance);!Ext.isEmpty(e)&&e.hasOwnProperty("value")&&(e.value.hasOwnProperty("displayValueRange")?this.showMacrosParameterList():(this.muteMacrosParameterEvent=!0,this.filterEdit.openedInput=Ext.create("Terrasoft.FilterEdit.Filter.Input",{renderTo:this.getMacrosParameterEl(),dataValueType:e.value.dataValueType,filter:this,value:this.filterManager.getRightExpressionValue(this.instance),setValue:this.setMacrosParameterValue})))},closeOpenedInput:function(){this.filterEdit.openedInput&&(this.filterEdit.openedInput.close(),this.filterEdit.openedInput=null)},showSelected:function(e){var t=this.getWrapEl();e?t.addCls(this.cssClass.selected):t.removeCls(this.cssClass.selected)},showAggregationList:function(){this.aggregationList||this.createAggregationList();var e=this.getAggregationEl().getBox();this.aggregationList.show(e)},showComparisonList:function(){this.comparisonList||this.createComparisonList();var e=this.getComparisonEl().getBox();this.comparisonList.show(e)},applyMenuItems:Terrasoft.emptyFn,showRightExpressionMenu:function(){if(!this.rightExpressionMenu){var e=this.getMacrosMenuItems();this.applyMenuItems(e),this.rightExpressionMenu=Ext.create("Terrasoft.Menu",{items:e}),this.rightExpressionMenu.on("hide",(function(){this.muteRightExpressionEvent=!1}),this)}var t=this.getRightEl(),r=this.getMacrosEl(),n=r||t;if(n){var i=n.getBox(),a=this.filterEdit.rightExpressionMenuAligned?this.getWrapEl():null;this.rightExpressionMenu.show(i,!1,a)}},onProcessParameterSelected:function(e,t){if(e.filterType===Terrasoft.FilterType.IN)return t.Id=t.id||Terrasoft.generateGUID(),void this.filterManager.setRightExpressionsValues(e,[t],Terrasoft.DataValueType.MAPPING);this.filterManager.setRightExpressionValue(e,t,null,Terrasoft.DataValueType.MAPPING)},_onMainRecordColumnSelected:function(e,t){e.filterType===Terrasoft.FilterType.IN?(t.Id=t.id||Terrasoft.generateGUID(),this.filterManager.setRightExpressionsValues(e,[t],Terrasoft.DataValueType.LOOKUP)):this.filterManager.setRightExpressionValue(e,t,null,Terrasoft.DataValueType.LOOKUP)},showMacrosParameterList:function(){this.macrosParameterList||this.createMacrosParameterList();var e=this.getMacrosParameterEl().getBox();this.macrosParameterList.show(e)},createAggregationList:function(){for(var e=this.filterManager.getAllowedAggregationOperations(this.instance),t=[],r=this,n=function(e,t){r.onAggregationSelect(t.caption)},i=0,a=e.length;i<a;i+=1)t.push({caption:e[i],handler:n});return this.aggregationList=Ext.create("Terrasoft.Menu",{items:t}),this.aggregationList},createComparisonList:function(){for(var e=this.filterManager.getAllowedComparisonTypes(this.instance),t=[],r=this,n=function(e,t){r.onComparisonSelect(t.caption)},i=0,a=e.length;i<a;i+=1){var s=this.filterEdit.ComparisonTypeFlipped[e[i]];t.push({caption:this.comparisonTranslate[s],handler:n})}return this.comparisonList=Ext.create("Terrasoft.Menu",{items:t}),this.comparisonList},getMacrosMenuItems:function(){var e=this.allowedMacrosTypes;e||(e=[]);var t={},r=[],n=[],i=!1,a=this,s=function(e,t){a.onMacrosSelect(e,t)},o=function(e,t){a.onMacrosParameterSelect(e,t)},l=this.getCancelMacrosCaption();return r=r.concat({id:this.id+this.idPrefix.macros+this.idPrefix.cancelMacros,caption:l,handler:s},{className:"Terrasoft.MenuSeparator"}),Terrasoft.each(e,(function(e){var a=this.filterManager.provider.getMacrosTypeConfig(e),l=this.id+this.idPrefix.macros+e,c=a.caption,u=[];if(a.hasOwnProperty("groupCaption")){if(!t.hasOwnProperty(a.groupCaption)){i=!1;var h={caption:a.groupCaption,menu:{items:[]}};r.push(h),t[a.groupCaption]=h.menu.items}if(a.hasOwnProperty("value")&&(c=a.caption+" "+this.macrosParameterPlaceholder,i||(t[a.groupCaption].push({className:"Terrasoft.MenuSeparator"}),i=!0),a.value.hasOwnProperty("displayValueRange")))for(var f=a.value.displayValueRange,d=0,p=f.length;d<p;d+=1){var m=this.id+this.idPrefix.macrosParameter+e+"-"+d;u.push({id:m,caption:f[d],handler:o})}var g={id:l,caption:c,handler:s};u.length&&(g.menu={items:u}),t[a.groupCaption].push(g)}else n.push({id:l,caption:c,handler:s})}),this),r=r.concat({className:"Terrasoft.MenuSeparator"},n)},getCancelMacrosCaption:function(){var e=this.instance.dataValueType,t=this.instance.referenceSchemaName,r=this.translate.CANCEL_MACROS_DEFAULT;return Terrasoft.isDateDataValueType(e)&&(r=this.translate.CANCEL_MACROS_DATE),"Contact"===t&&(r=this.translate.CANCEL_MACROS_CONTACT),r},createMacrosParameterList:function(){for(var e=this.filterManager.provider.getFilterMacrosConfig(this.instance),t=[],r=this,n=function(e,t){r.onMacrosParameterSelect(e,t)},i=e.value.displayValueRange,a=0,s=i.length;a<s;a+=1){var o=this.id+this.idPrefix.macrosParameter+a;t.push({id:o,caption:i[a],handler:n})}return this.macrosParameterList=Ext.create("Terrasoft.Menu",{items:t}),this.macrosParameterList},setValue:function(e){this.filterManager.setRightExpressionValue(this.instance,e)},setMacrosParameterValue:function(e){this.filterEdit.openMacrosParameter=null;var t=this.filterManager.provider.getFilterMacrosConfig(this.instance);this.filterManager.provider.setRightExpressionValue(this.instance,e,t.filterMacrosType)},macrosParameterDisplay:function(e){var t=this.getMacrosParameterEl();Ext.isEmpty(t)||(!1===e?t.addCls("filteredit-hidden"):t.removeCls("filteredit-hidden"))},getIsRightExpressionMenuAllowed:function(){return this.allowedMacrosTypes&&this.allowedMacrosTypes.length>0},destroy:function(){this.destroyDeleteElement(),this.destroyMacrosElements(),this.destroyFilterElements(),this.getWrapEl().removeAllListeners()},destroyAggregationList:function(){this.aggregationList&&this.aggregationList.destroy()},destroyComparisonList:function(){this.comparisonList&&this.comparisonList.destroy()},destroyRightExpressionMenu:function(){this.rightExpressionMenu&&this.rightExpressionMenu.destroy()},destroyMacrosParameterList:function(){this.macrosParameterList&&this.macrosParameterList.destroy()},destroyDeleteElement:function(){var e=this.getDeleteEl();e&&Ext.removeNode(e.dom)},destroyMacrosElements:function(){this.destroyMacrosParameterList(),this.destroyMacrosParameterElement(),this.destroyMacrosElement()},destroyMacrosParameterElement:function(){var e=this.getMacrosParameterEl();e&&Ext.removeNode(e)},destroyMacrosElement:function(){var e=this.getMacrosEl();e&&Ext.removeNode(e)},destroyFilterElements:function(){this.destroyFilterLeftExpressionElement(),this.destroyFilterComparisionTypeElement(),this.destroyFilterRightExpressionElement(),this.destroyFilterAggregationElement()},destroyFilterLeftExpressionElement:function(){var e=this.getLeftEl();Ext.removeNode(e.dom)},destroyFilterComparisionTypeElement:function(){this.destroyComparisonList();var e=this.getComparisonEl();e&&Ext.removeNode(e.dom)},destroyFilterRightExpressionElement:function(){this.destroyRightExpressionMenu();var e=this.getRightEl();e&&Ext.removeNode(e.dom)},destroyFilterAggregationElement:function(){this.destroyAggregationList();var e=this.getAggregationEl();e&&Ext.removeNode(e.dom)}}),Ext.define("Terrasoft.controls.FilterEdit.Group",{extend:"Terrasoft.FilterEdit.Item",alternateClassName:"Terrasoft.FilterEdit.Group",idPrefix:{group:"-filteredit-group-"},cssClass:{group:"filteredit-group",aggregativeGroup:"filteredit-aggregative-group",type:"filteredit-group-type",groupTypeHidden:"filteredit-group-type-hidden",groupTypeDisabled:"filteredit-group-type-disabled",enableWrapper:"t-checkboxedit-wrap",enable:"t-checkboxedit",disable:"filteredit-disabled",checked:"t-checkboxedit-checked",rules:"filteredit-group-rules",add:"filteredit-group-rules-add",del:"filteredit-group-delete",selected:"filteredit-selected"},deletable:!0,groupAggregative:!1,typeEl:null,typeSpaceEl:null,addEl:null,constructor:function(){this.callParent(arguments),this.id=this.filterEdit.id+this.idPrefix.group+this.instance.key,this.generateHtmlConfig()},init:function(e){this.instance=e.groupFilters,this.enabled=e.groupFilters.isEnabled,this.deletable="undefined"!==Ext.typeOf(e.deletable)?e.deletable:this.deletable,this.groupType=e.groupType,this.groupAggregative=e.groupAggregative,this.generateTo=e.generateTo},getAllowedManageOperations:function(){var e=this.filterManager;return e?e.getAllowedFilterGroupManageOperations(this.instance):{canViewEnabled:!0,canEditEnabled:!0,canRemove:!0,canAddFilters:!0,canViewGroupType:!0,canEditGroupType:!0,canSelect:!0}},generateTypeConfig:function(e){var t=this.allowedManageOperations,r=[this.cssClass.type];t.canViewGroupType||r.push(this.cssClass.groupTypeHidden),t.canEditGroupType||r.push(this.cssClass.groupTypeDisabled);var n={tag:"span",cls:r.join(" "),children:[]};if(this.allowedManageOperations.canViewGroupType){var i=this.filterEdit.LogicalOperatorTypeFlipped[this.groupType],a=Terrasoft.Resources.LogicalOperatorType[i];n.children.push({tag:"span",html:a})}e.push(n)},generateRulesListConfig:function(e){var t=this.generateFilterGroupItemsHtmlConfig(),r={tag:"div",cls:this.cssClass.rules,children:[{tag:"div",cls:"filteredit-group-rules-list",children:t}]};this.allowedManageOperations.canAddFilters&&r.children.push({tag:"span",cls:this.cssClass.add,html:this.translate.ADD_FILTER}),e.push(r)},generateFilterGroupItemsHtmlConfig:function(){var e=this.instance,t=[];return e.each((function(e){e.filterType===Terrasoft.FilterType.FILTER_GROUP?this.generateChildFilterEditGroupItem(e,t):this.generateChildFilterEditFilterItem(e,t)}),this),t},generateChildFilterEditGroupItem:function(e,t){var r=Ext.create("Terrasoft.FilterEdit.Group",{filterEdit:this.filterEdit,filterManager:this.filterManager,groupFilters:e,groupType:e.logicalOperation,generateTo:t});this.filterEdit.renderedGroups[e.key]=r},generateChildFilterEditFilterItem:function(e,t){var r=this.filterEdit.getFilterEditConfig().filterClassName,n=Ext.create(r,{filterEdit:this.filterEdit,filterManager:this.filterManager,filter:e,generateTo:t});this.filterEdit.renderedFilters[e.key]=n},generateDeleteConfig:function(e){var t={tag:"a",href:"#",cls:this.cssClass.del};return e.push(t),Terrasoft.deepClone(t)},generateHtmlConfig:function(){var e=this.cssClass,t=this.allowedManageOperations,r=[];this.generateTypeConfig(r),this.deletable&&t.canRemove&&this.generateDeleteConfig(r),this.generateRulesListConfig(r),t.canViewEnabled&&this.generateCheckboxConfig(r);var n=[e.group];this.enabled||n.push(e.disable),this.groupAggregative&&n.push(e.aggregativeGroup),this.filterEdit.selectedFilters.hasOwnProperty(this.id)&&n.push(e.selected);var i={tag:"div",id:this.id,cls:n.join(" "),children:r};this.generateTo.push(i)},getTypeEl:function(){if(!this.typeEl){var e=this.getWrapEl();this.typeEl=e.child("."+this.cssClass.type+" span")}return this.typeEl},getTypeSpaceEl:function(){if(!this.typeSpaceEl){var e=this.getWrapEl();this.typeSpaceEl=e.child("."+this.cssClass.type)}return this.typeSpaceEl},getDeleteEl:function(){if(!this.deleteEl){var e=this.getWrapEl();this.deleteEl=e.child("."+this.cssClass.del)}return this.deleteEl},getAddEl:function(){if(!this.addEl){var e=this.getWrapEl();this.addEl=e.child("."+this.cssClass.rules+" > ."+this.cssClass.add)}return this.addEl},initDomEvents:function(){var e=this.getWrapEl();e&&(e.on("click",this.onWrapElClick,this),this.initEditGroupTypeDomEvent(),this.initGroupSelectionDomEvent(),this.initEditEnabledDomEvent(),this.initDeleteFilterGroupDomEvent(),this.initAddFilterDomEvent())},initEditGroupTypeDomEvent:function(){if(this.allowedManageOperations.canEditGroupType){var e=this.getTypeEl();e&&e.on("click",this.onTypeElClick,this)}},initEditEnabledDomEvent:function(){if(this.allowedManageOperations.canEditEnabled){var e=this.getEnableWrapEl();e&&e.on("click",this.onEnableElClick,this)}},initGroupSelectionDomEvent:function(){if(this.allowedManageOperations.canSelect){var e=this.getTypeSpaceEl();e&&e.on("click",this.onTypeSpaceElClick,this)}},initDeleteFilterGroupDomEvent:function(){this.deletable&&this.allowedManageOperations.canRemove&&this.getDeleteEl().on("click",this.onDeleteElClick,this)},initAddFilterDomEvent:function(){this.allowedManageOperations.canAddFilters&&this.getAddEl().on("click",this.onAddClick,this)},onWrapElClick:function(e){e.stopEvent()},onTypeElClick:function(e){e.stopEvent(),this.filterManager.toggleFilterGroupLogicalOperation(this.instance),this.filterEdit.update()},onTypeSpaceElClick:function(e){e.stopEvent();var t=e.ctrlKey?[this]:this;this.filterEdit.setSelectedFilters(t),e.ctrlKey?this.filterEdit.fireEvent("selectedFiltersChange",this.instance):this.filterEdit.fireEvent("selectedFiltersChange")},onDeleteElClick:function(e){e.stopEvent(),this.filterEdit.clearSelected(),this.filterManager.deleteItem(this.instance),this.filterEdit.update()},onAddClick:function(e){e.stopEvent(),this.filterManager.addFilter(this.instance)},showSelected:function(e){var t=this.getWrapEl();e?t.addCls(this.cssClass.selected):t.removeCls(this.cssClass.selected)},destroy:function(){var e=this.getWrapEl();e&&(this.destroyGroupTypeElement(),this.destroyEnableGroupElement(),this.destroyDeleteElement(),this.destroyAddFilterElement(),e.removeAllListeners())},destroyGroupTypeElement:function(){if(this.allowedManageOperations.canViewGroupType){var e=this.getTypeSpaceEl();Ext.removeNode(e);var t=this.getTypeEl();Ext.removeNode(t)}},destroyEnableGroupElement:function(){if(this.allowedManageOperations.canEditEnabled){var e=this.getEnableWrapEl();Ext.removeNode(e)}},destroyDeleteElement:function(){if(this.allowedManageOperations.canRemove){var e=this.getDeleteEl();Ext.removeNode(e)}},destroyAddFilterElement:function(){if(this.allowedManageOperations.canAddFilters){var e=this.getAddEl();Ext.removeNode(e)}}}),Ext.define("Terrasoft.data.expressions.BaseExpression",{extend:"Terrasoft.core.collections.ObjectCollectionItem",alternateClassName:"Terrasoft.BaseExpression",expressionType:Terrasoft.ExpressionType.SCHEMA_COLUMN,datePartType:Terrasoft.DatePartType.NONE,isBlock:!1,getSerializableObject:function(e){this.callParent(arguments),e.expressionType=this.expressionType,this.isBlock&&(e.isBlock=this.isBlock)}}),Ext.define("Terrasoft.data.expressions.ColumnExpression",{extend:"Terrasoft.data.expressions.BaseExpression",alternateClassName:"Terrasoft.ColumnExpression",expressionType:Terrasoft.ExpressionType.SCHEMA_COLUMN,columnPath:"",getSerializableObject:function(e){this.callParent(arguments),e.columnPath=this.columnPath}}),Ext.define("Terrasoft.data.columns.EntityQueryColumn",{extend:"Terrasoft.BaseQueryColumn",alternateClassName:"Terrasoft.EntityQueryColumn",columnPath:"",initExpression:function(){this.callParent(arguments),this.expression=Ext.create("Terrasoft.ColumnExpression",{columnPath:this.columnPath})}}),Ext.define("Terrasoft.data.expressions.FunctionExpression",{extend:"Terrasoft.BaseExpression",alternateClassName:"Terrasoft.FunctionExpression",expressionType:Terrasoft.ExpressionType.FUNCTION,functionType:Terrasoft.FunctionType.NONE,macrosType:Terrasoft.QueryMacrosType.NONE,aggregationType:Terrasoft.AggregationType.NONE,aggregationEvalType:Terrasoft.AggregationEvalType.NONE,datePartType:Terrasoft.DatePartType.NONE,functionArgument:null,functionArguments:null,getSerializableObject:function(e){if(this.callParent(arguments),!this.functionType)throw new Terrasoft.InvalidObjectState("FunctionExpression.functionType === NONE");e.functionType=this.functionType,this.functionArgument&&(e.functionArgument=this.getSerializableProperty(this.functionArgument)),this.macrosType&&(e.macrosType=this.macrosType),this.datePartType&&(e.datePartType=this.datePartType),this.aggregationType&&(e.aggregationType=this.aggregationType),this.aggregationEvalType&&(e.aggregationEvalType=this.aggregationEvalType)}}),Ext.define("Terrasoft.data.columns.FunctionQueryColumn",{extend:"Terrasoft.BaseQueryColumn",alternateClassName:"Terrasoft.FunctionQueryColumn",functionType:Terrasoft.FunctionType.NONE,macrosType:Terrasoft.QueryMacrosType.NONE,aggregationType:Terrasoft.AggregationType.NONE,aggregationEvalType:Terrasoft.AggregationEvalType.NONE,datePartType:Terrasoft.DatePartType.NONE,columnPath:"",macrosValue:null,functionArgument:null,functionArguments:null,initExpression:function(){this.callParent(arguments),null===this.functionArgument&&(Ext.isEmpty(this.columnPath)?null!==this.macrosValue&&(this.functionArgument=Ext.create("Terrasoft.ParameterExpression",{parameterValue:this.macrosValue})):this.functionArgument=Ext.create("Terrasoft.ColumnExpression",{columnPath:this.columnPath})),this.expression=Ext.create("Terrasoft.FunctionExpression",{functionType:this.functionType,macrosType:this.macrosType,datePartType:this.datePartType,aggregationType:this.aggregationType,aggregationEvalType:this.aggregationEvalType,functionArgument:this.functionArgument})}}),Ext.define("Terrasoft.data.expressions.SubQueryExpression",{extend:"Terrasoft.BaseExpression",alternateClassName:"Terrasoft.SubQueryExpression",expressionType:Terrasoft.ExpressionType.SUBQUERY,aggregationType:Terrasoft.AggregationType.NONE,columnPath:"",subFilters:null,constructor:function(){this.callParent(arguments),this.subFilters=this.subFilters||Ext.create("Terrasoft.FilterGroup")},getSerializableObject:function(e){this.callParent(arguments),e.aggregationType=this.aggregationType,e.columnPath=this.columnPath,this.subFilters.getCount()>0?e.subFilters=this.getSerializableProperty(this.subFilters):e.subFilters=null}}),Ext.define("Terrasoft.data.columns.SubQueryColumn",{extend:"Terrasoft.BaseQueryColumn",alternateClassName:"Terrasoft.SubQueryColumn",columnPath:"",aggregationType:Terrasoft.AggregationType.NONE,subFilters:null,initExpression:function(){this.callParent(arguments),this.expression=Ext.create("Terrasoft.SubQueryExpression",{aggregationType:this.aggregationType,columnPath:this.columnPath,subFilters:this.subFilters})}}),Ext.define("Terrasoft.data.expressions.ArithmeticExpression",{extend:"Terrasoft.BaseExpression",alternateClassName:"Terrasoft.ArithmeticExpression",expressionType:Terrasoft.ExpressionType.ARITHMETIC_OPERATION,arithmeticOperation:null,leftArithmeticOperand:null,rightArithmeticOperand:null,getSerializableObject:function(e){this.callParent(arguments),e.arithmeticOperation=this.arithmeticOperation,e.leftArithmeticOperand=this.getSerializableProperty(this.leftArithmeticOperand),e.rightArithmeticOperand=this.getSerializableProperty(this.rightArithmeticOperand)}}),Ext.define("Terrasoft.data.columns.ArithmeticQueryColumn",{extend:"Terrasoft.BaseQueryColumn",alternateClassName:"Terrasoft.ArithmeticQueryColumn",arithmeticOperation:null,leftArithmeticOperand:null,rightArithmeticOperand:null,initExpression:function(){this.callParent(arguments),this.expression=Ext.create("Terrasoft.ArithmeticExpression",{arithmeticOperation:this.arithmeticOperation,leftArithmeticOperand:this.leftArithmeticOperand,rightArithmeticOperand:this.rightArithmeticOperand})}}),Ext.define("Terrasoft.data.expressions.AggregationQueryExpression",{extend:"Terrasoft.BaseExpression",alternateClassName:"Terrasoft.AggregationQueryExpression",expressionType:Terrasoft.ExpressionType.SUBQUERY,functionType:Terrasoft.FunctionType.AGGREGATION,aggregationType:Terrasoft.AggregationType.NONE,columnPath:"",subFilters:null,constructor:function(){this.callParent(arguments),this.subFilters||(this.subFilters=Ext.create("Terrasoft.FilterGroup"))},getSerializableObject:function(e){this.callParent(arguments),e.functionType=this.functionType,e.aggregationType=this.aggregationType,e.columnPath=this.columnPath,e.subFilters=this.getSerializableProperty(this.subFilters)}}),Ext.define("Terrasoft.data.columns.AggregationQueryColumn",{extend:"Terrasoft.BaseQueryColumn",alternateClassName:"Terrasoft.AggregationQueryColumn",aggregationType:Terrasoft.AggregationType.NONE,subFilters:null,columnPath:"",initExpression:function(){this.callParent(arguments),this.expression=Ext.create("Terrasoft.AggregationQueryExpression",{aggregationType:this.aggregationType,columnPath:this.columnPath,subFilters:this.subFilters})}}),Ext.define("Terrasoft.data.filters.Parameter",{extend:"Terrasoft.ObjectCollectionItem",alternateClassName:"Terrasoft.Parameter",dataValueType:Terrasoft.DataValueType.TEXT,value:null,dateValue:null,arrayValue:null,constructor:function(){this.callParent(arguments),this.addEvents("change"),this.setDataValueType(this.dataValueType),this.setValue(this.value)},getSerializableObject:function(e,t){this.callParent(arguments),e.dataValueType=this.dataValueType;var r=this.value;this.dataValueType!==Terrasoft.DataValueType.LOOKUP&&this.dataValueType!==Terrasoft.DataValueType.IMAGELOOKUP||t.serializeFilterManagerInfo||(r=Ext.isObject(r)?r.value:r),t.serializeFilterManagerInfo&&this.dateValue?(e.dateValue=this.dateValue,e.value=Terrasoft.encodeDate(this.dateValue)):this.dataValueType===Terrasoft.DataValueType.BLOB||this.dataValueType===Terrasoft.DataValueType.IMAGE?Ext.isArray(r)?e.arrayValue=r:e.arrayValue=Ext.isEmpty(r)?[]:Terrasoft.convertStringToBlobArray(r):(Ext.isDate(r)&&(r=Terrasoft.encodeDate(r)),e.value=r)},setDataValueType:function(e){this.dataValueType!==e&&(this.dataValueType=e,this.fireEvent("change",this,this))},setValue:function(e){Ext.isDate(e)&&(this.dateValue=e),this.value!==e&&(this.value=e,this.fireEvent("change",this,this))},getValue:function(){return this.value}}),Ext.define("Terrasoft.data.expressions.ParameterExpression",{extend:"Terrasoft.data.expressions.BaseExpression",alternateClassName:"Terrasoft.ParameterExpression",expressionType:Terrasoft.ExpressionType.PARAMETER,parameterDataType:Terrasoft.DataValueType.TEXT,parameterValue:null,parameter:null,parentFilter:null,constructor:function(){this.callParent(arguments),void 0===this.parameterDataType&&(this.parameterDataType=Terrasoft.DataValueType.TEXT),this.initParameter(this.parameterValue,this.parameterDataType)},onParameterChange:function(){var e=this.parentFilter;e&&e.getParentFilters().filterChanged(e)},getSerializableObject:function(e){this.callParent(arguments),e.parameter=this.getSerializableProperty(this.parameter)},initParameter:function(e,t){null===this.parameter&&(this.parameter=Ext.create("Terrasoft.Parameter",{dataValueType:t,value:e})).on("change",this.onParameterChange,this)},onDestroy:function(){var e=this.parameter;e&&(e.un("change",this.onParameterChange,this),e.destroy(),delete this.parameter),this.callParent(arguments)}}),Ext.define("Terrasoft.data.filters.BaseFilter",{extend:"Terrasoft.ObjectCollectionItem",alternateClassName:"Terrasoft.BaseFilter",filterType:Terrasoft.FilterType.NONE,leftExpression:null,comparisonType:Terrasoft.ComparisonType.EQUAL,isAggregative:!1,isEnabled:!0,trimDateTimeParameterToDate:!1,dataValueType:Terrasoft.DataValueType.TEXT,leftExpressionCaption:"",referenceSchemaName:"",key:"",constructor:function(){this.callParent(arguments),this.addEvents("leftExpressionChange","comparisonTypeChange"),this.setLeftExpression(this.leftExpression)},getSerializableObject:function(e,t){if(this.callParent(arguments),e.filterType=this.filterType,e.comparisonType=this.comparisonType,e.isEnabled=this.isEnabled,e.trimDateTimeParameterToDate=this.trimDateTimeParameterToDate,e.leftExpression=this.getSerializableProperty(this.leftExpression),t.serializeFilterManagerInfo){e.isAggregative=this.isAggregative,e.key=this.key,e.dataValueType=this.dataValueType,e.leftExpressionCaption=this.leftExpressionCaption;var r=this.referenceSchemaName;Ext.isEmpty(r)||(e.referenceSchemaName=r)}},getIsCompleted:function(){return Ext.isObject(this.leftExpression)},setComparisonType:function(e){this.comparisonType!==e&&(this.comparisonType=e,this.fireEvent("comparisonTypeChange",this,this))},setLeftExpression:function(e){e&&(e.parentFilter=this),this.leftExpression=e,this.fireEvent("leftExpressionChange",this,this)},getParentFilters:function(){return this.parentCollection},getIsEquals:function(){throw new Terrasoft.NotImplementedException},getIsEnabled:function(){return this.isEnabled},updateLeftExpressionCaption:function(e){var t=e.leftExpressionCaption;if(new RegExp("\\.Id$","ig").test(t)){var r=t.split(".");t=(r=r.slice(0,r.length-1)).join(".")}this.leftExpressionCaption=t},updateCaptionForInnerCollection:function(e,t){0!==e.getCount()&&t&&e.each((function(e){var r=t[e.key];r&&e.updateLeftExpressionCaption(r)}),this)}}),Ext.define("Terrasoft.data.filters.CompareFilter",{extend:"Terrasoft.BaseFilter",alternateClassName:"Terrasoft.CompareFilter",filterType:Terrasoft.FilterType.COMPARE,rightExpression:null,subFilters:null,constructor:function(){this.callParent(arguments),this.addEvents("rightExpressionChange"),this.setRightExpression(this.rightExpression),this.setSubFilter(this.leftExpression)},getSerializableObject:function(e){this.callParent(arguments),this.leftExpression&&this.leftExpression.datePartType&&this.leftExpression.datePartType!==Terrasoft.DatePartType.NONE&&(e.leftExpression.datePartType=this.leftExpression.datePartType),e.rightExpression=this.getSerializableProperty(this.rightExpression),Terrasoft.Features.getIsDisabled("DisableForceUpdateCaptionForLeftExpression")&&this.subFilters&&(e.subFilters=this.getSerializableProperty(this.subFilters))},setSubFilter:function(e){e&&e.subFilters&&(this.subFilters=e.subFilters)},getIsCompleted:function(){var e=this.callParent(arguments);if(e){var t=this.rightExpression;if(e=e&&Ext.isObject(t),t instanceof Terrasoft.ParameterExpression){var r=t.parameter,n=r.getValue(),i=null==n;e=e&&!1===i}}return e},setRightExpression:function(e){e&&(e.parentFilter=this),this.rightExpression=e,this.fireEvent("rightExpressionChange",this,this)},updateLeftExpressionCaption:function(e){this.callParent(arguments),this.subFilters&&e.subFilters&&this.updateCaptionForInnerCollection(this.subFilters,e.subFilters.items)}}),Ext.define("Terrasoft.data.filters.ExistsFilter",{extend:"Terrasoft.BaseFilter",alternateClassName:"Terrasoft.ExistsFilter",filterType:Terrasoft.FilterType.EXISTS,comparisonType:Terrasoft.ComparisonType.EXISTS,subFilters:null,isAggregative:!0,constructor:function(){this.callParent(arguments),this.subFilters||(this.subFilters=Ext.create("Terrasoft.FilterGroup"))},getIsCompleted:function(){return!0},getSerializableObject:function(e){this.callParent(arguments),e.subFilters=this.getSerializableProperty(this.subFilters)},updateLeftExpressionCaption:function(e){this.callParent(arguments),this.subFilters&&e.subFilters&&!this.subFilters.isEmpty()&&this.updateCaptionForInnerCollection(this.subFilters,e.subFilters.items)}}),Ext.define("Terrasoft.data.filters.BetweenFilter",{extend:"Terrasoft.BaseFilter",alternateClassName:"Terrasoft.BetweenFilter",filterType:Terrasoft.FilterType.BETWEEN,comparisonType:Terrasoft.ComparisonType.BETWEEN,rightLessExpression:null,rightGreaterExpression:null,constructor:function(){this.callParent(arguments),this.setRightLessExpression(this.rightLessExpression),this.setRightGreaterExpression(this.rightGreaterExpression)},getSerializableObject:function(e){this.callParent(arguments),e.rightLessExpression=this.getSerializableProperty(this.rightLessExpression),e.rightGreaterExpression=this.getSerializableProperty(this.rightGreaterExpression)},getIsCompleted:function(){var e=this.callParent(arguments);if(e){var t=this.rightLessExpression;if(e=e&&Ext.isObject(t),t instanceof Terrasoft.ParameterExpression){var r=t.parameter;e=e&&!Ext.isEmpty(r.getValue())}var n=this.rightGreaterExpression;if(e=e&&Ext.isObject(n),n instanceof Terrasoft.ParameterExpression){var i=n.parameter;e=e&&!Ext.isEmpty(i.getValue())}}return e},setRightLessExpression:function(e){e&&(e.parentFilter=this),this.rightLessExpression=e},setRightGreaterExpression:function(e){e&&(e.parentFilter=this),this.rightGreaterExpression=e}}),Ext.define("Terrasoft.data.filters.IsNullFilter",{extend:"Terrasoft.data.filters.BaseFilter",alternateClassName:"Terrasoft.IsNullFilter",filterType:Terrasoft.FilterType.IS_NULL,comparisonType:Terrasoft.ComparisonType.IS_NULL,isNull:!0,getSerializableObject:function(e){this.callParent(arguments),e.isNull=e.comparisonType===Terrasoft.ComparisonType.IS_NULL},getIsEquals:function(e){var t=!!e;return t=(t=(t=t&&e instanceof Terrasoft.IsNullFilter)&&this.filterType===e.filterType)&&e.isNull}}),Ext.define("Terrasoft.data.filters.InFilter",{extend:"Terrasoft.data.filters.BaseFilter",alternateClassName:"Terrasoft.InFilter",filterType:Terrasoft.FilterType.IN,comparisonType:Terrasoft.ComparisonType.EQUAL,rightExpressions:null,constructor:function(){this.callParent(arguments),this.addEvents("rightExpressionsChange"),this.setRightExpressions(this.rightExpressions)},getIsFilterLeftExpressionEquals:function(e,t){if(Terrasoft.isEmptyObject(e)&&Terrasoft.isEmptyObject(t))return!0;var r=e.expressionType===t.expressionType;return r=r&&e.columnPath===t.columnPath},getFilterExpressionParameterValueMap:function(e){return e?e.map((function(e){var t=e.parameter.value;return Ext.isObject(t)?t.value:t})):[]},getIsFilterRightExpressionEquals:function(e,t){return e=this.getFilterExpressionParameterValueMap(e),t=this.getFilterExpressionParameterValueMap(t),0===e.length&&0===t.length||Terrasoft.some(e,(function(e){return Terrasoft.contains(t,e)}),this)},getSerializableObject:function(e){this.callParent(arguments);var t=e.rightExpressions=[],r=this.rightExpressions;r&&r.length>0&&Terrasoft.each(r,(function(e){t.push(this.getSerializableProperty(e))}),this)},getIsCompleted:function(){var e=this.callParent(arguments);if(e){var t=this.rightExpressions;if(e=Ext.isArray(t)){var r=t[0];if(e=Ext.isObject(r),r instanceof Terrasoft.ParameterExpression){var n=r.parameter;e=e&&!Ext.isEmpty(n.getValue())}}}return e},setRightExpressions:function(e){if(e&&!Ext.isArray(e))throw new Terrasoft.UnsupportedTypeException;Terrasoft.each(e,(function(e){e.parentFilter=this}),this),this.rightExpressions=e,this.fireEvent("rightExpressionsChange",this,this)},getIsEquals:function(e){var t=!!e;return t=(t=(t=(t=(t=(t=(t=(t=(t=t&&e instanceof Terrasoft.InFilter)&&this.isNull===e.isNull)&&this.isEnabled===e.isEnabled)&&this.filterType===e.filterType)&&this.dataValueType===e.dataValueType)&&this.comparisonType===e.comparisonType)&&this.referenceSchemaName===e.referenceSchemaName)&&this.getIsFilterLeftExpressionEquals(this.leftExpression,e.leftExpression))&&this.getIsFilterRightExpressionEquals(this.rightExpressions,e.rightExpressions)}}),Ext.define("Terrasoft.data.filters.FilterGroup",{extend:"Terrasoft.ObjectCollection",alternateClassName:"Terrasoft.FilterGroup",itemKeyTemplate:"filter",logicalOperation:Terrasoft.LogicalOperatorType.AND,isEnabled:!0,filterType:Terrasoft.FilterType.FILTER_GROUP,key:"",rootSchemaName:"",constructor:function(){this.callParent(arguments),this.addEvents("changeItem","logicalOperationChanged")},getUniqueKey:function(){return Terrasoft.generateFilterKey()},subscribeForItemEvents:function(e){var t=e.filterType;t===Terrasoft.FilterType.FILTER_GROUP?e.on("logicalOperationChanged",this.filterChanged,this):(e.on("leftExpressionChange",this.filterChanged,this),e.on("comparisonTypeChange",this.filterChanged,this),t===Terrasoft.FilterType.COMPARE?e.on("rightExpressionChange",this.filterChanged,this):t===Terrasoft.FilterType.IN&&e.on("rightExpressionsChange",this.filterChanged,this))},unSubscribeForItemEvents:function(e){var t=e.filterType;t===Terrasoft.FilterType.FILTER_GROUP?e.un("logicalOperationChanged",this.filterChanged,this):(e.un("leftExpressionChange",this.filterChanged,this),e.un("comparisonTypeChange",this.filterChanged,this),t===Terrasoft.FilterType.COMPARE?e.un("rightExpressionChange",this.filterChanged,this):t===Terrasoft.FilterType.IN&&e.un("rightExpressionsChange",this.filterChanged,this))},filterChanged:function(e){this.fireEvent("changeItem",e,this)},onCollectionAdd:function(e,t,r){t.key=r,this.callParent(arguments),this.subscribeForItemEvents(t)},onCollectionRemove:function(e){this.callParent(arguments),this.unSubscribeForItemEvents(e),e.key=""},getSerializableObject:function(e,t){this.callParent(arguments),e.logicalOperation=this.logicalOperation,e.isEnabled=this.isEnabled,e.filterType=this.filterType;var r=this.rootSchemaName;Ext.isEmpty(r)||(e.rootSchemaName=r),t.serializeFilterManagerInfo&&(e.key=this.key)},needSerializeItem:function(e,t,r){return!!r.serializeFilterManagerInfo||t.getIsCompleted()},getIsCompleted:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(e.recursive){var t=this.mapArray((function(e){return e instanceof Terrasoft.FilterGroup?e.getIsCompleted({recursive:!0}):e.getIsCompleted()}),this);return t.every((function(e){return!0===e}))}return!0},setLogicalOperation:function(e){this.logicalOperation!==e&&(this.logicalOperation=e,this.fireEvent("logicalOperationChanged",this,this))},getParentFilters:function(){return this.parentCollection},clear:function(){this.each((function(e){e.key="",this.unSubscribeForItemEvents(e)}),this),this.callParent(arguments)},isEmpty:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(!e)return this.callParent(arguments);var t=!0;return this.each((function(e){return t=e instanceof Terrasoft.FilterGroup&&e.isEmpty(!0)}),this),t},getIsEnabled:function(){return!!this.isEnabled&&this.getItems().some((function(e){return e.getIsEnabled()}))},updateLeftExpressionCaption:function(e){!this.isEmpty()&&e.items&&this.each((function(t){var r=e.items[t.key];t&&t.updateLeftExpressionCaption(r)}),this)}}),Ext.define("Terrasoft.controls.FilterEdit",{alternateClassName:"Terrasoft.FilterEdit",extend:"Terrasoft.Component",uses:["Terrasoft.Collection","Terrasoft.ListView"],translate:Terrasoft.Resources.FilterEdit,LogicalOperatorTypeFlipped:Terrasoft.invert(Terrasoft.LogicalOperatorType),ComparisonTypeFlipped:Terrasoft.invert(Terrasoft.ComparisonType),ComparisonTypeTranslateFlipped:Terrasoft.invert(Terrasoft.Resources.ComparisonType),filterManager:null,filters:null,renderedGroups:null,renderedFilters:null,selectedFilters:null,selectedItems:null,openedInput:null,openMacrosParameter:null,useProcessParameters:!1,useDcmMainRecord:!1,filterEditConfig:null,_scrollPosition:0,_getDefaultConfig:function(){return{filterClassName:"Terrasoft.FilterEdit.Filter"}},rightExpressionMenuAligned:!1,constructor:function(){this.callParent(arguments),Ext.get(window).on("click",this.onClickOutside,this)},getFilterEditConfig:function(){return this.filterEditConfig||this._getDefaultConfig()},init:function(){this.callParent(arguments),this.addEvents("selectedFiltersChange","prepareMappingParametersList","prepareMainRecordModalBox"),this.selectors={wrapEl:""},this.classes={wrapEl:["filteredit"]},this.selectedFilters={},this.selectedItems={},this.renderedGroups={},this.renderedFilters={},this._scrollPosition=0},createEmptyFilterGroup:function(){return Ext.create("Terrasoft.FilterGroup")},onFilterAdd:function(e){this.update(),this.processUpdatedFilter(e)},onFilterRemove:function(e,t,r){Terrasoft.each(this.selectedFilters,(function(e,t){return-1===t.indexOf(r)||(this.setSelectedFilters(e),!1)}),this),this.fireEvent("selectedFiltersChange"),this.update()},onFilterChange:function(e){this.update(),this.processUpdatedFilter(e)},processUpdatedFilter:function(e){var t=this.renderedFilters[e.key],r=this.filterManager.getRightExpressionDisplayValue(e);t&&t.getIsRightExpressionMenuAllowed()&&!r&&t.showRightExpressionMenu()},getBindConfig:function(){var e=this.callParent(),t={filterManager:{changeMethod:"setFilterManager"},useProcessParameters:{changeMethod:"setUseProcessParameters"},useDcmMainRecord:{changeMethod:"_setUseDcmMainRecord"},rightExpressionMenuAligned:{changeMethod:"setRightExpressionMenuAligned"},selectedItems:{changeEvent:"selectedFiltersChange"},prepareMappingParametersList:{changeEvent:"prepareMappingParametersList"},prepareMainRecordModalBox:{changeEvent:"prepareMainRecordModalBox"},filterEditConfig:{changeMethod:"setFilterEditConfig"}};return Ext.apply(t,e),t},initDomEvents:function(){this.callParent(arguments),this.initGroupsDomEvents(),this.initFiltersDomEvents()},onClickOutside:function(){this.fireEvent("clickOutside",this),this.clearSelected()},initGroupsDomEvents:function(){Terrasoft.each(this.renderedGroups,(function(e){e.initDomEvents()}),this)},initFiltersDomEvents:function(){Terrasoft.each(this.renderedFilters,(function(e){e.initDomEvents()}),this)},_getFilterEditId:function(){return"filteredit-"+this.id+"-wrap"},generateHtml:function(){var e=this._getFilterEditId();this.selectors.wrapEl="#"+e;var t={tag:"div",id:e,cls:this.classes.wrapEl.join(" "),children:[]},r=this.filters||this.createEmptyFilterGroup(),n={filterManager:this.filterManager,filterEdit:this,groupType:r.logicalOperation,groupFilters:r,generateTo:t.children},i=Ext.create("Terrasoft.FilterEdit.Group",n);return this.renderedGroups[i.id]=i,this.tpl=Ext.DomHelper.markup(t),this.callParent(arguments)},_saveScrollPosition:function(){var e=this.wrapEl;Ext.isEmpty(e)||(this._scrollPosition=e.getScrollTop())},_restoreScrollPosition:function(){var e=this.wrapEl;Ext.isEmpty(e)||e.setScrollTop(this._scrollPosition)},update:function(){this.rendered&&this.visible&&(this._saveScrollPosition(),this.clear(),this.reRender(),this._restoreScrollPosition())},setSelectedFilters:function(e){var t=this;Ext.isArray(e)?Terrasoft.each(e,(function(e){t.selectFilter(e,!0)}),this):this.selectFilter(e,!1)},selectFilter:function(e,t){var r=Object.values(this.selectedFilters)[0];r&&((r.instance.parentCollection?r.instance.parentCollection.key:"")!==(e.instance.parentCollection?e.instance.parentCollection.key:"")&&(Terrasoft.each(this.selectedFilters,(function(e){e.showSelected(!1)}),this),this.selectedFilters={},this.selectedItems={}));if(this.selectedFilters.hasOwnProperty(e.id))return e.showSelected(!1),delete this.selectedFilters[e.id],void delete this.selectedItems[e.id];t||this.clearSelected(),e.showSelected(!0),this.selectedFilters[e.id]=e,this.selectedItems[e.id]=e.instance},clearSelected:function(){Terrasoft.each(this.selectedFilters,(function(e){e.showSelected(!1)}),this),this.selectedFilters={},this.selectedItems={}},clear:function(){this.openedInput&&(this.openedInput.close(),this.openedInput=null),Terrasoft.each(this.renderedFilters,(function(e){e.destroy()}),this),this.renderedFilters={},Terrasoft.each(this.renderedGroups,(function(e){e.destroy()}),this),this.renderedGroups={}},setFilterManager:function(e){if(this.filterManager!==e){this.unSubscribeForFilterManagerEvents(),this.filterManager=e,this.subscribeForFilterManagerEvents();var t=e?e.filters:null;this.updateFilters(t)}},setUseProcessParameters:function(e){this.useProcessParameters=e},_setUseDcmMainRecord:function(e){this.useDcmMainRecord=e},setRightExpressionMenuAligned:function(e){this.rightExpressionMenuAligned=e},setFilterEditConfig:function(e){this.filterEditConfig=e},updateFilters:function(e){this.filters=e,this.update()},subscribeForFilterManagerEvents:function(){var e=this.filterManager;e&&(e.on("addFilter",this.onFilterAdd,this),e.on("removeFilter",this.onFilterRemove,this),e.on("changeFilter",this.onFilterChange,this),e.on("rootFiltersChanged",this.updateFilters,this))},unSubscribeForFilterManagerEvents:function(){var e=this.filterManager;e&&(e.un("addFilter",this.onFilterAdd,this),e.un("removeFilter",this.onFilterRemove,this),e.un("changeFilter",this.onFilterChange,this),e.un("rootFiltersChanged",this.updateFilters,this))},onDestroy:function(){this.clear(),this.unSubscribeForFilterManagerEvents(),Ext.get(window).un("click",this.onClickOutside,this),this.callParent(arguments)}}),Ext.ns("Terrasoft.data.filters.FilterUtils.FilterUtils"),Terrasoft.data.filters.FilterUtils.createFilterGroup=function(){return Ext.create("Terrasoft.FilterGroup")},Terrasoft.createFilterGroup=Terrasoft.data.filters.FilterUtils.createFilterGroup,Terrasoft.data.filters.FilterUtils.createCompareFilter=function(e,t,r){return Ext.create("Terrasoft.CompareFilter",{comparisonType:e,leftExpression:t,rightExpression:r})},Terrasoft.createCompareFilter=Terrasoft.data.filters.FilterUtils.createCompareFilter,Terrasoft.data.filters.FilterUtils.createBetweenFilter=function(e,t,r){return Ext.create("Terrasoft.BetweenFilter",{leftExpression:e,rightLessExpression:t,rightGreaterExpression:r})},Terrasoft.createBetweenFilter=Terrasoft.data.filters.FilterUtils.createBetweenFilter,Terrasoft.data.filters.FilterUtils.createIsNullFilter=function(e){return Ext.create("Terrasoft.IsNullFilter",{leftExpression:e,comparisonType:Terrasoft.ComparisonType.IS_NULL,isNull:!0})},Terrasoft.createIsNullFilter=Terrasoft.data.filters.FilterUtils.createIsNullFilter,Terrasoft.data.filters.FilterUtils.createIsNotNullFilter=function(e){return Ext.create("Terrasoft.IsNullFilter",{leftExpression:e,comparisonType:Terrasoft.ComparisonType.IS_NOT_NULL,isNull:!1})},Terrasoft.createIsNotNullFilter=Terrasoft.data.filters.FilterUtils.createIsNotNullFilter,Terrasoft.data.filters.FilterUtils.createInFilter=function(e,t){return Ext.create("Terrasoft.InFilter",{leftExpression:e,rightExpressions:t})},Terrasoft.createInFilter=Terrasoft.data.filters.FilterUtils.createInFilter,Terrasoft.data.filters.FilterUtils.createFilter=function(e,t,r){var n=Ext.create("Terrasoft.ColumnExpression",{columnPath:t}),i=Ext.create("Terrasoft.ColumnExpression",{columnPath:r});return Terrasoft.createCompareFilter(e,n,i)},Terrasoft.createFilter=Terrasoft.data.filters.FilterUtils.createFilter,Terrasoft.data.filters.FilterUtils.createColumnFilterWithParameter=function(e,t,r,n){Ext.isString(e)&&(n=r,r=t,t=e,e=Terrasoft.ComparisonType.EQUAL);var i=Ext.create("Terrasoft.ColumnExpression",{columnPath:t}),a=Ext.create("Terrasoft.ParameterExpression",{parameterValue:r,parameterDataType:n});return Terrasoft.createCompareFilter(e,i,a)},Terrasoft.createColumnFilterWithParameter=Terrasoft.data.filters.FilterUtils.createColumnFilterWithParameter,Terrasoft.data.filters.FilterUtils.createPrimaryDisplayColumnFilterWithParameter=function(e,t,r){var n=Ext.create("Terrasoft.FunctionExpression",{functionType:Terrasoft.FunctionType.MACROS,macrosType:Terrasoft.QueryMacrosType.PRIMARY_DISPLAY_COLUMN}),i=Ext.create("Terrasoft.ParameterExpression",{parameterValue:t,parameterDataType:r});return Terrasoft.createCompareFilter(e,n,i)},Terrasoft.createPrimaryDisplayColumnFilterWithParameter=Terrasoft.data.filters.FilterUtils.createPrimaryDisplayColumnFilterWithParameter,Terrasoft.data.filters.FilterUtils.createColumnBetweenFilterWithParameters=function(e,t,r,n){var i=Ext.create("Terrasoft.ColumnExpression",{columnPath:e}),a=Ext.create("Terrasoft.ParameterExpression",{parameterValue:t,parameterDataType:n}),s=Ext.create("Terrasoft.ParameterExpression",{parameterValue:r,parameterDataType:n});return Terrasoft.createBetweenFilter(i,a,s)},Terrasoft.createColumnBetweenFilterWithParameters=Terrasoft.data.filters.FilterUtils.createColumnBetweenFilterWithParameters,Terrasoft.data.filters.FilterUtils.createColumnIsNullFilter=function(e){var t=Ext.create("Terrasoft.ColumnExpression",{columnPath:e});return Terrasoft.createIsNullFilter(t)},Terrasoft.createColumnIsNullFilter=Terrasoft.data.filters.FilterUtils.createColumnIsNullFilter,Terrasoft.data.filters.FilterUtils.createColumnIsNotNullFilter=function(e){var t=Ext.create("Terrasoft.ColumnExpression",{columnPath:e});return Terrasoft.createIsNotNullFilter(t)},Terrasoft.createColumnIsNotNullFilter=Terrasoft.data.filters.FilterUtils.createColumnIsNotNullFilter,Terrasoft.data.filters.FilterUtils.createColumnInFilterWithParameters=function(e,t,r){if(!Ext.isArray(t))throw new Terrasoft.UnsupportedTypeException;var n=Ext.create("Terrasoft.ColumnExpression",{columnPath:e}),i=[];return Terrasoft.each(t,(function(e){var t=Ext.create("Terrasoft.ParameterExpression",{parameterValue:e,parameterDataType:r});i.push(t)})),Terrasoft.createInFilter(n,i)},Terrasoft.createColumnInFilterWithParameters=Terrasoft.data.filters.FilterUtils.createColumnInFilterWithParameters,Terrasoft.data.filters.FilterUtils.createExistsFilter=function(e,t){return Terrasoft.checkArguments(arguments,"columnPath"),Ext.create("Terrasoft.ExistsFilter",{comparisonType:Terrasoft.ComparisonType.EXISTS,leftExpression:Ext.create("Terrasoft.ColumnExpression",{columnPath:e}),subFilters:t})},Terrasoft.createExistsFilter=Terrasoft.data.filters.FilterUtils.createExistsFilter,Terrasoft.data.filters.FilterUtils.createNotExistsFilter=function(e,t){return Terrasoft.checkArguments(arguments,"columnPath"),Ext.create("Terrasoft.ExistsFilter",{comparisonType:Terrasoft.ComparisonType.NOT_EXISTS,leftExpression:Ext.create("Terrasoft.ColumnExpression",{columnPath:e}),subFilters:t})},Terrasoft.createNotExistsFilter=Terrasoft.data.filters.FilterUtils.createNotExistsFilter,Terrasoft.data.filters.FilterUtils.createDatePartColumnFilter=function(e,t,r,n){if(Ext.isEmpty(t))throw new Terrasoft.ArgumentNullOrEmptyException({argumentName:"columnPath"});var i=Ext.create("Terrasoft.FunctionExpression",{functionType:Terrasoft.FunctionType.DATE_PART,datePartType:r,functionArgument:Ext.create("Terrasoft.ColumnExpression",{columnPath:t})}),a=Ext.create("Terrasoft.ParameterExpression",{parameterValue:n,parameterDataType:Terrasoft.DataValueType.INTEGER});return Terrasoft.createCompareFilter(e,i,a)},Terrasoft.createDatePartColumnFilter=Terrasoft.data.filters.FilterUtils.createDatePartColumnFilter,Terrasoft.data.filters.FilterUtils.getRightExpressionDisplayValue=function(e){var t="";if(Terrasoft.isFilterWithMacros(e)){var r=Terrasoft.GetRightExpressionMacrosDisplayValues(e),n=r.macrosCaption;t=Ext.isEmpty(n)?t:n;var i=r.macrosParameterCaption;t=Ext.isEmpty(i)?t:Ext.String.format("{0} {1}",t,i)}else{var a,s;switch(e.filterType){case Terrasoft.FilterType.COMPARE:var o=e.rightExpression;if(o&&o.parameter){var l=(s=o.parameter).getValue();(a=s.dataValueType||e.dataValueType)===Terrasoft.DataValueType.DATE_TIME&&(a=Terrasoft.DataValueType.DATE),t=Ext.isEmpty(l)?"":Terrasoft.getTypedStringValue(l,a)}break;case Terrasoft.FilterType.IN:var c=[];Terrasoft.each(e.rightExpressions,(function(t){var r=t.parameter;r&&(a=r.dataValueType||e.dataValueType,c.push(Terrasoft.getTypedStringValue(r.getValue(),a)))})),t=c.join("; ")}}return t},Terrasoft.getRightExpressionDisplayValue=Terrasoft.data.filters.FilterUtils.getRightExpressionDisplayValue,Terrasoft.data.filters.FilterUtils.getRightExpressionValue=function(e){if(e.filterType!==Terrasoft.FilterType.COMPARE)throw new Terrasoft.UnsupportedTypeException({message:Terrasoft.Resources.FilterUtils.FilterTypeShouldBeCompare});var t=null,r=e.rightExpression;r&&r.parameter&&(t=r.parameter.getValue());var n=r&&r.functionArgument&&r.functionArgument.parameter;return n&&(t=n.value),t},Terrasoft.getRightExpressionValue=Terrasoft.data.filters.FilterUtils.getRightExpressionValue,Terrasoft.data.filters.FilterUtils.isFilterWithMacros=function(e){var t=e.leftExpression?e.leftExpression.functionType:null,r=e.rightExpression?e.rightExpression.functionType:null;return t===Terrasoft.FunctionType.DATE_PART||r===Terrasoft.FunctionType.MACROS},Terrasoft.isFilterWithMacros=Terrasoft.data.filters.FilterUtils.isFilterWithMacros,Terrasoft.data.filters.FilterUtils.GetRightExpressionMacrosDisplayValues=function(e){var t={},r=Terrasoft.GetFilterMacrosConfig(e);return r&&(t.macrosCaption=r.caption,Ext.isEmpty(r.value)||(t.macrosParameterCaption=function(e,t){var r,n=t.functionType;if(n===Terrasoft.FunctionType.DATE_PART){var i=e.parameter;r=function(e,t){var r=t,n=e.value,i=n.displayValueRange;return n.dataValueType===Terrasoft.DataValueType.TIME?r=Ext.Date.format(t,Terrasoft.Resources.CultureSettings.timeFormat):i&&(r=i[t-1]),r}(t,i?i.value:null)}else if(n===Terrasoft.FunctionType.MACROS){var a=t.filterMacrosType;if(Terrasoft.ParameterizedFilterMacrosTypes.indexOf(a)>-1){var s=e.functionArgument.parameter;r=s?s.value:null}}return r}(e.rightExpression,r))),t},Terrasoft.GetRightExpressionMacrosDisplayValues=Terrasoft.data.filters.FilterUtils.GetRightExpressionMacrosDisplayValues,Terrasoft.data.filters.FilterUtils.GetFilterMacrosConfig=function(e){var t,r,n=e.leftExpression,i=n?n.functionType:null,a=e.rightExpression,s=a?a.functionType:null;return i===Terrasoft.FunctionType.DATE_PART?r=Terrasoft.GetDatePartTypeFilterMacrosType(n.datePartType):s===Terrasoft.FunctionType.MACROS&&(r=Terrasoft.GetQueryMacrosTypeFilterMacrosType(a.macrosType)),Ext.isEmpty(r)||((t=Terrasoft.MacrosTypeConfig[r]).filterMacrosType=r),t},Terrasoft.GetFilterMacrosConfig=Terrasoft.data.filters.FilterUtils.GetFilterMacrosConfig,Terrasoft.data.filters.FilterUtils.GetDatePartTypeFilterMacrosType=function(e){var t=Terrasoft.DatePartTypeFilterMacrosType[e];if(Ext.isEmpty(t))throw new Terrasoft.UnsupportedTypeException({message:Terrasoft.Resources.FilterMacros.GetDatePartTypeFilterMacrosTypeException});return t},Terrasoft.GetDatePartTypeFilterMacrosType=Terrasoft.data.filters.FilterUtils.GetDatePartTypeFilterMacrosType,Terrasoft.data.filters.FilterUtils.getMacrosTypeConfig=function(e){var t=Terrasoft.MacrosTypeConfig[e];if(Ext.isEmpty(t))throw new Terrasoft.UnsupportedTypeException({message:Terrasoft.Resources.FilterMacros.GetMacrosTypeConfigException});return t},Terrasoft.getMacrosTypeConfig=Terrasoft.data.filters.FilterUtils.getMacrosTypeConfig,Terrasoft.data.filters.FilterUtils.GetQueryMacrosTypeFilterMacrosType=function(e){var t=Terrasoft.QueryMacrosTypeFilterMacrosType[e];if(Ext.isEmpty(t))throw new Terrasoft.UnsupportedTypeException({message:Terrasoft.Resources.FilterMacros.GetQueryMacrosTypeFilterMacrosTypeException});return t},Terrasoft.GetQueryMacrosTypeFilterMacrosType=Terrasoft.data.filters.FilterUtils.GetQueryMacrosTypeFilterMacrosType,Terrasoft.data.filters.FilterUtils.getFilterDataValueType=function(e){var t;if(e&&(t=e.dataValueType,Terrasoft.isFilterWithMacros(e))){var r=[Terrasoft.FilterMacrosType.CONTACT_CURRENT,Terrasoft.FilterMacrosType.USER_CURRENT],n=Terrasoft.GetFilterMacrosConfig(e);Terrasoft.contains(r,n.filterMacrosType)&&(t=Terrasoft.DataValueType.LOOKUP)}return t},Terrasoft.getFilterDataValueType=Terrasoft.data.filters.FilterUtils.getFilterDataValueType,Ext.define("Terrasoft.data.columns.ParameterQueryColumn",{extend:"Terrasoft.BaseQueryColumn",alternateClassName:"Terrasoft.ParameterQueryColumn",parameterValue:null,parameterDataType:Terrasoft.DataValueType.TEXT,initExpression:function(){this.callParent(arguments),this.expression=Ext.create("Terrasoft.ParameterExpression",{parameterDataType:this.parameterDataType,parameterValue:this.parameterValue})},setParentCollection:function(e){if(this.callParent(arguments),e){var t=e.parentQuery;if(t){var r=t.parameters;r.addItem(this.expression.parameter)}}}}),Ext.define("Terrasoft.data.expressions.DateAddFunctionExpression",{extend:"Terrasoft.FunctionExpression",alternateClassName:"Terrasoft.DateAddFunctionExpression",functionType:Terrasoft.FunctionType.DATE_ADD,datePartType:Terrasoft.DatePartType.NONE,numberExpression:null,dateTimeExpression:null,getSerializableObject:function(e){this.callParent(arguments),e.datePartType=this.datePartType,e.functionArguments=e.functionArguments||[],this.numberExpression&&e.functionArguments.push(this.getSerializableProperty(this.numberExpression)),this.dateTimeExpression&&e.functionArguments.push(this.getSerializableProperty(this.dateTimeExpression))}}),Ext.define("Terrasoft.data.columns.DateAddFunctionQueryColumn",{extend:"Terrasoft.FunctionQueryColumn",alternateClassName:"Terrasoft.DateAddFunctionQueryColumn",functionType:Terrasoft.FunctionType.DATE_ADD,numberExpression:null,dateTimeExpression:null,initExpression:function(){this.callParent(arguments),this.expression=Ext.create("Terrasoft.DateAddFunctionExpression",{datePartType:this.datePartType,numberExpression:this.numberExpression,dateTimeExpression:this.dateTimeExpression})}}),Ext.define("Terrasoft.data.expressions.DateDiffFunctionExpression",{extend:"Terrasoft.FunctionExpression",alternateClassName:"Terrasoft.DateDiffFunctionExpression",functionType:Terrasoft.FunctionType.DATE_DIFF,dateDiffInterval:Terrasoft.DateDiffInterval.NONE,startDateExpression:null,endDateExpression:null,getSerializableObject:function(e){this.callParent(arguments),e.dateDiffInterval=this.dateDiffInterval,e.functionArguments=e.functionArguments||[],this.startDateExpression&&e.functionArguments.push(this.getSerializableProperty(this.startDateExpression)),this.endDateExpression&&e.functionArguments.push(this.getSerializableProperty(this.endDateExpression))}}),Ext.define("Terrasoft.data.columns.DateDiffFunctionQueryColumn",{extend:"Terrasoft.FunctionQueryColumn",alternateClassName:"Terrasoft.DateDiffFunctionQueryColumn",functionType:Terrasoft.FunctionType.DATE_DIFF,startDateExpression:null,endDateExpression:null,dateDiffInterval:Terrasoft.DateDiffInterval.NONE,initExpression:function(){this.callParent(arguments),this.expression=Ext.create("Terrasoft.DateDiffFunctionExpression",{startDateExpression:this.startDateExpression,endDateExpression:this.endDateExpression,dateDiffInterval:this.dateDiffInterval})}}),Terrasoft.FormulaExpressionType={OPERATOR:0,OPERAND:1,FUNCTION:2},Terrasoft.OperatorType={PARENTHESES:0,ARITHMETIC:1,RELATIONAL:2,TERNARY:3},Terrasoft.OperandType={CONST:0,COLUMN:1,SYSSETTING:2,SYSVARIABLE:3},Terrasoft.ColumnOperandType={SCHEMACOLUMN:0,SUBQUERY:1,AGGREGATION:2},Ext.define("Terrasoft.data.EsqExpressionConverter",{alternateClassName:"Terrasoft.EsqExpressionConverter",extend:"Terrasoft.BaseObject",singleton:!0,_datePartMapping:{Y:Terrasoft.DatePartType.YEAR,M:Terrasoft.DatePartType.MONTH,W:Terrasoft.DatePartType.WEEK,D:Terrasoft.DatePartType.DAY,H:Terrasoft.DatePartType.HOUR,DW:Terrasoft.DatePartType.WEEK_DAY},_dateDiffIntervalMapping:{Y:Terrasoft.DateDiffInterval.YEAR,M:Terrasoft.DateDiffInterval.MONTH,D:Terrasoft.DateDiffInterval.DAY,H:Terrasoft.DateDiffInterval.HOUR,Mi:Terrasoft.DateDiffInterval.MINUTE},_createQueryColumn:function(e){switch(e.type){case Terrasoft.FormulaExpressionType.OPERATOR:return this._createOperatorQueryColumn(e);case Terrasoft.FormulaExpressionType.OPERAND:return this._createOperandQueryColumn(e);case Terrasoft.FormulaExpressionType.FUNCTION:return this._createFunctionQueryColumn(e);default:throw new Error("The expression of type ".concat(e.type," is not supported."))}},_createFunctionQueryColumn:function(e){var t=e.code;switch(t){case"DATEADD":return this._createDateAddFunctionQueryColumn(e);case"DATEDIFF":return this._createDateDiffFunctionQueryColumn(e);case"DATEPART":return this._createDatePartFunctionQueryColumn(e);default:throw new Error("The function ".concat(t," is not supported."))}},_createDateAddFunctionQueryColumn:function(e){var t=e.arguments;return Ext.create("Terrasoft.DateAddFunctionQueryColumn",{dateTimeExpression:this._createExpression(t[0]),numberExpression:this._createExpression(t[1]),datePartType:this._datePartMapping[t[2].value]})},_createDateDiffFunctionQueryColumn:function(e){var t=e.arguments;return Ext.create("Terrasoft.DateDiffFunctionQueryColumn",{startDateExpression:this._createExpression(t[0]),endDateExpression:this._createExpression(t[1]),dateDiffInterval:this._dateDiffIntervalMapping[t[2].value]})},_createDatePartFunctionQueryColumn:function(e){var t=e.arguments;return Ext.create("Terrasoft.FunctionQueryColumn",{functionType:Terrasoft.FunctionType.DATE_PART,functionArgument:this._createExpression(t[0]),datePartType:this._datePartMapping[t[1].value]})},_createOperatorQueryColumn:function(e){switch(e.operatorType){case Terrasoft.OperatorType.PARENTHESES:return this._createParenthesesQueryColumn(e);case Terrasoft.OperatorType.ARITHMETIC:return this._createArithmeticQueryColumn(e);default:throw new Error("The operator type ".concat(e.operatorType," is not supported."))}},_createOperandQueryColumn:function(e){switch(e.operandType){case Terrasoft.OperandType.CONST:return this._createParameterQueryColumn(e);case Terrasoft.OperandType.COLUMN:return this._createColumnOperandQueryColumn(e);default:throw new Error("The operand type ".concat(e.operandType," is not supported."))}},_createParenthesesQueryColumn:function(e){var t=this._createExpression(e.expression);return t.isBlock=!0,Ext.create("Terrasoft.BaseQueryColumn",{expression:t})},_createArithmeticQueryColumn:function(e){return Ext.create("Terrasoft.ArithmeticQueryColumn",{arithmeticOperation:e.arithmeticOperatorType,leftArithmeticOperand:this._createExpression(e.leftExpression),rightArithmeticOperand:this._createExpression(e.rightExpression)})},_createParameterQueryColumn:function(e){return Ext.create("Terrasoft.ParameterQueryColumn",{parameterDataType:e.dataType,parameterValue:e.value})},_createColumnOperandQueryColumn:function(e){switch(e.columnOperandType){case Terrasoft.ColumnOperandType.SCHEMACOLUMN:return this._createEntityQueryColumn(e);case Terrasoft.ColumnOperandType.SUBQUERY:return this._createSubQueryColumn(e);case Terrasoft.ColumnOperandType.AGGREGATION:return this._createAggregationQueryColumn(e);default:throw new Error("The column operand type ".concat(e.columnOperandType," is not supported."))}},_createEntityQueryColumn:function(e){return Ext.create("Terrasoft.EntityQueryColumn",{columnPath:e.columnPath})},_createSubQueryColumn:function(e){return Ext.create("Terrasoft.SubQueryColumn",{columnPath:e.columnPath,subFilters:this._getFilters(e.subFilters)})},_createAggregationQueryColumn:function(e){return Ext.create("Terrasoft.AggregationQueryColumn",{columnPath:e.columnPath,subFilters:this._getFilters(e.subFilters),aggregationType:e.aggregationType})},_createExpression:function(e){switch(e.type){case Terrasoft.FormulaExpressionType.OPERATOR:return this._createOperatorExpression(e);case Terrasoft.FormulaExpressionType.OPERAND:return this._createOperandExpression(e);case Terrasoft.FormulaExpressionType.FUNCTION:return this._createFunctionExpression(e);default:throw new Error("The expression of type ".concat(e.type," is not supported."))}},_createFunctionExpression:function(e){var t=e.code;switch(t){case"DATEADD":return this._createDateAddFunctionExpression(e);case"DATEDIFF":return this._createDateDiffFunctionExpression(e);case"DATEPART":return this._createDatePartFunctionExpression(e);default:throw new Error("The function ".concat(t," is not supported."))}},_createDateAddFunctionExpression:function(e){var t=e.arguments;return Ext.create("Terrasoft.DateAddFunctionExpression",{dateTimeExpression:this._createExpression(t[0]),numberExpression:this._createExpression(t[1]),datePartType:this._datePartMapping[t[2].value]})},_createDateDiffFunctionExpression:function(e){var t=e.arguments;return Ext.create("Terrasoft.DateDiffFunctionExpression",{startDateExpression:this._createExpression(t[0]),endDateExpression:this._createExpression(t[1]),dateDiffInterval:this._dateDiffIntervalMapping[t[2].value]})},_createDatePartFunctionExpression:function(e){var t=e.arguments;return Ext.create("Terrasoft.FunctionExpression",{functionType:Terrasoft.FunctionType.DATE_PART,functionArgument:this._createExpression(t[0]),datePartType:this._datePartMapping[t[1].value]})},_createOperatorExpression:function(e){switch(e.operatorType){case Terrasoft.OperatorType.PARENTHESES:return this._createParenthesesOperatorExpression(e);case Terrasoft.OperatorType.ARITHMETIC:return this._createArithmeticOperatorExpression(e);default:throw new Error("The operator type ".concat(e.operatorType," is not supported."))}},_createOperandExpression:function(e){switch(e.operandType){case Terrasoft.OperandType.CONST:return this._createParameterOperandExpression(e);case Terrasoft.OperandType.COLUMN:return this._createColumnOperandExpression(e);default:throw new Error("The operand type ".concat(e.operandType," is not supported."))}},_createParenthesesOperatorExpression:function(e){var t=this._createExpression(e.expression);return t.isBlock=!0,t},_createArithmeticOperatorExpression:function(e){return Ext.create("Terrasoft.ArithmeticExpression",{arithmeticOperation:e.arithmeticOperatorType,leftArithmeticOperand:this._createExpression(e.leftExpression),rightArithmeticOperand:this._createExpression(e.rightExpression)})},_createParameterOperandExpression:function(e){return Ext.create("Terrasoft.ParameterExpression",{parameterDataType:e.dataType,parameterValue:e.value})},_createColumnOperandExpression:function(e){switch(e.columnOperandType){case Terrasoft.ColumnOperandType.SCHEMACOLUMN:return this._createSchemaColumnOperandExpression(e);case Terrasoft.ColumnOperandType.SUBQUERY:return this._createSubQueryOperandExpression(e);case Terrasoft.ColumnOperandType.AGGREGATION:return this._createAggregationSubQueryOperandExpression(e);default:throw new Error("The column operand type ".concat(e.columnOperandType," is not supported."))}},_createSchemaColumnOperandExpression:function(e){return Ext.create("Terrasoft.ColumnExpression",{columnPath:e.columnPath})},_createSubQueryOperandExpression:function(e){return Ext.create("Terrasoft.SubQueryExpression",{columnPath:e.columnPath,subFilters:this._getFilters(e.subFilters)})},_createAggregationSubQueryOperandExpression:function(e){return Ext.create("Terrasoft.AggregationQueryExpression",{columnPath:e.columnPath,subFilters:this._getFilters(e.subFilters),aggregationType:e.aggregationType})},_getFilters:function(e){return Ext.isString(e)?Terrasoft.deserialize(e):e},createEsqColumn:function(e,t){var r=this._createQueryColumn(e);return t&&(r.caption=t.caption),r}}),Ext.define("Terrasoft.data.filters.Parameters",{extend:"Terrasoft.ObjectCollection",alternateClassName:"Terrasoft.Parameters",itemKeyTemplate:"Param",parentQuery:null,createParameter:function(e,t){return Ext.create("Terrasoft.Parameter",{dataValueType:e,value:t})},addParameter:function(e,t){var r=this.createParameter(e,t);return this.addItem(r),r}}),Ext.define("Terrasoft.Core.Process.ExecutionDataCollector",{alternateClassName:"Terrasoft.ProcessExecutionDataCollector",extend:"Terrasoft.BaseObject",singleton:!0,_buffer:null,constructor:function(){this.callParent(arguments),this.addEvents("executionDataReady"),this._buffer=[]},_addItem:function(e){this.hasListener("executionDataReady")?this.fireEvent("executionDataReady",e):this._buffer.push(e)},add:function(e,t){if(e){var r={executionData:e};t&&Ext.apply(r,t),this._addItem(r)}},flushBufferedItems:function(){for(var e,t=this._buffer.splice(0);e=t.pop();)this._addItem(e)}}),Ext.ns("Terrasoft.data.query"),Ext.define("Terrasoft.data.query.ColumnValues",{extend:"Terrasoft.ObjectCollection",alternateClassName:"Terrasoft.ColumnValues",setColumnValue:function(e,t){var r=Ext.create("Terrasoft.ColumnExpression",{columnPath:t});return this.add(e,r),r},setParameterValue:function(e,t,r){if(!Ext.isNumber(r))throw new Terrasoft.exceptions.ArgumentNullOrEmptyException({argumentName:"parameterDataType"});var n=Ext.create("Terrasoft.ParameterExpression",{parameterValue:t,parameterDataType:r});return this.add(e,n),n},setFunctionValue:function(e,t){var r=Ext.create("Terrasoft.FunctionExpression",t);return this.add(e,r),r}}),Ext.define("Terrasoft.data.columns.QueryColumns",{extend:"Terrasoft.ObjectCollection",alternateClassName:"Terrasoft.QueryColumns",addColumn:function(e,t,r){var n;if(Ext.isString(e)){var i={columnPath:e,parentCollection:this};Ext.isObject(r)&&Ext.apply(i,r),n=Ext.create("Terrasoft.EntityQueryColumn",i),t=t||e}else if(n=e,Ext.isEmpty(t))throw new Terrasoft.ArgumentNullOrEmptyException({argumentName:t});return this.addIfNotExists(t,n),n},addFunctionColumn:function(e,t,r){var n={functionType:t,columnPath:e,parentCollection:this},i=Ext.create("Terrasoft.FunctionQueryColumn",n);return r?this.add(r,i):this.addItem(i)},addMacrosColumn:function(e,t){var r={functionType:Terrasoft.FunctionType.MACROS,macrosType:e,parentCollection:this},n=Ext.create("Terrasoft.FunctionQueryColumn",r);return t?this.add(t,n):this.addItem(n)},addDatePeriodMacrosColumn:function(e,t,r){var n={functionType:Terrasoft.FunctionType.MACROS,macrosType:e,macrosValue:t,parentCollection:this},i=Ext.create("Terrasoft.FunctionQueryColumn",n);return r?this.add(r,i):this.addItem(i)},addDatePartFunctionColumn:function(e,t,r){var n={functionType:Terrasoft.FunctionType.DATE_PART,columnPath:e,datePartType:t,parentCollection:this},i=Ext.create("Terrasoft.FunctionQueryColumn",n);return r?this.add(r,i):this.addItem(i)},addAggregationSchemaColumn:function(e,t,r,n){var i={functionType:Terrasoft.FunctionType.AGGREGATION,columnPath:e,aggregationType:t,aggregationEvalType:n||Terrasoft.AggregationEvalType.NONE,parentCollection:this},a=Ext.create("Terrasoft.FunctionQueryColumn",i);return r?this.add(r,a):this.addItem(a)},addWindowFunctionColumn:function(e,t,r,n){var i={functionType:Terrasoft.FunctionType.WINDOW,functionArgument:{functionType:e.functionType,columnPath:e.columnPath,aggregationType:e.aggregationType,aggregationEvalType:e.aggregationEvalType||Terrasoft.AggregationEvalType.NONE,partitionByColumn:t,orderByColumn:r},parentCollection:this},a=Ext.create("Terrasoft.FunctionQueryColumn",i);return n?this.add(n,a):this.addItem(a)},addParameterColumn:function(e,t,r){var n={parameterValue:e,parameterDataType:t,parentCollection:this},i=Ext.create("Terrasoft.ParameterQueryColumn",n);return r?this.add(r,i):this.addItem(i)},addArithmeticColumn:function(e,t,r,n){var i={arithmeticOperation:e,leftArithmeticOperand:t,rightArithmeticOperand:r},a=Ext.create("Terrasoft.ArithmeticQueryColumn",i);return n?this.add(n,a):this.addItem(a)}}),Ext.ns("Terrasoft.DeferredExecution"),Terrasoft.DeferredExecution.FunctionStatus={Canceled:"canceled",Pending:"pending",Completed:"completed"},Ext.define("Terrasoft.DeferredExecution.Function",{mixins:{observable:"Ext.util.Observable"},_callback:null,_scope:null,_arguments:null,_canceled:!1,_status:Terrasoft.DeferredExecution.FunctionStatus.Pending,constructor:function(e){if(!Ext.isFunction(e.callback))throw new Terrasoft.UnsupportedTypeException({argumentName:"callback"});this.callParent([]),this._scope=e.scope,this._arguments=e.arguments,this._callback=e.callback,this.mixins.observable.constructor.call(this),this.addEvents("canceled")},cancel:function(){this._status===Terrasoft.DeferredExecution.FunctionStatus.Pending&&(this._status=Terrasoft.DeferredExecution.FunctionStatus.Canceled,this._canceled=!0,this.fireEvent("canceled"))},invoke:function(){if(this._status===Terrasoft.DeferredExecution.FunctionStatus.Pending)try{this._callback.apply(this._scope,this._arguments)}finally{this._status=Terrasoft.DeferredExecution.FunctionStatus.Completed}}}),Ext.ns("Terrasoft.DeferredExecution"),Ext.define("Terrasoft.DeferredExecution.Dispatcher",{extend:"Terrasoft.BaseObject",_waitingContexts:null,_deferredInvokeHandle:null,allowExecutionPredicate:null,constructor:function(){if(this.callParent(arguments),this._waitingContexts=[],!this.allowExecutionPredicate)throw new Terrasoft.ArgumentNullOrEmptyException({argumentName:"allowExecutionPredicate"})},_tryInvoke:function(){var e;for(this._deferredInvokeHandle=null;this.allowExecutionPredicate()&&(e=this._waitingContexts.shift());)try{e.invoke()}catch(e){this.error(e)}},_cancel:function(e){var t=this._waitingContexts.indexOf(e);t>-1&&this._waitingContexts.splice(t,1)},register:function(e,t){for(var r=this,n=arguments.length,i=new Array(n>2?n-2:0),a=2;a<n;a++)i[a-2]=arguments[a];var s=Ext.create("Terrasoft.DeferredExecution.Function",{scope:t,arguments:i,callback:e});return s.on("canceled",(function(){return r._cancel(s)})),this._waitingContexts.push(s),this.notify(),s},notify:function(){var e=this;this._waitingContexts.length<1||this._deferredInvokeHandle||(this._deferredInvokeHandle=Terrasoft.defer((function(){return e._tryInvoke()})))}}),Ext.define("Terrasoft.core.DynamicCache",{extend:"Terrasoft.BaseObject",alternateClassName:"Terrasoft.DynamicCache",_store:null,expirationInterval:1e3,_initStore:function(){this._store=this._getStore()||{}},_setStoreFlushTimer:function(){var e=this;setInterval((function(){var t=(new Date).getTime();e.getKeys().forEach((function(r){var n=e._getValue(r);t-n.cacheTime>e.expirationInterval&&e.canRemoveValue(n.value)&&(e.log("CLEAR DYNAMIC CACHE: "+r),e.removeValue(r))}))}),this.expirationInterval)},_getStore:function(){return this._store},_getValue:function(e){if(null!=e)return this._getStore()[e]},log:function(e){Terrasoft.isDebug&&console.log(e)},canRemoveValue:function(e){return!0},constructor:function(){this.callParent(arguments),this._initStore(),this._setStoreFlushTimer()},getKeys:function(){var e=this._getStore();return Object.keys(e)},getValue:function(e){var t=this._getValue(e);return t&&t.value},setValue:function(e,t){if(e){var r=this._getStore();if(r[e])throw"The '".concat(e,"' key already exists in the cache.");r[e]={value:t,cacheTime:(new Date).getTime()}}},updateValue:function(e,t){if(e){var r=this._getStore();null!=r[e]&&(r[e].value=t)}},removeValue:function(e){e&&delete this._getStore()[e]}}),Ext.define("Terrasoft.core.RequestsCache",{extend:"Terrasoft.DynamicCache",alternateClassName:"Terrasoft.RequestsCache",singleton:!0,_maxRequestsCachingTtl:5e3,constructor:function(){this._setExpirationInterval(),this.callParent(arguments)},_setExpirationInterval:function(){var e=Terrasoft.RequestsCachingSettings&&Terrasoft.RequestsCachingSettings.ttl;e>0&&e<=this._maxRequestsCachingTtl?this.expirationInterval=e:console.warn("Unsupported requests caching TTL: ".concat(e,". ")+"The value must be greater than 0 and less than or equal to ".concat(this._maxRequestsCachingTtl,". ")+"By default the TTL was set to ".concat(this.expirationInterval,"."))},_getRequestOrThrow:function(e){var t=this.getRequest(e);if(t)return t;throw"The '".concat(this.getKey(e),"' request not found.")},_getJsonBody:function(e){var t="string"==typeof e?JSON.parse(e):e,r=JSON.stringify(t);return this._hasDynamicKeys(t)?this._cutDynamicKeys(r):r},_hasDynamicKeys:function(e){return Boolean(e.rootSchemaName)},_cutDynamicKeys:function(e){var t=0;return e.replace(/"[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}":/gi,(function(){return t++,'"#'.concat(t,'":')}))},canRemoveValue:function(e){return Boolean(e&&e.completed)},getKey:function(e){if(!e)throw"Cannot create cache key: invalid options.";var t="";return e.method&&(t+=e.method),e.url&&(t+=e.url),e.jsonData&&(t+=this._getJsonBody(e.jsonData)),t},getRequest:function(e){var t=this.getKey(e);return this.getValue(t)},initRequest:function(e){this.log("INIT CACHING REQUEST: "+(null==e?void 0:e.url));var t=this.getKey(e);this.setValue(t,{queue:[],completed:!1})},queueRequest:function(e){var t=this._getRequestOrThrow(e),r=Object.assign({},e),n=t.queue.push(r);this.updateRequest(e,t);var i=n-1;return this.log("QUEUE REQUEST (queuePosition = "+i+"): "+(null==e?void 0:e.url)),i},dequeueRequest:function(e,t){null==t&&(t=0);var r=this._getRequestOrThrow(e),n=r.queue[t];if(null!=n)return this.log("DEQUEUE REQUEST (queuePosition = "+t+"): "+(null==e?void 0:e.url)),r.queue.splice(t,1),this.updateRequest(e,r),n},updateRequest:function(e,t){this.log("UPDATE REQUEST: "+(null==e?void 0:e.url));var r=this.getKey(e);this.updateValue(r,t)},removeRequest:function(e){this.log("REMOVE REQUEST: "+(null==e?void 0:e.url));var t=this.getKey(e);this.removeValue(t)}}),Ext.define("Terrasoft.data.queries.BatchQuery",{extend:"Terrasoft.BaseObject",alternateClassName:"Terrasoft.BatchQuery",mixins:{serializable:"Terrasoft.Serializable"},operationType:Terrasoft.QueryOperationType.BATCH,queries:null,queriesMap:null,_queryIndex:null,includeProcessExecutionData:!0,publishProcessExecutionData:!0,_request:null,constructor:function(){this.callParent(arguments),this.queries=[],this.queriesMap={},this._queryIndex=-1,Terrasoft.AjaxProvider.on("requestaborted",this._onRequestAborted,this)},_hasQuery:function(e){return!!Ext.Array.findBy(this.queries,(function(t){return t.query&&t.query.instanceId===e}))},_onRequestAborted:function(e){var t=e&&e.options&&e.options.instanceId;t&&t!==this.instanceId&&!Ext.isEmpty(this.queries)&&(this._abortedQueries=this._abortedQueries||[],this._hasQuery(t)&&(this._abortedQueries.push(t),this._abortedQueries.length===this.queries.length&&Terrasoft.AjaxProvider.abortRequestByInstanceId(this.instanceId)))},parseResponse:function(e,t,r){if(this.publishProcessExecutionData&&Terrasoft.ProcessExecutionDataCollector.add(e.processExecutionData),Ext.isFunction(t)&&t.call(r||this,e),e.success){var n=e.queryResults;n&&0!==n.length&&Terrasoft.each(this.queries,(function(t){var r=t.query,i=n.shift();t.callback&&!Terrasoft.contains(this._abortedQueries,r.instanceId)&&(i.success=e.success,r.parseResponse(i,t.callback,t.scope))}),this)}},getSerializableObject:function(e){var t=e.items=[];this.includeProcessExecutionData&&Terrasoft.Features.getIsEnabled("GetProcessStepsViaResponse")&&(e.includeProcessExecutionData=!0),Terrasoft.each(this.queries,(function(e){var r=e.query,n={};r instanceof Terrasoft.EntitySchemaQuery&&(n.__type="Terrasoft.Nui.ServiceModel.DataContract.SelectQuery"),r instanceof Terrasoft.InsertQuery&&(n.__type="Terrasoft.Nui.ServiceModel.DataContract.InsertQuery"),r instanceof Terrasoft.UpdateQuery&&(n.__type="Terrasoft.Nui.ServiceModel.DataContract.UpdateQuery"),r instanceof Terrasoft.UpdateLocalizationQuery&&(n.__type="Terrasoft.Nui.ServiceModel.DataContract.UpdateLocalizationQuery"),r instanceof Terrasoft.SelectLocalizationQuery&&(n.__type="Terrasoft.Nui.ServiceModel.DataContract.SelectLocalizationQuery"),r instanceof Terrasoft.DeleteQuery&&(n.__type="Terrasoft.Nui.ServiceModel.DataContract.DeleteQuery"),Ext.apply(n,this.getSerializableProperty(r)),t.push(n)}),this),e.instanceId=this.instanceId},add:function(e,t,r){if(!e)throw new Terrasoft.ArgumentNullOrEmptyException({argumentName:"query"});this.queries.push({query:e,callback:t||null,scope:r||this})},addNamedQuery:function(e,t,r,n){this.add(e,r,n),++this._queryIndex,this.queriesMap[t]=this._queryIndex},execute:function(e,t){this._request=Terrasoft.DataProvider.executeQuery(this,(function(r){this.parseResponse(r,e,t)}),this)},abortQuery:function(){var e=this._request;e&&!e.completed&&Terrasoft.AjaxProvider.abortRequest(e)},onDestroy:function(){this.abortQuery(),Terrasoft.AjaxProvider.un("requestaborted",this._onRequestAborted,this),this.queries=null,this.queriesMap=null,this.callParent(arguments)}}),Ext.define("Terrasoft.core.DeleteSysSettingRequest",{alternateClassName:"Terrasoft.DeleteSysSettingRequest",extend:"Terrasoft.BaseRequest",contractName:"DeleteSysSettingRequest",primaryColumnValues:null,validate:function(){if(this.callParent(arguments),Ext.isEmpty(this.primaryColumnValues))throw new Terrasoft.NullOrEmptyException({message:"primaryColumnValues"});return!0},getSerializableObject:function(e){this.callParent(arguments),e.primaryColumnValues=this.primaryColumnValues}}),Ext.define("Terrasoft.core.SysSettingSaveRequest",{alternateClassName:"Terrasoft.SysSettingSaveRequest",extend:"Terrasoft.BaseRequest",contractName:null,propertyColumnName:{id:"Id",name:"Name",code:"Code",description:"Description",valueTypeName:"ValueTypeName",referenceSchemaUId:"ReferenceSchemaUId",isPersonal:"IsPersonal",isCacheable:"IsCacheable",isSSPAvailable:"IsSSPAvailable"},id:null,name:null,code:null,description:null,valueTypeName:null,referenceSchemaUId:null,isPersonal:null,isCacheable:null,isSSPAvailable:null,validate:function(){this.callParent(arguments);var e=["id","name","code"];return Terrasoft.each(e,(function(e){if(Ext.isEmpty(this[e]))throw new Terrasoft.NullOrEmptyException({message:e})}),this),!0},getSerializableObject:function(e){for(var t in this.callParent(arguments),this.propertyColumnName)e[t]=this[t]}}),Ext.define("Terrasoft.core.InsertSysSettingRequest",{alternateClassName:"Terrasoft.InsertSysSettingRequest",extend:"Terrasoft.SysSettingSaveRequest",contractName:"InsertSysSettingRequest"}),Ext.define("Terrasoft.core.UpdateSysSettingRequest",{alternateClassName:"Terrasoft.UpdateSysSettingRequest",extend:"Terrasoft.SysSettingSaveRequest",contractName:"UpdateSysSettingRequest"}),Ext.define("Terrasoft.data.filters.BaseFilterProvider",{extend:"Terrasoft.BaseObject",alternateClassName:"Terrasoft.BaseFilterProvider",defaultComparisonType:Terrasoft.ComparisonType.EQUAL,defaultAggregationComparisonType:Terrasoft.ComparisonType.GREATER,defaultImageLookupComparisonType:Terrasoft.ComparisonType.IS_NOT_NULL,filterTypeNames:["NONE","COMPARE","IS_NULL","BETWEEN","IN","EXISTS","FILTER_GROUP"],comparisonTypeNames:["BETWEEN","IS_NULL","IS_NOT_NULL","EQUAL","NOT_EQUAL","LESS","LESS_OR_EQUAL","GREATER","GREATER_OR_EQUAL","START_WITH","NOT_START_WITH","CONTAIN","NOT_CONTAIN","END_WITH","NOT_END_WITH","EXISTS","NOT_EXISTS"],filterComparisonTypes:{COMPARE:[Terrasoft.ComparisonType.EQUAL,Terrasoft.ComparisonType.NOT_EQUAL,Terrasoft.ComparisonType.START_WITH,Terrasoft.ComparisonType.NOT_START_WITH,Terrasoft.ComparisonType.CONTAIN,Terrasoft.ComparisonType.NOT_CONTAIN,Terrasoft.ComparisonType.END_WITH,Terrasoft.ComparisonType.NOT_END_WITH,Terrasoft.ComparisonType.LESS,Terrasoft.ComparisonType.LESS_OR_EQUAL,Terrasoft.ComparisonType.GREATER,Terrasoft.ComparisonType.GREATER_OR_EQUAL],IS_NULL:[Terrasoft.ComparisonType.IS_NULL,Terrasoft.ComparisonType.IS_NOT_NULL],IN:[Terrasoft.ComparisonType.EQUAL,Terrasoft.ComparisonType.NOT_EQUAL]},dataValueTypeNames:["GUID","TEXT",null,null,"INTEGER","FLOAT","MONEY","DATE_TIME","DATE","TIME","LOOKUP","ENUM","BOOLEAN","BLOB","IMAGE","CUSTOM_OBJECT"],dataValueTypeAggregationFunction:{INTEGER:[Terrasoft.AggregationType.SUM,Terrasoft.AggregationType.AVG,Terrasoft.AggregationType.MIN,Terrasoft.AggregationType.MAX],FLOAT:[Terrasoft.AggregationType.SUM,Terrasoft.AggregationType.AVG,Terrasoft.AggregationType.MIN,Terrasoft.AggregationType.MAX],MONEY:[Terrasoft.AggregationType.SUM,Terrasoft.AggregationType.AVG,Terrasoft.AggregationType.MIN,Terrasoft.AggregationType.MAX],DATE_TIME:[Terrasoft.AggregationType.MIN,Terrasoft.AggregationType.MAX],DATE:[Terrasoft.AggregationType.MIN,Terrasoft.AggregationType.MAX],TIME:[Terrasoft.AggregationType.MIN,Terrasoft.AggregationType.MAX]},aggregationTypeNames:["NONE","COUNT","SUM","AVG","MIN","MAX"],aggregationFunctionComparisonTypes:{COUNT:[Terrasoft.ComparisonType.GREATER,Terrasoft.ComparisonType.GREATER_OR_EQUAL,Terrasoft.ComparisonType.EQUAL,Terrasoft.ComparisonType.NOT_EQUAL,Terrasoft.ComparisonType.LESS,Terrasoft.ComparisonType.LESS_OR_EQUAL],SUM:[Terrasoft.ComparisonType.GREATER,Terrasoft.ComparisonType.GREATER_OR_EQUAL,Terrasoft.ComparisonType.EQUAL,Terrasoft.ComparisonType.NOT_EQUAL,Terrasoft.ComparisonType.LESS,Terrasoft.ComparisonType.LESS_OR_EQUAL],AVG:[Terrasoft.ComparisonType.GREATER,Terrasoft.ComparisonType.GREATER_OR_EQUAL,Terrasoft.ComparisonType.EQUAL,Terrasoft.ComparisonType.NOT_EQUAL,Terrasoft.ComparisonType.LESS,Terrasoft.ComparisonType.LESS_OR_EQUAL],MIN:[Terrasoft.ComparisonType.GREATER,Terrasoft.ComparisonType.GREATER_OR_EQUAL,Terrasoft.ComparisonType.EQUAL,Terrasoft.ComparisonType.NOT_EQUAL,Terrasoft.ComparisonType.LESS,Terrasoft.ComparisonType.LESS_OR_EQUAL],MAX:[Terrasoft.ComparisonType.GREATER,Terrasoft.ComparisonType.GREATER_OR_EQUAL,Terrasoft.ComparisonType.EQUAL,Terrasoft.ComparisonType.NOT_EQUAL,Terrasoft.ComparisonType.LESS,Terrasoft.ComparisonType.LESS_OR_EQUAL]},aggregationOperationNames:["EXIST","AGGREGATION"],equalComparisonTypes:[Terrasoft.ComparisonType.EQUAL,Terrasoft.ComparisonType.NOT_EQUAL],isNullComparisonTypes:[Terrasoft.ComparisonType.IS_NOT_NULL,Terrasoft.ComparisonType.IS_NULL],booleanComparisonTypes:[Terrasoft.ComparisonType.EQUAL],textComparisonTypes:[Terrasoft.ComparisonType.CONTAIN,Terrasoft.ComparisonType.NOT_CONTAIN,Terrasoft.ComparisonType.START_WITH,Terrasoft.ComparisonType.NOT_START_WITH,Terrasoft.ComparisonType.END_WITH,Terrasoft.ComparisonType.NOT_END_WITH],numberDateComparisonTypes:[Terrasoft.ComparisonType.LESS,Terrasoft.ComparisonType.LESS_OR_EQUAL,Terrasoft.ComparisonType.GREATER,Terrasoft.ComparisonType.GREATER_OR_EQUAL],getLeftExpression:function(){},getComparisonTypeName:function(e){return this.comparisonTypeNames[e]},getComparisonTypeCaption:function(e){var t=this.getComparisonTypeName(e);return Terrasoft.Resources.ComparisonType[t]},getComparisonTypeByCaption:function(e){var t=_.values(Terrasoft.Resources.ComparisonType).indexOf(e),r=_.keys(Terrasoft.Resources.ComparisonType)[t];return Terrasoft.ComparisonType[r]},getAggregationTypeName:function(e){return this.aggregationTypeNames[e]},getAggregationTypeCaption:function(e){var t=this.getAggregationTypeName(e);return Terrasoft.Resources.AggregationType[t]},getAggregationTypeByCaption:function(e){var t=_.values(Terrasoft.Resources.AggregationType).indexOf(e),r=_.keys(Terrasoft.Resources.AggregationType)[t];return Terrasoft.AggregationType[r]},getAllowedComparisonTypes:function(e){var t=[];if(e.isAggregative){var r=e.leftExpression.aggregationType;t=this.getAggregationFilterComparisonTypes(r)}else{var n=Terrasoft.getFilterDataValueType(e);t=this.getSimpleFilterComparisonTypes(n)}return e.dataValueType===Terrasoft.DataValueType.BOOLEAN?this.booleanComparisonTypes:t},getSimpleFilterComparisonTypes:function(e){var t=[];if(e!==Terrasoft.DataValueType.IMAGELOOKUP)switch(t=t.concat(this.equalComparisonTypes),e){case Terrasoft.DataValueType.TEXT:case Terrasoft.DataValueType.SHORT_TEXT:case Terrasoft.DataValueType.MEDIUM_TEXT:case Terrasoft.DataValueType.LONG_TEXT:case Terrasoft.DataValueType.MAXSIZE_TEXT:case Terrasoft.DataValueType.GUID:t=t.concat(this.textComparisonTypes);break;case Terrasoft.DataValueType.INTEGER:case Terrasoft.DataValueType.MONEY:case Terrasoft.DataValueType.FLOAT:case Terrasoft.DataValueType.DATE_TIME:case Terrasoft.DataValueType.DATE:case Terrasoft.DataValueType.TIME:t=t.concat(this.numberDateComparisonTypes)}return t=t.concat(this.isNullComparisonTypes)},getAggregationFilterComparisonTypes:function(e){var t=this.aggregationTypeNames[e];return this.aggregationFunctionComparisonTypes[t]},getAllowedAggregationOperations:function(e){var t=[],r=e.filterType===Terrasoft.FilterType.EXISTS,n=e.leftExpression.aggregationType;if(r||n===Terrasoft.AggregationType.COUNT)t.push(this.getComparisonTypeCaption(Terrasoft.ComparisonType.EXISTS)),t.push(this.getComparisonTypeCaption(Terrasoft.ComparisonType.NOT_EXISTS)),t.push(this.getAggregationTypeCaption(Terrasoft.AggregationType.COUNT));else{var i=e.dataValueType,a=this.dataValueTypeNames[i],s=this.dataValueTypeAggregationFunction[a];Terrasoft.each(s,(function(e){t.push(this.getAggregationTypeCaption(e))}),this)}return t},getAggregationOperation:function(e){var t;if(e.filterType===Terrasoft.FilterType.EXISTS)t=this.getComparisonTypeCaption(e.comparisonType);else{var r=e.leftExpression;t=this.getAggregationTypeCaption(r.aggregationType)}return t},setRightExpressionValue:function(e,t){var r=Ext.create("Terrasoft.ParameterExpression",{parameterDataType:e.dataValueType,parameterValue:t});e.setRightExpression(r)},setRightExpressionsValues:function(e,t){if(!e||!Ext.isDefined(e.setRightExpressions))throw new Terrasoft.UnsupportedTypeException;if(t&&!Ext.isArray(t))throw new Terrasoft.UnsupportedTypeException;var r=[];Terrasoft.each(t,(function(e){var t=Ext.create("Terrasoft.ParameterExpression",{parameterValue:e,parameterDataType:Terrasoft.DataValueType.LOOKUP});r.push(t)}),this),e.setRightExpressions(r)},createDefaultFilter:Terrasoft.abstractFn,getFilterTypeByAggregationOperationCaption:function(e){return this.getComparisonTypeByCaption(e)?Terrasoft.FilterType.EXISTS:Terrasoft.FilterType.COMPARE},getMatchingFilterType:function(e){return e.isAggregative?Terrasoft.FilterType.COMPARE:this.getSimpleFilterMatchingFilterType(e)},getSimpleFilterMatchingFilterType:function(e){var t=null,r=e.filterType,n=e.comparisonType,i=this.filterTypeNames[r];if(this.filterComparisonTypes[i].indexOf(n)>-1)t=r;else if(n===Terrasoft.ComparisonType.IS_NULL||n===Terrasoft.ComparisonType.IS_NOT_NULL)t=Terrasoft.FilterType.IS_NULL;else{var a=e.dataValueType;t=a===Terrasoft.DataValueType.LOOKUP||a===Terrasoft.DataValueType.ENUM?Terrasoft.FilterType.IN:Terrasoft.FilterType.COMPARE}return t},getAllowedFilterManageOperations:function(){return{canViewEnabled:!0,canEditEnabled:!0,canEditLeftExpression:!0,canEditRightExpression:!0,canEditComparisonType:!0,canRemove:!0,canSelect:!0}},getAllowedFilterGroupManageOperations:function(){return{canViewEnabled:!0,canEditEnabled:!0,canViewGroupType:!0,canEditGroupType:!0,canAddFilters:!0,canRemove:!0,canSelect:!0}},subscribeForFilterSchemaName:Terrasoft.emptyFn,getAllowedMacrosTypes:function(){return[]},constructor:function(){this.callParent(arguments),this.addEvents("replaceFilter")}}),Object.defineProperty(Terrasoft.BaseFilterProvider.prototype,"logicalComparisonTypes",{get:function(){return this.booleanComparisonTypes},set:function(e){this.booleanComparisonTypes=e,this.log(Ext.String.format(Terrasoft.Resources.ObsoleteMessages.ObsoletePropertyMessage,"logicalComparisonTypes","booleanComparisonTypes"))},enumerable:!0}),Ext.define("Terrasoft.data.filters.FilterManager",{extend:"Terrasoft.BaseObject",alternateClassName:"Terrasoft.FilterManager",filterClasses:["Terrasoft.BaseFilter","Terrasoft.CompareFilter","Terrasoft.IsNullFilter","Terrasoft.BetweenFilter","Terrasoft.InFilter","Terrasoft.ExistsFilter","Terrasoft.FilterGroup","Terrasoft.AggregationFilter"],provider:null,rootSchemaName:"",filters:null,config:null,constructor:function(e){this.callParent(arguments),this.addEvents("changeFilter","addFilter","removeFilter","rootFiltersChanged");var t=this.provider;t&&(this.rootSchemaName=t.rootSchemaName,t.on("replaceFilter",this.replaceFilter,this))},setFilters:function(e){this.filters!==e&&(this.unSubscribeForFiltersTreeEvents(this.filters),e.rootSchemaName=this.rootSchemaName,this.filters=e,e.getCount()>0?this.setRootFiltersMetaData(e,(function(){this.subscribeForFiltersTreeEvents(e),this.fireEvent("rootFiltersChanged",e,this)}),this):(this.subscribeForFiltersTreeEvents(e),this.fireEvent("rootFiltersChanged",e,this)))},setRootFiltersMetaData:function(e,t,r){e.serializationInfo={serializeFilterManagerInfo:!0},Terrasoft.DataProvider.getFiltersMetaData(e,(function(e){this.setFilterGroupMetaData(e),t.call(r)}),this)},setFilterGroupMetaData:function(e){Terrasoft.each(e.items,(function(e,t){e.filterType===Terrasoft.FilterType.FILTER_GROUP?this.setFilterGroupMetaData(e,t):this.setFilterMetaData(e,t)}),this)},setFilterMetaData:function(e,t){var r=this.getItemByKey(t);if(r.dataValueType=e.dataValueType,r.dataValueType===Terrasoft.DataValueType.DATE_TIME&&(r.trimDateTimeParameterToDate=!0),Terrasoft.Features.getIsEnabled("DisableForceUpdateCaptionForLeftExpression")){var n=e.leftExpressionCaption;if(new RegExp("\\.Id$","ig").test(n)){var i=n.split(".");n=(i=i.slice(0,i.length-1)).join(".")}r.leftExpressionCaption=n}else r.updateLeftExpressionCaption(e);r.referenceSchemaName=e.referenceSchemaName},subscribeForFiltersTreeEvents:function(e){e&&(this.subscribeForFilterEvents(e),e.each((function(e){this.subscribeForFilterEvents(e),e.filterType===Terrasoft.FilterType.FILTER_GROUP&&this.subscribeForFiltersTreeEvents(e)}),this))},unSubscribeForFiltersTreeEvents:function(e){e&&(e.each((function(e){this.unSubscribeForFilterEvents(e),e.filterType===Terrasoft.FilterType.FILTER_GROUP&&this.unSubscribeForFiltersTreeEvents(e)}),this),this.unSubscribeForFilterEvents(e))},subscribeForFilterEvents:function(e){if(e.filterType===Terrasoft.FilterType.FILTER_GROUP?(e.on("add",this.onFiltersAddFilter,this),e.on("remove",this.onFiltersRemoveFilter,this),e.on("changeItem",this.onFiltersChangeFilter,this),e.parentCollection||e.on("logicalOperationChanged",this.onFiltersChangeFilter,this)):e.on("comparisonTypeChange",this.onFilterComparisonTypeChanged,this),e.isAggregative){var t=e.subFilters?e.subFilters:e.leftExpression.subFilters;this.subscribeForFiltersTreeEvents(t)}},unSubscribeForFilterEvents:function(e){if(e.filterType===Terrasoft.FilterType.FILTER_GROUP?(e.un("add",this.onFiltersAddFilter,this),e.un("remove",this.onFiltersRemoveFilter,this),e.un("changeItem",this.onFiltersChangeFilter,this),e.parentCollection||e.un("logicalOperationChanged",this.onFiltersChangeFilter,this)):e.un("comparisonTypeChange",this.onFilterComparisonTypeChanged,this),e.isAggregative){var t=e.subFilters?e.subFilters:e.leftExpression.subFilters;this.unSubscribeForFiltersTreeEvents(t)}},getItemByKey:function(e,t){var r=null,n=t||this.filters;if(n.contains(e))r=n.get(e);else for(var i=n.getItems(),a=0,s=i.length;a<s;a++){var o=i[a];if(o.filterType===Terrasoft.FilterType.FILTER_GROUP&&(r=this.getItemByKey(e,o)),o.isAggregative&&(r=this.getItemInAggregationFilterByKey(o,e)),r)break}return r},getItemInAggregationFilterByKey:function(e,t){var r=e.subFilters?e.subFilters:e.leftExpression.subFilters;return r.key===t?r:this.getItemByKey(t,r)},onFiltersChangeFilter:function(e){this.fireEvent("changeFilter",e,e.getParentFilters(),this)},onFiltersAddFilter:function(e,t){this.subscribeForFilterEvents(e),this.fireEvent("addFilter",e,e.getParentFilters(),t,this)},onFiltersRemoveFilter:function(e,t){this.unSubscribeForFilterEvents(e),this.fireEvent("removeFilter",e,e.getParentFilters(),t,this)},onFilterComparisonTypeChanged:function(e){var t=this.provider.getMatchingFilterType(e);if(e.filterType!==t){var r=Ext.create(this.filterClasses[t],{leftExpression:e.leftExpression,dataValueType:e.dataValueType,leftExpressionCaption:e.leftExpressionCaption,comparisonType:e.comparisonType,referenceSchemaName:e.referenceSchemaName});this.replaceFilter(e,r)}},replaceFilter:function(e,t){var r=e.key,n=e.getParentFilters(),i=n.indexOf(e);n.suspendEvents(!1);try{n.remove(e),this.unSubscribeForFilterEvents(e),n.insert(i,r,t),this.subscribeForFilterEvents(t)}finally{n.resumeEvents()}n.filterChanged(t)},serializeFilters:function(){var e=this.filters.getDefSerializationInfo();return e.serializeFilterManagerInfo=!0,this.filters.serialize(e)},addFilter:function(e,t){if(!e)throw new Terrasoft.NullOrEmptyException({message:Terrasoft.Resources.FilterManager.FilterGroupIsNotDefined});var r=e.rootSchemaName?e.rootSchemaName:e.parentCollection.rootSchemaName;e.rootSchemaName=r,this.provider.subscribeForFilterSchemaName(r),this.provider.rootSchemaName=r,this.provider.getLeftExpression((function(r){var n=this.provider.createDefaultFilter(r);n.dataValueType!==Terrasoft.DataValueType.DATE_TIME&&n.dataValueType!==Terrasoft.DataValueType.DATE||(n.trimDateTimeParameterToDate=!0),t?this.replaceFilter(t,n):e.addItem(n)}),this,t)},setEnableFilterValueByKey:function(e,t){var r=this.getItemByKey(e)||this.filters;r.isEnabled=t,this.onFiltersChangeFilter(r)},groupFilters:function(e){if(e&&0!==e.length){var t=e[0],r=t.getParentFilters();if(r){var n=r.indexOf(t),i=Terrasoft.createFilterGroup(),a=Terrasoft.generateFilterKey();i.rootSchemaName=r.rootSchemaName,r.insert(n,a,i),Terrasoft.each(e,(function(e){var t=e.key;r.remove(e),i.add(t,e)}),this)}}},unGroupFilters:function(e){if(e&&e instanceof Terrasoft.FilterGroup){var t=e.getParentFilters();if(t){var r=t.indexOf(e);t.remove(e);for(var n=e.getItems(),i=0,a=n.length;i<a;i++){var s=n[0],o=s.key;e.remove(s),t.insert(r+i,o,s)}}}},moveUp:function(e){if(e){var t=e.getParentFilters();if(t){var r=e.key,n=t.indexOf(e);if(0===n){var i=t.getParentFilters();if(!i)return;t.remove(e);var a=i.indexOf(t);i.insert(a,r,e)}else{var s=t.getByIndex(n-1);t.remove(e),s.filterType===Terrasoft.FilterType.FILTER_GROUP?s.add(r,e):t.insert(n-1,r,e)}}}},moveDown:function(e){if(e){var t=e.getParentFilters();if(t){var r=e.key,n=t.indexOf(e);if(n===t.getCount()-1){var i=t.getParentFilters();if(!i)return;t.remove(e);var a=i.indexOf(t);i.insert(a+1,r,e)}else{var s=t.getByIndex(n+1);t.remove(e),s.filterType===Terrasoft.FilterType.FILTER_GROUP?s.insert(0,r,e):t.insert(n+1,r,e)}}}},getRightExpressionDisplayValue:function(e){return Terrasoft.getRightExpressionDisplayValue(e)},getRightExpressionValue:function(e){return Terrasoft.getRightExpressionValue(e)},toggleFilterGroupLogicalOperation:function(e){var t=e.logicalOperation===Terrasoft.LogicalOperatorType.AND?Terrasoft.LogicalOperatorType.OR:Terrasoft.LogicalOperatorType.AND;e.setLogicalOperation(t)},toggleFilterBooleanValue:function(e){if(e.dataValueType!==Terrasoft.DataValueType.BOOLEAN)throw new Terrasoft.UnsupportedTypeException;var t=e.rightExpression.parameter.getValue();this.setRightExpressionValue(e,!t)},deleteItem:function(e){e.getParentFilters().remove(e)},setRightExpressionValue:function(e,t,r,n){this.provider.setRightExpressionValue(e,t,r,n)},setRightExpressionsValues:function(e,t,r){this.provider.setRightExpressionsValues(e,t,r)},setComparisonType:function(e,t){e.setComparisonType(t)},setAggregationOperation:function(e,t){var r=this.provider,n=r.getFilterTypeByAggregationOperationCaption(t),i=e.leftExpression,a=r.getComparisonTypeByCaption(t),s=r.getAggregationTypeByCaption(t),o=e.filterType!==n||!Ext.isEmpty(a)&&e.comparisonType!==a,l=e.subFilters?e.subFilters:i.subFilters,c={};if(n===Terrasoft.FilterType.EXISTS?(e.setLeftExpression(Ext.create("Terrasoft.ColumnExpression",{columnPath:i.columnPath})),e.comparisonType=a,c={subFilters:l}):(a=this.provider.defaultAggregationComparisonType,s===Terrasoft.AggregationType.COUNT&&(e.dataValueType=Terrasoft.DataValueType.INTEGER),i.functionArgument?(i.functionArgument.aggregationType=s,e.setLeftExpression(Ext.create("Terrasoft.FunctionExpression",{functionType:i.functionType,datePartType:i.datePartType,functionArgument:i.functionArgument,aggregationType:s}))):e.setLeftExpression(Ext.create("Terrasoft.AggregationQueryExpression",{columnPath:i.columnPath,subFilters:l,aggregationType:s}))),o){Ext.apply(c,{leftExpression:e.leftExpression,dataValueType:e.dataValueType,leftExpressionCaption:e.leftExpressionCaption,comparisonType:a,referenceSchemaName:e.referenceSchemaName,isAggregative:!0});var u=Ext.create(this.filterClasses[n],c);this.replaceFilter(e,u)}},getAllowedAggregationOperations:function(e){return this.provider.getAllowedAggregationOperations(e)},getAggregationOperation:function(e){return this.provider.getAggregationOperation(e)},getAllowedComparisonTypes:function(e){return this.provider.getAllowedComparisonTypes(e)},getAllowedFilterGroupManageOperations:function(e){return this.provider.getAllowedFilterGroupManageOperations(e)},getAllowedFilterManageOperations:function(e){return this.provider.getAllowedFilterManageOperations(e)},getLookupFilterValue:function(e){this.provider.getLookupFilterValue(e)},onDestroy:function(){var e=this.filters;this.unSubscribeForFiltersTreeEvents(e);var t=this.provider;t&&t.un("replaceFilter",this.replaceFilter,this),this.callParent(arguments)}}),Ext.define("Terrasoft.core.MsgChannel",{extend:"Terrasoft.core.BaseObject",alternateClassName:"Terrasoft.MsgChannel",msgProvider:null,name:"",hasOwnSerializer:!1,constructor:function(e){this.callParent(arguments),this.addEvents(Terrasoft.EventName.ON_MESSAGE,Terrasoft.EventName.ON_CHANNEL_CLOSED),e.msgProvider&&(this.msgProvider=e.msgProvider,this.msgProvider.on(Terrasoft.EventName.ON_MESSAGE,this.providerChannelMsgEventHandler,this),this.msgProvider.on(Terrasoft.EventName.ON_CHANNEL_CLOSED,this.channelClosedHandler,this))},channelMsgHandler:function(e){this.fireEvent(Terrasoft.EventName.ON_MESSAGE,this,e)},providerChannelMsgEventHandler:Terrasoft.emptyFn,channelClosedHandler:function(){this.fireEvent(Terrasoft.EventName.ON_CHANNEL_CLOSED,this)},postMessage:function(e){this.msgProvider.postMessage(e)},postRawMessage:function(e){this.msgProvider.postRawMessage(e)}}),Object.defineProperty(Terrasoft.core.MsgChannel.prototype,"isOpened",{get:function(){return!!this.msgProvider&&this.msgProvider.isOpened}}),Ext.define("Terrasoft.core.WebSocketChannel",{extend:"Terrasoft.core.MsgChannel",alternateClassName:"Terrasoft.WebSocketChannel",webSocketConnection:null,serviceUrl:"",constructor:function(e){this.callParent(arguments),this.addEvents(Terrasoft.EventName.ON_CONNECTION_INITIALIZED,Terrasoft.EventName.ON_ERROR),e.serviceUrl&&(this.serviceUrl=e.serviceUrl,this.init())},setupWebSocketHandlers:function(){this.webSocketConnection.onopen=this.webSocketOpen.bind(this),this.webSocketConnection.onmessage=function(e){this.channelMsgHandler(e.data)}.bind(this),this.webSocketConnection.onclose=this.channelClosedHandler.bind(this),this.webSocketConnection.onerror=this.webSocketError.bind(this)},webSocketOpen:function(){this.log("WebSocket-connection opened for url:"+this.serviceUrl),this.fireEvent(Terrasoft.EventName.ON_CONNECTION_INITIALIZED,this)},webSocketError:function(){this.fireEvent(Terrasoft.EventName.ON_ERROR,this)},getConnectionState:function(){return this.webSocketConnection?this.webSocketConnection.readyState:Terrasoft.SocketConnectionState.NOT_INITIALIZED},init:function(){this.webSocketConnection&&this.webSocketConnection.readyState===Terrasoft.SocketConnectionState.OPEN||(this.webSocketConnection=new WebSocket(this.serviceUrl),Ext.isIE&&this.webSocketConnection&&(window.onbeforeunload=function(){this.webSocketConnection=null}.bind(this)),this.setupWebSocketHandlers())},close:function(){this.webSocketConnection&&this.webSocketConnection.close()},ping:function(){var e={Id:Terrasoft.generateGUID(),Header:{Sender:Terrasoft.ServerChannelSender.CONSOLE_COMMAND,BodyTypeName:"System.String"},Body:"ping"},t=Terrasoft.encode(e);this.postMessage(t)},postMessage:function(e){this.webSocketConnection.send(e)},postRawMessage:function(e){this.webSocketConnection.send(e)}}),Object.defineProperty(Terrasoft.core.WebSocketChannel.prototype,"isOpened",{get:function(){return this.getConnectionState()===Terrasoft.SocketConnectionState.OPEN}}),Ext.define("Terrasoft.core.SignalRChannel",{extend:"Terrasoft.core.MsgChannel",alternateClassName:"Terrasoft.SignalRChannel",connection:null,serviceUrl:null,hasOwnSerializer:!0,state:Terrasoft.SocketConnectionState.NOT_INITIALIZED,constructor:function(e){this.callParent(arguments),this.addEvents(Terrasoft.EventName.ON_CONNECTION_INITIALIZED,Terrasoft.EventName.ON_ERROR),e.serviceUrl&&(this.serviceUrl=e.serviceUrl,this.init())},_setupSignalRHandlers:function(){this.connection.on("ServerMessage",this.channelMsgHandler.bind(this)),this.connection.start().then(this.onConnectionStarted.bind(this)).catch(this.onConnectionError.bind(this)),this.connection.onclose(this.channelClosedHandler.bind(this))},channelClosedHandler:function(){this.state=Terrasoft.SocketConnectionState.CLOSED,this.connection.off(),this.callParent()},onConnectionStarted:function(){this.log("SignalR hub connected for url: "+this.serviceUrl),this.state=Terrasoft.SocketConnectionState.OPEN,this.fireEvent(Terrasoft.EventName.ON_CONNECTION_INITIALIZED,this)},onConnectionError:function(){this.state=Terrasoft.SocketConnectionState.CLOSED,this.fireEvent(Terrasoft.EventName.ON_ERROR,this),this.fireEvent(Terrasoft.EventName.ON_CHANNEL_CLOSED,this)},getConnectionState:function(){return this.state},init:function(){var e=Ext.global.signalR;e?this._buildSignalRConnection(e):Terrasoft.require(["signalr"],this._buildSignalRConnection,this)},_buildSignalRConnection:function(e){this.connection||(this.connection=(new e.HubConnectionBuilder).withUrl(this.serviceUrl).build()),this.state=Terrasoft.SocketConnectionState.CONNECTING,this._setupSignalRHandlers()},_invoke:function(e){var t,r=arguments,n=this;Terrasoft.isAngularHost&&"navigation"===Zone.current.name?Zone.current.parent.run((function(){var e;(e=n.connection).invoke.apply(e,_toConsumableArray(r))})):(t=this.connection).invoke.apply(t,arguments)},close:function(){this.connection&&(this.connection.stop(),this.connection.off())},ping:function(){this._invoke.call(this,"Ping")},postMessage:function(e){this._invoke.call(this,"SendMessage",e)},postRawMessage:function(e){this._invoke.call(this,"SendRawMessage",e)}}),Object.defineProperty(Terrasoft.core.SignalRChannel.prototype,"isOpened",{get:function(){return this.getConnectionState()===Terrasoft.SocketConnectionState.OPEN}}),Ext.define("Terrasoft.core.ServerChannel",{extend:"Terrasoft.MsgChannel",alternateClassName:"Terrasoft.ServerChannel",singleton:!0,reconnectTimeout:2e3,maxReconnectCount:200,reconnectCount:0,_defaultMsgProviderClass:"Terrasoft.WebSocketChannel",commandMsgHandler:function(e){try{this.log("Server said: "+e.Body),this.fireEvent(Terrasoft.EventName.ON_MESSAGE,this,e)}catch(e){this.log("Error in command handler:"+e)}},broadcastMsgHandler:function(e){var t=Terrasoft.decode(e.Body);this.fireEvent(Terrasoft.ServerChannelSender.BROADCAST_MESSAGE,this,t)},_ptpMsgHandler:function(e){var t=Terrasoft.decode(e.Body);this.fireEvent(Terrasoft.ServerChannelSender.PTP_MESSAGE,this,t)},_translateDecodedMessage:function(e){switch(this.getSenderName(e)){case Terrasoft.ServerChannelSender.COMMAND_SERVICE:this.commandMsgHandler(e);break;case Terrasoft.ServerChannelSender.BROADCAST_MESSAGE:this.broadcastMsgHandler(e);break;case Terrasoft.ServerChannelSender.PTP_MESSAGE:this._ptpMsgHandler(e);break;default:this.fireEvent(Terrasoft.EventName.ON_MESSAGE,this,e)}},_channelMsgHandler:function(e){var t;if(this.msgProvider.hasOwnSerializer)this._translateDecodedMessage(e);else try{t=Ext.decode(e)}catch(e){this.log("Error on server msg decoding:"+e)}finally{this._translateDecodedMessage(t)}},getSenderName:function(e){return e&&e.Header.Sender},constructor:function(){var e={serviceUrl:Terrasoft.serviceUrl};this.reconnectCount=0;var t=Terrasoft.serverChannelMsgProviderClass||this._defaultMsgProviderClass,r=Ext.create(t,e),n={msgProvider:r};this.callParent([n]),r.on(Terrasoft.EventName.ON_CHANNEL_CLOSED,this.providerChannelClosedHandler,this),r.on(Terrasoft.EventName.ON_CONNECTION_INITIALIZED,this.providerChannelOpenedHandler,this),r.on(Terrasoft.EventName.ON_MESSAGE,this.providerChannelMsgEventHandler,this)},tryReconnect:function(){this.reconnectCount<this.maxReconnectCount?(this.init(),this.reconnectCount++):this.log("Max reconnect count exceeded. Reload page after the server will be available")},providerChannelClosedHandler:function(){var e=this,t=new Date;this.log(t+" Channel closed. Reconnect.."),"NETCOREAPP"===Terrasoft.appFramework?setTimeout((function(){return e.tryReconnect()}),this.reconnectTimeout):this.tryReconnect()},providerChannelOpenedHandler:function(){this.reconnectCount=0},channelMsgHandler:function(e){this._channelMsgHandler(e)},providerChannelMsgEventHandler:function(e,t){this._channelMsgHandler(t)},getConnectionState:function(){return this.msgProvider.getConnectionState()},createMessageObject:function(){return{Id:Terrasoft.generateGUID(),Header:{Sender:"",BodyTypeName:""},Body:null}},ping:function(){this.msgProvider.ping()},postMessage:function(e){var t=this.msgProvider.hasOwnSerializer?e:Terrasoft.encode(e);this.callParent([t])},broadcastMessage:function(e){var t={Id:Terrasoft.generateGUID(),Header:{Sender:Terrasoft.ServerChannelSender.BROADCAST_MESSAGE,BodyTypeName:"System.String"},Body:Terrasoft.encode(e)};this.postMessage(t)},getBroadcastMessage:function(e){var t=null;if(this.getSenderName(e)===Terrasoft.ServerChannelSender.BROADCAST_MESSAGE){var r=Terrasoft.decode(e.Body);Terrasoft.isEmptyObject(r)||(t=r)}return t},init:function(){try{this.msgProvider.init()}catch(e){this.log(e)}}}),Ext.define("Terrasoft.core.AjaxProvider",{extend:"Terrasoft.BaseObject",alternateClassName:"Terrasoft.AjaxProvider",singleton:!0,_requestsCachingOptions:null,_deferredExecutionDispatcher:null,extAjax:Ext.Ajax,maxDataLogSize:150,requests:{},_activeRequests:null,csrfCookieName:"BPMCSRF",requestsCache:Terrasoft.RequestsCache,_log:function(e){Terrasoft.isDebug&&console.log(e)},_markRequestAsNotActive:function(e){var t=this._activeRequests.indexOf(e);t>-1&&this._activeRequests.splice(t,1)},_dequeueCachedRequest:function(e){var t=e.options,r=e.queueId;this._isRequestCachingDisabled(t)||null==r||(this._log("DEQUEUEU REQUEST: "+t.url,", queueId: "+r),this.requestsCache.dequeueRequest(e.options,r))},_setResponseToCachedRequest:function(e,t,r){if(!this._isRequestCachingDisabled(e)){this._log("SET RESPONSE TO CACHED REQUEST: "+e.url);var n=this.requestsCache.getRequest(e);if(null!=n){var i=n.queue.concat([]);n.queue=[],n.response={body:r,success:t},n.completed=!0,this.requestsCache.updateRequest(e,n),this._log("CALL CALLBACK FOR QUEUED REQUESTS: "+e.url+", sucess: "+t),i.forEach((function(e){var n=e.scope,i=e.callback;!n.destroyed&&Ext.isFunction(i)?i.call(n,e,t,r):Terrasoft.Mask.clearAllMasks()}))}}},_sendNextQueuedCachedRequest:function(e){var t=this;if(!this._isRequestCachingDisabled(e)){this._log("SEND NEXT REQUEST FROM QUEUE: "+e.url);var r=this.requestsCache.getRequest(e);if(null!=r){var n=r.queue.concat([]);this._log("QUEUEUD REQUESTS: "+n.length),this.requestsCache.removeRequest(e),n.forEach((function(e){t.request(e)}),this)}}},_isRequestCachingDisabled:function(e){return!this._isRequestCachingEnabled(e)},_isRequestCachingEnabled:function(e){var t=this._requestsCachingOptions;if(!t)return!1;var r=this._isRequestExistInConfig(e,t.included||[]),n=this._isRequestExistInConfig(e,t.excluded||[]);return r&&!n},_isRequestExistInConfig:function(e,t){return t.some((function(t){var r=t.url,n=t.body,i=t.method,a=!1;if(r)try{a=new RegExp(r).test(e.url)}catch(e){console.error(e),a=!1}if(n)try{a=new RegExp(n).test(e.jsonData)}catch(e){console.error(e),a=!1}return i&&(a=e.method===i),a}))},_setRequestsCachingOptions:function(){var e=Terrasoft.RequestsCachingSettings&&Terrasoft.RequestsCachingSettings.options;if(e)try{this._requestsCachingOptions=JSON.parse(e)}catch(e){console.error(e)}},_sendResponseToCallback:function(e,t,r){var n=e.scope||{};e.callback.apply(n,[e,t,r]),performanceManager.stop(e.url)},constructor:function(){var e=this;this.callParent(arguments),this.addEvents("requestaborted"),this._activeRequests=[],this._deferredExecutionDispatcher=Ext.create("Terrasoft.DeferredExecution.Dispatcher",{allowExecutionPredicate:function(){return 0===e._activeRequests.length}}),this._setRequestsCachingOptions()},abortRequest:function(e){this._dequeueCachedRequest(e),this._markRequestAsNotActive(e),this._deferredExecutionDispatcher.notify(),this.extAjax.abort(e),"undefined"!=typeof performanceManager&&performanceManager.stop(e.url),e.terminated=!0,this.fireEvent("requestaborted",e)},abortRequestByInstanceId:function(e){var t=this.requests[e];t&&this.abortRequest(t)},request:function(e){var t,r=e.callback,n=e.scope||{},i=e.headers=e.headers||{},a=e.instanceId,s=this.getResponseFromCache(e);if(s)return this._sendResponseToCallback(e,!0,s),t;if(this._isRequestCachingEnabled(e)){var o=this.requestsCache.getRequest(e);if(o)return(s=o.response)?(this._log("GET RESPONSE FROM CACHED REQUEST: "+e.url+", success: "+s.success),this._sendResponseToCallback(e,s.success,s.body)):(t={options:e,queueId:this.requestsCache.queueRequest(e)},this._log("ADD REQUEST TO QUEUE: "+e.url+", queueId: "+t.queueId)),t;this._log("INIT CACHING REQUEST: "+e.url),this.requestsCache.initRequest(e)}e.scope=this,e.callback=function(e,i,s){if(this._markRequestAsNotActive(t),this._deferredExecutionDispatcher.notify(),performanceManager.stop(e.url),t.aborted||t.terminated)this._sendNextQueuedCachedRequest(t.options);else{var o=Terrasoft.ServerChannel;i&&o.getConnectionState()===Terrasoft.SocketConnectionState.CLOSED&&o.init(),i=this.validateResponse(e,i,s),!n.destroyed&&Ext.isFunction(r)?(r.call(n,e,i,s),this.setResponseToCache(e,s),this._setResponseToCachedRequest(e,i,s)):Terrasoft.Mask.clearAllMasks(),t.completed=!0,a&&delete this.requests[a]}},!1===e.useDefaultHeaders?Ext.Ajax.useDefaultXhrHeader=!1:i["X-Request-Source"]="ajax-provider",this.addCsrfTokenToHeaders(i);try{performanceManager.start(e.url),t=this.extAjax.request(e)}finally{Ext.Ajax.useDefaultXhrHeader=!0}return a&&(this.requests[a]=t),this._activeRequests.push(t),t},logResponseError:function(e,t){var r=Terrasoft.Resources.AjaxProvider.RequestErrorTemplate;r=(r=(r=r.replace("{errorText}",t)).replace("{errorStatus}",e.status)).replace("{errorStatusText}",e.statusText);var n,i,a=e.request.options;if(r=(r=r.replace("{requestUrl}",a.url)).replace("{requestMethod}",a.method),i=a.jsonData||a.xmlData||a.binaryData)if(Ext.isObject(i)||Ext.isArray(i)){var s=a.securitySensitiveFields||[];Terrasoft.each(s,(function(e){i[e]&&(i[e]="*******")})),n=Ext.encode(i)}else n=i;n&&n.length>this.maxDataLogSize&&(n=n.substring(0,this.maxDataLogSize)+"..."),r=r.replace("{requestData}",n),this.error(r)},validateResponse:function(e,t,r){if(t)return!0;var n="";return 401===r.status?window.location=Terrasoft.loaderBaseUrl:0===r.status&&(this.extAjax.abort(e),n=r.timedout?Terrasoft.Resources.AjaxProvider.RequestTimeout:Terrasoft.Resources.AjaxProvider.ServerUnavailable),this.logResponseError(r,n),!1},setResponseToCache:function(e,t){e.cacheLevel&&e.cacheKey&&Terrasoft[e.cacheLevel].setItem(e.cacheKey,t)},getResponseFromCache:function(e){var t=null;e.cacheLevel&&e.cacheKey&&(t=Terrasoft[e.cacheLevel].getItem(e.cacheKey));return t},addCsrfTokenToHeaders:function(e){var t=Ext.util.Cookies.get(this.csrfCookieName);null!==t&&(e[this.csrfCookieName]=t)},getDeferredExecutionDispatcher:function(){return this._deferredExecutionDispatcher}}),Ext.ns("Terrasoft.core"),Ext.define("Terrasoft.core.SysSettings",{extend:"Terrasoft.BaseObject",alternateClassName:"Terrasoft.SysSettings",singleton:!0,cachedSettings:null,_invalidSettingsCacheItems:null,postValuesMethodName:"PostSysSettingsValues",querySettingsMethodName:"QuerySysSettings",querySettingsRightsMethodName:"GetSysSettingsRightsRequest",setSettingsRightsMethodName:"SetSysSettingsRightsRequest",clearSysSettingsCacheMethodName:"ClearSysSettingsCacheRequest",lookupRowCount:15,lookupFilterType:Terrasoft.ComparisonType.START_WITH,_isInvalidCacheItem:function(e){return!!this._invalidSettingsCacheItems&&this._invalidSettingsCacheItems.indexOf(e)>=0},_addInvalidCacheItem:function(e){this._invalidSettingsCacheItems||(this._invalidSettingsCacheItems=[]),this._invalidSettingsCacheItems.indexOf(e)<0&&this._invalidSettingsCacheItems.push(e)},_removeInvalidCacheItem:function(e){if(this._invalidSettingsCacheItems){var t=this._invalidSettingsCacheItems.indexOf(e);t>=0&&this._invalidSettingsCacheItems.splice(t,1)}},_onSysSettingsChanged:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=t.Header,n=t.Body;r&&"SysSettingsChanged"===r.Sender&&this._addInvalidCacheItem(n)},constructor:function(){var e=this;this.callParent(arguments),this.cachedSettings={};var t=Terrasoft.preLoadedSysSettings;t&&Terrasoft.each(t,(function(t,r){var n=t.dataValueTypeName;n&&(t.dataValueType=Terrasoft.DataValueType[n]),t.isCacheable&&(e.cachedSettings[r]=e.getValue(t))}),this),Terrasoft.ServerChannel.on(Terrasoft.EventName.ON_MESSAGE,this._onSysSettingsChanged,this)},updateCachedValues:function(e){var t=this.cachedSettings;Terrasoft.each(e,(function(e,r){void 0!==t[r]&&(t[r]=Terrasoft.deepClone(e))}),this)},getValue:function(e){var t=e.dataValueType,r=e.value;return Terrasoft.isDateDataValueType(t)?r=Ext.isEmpty(r)?null:Terrasoft.parseDate(r):Terrasoft.isLookupDataValueType(t)&&(r=Ext.isEmpty(r)?null:{value:r,displayValue:e.displayValue}),r},updateSysSettingsValue:function(e,t,r){var n={isPersonal:!0===e.isPersonal},i=e.sysSettingsValues,a=n.sysSettingsValues={};Terrasoft.each(i,(function(e,t){var r;r=Ext.isDate(e)?Terrasoft.encodeDate(e):Ext.isObject(e)?e.value:e,a[t]=r}),this),Terrasoft.ServiceProvider.executeRequest(this.postValuesMethodName,n,(function(e){e.success&&this.updateCachedValues(i),Ext.callback(t,r||this,[e])}),this)},querySysSetting:function(e,t,r,n,i){var a={sysSettingsNameCollection:Ext.Array.from(e)};Terrasoft.ServiceProvider.executeRequest(this.querySettingsMethodName,a,(function(a){var s=a.values,o=n||{};Terrasoft.each(s,(function(e,t){var r=this.getValue(e);e.isCacheable?this.cachedSettings[t]=r:delete this.cachedSettings[t],this._isInvalidCacheItem(t)&&this._removeInvalidCacheItem(t),o[t]=r}),this),Ext.isFunction(t)&&(i?t.call(r||this,o[e[0]]):t.call(r||this,o))}),this)},querySysSettingsRaw:function(e,t,r){Terrasoft.ServiceProvider.executeRequest(this.querySettingsMethodName,{sysSettingsNameCollection:e},t,r)},querySysSettingsItem:function(e,t,r){!this.cachedSettings.hasOwnProperty(e)||this._isInvalidCacheItem(e)?this.querySysSetting([e],t,r,null,!0):t.call(r||this,this.cachedSettings[e])},getCachedSysSetting:function(e){return this.cachedSettings[e]},querySysSettings:function(e,t,r){var n=Terrasoft.deepClone(e),i={};Terrasoft.each(e,(function(e){var t=this.cachedSettings[e];void 0===t||this._isInvalidCacheItem(e)||(i[e]=t,n.splice(n.indexOf(e),1))}),this),0!==n.length?this.querySysSetting(n,t,r,i,!1):t.call(r||this,i)},postSysSettingsValue:function(e,t,r,n){var i={sysSettingsValues:{},isPersonal:!1};i.sysSettingsValues[e]=t,this.updateSysSettingsValue(i,r,n)},postPersonalSysSettingsValue:function(e,t,r,n){var i={sysSettingsValues:{},isPersonal:!0};i.sysSettingsValues[e]=t,this.updateSysSettingsValue(i,r,n)},postSysSettingsValues:function(e,t,r){this.updateSysSettingsValue(e,t,r)},getSysSettingsRightsAsync:function(){var e=_asyncToGenerator(regeneratorRuntime.mark((function e(t){var r,n,i,a,s,o;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.sysSettingsCode,n=Ext.create("Terrasoft.ParametrizedRequest",{contractName:this.querySettingsRightsMethodName,config:{sysSettingsCode:r}}),e.next=4,n.executeAsync();case 4:if(i=e.sent,a=i.success,s=i.readOperationCode,o=i.readWriteOperationCode,a){e.next=10;break}return e.abrupt("return",{readOperationCode:null,readWriteOperationCode:null});case 10:return e.abrupt("return",{readOperationCode:s,readWriteOperationCode:o});case 11:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),setSysSettingsRightsAsync:function(){var e=_asyncToGenerator(regeneratorRuntime.mark((function e(t){var r,n,i,a,s;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.sysSettingsCode,n=t.readOperationCode,i=t.readWriteOperationCode,a=Ext.create("Terrasoft.ParametrizedRequest",{contractName:this.setSettingsRightsMethodName,config:{sysSettingsCode:r,readOperationCode:n,readWriteOperationCode:i}}),e.next=4,a.executeAsync();case 4:if(s=e.sent,s.success){e.next=8;break}throw new Error(new Terrasoft.ItemNotFoundException);case 8:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),clearSysSettingsServerCache:function(){var e=_asyncToGenerator(regeneratorRuntime.mark((function e(){var t,r,n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=Ext.create("Terrasoft.BaseRequest",{contractName:this.clearSysSettingsCacheMethodName}),e.next=3,t.executeAsync();case 3:return r=e.sent,n=r.success,e.abrupt("return",n);case 6:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),getTypes:function(){return{Binary:{value:"Binary",displayValue:Terrasoft.Resources.DataValueType.BLOB},Boolean:{value:"Boolean",displayValue:Terrasoft.Resources.DataValueType.BOOLEAN},DateTime:{value:"DateTime",displayValue:Terrasoft.Resources.DataValueType.DATE_TIME},Date:{value:"Date",displayValue:Terrasoft.Resources.DataValueType.DATE},Time:{value:"Time",displayValue:Terrasoft.Resources.DataValueType.TIME},Integer:{value:"Integer",displayValue:Terrasoft.Resources.DataValueType.INTEGER},Money:{value:"Money",displayValue:Terrasoft.Resources.DataValueType.MONEY},Float:{value:"Float",displayValue:Terrasoft.Resources.DataValueType.FLOAT},Lookup:{value:"Lookup",displayValue:Terrasoft.Resources.DataValueType.LOOKUP},ShortText:{value:"ShortText",displayValue:Terrasoft.Resources.DataValueType.SHORT_TEXT},MediumText:{value:"MediumText",displayValue:Terrasoft.Resources.DataValueType.MEDIUM_TEXT},LongText:{value:"LongText",displayValue:Terrasoft.Resources.DataValueType.LONG_TEXT},Text:{value:"Text",displayValue:Terrasoft.Resources.DataValueType.TEXT},MaxSizeText:{value:"MaxSizeText",displayValue:Terrasoft.Resources.DataValueType.MAXSIZE_TEXT},SecureText:{value:"SecureText",displayValue:Terrasoft.Resources.DataValueType.SECURE_TEXT}}}}),Ext.define("Terrasoft.controls.LookupEdit",{extend:"Terrasoft.controls.BaseEdit",alternateClassName:"Terrasoft.LookupEdit",mixins:{expandableList:"Terrasoft.ExpandableList",leftIcon:"Terrasoft.LeftIcon",rightIcon:"Terrasoft.RightIcon"},disableInputDrop:!0,enableLeftIcon:!1,enableRightIcon:!0,rightIconClasses:["lookup-edit-right-icon"],value:null,displayValue:null,minSearchCharsCount:3,searchDelay:500,maxItemsInView:0,enableLocalFilter:!1,_autoSelectElement:function(){var e=this.listView,t=e&&e.getListItemsData()||[];return 1===Terrasoft.filter(t,(function(e){return e.value&&e.value!==Terrasoft.GUID_EMPTY}),this).length&&(e.selectElement(),!0)},init:function(){this.callParent(arguments),this.addEvents("loadVocabulary","paste"),Terrasoft.ControlsSettings&&Terrasoft.ControlsSettings.lookupMinSearchCharsCount>=0&&(this.minSearchCharsCount=Terrasoft.ControlsSettings.lookupMinSearchCharsCount),this.mixins.expandableList.init.call(this)},initDomEvents:function(){this.callParent(arguments),this.on("rightIconMouseOver",this.onRightIconMouseOver,this),this.on("rightIconMouseOut",this.onRightIconMouseOut,this),this.on("rightIconClick",this.onRightIconClick,this);var e=this.getEl();e.on("paste",this.onPaste,this);var t=Ext.getDoc();t.on("mousedown",this.onMouseDownCollapse,this)},onPaste:function(e){this.onKeyUp(e)},onRightIconMouseOver:function(){this.rendered&&this.rightIconEl.addCls("lookup-edit-right-icon-hover")},onRightIconMouseOut:function(){this.rendered&&this.rightIconEl.removeCls("lookup-edit-right-icon-hover")},onRightIconClick:function(){if(this.enabled&&!this.readonly){this.listView&&this.listView.visible&&this.expandList();var e=this.getTypedValue();this.fireEvent("loadVocabulary",{searchValue:e})}},onListElementSelected:function(e){this.mixins.expandableList.onListElementSelected.call(this,e)},onFocus:function(){this.callParent(arguments),this.mixins.expandableList.onFocus.call(this)},onBlur:function(){this.mixins.expandableList.onBlur.call(this),this.collapseList()},onMouseDownCollapse:function(e){var t=e.within(this.getWrapEl()),r=this.listView,n=Ext.isEmpty(r)||e.within(r.getWrapEl());if(!t&&!n&&(this.collapseList(),!this.value)){var i=this.getEl();if(i){var a=i.dom;a&&(a.value="")}}},onKeyDown:function(e){if(this.enabled){this.mixins.expandableList.onKeyDown.call(this,e,!0);var t=e.getKey(),r=this.typedValue,n=this.listView;switch(t){case e.DOWN:null===n?this.expandList():n.visible||this.expandList(r);break;case e.ENTER:if(e.ctrlKey||e.altKey||e.shiftKey)break;n&&n.visible&&(n.selectedItem||this._autoSelectElement())?n.fireEvent("listPressEnter"):(this.collapseList(),this.fireEvent("loadVocabulary",{searchValue:r}))}}},onKeyUp:function(e){if(this.enabled){this.clearTimer("timerId");var t=this.getTypedValue();e.isNavKeyPress()||e.getKey()===e.ENTER||t===this.typedValue||(this.typedValue=t,this.list&&this.list.clear(),this.changeValue(null)),e.isNavKeyPress()||(t.length>this.minSearchCharsCount?this.timerId=Ext.defer((function(){this.expandList(t)}),this.searchDelay,this):this.collapseList())}},changeValue:function(e){var t,r=this.value;if(t=null!==r&&null!==e?r.value!==e.value||r.displayValue!==e.displayValue:r!==e){this.value=e;var n=Terrasoft.deepClone(e);this.fireEvent("change",n,this),this.setClearIconVisibility()}return t},setValue:function(e){if(this.mixins.predictableIcon.valueChanged.call(this,e),this.changeValue(e)&&this.rendered){var t=e?e.displayValue:"";this.setDomValue(t),this.setElementDirection(this.getEl(),t),this.setElementDirection(this.getLinkEl(),t)}},getInitValue:function(){var e=this.value,t=e?Terrasoft.getTypedStringValue(e,Terrasoft.DataValueType.LOOKUP):"";return t?Terrasoft.encodeHtml(t):""},getBindConfig:function(){var e=this.callParent(arguments),t=this.mixins.expandableList.getBindConfig();Ext.apply(e,t);var r=this.mixins.leftIcon.getBindConfig();return Ext.apply(e,r),e},initBinding:function(e,t,r){var n=this.callParent(arguments),i=this.mixins.expandableList.initBinding.call(this,e,t,r);return Ext.apply(n,i)},getModelMethod:function(e,t){return this.mixins.expandableList.getModelMethod.call(this,e,t)},subscribeForEvents:function(e,t,r){this.callParent(arguments),this.mixins.expandableList.subscribeForEvents.call(this,e,t,r)},onDestroy:function(){this.mixins.expandableList.destroy.call(this),this.callParent(arguments)},setEnabled:function(){this.callParent(arguments),this.setClearIconVisibility()}}),Ext.ns("Terrasoft.controls.MessageBoxEnums"),Terrasoft.MessageBoxButtons={YES:{className:"Terrasoft.Button",caption:Terrasoft.Resources.Controls.MessageBox.ButtonCaptionYes,markerValue:Terrasoft.Resources.Controls.MessageBox.ButtonCaptionYes,returnCode:"yes"},NO:{className:"Terrasoft.Button",caption:Terrasoft.Resources.Controls.MessageBox.ButtonCaptionNo,markerValue:Terrasoft.Resources.Controls.MessageBox.ButtonCaptionNo,returnCode:"no"},CANCEL:{className:"Terrasoft.Button",caption:Terrasoft.Resources.Controls.MessageBox.ButtonCaptionCancel,markerValue:Terrasoft.Resources.Controls.MessageBox.ButtonCaptionCancel,returnCode:"cancel"},CLOSE:{className:"Terrasoft.Button",caption:Terrasoft.Resources.Controls.MessageBox.ButtonCaptionClose,markerValue:Terrasoft.Resources.Controls.MessageBox.ButtonCaptionClose,returnCode:"close"},OK:{className:"Terrasoft.Button",caption:Terrasoft.Resources.Controls.MessageBox.ButtonCaptionOk,markerValue:Terrasoft.Resources.Controls.MessageBox.ButtonCaptionOk,returnCode:"ok"},SAVE:{className:"Terrasoft.Button",caption:Terrasoft.Resources.Controls.MessageBox.ButtonCaptionSave,markerValue:Terrasoft.Resources.Controls.MessageBox.ButtonCaptionSave,returnCode:"save"}},Terrasoft.controls.MessageBoxEnums.Buttons=Terrasoft.MessageBoxButtons,Terrasoft.MessageBoxStyles={RED:{borderStyle:"ts-messagebox-border-style-red",buttonStyle:"red"},BLUE:{borderStyle:"ts-messagebox-border-style-blue",buttonStyle:"blue"}},Terrasoft.controls.MessageBoxEnums.Styles=Terrasoft.MessageBoxStyles,Ext.define("Terrasoft.controls.MessageBox",{extend:"Terrasoft.controls.Container",alternateClassName:"Terrasoft.MessageBox",singleton:!0,renderTo:null,defaultConfig:{caption:"",buttons:null,defaultButton:null,callback:null,scope:null,style:Terrasoft.MessageBoxStyles.BLUE,visible:!1,controlConfig:null,customWrapClass:null,handler:null},configClasses:{leftPositionClass:"ts-messagebox-center-left-position",centralPositionClass:"ts-messagebox-center-position",defaultButtonStyle:"t-btn-style-default",buttonFocus:"t-btn-focus"},handler:null,scope:null,visible:!1,caption:"",defaultButton:null,buttons:null,style:Terrasoft.MessageBoxStyles.BLUE,controlConfig:null,controlArray:null,controlContainer:"-custom-control",customWrapClass:null,useHtmlContent:!1,init:function(){this.callParent(arguments),this.addEvents("stateChanged"),this.on("stateChanged",this.onStateChanged,this)},onStateChanged:function(e){var t=this.handler,r=this.scope||this;if(this.updateCustomControl(),t){var n=Terrasoft.deepClone(this.controlConfig);this.controlConfig&&(this.controlConfig=null),t.call(r,e,n)}},initItems:function(){this.items=this.getMessageBoxItems(),this.callParent(arguments),this.attachButtonsHandlers()},add:function(){this.callParent(arguments),this.attachButtonsHandlers()},getTpl:function(){return['<div id="{id}-cover" class="{coverClass}"></div>','<div id="{id}-wrap" class="{boxClass}">','<tpl if="!inputbox">','<div id="{id}-caption" class="{captionClass}"<tpl if="direction"> dir="{direction}"</tpl>',">","{caption}","</div>","</tpl>",'<tpl if="inputbox">','<tpl if="caption">','<div id="{id}-caption" class="{inputboxCaptionClass}"<tpl if="direction"> dir="{direction}"</tpl>',">","{caption}","</div>","</tpl>",'<tpl if="!caption">','<div id="{id}-caption" class="{inputboxNoCaptionClass}">',"</div>","</tpl>",'<div id="{id}-inputbox">','<div id="{id}-custom-control" class="{customControl}">',"</div>","</div>","</tpl>",'<tpl for="items">',"<@item>","</tpl>","</div>"]},getMessageBoxItems:function(){var e=this.buttons;e||(e=[Terrasoft.MessageBoxButtons.CLOSE]);for(var t,r=[],n=0,i=e.length;n<i;n++){var a=e[n];Ext.isString(a)&&(a=a.toUpperCase(),void 0!==(t=Terrasoft.MessageBoxButtons[a])&&r.push(Ext.apply({},t))),Ext.isObject(a)&&r.push(a)}var s=this.defaultButton;null!==s&&void 0!==(t=r[s])&&(t.style=this.style.buttonStyle);var o=r.filter((function(e){return!e.style||e.style===Terrasoft.controls.ButtonEnums.style.DEFAULT}));if(r.length>0&&o.length===r.length&&(r[0].style=Terrasoft.controls.ButtonEnums.style.BLUE),null===this.defaultButton){var l=Terrasoft.findItem(r,(function(e){return e.style&&e.style!==Terrasoft.controls.ButtonEnums.style.DEFAULT}));l&&(this.defaultButton=l.index)}return r},initCustomControl:function(){this.destroyCustomControl(),this.wrapEl.on("click",this._onWrapElClick,this);var e=Terrasoft.deepClone(this.controlConfig);if(!e)return null;this.controlArray=[],Terrasoft.each(e,this._initCustomControlItem,this)},_onWrapElClick:function(e){this._linkClick(e)||e.stopEvent()},_linkClick:function(e){return"A"===e.target.tagName&&this.useHtmlContent},_initCustomControlItem:function(e,t){var r={className:"Terrasoft.Label",caption:e.caption||"",classes:{labelClass:["controlCaption"]},isRequired:Boolean(e.isRequired)},n={className:"Terrasoft.Label",caption:e.description||"",classes:{labelClass:["controlDescription"]},visible:Boolean(e.description)},i=Terrasoft.getControlConfigByDataValueType(e.dataValueType);i.markerValue=e.caption||"",e.customConfig&&Ext.apply(i,e.customConfig),e.dataValueType===Terrasoft.DataValueType.BOOLEAN?i.checked=e.value:i.value=e.value;var a=Ext.get(this.id+this.controlContainer);r.renderTo=i.renderTo=n.renderTo=a;var s={name:t,label:Ext.create(r.className,r),control:Ext.create(i.className,i),description:Ext.create(n.className,n)};this.controlArray.push(s)},initDomEvents:function(){this.callParent(arguments);var e=Ext.getDoc();e.on("keydown",this.onKeyDown,this)},onKeyDown:function(e){if(this.visible&&e.getKey()===e.ESC){e.stopPropagation(),this.setVisible(!1);var t=Terrasoft.MessageBoxButtons.CANCEL.returnCode;this.fireEvent("stateChanged",t,this)}},attachButtonsHandlers:function(){for(var e=this.items.items,t=0,r=e.length;t<r;t++)e[t].on("click",this.onButtonClick(this))},onButtonClick:function(e){return function(){var t=this.returnCode;e.setVisible(!1),e.fireEvent("stateChanged",t,e,this)}},reConfigurateButtonItems:function(){var e=this.items;e.each((function(e){e.destroy()}),this),e.clear();var t=this.getMessageBoxItems(this.buttons);this.add(t)},applyDefaultConfig:function(){Ext.apply(this,this.defaultConfig)},reRender:function(){this.renderTo=Ext.getBody(),this._removeCoverEl(),this.callParent(arguments)},onAfterRender:function(){this.callParent(arguments),this.initCustomControl(),this.applyAfterRenderClasses()},onAfterReRender:function(){this.callParent(arguments),this.initCustomControl(),this.applyAfterRenderClasses()},applyAfterRenderClasses:function(){var e=this.wrapEl,t=this.configClasses;e.removeCls(t.leftPositionClass),e.addCls(t.centralPositionClass);var r=this.defaultButton;if(null!==r){var n=this.items.items[r];if(n){var i=n.selectors.wrapEl,a=Ext.query(i)[0],s=Ext.get(a);s.addCls(this.configClasses.buttonFocus),s.focus()}}},getTplData:function(){var e=this.callParent(arguments),t=this.getMessageCaption(),r={caption:t,direction:Terrasoft.getTextDirection(t)};return this.selectors=this.getSelectors(),Ext.apply(e,this.getClasses()),e.inputbox=Boolean(this.controlConfig),e.caption=Boolean(this.caption),Ext.apply(e,r,{})},getMessageCaption:function(){return this.useHtmlContent?this.caption:Terrasoft.encodeHtml(this.caption)},getClasses:function(){var e={coverClass:["ts-messagebox-cover"],captionClass:["ts-messagebox-caption"],inputboxCaptionClass:["ts-inputbox-caption"],inputboxNoCaptionClass:["ts-inputbox-nocaption"],customControl:["ts-inpupbox-control"]},t=e.boxClass=["ts-messagebox-box","ts-messagebox-center-left-position"];return t.push(this.style.borderStyle),this.customWrapClass&&t.push(this.customWrapClass),e},getSelectors:function(){return{wrapEl:"#"+this.id+"-wrap",captionEl:"#"+this.id+"-caption"}},setCaption:function(e){this.caption!==e&&(this.caption=e,this.safeRerender())},setVisible:function(e){this.visible!==e&&(this.renderTo||(this.renderTo=Ext.getBody()),this.callParent(arguments),!0===e&&this._initCoverEl(),!1===e&&this._hideCoverEl())},updateCustomControl:function(){if(!this.controlConfig)return null;for(var e=this.controlConfig,t=this.controlArray,r=0;r<t.length;r++){var n=e[t[r].name],i=t[r].control;n.value=Ext.isFunction(i.getValue)?i.getValue():i.value}},destroyCustomControl:function(){var e=this.controlArray;if(e)for(var t=0;t<e.length;t++){e[t].label.destroy(),e[t].control.destroy(),e[t].description.destroy()}this.controlArray=null,this.wrapEl.un("click",(function(e){e.stopEvent()}))},onDestroy:function(){this.destroyCustomControl(),this.callParent(arguments)},_initCoverEl:function(){this.coverEl=Ext.get(this.id+"-cover"),this.coverEl.on("wheel",(function(e){e.preventDefault()})),this.coverEl.on("click",(function(e){e.stopEvent()})),this.coverEl.dom.style.backgroundColor="#737ca14d"},_hideCoverEl:function(){this.coverEl.dom.style.display="none"},_removeCoverEl:function(){this.coverEl&&(this.coverEl.destroy(),this.coverEl=null)},prepare:function(e){this.applyDefaultConfig(),Ext.apply(this,e),this.reConfigurateButtonItems()},show:function(){this.setVisible(!0)}}),Ext.ns("Terrasoft.core"),Ext.define("Terrasoft.core.Features",{extend:"Terrasoft.BaseObject",alternateClassName:"Terrasoft.Features",singleton:!0,cachedFeatures:null,constructor:function(){this.callParent(arguments),this.cachedFeatures={},Ext.apply(this.cachedFeatures,Terrasoft.preLoadedFeatures)},getIsEnabled:function(e){var t=this.cachedFeatures[e];return!!t&&t.state===Terrasoft.FeatureState.ENABLED},getIsDisabled:function(e){return!this.getIsEnabled(e)}}),Ext.define("Terrasoft.exporters.EmailContentTemplates",{alternateClassName:"Terrasoft.EmailContentTemplates",singleton:!0,getNotMsoTpl:function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return"\x3c!--[if !mso]>\x3c!-- --\x3e".concat(t.join(""),"\x3c!--<![endif]--\x3e")},getDesktopBackgroundTpl:function(e){for(var t=arguments.length,r=new Array(t>1?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];return'<table style="'.concat(e.style||"",' {styles}" width="').concat(e.width||"100%",'" cellpadding="0"\n\t\tcellspacing="0" ').concat(e.align?'<tpl if="'.concat(e.align,'"> align="{').concat(e.align,'}" </tpl>'):"",'\n\t\t<tpl if="mobileBackground"> class="').concat(e.additionalClass||"",' ignore-collapse desktop-background">\n\t\t<tpl else>class="').concat(e.additionalClass||"",'  ignore-collapse"></tpl>\n\t\t\t<tbody>\n\t\t\t\t<tr>\n\t\t\t\t').concat(r.join(""),"\n\t\t\t\t</tr>\n\t\t\t</tbody>\n\t\t</table>")},getMobileBackgroundTpl:function(e){for(var t=arguments.length,r=new Array(t>1?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];var i=this.getColumnTpl(e,'\n\t\t\t<table width="100%" class="ignore-collapse mobile-background" cellpadding="0" cellspacing="0"\n\t\t\t\t<tpl if="mobileBackground"> style="{borderRadiusStyle};background-size: 0;\n\t\t\tbackground-image: url({mobileBackground})"</tpl>>\n\t\t\t\t<tbody>\n\t\t\t\t\t<tr>\n\t\t\t\t\t\t'.concat(r.join(""),"\n\t\t\t\t\t</tr>\n\t\t\t\t</tbody>\n\t\t\t</table>")),a=Terrasoft.Features.getIsEnabled("OptimizeMobileBackgroundTemplate")&&Terrasoft.isEmptyObject(e);return"\n\t\t\t".concat(a?'<tpl if="mobileBackground">':"","\n\t\t\t").concat(i,"\n\t\t\t").concat(a?"<tpl else>".concat(r.join(""),"</tpl>"):"")},getColumnTpl:function(e){for(var t=arguments.length,r=new Array(t>1?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];return"<td ".concat(Object.keys(e).map((function(t){return"".concat(t,'="').concat(e[t],'"')})).join(" "),">\n\t\t\t\t\t").concat(r.join(""),"\n\t\t\t\t</td>")},getContainerTpl:function(){return"{%this.generateItems(out, values)%}"},getSeparatorTpl:function(){return'\n\t\t\t<table border="0" cellpadding="0" cellspacing="0" width="100%"\n\t\t\t\t\tclass="separator-element-wrapper flexible-container">\n\t\t\t\t<tbody>\n\t\t\t\t\t<tr>\n\t\t\t\t\t\t<td>\n\t\t\t\t\t\t\t<table cellpadding="0" cellspacing="0"\n\t\t\t\t\t\t\t\tborder="0" width="100%"\n\t\t\t\t\t\t\t\tclass="separator-element flexible-container">\n\t\t\t\t\t\t\t\t<tbody>\n\t\t\t\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t\t\t\t<td style="{separatorStyles}">\n\t\t\t\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t\t\t\t</tr>\n\t\t\t\t\t\t\t\t</tbody>\n\t\t\t\t\t\t\t</table>\n\t\t\t\t\t\t</td>\n\t\t\t\t\t</tr>\n\t\t\t\t</tbody>\n\t\t\t</table>\n\t\t'},getMobileRowsTpl:function(){return'<tpl for="mobileItems">\n\t\t\t\x3c!--[if !((gte mso 9)|(mso 9))]>\x3c!--\x3e\n\t\t\t\t<tr style="display: none;" class="mobile-item">\n\t\t\t\t\t<td valign="top" style="{parent.rowTplData.styles}" class="flexible-container">\n\t\t\t\t\t\t\x3c!--[if (gte mso 9)|(IE)]><table width="100%" align="center" valign="top" cellpadding="0"\n\t\t\t\t\t\t\tcellspacing="0" border="0"><tr><![endif]--\x3e\n\t\t\t\t\t\t{html}\n\t\t\t\t\t\t\x3c!--[if (gte mso 9)|(IE)]></tr></table><![endif]--\x3e\n\t\t\t\t\t</td>\n\t\t\t\t</tr>\n\t\t\t\x3c!--<![endif]--\x3e\n\t\t\t</tpl>'},getImageTpl:function(e){return'\n\t\t\t<p style="{paragraphStyles}" class="adaptive-image">\n\t\t\t\t<tpl if="hasLink"><a href="{Link}" target="_blank" title="{Link}"></tpl>\n\t\t\t\t<img src="'.concat(e.src,'" class="adaptive-image flexible-image ').concat(e.additionalClass||"",'"\n\t\t\t\t\t<tpl if="hasTitle"> title="{title}"</tpl>\n\t\t\t\t\t').concat(e.width?'width="'.concat(e.width,'"'):""," ").concat(e.height?'height="'.concat(e.height,'"'):"",'\n\t\t\t\t\tmc:label="{alt}" alt="{alt}" mc:edit="{alt}" style="{imageStyles}" />\n\t\t\t\t<tpl if="hasLink"></a></tpl>\n\t\t\t</p>')}}),Ext.define("Terrasoft.exporters.EmailContentExporter",{extend:"Terrasoft.BaseContentExporter",alternateClassName:"Terrasoft.EmailContentExporter",ExportedItemType:Object.assign({BLOCKROW:"BlockRow",BLOCKCOLUMN:"BlockColumn",BUTTONSGROUP:"ButtonsGroup"},Terrasoft.ExportedItemType),maxColumnsCount:24,defaulSheetWidth:600,defaultImagePadding:0,defaulSheetBgColor:"#fff",linkCssStyles:{color:"#336699","font-weight":"normal","text-decoration":"underline"},sheetCssStyles:{color:"#444444","font-family":"arial,helvetica,sans-serif","font-size":"14px","line-height":"initial","min-width":"200px","border-collapse":"collapse"},textCssStyles:{color:"#444444","font-family":"arial,helvetica,sans-serif","font-size":"14px","line-height":"inherit",padding:"5px","text-align":"left","word-wrap":"break-word","word-break":"break-word","-webkit-hyphens":"auto","-moz-hyphens":"auto",hyphens:"auto"},htmlCssStyles:{color:"#444444",margin:"8px","font-family":"arial,helvetica,sans-serif","font-size":"14px","word-wrap":"break-word","-ms-word-break":"break-all","word-break":"break-word","-webkit-hyphens":"auto","-moz-hyphens":"auto",hyphens:"auto",overflow:"hidden"},imageWrapperCssStyles:{},imageParagraphCssStyles:{margin:0},imageCssStyles:{height:"auto",display:"block",border:"none",margin:0,padding:0},blockColumnCssStyles:{"vertical-align":"top",width:"100%","border-collapse":"collapse"},blockRowCssStyles:{width:"100%","vertical-align":"top"},sheetTpl:['<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">',"<html>","<head>",'<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />','<meta property="og:title" content="" />','<meta name="viewport" content="width=device-width, initial-scale=1.0"/>','<meta http-equiv="X-UA-Compatible" content="IE=edge"/>',"<title></title>",'<style type="text/css">',"#outlook a {padding:0;}","body {width:100% !important;} .ReadMsgBody {width:100%;} .ExternalClass {width:100%;}",".ExternalClass, .ExternalClass p, .ExternalClass span, .ExternalClass font, .ExternalClass td, .ExternalClass div {line-height: 100%;}","body, table, td, p, a, li, blockquote {-webkit-text-size-adjust:100%; -ms-text-size-adjust:100%; mso-line-height-rule:exactly;}","table, td {mso-table-lspace:0pt; mso-table-rspace:0pt; border-spacing:0;}","body {margin:0; padding:0;}","img {border:0; line-height:100%; outline:none; text-decoration:none; -ms-interpolation-mode:bicubic;}","a[x-apple-data-detectors] {color: inherit !important;text-decoration: none !important;font-size: inherit !important;font-family: inherit !important;font-weight: inherit !important;line-height: inherit !important;}","table {border-collapse:collapse !important;}","table td {border-collapse:collapse;}","body {height:100% !important; margin:0; padding:0; width:100% !important;}","@media only screen and (max-width: 480px) {.mobshow {display: table!important;overflow: visible!important;}.nomob {display: none!important;width: 0px!important;height: 0px!important;}.content-block {font-size: 16px;}","body {width:100% !important; min-width:100% !important;}","img.flexible-image {height:auto !important; width:100% !important; max-width:100% !important;}","body,table,td,p,a,li,blockquote {-webkit-text-size-adjust: none !important;}","}","@media only screen and (max-device-width: 480px) {",".content-block {font-size: 16px;}","body {width:100% !important; min-width:100% !important;}","img.flexible-image {height:auto !important; width:100% !important; max-width:100% !important;}","body,table,td,p,a,li,blockquote {-webkit-text-size-adjust: none !important;}","}",".content-block td { {styles} }",".content-block td a:link, .content-block td a:visited, .content-block td a .yshortcuts {"," {contentLinkStyles}","}",".content-block td img {display:inline; height:auto;}.text-element p, .html-element p, p {","-webkit-margin-before: 0em;","-webkit-margin-after: 0em;","-webkit-margin-start: 0em;","-webkit-margin-end: 0em;","margin: 0em;","}","\n\t\t.separator-element, .separator-element-wrapper {\n\t\t\twidth: 100%;\n\t\t}\n\t\t.ignore-collapse {\n\t\t\tborder-collapse: separate!important;\n\t\t}\n\t\t.desktop-background {\n\t\t\tbackground-size: 100%;\n\t\t}\n\t\t.mobile-background {\n\t\t\tbackground-size: 0;\n\t\t\tbackground-repeat: no-repeat;\n\t\t}\n\t\t.mobile-item {\n\t\t\tdisplay: none;\n\t\t\tvisibility: collapse;\n\t\t}\n\t\t.mobile-item * {\n\t\t\tmso-hide: all;\n\t\t}",Terrasoft.Features.getIsEnabled("EmailTemplateLegacyMarkupFeature")?"\n\t\t.desktop-item {\n\t\t\tdisplay: table-cell;\n\t\t}":"\n\t\t.hybrid-item {\n\t\t\tdisplay: table-cell;\n\t\t}\n\t\t.desktop-item {\n\t\t\tdisplay: table-cell;\n\t\t}","\n\t\t.button-element {\n\t\t\tdisplay: inline-block;\n\t\t\ttext-decoration: none;\n\t\t}\n\t\t.button-th {\n\t\t\tfont-weight:normal;\n\t\t}\n\t\t@media only screen and (max-width: 480px) {\n\t\t\t.desktop-background {\n\t\t\t\tbackground-size: 0!important;\n\t\t\t}\n\t\t\t.mobile-background {\n\t\t\t\tbackground-size: 100%!important;\n\t\t\t}\n\t\t\t.mobile-item {\n\t\t\t\tdisplay: table-row!important;\n\t\t\t\tvisibility: visible;\n\t\t\t}\n\t\t\t.mobile-item * {\n\t\t\t\tmso-hide: none!important;\n\t\t\t}",Terrasoft.Features.getIsEnabled("EmailTemplateLegacyMarkupFeature")?"\n\t\t\t.desktop-item {\n\t\t\t\tdisplay: none!important;\n\t\t\t}":"\n\t\t\t.desktop-item {\n\t\t\t\tdisplay: none!important;\n\t\t\t}\n\t\t\t.hybrid-item {\n\t\t\t\tvertical-align: top!important;\n\t\t\t\twidth: 100% !important;\n\t\t\t}","\n\t\t\t.adaptive-image, .adaptive-text, .adaptive-button {\n\t\t\t\twidth: 100%!important;\n\t\t\t\theight: auto!important;\n\t\t\t\tmax-width: 480px!important\n\t\t\t}\n\t\t\t.adaptive-sheet, .adaptive-block {\n\t\t\t\tmax-width: 480px!important\n\t\t\t}\n\t\t}\n\t\t::-webkit-scrollbar {\n\t\t\t-webkit-appearance: none;\n\t\t\twidth: 10px;\n\t\t\theight: 10px;\n\t\t}\n\t\t::-webkit-scrollbar-thumb {\n\t\t\tbackground: #DBDBDB;\n\t\t}\n\t\t@media only screen and (max-width: 670px) {\n\t\t\t.button-half-row {\n\t\t\t\tdisplay: inline-block;\n\t\t\t\twidth: 50%!important;\n\t\t\t}\n\t\t}\n\t\t@media only screen and (max-width: 292px) {\n\t\t\t.button-half-row {\n\t\t\t\tdisplay: block;\n\t\t\t\twidth: 100%!important;\n\t\t\t}\n\t\t}\n\t\t","</style>","</head>",'<body leftmargin="0" marginwidth="0" topmargin="0" marginheight="0" offset="0" style="margin:0">','<table border="0" cellpadding="0" cellspacing="0" height="100%" width="100%" style="border-collapse:collapse;">',"<tr>",'<td align="{SheetAlign}" valign="top">','\x3c!--[if (gte mso 9)|(IE)]><table width="{Width}" cellpadding="0" cellspacing="0" border="0"><tr><td><![endif]--\x3e','<table bgcolor="{BackgroundColor}" class="adaptive-sheet" style="{styles}" cellspacing="0" cellpadding="10" id="backgroundTable">',"<tr>",'<td valign="top">',"{%this.generateItems(out, values)%}","</td>","</tr>","</table>","\x3c!--[if (gte mso 9)|(IE)]></td></tr></table><![endif]--\x3e","<br />","</td>","</tr>","</table>","</body>","</html>"],blockGroupTpl:[Terrasoft.EmailContentTemplates.getContainerTpl()],blockTpl:[Terrasoft.EmailContentTemplates.getDesktopBackgroundTpl({},Terrasoft.EmailContentTemplates.getMobileBackgroundTpl({valign:"{valign}"},Terrasoft.EmailContentTemplates.getColumnTpl({style:"{columnStyles}"},Terrasoft.EmailContentTemplates.getContainerTpl())))],blockRowTpl:['<table class="block-row" border="0" cellpadding="0" cellspacing="0" width="{Width}">\n\t\t{%this.generateBlockRowItems(out, values, parent)%}\n\t\t</table>'],blockCellTpl:['\x3c!--[if (gte mso 9)|(IE)]><td style="padding: {CellPadding}px;" width="{TdWidth}" valign="top" ><![endif]--\x3e\n\t\t<table align="left" border="0" cellpadding="0" cellspacing="0" style="{styles}" class="adaptive-block\n\t\tflexible-container">\n\t\t\t<tr>\n\t\t\t\t<td<tpl if="Align"> align="{Align}"</tpl>>\n\t\t\t\t\t{%this.generateItems(out, values)%}\n\t\t\t\t</td>\n\t\t\t</tr>\n\t\t</table>\n\t\t\x3c!--[if (gte mso 9)|(IE)]></td><![endif]--\x3e'],htmlTpl:['<div style="{elementStyles}">\n\t\t\t'.concat(Terrasoft.EmailContentTemplates.getDesktopBackgroundTpl({},Terrasoft.EmailContentTemplates.getMobileBackgroundTpl({},Terrasoft.EmailContentTemplates.getColumnTpl({style:"{columnStyles}",class:"html-element"},"{Content}"))),"\n\t\t</div>")],separatorTpl:[Terrasoft.EmailContentTemplates.getDesktopBackgroundTpl({},Terrasoft.EmailContentTemplates.getMobileBackgroundTpl({},Terrasoft.EmailContentTemplates.getColumnTpl({style:"{columnStyles}"},Terrasoft.EmailContentTemplates.getSeparatorTpl())))],textTpl:[Terrasoft.EmailContentTemplates.getDesktopBackgroundTpl({additionalClass:"adaptive-text",width:"{width}"},Terrasoft.EmailContentTemplates.getMobileBackgroundTpl({},Terrasoft.EmailContentTemplates.getColumnTpl({style:"{columnStyles}",valign:"top",class:"text-element"},"{Content}")))],imageTpl:[Terrasoft.EmailContentTemplates.getDesktopBackgroundTpl({additionalClass:"adaptive-image flexible-container",width:"{Width}",align:"Align"},Terrasoft.EmailContentTemplates.getMobileBackgroundTpl({},Terrasoft.EmailContentTemplates.getColumnTpl({style:"{columnStyles}",align:"{Align}",class:"image-element"},Terrasoft.EmailContentTemplates.getImageTpl({src:"{imageSrc}",width:"{ImageWidth}",height:"{ImageHeight}"}))))],mobileImageTpl:[Terrasoft.EmailContentTemplates.getNotMsoTpl(Terrasoft.EmailContentTemplates.getDesktopBackgroundTpl({align:"center",additionalClass:"adaptive-image flexible-container mobshow mobile-item",style:"display: none; min-width: 0px !important;"},Terrasoft.EmailContentTemplates.getMobileBackgroundTpl({},Terrasoft.EmailContentTemplates.getColumnTpl({style:"{columnStyles}",class:"image-element"},Terrasoft.EmailContentTemplates.getImageTpl({src:"{mobileImageSrc}",additionalClass:"mobshow"}))))),Terrasoft.EmailContentTemplates.getDesktopBackgroundTpl({align:"{Align}",additionalClass:"flexible-container nomob"},Terrasoft.EmailContentTemplates.getMobileBackgroundTpl({},Terrasoft.EmailContentTemplates.getColumnTpl({style:"{columnStyles}",class:"image-element"},Terrasoft.EmailContentTemplates.getImageTpl({src:"{imageSrc}",width:"{ImageWidth}",height:"{ImageHeight}",additionalClass:"nomob"}))))],preHeaderTpl:['<div  hidden class="email-template-pre-header" style="display:none; line-height: 1px; max-height: 0px; max-width: 0px; opacity: 0; overflow: hidden; color: {BackgroundColor}; font-size:1px; font-family: verdana, geneva, sans-serif;">',"{PreHeaderText}","</div >"],preHeaderClassName:"email-template-pre-header",_butonLinkExample:Terrasoft.Resources.EmailContentExporter.ButtonLinkExampleUrl,buttonTpl:['<table width="100%" border="0" cellspacing="0" cellpadding="0" class="ignore-collapse">\n\t\t\t<tr>\n\t\t\t\t<td style="{margin}" align="{align}">\n\t\t\t\t\t<table width="{width}" height="{height}" border="0" cellspacing="0" cellpadding="0"\n\t\t\t\t\t\tclass="ignore-collapse">\n\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t\x3c!--[if !mso]>\x3c!--\x3e\n\t\t\t\t\t\t\t<td width="{width}" align="center">\n\t\t\t\t\t\t\t\t<a href="{Link}" target="_blank" style="display:inline-block;text-decoration:none;{border}{styles}">\n\t\t\t\t\t\t\t\x3c!--<![endif]--\x3e\n\t\t\t\t\t\t\t\x3c!--[if mso]>\n\t\t\t\t\t\t\t\t<td width="{width}" height="{height}" align="center"\n\t\t\t\t\t\t\t\t\tstyle="{padding}{border}" bgcolor="{bgColor}">\n\t\t\t\t\t\t\t\t<a href="{Link}" target="_blank" style="display:inline-block;text-decoration:none;{styles}">\n\t\t\t\t\t\t\t<![endif]--\x3e\n\t\t\t\t\t\t\t\t\t{HtmlText}\n\t\t\t\t\t\t\t\t</a>\n\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t</tr>\n\t\t\t\t\t</table>\n\t\t\t\t</td>\n\t\t\t</tr>\n\t\t</table>'],rowBodyTplTopAlign:['\n\t\t\t<tr>\n\t\t\t<tpl for="items">\n\t\t\t\t<td valign="{parent.valign}" width="{width}" style="display: inline-block;{parent.rowTplData.styles}"\n\t\t\t\t\tclass="flexible-container hybrid-item">\n\t\t\t\t\x3c!--[if (gte mso 9)|(IE)]><table width="100%" align="center" valign="top" cellpadding="0"\n\t\t\t\t\tcellspacing="0" border="0"><tr><![endif]--\x3e\n\t\t\t\t\t{html}\n\t\t\t\t\x3c!--[if (gte mso 9)|(IE)]></tr></table><![endif]--\x3e\n\t\t\t\t</td>\n\t\t\t\t</tpl>\n\t\t\t</tr>\n\t\t'],rowBodyTpl:['<tpl if="reverseColumnOrder">',Terrasoft.EmailContentTemplates.getMobileRowsTpl(),"</tpl>",Terrasoft.Features.getIsEnabled("EmailTemplateLegacyMarkupFeature")?'<tr class="desktop-item"><tpl for="items">\n\t\t\t<td valign="{parent.valign}" width="{width}" style="{parent.rowTplData.styles}" class="flexible-container">':'<tr><tpl for="items">\n\t\t\t<td valign="{parent.valign}" width="{width}" style="{parent.rowTplData.styles}" class="flexible-container\n\t\t\t\t<tpl if="xindex === 1">hybrid-item<tpl else>desktop-item</tpl>">','\t\x3c!--[if (gte mso 9)|(IE)]><table width="100%" align="center" valign="top" cellpadding="0"\n\t\t\t\t\tcellspacing="0" border="0"><tr><![endif]--\x3e\n\t\t\t\t{html}\n\t\t\t\t\x3c!--[if (gte mso 9)|(IE)]></tr></table><![endif]--\x3e\n\t\t\t</td>\n\t\t</tpl>\n\t\t</tr>','<tpl if="!reverseColumnOrder">',Terrasoft.EmailContentTemplates.getMobileRowsTpl(),"</tpl>"],buttonsGroupTpl:['\n\t\t<table align="center" cellspacing="0" cellpadding="0" width="100%" border="0" style="max-width: 100%;">\n\t\t\t<tbody>\n\t\t\t\t<tr><tpl for="Items"><th class="button-th button-half-row" width="{PercentWidth}%">{html}</th></tpl></tr>\n\t\t\t</tbody>\n\t\t</table>\n\t'],minify:Terrasoft.Features.getIsEnabled("MinifyEmailHtml"),minificationConfig:{collapseBooleanAttributes:!0,collapseWhitespace:!1,collapseInlineTagWhitespace:!0,keepClosingSlash:!0,html5:!1,minifyCSS:!0,removeComments:!0,removeEmptyAttributes:!0,removeRedundantAttributes:!0,caseSensative:!0,removeAttributeQuotes:!1},generateItems:function(e,t){Ext.isEmpty(t.Items)||Terrasoft.each(t.Items,(function(t){var r=this.exportItem(t);e.push(r)}),t.self)},generateBlockRowItems:function(e,t,r){var n=t.self,i=t.Items,a=t.Valign,s=t.ReverseColumnOrder,o=n.rowBodyTpl,l=n.rowBodyTplTopAlign;if(!Ext.isEmpty(i)){var c=(Terrasoft.Features.getIsEnabled("EmailTemplateGroupButtonsFeature")?n._groupRowItems(i):i).map((function(e){return{html:n.exportItem(e),width:e.Width}}));Terrasoft.Features.getIsEnabled("ReverseColumnOrderContentBuilderFeature")||(s=!1);var u=Terrasoft.Features.getIsEnabled("ValignTopSimpleMarkupFeature")&&a===Terrasoft.Valign.TOP&&!s?l:o,h=Terrasoft.Features.getIsEnabled("EmailTemplateLegacyMarkupFeature")?c:c.slice(1);s&&h.reverse(),e.push(n.generate(u,{items:c,mobileItems:h,rowTplData:r,valign:a,reverseColumnOrder:s}))}},generate:function(e,t){Ext.isArray(e)&&(e=e.join("")),e=e.replace(/\s+/g," "),Ext.apply(t,{self:this,generateItems:this.generateItems,generateBlockRowItems:this.generateBlockRowItems});var r=new Ext.XTemplate(e);this.prepareTpl(r,t);var n=[];return r.applyOut(t,n),n.join("")},prepareTpl:function(e,t){Terrasoft.each(t,(function(t,r){Ext.isFunction(t)&&(e[r]=t)}),this)},exportSheet:function(e){var t=Terrasoft.deepClone(e);t.BackgroundColor=t.BackgroundColor||this.defaulSheetBgColor,t.Width=t.Width||this.defaulSheetWidth;var r=t.Width;Terrasoft.each(t.Items,(function(e){e.ParentWidth=r-20}));var n=Ext.apply({width:"100%","max-width":r+"px !important"},this.sheetCssStyles);return n=Ext.apply(n,t.Styles),t.styles=Ext.DomHelper.generateStyles(n),t.contentLinkStyles=Ext.DomHelper.generateStyles(this.linkCssStyles),this.generate(this.sheetTpl,t)},exportBlockGroup:function(e){var t=Terrasoft.deepClone(e),r=Ext.apply({},t.Styles);return t.styles=Ext.DomHelper.generateStyles(r),this.generate(this.blockGroupTpl,t)},exportText:function(e){var t=Terrasoft.deepClone(e);this._applyDefaultPadding(t);var r=Ext.apply({},t.Styles,this.textCssStyles);return t.width=!e.Styles||Ext.isEmpty(e.Styles.width)?e.ParentWidth:e.Styles.width,Ext.apply(t,this._sliceStyles(r)),t.mobileBackground=t.BackgroundImage&&t.BackgroundImage.mobile,this.generate(this.textTpl,t)},exportImage:function(e){var t=Terrasoft.deepClone(e);return this._applyDefaultPadding(t),t.title=e.ImageTitle,t.hasTitle=!Ext.isEmpty(e.ImageTitle),t.alt=e.Alt||"Image",t.align=e.Align,t.hasLink=!Ext.isEmpty(e.Link),this._prepareImage(t,e),this._prepareMobileImage(t,e),this._prepareImageElementStyles(t,e),t.mobileBackground=t.BackgroundImage&&t.BackgroundImage.mobile,t.mobileImageSrc?this.generate(this.mobileImageTpl,t):this.generate(this.imageTpl,t)},exportButton:function(e){var t=Terrasoft.deepClone(e),r=Ext.apply({},t.Styles);return t.bgColor=r["background-color"],t.width=parseFloat(r.width)||r.width,t.height=parseFloat(r.height)||r.height,t.align=t.Align,t.Link=t.Link||this._butonLinkExample,t.margin=Ext.DomHelper.generateStyles(t.Padding),this._generateButtonBorder(t,r),this._generateButtonPadding(t,r),this._generateButtonWidth(r),this._generateButtonHeight(r),this._generateButtonHrefStyle(r),t.styles=Ext.DomHelper.generateStyles(r),this.generate(this.buttonTpl,t)},exportHtml:function(e){var t=Terrasoft.deepClone(e);this._applyDefaultPadding(t);var r=Ext.apply({},t.Styles);return Ext.apply(t,this._sliceStyles(r,this.htmlCssStyles)),t.mobileBackground=t.BackgroundImage&&t.BackgroundImage.mobile,this.generate(this.htmlTpl,t)},exportSeparator:function(e){var t=Terrasoft.deepClone(e),r=Ext.apply({},t.Styles);Ext.apply(t,this._sliceStyles(r));var n={};return n["border-top-color"]=t.Color,n["border-top-style"]=t.Style,n["border-top-width"]=t.Thickness,t.separatorStyles=Ext.DomHelper.generateStyles(n),t.mobileBackground=t.BackgroundImage&&t.BackgroundImage.mobile,this.generate(this.separatorTpl,t)},exportBlock:function(e){var t=Terrasoft.deepClone(e),r=this.groupBlockElements(t.Items);Terrasoft.each(r,(function(e){e.ParentWidth=t.ParentWidth-Terrasoft.calculateStylesWidth(t.Styles)}));var n=Ext.apply({},t.Styles);Ext.apply(t,this._sliceStyles(n));var i=this.getLayoutItemsConfig(r),a=e.Valign||Terrasoft.Valign.TOP;return t.Items=this.generateRows(i,{reverseColumnOrder:t.ReverseColumnOrder,minRow:0,maxRow:this.getRowsCount(i),minColumn:0,maxColumn:this.maxColumnsCount,valign:a}),t.valign=a,t.mobileBackground=t.BackgroundImage&&t.BackgroundImage.mobile,this.generate(this.blockTpl,t)},groupBlockElements:function(e){for(var t=[],r={},n=function(e){r.minColumn=e.Column<r.minColumn?e.Column:r.minColumn,r.minRow=e.Row<r.minRow?e.Row:r.minRow;var t=e.Row+e.RowSpan;r.maxRow=t>r.maxRow?t:r.maxRow;var n=e.Column+e.ColSpan;r.maxColumn=n>r.maxColumn?n:r.maxColumn};!Ext.isEmpty(e);){for(var i=e[0].GroupName,a=[],s=e.length-1;s>=0;s--)if(e[s].GroupName===i){delete e[s].GroupName;var o=e.splice(s,1);a.push(o[0])}if(!Ext.isEmpty(i)){var l=this.getLayoutItemsConfig(a);Ext.apply(r,{minRow:24,maxRow:0,minColumn:24,maxColumn:0}),this.eachLayoutItem(l,{minRow:0,maxRow:24,minColumn:0,maxColumn:24},n,this),a=[{ItemType:"block",Column:r.minColumn,Row:r.minRow,ColSpan:r.maxColumn-r.minColumn,RowSpan:r.maxRow-r.minRow,Items:a}]}t=t.concat(a)}return t},exportBlockRow:function(e){var t=Terrasoft.deepClone(e),r=Ext.apply({},t.Styles,this.blockRowCssStyles);return t.Width="100%",t.styles=Ext.DomHelper.generateStyles(r),this.generate(this.blockRowTpl,t)},exportBlockColumn:function(e){var t=Terrasoft.deepClone(e),r=Ext.apply({"max-width":t.Width+"px"},t.Styles,this.blockColumnCssStyles),n=0;return Terrasoft.each(t.Items,(function(e){"block"===e.ItemType?e.ParentWidth=t.ParentWidth:(this._applyItemSpecificStyles(e,t),e.ParentWidth=t.Width,n=5)}),this),t.TdWidth=t.Width-2*n,t.CellPadding=n,t.styles=Ext.DomHelper.generateStyles(r),this.generate(this.blockCellTpl,t)},exportButtonsGroup:function(e){var t=this,r=Terrasoft.deepClone(e);return r.Items.forEach((function(e){e.html=t.exportItem(e.Items[0])})),this.generate(this.buttonsGroupTpl,r)},generateRows:function(e,t){var r=[];return this.eachLayoutItem(e,t,(function(n,i){var a=this.calculateRowHeight(e,Ext.apply({},{minRow:i,maxRow:i+n.RowSpan},t)),s=this.generateColumns(e,Ext.apply({},{minRow:i,maxRow:i+a},t));return r.push({ItemType:"BlockRow",Items:s,Styles:t.rowStyles,Valign:t.valign,ReverseColumnOrder:t.reverseColumnOrder}),{breakInner:!0,increaseOuter:a-1}}),this),r},getRangeRowsCount:function(e,t){var r=0;return this.eachLayoutItem(e,t,(function(n,i){var a=this.calculateRowHeight(e,Ext.apply({},{minRow:i,maxRow:i+n.RowSpan},t));return r++,{breakInner:!0,increaseOuter:a-1}}),this),r},generateColumns:function(e,t){for(var r=[],n=t.minColumn;n<t.maxColumn;n++)for(var i=t.minRow;i<t.maxRow;i++){var a=e[i]?e[i][n]:null;if(a){var s=this.getColumnWidth(e,Ext.apply({},{minColumn:n,maxColumn:n+a.ColSpan},t)),o=null;o=this.getRangeRowsCount(e,Ext.apply({},{minColumn:n,maxColumn:n+s},t))>1?this.generateRows(e,Ext.apply({},{minColumn:n,maxColumn:n+s},t)):[a];var l={ItemType:"BlockColumn",DataColspan:s,ParentWidth:a.ParentWidth,Items:o};r.push(l),n+=s-1;break}}return r=this.calculateColumnWidth(r)},eachLayoutItem:function(e,t,r,n){var i={outerFrom:t.minRow,outerTo:t.maxRow,innerFrom:t.minColumn,innerTo:t.maxColumn};this.eachItem(e,i,r,n)},eachItem:function(e,t,r,n){for(var i=t.outerFrom,a=t.outerTo;i<a;i++)for(var s=t.innerFrom,o=t.innerTo;s<o;s++){var l=e[i]?e[i][s]:null;if(l){var c=r.call(n||this,l,i,s)||{};if(c.increaseOuter&&(i+=c.increaseOuter),c.breakInner)break}}},calculateColumnWidth:function(e){var t=0;Terrasoft.each(e,(function(e){t+=parseInt(e.DataColspan,10)}),this);var r=0;do{var n=e[r];n.PercentWidth=100*n.DataColspan/t,n.Width=Math.round(n.DataColspan*n.ParentWidth/this.maxColumnsCount),r++}while(r<e.length-1);var i=Terrasoft.last(e),a=e.filter((function(e){return e!==i}));if(a.length){i.PercentWidth=100*i.DataColspan/t;var s=a.reduce((function(e,t){return e+t.Width}),0),o=i.ParentWidth*(t/this.maxColumnsCount);i.Width=Math.ceil(o-s)}return e},getColumnWidth:function(e,t){var r=!1,n=function(e,n,i){var a=e.ColSpan;i+a>t.maxColumn&&(t.maxColumn=i+a,r=!0)};do{r=!1,this.eachLayoutItem(e,t,n,this)}while(r);return t.maxColumn-t.minColumn},calculateRowHeight:function(e,t){return this.eachLayoutItem(e,t,(function(e,r){var n=r+e.RowSpan;n>t.maxRow&&(t.maxRow=n)}),this),t.maxRow-t.minRow},getLayoutItemsConfig:function(e){var t={};return Terrasoft.each(e,(function(e){(!e.RowSpan||e.RowSpan<1)&&(e.RowSpan=1);var r=e.Row;t[r]=t[r]||{},t[r][e.Column]=e}),this),t},getRowsCount:function(e){var t=Ext.Object.getKeys(e);t=Ext.Array.map(t,(function(e){return parseInt(e,10)}),this);var r=parseInt(Ext.Array.max(t),10);return++r},exportItem:function(e){var t=e.ItemType,r=null;switch(t){case this.ExportedItemType.BLOCKROW:r=this.exportBlockRow(e);break;case this.ExportedItemType.BLOCKCOLUMN:r=this.exportBlockColumn(e);break;case this.ExportedItemType.BUTTONSGROUP:r=this.exportButtonsGroup(e);break;default:r=this.callParent(arguments)}return r},exportData:function(e){var t,r=this.findSingleHtmlBlock(e);if(t=r&&r.Content?r.Content:this.callParent(arguments),e.PreHeaderText&&(t=this._addPreHeaderIfNotExists(t,e)),this.minify)try{t=Terrasoft.utils.minifier.minify(t,this.minificationConfig)}catch(e){this.log("minification failed: ".concat(e.name,", message: ").concat(e.message),Terrasoft.LogMessageType.WARNING)}return t},_addPreHeaderIfNotExists:function(e,t){var r=(new DOMParser).parseFromString(e,"text/html");if(r.getElementsByClassName(this.preHeaderClassName).length>0)return e;var n=r.createElement("span");return n.innerHTML=this.generate(this.preHeaderTpl,t),r.documentElement.insertBefore(n,r.body),(new XMLSerializer).serializeToString(r)},_getImageSource:function(e){return Ext.isEmpty(e.imageSrc)?Terrasoft.ImageUrlBuilder.getUrl(e):e.imageSrc},_prepareImage:function(e,t){var r=t.ImageConfig;Ext.isEmpty(r)?e.imageSrc="":e.imageSrc=this._getImageSource(r)},_prepareMobileImage:function(e,t){var r=t.MobileImageConfig;r&&(e.mobileImageSrc=this._getImageSource(r))},_applyItemSpecificStyles:function(e,t){e.Align&&["text","image"].includes(e.ItemType)&&(t.Align=e.Align)},_prepareImageElementStyles:function(e,t){var r=Ext.apply({},e.Styles,this.imageWrapperCssStyles),n=this.defaultImagePadding;Ext.apply(e,this._sliceStyles(r));var i=t.Width?parseInt(t.Width,10)+2*n:e.ParentWidth,a=i-Terrasoft.calculateStylesWidth(e.Styles)-2*n;(t.Width||!t.Width&&!t.Height)&&(e.ImageWidth=a),e.Width=i===e.ParentWidth?"auto":i;var s=Ext.apply({"max-width":a?a+"px":"100%"},e.ImageStyles,this.imageCssStyles);!Ext.isEmpty(t.Height)&&Ext.isEmpty(t.Width)&&(s.width="auto"),t.Height&&(e.ImageHeight=t.Height,s.height=parseInt(t.Height,10)-Terrasoft.calculateStylesHeight(e.Styles)+"px"),e.imageStyles=Ext.DomHelper.generateStyles(s);var o=Ext.apply({padding:n+"px","max-width":a+"px"},e.ParagraphStyles,this.imageParagraphCssStyles);e.paragraphStyles=Ext.DomHelper.generateStyles(o);var l=Ext.apply({},s),c=Ext.apply({},o);Ext.apply(l,{display:"none"}),Ext.apply(c,{display:"none"}),e.mobileImageStyles=Ext.DomHelper.generateStyles(l),e.mobileParagraphStyles=Ext.DomHelper.generateStyles(c)},_applyDefaultPadding:function(e){_.isUndefined(e.Styles)&&(e.Styles={}),_.isUndefined(e.Styles["padding-left"])&&(e.Styles["padding-left"]="5px"),_.isUndefined(e.Styles["padding-right"])&&(e.Styles["padding-right"]="5px"),_.isUndefined(e.Styles["padding-top"])&&(e.Styles["padding-top"]="5px"),_.isUndefined(e.Styles["padding-bottom"])&&(e.Styles["padding-bottom"]="5px")},_getMobileBorderRadius:function(e){var t={};if(!Ext.isEmpty(e["border-radius"])){var r=["border-left","border-top","border-right","border-bottom"].filter((function(t){return Boolean(e[t])&&!e[t].includes("None")})),n=Math.max.apply(Math,_toConsumableArray(r.map((function(t){return parseInt(e[t],10)}))).concat([0]));t["border-radius"]="".concat(Math.max(parseInt(e["border-radius"],10)-n,0),"px")}return t},_getColumnStyles:function(e){var t=this._sliceObjectByFn(e,(function(e){return e.startsWith("padding")}));return Ext.isEmpty(e.height)||(t.height=parseInt(e.height,10)-Terrasoft.calculateStylesHeight(e)+"px"),Ext.isEmpty(e["line-height"])||(t["line-height"]=e["line-height"]),t},_sliceStyles:function(e,t){var r=this._getColumnStyles(e),n=this._sliceObjectByFn(e,(function(e){return!r.hasOwnProperty(e)})),i=this._getMobileBorderRadius(e);return{columnStyles:Ext.DomHelper.generateStyles(r),styles:Ext.DomHelper.generateStyles(n),elementStyles:Ext.DomHelper.generateStyles(t),borderRadiusStyle:Ext.DomHelper.generateStyles(i)}},_sliceObjectByFn:function(e,t){return _.keys(e).filter(t).reduce((function(t,r){return t[r]=e[r],t}),{})},_generateButtonBorder:function(e,t){e.border=Ext.DomHelper.generateStyles({"border-left":t["border-left"]||0,"border-right":t["border-right"]||0,"border-top":t["border-top"]||0,"border-bottom":t["border-bottom"]||0})},_generateButtonPadding:function(e,t){e.padding=Ext.DomHelper.generateStyles({"padding-left":t["padding-left"]||0,"padding-right":t["padding-right"]||0,"padding-top":t["padding-top"]||0,"padding-bottom":t["padding-bottom"]||0})},_generateButtonWidth:function(e){parseFloat(e.width)>0&&(e["max-width"]=e.width=Math.max(0,parseFloat(e.width)-(parseFloat(e["padding-left"])||0)-(parseFloat(e["padding-right"])||0)-(parseFloat(e["border-left"])||0)-(parseFloat(e["border-right"])||0))+"px")},_generateButtonHeight:function(e){parseFloat(e.height)>0&&(e["max-height"]=e.height=Math.max(0,parseFloat(e.height)-(parseFloat(e["padding-top"])||0)-(parseFloat(e["padding-bottom"])||0)-(parseFloat(e["border-bottom"])||0)-(parseFloat(e["border-top"])||0))+"px")},_generateButtonHrefStyle:function(e){delete e.border,delete e["border-left"],delete e["border-right"],delete e["border-top"],delete e["border-bottom"]},_addButtonsGroup:function(e,t){t.length>1?e.push({Items:t,ItemType:this.ExportedItemType.BUTTONSGROUP,Width:t.reduce((function(e,t){return e+t.Width}),0)}):e.push(t[0])},_isButtonBlock:function(e){return e.ItemType===this.ExportedItemType.BLOCKCOLUMN&&1===e.Items.length&&e.Items[0].ItemType===this.ExportedItemType.BUTTON},_canBeAddedToGroup:function(e,t){return 0===e.length||e[0].PercentWidth===t.PercentWidth},_groupRowItems:function(e){var t=this,r=[],n=[];return e.forEach((function(e){t._isButtonBlock(e)?t._canBeAddedToGroup(n,e)?n.push(e):(t._addButtonsGroup(r,n),n=[e]):(n.length&&(t._addButtonsGroup(r,n),n=[]),r.push(e))})),n.length&&this._addButtonsGroup(r,n),r}}),Ext.ns("Terrasoft.diagram.enums"),Terrasoft.diagram.enums.ProcessDiagramType={"Terrasoft.manager.ProcessLaneSchema":"lane","Terrasoft.manager.ProcessLaneSetSchema":"laneSet","Terrasoft.manager.ProcessStartEventSchema":"startEvent","Terrasoft.manager.ProcessStartMessageSchema":"startEventMessage","Terrasoft.manager.ProcessStartSignalSchema":"startEventSignal","Terrasoft.manager.ProcessIntermediateCatchMessageSchema":"intermediateCatchEventMessage","Terrasoft.manager.ProcessIntermediateCatchSignalSchema":"intermediateCatchEventSignal","Terrasoft.manager.ProcessIntermediateCatchTimerSchema":"intermediateCatchEventTimer","Terrasoft.manager.ProcessStartTimerEventSchema":"startEventTimer","Terrasoft.manager.ProcessIntermediateThrowMessageSchema":"intermediateThrowEventMessage","Terrasoft.manager.ProcessIntermediateThrowSignalSchema":"intermediateThrowEventSignal","Terrasoft.manager.ProcessTerminateEventSchema":"endEvent","Terrasoft.manager.ProcessExclusiveEventBasedGatewaySchema":"exclusiveEventBasedGateway","Terrasoft.manager.ProcessExclusiveGatewaySchema":"exclusiveGateway","Terrasoft.manager.ProcessInclusiveGatewaySchema":"inclusiveGateway","Terrasoft.manager.ProcessParallelGatewaySchema":"parallelGateway","Terrasoft.manager.ProcessSubprocessSchema":"callActivity","Terrasoft.manager.ProcessScriptTaskSchema":"scriptTask","Terrasoft.manager.ProcessFormulaTaskSchema":"userTask","Terrasoft.manager.ProcessSequenceFlowSchema":"connection","Terrasoft.manager.ProcessConditionalSequenceFlowSchema":"conditionalConnection","Terrasoft.manager.ProcessDefaultSequenceFlowSchema":"defaultConnection","Terrasoft.manager.ProcessEventSubprocessSchema":"eventSubProcessExpanded","Terrasoft.manager.ProcessEventBasedGatewaySchema":"eventBasedGateway","Terrasoft.manager.ProcessUserTaskSchema":"userTask","Terrasoft.manager.ProcessSchemaUserTask":"userTask","Terrasoft.manager.ProcessWebServiceSchema":"userTask","Terrasoft.manager.ProcessStartMessageNonInterruptingSchema":"startEventMessageNonInterrupting","Terrasoft.manager.ProcessEndEventSchema":"endEvent","Terrasoft.manager.ProcessStartSignalNonInterruptingSchema":"startEventSignalNonInterrupting","Terrasoft.manager.ProcessStartTimerEventNonInterruptingSchema":"startEventTimerNonInterrupting","Terrasoft.manager.ProcessLabelSchema":"label"},Terrasoft.diagram.enums.ProcessBoundaryEventTypes=["boundaryInterruptingEventMessage","boundaryInterruptingEventTimer","boundaryInterruptingEventError","boundaryInterruptingEventEscalation","boundaryInterruptingEventCompensation","boundaryInterruptingEventConditional","boundaryInterruptingEventSignal","boundaryInterruptingEventMultiple","boundaryInterruptingEventParallel","boundaryNonInterruptingEventMessage","boundaryNonInterruptingEventTimer","boundaryNonInterruptingEventEscalation","boundaryNonInterruptingEventConditional","boundaryNonInterruptingEventSignal","boundaryNonInterruptingEventMultiple","boundaryNonInterruptingEventParallel"],Terrasoft.diagram.enums.ProcessDiagramUnsupportedTerminateEventTypes=["endEventMessage","endEventEscalation","endEventError","endEventCompensate","endEventSignal","endEventTerminate","endEventMultiple","endEventCancel"],Terrasoft.diagram.enums.ProcessDiagramUnsupportedSquareTypes=["complexGateway","startEventConditional","startEventMultiple","startEventParallel","startEventEscalation","startEventError","startEventCompensation","startEventEscalationNonInterrupting","startEventMultipleNonInterrupting","startEventParallelNonInterrupting","startEventConditionalNonInterrupting","intermediateThrowEvent","intermediateThrowEventEscalation","intermediateThrowEventCompensate","intermediateThrowEventLink","intermediateThrowEventMultiple","intermediateCatchEventConditional","intermediateCatchEventLink","intermediateCatchEventMultiple","intermediateCatchEventParallel"].concat(_toConsumableArray(Terrasoft.diagram.enums.ProcessDiagramUnsupportedTerminateEventTypes),_toConsumableArray(Terrasoft.diagram.enums.ProcessBoundaryEventTypes)),Terrasoft.diagram.enums.ProcessDiagramUnsupportedRectangleTypes=["subProcessCollapsed","task","manualTask","businessRuleTask","serviceTask","receiveTask","sendTask","subProcessExpanded"],Terrasoft.diagram.enums.UnsupportedTypeToUserTaskType={task:"activityUserTask",manualTask:"activityUserTask",sendTask:"emailTemplateUserTask",serviceTask:"webService"},Terrasoft.diagram.enums.ProcessDiagramUnsupportedElemenetConst={size:{round:{diameter:31},rectangle:{width:69,height:55}}},Terrasoft.diagram.enums.ProcessDiagramUnsupportedTypes=[].concat(_toConsumableArray(Terrasoft.diagram.enums.ProcessDiagramUnsupportedSquareTypes),_toConsumableArray(Terrasoft.diagram.enums.ProcessDiagramUnsupportedRectangleTypes)),Terrasoft.UnsupportedTypeToUserTaskType=Terrasoft.diagram.enums.UnsupportedTypeToUserTaskType,Terrasoft.ProcessDiagramTypesEnum=Terrasoft.diagram.enums.ProcessDiagramType,Terrasoft.ProcessDiagramUnsupportedTypes=Terrasoft.diagram.enums.ProcessDiagramUnsupportedTypes,Terrasoft.ProcessBoundaryEventTypes=Terrasoft.diagram.enums.ProcessBoundaryEventTypes;Terrasoft.ProcessDiagramUnsupportedTerminateEventTypes=Terrasoft.diagram.enums.ProcessDiagramUnsupportedTerminateEventTypes,Ext.define("Terrasoft.controls.BaseDiagramComponent",{extend:"Terrasoft.BaseDiagram",alternateClassName:"Terrasoft.BaseDiagramComponent",mixins:{customEvent:"Terrasoft.mixins.CustomEventDomMixin"},readOnly:!1,straightConnection:!1,direction:Terrasoft.TextDirection.INHERIT,overflow:"hidden",adapterClassName:Terrasoft.emptyFn,parserClassName:"Terrasoft.DiagramChangesParser",_parser:null,diagramConfig:null,tpl:[],constructor:function(){Terrasoft.getIsRtlMode()&&(this.direction=Terrasoft.TextDirection.RTL),this.callParent(arguments)},init:function(){this.callParent(arguments),this.mixins.customEvent.init.call(this),this._createDiagramChangesParser(),this.subscribeEvents(),this.subscribeCustomEvents()},_createDiagramChangesParser:function(){this._parser=Ext.create(this.parserClassName)},subscribeEvents:function(){this.addEvents("itemsContainerChanged","itemsPositionChanged","linePositionChanged","sizeChanged","generateItemNameAndCaption","polylinePointPositionsChanged","insertNodeInConnector","itemsRemoving","itemsRemoved","connectorCreate","connectorUpdatingType","itemSelected","openPropertyPage","diagramItemCreated","pasteElement","itemValidateUpdatingType","itemTypeUpdated","canCopy","updateStudioFreeDiagramUrl")},subscribeCustomEvents:function(){var e=this,t=this.mixins.customEvent;t.subscribe.call(this,"diagramElementRemoving").subscribe((function(r){e.fireEvent("itemsRemoving",e,{ids:r,next:function(){t.publish.call(e,"elementRemoved",r)},cancel:function(){t.publish.call(e,"removeCancelled",r)}})})),t.subscribe.call(this,"diagramChanged").subscribe((function(t){Ext.isArray(t)&&e._applyDiagramChanges(t)})),t.subscribe.call(this,"diagramElementClick").subscribe((function(t){e.fireEvent("itemSelected",e._getElementName(t))})),t.subscribe.call(this,"diagramElementDoubleClick").subscribe((function(t){e.fireEvent("openPropertyPage",t)})),t.subscribe.call(this,"pasteDiagramElement").subscribe((function(t){e.fireEvent("pasteElement",{element:t}),e.updateItemName(t.id)}))},allowExternalChanges:function(){return!0},getTplData:function(){var e=this.callParent(arguments);return e.readOnly=this.readOnly,e.straightConnection=this.straightConnection,e},getBindConfig:function(){var e=this.callParent(arguments),t={diagramConfig:{changeMethod:"onChangeDiagramConfig"}};return Ext.apply(t,e)},_initDiagramConfig:function(){var e=_asyncToGenerator(regeneratorRuntime.mark((function e(){var t=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,new Promise((function(e){var r=t.mixins.customEvent;r.subscribe.call(t,"getDiagramConfig").subscribe((function(){var n=t.diagramConfig;r.publish.call(t,"setDiagramConfig",n),e()}))}));case 2:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),_findItemByUId:function(e){return this.items.findByPath("uId",e)},_getElementName:function(e){var t=(e=e||{}).itemName||e.name;!t&&e.id&&(t=this._findItemByUId(e.id).name);return t},_applyDiagramChanges:function(e){var t=this,r=this._parser.getChangesForSchema(e,this.items);Terrasoft.each(r,(function(e,r){switch(r){case"update":t._applyUpdateChanges(e);break;case"remove":t._applyRemoveChanges(e);break;case"add":t._applyAddChanges(e)}}))},_applyAddChanges:function(e){var t=this;Terrasoft.each(e,(function(e,r){switch(r){case"connections":t._addConnections(e);break;case"elements":t._addElements(e);break;case"labels":t._addLabels(e)}}))},_addConnections:function(e){var t=this;e.length>0&&Terrasoft.each(e,(function(e){t.fireEvent("connectorCreate",e.itemValue),t.updateItemName(e.itemValue.id)}))},_addElements:function(e){var t=this;e.length>0&&Terrasoft.each(e,(function(e){t.fireEvent("diagramItemCreated",e.itemValue),t.updateItemName(e.itemValue.id)}))},_addLabels:function(e){var t=this;e.forEach((function(e){return t.fireEvent("diagramItemCreated",e.itemValue)}))},_applyUpdateChanges:function(e){var t=this;Terrasoft.each(e,(function(e,r){switch(r){case"connections":t._updateConnections(e);break;case"elements":t._updateElements(e);break;case"labels":t._updateLabels(e)}}))},_applyRemoveChanges:function(e){var t=this;Terrasoft.each(e,(function(e,r){switch(r){case"connections":e.forEach((function(e){return t._deleteConnection(e)}));break;case"elements":case"labels":t._deleteElements(e)}}))},_deleteElements:function(e){this.fireEvent("itemsRemoved",{ids:e.map((function(e){return e.itemValue.id}))})},_deleteConnection:function(e){e&&e.name&&this.items.removeByKey(e.name)},_getPolylinePositionsChanges:function(e){if(e.length>0)return e.filter((function(e){return e.hasOwnProperty("polylinePointPositions")}))},_getConnectorValueChanges:function(e){if(e.length>0)return Terrasoft.deepClone(e).filter((function(e){return e.hasOwnProperty("itemValue")})).map((function(e){return delete e.itemValue.type,e.itemValue}))},_getConnectorTypeChanges:function(e){if(e.length>0)return e.filter((function(e){return e.hasOwnProperty("itemValue")&&e.itemValue.hasOwnProperty("type")})).map((function(e){return{name:e.name,type:e.itemValue.type}}))},_updateConnections:function(e){var t=this;if(e.length>0){var r;if((r=this._getPolylinePositionsChanges(e)).length>0&&this.fireEvent("polylinePointPositionsChanged",r),(r=this._getConnectorValueChanges(e)).length>0&&this.fireEvent("connectorsNodesChange",r),(r=this._getConnectorTypeChanges(e)).length>0){this.fireEvent("connectorUpdatingType",{connections:r,next:function(e){var r=e.id,n=e.name,i=e.caption,a=t.mixins.customEvent;a.publish.call(t,"updateElementName",{id:r,name:n}),a.publish.call(t,"setIsElementValid",{id:r,isValid:!0}),a.publish.call(t,"elementCaptionChanged",{id:r,caption:i})}})}this._updateConnectionCaptions(e)}},_updateConnectionCaptions:function(e){var t=this;e.forEach((function(e){var r=e.itemValue;if(r&&r.hasOwnProperty("caption")){var n={element:{name:r.name},value:r.caption};t.fireEvent("textChange",n)}}))},_updateItemsPosition:function(e){var t=e.filter((function(e){return e.hasOwnProperty("position")}));Ext.isEmpty(t)||this.fireEvent("itemsPositionChanged",t)},_updateElements:function(e){var t=this;e&&(e=Array.isArray(e)?e:[e],this._updateItemsPosition(e),e.forEach((function(e){if(e.hasOwnProperty("size")&&t.fireEvent("sizeChanged",e),e.hasOwnProperty("parent")&&t.fireEvent("itemsContainerChanged",e),e.hasOwnProperty("caption")){var r={element:{name:e.itemName},value:e.caption};t.fireEvent("textChange",r)}})))},_updateLabels:function(e){e&&this._updateItemsPosition(e)},onCollectionDataLoaded:function(e,t){(e=t||e)&&!e.isEmpty()&&this.mixins.customEvent.subscribe.call(this,"diagramInitialized",this.allowExternalChanges()).subscribe(function(){this.renderItems(t)}.bind(this))},renderItems:function(e){var t=this.getDiagramData(e);this.mixins.customEvent.publish.call(this,"diagramDataLoaded",t)},setIsElementValid:function(e,t){this.mixins.customEvent.publish.call(this,"setIsElementValid",{id:e,isValid:t})},selectItem:function(e){var t=this.items.findByPath("name",e);t&&this.mixins.customEvent.publish.call(this,"elementSelected",{id:t.uId})},itemCenterViewBox:function(e){var t=this.items.findByPath("name",e);t&&this.mixins.customEvent.publish.call(this,"elementCenterViewBox",{id:t.uId})},clearSelection:function(){this.mixins.customEvent.publish.call(this,"elementSelected",{})},initDiagram:function(){var e=_asyncToGenerator(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this._initDiagramConfig();case 2:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),getDiagramDataAdapter:function(){return Ext.create(this.adapterClassName)},getDiagramData:function(e){return this.getDiagramDataAdapter().getDiagramData(e)},updateItemName:function(e){var t=this.mixins.customEvent,r=this._findItemByUId(e);r&&t.publish.call(this,"updateElementName",{id:r.uId,name:r.name})},onChangeDiagramConfig:function(e){this.diagramConfig=e},onDestroy:function(){this.mixins.customEvent.destroy.call(this),this.callParent(arguments)},setNodeCaption:function(e,t){var r=this.items.find(e);r&&this.mixins.customEvent.publish.call(this,"elementCaptionChanged",{id:r.uId,caption:t})},updateElementMarkers:function(e,t){var r=this.mixins.customEvent,n=this._findItemByUId(e);n&&r.publish.call(this,"updateElementMarkers",{id:n.uId,markers:t})}}),Ext.define("Terrasoft.diagram.ProcessDiagramTypeResolver",{alternateClassName:"Terrasoft.mixins.ProcessDiagramTypeResolver",_elementConstSize:Terrasoft.diagram.enums.ProcessDiagramUnsupportedElemenetConst.size,_getElementSize:function(e){var t,r;return Terrasoft.diagram.enums.ProcessDiagramUnsupportedSquareTypes.indexOf(e)>-1?t=r=this._elementConstSize.round.diameter:(t=this._elementConstSize.rectangle.width,r=this._elementConstSize.rectangle.height),{width:t,height:r}},_getElementLargeImage:function(e){return{largeImage:Terrasoft.toCamelCase(e)+"Large.svg"}},toDiagramType:function(e){return["Terrasoft.manager.ProcessUnsupportedElementSchema","Terrasoft.manager.ProcessUnsupportedTerminateEventSchema","Terrasoft.manager.ProcessBoundaryEventSchema"].includes(e.$className)?e.unsupportedType:Terrasoft.ProcessDiagramTypesEnum[e.$className]},toDiagramTypeName:function(e){switch(e.$className){case"Terrasoft.manager.ProcessFormulaTaskSchema":case"Terrasoft.manager.ProcessUserTaskSchema":case"Terrasoft.manager.ProcessSchemaUserTask":case"Terrasoft.manager.ProcessWebServiceSchema":return Terrasoft.toLowerCamelCase(e.name);case"Terrasoft.manager.ProcessEndEventSchema":return"endEvent2";default:return this.toDiagramType(e)}},getUnsupportedElementConfig:function(e){if(Terrasoft.ProcessDiagramUnsupportedTypes.indexOf(e)<0)return null;var t=Object.assign({type:e},this._getElementSize(e),this._getElementLargeImage(e)),r=Terrasoft.UnsupportedTypeToUserTaskType[e];return r&&(t.transformToType=r),t}}),Ext.define("Terrasoft.diagram.DiagramDataAdapter",{extend:"Terrasoft.BaseDiagramDataAdapter",alternateClassName:"Terrasoft.DiagramDataAdapter",_getUserTaskType:function(e){var t=Terrasoft.ProcessFlowElementSchemaManager.getItems().getItems().find((function(t){return t.uId===e.managerItemUId}));if(!t)return null;var r=t.instance;return"userTask"===this.getType(e)?Terrasoft.toLowerCamelCase(r.name):r.type},hasEmbeddedLabel:function(e){var t=this.getType(e);return["lane","laneSet","eventSubProcessExpanded"].includes(t)},getExecutedCountLabels:function(e){return e.executedCount<=0?null:this.callParent(arguments)},getType:function(e){var t=Ext.create("Terrasoft.diagram.ProcessDiagramTypeResolver").toDiagramType(e);return t||(console.warn("Not supported class"+e.$className),t="userTask"),t},getElementConfig:function(e,t){var r=this.callParent(arguments);if(!r)return null;var n=this._getUserTaskType(t);return Ext.apply(r,{userTaskType:n}),r}}),Ext.define("Terrasoft.controls.ProcessDiagramComponent",{extend:"Terrasoft.BaseDiagramComponent",alternateClassName:"Terrasoft.ProcessDiagramComponent",adapterClassName:"Terrasoft.DiagramDataAdapter",canImport:!0,tpl:['<div id="diagram-{id}" class="{wrapClassName}">','<ts-process-diagram readonly="{readOnly}" straightconnection="{straightConnection}"  dir="{direction}" canimport="{canImport}">',"</ts-process-diagram>","</div>"],getBindConfig:function(){var e=this.callParent(arguments),t={importData:{changeMethod:"onImportDataChanged"},suggestions:{changeMethod:"onSuggestionsChanged"},suggestionsTriggered:{changeMethod:"onSuggestionsTriggered"}};return Ext.apply(t,e)},getTplData:function(){var e=this.callParent(arguments);return e.canImport=this.canImport,e},subscribeEvents:function(){this.callParent(),this.addEvents("importError","diagramImportStart","itemSuggestionsClick")},onImportDataChanged:function(e){e&&this.mixins.customEvent.publish("bpmnFileImported",e)},onSuggestionsChanged:function(e){e&&this.mixins.customEvent.publish("elementSuggestionsReceived",e)},onSuggestionsTriggered:function(e){e&&this.mixins.customEvent.publish("elementSuggestionsTriggered",e)},init:function(){require(["process-designer-component"],(function(){})),this.callParent(arguments)},subscribeCustomEvents:function(){var e=this;this.callParent(arguments);var t=this.mixins.customEvent;t.subscribe("diagramElementValidateUpdatingType").subscribe((function(r){var n=r.id,i=r.config;e.fireEvent("itemValidateUpdatingType",e,n,(function(){t.publish("elementUpdateType",{id:n,config:i}),e.mixins.customEvent.publish("setIsElementValid",{id:n,isValid:!0})}))})),t.subscribe("diagramElementTypeUpdated").subscribe((function(r){e.fireEvent("itemTypeUpdated",e,r,(function(e){t.publish("updateElementName",{id:r.id,name:e})}))})),t.subscribe("diagramUrlUpdated").subscribe((function(t){e.fireEvent("updateStudioFreeDiagramUrl",e,t)})),t.subscribe("getCanCopy").subscribe((function(r){var n=e.fireEvent("canCopy",r);t.publish("setCanCopy",n)})),t.subscribe("diagramImportError").subscribe((function(){e.fireEvent("importError",e)})),t.subscribe("diagramImportStart").subscribe((function(){e.fireEvent("diagramImportStart",e)})),t.subscribe("itemSuggestionsClick").subscribe((function(t){e.fireEvent("itemSuggestionsClick",t)}))}}),Ext.define("Terrasoft.core.BaseServiceProvider",{extend:"Terrasoft.BaseObject",alternateClassName:"Terrasoft.BaseServiceProvider",statics:{requestTimeout:3e4,_getCachedSetting:function(e){return Terrasoft.SysSettings&&Terrasoft.SysSettings.getCachedSysSetting?Terrasoft.SysSettings.getCachedSysSetting(e):null},getRequestTimeout:function(e,t){var r=this._getCachedSetting("DataServiceQueryTimeout"),n=e.data,i=n&&n.requestTimeout,a=this.requestTimeout;return i||t||r||a}},requestMethod:"POST",requestTimeout:null,serviceUrl:"",requestProvider:Terrasoft.AjaxProvider,buildRequest:function(e,t,r){var n=e.data,i=n&&n.instanceId,a=this.getJsonData(n),s="",o="";r&&(s=r.cacheLevel,o=r.cacheKey);var l={"Content-Type":"application/json"};return Terrasoft.findValueByPath(e,"data.useTimeStampHeader")&&this._addTimestampToHeaders(l),{url:e.url||this.getRequestUrl(e.serverMethod),headers:l,method:this.requestMethod,jsonData:a,timeout:this.getRequestTimeout(e),scope:this,callback:function(e,n,i){if(r=r||this,Ext.isFunction(t)&&!0!==r.destroyed){var a=this.parseResponse(i,n);t.call(r,a)}},cacheLevel:s,cacheKey:o,instanceId:i}},_addTimestampToHeaders:function(e){e.Timestamp=new Date(Date.now()).toISOString()},getJsonData:function(e){return Ext.isString(e)?e:Ext.isFunction(e.serialize)?e.serialize():Terrasoft.encode(e)},getResponseObject:function(e,t){var r=e?e.responseText:"";if(e&&e.timedout)throw new Terrasoft.QueryExecutionException({message:Terrasoft.Resources.DataProvider.timeoutResponseExceptionMessage});if(Ext.isEmpty(r))throw new Terrasoft.QueryExecutionException({message:Terrasoft.Resources.DataProvider.emptyResponseExceptionMessage});try{return Terrasoft.decode(r)}catch(r){throw new Terrasoft.QueryExecutionException({message:t?r.message:e.statusText})}},parseResponse:function(e,t){var r,n,i,a=Terrasoft.Features.getIsEnabled("DoNotProcessErrorInfoFromResponse");try{n=this.getResponseObject(e,a||t)}catch(t){r={message:t.message,response:e}}if(n&&(i=n.ResponseStatus||n.responseStatus),!a&&n&&n.errorInfo&&(r=n.errorInfo),!r&&i&&(r={errorCode:i.ErrorCode,message:i.Message,stackTrace:i.StackTrace,errors:i.Errors}),r){var s={success:!1,errorInfo:r};return n&&n.validationErrors&&(s.validationErrors=_toConsumableArray(n.validationErrors)),s}return n.success=a||t,n},getRequestTimeout:function(e){return Terrasoft.BaseServiceProvider.getRequestTimeout(e,this.requestTimeout)},getRequestUrl:Terrasoft.abstractFn,prepareResponse:function(e,t){var r=e.responseClassName;if(r){var n=Ext.create(r,t);return Ext.isFunction(n.setRequestConfig)&&n.setRequestConfig(e),n}return t},executeRequest:function(e,t,r){var n=this.buildRequest(e,t,r);return this.requestProvider.request(n)},execute:function(e,t,r){this.executeRequest(e,(function(n){var i=this.prepareResponse(e,n);Ext.callback(t,r,[i])}),this)},executeAsync:function(e){var t=this;return new Promise((function(r){t.executeRequest(e,(function(n){var i=t.prepareResponse(e,n);r(i)}),t)}))}}),Ext.define("Terrasoft.core.ServiceProvider",{extend:"Terrasoft.BaseServiceProvider",alternateClassName:"Terrasoft.ServiceProvider",singleton:!0,serviceUrl:"../DataService/json",sspServiceUrl:"../DataService/ssp/json",_getIsNeedToUseSspServiceUrl:function(){return Terrasoft.CurrentUser&&Terrasoft.isCurrentUserSsp()&&Terrasoft.Features.getIsEnabled("UsePortalDataService")},getRequestUrl:function(e){var t=this._getIsNeedToUseSspServiceUrl()?this.sspServiceUrl:this.serviceUrl;return Terrasoft.combinePath(t,"SyncReply",e)},buildRequest:function(e,t,r,n){if(Ext.isObject(e))return this.callParent(arguments);var i={serverMethod:e,data:t};return this.callParent([i,r,n])},executeRequest:function(e,t,r,n){if(Ext.isObject(e))return this.callParent(arguments);var i={serverMethod:e,data:t};return this.callParent([i,r,n])}}),Ext.define("Terrasoft.core.DataProvider",{extend:"Terrasoft.BaseObject",alternateClassName:"Terrasoft.DataProvider",singleton:!0,serviceProvider:Terrasoft.ServiceProvider,dataServiceMethods:["SelectQuery","InsertQuery","UpdateQuery","DeleteQuery","BatchQuery","ListSelectQuery","FilteredSelectQuery","LookupSelectQuery","UpdateLocalizationQuery","SelectLocalizationQuery"],getFiltersMetaDataServiceMethod:"Filters",_queries:[],_batchSize:10,_esqCount:0,_bqCount:0,_printStatistic:!1,autoBatchDelay:100,autoBatch:Terrasoft.Features&&Terrasoft.Features.getIsEnabled("DataProviderAutoBatch"),_isBatchable:function(e){return(this.autoBatch||e.isBatchable)&&e.operationType===Terrasoft.QueryOperationType.SELECT},_execute:function(){var e=this._queries.shift();if(e){for(var t=Ext.create("Terrasoft.BatchQuery");e;)t.add.apply(t,e),e=this._queries.shift();this._bqCount++,t.execute(Terrasoft.emptyFn,this)}this._printStatistic&&(console.clear(),console.info(this._getStatistic()))},_getStatistic:function(){var e=Ext.Number.toFixed(100-100*this._bqCount/this._esqCount,1);return Ext.String.format("ESQ:{0} | BQ:{1} | ECO:{2}%",this._esqCount,this._bqCount,e)},executeQuery:function(e,t,r){if(!this._isBatchable(e))return this.serviceProvider.executeRequest(this.dataServiceMethods[e.operationType],e,t,r);this._queries.push([e,t,r]),this._esqCount++,Terrasoft.debounce(this._execute.bind(this),this.autoBatchDelay,this._queries.length>=this._batchSize)()},getFiltersMetaData:function(e,t,r){this.serviceProvider.executeRequest(this.getFiltersMetaDataServiceMethod,e,t,r)}}),Ext.define("Terrasoft.data.queries.BaseQuery",{extend:"Terrasoft.core.BaseObject",alternateClassName:"Terrasoft.BaseQuery",mixins:{serializable:"Terrasoft.Serializable"},queryItemConfig:null,queryKind:Terrasoft.QueryKind.GENERAL,useTimeStampHeader:!1,operationType:Terrasoft.QueryOperationType.SELECT,rootSchema:null,rootSchemaName:"",parameters:null,cacheLevel:"",cacheKey:"",request:null,isBatchable:!1,includeProcessExecutionData:!0,publishProcessExecutionData:!0,constructor:function(e){Ext.isString(e)&&(e={rootSchemaName:e}),this.callParent([e]),this.initQueryItems()},getSerializableObject:function(e){var t=this.rootSchema;e.rootSchemaName=t?t.name:this.rootSchemaName,e.operationType=this.operationType,this.includeProcessExecutionData&&Terrasoft.Features.getIsEnabled("GetProcessStepsViaResponse")&&(e.includeProcessExecutionData=!0),this.queryKind!==Terrasoft.QueryKind.GENERAL&&(e.queryKind=this.queryKind)},initQueryItems:function(){this.parameters=Ext.create("Terrasoft.Parameters")},parseResponse:function(e,t,r){this.publishProcessExecutionData&&Terrasoft.ProcessExecutionDataCollector.add(e.processExecutionData),Ext.callback(t,r,[e])},execute:function(e,t){!0!==this.destroyed&&(this.request=Terrasoft.DataProvider.executeQuery(this,(function(r){this.responseHandler(r,e,t)}),this))},responseHandler:function(e,t,r){if(!(r&&r.destroyed||(this.parseResponse(e,t,r),e.success)))throw new Terrasoft.exceptions.QueryExecutionException(e.errorInfo)},onDestroy:function(){this.abortQuery(),this.parameters.destroy(),delete this.parameters,this.callParent(arguments)},abortQuery:function(){var e=this.request;e&&!e.completed&&Terrasoft.AjaxProvider.abortRequest(e)}}),Ext.define("Terrasoft.data.queries.BaseFilterableQuery",{extend:"Terrasoft.data.queries.BaseQuery",alternateClassName:"Terrasoft.BaseFilterableQuery",primaryColumnFilterName:"primaryColumnFilter",filtersEnabledState:null,filters:null,primaryColumnFilter:null,initPrimaryColumnFilter:function(){var e=Ext.create("Terrasoft.FunctionExpression",{functionType:Terrasoft.FunctionType.MACROS,macrosType:Terrasoft.QueryMacrosType.PRIMARY_COLUMN}),t=Ext.create("Terrasoft.ParameterExpression",{parameterValue:"",parameterDataType:Terrasoft.DataValueType.GUID}),r=this.createCompareFilter(Terrasoft.ComparisonType.EQUAL,e,t);return r.isEnabled=!1,this.filters.add(this.primaryColumnFilterName,r),r},disablePrimaryColumnFilter:function(){var e=this.primaryColumnFilter;if(e){e.isEnabled=!1;var t=this.filters;Terrasoft.each(this.filtersEnabledState,(function(e,r){t.get(r).isEnabled=e}))}},initQueryItems:function(){this.callParent(arguments),this.filters=Ext.create("Terrasoft.FilterGroup")},getSerializableObject:function(e){this.callParent(arguments);var t=this.filters;e.filters=t.isEmpty()?null:this.getSerializableProperty(t)},validateFilters:function(){if(!Terrasoft.Features.getIsDisabled("QueryStrictMode")&&(!this.filters.isEmpty()&&!1===this.filters.mapArray((function(e){return e.getIsCompleted({recursive:!0})}),this).every((function(e){return!0===e}))))throw new Error("One or more filters are not filled, please fill in all filters and try again.")},enablePrimaryColumnFilter:function(e){var t=this.filtersEnabledState={};this.filters.eachKey((function(e,r){t[e]=r.isEnabled,r.isEnabled=!1}));var r=this.primaryColumnFilter=this.primaryColumnFilter||this.initPrimaryColumnFilter(),n=r.rightExpression.parameter;n.setValue(e),n.setDataValueType(Terrasoft.DataValueType.GUID),r.isEnabled=!0},createFilterGroup:function(){return Terrasoft.createFilterGroup()},createCompareFilter:function(e,t,r){return Terrasoft.createCompareFilter(e,t,r)},createBetweenFilter:function(e,t,r){return Terrasoft.createBetweenFilter(e,t,r)},createIsNullFilter:function(e){return Terrasoft.createIsNullFilter(e)},createIsNotNullFilter:function(e){return Terrasoft.createIsNotNullFilter(e)},createInFilter:function(e,t){return Terrasoft.createInFilter(e,t)},createFilter:function(e,t,r){return Terrasoft.createFilter(e,t,r)},createColumnFilterWithParameter:function(e,t,r,n){return Terrasoft.createColumnFilterWithParameter(e,t,r,n)},createPrimaryDisplayColumnFilterWithParameter:function(e,t,r){return Terrasoft.createPrimaryDisplayColumnFilterWithParameter(e,t,r)},createColumnBetweenFilterWithParameters:function(e,t,r,n){return Terrasoft.createColumnBetweenFilterWithParameters(e,t,r,n)},createColumnIsNullFilter:function(e){return Terrasoft.createColumnIsNullFilter(e)},createColumnIsNotNullFilter:function(e){return Terrasoft.createColumnIsNotNullFilter(e)},createColumnInFilterWithParameters:function(e,t,r){return Terrasoft.createColumnInFilterWithParameters(e,t,r)},createExistsFilter:function(e){return Terrasoft.createExistsFilter(e)},createNotExistsFilter:function(e){return Terrasoft.createNotExistsFilter(e)},onDestroy:function(){this.filters.destroy(),delete this.filters,this.callParent(arguments)}}),Ext.define("Terrasoft.data.queries.EntitySchemaQuery",{extend:"Terrasoft.data.queries.BaseFilterableQuery",alternateClassName:"Terrasoft.EntitySchemaQuery",statics:{cache:{},clearCache:function(e){e?(Ext.isArray(e)||(e=[e]),e.forEach((function(e){delete this.cache[e]}),this)):this.cache={}}},columns:null,allColumns:!1,isDistinct:!1,ignoreDisplayValues:!1,rowCount:-1,rowsOffset:-1,chunkSize:-1,defaultPrimaryColumnName:"Id",isPageable:!1,conditionalValues:null,isHierarchical:!1,hierarchicalMaxDepth:0,hierarchicalColumnName:"",hierarchicalColumnValue:"",useLocalization:!0,useRecordDeactivation:!1,rowViewModelClassName:"Terrasoft.BaseViewModel",serverESQCacheParameters:null,clientESQCacheParameters:null,queryOptimize:!1,useReExecute:!1,useMetrics:!1,adminUnitRoleSources:Terrasoft.AdminUnitRoleSources.None,querySource:Terrasoft.QuerySource.UNDEFINED,constructor:function(e){if(this.callParent(arguments),this.serverESQCacheParameters={cacheLevel:Terrasoft.ESQServerCacheLevels.SESSION,cacheGroup:"",cacheItemName:""},!Ext.Object.isEmpty(e)&&e.hasOwnProperty("serverESQCacheParameters")){var t=e.serverESQCacheParameters;t.hasOwnProperty("cacheLevel")&&(this.serverESQCacheParameters.cacheLevel=t.cacheLevel),t.hasOwnProperty("cacheGroup")&&(this.serverESQCacheParameters.cacheGroup=t.cacheGroup),t.hasOwnProperty("cacheItemName")&&(this.serverESQCacheParameters.cacheItemName=t.cacheItemName)}if(this.clientESQCacheParameters={cacheItemName:""},!Ext.Object.isEmpty(e)&&e.hasOwnProperty("clientESQCacheParameters")){var r=e.clientESQCacheParameters;r.hasOwnProperty("cacheItemName")&&(this.clientESQCacheParameters.cacheItemName=r.cacheItemName)}this.useTimeStampHeader=this._isUseQueryOptimize(),this.addEvents("createviewmodel","reexecute")},_destroy:function(){this.columns.destroy(),delete this.columns},createViewModelByQueryResult:function(e,t){var r=this.getViewModelRowConfig(t),n={viewModel:{},rawData:e,rowConfig:r};return this.fireEvent("createviewmodel",n),Ext.Object.isEmpty(n.viewModel)?Ext.create(this.rowViewModelClassName,{entitySchema:this.rootSchema,rowConfig:r,values:e,isNew:!1,isDeleted:!1}):n.viewModel},getViewModelRowConfig:function(e){var t=e;return this.columns.eachKey((function(e,r){t[e]&&(t[e].columnPath=r.columnPath)}),this),t},getViewModelByQueryResult:function(e,t){return Terrasoft.each(t,(function(t,r){var n=t.dataValueType;if(n===Terrasoft.DataValueType.DATE||n===Terrasoft.DataValueType.DATE_TIME||n===Terrasoft.DataValueType.TIME){var i=e[r];e[r]=Ext.isEmpty(i)?null:Terrasoft.parseDate(i)}}),this),this.createViewModelByQueryResult(e,t)},getClientCacheItemName:function(e){var t="";return this.clientESQCacheParameters&&(t=this.clientESQCacheParameters.cacheItemName),!t&&this.serverESQCacheParameters&&(t=this.serverESQCacheParameters.cacheItemName),t&&e&&(t=t+"__"+e),t},getSerializableObject:function(e){this.callParent(arguments),e.columns=this.getSerializableProperty(this.columns),e.isDistinct=this.isDistinct,e.rowCount=this.rowCount,this.chunkSize>0&&(e.chunkSize=this.chunkSize),e.rowsOffset=this.rowsOffset,e.isPageable=this.isPageable,e.allColumns=this.allColumns,e.useLocalization=this.useLocalization,e.useRecordDeactivation=this.useRecordDeactivation,e.serverESQCacheParameters=this.serverESQCacheParameters,e.queryOptimize=this.queryOptimize,e.useMetrics=this.useMetrics,e.adminUnitRoleSources=this.adminUnitRoleSources,e.querySource=this.querySource,e.ignoreDisplayValues=this.ignoreDisplayValues,this.isPageable&&(e.conditionalValues=this.getSerializableProperty(this.conditionalValues)),e.isHierarchical=this.isHierarchical,this.isHierarchical&&(e.hierarchicalMaxDepth=this.hierarchicalMaxDepth,e.hierarchicalColumnName=this.hierarchicalColumnName,e.hierarchicalColumnValue=this.hierarchicalColumnValue)},initQueryItems:function(){this.callParent(arguments),this.columns=Ext.create("Terrasoft.QueryColumns")},addColumn:function(e,t,r){return this.columns.addColumn(e,t,r)},addParameterColumn:function(e,t,r){return this.columns.addParameterColumn(e,t,r)},addMacrosColumn:function(e,t){return this.columns.addMacrosColumn(e,t)},addDatePeriodMacrosColumn:function(e,t,r){return this.columns.addDatePeriodMacrosColumn(e,t,r)},addDatePartFunctionColumn:function(e,t,r){return this.columns.addDatePartFunctionColumn(e,t,r)},addAggregationSchemaColumn:function(e,t,r,n){return this.columns.addAggregationSchemaColumn(e,t,r,n)},addWindowFunctionColumn:function(e,t,r,n){return this.columns.addWindowFunctionColumn(e,t,r,n)},addFunctionColumn:function(e,t,r){return this.columns.addFunctionColumn(e,t,r)},addArithmeticColumn:function(e,t,r,n){return this.columns.addArithmeticColumn(e,t,r,n)},_parseGetEntityResponse:function(e,t,r,n){if(!n||!n.destroyed){var i={success:e.success,entity:null};if(e.success&&(e.entity?i.entity=e.entity:e.collection?i.entity=e.collection.find(t)||e.collection.first():(this._storeQueryResponseToCache(e,t),i.entity=this._getEntityFromQueryResponse(e))),Ext.callback(r,n||this,[i]),!e.success)throw new Terrasoft.exceptions.QueryExecutionException(e.errorInfo)}},_getEntityFromQueryResponse:function(e){var t=null;return e.rowsAffected>0&&(e.rowConfig||this._setDefaultRowConfig(e),t=this.getViewModelByQueryResult(e.rows[0],e.rowConfig)),t},_storeQueryResponseToCache:function(e,t){if(e.success){var r=Terrasoft.EntitySchemaQuery.cache,n=this.getClientCacheItemName(t);n&&!r[n]&&(r[n]=Terrasoft.deepClone(e))}},_restoreQueryResponseFromCache:function(e){var t=Terrasoft.EntitySchemaQuery.cache,r=this.getClientCacheItemName(e);return r&&t[r]&&Terrasoft.deepClone(t[r])},getEntity:function(e,t,r){if(!e)throw new Terrasoft.ArgumentNullOrEmptyException;if(!0!==this.destroyed){var n=this._restoreQueryResponseFromCache(e);n?Ext.callback(t,r||this,[{success:n.success,entity:this._getEntityFromQueryResponse(n)}]):(this.enablePrimaryColumnFilter(e),Terrasoft.DataProvider.executeQuery(this,(function(n){this.disablePrimaryColumnFilter(),this._parseGetEntityResponse(n,e,t,r)}),this))}},getEntityCollection:function(e,t){this.execute(e,t)},_setDefaultRowConfig:function(e){e.rowConfig={},this.columns.eachKey((function(t){e.rowConfig[t]={}}),this)},_updateRowConfigWithNotFoundColumns:function(e){(e.notFoundColumns||[]).forEach((function(t){e.rowConfig[t]={dataValueType:Terrasoft.DataValueType.TEXT,isNotFound:!0}}))},_getResponseEntityCollection:function(e){var t=e.rowConfig,r=Ext.create("Terrasoft.BaseViewModelCollection",{entitySchema:this.rootSchema,rowConfig:t});if(e.success&&e.rowsAffected>0){var n=this.rootSchema?this.rootSchema.primaryColumnName:this.defaultPrimaryColumnName;Terrasoft.each(e.rows,(function(e){var i=this.getViewModelByQueryResult(e,t);if(t[n]){var a=i.get(n);r.contains(a)?r.addItem(i):r.add(a,i)}else r.addItem(i)}),this)}return r},parseResponse:function(e,t,r){if(e.collection)Ext.callback(t,r,[e]);else{this._storeQueryResponseToCache(e),e.rowConfig||this._setDefaultRowConfig(e),this._updateRowConfigWithNotFoundColumns(e);var n={success:e.success,collection:this._getResponseEntityCollection(e),errorInfo:e.errorInfo};this.callParent([n,t,r])}},responseHandler:function(e,t,r){if(this._isUseReExecute(e))return this.queryOptimize=!0,this.fireEvent("reexecute"),void this.execute(t,r);this.callParent(arguments)},_isUseReExecute:function(e){var t=Terrasoft.findValueByPath(e,"errorInfo.response.timedout");return e&&!e.success&&t&&this.useReExecute&&!this.queryOptimize&&this._isUseQueryOptimize()},_isUseQueryOptimize:function(){return Terrasoft.Features.getIsEnabled("UseQueryOptimize")||Terrasoft.isDebug},execute:function(e,t){var r=this.getClientCacheItemName(),n=Terrasoft.EntitySchemaQuery.cache;if(r&&n[r]){var i=n[r];this.parseResponse(Terrasoft.deepClone(i),e,t)}else this.callParent(arguments)},onDestroy:function(){if(!this.destroyed){var e=this.getParentMethod(this,arguments);Terrasoft.DataProvider.autoBatch?Terrasoft.delay((function(){this._destroy(),e()}),this,10*Terrasoft.DataProvider.autoBatchDelay):(this._destroy(),e())}}}),Ext.define("Terrasoft.data.queries.SysSettingQuery",{alternateClassName:"Terrasoft.SysSettingQuery",extend:"Terrasoft.EntitySchemaQuery",rowViewModelClassName:"Terrasoft.SysSettingViewModel"}),Ext.ns("Terrasoft.data.queries"),Ext.define("Terrasoft.data.queries.SelectLocalizationQuery",{extend:"Terrasoft.EntitySchemaQuery",alternateClassName:"Terrasoft.SelectLocalizationQuery",operationType:Terrasoft.QueryOperationType.SELECT_LOCALIZATION}),Ext.define("Terrasoft.data.queries.DeleteQuery",{extend:"Terrasoft.BaseFilterableQuery",alternateClassName:"Terrasoft.DeleteQuery",operationType:Terrasoft.QueryOperationType.DELETE,getSerializableObject:function(){this.callParent(arguments),this.validateFilters()}}),Ext.ns("Terrasoft.data.queries"),Ext.define("Terrasoft.data.queries.UpdateQuery",{extend:"Terrasoft.BaseFilterableQuery",alternateClassName:"Terrasoft.UpdateQuery",operationType:Terrasoft.QueryOperationType.UPDATE,columnValues:null,isForceUpdate:!1,initQueryItems:function(){this.callParent(arguments),this.columnValues=Ext.create("Terrasoft.ColumnValues")},getSerializableObject:function(e){this.callParent(arguments),this.validateFilters(),e.columnValues=this.getSerializableProperty(this.columnValues),e.isForceUpdate=this.getSerializableProperty(this.isForceUpdate)},setColumnValue:function(e,t){return this.columnValues.setColumnValue(e,t)},setParameterValue:function(e,t,r){!r&&this.rootSchema&&(r=this.rootSchema.getColumnByName(e).dataValueType);return this.columnValues.setParameterValue(e,t,r)},setFunctionValue:function(e,t){return this.columnValues.setFunctionValue(e,t)},onDestroy:function(){this.columnValues.destroy(),delete this.columnValues,this.callParent(arguments)}}),Ext.ns("Terrasoft.data.queries"),Ext.define("Terrasoft.data.queries.UpdateLocalizationQuery",{extend:"Terrasoft.UpdateQuery",alternateClassName:"Terrasoft.UpdateLocalizationQuery",operationType:Terrasoft.QueryOperationType.UPDATE_LOCALIZATION}),Ext.define("Terrasoft.data.queries.InsertQuery",{extend:"Terrasoft.BaseQuery",alternateClassName:"Terrasoft.InsertQuery",operationType:Terrasoft.QueryOperationType.INSERT,columnValues:null,initQueryItems:function(){this.callParent(arguments),this.columnValues=Ext.create("Terrasoft.ColumnValues")},getSerializableObject:function(e){this.callParent(arguments),e.columnValues=this.getSerializableProperty(this.columnValues)},setColumnValue:function(e,t){return this.columnValues.setColumnValue(e,t)},setParameterValue:function(e,t,r){!r&&this.rootSchema&&(r=this.rootSchema.getColumnByName(e).dataValueType);return this.columnValues.setParameterValue(e,t,r)},setFunctionValue:function(e,t){return this.columnValues.setFunctionValue(e,t)},onDestroy:function(){this.columnValues.destroy(),delete this.columnValues,this.callParent(arguments)}}),Ext.define("Terrasoft.core.mixins.EntityBaseViewModelMixin",{extend:"Terrasoft.core.BaseObject",alternateClassName:"Terrasoft.EntityBaseViewModelMixin",entitySchema:null,primaryColumnName:"",primaryImageColumnName:"",primaryDisplayColumnName:"",deleteQuery:null,insertQuery:null,updateQuery:null,_isLoading:!1,_findPrimaryDataModel:function(){return this.dataModelCollection&&this.dataModelCollection.findPrimary()},getDeleteQuery:function(){return this._findPrimaryDataModel().getDeleteQuery()},getInsertQuery:function(){return this._findPrimaryDataModel().getInsertQuery()},getUpdateQuery:function(){return this._findPrimaryDataModel().getUpdateQuery(this.get("IsProcessMode"))},setColumnValues:function(e,t){Terrasoft.each(this.columns,(function(r,n){e.columns[n]&&r.type===Terrasoft.ViewModelColumnType.ENTITY_COLUMN&&!0!==r.isCollection&&this.setColumnValue(n,e.get(n),t)}),this)},getSafeEntityColumn:function(e){return window.console.warn(Ext.String.format(Terrasoft.Resources.ObsoleteMessages.ObsoleteMethodMessage,"getSafeEntityColumn","findEntityColumn")),this.findEntityColumn(e)},getLookupDataCallback:function(e,t){this.removeLookupDataRequestInstanceId(e&&e.columnName),this.isListFullyLoaded=!t.collection.getCount();var r={},n={collection:t.collection,columnName:e.columnName,filterValue:e.filterValue,isLookupEdit:e.isLookupEdit,objects:r};this.onLookupDataLoaded(n),e.list.loadAll(r),Ext.callback(e.callback,e.scope||this)},_getLookupColumnsDefaultDisplayValues:function(e,t,r){if(Terrasoft.useStaticFileContent){var n=this._getLookupDisplayValueByPrimaryColumnBatchQuery(e);Ext.isEmpty(n.queries)?t.call(r,e):n.execute((function(i){i&&i.success&&Terrasoft.each(n.queriesMap,(function(e,t){var r=this.findEntityColumn(t),n=i.queryResults[e]&&i.queryResults[e].rows[0]&&i.queryResults[e].rows[0].displayValue;r.defaultValue.value.displayValue=n||Terrasoft.emptyString}),this),t.call(r,e)}),this)}else Ext.callback(t,r||this,[e])},_getColumnsDefaultValues:function(e,t,r,n){var i="".concat(e,"_").concat(n);if(n){var a=window.defaultValueStorage&&window.defaultValueStorage[i]||null;if(a)return void(t&&t.call(r,a))}var s=Terrasoft.utils.uri.getConfigurationWebServiceBaseUrl()+"/rest/EntitySchemaService/GetEntityDefaultValues?entityName="+e;Terrasoft.AjaxProvider.request({url:s,headers:{Accept:"application/json","Content-Type":"application/json"},method:"GET",jsonData:{},scope:this,callback:function(e,a,s){if(t){var o=(a?Terrasoft.decode(s.responseText):{GetEntityDefaultValuesResult:[]}).GetEntityDefaultValuesResult;if(n){var l=window.defaultValueStorage||{};l[i]=o,window.defaultValueStorage=l}t.call(r,o)}}})},_getEntityColumnsWithDefaultValues:function(e){var t={};return Terrasoft.each(this.columns,(function(r,n){if(r.type===Terrasoft.ViewModelColumnType.ENTITY_COLUMN&&!(Terrasoft.contains(this.ignoredSystemColumns,r.columnPath)||e&&r.modelName!==e)){var i=this.findEntityColumn(n);i&&i.defaultValue&&(t[n]=i)}}),this),t},_getLookupDisplayValueByPrimaryColumnBatchQuery:function(e){var t=Ext.create("Terrasoft.BatchQuery");return Terrasoft.each(e,(function(e,r){var n=Terrasoft.isLookupDataValueType(e.dataValueType)||e.isLookup,i=e.defaultValue;if(i&&i.value&&i.value.value&&n&&i.source===Terrasoft.EntitySchemaColumnDefSource.CONST&&!i.value.displayValue){var a=this._getLookupDisplayValueByPrimaryColumnQuery(i.value.value,e.referenceSchemaName);t.addNamedQuery(a,r,Terrasoft.emptyFn,this)}}),this),t},_getLookupDisplayValueByPrimaryColumnQuery:function(e,t){var r=Ext.create("Terrasoft.EntitySchemaQuery",{rootSchemaName:t});return r.addMacrosColumn(Terrasoft.QueryMacrosType.PRIMARY_DISPLAY_COLUMN,"displayValue"),r.enablePrimaryColumnFilter(e),r},_setColumnsDataModelName:function(){var e=this._findPrimaryDataModel();e&&Terrasoft.each(this.columns,(function(t){t.type===Terrasoft.ViewModelColumnType.ENTITY_COLUMN&&Ext.isEmpty(t.modelName)&&!Ext.isEmpty(t.columnPath)&&(t.modelName=e.name)}),this)},_getSaveEntitiesBatchQuery:function(){for(var e=Ext.create("Terrasoft.BatchQuery"),t=this.dataModelCollection.getCount()-1;t>-1;t--){var r=this.dataModelCollection.getByIndex(t),n=this._getSaveEntityQuery(r);e.addNamedQuery(n,r.name,Terrasoft.EmptyFn,this)}return e},_getSaveEntityQuery:function(e){var t=e.getPrimaryColumnName();return e.getSaveQuery({primaryColumnValue:this.get(t),changedValues:this.changedValues,columns:this.columns,isForceUpdate:this.get("IsProcessMode")})},_loadDataModelEntity:function(e,t,r){var n=this._getDataModelPrimaryColumnValue(e);if(Terrasoft.isGUID(n)){var i={primaryColumnValue:n,columns:this.columns};e.load(i,(function(n){n&&(this.setColumnValues(n,{preventValidation:!0}),this._clearChangedValues(e.name)),Ext.callback(t,r,[n])}),this)}else{var a=e.name;e.isNew||(e.isNew=!0,this._clearAttribute(a)),this._setDefaultValuesForDataModel(a,t,r)}},_getDataModelPrimaryColumnValue:function(e){var t=null,r=e.primaryColumnValueConfig;if(!r)return null;if(Terrasoft.isGUID(r))t=r;else{var n=r.bindTo;if(Terrasoft.isEmpty(n))throw new Terrasoft.NotImplementedException({message:'Property "bindTo" is not defined'});if(this.columns[n]){var i=this.get(n);t=Ext.isObject(i)?i&&i.value:i}else{if(!Ext.isFunction(this[n]))throw new Terrasoft.ItemNotFoundException({message:Ext.String.format(Terrasoft.Resources.EntityBaseViewModelMixin.AttributeOrFunctionNotFound,n)});t=this[n]()}}return t},_setLookupValueForParentEntity:function(e){var t=this._getDataModelPrimaryColumn(e);if(t){var r=e.getPrimaryColumnName(),n=e.findPrimaryDisplayColumnName(),i={value:this.get(r),displayValue:this.get(n)};this.set(t.name,i)}},_setLookupValueForParentEntities:function(){for(var e=this.dataModelCollection.getCount()-1;e>-1;e--){var t=this.dataModelCollection.getByIndex(e);t.isNew&&this._setLookupValueForParentEntity(t)}},_findDependentDataModels:function(e){var t=new Terrasoft.Collection;return this.dataModelCollection.each((function(r){var n=this._getDataModelPrimaryColumn(r);if(n&&n.modelName===e){t.add(r.name,r);var i=this._findDependentDataModels(r.name);t.loadAll(i)}}),this),t},_getDataModelPrimaryColumn:function(e){var t=e.primaryColumnValueConfig,r=t&&t.bindTo,n=this.columns[r];return n&&n.dataValueType===Terrasoft.DataValueType.LOOKUP?n:null},_clearAttribute:function(e){var t=this._getEntityColumnsWithDefaultValues(e);Terrasoft.each(this.columns,(function(r,n){r.modelName!==e||t[n]||this.set(n,null)}),this)},_saveDataModelEntities:function(e,t){this._setLookupValueForParentEntities();var r=this._getSaveEntitiesBatchQuery();r.execute((function(n){n&&n.success&&(Terrasoft.each(r.queriesMap,(function(e,t){this.dataModelCollection.get(t).isNew=!1}),this),this.changedValues={}),Ext.callback(e,t||this,[n])}),this)},_loadDataModelEntities:function(e,t,r){var n=[];this._isLoading=!0,(e.dataModelCollection||this.dataModelCollection).eachAsync((function(e,t){this._loadDataModelEntity(e,(function(e){e&&n.push(e),t.call(this)}),this)}),(function(){this._isLoading=!1,Ext.callback(t,r,[this])}),this)},_clearChangedValues:function(e){Terrasoft.each(this.changedValues,(function(t,r){var n=this.columns[r];n&&n.modelName===e&&delete this.changedValues[r]}),this)},_getSysSettingDefaultValue:function(e,t){var r=t.defaultValue.value,n=t.defaultValue.displayValue;switch(e.dataValueType){case Terrasoft.DataValueType.LOOKUP:return{value:r,displayValue:n};case Terrasoft.DataValueType.DATE:return Terrasoft.clearTime(new Date(r));case Terrasoft.DataValueType.TIME:var i=new Date(r),a=new Date(null);return a.setHours(i.getHours()),a.setMinutes(i.getMinutes()),a.setSeconds(i.getSeconds()),a.setMilliseconds(i.getMilliseconds()),a;case Terrasoft.DataValueType.DATE_TIME:return new Date(r);default:return r}},_setDefaultValuesForDataModel:function(e,t,r,n){var i=this._getEntityColumnsWithDefaultValues(e);i=this._addLookupListConfig(i),this._getLookupColumnsDefaultDisplayValues(i,(function(i){this.getDefaultColumnValues(i,(function(e){Terrasoft.each(e,(function(e,t){this.setColumnValue(t,e.value)}),this),Ext.callback(t,r,[this])}),this,e,n)}),this)},_addLookupListConfig:function(e){return Terrasoft.each(e,(function(e){var t=this.columns[e.name];t&&t.lookupListConfig&&(e.lookupListConfig=t.lookupListConfig)}),this),e},_getDefaultValuesFromSysSettings:function(e,t,r,n,i){0!==t.length?Terrasoft.SysSettings.querySysSettings(t,(function(t){Terrasoft.each(r,(function(r,n){e[n]&&(e[n].value=t[r])}),this),Ext.callback(n,i,[e])}),this):Ext.callback(n,i,[e])},_onChangedAttributes:function(e){if(!this._isLoading){var t=new Terrasoft.Collection;t.add(e.name,e);var r=this._findDependentDataModels(e.name);t.loadAll(r),Terrasoft.delay(this._loadDataModelEntities.bind(this,{dataModelCollection:t}),this,0)}},_findEntitySchemaByModelName:function(e){var t=this.dataModelCollection&&this.dataModelCollection.find(e);return t&&t.schema},_getDataModelPrimaryColumnsConfig:function(){var e=[];return this.dataModelCollection&&this.dataModelCollection.each((function(t){var r=this._getDataModelPrimaryColumn(t);r&&e.push({name:r.name,dataModel:t})}),this),e},_getEntityNameByModelName:function(e){if(!e)return null;if(!e&&!this.dataModelCollection)return null;var t=this.dataModelCollection.findByPath(e);return t?t.schemaName:null},_getDefaultColumnValuesByEntityName:function(e,t,r,n,i){var a=Terrasoft.deepClone(e);this._getColumnsDefaultValues(n,(function(n){Terrasoft.each(e,(function(e,t){var r,i,s=e.defaultValue;switch(s.source){case Terrasoft.EntitySchemaColumnDefSource.CONST:a[t].value=s.value;break;case Terrasoft.EntitySchemaColumnDefSource.SYSTEM_VALUE:a[t].value=this.getSysDefaultValue(s.value);break;case Terrasoft.EntitySchemaColumnDefSource.SETTINGS:var o=n.find((function(e){return e.name===t}));(null==o||null===(r=o.defaultValue)||void 0===r?void 0:r.value)&&(a[t].value=this._getSysSettingDefaultValue(e,o));break;case Terrasoft.EntitySchemaColumnDefSource.SEQUENCE:var l=n.find((function(e){return e.name===t}));(null==l||null===(i=l.defaultValue)||void 0===i?void 0:i.value)&&(a[t].value=l.defaultValue.value)}}),this),Ext.callback(t,r,[a])}),this,i)},_getDefaultColumnValuesByColumns:function(e,t,r){var n=[],i=Terrasoft.deepClone(e),a={},s="";Terrasoft.each(e,(function(e,t){var r=e.defaultValue;switch(r.source){case Terrasoft.EntitySchemaColumnDefSource.CONST:i[t].value=r.value;break;case Terrasoft.EntitySchemaColumnDefSource.SYSTEM_VALUE:i[t].value=this.getSysDefaultValue(r.value);break;case Terrasoft.EntitySchemaColumnDefSource.SETTINGS:s=r.value,Ext.Array.contains(n,s)||n.push(s),a[t]=s}}),this),this._getDefaultValuesFromSysSettings(i,n,a,(function(e){Ext.callback(t,r,[e])}),this)},initEntitySchemaProperties:function(){this.entitySchema&&(this.primaryColumnName=this.entitySchema.primaryColumnName,this.primaryDisplayColumnName=this.entitySchema.primaryDisplayColumnName,this.primaryImageColumnName=this.entitySchema.primaryImageColumnName)},findEntityColumn:function(e){var t=null,r=this.getColumnByName(e),n=r?r.columnPath:e,i=r&&this._findEntitySchemaByModelName(r.modelName)||this.entitySchema;return i&&i.isColumnExist(n)&&(t=i.getColumnByName(n)),t},setDefaultValues:function(e,t,r){t=t||this,Ext.isEmpty(this.dataModelCollection)||this.dataModelCollection.isEmpty()?Ext.callback(e,t,[this]):this.dataModelCollection.eachAsync((function(e,t){this._setDefaultValuesForDataModel(e.name,t,this,r)}),(function(){Ext.callback(e,t)}),this)},addPrimaryValueColumn:function(e){e.addMacrosColumn(Terrasoft.QueryMacrosType.PRIMARY_COLUMN,"value")},addPrimaryDisplayColumn:function(e){var t=e.addMacrosColumn(Terrasoft.QueryMacrosType.PRIMARY_DISPLAY_COLUMN,"displayValue");t.orderPosition=1,t.orderDirection=Terrasoft.OrderDirection.ASC},addListConfigColumns:function(e,t){var r=this.getColumnByName(t),n=r&&r.lookupListConfig||{};Terrasoft.each(n.columns,(function(t){e.columns.contains(t)||e.addColumn(t)}))},addLookupQueryFilter:function(e,t){var r=this.getLookupComparisonType(),n=e.createPrimaryDisplayColumnFilterWithParameter(r,t,Terrasoft.DataValueType.TEXT);e.filters.add("LookupFilter",n),n.isEnabled=Boolean(t)},addLookupQueryColumns:function(e,t){this.addPrimaryValueColumn(e),this.addPrimaryDisplayColumn(e),this.addListConfigColumns(e,t)},checkColumnLookupType:function(e){if(!(Terrasoft.isLookupDataValueType(e.dataValueType)||e.isLookup))throw new Terrasoft.UnsupportedTypeException({message:Terrasoft.Resources.BaseViewModel.columnUnsupportedTypeException})},getLookupQueryConfig:function(e){if(!e)throw new Terrasoft.ItemNotFoundException;return this.checkColumnLookupType(e),{rootSchemaName:e.referenceSchemaName,rowCount:Terrasoft.SysSettings.lookupRowCount,isPageable:!0,useRecordDeactivation:!0}},getLookupQuery:function(e,t){this.abortLoadLookupDataRequest(t);var r=this.getColumnByName(t),n=this.getLookupQueryConfig(r),i=Ext.create("Terrasoft.EntitySchemaQuery",n);this.addLookupQueryColumns(i,t),this.addLookupQueryFilter(i,e);var a=this.pagingParams;return a?(this.addPagingParameters(i,a),a=null):Terrasoft.useOffsetFetchPaging&&(i.rowsOffset=0),this.saveLookupDataRequestInstanceId(t,i.instanceId),i},addPagingParameters:function(e,t){var r=t&&t.list&&t.list.getCount();if(Terrasoft.useOffsetFetchPaging&&r)e.rowsOffset=this._getListLength(t.list);else{var n=e.conditionalValues=Ext.create("Terrasoft.ColumnValues");if(r){var i=this.getLastRecord(t.list),a=i.displayValue,s=i.value;n.setParameterValue("displayValue",a,Terrasoft.DataValueType.TEXT),n.setParameterValue("value",s,Terrasoft.DataValueType.GUID)}}},loadLookupData:function(e,t,r,n,i,a){t&&t.clear(),this.pagingParams=null;var s={callback:i,columnName:r,filterValue:e,isLookupEdit:n,list:t,scope:a};this.getLookupQuery(e,r).getEntityCollection(this.getLookupDataCallback.bind(this,s))},getPredictableLookupQuery:function(e,t){var r=this.getLookupQuery(e,t);return this.appendPredictableQueryColumns(r),this.appendPredictableQueryConditions(r,t),r},loadPredictableData:function(e,t,r,n,i,a){t&&t.clear(),this.getPredictableLookupQuery(e,r).getEntityCollection(this.getLookupDataCallback.bind(this,{callback:i,columnName:r,filterValue:e,isLookupEdit:n,list:t,scope:a}))},loadLookupDataWithParams:function(e,t,r,n,i){if(!this.isListFullyLoaded&&e){var a=e.filterValue||"",s={callback:n,columnName:t,filterValue:a,isLookupEdit:r,list:e.list||{},scope:i,listView:e.listView||{}};this.pagingParams=e,this.getLookupQuery(a,t).getEntityCollection(this.getLookupDataCallback.bind(this,s))}},getSchemaImageUrl:function(){var e,t,r,n=this._findPrimaryDataModel();return e=this.primaryImageColumnName||n.getEntityPrimaryImageColumnName(),(t=this.get(e))?(r={source:Terrasoft.ImageSources.SYS_IMAGE,params:{primaryColumnValue:t.value}},Terrasoft.ImageUrlBuilder.getUrl(r)):null},getSaveQuery:function(){var e=null;if(!this.validate())return null;if(this.isDeleted)throw new Terrasoft.InvalidObjectState;var t=this._findPrimaryDataModel();if(this.isNew)e=this.getInsertQuery();else{e=this.getUpdateQuery();var r=this.get(this.primaryColumnName);e.enablePrimaryColumnFilter(r)}return t.getSaveQuery({primaryColumnValue:this.get(this.primaryColumnName),changedValues:this.changedValues,columns:this.columns,saveQuery:e,isForceUpdate:this.get("IsProcessMode"),isNew:this.isNew})},saveEntity:function(e,t){var r={saveQuery:this.getSaveQuery()};this._findPrimaryDataModel().save(r,(function(r){r.success&&(this.isNew=!1,this.changedValues=null),Ext.callback(e,t||this,[r])}),this)},deleteEntity:function(e,t){if(this.isNew||this.isDeleted)throw new Terrasoft.InvalidObjectState;var r=this._findPrimaryDataModel(),n={deleteQuery:this.getDeleteQuery(),primaryColumnValue:this.get(this.primaryColumnName)};r.deleteEntity(n,(function(r){r.success&&(this.isDeleted=!0),e.call(t||this,r)}),this)},getEntitySchemaQuery:function(){return this._findPrimaryDataModel().getEntitySchemaQuery(this.columns)},loadEntity:function(e,t,r){var n={primaryColumnValue:e,entitySchemaQuery:this.getEntitySchemaQuery(),columns:this.columns};this._findPrimaryDataModel().load(n,(function(e){e&&(this.isNew=!1,this.setColumnValues(e,{preventValidation:!0}),this.changedValues={}),Ext.callback(t,r||this,[this])}),this)},addRelatedEntityColumns:function(e){var t=this._findPrimaryDataModel();t&&t.addRelatedEntityColumns(e,this.columns)},copyEntity:function(e,t,r){var n={primaryColumnValue:e,entitySchemaQuery:this.getEntitySchemaQuery()};this._findPrimaryDataModel().copy(n,(function(n){this.setDefaultValues((function(){this.setCopyColumnValues(n),Ext.callback(t,r||this,[this])}),this,e)}),this)},getEntityViewModelEntitySchema:function(){var e=this._findPrimaryDataModel();return e&&e.schema||null},setEntityViewModelEntitySchema:function(e){if(e){var t=this._findPrimaryDataModel();if(t&&t.schema.instanceId===e.instanceId)return;var r=e.name||"dataEntityModelKey",n=this.dataModelCollection=Ext.create("Terrasoft.DataModelCollection"),i={};i[r]={entitySchema:e,isPrimary:!0},n.init(i),this.initEntitySchemaProperties()}else this.dataModelCollection&&this.dataModelCollection.getCount()>0&&this.dataModelCollection.removeByIndex(0)},saveLookupDataRequestInstanceId:function(e,t){this.lookupDataRequestInstanceId[e]=t},removeLookupDataRequestInstanceId:function(e){delete this.lookupDataRequestInstanceId[e]},abortLoadLookupDataRequest:function(e){var t=this.lookupDataRequestInstanceId[e];t&&(Terrasoft.AjaxProvider.abortRequestByInstanceId(t),this.removeLookupDataRequestInstanceId(e))},appendPredictableQueryColumns:Terrasoft.emptyFn,appendPredictableQueryConditions:Terrasoft.emptyFn,initDataModelsStatus:function(){this.dataModelCollection&&this.dataModelCollection.each((function(e){e.isNew=!0}),this)},subscribeOnChangePrimaryColumn:function(){this._getDataModelPrimaryColumnsConfig().forEach((function(e){this.on("change:"+e.name,this._onChangedAttributes.bind(this,e.dataModel),this)}),this)},unsubscribeOnChangePrimaryColumn:function(){this._getDataModelPrimaryColumnsConfig().forEach((function(e){this.un("change:"+e.name,this._onChangedAttributes.bind(this,e.dataModel),this)}),this)},loadLookupColumnValues:function(e,t,r){var n=Ext.create("Terrasoft.BatchQuery");Terrasoft.each(e,(function(e,t){var r=this.getLookupQuery(null,t);r.enablePrimaryColumnFilter(e),n.addNamedQuery(r,t,Terrasoft.emptyFn,this)}),this),n.execute((function(e){var i={};e&&e.success&&Terrasoft.each(n.queriesMap,(function(t,r){var n=e.queryResults[t];i[r]=n?n.rows[0]:null}),this),Ext.callback(t,r||this,[i])}),this)},getDefaultColumnValues:function(e,t,r,n,i){var a=this._getEntityNameByModelName(n);a?this._getDefaultColumnValuesByEntityName(e,(function(e){Ext.callback(t,r,[e])}),r,a,i):this._getDefaultColumnValuesByColumns(e,(function(e){Ext.callback(t,r,[e])}),r)}}),Ext.ns("Terrasoft.model"),Ext.define("Terrasoft.model.BaseViewModel",{extend:"Terrasoft.model.BaseModel",alternateClassName:"Terrasoft.BaseViewModel",mixins:{entityBaseViewModelMixin:"Terrasoft.EntityBaseViewModelMixin",viewModelResourcesMixin:"Terrasoft.ViewModelResourcesMixin"},dataModelCollection:null,rowConfig:null,name:"",defLoadLookupDataMethod:"loadLookupData",loadLookupDataMethod:"loadLookupDataWithParams",lookupDataRequestInstanceId:null,defGetLookupImageUrlMethod:"getLookupImageUrl",defHasNestingColumnName:"HasNesting",isNew:!0,isDeleted:!1,canValidate:!0,validationConfig:null,isListFullyLoaded:!1,validationInfo:null,pagingParams:null,ignoredSystemColumns:["CreatedOn","ModifiedOn"],_isAllowZeroValueSatisfied:function(e,t){return t&&t.allowZeroValue&&0===e},_isDefaultConditionSatisfied:function(e,t){return e||Terrasoft.isEmptyObject(t)||Ext.isBoolean(e)||!1===(t.isRequired||t.isRequiredOnPage)},constructor:function(e){this.callParent(arguments),this.validationInfo=new Backbone.Model,e&&(this.validationConfig=e.validationConfig),this.validationConfig=this.validationConfig||{},this.lookupDataRequestInstanceId={},this.initEntitySchemaProperties(),this.initDataModelsStatus(),this.subscribeOnChangePrimaryColumn()},addColumnValidator:function(e,t){(this.validationConfig[e]=this.validationConfig[e]||[]).push(t)},setColumnValue:function(e,t,r){this.set(e,t,r)},setCopyColumnValues:function(e){var t=e.entitySchema;Terrasoft.each(this.columns,(function(r,n){var i=t.columns[n],a=e.get(n);i&&i.isValueCloneable&&""!==a&&this.set(n,a)}),this)},getSysDefaultValue:function(e){var t;switch(e){case Terrasoft.SystemValueType.CURRENT_TIME:var r=new Date;(t=new Date(null)).setHours(r.getHours()),t.setMinutes(r.getMinutes()),t.setSeconds(r.getSeconds()),t.setMilliseconds(r.getMilliseconds());break;case Terrasoft.SystemValueType.CURRENT_DATE:t=Terrasoft.clearTime(new Date);break;case Terrasoft.SystemValueType.CURRENT_DATE_TIME:t=new Date;break;case Terrasoft.SystemValueType.CURRENT_USER:t=Terrasoft.SysValue.CURRENT_USER;break;case Terrasoft.SystemValueType.CURRENT_USER_CONTACT:t=Terrasoft.SysValue.CURRENT_USER_CONTACT;break;case Terrasoft.SystemValueType.CURRENT_USER_ACCOUNT:t=Terrasoft.SysValue.CURRENT_USER_ACCOUNT;break;case Terrasoft.SystemValueType.CURRENT_WORKSPACE:t=Terrasoft.SysValue.CURRENT_WORKSPACE;break;case Terrasoft.SystemValueType.GENERATE_UID:case Terrasoft.SystemValueType.GENERATE_SEQUENTIAL_UID:t=Terrasoft.generateGUID();break;case Terrasoft.SystemValueType.CURRENT_MAINTAINER:t=Terrasoft.SysValue.CURRENT_MAINTAINER;break;default:throw new Terrasoft.ItemNotFoundException}return t},typeValidator:function(e,t){var r={invalidMessage:""},n=this.getColumnDataValueType(t),i=!0,a=n===Terrasoft.DataValueType.DATE_TIME||n===Terrasoft.DataValueType.DATE||n===Terrasoft.DataValueType.TIME,s=Ext.isEmpty(e);if(a){if(s&&!(""===e))return r}else if(s)return r;switch(n){case Terrasoft.DataValueType.INTEGER:case Terrasoft.DataValueType.FLOAT:case Terrasoft.DataValueType.MONEY:i=Ext.isNumeric(e);break;case Terrasoft.DataValueType.DATE_TIME:case Terrasoft.DataValueType.DATE:case Terrasoft.DataValueType.TIME:i=Ext.isDate(e);break;case Terrasoft.DataValueType.BOOLEAN:i=Ext.isBoolean(e);break;case Terrasoft.DataValueType.TEXT:i=Ext.isString(e);break;case Terrasoft.DataValueType.GUID:i=Ext.isObject(e)?Terrasoft.isGUID(e.value):Terrasoft.isGUID(e)}return i||(r.invalidMessage=Terrasoft.Resources.BaseViewModel.columnIncorrectTypeValidationMessage),r},rangeValidator:function(e,t){var r={invalidMessage:""};if(Ext.isEmpty(e))return r;switch(this.getColumnDataValueType(t)){case Terrasoft.DataValueType.INTEGER:r=Terrasoft.validateNumberRange(Terrasoft.DataValueTypeRange.INTEGER.minValue,Terrasoft.DataValueTypeRange.INTEGER.maxValue,e);break;case Terrasoft.DataValueType.FLOAT:case Terrasoft.DataValueType.MONEY:r=Terrasoft.validateNumberRange(Terrasoft.data.constants.FloatRange.MIN_VALUE,Terrasoft.data.constants.FloatRange.MAX_VALUE,e);break;case Terrasoft.DataValueType.TEXT:var n=this.findEntityColumn(t.name);if(n){var i=n.size,a=e.length;if(a>i){var s=Terrasoft.Resources.BaseViewModel.columnIncorrectTextRangeValidationMessage;s+=" ("+a+"/"+i+")",r.invalidMessage=s}}}return r},requiredValidator:function(e,t){Ext.isString(e)&&(e=Ext.String.trim(e));var r="",n={invalidMessage:r};if(this._isAllowZeroValueSatisfied(e,t))return n;if(this._isDefaultConditionSatisfied(e,t))return n;if(t.isRequired||t.isRequiredOnPage)r=Terrasoft.Resources.BaseViewModel.columnRequiredValidationMessage;else{var i=t.columnPath,a=this.entitySchema;if(a&&a.isColumnExist(i))a.getColumnByName(i).isRequired&&(r=Terrasoft.Resources.BaseViewModel.columnRequiredValidationMessage)}return n.invalidMessage=r,n},positiveNumberValidator:function(e){return Terrasoft.validateNumberRange(0,Terrasoft.DataValueTypeRange.INTEGER.maxValue,e)},getDefaultValidators:function(){return[this.typeValidator,this.rangeValidator,this.requiredValidator]},validateColumn:function(e,t){if(t=t||{},!this.validationConfig)return!0;var r={invalidMessage:"",isValid:!0};if(!t.skipValidation){Terrasoft.Features.getIsEnabled("ValidateRequiredFields")&&this.fireEvent("validate:"+e,this);var n=this.getDefaultValidators(),i=Terrasoft.deepClone(this.validationConfig[e])||[];i=n.concat(i);var a=this.get(e),s=this.columns[e];Terrasoft.each(i,(function(e){return(r=e.call(this,a,s)).isValid=Ext.isEmpty(r.invalidMessage),r.isValid}),this),s&&Ext.isDefined(s.validateOrder)&&(r.validateOrder=s.validateOrder)}return"*"!==e&&this.validationInfo.set(e,r),r.isValid},getColumnDataValueType:function(e){if(!e)return null;if(e.type!==Terrasoft.ViewModelColumnType.ENTITY_COLUMN)return e.dataValueType;var t=this.findEntityColumn(e.name);return t?t.dataValueType:null},getEntityColumns:function(){return Terrasoft.pick(this.columns,(function(e,t){var r=this.getColumnByName(t);return(r&&r.type)===Terrasoft.ViewModelColumnType.ENTITY_COLUMN}),this)},isChanged:function(){return this.isEntityChanged()},isEntityChanged:function(){return this.getChangedEntityColumns().length>0},getChangedEntityColumns:function(){var e=this.getEntityColumns(),t=Terrasoft.keys(e),r=Terrasoft.keys(this.changedValues);return _.intersection(t,r)},set:function(e,t,r){this.callParent(arguments),r&&(r.silent||r.preventValidation)||this.validateColumn(e,r)},validate:function(){var e=!0;if(this.validationConfig){var t=Terrasoft.sortObj(this.columns,"validateOrder");Terrasoft.each(t,(function(t,r){e=e&&this.validateColumn(r)}),this),e=e&&this.validateColumn("*")}return e},setValidationInfo:function(e,t,r){var n={isValid:t,invalidMessage:r};this.validationInfo.set(e,n)},loadFromColumnValues:function(e,t){t&&Terrasoft.each(t,(function(e,t){this.columns[t]?Ext.apply(this.columns[t],e):this.columns[t]=e}),this),e&&Terrasoft.each(e,(function(e,t){this.setColumnValue(t,e,{silent:!0})}),this)},initModelColumns:function(){this.callParent(arguments),this._setColumnsDataModelName(),this._setResourceColumns()},getColumnDataType:function(e){var t=this.getColumnByName(e);if(t&&!Ext.isEmpty(t.dataValueType))return t.dataValueType;var r=t?t.columnPath:e,n=this.entitySchema;if(n&&n.isColumnExist(r))return n.getColumnByName(r).dataValueType;var i=this.getColumnByName(r);return i&&!Ext.isEmpty(i.dataValueType)?i.dataValueType:null},getLookupComparisonType:function(){return this.getStringColumnComparisonType()},getStringColumnComparisonType:function(){return 1===Terrasoft.SysSettings.getCachedSysSetting("StringColumnSearchComparisonType")?Terrasoft.ComparisonType.CONTAIN:Terrasoft.ComparisonType.START_WITH},getLastRecord:function(e){var t=this._getListLength(e);return e.getByIndex(t-1)},_getListLength:function(e){var t=e.getCount(),r=e.last();return t-(Terrasoft.isEmptyGUID(r.value)?1:0)},onLookupDataLoaded:function(e){e.collection.each((function(t){var r=t.get("value");e.objects[r]=t.model.attributes}),this)},getLookupImageUrl:function(e){var t=this.findEntityColumn(e)||this.getColumnByName(e);if(!t||!t.isLookup)throw new Terrasoft.UnsupportedTypeException;var r=this.get(e).primaryImageValue;if(!r)return null;var n={source:Terrasoft.ImageSources.SYS_IMAGE,params:{primaryColumnValue:r}};return Terrasoft.ImageUrlBuilder.getUrl(n)},showConfirmationDialog:function(e,t,r,n){Terrasoft.utils.showConfirmation(e,t,r,this,n)},showInformationDialog:function(e,t,r){Terrasoft.utils.showInformation(e,t,this,r)},getAttributePropertyValue:function(e,t){if(!e)return null;var r=e[t];if(Ext.isObject(r)&&r.bindTo){var n=r.bindTo,i=r.bindConfig&&r.bindConfig.converter,a=this.get(n)||this[n];if(!Ext.isFunction(a)&&!i)return a;var s=i?this[i]:a,o=i?a:void 0;return Ext.isFunction(s)?s.call(this,o):null}return r},getColumnCaptionByName:function(e){var t=this.getColumnByName(e);return this.getAttributePropertyValue(t,"caption")||t.name||e},getValidationMessage:function(){var e=null,t=Terrasoft.Resources.BaseViewModel.fieldValidationError,r="",n=Terrasoft.sortObj(this.validationInfo.attributes,"validateOrder");Terrasoft.each(n,(function(t,n){if(t&&!t.isValid&&!t.isCustomMessage)return e=n,r=t.invalidMessage,!1}),this);var i=null;if(e){var a=this.getColumnCaptionByName(e);i=Ext.String.format(t,a,r)}return i},loadDataModels:function(e,t,r){this._loadDataModelEntities(e,t,r)},saveDataModels:function(e,t){this._saveDataModelEntities(e,t)},onDestroy:function(){this.unsubscribeOnChangePrimaryColumn(),this.callParent(arguments)}}),Object.defineProperty(Terrasoft.BaseViewModel.prototype,"entitySchema",{get:function(){return this.getEntityViewModelEntitySchema()},set:function(e){this.setEntityViewModelEntitySchema(e)},enumerable:!0}),Object.defineProperty(Terrasoft.BaseViewModel.prototype,"deleteQuery",{get:function(){var e=this._findPrimaryDataModel();return e&&e._deleteQuery||null},set:function(e){var t=this._findPrimaryDataModel();t&&(t._deleteQuery=e)},enumerable:!0}),Object.defineProperty(Terrasoft.BaseViewModel.prototype,"insertQuery",{get:function(){var e=this._findPrimaryDataModel();return e&&e._insertQuery||null},set:function(e){var t=this._findPrimaryDataModel();t&&(t._insertQuery=e)},enumerable:!0}),Object.defineProperty(Terrasoft.BaseViewModel.prototype,"updateQuery",{get:function(){var e=this._findPrimaryDataModel();return e&&e._updateQuery||null},set:function(e){var t=this._findPrimaryDataModel();t&&(t._updateQuery=e)},enumerable:!0}),Ext.ns("Terrasoft.diagram.enums"),Ext.ns("Terrasoft.process.enums"),Terrasoft.diagram.enums.PortPosition={Auto:{name:"{X=0,Y=0}",offset:{x:0,y:0}},Top:{name:"{X=0,Y=1}",offset:{x:.5,y:0}},Bottom:{name:"{X=0,Y=-1}",offset:{x:.5,y:1}},Left:{name:"{X=-1,Y=0}",offset:{x:0,y:.5}},Right:{name:"{X=1,Y=0}",offset:{x:1,y:.5}},TopLeft:{name:"{X=-1,Y=1}",offset:{x:0,y:0}},TopRight:{name:"{X=1,Y=1}",offset:{x:1,y:0}},BottomLeft:{name:"{X=-1,Y=-1}",offset:{x:0,y:1}},BottomRight:{name:"{X=1,Y=-1}",offset:{x:1,y:1}}},Terrasoft.diagram.PortPosition=Terrasoft.diagram.enums.PortPosition,Terrasoft.diagram.enums.PortsSet={All:[Terrasoft.diagram.PortPosition.Top,Terrasoft.diagram.PortPosition.Bottom,Terrasoft.diagram.PortPosition.Left,Terrasoft.diagram.PortPosition.Right,Terrasoft.diagram.PortPosition.TopLeft,Terrasoft.diagram.PortPosition.TopRight,Terrasoft.diagram.PortPosition.BottomLeft,Terrasoft.diagram.PortPosition.BottomRight],Basic:[Terrasoft.diagram.PortPosition.Top,Terrasoft.diagram.PortPosition.Bottom,Terrasoft.diagram.PortPosition.Left,Terrasoft.diagram.PortPosition.Right],Additional:[Terrasoft.diagram.PortPosition.TopLeft,Terrasoft.diagram.PortPosition.TopRight,Terrasoft.diagram.PortPosition.BottomLeft,Terrasoft.diagram.PortPosition.BottomRight],None:[]},Terrasoft.diagram.PortsSet=Terrasoft.diagram.enums.PortsSet,Terrasoft.diagram.enums.UserHandlesConstraint={Node:1,Connector:2,Event:3,Gateway:4,Lane:5,LaneSet:6,Subprocess:7,All:8,Label:9},Terrasoft.diagram.UserHandlesConstraint=Terrasoft.diagram.enums.UserHandlesConstraint,Terrasoft.diagram.enums.ToolsConstraint={NodeAddTool:1,NodeSelectionTool:2,NodeRemoveTool:4,ConnectionEditTool:8,ConnectorRemoveTool:16},Terrasoft.diagram.ToolsConstraint=Terrasoft.diagram.enums.ToolsConstraint,Terrasoft.diagram.enums.labelBackgroundTag={CIRCLE:"circle",ELLIPSE:"ellipse",RECTANGLE:"rectangle"},Terrasoft.diagram.labelBackgroundTag=Terrasoft.diagram.enums.labelBackgroundTag,Terrasoft.process.enums.ProcessSchemaPoolDirection={VERTICAL:0,HORIZONTAL:1},Terrasoft.ProcessSchemaPoolDirection=Terrasoft.process.enums.ProcessSchemaPoolDirection,Terrasoft.process.enums.ProcessSchemaParameterDirection={IN:0,OUT:1,VARIABLE:2},Terrasoft.ProcessSchemaParameterDirection=Terrasoft.process.enums.ProcessSchemaParameterDirection,Terrasoft.process.enums.ProcessSchemaParameterDirectionOrder=(_Terrasoft$process$en={},_defineProperty(_Terrasoft$process$en,Terrasoft.ProcessSchemaParameterDirection.IN,0),_defineProperty(_Terrasoft$process$en,Terrasoft.ProcessSchemaParameterDirection.VARIABLE,1),_defineProperty(_Terrasoft$process$en,Terrasoft.ProcessSchemaParameterDirection.OUT,2),_Terrasoft$process$en),Terrasoft.ProcessSchemaParameterDirectionOrder=Terrasoft.process.enums.ProcessSchemaParameterDirectionOrder,Terrasoft.ProcessSchemaUsageType={NONE:0,GENERAL:1,ADVANCED:2},Terrasoft.process.enums.ProcessSchemaUsageType=Terrasoft.ProcessSchemaUsageType,Terrasoft.ProcessSchemaParameterValueSource={None:0,ConstValue:1,Mapping:2,Script:3,SystemValue:4,SystemSetting:5,EntityMapping:6,SamplingEntityMapping:7},Terrasoft.process.enums.ProcessSchemaParameterValueSource=Terrasoft.ProcessSchemaParameterValueSource,Terrasoft.process.enums.LabelType={CAPTION:"caption",STATISTIC_INFO:"statisticInfo"},Terrasoft.LabelType=Terrasoft.process.enums.LabelType,Terrasoft.process.enums.ProcessSchemaEditSequenceFlowType={SEQUENCE:0,DEFAULT:1,CONDITIONAL:2,DATA:3,MESSAGE:4,ASSOCIATION:5},Terrasoft.ProcessSchemaEditSequenceFlowType=Terrasoft.process.enums.ProcessSchemaEditSequenceFlowType,Terrasoft.process.enums.ValidationType={ERROR:"error",WARNING:"warning",INFO:"information"},Terrasoft.ValidationType=Terrasoft.process.enums.ValidationType,Terrasoft.process.enums.MultiInstanceExecutionMode={SEQUENTIAL:0,PARALLEL:1},Terrasoft.process.MultiInstanceExecutionMode=Terrasoft.process.enums.MultiInstanceExecutionMode,Terrasoft.process.enums.AssignmentType={NONE:0,USER:1,MANAGER:2,ROLE:3},Terrasoft.process.AssignmentType=Terrasoft.process.enums.AssignmentType,Terrasoft.process.enums.UserTaskAssignmentGroupType={None:0,AdminUnitRole:1},Terrasoft.process.UserTaskAssignmentGroupType=Terrasoft.process.enums.UserTaskAssignmentGroupType,Terrasoft.process.enums.BackgroundModePriority={Inherited:0,Low:100,Medium:200,High:300},Terrasoft.process.BackgroundModePriority=Terrasoft.process.enums.BackgroundModePriority,Ext.ns("Terrasoft.process.constants");var consts=Terrasoft.process.constants;consts.MACROS_SEPARATOR=".",consts.LEFT_MACROS_BRACKET="[#",consts.RIGHT_MACROS_BRACKET="#]",consts.BOOLEAN_MACROS_PREFIX="BooleanValue",consts.BOOLEAN_MACROS_TRUE_VALUE="True",consts.BOOLEAN_MACROS_FALSE_VALUE="False",consts.PROPERTY_VALUE_MACROS_CAPTION="Caption",consts.PROPERTY_VALUE_TEMPLATE="[PropertyValue:{0}]",consts.CAPTION_PROPERTY_VALUE_MACROS=Ext.String.format(consts.PROPERTY_VALUE_TEMPLATE,consts.PROPERTY_VALUE_MACROS_CAPTION),consts.SYS_VARIABLE_PREFIX="SysVariable",consts.SYS_SETTINGS_PREFIX="SysSettings",consts.LOOKUP_VALUE_PREFIX="Lookup",consts.SAMPLING_COLUMN_VALUE_PREFIX="SamplingColumnValue.",consts.TIME_VALUE_PREFIX="TimeValue",consts.DATE_VALUE_PREFIX="DateValue",consts.DATE_TIME_VALUE_PREFIX="DateTimeValue",consts.COLUMN_VALUE_PREFIX="ColumnValue",consts.PARAMETER_PREFIX=consts.PARAMETER_IS_OWNER_SCHEMA+consts.MACROS_SEPARATOR+consts.PARAMETER_IS_SCHEMA,consts.PARAMETER_IS_OWNER_SCHEMA="[IsOwnerSchema:false]",consts.PARAMETER_IS_SCHEMA="[IsSchema:false]",consts.PARAMETER_ELEMENT_TEMPLATE="[Element:{{0}}]",consts.PARAMETER_PARAMETER_TEMPLATE="[Parameter:{{0}}]",consts.PARAMETER_ENTITY_COLUMN_TEMPLATE="[EntityColumn:{{0}}]",consts.SYS_SETTING_VALUE_TEMPLATE="{0}<{1}>",consts.PROCESS_PARAMETER_METAPATH_TEMPLATE="[IsOwnerSchema:false].[IsSchema:false].[Parameter:{{0}}]",consts.PARAMETER_METAPATH_TEMPLATE=consts.PARAMETER_ELEMENT_TEMPLATE+consts.MACROS_SEPARATOR+"[Parameter:{{1}}]",consts.ENTITY_COLUMN_METAPATH_TEMPLATE=".[EntityColumn:{{2}}]",consts.ELEMENT_PARAMETER_TEMPLATE=consts.PARAMETER_PREFIX+consts.MACROS_SEPARATOR+consts.PARAMETER_METAPATH_TEMPLATE,consts.ENTITY_COLUMN_ELEMENT_PARAMETER_TEMPLATE=consts.PARAMETER_PREFIX+consts.MACROS_SEPARATOR+consts.PARAMETER_METAPATH_TEMPLATE+consts.ENTITY_COLUMN_METAPATH_TEMPLATE,consts.PARAMETER_TEMPLATE=consts.PARAMETER_PREFIX+consts.MACROS_SEPARATOR+consts.PARAMETER_PARAMETER_TEMPLATE,consts.LOOKUP_PARAMETER_TEMPLATE=consts.LOOKUP_VALUE_PREFIX+consts.MACROS_SEPARATOR+"{0}.{1}",consts.SYS_SETTINGS_PARAMETER_TEMPLATE=consts.SYS_SETTINGS_PREFIX+consts.MACROS_SEPARATOR+consts.SYS_SETTING_VALUE_TEMPLATE,consts.SYS_VARIABLE_PARAMETER_TEMPLATE=consts.SYS_VARIABLE_PREFIX+consts.MACROS_SEPARATOR+"{0}",consts.PARAMETER_REGEX=/\[\#(.*?)\#\]/g,consts.HTML_PARAMETER_REGEX=/(<img.*?data-type="ProcessParameter".*?\/>)/g,consts.PARAMETER_ESCAPE_REGEX=/[-[\]{}()*+?.,\\^$|#\s]/g,consts.PARAMETER_MAPPING_REGEX=/\[([a-zA-Z]+):{?([-\w]+)}?\]/g,consts.PARAMETER_LOOKUP_REGEX=/\[\#(.*?)\.(.*?)\.(.*?)\#\]/g,consts.FORMULA_ARGUMENTS_REGEX=/\(.+\)/g,consts.DEFAULT_EDIT_PAGE_SCHEMA_NAME="BaseProcessSchemaElementPropertiesPage",consts.TERRASOFT_COMMON_NAMESPACE="Terrasoft.Common.",consts.DATE_VALUE_FORMAT="d.m.Y",consts.TIME_VALUE_FORMAT="H:i",consts.DATE_TIME_VALUE_FORMAT="d.m.Y H:i",consts.READ_DATA_USER_TASK_SCHEMA_UID="cb455b6f-78ff-4b1e-b241-c2bbc0b37e9f",consts.SUBPROCESS_MANAGER_ITEM_UID="49eafdbb-a89e-4bdf-a29d-7f17b1670a45",consts.EMAIL_RECIPIENT_PARAMETER_TEMPLATE="^{0}\\d+$",consts.EMAIL_ATTACHMENT_PARAMETER_TEMPLATE="^Attachments\\d+$",consts.SERVER_GENERIC_LIST_TYPE="System.Collections.Generic.List`1[[System.Collections.Generic.Dictionary`2[[System.String, mscorlib],[System.Object, mscorlib]], mscorlib]], mscorlib",consts.SERVER_GENERIC_DICTIONARY="System.Collections.Generic.Dictionary`2[[System.String, mscorlib],[System.Object, mscorlib]], mscorlib";var functionsResources=Terrasoft.Resources.ProcessSchemaDesigner.Functions;consts.FUNCTIONS=[{value:"Math.Ceiling",displayValue:functionsResources.FunctionRoundUp},{value:"Math.Round",displayValue:functionsResources.FunctionRound},{value:"Math.Floor",displayValue:functionsResources.FunctionRoundDown},{value:"Math.Abs",displayValue:functionsResources.FunctionAbs},{value:"FormulaUtilities.Min",displayValue:functionsResources.FunctionMin},{value:"FormulaUtilities.Max",displayValue:functionsResources.FunctionMax},{value:"FormulaUtilities.Avg",displayValue:functionsResources.FunctionAvg},{value:"FormulaUtilities.Mod",displayValue:functionsResources.FunctionMod},{value:"DateTimeUtilities.Day",displayValue:functionsResources.FunctionDay},{value:"DateTimeUtilities.Month",displayValue:functionsResources.FunctionMonth},{value:"DateTimeUtilities.Time",displayValue:functionsResources.FunctionTime},{value:"DateTimeUtilities.DayOfWeek",displayValue:functionsResources.FunctionDayOfWeek},{value:"DateTimeUtilities.DayInRange",displayValue:functionsResources.FunctionDayInRange}];var systemValueCaptionsResources=Terrasoft.Resources.SystemValueCaptions;consts.SYS_VARIABLES=[{value:Terrasoft.SystemValueType.GENERATE_UID,displayValue:systemValueCaptionsResources.AutoGuid},{value:Terrasoft.SystemValueType.GENERATE_SEQUENTIAL_UID,displayValue:systemValueCaptionsResources.SequentialGuid},{value:Terrasoft.SystemValueType.CURRENT_DATE_TIME,displayValue:systemValueCaptionsResources.CurrentDateTime},{value:Terrasoft.SystemValueType.CURRENT_DATE,displayValue:systemValueCaptionsResources.CurrentDate},{value:Terrasoft.SystemValueType.CURRENT_TIME,displayValue:systemValueCaptionsResources.CurrentTime},{value:Terrasoft.SystemValueType.CURRENT_USER,displayValue:systemValueCaptionsResources.CurrentUser},{value:Terrasoft.SystemValueType.CURRENT_USER_CONTACT,displayValue:systemValueCaptionsResources.CurrentUserContact},{value:Terrasoft.SystemValueType.CURRENT_USER_ACCOUNT,displayValue:systemValueCaptionsResources.CurrentUserAccount}],consts.READ_DATA_RESULT_TYPE={ENTITY:"0",FUNCTION:"1"},consts.ITEM_CHANGE_ACTION={ADD:"add",DELETE:"delete",MODIFY:"modify"},consts.DATE_TIME_VALUE_TYPE_NAME_IN_CAMEL_CASE={DATE_TIME:"DateTime",DATE:"Date",TIME:"Time"},consts.DESIGNER_LEFT_TOOLBAR_ITEMS_ORDER=["ActivityUserTask","EmailUserTask","UserQuestionUserTask","OpenEditPageUserTask","AutoGeneratedPageUserTask","PreconfiguredPageUserTask","ReadDataUserTask","AddDataUserTask","ChangeDataUserTask","DeleteDataUserTask","FormulaTask","ChangeAdminRightsUserTask","ObjectFileProcessingUserTask","WebService","MLDataPredictionUserTask","SendEmailUserTask","ScriptTask","LinkEntityToProcessUserTask","UserTask","EmailTemplateUserTask","SearchDuplicatesUserTask"],consts.PROCESS_DIAGRAM_REPLACE_MENU_ORDER=["ActivityUserTask","UserQuestionUserTask","OpenEditPageUserTask","AutoGeneratedPageUserTask","PreconfiguredPageUserTask","EmailTemplateUserTask","ApprovalUserTask","ReadDataUserTask","AddDataUserTask","ChangeDataUserTask","DeleteDataUserTask","FormulaTask","ChangeAdminRightsUserTask","ObjectFileProcessingUserTask","WebService","MLDataPredictionUserTask","SendEmailUserTask","ScriptTask","LinkEntityToProcessUserTask","UserTask","SubProcess","EventSubProcess","SearchDuplicatesUserTask"],consts.SignalType={SimpleSignal:0,ObjectSignal:1},consts.TimerExpressionTypes={Empty:-1,SingleRun:0,MinuteHour:1,Day:2,Week:3,Month:4,Year:5,CustomCronExpression:6},Terrasoft.TimerExpressionTypes=consts.TimerExpressionTypes,consts.CronWeekDayPosition={First:1,Second:2,Third:3,Fourth:4,Last:5},Terrasoft.CronWeekDayPosition=consts.CronWeekDayPosition,consts.CronWorkDayPosition={First:1,Last:5},Terrasoft.CronWorkDayPosition=consts.CronWorkDayPosition,consts.CronDayTypes={Day:0,WorkDay:1},Terrasoft.CronDayTypes=consts.CronDayTypes,consts.CronDayPeriodTypes={Day:0,WeekDay:1,WorkDay:2},Terrasoft.CronDayPeriodTypes=consts.CronDayPeriodTypes,consts.TimerMisfireInstructionTypes={IgnoreMisfires:0,FireNow:1},Terrasoft.TimerMisfireInstructionTypes=consts.TimerMisfireInstructionTypes,consts.SignalExpectChanges={AnyField:0,AnySelectedField:1},consts.TypeMappingMenu={Default:0,EmailRecipientType:1};var parameterDirectionResources=Terrasoft.Resources.ProcessSchemaDesigner.ParameterDirection;consts.ParameterDirectionConfig={IN:{value:Terrasoft.ProcessSchemaParameterDirection.IN,displayValue:parameterDirectionResources.In},OUT:{value:Terrasoft.ProcessSchemaParameterDirection.OUT,displayValue:parameterDirectionResources.Out},VARIABLE:{value:Terrasoft.ProcessSchemaParameterDirection.VARIABLE,displayValue:parameterDirectionResources.Variable}};var multiInstanceExecutionModeResources=Terrasoft.Resources.ProcessSchemaDesigner.MultiInstanceExecutionMode,_Ext$define;function ownKeys(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function _objectSpread(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?ownKeys(Object(r),!0).forEach((function(t){_defineProperty(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):ownKeys(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function _defineProperty(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function _typeof(e){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function asyncGeneratorStep(e,t,r,n,i,a,s){try{var o=e[a](s),l=o.value}catch(e){return void r(e)}o.done?t(l):Promise.resolve(l).then(n,i)}function _asyncToGenerator(e){return function(){var t=this,r=arguments;return new Promise((function(n,i){var a=e.apply(t,r);function s(e){asyncGeneratorStep(a,n,i,s,o,"next",e)}function o(e){asyncGeneratorStep(a,n,i,s,o,"throw",e)}s(void 0)}))}}function _slicedToArray(e,t){return _arrayWithHoles(e)||_iterableToArrayLimit(e,t)||_unsupportedIterableToArray(e,t)||_nonIterableRest()}function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _unsupportedIterableToArray(e,t){if(e){if("string"==typeof e)return _arrayLikeToArray(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?_arrayLikeToArray(e,t):void 0}}function _arrayLikeToArray(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function _iterableToArrayLimit(e,t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e)){var r=[],n=!0,i=!1,a=void 0;try{for(var s,o=e[Symbol.iterator]();!(n=(s=o.next()).done)&&(r.push(s.value),!t||r.length!==t);n=!0);}catch(e){i=!0,a=e}finally{try{n||null==o.return||o.return()}finally{if(i)throw a}}return r}}function _arrayWithHoles(e){if(Array.isArray(e))return e}function _toConsumableArray(e){return _arrayWithoutHoles(e)||_iterableToArray(e)||_unsupportedIterableToArray(e)||_nonIterableSpread()}function _nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _unsupportedIterableToArray(e,t){if(e){if("string"==typeof e)return _arrayLikeToArray(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?_arrayLikeToArray(e,t):void 0}}function _iterableToArray(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}function _arrayWithoutHoles(e){if(Array.isArray(e))return _arrayLikeToArray(e)}function _arrayLikeToArray(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function asyncGeneratorStep(e,t,r,n,i,a,s){try{var o=e[a](s),l=o.value}catch(e){return void r(e)}o.done?t(l):Promise.resolve(l).then(n,i)}function _asyncToGenerator(e){return function(){var t=this,r=arguments;return new Promise((function(n,i){var a=e.apply(t,r);function s(e){asyncGeneratorStep(a,n,i,s,o,"next",e)}function o(e){asyncGeneratorStep(a,n,i,s,o,"throw",e)}s(void 0)}))}}function _defineProperty(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function ownKeys(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function _objectSpread(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?ownKeys(Object(r),!0).forEach((function(t){_defineProperty(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):ownKeys(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function _defineProperty(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function asyncGeneratorStep(e,t,r,n,i,a,s){try{var o=e[a](s),l=o.value}catch(e){return void r(e)}o.done?t(l):Promise.resolve(l).then(n,i)}function _asyncToGenerator(e){return function(){var t=this,r=arguments;return new Promise((function(n,i){var a=e.apply(t,r);function s(e){asyncGeneratorStep(a,n,i,s,o,"next",e)}function o(e){asyncGeneratorStep(a,n,i,s,o,"throw",e)}s(void 0)}))}}function asyncGeneratorStep(e,t,r,n,i,a,s){try{var o=e[a](s),l=o.value}catch(e){return void r(e)}o.done?t(l):Promise.resolve(l).then(n,i)}function _asyncToGenerator(e){return function(){var t=this,r=arguments;return new Promise((function(n,i){var a=e.apply(t,r);function s(e){asyncGeneratorStep(a,n,i,s,o,"next",e)}function o(e){asyncGeneratorStep(a,n,i,s,o,"throw",e)}s(void 0)}))}}function _slicedToArray(e,t){return _arrayWithHoles(e)||_iterableToArrayLimit(e,t)||_unsupportedIterableToArray(e,t)||_nonIterableRest()}function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _iterableToArrayLimit(e,t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e)){var r=[],n=!0,i=!1,a=void 0;try{for(var s,o=e[Symbol.iterator]();!(n=(s=o.next()).done)&&(r.push(s.value),!t||r.length!==t);n=!0);}catch(e){i=!0,a=e}finally{try{n||null==o.return||o.return()}finally{if(i)throw a}}return r}}function _arrayWithHoles(e){if(Array.isArray(e))return e}function _createForOfIteratorHelper(e,t){var r;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(r=_unsupportedIterableToArray(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,i=function(){};return{s:i,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,s=!0,o=!1;return{s:function(){r=e[Symbol.iterator]()},n:function(){var e=r.next();return s=e.done,e},e:function(e){o=!0,a=e},f:function(){try{s||null==r.return||r.return()}finally{if(o)throw a}}}}function _toConsumableArray(e){return _arrayWithoutHoles(e)||_iterableToArray(e)||_unsupportedIterableToArray(e)||_nonIterableSpread()}function _nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _unsupportedIterableToArray(e,t){if(e){if("string"==typeof e)return _arrayLikeToArray(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?_arrayLikeToArray(e,t):void 0}}function _iterableToArray(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}function _arrayWithoutHoles(e){if(Array.isArray(e))return _arrayLikeToArray(e)}function _arrayLikeToArray(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function ownKeys(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function _objectSpread(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?ownKeys(Object(r),!0).forEach((function(t){_defineProperty(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):ownKeys(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function _defineProperty(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function ownKeys(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function _objectSpread(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?ownKeys(Object(r),!0).forEach((function(t){_defineProperty(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):ownKeys(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function _defineProperty(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function _defineProperty(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function ownKeys(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function _objectSpread(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?ownKeys(Object(r),!0).forEach((function(t){_defineProperty(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):ownKeys(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function _defineProperty(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function _defineProperty(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}consts.MultiInstanceExecutionModeConfig={SEQUENTIAL:{value:Terrasoft.process.MultiInstanceExecutionMode.SEQUENTIAL,displayValue:multiInstanceExecutionModeResources.Sequential},PARALLEL:{value:Terrasoft.process.MultiInstanceExecutionMode.PARALLEL,displayValue:multiInstanceExecutionModeResources.Parallel}},Ext.define("Terrasoft.manager.ProcessSchemaDesignerUtilities",{extend:"Terrasoft.BaseObject",alternateClassName:"Terrasoft.ProcessSchemaDesignerUtilities",singleton:!0,_getCanSafelyChangeDataValueType:function(e,t){return!e.hasNestedParameters()||this.getValueTypeSupportsNestedParameters(t)||!this.getValueTypeSupportsNestedParameters(e.dataValueType)},_validateCanRemoveNestedParameters:function(e,t){var r=!0,n=[];return e.itemProperties.each((function(e){var i=t.canRemoveParameter(e),a=i.canRemove,s=i.validationInfo;a||(r=!1,n.push(s))})),{canRemove:r,validationInfo:n.join("\n")}},getCoreImageUrl:function(e){return Terrasoft.ImageUrlBuilder.getUrl({source:Terrasoft.ImageSources.RESOURCE_MANAGER,params:{resourceManagerName:"Terrasoft.Nui",resourceItemName:"ProcessSchemaDesigner."+e}})},getDataValueTypeImageUrl:function(e){var t=Terrasoft.getImageNameByDataValueType(e);return this.getCoreImageUrl(t)},getDirectionImageUrl:function(e){var t;switch(e){case Terrasoft.ProcessSchemaParameterDirection.IN:t="ParameterDirection.In.svg";break;case Terrasoft.ProcessSchemaParameterDirection.OUT:t="ParameterDirection.Out.svg";break;case Terrasoft.ProcessSchemaParameterDirection.VARIABLE:t="ParameterDirection.Variable.svg";break;default:return this.warning("Unknown direction value ".concat(e)),null}return this.getCoreImageUrl(t)},getElementCaption:function(e){if(!e)return null;var t=e.caption;return t instanceof Terrasoft.LocalizableString&&(t=t.getValue()),t=t||e.name},addParameterMask:function(e){var t=Terrasoft.process.constants;return t.LEFT_MACROS_BRACKET+e+t.RIGHT_MACROS_BRACKET},removeParameterMask:function(e){return e.slice(2,-2)},getPackageUId:function(e){return e.parentSchema.packageUId},getModalBoxConfig:function(){return{heightPixels:800,widthPixels:1280,boxClasses:["formula-modal-box"]}},getDateTimeModalBoxConfig:function(){return{heightPixels:230,widthPixels:460,boxClasses:["date-time-modal-box"]}},getProcessMessageBoxControlConfig:function(e){return{memo:{dataValueType:Terrasoft.DataValueType.TEXT,value:e,customConfig:{className:"Terrasoft.MemoEdit",height:"235px",readonly:!0,markerValue:"validationMessage"}}}},showProcessMessageBox:function(e){e.message&&(e.customWrapClass=e.customWrapClass||"ts-process-message-box",e.controlConfig=e.controlConfig||this.getProcessMessageBoxControlConfig(e.message)),Terrasoft.utils.showMessage(e)},getParameterValueSource:function(e){return(e||{}).source||Terrasoft.ProcessSchemaParameterValueSource.None},getIsMappingParameterValue:function(e){var t=this.getParameterValueSource(e),r=[Terrasoft.ProcessSchemaParameterValueSource.ConstValue,Terrasoft.ProcessSchemaParameterValueSource.None];return!Terrasoft.contains(r,t)},validateElementRemoval:function(e,t,r,n){this.processRemovalConfig(e.canRemoveElements(t),r,n)},validateElementReplace:function(e,t,r,n){this.processRemovalConfig(_objectSpread(_objectSpread({},e.canRemoveElements(t)),{},{caption:Terrasoft.Resources.ProcessSchemaDesigner.Messages.InvalidReplaceElement}),r,n)},validateParameterRemoval:function(e,t,r,n){this.processRemovalConfig(e.canRemoveParameter(t),r,n)},processRemovalConfig:function(e,t,r){var n=e.canRemove,i=e.caption,a=e.validationInfo;n?t.call(r,!0):(i=i||Terrasoft.Resources.ProcessSchemaDesigner.Messages.InvalidRemoveElement,this.showValidateDialog({caption:i,validationInfo:a,callback:function(){return t.call(r,!1)},scope:r}))},validateCanChangeParameterDataValueType:function(e){var t=e.schema.parameters.find(e.parameterUId);if(!t||this._getCanSafelyChangeDataValueType(t,e.newDataValueType))return!0;var r=this._validateCanRemoveNestedParameters(t,e.schema);return this.processRemovalConfig(r,e.callback||Terrasoft.emptyFn,e.scope),r.canRemove},validateAllLazyPropertiesAreLoaded:function(e,t,r){if(e.getAllLazyPropertiesAreLoaded())t.call(r,!0);else{var n=Terrasoft.Mask.show({timeout:0});e.loadAllLazyProperties((function(){Terrasoft.Mask.hide(n),t.call(r,!0)}),e)}},showLoadLazyParametersDialog:function(e,t,r){var n=Terrasoft.Resources.ProcessSchemaDesigner.Messages.LazyLoadMessage;Terrasoft.utils.showConfirmation(n,(function(n){if("yes"===n){var i=Terrasoft.Mask.show({timeout:0});e.loadAllLazyProperties((function(){Terrasoft.Mask.hide(i),Ext.callback(t,r,[!0])}),e)}else Ext.callback(t,r,[!1])}),["yes","no"],this,{defaultButton:0})},showValidateDialog:function(e){var t=e.caption,r=e.validationInfo,n=e.callback,i=e.scope;this.showProcessMessageBox({caption:t,message:r,handler:n,scope:i})},hasMapping:function(e){if(e&&e.source){var t=Terrasoft.ProcessSchemaParameterValueSource;return e.source!==t.None&&e.source!==t.ConstValue}return!1},mappingValidator:function(e){var t={invalidMessage:""};if(e&&!1===e.isValid&&Terrasoft.ProcessSchemaDesignerUtilities.hasMapping(e)){var r=Terrasoft.Resources.ProcessSchemaDesigner.Messages;t.invalidMessage=r.InvalidMappingColumn||"Invalid formula"}return t},getSchemaIdByUId:function(e,t,r){var n=Ext.create("Terrasoft.EntitySchemaQuery",{rootSchemaName:"SysSchema"});n.addColumn("Id"),n.filters.add("UId",n.createColumnFilterWithParameter(Terrasoft.ComparisonType.EQUAL,"UId",e)),n.getEntityCollection((function(e){var n;e.success&&!e.collection.isEmpty()&&(n=e.collection.first().$Id),Ext.callback(t,r,[n])}),this)},getValueTypeSupportsNestedParameters:function(e){return e===Terrasoft.DataValueType.COMPOSITE_OBJECT_LIST}}),Ext.define("Terrasoft.Designers.ProcessSchemaElementEditable",{alternateClassName:"Terrasoft.ProcessSchemaElementEditable",extend:"Terrasoft.core.BaseObject",sandbox:null,isReadonly:!1,tag:null,init:function(e,t){var r=this.sandbox,n=this.getMessagesConfig();r.registerMessages(n);var i=r.publish("GetElementData",this.tag);i?this.onElementDataLoad(i,(function(){this.destroyed?this.hideMask():(!0!==this.isReadonly&&r.subscribe("SaveElementProperties",this.onSaveElementProperties,this),this.validateAfterDataLoaded(),e.call(t||this))}),this):this.hideMask()},hideMask:function(){var e=this.maskId;e&&Terrasoft.Mask.hide(e)},getMessagesConfig:function(){var e={GetElementData:{direction:Terrasoft.MessageDirectionType.PUBLISH,mode:Terrasoft.MessageMode.PTP},GetProcessSchema:{direction:Terrasoft.MessageDirectionType.PUBLISH,mode:Terrasoft.MessageMode.PTP},GetSchemaManagerItem:{direction:Terrasoft.MessageDirectionType.PUBLISH,mode:Terrasoft.MessageMode.PTP}};return!0!==this.isReadonly&&Ext.apply(e,{SaveProperties:{direction:Terrasoft.MessageDirectionType.PUBLISH,mode:Terrasoft.MessageMode.PTP},HidePropertyPage:{direction:Terrasoft.MessageDirectionType.PUBLISH,mode:Terrasoft.MessageMode.PTP},SaveElementProperties:{direction:Terrasoft.MessageDirectionType.SUBSCRIBE,mode:Terrasoft.MessageMode.PTP},DiagramPageCaptionChanged:{direction:Terrasoft.MessageDirectionType.SUBSCRIBE,mode:Terrasoft.MessageMode.PTP},PropertiesPageCaptionChanged:{direction:Terrasoft.MessageDirectionType.PUBLISH,mode:Terrasoft.MessageMode.PTP}}),e},save:function(e){!0!==this.isReadonly&&this.sandbox.publish("SaveProperties",e)},onDestroy:function(){this.sandbox.unRegisterMessages()},onElementDataLoad:function(){throw new Terrasoft.NotImplementedException({message:"editElement is not defined"})},validateAfterDataLoaded:function(){throw new Terrasoft.NotImplementedException({message:"validateAfterDataLoaded is not defined"})},onSaveElementProperties:function(){throw new Terrasoft.NotImplementedException({message:"onSaveElementProperties is not implemented"})}}),Ext.define("Terrasoft.diagram.userHandles.NodeSelectionTool",{alternateClassName:"Terrasoft.NodeSelectionTool",getNodeSelectionTool:function(){if(this.nodeSelectionHandle)return this.nodeSelectionHandle;var e=this.nodeSelectionHandle=ej.Diagram.UserHandle({name:"NodeSelectionHandle",constraint:Terrasoft.diagram.ToolsConstraint.NodeSelectionTool,position:{x:0,y:0},enableMultiSelection:!1,cornerRadius:8,defStrokeWidth:7,eventStrokeWidth:9}),t=this.customMoveTool(ej.Diagram.MoveTool);return e.renderUserHandle=this.nodeSelectionRenderUserHandle,e.upateHandle=this.nodeSelectionUpateHandle,e.tool=new t(null),e},customMoveTool:function(e){function t(t){e.call(this,t)}return ej.Diagram.extend(t,e),t.prototype._findNodeUnderMouse=function(t,r){var n=e.prototype._findNodeUnderMouse.call(this,t,r);return n||Ext.isEmpty(this.diagram.selectionList)||(n=this.diagram.selectionList[0]),n},t},nodeSelectionRenderUserHandle:function(e,t,r,n,i,a){var s=t.width+7,o=t.height+7;e.fillColor="none",e.pathColor="none";var l=r.g({id:r.document.id+"userHandle_g",class:"userHandle"});i.appendChild(l);var c=this._getHandlePosition(e,t,n),u=this._getHandleShape(e,c.x*n,c.y*n);if(u.fill="none",u.stroke=a.selectionColor,u.opacity=.4,u["stroke-width"]=e.defStrokeWidth,u.class+=" nodeSelectionHandle",t.nodeType===Terrasoft.diagram.UserHandlesConstraint.Event)u.cx=c.x*n,u.cy=c.y*n,u.r=s/2,u["stroke-width"]=e.eventStrokeWidth,l.appendChild(r.circle(u));else if(t.nodeType===Terrasoft.diagram.UserHandlesConstraint.Gateway){var h=ej.Diagram.Util.bounds(t),f=Math.sqrt(2*Math.pow(h.height/2,2))+e.defStrokeWidth,d=r.g({id:e.name+"userHandle_rotate_g",transform:Ext.String.format("translate({0} {1}) rotate(45)",h.center.x,h.center.y-h.height/2-5)});u.x=0,u.y=0,u.height=f,u.width=f,l.appendChild(d),d.appendChild(r.rect(u))}else u.width=s,u.height=o,u.x=c.x*n-s/2,u.y=c.y*n-o/2,u.rx=e.cornerRadius,u.ry=e.cornerRadius,l.appendChild(r.rect(u))},nodeSelectionUpateHandle:function(e,t,r,n,i){if(t.sourceNode||t.sourcePoint)this._updateHandle(e,t,r,n,i);else{var a=r.getElementById(e.name+"_shape");if(!n&&e.visible){var s=t.width+7,o=t.height+7,l=this._getHandlePosition(e,t,i),c={id:e.name+"_shape"};if(t.nodeType===Terrasoft.diagram.UserHandlesConstraint.Event)c.cx=l.x*i,c.cy=l.y*i,r.circle(c);else{if(t.nodeType===Terrasoft.diagram.UserHandlesConstraint.Gateway){var u=ej.Diagram.Util.bounds(t),h=Math.sqrt(2*Math.pow(u.height/2,2))+e.defStrokeWidth;c.x=0,c.y=0,c.height=h,c.width=h,r.g({id:e.name+"userHandle_rotate_g",transform:Ext.String.format("translate({0} {1}) rotate(45)",u.center.x,u.center.y-u.height/2-5)})}else c.width=s,c.height=o,c.x=l.x*i-s/2,c.y=l.y*i-o/2;r.rect(c)}a&&e.visible&&(a.style.display="block")}else a&&(a.style.display="none")}}}),Ext.define("Terrasoft.diagram.userHandles.ConnectionEditTool",{alternateClassName:"Terrasoft.ConnectionEditTool",minPortDistance:20,connectionEditTool:function(){var e=ej.Diagram.ConnectionEditTool;function t(t){e.call(this,t)}var r=this,n=e.prototype._checkConnectionPossible;e.prototype._checkConnectionPossible=function(e){var t=this.diagram._findNodeUnderMouse(e);if(t){var r=this.checkIsNewConnectionPossible(t,this._endPoint);r&&n.apply(this,arguments)}};var i=e.prototype.mousemove;e.prototype.mousemove=function(e){var t=this.diagram,r=this.selectedObject;null==this.segments&&r&&"segmentEnd"!==this._endPoint&&(this.segments=Terrasoft.deepClone(r.segments),t.updateConnector(r.name,{segments:[{type:"orthogonal"}]}));var n=t._findNodeUnderMouse(e);if(n){var a=this.checkIsNewConnectionPossible(n,this._endPoint);if(this._setPortsVisibility(n,a),!a){var s=n.constraints;n.constraints=ej.Diagram.NodeConstraints.None;var o=this._currentPossibleConnection;return o&&o.ports&&this._showPort(o,!0),ej.Diagram.SvgContext._removePortHighlighter(this.diagram._svg,this.diagram._adornerLayer),this._currentPossibleConnection=null,i.call(this,e),void(n.constraints=s)}}i.call(this,e)},e.prototype.checkIsNewConnectionPossible=function(e,t){var r,n,i,a,s=this.selectedObject;if(e.nodeType===Terrasoft.diagram.UserHandlesConstraint.Lane||e.nodeType===Terrasoft.diagram.UserHandlesConstraint.Connector)return!1;if(!s)return!0;var o=e.name;if("targetEndPoint"===t?(r="targetNode",n=e.incomingConnectionsLimit,a=o,i=s.sourceNode):"sourceEndPoint"===t&&(r="sourceNode",n=e.outgoingConnectionsLimit,a=s.targetNode,i=o),a===i)return!1;if(Ext.isEmpty(r))return!0;for(var l=0,c=this.diagram&&this.diagram.model.connectors||[],u=0;u<c.length;u++){var h=c[u];if(h.name!==s.name)if(h[r]===o&&l++,h.targetNode===a&&h.sourceNode===i)return!1}return!(!Ext.isEmpty(n)&&-1!==n)||l<n},e.prototype._setPortsVisibility=function(e,t){var r=e.ports;if(r)for(var n=ej.Diagram.PortConstraints,i=t?n.Connect:n.None,a=0;a<r.length;a++){r[a].constraints=i}};var a=ej.Diagram.prototype._findPortAtPoint;ej.Diagram.prototype._findPortAtPoint=function(e,t){var n=a.apply(this,arguments);if(null==n){var i=ej.Diagram.Util.bounds(t),s=r.minPortDistance;ej.Diagram.Geometry.containsPoint(i,e)&&(s=Math.max(i.width/2,i.height/2)),t.ports.forEach((function(t){var r=ej.Diagram.Util._getPortPosition(t,i),a=ej.Diagram.Geometry.distance(e,r);a<s&&(s=a,n=t)}),this)}return n},ej.Diagram.extend(t,e),t.prototype._getCanConnect=function(){var e=!1;if(this._currentPossibleConnection){if(e=(e=null!=this._possibleConnectionPort&&ej.Diagram.Util.canConnect(this._possibleConnectionPort,!0))&&ej.Diagram.Util.canConnect(this._currentPossibleConnection)){var t=this._currentPossibleConnection;t&&(e=this.checkIsNewConnectionPossible(t,this._endPoint))}}else"targetEndPoint"!==this._endPoint&&"sourceEndPoint"!==this._endPoint&&(e=!0);return e};var s=e.prototype.mouseup;return e.prototype.mouseup=function(){var e=this._endPoint,t="targetEndPoint"===e||"sourceEndPoint"===e;s.apply(this,arguments);var n=this.diagram,i=n.selectionList[0];i&&i.segments&&(i.targetNode&&i.sourceNode?(n.tools.ConnectorRemoveHandle.currentPoint=r.utils.labelUtils.getSequenceFlowCaptionPosition(i),n._clearSelection(),n.addSelection(i),t&&r.fireEvent("connectorsNodesChange",[i]),r.updateSequenceFlowPolylinePointPositions([i.name])):(n.undo(),n.updateConnector(i.name,{segments:this.segments}))),this.segments=null},t},createConnectionTool:function(e,t){function r(){e.call(this),this._connector=null}return ej.Diagram.extend(r,e),r.prototype.test=function(e){var t=e.outgoingConnectionsLimit;if(Ext.isEmpty(t)||-1===t)return!0;for(var r=0,n=this.diagram&&this.diagram.model.connectors||[],i=0;i<n.length;i++)n[i].sourceNode===e.name&&r++;return r<t},r.prototype.mousedown=function(e){var r=e.target.attributes.flowType;if(r){var n,i=r.value,a=this.diagram.selectionList[0].name,s=t.items,o=s.get(a),l=Ext.create("Terrasoft.Process"+i+"Schema",{name:i,sourceNode:a,sourceRefUId:o.uId,targetRefUId:Terrasoft.GUID_EMPTY,sourceSequenceFlowPointLocalPosition:"1;0",targetPoint:t.getOffsetMousePosition(e),showPropertiesWindowOnAdding:!0,isValidateExecuted:!1});if(l.flowType===Terrasoft.ProcessSchemaEditSequenceFlowType.CONDITIONAL&&(l.isValid=!1),l.uId=Terrasoft.generateGUID(),!1===t.fireEvent("generateItemNameAndCaption",l))n=l.name;else{var c=1,u=l.name;for(n=u+c;s.contains(n);)n=u+ ++c;l.name=n}s.add(n,l),this.selectedObject=this._connector=this.diagram._findConnector(n),this.undoObject=this._getClonedObject(this.selectedObject),this._endPoint="targetEndPoint",this.targetid="targetEndPoint",this._selectedSegment=""}},r.prototype.mouseup=function(r){var n=e.prototype._getCanConnect.call(this,r);e.prototype.mouseup.call(this,r),n||t.items.removeByKey(this._connector.name)},r.connectionChange=this.onConnectionChange.bind(this),r},getConnectionEditTool:function(){if(this.createConnectionHandle)return this.createConnectionHandle;var e=this.createConnectionHandle=ej.Diagram.UserHandle({XLINK_ATTRIBUTE:"href",TOOL_SIZE:21,NODE_BORDER_WIDTH:7,TOOL_MARGIN:6,name:"CreateConnectionHandle",size:21,constraint:Terrasoft.diagram.ToolsConstraint.ConnectionEditTool,position:{x:0,y:0},enableMultiSelection:!1,renderUserHandle:this.connectionRenderUserHandle,upateHandle:this.connectionUpateHandle,renderToolFilter:this.renderToolFilter,getImageUrl:this.getImageUrl,renderTool:this.renderTool,getPosition:this.getPosition,renderTools:this.renderTools}),t=this.createConnectionTool(this.connectionEditTool(),this);return e.tool=new t,e},connectionRenderUserHandle:function(e,t,r,n,i,a){var s=a.items.get(t.name).getConnectionUserHandles(),o=r.g({id:r.document.id+"userHandle_g",class:"userHandle"});i.appendChild(o),e.renderTools(s,t,o,r,a)},renderTools:function(e,t,r,n,i){var a=!1;e.length>1&&(a=t.outEdges.some((function(e){return i.items.get(e)instanceof Terrasoft.ProcessDefaultSequenceFlowSchema}))),1===e.length&&this.renderTool(e[0],r,n,t,"center",i),2===e.length&&(this.renderTool(e[0],r,n,t,"top",i),a||this.renderTool(e[1],r,n,t,"bottom",i)),3===e.length&&(this.renderTool(e[0],r,n,t,"top",i),a||this.renderTool(e[1],r,n,t,"center",i),this.renderTool(e[2],r,n,t,"bottom",i))},getPosition:function(e,t){var r=ej.Diagram.Util.bounds(e).middleRight,n={x:r.x-this.TOOL_SIZE/2+this.NODE_BORDER_WIDTH,y:r.y};switch(t){case"top":n.y=n.y-this.TOOL_SIZE/2-this.TOOL_SIZE-this.TOOL_MARGIN,e.nodeType===Terrasoft.diagram.UserHandlesConstraint.Gateway&&(n.x=n.x-this.NODE_BORDER_WIDTH,n.y=r.y-this.TOOL_SIZE-this.TOOL_MARGIN/2);break;case"center":n.y=n.y-this.TOOL_SIZE/2;break;case"bottom":n.y=n.y+this.TOOL_SIZE/2+this.TOOL_MARGIN,e.nodeType===Terrasoft.diagram.UserHandlesConstraint.Gateway&&(n.x=n.x-this.NODE_BORDER_WIDTH,n.y=r.y+this.TOOL_MARGIN/2)}return n},renderTool:function(e,t,r,n,i,a){var s=this.getPosition(n,i,a),o=this.name+"_"+e+"_shape";if(r.getElementById(o))r.image({id:o,x:s.x,y:s.y});else{this.filter||(this.filter=this.renderToolFilter({name:"CreateConnectionHandle",constraints:ej.Diagram.NodeConstraints.Shadow,width:this.TOOL_SIZE,height:this.TOOL_SIZE},r));var l={id:o,flowType:e,width:this.TOOL_SIZE,height:this.TOOL_SIZE,x:s.x,y:s.y,class:"userHandle "+e+"Handle",preserveAspectRatio:"none",filter:this.filter},c=r.image(l),u=this.getImageUrl(e+".svg");c.setAttributeNS(this.XLINK_NAMESPACE,this.XLINK_ATTRIBUTE,u),t.appendChild(c)}},connectionUpateHandle:function(e,t,r,n,i,a){for(var s=a.items.get(t.name).getConnectionUserHandles(),o=0;o<s.length;++o){var l=r.getElementById(e.name+"_"+s[o]+"_shape");l&&(!n&&e.visible?l.style.display="block":l.style.display="none")}e.renderTools(s,t,null,r,a)}}),Ext.define("Terrasoft.diagram.userHandles.NodeRemoveTool",{alternateClassName:"Terrasoft.NodeRemoveTool",getNodeRemoveTool:function(){if(this.nodeRemoveHandle)return this.nodeRemoveHandle;var e=this.nodeRemoveHandle=ej.Diagram.UserHandle({XLINK_ATTRIBUTE:"href",TOOL_SIZE:21,NODE_BORDER_WIDTH:7,name:"NodeRemoveHandle",constraint:Terrasoft.diagram.ToolsConstraint.NodeRemoveTool,position:{x:0,y:0},enableMultiSelection:!1,renderUserHandle:this.nodeRemoveRenderUserHandle,renderToolFilter:this.renderToolFilter,upateHandle:this.nodeRemoveUpateHandle,getImageUrl:this.getImageUrl}),t=this.nodeRemoveTool(ej.Diagram.PhaseTool);return e.tool=new t(null),e},nodeRemoveTool:function(e){function t(t){e.call(this,t)}ej.Diagram.extend(t,e);var r=this;return t.prototype.mouseup=function(){var e=r.diagram.selectionList[0];r.items.removeByKey(e.name)},t},nodeRemoveRenderUserHandle:function(e,t,r,n,i){var a=r.g({id:r.document.id+"userHandle_g",class:"userHandle"});i.appendChild(a);var s=ej.Diagram.Util.bounds(t);this.filter||(this.filter=e.renderToolFilter({name:"NodeRemoveTool",constraints:ej.Diagram.NodeConstraints.Shadow,width:e.TOOL_SIZE,height:e.TOOL_SIZE},r));var o={id:e.name+"_shape",width:e.TOOL_SIZE,height:e.TOOL_SIZE,x:s.x-e.NODE_BORDER_WIDTH/2-e.TOOL_SIZE/2,y:s.y-e.NODE_BORDER_WIDTH/2-e.TOOL_SIZE/2,class:"userHandle nodeRemoveHandle",preserveAspectRatio:"none","data-item-marker":e.name,filter:this.filter};t.nodeType===Terrasoft.diagram.UserHandlesConstraint.Gateway&&(o.x=o.x+s.width/4,o.y=o.y+s.height/4);var l=r.image(o),c=e.getImageUrl("removeTool.svg");l.setAttributeNS(e.XLINK_NAMESPACE,e.XLINK_ATTRIBUTE,c),a.appendChild(l)},nodeRemoveUpateHandle:function(e,t,r,n){if(!n&&e.visible){r.getElementById(e.name+"_shape")&&e.visible&&(r.getElementById(e.name+"_shape").style.display="block");var i=ej.Diagram.Util.bounds(t),a={id:e.name+"_shape",x:i.x-e.NODE_BORDER_WIDTH/2-e.TOOL_SIZE/2,y:i.y-e.NODE_BORDER_WIDTH/2-e.TOOL_SIZE/2};t.nodeType===Terrasoft.diagram.UserHandlesConstraint.Gateway&&(a.x=a.x+i.width/4,a.y=a.y+i.height/4),r.image(a)}else r.getElementById(e.name+"_shape")&&(r.getElementById(e.name+"_shape").style.display="none")}}),Ext.define("Terrasoft.diagram.userHandles.ConnectorRemoveTool",{alternateClassName:"Terrasoft.ConnectorRemoveTool",getConnectorRemoveTool:function(){if(this.connectorRemoveHandle)return this.connectorRemoveHandle;var e=this.connectorRemoveHandle=ej.Diagram.UserHandle({name:"ConnectorRemoveHandle",constraint:Terrasoft.diagram.ToolsConstraint.ConnectorRemoveTool,position:{x:0,y:0},enableMultiSelection:!1,singleAction:!0,XLINK_ATTRIBUTE:"href",TOOL_SIZE:21,renderToolFilter:this.renderToolFilter,renderUserHandle:this.connectorRemoveRenderUserHandle,upateHandle:Ext.emptyFn,getImageUrl:this.getImageUrl}),t=this.connectorRemoveTool(ej.Diagram.PhaseTool);return e.tool=new t(e.name),e},connectorRemoveTool:function(e){function t(t){e.call(this,t)}return ej.Diagram.extend(t,e),t.prototype.mouseup=function(){var e=this.diagram;e.remove(e.selectionList[0])},t},connectorRemoveRenderUserHandle:function(e,t,r,n,i){var a=r.g({id:r.document.id+"userHandle_g",class:"userHandle"});i.appendChild(a);var s=ej.Diagram.Point(0,0),o=Terrasoft.isEqual(e.tool.currentPoint,s)?t.segments[0].points[0]:e.tool.currentPoint,l={id:e.name+"_shape",width:e.TOOL_SIZE,height:e.TOOL_SIZE,x:o.x-e.TOOL_SIZE-5,y:o.y-e.TOOL_SIZE-5,class:"userHandle connectorRemoveHandle",preserveAspectRatio:"none"};l.filter=e.renderToolFilter({name:"ConnectorRemoveHandle",constraints:ej.Diagram.NodeConstraints.Shadow,width:e.TOOL_SIZE,height:e.TOOL_SIZE},r);var c=r.image(l),u=e.getImageUrl("removeTool.svg");c.setAttributeNS(e.XLINK_NAMESPACE,e.XLINK_ATTRIBUTE,u),a.appendChild(c),e.tool.currentPoint=s}}),Ext.define("Terrasoft.utils.TsDiagramModule.LabelUtils",{extend:"Terrasoft.BaseObject",alternateClassName:"Terrasoft.TsDiagramModule.LabelUtils",svgUtils:null,getSequenceFlowCaptionPosition:function(e){var t,r,n=this.getSequenceFlowPoints(e),i=Math.floor(n.length/2),a=n[i];return n.length%2==0?(t=(n[i-1].x+a.x)/2,r=(n[i-1].y+a.y)/2):(t=a.x,r=a.y),ej.datavisualization.Diagram.Point(t,r)},getSequenceFlowPoints:function(e){var t,r=e.segments,n=[];return r.forEach((function(e){e.points.forEach((function(e){t&&ej.datavisualization.Diagram.Geometry.isEqualPoint(e,t)||(t=e,n.push(e))}))})),n},getLabelBackgroundEl:function(e){var t,r=e.label,n=e.textNode,i=e.svg,a=e.node,s=r.bBox||n.getBBox(),o={id:a.name+"_"+r.name+"_lblbg",width:s.width,height:s.height,fill:r.text?r.fillColor:"transparent",stroke:r.borderColor,"stroke-width":r.borderWidth,transform:"translate(0, 0)"};switch(r.tag){case Terrasoft.diagram.labelBackgroundTag.CIRCLE:o.r=Math.max(s.width,s.height)/2,o.cx=0,o.cy=0,t=i.circle(o);break;case Terrasoft.diagram.labelBackgroundTag.ELLIPSE:o.rx=s.width/2,o.ry=s.height/2,o.cx=0,o.cy=0,t=i.ellipse(o);break;default:t=i.rect(o)}return t},updateLabelBackground:function(e){var t,r=e.textNode,n=e.label,i=e.backgroundPadding,a=e.labelBackgroundEl;switch(a.tagName){case Terrasoft.diagram.labelBackgroundTag.CIRCLE:t=this.getLabelCircleBackgroundConfig({label:n,textNode:r,padding:i});break;case Terrasoft.diagram.labelBackgroundTag.ELLIPSE:t=this.getLabelEllipseBackgroundConfig({label:n,textNode:r,padding:i});break;default:t=this.getLabelRecatangleBackgroundConfig({label:n,textNode:r,labelBackgroundEl:a,padding:i})}"statisticInfo"===n.labelType&&(t.filter=this.getStatisticInfoLabelShadowFilter(e.svg)),ej.datavisualization.Diagram.Util.attr(a,t)},getLabelCircleBackgroundConfig:function(e){var t=e.label,r=t.bBox,n=this.getTextCenter(e.textNode,r),i=t.padding||e.padding;return{r:Math.max(r.width,r.height)/2+i,transform:"translate("+n.x+","+n.y+")"}},getLabelEllipseBackgroundConfig:function(e){var t=e.label,r=t.bBox,n=this.getTextCenter(e.textNode,r),i=t.padding||e.padding;return{rx:Math.max(r.width,r.height)/2+i,ry:r.height/2+i,transform:"translate("+n.x+","+n.y+")"}},getLabelRecatangleBackgroundConfig:function(e){var t=e.labelBackgroundEl,r=this.svgUtils.getSvgElTranslateValues(e.textNode,["e","f"]),n=e.label.bBox,i=n.x+r.e-e.padding,a=n.y+r.f-e.padding;return{width:t.width.baseVal.value+2*e.padding,height:t.height.baseVal.value+2*e.padding,transform:"translate("+i+","+a+")"}},offsetConnectorLabel:function(e){var t=this.getSequenceFlowCaptionPosition(e.connector),r=e.offset;t.x+=r.x,t.y+=r.y,ej.datavisualization.Diagram.Util.attr(e.textNode,{transform:"translate("+t.x+","+t.y+")"})},wrapTextAlign:function(e,t,r,n){for(var i=0;i<t.length;i++){var a=t[i].getComputedTextLength();switch(n){case"left":a=0;break;case"center":a=Terrasoft.getIsRtlMode()&&!Ext.isIEOrEdge?a/2:-a/2;break;case"right":a=-a}var s={x:Number(a),dy:r},o=t[i];ej.datavisualization.Diagram.Util.attr(o,s)}},alignTextOnLabel:function(e){var t=e.node,r=e.nodeBounds,n=e.text,i=e.label,a=e.svg,s=i.bBox;s||(s=i.bBox=n.getBBox());var o=ej.datavisualization.Diagram.Util._getLabelPosition(i,r),l={x:0,y:0},c=0;switch(c=i.verticalAlignment===ej.datavisualization.Diagram.VerticalAlignment.Top?o.y:i.verticalAlignment===ej.datavisualization.Diagram.VerticalAlignment.Center?o.y-s.height/2:o.y-s.height,l.y=c,i.horizontalAlignment){case ej.datavisualization.Diagram.HorizontalAlignment.Left:switch(i.textAlign){case ej.datavisualization.Diagram.TextAlign.Left:l.x=o.x;break;case ej.datavisualization.Diagram.TextAlign.Center:l.x=o.x+s.width/2;break;case ej.datavisualization.Diagram.TextAlign.Right:l.x=o.x+s.width}break;case ej.datavisualization.Diagram.HorizontalAlignment.Center:switch(i.textAlign){case ej.datavisualization.Diagram.TextAlign.Left:l.x=o.x-s.width/2;break;case ej.datavisualization.Diagram.TextAlign.Center:l.x=o.x;break;case ej.datavisualization.Diagram.TextAlign.Right:l.x=o.x+s.width/2}break;case ej.datavisualization.Diagram.HorizontalAlignment.Right:switch(i.textAlign){case ej.datavisualization.Diagram.TextAlign.Left:l.x=o.x-s.width;break;case ej.datavisualization.Diagram.TextAlign.Center:l.x=o.x-s.width/2;break;case ej.datavisualization.Diagram.TextAlign.Right:l.x=o.x}}(t.segments||"group"===t.type)&&(l.x=l.x+r.x,l.y=l.y+r.y,o.x+=r.x,o.y+=r.y),n.setAttribute("transform","translate("+l.x+","+l.y+"), rotate("+i.rotateAngle+","+(o.x-l.x)+","+(o.y-l.y)+")");var u=a.getElementById(t.name+"_"+i.name+"_lblbg");if(u){var h=l.x+s.x;c=l.y;var f={width:s.width,height:s.height,transform:"translate("+h+","+c+"), rotate("+i.rotateAngle+","+(o.x-h)+","+(o.y-c)+")",fill:i.text?i.fillColor:"transparent",stroke:i.borderColor,"stroke-width":i.borderWidth};ej.datavisualization.Diagram.Util.attr(u,f)}if(n.setAttribute("data-item-marker",i.text),!0!==i.defaultRendering&&u){if(t.nodeType===Terrasoft.diagram.UserHandlesConstraint.Connector){var d=e.connectorCaptionOffset;this.offsetConnectorLabel({connector:t,textNode:n,offset:{x:d.x||0,y:d.y||0}})}this.updateLabelBackground({textNode:n,label:i,backgroundPadding:e.labelBackgroundPadding||0,labelBackgroundEl:u,svg:a})}},getTextCenter:function(e,t){var r=this.svgUtils.getSvgElTranslateValues(e,["e","f"]);return{x:t.x+r.e+t.width/2,y:t.y+r.f+t.height/2}},getStatisticInfoLabelShadowFilter:function(e){return this.svgUtils.createShadowFilter(e,{name:"StatisticInfoShadow_filter",color:"#000",opacity:.4,offsetX:1,offsetY:2,blur:2})}}),Ext.define("Terrasoft.controls.Diagram",{extend:"Terrasoft.BaseDiagram",alternateClassName:"Terrasoft.Diagram",mixins:{connectorRemoval:"Terrasoft.ConnectorRemovalMixin"},statics:{custom:{}},minHeight:300,autoScroll:!0,selectedItem:null,diagram:null,diagramSnap:null,svgContextSnap:null,cancelDiagramEvents:!1,nodeConstraints:null,portDefaultsConfig:null,nodeBaseDefaultsConfig:null,connectorConstraints:null,connectorLineColor:"#A4A4A4",selectionColor:"#C2D1F9",connectorPortColor:"#5FADEA",portRadius:3.5,autoScrollBorder:null,renderToSelector:null,svgContainerSelector:null,bottomScrollContentOffset:0,rightScrollContentOffset:0,itemsBounds:null,overflow:"auto",constructor:function(){ej.Diagram=ej.datavisualization.Diagram,this.svgContextSnap=Terrasoft.deepClone(ej.Diagram.SvgContext),this.itemsBounds=[],this.autoScrollBorder={left:50,top:50,right:50,bottom:50},this.nodeBaseDefaultsConfig={constraints:ej.Diagram.NodeConstraints.Delete,inputPortCount:0,outputPortCount:0,children:[]},this.portDefaultsConfig={visibility:ej.Diagram.PortVisibility.Connect,fillColor:"#FFFFFF",shape:ej.Diagram.PortShapes.Circle,size:2*this.portRadius,borderColor:this.connectorPortColor,borderWidth:1,constraints:ej.Diagram.PortConstraints.Connect},this.connectorConstraints=ej.Diagram.ConnectorConstraints.Delete|ej.Diagram.ConnectorConstraints.DragSourceEnd|ej.Diagram.ConnectorConstraints.DragTargetEnd|ej.Diagram.ConnectorConstraints.Select,this.nodeConstraints=ej.Diagram.NodeConstraints.Select|ej.Diagram.NodeConstraints.Drag|ej.Diagram.NodeConstraints.Delete|ej.Diagram.NodeConstraints.Connect|ej.Diagram.NodeConstraints.Shadow,this.initUtils(),this.callParent(arguments)},initUtils:function(){var e=this.utils={};e.svg=this.getSvgUtils(),e.labelUtils=this.getLabelUtils(e.svg)},getSvgUtils:function(){return Ext.create("Terrasoft.TsDiagramModule.SvgUtils")},getLabelUtils:function(e){return Ext.create("Terrasoft.TsDiagramModule.LabelUtils",{svgUtils:e})},tpl:['<div id="diagram-{id}" class="{wrapClassName}"></div>'],getState:function(){return this.getInstance().save()},renderItem:function(e,t){var r=this.getInstance(),n=r._svg,i=n.getElementById(t);"group"===e.type?ej.Diagram.SvgContext.renderGroup(e,n,i,r.nameTable,r):e.segments?ej.Diagram.SvgContext.renderConnector(e,n,i):ej.Diagram.SvgContext.renderNode(e,n,i),!0===e.isContainer&&this.iterateItemChildrens(e,(function(t){this.renderItem(t,e.name)}),this)},getElementById:function(e){return this.getInstance().findNode(e)},getSvgElementById:function(e){return this.getInstance()._svg.getElementById(e)},addCls:function(e,t){var r=e.classList;r.add.apply(r,t)},getSelectedItem:function(){return this.getInstance().selectionList[0]},iterateItemChildrens:function(e,t,r){e.children&&e.children.forEach((function(e,n){"string"==typeof e&&(e=this.getElementById(e)),t.call(r,e,n)}),this)},getItemBounds:function(e,t){var r=e.name,n=this.itemsBounds[r];if(n&&!0!==t)return n;var i=ej.Diagram.Util.bounds(e),a=i.x,s=i.y;return e.labels.forEach((function(t){if(t.text){var r=this.getSvgElementById(e.name+"_"+t.name);if(r){var n=this.utils.svg.getSvgElTranslateValues(r,["e","f"]),o=t.bBox;o||(o=t.bBox=r.getBBox());var l=o.width,c=o.height,u=a+n.e-l/2,h=this.getSvgElementById(e.name+"_"+t.name+"_lblbg"),f=this.utils.svg.getSvgElTranslateValues(h,["f"]),d=s+f.f,p=ej.Diagram.Rectangle(u,d,l,c);i=ej.Diagram.Geometry.union(i,p)}}}),this),!1===e.isContainer&&this.iterateItemChildrens(e,(function(e){var t=this.getItemBounds(e);i=ej.Diagram.Geometry.union(i,t)}),this),this.itemsBounds[r]=i,i},removeItemBoundsCache:function(e){if(e&&(delete this.itemsBounds[e.name],e.parent)){var t=this.getElementById(e.parent);this.removeItemBoundsCache(t)}},disableDiagramFeatures:function(){ej.Diagram.prototype._handleMouseWheel=Ext.emptyFn,ej.Diagram.prototype._onContextMenuOpen=Ext.emptyFn,ej.Diagram.prototype._initContextMenu=Ext.emptyFn,ej.Diagram.prototype._renderContextMenu=Ext.emptyFn,ej.Diagram.prototype._createScrollbar=Ext.emptyFn},customizeMouseMove:function(){var e="#"+this.renderToSelector;if(!Terrasoft.Diagram.custom.enableAutoScroll){var t=ej.Diagram.prototype.enableAutoScroll;ej.Diagram.prototype.enableAutoScroll=function(){if(arguments.length>0&&"customized"===arguments[0])return!0;t.apply(this,arguments)},Terrasoft.Diagram.custom.enableAutoScroll=!0}if(!Terrasoft.Diagram.custom._mousemove){var r=ej.Diagram.prototype._mousemove;ej.Diagram.prototype._mousemove=function(t){if(r.apply(this,arguments),this.activeTool.inAction&&this.enableAutoScroll("customized")){var n=200,i=10,a=10,s=ej.Diagram.ScrollUtil._viewPort(this),o=this._mousePosition(t,!0),l=this.model.pageSettings.autoScrollBorder,c=$(e),u=function(e,t){this.canvasBBox=null,this._canAutoScroll||(this._canAutoScroll=!0,this._beginAutoScrollDelay=n,this._beginAutoScroll(e,t)),this._beginAutoScrollDelay-=i}.bind(this),h=c.scrollLeft(),f=c.scrollTop();if(o.x-h+l.right>=s.width-a){if(this.activeTool.previousPoint&&o.x<this.activeTool.previousPoint.x)return void(this._canAutoScroll=!1);u("right",t)}else if(o.x-h<=l.left){if(this.activeTool.previousPoint&&o.x>this.activeTool.previousPoint.x)return void(this._canAutoScroll=!1);u("left",t)}else if(o.y-f+l.bottom>=s.height-a){if(this.activeTool.previousPoint&&o.y<this.activeTool.previousPoint.y)return this._canAutoScroll=!1,void(this._autoScrollStartPoint=null);u("bottom",t)}else if(o.y-f<=l.top){if(this.activeTool.previousPoint&&o.y>this.activeTool.previousPoint.y)return void(this._canAutoScroll=!1);u("top",t)}else this._canAutoScroll=!1}},Terrasoft.Diagram.custom._mousemove=!0}},customizeUpdateSelectionOnScroll:function(){if(!Terrasoft.Diagram.custom._updateSelectionOnScroll){var e=ej.Diagram.prototype._updateSelectionOnScroll;ej.Diagram.prototype._updateSelectionOnScroll=function(t,r){var n=this.activeTool;if("move"===n.name&&n.helper)return n._updateHelperXY(n.helper,n.previousPoint,n.currentPoint),ej.Diagram.SvgContext._updateContainerHelper(this),n.currentPoint=ej.Diagram.Point(n.currentPoint.x+t,n.currentPoint.y+r),this._translate(n.helper,t,r,this.nameTable),void(n.previousPoint=ej.Diagram.Point(n.currentPoint.x,n.currentPoint.y));e.apply(this,arguments)},Terrasoft.Diagram.custom._updateSelectionOnScroll=!0}},customizeBeginAutoScroll:function(){if(!Terrasoft.Diagram.custom._beginAutoScroll){var e="#"+this.renderToSelector;ej.Diagram.prototype._beginAutoScroll=function(t,r){var n=this._beginAutoScrollDelay>0?this._beginAutoScrollDelay:0,i=this,a=0,s=0;if(this._canAutoScroll){var o=$(e),l=o.scrollLeft(),c=o.scrollTop();switch(t){case"right":a=10,o.scrollLeft(l+a);break;case"left":if(0===l)return;a-=10,o.scrollLeft(l+a);break;case"top":if(0===c)return;s-=10,o.scrollTop(c+s);break;case"bottom":s=10,o.scrollTop(c+s)}setTimeout((function(){i._raiseEvent("autoScrollChange",{delay:n}),i._updateScrollBar(a,s,t,r)}),n)}},Terrasoft.Diagram.custom._beginAutoScroll=!0}},customizeSetScrollContentSize:function(){var e=this.rightScrollContentOffset,t=this.bottomScrollContentOffset;ej.Diagram.ScrollUtil._setScrollContentSize=function(r){if(!0!==r.disableSetScrollContentSize){r.viewPortSize=null;var n=ej.Diagram.ScrollUtil._viewPort(r);n=ej.Diagram.Rectangle(r._hScrollOffset,r._vScrollOffset,n.width,n.height);var i=r._spatialSearch.pageLeft,a=r._spatialSearch.pageRight,s=r._spatialSearch.pageTop,o=r._spatialSearch.pageBottom,l=ej.Diagram.Rectangle(0,0,0,0);l=this._union(l,ej.Diagram.Rectangle(0,0,n.width,n.height)),l=this._union(l,ej.Diagram.Geometry.rect([{x:i,y:s},{x:a,y:o}]));var c=r.activeTool,u=l.width,h=l.height;if(c&&"move"===c.name&&c.helper){var f=c.helper;c.currentPoint.x>u&&(u=f.offsetX+f.width),c.currentPoint.y>h&&(h=f.offsetY+f.height)}u>n.width&&(u+=e),h>n.height&&(h+=t),ej.Diagram.SvgContext.setSize(r._svg,u,h)}}},customizeContainerMouseMove:function(){var e=this;if(ej.Diagram.MoveTool.prototype._containerMouseMove=function(){var e=this.helper;if(e)this._updateHelperXY(e,this.previousPoint,this.currentPoint),ej.Diagram.SvgContext._updateContainerHelper(this.diagram);else{(e=this.helper=this._getCloneNode(this.selectedObject)).name="helper",e.labels=[];var t=ej.Diagram.Util.bounds(this.selectedObject);e.offsetX=t.center.x+this.currentPoint.x-this.previousPoint.x,e.offsetY=t.center.y+this.currentPoint.y-this.previousPoint.y,ej.Diagram.SvgContext._drawContainerHelper(this.diagram),"pseudoGroup"!==this.selectedObject.type&&this._renderHelper()}},!Terrasoft.Diagram.custom._endAction){var t=ej.Diagram.MoveTool.prototype._endAction;ej.Diagram.MoveTool.prototype._endAction=function(){if(this.helper){var r=this.selectedObject;if("pseudoGroup"!==r.type){var n=this.diagram,i=this.startPoint,a=this.currentPoint,s=a.x<i.x,o=a.y<i.y,l=e.getItemBounds(r);if(s){var c=Math.ceil(a.x);Math.abs(c)<=l.width&&(a.x=Math.ceil(l.width/2))}if(o){var u=Math.ceil(a.y);Math.abs(u)<=l.height&&(a.y=Math.ceil(l.height/2))}this._updateXY(r,i,a),ej.Diagram.DiagramContext.update(r,n),n._renderTooltip(r),this._updateSelection(),n._updateSelectionHandle(!0)}}t.apply(this,arguments)},Terrasoft.Diagram.custom._endAction=!0}},customizeRemoveChildParent:function(){var e=ej.Diagram.MoveTool.prototype._removeChildParent;ej.Diagram.MoveTool.prototype._removeChildParent=function(t){"pseudoGroup"!==t.type&&e.apply(this,arguments)}},customizeDiagram:function(){this.customizeMouseMove(),this._customizeWrapTextAlign(),this.customizeUpdateSelectionOnScroll(),this.customizeBeginAutoScroll(),this.customizeSetScrollContentSize(),this.customizeContainerMouseMove(),this.customizeRemoveChildParent(),this.customizeSvgImage(),this.customizeDisConnect(),this.customizeRemoveConnector(),this.customizeRecordPinPointChanged(),this.customizeRecordRotationChanged(),this.customizeRecordSizeChanged();var e=this,t=ej.Diagram.SvgContext;t.updateUserHandles=function(t,r,n,i,a,s){if(t&&t.length>0)for(var o=0;o<t.length;o++){var l=t[o];r.toolsConstraint&l.constraint&&((i&&l.enableMultiSelection||!i)&&(l.upateHandle?l.upateHandle.call(this,l,r,n,a,s,e):this._updateHandle(l,r,n,a,s)))}},t.renderUserHandles=function(t,r,n,i,a,s){for(var o=0;o<t.length;o++)if(i&&t[o].enableMultiSelection||!i){var l=t[o];if(l.visible&&r.toolsConstraint&l.constraint){if(l.tool&&l.tool.test&&!l.tool.test(r))continue;l.renderUserHandle?l.renderUserHandle.call(this,l,r,n,a,s,e):this._renderUserHandle(l,r,n,a,s)}}};var r=t._updateConnector;t._updateConnector=function(e,t,n){r.apply(this,arguments);var i=this._findPath(e,n);t.path({id:e.name+"_segments_selection",d:i})};var n=this.connectorPortColor,i=this.portRadius;t._renderOrthogonalThumb=function(e,t,r,a,s){var o=a.getElementById(a.document.id+"handle_g"),l={id:e,class:"segmentEnd",fill:n,r:i,stroke:n,transform:"translate("+t+","+r+")",visibility:s};o.appendChild(a.circle(l))},t._updateOrthoThumb=function(e,t,r,n,i){var a={id:e,visibility:i,transform:"translate("+t+","+r+")"};n.circle(a)},t._updateEndPointCorner=function(e,t,r,n,i,a){var s=n?"#aad4ff":"white";a||(s="darkgray");var o={id:e,fill:s,cx:t,cy:r};i.circle(o)},t._renderEndPointCorner=function(e,t,r,a,s,o){var l=s.getElementById(s.document.id+"handle_g"),c=a?"#FFFFFF":"rgba(0,0,0,0)";o||(c="darkgray");var u={id:e,class:e,opacity:a?.75:0,fill:c,stroke:a?n:"rgba(0,0,0,0)","stroke-width":1,cx:t,cy:r,r:i};l.appendChild(s.circle(u))};var a=t._getHandlePosition;t._getHandlePosition=function(e,t,r){var n=e.position;if("object"===_typeof(n)){var i=ej.Diagram.Point(),s=ej.Diagram.Util.bounds(t);return i.x=s.center.x+n.x,i.y=s.center.y+n.y,i}return a(e,t,r)},t._renderLabelBackground=function(t,r,n,i){return e.utils.labelUtils.getLabelBackgroundEl({label:t,node:r,textNode:n,svg:i})},t.updateGroup=function(e,t,r,n){if(e.nodeType!==Terrasoft.diagram.UserHandlesConstraint.Lane){var i=e.visible?"visible":"hidden",a="display:block;";if(e.visible||(a="display:none;"),t.g({id:e.name,visibility:"visible",style:"display:block"}),"pseudoGroup"===e.type)for(var s=r._getChildren(e.children),o=0,l=s.length;o<l;o++){var c=r.nameTable[s[o]];c&&("group"===c.type?this.updateGroup(c,t,r,n):c.segments?this.updateConnector(c,t,r):this.updateNode(c,t,r,n))}t.g({id:e.name,visibility:i,style:a}),this._updateGoupBackground(e,t),this._updateAssociatedConnector(e,t,r),this._updateLabels(e,t),this._updatePorts(e,t);var u=r.model.phases;if(e.isSwimlane&&u&&u.length>0)for(var h=null,f=0;f<u.length;f++)(h=u[f]).parent===e.name&&this._updatephase(h,r)}};var s=t._renderFilter;t._renderFilter=function(e,t){if(e.constraints&ej.Diagram.NodeConstraints.Shadow){var r=t.getElementById(e.name+"_filter");if(!r)return s.apply(this,arguments)}},t._enableSelectedNode=Ext.emptyFn,t._disableSelectedNode=Ext.emptyFn;var o=t._renderPort;if(t._renderPort=function(e,t,r){var n=e.name+"_"+t.name,i=r.getElementById(n);return i||o.apply(this,arguments)},t.updateNode=function(e,t,r){var n,i;if("html"===e.shape.type&&"msie"===ej.browserInfo().name?i={x:(n=document.getElementById(e.name+"_html").getBoundingClientRect()).left,y:n.top,width:n.width,height:n.height}:n=t.getElementById(e.name+"_shape"),n&&!i&&(i=ej.Diagram.Util.bounds(e)),this._updateNode(e,t),!r._layoutInAction){this._updateAssociatedConnector(e,t,r);var a=r.activeTool;(!a.inAction||"move"!==a.name&&"rotate"!==a.name)&&(this._updateLabels(e,t),i&&(i&&i.width!==e.width||i.height!==e.height)&&this._updatePorts(e,t))}},!Terrasoft.Diagram.custom._addSelection){var l=ej.Diagram.prototype._addSelection;ej.Diagram.prototype._addSelection=function(){if(!0!==this.disableDefaultSelection)return l.apply(this,arguments)},Terrasoft.Diagram.custom._addSelection=!0}if(!Terrasoft.Diagram.custom._updateCursor){var c=ej.Diagram.prototype._updateCursor;ej.Diagram.prototype._updateCursor=function(){this.cursor!==this._currentCursor&&(this.cursor=this._currentCursor,c.apply(this,arguments))},Terrasoft.Diagram.custom._updateCursor=!0}Terrasoft.Diagram.custom._mousePosition||(ej.Diagram.prototype._mousePosition=function(e,t){var r=this._isTouchEvent(e),n=this.canvasBBox;null==n&&(n=this.canvasBBox=this._canvas.getBoundingClientRect());var i=r.clientX+0-n.left,a=0+r.clientY-n.top;return t||(i=(i+this._hScrollOffset)/this._currZoom,a=(a+this._vScrollOffset)/this._currZoom),new ej.Diagram.Point(Math.round(100*i)/100,Math.round(100*a)/100)},Terrasoft.Diagram.custom._mousePosition=!0),ej.Diagram.ScrollUtil._viewPort=function(e){var t=e.viewPortSize;if(null!=t)return t;var r=e.element[0],n=Math.floor($(r)[0].getBoundingClientRect().width),i=$(r).height(),a=e.element[0].getBoundingClientRect(),s=window.screenX<0?-1*window.screenX:window.screenX;0===n&&(n=Math.floor(window.innerWidth-s-Math.floor(a.left)));var o=window.screenY<0?-1*window.screenY:window.screenY;return 0===i&&(i=Math.floor(window.innerHeight-o-Math.floor(a.top))),t=e.viewPortSize=ej.Diagram.Size(n,i)},ej.Diagram.ScrollUtil._transform=function(e,t,r,n){ej.Diagram.SvgContext.transformView(e,-t,-r),n&&ej.Diagram.SvgContext.scaleContent(e,e._currZoom),ej.Diagram.PageUtil._updatePageSize(e),ej.Diagram.SvgContext._updateBackground(t,r,e._currZoom,e),ej.Diagram.SvgContext._updateGrid(t,r,e._currZoom,e)},Terrasoft.Diagram.custom._updateScrollOffset||(ej.Diagram.prototype._updateScrollOffset=function(e,t,r){ej.Diagram.ScrollUtil._transform(this,e,t,r);var n=this;this._views.forEach((function(r){if("overview"===n._views[r].type){var i=$("#"+r).ejOverview("instance");i&&i._scrollOverviewRect(e,t,n._currZoom)}}))},Terrasoft.Diagram.custom._updateScrollOffset=!0),ej.Diagram.Util.removeItem=function(e,t){for(var r;(r=e.indexOf(t))>=0;)e.splice(r,1)};var u=this;ej.Diagram.Util._rotateChildBounds=function(e){var t=u.getItemBounds(e,!0);return t.x-10>0&&t.y-10>0&&(t.x-=10,t.y-=10,t.height+=20,t.width+=20),t}},_customizeWrapTextAlign:function(){ej.Diagram.SvgContext._wrapTextAlign=this.utils.labelUtils.wrapTextAlign},setDefaults:function(){Ext.apply(ej.Diagram.PortDefaults,this.portDefaultsConfig),Ext.apply(ej.Diagram.NodeBaseDefaults,this.nodeBaseDefaultsConfig)},init:function(){this.callParent(arguments),this.renderToSelector="diagram-"+this.id,this.svgContainerSelector=this.renderToSelector+"_canvas_svg",this.customizeDiagram(),this.customizeRenderNode(),this.disableDiagramFeatures(),this.setDefaults()},getNodeDataItemMarker:function(e){var t=e.name;return Ext.isEmpty(e.labels)||Ext.isEmpty(e.labels[0].text)||(t+=" "+e.labels[0].text),t},customizeRenderNode:function(){var e=this,t=ej.Diagram.SvgContext,r=t.renderNode;t.renderNode=function(t,n){r.apply(this,arguments);var i=e.getNodeDataItemMarker(t);n.g({id:t.name+"_shape","data-item-marker":i})}},getInstance:function(){var e=this.diagram;return this.isDiagramLoaded()&&(e=this.diagram=$("#diagram-"+this.id).ejDiagram("instance")),e},getWidth:function(){return this.getInstance()._svg.document.getBBox().width},getHeight:function(){var e=$(window).height()-$("#diagram-"+this.id).offset().top;return Math.max(this.minHeight,e)},setConteinerAutoOverflow:function(){var e=Ext.get("diagram-"+this.id);e.setStyle("overflow",this.overflow),e.on("scroll",this.onScroll,this)},onScroll:function(){this.getInstance().canvasBBox=null},isDiagramLoaded:function(){return $("#diagram-"+this.id).hasClass("e-datavisualization-diagram")},clearDiagram:function(){this.isDiagramLoaded()&&(this.getInstance().clear(),Ext.isIE&&Ext.select('[class="htmlLayer"] > *').remove())},setPortsVisibility:function(e,t,r){for(var n,i,a=t.ports||[],s=a.length,o=r?"hidden":"visible",l=0;l<s;++l)((i=a[l]).visibility&ej.Diagram.PortVisibility.Hover||i.visibility&ej.Diagram.PortVisibility.Connect)&&(n=e._svg.getElementById(t.name+"_"+i.name))&&n.setAttribute("visibility",o)},getUserHandles:function(){return[]},createPorts:function(e){return e.map((function(e){return{name:e.name,offset:e.offset}}))},getNodes:function(){return this.items.filterByFn(this.isItemNode,this).getItems()},getConnectors:function(){return this.items.filterByFn(this.isItemConnector,this).getItems()},getDiagramConfig:function(){var e=this.getNodes(),t=[];e&&e.length>0&&(t=this.getConnectors());var r={renderTo:"#diagram-"+this.id,diagram:{nodes:e,connectors:t,selectedItems:{userHandles:this.getUserHandles()},constraints:ej.Diagram.DiagramConstraints.Default|ej.Diagram.DiagramConstraints.Zoomable,snapSettings:{enableSnapToObject:!0,snapConstraints:ej.Diagram.SnapConstraints.SnapToLines},selectorConstraints:ej.Diagram.SelectorConstraints.UserHandles|ej.Diagram.SelectorConstraints.Resizer,enableVisualGuide:!1,defaultSettings:{connector:{constraints:this.connectorConstraints,segments:[{type:"orthogonal"}]}},showTooltip:!1,pageSettings:{scrollLimit:"diagram",autoScrollBorder:this.autoScrollBorder},width:"100%",height:this.getHeight()}};return Ext.isIE&&Ext.apply(r.diagram.snapSettings,{enableSnapToObject:!1,snapObjectDistance:1,horizontalGridLines:{snapInterval:[1]},verticalGridLines:{snapInterval:[1]}}),r},initDiagram:function(){this.cancelDiagramEvents=!0;var e=this.getDiagramConfig();this.clearDiagram(),$(e.renderTo).ejDiagram(Ext.apply(e.diagram,{nodeCollectionChange:this.onNodesCollectionChange.bind(this),connectorCollectionChange:this.onConnectorsCollectionChange.bind(this),itemClick:this.onItemClick.bind(this),click:this.onClick.bind(this),doubleClick:this.onDoubleClick.bind(this),textChange:this.onTextChange.bind(this),drag:this.onDrag.bind(this)})),this.autoScroll&&this.setConteinerAutoOverflow();var t=this.getInstance();Terrasoft.isEmptyObject(this.diagramSnap)||t.load(this.diagramSnap);var r=this;t._on($(window),"resize",(function(){var e=document.getElementById(this._id),t=r.getHeight();$(e).height(t),this._svg.document.setAttribute("height",t),this._updateScrollOffset(0,0)}));var n=$(t._canvas);t._on(n,ej.eventType.mouseUp,this.onDiagramMouseUp.bind(this)),t._on(n,ej.eventType.mouseMove,this.onDiagramMouseMove.bind(this)),t.model.selectionChange=this.onSelectionChange.bind(this),t.model.connectionChange=this.onConnectionChange.bind(this),this.initConnectorRemovalMixin()},initConnectorRemovalMixin:function(){this.mixins.connectorRemoval.init(this.getInstance())},nodeTemplate:Ext.emptyFn,connectorTemplate:Ext.emptyFn,onSelectionChange:function(e){var t,r,n,i=e.element;i&&"insert"===e.changeType&&(t=Ext.isArray(i)&&i.length>0?i[0].name:i.name);var a=this.getInstance(),s=a._svg,o=a.model,l=o.connectors;for(n=l.length,r=0;r<n;r++){var c=l[r],u=c.name===t;this.updateConnectorSelection(s,c,u)}this.setPortsVisibilityOnSelectionChange(e,a,o.nodes),this.fireEvent("selectionChange",e)},setPortsVisibilityOnSelectionChange:function(e,t,r){var n,i=e.element;i&&(n=i.name);for(var a=r.length,s=0;s<a;s++){var o=r[s];this.setPortsVisibility(t,o,o.name!==n)}},updateConnectorSelection:function(e,t,r){var n=t.name,i=e.path({id:n+"_segments"}),a={id:n+"_segments_selection",fill:"none",color:r?this.selectionColor:this.connectorLineColor,"stroke-width":1,"stroke-opacity":r?13:0,d:i.attributes.getNamedItem("d").value};i.parentNode.appendChild(e.path(a))},onConnectionChange:function(e){var t=e.element,r=e.connection,n=e.port;if(t&&r&&n){var i="sourceEndPoint"===e.endPoint,a=i?"sourceNode":"targetNode",s=i?t.sourcePort:t.targetPort,o=n.name;if(t[a]===r.name&&s===o)return;this.fireEvent("connectorsNodesChange",[{changedProperty:a,connectorName:t.name,nodeName:r.name,port:o}])}},onDoubleClick:function(e){e.cancel=!0,this.fireEvent("doubleClick",e)},onTextChange:function(e){this.fireEvent("textChange",e)},onClick:function(e){this.fireEvent("click",e)},onItemClick:function(e){this.fireEvent("itemClick",e)},onDiagramMouseUp:function(e){Ext.select(".hitTest").set({"pointer-events":"stroke"}),this.fireEvent("mouseUp",e)},onDiagramMouseMove:function(e){this.fireEvent("mouseMove",e)},onDrag:function(e){this.fireEvent("drag",e)},onNodesCollectionChange:function(e){this.onDiagramItemsChange(e),this.fireEvent("nodesCollectionChange",e)},onConnectorsCollectionChange:function(e){this.onDiagramItemsChange(e),this.fireEvent("connectorsCollectionChange",e)},onDiagramItemsChange:function(e){if("remove"===e.changeType){var t=e.element,r=this.items;r.collection.rebuildIndexMap();var n=t.name;r.contains(n)&&r.removeByKey(n)}},linkConnectors:function(e,t){var r=[],n=this,i=t||[];function a(e,t){var i=n.getElementById(e);i&&r.push({changedProperty:t,connectorName:e,nodeName:i[t]})}(e||[]).forEach((function(e){a(e,"targetNode")}),this),i.forEach((function(e){a(e,"sourceNode")}),this),this.fireEvent("connectorsNodesChange",r)},bind:function(e){this.mixins.bindable.bind.call(this,e)},reRender:function(){this.allowRerender()&&this.callParent(arguments)},onAfterRender:function(){this.callParent(arguments),this.afterRenderOrAfterReRender()},onAfterReRender:function(){this.callParent(arguments),this.diagram=null,this.afterRenderOrAfterReRender()},afterRenderOrAfterReRender:function(){this.initDiagram(),this.cancelDiagramEvents=!1},updatePageSize:function(){var e=this.getInstance();ej.Diagram.PageUtil._updatePageSize(e)},subscribeForCollectionEvents:function(e,t,r){this.callParent(arguments);var n=r.get(e.modelItem);n.on("dataLoaded",this.onCollectionDataLoaded,this),n.on("add",this.onAddItem,this),n.on("remove",this.onRemoveItem,this),n.on("clear",this.clearDiagram,this)},unSubscribeForCollectionEvents:function(e,t,r){if(r){var n=r.get(e.modelItem);n.un("dataLoaded",this.onCollectionDataLoaded,this),n.un("add",this.onAddItem,this),n.un("remove",this.onRemoveItem,this),n.un("clear",this.clearDiagram,this),this.callParent(arguments)}},onCollectionDataLoaded:function(e,t){if((e=t||e)&&e.getCount()>0){var r,n=this.isDiagramLoaded();n&&((r=this.getInstance()).disableSetScrollContentSize=!0,r.disableDefaultSelection=!0);var i=this.items;i.suspendEvents(!1),e.each((function(e){this.onAddItem(e,!0)}),this),i.resumeEvents(),n&&(r.disableSetScrollContentSize=!1,r.disableDefaultSelection=!1,ej.Diagram.ScrollUtil._setScrollContentSize(r))}},isItemConnector:function(e){return!(!e.sourceNode&&!e.sourcePoint)},isItemNode:function(e){return!this.isItemConnector(e)},onAddItem:function(e,t){if(this.isDiagramLoaded()){if(this.isItemConnector(e))this.connectorTemplate(e);else{if(e.offsetX=e.offsetX+this.diagram._hScrollOffset,e.offsetY=e.offsetY+this.diagram._vScrollOffset,e.constraints=e.constraints||this.nodeConstraints,e.constraints&ej.Diagram.NodeConstraints.Connect){var r=e.portsSet?e.portsSet:Terrasoft.diagram.PortsSet.All;e.ports=this.createPorts(r)}this.nodeTemplate(e)}this.addItem(e,t)}},addItem:function(e){this.isDiagramLoaded()&&this.getInstance().add(e)},onRemoveItem:function(e){if(this.isDiagramLoaded()){var t=this.getElementById(e.name),r=null,n=null,i=t.type;"node"===i&&(r=t.inEdges,n=t.outEdges),this.getInstance().remove(t),"node"===i&&this.linkConnectors(r,n)}},onDestroy:function(){this.callParent(arguments),this.diagram&&this.diagram.destroy(),this.diagram=null,this.svgContextSnap&&(ej.Diagram.SvgContext=Terrasoft.deepClone(this.svgContextSnap),this.svgContextSnap=null)},customizeSvgImage:function(){ej.Diagram.Svg.prototype.image=function(e){var t=this.element(e,"image");Ext.isGecko&&Ext.fly(t).on("click",(function(e){!0!==e.ctrlKey&&!0!==e.shiftKey||e.preventDefault()}));return t}},customizeDisConnect:function(){if(!Terrasoft.Diagram.custom._disConnect){var e=this.mixins.connectorRemoval;ej.Diagram.prototype._disConnect=function(t,r,n){e.disconnect(t,r,n)}}},customizeRemoveConnector:function(){if(!Terrasoft.Diagram.custom._removeConnector){var e=this.mixins.connectorRemoval;ej.Diagram.prototype._removeConnector=function(t,r){e.removeConnector(t,r)},Terrasoft.Diagram.custom._removeConnector=!0}},customizeRecordPinPointChanged:function(){if(!Terrasoft.Diagram.custom._recordPinPointChanged){var e=ej.Diagram.prototype._recordPinPointChanged;ej.Diagram.prototype._recordPinPointChanged=function(t){t.object.node&&e.apply(this,arguments)}}},customizeRecordRotationChanged:function(){if(!Terrasoft.Diagram.custom._recordRotationChanged){var e=ej.Diagram.prototype._recordRotationChanged;ej.Diagram.prototype._recordRotationChanged=function(t){t.object.node&&e.apply(this,arguments)}}},customizeRecordSizeChanged:function(){if(!Terrasoft.Diagram.custom._recordSizeChanged){var e=ej.Diagram.prototype._recordSizeChanged;ej.Diagram.prototype._recordSizeChanged=function(t){t.object.node&&e.apply(this,arguments)}}}}),Ext.define("Terrasoft.controls.MappingEdit",{extend:"Terrasoft.controls.BaseEdit",alternateClassName:"Terrasoft.MappingEdit",mixins:{menuMixin:"Terrasoft.MenuMixin",rightIcon:"Terrasoft.RightIcon"},enableRightIcon:!0,rightIconClasses:["mapping-edit-right-icon"],hasClearIcon:!0,allowInlineEditing:!1,value:null,onClick:function(){this.enabled&&(!this.getAllowInlineEditing()&&(this.menu?this.showMenu(this.rightIconWrapperEl):this.openEditWindow()))},onRightIconClick:function(){this.enabled&&(this.menu?this.showMenu(this.rightIconWrapperEl):this.openEditWindow())},init:function(){this.callParent(arguments),this.addEvents("openEditWindow"),this.mixins.menuMixin.init.call(this)},combineClasses:function(){var e=this.callParent(arguments);return e.wrapClass.push("mapping-edit"),e},initDomEvents:function(){this.callParent(arguments),this.on("rightIconClick",this.onRightIconClick,this);var e=this.getEl();e.on("click",this.onClick,this)},bind:function(){this.callParent(arguments),this.mixins.menuMixin.bindMenu.call(this,this.model)},onDestroy:function(){this.removeMenu(!0),this.callParent(arguments)},onMenuItemsChange:Terrasoft.emptyFn,changeValue:function(e){var t=this.value,r=!Ext.Object.equals(t,e);if(r){this.value=e;var n=Terrasoft.deepClone(e);this.fireEvent("change",n,this)}var i=!this.getAllowInlineEditing();return this.setReadonly(i),this.setClearIconVisibility(),r},setValue:function(e){if(this.changeValue(e)&&this.rendered){var t=e?e.displayValue:"";this.restoreWrongReference(),this.setDomValue(t)}},getInitValue:function(){var e=this.value,t=e?e.displayValue:"";return t?Terrasoft.encodeHtml(t):""},onBlur:function(){this.enabled&&this.rendered&&(!this.readonly&&Ext.isObject(this.value)&&this.setConstValue(),this.focused=!1,this.fireEvent("blur",this),this.fireEvent("focusChanged",this))},onEnterKeyPressed:function(){if(this.enabled&&this.rendered){var e=!1;!this.readonly&&Ext.isObject(this.value)&&(e=this.setConstValue()),this.fireEvent("enterkeypressed",this),e||this.fireEvent("editenterkeypressed",this)}},onFocus:function(){if(this.callParent(arguments),this.enabled&&this.rendered&&this.getAllowInlineEditing()){var e=this.getEl();e&&e.dom&&e.dom.value&&e.dom.select()}},getIsHidden:function(){var e=this.getInitValue();return Ext.isEmpty(e)||!this.enabled},setConstValue:function(){var e=Ext.clone(this.value),t=this.getTypedValue()||null;return e.value=e.displayValue=t,e.source=null==t?Terrasoft.ProcessSchemaParameterValueSource.None:Terrasoft.ProcessSchemaParameterValueSource.ConstValue,this.changeValue(e)},openEditWindow:function(){this.fireEvent("openEditWindow",this.tag,this.value)},getDisplayValue:function(e){var t=e?e.displayValue:"";return t?Terrasoft.encodeHtml(t):""},getAllowInlineEditing:function(){var e=this.value,t=!1;return e&&(t=!(!Ext.isEmpty(e.value)||!this.allowInlineEditing)||!!this.isConstSourceValue(e)&&this.isAllowInlineEditDataValueType(e.dataValueType)),t},isConstSourceValue:function(e){var t=e.source,r=Terrasoft.ProcessSchemaParameterValueSource;return t===r.None||t===r.ConstValue},isAllowInlineEditDataValueType:function(e){return Terrasoft.isNumberDataValueType(e)||Terrasoft.isTextDataValueType(e)||e===Terrasoft.DataValueType.METADATA_TEXT},restoreWrongReference:function(){this.el&&(document.getElementById(this.id+"-el")!==this.el.dom&&(this.el=Ext.get(this.id+"-el")))},onClearIconClick:function(){if(this.enabled){var e={value:null,displayValue:null,source:Terrasoft.ProcessSchemaParameterValueSource.None,dataValueType:this.value.dataValueType,referenceSchemaUId:this.value.referenceSchemaUId||null};this.setValue(e),this.fireEvent("cleariconclick",this)}}}),Ext.ns("Terrasoft.model"),Ext.define("Terrasoft.model.SysSettingViewModel",{extend:"Terrasoft.BaseViewModel",alternateClassName:"Terrasoft.SysSettingViewModel",insertRequestClassName:"Terrasoft.InsertSysSettingRequest",updateRequestClassName:"Terrasoft.UpdateSysSettingRequest",deleteRequestClassName:"Terrasoft.DeleteSysSettingRequest",saveEntity:function(e,t){if(this.validate()){var r=this.isNew?this.insertRequestClassName:this.updateRequestClassName,n=Ext.create(r,{id:this.get(this.primaryColumnName)});Terrasoft.each(n.propertyColumnName,(function(e,t){n[t]=this.get(e)}),this),n.execute((function(r){e.call(t,r)}),this)}},deleteEntity:function(e,t){Ext.create(this.deleteRequestClassName,{primaryColumnValues:[this.get(this.primaryColumnName)]}).execute((function(r){e.call(t,r)}),this)}}),Ext.define("Terrasoft.mixins.ReorderableItemVMMixin",{alternateClassName:"Terrasoft.ReorderableItemVMMixin",preInit:function(){this.initAttribute()},initAttribute:function(){var e=this.columns;e.ReorderableModel=e.ReorderableModel||{type:Terrasoft.core.enums.ViewModelColumnType.VIRTUAL_COLUMN,caption:"ReorderableModel",dataValueType:Terrasoft.core.enums.DataValueType.CUSTOM_OBJECT},e.Name=e.Name||{type:Terrasoft.core.enums.ViewModelColumnType.VIRTUAL_COLUMN,caption:"Name",dataValueType:Terrasoft.core.enums.DataValueType.TEXT},e.Id=e.Id||{type:Terrasoft.core.enums.ViewModelColumnType.VIRTUAL_COLUMN,caption:"Id",dataValueType:Terrasoft.core.enums.DataValueType.TEXT}}}),Ext.define("Terrasoft.core.CoreServiceProvider",{extend:"Terrasoft.BaseServiceProvider",alternateClassName:"Terrasoft.CoreServiceProvider",singleton:!0,serviceUrl:"ServiceModel",getRequestUrl:function(e){return Terrasoft.combinePath(Terrasoft.workspaceBaseUrl,this.serviceUrl,e)}}),Ext.define("Terrasoft.core.BaseCoreRequest",{alternateClassName:"Terrasoft.BaseCoreRequest",extend:"Terrasoft.BaseRequest",serviceName:"",serviceMethod:"",data:null,getRequestConfig:function(){var e=this.callParent(arguments);return Ext.apply(e,{serverMethod:Terrasoft.combinePath(this.serviceName,this.serviceMethod),data:this.data||this})},validate:function(){if(!this.serviceName)throw new Terrasoft.NullOrEmptyException({message:"serviceName"});if(!this.serviceMethod)throw new Terrasoft.NullOrEmptyException({message:"serviceMethod"});return!0},constructor:function(){this.callParent(arguments),this.serviceProvider=Terrasoft.CoreServiceProvider}}),Ext.define("Terrasoft.core.WebSocketMaintenance",{extend:"Terrasoft.BaseObject",alternateClassName:"Terrasoft.WebSocketMaintenance",singleton:!0,constructor:function(){this.callParent(arguments),this._trySchedulePingWebSocketConnection()},_trySchedulePingWebSocketConnection:function(){if(Terrasoft&&void 0!==Terrasoft.useWebSocketKeepAlive){if(Terrasoft.useWebSocketKeepAlive){setInterval(this._pingWebSocketConnection,3e4),console.info("WebSocketMaintenance: WebSocket connection ping scheduled for every [30] sec")}}else setTimeout(this._trySchedulePingWebSocketConnection.bind(this),5e3)},_pingWebSocketConnection:function(){Terrasoft.ServerChannel.isOpened?Terrasoft.ServerChannel.ping():console.warn("WebSocketMaintenance: ServerChannel is not opened")}}),Ext.define("Terrasoft.core.SessionEndUserNotification",{extend:"Terrasoft.BaseObject",alternateClassName:"Terrasoft.SessionEndUserNotification",singleton:!0,sessionExpired:!1,constructor:function(){this.callParent(arguments),this._trySubsribeOnServerChannelMessage()},_trySubsribeOnServerChannelMessage:function(){Terrasoft&&void 0!==Terrasoft.showSessionEndNotification?Terrasoft.showSessionEndNotification&&Terrasoft.ServerChannel.on(Terrasoft.EventName.ON_MESSAGE,this._handleServerChannelMessage,this):window.setTimeout(this._trySubsribeOnServerChannelMessage.bind(this),5e3)},_handleServerChannelMessage:function(e,t){if(t&&"WebApp"===t.Header.Sender&&"SessionEnd"===t.Header.BodyTypeName){var r;try{r=JSON.parse(t.Body)}catch(e){return void this.error("[SessionEnd]. Error occured. Message = ["+t.Body+"]")}var n=Terrasoft.sessionId,i=r.SessionId;this.log("[SessionEnd]. Current = ["+n+"]. Received = ["+i+"]"),n&&i!==n||(Terrasoft.ServerChannel.un(Terrasoft.EventName.ON_MESSAGE,this._handleServerChannelMessage,this),this.sessionExpired=!0,this._logout())}},_logout:function(){var e={buttons:[{className:"Terrasoft.Button",caption:Terrasoft.Resources.SessionEndUserNotification.ConfirmationButtonCaption}]};Terrasoft.showInformation(Terrasoft.Resources.SessionEndUserNotification.Message,(function(){location.reload()}),this,e)}}),Ext.define("Terrasoft.controls.HtmlControl",{extend:"Terrasoft.Component",alternateClassName:"Terrasoft.HtmlControl",tpl:['<div id="{id}">',"{htmlContent}","</div>"],htmlContent:null,setHtmlContent:function(e){this.htmlContent!==e&&(this.htmlContent=e,this.safeRerender())},init:function(){this.callParent(arguments);var e=this.selectors=this.selectors||{},t=e.wrapEl,r=this.html;if(!t&&!r){var n=this.id;e.wrapEl="#"+n}},getBindConfig:function(){var e=this.callParent(arguments),t={htmlContent:{changeMethod:"setHtmlContent"}};return Ext.apply(t,e),t},getTplData:function(){var e=this.callParent(arguments);return e.htmlContent=this.htmlContent,e}}),Ext.define("Terrasoft.controls.IframeControl",{extend:"Terrasoft.Component",alternateClassName:"Terrasoft.IframeControl",mixins:{sanitizeHtml:"Terrasoft.SanitizeHtml"},tpl:['<tpl if="addSandbox">','<iframe id="{id}" src="{src}" class="{wrapClass}" sandbox="{sandboxAttributes}"></iframe>',"<tpl else>",'<iframe id="{id}" src="{src}" class="{wrapClass}"></iframe>',"</tpl>"],iframeContent:null,id:null,src:"",wrapClass:["t-iframe"],fitHeightToContent:!1,bordersWidth:2,sanitizationLevel:Terrasoft.sanitizationLevel.DEFAULT,sandboxAttributes:"",addSandbox:!1,useDefaultFonts:!1,setIframeContent:function(e,t){this.src=null,e=e||"",(this.iframeContent!==e||t)&&(this.iframeContent=this.getSanitizedValue(e,this.sanitizationLevel),this.safeRerender())},_loadIframeContent:function(){!this.src&&this.iframeContent&&this.writeHTMLToIframe()},_adjustIframeHeight:function(){if(this.fitHeightToContent){var e=this.getWrapEl(),t=e.dom.contentWindow.document.body,r=Ext.get(t).getHeight();e.setHeight(r+this.bordersWidth)}},_subscribeLinksClick:function(e){var t=e.querySelectorAll("a");Terrasoft.each(t,(function(e){e.addEventListener("click",this._onUrlClick.bind(this))}),this)},_onUrlClick:function(e){e.preventDefault(),e.stopPropagation();var t=e.currentTarget,r=t&&t.href;this.openUrl(r,"_blank")},_addDefaultFont:function(e){if(this.useDefaultFonts){var t=e.createElement("link");t.href="../core/hash/Fonts/fonts.css",t.rel="stylesheet",t.type="text/css",e.head.append(t)}},init:function(){this.callParent(arguments);var e=this.selectors=this.selectors||{};e.wrapEl=e.wrapEl||"#"+this.id},writeHTMLToIframe:function(){var e=this.getWrapEl();e.on("load",this.onIframeLoad,this,{single:!0});var t=e.dom.contentWindow.document;t.open(),t.write(this.iframeContent),t.close(),t.body.dir=Terrasoft.getIsRtlMode()?"rtl":"ltr",this._addDefaultFont(t),this._subscribeLinksClick(t)},setIframeSrc:function(e){this.iframeContent=null,e=e||"",this.src!==e&&(this.src=e,this.safeRerender())},setSandboxAttributes:function(e){this.addSandbox=!0,e!==this.sandboxAttributes&&(this.sandboxAttributes=e,this.safeRerender())},setUseDefaultFonts:function(e){this.useDefaultFonts=e},onAfterRender:function(){this.callParent(arguments),this._loadIframeContent()},onAfterReRender:function(){this.callParent(arguments),this._loadIframeContent()},getBindConfig:function(){var e=this.callParent(arguments),t=this.getSanitizeHtmlBindConfig();return Ext.apply(e,{iframeContent:{changeMethod:"setIframeContent"},src:{changeMethod:"setIframeSrc"},useDefaultFonts:{changeMethod:"setUseDefaultFonts"},sandboxAttributes:{changeMethod:"setSandboxAttributes"}},t)},getTplData:function(){var e=this.callParent(arguments);return Ext.apply(e,{iframeContent:this.iframeContent,src:this.src,wrapClass:this.wrapClass,sandboxAttributes:this.sandboxAttributes,addSandbox:this.addSandbox})},openUrl:function(e,t){Ext.isEmpty(e)||window.open(e,t)},onIframeLoad:function(){this._adjustIframeHeight()},setSanitizeHtml:function(e){this.mixins.sanitizeHtml.setSanitizeHtml.call(this,e),this.setIframeContent(this.iframeContent,!0)}}),Ext.define("Terrasoft.controls.CommandLine",{extend:"Terrasoft.BaseEdit",alternateClassName:"Terrasoft.CommandLine",mixins:{expandableList:"Terrasoft.ExpandableList",rightIcon:"Terrasoft.RightIcon",leftIcon:"Terrasoft.LeftIcon"},enableRightIcon:!0,enableLeftIcon:!0,rightIconClasses:["command-line-icon"],minSearchCharsCount:0,searchDelay:350,maskDelay:0,value:null,selectionText:"",enableLocalFilter:!1,useDefSelection:!1,changeTypedValueDelayedTask:null,onListElementSelected:function(e){this.setValue(e),this.listView.hide()},initDomEvents:function(){this.callParent(arguments),this.on("rightIconClick",this.onMarkerWrapClick,this),Ext.getDoc().on("mousedown",this.onMouseDownCollapse,this)},onMouseDownCollapse:function(e){var t=this.listView;t&&(e.within(t.getWrapEl())||t.hide())},init:function(){this.callParent(arguments),this.mixins.expandableList.init.call(this),this.mixins.rightIcon.init.apply(this,arguments),this.addEvents("selectSuggestion","commandLineExecute","listViewItemRender","keyUp","keyDown","changeTypedValue","typedValueChanged","changeValue"),this.on("selectSuggestion",(function(){null===this.listView&&this.createListView(),this.selectSuggestionDelayedTask.cancel(),this.selectSuggestionDelayedTask.delay(this.searchDelay)}),this),this.changeTypedValueDelayedTask=new Ext.util.DelayedTask(this.initChangeTypedValueDelayedTask,this),this.selectSuggestionDelayedTask=new Ext.util.DelayedTask(this.initSelectSuggestionDelayedTask,this)},initChangeTypedValueDelayedTask:function(){this.fireEvent("typedValueChanged",this.typedValue)},initSelectSuggestionDelayedTask:function(){this.selectSuggestion()},onMarkerWrapClick:function(){this.typedValue=this.getInputedCommand(),this.fireEvent("commandLineExecute",this,this.typedValue)},onFocus:function(){this.callParent(arguments),this.mixins.expandableList.onFocus.call(this)},onBlur:function(){this.mixins.expandableList.onBlur.call(this),this.listView&&this.listView.hide()},onKeyDown:function(e){switch(this.fireEvent("keyDown",e,this),this.mixins.expandableList.onKeyDown.call(this,e,!1),e.getKey()){case e.ENTER:var t=this.typedValue||Terrasoft.Features.getIsEnabled("GlobalSearch")?this.getTypedValue():this.typedValue;t.length>0&&(this.fireEvent("commandLineExecute",this,t),this.collapseList())}},changeValue:function(e){var t,r=this.value;if(t=null!==r&&null!==e?r.value!==e.value||r.displayValue!==e.displayValue:r!==e){this.value=e,this.fireEvent("changeValue",r);var n=Terrasoft.deepClone(e);this.fireEvent("change",n,this),this.typedValue=n?n.displayValue:"",this.fireEvent("changeTypedValue",this.typedValue)}return t},onKeyUp:function(e){this.fireEvent("keyUp",e,this);var t=this.getTypedValue();this.typedValue=this.getInputedCommand();var r=e.getKey();if(r!==e.SHIFT&&r!==e.HOME&&r!==e.CTRL)if(r!==e.DELETE&&r!==e.BACKSPACE||""!==t){if((r===e.DELETE||r===e.BACKSPACE)&&""!==this.selectionText)return void this.fireEvent("changeTypedValue",this.typedValue);if(r===e.UP||r===e.DOWN){var n=this.listView;if(!n)return;this.onItemSelectByKey(n)}else this.getCaretPosition(this.getEl().dom)!==this.typedValue.length||e.isNavKeyPress()&&r!==e.RIGHT&&r!==e.END||t.length>=this.minSearchCharsCount&&(this.changeTypedValueDelayedTask.cancel(),this.changeTypedValueDelayedTask.delay(this.searchDelay),this.fireEvent("changeTypedValue",this.typedValue))}else this.collapseList()},onItemSelectByKey:function(e){var t=e.map.displayValue,r=this.listViewConfig;r&&r.map&&(t=r.map.displayValue);var n=e.selectedItem,i=n.dom.getAttribute("data-value"),a=this.list.collection.get(i);if(a){var s=a[t];n={value:i,displayValue:s},this.setValue(n),this.typedValue=this.getInputedCommand(),this.fireEvent("changeTypedValue",this.typedValue),this.el.dom.value=s}},getCaretPosition:function(e){var t=null;if(document.selection){var r=document.selection.createRange();r.moveStart("textedit",-1),t=r.text.length}else t=e.selectionStart;return t},getUserSelection:function(){var e="";if(window.getSelection)e=(e=window.getSelection()).toString();else{var t=document.selection.createRange();e=t?t.text:""}return e},getInputedCommand:function(){var e=this.getUserSelection(),t=this.getTypedValue();return t.substr(0,t.length-e.length)},selectSuggestion:function(){var e=this.typedValue;e.length>=this.minSearchCharsCount&&this.expandList();var t=this.selectionText;if(""!==t){var r=e+t,n=this.el;if(n){var i=n.dom;i.value=r;var a=e.length,s=r.length;if(i.setSelectionRange)i.focus(),i.setSelectionRange(a,s);else{var o=i.createTextRange();o.collapse(!0),o.moveEnd("character",s),o.moveStart("character",a),o.select()}}}},onSelectionTextChange:function(e){this.selectionText=e},onChangeValue:function(e){this.setValue(e)},getInitValue:function(){var e=this.value,t=e?Terrasoft.getTypedStringValue(e,Terrasoft.DataValueType.LOOKUP):"";return t?Terrasoft.encodeHtml(t):""},getBindConfig:function(){var e=this.callParent(arguments),t={typedValue:{changeEvent:"changeTypedValue"},selectionText:{changeMethod:"onSelectionTextChange"},value:{changeEvent:"changeValue",changeMethod:"onChangeValue"}};Ext.apply(e,t);var r=this.mixins.expandableList.getBindConfig();return Ext.apply(e,r),e},subscribeForEvents:function(e,t,r){this.callParent(arguments),this.mixins.expandableList.subscribeForEvents.call(this,e,t,r)},initBinding:function(e,t,r){var n=this.callParent(arguments),i=this.mixins.expandableList.initBinding.call(this,e,t,r);return Ext.apply(n,i)},getModelMethod:function(e,t){return this.mixins.expandableList.getModelMethod.call(this,e,t)},setValue:function(e){var t=this.changeValue(e);(this.setSelectedItem(e),this.rendered&&t)&&(this.getEl().dom.value=e?e.displayValue:"")},createListView:function(){var e=this.mixins.expandableList.createListView.call(this);return e.useDefSelection=this.useDefSelection,e},onDestroy:function(){this.mixins.expandableList.destroy.call(this),this.callParent(arguments)}}),Ext.ns("Terrasoft"),Ext.ns("Terrasoft.controls.ImageEditEnums"),Terrasoft.controls.ImageEditEnums.ImageStyle={RECTANGULAR:"rectangular",CIRCLE:"circle"},Terrasoft.ImageStyle=Terrasoft.controls.ImageEditEnums.ImageStyle,Ext.define("Terrasoft.controls.ImageEdit",{extend:"Terrasoft.Component",alternateClassName:"Terrasoft.ImageEdit",mixins:{fileUpload:"Terrasoft.FileUpload"},imageStyle:Terrasoft.ImageStyle.RECTANGULAR,width:"8em",height:"8em",readonly:!1,uploadButtonEnabled:!0,clearButtonEnabled:!0,imageTitle:"",defaultImageSrc:"",imageSrc:"",value:null,file:null,wrapClasses:"ts-image-edit-wrap ts-box-sizing",imageContainerClasses:"ts-image-edit-container ts-box-sizing ts-image-edit-full-size",imageElClasses:"ts-image-edit-full-size-element",uploadButtonClasses:"ts-image-edit-button ts-image-edit-upload",clearButtonClasses:"ts-image-edit-button ts-image-edit-clear",pressedButtonClass:"ts-image-edit-pressed",disabledButtonClass:"ts-image-edit-disabled",imageStylePrefix:"ts-image-style-",imageContainerStylePrefix:"ts-image-container-style-",fileUpload:!0,maxFileSize:-1,tpl:['<div id="{id}-image-edit" class="{wrapClass}" style="{wrapStyles}">','<div id="{id}-image-edit-container" class="{imageContainerClasses}" style="{imageContainerStyles}">','<div class="ts-image-edit-inner-container"><img id="{id}-image-edit-element" class="{imageElClasses}" src="{imageSrc}" title="{imageTitle}"></div>',"</div>",'<span id="{id}-image-edit-upload" class="{uploadButtonClasses}" style="{uploadButtonStyles}"><span></span></span>','<span id="{id}-image-edit-clear" class="{clearButtonClasses}" style="{clearButtonStyles}"><span></span></span>',"</div>"],getTplData:function(){var e=this.callParent(arguments);return Ext.apply(e,this.combineClasses()),this.styles=this.combineStyles(),e.imageSrc=this.imageSrc,e.imageTitle=this.imageTitle,this.updateSelectors(e),e},updateSelectors:function(e){var t=e.id,r=this.selectors={};return r.wrapEl="#"+t+"-image-edit",r.imageContainerEl="#"+t+"-image-edit-container",r.imageEl="#"+t+"-image-edit-element",r.uploadButtonEl="#"+t+"-image-edit-upload",r.clearButtonEl="#"+t+"-image-edit-clear",r},combineClasses:function(){var e={};return e.wrapClass=this.wrapClasses,e.imageContainerClasses=[this.imageContainerClasses,this.getImageStyleClass(this.imageContainerStylePrefix)],e.imageElClasses=[this.imageElClasses,this.getImageStyleClass(this.imageStylePrefix)],e.uploadButtonClasses=[this.uploadButtonClasses],e.clearButtonClasses=[this.clearButtonClasses],this.uploadButtonEnabled||e.uploadButtonClasses.push(this.disabledButtonClass),this.clearButtonEnabled=this.imageSrc!==this.defaultImageSrc,this.clearButtonEnabled||e.clearButtonClasses.push(this.disabledButtonClass),e},combineStyles:function(){var e=this.styles||{},t=e.wrapStyles=e.wrapStyles||{};t.width=this.width,t.height=this.height;var r=e.uploadButtonStyles={},n=e.clearButtonStyles={},i=e.imageContainerStyles={};return this.readonly&&(r.display="none",n.display="none",i.border="none",i.padding="0",t[Terrasoft.getIsRtlMode()?"marginLeft":"marginRight"]="0px"),e},init:function(){this.callParent(arguments),this.addEvents("change","beforefileselected","onImageClick","fileSizeOverflow"),this.on("filesSelected",this.onFileSelected,this)},constructor:function(){this.mixins.fileUpload.constructor.call(this),this.fileTypeFilter.push("image/*"),this.callParent(arguments)},initDomEvents:function(){this.callParent(arguments);var e=this.getWrapEl();e&&e.on("click",this.onClick,this);var t=this.clearButtonEl;t&&(t.on("mousedown",this.onButtonsMouseDown,this),t.on("mouseup",this.onButtonsMouseUp,this));var r=this.uploadButtonEl;r&&(r.on("mousedown",this.onButtonsMouseDown,this),r.on("mouseup",this.onButtonsMouseUp,this));var n=this.uploadButtonEnabled;n&&r&&r.on("click",this.onUploadButtonClick,this),this.clearButtonEnabled&&t&&t.on("click",this.onClearButtonClick,this),this.mixins.fileUpload.destroy.call(this);var i=Ext.isIE&&n?r:null;this.addInputFile(i)},onClick:function(e){var t=this.canExecute({method:this.onClick,args:arguments});!1!==t&&(e.stopEvent(),this.fireEvent("onImageClick",this))},onButtonsMouseDown:function(e){Ext.fly(e.currentTarget).addCls(this.pressedButtonClass)},onButtonsMouseUp:function(e){Ext.fly(e.currentTarget).removeCls(this.pressedButtonClass)},setDefaultImageSrc:function(e){this.defaultImageSrc=e||""},setImageSrc:function(e,t){this.imageSrc=e||this.defaultImageSrc,this.imageTitle=Ext.isEmpty(t,!0)?this.imageTitle:t,this.clearButtonEnabled=this.imageSrc!==this.defaultImageSrc,this.safeRerender()},clearImage:function(){this.value=null,this.setImageSrc(this.defaultImageSrc,"")},getBindConfig:function(){var e=this.callParent(arguments),t={defaultImageSrc:{changeMethod:"setDefaultImageSrc"},imageSrc:{changeMethod:"setImageSrc"},uploadButtonEnabled:{changeMethod:"setUploadButtonEnabled"},readonly:{changeMethod:"setReadonly"},width:{changeMethod:"setWidth"},height:{changeMethod:"setHeight"},file:{changeMethod:"setFile"},imageStyle:{changeMethod:"setImageStyle"},maxFileSize:{changeMethod:"setMaxFileSize"}};return Ext.apply(t,e),t},setMaxFileSize:function(e){e>0&&(this.maxFileSize=e)},setFile:function(e){Ext.isEmpty(e)||this.onFileSelected([e])},setImageStyle:function(e){if(this.imageStyle!==e){var t=this.imageStylePrefix,r=this.imageContainerStylePrefix,n=this.getImageStyleClass(t),i=this.getImageStyleClass(r);if(this.imageStyle=e,this.rendered){var a=this.imageEl,s=this.imageContainerEl;a&&s&&(a.removeCls(n),a.addCls(this.getImageStyleClass(t)),s.removeCls(i),s.addCls(this.getImageStyleClass(r)))}}},getImageStyleClass:function(e){var t=this.imageStyle;return e+(t?t.toLowerCase():Terrasoft.ImageStyle.RECTANGULAR)},onDestroy:function(){var e=this.getWrapEl();e&&e.un("onImageClick",this.onClick,this),this.mixins.fileUpload.destroy.call(this),this.callParent(arguments)},setUploadButtonEnabled:function(e){this.uploadButtonEnabled!==e&&(this.uploadButtonEnabled=e,this.safeRerender())},setReadonly:function(e){this.readonly!==e&&(this.readonly=e,this.safeRerender())},setWidth:function(e){this.width!==e&&(this.width=e,this.wrapEl.setStyle("width",e))},setHeight:function(e){this.height!==e&&(this.height=e,this.wrapEl.setStyle("height",e))},fireChangeValue:function(e){this.fireEvent("change",e,this)},onUploadButtonClick:function(){!1!==this.fireEvent("beforefileselected",this)&&this.fireEvent("click",this)},onClearButtonClick:function(){this.clearImage(),this.fireChangeValue(null)},onFileSelected:function(e){var t=e[0];this.maxFileSize>0&&(null==t?void 0:t.size)>this.maxFileSize?this.fireEvent("fileSizeOverflow",this):(this.value=t,this.fireChangeValue(this.value))}}),Ext.define("Terrasoft.controls.ColorButton",{extend:"Terrasoft.Component",alternateClassName:"Terrasoft.ColorButton",simpleMode:!1,imageConfig:null,buttonIdSuffix:"-button",colorButtonViewerClass:"ts-color-button-viewer",colorButtonViewerFullClass:"ts-color-button-viewer-full",button:null,value:null,defaultValue:"#000000",buttonTpl:['<tpl if="hasWrapper">','<span id="{id}-wrapperEl" class="{wrapperClass}" style="{wrapperStyle}" tabindex="{tabIndex}"'," {extraComponentAttributes}>","</tpl>",'<tpl if="hasInnerWrapper">','<span id="{id}-innerWrapperEl" class="{innerWrapperClass}" style="{innerWrapperStyle}">',"</tpl>",'<tpl if="hasImage && !imageAfterText">','<span id="{id}-imageEl" class="{imageClass}" style="{imageStyle}"></span>',"</tpl>",'<div id="{id}-viewerEl" class="{colorButtonViewerClass}" style="{colorValue}"></div>','<tpl if="text">','<span id="{id}-textEl" class="{textClass}" style="{textStyle}"','<tpl if="!hasWrapper">','tabindex="{tabIndex}" {extraComponentAttributes}',"</tpl>",">","{text}","</span>","</tpl>",'<tpl if="hasImage && imageAfterText">','<span id="{id}-imageEl" class="{imageClass}" style="{imageStyle}"></span>',"</tpl>",'<tpl if="menu">','<span id="{id}-menuWrapEl" class="{menuWrapClass}">&nbsp;</span>','<span id="{id}-menuEl" class="{menuClass}" style="{menuStyle}" {menuAttribute}>','<span id="{id}-markerEl" class="{markerClass}" style="{markerStyle}"></span>',"</span>","</tpl>",'<tpl if="hasInnerWrapper"></span></tpl>','<tpl if="hasWrapper"></span></tpl>'],tpl:['<div id="{id}-color-button" class="{wrapClasses}" style="{wrapStyles}">',"{%this.generateColorButton(out, values)%}","</div>"],menuItemClassName:null,colorValueEncoding:null,menuItemConfig:null,init:function(){this.callParent(arguments),this.initButton();var e=this.button.menu.getItemByIndex(0);e.on("colorselected",this.onColorSelected,this),this.menuItemClassName===Terrasoft.MenuItemType.COLOR_PICKER&&this.button.on("prepareMenu",(function(){e.setButtonValue(this.value)}),this)},constructor:function(e){this.menuItemClassName=e.menuItemClassName||Terrasoft.MenuItemType.COLOR,this.colorValueEncoding=e.colorValueEncoding||Terrasoft.ColorEncoding.HEX,this.callParent(arguments),this.addEvents("change")},onDestroy:function(){this.button.destroy(),this.callParent(arguments)},initButton:function(){var e=this.id+this.buttonIdSuffix,t=this.imageConfig?"":this.colorButtonViewerFullClass,r=this.defaultValue;this.button=Ext.create("Terrasoft.Button",{id:e,tpl:this.buttonTpl,iconAlign:Terrasoft.controls.ButtonEnums.iconAlign.TOP,imageConfig:this.imageConfig,selectors:{viewerEl:"#"+e+"-viewerEl"},classes:{colorButtonViewerClass:[this.colorButtonViewerClass,t]},styles:{colorValue:{backgroundColor:r}},menu:{items:[this.getMenuItemConfig()]}}),this.button.added(this)},bind:function(){var e;this.callParent(arguments),(e=this.button.bind).call.apply(e,[this.button].concat(Array.prototype.slice.call(arguments)))},getMenuItemConfig:function(){var e={className:this.menuItemClassName};return this.menuItemClassName===Terrasoft.MenuItemType.COLOR_PICKER?Ext.apply(e,{colorEncoding:this.colorValueEncoding}):Ext.apply(e,{simpleMode:this.simpleMode}),Ext.apply(e,this.menuItemConfig),e},getTplData:function(){var e=this.callParent(arguments);return this.selectors={wrapEl:"#"+this.id+"-color-button"},e.generateColorButton=this.generateColorButton,e},generateColorButton:function(e,t){var r=t.self.button.generateHtml();e.push(r)},remove:function(){this.button=null},onColorSelected:function(e,t){this.setValue(t),this.fireEvent("change",t,this)},setEnabled:function(e){this.callParent(arguments),this.button.setEnabled(e)},setValue:function(e){e||(e=this.defaultValue),e!==this.value&&(this.value=e,this.button&&(this.button.styles.colorValue.backgroundColor=e,this.button.viewerEl&&this.button.viewerEl.setStyle("background-color",e)))},getBindConfig:function(){var e=this.callParent(arguments),t={value:{changeMethod:"setValue",changeEvent:"change"}};return Ext.apply(t,e),t}}),Ext.define("Terrasoft.core.Logger",{extend:"Terrasoft.BaseObject",alternateClassName:"Terrasoft.Logger",singleton:!0,logPackage:null,throttleTime:3e3,serverLoggerName:"",debugEnabled:!1,errorEnabled:!1,infoEnabled:!1,throttledFlushLogPackage:null,postMethodName:"PostClientLog",constructor:function(){this.callParent(arguments);var e=Terrasoft.LoggerSettings;this.init(e,this.throttleTime)},init:function(e,t){e&&(this.serverLoggerName=e.loggerName,this.debugEnabled=e.debugLogEnabled,this.errorEnabled=e.errorLogEnabled,this.infoEnabled=e.infoLogEnabled),this.logPackage={logItems:[]},this.throttledFlushLogPackage=Terrasoft.throttle(this.flushLogPackage,t)},flushLogPackage:function(){var e=this.logPackage;0!==e.logItems.length&&(Terrasoft.ServiceProvider.executeRequest(this.postMethodName,e),e.logItems.length=0)},queueLogItem:function(e,t){var r={loggerName:this.serverLoggerName,message:e,messageType:t};this.logPackage.logItems.push(r),this.throttledFlushLogPackage()},debug:function(e){this.debugEnabled&&this.queueLogItem(e,Terrasoft.LogItemType.DEBUG)},error:function(e){this.errorEnabled&&this.queueLogItem(e,Terrasoft.LogItemType.ERROR)},info:function(e){this.infoEnabled&&this.queueLogItem(e,Terrasoft.LogItemType.INFO)}}),Ext.define("Terrasoft.core.FileHelper",{extend:"Terrasoft.BaseObject",alternateClassName:"Terrasoft.FileHelper",singleton:!0,fileNameForbiddenSymbols:["[?\\/:*\"'<>|+s.%@&()#][;,]","[^0-9a-zÀ-ž֑-߿יִ-﷽ﹰ-ﻼа-я]"],maxFileNameLength:60,executeUploadQuery:function(e,t,r,n,i){var a={};a[t]=r.name;var s=Terrasoft.DataProvider.dataServiceMethods[e.operationType],o=Terrasoft.ServiceProvider.buildRequest(s,e,n,i),l=Terrasoft.ServiceProvider.getRequestUrl("UploadFile"),c=Ext.util.Cookies.get("BPMCSRF");FileAPI.upload({url:l,data:{queryData:o.jsonData,operationType:e.operationType,fileToFieldData:Terrasoft.encode(a)},headers:{BPMCSRF:c||""},files:{file:r},filecomplete:function(e,t){o.callback.call(Terrasoft.ServiceProvider,null,!e,t)}})},uploadFile:function(e,t,r,n){var i=t.fileFieldName,a=t.parameters,s=e===Terrasoft.QueryOperationType.INSERT?"InsertQuery":"UpdateQuery",o=Ext.create("Terrasoft."+s,{rootSchemaName:t.entityName});e!==Terrasoft.QueryOperationType.INSERT&&o.enablePrimaryColumnFilter(t.id),Terrasoft.each(a,(function(e,t){o.setParameterValue(t,e.value,e.type)}),this),o.setParameterValue(i,null,Terrasoft.DataValueType.BLOB),this.executeUploadQuery(o,i,t.file,r,n)},stripFileName:function(e){var t=new RegExp(this.fileNameForbiddenSymbols.join("|"),"gi");return(e=(e=(e=e.replace(t,"_")).replace(/_{2,}/g,"_")).slice(0,this.maxFileNameLength)).toLowerCase()}}),Ext.ns("Terrasoft.integration"),Ext.ns("Terrasoft.integration.telephony"),Ext.ns("Terrasoft.integration.telephony.enums"),Terrasoft.integration.telephony.enums.CallDirection={UNKNOWN:"c072be2c-3d82-4468-9d4a-6db47d1f4cca",OUT:"53f71b5f-7e17-4cf5-bf14-6a59212db422",IN:"1d96a65f-2131-4916-8825-2d142b1000b2"},Terrasoft.CallDirection=Terrasoft.integration.telephony.enums.CallDirection,Terrasoft.integration.telephony.enums.CallFeaturesSet={CAN_NOTHING:0,CAN_RECALL:1,CAN_DIAL:2,CAN_ANSWER:4,CAN_DROP:8,CAN_HOLD:16,CAN_UNHOLD:32,CAN_SETUP_TRANSFER:64,CAN_COMPLETE_TRANSFER:128,CAN_CANCEL_COMPLETE_TRANSFER:8192,CAN_BLIND_TRANSFER:256,CAN_MAKE_CONSULT_CALL:512,CAN_DTMF:1024,CAN_VIDEO:2048,CAN_MUTE:4096},Terrasoft.CallFeaturesSet=Terrasoft.integration.telephony.enums.CallFeaturesSet,Terrasoft.integration.telephony.enums.AgentFeaturesSet={CAN_NOTHING:0,CAN_WRAP_UP:1,HAS_CALL_CENTRE_MODE:2,CAN_GET_CALL_RECORDS:4},Terrasoft.AgentFeaturesSet=Terrasoft.integration.telephony.enums.AgentFeaturesSet,Terrasoft.integration.telephony.enums.GeneralizedCallState={NONE:0,ALERTING:1,CONNECTED:2,HOLDED:3,CONFERENCED:4,UNKNOWN:5,BUSY:6},Terrasoft.GeneralizedCallState=Terrasoft.integration.telephony.enums.GeneralizedCallState,Terrasoft.integration.telephony.enums.CtiCommand={LOAD_LIBRARY:"LoadLibrary",OPEN_CONNECTION:"OpenConnection",REGISTER_CONNECTION_SESSION:"RegisterConnectionSession",CLOSE_CONNECTION:"CloseConnection",MAKE_CALL:"MakeCall",HOOKUP:"Hookup",PROCESS_LOGS:"ProcessLogs",ANSWER_CALL:"AnswerCall",HOLD_CALL:"HoldCall",DROP_CALL:"DropCall",SETUP_TRANSFER_CALL:"SetupTransferCall",MAKE_CONSULT_CALL:"MakeConsultCall",TRANSFER_CALL:"TransferCall",CANCEL_TRANSFER:"CancelTransfer",BLIND_TRANSFER_CALL:"BlindTransferCall",SET_DND:"SetDnd",QUERY_LINE_STATE:"QueryLineState",QUERY_ACTIVE_CALL_SNAPSHOT:"QueryActiveCallSnapshot",SET_MSG_USER_STATE:"SetMsgUserState",QUERY_MSG_USER_STATE:"QueryMsgUserState",LIBRARY_SPECIFIC_SERVICE:"LibrarySpecificService",POST_RAW_DATA:"PostRawData",SEND_DTMF:"SendDtmf",SET_LOG_FILE_PATH:"SetLogFilePath",SET_WRAP_UP_USER_STATE:"SetWrapUpUserState"},Terrasoft.CtiCommand=Terrasoft.integration.telephony.enums.CtiCommand,Terrasoft.integration.telephony.enums.MessagingCommandExecutorType={NONE:"",CALL:"Terrasoft.Messaging.Common.Call, Terrasoft.Messaging.Common"},Terrasoft.MessagingCommandExecutorType=Terrasoft.integration.telephony.enums.MessagingCommandExecutorType,Terrasoft.integration.telephony.enums.MsgEventType={NONE:0,LIBRARY_INITIALIZED:1,CONNECTION_CREATED:2,ERROR:3,COMMAND_INFO:4,RING_STARTED:5,RING_FINISHED:6,COMMUTATION_STARTED:7,PUT_HOLD_ACTION:8,END_HOLD_ACTION:9,ACTIVE_CALL_SNAPSHOT:10,LINE_STATE_CHANGED:11,AGENT_STATE_CHANGED:12,ABONENT_BUSY:13,DISCONNECTED:14,CALL_SAVED_IN_DB:15,RAW_DATA:16,CALL_INFO_CHANGED:17,DTMF_ENTERED:18},Terrasoft.MsgEventType=Terrasoft.integration.telephony.enums.MsgEventType,Terrasoft.integration.telephony.enums.MsgErrorType={GENERAL_ERROR:0,LOAD_LIBRARY_ERROR:1,OPEN_CONNECTION_ERROR:2,COMMAND_ERROR:3,COMMAND_NOT_IMPLEMENTED_ERROR:4,CALL_CENTRE_NOT_AVAILABLE_ERROR:5,AUTHENTICATION_ERROR:6,CALL_SAVING_ERROR:7,EVENT_HANDLER_ERROR:8,CONNECTION_CONFIG_ERROR:9},Terrasoft.MsgErrorType=Terrasoft.integration.telephony.enums.MsgErrorType,Ext.ns("Terrasoft.integration"),Ext.ns("Terrasoft.integration.telephony"),Ext.define("Terrasoft.integration.telephony.Call",{extend:"Terrasoft.BaseObject",alternateClassName:"Terrasoft.Telephony.Call",mixins:{serializable:"Terrasoft.Serializable"},serializablePropertiesList:["id","databaseUId","userContactUId","deviceId","callerId","calledId","direction","callContext","callContextType","state","redirectingId","redirectionId"],id:"",databaseUId:"",userContactUId:"",callFeaturesSet:0,parentCall:null,deviceId:"",callerId:"",calledId:"",direction:Terrasoft.CallDirection.UNKNOWN,callContext:"",callContextType:"",startTime:null,endTime:null,state:Terrasoft.GeneralizedCallState.NONE,oldState:Terrasoft.GeneralizedCallState.NONE,stateCause:"",oldData:null,identificationFieldsData:null,needSaveIdentificationData:!1,isSavedInDB:!1,currentHoldStartTime:null,totalHoldDuration:0,connectionStartTime:null,currentTalkStartTime:null,totalTalkDuration:0,redirectingId:"",redirectionId:"",timeStamp:null,ctiProvider:null,getAbonentNumber:function(){return this.deviceId===this.callerId?this.calledId:this.callerId},answer:function(){this.ctiProvider.answerCall(this)},drop:function(){this.ctiProvider.dropCall(this)},hold:function(){this.ctiProvider.holdCall(this)},makeConsultCall:function(e){this.ctiProvider.makeConsultCall(this,e)},transfer:function(e){this.ctiProvider.transferCall(this,e)},setupTransfer:function(){this.ctiProvider.setupTransferCall(this)},blindTransfer:function(e){this.ctiProvider.blindTransferCall(this,e)},sendDtmf:function(e){this.ctiProvider.sendDtmf(this,e)},updateOldData:function(){var e=this.oldData||{},t=!1;return Terrasoft.each(this.serializablePropertiesList,(function(r){var n=e[r],i=this[r];n!==i&&(e[r]=i,t=!0)}),this),t&&(this.oldData=e),t},getSerializableObject:function(e){Terrasoft.each(this.serializablePropertiesList,(function(t){var r=this[t];Ext.isEmpty(r)||(e[t]=r)}),this)}}),Ext.ns("Terrasoft.integration"),Ext.ns("Terrasoft.integration.telephony"),Ext.define("Terrasoft.integration.telephony.BaseCtiProvider",{extend:"Terrasoft.core.BaseObject",alternateClassName:"Terrasoft.BaseCtiProvider",msgUtilServiceUrl:Terrasoft.workspaceBaseUrl+"/ServiceModel/MsgUtilService.svc/",loginMethodName:"LogInMsgServer",updateCallMethodName:"UpdateCall",licInfoKeys:[],initialConfig:null,constructor:function(){this.callParent(arguments),this.addEvents("rawMessage","callStarted","callFinished","callBusy","currentCallChanged","callInfoChanged","commutationStarted","hold","unhold","callSaved","activeCallSnapshot","lineStateChanged","agentStateChanged","error","commandExecuted","initialized","callCentreStateChanged","dtmfEntered","disconnected","webRtcStarted","webRtcVideoStarted","webRtcDestroyed")},writeLog:function(e){if(Ext.isEmpty(e))throw new Terrasoft.ArgumentNullOrEmptyException;var t=e.message;if(!Ext.isEmpty(t)){if(!Ext.isString(t)){if(!Ext.isFunction(t.toString))return;t=t.toString()}var r=e.loggerType||Terrasoft.LoggerType.CLIENT;if(r!==Terrasoft.LoggerType.NONE){var n,i,a=Ext.global.console||{},s=Terrasoft.Logger;switch(e.logItemType){case Terrasoft.LogItemType.ERROR:n=a.error,i=s.error;break;case Terrasoft.LogItemType.INFO:n=a.info,i=s.info;break;default:n=a.log,i=s.debug}var o=Array.prototype.slice.call(arguments,1),l=Ext.String.format.apply(Ext.String,[t].concat(o));if(r===Terrasoft.LoggerType.CLIENT||r===Terrasoft.LoggerType.BOTH){var c="Y-m-d H:i:s,ms",u=Ext.Date.format(new Date,c),h=Ext.String.format("{0} [{1}] {2}",u,e.logName,l);Ext.isDefined(a)&&n&&Function.prototype.call.call(n,a,h)}r!==Terrasoft.LoggerType.SERVER&&r!==Terrasoft.LoggerType.BOTH||i.call(s,l)}}},writeTelephonyLog:function(e,t){var r=Terrasoft.LoggerType.CLIENT;Ext.isEmpty(this.initialConfig)||Ext.isEmpty(this.initialConfig.connectionConfig)||(r=this.initialConfig.connectionConfig.loggerType);var n={loggerType:r,logItemType:t,logName:"Telephony",message:e},i=[n].concat(Array.prototype.slice.call(arguments,2));this.writeLog.apply(this,i)},loginMsgService:function(e,t,r){Terrasoft.AjaxProvider.request({url:e,scope:this,jsonData:t,callback:function(e,t,n){this.onLoginMsgService(e,t,n,r)}})},onLoginMsgService:function(e,t,r,n){if(t&&Terrasoft.isGUID(r.responseText.replace(/\"/g,"")))n&&n(this.initialConfig.connectionConfig);else{this.fireEvent("rawMessage","LogInMsgService error");var i={internalErrorCode:null,data:r.responseText,source:"App server",errorType:Terrasoft.MsgErrorType.AUTHENTICATION_ERROR};this.fireEvent("error",i)}},updateDbCall:function(e,t){if(!Ext.isEmpty(e)&&e.updateOldData()){var r=e.serialize();Terrasoft.AjaxProvider.request({url:this.msgUtilServiceUrl+this.updateCallMethodName,scope:this,callback:t,jsonData:r})}},init:function(e){this.initialConfig=e},reConnect:function(){this.init(this.initialConfig)},logInfo:function(e){var t=Array.prototype.slice.call(arguments,1);this.writeTelephonyLog.apply(this,[e,Terrasoft.LogItemType.INFO].concat(t))},logError:function(e){var t=Array.prototype.slice.call(arguments,1);this.writeTelephonyLog.apply(this,[e,Terrasoft.LogItemType.ERROR].concat(t))},log:function(e){var t=Array.prototype.slice.call(arguments,1);this.writeTelephonyLog.apply(this,[e,Terrasoft.LogItemType.DEBUG].concat(t))},getAgentLogoutCode:Terrasoft.abstractFn,closeConnection:Terrasoft.abstractFn,makeCall:Terrasoft.abstractFn,hookup:Terrasoft.abstractFn,answerCall:Terrasoft.abstractFn,holdCall:Terrasoft.abstractFn,dropCall:Terrasoft.abstractFn,setupTransferCall:Terrasoft.abstractFn,makeConsultCall:Terrasoft.abstractFn,transferCall:Terrasoft.abstractFn,cancelTransfer:Terrasoft.abstractFn,blindTransferCall:Terrasoft.abstractFn,setDnd:Terrasoft.abstractFn,queryLineState:Terrasoft.abstractFn,queryActiveCallSnapshot:Terrasoft.abstractFn,setUserState:Terrasoft.abstractFn,setWrapUpUserState:Terrasoft.abstractFn,setVideoState:Terrasoft.abstractFn,queryUserState:Terrasoft.abstractFn,sendDtmf:Terrasoft.abstractFn,mute:Terrasoft.abstractFn,queryCallRecords:Terrasoft.abstractFn,changeCallCentreState:Terrasoft.abstractFn,getCapabilities:Terrasoft.abstractFn}),Ext.ns("Terrasoft.integration"),Ext.ns("Terrasoft.integration.telephony"),Ext.define("Terrasoft.integration.telephony.CtiModel",{extend:"Terrasoft.BaseModel",alternateClassName:"Terrasoft.CtiModel",singleton:!0,configGetterMethodName:"GetTelephonyConfig",closeConnectionOnLogoutSysSettingCode:"CloseTelephonyConnectionOnLogout",disconnectedMillisecond:1e4,ctiProvider:null,activeCalls:null,processReconnection:!0,reconnectTryCount:0,maxReconnectTryCount:200,reConnectTimerId:0,columns:{LineFeatures:{type:Terrasoft.ViewModelColumnType.VIRTUAL_COLUMN,dataValueType:Terrasoft.DataValueType.INTEGER},CurrentCall:{type:Terrasoft.ViewModelColumnType.VIRTUAL_COLUMN,dataValueType:Terrasoft.DataValueType.CUSTOM_OBJECT},LastCall:{type:Terrasoft.ViewModelColumnType.VIRTUAL_COLUMN,dataValueType:Terrasoft.DataValueType.CUSTOM_OBJECT},CurrentCallNumber:{type:Terrasoft.ViewModelColumnType.VIRTUAL_COLUMN,dataValueType:Terrasoft.DataValueType.TEXT},ConsultCallNumber:{type:Terrasoft.ViewModelColumnType.VIRTUAL_COLUMN,dataValueType:Terrasoft.DataValueType.TEXT},AgentState:{type:Terrasoft.ViewModelColumnType.VIRTUAL_COLUMN,dataValueType:Terrasoft.DataValueType.TEXT},AgentStateReason:{type:Terrasoft.ViewModelColumnType.VIRTUAL_COLUMN,dataValueType:Terrasoft.DataValueType.TEXT},IsConnected:{type:Terrasoft.ViewModelColumnType.VIRTUAL_COLUMN,dataValueType:Terrasoft.DataValueType.BOOLEAN},IsConsulting:{type:Terrasoft.ViewModelColumnType.VIRTUAL_COLUMN,dataValueType:Terrasoft.DataValueType.BOOLEAN},IsCallCentreActive:{type:Terrasoft.ViewModelColumnType.VIRTUAL_COLUMN,dataValueType:Terrasoft.DataValueType.BOOLEAN}},subscribeOnCtiProviderEvents:function(){var e=this.ctiProvider;e.on("initialized",this.onProviderInitialized,this),e.on("disconnected",this.onProviderDisconnected,this),e.on("callStarted",this.onProviderCallStarted,this),e.on("callFinished",this.onProviderCallFinished,this),e.on("commutationStarted",this.onProviderCommutationStarted,this),e.on("callBusy",this.onProviderCallBusy,this),e.on("hold",this.onProviderCallHold,this),e.on("unhold",this.onProviderCallUnhold,this),e.on("error",this.onProviderError,this),e.on("lineStateChanged",this.onLineStateChanged,this),e.on("agentStateChanged",this.onAgentStateChanged,this),e.on("activeCallSnapshot",this.onActiveCallSnapshot,this),e.on("callSaved",this.onCallSaved,this),e.on("rawMessage",this.onProviderRawMsg,this),e.on("currentCallChanged",this.onProviderCurrentCallChanged,this),e.on("callCentreStateChanged",this.onProviderCallCentreStateChanged,this),e.on("callInfoChanged",this.onProviderCallInfoChanged,this),e.on("dtmfEntered",this.onProviderDtmfEntered,this),e.on("webRtcStarted",this.onProviderWebRtcStarted,this),e.on("webRtcVideoStarted",this.onProviderWebRtcVideoStarted,this),e.on("webRtcDestroyed",this.onProviderWebRtcDestroyed,this)},getOpponentNumber:function(e){return e.direction===Terrasoft.CallDirection.IN?e.callerId:e.calledId},updateStateByCallProperty:function(e,t){var r=this.get("CurrentCall").direction;switch(e){case"callFeaturesSet":this.set("LineFeatures",t);break;case"callerId":r===Terrasoft.CallDirection.IN&&this.set("CurrentCallNumber",t);break;case"calledId":r===Terrasoft.CallDirection.OUT&&this.set("CurrentCallNumber",t)}},updateCallProperties:function(e,t,r){Terrasoft.each(t,(function(t,n){t!==e[n]&&(e[n]=t,r&&this.updateStateByCallProperty(n,t))}),this)},updateConsultCallModelProperties:function(e){var t=this.getOpponentNumber(e);t!==this.get("ConsultCallNumber")&&this.set("ConsultCallNumber",t)},updateCurrentCall:function(e){var t=this.activeCalls.find(e.id),r=!1;Ext.isEmpty(t)&&((t=_.clone(e)).ctiProvider=this.ctiProvider,this.activeCalls.add(t.id,t),r=!0);var n=this.get("CurrentCall");if(Ext.isObject(n)){var i=t.id===n.id;this.updateCallProperties(t,e,i),i||(r&&(t.parentCall=n),this.updateConsultCallModelProperties(t))}else this.set("CurrentCall",t),this.set("LastCall",t);return t},checkCurrentCallExists:function(e){if(Ext.isEmpty(e))throw new Terrasoft.InvalidOperationException({message:Terrasoft.Resources.Telephony.Exception.CurrentCallNotExistsException})},proxyEventArguments:function(e,t){var r=Array.prototype.slice.call(t,0),n=[e].concat(r);this.safeFireEvent.apply(this,n)},safeFireEvent:function(e){try{this.fireEventArgs(e,Array.prototype.slice.call(arguments,1))}catch(r){var t={internalErrorCode:null,data:r.message,source:r.stack,errorType:Terrasoft.MsgErrorType.EVENT_HANDLER_ERROR};this.fireEvent("error",t),this.ctiProvider.logError("'{0}' event handler exception. {1}",e,r.message)}},processCallEvent:function(e,t){var r=Array.prototype.slice.call(t,0),n=r[0],i=this.updateCurrentCall(n);r[0]=i,this.proxyEventArguments(e,r)},setReconnectTimer:function(){if(this.processReconnection&&0===this.reConnectTimerId&&this.reconnectTryCount<this.maxReconnectTryCount){var e=this.getReconnectTimerInterval(this.reconnectTryCount);this.log("Reconnect timer is set. Next reconnect will start after "+e+" seconds."),this.reConnectTimerId=setTimeout(this.onReconnectTimer.bind(this),1e3*e)}},resetReconnectTimer:function(){this.reConnectTimerId=0,this.reconnectTryCount=0},onProviderInitialized:function(){this.set("IsConnected",!0),this.proxyEventArguments("connected",arguments),0===this.activeCalls.getCount()&&this.set("LineFeatures",Terrasoft.CallFeaturesSet.CAN_DIAL),this.ctiProvider.queryActiveCallSnapshot(),this.resetReconnectTimer()},onProviderDisconnected:function(){this.set("IsConnected",!1),this.proxyEventArguments("disconnected",arguments),this.set("LineFeatures",Terrasoft.CallFeaturesSet.CAN_NOTHING),this.activeCalls.clear();var e=arguments[1];!Ext.isEmpty(e)&&e.ignoreTryReconnection||this.setReconnectTimer()},onProviderCallStarted:function(){this.processCallEvent("callStarted",arguments)},onProviderCallFinished:function(){var e=Array.prototype.slice.call(arguments,0),t=e[0],r=this.updateCurrentCall(t);e[0]=r,this.activeCalls.remove(r),this.proxyEventArguments("callFinished",e)},onProviderCommutationStarted:function(){this.processCallEvent("commutationStarted",arguments)},onProviderCallBusy:function(){this.processCallEvent("callBusy",arguments)},onProviderCallHold:function(){this.processCallEvent("hold",arguments)},onProviderCallUnhold:function(){this.processCallEvent("unhold",arguments)},onProviderError:function(e){e.data&&this.ctiProvider.logError(e.data),this.proxyEventArguments("error",arguments);var t=e.errorType===Terrasoft.MsgErrorType.OPEN_CONNECTION_ERROR||e.errorType===Terrasoft.MsgErrorType.CALL_CENTRE_NOT_AVAILABLE_ERROR;t&&this.setReconnectTimer()},onActiveCallSnapshot:function(e){this.activeCalls.clear();var t=e.ActiveCalls,r=e.CurrentCall?Ext.create("Terrasoft.Telephony.Call",e.CurrentCall):null;t&&Terrasoft.each(t,(function(e){var t=Ext.create("Terrasoft.Telephony.Call",e);r&&e.id!==r.id&&(t.parentCall=r),t.ctiProvider=this.ctiProvider,this.activeCalls.add(t.id,t)}),this),r&&this.updateCurrentCall(r)},onCallSaved:function(e){this.ctiProvider.log("callSaved. id = {0}, databaseId = {1}",e.id,e.databaseUId),e.isSavedInDB=!0;var t=this.activeCalls.find(e.id);Ext.isEmpty(t)||(t.isSavedInDB=!0,t.databaseUId=e.databaseUId),this.proxyEventArguments("callSaved",arguments)},onProviderRawMsg:function(e){this.ctiProvider.log(Terrasoft.encode(e))},onProviderCurrentCallChanged:function(e){this.ctiProvider.log("currentCallChanged. id = {0}",e.id);var t=this.activeCalls.find(e.id);Ext.isEmpty(t)?this.ctiProvider.logError("currentCallChanged. Call with id {0} was not found",e.id):(this.set("CurrentCall",t),this.set("LastCall",t))},onProviderCallCentreStateChanged:function(e){e!==this.get("IsCallCentreActive")&&this.set("IsCallCentreActive",e)},onProviderCallInfoChanged:function(e){var t=e.databaseUId,r=null,n=this.activeCalls;if(n.each((function(e){return e.databaseUId!==t||(r=e,!1)}),this),Ext.isEmpty(r))this.ctiProvider.logError("callInfoChanged. Call with databaseUId {0} was not found",t);else{var i=e.id;r.id=i,n.suspendEvents();try{n.remove(r),n.add(i,r)}finally{n.resumeEvents()}this.updateCurrentCall(e)}},onCurrentCallChanged:function(e,t){Ext.isEmpty(t)?this.set("CurrentCallNumber",""):Terrasoft.each(t,(function(e,t){this.updateStateByCallProperty(t,e)}),this)},onLineStateChanged:function(e){if(Ext.isObject(e)){var t,r=e.callFeaturesSet;if(Ext.isEmpty(e.callId))return this.set("LineFeatures",r),void this.ctiProvider.log("LineFeatures = {0}",r);t=this.activeCalls.find(e.callId),Ext.isObject(t)&&(t.callFeaturesSet=r);var n=this.get("CurrentCall");(Ext.isEmpty(n)||Ext.isObject(t)&&t.id===n.id)&&this.set("LineFeatures",r)}},onAgentStateChanged:function(e){this.set("AgentState",e.userState),this.set("AgentStateReason",e.userStateReasonCode)},onActiveCallAdded:function(){this.findConsultCall()&&this.set("IsConsulting",!0)},onActiveCallRemoved:function(){var e=this.activeCalls.getCount();if(0===e)this.set("CurrentCall",null);else if(e<2&&(this.set("IsConsulting",!1),this.set("ConsultCallNumber",""),1===e)){var t=this.activeCalls.getByIndex(0);this.set("LastCall",t),this.set("CurrentCall",t)}},onActiveCallsCleared:function(){this.set("IsConsulting",!1),this.set("CurrentCall",null)},onProviderDtmfEntered:function(){this.proxyEventArguments("dtmfEntered",arguments)},onProviderWebRtcStarted:function(){this.proxyEventArguments("webRtcStarted",arguments)},onProviderWebRtcVideoStarted:function(){this.proxyEventArguments("webRtcVideoStarted",arguments)},onProviderWebRtcDestroyed:function(){this.proxyEventArguments("webRtcDestroyed",arguments)},onReconnectTimer:function(){this.reConnectTimerId=0,this.reconnectTryCount++,this.ctiProvider.reConnect()},_getCloseTelephonyConnectionPromise:function(){return new Promise(function(e){var t=this;if(this.get("IsConnected")){var r=function t(r,n){this.ctiProvider.getAgentLogoutCode()===n&&(this.un("change:AgentState",t,this),this.ctiProvider.log("AgentState is "+n),e())};this.on("change:AgentState",r,this),this.ctiProvider.closeConnection(),setTimeout((function(){t.un("change:AgentState",r,t),e()}),this.disconnectedMillisecond)}else e()}.bind(this))},_isNeedCloseConnectionOnLogout:function(){return new Promise(function(e){var t=this.closeConnectionOnLogoutSysSettingCode;Terrasoft.SysSettings.querySysSettings([t],(function(r){e(r&&!!r[t])}),this)}.bind(this))},getReconnectTimerInterval:function(e){return Math.round(5+360/Math.PI*Math.atan(5*e*Math.PI/180))},findConsultCall:function(){var e=this.get("CurrentCall");if(!Ext.isObject(e))return null;var t=null;return this.activeCalls.each((function(r){return r.id===e.id||(t=r,!1)})),t},constructor:function(){this.callParent(arguments),this.addEvents("disconnected","connected","callStarted","callBusy","commutationStarted","hold","unhold","callFinished","error","callSaved","dtmfEntered","webRtcStarted","webRtcVideoStarted","webRtcDestroyed"),this.activeCalls=Ext.create("Terrasoft.Collection"),this.activeCalls.on("add",this.onActiveCallAdded,this),this.activeCalls.on("remove",this.onActiveCallRemoved,this),this.activeCalls.on("clear",this.onActiveCallsCleared,this),this.on("change:CurrentCall",this.onCurrentCallChanged,this)},init:function(e){Ext.isObject(e)&&(this.loadFromColumnValues(e.values,e.rowConfig),Ext.apply(this,e.methods),this.ctiProvider=e.ctiProvider)},connect:function(e,t){if(!Ext.isEmpty(e))return this.subscribeOnCtiProviderEvents(),this.ctiProvider.init(e),void(t&&t(!0));Terrasoft.ServiceProvider.executeRequest(this.configGetterMethodName,"",(function(r){if(!r.success){this.log(r);var n={internalErrorCode:13001,data:"Connection Failed",source:"CTI Model",errorType:Terrasoft.MsgErrorType.CONNECTION_CONFIG_ERROR};this.safeFireEvent("error",n),t&&t(!1,n)}var i={};r.connectionConfig&&(i=Terrasoft.decode(r.connectionConfig)),i.disableCallCentre?t&&t(!1):(this.log(r),e={msgServiceUrl:r.msgServerAddress,library:r.assemblyName,connectionConfig:i,sessionServiceParams:{UserUId:Terrasoft.SysValue.CURRENT_USER.value,UserContactUId:Terrasoft.SysValue.CURRENT_USER_CONTACT.value,ServiceUrl:Terrasoft.workspaceBaseUrl}},this.subscribeOnCtiProviderEvents(),this.ctiProvider.init(e),t&&t(!0))}),this)},makeCall:function(e){if(this.ctiProvider.log("makeCall({0})",e),Ext.isEmpty(e))throw new Terrasoft.ArgumentNullOrEmptyException({argumentName:"targetAddress"});this.ctiProvider.makeCall(e)},answerCall:function(){this.ctiProvider.log("answerCall()");var e=this.get("CurrentCall");this.checkCurrentCallExists(e),e.answer()},dropCall:function(){this.ctiProvider.log("dropCall()");var e=this.get("CurrentCall");this.checkCurrentCallExists(e),e.drop()},holdOrUnholdCall:function(){this.ctiProvider.log("holdOrUnholdCall()");var e=this.get("CurrentCall");this.checkCurrentCallExists(e),e.hold()},makeConsultCall:function(e){if(Ext.isEmpty(e))throw new Terrasoft.ArgumentNullOrEmptyException({argumentName:"ConsultCallNumber"});var t=this.get("CurrentCall");this.checkCurrentCallExists(t),this.ctiProvider.log("makeConsultCall({0})",e),t.makeConsultCall(e)},transferCall:function(){var e=this.findConsultCall();if(Ext.isEmpty(e))throw new Terrasoft.InvalidOperationException({message:Terrasoft.Resources.Telephony.Exception.ConsultCallNotExistsException});var t=this.get("CurrentCall");this.checkCurrentCallExists(t),this.ctiProvider.log("transfer(), consultCallId = {0}",e.id),t.transfer(e)},cancelTransfer:function(){var e=this.findConsultCall();if(Ext.isEmpty(e))throw new Terrasoft.InvalidOperationException({message:Terrasoft.Resources.Telephony.Exception.ConsultCallNotExistsException});var t=this.get("CurrentCall");this.checkCurrentCallExists(t),this.ctiProvider.log("cancelTransfer(), consultCallId = {0}, currentCallId = {1}",e.id,t.id),this.ctiProvider.cancelTransfer(t,e)},blindTransferCall:function(e){if(this.ctiProvider.log("blindTransferCall(), targetAddress = {0}",e),Ext.isEmpty(e))throw new Terrasoft.ArgumentNullOrEmptyException({argumentName:"ConsultCallNumber"});var t=this.get("CurrentCall");this.checkCurrentCallExists(t),t.blindTransfer(e)},sendDtmf:function(e){var t=this.get("CurrentCall");this.checkCurrentCallExists(t),this.ctiProvider.log("sendDtmf(), digit = {0}",e),t.sendDtmf(e)},mute:function(){var e=this.get("CurrentCall");this.ctiProvider.log("mute(), currentCallId = {0}",e.id),this.ctiProvider.mute(e)},queryLineState:function(){this.ctiProvider.log("queryLineState()"),this.ctiProvider.queryLineState()},queryAgentState:function(){this.ctiProvider.log("queryAgentState()"),this.ctiProvider.queryUserState()},setAgentState:function(e,t,r){var n=e||this.get("AgentState"),i=t||this.get("AgentStateReason");if(this.ctiProvider.log("setAgentState(), agentState = {0}",n),Ext.isEmpty(n))throw new Terrasoft.ArgumentNullOrEmptyException({argumentName:"AgentState"});this.ctiProvider.setUserState(n,i,r)},setWrapUpUserState:function(e,t){this.ctiProvider.setWrapUpUserState(e,t)},setVideoState:function(e,t,r){this.ctiProvider.setVideoState(e,t,r)},queryCallRecords:function(e,t){this.ctiProvider.queryCallRecords(e,t)},changeCallCentreState:function(e){this.ctiProvider.changeCallCentreState(e)},getProviderCapabilities:function(){return this.ctiProvider.getCapabilities()},closeConnection:function(){this.ctiProvider.log("closeConnection()"),this.ctiProvider.closeConnection()},onLogoutActionAsync:function(){var e=_asyncToGenerator(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.ctiProvider){e.next=7;break}return e.next=3,this._isNeedCloseConnectionOnLogout();case 3:if(!e.sent){e.next=7;break}return e.next=7,this.closeConnectionAsync();case 7:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),closeConnectionAsync:function(){var e=_asyncToGenerator(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.ctiProvider&&this.ctiProvider.log("closeConnection()"),this.processReconnection=!1,e.next=4,this._getCloseTelephonyConnectionPromise();case 4:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),getCanCall:function(){return 0!=(this.get("LineFeatures")&Terrasoft.CallFeaturesSet.CAN_DIAL)},getCanAnswer:function(){return 0!=(this.get("LineFeatures")&Terrasoft.CallFeaturesSet.CAN_ANSWER)},getCanHoldOrUnhold:function(){var e=this.get("LineFeatures");return 0!=(e&Terrasoft.CallFeaturesSet.CAN_HOLD)||0!=(e&Terrasoft.CallFeaturesSet.CAN_UNHOLD)},getCanHold:function(){return 0!=(this.get("LineFeatures")&Terrasoft.CallFeaturesSet.CAN_HOLD)},getCanMute:function(){return 0!=(this.get("LineFeatures")&Terrasoft.CallFeaturesSet.CAN_MUTE)},getCanUnhold:function(){return 0!=(this.get("LineFeatures")&Terrasoft.CallFeaturesSet.CAN_UNHOLD)},getCanDrop:function(){return 0!=(this.get("LineFeatures")&Terrasoft.CallFeaturesSet.CAN_DROP)},getCanSetupTransfer:function(){return 0!=(this.get("LineFeatures")&Terrasoft.CallFeaturesSet.CAN_SETUP_TRANSFER)},getCanMakeConsultCall:function(){return 0!=(this.get("LineFeatures")&Terrasoft.CallFeaturesSet.CAN_MAKE_CONSULT_CALL)},getCanTransfer:function(){return 0!=(this.get("LineFeatures")&Terrasoft.CallFeaturesSet.CAN_COMPLETE_TRANSFER)},getCanCancelCompleteTransfer:function(){return 0!=(this.get("LineFeatures")&Terrasoft.CallFeaturesSet.CAN_CANCEL_COMPLETE_TRANSFER)},getCanCancelTransfer:function(){return 0!=(this.get("LineFeatures")&Terrasoft.CallFeaturesSet.CAN_COMPLETE_TRANSFER)||this.get("IsConsulting")},getCanBlindTransfer:function(){return 0!=(this.get("LineFeatures")&Terrasoft.CallFeaturesSet.CAN_BLIND_TRANSFER)||0!=(this.get("LineFeatures")&Terrasoft.CallFeaturesSet.CAN_MAKE_CONSULT_CALL)},getCanMakeConsultCallOrBlindTransfer:function(){return this.getCanMakeConsultCall()||this.getCanBlindTransfer()},getCanDtmf:function(){return 0!=(this.get("LineFeatures")&Terrasoft.CallFeaturesSet.CAN_DTMF)},getCanGetCallRecords:function(){var e=this.getProviderCapabilities();return!Ext.isEmpty(e)&&!Ext.isEmpty(e.agentCapabilities)&&0!=(e.agentCapabilities&Terrasoft.AgentFeaturesSet.CAN_GET_CALL_RECORDS)},getLastAbonentNumber:function(){var e=this.get("LastCall");return e?e.parentCall?e.parentCall.getAbonentNumber():e.getAbonentNumber():""}}),Ext.ns("Terrasoft.integration"),Ext.ns("Terrasoft.integration.telephony"),Ext.ns("Terrasoft.integration.telephony.messaging"),Ext.define("Terrasoft.integration.telephony.messaging.MsgCommandInfo",{extend:"Terrasoft.BaseObject",alternateClassName:"Terrasoft.MsgCommandInfo",mixins:{serializable:"Terrasoft.Serializable"},serializableSimplePropertiesList:["commandUId","command","libraryInstanceUId","connectionUId","commandExecutorId","commandExecutorType","commandExecutorType"],commandUId:"",command:"",parameters:null,libraryInstanceUId:"",connectionUId:"",commandExecutorId:"",commandExecutorType:Terrasoft.MessagingCommandExecutorType.NONE,commandExecutor:null,getSerializableObject:function(e){Terrasoft.each(this.serializableSimplePropertiesList,(function(t){e[t]=this[t]}),this),e.commandExecutor=this.getSerializableProperty(this.commandExecutor),e.parameters=this.getSerializableProperty(this.parameters)}}),Ext.ns("Terrasoft.integration"),Ext.ns("Terrasoft.integration.telephony"),Ext.ns("Terrasoft.integration.telephony.messaging"),Ext.define("Terrasoft.integration.telephony.messaging.MsgEventInfo",{extend:"Terrasoft.BaseObject",alternateClassName:"Terrasoft.MsgEventInfo",mixins:{serializable:"Terrasoft.Serializable"},serializableSimplePropertiesList:["connectionUId","commandUId","eventType","content","contentType"],connectionUId:null,commandUId:"",eventType:Terrasoft.MsgEventType.NONE,content:"",contentType:"",privateData:null,getSerializableObject:function(e){Terrasoft.each(this.serializableSimplePropertiesList,(function(t){e[t]=this[t]}),this)}}),Ext.ns("Terrasoft.integration"),Ext.ns("Terrasoft.integration.telephony"),Ext.ns("Terrasoft.integration.telephony.messaging"),Ext.define("Terrasoft.integration.telephony.messaging.MsgServiceCtiProvider",{extend:"Terrasoft.BaseCtiProvider",alternateClassName:"Terrasoft.MsgServiceCtiProvider",singleton:!0,serviceUrl:"",serviceChannel:null,libraryInstanceUId:"",connectionUId:"",channelClosedHandler:function(){this.log("Messaging service channel closed"),this.fireEvent("disconnected",this)},processMsg:function(e){if(this.fireEvent("rawMessage",e),Ext.isObject(e)&&Ext.isNumber(e.eventType)){var t=Ext.create("Terrasoft.MsgEventInfo",e);if(t.eventType!==Terrasoft.MsgEventType.NONE){var r,n=t.content,i=t.privateData;switch(t.eventType){case Terrasoft.MsgEventType.LIBRARY_INITIALIZED:this.libraryInstanceUId=n,this.initializeConnection(this.initialConfig);break;case Terrasoft.MsgEventType.CONNECTION_CREATED:this.connectionUId=t.connectionUId,this.fireEvent("initialized",i);break;case Terrasoft.MsgEventType.ERROR:this.fireEvent("error",Terrasoft.decode(n),i);break;case Terrasoft.MsgEventType.COMMAND_INFO:this.fireEvent("commandExecuted",n,i);break;case Terrasoft.MsgEventType.RING_STARTED:r=Ext.create("Terrasoft.integration.telephony.Call",Terrasoft.decode(n)),this.fireEvent("callStarted",r,i);break;case Terrasoft.MsgEventType.RING_FINISHED:r=Ext.create("Terrasoft.integration.telephony.Call",Terrasoft.decode(n)),this.fireEvent("callFinished",r,i);break;case Terrasoft.MsgEventType.COMMUTATION_STARTED:r=Ext.create("Terrasoft.integration.telephony.Call",Terrasoft.decode(n)),this.fireEvent("commutationStarted",r,i);break;case Terrasoft.MsgEventType.PUT_HOLD_ACTION:r=Ext.create("Terrasoft.integration.telephony.Call",Terrasoft.decode(n)),this.fireEvent("hold",r,i);break;case Terrasoft.MsgEventType.END_HOLD_ACTION:r=Ext.create("Terrasoft.integration.telephony.Call",Terrasoft.decode(n)),this.fireEvent("unhold",r,i);break;case Terrasoft.MsgEventType.ACTIVE_CALL_SNAPSHOT:this.fireEvent("activeCallSnapshot",Terrasoft.decode(n),i);break;case Terrasoft.MsgEventType.LINE_STATE_CHANGED:this.fireEvent("lineStateChanged",Terrasoft.decode(n),i);break;case Terrasoft.MsgEventType.AGENT_STATE_CHANGED:this.fireEvent("agentStateChanged",{userState:Terrasoft.decode(n)},i);break;case Terrasoft.MsgEventType.ABONENT_BUSY:r=Ext.create("Terrasoft.integration.telephony.Call",Terrasoft.decode(n)),this.fireEvent("callBusy",r,i);break;case Terrasoft.MsgEventType.DISCONNECTED:var a=Terrasoft.decode(n);this.fireEvent("disconnected",a,i);break;case Terrasoft.MsgEventType.CALL_SAVED_IN_DB:r=Ext.create("Terrasoft.integration.telephony.Call",Terrasoft.decode(n)),this.fireEvent("callSaved",r,i);break;case Terrasoft.MsgEventType.CALL_INFO_CHANGED:r=Ext.create("Terrasoft.integration.telephony.Call",Terrasoft.decode(n)),this.fireEvent("callInfoChanged",r,i);break;case Terrasoft.MsgEventType.DTMF_ENTERED:this.fireEvent("dtmfEntered",Terrasoft.decode(n),i)}}}},channelMsgHandler:function(e,t){try{var r=Ext.decode(t);this.processMsg(r)}catch(e){this.logError("Processing msg exception:"+e)}},channelOpenedHandler:function(){this.log("Messaging service channel created"),this.initializeLibrary(this.initialConfig)},postCallCommand:function(e,t,r){var n={commandExecutor:e,parameters:r};this.postCommand(t,n)},_initServiceChannel:function(e){var t=e.startsWith("http")?"Terrasoft.SignalRChannel":"Terrasoft.WebSocketChannel";return this.serviceChannel=Ext.create(t,{}),this.serviceChannel.serviceUrl=e,this.serviceUrl=e,this.serviceChannel},init:function(e){this.callParent(arguments);var t=this._initServiceChannel(e.msgServiceUrl);t.close();try{t.init()}catch(e){return this.channelClosedHandler(),this.logError("Init cti channel exception:"+e)}t.on(Terrasoft.EventName.ON_CONNECTION_INITIALIZED,this.channelOpenedHandler,this),t.on(Terrasoft.EventName.ON_MESSAGE,this.channelMsgHandler,this),t.on(Terrasoft.EventName.ON_CHANNEL_CLOSED,this.channelClosedHandler,this)},postCommand:function(e,t){if(this.serviceChannel.getConnectionState()!==Terrasoft.SocketConnectionState.OPEN){var r=Terrasoft.Resources.Telephony.Exception.SocketConnectionChannelIsNotOpened;throw this.logError(r),new Terrasoft.InvalidObjectState(r)}t=t||{};var n=Ext.create("Terrasoft.MsgCommandInfo",{command:e,parameters:t.parameters,libraryInstanceUId:this.libraryInstanceUId,connectionUId:this.connectionUId,commandExecutor:t.commandExecutor});Ext.isObject(t.commandExecutor)&&(n.commandExecutorId=t.commandExecutor.id,Ext.getClassName(t.commandExecutor)===Ext.getClassName(Terrasoft.integration.telephony.Call)&&(n.commandExecutorType=Terrasoft.MessagingCommandExecutorType.CALL,n.commandExecutor=t.commandExecutor.serialize()));var i=n.serialize();this.serviceChannel.postRawMessage(i),this.log(i)},initializeLibrary:function(e){var t={parameters:{AssemblyName:e.library}};this.postCommand(Terrasoft.CtiCommand.LOAD_LIBRARY,t)},initializeConnection:function(e){var t={parameters:{connectionParams:Terrasoft.encode(e.connectionConfig),sessionServiceParams:Terrasoft.encode(e.sessionServiceParams)}};this.postCommand(Terrasoft.CtiCommand.OPEN_CONNECTION,t)},closeConnection:function(){this.postCommand(Terrasoft.CtiCommand.CLOSE_CONNECTION)},makeCall:function(e){this.postCommand(Terrasoft.CtiCommand.MAKE_CALL,{parameters:{targetAddress:e}})},hookup:function(){this.postCommand(Terrasoft.CtiCommand.HOOKUP)},answerCall:function(e){this.postCallCommand(e,Terrasoft.CtiCommand.ANSWER_CALL)},holdCall:function(e){this.postCallCommand(e,Terrasoft.CtiCommand.HOLD_CALL)},dropCall:function(e){this.postCallCommand(e,Terrasoft.CtiCommand.DROP_CALL)},setupTransferCall:function(e){this.postCallCommand(e,Terrasoft.CtiCommand.SETUP_TRANSFER_CALL)},makeConsultCall:function(e,t){this.postCallCommand(e,Terrasoft.CtiCommand.MAKE_CONSULT_CALL,{targetAddress:t})},transferCall:function(e,t){var r=Ext.getClassName(t)===Ext.getClassName(Terrasoft.integration.telephony.Call)?t.serialize():Terrasoft.encode(t);this.postCallCommand(e,Terrasoft.CtiCommand.TRANSFER_CALL,{consultationCall:r})},cancelTransfer:function(e,t){var r=e.serialize(),n=t.serialize();this.postCommand(Terrasoft.CtiCommand.CANCEL_TRANSFER,{parameters:{currentCall:r,consultCall:n}})},blindTransferCall:function(e,t){this.postCallCommand(e,Terrasoft.CtiCommand.BLIND_TRANSFER_CALL,{targetAddress:t})},setDnd:function(){this.postCommand(Terrasoft.CtiCommand.SET_DND)},queryLineState:function(){this.postCommand(Terrasoft.CtiCommand.QUERY_LINE_STATE)},queryActiveCallSnapshot:function(){this.postCommand(Terrasoft.CtiCommand.QUERY_ACTIVE_CALL_SNAPSHOT)},setUserState:function(e,t,r){var n={code:e,reason:t||""};this.postCommand(Terrasoft.CtiCommand.SET_MSG_USER_STATE,{parameters:n}),Ext.isFunction(r)&&r.call(this)},setWrapUpUserState:function(e,t){this.postCommand(Terrasoft.CtiCommand.SET_WRAP_UP_USER_STATE,{parameters:{isWrapUpActive:e}}),Ext.isFunction(t)&&t.call(this)},queryUserState:function(){this.postCommand(Terrasoft.CtiCommand.QUERY_MSG_USER_STATE)},sendDtmf:function(e,t){this.postCallCommand(e,Terrasoft.CtiCommand.SEND_DTMF,{digits:t})},getCapabilities:function(){return{callCapabilities:Terrasoft.CallFeaturesSet.CAN_RECALL|Terrasoft.CallFeaturesSet.CAN_DIAL|Terrasoft.CallFeaturesSet.CAN_DROP|Terrasoft.CallFeaturesSet.CAN_ANSWER|Terrasoft.CallFeaturesSet.CAN_HOLD|Terrasoft.CallFeaturesSet.CAN_UNHOLD|Terrasoft.CallFeaturesSet.CAN_COMPLETE_TRANSFER|Terrasoft.CallFeaturesSet.CAN_BLIND_TRANSFER|Terrasoft.CallFeaturesSet.CAN_MAKE_CONSULT_CALL|Terrasoft.CallFeaturesSet.CAN_DTMF,agentCapabilities:Terrasoft.AgentFeaturesSet.CAN_WRAP_UP}},processLogs:function(){this.postCommand(Terrasoft.CtiCommand.PROCESS_LOGS)},setLogFilePath:function(e){this.postCommand(Terrasoft.CtiCommand.SET_LOG_FILE_PATH,{parameters:{filePath:e}})}}),Ext.ns("Terrasoft.integration"),Ext.ns("Terrasoft.integration.telephony"),Ext.ns("Terrasoft.integration.telephony.callway"),Terrasoft.integration.telephony.callway.CallwayEventType={NEW_CALL:"NewCall",CALL_STATE_CHANGED:"CallStateChanged",OPERATOR_STATE:"OperatorState",AUTHORIZED:"AuthorizationResponse"},Terrasoft.CallwayEventType=Terrasoft.integration.telephony.callway.CallwayEventType,Terrasoft.integration.telephony.callway.CallwayCallDirection={INCOMING:"Incoming",OUTGOING:"Outgoing",LOCAL:"Internal"},Terrasoft.CallwayCallDirection=Terrasoft.integration.telephony.callway.CallwayCallDirection,Terrasoft.integration.telephony.callway.CallwayCallState={BRIDGE:"Bridge",HANGUP:"Hangup",HOLD:"Hold",UNHOLD:"Unhold",TRANSFER:"Transfer"},Terrasoft.CallwayCallState=Terrasoft.integration.telephony.callway.CallwayCallState,Terrasoft.integration.telephony.callway.CallwayAuthorizationResult={SUCCESS:"Success",FAILED:"Failed"},Terrasoft.CallwayAuthorizationResult=Terrasoft.integration.telephony.callway.CallwayAuthorizationResult,Ext.ns("Terrasoft.integration"),Ext.ns("Terrasoft.integration.telephony"),Ext.ns("Terrasoft.integration.telephony.callway"),Ext.define("Terrasoft.integration.telephony.callway.CallwayCtiProvider",{extend:"Terrasoft.BaseCtiProvider",alternateClassName:"Terrasoft.CallwayCtiProvider",singleton:!0,extension:"",routingRule:"",isCallwayClient:!0,ringBackCallerId:"",activeCall:null,consultCall:null,serviceUrl:"",serviceChannel:null,libraryInstanceUId:"",connectionUId:"",callwayMsgLibraryAssemblyName:"Terrasoft.Messaging.Callway.CallwayManager, Terrasoft.Messaging.Callway",ringBackCallIds:null,connectedCallFeaturesSet:Terrasoft.CallFeaturesSet.CAN_HOLD|Terrasoft.CallFeaturesSet.CAN_MAKE_CONSULT_CALL|Terrasoft.CallFeaturesSet.CAN_BLIND_TRANSFER|Terrasoft.CallFeaturesSet.CAN_DROP|Terrasoft.CallFeaturesSet.CAN_DTMF,licInfoKeys:["MessagingService.Use","BPMonlineCallwayConnector.Use"],constructor:function(){this.callParent(arguments),this.serviceChannel=Ext.create("Terrasoft.WebSocketChannel",{serviceUrl:this.serviceUrl}),this.ringBackCallIds=Ext.create("Terrasoft.Collection")},connect:function(e){var t=this.serviceChannel;t.serviceUrl=e.msgServiceUrl,t.init(),t.on(Terrasoft.EventName.ON_CONNECTION_INITIALIZED,this.channelOpenedHandler,this),t.on(Terrasoft.EventName.ON_MESSAGE,this.channelMsgHandler,this),t.on(Terrasoft.EventName.ON_CHANNEL_CLOSED,this.channelClosedHandler,this)},channelClosedHandler:function(){this.log("Messaging service channel closed"),this.fireEvent("disconnected",this)},channelMsgHandler:function(e,t){try{var r=Ext.decode(t);this.processMsg(r)}catch(e){this.logError("Processing message exception:"+e)}},channelOpenedHandler:function(){this.log("Messaging service channel created"),this.initializeLibrary(this.initialConfig)},initializeLibrary:function(){var e={parameters:{AssemblyName:this.callwayMsgLibraryAssemblyName}};this.postMessagingCommand(Terrasoft.CtiCommand.LOAD_LIBRARY,e)},initializeConnection:function(e){var t=e.connectionConfig,r={parameters:{connectionParams:Terrasoft.encode(t),sessionServiceParams:Terrasoft.encode(e.sessionServiceParams)}};this.extension=t.operatorId,this.routingRule=t.routingRule,this.ringBackCallerId=t.ringBackCallerId,Ext.isEmpty(t.isCallwayClient)||(this.isCallwayClient=t.isCallwayClient),this.postMessagingCommand(Terrasoft.CtiCommand.OPEN_CONNECTION,r)},processMsg:function(e){if(this.fireEvent("rawMessage",e),Ext.isObject(e)&&Ext.isNumber(e.eventType)){var t=Ext.create("Terrasoft.MsgEventInfo",e),r=t.content;switch(t.eventType){case Terrasoft.MsgEventType.LIBRARY_INITIALIZED:this.libraryInstanceUId=r,this.initializeConnection(this.initialConfig);break;case Terrasoft.MsgEventType.CONNECTION_CREATED:this.connectionUId=t.connectionUId,this.fireEvent("initialized"),this.queryOperatorState();break;case Terrasoft.MsgEventType.ERROR:this.fireEvent("error",Terrasoft.decode(r));break;case Terrasoft.MsgEventType.DISCONNECTED:var n=Terrasoft.decode(r);this.fireEvent("disconnected",n);break;case Terrasoft.MsgEventType.RAW_DATA:this.processCallwayEvent(Terrasoft.decode(r))}}},packCallwayCommand:function(e){if(Ext.isEmpty(e)||Ext.Object.isEmpty(e))return"";var t="";return Terrasoft.each(e,(function(e,r){t+=Ext.String.format("{0}: {1}\r\n",r,e)}),this),t+="\r\n"},unpackCallwayMessage:function(e){for(var t={},r=e.split("\r\n"),n=0,i=r.length;n<=i;n++){var a=r[n];if(!Ext.isEmpty(a)){var s=r[n].split(": ");if(!(s.length<2)){var o=s[0],l=s[1];t[o]=l}}}return t},postCallwayMessage:function(e){var t={parameters:{data:this.packCallwayCommand(e)}};this.postMessagingCommand(Terrasoft.CtiCommand.POST_RAW_DATA,t)},postMessagingCommand:function(e,t){if(this.serviceChannel.getConnectionState()!==Terrasoft.SocketConnectionState.OPEN){var r=Terrasoft.Resources.Telephony.Exception.SocketConnectionChannelIsNotOpened;throw this.logError(r),new Terrasoft.InvalidObjectState(r)}t=t||{};var n=Ext.create("Terrasoft.MsgCommandInfo",{command:e,parameters:t.parameters,libraryInstanceUId:this.libraryInstanceUId,connectionUId:this.connectionUId,commandExecutor:t.commandExecutor}).serialize();this.serviceChannel.postMessage(n),this.log(n)},processCallwayEvent:function(e){var t=this.unpackCallwayMessage(e);switch(t.Message){case Terrasoft.CallwayEventType.NEW_CALL:this.onNewCall(t);break;case Terrasoft.CallwayEventType.CALL_STATE_CHANGED:this.onCallStateChanged(t);break;case Terrasoft.CallwayEventType.OPERATOR_STATE:this.onOperatorState(t);break;case Terrasoft.CallwayEventType.AUTHORIZED:this.onAuthorized(t)}},internalMakeCall:function(e){var t={Message:"MakeCall",OperatorId:this.extension,Number:e};this.postCallwayMessage(t)},originate:function(e){var t={Message:"Originate",NumberA:this.extension,NumberB:e,RoutingRule:this.routingRule};this.postCallwayMessage(t)},queryOperatorState:function(e){var t={Message:"GetOperatorState",OperatorId:e||this.extension};this.postCallwayMessage(t)},findCurrentCallById:function(e){return Ext.isEmpty(this.consultCall)||this.consultCall.id!==e?Ext.isEmpty(this.activeCall)||this.activeCall.id!==e?null:this.activeCall:this.consultCall},getCallDirection:function(e,t){var r;return r=e===Terrasoft.CallwayCallDirection.INCOMING?Terrasoft.CallDirection.IN:e===Terrasoft.CallwayCallDirection.OUTGOING?Terrasoft.CallDirection.OUT:t!==this.extension?Terrasoft.CallDirection.IN:Terrasoft.CallDirection.OUT,this.log(r),r},onLoginMsgService:function(e,t,r){var n=Terrasoft.decode(r.responseText);if(t&&Terrasoft.isGUID(n))this.connect(this.initialConfig);else{this.fireEvent("rawMessage","LogInMsgService error");var i={internalErrorCode:null,data:r.responseText,source:"App server",errorType:Terrasoft.MsgErrorType.AUTHENTICATION_ERROR};this.fireEvent("error",i)}},onAuthorized:function(e){var t=e.AuthorizationResult;if(t!==Terrasoft.CallwayAuthorizationResult.SUCCESS){var r={internalErrorCode:t,data:Ext.String.format("AuthorizationResult: {0}",t),errorType:Terrasoft.MsgErrorType.AUTHENTICATION_ERROR,source:"Callway server"};this.fireEvent("error",r),this.closeConnection()}},onUpdateDbCall:function(e,t,r){var n=r.responseText,i=Terrasoft.isGUID(n)?n:Terrasoft.decode(n);if(t&&Terrasoft.isGUID(i)){var a=Terrasoft.decode(e.jsonData),s=a.id;Ext.isEmpty(this.activeCall)||this.activeCall.id!==s?Ext.isEmpty(this.consultCall)||this.consultCall.id!==s||(a=this.consultCall):a=this.activeCall,a.databaseUId=i,this.fireEvent("callSaved",a)}else{this.fireEvent("rawMessage","Update Call error");var o={internalErrorCode:null,data:i,source:"App server",errorType:Terrasoft.MsgErrorType.COMMAND_ERROR};this.fireEvent("error",o)}},onNewCall:function(e){var t=e.UniqueId;if(e.Number!==this.ringBackCallerId){var r=!Ext.isEmpty(this.activeCall),n=this.getCallDirection(e.Direction,e.Number),i=this.findCurrentCallById(t)||Ext.create("Terrasoft.integration.telephony.Call");i.id=t,i.direction=n,i.deviceId=this.extension,n===Terrasoft.CallDirection.IN?(i.callerId=e.Number,i.calledId=this.extension):(i.callerId=this.extension,i.calledId=e.Number),i.ctiProvider=this,i.timeStamp=new Date,i.callFeaturesSet=Terrasoft.CallFeaturesSet.CAN_DROP,this.isCallwayClient&&n===Terrasoft.CallDirection.IN&&(i.callFeaturesSet|=Terrasoft.CallFeaturesSet.CAN_ANSWER),i.state=Terrasoft.GeneralizedCallState.ALERTING,r?(i.redirectingId=this.extension,i.redirectionId=n===Terrasoft.CallDirection.OUT?i.calledId:i.callerId,this.consultCall=i,this.fireEvent("lineStateChanged",{callFeaturesSet:Terrasoft.CallFeaturesSet.CAN_NOTHING})):this.activeCall=i,this.fireEvent("callStarted",i),this.fireEvent("lineStateChanged",{callFeaturesSet:i.callFeaturesSet,callId:i.id}),this.updateDbCall(i,this.onUpdateDbCall)}else this.ringBackCallIds.contains(t)||this.ringBackCallIds.add(t,t)},onCallStateChanged:function(e){var t=e.UniqueId;if(this.ringBackCallIds.contains(t))e.State===Terrasoft.CallwayCallState.HANGUP&&this.ringBackCallIds.removeByKey(t);else{var r=this.findCurrentCallById(t);if(Ext.isEmpty(r))this.logError("Event for unknown call. Event config:"+Terrasoft.encode(e));else{switch(e.State){case Terrasoft.CallwayCallState.BRIDGE:this.onCallConnected(r);break;case Terrasoft.CallwayCallState.HANGUP:this.onCallHangup(r);break;case Terrasoft.CallwayCallState.HOLD:this.onCallHold(r);break;case Terrasoft.CallwayCallState.UNHOLD:this.onCallUnhold(r)}this.fireEvent("lineStateChanged",{callFeaturesSet:r.callFeaturesSet,callId:t}),this.updateDbCall(r,this.onUpdateDbCall)}}},onCallConnected:function(e){var t=e.id,r=!1;if(Ext.isEmpty(this.consultCall)||this.consultCall.id!==t||(r=!0),e.state=Terrasoft.GeneralizedCallState.CONNECTED,e.callFeaturesSet=this.connectedCallFeaturesSet,this.fireEvent("commutationStarted",e),r){var n=this.activeCall;n.callFeaturesSet=Terrasoft.CallFeaturesSet.CAN_COMPLETE_TRANSFER,this.fireEvent("lineStateChanged",{callFeaturesSet:n.callFeaturesSet,callId:n.id})}},onCallHangup:function(e){var t=e.id,r=this.consultCall;Ext.isEmpty(this.activeCall)||this.activeCall.id!==t?Ext.isEmpty(r)||r.id!==t||(this.consultCall=null):Ext.isEmpty(r)?this.activeCall=null:(this.activeCall=r,this.consultCall=null,this.fireEvent("currentCallChanged",this.activeCall)),e.state=Terrasoft.GeneralizedCallState.NONE,e.callFeaturesSet=Terrasoft.CallFeaturesSet.CAN_DIAL,this.fireEvent("callFinished",e);var n=this.activeCall;Ext.isEmpty(n)||(n.callFeaturesSet=this.connectedCallFeaturesSet,this.fireEvent("lineStateChanged",{callFeaturesSet:n.callFeaturesSet,callId:n.id}))},onCallHold:function(e){e.state=Terrasoft.GeneralizedCallState.HOLDED,e.callFeaturesSet=Terrasoft.CallFeaturesSet.CAN_UNHOLD|Terrasoft.CallFeaturesSet.CAN_MAKE_CONSULT_CALL,this.fireEvent("hold",e)},onCallUnhold:function(e){e.state=Terrasoft.GeneralizedCallState.CONNECTED,e.callFeaturesSet=this.connectedCallFeaturesSet,this.fireEvent("unhold",e)},onOperatorState:function(e){this.fireEvent("agentStateChanged",{userState:e.State})},init:function(){this.callParent(arguments),this.loginMsgService(this.msgUtilServiceUrl+this.loginMethodName,{LicInfoKeys:this.licInfoKeys,UserUId:Terrasoft.SysValue.CURRENT_USER.value},this.connect.bind(this))},closeConnection:function(){this.postMessagingCommand(Terrasoft.CtiCommand.CLOSE_CONNECTION)},authorize:function(e,t){var r={Message:"AuthorizationRequest",Login:e,Password:t};this.postCallwayMessage(r)},makeCall:function(e){this.isCallwayClient?this.internalMakeCall(e):this.originate(e)},answerCall:function(e){var t={Message:"Answer",UniqueId:e.id,OperatorId:this.extension};this.postCallwayMessage(t)},holdCall:function(e){var t={Message:e.state===Terrasoft.GeneralizedCallState.HOLDED?"UnHold":"Hold",UniqueId:e.id,OperatorId:this.extension};this.postCallwayMessage(t)},dropCall:function(e){var t={Message:"Drop",UniqueId:e.id,OperatorId:this.extension};this.postCallwayMessage(t)},makeConsultCall:function(e,t){this.makeCall(t)},transferCall:function(){if(Ext.isEmpty(this.activeCall)||Ext.isEmpty(this.consultCall))throw new Terrasoft.InvalidObjectState;var e={Message:"TransferToCall",UniqueIdA:this.activeCall.id,UniqueIdB:this.consultCall.id,OperatorId:this.extension};this.postCallwayMessage(e)},cancelTransfer:function(e,t){this.dropCall(t)},blindTransferCall:function(e,t){var r={Message:"Transfer",UniqueId:e.id,Number:t,OperatorId:this.extension};this.postCallwayMessage(r)},setUserState:function(e,t){var r={Message:"SetOperatorState",State:e,OperatorId:this.extension};this.postCallwayMessage(r),Ext.isFunction(t)&&t.call(this)},setWrapUpUserState:function(e,t){var r=e?"Busy":"Available";this.setUserState(r,t)},queryUserState:function(){this.queryOperatorState()},sendDtmf:function(e,t){var r={Message:"DialDTMF",UniqueId:e.id,Digit:t,OperatorId:this.extension};this.postCallwayMessage(r)},listenCall:function(e){var t={Message:"ListenCall",UniqueId:e,OperatorId:this.extension};this.postCallwayMessage(t)},queryActiveCallSnapshot:function(){},queryLineState:function(){},getCapabilities:function(){var e=Terrasoft.CallFeaturesSet.CAN_RECALL|Terrasoft.CallFeaturesSet.CAN_DIAL|Terrasoft.CallFeaturesSet.CAN_DROP|Terrasoft.CallFeaturesSet.CAN_HOLD|Terrasoft.CallFeaturesSet.CAN_UNHOLD|Terrasoft.CallFeaturesSet.CAN_COMPLETE_TRANSFER|Terrasoft.CallFeaturesSet.CAN_BLIND_TRANSFER|Terrasoft.CallFeaturesSet.CAN_MAKE_CONSULT_CALL|Terrasoft.CallFeaturesSet.CAN_DTMF;return this.isCallwayClient&&(e|=Terrasoft.CallFeaturesSet.CAN_ANSWER),{callCapabilities:e,agentCapabilities:Terrasoft.AgentFeaturesSet.CAN_WRAP_UP}}}),Ext.ns("Terrasoft.integration"),Ext.ns("Terrasoft.integration.telephony"),Ext.ns("Terrasoft.integration.telephony.finesse"),Terrasoft.integration.telephony.finesse.FinesseDialogState={INITIATING:"INITIATING",INITIATED:"INITIATED",ALERTING:"ALERTING",ACTIVE:"ACTIVE",FAILED:"FAILED",DROPPED:"DROPPED",ACCEPTED:"ACCEPTED",HELD:"HELD",WRAP_UP:"WRAP_UP"},Terrasoft.FinesseDialogState=Terrasoft.integration.telephony.finesse.FinesseDialogState,Terrasoft.integration.telephony.finesse.FinesseDialogStateCause={BUSY:"BUSY",BAD_DESTINATION:"BAD_DESTINATION",OTHER:"OTHER"},Terrasoft.FinesseDialogStateCause=Terrasoft.integration.telephony.finesse.FinesseDialogStateCause,Terrasoft.integration.telephony.finesse.FinesseDialogMediaType={VOICE:"Voice",EMAIL:"Email",CHAT:"Chat"},Terrasoft.FinesseDialogMediaType=Terrasoft.integration.telephony.finesse.FinesseDialogMediaType,Terrasoft.integration.telephony.finesse.FinesseDialogAction={MAKE_CALL:"MAKE_CALL",ANSWER:"ANSWER",HOLD:"HOLD",RETRIEVE:"RETRIEVE",DROP:"DROP",UPDATE_CALL_DATA:"UPDATE_CALL_DATA",SEND_DTMF:"SEND_DTMF",CONSULT_CALL:"CONSULT_CALL",CONFERENCE:"CONFERENCE",TRANSFER:"TRANSFER",TRANSFER_SST:"TRANSFER_SST",SILENT_MONITOR:"SILENT_MONITOR",BARGE_CALL:"BARGE_CALL",ACCEPT:"ACCEPT",CLOSE:"CLOSE",REJECT:"REJECT"},Terrasoft.FinesseDialogAction=Terrasoft.integration.telephony.finesse.FinesseDialogAction,Terrasoft.integration.telephony.finesse.FinesseAgentState={LOGIN:"LOGIN",LOGOUT:"LOGOUT",NOT_READY:"NOT_READY",READY:"READY",RESERVED:"RESERVED",RESERVED_OUTBOUND:"RESERVED_OUTBOUND",RESERVED_OUTBOUND_PREVIEW:"RESERVED_OUTBOUND_PREVIEW",TALKING:"TALKING",WORK:"WORK",WORK_READY:"WORK_READY",HOLD:"HOLD",UNKNOWN:"UNKNOWN",BUSY:"BUSY",BAD_DESTINATION:"BAD_DESTINATION"},Terrasoft.FinesseAgentState=Terrasoft.integration.telephony.finesse.FinesseAgentState,Terrasoft.integration.telephony.finesse.BoshConnectionStatus={LOADED:0,CONNECTING:1,CONNECTED:2,DISCONNECTED:3,DISCONNECTING:4,RECONNECTING:5,UNLOADING:6},Terrasoft.BoshConnectionStatus=Terrasoft.integration.telephony.finesse.BoshConnectionStatus,Terrasoft.integration.telephony.finesse.FinesseErrorType={DEVICE_BUSY:"Device Busy",INVALID_DEVICE:"Invalid Device"},Terrasoft.FinesseErrorType=Terrasoft.integration.telephony.finesse.FinesseErrorType,Terrasoft.integration.telephony.finesse.FinesseCallType={ACD_IN:"ACD_IN",PREROUTE_ACD_IN:"PREROUTE_ACD_IN",PREROUTE_DIRECT_AGENT:"PREROUTE_DIRECT_AGENT",TRANSFER:"TRANSFER",OTHER_IN:"OTHER_IN",OUT:"OUT",AGENT_INSIDE:"AGENT_INSIDE",CONSULT:"CONSULT",CONSULT_OFFERED:"CONSULT_OFFERED",CONFERENCE:"CONFERENCE",SUPERVISOR_MONITOR:"SUPERVISOR_MONITOR",OUTBOUND:"OUTBOUND",OUTBOUND_PREVIEW:"OUTBOUND_PREVIEW"},Terrasoft.FinesseCallType=Terrasoft.integration.telephony.finesse.FinesseCallType,Terrasoft.integration.telephony.finesse.FinesseAgentStateReason={UNKNOWN:"-1",ONBREAK:"7"},Terrasoft.FinesseAgentStateReason=Terrasoft.integration.telephony.finesse.FinesseAgentStateReason,Ext.ns("Terrasoft.integration"),Ext.ns("Terrasoft.integration.telephony"),Ext.ns("Terrasoft.integration.telephony.finesse"),Ext.define("Terrasoft.integration.telephony.finesse.FinesseCtiProvider",{extend:"Terrasoft.BaseCtiProvider",alternateClassName:"Terrasoft.FinesseCtiProvider",singleton:!0,deviceId:"",licInfoKeys:["BPMonlineFinesseConnector.Use"],msgUtilServiceUrl:Terrasoft.workspaceBaseUrl+"/ServiceModel/MsgUtilService.svc/",loginMethodName:"LogInMsgServer",updateCallMethodName:"UpdateCall",domain:"",agentId:"",password:"",defaultNotReadyReasonCode:"",boshClient:null,isBoshPresenceInit:!1,finessePath:"/finesse",finesseApiPath:"/finesse/api",notGetFinesseRequestsContentType:"application/xml",notGetFinesseRequestsAccept:"text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8",jabberLibNotFoundErrorMessage:"jabberwerx library not found.",finesseErrorMessageTemplate:"Finesse error. Detail info: {0}",jabberNotAuthorizedErrorCode:"not-authorized",jabberClientName:"cisco",activeCalls:null,activeCallId:"",userState:"",userStateReasonCode:"",lastNotReadyStateReasonCode:"",transferInitiator:"",callTypesWithMediaProperties:[Terrasoft.FinesseCallType.AGENT_INSIDE,Terrasoft.FinesseCallType.CONSULT],xmlToJson:function(e){return(new Ext.global.X2JS).xml_str2json(e)},jsonToXml:function(e){return(new Ext.global.X2JS).json2xml_str(e)},sendFinesseRequest:function(e,t,r,n,i,a){var s={url:this.finesseApiPath+e,method:t,headers:{Authorization:"Basic "+Ext.global.jabberwerx.util.crypto.b64Encode(this.agentId+":"+this.password)},success:r,failure:n,scope:i};"GET"!==t&&(s.headers["Content-Type"]=this.notGetFinesseRequestsContentType,s.headers.Accept=this.notGetFinesseRequestsAccept),a&&(s.xmlData=this.jsonToXml(a)),Ext.Ajax.request(s)},connect:function(e){this.agentId=e.AgentID,this.password=e.Password,this.domain=e.Domain,this.deviceId=e.Extension,this.createBoshConnection()},createBoshConnection:function(){var e=Ext.global.jabberwerx;if(Ext.isEmpty(e))return this.logError(this.jabberLibNotFoundErrorMessage),void Terrasoft.Logger.error(this.jabberLibNotFoundErrorMessage);var t=this.boshClient;if(t)t.isConnected()||(t.cancelReconnect(),t.disconnect());else{t=new e.Client(this.jabberClientName),this.boshClient=t,t.Scope=this,e._config.unsecureAllowed=!0;var r=this;t.event("clientStatusChanged").bind((function(e){r.onBoshStatusChanged(e)})),t.event("presenceReceived").bind((function(e){r.onBoshPresenceReceived(e)})),t.event("messageReceived").bindWhen('event[xmlns="http://jabber.org/protocol/pubsub#event"] items item notification',(function(e){r.onFinesseEvent(e)}))}var n=this.agentId+"@"+this.domain,i={httpBindingURL:this.finessePath+"/http-bind",errorCallback:function(e){r.onBoshClientError(e)},successCallback:function(e){r.onBoshClientConnected(e)}};t.connect(n,this.password,i)},onBoshStatusChanged:function(e){switch(e.data.next){case Terrasoft.BoshConnectionStatus.CONNECTED:this.log("Bosh client connected"),this.checkToSendConnected();break;case Terrasoft.BoshConnectionStatus.DISCONNECTED:e.data.error?(this.logError("Bosh client disconnected. Reason: BOSH client error"),Terrasoft.Logger.error("Bosh client disconnected. Reason: BOSH client error")):this.log("Bosh client disconnected successfully"),this.logoutFinesse()}},onBoshPresenceReceived:function(e){this.log("Jabber presence received.");var t=e.data.getFrom();if(!this.isBoshPresenceInit){var r=t.indexOf("@");if(r>0)"finesse"===t.substr(0,r)&&(this.isBoshPresenceInit=!0);this.checkToSendConnected()}},checkToSendConnected:function(){this.boshClient.isConnected()&&this.isBoshPresenceInit&&this.loginFinesse()},loginMsgService:function(e,t){Terrasoft.AjaxProvider.request({url:e,scope:this,callback:this.onLoginMsgService,jsonData:t})},loginFinesse:function(){var e="/User/"+this.agentId,t={User:{extension:this.deviceId,state:Terrasoft.FinesseAgentState.LOGIN}};this.sendFinesseRequest(e,"PUT",(function(){this.fireEvent("initialized")}),(function(e){var t=Ext.String.format("onSignInErrorHandler({0})",Terrasoft.encode(e.responseText));this.fireEvent("rawMessage",t)}),this,t)},logoutFinesse:function(){this.setFinesseAgentState(Terrasoft.FinesseAgentState.LOGOUT,"",(function(e){var t=e?e.responseText:Terrasoft.emptyString;this.fireEvent("disconnected",t)}))},setFinesseAgentState:function(e,t,r){var n="/User/"+this.agentId,i={state:e};Ext.isEmpty(t)||t===Terrasoft.FinesseAgentStateReason.UNKNOWN||(i.reasonCodeId=t);var a={User:i};this.sendFinesseRequest(n,"PUT",(function(n){n.status===Terrasoft.HttpStatusCode.ACCEPTED&&(this.log("setUserState success"),this.userStateChanged(e,t)),Ext.isFunction(r)&&r.call(this,n)}),(function(e){this.logError("setUserState error. Response = {0}",Terrasoft.encode(e.responseText)),Terrasoft.Logger.error("setUserState error. Response = {0}",Terrasoft.encode(e.responseText)),Ext.isFunction(r)&&r.call(this,e)}),this,a)},getFinesseAgentState:function(){var e="/User/"+this.agentId;this.sendFinesseRequest(e,"GET",(function(e){if(!Ext.isEmpty(e.responseXML)){var t=e.responseXML.xml;if(!Ext.isEmpty(t)){var r=this.xmlToJson(t);r&&r.User&&!Ext.isEmpty(r.User.state)&&this.userStateChanged(r.User.state)}}}),(function(e){this.logError("getUserState error. Response = {0}",Terrasoft.encode(e.responseText)),Terrasoft.Logger.error("getUserState error. Response = {0}",Terrasoft.encode(e.responseText))}),this)},makeFinesseCall:function(e,t){var r="/User/"+this.agentId+"/Dialogs",n={Dialog:{requestedAction:Terrasoft.FinesseDialogAction.MAKE_CALL,toAddress:e,fromAddress:this.deviceId}};this.sendFinesseRequest(r,"POST",(function(e){this.log("Make call successful."),Ext.isFunction(t)&&t.call(this,e)}),(function(e){this.logError("makeCall error. status = {0}",Terrasoft.encode(e.responseText)),Terrasoft.Logger.error("makeCall error. status = {0}",Terrasoft.encode(e.responseText)),Ext.isFunction(t)&&t.call(this,e)}),this,n)},makeFinesseConsultCall:function(e,t,r){var n="/Dialog/"+e,i=Terrasoft.FinesseDialogAction.CONSULT_CALL,a={Dialog:{requestedAction:i,toAddress:t,targetMediaAddress:this.deviceId}};this.sendFinesseRequest(n,"PUT",(function(e){this.log("{0} action succeed.",i),Ext.isFunction(r)&&r.call(this,e)}),(function(e){this.logError("{0} action error. response: {1}.",i,Terrasoft.encode(e.responseText)),Terrasoft.Logger.error("{0} action error. response: {1}.",i,Terrasoft.encode(e.responseText)),Ext.isFunction(r)&&r.call(this,e)}),this,a)},makeBlindTransferCall:function(e,t,r){var n="/Dialog/"+e,i=Terrasoft.FinesseDialogAction.TRANSFER_SST,a={Dialog:{requestedAction:i,toAddress:t,targetMediaAddress:this.deviceId}};this.sendFinesseRequest(n,"PUT",(function(e){this.log("{0} action succeed.",i),Ext.isFunction(r)&&r.call(this,e)}),(function(e){this.logError("{0} action error. response: {1}.",i,Terrasoft.encode(e.responseText)),Terrasoft.Logger.error("{0} action error. response: {1}.",i,Terrasoft.encode(e.responseText)),Ext.isFunction(r)&&r.call(this,e)}),this,a)},takeFinesseAction:function(e,t,r){var n="/Dialog/"+e,i={Dialog:{requestedAction:t,targetMediaAddress:this.deviceId}};this.sendFinesseRequest(n,"PUT",(function(e){this.log("{0} action succeed.",t),Ext.isFunction(r)&&r.call(this,e)}),(function(e){this.logError("{0} action error. response: {1}.",t,Terrasoft.encode(e.responseText)),Terrasoft.Logger.error("{0} action error. response: {1}.",t,Terrasoft.encode(e.responseText)),Ext.isFunction(r)&&r.call(this,e)}),this,i)},getCallFeatureFromAction:function(e){switch(e){case Terrasoft.FinesseDialogAction.MAKE_CALL:return Terrasoft.CallFeaturesSet.CAN_DIAL;case Terrasoft.FinesseDialogAction.ANSWER:return Terrasoft.CallFeaturesSet.CAN_ANSWER;case Terrasoft.FinesseDialogAction.HOLD:return Terrasoft.CallFeaturesSet.CAN_HOLD;case Terrasoft.FinesseDialogAction.RETRIEVE:return Terrasoft.CallFeaturesSet.CAN_UNHOLD;case Terrasoft.FinesseDialogAction.DROP:return Terrasoft.CallFeaturesSet.CAN_DROP;case Terrasoft.FinesseDialogAction.SEND_DTMF:return Terrasoft.CallFeaturesSet.CAN_DTMF;case Terrasoft.FinesseDialogAction.CONSULT_CALL:return Terrasoft.CallFeaturesSet.CAN_MAKE_CONSULT_CALL;case Terrasoft.FinesseDialogAction.TRANSFER:return Terrasoft.CallFeaturesSet.CAN_COMPLETE_TRANSFER;case Terrasoft.FinesseDialogAction.TRANSFER_SST:return Terrasoft.CallFeaturesSet.CAN_BLIND_TRANSFER;default:return Terrasoft.CallFeaturesSet.CAN_NOTHING}},getCallStateFromFinesseState:function(e,t){var r;switch(e){case Terrasoft.FinesseDialogState.INITIATING:case Terrasoft.FinesseDialogState.INITIATED:case Terrasoft.FinesseDialogState.ALERTING:r=Terrasoft.GeneralizedCallState.ALERTING;break;case Terrasoft.FinesseDialogState.ACTIVE:r=Terrasoft.GeneralizedCallState.CONNECTED;break;case Terrasoft.FinesseDialogState.HELD:r=Terrasoft.GeneralizedCallState.HOLDED;break;case Terrasoft.FinesseDialogState.FAILED:r=t===Terrasoft.FinesseDialogStateCause.BUSY?Terrasoft.GeneralizedCallState.BUSY:Terrasoft.GeneralizedCallState.ALERTING;break;default:r=Terrasoft.GeneralizedCallState.NONE}return r},processFinesseDialog:function(e){var t=this.activeCalls,r=e.id,n=t.find(r);if(Ext.isEmpty(n)){if(e.state===Terrasoft.FinesseDialogState.DROPPED)return this.log(Terrasoft.Resources.Telephony.CommonMessages.FinesseDialogObjectIgnoredReasonDroppped),null;n=this.createNewCall(e),this.activeCalls.add(r,n)}else n.oldState=n.state;n.timeStamp=new Date,this.setCallParticipants(n,e);var i=n.callFeaturesSet,a=Ext.isArray(e.participants.Participant)?e.participants.Participant:[e.participants.Participant],s=Terrasoft.findItem(a,{mediaAddress:this.deviceId});if(Ext.isEmpty(s))return this.log(Terrasoft.Resources.Telephony.CommonMessages.FinesseDialogObjectIgnoredReasonParticipantMissing),null;n.callFeaturesSet=Terrasoft.CallFeaturesSet.CAN_NOTHING;var o=s.item,l=o.actions.action;if(!Ext.isEmpty(l)){l=Ext.isArray(l)?l:[l];for(var c=0;c<l.length;c++)n.callFeaturesSet|=this.getCallFeatureFromAction(l[c])}i!==n.callFeaturesSet&&(n.isCallFeaturesSetChanged=!0);var u=o.state,h=o.stateCause;return n.state=this.getCallStateFromFinesseState(u,h),u===Terrasoft.FinesseDialogState.FAILED&&(n.stateCause=h||"",this.userStateChanged(n.stateCause,null,n.callFeaturesSet)),u!==Terrasoft.FinesseDialogState.DROPPED&&u!==Terrasoft.FinesseDialogState.WRAP_UP||(this.setRedirectionProperties(n,e),t.remove(n),t.isEmpty()&&u===Terrasoft.FinesseDialogState.DROPPED&&(n.callFeaturesSet|=Terrasoft.CallFeaturesSet.CAN_DIAL)),n},createNewCall:function(e){var t=e.id,r=Ext.create("Terrasoft.integration.telephony.Call");return r.id=t,r.deviceId=this.deviceId,r.ctiProvider=this,r.direction=this.getCallDirection(e),r},isAcdIn:function(e){return e===Terrasoft.FinesseCallType.ACD_IN||e===Terrasoft.FinesseCallType.PREROUTE_ACD_IN},getCallDirection:function(e){var t=e.mediaProperties,r=t.callType;return this.isAcdIn(r)?Terrasoft.CallDirection.IN:r!==Terrasoft.FinesseCallType.CONSULT_OFFERED&&r!==Terrasoft.FinesseCallType.TRANSFER?this.deviceId===e.toAddress||this.deviceId===t.DNIS?Terrasoft.CallDirection.IN:Terrasoft.CallDirection.OUT:Ext.isEmpty(e.toAddress)?Terrasoft.CallDirection.OUT:Terrasoft.CallDirection.IN},setCallParticipants:function(e,t){var r=e.callerId,n=e.calledId,i=t.mediaProperties,a=i.callType;(Ext.isEmpty(e.callerId)||Ext.isEmpty(e.calledId))&&((a===Terrasoft.FinesseCallType.OUT||-1!==this.callTypesWithMediaProperties.indexOf(a)&&e.direction===Terrasoft.CallDirection.OUT)&&e.direction===Terrasoft.CallDirection.OUT?(e.callerId=this.deviceId,e.calledId=i.dialedNumber):this.isAcdIn(a)?(e.callerId=t.fromAddress,e.calledId=i.DNIS||this.deviceId):a!==Terrasoft.FinesseCallType.CONFERENCE&&(e.callerId=t.fromAddress,e.calledId=t.toAddress));a!==Terrasoft.FinesseCallType.CONSULT_OFFERED&&a!==Terrasoft.FinesseCallType.TRANSFER||this.updateCallAfterConsultationFinished(e,t.participants.Participant),e.isInfoChanged=r!==e.callerId||n!==e.calledId},setRedirectionProperties:function(e,t){var r=this.activeCalls;if(t.mediaProperties.callType===Terrasoft.FinesseCallType.TRANSFER&&2===r.getCount()){var n=this.activeCallId,i=e.id===n,a=i?e:r.find(n),s=i?r.getByIndex(1):e;a&&s&&(a.redirectingId=s.calledId,a.redirectionId=s.callerId)}},updateCallAfterConsultationFinished:function(e,t){if(Ext.isArray(t)&&2===t.length){var r=this.deviceId,n=_.reject(t,(function(e){return e.mediaAddress===r})),i=e.direction===Terrasoft.CallDirection.OUT?e.calledId:e.callerId;Ext.isEmpty(n)||1!==n.length||n[0].mediaAddress===i||(i=n[0].mediaAddress,e.direction===Terrasoft.CallDirection.OUT?e.calledId=i:e.callerId=i)}},fireCallEventByState:function(e){var t;if(e.state!==e.oldState)switch(e.state){case Terrasoft.GeneralizedCallState.ALERTING:t="callStarted";break;case Terrasoft.GeneralizedCallState.CONNECTED:t="commutationStarted";break;case Terrasoft.GeneralizedCallState.HOLDED:t="hold";break;case Terrasoft.GeneralizedCallState.NONE:t="callFinished"}else e.isInfoChanged?t="callInfoChanged":e.id===this.activeCallId&&e.isCallFeaturesSetChanged&&this.fireLineStateChangedEvent(e.id,e.callFeaturesSet);e.isInfoChanged=!1,e.isCallFeaturesSetChanged=!1,Ext.isEmpty(t)||this.fireCallEvent(e,t)},fireCallEvent:function(e,t){this.fireEvent(t,e)},fireLineStateChangedEvent:function(e,t){this.fireEvent("lineStateChanged",{callId:e,callFeaturesSet:t})},onBoshClientConnected:function(e){var t=e.Scope;t.log("Bosh Client Connected"),this.boshClient.sendPresence(),t.fireEvent("rawMessage","Connected")},onBoshClientError:function(e){var t=e.xml,r={internalErrorCode:t,data:Terrasoft.Resources.Telephony.Exception.UnknownBoshException,source:"Finesse(Bosh)",errorType:Terrasoft.MsgErrorType.GENERAL_ERROR};if(!Ext.isEmpty(t)){var n=this.xmlToJson(t);Terrasoft.each(n.error,(function(e,t){t===this.jabberNotAuthorizedErrorCode&&(r.errorType=Terrasoft.MsgErrorType.AUTHENTICATION_ERROR,r.data=Terrasoft.Resources.Telephony.Exception.NotAuthorizedException)}),this)}this.fireEvent("error",r)},onFinesseEvent:function(e){var t=Ext.global.jQuery(e.selected).text();this.processFinesseEvent(t)},processFinesseEvent:function(e){this.fireEvent("rawMessage",e);var t=this.xmlToJson(e),r=Terrasoft.decode(t);if(!Ext.isEmpty(r)&&r.Update){var n=r.Update.data;if(n.user&&!Ext.isEmpty(n.user.state)&&this.agentId===n.user.loginId&&this.userStateChanged(n.user.state,n.user.reasonCodeId),Ext.isEmpty(n.dialogs)&&Ext.isEmpty(n.dialog)||this.dialogStateChanged(r),n.apiErrors){var i=n.apiErrors.apiError;this.onFinesseError(i)}}},onActiveCallAdded:function(){if(1===this.activeCalls.getCount()){var e=this.activeCalls.getByIndex(0);this.activeCallId=e.id}},onActiveCallRemoved:function(){if(0===this.activeCalls.getCount())this.activeCallId="",this.fireEvent("lineStateChanged",{callFeaturesSet:Terrasoft.CallFeaturesSet.CAN_DIAL});else if(Ext.isEmpty(this.activeCalls.find(this.activeCallId))){var e=this.activeCalls.getByIndex(0);this.activeCallId=e.id}},onActiveCallsCleared:function(){this.activeCallId=""},onUpdateDbCall:function(e,t,r){var n=r.responseText,i=Terrasoft.isGUID(n)?n:Terrasoft.decode(n);if(t&&Terrasoft.isGUID(i)){var a=Terrasoft.decode(e.jsonData).id,s=this.activeCalls.find(a);Ext.isEmpty(s)||(s.databaseUId=i,this.fireEvent("callSaved",s))}else{this.fireEvent("rawMessage","Update Call error");var o={internalErrorCode:null,data:n,source:"App server",errorType:Terrasoft.MsgErrorType.COMMAND_ERROR};this.fireEvent("error",o)}},userStateChanged:function(e,t,r){var n=this.userState!==e||this.userStateReasonCode!==t;if(this.userState=e,this.userStateReasonCode=t,e&&n&&(this.fireEvent("agentStateChanged",{userState:e,userStateReasonCode:t}),this.lastNotReadyStateReasonCode=e===Terrasoft.FinesseAgentState.NOT_READY?t:this.lastNotReadyStateReasonCode,0===this.activeCalls.getCount())){var i=Ext.isEmpty(r)?Terrasoft.CallFeaturesSet.CAN_NOTHING:r,a=e===Terrasoft.FinesseAgentState.NOT_READY||e===Terrasoft.FinesseAgentState.READY?Terrasoft.CallFeaturesSet.CAN_DIAL:i;this.fireEvent("lineStateChanged",{callFeaturesSet:a})}},dialogStateChanged:function(e){var t=e.Update.data.dialog;if(!Ext.isEmpty(e.Update.data.dialogs)){var r=e.Update.data.dialogs;t=Ext.isArray(r)?r[0]:r.Dialog}if(!Ext.isEmpty(t)&&t.mediaType===Terrasoft.FinesseDialogMediaType.VOICE){var n=this.processFinesseDialog(t);Ext.isEmpty(n)||(this.updateDbCall(n,this.onUpdateDbCall),this.fireCallEventByState(n,t))}},onFinesseError:function(e){this.logError(this.finesseErrorMessageTemplate,Terrasoft.encode(e)),Terrasoft.Logger.error(this.finesseErrorMessageTemplate,Terrasoft.encode(e));var t={internalErrorCode:e.errorType,data:Terrasoft.Resources.Telephony.Exception.UnknownFinesseException,source:"Finesse",errorType:Terrasoft.MsgErrorType.GENERAL_ERROR};switch(e.errorType){case Terrasoft.FinesseErrorType.DEVICE_BUSY:t.data=Terrasoft.Resources.Telephony.Exception.ExtensionBusyByAnotherUser,t.errorType=Terrasoft.MsgErrorType.OPEN_CONNECTION_ERROR,this.fireEvent("error",t),this.closeConnection();break;case Terrasoft.FinesseErrorType.INVALID_DEVICE:t.data=Terrasoft.Resources.Telephony.Exception.InvalidDevice,t.errorType=Terrasoft.MsgErrorType.OPEN_CONNECTION_ERROR,this.fireEvent("error",t),this.closeConnection();break;default:this.fireEvent("error",t)}},onLoginMsgService:function(e,t,r){if(t&&Terrasoft.isGUID(r.responseText.replace(/\"/g,""))){Terrasoft.SysSettings.querySysSettings(["SysMsgFinesseDefaulNotReadyReasonCode"],(function(e){if(this.defaultNotReadyReasonCode=e.SysMsgFinesseDefaulNotReadyReasonCode,Ext.isEmpty(this.defaultNotReadyReasonCode)){var t=Ext.String.format(Terrasoft.Resources.Telephony.Exception.DefaultNotReadyReasonCodeNotSetFromSysSettings,"SysMsgFinesseDefaulNotReadyReasonCode");this.logError(t),Terrasoft.Logger.error(t)}else this.connect(this.initialConfig.connectionConfig)}),this)}else{this.fireEvent("rawMessage","LogInMsgService error");var n={internalErrorCode:null,data:r.responseText,source:"App server",errorType:Terrasoft.MsgErrorType.AUTHENTICATION_ERROR};this.fireEvent("error",n)}},_loadJabberwerxIfExist:function(e){var t=function(){e()};require(["jQuery","x2js"],(function(){require(["jqueryMigrate"],(function(){var r=Date.prototype.toJSON;require(["jabberwerx"],(function(){Date.prototype.toJSON=r,e()}),t)}),t)}),t)},constructor:function(){this.callParent(arguments),this.activeCalls=Ext.create("Terrasoft.Collection"),this.activeCalls.on("add",this.onActiveCallAdded,this),this.activeCalls.on("remove",this.onActiveCallRemoved,this),this.activeCalls.on("clear",this.onActiveCallsCleared,this)},init:function(){this.callParent(arguments);var e=function(){this.loginMsgService(this.msgUtilServiceUrl+this.loginMethodName,{LicInfoKeys:this.licInfoKeys,UserUId:Terrasoft.SysValue.CURRENT_USER.value})}.bind(this);this._loadJabberwerxIfExist(e)},closeConnection:function(){this.boshClient.disconnect()},getAgentLogoutCode:function(){return Terrasoft.FinesseAgentState.LOGOUT},makeCall:function(e){this.makeFinesseCall(e)},answerCall:function(e){this.takeFinesseAction(e.id,Terrasoft.FinesseDialogAction.ANSWER)},holdCall:function(e){var t=e.state===Terrasoft.GeneralizedCallState.HOLDED?Terrasoft.FinesseDialogAction.RETRIEVE:Terrasoft.FinesseDialogAction.HOLD;this.takeFinesseAction(e.id,t)},dropCall:function(e){this.takeFinesseAction(e.id,Terrasoft.FinesseDialogAction.DROP)},makeConsultCall:function(e,t){this.makeFinesseConsultCall(e.id,t)},transferCall:function(e){this.takeFinesseAction(e.id,Terrasoft.FinesseDialogAction.TRANSFER)},cancelTransfer:function(e,t){this.dropCall(t),this.holdCall(e)},blindTransferCall:function(e,t){this.makeBlindTransferCall(e.id,t)},setUserState:function(e,t,r){e===Terrasoft.FinesseAgentState.NOT_READY&&(t=Ext.isEmpty(t)||t===Terrasoft.FinesseAgentStateReason.UNKNOWN?this.defaultNotReadyReasonCode:t),this.setFinesseAgentState(e,t,r)},setWrapUpUserState:function(e,t){if(!e){var r,n;if(this.userState===Terrasoft.FinesseAgentState.WORK_READY)r=Terrasoft.FinesseAgentState.READY,n=null;else{if(this.userState!==Terrasoft.FinesseAgentState.WORK)return void(Ext.isFunction(t)&&t.call(this));r=Terrasoft.FinesseAgentState.NOT_READY,n=this.lastNotReadyStateReasonCode}this.setUserState(r,n,t)}},queryUserState:function(){this.getFinesseAgentState()},sendDtmf:function(){},queryActiveCallSnapshot:function(){},queryLineState:function(){},getCapabilities:function(){return{callCapabilities:Terrasoft.CallFeaturesSet.CAN_RECALL|Terrasoft.CallFeaturesSet.CAN_DIAL|Terrasoft.CallFeaturesSet.CAN_DROP|Terrasoft.CallFeaturesSet.CAN_HOLD|Terrasoft.CallFeaturesSet.CAN_UNHOLD|Terrasoft.CallFeaturesSet.CAN_COMPLETE_TRANSFER|Terrasoft.CallFeaturesSet.CAN_BLIND_TRANSFER|Terrasoft.CallFeaturesSet.CAN_MAKE_CONSULT_CALL|Terrasoft.CallFeaturesSet.CAN_DTMF,agentCapabilities:Terrasoft.AgentFeaturesSet.CAN_NOTHING}},onCallFinished:function(e){this.isEmpty(e.databaseUId)||e.databaseUId===Terrasoft.GUID_EMPTY||this.callParent(arguments)}}),Ext.ns("Terrasoft.json"),Terrasoft.ObjectModificationType={NONE:0,INSERT:1,REMOVE:2,MERGE:3,REMOVE_PROPERTY:4,CHANGE_POSITION:5,MOVE:6},Terrasoft.json.ObjectModificationType=Terrasoft.ObjectModificationType,Ext.define("Terrasoft.json.JsonDiffer",{extend:"Terrasoft.BaseObject",alternateClassName:"Terrasoft.JsonDiffer",singleton:!0,patch:null,objectProperties:{parent:"parentName",parentPropertyName:"propertyName",index:"index",operationalName:"__operationalName",name:"name",root:"__root",patchDiffNodeTypeSymbol:"_t"},pathDelimiter:"(#@",moveOperationProperties:["parentName","propertyName","index"],operationalValues:{},constructor:function(){this.callParent(arguments);var e=window.jsondiffpatch;e.config.objectHash=function(e){if(Ext.isString(e.name))return e.name},this.patch=e},needFlatten:function(e,t){var r=t||!1;return(r=!Ext.isEmpty(null==e?void 0:e.name))||(Ext.isArray(e)&&e.length>0?r=!Ext.isEmpty(e[0].name):Ext.isObject(e)&&Terrasoft.each(e,(function(e){r=this.needFlatten(e,r)}),this)),r},_getFlattenObjectKey:function(e,t,r){return r&&r.identifyItemByPath?e:t},flattenObject:function(e,t,r,n,i,a){var s,o=t||{},l=r||"";if(Ext.isEmpty(e))o=null;else if(Ext.isArray(e))for(var c=0,u=e.length;c<u;c++)s=this._getFlattenObjectKey(l,r,a),this.flattenObject(e[c],o,s,c,i,a);else{var h=Terrasoft.deepClone(e),f=h.name,d=Ext.isEmpty(l)?"{1}":"{0}{1}";if(l+=Ext.String.format(d,this.pathDelimiter,f),s=this._getFlattenObjectKey(l,f,a),Ext.isEmpty(s))throw new Terrasoft.UnsupportedTypeException({message:Ext.String.format(Terrasoft.Resources.JsonDiffer.Exception.RequiredParameterNotFound,this.objectProperties.name)});if(o[s])throw new Terrasoft.ItemAlreadyExistsException({message:Ext.String.format(Terrasoft.Resources.JsonDiffer.Exception.ItemNameAlreadyExists,f)});delete h.name,Ext.isEmpty(r)||(h.parentName=r),Ext.isEmpty(n)||(h.index=n),Ext.isEmpty(i)||(h.propertyName=i);var p=[],m=[];Terrasoft.each(h,(function(e,t){if(e&&this.needFlatten(e)){p.push(e),m.push(t);var r=h[t];h[t]=Ext.isArray(r)?[]:{}}}),this),o[s]=h;var g=p.length;if(g>0)for(var T=0;T<g;T++)this.flattenObject(p[T],o,s,T,m[T],a)}return o},includeObjectOperations:function(e,t){var r=e||[];return t===Terrasoft.ObjectModificationType.REMOVE?r=[Terrasoft.ObjectModificationType.REMOVE]:Ext.Array.include(r,t),r},getObjectCollectionPropertyNames:function(e,t){var r=t||{},n=this.objectProperties,i=n.parentPropertyName,a=n.parent;return Terrasoft.each(e,(function(e){var t=e[i],n=e[a];Ext.isEmpty(n)||Ext.isEmpty(t)||(r[n]=r[n]||[],Ext.Array.include(r[n],t))}),this),r},getCollectionPropertyNames:function(){var e=this.operationalValues,t=e.flatPrimaryObject,r=e.flatModifiedObject,n={};return n=this.getObjectCollectionPropertyNames(t,n),n=this.getObjectCollectionPropertyNames(r,n)},getObjectOperations:function(e){var t=this.objectProperties,r=this.operationalValues.primaryObject,n=this.operationalValues.modifiedObject,i=this.operationalValues.flatModifiedObject,a=this.operationalValues.flatDelta,s=Terrasoft.deepClone(n);this.addOperationalNames(s);var o=this.makeDiff(r,s),l={},c=this.getCollectionPropertyNames();return Terrasoft.each(a,(function(e,r){this.isAdded(e)?l[r]=this.includeObjectOperations(l[r],Terrasoft.ObjectModificationType.INSERT):this.isRemoved(e)?l[r]=this.includeObjectOperations(l[r],Terrasoft.ObjectModificationType.REMOVE):Terrasoft.each(e,(function(e,n){if(Terrasoft.contains([t.parent,t.parentPropertyName],n))(this.isAdded(e)||this.isModified(e)||this.isRemoved(e))&&(l[r]=this.includeObjectOperations(l[r],Terrasoft.ObjectModificationType.MOVE));else if(n===t.index){if(this.isAdded(e)||this.isModified(e)||this.isRemoved(e)){var a=i[r],s=a[t.parent]||t.root,o=a[t.parentPropertyName]||t.root,u=c[s]||[];Ext.Array.include(u,o),c[s]=u}}else this.isRemoved(e)?l[r]=this.includeObjectOperations(l[r],Terrasoft.ObjectModificationType.REMOVE_PROPERTY):l[r]=this.includeObjectOperations(l[r],Terrasoft.ObjectModificationType.MERGE)}),this)}),this),l=this.getObjectChangePositionOperations(o,c,l,a,e)},getObjectChangePositionOperations:function(e,t,r,n,i){var a=r||{},s=[];Terrasoft.each(t,(function(r,a){var o;if(a===this.objectProperties.root)o=this.getChangePositionObjectName(e,n,a),s=Ext.Array.merge(s,o);else{var l=this._getModifiedObjectSimpleName(a),c=this.findOperationDeltaItem(l,e);if(c)for(var u=t[a].shift();!Ext.isEmpty(u);){var h=c[u];o=this.getChangePositionObjectName(h,n,a,i),s=Ext.Array.merge(s,o),u=t[a].shift()}}}),this);for(var o=s.shift();!Ext.isEmpty(o);)a[o]=this.includeObjectOperations(a[o],Terrasoft.ObjectModificationType.CHANGE_POSITION),o=s.shift();return a},getChangePositionObjectName:function(e,t,r,n){var i=[],a=this.objectProperties.patchDiffNodeTypeSymbol;return Terrasoft.each(e,(function(s,o){if(o!==a&&Terrasoft.contains(o,"_")&&this.isMoved(s)){var l=s[1],c=e[l];if(c){var u=c[this.objectProperties.operationalName][0],h=this._getChangePositionObjectPath(u,t,r,n);i.push(h)}}}),this),i},findOperationDeltaItem:function(e,t,r){var n=Terrasoft.deepClone(t),i=r,a=n[this.objectProperties.operationalName];return(a?a[0]:null)===e?i=n:i||(delete n[this.objectProperties.operationalName],Terrasoft.each(n,(function(t){(Ext.isArray(t)||Ext.isObject(t))&&(i=this.findOperationDeltaItem(e,t,i))}),this)),i},addOperationalNames:function(e){e.hasOwnProperty(this.objectProperties.name)&&(e[this.objectProperties.operationalName]=e[this.objectProperties.name]),(Ext.isObject(e)||Ext.isArray(e))&&Terrasoft.each(e,(function(e){e&&this.addOperationalNames(e)}),this)},_getModifiedObjectSimpleName:function(e){return e.split(this.pathDelimiter).pop()},_getChangePositionObjectPath:function(e,t,r,n){return!0===(null==n?void 0:n.identifyItemByPath)?"".concat(r).concat(this.pathDelimiter).concat(e):e},getObjectResultOperations:function(e){var t=[];return Terrasoft.each(e,(function(e,r){for(var n=0,i=e.length;n<i;n++){var a=e[n],s={operation:this.getObjectModificationTypeName(a),name:this._getModifiedObjectSimpleName(r)};switch(a){case Terrasoft.ObjectModificationType.INSERT:Ext.apply(s,this.getOperationValues(r,a)),Ext.apply(s,this.getOperationMoveProperties(r)),t.push(s);break;case Terrasoft.ObjectModificationType.CHANGE_POSITION:case Terrasoft.ObjectModificationType.MOVE:Ext.apply(s,this.getOperationMoveProperties(r)),t.push(s);break;case Terrasoft.ObjectModificationType.REMOVE_PROPERTY:Ext.apply(s,this.getOperationRemovedProperties(r)),s.properties.length>0&&t.push(s);break;case Terrasoft.ObjectModificationType.MERGE:Ext.apply(s,this.getOperationValues(r,a)),s.values&&t.push(s);break;default:t.push(s)}}}),this),t},getOperationMoveProperties:function(e){for(var t=this.operationalValues.flatModifiedObject[e],r={},n=this.moveOperationProperties,i=0,a=n.length;i<a;i++){var s=n[i],o=t[s];Ext.isEmpty(o)||("parentName"===s&&(o=this._getModifiedObjectSimpleName(o)),r[s]=o)}return r},getOperationRemovedProperties:function(e){var t=this.operationalValues.flatDelta,r={},n=[],i=t[e];return Terrasoft.each(i,(function(e,t){this.isRemoved(e)&&n.push(t)}),this),r.properties=n,r},getOperationValues:function(e,t){var r,n=this.operationalValues.flatModifiedObject,i=this.operationalValues.flatDelta,a={},s={};switch(t){case Terrasoft.ObjectModificationType.INSERT:r=n[e],Terrasoft.each(r,(function(e,t){Terrasoft.contains(this.moveOperationProperties,t)||(s[t]=Terrasoft.deepClone(e))}),this);break;case Terrasoft.ObjectModificationType.MERGE:r=i[e],Terrasoft.each(r,(function(t,r){var i;Terrasoft.contains(this.moveOperationProperties,r)||this.isRemoved(t)||(i="a"===t[this.objectProperties.patchDiffNodeTypeSymbol]||Ext.isObject(t)&&!Ext.Object.isEmpty(t)?n[e][r]:this.isAdded(t)?t[0]:t[1],s[r]=i)}),this)}return Ext.Object.isEmpty(s)||(a.values=s),a},getObjectModificationTypeName:function(e){var t;switch(e){case Terrasoft.ObjectModificationType.INSERT:t="insert";break;case Terrasoft.ObjectModificationType.REMOVE:case Terrasoft.ObjectModificationType.REMOVE_PROPERTY:t="remove";break;case Terrasoft.ObjectModificationType.MOVE:case Terrasoft.ObjectModificationType.CHANGE_POSITION:t="move";break;case Terrasoft.ObjectModificationType.MERGE:t="merge"}return t},isAdded:function(e){return 1===e.length},isModified:function(e){return 2===e.length},isMoved:function(e){return 3===e.length&&3===e[2]},isRemoved:function(e){return 3===e.length&&0===e[2]},makeDiff:function(e,t){if(!this.patch)throw new Terrasoft.NullOrEmptyException({message:Terrasoft.Resources.JsonDiffer.Exception.JsonDiffPatchIsNotDefined});return this.patch.diff(e,t)},getFlatObject:function(e,t){return this.flattenObject(e,null,null,null,null,t)||{}},getJsonDiff:function(e,t,r){var n=this,i=[];try{var a=this.makeDiff(e,t);if(a){var s=this.getFlatObject(e,r),o=this.getFlatObject(t,r),l=this.makeDiff(s,o);this.operationalValues={primaryObject:e,modifiedObject:t,delta:a,flatPrimaryObject:s,flatModifiedObject:o,flatDelta:l};var c=this.getObjectOperations(r);i=this.getObjectResultOperations(c)}}finally{Terrasoft.each(this.operationalValues,(function(e,t){delete n.operationalValues[t]})),this.operationalValues={}}return i}}),Ext.define("Terrasoft.json.JsonApplier",{extend:"Terrasoft.BaseObject",alternateClassName:"Terrasoft.JsonApplier",singleton:!0,sourceObject:null,memoryStore:null,operationRequiredParameters:{insert:[],set:["name","values"],merge:["name","values"],move:["name"],remove:["name"]},operationParameterName:"operation",aliases:null,removeFromCache:function(e){Terrasoft.iterateChildItems(e,(function(e){var t=e.item;this.memoryStore.removeItem(t.name)}),this),this.memoryStore.removeItem(e.name)},findItemInfo:function(e,t){if(Ext.isEmpty(e))return null;var r=this.memoryStore.getItem(e);if(r)return r;var n=this.aliases,i=n&&n[e],a=i&&i.name,s=null;return Terrasoft.iterateChildItems(t,(function(t){var r=t.item,n=a&&r.name===a,i=r.name===e||n;if(!t.childIterationResult||i){var o={item:r,parentName:t.parent.name,propertyName:t.propertyName};this.memoryStore.setItem(r.name,o),i&&(s=o)}return!i}),this),s},findItemInfoInSourceObject:function(e){var t={items:this.sourceObject};return this.findItemInfo(e,t)},checkRequiredParameters:function(e,t){Ext.isEmpty(t)||Terrasoft.each(t,(function(t){if(!e[t]){var r=Ext.String.format(Terrasoft.Resources.JsonApplier.Exception.RequiredParameterNotFound,t);throw new Terrasoft.InvalidObjectState({message:r})}}),this)},getSplittedOperations:function(e){var t={merge:[],set:[],removeProperties:[],remove:[],move:[],insert:[]};return Terrasoft.each(e,(function(e){this.checkOperation(e);var r=e.operation;if(!this.isExcludeAliasOperation(e.name,r,e.properties))switch(r){case"merge":t.merge.push(e);break;case"set":t.set.push(e);break;case"insert":t.insert.push(e);break;case"move":t.move.push(e);break;case"remove":var n=e.properties;n&&Ext.isArray(n)?t.removeProperties.push(e):t.remove.push(e)}}),this),t},convertMoveOperationToRemove:function(e){var t={},r=e.name,n=Terrasoft.deepClone(this.findItemInfoInSourceObject(r));return n&&(t={parentName:n.parentName||n.nameTo,propertyName:n.propertyName,index:n.propertyName,operation:"remove",name:r}),t},convertMoveOperationToInsert:function(e){var t={},r=e.name,n=Terrasoft.deepClone(this.findItemInfoInSourceObject(r));if(n){var i={values:n.item};delete i.values.name,Ext.apply(i,e),i.operation="insert",t=i}return t},applyOperations:function(e){var t=this.getSplittedOperations(e);this.applyOperationGroup(this.merge,t.merge),this.applyChangePositionOperationGroup(t.remove,t.insert,t.move),this.applyOperationGroup(this.remove,t.removeProperties),this.applyOperationGroup(this.set,t.set)},filterMoveOperation:function(e,t){return Terrasoft.each(e,(function(e){t=Ext.Array.filter(t,(function(t){return e.name!==t.name}))}),this),t},applyChangePositionOperationGroup:function(e,t,r){r=this.filterMoveOperation(e,r),Ext.Array.insert(e,e.length,r);var n=[];Terrasoft.each(e,(function(e){var t=this.convertMoveOperationToRemove(e);Terrasoft.isEmptyObject(t)?console.log("Element "+e.name+"was not moved."):n.push(t)}),this),n=this.getOperationsSequenceByPath(n,!1);var i=[],a=this.getObjectNameOperationsGroup(r);Terrasoft.each(n,(function(e){var t=this,r=a[e.name];Ext.isArray(r)&&r.forEach((function(e){var r=t.convertMoveOperationToInsert(e);Terrasoft.isEmptyObject(r)?console.log("Element "+e.name+"was not moved."):i.push(r)})),this.remove(e)}),this),Ext.Array.insert(t,t.length,i),t=this.getOperationsSequenceByPath(t,!0);var s=this.applyOperationGroup(this.insert,t);Ext.isArray(s)&&s.length>0&&this.applyUnsuccessfulInsertOperationGroup(s)},applyUnsuccessfulInsertOperationGroup:function(e){var t=this;e.forEach((function(r,n){r.operation="move",t.findItemInfoInSourceObject(r.parentName)||e.splice(n,1)})),e.length>0&&this.applyChangePositionOperationGroup([],[],e)},applyOperationGroup:function(e,t){var r=[];return Terrasoft.each(t,(function(t){e.call(this,t)||r.push(t)}),this),r},getObjectNameOperationsGroup:function(e){var t={};return e.forEach((function(e){var r=e.name;t[r]=t[r]||[],t[r].push(e)})),t},getOperationHierarchy:function(e){var t={};return e.forEach((function(e){var r=e.name,n=e.parentName||"_",i=e.propertyName||"_";t[r]={parentName:n,propertyName:i}})),t},getOperationItemPath:function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"",n=r;if(t[e]){var i=t[e].parentName,a=t[e].propertyName;n=i+"="+a+"=="+n,n=this.getOperationItemPath(i,t,n)}return n},addOperationItemPathInfo:function(e){var t=this,r=[],n=this.getOperationHierarchy(e);return e.forEach((function(e){e.__path=t.getOperationItemPath(e.name,n),r.push(e)})),r},getOperationPathGroupsInfo:function(e,t){var r=t?1:-1,n={},i=[];return e.forEach((function(e){var t=e.__path;n[t]=n[t]||[],n[t].push(e),Ext.Array.include(i,t)})),{groups:n,order:i.sort((function(e,t){return e.length===t.length?0:e.length>t.length?r:-1*r}))}},getOperationsSequenceByPath:function(e,t){e=this.addOperationItemPathInfo(e);var r=this.getOperationPathGroupsInfo(e,t),n=r.order,i=r.groups,a=[];return Terrasoft.Features.getIsEnabled("UseJsonApplierOldSortFunction")?(n.forEach((function(e){var r=t?1:-1,n=i[e].sort((function(e,t){return e.index||t.index?e.index>t.index?r:-1*r:0}));Ext.Array.insert(a,a.length,n)})),a):(n.forEach((function(e){var r=_.sortBy(i[e],"index");t||r.reverse(),Ext.Array.insert(a,a.length,r)})),a)},saveAlias:function(e){if(!Ext.isEmpty(e.alias)){var t=Terrasoft.deepClone(e),r=t.alias;Ext.isEmpty(this.aliases)&&(this.aliases={});var n=r.name;r.name=t.name,this.aliases[n]=r}},resetAliases:function(){this.aliases=null},excludeAliasProperties:function(e,t){var r=Object.keys(t),n=this.aliases&&this.aliases[e],i=n&&n.excludeProperties;return i&&(r=Ext.Array.difference(r,i)),r},isExcludeAliasOperation:function(e,t,r){if(r&&"remove"===t)return!1;var n=this.aliases&&this.aliases[e],i=n&&n.excludeOperations;return Terrasoft.contains(i,t)},insert:function(e){var t,r=e.parentName,n=e.name;e.nameTo&&(t=Terrasoft.Resources.JsonApplier.ObsoleteMessages.ParameterNameObsolete,this.log(Ext.String.format(t,"nameTo","parentName"),Terrasoft.LogMessageType.ERROR),r=e.nameTo);var i=this.findItemInfoInSourceObject(r),a=!(!i&&e.parentName),s=e.values||{};this.saveAlias(e);var o=null===i?this.sourceObject:i.item[e.propertyName];if(Ext.isEmpty(n)?(t=Terrasoft.Resources.JsonApplier.ObsoleteMessages.PropertyInParameterObsolete,this.log(Ext.String.format(t,"values","name"),Terrasoft.LogMessageType.WARNING)):Ext.apply(s,{name:n}),Ext.isArray(o)){var l=Ext.isEmpty(e.index)?o.length:e.index;Ext.Array.insert(o,l,[s])}else{if(!Ext.isObject(o)){var c=Ext.String.format(Terrasoft.Resources.JsonApplier.Exception.NotContainerItemInsertException,r);throw new Terrasoft.InvalidOperationException({message:c})}i.item[e.propertyName]=s}return a},set:function(e){var t=e.parentName;if(e.nameTo){var r=Terrasoft.Resources.JsonApplier.ObsoleteMessages.ParameterNameObsolete;this.log(Ext.String.format(r,"nameTo","parentName"),Terrasoft.LogMessageType.ERROR),t=e.nameTo}var n=this.remove(e),i=!Ext.isEmpty(n);return i&&(e.index=n.index,e.nameTo=t,e.parentName=t,e.propertyName=n.propertyName),this.insert(e),i},merge:function(e){var t=this.findItemInfoInSourceObject(e.name),r=!Ext.isEmpty(t);if(r){Terrasoft.each(t.item,(function(t,r){var n=Ext.isArray(t)?t[0]:t;if(Terrasoft.isItemConfig(n)&&e.values.hasOwnProperty(r)){var i=Ext.String.format(Terrasoft.Resources.JsonApplier.Exception.ItemWithItemsPropertyMergeException,e.name,r);throw new Terrasoft.InvalidOperationException({message:i})}}),this);var n=this.excludeAliasProperties(e.name,e.values);Terrasoft.each(n,(function(r){t.item[r]=e.values[r]}),this)}return r},remove:function(e){var t={},r=this.findItemInfoInSourceObject(e.name);if(Ext.isEmpty(r))return null;var n=e.properties;if(n&&Ext.isArray(n)){var i=r.item;n.forEach((function(e){delete i[e]}))}else{var a=r.item,s=r.parentName;if(r.nameTo){var o=Terrasoft.Resources.JsonApplier.ObsoleteMessages.ParameterNameObsolete;this.log(Ext.String.format(o,"nameTo","parentName"),Terrasoft.LogMessageType.ERROR),s=r.nameTo}var l=this.findItemInfoInSourceObject(s),c=l?l.item[r.propertyName]:this.sourceObject,u=0;Ext.isArray(c)?(u=c.indexOf(a),c.splice(u,1)):delete l.item[r.propertyName],this.removeFromCache(a),t={index:u,item:a,nameTo:s,parentName:s,propertyName:r.propertyName}}return t},checkOperation:function(e){var t=e.name,r=e.parentName;if(!Ext.isEmpty(t)&&r===t)throw new Terrasoft.InvalidOperationException({message:Ext.String.format(Terrasoft.Resources.JsonApplier.Exception.LoopDependency,t)});this.checkRequiredParameters(e,[this.operationParameterName]);var n=e[this.operationParameterName];this.checkRequiredParameters(e,this.operationRequiredParameters[n])},applyDiff:function(e,t){var r;this.memoryStore=Ext.create("Terrasoft.MemoryStore"),this.sourceObject=Terrasoft.deepClone(e),Ext.isEmpty(e)&&this.resetAliases();try{var n=Terrasoft.deepClone(t);this.applyOperations(n),r=this.sourceObject}finally{this.sourceObject=null,this.memoryStore.destroy(),this.memoryStore=null}return r}}),Ext.ns("Terrasoft.utils.dragdrop"),Ext.define("Terrasoft.utils.dragdrop.Helper",{extend:"Terrasoft.BaseObject",alternateClassName:"Terrasoft.DragDropHelper",elements:null,targets:null,baseGroupName:"basegroup",ddItemOverride:{b4StartDrag:function(){var e=this.el=Ext.get(this.getEl());e.setWidth(e.getWidth()),e.setHeight(e.getHeight()),e.setStyle("position","absolute"),e.setStyle("z-index","11"),this.originalXY=e.getXY()},onDrag:function(e){var t=[e.getX()-this.deltaX,e.getY()-this.deltaY];this.el.setXY(t)},onInvalidDrop:function(){this.invalidDrop=!0},endDrag:function(){var e=this.el;if(!0===this.invalidDrop)return e.moveTo(this.originalXY[0],this.originalXY[1]),void delete this.invalidDrop;delete this.el},onDragDrop:function(e,t){var r=Ext.get(t);this.config.self.fireEvent("dragdrop",r,this.el)}},constructor:function(){this.callParent(arguments),this.clear(),this.initElements(),this.initTargets(),this.addEvents("dragdrop")},initElements:function(){Ext.dd.DragDropManager.notifyOccluded=!0;for(var e=this.elements,t=0,r=e.length;t<r;t++){e[t].initDD(this.baseGroupName,{isTarget:!1,self:this},this.ddItemOverride)}},initTargets:function(){for(var e=this.targets,t=0,r=e.length;t<r;t++){e[t].initDDTarget(this.baseGroupName,{self:this})}},clear:function(){Ext.dd.DragDropManager.ids[this.baseGroupName]={}}}),Ext.define("Terrasoft.core.mixins.OutdatedSchemaNotificationMixin",{alternateClassName:"Terrasoft.OutdatedSchemaNotificationMixin",useNotification:!1,isOutdated:!1,outdatedEventName:null,outdatedProperties:[],subscribeOnServerChannelMessage:function(){if(this.useNotification){if(!this.outdatedEventName)throw new Terrasoft.NullOrEmptyException;Terrasoft.ServerChannel.on(Terrasoft.ServerChannelSender.BROADCAST_MESSAGE,this.onBroadcastServerMessage,this)}},getIsOutdated:function(e){return e.event===this.outdatedEventName&&e.senderInstanceId!==this.instanceId},onOutdated:function(e){this.isOutdated=!0,this.fireEvent("outdated",e,this)},onBroadcastServerMessage:function(e,t){t&&this.getIsOutdated(t)&&this.onOutdated(t)},getNotifyMessage:function(e,t){return t=t||{},Ext.apply(t,{senderInstanceId:this.instanceId,event:e}),t},notify:function(e,t){if(this.useNotification){var r=this.getNotifyMessage(e,t);Terrasoft.ServerChannel.isOpened?Terrasoft.ServerChannel.broadcastMessage(r):this.error("Outdated schema notification error. Websoсket is not opened")}}}),Ext.define("Terrasoft.manager.BaseManagerItem",{extend:"Terrasoft.core.BaseObject",alternateClassName:"Terrasoft.BaseManagerItem",changes:{},id:null,isDeleted:!1,constructor:function(){this.callParent(arguments),this.addEvents("remove")},setPropertyValue:function(e,t){this.changes[e]=t},getId:function(){return this.id},getIsDeleted:function(){return this.isDeleted},remove:function(){this.isDeleted=!0,this.fireEvent("remove",this)},getCopyConfig:function(){var e={},t=this.getSerializedPropertiesConfig();return Terrasoft.each(t,(function(t,r){!1!==t.isCopy?e[r]=Terrasoft.deepClone(this[r]):Ext.isDefined(t.defCopyValue)&&(e[r]=t.defCopyValue)}),this),e},copy:function(){var e=this.getCopyConfig();return Ext.create(this.alternateClassName,e)},getSerializedPropertiesConfig:function(){return{id:{isCopy:!1,defCopyValue:Terrasoft.generateGUID()},changes:{},isDeleted:{isCopy:!1,defCopyValue:!1}}}}),Ext.define("Terrasoft.manager.BaseManager",{extend:"Terrasoft.core.BaseObject",alternateClassName:"Terrasoft.BaseManager",mixins:{outdatedSchemaNotificationMixin:"Terrasoft.OutdatedSchemaNotificationMixin"},filterFn:null,itemClassName:"Terrasoft.BaseManagerItem",items:null,onRemoveManagerItem:function(e){this.fireEvent("removeManagerItem",e,this)},refreshItemsCollection:function(){var e=this.items.filterByFn((function(e){return e.isDeleted}));return e.each((function(e){this.items.remove(e)}),this),e},constructor:function(){this.callParent(arguments),this.items=new Terrasoft.Collection,this.addEvents("removeManagerItem"),this.subscribeOnServerChannelMessage()},filterByFn:function(e,t){return this.items.filterByFn(e,t)},findByFn:function(e,t){return this.items.findByFn(e,t)},contains:function(e){return this.items.contains(e)},findItem:function(e){return this.items.find(e)},getItem:function(e){return this.items.get(e)},get:function(e){return this.getItem(e)},createManagerItem:function(e){return Ext.create(this.itemClassName,e)},addItem:function(e){if(!e)throw new Terrasoft.NullOrEmptyException;if(e.alternateClassName!==this.itemClassName)throw new Terrasoft.UnsupportedTypeException;return e.on("remove",this.onRemoveManagerItem,this),this.items.add(e.id,e)},copyItem:function(e){return this.getItem(e).copy()},remove:function(e){this.getItem(e).remove()},removeIfExists:function(e){var t=this.findItem(e);return!!t&&(t.remove(),!0)},getItems:function(e){var t;if((e=e||{}).useFilterFn){if(!Ext.isFunction(this.filterFn))throw new Terrasoft.InvalidObjectState({message:Terrasoft.Resources.Managers.Exceptions.FilterFunctionIsNotInitialized});t=this.items.filterByFn(this.filterFn)}else t=this.items;return t},save:function(){return this.refreshItemsCollection()},clear:function(){this.items.each((function(e){Terrasoft.safeDestroy(e)})),this.items.clear()}}),Ext.define("Terrasoft.manager.DataManagerItem",{extend:"Terrasoft.BaseManagerItem",alternateClassName:"Terrasoft.DataManagerItem",viewModel:null,constructor:function(e){this.callParent(arguments);var t=e.viewModel;if(!t)throw new Terrasoft.NullOrEmptyException;this.viewModel=t,this.id=e.id||t.get("Id")},onDestroy:function(){this.viewModel.destroy(),this.callParent(arguments)},setColumnValue:function(e,t){this.viewModel.set(e,t)},getColumnValue:function(e){return this.viewModel.get(e)},getPreviousColumnValue:function(e){return this.viewModel.getPrevious(e)},getColumnByName:function(e){return this.viewModel.columns[e]},getValues:function(){var e={},t=this.viewModel.columns;return Terrasoft.each(t,(function(t,r){e[r]=this.viewModel.get(r)}),this),e},getSaveQuery:function(){if(this.isDeleted){if(this.getIsNew())return null;var e=this.viewModel.getDeleteQuery(),t=this.viewModel.get(this.viewModel.primaryColumnName);return e.enablePrimaryColumnFilter(t),e}return this.viewModel.getSaveQuery()},getSaveLocalizationQuery:function(){var e=this;if(!this.propertyLczValues)return null;var t=this.getEntitySchemaName(),r=new Terrasoft.UpdateLocalizationQuery({rootSchemaName:t}),n=this.viewModel.get(this.viewModel.primaryColumnName);return r.filters.addItem(Terrasoft.createColumnFilterWithParameter(Terrasoft.ComparisonType.EQUAL,this.viewModel.primaryColumnName,n)),Object.entries(this.propertyLczValues).forEach((function(t){var n=_slicedToArray(t,2),i=n[0],a=n[1],s=(e.propertyColumnNames||[])[i]||i;r.setParameterValue(s,a.serialize(),Terrasoft.DataValueType.LOCALIZABLE_STRING)})),r},remove:function(){this.isDeleted=!0,this.viewModel.isDeleted=!0},discard:function(){if(this.getIsNew())throw Terrasoft.InvalidOperationException();this.isDeleted=!1,this.viewModel.isDeleted=!1,this.viewModel.changedValues=null;var e=this.viewModel.values;Terrasoft.each(e,(function(e,t){this.setColumnValue(t,e)}),this)},save:function(e,t){this.getSaveQuery().execute((function(r){e.call(t,r)}),this)},getIsNew:function(){return this.viewModel.isNew},getIsChanged:function(){return this.viewModel.getIsChanged()},setIsSaved:function(){this.viewModel.isNew=!1;var e=this.viewModel.changedValues;this.viewModel.values||(this.viewModel.values={});var t=this.viewModel.values;Terrasoft.each(e,(function(e,r){t[r]=e}),this),this.viewModel.changedValues=null},getEntitySchemaName:function(){return this.viewModel.entitySchema.name},getEntitySchemaCaption:function(){return this.viewModel.entitySchema.caption},getSerializedPropertiesConfig:function(){var e=this.callParent(arguments),t=this.viewModel,r=Ext.create("Terrasoft.BaseViewModel",{entitySchema:t.entitySchema,columns:Terrasoft.deepClone(t.columns)});return Terrasoft.each(r.columns,(function(e,n){r.set(n,Terrasoft.deepClone(t.get(n)))})),r.set(r.entitySchema.primaryColumnName,Terrasoft.generateGUID()),Ext.apply(e,{id:{isCopy:!1,defCopyValue:r.get(r.entitySchema.primaryColumnName)},viewModel:{isCopy:!1,defCopyValue:r}}),e},reload:function(e,t){this.getIsNew()?e.call(t):this.viewModel.loadEntity(this.id,(function(){e.call(t)}),this)}}),Ext.define("Terrasoft.manager.DataManager",{extend:"Terrasoft.BaseObject",alternateClassName:"Terrasoft.DataManager",singleton:!0,dataStore:{},itemClassName:"Terrasoft.DataManagerItem",checkAreEmpty:function(e,t){Terrasoft.each(t,(function(t){if(Ext.isEmpty(e[t]))throw new Terrasoft.ArgumentNullOrEmptyException({argumentName:t})}),this)},createManagerItem:function(e){return Ext.create(this.itemClassName,e)},loadItem:function(e,t,r,n){var i=this,a=i.findItem(e,t);a?r.call(n,a):require([e],(function(e){var s=i.getViewModelColumns(e.columns),o=Ext.create("Terrasoft.BaseViewModel",{entitySchema:e,columns:s});o.loadEntity(t,(function(){if(!o.get("Id"))throw new Terrasoft.ItemNotFoundException;a=i.createManagerItem({viewModel:o}),r.call(n,a)}),this)}))},getDataStore:function(){return this.dataStore},getEntitySchemaData:function(e){return this.getDataStore()[e]},getViewModelColumns:function(e){var t=Terrasoft.deepClone(e);return Terrasoft.each(t,(function(e,t){e.type=Terrasoft.ViewModelColumnType.ENTITY_COLUMN,e.columnPath=t}),this),t},_loadEntitySchemaData:function(e,t,r){var n=e.entitySchemaName;Terrasoft.chain((function(e){Terrasoft.require([n],e,this)}),(function(t,r){e._entitySchema=r,this._getEntitySchemaData(e,t,this)}),(function(i,a){if(a.success){var s=new Terrasoft.Collection;e.addToStore&&this.initEntitySchemaDataCollection(n,s),a.collection.each((function(e){e.columns=this.getViewModelColumns(e.columns);var t=this.createManagerItem({viewModel:e});s.add(t.getId(),t)}),this),t.call(r,s)}}),this)},_getEntitySchemaData:function(e,t,r){var n=e.filters||null,i=e._entitySchema,a=new Terrasoft.EntitySchemaQuery({rootSchema:i,ignoreDisplayValues:e.ignoreDisplayValues});this._prepareEntitySchemaQueryColumns(a,{entitySchemaColumns:Ext.Object.getKeys(i.columns),columnsInfo:e.columnsInfo,lazyLoadingColumns:e.lazyLoadingColumns,allColumns:!Ext.isDefined(e.allColumns)||e.allColumns}),n&&a.filters.addItem(n),a.getEntityCollection(t,r)},_prepareEntitySchemaQueryColumns:function(e,t){var r=t.entitySchemaColumns,n=t.columnsInfo||[],i=t.lazyLoadingColumns||[],a=n.map((function(e){return e.columnName}),this);t.allColumns&&(a=Ext.Array.merge(r,a)),Terrasoft.each(a,(function(t){var r={columnName:t},a=Terrasoft.findWhere(n,r)||r,s=this._addColumn(e,a);Terrasoft.contains(i,t)&&(s.isVisible=!1)}),this)},_addColumn:function(e,t){var r=t.columnName,n=t.columnPath;return Ext.isEmpty(n)?e.addColumn(r):e.addColumn(n,r)},initEntitySchemaDataCollection:function(e,t){var r=this.getDataStore();return r[e]=t||new Terrasoft.Collection,r[e]},findItem:function(e,t){var r,n=this.getEntitySchemaData(e);return n&&(r=n.find(t)),r},select:function(e,t,r){this.checkAreEmpty(e,["entitySchemaName"]),r=r||this;var n=e.entitySchemaName,i=this.getEntitySchemaData(n);if(i)t.call(r,i);else{this._loadEntitySchemaData(e,(function(e){t.call(r,e)}),r)}},createItem:function(e,t,r){this.checkAreEmpty(e,["entitySchemaName"]);var n=e.entitySchemaName;Terrasoft.require([n],(function(n){var i=this.getViewModelColumns(n.columns),a=Ext.Object.merge(i,e.columns),s=Ext.create("Terrasoft.BaseViewModel",{entitySchema:n,columns:a});s.setDefaultValues((function(){var n=this.createManagerItem({viewModel:s}),i=e.columnValues||{};Terrasoft.each(i,(function(e,t){n.setColumnValue(t,e)}),this),t.call(r,n)}),this)}),this)},addItem:function(e){var t=e.getEntitySchemaName();return this.initEntitySchemaDataCollection(t,this.getEntitySchemaData(t)).add(e.getId(),e)},remove:function(e,t,r){this.checkAreEmpty(e,["entitySchemaName","primaryColumnValue"]);var n=e.entitySchemaName,i=e.primaryColumnValue;this.loadItem(n,i,(function(e){e.remove(),t.call(r,e)}),this)},removeItem:function(e){var t=e.getEntitySchemaName(),r=this.getEntitySchemaData(t);r&&(r.remove(e),e.destroy(),e=null)},update:function(e,t,r){var n=this;this.checkAreEmpty(e,["entitySchemaName","primaryColumnValue","columnValues"]);var i=e.entitySchemaName,a=e.primaryColumnValue,s=e.columnValues;n.loadItem(i,a,(function(e){Terrasoft.each(s,(function(t,r){e.setColumnValue(r,t)}),n),t.call(r,e)}),n)},discardItem:function(e){return e.getIsNew()?this.removeItem(e):e.discard(),e},executeUpdatePackageSchemaDataRequest:function(e,t,r){Ext.create("Terrasoft.UpdatePackageSchemaDataRequest",e).execute((function(e){t.call(r,e)}),this)},getSummaryUpdatePackageSchemaDataResponse:function(e){var t={success:!0};return Terrasoft.each(e,(function(e){e&&!e.success&&(t.success=!1,t.message=e.errorInfo.toString())})),t},updatePackageSchemaData:function(e,t,r,n){var i=[],a=t.packageSchemaDataNameTemplate||"{0}_Data",s=[];Terrasoft.each(e,(function(e,r){if(e.getCount()){i.push((function(n,i){i&&s.push(i);var o={entitySchemaName:r,recordList:e.getKeys(),packageUId:t.packageUId,entitySchema:Terrasoft[r],packageSchemaDataName:Ext.String.format(a,r)};this.executeUpdatePackageSchemaDataRequest(o,n,this)}))}}),this),i.push((function(e,t){t&&s.push(t);var i=this.getSummaryUpdatePackageSchemaDataResponse(s);r.call(n,i)})),i.push(this),Terrasoft.chain.apply(this,i)},getSchemaPackageDataInfo:function(e,t){var r={},n=Ext.isEmpty(e),i=this.getDataStore();return Terrasoft.each(i,(function(i,a){(n||Terrasoft.contains(e,a))&&(r[a]=t?i:i.filterByFn((function(e){return e.getIsChanged()||e.getIsNew()}),this))}),this),r},saveAndUpdatePackageSchemaData:function(e,t,r){e=e||{};var n=this.getSchemaPackageDataInfo(e.entitySchemaNames,e.updateAll);Terrasoft.chain((function(t){this.save(e,t,this)}),(function(t,r){r.success?this.updatePackageSchemaData(n,e,t,this):t(r)}),(function(e,n){t.call(r,n)}),this)},saveAndUpdateSchemaData:function(e,t,r){var n={packageUId:e};this.saveAndUpdatePackageSchemaData(n,t,r)},save:function(e,t,r){var n=new Terrasoft.BatchQuery,i=this.getDataStore(),a=[],s=[],o=e&&e.entitySchemaNames,l=Ext.isEmpty(o);Terrasoft.each(i,(function(e,t){(l||Terrasoft.contains(o,t))&&e.filterByFn((function(e){var t=e.getIsChanged(),r=e.getIsDeleted();return r?a.push(e):t&&s.push(e),t||r})).each((function(e){var t=e.getSaveQuery();t&&n.add(t);var r=e.getSaveLocalizationQuery();r&&n.add(r)}),this)}),this),n.execute((function(e){e.success&&(e.ResponseStatus||(Terrasoft.each(a,(function(e){this.removeItem(e)}),this),Terrasoft.each(s,(function(e){e.setIsSaved()}),this))),t.call(r,e)}),this)}}),Ext.define("Terrasoft.manager.ObjectManagerItem",{extend:"Terrasoft.manager.BaseManagerItem",alternateClassName:"Terrasoft.ObjectManagerItem",dataManagerItem:null,forceUpdateColumns:null,propertyColumnNames:null,lazyLoadingProperties:null,loadedLazyProperties:[],setProperties:function(e){var t=e.getValues();Terrasoft.each(this.propertyColumnNames,(function(e,r){this[r]=t[e]}),this)},getUnloadedLazyLoadingProperties:function(){return Ext.Array.difference(this.lazyLoadingProperties||[],this.loadedLazyProperties)},constructor:function(e){this.callParent(arguments),this.setProperties(e.dataManagerItem)},setPropertyValue:function(e,t){this[e]=t;var r=this.propertyColumnNames[e];if(!r)throw new Terrasoft.NullOrEmptyException;this.dataManagerItem.setColumnValue(r,t)},setForceUpdateColumns:function(e){this.forceUpdateColumns=Ext.clone(e)},getPropertyValue:function(e){if(this.getUnloadedLazyLoadingProperties().indexOf(e)>-1)throw new Terrasoft.InvalidOperationException;return this[e]},remove:function(){this.callParent(arguments),this.dataManagerItem.remove()},save:function(e,t){this.dataManagerItem.save(e,t)},discard:function(){var e=Terrasoft.DataManager.discardItem(this.dataManagerItem);this.dataManagerItem=e,e?this.setProperties(e):this.destroy()},getIsNew:function(){return this.dataManagerItem.getIsNew()},getIsChanged:function(){return this.dataManagerItem.getIsChanged()},getDataManagerItem:function(){return this.dataManagerItem},getSerializedPropertiesConfig:function(){var e=this.callParent(arguments);return Ext.apply(e,{propertyColumnNames:{},dataManagerItem:{isCopy:!1,defCopyValue:this.dataManagerItem.copy()}}),e},loadLazyPropertiesData:function(e,t){this.getUnloadedLazyLoadingProperties().length>0?this.dataManagerItem.reload((function(){this.setProperties(this.dataManagerItem),this.loadedLazyProperties=Terrasoft.deepClone(this.lazyLoadingProperties),Ext.callback(e,t)}),this):Ext.callback(e,t)}}),Ext.define("Terrasoft.manager.ObjectManager",{extend:"Terrasoft.manager.BaseManager",alternateClassName:"Terrasoft.ObjectManager",entitySchemaName:null,entitySchema:null,itemClassName:"Terrasoft.ObjectManagerItem",propertyColumnNames:null,propertyColumnConfig:null,initialized:!1,_initializing:!1,defaultPropertyColumnNames:{id:"Id"},lazyLoadingProperties:null,allColumns:!1,ignoreDisplayValues:!0,constructor:function(e){this.callParent([e]),this.propertyColumnNames=Ext.apply(this.propertyColumnNames||{},this.defaultPropertyColumnNames),this.lazyLoadingProperties=this.lazyLoadingProperties||[],Terrasoft.appendIf(this.lazyLoadingProperties,["ModifiedBy","CreatedBy"])},_getChangedItems:function(){return this.items.filterByFn((function(e){return(e.getIsNew()||e.getIsChanged())&&!e.getIsDeleted()}),this)},_getDeletedItems:function(){return this.items.filterByFn((function(e){return!e.getIsNew()&&e.getIsDeleted()}))},_forEachColumn:function(e,t){var r=this.propertyColumnConfig||{};Terrasoft.each(this.propertyColumnNames,(function(n,i){var a=r[i];e.call(t,n,i,a)}),this)},_getColumnsInfo:function(){var e=[];return this._forEachColumn((function(t,r,n){var i=Ext.apply({},n);i.columnName=t,i.columnKey=r,e.push(i)}),this),e},_getEntityColumnsConfig:function(){var e=null;return this._forEachColumn((function(t,r,n){Ext.isEmpty(n)||((e=e||{})[t]={dataValueType:n.columnDataValueType})}),this),e},getColumnsByProperties:function(e){var t=this;return Ext.isEmpty(e)?null:e.map((function(e){return t.propertyColumnNames[e]||e}))},initManagerItems:function(e){e.each((function(e){var t=e.getId(),r=this.createManagerItem({id:t,dataManagerItem:e});this.addItem(r)}),this)},_subscribeOnInitializedEvent:function(e,t){this.on("managerInitialized",(function(){Ext.callback(e,t)}),this,{single:!0})},initializeManager:function(e,t,r){e=Ext.apply({entitySchemaName:this.entitySchemaName,lazyLoadingColumns:this.getColumnsByProperties(this.lazyLoadingProperties),columnsInfo:this._getColumnsInfo(),allColumns:this.allColumns||e&&e.allColumns,ignoreDisplayValues:this.ignoreDisplayValues||e&&e.ignoreDisplayValues},e),Terrasoft.chain((function(e){this.initializeEntitySchema(e,this)}),(function(t){Terrasoft.DataManager.select(e,t,this)}),(function(e,n){this.initManagerItems(n),this.initialized=!0,this.isOutdated=!1,Ext.callback(t,r||this)}),this)},initializeEntitySchema:function(e,t){Terrasoft.require([this.entitySchemaName],(function(r){this.entitySchema=r,e.call(t)}),this)},checkIsInitialized:function(){if(!this.initialized)throw new Terrasoft.InvalidObjectState({message:Terrasoft.Resources.Managers.Exceptions.ManagerIsNotInitialized})},getInitConfig:function(e){return e},getPackageSchemaDataName:function(e){var t=e.getPropertyValue("id"),r=this.alternateClassName.replace("Terrasoft.","");return Ext.String.format("{0}_{1}_{2}",this.entitySchemaName,r,t.replace(/-/g,""))},updatePackageSchemaData:function(e,t,r,n){var i=[];t.each((function(t){var r=t.getPropertyValue("id");i.push((function(n){var i={entitySchemaName:this.entitySchemaName,recordList:[r],packageUId:e,packageSchemaDataName:this.getPackageSchemaDataName(t),entitySchema:Terrasoft[this.entitySchemaName],forceUpdateColumns:t.forceUpdateColumns};Ext.create("Terrasoft.UpdatePackageSchemaDataRequest",i).execute((function(e){if(!e||!e.success)throw new Terrasoft.InvalidOperationException({message:e.errorInfo.toString()});n()}),this)}))}),this),i.push((function(){r.call(n)})),i.push(this),Terrasoft.chain.apply(this,i)},deletePackageSchemaData:function(e,t){var r=e.mapArray((function(e){var r=this.getPackageSchemaDataName(e);return new Promise((function(e,n){Ext.create("Terrasoft.DeletePackageSchemaDataRequest",{packageSchemaDataName:r,packageUId:t}).execute((function(t){t&&t.success?e():n(t&&t.errorInfo)}),this)}))}),this);return Promise.all(r).catch((function(e){throw new Terrasoft.InvalidOperationException({message:e&&e.toString()})}))},unsubscribeEvents:function(){this.items.each((function(e){e.un("remove",this.onRemoveManagerItem,this)}),this)},createManagerItem:function(e){return this.propertyColumnNames&&Ext.apply(e,{propertyColumnNames:this.propertyColumnNames,lazyLoadingProperties:this.lazyLoadingProperties}),this.callParent(arguments)},findItem:function(){return this.checkIsInitialized(),this.callParent(arguments)},getItem:function(){return this.checkIsInitialized(),this.callParent(arguments)},remove:function(){this.checkIsInitialized(),this.callParent(arguments)},getItems:function(){return this.checkIsInitialized(),this.callParent(arguments)},clear:function(){var e=Terrasoft.DataManager.getDataStore();delete e[this.entitySchemaName],this.callParent(arguments),this.initialized=!1},onDestroy:function(){this.unsubscribeEvents(),this.callParent(arguments)},getPropertiesAttributes:function(){if(!this.entitySchema)return null;var e=this.entitySchema.columns,t={};return Terrasoft.each(this.propertyColumnNames,(function(r,n){t[n]=Terrasoft.deepClone(e[r]),Ext.apply(t[n],{columnPath:n,name:n})}),this),t},initialize:function(e,t,r){if(Ext.isFunction(e)&&(r=t||this,t=e,e=null),r=r||this,this.initialized)this.isOutdated?this.reInitialize(e,t,r):t.call(r);else if(this._subscribeOnInitializedEvent(t,r),!this._initializing){this._initializing=!0;var n=this.getInitConfig(e);this.initializeManager(n,(function(){this._initializing=!1,this.fireEvent("managerInitialized")}),this)}},addItem:function(e){var t=this.callParent([e]),r=t.getDataManagerItem();return Terrasoft.DataManager.addItem(r),t},discardItem:function(e){if(e.getIsNew()){if(e.dataManagerItem){var t=e.dataManagerItem;Terrasoft.DataManager.discardItem(t)}this.items.remove(e)}else e.discard();return e},hasChanges:function(){var e=this._getChangedItems(),t=this._getDeletedItems();return[].concat(_toConsumableArray(e.getItems()),_toConsumableArray(t.getItems())).length>0},save:function(e,t){this.callParent(arguments),Terrasoft.DataManager.save({entitySchemaNames:[this.entitySchemaName]},e,t)},saveAndUpdateSchemaData:function(e,t,r){var n=this._getChangedItems(),i=this._getDeletedItems();Terrasoft.chain((function(e){this.save(e,this)}),(function(t){this.updatePackageSchemaData(e,n,t,this)}),(function(t){this.deletePackageSchemaData(i,e).then(t)}),(function(){this.notify(this.outdatedEventName),t.call(r)}),this)},discard:Terrasoft.abstractFn,createItem:function(e,t,r){var n;if(2===arguments.length&&Ext.isFunction(e)&&(r=t,t=e,e=null),r=r||this,e&&e.dataManagerItem)n=this.createManagerItem(e),t.call(r,n);else{var i={entitySchemaName:this.entitySchemaName},a=this._getEntityColumnsConfig();a&&(i.columns=a),Terrasoft.DataManager.createItem(i,(function(i){var a;i.propertyLczValues=null===(a=e)||void 0===a?void 0:a.propertyLczValues,i.propertyColumnNames=this.propertyColumnNames,n=this.createManagerItem({dataManagerItem:i});var s=e&&e.propertyValues;Terrasoft.each(s,(function(e,t){n.setPropertyValue(t,e)}),this),t.call(r,n)}),this)}},reInitialize:function(e,t,r){2===arguments.length&&Ext.isFunction(e)&&(r=t,t=e,e=null),this.clear(),this.initialize(e,t,r)},loadLazyPropertiesDataForItems:function(e){var t=e.map((function(e){return this.items.get(e)}),this).map((function(e){return new Promise((function(t){e.loadLazyPropertiesData((function(){t(e)}),this)}))}),this);return Promise.all(t)}}),Ext.define("Terrasoft.manager.PackageManagerItem",{extend:"Terrasoft.BaseManagerItem",alternateClassName:"Terrasoft.PackageManagerItem",name:null,uId:null,caption:null,sysPackageEntity:null}),Ext.define("Terrasoft.core.manager.GetDesignPackageUIdRequest",{extend:"Terrasoft.BaseCoreRequest",alternateClassName:"Terrasoft.GetDesignPackageUIdRequest",serviceName:"AppInstallerService.svc",serviceMethod:"GetDesignPackageUId",schemaUId:null,getSerializableObject:function(e){return this.callParent(arguments),e.schemaUId=this.schemaUId,e},validate:function(){if(this.callParent(arguments),!this.schemaUId||Terrasoft.isEmptyGUID(this.schemaUId))throw new Terrasoft.NullOrEmptyException({argumentName:"schemaUId"});return!0}}),Ext.define("Terrasoft.manager.PackageManager",{extend:"Terrasoft.ObjectManager",alternateClassName:"Terrasoft.PackageManager",singleton:!0,CUSTOM_PACKAGE_NAME:"Custom",currentPackageUId:null,itemClassName:"Terrasoft.PackageManagerItem",entitySchemaName:"SysPackage",propertyColumnNames:{id:"Id",uId:"UId",caption:"Caption",name:"Name"},getCustomPackageUId:function(e,t){Terrasoft.SysSettings.querySysSettingsItem("CustomPackageUId",(function(r){var n=r?r.value:Terrasoft.GUID_EMPTY;e.call(t,n)}),this)},getCurrentPackageUId:function(e,t){this.currentPackageUId?e.call(t,this.currentPackageUId):Terrasoft.SchemaDesignerUtilities.getCurrentPackageUId((function(r){this.currentPackageUId=r,e.call(t,r)}),this)},getPackageInfo:function(e,t,r){if(Ext.isEmpty(e))throw Terrasoft.NullOrEmptyException("packageUIds");var n=Ext.create("Terrasoft.EntitySchemaQuery",{rootSchemaName:"SysPackage"});n.addColumn("UId"),n.addColumn("Name"),n.filters.addItem(Terrasoft.createColumnInFilterWithParameters("UId",e)),n.getEntityCollection((function(e){var n={};e.success&&e.collection.each((function(e){n[e.$UId]=e.$Name})),Ext.callback(t,r,[n])}),this)},getDesignPackageUId:function(e,t,r){Ext.create("Terrasoft.GetDesignPackageUIdRequest",{schemaUId:e}).execute((function(e){var n;e.success&&(n=e.uId),Ext.callback(t,r,[n])}),this)}}),Ext.define("Terrasoft.Designers.BaseProcessSchemaDesignerViewModel",{extend:"Terrasoft.model.BaseViewModel",alternateClassName:"Terrasoft.BaseProcessSchemaDesignerViewModel",mixins:{BaseSchemaDesignerStorageMixin:"Terrasoft.BaseSchemaDesignerStorageMixin",BaseProcessSchemaDesignerValidationMixin:"Terrasoft.BaseProcessSchemaDesignerValidationMixin"},preventSaveToStorage:!1,id:null,sandbox:null,propertiesContainerId:null,contextHelpCode:null,storageLocationHref:null,storageSchemaMetadata:null,storageSchemaResources:null,storageLoadedPropertiesItemName:null,schemaManager:null,urlHashPrefix:"case",initialSchemaPackageUId:null,columns:{Items:{type:Terrasoft.ViewModelColumnType.VIRTUAL_COLUMN,dataValueType:Terrasoft.DataValueType.COLLECTION},SchemaUId:{type:Terrasoft.ViewModelColumnType.VIRTUAL_COLUMN,dataValueType:Terrasoft.DataValueType.GUID},PackageUId:{type:Terrasoft.ViewModelColumnType.VIRTUAL_COLUMN,dataValueType:Terrasoft.DataValueType.GUID},Schema:{type:Terrasoft.ViewModelColumnType.VIRTUAL_COLUMN,dataValueType:Terrasoft.DataValueType.CUSTOM_OBJECT},SchemaManagerItem:{type:Terrasoft.ViewModelColumnType.VIRTUAL_COLUMN,dataValueType:Terrasoft.DataValueType.CUSTOM_OBJECT},SchemaCaption:{type:Terrasoft.ViewModelColumnType.VIRTUAL_COLUMN,name:"SchemaCaption",caption:Terrasoft.Resources.SchemaDesigner.ProcessCaptionColumnCaption,isRequired:!0,size:250},LoadedPropertiesItemName:{type:Terrasoft.ViewModelColumnType.VIRTUAL_COLUMN,dataValueType:Terrasoft.DataValueType.STRING,value:null},PropertiesEditModule:{type:Terrasoft.ViewModelColumnType.VIRTUAL_COLUMN,dataValueType:Terrasoft.DataValueType.STRING},LastSelectedItemUId:{type:Terrasoft.ViewModelColumnType.VIRTUAL_COLUMN,dataValueType:Terrasoft.DataValueType.STRING,value:null},IsSchemaChanged:{type:Terrasoft.ViewModelColumnType.VIRTUAL_COLUMN,dataValueType:Terrasoft.DataValueType.BOOLEAN,value:!1},IsLoadStoragePanelVisible:{type:Terrasoft.ViewModelColumnType.VIRTUAL_COLUMN,dataValueType:Terrasoft.DataValueType.BOOLEAN,value:!1},IsMessagePanelVisible:{type:Terrasoft.ViewModelColumnType.VIRTUAL_COLUMN,dataValueType:Terrasoft.DataValueType.BOOLEAN,value:!1},SearchTextEditValue:{type:Terrasoft.ViewModelColumnType.VIRTUAL_COLUMN,dataValueType:Terrasoft.DataValueType.STRING},IsSearchVisible:{type:Terrasoft.ViewModelColumnType.VIRTUAL_COLUMN,dataValueType:Terrasoft.DataValueType.BOOLEAN,value:!1},FoundItems:{type:Terrasoft.ViewModelColumnType.VIRTUAL_COLUMN,dataValueType:Terrasoft.DataValueType.COLLECTION},SearchItemIndex:{type:Terrasoft.ViewModelColumnType.VIRTUAL_COLUMN,dataValueType:Terrasoft.DataValueType.INTEGER},SearchValue:{type:Terrasoft.ViewModelColumnType.VIRTUAL_COLUMN,dataValueType:Terrasoft.DataValueType.STRING},SearchInfo:{type:Terrasoft.ViewModelColumnType.VIRTUAL_COLUMN,dataValueType:Terrasoft.DataValueType.STRING},IsSearchStarted:{type:Terrasoft.ViewModelColumnType.VIRTUAL_COLUMN,dataValueType:Terrasoft.DataValueType.BOOLEAN,value:!1},IsItemsFound:{type:Terrasoft.ViewModelColumnType.VIRTUAL_COLUMN,dataValueType:Terrasoft.DataValueType.BOOLEAN,value:!1},CopySourceSchemaId:{type:Terrasoft.ViewModelColumnType.VIRTUAL_COLUMN,dataValueType:Terrasoft.DataValueType.STRING},IsActiveVersionMenuItemEnabled:{type:Terrasoft.ViewModelColumnType.VIRTUAL_COLUMN,dataValueType:Terrasoft.DataValueType.BOOLEAN,value:!0},IsSchemaCaptionEnabled:{type:Terrasoft.ViewModelColumnType.VIRTUAL_COLUMN,dataValueType:Terrasoft.DataValueType.BOOLEAN,value:!0},SaveButtonMenuItems:{type:Terrasoft.ViewModelColumnType.VIRTUAL_COLUMN,dataValueType:Terrasoft.DataValueType.COLLECTION}},onGetSchema:function(){return this.get("Schema")},onGetSchemaManagerItem:function(){return this.get("SchemaManagerItem")},getPropertiesModuleId:function(e){return this.id+"-properties-module-"+e},addHotkeys:function(){Ext.getDoc().on("keydown",this.onKeyDown,this)},removeHotkeys:function(){Ext.getDoc().un("keydown",this.onKeyDown,this)},setVisiblePropertyPage:function(e){if(this.get("IsShowPropertyPage")!==e&&(this.set("IsShowPropertyPage",e),e)){var t=this.propertiesContainerId;this.sandbox.publish("ReRenderPropertiesPage",t)}},showErrorMessage:function(e,t){Terrasoft.Mask.clearMasks("body"),Terrasoft.showErrorMessage(e,(function(){t&&!1===t.doCloseWindow||window.close()}),this)},getCanEditSchema:function(e,t,r){Terrasoft.BaseSchemaDesignerUtilities.getIsPackageForeign(e,(function(e,n){n?this.showErrorMessage(n):t.call(r,{canEditPackageSchema:!e.isPackageForeign,sysPackage:e.sysPackage})}),this)},validateSchemaViewModel:function(e,t){this.getCanUseProcessVersions()?this.getNeedCreateNewVersionSchema((function(r){this.validateViewModel((function(n,i){var a=Ext.apply({isValid:n,shouldSaveProcess:i},r);e.call(t,a)}),this)}),this):this.validateViewModel((function(r,n){e.call(t,{isValid:r,shouldSaveProcess:n,canEditPackageSchema:!0})}),t)},showSaveResponseErrorMessage:function(e){var t=this.get("Schema").validatorMessage;t||(t=this.getValidatorDetailInfo().message);var r=e.errorInfo?e.errorInfo.message:e.statusText;Terrasoft.ProcessSchemaDesignerUtilities.showProcessMessageBox({caption:r,message:t})},internalSaveSchema:function(e,t,r){var n,i=Terrasoft.Mask.show({caption:Terrasoft.Resources.SchemaDesigner.SavingMaskCaption,timeout:0});Terrasoft.chain((function(e){this.saveProcess(e,this)}),(function(t,r){var a;r.success?(e.hasErrors=r.hasErrors,(null===(a=r.validationErrors)||void 0===a?void 0:a.length)>0&&(n={validationErrors:r.validationErrors,message:r.validatorMessage}),this.onAfterSaveProcessSuccess(t,this)):(Terrasoft.Mask.hide(i),this.showSaveResponseErrorMessage(r))}),(function(t){var r=this.getValidatorDetailInfo(e.hasErrors);this.onAfterSchemaSaved(r,e.isValid,t,this)}),(function(e,a,s){Terrasoft.Mask.hide(i),this._loadSaveButtonMenuItems(),n&&(a.validationErrorsInfo=n),t.call(r,a,s)}),this)},saveSchema:function(e,t,r){if(e.shouldSaveProcess){var n=this.get("Schema");e=Ext.apply({sourceSchema:n},e),this.getShouldSaveNewVersionWhenPackageChange()?this.schemaManager.getNewSchemaVersion(e,(function(i){n.name=i.instance.name,n.version=i.instance.version,this.sandbox.publish("SchemaPropertiesChanged",{name:n.name,version:n.version}),this.internalSaveSchema(e,t,r)}),this):this.internalSaveSchema(e,t,r)}},_getIsNew:function(){var e=this.get("SchemaManagerItem");return e&&e.isNew()},getNeedCreateNewVersionSchema:function(e,t){if(this._getIsNew())e.call(t,{canEditPackageSchema:!0});else{var r=this.get("Schema");this.getCanEditSchema(r.packageUId,(function(n){var i=Ext.apply({},n);n.canEditPackageSchema?Terrasoft.BaseSchemaDesignerUtilities.getRunningProcessCountBySysSchemaUId(r.uId,(function(r,n){n?this.showErrorMessage(n):(i.hasRunningProcess=r&&r>0,e.call(t,i))}),this,this.schemaManager.managerName):e.call(t,i)}),this)}},blinkPropertiesPageMask:function(e){var t=Terrasoft.Mask.show({selector:"#"+this.propertiesContainerId,clearMasks:!0,opacity:0,timeout:0});setTimeout((function(){Terrasoft.Mask.hide(t)}),e)},saveElementProperties:function(){return this.sandbox.publish("SaveElementProperties")},loadElementLazyParameters:function(e,t,r){if(e.hasLazyParameters&&!e.getNotLoadedLazyParameters().isEmpty()){var n=Terrasoft.Mask.show({timeout:0});e.loadLazyParameters((function(){Terrasoft.Mask.hide(n),t.call(r)}),this)}else t.call(r)},loadElementProperties:function(e){var t=this.get("LoadedPropertiesItemName"),r=e.elementName;null!==t&&t!==r&&this.saveElementProperties(),this.set("LoadedPropertiesItemName",r);var n=this.getPropertiesModuleId(r),i=this.sandbox,a=this.get("PropertiesEditModule"),s=[a].concat(e.propertiesEditSchema);i.requireModuleDescriptors(s,(function(){i.loadModule(a,{id:n,renderTo:e.renderTo,instanceConfig:{tag:r,schemaName:e.propertiesEditSchema,maskId:e.maskId}})}),this)},getValidatorDetailInfo:function(e){var t={hasErrors:e},r=this.get("Schema").validatorInfo;if(r&&r.length>0){var n=r.join(", "),i=e?Terrasoft.Resources.SchemaDesigner.ErrorMessages:Terrasoft.Resources.SchemaDesigner.RequireCompilationMessage;t.message=Ext.String.format(i,n)}return t},replaceUrlWithCurrentSchemaUId:function(){var e=this.get("SchemaUId");history.replaceState({},document.title,"#"+this.urlHashPrefix+"/"+e)},getIsSchemaAddMode:function(){return!new RegExp("(#"+this.urlHashPrefix+"/.{8}-.{4}-.{4}-.{4}-.{12})").test(window.location.hash)},deactivateSchema:function(e,t,r){Terrasoft.SysUserPropertyHelper.setProperty({schemaId:e,propertyName:"Enabled",propertyValue:!1,managerName:this.schemaManager.managerName},t,r)},saveProcess:function(e,t){var r=this.get("SchemaManagerItem"),n=r.status;r.setStatus(Terrasoft.ModificationStatus.UPDATED),r.save({},(function(i){if(i.success){var a=r.instance;this._publishProcessSavedBroadcastMessage({isNew:n===Terrasoft.ModificationStatus.NEW,uId:a.uId,name:a.name,caption:a.caption.getValue(),parentUId:a.parentSchemaUId,isActiveVersion:a.isActiveVersion}),this.schemaManager.onItemOutdated({status:Terrasoft.ModificationStatus.UPDATED,uId:r.uId,name:r.name,caption:r.caption})}e.call(t,i)}),this)},_publishProcessSavedBroadcastMessage:function(e){var t=e.isNew,r=e.uId,n=e.name,i=e.caption,a=e.parentUId,s=e.isActiveVersion;new BroadcastChannel2("process-schema-saved").postMessage({isNew:t,uId:r,name:n,caption:i,parentUId:a,isActiveVersion:s})},getItemIsChanged:function(e){var t=Ext.Object.getKeys(e);return!(1===t.length&&"isActiveVersion"===t[0])},onItemChanged:function(e,t){var r=this.get("Schema");e.hasOwnProperty("isValid")?t!==r&&this.fireEvent("itemIsValidChanged",t):(this.hideMessagePanel(),this.getItemIsChanged(e)&&this.set("IsSchemaChanged",!0),this.get("IsLoadStoragePanelVisible")&&this.clearSchemaStorageInfo(),e.hasOwnProperty("caption")&&t!==r&&this.fireEvent("itemCaptionChanged",t),t!==r&&r.fireEvent("changed",{},r))},getSchemaDisplayValue:function(){return this.get("Schema").getDisplayValue()},_onSaveVersionClick:function(e,t,r){e.saveAsNewVersion?this.saveNewSchemaVersion(e,t,r):(e.isDelivered||e.canEditPackageSchema&&e.hasRunningProcess)&&this.saveSchema(e,(function(e,n){this.saveProcessSchemaResponse(e,n),Ext.callback(t,r,[e,n])}),this)},_loadSaveSchemaVersionMessageBox:function(e,t){var r=this.sandbox.id+"_SaveSchemaVersionMessageBox",n={id:r,renderTo:e,instanceConfig:{schemaName:"SaveSchemaVersionMessageBox",isSchemaConfigInitialized:!0,useHistoryState:!1,generateViewContainerId:!1,parameters:{viewModelConfig:t}}};return this.sandbox.loadModule("BaseSchemaModuleV2",n),r},loadPropertiesPage:function(e){if(this.get("IsShowPropertyPage")){var t=this.findItemByKey(e);Terrasoft.chain((function(e){this.loadElementLazyParameters(t,e,this)}),(function(){var r=this.get("LastSelectedItemUId");if(this.set("LastSelectedItemUId",t.uId),null==r){if(this.get("LoadedPropertiesItemName")===e)return this.set("LastSelectedItemUId",null),void this.blinkPropertiesPageMask(100);var n=this.maskId=this.loadPropertiesPageMask(t);t.getEditPageSchemaName((function(t){this.loadElementProperties({elementName:e,propertiesEditSchema:t,renderTo:this.propertiesContainerId,maskId:n})}),this)}}),this)}},getSaveSchemaVersionMessageBoxTitle:function(){return Terrasoft.Resources.SchemaDesigner.SavingProcess},getSaveSchemaVersionMessageBoxMessage:function(e){return e.isDelivered?Terrasoft.Resources.SchemaDesigner.SchemaWasExported:e.canEditPackageSchema?Terrasoft.Resources.SchemaDesigner.ExistsRunningProcessQuestion:Terrasoft.Resources.SchemaDesigner.SchemaCreatesInForeighnMaintainerQuestion},showSaveNewSchemaVersionConfirmationDialog:function(e,t,r){e.isDelivered=this.getIsDelivered();var n={Title:this.getSaveSchemaVersionMessageBoxTitle(),Message:this.getSaveSchemaVersionMessageBoxMessage(e),IsForceSaveNewVersion:!e.canEditPackageSchema};this.requireModule("ModalBox",(function(i){var a=i.show({widthPixels:550,heightPixels:200}).id,s=this._loadSaveSchemaVersionMessageBox(a,n);this.sandbox.subscribe("OnSaveVersionClick",(function(n){e.saveAsNewVersion=n,this._onSaveVersionClick(e,t,r)}),this,[s])}),this)},getNeedSetActualSchemaVersionQuestionText:function(e){var t=Terrasoft.Resources.SchemaDesigner.NeedSetActualSchemaVersionConfirmationMessage;return Ext.String.format(t,e)},showIsNeedSetActualSchemaVersionConfirmationMessage:function(e,t){var r=this.getSchemaDisplayValue(),n=this.getNeedSetActualSchemaVersionQuestionText(r);this.showConfirmationDialog(n,(function(r){if(r===Terrasoft.MessageBoxButtons.YES.returnCode){var n=this.get("SchemaUId");this._setIsActualVersionByUId(n,e,t)}else Ext.callback(e,t)}),[Terrasoft.MessageBoxButtons.YES.returnCode,Terrasoft.MessageBoxButtons.NO.returnCode],null)},getShouldSaveNewVersionWhenPackageChange:function(){if(!this.getCanUseProcessVersions())return!1;var e=this.get("Schema"),t=!this._getIsNew(),r=this.initialSchemaPackageUId!==e.packageUId,n=0!==e.version;return t&&r&&n},getIsDelivered:function(){return!!this.getCanUseProcessVersions()&&this.get("Schema").getPropertyValue("isDelivered")},closeSchemaDesigner:function(){this.preventSaveToStorage=!0,window.close()},_save:function(e){this.clearSchemaStorageInfo(),this.hideMessagePanel(),this.fireEvent("focusDesigner",this),this.saveElementProperties(),this.validateSchemaViewModel((function(t){t.shouldSaveProcess&&(e||!this.getIsDelivered()?!t.canEditPackageSchema||!e&&t.hasRunningProcess?this.showSaveNewSchemaVersionConfirmationDialog(t):this.saveSchema(t,(function(e,t){this.saveProcessSchemaResponse(e,t)}),this):this.showSaveNewSchemaVersionConfirmationDialog(t))}),this)},constructor:function(){this.callParent(arguments),this.addEvents("initialized","itemschanged","itemCaptionChanged","itemIsValidChanged","clearSelection","itemSelected","focusDesigner","updateItemsHighlighter")},init:function(){this.mixins.BaseSchemaDesignerStorageMixin.init.call(this);var e=this.get("SchemaUId");e?this.tryEditSchema(e):(e=Terrasoft.generateGUID(),this.set("SchemaUId",e),this.createSchema(e)),this.setValidationConfig();var t=Ext.create("Terrasoft.BaseViewModelCollection");this.set("SaveButtonMenuItems",t)},createSchema:function(e){this.getPackageUId((function(t){this.schemaManager.createSchemaInstance(e,t,(function(e,t,r){r?this.showErrorMessage(r):(this.set("SchemaManagerItem",t),this.onSchemaLoaded(e))}),this)}),this)},onAfterGetSchemaInstance:function(e,t,r){this._initIsActualVersionMenuItem(e,(function(){return t.call(r,e)}),this)},getSchemaInstance:function(e,t,r){Terrasoft.chain((function(t){this.schemaManager.getSchemaInstance(e,t,this)}),(function(e,n,i,a){a?this.showErrorMessage(a):(this.set("SchemaManagerItem",i),this.onAfterGetSchemaInstance(n,t,r))}),this)},tryEditSchema:function(e){this.getSchemaInstance(e,(function(e){this.getCanEditSchema(e.packageUId,(function(t){t.canEditPackageSchema?this.editSchema(e):this.copySchema(e)}),this)}),this)},editSchema:function(e){Terrasoft.chain((function(t){this.schemaManager.getCanEditSchema(e.uId,t,this)}),(function(e,t,r,n){if(n)this.showErrorMessage(n);else if(t)e();else{var i=r||Terrasoft.Resources.SchemaDesigner.PackageElementEditWithoutLockMessage;Terrasoft.showInformation(i,e,this)}}),(function(){this.onSchemaLoaded(e)}),this)},setIsActiveVersion:function(e){this._setIsActualVersionMenuItemVisibility(e);var t=this.get("Schema");t.setPropertyValue("isActiveVersion",e),t.setIsActualVersion(e),this.sandbox.publish("SchemaPropertiesChanged",{isActualVersion:e})},setIsActualVersionByUId:function(e){this._setIsActualVersionByUId(e,Ext.emptyFn,this)},copySchema:function(e){Terrasoft.chain((function(e){this.schemaManager.initialize(e,this)}),(function(t){this.schemaManager.getSchemaInstance(e.uId,t,this)}),(function(e,t,r,n){n?this.showErrorMessage(n):(this.set("CopySourceSchemaId",r.id),this.copySchemaInstance(t))}),this)},copySchemaInstance:function(e){var t=this.schemaManager,r=t.copySchema(e),n=r.instance,i=t.schemaNamePrefix+n.name;n.name=t.generateItemUniqueName(i),this.set("SchemaUId",n.uId),this.set("SchemaManagerItem",r),this.getPackageUId((function(e){n.packageUId=e,this.onSchemaLoaded(n)}),this)},requireModule:function(e,t,r){var n=this[e];n?t.call(r,n):this.sandbox.requireModuleDescriptors([e],(function(){var n=this;require([e],(function(i){n[e]=i,t.call(r,i)}))}),this)},getProcessModuleUtilities:function(e,t){this.requireModule("ProcessModuleUtilities",e,t)},loadPropertiesPageMask:function(){var e="#"+this.propertiesContainerId;return Terrasoft.Mask.show({selector:e,opacity:.5,showHidden:!0,clearMasks:!0})},getItemKey:function(e){return e.uId},getPropertiesPageData:function(e){var t=this.get("LastSelectedItemUId"),r=this.findItemByUId(t),n=r&&this.getItemKey(r);return this.set("LastSelectedItemUId",null),Ext.isEmpty(n,!0)||e===n?this.findItemByKey(e):(this.set("LoadedPropertiesItemName",null),this.loadPropertiesPage(n),null)},getPackageUId:function(e,t){var r=this.get("PackageUId");r?e.call(t,r):Terrasoft.PackageManager.getCurrentPackageUId(e,t)},onSandboxInitialized:function(){var e=this.sandbox;e.registerMessages({GetSchema:{direction:Terrasoft.MessageDirectionType.SUBSCRIBE,mode:Terrasoft.MessageMode.PTP},GetSchemaManagerItem:{direction:Terrasoft.MessageDirectionType.SUBSCRIBE,mode:Terrasoft.MessageMode.PTP},PropertiesPageCaptionChanged:{direction:Terrasoft.MessageDirectionType.SUBSCRIBE,mode:Terrasoft.MessageMode.PTP},GetProcessSchema:{direction:Terrasoft.MessageDirectionType.SUBSCRIBE,mode:Terrasoft.MessageMode.PTP},OnSaveVersionClick:{direction:Terrasoft.MessageDirectionType.SUBSCRIBE,mode:Terrasoft.MessageMode.PTP},DiagramPageCaptionChanged:{direction:Terrasoft.MessageDirectionType.PUBLISH,mode:Terrasoft.MessageMode.PTP},SchemaPropertiesChanged:{direction:Terrasoft.MessageDirectionType.PUBLISH,mode:Terrasoft.MessageMode.PTP}}),e.subscribe("GetSchema",this.onGetSchema,this),e.subscribe("GetSchemaManagerItem",this.onGetSchemaManagerItem,this),e.subscribe("PropertiesPageCaptionChanged",this.onPropertiesPageCaptionChanged,this),e.subscribe("GetProcessSchema",this.onGetSchema,this)},onPropertiesPageCaptionChanged:function(e){this.set("SchemaCaption",e)},initializeSchemaCaption:function(e){this.set("SchemaCaption",e.caption.getValue())},loadItems:function(e){e.subscribeOnChangedEvent(this.onItemChanged,this),e.on("parameterAdded",this.onParameterAdded,this),e.on("parameterRemoved",this.onParameterRemoved,this),this.initializeSchemaCaption(e),this.set("Schema",e)},findItemByUId:function(e){var t=this.get("Schema");return t.uId===e?t:t.findItemByUId(e)},findItemByKey:function(e){return this.findItemByUId(e)},loadSchemaPropertiesPage:function(){var e=this.get("Schema"),t=this.getItemKey(e);this.loadPropertiesPage(t)},onHidePropertyPage:Terrasoft.abstractFn,onParameterAdded:function(e){this.onItemChanged({},e),e.on("changed",this.onItemChanged,this)},onParameterRemoved:function(e){this.onItemChanged({},e),e.un("changed",this.onItemChanged,this)},onLoadStorageClick:function(){var e=Terrasoft.Mask.show({timeout:0});setTimeout(function(){this.loadSchemaFromStorage((function(){this.clearSchemaStorageInfo(),Terrasoft.Mask.hide(e)}),this)}.bind(this),0)},hideMessagePanel:function(){this.set("IsMessagePanelVisible",!1),this.set("MessagePanelMessage",null)},onDiscardStorageClick:function(){this.clearSchemaStorageInfo()},clearSchemaStorageInfo:function(){this.mixins.BaseSchemaDesignerStorageMixin.clearSchemaStorageInfo.call(this)},onSchemaLoaded:function(e){this.loadItems(e),this.on("change:SchemaCaption",this.onSchemaCaptionChange,this),this.onSandboxInitialized(),this.addHotkeys(),this.loadSchemaPropertiesPage(),Ext.EventManager.on(window,"beforeunload",this.onBeforeUnload.bind(this),this),this.mixins.BaseSchemaDesignerStorageMixin.initLocalStorageSchema.call(this),this.fireEvent("initialized",this),this.initialSchemaPackageUId=e.packageUId,this._loadSaveButtonMenuItems()},_loadSaveButtonMenuItems:function(){var e=Ext.create("Terrasoft.BaseViewModelCollection");if(!this._getIsNew()){var t=this.getSaveButtonMenuItems();e.loadAll(t)}this.set("SaveButtonMenuItems",e)},onBeforeUnload:function(){if(!this.preventSaveToStorage){Terrasoft.Mask.show({timeout:0}),this.fireEvent("focusDesigner",this),this.saveElementProperties();var e=this.get("Schema");e.clearLazyParametersValues&&e.clearLazyParametersValues(),this.saveSchemaToStorage()}},onDestroy:function(){this.removeHotkeys();var e=this.get("Schema");e&&!e.destroyed&&e.destroy(),Ext.EventManager.un(window,"beforeunload",this.onBeforeUnload,this),this.callParent(arguments)},onKeyDown:function(e){return e.ctrlKey&&!e.altKey&&e.keyCode===e.S?(e.preventDefault(),this.save(),!1):e.ctrlKey&&e.altKey?(e.preventDefault(),this.handleCtrlAltKeyDown(e)):e.keyCode===e.F1?(e.preventDefault(),this.onHelpClick(),!1):e.ctrlKey&&e.keyCode===e.M?(e.preventDefault(),this.onOpenMetaDataClick(),!1):void 0},handleCtrlAltKeyDown:function(e){switch(e.keyCode){case Ext.EventObject.S:this.forceSave();break;case Ext.EventObject.N:this.saveNewVersion()}return!1},onHelpClick:function(){this.requireModule("AcademyUtilities",(function(e){Terrasoft.BaseSchemaDesignerUtilities.openHelp(e,this.contextHelpCode)}),this)},onESNFeedClick:function(){this.clearSelection(),this.setVisiblePropertyPage(!0),this.loadElementProperties({elementName:"_feed_",propertiesEditSchema:"ProcessDesignerESNFeedPropertiesPage",renderTo:this.propertiesContainerId})},_updateProcessPropertiesPageSchemaName:function(){var e=this.get("Schema");this.sandbox.publish("SchemaPropertiesChanged",{name:e.name})},_initIsActualVersionMenuItem:function(e,t,r){this._setIsActualVersionMenuItemVisibility(!0),this.schemaManager.getIsActualVersion(e,(function(n){this._setIsActualVersionMenuItemVisibility(n),e.setIsActualVersion(n),Ext.callback(t,r,[n])}),this)},_setIsActualVersionMenuItemVisibility:function(e){this.set("IsActiveVersionMenuItemEnabled",e)},_setIsActualVersionByUId:function(e,t,r){var n=Terrasoft.Mask.show({showHidden:!0});Terrasoft.chain((function(t){this.schemaManager.setIsActualVersionByUId(e,t,this)}),(function(e,t){var r=Terrasoft.Resources.SchemaDesigner;t?(this.setIsActiveVersion(!0),this.showMessagePanel(r.ActualizeSchemaResultMessage,e,this)):this.showErrorMessage(r.ActualSchemaSetErrorMessage),e()}),(function(){Terrasoft.Mask.hide(n),Ext.callback(t,r)}),this)},reloadWorkspaceExplorer:function(){new BroadcastChannel2("workspace-explorer-items-reload").postMessage()},onAfterSaveProcessSuccess:function(e,t){this.set("IsSchemaChanged",!1);var r=this.getIsSchemaAddMode(),n=this.get("CopySourceSchemaId");(r||n)&&this.replaceUrlWithCurrentSchemaUId(),r&&this._updateProcessPropertiesPageSchemaName(),n?(this.set("CopySourceSchemaId",null),this.deactivateSchema(n,e,t)):e.call(t)},showSaveConfirmationDialog:function(e,t,r){var n=this._getIsNew();if(this.get("IsSchemaChanged")||n){var i=Terrasoft.MessageBoxButtons;this.showConfirmationDialog(e,(function(e){e!==i.SAVE.returnCode?n||e!==i.CANCEL.returnCode||t.call(r,null,!0):this.validateAndSave(t,r)}),[i.SAVE,i.CANCEL],{defaultButton:0})}else t.call(r)},validateAndSave:function(e,t){this.validateSchemaViewModel((function(r){var n=!r.shouldSaveProcess;n?e.call(t,null,n):this.getIsDelivered()||!r.canEditPackageSchema||r.hasRunningProcess?this.showSaveNewSchemaVersionConfirmationDialog(r,(function(r){e.call(t,r)}),this):this.saveSchema(r,(function(r,n){this.saveProcessSchemaResponse(r,n),e.call(t,r)}),this)}),this)},saveProcessSchemaResponse:function(e){if(null==e?void 0:e.validationErrorsInfo)Terrasoft.BaseSchemaDesignerUtilities.openValidationErrors(e.validationErrorsInfo.message,e.validationErrorsInfo.validationErrors);else{var t=Terrasoft.Resources.SchemaDesigner.SchemaSavedMessage;this.showMessagePanel(t)}},showMessagePanel:function(e){this.set("MessagePanelMessage",e),this.set("IsMessagePanelVisible",!0)},onAfterSchemaSaved:function(e,t,r,n){var i=this.get("Schema");this.initialSchemaPackageUId=i.packageUId,this._initIsActualVersionMenuItem(i,(function(i){this.sandbox.publish("SchemaPropertiesChanged",{isActualVersion:i}),this.reloadWorkspaceExplorer(),r.call(n,e,t)}),this)},save:function(){this._save()},saveNewVersion:function(){this.clearSchemaStorageInfo(),this.hideMessagePanel(),this.fireEvent("focusDesigner",this),this.saveElementProperties(),this.validateSchemaViewModel((function(e){e.saveAsNewVersion=!0,this._onSaveVersionClick(e)}),this)},getSaveButtonStyle:function(){return Terrasoft.isDebug&&!this.get("IsSchemaChanged")?Terrasoft.controls.ButtonEnums.style.GREY:Terrasoft.controls.ButtonEnums.style.GREEN},getSaveButtonHint:function(){return this.get("IsSchemaChanged")?Terrasoft.Resources.SchemaDesigner.SaveButtonHint:Terrasoft.Resources.SchemaDesigner.AlreadySavedButtonHint},forceSave:function(){this._save(!0)},close:function(){if(this.get("IsSchemaChanged")){var e=Terrasoft.Resources.SchemaDesigner.CloseUnsavedSchemaConfirmation;this.showConfirmationDialog(e,(function(e){"yes"===e&&this.closeSchemaDesigner()}),["yes","no"])}else this.closeSchemaDesigner()},saveNewSchemaVersion:function(e,t,r){if(e.shouldSaveProcess){var n=null,i=this.get("Schema");e=Ext.apply({sourceSchema:i,sourceManagerItem:this.get("SchemaManagerItem")},e),Terrasoft.chain((function(e){if(i.getAllLazyPropertiesAreLoaded())e();else{var t=Terrasoft.Mask.show({timeout:0});i.loadAllLazyProperties((function(){Terrasoft.Mask.hide(t),e()}),this)}}),(function(t){this.schemaManager.getNewSchemaVersion(e,t,this)}),(function(t,r,i){if(i)this.showErrorMessage(i);else{var a=(n=r).instance;this.set("SchemaUId",a.uId),this.set("Schema",a),this.set("SchemaManagerItem",n),this.saveSchema(e,t,this)}}),(function(e,t,r){this._setIsActualVersionMenuItemVisibility(!1),this.clearSchemaItems(),this.onSchemaLoaded(this.get("Schema")),this.replaceUrlWithCurrentSchemaUId(),t&&t.hasErrors||!r?e(t,r):this.showIsNeedSetActualSchemaVersionConfirmationMessage((function(){e(t,r)}))}),(function(e,n,i){this.saveProcessSchemaResponse(n,i),this.reloadWorkspaceExplorer();var a=this.get("Schema");this._publishProcessSavedBroadcastMessage({isNew:!1,uId:a.uId,name:a.name,caption:a.caption.getValue(),parentUId:a.parentSchemaUId,isActiveVersion:a.isActiveVersion}),Ext.callback(t,r,[n,i])}),this)}},getCanUseProcessVersions:function(){return this.schemaManager.getCanUseProcessVersions()},showResponseErrorMessage:function(e){var t=e.errorInfo?e.errorInfo.toString():e.statusText;this.showErrorMessage(t,{doCloseWindow:!1})},onShowPropertyPage:function(){this.clearSelection(),this.setVisiblePropertyPage(!0),this.loadSchemaPropertiesPage()},onSchemaCaptionChange:function(e,t){this.get("Schema").setLocalizableStringPropertyValue("caption",t),this.sandbox.publish("DiagramPageCaptionChanged",t)},onOpenMetaDataClick:function(){var e=this.get("Schema"),t=Terrasoft.Resources.ProcessSchemaDesigner.Messages.SaveMetaDataConfirmationMessage,r=Ext.String.format(t,e.typeCaption);this.showSaveConfirmationDialog(r,(function(){Terrasoft.BaseSchemaDesignerUtilities.openMetaData(e)}),this)},onExportSchemaClick:function(){var e=this.get("Schema"),t=Terrasoft.Resources.ProcessSchemaDesigner.Messages.SaveMetaDataConfirmationMessage,r=Ext.String.format(t,e.typeCaption);this.showSaveConfirmationDialog(r,(function(){this.preventSaveToStorage=!0,Terrasoft.BaseSchemaDesignerUtilities.exportMetaData(e),e.setPropertyValue("isDelivered",!0),this.preventSaveToStorage=!1}),this)},clearSchemaItems:Terrasoft.abstractFn,selectItem:Terrasoft.abstractFn,clearSelection:Terrasoft.abstractFn,setValidationConfig:function(){this.addColumnValidator("SchemaCaption",this.schemaCaptionValidator),this.addColumnValidator("Schema",this.validateSchema)},validateViewModel:function(e,t){this.validateProcessSchema((function(){var r=this.validate();if(r)e.call(t,r,!0);else{var n=this.getValidationMessage();this.showValidationMessage(n,(function(n){e.call(t,r,n)}),t)}}),this)},getSaveButtonMenuItems:function(){return[this.getSaveNewVersionButtonConfig(),this.getSaveCurrentVersionMenuItem()]},getSaveNewVersionButtonConfig:function(){return Ext.create("Terrasoft.BaseViewModel",{values:{Caption:Terrasoft.Resources.SchemaDesigner.SaveNewVersionButtonCaption,Id:this.id+"-save-new-version-btn",Click:{bindTo:"saveNewVersion"},MarkerValue:"saveNewVersion"}})},getSaveCurrentVersionMenuItem:function(){return Ext.create("Terrasoft.BaseViewModel",{values:{Caption:Terrasoft.Resources.SchemaDesigner.SaveCurrentVersion,Id:this.id+"-save-current-version-mi",Click:{bindTo:"forceSave"},MarkerValue:"saveCurrentVersion"}})}}),Ext.define("Terrasoft.core.SchemaManagerDataProvider",{extend:"Terrasoft.BaseObject",alternateClassName:"Terrasoft.SchemaManagerDataProvider",singleton:!0,serviceProvider:Terrasoft.ServiceProvider,contractNames:["GetLazyPropertiesRequest","SchemaDesignerRequest","EntitySchema","EntitySchemaRequest","AggregatedEntitySchemaRequest","RemoveEntitySchemaRequest","ClientUnitSchemaRequest","ClientUnitSchema","RemoveClientUnitSchemaRequest","ProcessSchema","ProcessSchemaRequest","RemoveProcessSchemaRequest","ProcessSchemaUserTask"],execute:function(e,t,r){if(!Ext.Array.contains(this.contractNames,e.contractName))throw new Terrasoft.ItemNotFoundException;var n={serverMethod:e.contractName,responseClassName:e.responseClassName,data:e};this.serviceProvider.execute(n,(function(e){t.call(r,e)}),this)}}),Ext.define("Terrasoft.manager.SchemaDesignerUtilities",{extend:"Terrasoft.BaseObject",alternateClassName:"Terrasoft.SchemaDesignerUtilities",singleton:!0,contractName:"SchemaDesignerRequest",dataProvider:Terrasoft.SchemaManagerDataProvider,defaultTimeout:6e7,dataValueTypeInfo:null,cachedPackageHierarchy:null,_cachedAvailablePackages:null,_allPackageHierarchy:null,_packageTopologicalOrder:null,_lastPackageInHierarchy:null,orderByTopology:function(e,t){Ext.Array.sort(e,(function(e,r){return t.indexOf(r)-t.indexOf(e)}))},lockPackageElements:function(e,t,r){this.execute({lockPackageElements:e},t,r)},updateClienUnitSchemasFileContent:function(e,t,r){var n=Ext.String.format(Terrasoft.Resources.ObsoleteMessages.ObsoleteMethodMessage,"updateClienUnitSchemasFileContent","updateClientUnitSchemasFileContent");console.warn(n),this.updateClientUnitSchemasFileContent(e,t,r)},updateClientUnitSchemasFileContent:function(e,t,r){this.execute({updateClienUnitSchemasFileContent:e},t,r)},saveSchemaDBStructure:function(e,t,r){this.execute({saveSchemaDBStructure:e},t,r)},buildWorkspace:function(e,t){this.execute({buildWorkspace:!0},e,t)},forceBuildWorkspace:function(e,t){this.execute({forceBuildWorkspace:!0},e,t)},refreshClientUnitSchemaItems:function(e,t){this.execute({refreshClientUnitSchemaItems:!0},e,t)},buildChangedConfiguration:function(e,t){this.execute({buildChangedConfiguration:!0},e,t)},buildOData:function(e,t){this.execute({buildOData:!0},e,t)},buildAllConfiguration:function(e,t){this.execute({buildAllConfiguration:!0},e,t)},getPackageHierarchy:function(e,t,r){r=r||[];var n=this.getPackageHierarchyFromCache(e);if(n)Terrasoft.appendIf(r,n);else{var i=[e],a=t[e];Terrasoft.each(a,(function(e){this.getPackageHierarchy(e,t,i)}),this),Terrasoft.appendIf(r,i),this.savePackageHierarchyInCache(Terrasoft.deepClone(i))}return r},forceGetPackageHierarchy:function(e,t,r){if(this._allPackageHierarchy&&this._packageTopologicalOrder){var n=this.getPackageHierarchy(e,this._allPackageHierarchy);return this.orderByTopology(n,this._packageTopologicalOrder),Ext.callback(t,r,[n,Ext.clone(this._packageTopologicalOrder)])}return Ext.create("Terrasoft.BuildPackageHierarchyRequest").execute((function(n){if(!n||!n.success)throw new Terrasoft.InvalidOperationException({message:n.errorInfo.toString()});if(this._allPackageHierarchy=n.packageHierarchy,this._packageTopologicalOrder=n.packageTopologicalOrder,!e)throw new Terrasoft.NullOrEmptyException;Terrasoft.isEmptyGUID(e)&&(e=this._packageTopologicalOrder[this._packageTopologicalOrder.length-1],this._lastPackageInHierarchy=e);var i=this.getPackageHierarchy(e,n.packageHierarchy);this.orderByTopology(i,n.packageTopologicalOrder),Ext.callback(t,r,[i,Ext.clone(this._packageTopologicalOrder)])}),this)},getPackageHierarchyFromCache:function(e){return Terrasoft.isEmptyGUID(e)&&this._lastPackageInHierarchy&&(e=this._lastPackageInHierarchy),this.cachedPackageHierarchy&&this.cachedPackageHierarchy[e]},savePackageHierarchyInCache:function(e){Ext.isEmpty(this.cachedPackageHierarchy)&&(this.cachedPackageHierarchy={});var t=Terrasoft.deepClone(e);this.cachedPackageHierarchy[t[0]]=t},buildPackageHierarchy:function(e,t,r){var n=null,i=!1;if(Ext.isString(e)){n=e;var a=Terrasoft.Resources.ObsoleteMessages.ArgumentTypeObsoleteMessage,s=Ext.String.format(a,"String","config","Object");window.console.log(s)}else{if(!Ext.isObject(e))throw new Terrasoft.ArgumentNullOrEmptyException;n=e.packageUId,i=e.useCache}var o=i?this.getPackageHierarchyFromCache(n):null;Ext.isEmpty(o)?this.forceGetPackageHierarchy(n,(function(e){this.savePackageHierarchyInCache(e),t.call(r,e)}),this):t.call(r,o)},getDataValueTypeInfo:function(e,t){this.dataValueTypeInfo?e.call(t,this.dataValueTypeInfo):this.execute({getDataValueTypeInfo:!0},(function(r){var n=r.dataValueTypeInfo;this.dataValueTypeInfo=n,e.call(t,n)}),this)},getSchemaHierarchy:function(e,t,r){var n;Terrasoft.chain((function(t){this.buildPackageHierarchy({packageUId:e.packageUId,useCache:!1},t,this)}),(function(e,t){n=t,e()}),(function(){for(var i=n.pop(),a=e.name,s=[];i;){var o=Terrasoft.ClientUnitSchemaManager.getItems().filterByPath("name",a).filterByPath("packageUId",i).first();o&&s.push(o),i=n.pop()}Terrasoft.ClientUnitSchemaManager.getInstances(s,t,r)}),this)},getSchemaRelatives:function(e,t,r){var n=e.getPropertyValue("uId"),i=Terrasoft.ClientCoreCache,a=i.getItem(n);if(a)t.call(r,a);else if(a={parent:null,current:e},e.extendParent)this.getSchemaHierarchy(e,(function(e){var s=e.pop(),o=e.pop();a.parent=o,a.current=s,i.setItem(n,a),t.call(r,a)}),this);else{var s=e.getPropertyValue("parentSchemaUId");s?Terrasoft.ClientUnitSchemaManager.getInstanceByUId(s,(function(e){a.parent=e,i.setItem(n,a),t.call(r,a)}),this):(i.setItem(n,a),t.call(r,a))}},getMaxEntitySchemaNameLength:function(e,t){this.execute({getMaxEntitySchemaNameLength:!0},(function(r){r&&r.success&&e.call(t,r.maxEntitySchemaNameLength)}),this)},getSchemaPackageHierarchy:function(e,t,r){this.execute({getSchemaHierarchy:e},(function(e){e&&e.success&&t.call(r,e.schemaHierarchy)}),this)},getAvailablePackages:function(e,t){this._cachedAvailablePackages?e.call(t,Terrasoft.deepClone(this._cachedAvailablePackages)):Ext.create("Terrasoft.GetAvailablePackagesRequest").execute((function(r){if(!r||!r.success)throw new Terrasoft.InvalidOperationException({message:r.errorInfo.toString()});this._cachedAvailablePackages=r.availablePackages,e.call(t,Terrasoft.deepClone(this._cachedAvailablePackages))}),this)},updatePackageSchemaData:function(e,t,r){Ext.create("Terrasoft.UpdatePackageSchemaDataRequest",e).execute(t,r)},getCurrentPackageUId:function(e,t){this.execute({getCurrentPackageUId:!0},(function(r){if(!r||!r.success)throw new Terrasoft.InvalidOperationException({message:r.errorInfo.toString()});e.call(t,r.currentPackageUId)}),this)},getSchemasWithForeignLock:function(e,t,r,n){t&&t.length>0?Ext.create("Terrasoft.ParametrizedRequest",{contractName:"GetSchemasWithForeignLockRequest",config:{packageUId:e,schemas:t}}).execute((function(e){if(!e||!e.success)throw new Terrasoft.InvalidOperationException({message:e&&e.errorInfo&&e.errorInfo.toString()});r.call(n,e.lockedSchemas)}),this):r.call(n)},execute:function(e,t,r){var n=Ext.apply({},e,{contractName:this.contractName,requestTimeout:this.defaultTimeout,responseClassName:"Terrasoft.BaseResponse"});this.dataProvider.execute(n,t,r)},getSchemaResources:function(e){var t={};return Terrasoft.each(e,(function(e,r){var n=r.split(".");this.setSchemaResource(t,n,e)}),this),t},setSchemaResource:function(e,t,r){var n=t.shift(),i=e[n]=e[n]||{};t.length>0?this.setSchemaResource(i,t,r):e[n]=r},createInstanceByMetaData:function(e){var t=Terrasoft.decode(e.metaData).metaData.schema;t.metaData=e.metaData;var r=Ext.create(e.schemaClassName,t),n=e.resources;if(n){var i=this.getSchemaResources(n);r.loadLocalizableValues(i)}return r},getColumnCaptionPathByMetaPath:function(e,t,r){var n={getColumnCaptionPathByMetaPath:e};this.execute(n,(function(e){t.call(r,e.columnCaptionPath,e)}),r)},getColumnMetaPathByCaptionPath:function(e,t,r){var n={getColumnMetaPathByCaptionPath:e};this.execute(n,(function(e){t.call(r,e.columnMetaPath,e)}),r)},getEntitySchemaColumnPathByMetaPath:function(e,t,r){var n={getSchemaColumnInformation:e};this.execute(n,(function(e){var n=e&&e.getSchemaColumnInformationResponse;if(Ext.isEmpty(n))throw new Terrasoft.InvalidOperationException;t.call(r,n)}),this)},getEntitySchemaColumnInformationByPath:function(e,t,r){var n={getSchemaColumnInformation:e};this.execute(n,(function(e){var n=e&&e.getSchemaColumnInformationResponse;if(Ext.isEmpty(n))throw new Terrasoft.InvalidOperationException;t.call(r,{columnMetaPath:n.columnMetaPath,dataValueType:Terrasoft.ServerDataValueType[n.columnDataValueTypeUId]})}),this)},clearCachedPackageHierarchy:function(){this.cachedPackageHierarchy=null,this._packageTopologicalOrder=null,this._allPackageHierarchy=null,this._lastPackageInHierarchy=null}}),Ext.define("Terrasoft.manager.MetaItem",{extend:"Terrasoft.core.BaseObject",alternateClassName:"Terrasoft.MetaItem",statics:{nameValidator:function(e){var t={isValid:!0};return/^[a-zA-Z]{1}[a-zA-Z0-9_]*$/.test(e)||(t.isValid=!1,t.invalidMessage=Terrasoft.Resources.MetaItem.WrongNameMessage),t}},mixins:{serializable:"Terrasoft.Serializable"},serializableProperties:["uId","realUId","name","createdInSchemaUId","modifiedInSchemaUId","createdInPackageId"],uId:null,name:null,realUId:null,createdInSchemaUId:null,modifiedInSchemaUId:null,createdInPackageId:null,constructor:function(e){this.checkNullOrEmptyArguments(e),this.callParent(arguments)},checkNullOrEmptyArguments:function(e){var t=this.getRequiredAttributes(),r=[];Terrasoft.each(t,(function(t){Ext.isObject(e)&&void 0!==e[t]&&null!==e[t]||r.push(t)}),this);var n="argumentNames: "+r.join(", ");if(!Ext.isEmpty(r))throw new Terrasoft.ArgumentNullOrEmptyException({message:n})},getSerializableObject:function(e){this.getSerializableProperties().forEach((function(t){this.setSerializableProperty(e,t)}),this)},getSerializableProperties:function(){return Terrasoft.deepClone(this.serializableProperties)},setSerializableCollectionProperty:function(e,t){var r=this[t];e[t]=this.getSerializableProperty(r.getItems())},getRestoreOrder:function(e){return e},getPropertyValue:function(e){return this[e]},setPropertyValue:function(e,t,r){var n=r&&r.silent,i=this[e];if(i&&Terrasoft.instanceOfClass(i,"Terrasoft.LocalizableString")&&t&&!Terrasoft.instanceOfClass(t,i.alternateClassName))throw new Terrasoft.UnsupportedTypeException({message:Terrasoft.Resources.Managers.Exceptions.UsingInvalidSetMethod});if(!Terrasoft.isEqual(i,t)&&(this[e]=t,!n)){var a={};a[e]=t,this.fireEvent("changed",a,this)}},initLocalizableStringValue:function(e,t){t=t||{},Terrasoft.isInstanceOfClass(t,"Terrasoft.LocalizableString")||(t=Ext.create("Terrasoft.LocalizableString",{cultureValues:t})),this[e]=t},getRequiredAttributes:function(){return[]},saveState:function(){this._state=this.serialize()},restorePropertyValue:function(e,t){this.getPropertyValue(e)instanceof Terrasoft.MetaItem?this.getPropertyValue(e).restoreState(t):this.getPropertyValue(e)instanceof Terrasoft.LocalizableString?Terrasoft.each(t,(function(t,r){this.setLocalizableStringPropertyValue(e,t,r)}),this):this.setPropertyValue(e,t)},restoreState:function(e){if(!e){if(!this._state)return;e=JSON.parse(this._state)}this.getRestoreOrder(_.keys(e)).map(function(t){this.restorePropertyValue(t,e[t])}.bind(this))},setUId:function(e){this.setPropertyValue("uId",e)},getUId:function(){return this.uId},setName:function(e){this.setPropertyValue("name",e)},getName:function(){return this.name}}),Ext.define("Terrasoft.manager.BaseSchema",{extend:"Terrasoft.manager.MetaItem",alternateClassName:"Terrasoft.BaseSchema",serializableProperties:["uId","realUId","name","description","extendParent","packageUId","createdInSchemaUId","modifiedInSchemaUId","createdInPackageId"],contractName:"BaseSchema",caption:null,description:null,extendParent:!1,packageUId:null,hasLazyParameters:!1,define:Terrasoft.emptyFn,setLocalizableStringPropertyValue:function(e,t,r){var n=this[e];Terrasoft.validateObjectClass(n,"Terrasoft.LocalizableString");var i="";if(r?(i=n.getCultureValue(r),n.setCultureValue(r,t)):(i=n.getValue(),n.setValue(t)),i!==t){var a={};a[e]=n,this.fireEvent("changed",a,this)}},constructor:function(e){this.callParent(arguments);var t=e&&e.caption||this.caption;this.initLocalizableStringValue("caption",t);var r=e&&e.description;this.initLocalizableStringValue("description",r),this.addEvents("changed"),this.initEvents()},initEvents:Terrasoft.emptyFn,getCaption:function(){var e=this.caption;return e?e.getValue():null},getDisplayValue:function(){return this.getCaption()||this.getName()},getPackageUId:function(){return this.packageUId},initCollection:function(e,t,r){var n=this[e],i=Ext.create("Terrasoft.Collection");Terrasoft.each(n,(function(e){var n=Terrasoft.deepClone(e);n.parentSchema=r;var a=Ext.create(t,n);i.add(a.uId,a)}),this),this[e]=i},loadLocalizableValues:function(e){e&&Terrasoft.each(["Caption","Description"],(function(t){this[Terrasoft.toLowerCamelCase(t)]=Ext.create("Terrasoft.LocalizableString",{cultureValues:e[t]})}),this)},loadLocalizableValuesByUIds:function(e){e&&Terrasoft.each(["caption","description"],(function(t){this[t]=Ext.create("Terrasoft.LocalizableString",{cultureValues:e[this.uId+"."+t]})}),this)},getLocalizableValues:function(e){Terrasoft.each(["caption","description"],(function(t){e[this.uId+"."+t]=this.getSerializableProperty(this[t])}),this)},isNew:Terrasoft.abstractFn,canDesignSchema:function(){return!0}}),Ext.define("Terrasoft.core.BaseSchemaResponse",{alternateClassName:"Terrasoft.BaseSchemaResponse",extend:"Terrasoft.BaseResponse",schemaClassName:"Terrasoft.BaseSchema",getResponsePropertyNames:function(){var e=this.callParent(arguments);return e.push("schema"),e},createSchemaInstance:function(e){return Ext.create(this.schemaClassName,e)},initPropertyValue:function(e,t){return t=this.callParent(arguments),"schema"===e&&t&&!Terrasoft.instanceOfClass(t,this.schemaClassName)&&(t=this.createSchemaInstance(t)),t},destroyPropertyValue:function(e){"schema"===e&&this[e].destroy(),this.callParent(arguments)}}),Ext.define("Terrasoft.manager.ProcessLabelSchema",{extend:"Terrasoft.manager.MetaItem",alternateClassName:"Terrasoft.ProcessLabelSchema",nodeType:Terrasoft.diagram.UserHandlesConstraint.Label,parentUId:null,x:null,y:null,typeName:"Terrasoft.Core.Process.ProcessSchemaLabel",getSerializableProperties:function(){return["uId","parentUId","x","y","name","typeName","createdInSchemaUId"]},subscribeOnChangedEvent:function(e,t){this.on("changed",e,t)},unsubscribeOnChangedEvent:function(e,t){this.un("changed",e,t)}}),Ext.define("Terrasoft.data.queries.BaseSchemaRequest",{extend:"Terrasoft.BaseRequest",alternateClassName:"Terrasoft.BaseSchemaRequest",responseClassName:"Terrasoft.BaseSchemaResponse",uId:null,packageUId:null,getSerializableObject:function(e){e.uId=this.uId,e.packageUId=this.packageUId}}),Ext.define("Terrasoft.manager.BaseSchemaManagerItem",{extend:"Terrasoft.manager.BaseManagerItem",alternateClassName:"Terrasoft.BaseSchemaManagerItem",instanceClassName:"Terrasoft.BaseSchema",requestClassName:"Terrasoft.BaseSchemaRequest",updateRequestClassName:null,removeRequestClassName:null,uId:null,packageUId:null,name:null,caption:null,parentUId:null,isLocked:!1,extendParent:!1,extraProperties:null,sysWorkspaceId:null,status:Terrasoft.ModificationStatus.NOT_MODIFIED,instance:null,getInstanceWithResponse:function(e,t){var r=this.getSafeCallback(e,t);this.instance?r(this.instance):this.forceGetInstance((function(e,t){this.setInstance(e),r(e,t)}),this)},getUId:function(){return this.uId},getPackageUId:function(){return this.packageUId},getName:function(){return this.name},getCaption:function(){return this.caption},getDisplayValue:function(){return this.caption||this.name},getParentUId:function(){return this.parentUId},getIsLocked:function(){return this.isLocked},getSysWorkspaceId:function(){return this.sysWorkspaceId},getExtendParent:function(){return this.extendParent},getStatus:function(){return this.status},isModified:function(){return this.getStatus()!==Terrasoft.ModificationStatus.NOT_MODIFIED},isNew:function(){return this.getStatus()===Terrasoft.ModificationStatus.NEW},setStatus:function(e){var t=this.status;this.status=e,t!==e&&this.fireEvent("statusChanged",this)},getInstance:function(e,t){var r=this.getSafeCallback(e,t);this.instance?r(this.instance):this.forceGetInstance((function(e,t){if(this.setInstance(e),!t.success){var n=t.errorInfo,i=n?n.toString():"";throw new Terrasoft.InvalidOperationException({message:i})}r(e)}),this)},revert:function(){this.setStatus(Terrasoft.ModificationStatus.NOT_MODIFIED),this.instance=null},onAfterSave:function(e){e&&e.success&&(this.fireEvent("outdated",this),this.status=Terrasoft.ModificationStatus.NOT_MODIFIED)},save:function(e,t,r){if(!this.isModified())return Ext.callback(t,r);this.status===Terrasoft.ModificationStatus.REMOVED?this.applyRemove(t,r):(this.checkInstance(),Terrasoft.chain((function(e){this.applyChanges(e,this)}),(function(e,n){this.onAfterSave(n),Ext.callback(t,r,[n])}),this))},getPackageInstance:function(e,t,r){var n={packageUId:e};this.getInstanceRequest(n).execute((function(e){if(!e||!e.success)throw new Terrasoft.InvalidOperationException({message:e.errorInfo.toString()});t.call(r,e.schema)}),r)},getPackageInstace:function(){this.getPackageInstance.call(this,arguments)},forceGetInstance:function(e,t){this.forceGetInstanceByConfig(null,e,t)},forceGetInstanceByConfig:function(e,t,r){this.getInstanceRequest(e).execute((function(e){e=e||{},t.call(r,e.schema,e)}),r)},refresh:function(e,t){var r=[];this.status!==Terrasoft.ModificationStatus.REMOVED&&this.status!==Terrasoft.ModificationStatus.NEW&&this.instance&&(this.clearInstance(),r.push(this.getInstance)),r.push((function(e){this.status=Terrasoft.ModificationStatus.NOT_MODIFIED,e()}));var n=this.getSafeCallback(e,t);r.push(n),r.push(this),Terrasoft.chain.apply(this,r)},setPropertyValue:function(e,t){this.checkInstance(),this.instance.setPropertyValue(e,t),this.callParent(arguments)},setLocalizableStringPropertyValue:function(e,t,r){this.checkInstance(),this.instance.setLocalizableStringPropertyValue(e,t,r)},remove:function(){this.callParent(arguments),this.status===Terrasoft.ModificationStatus.NEW?this.fireEvent("removed",this):this.status=Terrasoft.ModificationStatus.REMOVED},copy:function(){throw new Terrasoft.exceptions.NotImplementedException},constructor:function(e){e&&e.instance&&Terrasoft.validateObjectClass(e.instance,this.instanceClassName),this.callParent(arguments),this.instance&&this.instance.on("changed",this.onInstanceChanged,this),this.addEvents("removed"),this.addEvents("outdated"),this.addEvents("statusChanged")},destroy:function(){this.instance&&!this.instance.destroyed&&(this.instance.un("changed",this.onInstanceChanged,this),this.instance.destroy()),delete this.instance,this.callParent(arguments)},clearInstance:function(){this.instance.un("changed",this.onInstanceChanged,this),this.status=Terrasoft.ModificationStatus.NOT_MODIFIED,this.instance=null},setInstance:function(e){this.instance=e,this.instance&&(this.instance.on("changed",this.onInstanceChanged,this),this.status!==Terrasoft.ModificationStatus.REMOVED&&(this.status=Terrasoft.ModificationStatus.NOT_MODIFIED))},applyChanges:function(e,t){var r=this.getSafeCallback(e,t);this.getUpdateRequest().execute((function(e){r(e)}),this)},applyRemove:function(e,t){var r=this.getSafeCallback(e,t);this.getRemoveRequest().execute((function(e){e&&e.success&&this.fireEvent("removed",this),r(e)}),this)},getInstanceRequest:function(e){if(!this.uId)throw new Terrasoft.exceptions.InvalidObjectState;var t=Ext.apply({uId:this.uId,packageUId:this.packageUId},e);return Ext.create(this.requestClassName,t)},getRemoveRequest:function(){if(!this.uId)throw new Terrasoft.exceptions.InvalidObjectState;return Ext.create(this.removeRequestClassName,{uId:this.uId,packageUId:this.packageUId})},getUpdateRequest:function(){if(!this.instance)throw new Terrasoft.exceptions.InvalidObjectState;return Ext.create(this.updateRequestClassName,{schema:this.instance})},checkInstance:function(){if(!this.instance)throw new Terrasoft.exceptions.InvalidObjectState},onInstanceChanged:function(e){var t=["uId","packageUId","parentUId","name","caption"];this.status===Terrasoft.ModificationStatus.NOT_MODIFIED&&(this.status=Terrasoft.ModificationStatus.UPDATED),Terrasoft.each(e,(function(e,r){Ext.Array.contains(t,r)&&(this[r]=Terrasoft.isInstanceOfClass(e,"Terrasoft.LocalizableString")?e.getValue():e)}),this)},createInstance:function(e){if(!this.instanceClassName)throw new Terrasoft.exceptions.InvalidObjectState;return Ext.create(this.instanceClassName,e)}}),Ext.define("Terrasoft.manager.BaseSchemaManagerRequest",{extend:"Terrasoft.BaseObject",alternateClassName:"Terrasoft.BaseSchemaManagerRequest",serviceName:null,methodName:null,timeout:9e8,urlParameters:null,getResponseErrorMessage:function(e){return e.errorInfo?e.errorInfo.toString():e.statusText},getRequestUrl:function(){var e=Ext.isEmpty(this.urlParameters)?"":"?"+Ext.Object.toQueryString(this.urlParameters);return e=this.methodName+e,Terrasoft.combinePath(Terrasoft.workspaceBaseUrl,this.serviceName,e)},callService:function(e,t,r){var n=e.data||{},i=!1===e.encodeData?n:Ext.encode(n),a=this.getRequestUrl();return Terrasoft.AjaxProvider.request({url:a,headers:{Accept:"application/json","Content-Type":"application/json"},method:e.method||"POST",jsonData:i,callback:t,scope:r||this,timeout:this.timeout})},executeRequest:function(e,t,r){this.callService(e,(function(e,n,i){if(n){var a=Terrasoft.decode(Terrasoft.decode(i.responseText));t.call(r||this,a)}else{var s=this.getResponseErrorMessage(i);t.call(r,null,s)}}),this)},execute:function(e,t){this.executeRequest({},e,t)}}),Ext.define("Terrasoft.manager.BaseSchemaManager",{extend:"Terrasoft.manager.BaseManager",alternateClassName:"Terrasoft.BaseSchemaManager",_bundleSchemaCache:{},initialized:!1,initializing:!1,itemClassName:"Terrasoft.BaseSchemaManagerItem",managerName:"",schemaNamePrefix:"",schemaManagerServiceName:"ServiceModel/SchemaManagerService.svc",sysWorkspaceColumnPath:"SysPackage.SysWorkspace",propertyColumnNames:null,itemInstanceClassName:null,entitySchemaName:"SysSchema",defSchemaUId:"",_getCachingGroupKey:function(){return this.managerName+"CachingGroupKey"},_createSchemaInstance:function(e,t,r){Terrasoft.chain((function(t){e.name&&e.caption?t():this.getUniqueNameAndCaption({},t,this)}),(function(n,i,a,s){if(s)t.call(r,null,null,s);else{var o=this.createSchema(Ext.apply({name:i,caption:a},e)),l=this.addSchema(o);t.call(r,o,l,s)}}),this)},_buildPackageHierarchy:function(e,t,r){Terrasoft.SchemaDesignerUtilities.buildPackageHierarchy({packageUId:e,useCache:!0},t,r)},getItemInstanceClassName:function(){return Ext.ClassManager.get(this.itemClassName).prototype.instanceClassName},initItems:function(e){e.each((function(e){var t={};Terrasoft.each(this.propertyColumnNames,(function(r,n){t[n]=e.get(r)}),this),t.status=Terrasoft.ModificationStatus.NOT_MODIFIED;var r=this.createManagerItem(t);this.addItem(r)}),this)},initServiceItems:function(e){var t=this;Terrasoft.each(e,(function(e){var r={status:Terrasoft.ModificationStatus.NOT_MODIFIED};Object.keys(e).forEach((function(t){r[Terrasoft.toLowerCamelCase(t)]=e[t]}));var n=t.createManagerItem(r);t.addItem(n)}))},getSelectQuery:function(){var e=Ext.create("Terrasoft.EntitySchemaQuery",{rootSchemaName:this.entitySchemaName});return Terrasoft.each(this.propertyColumnNames,(function(t){return e.addColumn(t)}),this),e.filters.addItem(Terrasoft.createColumnFilterWithParameter(Terrasoft.ComparisonType.EQUAL,this.sysWorkspaceColumnPath,Terrasoft.SysValue.CURRENT_WORKSPACE.value)),this.addManagerNameFilter(e),e},addManagerNameFilter:function(e){e.filters.addItem(Terrasoft.createColumnFilterWithParameter(Terrasoft.ComparisonType.EQUAL,"ManagerName",this.managerName))},initializeSchemaNamePrefix:function(e,t){Terrasoft.SysSettings.querySysSettings(["SchemaNamePrefix"],(function(r){this.schemaNamePrefix=r.SchemaNamePrefix,Ext.callback(e,t)}),this)},findPackageSchemaUId:function(e,t,r,n){var i=this.items.filter(e);this._buildPackageHierarchy(t,(function(e){var t=null;Terrasoft.each(e,(function(e){return t=i.findByPath("packageUId",e),Ext.isEmpty(t)})),r.call(n,t&&t.getUId())}),this)},getResponseErrorMessage:function(e){return e.errorInfo?e.errorInfo.toString():e.statusText},getUniqueNameAndCaption:function(e,t,r){Ext.isFunction(e)&&(r=t=e,e={}),Ext.create("Terrasoft.BaseSchemaManagerRequest",{serviceName:"ServiceModel/SchemaManagerService.svc",methodName:"GetUniqueNameAndCaption",urlParameters:{managerName:this.managerName,namePrefix:e.namePrefix,captionPrefix:e.captionPrefix}}).execute((function(e,n){n?t.call(r,null,null,n):t.call(r,e.name,e.caption)}),this)},_resetBundleInstanceCache:function(e){var t=this.findRootSchemaItemByName(e.name);if(t){var r=this._getSchemaCacheKey(t.uId,e.packageUId);delete this._bundleSchemaCache[r],r=this._getSchemaCacheKey(t.uId,Terrasoft.GUID_EMPTY),delete this._bundleSchemaCache[r]}},_getSchemaCacheKey:function(e,t){return e+"_"+t},_packageItemsByHierarchyComparer:function(e,t,r){if(e.getName()===t.getName()){var n=e.packageUId,i=t.packageUId;return r.indexOf(i)-r.indexOf(n)}return 0},_getRequestClassName:function(){return Ext.ClassManager.get(this.itemClassName).prototype.requestClassName},_getAggregatedRequestClassName:function(){var e=this._getRequestClassName(),t="Terrasoft.".length;return e.substring(0,t)+"Aggregated"+e.substring(t,e.length)},_getInstanceRequest:function(e,t,r){return Ext.create(e,{uId:t,packageUId:r})},_findPackageItems:function(e,t,r,n){Terrasoft.chain(this.initialize,(function(t){this._buildPackageHierarchy(e,t,this)}),(function(t,r){var n=new Terrasoft.Collection({getKey:function(e){return null==e?void 0:e.getUId()}}),i=this.items;Terrasoft.isEmptyGUID(e)||(i=this.items.filter((function(e){return Terrasoft.contains(r,e.packageUId)}))),n.loadAll(i),t(n,r)}),(function(e,t,r){var n=this;Terrasoft.Features.getIsDisabled("DisableSortPackageItemsByHierarchy")&&(t.sort("name",Terrasoft.OrderDirection.ASC),t.sortByFn((function(e,t){return n._packageItemsByHierarchyComparer(e,t,r)}),this)),e(t)}),(function(e,i){var a=Ext.isFunction(t)?i.filterByFn(t,n):i;r.call(n,a)}),this)},_findSchemaInstance:function(e,t,r){var n=e.schemaUId,i=this.findItem(n);if(i&&i.isNew())i.getInstance(t,r);else{var a=e.packageUId,s=this._getSchemaCacheKey(n,a),o=!1!==e.useCache&&this._bundleSchemaCache[s];if(o)t.call(r,o);else this._getInstanceRequest(e.requestClassName,n,a).execute((function(n){var i;if(n&&n.success)i=n.schema,this._bundleSchemaCache[s]=i;else{var a=e.getErrorMessage();this.error(a)}t.call(r,i)}),this)}},queryItems:function(e,t){this.getSelectQuery().getEntityCollection(e,t)},processItemsQueryResponse:function(e,t){if(!t.success)throw new Terrasoft.InvalidOperationException({message:t.errorInfo});this.initItems(t.collection),e.call(this)},initializeAsync:function(){var e=_asyncToGenerator(regeneratorRuntime.mark((function e(){var t=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,new Promise((function(e){return t.initialize(e,t)}));case 2:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),initialize:function(e,t){this.initialized?this.isOutdated?this.hasModifiedItems()?(console.warn(this.alternateClassName+" is outdated. It can't be reinitialized, because it has modified items."),Ext.callback(e,t)):this.reInitialize(e,t):Ext.callback(e,t):this.initializing?this.on("initialized",(function(){Ext.callback(e,t)}),this,{single:!0}):(this.initializing=!0,Terrasoft.chain(this.queryItems,this.processItemsQueryResponse,this.initializeSchemaNamePrefix,(function(){this.initialized=!0,this.initializing=!1,this.isOutdated=!1,Ext.callback(e,t),this.fireEvent("initialized")}),this))},clear:function(){this.callParent(arguments),this.initialized=!1},saveSchema:function(e,t,r){this.initialized?this.findItemByUId(e,(function(e){e?e.save({},t,r):Ext.callback(t,r)}),this):this.getSafeCallback(t,r)()},save:function(e,t){var r=this.getItems({useFilterFn:!0}),n={success:!0,items:r};Terrasoft.chain((function(e){this.getSaveSequence(r.getItems(),e,this)}),(function(r,i){var a=[];if(this.initialized){var s=function(r){var a=i.pop();a.save({},(function(i){i&&i.success?(this._resetBundleInstanceCache(a),r()):(Ext.apply(n,i),n.failedItem=a,e.call(t,n))}),this)};a=i.map((function(){return s}),this)}a.push((function(){e.call(t,n)})),a.push(this),Terrasoft.chain.apply(this,a)}),this)},onItemRemoved:function(e){e&&(e.un("removed",this.onItemRemoved,this),this.items.remove(e),e.destroy())},onItemOutdated:function(e){this.notify(this.outdatedEventName,{status:e.status,uId:e.uId,name:e.name,caption:e.caption})},getSaveSequence:function(e,t,r){t.call(r,e)},checkIsInitialized:function(){if(!this.initialized)throw new Terrasoft.InvalidObjectState({message:Terrasoft.Resources.Managers.Exceptions.ManagerIsNotInitialized})},getBundleInstanceRequest:function(e,t){var r=this._getRequestClassName();return this._getInstanceRequest(r,e,t)},getSchemaNamePrefix:function(){return this.schemaNamePrefix},addItem:function(e){if(!e)throw new Terrasoft.NullOrEmptyException;return Terrasoft.validateObjectClass(e,this.itemClassName),e.on("removed",this.onItemRemoved,this),e.on("outdated",this.onItemOutdated,this),this.items.add(e.uId,e)},filterFn:function(e){return e.isModified()},constructor:function(){this.callParent(arguments),this.itemInstanceClassName=this.getItemInstanceClassName(),this.propertyColumnNames={id:"Id",name:"Name",caption:"Caption",uId:"UId",packageUId:"SysPackage.UId",parentUId:"Parent.UId",extendParent:"ExtendParent"}},refresh:function(e,t){var r=[];if(this.initialized){var n=this.getItems({useFilterFn:!0}).getItems(),i=function(e){n.pop().refresh(e,this)};r=n.map((function(){return i}),this)}var a=this.getSafeCallback(e,t);r.push(a),r.push(this),Terrasoft.chain.apply(this,r)},getItemByUId:function(e,t,r){Terrasoft.chain((function(e){this.initialized?e():this.initialize(e,this)}),(function(){var n=this.items.get(e);Ext.callback(t,r,[n])}),this)},getInstanceByUId:function(e,t,r){if(arguments.length>3){var n=Ext.String.format(Terrasoft.Resources.ObsoleteMessages.MethodFormatObsolete,"getInstanceByUId","schemaUId, callback, scope, config","schemaUId, callback, scope");this.log(n,Terrasoft.LogMessageType.WARNING)}this.findInstanceByUId(e,(function(e){if(null==e)throw Terrasoft.ItemNotFoundException();t.call(r,e)}),this)},findInstanceByUId:function(e,t,r){Terrasoft.chain((function(t){this.findItemByUId(e,t,this)}),(function(e,n){n&&n.status!==Terrasoft.ModificationStatus.REMOVED?n.getInstance(t,r):t.call(r,null)}),this)},forceGetInstanceByUId:function(e,t,r){Terrasoft.chain((function(t){this.getItemByUId(e,t)}),(function(e,n){if(n.status===Terrasoft.ModificationStatus.REMOVED)throw Terrasoft.ItemNotFoundException();n.forceGetInstance((function(e){t.call(r,e)}),this)}),this)},findItemByUId:function(e,t,r){Terrasoft.chain(this.initialize,(function(){var n=this.items.find(e);t.call(r,n)}),this)},findRootItemByUId:function(e){return this.items.findByFn((function(t){return!t.extendParent&&t.uId===e}),this)},findRootSchemaItemByName:function(e){return this.initialized?this.items.firstOrDefault((function(t){return t.name===e&&!t.getExtendParent()}),this):null},generateItemUniqueName:function(e){var t=e+"{0}";return this.getUniqueNameByTemplate(t)},getUniqueNameByTemplate:function(e){var t,r,n=0;do{n++,t=Ext.String.format(e,n),r=this.items.findByPath("name",t)}while(r);return t},generateItemUniqueCaption:function(e){for(var t=e+" 1",r=1,n=function(e){return e.caption.getValue?e.caption.getValue()===t:e.caption===t};;){if(0===this.items.filterByFn(n).getCount())return t;r++,t=e+" "+r}},addSchema:function(e){if(!e)throw new Terrasoft.NullOrEmptyException;Terrasoft.validateObjectClass(e,this.itemInstanceClassName);var t={};Terrasoft.each(Object.keys(this.propertyColumnNames),(function(r){if(e.hasOwnProperty(r)){var n=e[r],i=Terrasoft.instanceOfClass(n,"Terrasoft.LocalizableString");t[r]=i?n.getValue():n}}),this),t.instance=e;var r=this.createManagerItem(t);return r.setStatus(Terrasoft.ModificationStatus.NEW),this.addItem(r)},createSchema:function(e){return e.extendParent||this.validateSchemaName(e.name),Ext.create(this.itemClassName).createInstance(e)},validateSchemaName:function(e){if(e&&!e.match(this.schemaNamePrefix)){var t=Ext.String.format(Terrasoft.Resources.Managers.Exceptions.SchemaNamePrefixException,this.schemaNamePrefix);throw new Terrasoft.InvalidOperationException({message:t})}},validateSchemaAsParent:function(e){if(0===Terrasoft[this.managerName].getItems().filterByFn((function(t){return t.uId===e&&!t.extendParent})).getCount())throw new Terrasoft.InvalidObjectState},getInstances:function(e,t,r){Terrasoft.eachAsyncAll(e,(function(e,t){e.getInstance(t,this)}),(function(){var n=e.map((function(e){return e.instance}));Ext.callback(t,r,[n])}))},getAllInstances:function(e,t){var r=this.items.getItems();this.getInstances(r,e,t)},getPackageSchemaManagerItem:function(e,t,r){var n=e.packageUId,i=e.schemaUId;Terrasoft.chain((function(e){this.getItemByUId(i,e,this)}),(function(e,i){var a=this.getItems().filterByFn((function(e){return e.getName()===i.getName()&&e.getPackageUId()===n})).first();t.call(r,a)}),this)},forceGetPackageSchema:function(e,t,r){this.getPackageSchemaManagerItem(e,(function(n){n?n.getInstance(t,r):this.requestDesignSchema(e,t,r)}),this)},getDesignSchemaRequestParameters:function(){throw new Terrasoft.NotImplementedException},requestDesignSchema:function(e,t,r){var n=this.getDesignSchemaRequestParameters();Ext.create("Terrasoft.ParametrizedRequest",{contractName:n.contractName,responseClassName:n.responseClassName,config:{uId:e.schemaUId,packageUId:e.packageUId}}).execute((function(e){if(!e.success)throw new Terrasoft.QueryExecutionException({message:e.errorInfo.toString()});t.call(r,e.schema)}))},getModifiedItems:function(){var e=[];if(this.initialized&&!this.initializing)return this.items.each((function(t){t.isModified()&&e.push(t)}),this),e;throw new Terrasoft.InvalidObjectState},hasModifiedItems:function(){if(!this.initialized)return!1;var e=this.findByFn((function(e){return e.isModified()}),this);return!Ext.isEmpty(e)},getPackageSchemaInstanceBySchemaName:function(e,t,r,n){this.findPackageSchemaUId((function(t){return t.name===e}),t,(function(e){this.getInstanceByUId(e,r,n)}),this)},getPackageSchemaInstanceBySchemaUId:function(e,t,r,n){this.getItemByUId(e,(function(e){var i=e.getName();this.getPackageSchemaInstanceBySchemaName(i,t,r,n)}),this)},findSortedByTopologyItems:function(e){var t=Ext.isFunction(e.filterFn)?e.filterFn:function(){return!0},r=e&&e.includeExtensionItems?e.filterFn:function(e){return!e.getExtendParent()&&t(e)};this._findPackageItems(Terrasoft.GUID_EMPTY,r,e.callback,e.scope)},findPackageItems:function(e,t,r){var n=e.filterFn,i=e.packageUId;Ext.isString(e)&&(n=function(e){return!e.getExtendParent()},i=e),this._findPackageItems(i,n,t,r)},findPackageItem:function(e,t,r,n){this.findItemByUId(e,(function(e){e?this._buildPackageHierarchy(t,(function(t){Terrasoft.contains(t,e.packageUId)?r.call(n,e):r.call(n)}),this):r.call(n)}),this)},getAbsentSchemaItemsInHierarchy:function(e,t,r){var n=this,i=e.schemaUIds,a=e.packageUId;Terrasoft.chain((function(e){return n.initialize(e,n)}),(function(e){return n._buildPackageHierarchy(a,e,n)}),(function(e,a){var s=n.items.getItems().filter((function(e){return!function(e){return _.contains(a,e.packageUId)}(e)&&function(e){return _.contains(i,e.uId)}(e)}));t.call(r,s)}))},getSchemaInstance:function(e,t,r){var n=this.findItem(e);n||(n=this.createManagerItem({uId:e})),n.getInstance((function(e,i){if(e)t.call(r,e,n);else{var a=this.getResponseErrorMessage(i);t.call(r,null,null,a)}}),this)},createSchemaInstance:function(e,t,r,n){if(Ext.isObject(e)){var i=e;n=r,r=t,this._createSchemaInstance(i,r,n)}else this._createSchemaInstance({uId:e,packageUId:t},r,n)},getCanEditSchema:function(e,t,r){Ext.create("Terrasoft.BaseSchemaManagerRequest",{serviceName:"ServiceModel/SchemaManagerService.svc",methodName:"CheckHasNoForeignLock",urlParameters:{managerName:this.managerName,schemaUId:e}}).execute((function(e,n){n?t.call(r,null,null,n):t.call(r,e.success,e.message)}),this)},replaceObjectProperty:function(e,t,r,n){var i=Terrasoft.encode(e);return t.forEach((function(e){var t=new RegExp('"'+e+'":"'+r+'"',"gi");i=i.replace(t,'"'+e+'":"'+n+'"')})),Terrasoft.decode(i)},copyLocalizableResources:function(e,t){var r=t.uId;t.uId=e.uId;var n={};e.getLocalizableValues(n),t.loadLocalizableValuesByUIds(n),t.uId=r},copySchema:function(e){var t=Terrasoft.generateGUID(),r={};e.getSerializableObject(r);(r=this.replaceObjectProperty(r,["createdInSchemaUId","modifiedInSchemaUId"],e.uId,t)).uId=t;var n=Ext.create(this.itemInstanceClassName,r);return this.copyLocalizableResources(e,n),this.addSchema(n)},reInitialize:function(e,t){this.clear(),this.initialize(e,t)},findBundleSchemaInstance:function(e,t,r){var n={schemaUId:e.schemaUId,packageUId:e.packageUId,useCache:e.useCache,requestClassName:this._getRequestClassName(),getErrorMessage:function(){return Ext.String.format(Terrasoft.Resources.BaseSchemaManager.Exceptions.SchemaNotFoundMessage,e.schemaUId,e.packageUId)}};this._findSchemaInstance(n,t,r)},findAggregatedSchemaInstance:function(e,t,r){var n={schemaUId:e.schemaUId,packageUId:Terrasoft.GUID_EMPTY,useCache:e.useCache,requestClassName:this._getAggregatedRequestClassName(),getErrorMessage:function(){return Ext.String.format(Terrasoft.Resources.BaseSchemaManager.Exceptions.SchemaNotFoundByUIdMessage,e.schemaUId)}};this._findSchemaInstance(n,t,r)},isInheritedFrom:function(e,t){var r=this.findRootItemByUId(t);if(r)for(var n=this.findRootItemByUId(e);n;){if(n.parentUId===r.uId)return!0;n=this.findRootItemByUId(n.parentUId)}return!1},getSchemaUIdById:function(e,t,r){var n=new Terrasoft.EntitySchemaQuery("SysSchema");n.addColumn("UId"),n.filters.addItem(n.createColumnFilterWithParameter(Terrasoft.ComparisonType.EQUAL,"SysWorkspace",Terrasoft.SysValue.CURRENT_WORKSPACE.value)),n.getEntity(e,(function(n){if(n.entity)Ext.callback(t,r,[n.entity.$UId]);else{var i=Terrasoft.Resources.ProcessDiagram.Messages.ProcessSchemaNotFound,a=Ext.String.format(i,e);this.warning(a),Terrasoft.showErrorMessage(a)}}),this)},startWithPrefix:function(e){var t=this.getSchemaNamePrefix();return e.startsWith(t)},generateUniqueSchemaName:function(e){var t=this.schemaNamePrefix||"";if(Terrasoft.useSchemaUniqueNameRandomGenerator){var r=Terrasoft.generateGUID().substring(0,8);return t+Ext.String.format(e,r)}for(var n=this.getItems(),i=t+Ext.String.format(e,1),a=1,s=n.getCount();a<s;a++){if(i=t+Ext.String.format(e,a),n.filterByPath("name",i).isEmpty())break}return i},generateNameWithPrefix:function(e){if(!this.isInitialized)throw new Error("Manager is not initialized");return e.startsWith(this.schemaNamePrefix)?e:this.schemaNamePrefix+e},resetBundleInstanceCache:function(){this._bundleSchemaCache={}}}),Object.defineProperty(Terrasoft.BaseSchemaManager.prototype,"isInitialized",{get:function(){return this.initialized},set:function(e){this.initialized=e}}),Object.defineProperty(Terrasoft.BaseSchemaManager.prototype,"isInitializing",{get:function(){return this.initializing},set:function(e){this.initializing=e}}),Ext.define("Terrasoft.manager.EntitySchemaColumn",{extend:"Terrasoft.core.BaseObject",alternateClassName:"Terrasoft.EntitySchemaColumn",mixins:{serializable:"Terrasoft.Serializable"},serializableProperties:["uId","name","caption","description","dataValueType","isInherited","isOverride","referenceSchemaUId","referenceSchemaName","isRequired","isVirtual","isValueCloneable","isMultilineText","isMasked","isFormatValidated","isSimpleLookup","isCascade","status","isIndexed","isWeakReference","usageType","isSensitiveData","defValue"],uId:null,name:null,caption:null,description:null,isInherited:!1,isOverride:!1,referenceSchemaUId:null,referenceSchemaName:null,isRequired:!1,isVirtual:!1,isValueCloneable:!1,isMultilineText:!1,isMasked:!1,isFormatValidated:!1,isSensitiveData:!1,isSimpleLookup:!1,isCascade:!1,status:Terrasoft.ModificationStatus.NOT_MODIFIED,isIndexed:!0,isWeakReference:!1,dataValueType:null,defValue:null,usageType:Terrasoft.EntitySchemaColumnUsageType.General,designToolClassName:"Terrasoft.SchemaColumnDesignToolItem",initLocalizableStringValue:function(e,t){t=t||{},Terrasoft.instanceOfClass(t,"Terrasoft.LocalizableString")||(t=Ext.create("Terrasoft.LocalizableString",{cultureValues:t})),this[e]=t},constructor:function(e){this.callParent(arguments);var t=e&&e.caption;this.initLocalizableStringValue("caption",t);var r=e&&e.description;this.initLocalizableStringValue("description",r),this.addEvents("changed")},getPropertyValue:function(e){return this[e]},setLocalizableStringPropertyValue:function(e,t,r){Terrasoft.validateObjectClass(this[e],"Terrasoft.LocalizableString"),r?this[e].setCultureValue(r,t):this[e].setValue(t);var n={};n[e]=this[e],this.onColumnChanged(n),this.fireEvent("changed",n,this)},setPropertyValue:function(e,t){var r=this[e];if(r&&Terrasoft.instanceOfClass(r,"Terrasoft.LocalizableString")&&t&&!Terrasoft.instanceOfClass(t,r.alternateClassName))throw new Terrasoft.UnsupportedTypeException({message:Terrasoft.Resources.Managers.Exceptions.UsingInvalidSetMethod});this[e]=t;var n={};n[e]=t,this.onColumnChanged(n),this.fireEvent("changed",n,this)},getStatus:function(){return this.status},setStatus:function(e){this.setPropertyValue("status",e)},setNew:function(){this.setStatus(Terrasoft.ModificationStatus.NEW)},setRemoved:function(){this.setStatus(Terrasoft.ModificationStatus.REMOVED)},onColumnChanged:function(){this.status===Terrasoft.ModificationStatus.NOT_MODIFIED&&(this.status=Terrasoft.ModificationStatus.UPDATED)},getSerializableObject:function(e){Terrasoft.each(this,(function(t,r){Ext.isEmpty(t)||Ext.isFunction(t)||!Ext.Array.contains(this.serializableProperties,r)||(e[r]=this.getSerializableProperty(t))}),this)}}),Ext.define("Terrasoft.manager.EntitySchema",{extend:"Terrasoft.manager.BaseSchema",alternateClassName:"Terrasoft.EntitySchema",contractName:"EntitySchema",serializableProperties:["uId","realUId","name","caption","description","extendParent","packageUId","parentUId","isVirtual","isDBView","isTrackChangesInDB","showInAdvancedMode","administratedByOperations","administratedByColumns","administratedByRecords","useMasterRecordRights","masterRecordSchemaName","columns","primaryColumnUId","primaryDisplayColumnUId","hierarchyColumnUId"],parentUId:null,isVirtual:null,isDBView:null,isTrackChangesInDB:null,showInAdvancedMode:null,administratedByOperations:null,administratedByColumns:null,administratedByRecords:null,useMasterRecordRights:null,masterRecordSchemaName:null,columns:null,columnClassName:"Terrasoft.EntitySchemaColumn",primaryColumnUId:null,primaryDisplayColumnUId:null,primaryColorColumnUId:null,hierarchyColumnUId:null,primaryColumn:null,primaryDisplayColumn:null,hierarchyColumn:null,constructor:function(e){this.callParent(arguments),this.columns=new Terrasoft.ObjectCollection,e.columns&&Terrasoft.each(e.columns.Items,(function(e){var t=this.createColumn(Ext.apply({},e,{status:Terrasoft.ModificationStatus.NOT_MODIFIED}));this.addColumn(t),this.setSystemColumn(t)}),this)},onColumnChange:function(e,t){var r={columns:[e],column:t};this.fireEvent("changed",r,this)},createColumn:function(e){return Ext.create(this.columnClassName,Ext.apply({},e,{status:Terrasoft.ModificationStatus.NEW}))},addColumn:function(e){if(!e)throw new Terrasoft.NullOrEmptyException;Terrasoft.validateObjectClass(e,this.columnClassName);var t=e.getPropertyValue("uId"),r=Terrasoft.generateGUID(),n=Ext.isEmpty(t)?r:t;e.setPropertyValue("uId",n);var i=this.columns.add(n,e);if(i.on("changed",this.onColumnChange,this),e.getStatus()===Terrasoft.ModificationStatus.NEW){var a=e.getPropertyValue("name");this.fireEvent("changed",{newColumns:[a]},this)}return i},removeColumnByUId:function(e){this.getColumnByUId(e).setRemoved()},findColumnByUId:function(e){return this.columns.find(e)},getColumnByUId:function(e){return this.columns.get(e)},setParent:function(e,t,r){var n=null,i=null;Ext.isObject(e)?(n=e.uId,i=e.packageUId):n=e,n?(Terrasoft.EntitySchemaManager.validateSchemaAsParent(n),this.clear(),Terrasoft.EntitySchemaManager.findItemByUId(n,(function(e){i=i||e.packageUId,e.getPackageInstance(i,(function(e){var n={};e.serializationInfo=e.serializationInfo||{},e.getSerializableObject(n),n.parentUId=n.uId,n.uId=this.uId,n.realUId=this.realUId,n.caption=this.caption||Terrasoft.decodeLocalizableString(n.caption),n.description=this.description||Terrasoft.decodeLocalizableString(n.description),n.administratedByRecords=this.administratedByRecords,n.administratedByColumns=this.administratedByColumns,n.administratedByOperations=this.administratedByOperations,n.useMasterRecordRights=this.useMasterRecordRights,n.masterRecordSchemaName=this.masterRecordSchemaName,delete n.name,delete n.isVirtual,delete n.extendParent,delete n.packageUId,Terrasoft.each(n.columns.items,(function(e){e.caption=Terrasoft.decodeLocalizableString(e.caption),e.description=Terrasoft.decodeLocalizableString(e.description),e.isInherited=!0,e.status=Terrasoft.ModificationStatus.NOT_MODIFIED}),this),this.serializationInfo=this.serializationInfo||{};var i=this.getSerializableProperty(this.columns);n.columns.Items=Ext.apply(n.columns.items,i.items),this.constructor(n),this.fireEvent("changed",n,this),t.call(r)}),this)}),this)):(this.clear(),this.setPropertyValue("parentUId",null),t.call(r))},define:function(e){function t(){return e.apply(this,arguments)}return t.toString=function(){return e.toString()},t}((function(){var e=this.name,t=this.primaryColumn,r=this.primaryDisplayColumn,n=this.getLczValue(this.caption),i=this.getEntitySchemaColumnList(),a=Ext.String.format("Terrasoft.data.models.{0}",e),s=Ext.String.format("Terrasoft.{0}",e);Ext.define(a,{extend:"Terrasoft.BaseEntitySchema",alternateClassName:s,singleton:!0,uId:this._getBaseUId(),name:e,caption:n,administratedByRecords:this.administratedByRecords,administratedByOperations:this.administratedByOperations,useMasterRecordRights:this.useMasterRecordRights,masterRecordSchemaName:this.masterRecordSchemaName,primaryColumnName:t&&t.name,primaryDisplayColumnName:r&&r.name,columns:i}),define(e,["terrasoft"],(function(t){return t[e]}))})),undef:function(){requirejs.undef(this.name)},getSerializableObject:function(e){this.callParent(arguments),e.columns=this.getSerializableProperty(this.columns)},setSystemColumn:function(e){e.uId===this.primaryColumnUId&&(this.primaryColumn=e),e.uId===this.primaryDisplayColumnUId&&(this.primaryDisplayColumn=e),e.uId===this.hierarchyColumnUId&&(this.hierarchyColumn=e)},clear:function(){this.columns&&this.columns.filterByFn((function(e){return e.getPropertyValue("isInherited")}),this).eachKey((function(e,t){switch(this.columns.removeByKey(e),t.destroy(),e){case this.primaryColumnUId:this.primaryColumnUId=null,this.primaryColumn=null;break;case this.primaryDisplayColumnUId:this.primaryDisplayColumnUId=null,this.primaryDisplayColumn=null;break;case this.hierarchyColumnUId:this.hierarchyColumnUId=null,this.hierarchyColumn=null}}),this)},getLczValue:function(e){return(e||"").toString()},getEntitySchemaColumnList:function(){var e=this,t={};return this.columns&&this.columns.each((function(r){var n=r.name,i=r.dataValueType,a=e.getLczValue(r.caption),s=r.referenceSchemaUId,o=Terrasoft.isLookupDataValueType(i),l={uId:r.uId,name:n,caption:a,dataValueType:i,type:Terrasoft.ViewModelColumnType.ENTITY_COLUMN,usageType:r.usageType,isInherited:r.isInherited,columnPath:r.name,isLookup:o};if(t[n]=l,o&&s){l.referenceSchemaUId=s;var c=Terrasoft.EntitySchemaManager.getItem(s).name;l.referenceSchema={name:c},l.referenceSchemaName=c}})),t},getColumnCaptionPathByMetaPath:function(e,t,r){Terrasoft.SchemaDesignerUtilities.getColumnCaptionPathByMetaPath(e,t,r)},getColumnMetaPathByCaptionPath:function(e,t,r){e=this.getCaption()+"."+e,Terrasoft.SchemaDesignerUtilities.getColumnMetaPathByCaptionPath(e,t,r)},findColumnsByType:function(e){return e?(t=e.dataValueType!==Terrasoft.DataValueType.LOOKUP?function(t){return t.dataValueType===e.dataValueType}:function(t){return t.dataValueType===e.dataValueType&&t.referenceSchemaUId===e.referenceSchemaUId},this.columns.filterByFn(t,this)):this.columns;var t},isNew:function(){var e=Terrasoft.EntitySchemaManager.findRootSchemaItemByName(this.name);return e&&e.isNew()},canDesignSchema:function(){return!this.isDBView},_getBaseUId:function(){var e=Terrasoft.EntitySchemaManager.items.findByFn((function(e){return!1===e.extendParent&&e.name===this.name}),this);return e&&e.uId||this.uId}}),Ext.define("Terrasoft.core.EntitySchemaResponse",{alternateClassName:"Terrasoft.EntitySchemaResponse",extend:"Terrasoft.BaseSchemaResponse",schemaClassName:"Terrasoft.EntitySchema"}),Ext.define("Terrasoft.data.queries.EntitySchemaRequest",{extend:"Terrasoft.BaseSchemaRequest",alternateClassName:"Terrasoft.EntitySchemaRequest",contractName:"EntitySchemaRequest",responseClassName:"Terrasoft.EntitySchemaResponse"}),Ext.define("Terrasoft.data.queries.AggregatedEntitySchemaRequest",{extend:"Terrasoft.BaseSchemaRequest",alternateClassName:"Terrasoft.AggregatedEntitySchemaRequest",contractName:"AggregatedEntitySchemaRequest",responseClassName:"Terrasoft.EntitySchemaResponse"}),Ext.define("Terrasoft.data.queries.AggregatedClientUnitSchemaRequest",{extend:"Terrasoft.BaseSchemaRequest",alternateClassName:"Terrasoft.AggregatedClientUnitSchemaRequest",contractName:"AggregatedClientUnitSchemaRequest",responseClassName:"Terrasoft.ClientUnitSchemaResponse"}),Ext.define("Terrasoft.data.queries.EntitySchemaRemoveRequest",{extend:"Terrasoft.EntitySchemaRequest",alternateClassName:"Terrasoft.EntitySchemaRemoveRequest",contractName:"RemoveEntitySchemaRequest"}),Ext.define("Terrasoft.manager.EntitySchemaManagerItem",{extend:"Terrasoft.manager.BaseSchemaManagerItem",alternateClassName:"Terrasoft.EntitySchemaManagerItem",instanceClassName:"Terrasoft.EntitySchema",requestClassName:"Terrasoft.EntitySchemaRequest",removeRequestClassName:"Terrasoft.EntitySchemaRemoveRequest",updateRequestClassName:"Terrasoft.EntitySchemaUpdateRequest",needUpdateStructure:null,isVirtual:null,onAfterSave:function(e){this.needUpdateStructure=this.status!==Terrasoft.ModificationStatus.NOT_MODIFIED,this.checkInstance(),this.instance.undef(),this.instance.define(),e&&e.success&&this._setNewColumnsUpdatedStatus(),this.callParent(arguments)},getNeedUpdateStructure:function(){return this.needUpdateStructure},getIsVirtual:function(){return!0===this.isVirtual},getHierarchyUIds:function(){var e=[],t=Terrasoft.EntitySchemaManager.findItem(this.parentUId);return t&&(e=e.concat(t.getHierarchyUIds())),e.push(this.uId),e},getHierarchyInfo:function(){var e=[],t=Terrasoft.EntitySchemaManager.findItem(this.parentUId);return t&&(e=e.concat(t.getHierarchyInfo())),e.push({id:this.id,uId:this.uId,name:this.name,packageUId:this.packageUId}),e},_setNewColumnsUpdatedStatus:function(){this.instance.columns.each((function(e){e.status===Terrasoft.ModificationStatus.NEW&&(e.status=Terrasoft.ModificationStatus.UPDATED)}))}}),Ext.define("Terrasoft.manager.EntitySchemaManager",{extend:"Terrasoft.manager.BaseSchemaManager",alternateClassName:"Terrasoft.EntitySchemaManager",singleton:!0,itemClassName:"Terrasoft.EntitySchemaManagerItem",managerName:"EntitySchemaManager",maxEntitySchemaNameLength:null,entitySchemaName:"VwSysEntitySchemaInWorkspace",outdatedEventName:"EntitySchema_Outdated",useNotification:!0,processSchemaSequence:function(e,t){var r=t.getPropertyValue("uId"),n=t.getPropertyValue("columns"),i=e.indexOf(r),a=["CreatedBy","ModifiedBy"];return n.each((function(t){var r=t.getPropertyValue("name");if(!Terrasoft.contains(a,r)){var n=t.getPropertyValue("dataValueType"),s=[Terrasoft.DataValueType.LOOKUP,Terrasoft.DataValueType.IMAGELOOKUP];if(Terrasoft.contains(s,n)){var o=t.getPropertyValue("referenceSchemaUId"),l=e.indexOf(o);if(l>i){var c=e[l];e.splice(l,1),e.unshift(c)}}}}),this),e},getSaveSequence:function(e,t,r){Terrasoft.chain((function(t){this.getInstances(e,t,this)}),(function(n,i){var a=[];Terrasoft.each(e,(function(e){a.push(e.getUId())}),this),Terrasoft.each(i,(function(e){a=this.processSchemaSequence(a,e)}),this);var s=[];Terrasoft.each(a,(function(t){s.push(Ext.Array.findBy(e,(function(e){return e.getUId()===t}),this))}),this),s=s.reverse(),t.call(r,s)}),this)},getDesignSchemaRequestParameters:function(){return{contractName:"DesignEntitySchemaRequest",responseClassName:"Terrasoft.EntitySchemaResponse"}},constructor:function(){this.callParent(arguments),Ext.apply(this.propertyColumnNames,{needUpdateStructure:"NeedUpdateStructure",isVirtual:"IsVirtual"}),this.maxEntitySchemaNameLength=Terrasoft.SysValue.MAX_ENTITY_SCHEMA_NAME_LENGTH},initItems:function(e){this.initServiceItems(e)},queryItems:function(e,t){return new Terrasoft.BaseRequest({contractName:"EntitySchemaManagerRequest"}).execute(e,t)},getMaxEntitySchemaNameLength:function(){return this._checkInitialized(),this.maxEntitySchemaNameLength},getMaxEntitySchemaNameWithPrefix:function(){return this.maxEntitySchemaNameLength-Terrasoft.DesignTimeEnums.EntitySchemaColumnSizes.ENTITY_SCHEMA_COLUMN_ID_SUFFIX_SIZE-this.schemaNamePrefix.length},_getNeedUpdateManagerItems:function(e){return this.items.filterByFn((function(t){var r=t.getNeedUpdateStructure();return e?r&&t.getPackageUId()===e:r}))},_getNeedUpdateStructureItems:function(e,t,r){var n=e&&e.packageUId,i=Ext.create("Terrasoft.EntitySchemaQuery",{rootSchemaName:this.entitySchemaName});i.addColumn("UId"),i.filters.addItem(Terrasoft.createColumnFilterWithParameter(Terrasoft.ComparisonType.EQUAL,this.sysWorkspaceColumnPath,Terrasoft.SysValue.CURRENT_WORKSPACE.value)),n&&i.filters.addItem(Terrasoft.createColumnFilterWithParameter(Terrasoft.ComparisonType.EQUAL,"PackageUId",e.packageUId)),i.filters.addItem(Terrasoft.createColumnFilterWithParameter(Terrasoft.ComparisonType.EQUAL,"NeedUpdateStructure",!0));var a=this._getNeedUpdateManagerItems(n);return i.getEntityCollection((function(e){var n=this;return e.collection.each((function(e){var t=e.get("UId"),r=n.items.find(t);r&&a.add(r)})),Ext.callback(t,r,[a])}),this)},_checkInitialized:function(){if(!this.isInitialized)throw new Terrasoft.InvalidObjectState},_getItemCaption:function(e){return e.getCaption()},_getItemName:function(e){return e.getName()},_findItemByValue:function(e,t){var r=arguments.length>2&&void 0!==arguments[2]&&arguments[2],n=Terrasoft.EntitySchemaManager.items.filterByFn((function(n){return(!r&&!n.getExtendParent()||r)&&t(n)===e}));return n.isEmpty()?null:n.getByIndex(0)},updateDBStructure:function(e,t,r){this._checkInitialized(),this._getNeedUpdateStructureItems(e,(function(e){if(e.isEmpty())return Ext.callback(t,r);this.getSaveSequence(e.getItems(),(function(n){var i=[];return Terrasoft.each(n,(function(e){return i.push(e.getUId())})),Terrasoft.SchemaDesignerUtilities.saveSchemaDBStructure(i,(function(n){return e.each((function(e){e.needUpdateStructure=!1})),Ext.callback(t,r,[n])}),this)}),this)}),this)},findItemByCaption:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return this._findItemByValue(e,this._getItemCaption,t)},findItemByName:function(e){return this._findItemByValue(e,this._getItemName)},getCurrentPackageSchemaByUId:function(e,t,r){Terrasoft.PackageManager.getCurrentPackageUId((function(n){this.getPackageSchemaInstanceBySchemaUId(e,n,t,r)}),this)},findRootSchemaItemByCaption:function(e){var t=this.findItemByCaption(e,!0);return t?this.findRootSchemaItemByName(t.name):null}}),Ext.define("Terrasoft.data.queries.ClientUnitSchemaRequest",{extend:"Terrasoft.BaseSchemaRequest",alternateClassName:"Terrasoft.ClientUnitSchemaRequest",contractName:"ClientUnitSchemaRequest",responseClassName:"Terrasoft.ClientUnitSchemaResponse"}),Ext.define("Terrasoft.data.queries.ClientUnitSchemaRemoveRequest",{extend:"Terrasoft.ClientUnitSchemaRequest",alternateClassName:"Terrasoft.ClientUnitSchemaRemoveRequest",contractName:"RemoveClientUnitSchemaRequest"}),Ext.define("Terrasoft.data.queries.ClientUnitBundleSchemaRequest",{extend:"Terrasoft.BaseSchemaRequest",alternateClassName:"Terrasoft.ClientUnitBundleSchemaRequest",contractName:"ClientUnitBundleSchemaRequest",responseClassName:"Terrasoft.ClientUnitSchemaResponse"}),Ext.define("Terrasoft.data.queries.BaseSchemaUpdateRequest",{extend:"Terrasoft.BaseSchemaRequest",alternateClassName:"Terrasoft.BaseSchemaUpdateRequest",responseClassName:"Terrasoft.BaseSchemaResponse",schema:null,getData:function(){return Ext.apply(this.schema,{requestTimeout:this.requestTimeout})},execute:function(e,t){this.validate();var r={serverMethod:this.contractName,responseClassName:this.responseClassName,data:this.getData()};this.serviceProvider.execute(r,e,t)}}),Ext.define("Terrasoft.data.queries.ProcessSchemaUpdateRequest",{extend:"Terrasoft.BaseSchemaUpdateRequest",alternateClassName:"Terrasoft.ProcessSchemaUpdateRequest",contractName:"ContractProcessSchema",getData:function(){var e=this.schema,t={};return e.getLocalizableValues(t),{metaData:e.serialize(),resources:t,uId:e.uId,name:e.name,packageUId:e.packageUId,requestTimeout:this.requestTimeout,changedItems:e.changedItems,loadedLazyProperties:e.getLoadedLazyProperties(),lazyProperties:e.getLazyProperties()}}}),Ext.define("Terrasoft.data.queries.EntitySchemaUpdateRequest",{extend:"Terrasoft.BaseSchemaUpdateRequest",alternateClassName:"Terrasoft.EntitySchemaUpdateRequest",contractName:"EntitySchema"}),Ext.define("Terrasoft.data.queries.ClientUnitSchemaUpdateRequest",{extend:"Terrasoft.BaseSchemaUpdateRequest",alternateClassName:"Terrasoft.ClientUnitSchemaUpdateRequest",contractName:"ClientUnitSchema",getData:function(){var e=this.callParent(arguments);return e.resources={},e.getParametersLocalizableValues(e.resources),e}}),Ext.define("Terrasoft.manager.SchemaUsing",{extend:"Terrasoft.BaseObject",alternateClassName:"Terrasoft.SchemaUsing",mixins:{serializable:"Terrasoft.Serializable"},typeName:"Terrasoft.Core.SchemaUsing",uId:null,name:null,createdInSchemaUId:null,createdInPackageId:null,modifiedInSchemaUId:null,alias:null,serializableProperties:["uId","name","alias","createdInSchemaUId","modifiedInSchemaUId","createdInPackageId","typeName"],getSerializableObject:function(e){this.serializableProperties.forEach((function(t){this.setSerializableProperty(e,t)}),this)},setValue:function(e){var t=e.alias;t=Ext.isEmpty(t)?null:t,this.name===e.name&&this.alias===t||(this.name=e.name,this.alias=e.alias,this.modifiedInSchemaUId=e.modifiedInSchemaUId,this.fireEvent("changed",e,this))}}),Ext.define("Terrasoft.data.queries.ProcessSchemaRequest",{extend:"Terrasoft.BaseSchemaRequest",alternateClassName:"Terrasoft.ProcessSchemaRequest",contractName:"ProcessSchemaRequest",responseClassName:"Terrasoft.ProcessSchemaResponse",convertLocalizableStringToParameter:!0,getSerializableObject:function(e){this.callParent(arguments),e.convertLocalizableStringToParameter=this.convertLocalizableStringToParameter}}),Ext.define("Terrasoft.manager.BaseProcessSchemaManager",{extend:"Terrasoft.manager.BaseSchemaManager",alternateClassName:"Terrasoft.BaseProcessSchemaManager",managerName:"BaseProcessSchemaManager",setNewSchemaVersionName:function(e,t,r){r=r.replace(/\W/g,""),e.name=t.parentSchemaName+r+e.version,this.schemaNamePrefix&&this.schemaNamePrefix.length>0&&!Ext.String.startsWith(t.parentSchemaName,this.schemaNamePrefix)&&(e.name=this.schemaNamePrefix+e.name)},_getActualVersionUId:function(e,t,r){var n=e,i=this.items.find(e);if(!Ext.isEmpty(i)&&i.status===Terrasoft.ModificationStatus.NEW){var a=i.getParentUId();if(!this.getIsSetParentSchemaUId(a))return void Ext.callback(t,r,[{actualVersionSchemaUId:e}]);n=a}Ext.create("Terrasoft.BaseSchemaManagerRequest",{serviceName:this.schemaManagerServiceName,methodName:"GetActualVersionUId",urlParameters:{schemaUId:n}}).execute(t,r)},getIsSetParentSchemaUId:function(e){return e&&!Terrasoft.isEmptyGUID(e)&&e!==this.defSchemaUId},createNewSchemaVersion:function(e){var t=e.sourceSchema,r=this.copySchema(t),n=r.instance,i=t.parentSchemaUId;return n.parentSchemaUId=this.getIsSetParentSchemaUId(i)?i:t.uId,n.setPropertyValue("isActiveVersion",!1),n.setPropertyValue("isDelivered",!1),r.parentUId=n.parentSchemaUId,r},getSchemaVersionInfo:function(e,t,r){Ext.create("Terrasoft.BaseSchemaManagerRequest",{serviceName:this.schemaManagerServiceName,methodName:"GetSchemaVersionInfo",urlParameters:e}).execute(t,r)},_getPackageForNewSchemaVersion:function(e,t,r){Terrasoft.Features.getIsDisabled("SaveProcessVersionInApplicationPackage")?Terrasoft.PackageManager.getCurrentPackageUId(t,r):Terrasoft.PackageManager.getDesignPackageUId(e,t,r)},getNewSchemaVersion:function(e,t,r){if(!this.getCanUseProcessVersions())throw new Terrasoft.InvalidOperationException;var n=this.createNewSchemaVersion(e),i=n.instance,a=Terrasoft.PackageManager.CUSTOM_PACKAGE_NAME,s=e.sysPackage;Terrasoft.chain((function(t){if(s&&e.canEditPackageSchema)i.packageUId=s.get("UId"),a=s.get("Name"),t();else{var r=e.sourceSchema.uId;this._getPackageForNewSchemaVersion(r,(function(e){i.packageUId=e,t()}),this)}}),this.initializeSchemaNamePrefix.bind(this),(function(){var e={parentSchemaUId:i.parentSchemaUId,packageUId:i.packageUId};this.getSchemaVersionInfo(e,(function(e,s){s?t.call(r,n,s):(i.version=e.maxVersionInPackage+1,this.setNewSchemaVersionName(i,e,a),t.call(r,n))}),this)}),this)},setIsActualVersionByUId:function(e,t,r){this.log(Ext.String.format(Terrasoft.Resources.ObsoleteMessages.ObsoleteMethodMessage,"Terrasoft.BaseProcessSchemaManager.setIsActualVersionByUId","Terrasoft.BaseProcessSchemaManager.setIsActualVersion"));var n={doNotValidate:!0,schemaUId:e};this.setIsActualVersion(n,t,r)},setIsActualVersion:function(e,t,r){if(this.getCanUseProcessVersions()){var n=Ext.create("Terrasoft.BaseSchemaManagerRequest",{serviceName:this.schemaManagerServiceName,methodName:"SetIsActualVersion",urlParameters:{schemaUId:e.schemaUId}});this.validateActualVersion(e,(function(e,i){Boolean(e)?n.execute((function(e,n){e.success&&this.notify(this.outdatedEventName),t.call(r,e,n)}),this):t.call(r,null,i)}),this)}else Ext.callback(t,r,[{success:!0}])},validateActualVersion:function(e,t,r){t.call(r,!0)},getActualVersionUId:function(e,t,r){Terrasoft.isEmpty(e)?Ext.callback(t,r,[null]):this.getCanUseProcessVersions()?this._getActualVersionUId(e,t,r):Ext.callback(t,r,[{actualVersionSchemaUId:e}])},getIsActualVersion:function(e,t,r){if(!e||!e.uId)throw new Terrasoft.ArgumentNullOrEmptyException({argumentName:e?"schema.uId":"schema"});this.getActualVersionUId(e.uId,(function(n){var i=e.uId===n.actualVersionSchemaUId;Ext.callback(t,r,[i])}),this)},getCanUseProcessVersions:function(){return!1},createSchema:function(){var e=this.callParent(arguments);return e.useSystemSecurityContext=Terrasoft.Features.getIsEnabled("DisableAdminRightsInScriptTask"),e}}),Ext.define("Terrasoft.data.queries.ProcessSchemaRemoveRequest",{extend:"Terrasoft.ProcessSchemaRequest",alternateClassName:"Terrasoft.ProcessSchemaRemoveRequest",contractName:"RemoveProcessSchemaRequest"}),Ext.define("Terrasoft.manager.ProcessSchemaLazyPropertiesHelper",{extend:"Terrasoft.BaseObject",alternateClassName:"Terrasoft.ProcessSchemaLazyPropertiesHelper",singleton:!0,contractName:"GetLazyPropertiesRequest",requestTimeout:6e7,dataProvider:Terrasoft.SchemaManagerDataProvider,getLazyParameterValues:function(e,t,r){var n={userTaskUId:e.userTaskUId,schemaUId:e.processSchemaUId};this.execute(n,(function(e){var n=e.lazyProperties,i={};Terrasoft.each(n,(function(e,t){var r=Terrasoft.decode(e);r.referenceSchemaUId&&Terrasoft.isEmptyGUID(r.referenceSchemaUId)&&(r.referenceSchemaUId=null),i[t]=r})),t.call(r,i,e)}),r)},execute:function(e,t,r){var n=Ext.apply({},e,{contractName:this.contractName,requestTimeout:this.requestTimeout,responseClassName:"Terrasoft.BaseResponse"});this.dataProvider.execute(n,t,r)}}),Ext.define("Terrasoft.data.queries.ProcessUserTaskSchemaRequest",{extend:"Terrasoft.BaseSchemaRequest",alternateClassName:"Terrasoft.ProcessUserTaskSchemaRequest",contractName:"ProcessUserTaskSchemaRequest",responseClassName:"Terrasoft.ProcessUserTaskSchemaResponse",itemsData:null,getSerializableObject:function(e){this.callParent(arguments),e.itemsData=this.itemsData}}),Ext.define("Terrasoft.data.queries.ProcessUserTaskSchemaResetRequest",{extend:"Terrasoft.ProcessUserTaskSchemaRequest",alternateClassName:"Terrasoft.ProcessUserTaskSchemaResetRequest",contractName:"ProcessUserTaskSchemaResetRequest",responseClassName:"Terrasoft.BaseSchemaResponse"}),Ext.define("Terrasoft.data.queries.ProcessUserTaskSchemaResetAllRequest",{extend:"Terrasoft.BaseRequest",alternateClassName:"Terrasoft.ProcessUserTaskSchemaResetAllRequest",contractName:"ProcessUserTaskSchemaResetAllRequest",responseClassName:"Terrasoft.BaseSchemaResponse"}),Ext.define("Terrasoft.configuration.BaseProcessSchemaItem",{extend:"Terrasoft.manager.BaseSchema",alternateClassName:"Terrasoft.BaseProcessSchemaItem",typeName:null,parentSchema:null,validationResults:null,isValid:!0,isValidateExecuted:!0,constructor:function(){this.validationResults=[],this.callParent(arguments)},getSerializableProperties:function(){var e=this.callParent(arguments);return Ext.Array.push(e,["typeName","isValid"])},checkParentSchema:function(){if(!this.parentSchema)throw new Terrasoft.NullOrEmptyException},internalValidate:function(){return[]}}),Ext.define("Terrasoft.configuration.BaseProcessSchemaElement",{extend:"Terrasoft.configuration.BaseProcessSchemaItem",alternateClassName:"Terrasoft.BaseProcessSchemaElement",containerUId:null,editPageSchemaName:Terrasoft.process.constants.DEFAULT_EDIT_PAGE_SCHEMA_NAME,getSerializableProperties:function(){var e=this.callParent(arguments);return Ext.Array.push(e,["containerUId"])},loadLocalizableValues:function(e){e&&(this.caption=Ext.create("Terrasoft.LocalizableString",{cultureValues:e.Caption}))},loadLocalizableValuesByUIds:function(e){if(e){var t=this.uId;this.caption=Ext.create("Terrasoft.LocalizableString",{cultureValues:e[t+".caption"]})}},getLocalizableValues:function(e){e[this.uId+".caption"]=this.getSerializableProperty(this.caption)},getEditPageSchemaName:function(e,t){e.call(t,this.editPageSchemaName)}}),Ext.define("Terrasoft.manager.ProcessBaseElementSchema",{extend:"Terrasoft.configuration.BaseProcessSchemaElement",alternateClassName:"Terrasoft.ProcessBaseElementSchema",realName:null,dragGroupName:null,containerItemIndex:0,managerItemUId:null,createdInOwnerSchemaUId:null,ownerSchemaManagerName:null,silverlightOffsetX:0,silverlightOffsetY:0,nodeType:null,group:null,name:null,fontSize:13,executionCountFontSize:13,executionCountFillColor:"#6dc9f4",executedMICompletedFillColor:"#8ECB60",executedMIFailedFillColor:"#DF1F26",executionCountFontColor:"#fff",executionCountLabelTag:Terrasoft.diagram.labelBackgroundTag.ELLIPSE,executionCountLabelPadding:2.5,fontFamily:"'Bpmonline Open Sans', serif",fontColor:"#444444",captionBackcolor:"rgba(255, 255, 255, 0)",captionFillColor:"rgba(255,255,255,0)",captionWidth:120,maxLengthCaption:51,position:"0;0",offsetX:0,offsetY:0,emptyDiagramCaption:!1,typeCaption:null,resourceManagerName:"Terrasoft.Nui",smallImageName:"",largeImageName:"",titleImageName:"",color:"#839DC3",toolsConstraint:0,showPropertiesWindowOnAdding:!1,preventShowPropertiesWindowOnAdding:!1,executedCount:0,completedCount:0,completedCountTooltipText:null,failedCount:0,failedCountTooltipText:null,usageType:null,defaultCaption:null,notValidCaptionPrefix:"⚑",notValidCaptionFontColor:"#F15440",validationInfoCaption:null,useBackgroundMode:!1,isDeprecated:!1,supportEmbeddedProcess:!1,constructor:function(){this.defaultCaption=this.caption,this.callParent(arguments),this.position&&(this.position=this.parsePoint(this.position)),this.typeCaption=this.getTypeCaption(),this.emptyDiagramCaption&&this.caption.setValue("")},getTypeCaption:function(){var e=this.caption||"";return"function"==typeof e.getValue&&(e=e.getValue()),e},getImageConfig:function(e){return{source:Terrasoft.ImageSources.RESOURCE_MANAGER,params:{resourceManagerName:this.resourceManagerName,resourceItemName:"ProcessSchemaDesigner."+e}}},getSmallImage:function(){return this.getImageConfig(this.smallImageName)},getLargeImage:function(){return this.getImageConfig(this.largeImageName)},getTitleImage:function(){return this.getImageConfig(this.titleImageName)},getDiagramConfig:function(e){var t=this.caption||"";"function"==typeof t.getValue&&(t=t.getValue());var r={name:this.name,caption:t||"",nodeType:this.nodeType,tag:this.uId,offsetX:this.position?this.position.X+this.width/2:0,offsetY:this.position?this.position.Y+this.height/2:0};return this.executedCount>0&&(r.labels=[{name:this.name+"_execCount_label",text:this.executedCount.toString(),textAlign:ej.Diagram.TextAlign.Center,verticalAlignment:ej.Diagram.VerticalAlignment.Center,fillColor:this.executionCountFillColor,fontColor:this.executionCountFontColor,fontSize:this.executionCountFontSize,fontFamily:this.fontFamily,tag:this.executionCountLabelTag,offset:ej.Diagram.Point(0,0),padding:this.executionCountLabelPadding,labelType:Terrasoft.LabelType.STATISTIC_INFO}]),r=Ext.apply(r,e)},getLabelConfig:function(){return this.caption&&this.caption.getCultureValue()?{id:this.uId+"_label",type:"label",parent:this.uId}:null},getExecutedCountLabels:function(){return this.executedCount<=0?null:{id:this.uId+"_execCount_label",parent:this.uId,type:"label",rx:0,ry:0,caption:this.executedCount.toString(),horizontalAlignment:"center",verticalAlignment:"center",backgroundStyle:{type:this.executionCountLabelTag,fill:this.executionCountFillColor,padding:4.5,filter:{name:"StatisticInfoShadow_filter",color:"#000",opacity:.4,offsetX:1,offsetY:2,blur:2}},style:{fill:this.executionCountFontColor}}},getSerializableObject:function(e){this.callParent(arguments),e.name=this.getSerializableProperty(this.getName()),e.position=this.getSerializablePosition()},getSerializableProperties:function(){var e=this.callParent(arguments);return Ext.Array.push(e,["containerItemIndex","dragGroupName","managerItemUId","createdInOwnerSchemaUId"])},getSerializablePosition:function(){var e=this.position,t="0;0";return e&&(t=Terrasoft.serializeObject({source:e,properties:["X","Y"],format:"{X};{Y}",valueConverter:function(e){return parseInt(e,10)||0}})),this.getSerializableProperty(t)},parsePoint:function(e){var t=this.parseValuePairString(e);return{X:t[0],Y:t[1]}},parseValuePairString:function(e){var t=/\s*(-?\d+)\s*;\s*(-?\d+)\s*/.exec(e);return[parseInt(t[1],10),parseInt(t[2],10)]},getUIJsonData:function(){var e={};return this.getSerializableObject(e),this.setSerializableProperty(e,"caption"),{Id:e.uId,Name:e.name,Caption:e.caption,Position:e.position,ContainerUId:e.containerUId}},subscribeOnChangedEvent:function(e,t){this.on("changed",e,t)},unsubscribeOnChangedEvent:function(e,t){this.un("changed",e,t)},requireCompilation:function(){return!1},getLabelText:function(e,t){var r=e&&e.toString()||"";return t?r:this.notValidCaptionPrefix+" "+r},getLabelFontColor:function(e){return e?this.fontColor:this.notValidCaptionFontColor},getPackageUId:function(){return this.parentSchema.getPackageUId()},setName:function(e){this.name!==e&&this.setPropertyValue("realName",e)},getName:function(){return this.realName||this.name},getMarkersConfig:function(){return{}}}),Ext.ns("Terrasoft.Core.Process"),Ext.define("Terrasoft.manager.ProcessSchemaParameter",{extend:"Terrasoft.manager.ProcessBaseElementSchema",alternateClassName:"Terrasoft.ProcessSchemaParameter",typeName:"Terrasoft.Core.Process.ProcessSchemaParameter",sourcePath:null,sourceMetaPath:null,targetMetaPath:null,targetPath:null,group:null,skipValidation:!1,forceRemove:!1,_parent:null,name:"ProcessSchemaParameter",dataValueType:Terrasoft.data.constants.GUID_EMPTY,direction:Terrasoft.process.enums.ProcessSchemaParameterDirection.VARIABLE,isCopyValue:!1,isPerformer:!1,isRequired:!1,isResult:!1,isLazy:!1,isLoaded:!1,isValueSerializable:!0,modifiedInSchemaUId:null,referenceSchemaName:"",referenceSchemaUId:null,sourceValue:null,processFlowElementSchema:null,tag:null,itemProperties:null,sourceParameterUId:null,constructor:function(e){this.callParent(arguments),this.uId=this.uId||Terrasoft.generateGUID(),this.sourceValue=this.sourceValue||{},this._initItemProperties(e&&e.itemProperties),this._initClientDataValueType(),this.addEvents("changed"),delete this.description,delete this.extendParent,delete this.packageUId},_onItemPropertiesAdd:function(e){e._parent=this},_onItemPropertiesRemove:function(e){e._parent=null},_onItemPropertiesClear:function(e,t){t.each((function(e){e._parent=null}))},_initItemProperties:function(e){this.itemProperties=new Terrasoft.Collection,this.itemProperties.on("add",this._onItemPropertiesAdd,this),this.itemProperties.on("remove",this._onItemPropertiesRemove,this),this.itemProperties.on("clear",this._onItemPropertiesClear,this),Terrasoft.each(e,(function(e){var t=Terrasoft.isInstanceOfClass(e,"Terrasoft.ProcessSchemaParameter")?e:Ext.create("Terrasoft.ProcessSchemaParameter",e);this.itemProperties.add(e.uId,t)}),this)},_requiredValidator:function(){if(this.processFlowElementSchema instanceof Terrasoft.ProcessWebServiceSchema&&this.isRequired&&!this.sourceValue.value&&!Ext.isBoolean(this.sourceValue.value))return{validationType:Terrasoft.ValidationType.ERROR,message:Terrasoft.Resources.BaseViewModel.columnRequiredValidationMessage}},_mappingValidator:function(){if(!this.getMappingValue().isValid)return{validationType:Terrasoft.ValidationType.ERROR,message:'Invalid "'+this.getDisplayValue()+'" parameter value.'}},_getInvalidMessage:function(){return'Invalid "'+this.getDisplayValue()+'" parameter value.'},_constValidator:function(){var e=this.getMappingValue();e.source!==Terrasoft.ProcessSchemaParameterValueSource.ConstValue||Terrasoft.isJsonObject(e.value,!1)||this.getMetaPathValidationRegexps().forEach((function(t){if(t.exec(e.value))return{validationType:Terrasoft.ValidationType.ERROR,message:this._getInvalidMessage()}}),this)},_initClientDataValueType:function(){var e=this.dataValueType;Terrasoft.isGUID(e)&&!Terrasoft.isEmptyGUID(e)&&(this.dataValueType=Terrasoft.convertToClientDataValueType(e))},_cloneItemProperties:function(){var e=new Terrasoft.Collection;return this.itemProperties.each((function(t){e.add(t.clone())})),e},getLocalizableString:function(e){var t=e;return e instanceof Terrasoft.LocalizableString||(t=Ext.create("Terrasoft.LocalizableString")).setValue(e),t},getIsComplexLocalizableValueType:function(){var e=this.dataValueType;return e===Terrasoft.DataValueType.LOCALIZABLE_PARAMETER_VALUES_LIST||e===Terrasoft.DataValueType.ENTITY_COLUMN_MAPPING_COLLECTION},getLocalizableParameterValues:function(){var e=this.getValue();return(e=Terrasoft.utils.common.json.decode(e)).$values},restoreComplexLocalizableValue:function(e){if(this.sourceValue.hasOwnProperty("value")&&e.Value){var t=this.getLocalizableParameterValues();t.forEach((function(t){var r=e.Value[t.ItemUId];for(var n in t)if(t.hasOwnProperty(n)||"ItemUId"===n){var i=t[n];if(i.isLczValue)if(r){var a=Ext.create("Terrasoft.LocalizableString",{cultureValues:r[n]});i.value=a.getValue()}else{var s=Ext.String.format(Terrasoft.Resources.ProcessSchemaDesigner.Exceptions.LocalizableCollectionPropertyNotFoundMessage,n);this.error(s)}}}),this),this.setLocalizableParameterValues(t)}},getIsSourceValueEquals:function(e,t){var r=e.value||"",n=this.convertDataValueByType(t)||"",i=e.displayValue||"",a=t.displayValue||"",s=e.source||null,o=t.source||null,l=e.referenceSchemaUId||this.referenceSchemaUId,c=t.referenceSchemaUId||this.referenceSchemaUId;return r=this._getStringValue(r),n=this._getStringValue(n),i=this._getStringValue(i),a=this._getStringValue(a),r===n&&i===a&&s===o&&l===c},clearSourceValue:function(){var e=this.sourceValue;e&&(e.value=this.getIsValueLocalizable()?"":null,e.displayValue=Ext.create("Terrasoft.LocalizableString"),e.source=Terrasoft.ProcessSchemaParameterValueSource.None),this.itemProperties.each((function(e){e.clearSourceValue()}),this)},convertToServerDataValueType:function(e){return Terrasoft.isGUID(e)?e:Terrasoft.convertToServerDataValueType(e)},getIsValueLocalizable:function(){var e=this.sourceValue,t=Terrasoft.process.enums.ProcessSchemaParameterValueSource;if(e&&(e.source===t.Script||e.source===t.Mapping))return!1;var r=this.dataValueType;return Terrasoft.isTextDataValueType(r)},getParameterMappingRegexp:function(){var e=Terrasoft.getFormattedString("(\\[#{0}\\.{1}\\.{2}\\.*{3}#\\])","\\[IsOwnerSchema:(true|false)\\]","\\[IsSchema:(true|false)\\]","(?:\\[Element:\\{.*?\\}\\])*","(\\[Parameter:\\{.*?\\}\\])");return new RegExp(e,"g")},getLookupMappingRegexp:function(){return/(\[#Lookup\.)/g},getSysSettingMappingRegexp:function(){return/(\[#SysSettings\.)/g},getSysVariableMappingRegexp:function(){return/(\[#SysVariable\.)/g},getDateTimeMappingRegexp:function(){return/(\[#(DateValue|TimeValue|DateTimeValue)\.)/g},getMetaPathValidationRegexps:function(){return[this.getParameterMappingRegexp(),this.getLookupMappingRegexp(),this.getSysSettingMappingRegexp(),this.getSysVariableMappingRegexp(),this.getDateTimeMappingRegexp()]},_getStringValue:function(e){return e instanceof Terrasoft.LocalizableString?e.getValue()||"":e},_processSetterOptions:function(e){e&&e.clearParentValue&&this.tryClearParentValue()},_getEmptyValue:function(){return{value:null,displayValue:null,source:Terrasoft.ProcessSchemaParameterValueSource.None}},_findMappingParameter:function(e){var t=this.getParentSchema();return Terrasoft.FormulaParserUtils.findMappingParameter(e,t)},_clearReferenceSchemaName:function(){this.referenceSchemaUId&&delete this.referenceSchemaName},getSerializableObject:function(e){this.callParent(arguments);var t=this.dataValueType;Terrasoft.isEmptyGUID(t)||(t=this.convertToServerDataValueType(t),e.dataValueType=this.getSerializableProperty(t),this.itemProperties&&!this.itemProperties.isEmpty()&&(e.itemProperties=[],this.itemProperties.each((function(t){var r={};t.getSerializableObject(r),e.itemProperties.push(r)}),this)))},getSerializableProperties:function(){var e=this.callParent(arguments),t=["caption","description","extendParent","packageUId","skipValidation","forceRemove"];return t.forEach((function(t){Ext.Array.remove(e,t)})),Ext.Array.push(e,["sourceValue","sourceMetaPath","sourcePath","targetMetaPath","targetPath","isRequired","referenceSchemaUId","referenceSchemaName","isValueSerializable","direction","isResult","isPerformer","isCopyValue","isLazy","tag","sourceParameterUId"])},getParentSchema:function(){var e=this.processFlowElementSchema&&(this.processFlowElementSchema.parentSchema||this.processFlowElementSchema);if(e)return e;for(var t=this._parent;Terrasoft.instanceOfClass(t,"Terrasoft.ProcessSchemaParameter")&&t.getParent();)t=t.getParent();return t.processFlowElementSchema.parentSchema||t.processFlowElementSchema},tryClearParentValue:function(){var e=this._parent&&this._parent.hasValue()&&!this._parent.hasCollectionInNestedParameterValues();return e&&this._parent.setMappingValue(this._getEmptyValue(),{clearParentValue:!0}),e},getFullCaption:function(){var e=this.caption.getValue()||this.name;return this._parent?this._parent.getFullCaption()+":"+e:e},getParent:function(){return this._parent},hasParent:function(){return!Ext.isEmpty(this._parent)},getHierarchicalParentsUIds:function(){var e=[],t=this._parent;return t&&(e.push(t.uId),e=_.union(e,t.getHierarchicalParentsUIds())),e},hasValue:function(){return this.getMappingValue().source!==Terrasoft.ProcessSchemaParameterValueSource.None},getValue:function(){var e=this.sourceValue,t=e.value;return t instanceof Terrasoft.LocalizableString&&(t=t.getValue()),t&&this.getIsConstBooleanParameter(e)&&(t="true"===t.toLowerCase()),!t&&this.getIsConstNumberParameter(e)&&(t="0"),t},getParameterDisplayValue:function(){var e=this.sourceValue.displayValue;return e?e.getValue():null},getMappingValue:function(){var e=this.getValue();return{value:e||null,displayValue:this.getParameterDisplayValue()||e||null,source:this.getValueSource(),referenceSchemaUId:this.referenceSchemaUId,dataValueType:this.dataValueType,isValid:this.isValid}},getValueSource:function(){return this.sourceValue.source||Terrasoft.ProcessSchemaParameterValueSource.None},setMappingValue:function(e,t){var r=this.sourceValue;if(!this.getIsSourceValueEquals(r,e)){r.value=this.convertDataValueByType(e),r.source=e.source,r.displayValue||(r.displayValue=Ext.create("Terrasoft.LocalizableString"));var n=e.displayValue&&e.displayValue.toString();r.displayValue.setValue(n),r.referenceSchemaUId=e.referenceSchemaUId,this.referenceSchemaUId=e.referenceSchemaUId,this._clearReferenceSchemaName(),this.updateSchemaMapping(),this.fireEvent("changed",{},this),this._processSetterOptions(t)}},setValue:function(e){var t=this.sourceValue;this.getIsSourceValueEquals(t,e)||(Ext.apply(t,e),t.value&&(t.value=this.convertDataValueByType(t)),this.updateSchemaMapping(),this.fireEvent("changed",{},this))},updateSchemaMapping:function(){var e=this.getParentSchema();e.changeMapping(this),this.sourceValue.modifiedInSchemaUId=e.uId,this.setPropertyValue("isValid",!0)},setLocalizableParameterValues:function(e){e=e||[];var t=Terrasoft.utils.common.json.encode({$type:"Terrasoft.Core.Process.LocalizableParameterValuesList, Terrasoft.Core",$values:e}),r=Terrasoft.process.enums.ProcessSchemaParameterValueSource;this.setValue({value:t,source:e.length>0?r.ConstValue:r.None})},clone:function(){return new this.self({name:this.name,caption:this.caption.clone(),dataValueType:this.dataValueType,createdInSchemaUId:this.createdInSchemaUId,modifiedInSchemaUId:this.modifiedInSchemaUId,createdInPackageId:this.createdInPackageId,managerItemUId:this.managerItemUId,createdInOwnerSchemaUId:this.createdInOwnerSchemaUId,ownerSchemaManagerName:this.ownerSchemaManagerName,sourceValue:this.cloneSourceValue(),sourceMetaPath:this.sourceMetaPath,sourcePath:this.sourcePath,targetMetaPath:this.targetMetaPath,targetPath:this.targetPath,isRequired:this.isRequired,referenceSchemaUId:this.referenceSchemaUId,referenceSchemaName:this.referenceSchemaName,isValueSerializable:this.isValueSerializable,direction:this.direction,isResult:this.isResult,isPerformer:this.isPerformer,isCopyValue:this.isCopyValue,containerUId:this.containerUId,dragGroupName:this.dragGroupName,processFlowElementSchema:this.processFlowElementSchema,skipValidation:this.skipValidation,forceRemove:this.forceRemove,isLazy:this.isLazy,isValid:this.isValid,tag:this.tag,itemProperties:this._cloneItemProperties(),sourceParameterUId:this.sourceParameterUId})},cloneSourceValue:function(){var e=this.sourceValue,t=Terrasoft.deepClone(e);return e.displayValue&&(t.displayValue=e.displayValue.clone()),e.value instanceof Terrasoft.LocalizableString&&(t.value=e.value.clone()),t},convertDataValueByType:function(e){var t=e.value;return this.getIsConstBooleanParameter(e)?t?t.toString():"false":this.getIsConstNumberParameter(e)?t||"0":t},getIsConstBooleanParameter:function(e){return this.dataValueType===Terrasoft.DataValueType.BOOLEAN&&(e.source===Terrasoft.ProcessSchemaParameterValueSource.ConstValue||!e.source)},getIsConstNumberParameter:function(e){var t=this.dataValueType;return Terrasoft.isNumberDataValueType(t)&&e.source===Terrasoft.ProcessSchemaParameterValueSource.ConstValue},setName:function(e){this.setPropertyValue("name",e)},getName:function(){return this.name},getIsDynamic:function(){var e=this.getParentSchema();return!e.isUserTask&&this.createdInSchemaUId===e.uId},loadLocalizableValues:function(e){if(this.callParent(arguments),e){this.getIsComplexLocalizableValueType()&&this.restoreComplexLocalizableValue(e);var t=this.sourceValue;t&&(t.displayValue=Ext.create("Terrasoft.LocalizableString",{cultureValues:e.DisplayValue}),this.getIsValueLocalizable()&&(t.value=Ext.create("Terrasoft.LocalizableString",{cultureValues:e.Value}))),this.itemProperties.each((function(t){t.loadLocalizableValues(e[t.name])}))}},loadLocalizableValuesByUIds:function(e){if(e){var t=this.uId;this.caption=Ext.create("Terrasoft.LocalizableString",{cultureValues:e[t+".caption"]});var r=this.sourceValue;r&&(r.displayValue=Ext.create("Terrasoft.LocalizableString",{cultureValues:e[t+".displayValue"]}),this.getIsValueLocalizable()&&(r.value=Ext.create("Terrasoft.LocalizableString",{cultureValues:e[t+".value"]})))}},getLocalizableValues:function(e){this.callParent(arguments);var t=this.uId,r=this.sourceValue;if(r){var n=this.isLazy?{}:this.getLocalizableString(r.displayValue);if(e[t+".displayValue"]=this.getSerializableProperty(n),this.getIsValueLocalizable()){var i=this.getLocalizableString(r.value);e[t+".value"]=this.getSerializableProperty(i)}}},hasCollectionInNestedParameterValues:function(e){e=e||[];var t=!1;return this.hasNestedParameters()&&this.itemProperties.each((function(r){Ext.Array.contains(e,r.uId)||(t=t||r.hasCollectionValue())})),t},hasCollectionValue:function(){var e=!1;if(this.hasValue()){var t=Terrasoft.FormulaParserUtils.getParameterMappingInfo(this.sourceValue.value),r=this._findMappingParameter(t);e=!!r&&r.hasParent()}return e},validate:function(){var e;if(!this.skipValidation){var t=[this._requiredValidator,this._mappingValidator,this._constValidator];_.find(t,(function(t){return e=t.call(this)}),this)}return e?[e]:[]},hasNestedParameters:function(){return this.itemProperties&&!this.itemProperties.isEmpty()},getNestingLevel:function(){return this._parent?this._parent.getNestingLevel()+1:0},onDestroy:function(){this.itemProperties.un("add",this._parametersAddHandler,this),this.callParent(arguments)}}),Object.defineProperty(Terrasoft.ProcessSchemaParameter.prototype,"isInherited",{get:function(){var e=this.getParentSchema();return e&&e.uId!==this.createdInSchemaUId},enumerable:!0}),Terrasoft.Core.Process.ProcessSchemaParameter=Terrasoft.ProcessSchemaParameter,Ext.define("Terrasoft.manager.ClientUnitSchemaParameter",{extend:"Terrasoft.manager.ProcessSchemaParameter",alternateClassName:"Terrasoft.ClientUnitSchemaParameter",typeName:"Terrasoft.Core.ClientUnitSchemaParameter",status:Terrasoft.ModificationStatus.NOT_MODIFIED,designToolClassName:"Terrasoft.SchemaParameterDesignToolItem",constructor:function(){this.callParent(arguments),Terrasoft.isEmptyObject(this.sourceValue)&&(this.sourceValue={value:"",displayValue:"",source:Terrasoft.ProcessSchemaParameterValueSource.None})},_convertNestedParametersToProcessParameters:function(e){e.forEach((function(e){var t;delete e.typeName,(null==e||null===(t=e.itemProperties)||void 0===t?void 0:t.length)>0&&this._convertNestedParametersToProcessParameters(e.itemProperties)}),this)},_getNestedParameter:function(e,t){if(!(t instanceof Terrasoft.Collection))return null;var r=t.findByPath("uId",e);return r||Terrasoft.each(t.getItems(),(function(t){r||(r=this._getNestedParameter(e,t.itemProperties))}),this),r},_loadNestedParametersLocalizableValues:function(e,t,r){t instanceof Terrasoft.Collection&&t.each((function(t){var n=r+"."+t.getName();t.caption=new Terrasoft.LocalizableString({cultureValues:e["Parameters."+n+".Caption"]}),this._loadNestedParametersLocalizableValues(e,t.itemProperties,n)}),this)},_updateNestedParameterCaption:function(e){var t;(null==e||null===(t=e.itemProperties)||void 0===t?void 0:t.length)>0&&e.itemProperties.forEach((function(e){var t=this._getNestedParameter(e.uId,this.itemProperties);t&&(e.caption=t.caption.getValue()),this._updateNestedParameterCaption(e)}),this)},_restoreComplexLocalizableValue:function(e){if(this.sourceValue.hasOwnProperty("value")){var t=this.uId,r=this.getLocalizableParameterValues();Terrasoft.each(r,(function(r){var n=r.ItemUId,i=Terrasoft.filterObject(r,{isLczValue:!0});Terrasoft.each(i,(function(r,i){var a=e["Parameters."+t+".Value."+n+"."+i];if(a){var s=new Terrasoft.LocalizableString({cultureValues:a});r.value=s.getValue()}else{var o=Ext.String.format(Terrasoft.Resources.ProcessSchemaDesigner.Exceptions.LocalizableCollectionPropertyNotFoundMessage,i);this.error(o)}}),this)}),this),this.setLocalizableParameterValues(r)}},updateSchemaMapping:Terrasoft.emptyFn,getSerializableObject:function(e){this.callParent(arguments),e.caption=this.caption.getValue(),this._updateNestedParameterCaption(e)},loadLocalizableValues:function(e){e&&(this.caption=new Terrasoft.LocalizableString({cultureValues:e["Parameters."+this.uId+".Caption"]}),this._loadNestedParametersLocalizableValues(e,this.itemProperties,this.uId),this.getIsComplexLocalizableValueType()&&this._restoreComplexLocalizableValue(e))},getParentSchema:function(){return this.parentSchema},getStatus:function(){return this.status},convertToProcessParameter:function(){var e,t=this.serialize(),r=Terrasoft.decode(t);return delete r.typeName,(null==r||null===(e=r.itemProperties)||void 0===e?void 0:e.length)>0&&this._convertNestedParametersToProcessParameters(r.itemProperties),new Terrasoft.ProcessSchemaParameter(r)}}),Ext.define("Terrasoft.manager.ClientUnitSchema",{extend:"Terrasoft.manager.BaseSchema",alternateClassName:"Terrasoft.ClientUnitSchema",diffRegExp:null,contractName:"ClientUnitSchema",serializableProperties:["uId","realUId","name","caption","description","extendParent","packageUId","parentSchemaUId","body","schemaType","autogeneratedCode","css","less","parameters","copySourceSchemaUId","resources"],parentSchemaUId:null,body:null,schemaType:null,autogeneratedCode:null,dependencies:null,messages:null,columnClassName:"Terrasoft.ClientUnitSchemaParameter",parameters:null,css:null,less:null,localizableStrings:null,localizableImages:null,markerCommentsTemplate:"(\\/\\*\\*PROPERTY_NAME\\*\\/)([\\s\\S]*)(\\/\\*\\*PROPERTY_NAME\\*\\/)",resources:null,managerName:"ClientUnitSchemaManager",copySourceSchemaUId:null,addEmptyBusinessRuleBlock:function(){var e=this.body.match(this.diffRegExp).index,t=this.body.substring(0,e),r=this.body.substring(e);this.body=t+"businessRules: /**SCHEMA_BUSINESS_RULES*/{}/**SCHEMA_BUSINESS_RULES*/,\n\t\t"+r},addEmptyModulesBlock:function(){var e=this.body.match(this.diffRegExp).index,t=this.body.substring(0,e),r=this.body.substring(e);this.body=t+"modules: /**SCHEMA_MODULES*/{}/**SCHEMA_MODULES*/,\n\t\t"+r},addEmptyDataModelsBlock:function(){var e=this.body.match(this.diffRegExp).index,t=this.body.substring(0,e),r=this.body.substring(e);this.body=t+"dataModels: /**SCHEMA_DATA_MODELS*/{}/**SCHEMA_DATA_MODELS*/,\n\t\t"+r},innerDefine:function innerDefine(currentSchemaName,parentSchemaName){var schemaDefinition=[];schemaDefinition.push(this.generateSchemaStructure(currentSchemaName,parentSchemaName)),schemaDefinition.push(this.generateSchemaResources(currentSchemaName+"Resources")),schemaDefinition.push(this.generateSchemaBody(currentSchemaName)),this.undef(),eval(schemaDefinition.join("\n"))},_setBodyName:function(e,t){if(this.body){var r=this.generateSchemaBody(e);this.setPropertyValue("body",r,t)}},_getParentSchemaName:function(e,t,r){var n=e.getPropertyValue("parentSchemaUId");n?Terrasoft.ClientUnitSchemaManager.getInstanceByUId(n,(function(e){var n=e.getPropertyValue("name");t.call(r,n)}),this):t.call(r,null)},_fixTabs:function(e){return e.split("\n").map((function(e,t){return(t>0?"\t\t":"")+e}),this).join("\n")},_replaceConstantMacros:function(e){return e.replace(/("#(.+)#)"/g,"$2")},_prepareBodyProperty:function(e){if(Ext.isString(e))return e;var t=JSON.stringify(e||{},null,"\t");return t=this._fixTabs(t),t=this._replaceConstantMacros(t)},_tryInnerDefine:function(e,t){try{return this.innerDefine(e,t),{success:!0}}catch(e){return{success:!1,errorMessage:e.toString()}}},_initRegExp:function(){this.diffRegExp=new RegExp("[\"|']?diff[\"|']?\\s*?:\\s*?\\/\\*\\*SCHEMA_DIFF\\*\\/","im")},initParameters:function(e){this.parameters=Ext.create("Terrasoft.Collection"),Terrasoft.each(e.parameters,(function(e){var t=Terrasoft.decode(e);t.parentSchema=this;var r=new Terrasoft.ClientUnitSchemaParameter(t);this.parameters.add(r.uId,r)}),this)},initMessages:function(e){this.messages=Ext.create("Terrasoft.Collection"),Terrasoft.each(e.messages,(function(e,t){this.messages.add(t,Ext.create("Terrasoft.ClientUnitSchemaMessage",{name:t,directionType:e.DirectionType,mode:e.Mode}))}),this)},initLocalizableStrings:function(e){this.localizableStrings=Ext.create("Terrasoft.Collection"),this.initLocalizableValues("Terrasoft.LocalizableString",e.localizableStrings,this.localizableStrings)},initLocalizableImages:function(e){this.localizableImages=Ext.create("Terrasoft.Collection"),this.initLocalizableValues("Terrasoft.LocalizableImage",e.localizableImages,this.localizableImages)},initLocalizableValues:function(e,t,r){Terrasoft.each(t,(function(t,n){r.add(n,Ext.create(e,{cultureValues:t}))}),this)},getSchemaStructureTemplate:function(){var e="";switch(this.schemaType){case Terrasoft.SchemaType.EDIT_VIEW_MODEL_SCHEMA:case Terrasoft.SchemaType.MODULE_VIEW_MODEL_SCHEMA:case Terrasoft.SchemaType.GRID_DETAIL_VIEW_MODEL_SCHEMA:e="define('{0}Structure', ['{0}Resources'], function(resources) {return {schemaUId:'{2}',schemaName:'{3}',parentSchemaUId:'{4}',parentSchemaName:'{6}',extendParent:{5},type:"+this.schemaType+",entitySchema:'',name:'',extend:'Terrasoft.model.BaseViewModel',schema:{leftPanel:[],rightPanel:[],actions:[],analytics:[]},methods:{},controlsConfig:{},customBindings:{},bindings:{},schemaDifferences:function(){\n{1}\n}}});";break;case Terrasoft.SchemaType.MODULE:break;case Terrasoft.SchemaType.EDIT_CONTROLS_DETAIL_VIEW_MODEL_SCHEMA:e="define('{0}Structure', ['{0}Resources'], function(resources) {return {schemaUId:'{2}',schemaName:'{3}',parentSchemaUId:'{4}',parentSchemaName:'{6}',extendParent:{5},type:"+this.schemaType+",entitySchema:'',name:'',extend:'Terrasoft.model.BaseViewModel',schema:{{attributes:[]}},methods:{{}},schemaDifferences:function(){\n{1}\n}});"}return e},getSerializableObject:function(e){this.callParent(arguments);var t={};this.dependencies.eachKey((function(e,r){t[e]=r}),this),e.dependencies=t;var r={};this.localizableStrings.eachKey((function(e,t){r[e]=this.getSerializableProperty(t)}),this),e.localizableStrings=r;var n={};this.messages.eachKey((function(e,t){n[e]=this.getSerializableProperty(t)}),this),e.messages=n;var i=[];this.parameters.eachKey((function(e,t){var r=this.getSerializableProperty(t);i.push(Ext.encode(r))}),this),e.parameters=i},getSchemaBodyProperty:function(e){var t=this.getMarkerCommentRexExp(e),r=this.body.match(t);return r&&r[2]},setSchemaBodyProperty:function(e,t){var r=this._prepareBodyProperty(t),n=this.getMarkerCommentRexExp(e);this.body=this.body.replace(n,"$1"+r+"$3"),this.fireEvent("changed",{body:this.body},this)},getMarkerCommentRexExp:function(e){var t=this.markerCommentsTemplate.replace(/PROPERTY_NAME/g,e);return new RegExp(t)},getSchemaDefinitionName:function(){var e=this.name+this.packageUId;return e=requirejs.specified(e)?e:this.name},generateSchemaStructure:function(e,t){var r=this.getSchemaStructureTemplate();return r&&(r=Ext.String.format(r,e,"",this.uId,e,this.parentSchemaUId,this.extendParent,t)),r},generateSchemaResources:function(e){var t=this.getSchemaLocalizableValues(this.localizableStrings),r=this.getSchemaLocalizableValues(this.localizableImages);return Ext.String.format("define('{0}', ['terrasoft'], function() {var localizableStrings = {1};var localizableImages = {2}; return {localizableStrings: localizableStrings, localizableImages: localizableImages};});",e,JSON.stringify(t),JSON.stringify(r))},getSchemaLocalizableValues:function(e){var t={};return e.eachKey((function(e,r){t[e]=r.getValue()}),this),t},generateSchemaBody:function(e){return this.body.replace(this.name,e)},define:function(e,t){Terrasoft.chain((function(e){Terrasoft.SchemaDesignerUtilities.getSchemaHierarchy(this,e,this)}),(function(r,n){this.defineSchemaHierarchy(n,e,t)}),this)},defineSchemaHierarchy:function(e,t,r){var n;Terrasoft.eachAsync(e,(function(e,i){var a=e===this?"":e.getPackageUId(),s=e.getName()+a;if(e.extendParent){var o=e._tryInnerDefine(s,n);o.success?(n=s,i()):t.call(r,o.errorMessage)}else n=s,this._getParentSchemaName(e,(function(n){var a=e._tryInnerDefine(s,n);a.success?i():t.call(r,a.errorMessage)}),this)}),(function(){t.call(r)}),this)},defineDesignSchema:function(e,t){this.define(e,t)},undef:function(){var e=this.getSchemaDefinitionName();(requirejs.undef(e+"Structure"),requirejs.undef(e+"Resources"),requirejs.undef(e),Terrasoft.useParallelSchemaBuilding)&&delete(Terrasoft.configuration.Structures||{})[e]},constructor:function(e){e=e||{},this.callParent(arguments),this.dependencies=Ext.create("Terrasoft.Collection"),this.dependencies.loadAll(e.dependencies),this.initLocalizableStrings(e),this.initLocalizableImages(e),this.initMessages(e),this.initParameters(e),this.loadLocalizableValues(e.resources),this._initRegExp()},loadLocalizableValues:function(e){this.parameters.each((function(t){t.loadLocalizableValues(e)}),this)},getSchemaDiff:function(){return this.getSchemaBodyProperty("SCHEMA_DIFF")},getSchemaDetails:function(){return this.getSchemaBodyProperty("SCHEMA_DETAILS")},getSchemaModules:function(){return this.getSchemaBodyProperty("SCHEMA_MODULES")},getSchemaDataModels:function(){return this.getSchemaBodyProperty("SCHEMA_DATA_MODELS")},setSchemaDiff:function(e){return this.setSchemaBodyProperty("SCHEMA_DIFF",e||"")},setSchemaDataModels:function(e){return null===this.getSchemaDataModels()&&this.addEmptyDataModelsBlock(),this.setSchemaBodyProperty("SCHEMA_DATA_MODELS",e)},setSchemaDetails:function(e){return this.setSchemaBodyProperty("SCHEMA_DETAILS",e)},setSchemaModules:function(e){return null===this.getSchemaModules()&&this.addEmptyModulesBlock(),this.setSchemaBodyProperty("SCHEMA_MODULES",e)},getSchemaValidators:function(){return[this.validateSchemaMarkerComments]},validateSchema:function(e,t){var r=this.getSchemaValidators(),n={success:!0};Terrasoft.each(r,(function(e){return(n=e.call(this)).success}),this),e.call(t,n)},validateSchemaMarkerComments:function(){var e=[];switch(this.schemaType){case Terrasoft.SchemaType.EDIT_VIEW_MODEL_SCHEMA:e.push("SCHEMA_DETAILS","SCHEMA_DIFF");break;case Terrasoft.SchemaType.EDIT_CONTROLS_DETAIL_VIEW_MODEL_SCHEMA:case Terrasoft.SchemaType.MODULE_VIEW_MODEL_SCHEMA:case Terrasoft.SchemaType.GRID_DETAIL_VIEW_MODEL_SCHEMA:e.push("SCHEMA_DIFF")}var t={success:!0};return e.forEach((function(e){if(!this.getMarkerCommentRexExp(e).test(this.body))return t.success=!1,t.message=Ext.String.format(Terrasoft.Resources.Managers.Messages.MarkerCommentsValidationMessage,e),!1}),this),t},getSchemaBusinessRules:function(){return this.getSchemaBodyProperty("SCHEMA_BUSINESS_RULES")},setSchemaBusinessRules:function(e){null===this.getSchemaBusinessRules()&&this.addEmptyBusinessRuleBlock(),this.setSchemaBodyProperty("SCHEMA_BUSINESS_RULES",e)},areAllSchemaBusinessRulesValid:function(){var e=this.getSchemaBusinessRules();if(null===e)return!0;try{return JSON.parse(e),!0}catch(e){return!1}},setDefaultSchemaBody:function(e,t){var r=Terrasoft.ClientUnitSchemaBodyTemplate[e],n=Ext.String.format(r,this.name,t.entitySchemaName);this.setPropertyValue("body",n)},isNew:function(){var e=Terrasoft.ClientUnitSchemaManager.findRootSchemaItemByName(this.name);return e&&e.isNew()},addColumn:function(e){var t=e.getPropertyValue("uId"),r=Ext.isEmpty(t)?Terrasoft.generateGUID():t;e.setPropertyValue("uId",r);var n=this.columns.add(r,e);if(n.on("changed",this.onColumnChange,this),e.getStatus()===Terrasoft.ModificationStatus.NEW){var i=e.getPropertyValue("name");this.fireEvent("changed",{newColumns:[i]},this)}return n},onColumnChange:function(e,t){var r={columns:[e],column:t};this.fireEvent("changed",r,this)},setPropertyValue:function(e,t,r){"name"===e&&this._setBodyName(t,r),this.callParent(arguments)},findParameterByName:function(e){return this.parameters.findByFn((function(t){return t.name===e}),this)},undefViewModelClass:function(e){var t=this.getSchemaDefinitionName()+(e||"")+"ViewModel";Ext.ClassManager.set("Terrasoft."+t,null),Ext.ClassManager.set("Terrasoft.model."+t,null)},getParametersLocalizableValues:function(e){this.parameters.each((function(t){return t.getLocalizableValues(e)}))}}),Object.defineProperty(Terrasoft.ClientUnitSchema.prototype,"columns",{get:function(){return this.parameters},set:function(e){this.parameters=e}}),Ext.define("Terrasoft.core.ClientUnitSchemaResponse",{alternateClassName:"Terrasoft.ClientUnitSchemaResponse",extend:"Terrasoft.BaseSchemaResponse",schemaClassName:"Terrasoft.ClientUnitSchema"}),Ext.define("Terrasoft.manager.ClientUnitSchemaManagerItem",{extend:"Terrasoft.manager.BaseSchemaManagerItem",alternateClassName:"Terrasoft.ClientUnitSchemaManagerItem",instanceClassName:"Terrasoft.ClientUnitSchema",requestClassName:"Terrasoft.ClientUnitSchemaRequest",removeRequestClassName:"Terrasoft.ClientUnitSchemaRemoveRequest",updateRequestClassName:"Terrasoft.ClientUnitSchemaUpdateRequest",parentSchemaUId:null,schemaType:null,save:function(){if(this.isModified()&&this.status!==Terrasoft.ModificationStatus.REMOVED){this.checkInstance();var e=this.instance;e.body=Terrasoft.convertEolToUnix(e.body)}this.callParent(arguments)},logInstanceBody:function(){this.instance&&this.warning(this.instance.body)},onAfterSave:function(e){e&&e.success&&this._setNewParametersUpdatedStatus(),this.callParent(arguments)},_setNewParametersUpdatedStatus:function(){this.instance.parameters.each((function(e){e.status===Terrasoft.ModificationStatus.NEW&&(e.status=Terrasoft.ModificationStatus.UPDATED)}))}}),Ext.define("Terrasoft.manager.ClientUnitSchemaManager",{extend:"Terrasoft.manager.BaseSchemaManager",alternateClassName:"Terrasoft.ClientUnitSchemaManager",singleton:!0,itemClassName:"Terrasoft.ClientUnitSchemaManagerItem",managerName:"ClientUnitSchemaManager",outdatedEventName:"ClientUnitSchema_Outdated",useNotification:!0,_assignParentSchemaParameters:function(e,t,r){var n=e&&e.parentSchemaUId;Terrasoft.isEmpty(n)?t.call(r):Terrasoft.ClientUnitSchemaManager.getSchemaInstance(n,(function(n){n.parameters.each((function(t){var r=t.clone();r.uId=t.uId,r.parentSchema=e,e.parameters.add(r.uId,r)}),this),t.call(r)}),this)},initItems:function(e){Terrasoft.Features.getIsEnabled("CRM-39598")?this.initServiceItems(e):this.callParent(arguments)},queryItems:function(e,t){if(Terrasoft.Features.getIsEnabled("CRM-39598")){var r=new Terrasoft.BaseRequest({contractName:"ClientUnitSchemaManagerRequest"});return r.execute(e,t)}this.callParent(arguments)},getSelectQuery:function(){var e=this.callParent(arguments);if(Terrasoft.Features.getIsDisabled("CRM-39598")&&Terrasoft.Features.getIsEnabled("ProcessFeatures.Use8XPages")){var t=Terrasoft.createColumnFilterWithParameter("[SysSchemaProperty:SysSchema:Id].Name","SchemaType");e.filters.addItem(t)}return e},constructor:function(){this.callParent(arguments);var e={parentSchemaUId:"Parent.UId"};Terrasoft.Features.getIsDisabled("CRM-39598")&&Terrasoft.Features.getIsEnabled("ProcessFeatures.Use8XPages")&&(e.schemaType="[SysSchemaProperty:SysSchema:Id].Value"),Ext.apply(this.propertyColumnNames,e)},getDesignSchemaRequestParameters:function(){return{contractName:"DesignClientUnitSchemaRequest",responseClassName:"Terrasoft.ClientUnitSchemaResponse"}},createSchemaInstance:function(e,t,r){this.callParent([e,function(e,n,i){this._assignParentSchemaParameters(e,(function(){t.call(r,e,n,i)}),this)},this])},getBundleInstanceRequest:function(e,t){return new Terrasoft.ClientUnitBundleSchemaRequest({uId:e,packageUId:t})},findParameterByUId:function(e,t,r){this.getInstanceByUId(e.schemaUId,(function(n){var i=n.parameters.find(e.parameterUId);t.call(r,i)}),this)},findParameterByName:function(e,t,r){this.getInstanceByUId(e.schemaUId,(function(n){var i=n.parameters.findByPath("name",e.parameterName);t.call(r,i)}),this)},getCurrentPackageSchemaByUId:function(e,t,r){Terrasoft.PackageManager.getCurrentPackageUId((function(n){var i={packageUId:n,schemaUId:e};this.forceGetPackageSchema(i,t,r)}),this)},prepareDesignPageSchema:function(e,t,r,n){if(this.contains(e.uId))r.call(n,e);else{var i=Terrasoft.SchemaType.EDIT_VIEW_MODEL_SCHEMA;if(e.setDefaultSchemaBody(i,{entitySchemaName:t}),this.addSchema(e),Terrasoft.Features.getIsEnabled("UseSectionWizardHierarchy"))return e.define((function(){return Ext.callback(r,n,[e])}),this);var a=Terrasoft.SchemaDesignerUtilities;a.getCurrentPackageUId((function(t){a.forceGetPackageHierarchy(t,(function(i,a){if(a.slice(-1)[0]===t)return Ext.callback(r,n,[e]);e.define((function(){return Ext.callback(r,n,[e])}),this)}),this)}),this)}},designPageSchema:function(e,t,r){var n;Terrasoft.chain((function(t){this.forceGetPackageSchema({schemaUId:e.schemaUId,packageUId:e.packageUId},t,this)}),(function(t,r){n=r,this.prepareDesignPageSchema(n,e.entityName||"",t,this)}),(function(){t.call(r,n)}),this)},findExtendedItem:function(e,t){return this.findByFn((function(r){return r.extendParent&&r.parentSchemaUId===e&&r.packageUId===t}),this)},copySchema:function(e){var t={};e.getSerializableObject(t);var r=Terrasoft.generateGUID();(t=this.replaceObjectProperty(t,["createdInSchemaUId","modifiedInSchemaUId"],e.uId,r)).uId=r,t.realUId=r;var n=e.name;0!==n.indexOf(this.schemaNamePrefix)&&(n=this.schemaNamePrefix+n);var i=this.generateItemUniqueName(n);t.extendParent=!1;var a=this.get(e.uId);t.copySourceSchemaUId=a.status===Terrasoft.ModificationStatus.NEW?e.copySourceSchemaUId:e.uId,t.dependencies=e.dependencies.clone(),t.parameters=e.parameters.clone();var s=Ext.create(this.itemInstanceClassName,t);return this.copyLocalizableResources(e,s),s.setPropertyValue("name",i),this.addSchema(s)},setRequireJsConfig:function(e){var t;require.undef(e),require.undef(e+"Structure");var r=e+"Resources";if(require.undef(r),Terrasoft.useStaticFileContent){var n,i=Terrasoft.workspaceBaseUrl+"/conf/content/",a=i+e,s="".concat(i,"resources/").concat(Terrasoft.currentUserCultureName,"/").concat(r),o=Terrasoft.coreModulesPath+"Terrasoft/configuration/resources/empty-resources";_defineProperty(n={},e,a),_defineProperty(n,r,[s,o]),t=n}else{var l=Terrasoft.workspaceBaseUrl+"/configuration/hash/";t=_defineProperty({},e,l+e)}require.config({paths:t})},createManagerItem:function(e){return Terrasoft.Features.getIsDisabled("CRM-39598")&&Ext.isString(e.schemaType)&&!e.extraProperties&&(e.extraProperties={schemaType:Terrasoft.ServerSchemaType[e.schemaType]},delete e.schemaType),this.callParent(arguments)}}),Ext.define("Terrasoft.manager.ProcessFlowElementSchema",{extend:"Terrasoft.manager.ProcessBaseElementSchema",alternateClassName:"Terrasoft.ProcessFlowElementSchema",nodeType:Terrasoft.diagram.UserHandlesConstraint.Node,toolsConstraint:Terrasoft.diagram.ToolsConstraint.NodeSelectionTool|Terrasoft.diagram.ToolsConstraint.NodeRemoveTool|Terrasoft.diagram.ToolsConstraint.ConnectionEditTool,isExpanded:!1,serializeToDB:!1,isLogging:!0,width:0,height:0,parent:null,containerUId:null,portsSet:Terrasoft.diagram.enums.PortsSet.Basic,incomingConnectionsLimit:-1,outgoingConnectionsLimit:-1,smallImageName:"UserTaskSmall.svg",largeImageName:"UserTaskLarge.svg",titleImageName:"userTask_title.svg",size:null,visible:!0,useBackgroundMode:!1,backgroundModePriority:Terrasoft.process.BackgroundModePriority.Inherited,constructor:function(){this.callParent(arguments),this.size?(this.size=this.parseSize(this.size),this.width=this.size.width,this.height=this.size.height):this.size=this.initSize()},initSize:function(){return{width:this.width,height:this.height}},parseSize:function(e){var t=this.parseValuePairString(e);return{width:t[0],height:t[1]}},getCenterPosition:function(e,t){var r=this.size;return{X:e-r.width/2,Y:t-r.height/2}},getShape:function(){return{type:ej.Diagram.Shapes.Rectangle}},getDiagramConfig:function(e){var t=this.callParent(arguments),r=this.getLargeImage(),n=this.getShape();return r&&(n.type=ej.Diagram.Shapes.Image,n.src=Terrasoft.ImageUrlBuilder.getUrl(r)),t=Ext.apply(t,{visible:this.visible,width:this.width,height:this.height,borderWidth:0,shape:n,nodeType:this.nodeType,fillColor:"rgba(0,0,0,0)",portsSet:this.portsSet,incomingConnectionsLimit:this.incomingConnectionsLimit,outgoingConnectionsLimit:this.outgoingConnectionsLimit,parent:this.parent,toolsConstraint:this.toolsConstraint}),t=Ext.apply(t,e),this.addUserTaskLabelConfig(t),t.constraints&&(t.constraints=this.getNodeConstraints(t.constraints)),t},addUserTaskLabelConfig:function(e){this.addLabelConfig(e);var t=e.labels;t[t.length-1].offset=ej.Diagram.Point(.5,1)},addLabelConfig:function(e){var t,r=e.labels,n={text:this.getLabelText(e.caption,!0)};Ext.isEmpty(r)?t=(r=e.labels=[n])[0]:(r.push(n),t=r[r.length-1]),t.labelType=Terrasoft.LabelType.CAPTION,t.name=this.name,t.wrapText=!0,t.textAlign=ej.Diagram.TextAlign.Center,t.fontSize=this.fontSize,t.fontFamily=this.fontFamily,t.fontColor=this.fontColor,t.fillColor=this.captionFillColor,t.verticalAlignment=ej.Diagram.VerticalAlignment.Top,t.shape={},t.width=this.captionWidth},getNodeConstraints:function(e){for(var t=0,r=0;r<e.length;r++)t|=ej.Diagram.NodeConstraints[e[r]];return t},getConnectionUserHandles:function(){return["SequenceFlow","DefaultSequenceFlow","ConditionalSequenceFlow"]},getToolbarHtml:function(){return{caption:this.typeCaption,image:this.getSmallImage()}},getSerializableObject:function(e){this.callParent(arguments),e.size=this.getSerializableSize()},getSerializableProperties:function(){var e=this.callParent(arguments);return Ext.Array.push(e,["serializeToDB","isLogging","editPageSchemaName","containerUId","isExpanded","useBackgroundMode","backgroundModePriority"])},getSerializableSize:function(){var e=this.size,t="0;0";return e&&(t=Terrasoft.serializeObject({source:e,properties:["width","height"],format:"{width};{height}",valueConverter:function(e){return parseInt(e,10)||0}})),this.getSerializableProperty(t)},getIncomingSequenceFlows:function(){var e=this.parentSchema;if(null==e)throw new Terrasoft.NullOrEmptyException;return e.flowElements.filterByFn((function(e){return e instanceof Terrasoft.ProcessSequenceFlowSchema&&e.targetRefUId===this.uId}),this).getItems()},getOutgoingsSequenceFlows:function(){var e=this.parentSchema;if(null==e)throw new Terrasoft.NullOrEmptyException;return e.flowElements.filterByFn((function(e){return e instanceof Terrasoft.ProcessSequenceFlowSchema&&e.sourceRefUId===this.uId}),this).getItems()},getDragImage:function(){return this.getLargeImage()},getIsMultiInstanceSupported:function(){return!1},getIsMultiInstanceModeEnabled:function(){return!1}}),Ext.define("Terrasoft.manager.ProcessLaneSchema",{extend:"Terrasoft.ProcessBaseElementSchema",alternateClassName:"Terrasoft.ProcessLaneSchema",managerItemUId:"abcd74b9-5912-414b-82ac-f1aa4dcd554e",typeName:"Terrasoft.Core.Process.ProcessSchemaLane",parent:null,artifacts:null,userContexts:null,size:null,flowElementRefs:null,laneSetUId:null,nodeType:Terrasoft.diagram.UserHandlesConstraint.Lane,isExpanded:!0,resourceManagerName:"Terrasoft.Nui",isContainer:!0,name:"Lane",hasEmbeddedLabel:!0,getDiagramConfig:function(e){var t=this.callParent(arguments),r=t.name+"_line";return Ext.apply(t,e,{type:"group",lineName:r,nodeType:Terrasoft.diagram.UserHandlesConstraint.Lane,constraints:ej.Diagram.NodeConstraints.None,offsetX:0,offsetY:this.position?this.position.Y:0,children:[{name:r}]}),t},getSerializableProperties:function(){var e=this.callParent(arguments);return Ext.Array.push(e,["artifacts","laneSetUId","isExpanded","userContext"])}}),Ext.define("Terrasoft.manager.ProcessLaneSetSchema",{extend:"Terrasoft.ProcessBaseElementSchema",alternateClassName:"Terrasoft.ProcessLaneSetSchema",managerItemUId:"11a47caf-a0d5-41fa-a274-a0b11f77447a",typeName:"Terrasoft.Core.Process.ProcessSchemaLaneSet",isExpanded:!0,nodeType:Terrasoft.diagram.UserHandlesConstraint.LaneSet,direction:Terrasoft.process.enums.ProcessSchemaPoolDirection.HORIZONTAL,size:null,resourceManagerName:"Terrasoft.Nui",lanes:null,name:"LaneSet",hasEmbeddedLabel:!0,constructor:function(){this.callParent(arguments),this.initLanes(this.lanes||[])},initLanes:function(e){var t=this.lanes=Ext.create("Terrasoft.Collection");e.forEach((function(e){var r=Terrasoft.ProcessFlowElementSchemaManager.createInstance(e.managerItemUId,e);t.add(r.name,r)}),this)},loadLocalizableValues:function(e){if(this.callParent(arguments),e){var t=e.Lanes||{};this.lanes.each((function(e){var r=t[e.name];e.loadLocalizableValues(r)}),this)}},loadLocalizableValuesByUIds:function(e){this.callParent(arguments),e&&this.lanes.each((function(t){t.loadLocalizableValuesByUIds(e)}),this)},getLocalizableValues:function(e){this.callParent(arguments),this.lanes.each((function(t){t.getLocalizableValues(e)}),this)},getSerializableObject:function(e){this.callParent(arguments);var t=e.lanes=[];this.lanes.each((function(e){var r=this.getSerializableProperty(e);t.push(r)}),this)},getSerializableProperties:function(){var e=this.callParent(arguments);return Ext.Array.push(e,["direction","isExpanded"])}}),Ext.define("Terrasoft.data.queries.ProcessFlowElementSchemaRequest",{extend:"Terrasoft.BaseSchemaRequest",alternateClassName:"Terrasoft.ProcessFlowElementSchemaRequest",contractName:"ProcessFlowElementSchemaRequest",responseClassName:"Terrasoft.ProcessFlowElementSchemaResponse"}),Ext.define("Terrasoft.manager.ProcessFlowElementSchemaManagerItem",{extend:"Terrasoft.BaseSchemaManagerItem",alternateClassName:"Terrasoft.ProcessFlowElementSchemaManagerItem",instanceClassName:"Terrasoft.ProcessFlowElementSchema",requestClassName:"Terrasoft.ProcessFlowElementSchemaRequest",setInstance:function(){this.callParent(arguments),this.uId=this.instance.managerItemUId||this.instance.uId},createInstance:function(e){var t=this.callParent(arguments);return Terrasoft.each(e,(function(e,r){t[r]instanceof Terrasoft.LocalizableString&&("string"==typeof e?t[r]=new Terrasoft.LocalizableString(e):e instanceof Terrasoft.LocalizableString?t[r]=e.clone():t[r]=Ext.create("Terrasoft.LocalizableString",{cultureValues:e}))}),this),t}}),Ext.ns("Terrasoft.Core.Process"),Ext.define("Terrasoft.manager.DynamicProcessSchemaParameter",{extend:"Terrasoft.ProcessSchemaParameter",alternateClassName:"Terrasoft.DynamicProcessSchemaParameter",getSerializableObject:function(e){this.callParent(arguments);var t=this.getParentSchema(),r=t.uId;e.createdInSchemaUId=r,e.modifiedInSchemaUId=r},getIsDynamic:function(){return!0}}),Terrasoft.Core.Process.DynamicProcessSchemaParameter=Terrasoft.DynamicProcessSchemaParameter,Ext.define("Terrasoft.service.ProcessSchemaParameterCollection",{extend:"Terrasoft.Collection",alternateClassName:"Terrasoft.ProcessSchemaParameterCollection",_parameters:null,constructor:function(e){this.callParent(),this._parameters=Ext.create("Terrasoft.Collection",e),this._parameters.on("add",this.onParameterAdd,this),this._parameters.on("remove",this.onParameterRemove,this),this._parameters.on("dataLoaded",this.onParametersLoaded,this),this._parameters.on("clear",this.onParametersCleared,this),this._parameters.each((function(e){this._addNestedParameters(e)}),this)},_addNestedParameters:function(e){var t=e.itemProperties;t.on("add",this.onParameterAdd,this),t.on("remove",this.onParameterRemove,this),t.on("clear",this.onParametersCleared,this),t.on("dataLoaded",this.onParametersLoaded,this),t.each((function(e){this.onParameterAdd(e)}),this)},_recursiveRemoveByUId:function(e,t){var r=e.findByFn((function(e){return e.uId===t}),this);r?e.remove(r):e.each((function(e){this._recursiveRemoveByUId(e.itemProperties,t)}),this)},onParametersLoaded:function(e,t){t.each((function(e){this.onParameterAdd(e)}),this)},onParametersCleared:function(e,t){t.each((function(e){this.onParameterRemove(e)}),this)},onParameterAdd:function(e,t,r){r=r||e.uId,this.collection.add(r,e);var n=e.itemProperties;n.on("add",this.onParameterAdd,this),n.on("remove",this.onParameterRemove,this),n.on("clear",this.onParametersCleared,this),n.on("dataLoaded",this.onParametersLoaded,this),n.each((function(e){this.onParameterAdd(e)}),this)},onParameterRemove:function(e){this.collection.remove(e);var t=e.itemProperties;t.un("add",this.onParameterAdd,this),t.un("remove",this.onParameterRemove,this),t.un("clear",this.onParametersCleared),t.un("dataLoaded",this.onParametersLoaded,this),t.each((function(e){this.onParameterRemove(e)}),this)},onDestroy:function(){this.callParent(),this._parameters.un("add",this.onParameterAdd,this),this._parameters.un("remove",this.onParameterRemove,this),this._parameters.un("clear",this.onParametersCleared,this),this._parameters.un("dataLoaded",this.onParametersLoaded,this)},getRoots:function(){return this._parameters},add:function(e,t,r){return this._parameters.add(e,t,r)},remove:function(e){var t=e.getParent();return t?t.itemProperties.remove(e):this._parameters.remove(e)},clone:function(){var e=Ext.create("Terrasoft.ProcessSchemaParameterCollection");return e.loadAll(this._parameters),e},loadAll:function(){this._parameters.loadAll.apply(this._parameters,arguments)},clear:function(){this._parameters.clear.apply(this._parameters,arguments)},removeByKey:function(e){return this._parameters.removeByIndex(this._parameters.indexOfKey(e))},removeByUId:function(e){this._recursiveRemoveByUId(this._parameters,e)},removeByIndex:function(e){return this._parameters.removeByIndex(e)},indexOf:function(e){return this._parameters.indexOf(e)},indexOfKey:function(e){return this._parameters.indexOfKey(e)}}),Ext.define("Terrasoft.manager.mixins.ParametrizedProcessSchemaElement",{alternateClassName:"Terrasoft.ParametrizedProcessSchemaElement",mixins:{serializable:"Terrasoft.Serializable"},parameters:null,enableEditCollection:!0,constructor:function(){this.callParent(arguments);var e=this.parameters||[];this.parameters=Terrasoft.Features.getIsEnabled("ProcessParameterCollections")||Terrasoft.isDebug?Ext.create("Terrasoft.ProcessSchemaParameterCollection"):Ext.create("Terrasoft.Collection"),this.enableEditCollection&&(Terrasoft.each(e,(function(e){if(!this.parameters.find(e.uId)){var t=e.typeName||Terrasoft.ProcessSchemaParameter.prototype.typeName,r=Ext.create(t,e);this.parameters.add(r.uId,r)}}),this),this.parameters.each((function(e){e.processFlowElementSchema=this}),this),this.initHasLazyParameters())},_getRootParameters:function(e){return Terrasoft.Features.getIsEnabled("ProcessParameterCollections")||Terrasoft.isDebug?e.getRoots():e},_findParameterByCaption:function(e,t){return e.filterByFn((function(e){return Terrasoft.ProcessSchemaDesignerUtilities.getElementCaption(e)===t}),this).first()},initHasLazyParameters:function(){var e=this.getLazyParameters();this.hasLazyParameters=!e.isEmpty()},getCanSynchronizeParameters:function(e){return!(!(e=e||this.schema)||this.schemaUId===this.parentSchema.uId)},_recursivelyFindParameterByCaption:function(e){for(var t=this._findParameterByCaption(this.parameters,e[0]),r=1;r<e.length;r++)t&&(t=this._findParameterByCaption(t.itemProperties,e[r]));return t},synchronizeParameter:function(e){var t=this.createElementParameter(e);this.parameters.add(t.uId,t),this._updateMapping(e,t)},_updateMapping:function(e,t){var r=this.parentSchema.mappings,n=this.createMappingInfo(e.uId,t);r.add(n.targetUId,n),e.itemProperties.each((function(e){var r=t.itemProperties.findByPath("name",e.name);this._updateMapping(e,r)}),this)},_prepareClonedParameter:function(e){e.uId=Terrasoft.generateGUID(),e.containerUId=this.uId,e.processFlowElementSchema=this,e.itemProperties.each((function(e){this._prepareClonedParameter(e)}),this)},synchronizeDynamicParameter:function(e){e.getIsDynamic()&&!this.findParameterByName(e.name)&&this.synchronizeParameter(e)},createElementParameter:function(e){var t=e.clone();return this._prepareClonedParameter(t),this.clearSubProcessParametersSourceValue(t),t},getSerializableObject:function(e){var t=Terrasoft.isInstanceOfClass(this.parameters,"Terrasoft.ProcessSchemaParameterCollection")?this.parameters.getRoots():this.parameters;t&&!t.isEmpty()&&(e.parameters=[],t.each((function(t){var r=this.getSerializableProperty(t);e.parameters.push(r)}),this))},getCanAssignParameterSourceValue:function(e){return e.direction!==Terrasoft.ProcessSchemaParameterDirection.OUT},loadParametersLocalizableValues:function(e){if(e){var t=e.Parameters||{};this.parameters.each((function(e){var r=t[e.name];e.loadLocalizableValues(r),this.clearSubProcessParametersSourceValue(e)}),this)}},loadParametersLocalizableValuesByUIds:function(e){e&&this.parameters.each((function(t){t.loadLocalizableValuesByUIds(e),this.clearSubProcessParametersSourceValue(t)}),this)},getParametersLocalizableValues:function(e){this.parameters.each((function(t){t.getLocalizableValues(e)}),this)},findParameterByName:function(e){return this.parameters.findByFn((function(t){return t.name===e}),this)},findParameterByReferenceSchemaUId:function(e){return this.parameters.filterByFn((function(t){return t.referenceSchemaUId===e}),this).first()},getParameterByName:function(e){var t=this.findParameterByName(e);if(!t){var r=Ext.String.format(Terrasoft.Resources.ProcessSchemaDesigner.Messages.ParameterNotFoundMessage,e);throw Ext.create("Terrasoft.exceptions.ItemNotFoundException",{message:r})}return t},findParameterByCaption:function(e){return this._recursivelyFindParameterByCaption([e])||this._recursivelyFindParameterByCaption(e.split(":"))},findParameterByUId:function(e){return this.parameters.find(e)},findParameterBySourceUId:function(e){return this.parameters.filterByPath("sourceParameterUId",e).first()||null},getResultParamter:function(){return this.getResultParameter()},getResultParameter:function(){var e=this.parameters.filterByFn((function(e){return!0===e.isResult}));if(e.getCount()>1)throw new Terrasoft.InvalidObjectState;return e.first()},onParameterAdded:function(e){this.fireEvent("parameterAdded",e,this)},onParameterRemoved:function(e){this.fireEvent("parameterRemoved",e,this)},subscribeOnChangedEvent:function(e,t){this.on("changed",e,t),this.parameters.on("add",this.onParameterAdded,this),this.parameters.on("remove",this.onParameterRemoved,this),this.parameters.each((function(r){r.on("changed",e,t)}),this)},unsubscribeOnChangedEvent:function(e,t){this.un("changed",e,t),this.parameters.un("add",this.onParameterAdded,this),this.parameters.un("remove",this.onParameterRemoved,this),this.parameters.each((function(r){r.un("changed",e,t)}),this)},synchronizeParameters:function(e){if(this.getCanSynchronizeParameters(e)){this.clearParameters();var t=this._getRootParameters(e.parameters);t&&t.each(this.synchronizeParameter,this)}this.initHasLazyParameters()},synchronizeDynamicParameters:function(){if(this.getCanSynchronizeParameters()){var e=this.schema.parameters;e&&e.each(this.synchronizeDynamicParameter,this)}},clearParamters:function(){this.clearParameters()},clearParameters:function(){var e=this.parentSchema.mappings;this.parameters.each((function(t){var r=e.find(t.uId);e.remove(r)}),this),this.parameters.clear()},clearDynamicParamters:function(){this.clearDynamicParameters()},clearDynamicParameters:function(){this.getDynamicParameters().each((function(e){this.clearDynamicParameter(e.uId)}),this)},clearDynamicParameter:function(e){var t=this.parentSchema.mappings,r=t.find(e);t.remove(r),this.parameters.removeByKey(e)},getDynamicParameters:function(){return this.parameters.filterByFn((function(e){return e.getIsDynamic()}),this)},createMappingInfo:function(e,t){var r=this.parentSchema.uId,n=Terrasoft.FormulaMacros.prepareProcessElementParameterValue(this.uId,t.uId).getMetaPath();return{createdInSchemaUId:r,modifiedInSchemaUId:r,name:this.name,source:t.cloneSourceValue(),sourceSchemaUId:this.schemaUId,dragGroupName:t.dragGroupName,ownerSchemaManagerName:t.ownerSchemaManagerName,sourceParameterUId:e,targetUId:t.uId,typeName:"Terrasoft.Core.Process.ProcessSchemaMapping",targetMetaPath:n,uId:Terrasoft.generateGUID()}},clearSubProcessParametersSourceValue:function(e){if(!Terrasoft.Features.getIsEnabled("UseMultiInstanceSubProcess")&&this.nodeType===Terrasoft.diagram.UserHandlesConstraint.Subprocess){var t=e.sourceValue;e.createdInSchemaUId===t.modifiedInSchemaUId&&e.clearSourceValue()}},validateParameters:function(){var e=[];return this.parameters.each((function(t){var r=t.validate();Ext.Array.push(e,r)}),this),e},getLazyParameters:function(){return this.parameters.filterByFn((function(e){return e.isLazy}),this)},getLoadedLazyParameters:function(){return this.parameters.filterByFn((function(e){return e.isLazy&&e.isLoaded}),this)},getNotLoadedLazyParameters:function(){return this.parameters.filterByFn((function(e){return e.isLazy&&!e.isLoaded}),this)},getAllLazyParametersAreLoaded:function(){return 0===this.getNotLoadedLazyParameters().getCount()},loadLazyParameters:function(e,t){t=t||this;var r=this.getNotLoadedLazyParameters();if(r.isEmpty())e.call(t,this);else{var n={userTaskUId:this.uId,processSchemaUId:this.parentSchema.uId};Terrasoft.ProcessSchemaLazyPropertiesHelper.getLazyParameterValues(n,(function(n){r.each((function(e){var t=n[e.uId];Ext.isEmpty(t)||e.setPropertyValue("sourceValue",t),e.setPropertyValue("isLoaded",!0)}),this),e.call(t)}),this)}},clearLazyParameterValues:function(){this.getLazyParameters().each((function(e){e.clearSourceValue(),e.setPropertyValue("isLoaded",!1)}),this)},updateParametersDisplayValue:function(e,t){var r=this,n=this.parameters.filterByFn((function(e){var t=e.sourceValue.source,r=Terrasoft.ProcessSchemaParameterValueSource,n=t&&t!==r.None&&t!==r.ConstValue,i=!Ext.isEmpty(e.sourceValue.value);return n&&i}),this).getItems().map((function(e){var t=e.sourceValue,n=t.value,i=t.displayValue=t.displayValue||new Terrasoft.LocalizableString,a=r.parentSchema||this;return function(t){Terrasoft.FormulaParserUtils.getFormulaDisplayValue(n,a,(function(n,a,s){var o=Ext.isEmpty(s);o?i.setValue(n):(e.setPropertyValue("isValid",o),r.setPropertyValue("isValid",o)),t()}),this)}}),this);n.push((function(){e.call(t)})),Terrasoft.chain.apply(this,n)},getResultParameters:function(){return this._getRootParameters(this.parameters).getItems()},getEditableParameters:function(e){return this._getRootParameters(this.parameters).getItems()},getRootParameters:function(){return this._getRootParameters(this.parameters)},removeParameterByUId:function(e){Terrasoft.Features.getIsEnabled("ProcessParameterCollections")||Terrasoft.isDebug?this.parameters.removeByUId(e):this.parameters.removeByKey(e)}}),Ext.define("Terrasoft.manager.BaseProcessSchema",{extend:"Terrasoft.manager.BaseSchema",alternateClassName:"Terrasoft.BaseProcessSchema",mixins:{parametrizedProcessSchemaElement:"Terrasoft.ParametrizedProcessSchemaElement"},_isActualVersion:null,typeName:"Terrasoft.Core.Process.BaseProcessSchema",contractName:null,metaData:null,managerName:null,typeCaption:null,createdInVersion:null,parentSchemaUId:null,enabled:!0,serializeToDB:!1,serializeToMemory:!0,isLogging:!0,maxLoopCount:100,color:null,validationInfo:null,validationResults:null,flowElements:null,isValid:!0,mappings:null,isActiveVersion:!0,studioFreeProcessUrl:"",isDelivered:!1,version:0,notificationCaption:null,useSystemSecurityContext:!1,useNotificationCaption:!0,backgroundModePriority:Terrasoft.process.BackgroundModePriority.Medium,constructor:function(){this.callParent(arguments),this.validationResults=[],this.mixins.parametrizedProcessSchemaElement.constructor.call(this),this.addEvents("parameterAdded","parameterRemoved"),this._initNotificationCaption()},_initNotificationCaption:function(){if(this.useNotificationCaption){var e=this._createNotificationCaption(),t=this.notificationCaption;if(t){var r=e.sourceValue,n=t.sourceValue;r.source=n.source,r.value=n.value}this.notificationCaption=e}},_createNotificationCaption:function(){var e=Terrasoft.Resources.ProcessSchemaDesigner,t=Ext.create("Terrasoft.LocalizableString",e.Parameters.NotificationCaption),r=Terrasoft.process.constants,n=r.LEFT_MACROS_BRACKET+"{0}"+r.RIGHT_MACROS_BRACKET,i=Ext.create("Terrasoft.LocalizableString",Ext.String.format(n,e.PropertyNames.Caption));return Ext.create("Terrasoft.ProcessSchemaParameter",{uId:"cdd58be7-2dba-4a5e-869b-1ad5d6d7513a",name:"NotificationCaption",caption:t,dataValueType:Terrasoft.DataValueType.TEXT,createdInSchemaUId:this.uId,modifiedInSchemaUId:this.uId,sourceValue:{source:Terrasoft.ProcessSchemaParameterValueSource.Script,value:Ext.String.format(n,r.CAPTION_PROPERTY_VALUE_MACROS),displayValue:i},processFlowElementSchema:this})},internalValidate:function(){return this.mixins.parametrizedProcessSchemaElement.validateParameters.apply(this,arguments)},collectValidationResults:function(e,t){e.each((function(e){var r=e.validationResults;if(!1===e.isValid&&Ext.isEmpty(r)){var n=Terrasoft.Resources.ProcessSchemaDesigner.Messages.ProcessSchemaElementRequirePropertyValidation;r=[{validationType:Terrasoft.ValidationType.ERROR,message:n}]}this.addValidationResult(t,e,r);var i=e.internalValidate();this.addValidationResult(t,e,i)}),this)},getIsSchemaValid:function(e,t){var r=!0;return r=e.itemsValidationInfo.reduce(function(e,r){return e&&this.getIsItemValid(r,t)}.bind(this),r)},getIsItemValid:function(e,t){var r=!0;return r=e.validationResults.reduce(function(e,r){return e&&this.isResultValid(r.validationType,t)}.bind(this),r)},isResultValid:function(e,t){var r=[Terrasoft.ValidationType.ERROR];switch(t){case Terrasoft.ValidationType.ERROR:break;case Terrasoft.ValidationType.WARNING:r.push(Terrasoft.ValidationType.WARNING);break;case Terrasoft.ValidationType.INFO:r.push(Terrasoft.ValidationType.WARNING),r.push(Terrasoft.ValidationType.INFO)}return!Ext.Array.contains(r,e)},forceGetItemValidationInfo:function(e,t){var r=this.findItemValidationInfo(e,t);r||(r={displayValue:t.validationInfoCaption||t.getDisplayValue(),uId:t.uId,validationResults:[]},e.itemsValidationInfo.push(r));return r},addValidationResult:function(e,t,r){var n=this.forceGetItemValidationInfo(e,t);Ext.Array.push(n.validationResults,r)},findItemValidationInfo:function(e,t){var r=null;return e.itemsValidationInfo.forEach((function(e){var n=e.uId===t.uId;return n&&(r=e),!n}),this),r},findLinksToElements:function(e){var t=[],r=[];return e.forEach((function(e){var t=this.findElementChildrenName(e);(r=r.concat(t)).push(e)}),this),r.every((function(e){var n=this.findItemByName(e),i=n&&n.parameters;return!i||0===i.getCount()||(i.each((function(e){var n=this.findLinksToFlowElement(e,r),i=this.findLinksToParameters(e,this.parameters);t=t.concat(n,i)}),this),!0)}),this),t},findLinksToSchemaParameter:function(e){var t=this.findLinksToFlowElement(e),r=this.findLinksToParameters(e,this.parameters);return t.concat(r)},findLinksToParameters:function(e,t){var r=[],n=[Terrasoft.ProcessSchemaParameterValueSource.Mapping,Terrasoft.ProcessSchemaParameterValueSource.Script,Terrasoft.ProcessSchemaParameterValueSource.ConstValue];return t.each((function(t){var i=!Terrasoft.includes(n,t.getValueSource());if(t.uId!==e.uId&&!t.forceRemove&&!i){var a=t.getMappingValue().value;if(this._getIsDependentParameterValueFromParameter(a,e)){var s=t.processFlowElementSchema;r.push({sourceParameter:e,dependentElement:s,dependentParameter:t})}}}),this),r},_getIsDependentParameterValueFromParameter:function(e,t){var r=!1;if(e&&!Ext.isBoolean(e))if(this.getIsProcessSchemaParameter(t)){var n=Terrasoft.process.constants.PROCESS_PARAMETER_METAPATH_TEMPLATE,i=Ext.String.format(n,t.uId);r=Terrasoft.includes(e,i)}else{var a=t.processFlowElementSchema,s=Terrasoft.process.constants.PARAMETER_METAPATH_TEMPLATE,o=Ext.String.format(s,a.uId,t.uId);r=Terrasoft.includes(e,o)}return r},findElementChildrenName:function(e){var t=[];return this.flowElements.filterByFn((function(t){return t.parent===e}),this).each((function(e){t.push(e.name);var r=this.findElementChildrenName(e.name);t=t.concat(r)}),this),t},getInvalidRemoveElementMessage:function(e){var t="";return e.every((function(e){return""!==t&&(t+="\r\r"),t+=this.getInvalidRemoveElementLinkMessage(e)}),this),t},getInvalidRemoveElementLinkMessage:function(e){var t="",r=Terrasoft.Resources.ProcessSchemaDesigner.Messages,n=e.sourceParameter,i=n.processFlowElementSchema,a=i.caption.getValue()||i.name,s=n.caption.getValue()||n.name,o=e.dependentElement,l=o.caption.getValue()||o.name,c=this.parameters.contains(n.uId),u=e.dependentParameter;if(!u)return t+=c?Ext.String.format(r.InvalidRemoveSchemaParameterUsedinElement,s,l):Ext.String.format(r.InvalidRemoveParameterUsedinElement,s,a,l);var h=this.parameters.contains(u.uId),f=u.caption.getValue()||u.name;return t+=c?h?Ext.String.format(r.InvalidRemoveSchemaParameterUsedinSchemaParameter,s,f):Ext.String.format(r.InvalidRemoveSchemaParameterUsedinParameter,s,f,l):h?Ext.String.format(r.InvalidRemoveElementUsedinSchemaParameter,s,a,f):Ext.String.format(r.InvalidRemoveElementUsedinParameter,s,a,f,l)},getEditPageSchemaName:Terrasoft.abstractFn,getSerializableProperties:function(){var e=this.callParent(arguments),t=Ext.Array.push(e,["typeName","isLogging","serializeToDB","serializeToMemory","maxLoopCount","enabled","isValid","parentSchemaUId","isActiveVersion","isDelivered","version","notificationCaption","useSystemSecurityContext","studioFreeProcessUrl","backgroundModePriority"]);return t},loadLocalizableValues:function(e){if(this.callParent(arguments),this.mixins.parametrizedProcessSchemaElement.loadParametersLocalizableValues.call(this,e),this.useNotificationCaption&&e){var t=this.notificationCaption,r=e[t.name];t.loadLocalizableValues.call(t,r)}},loadLocalizableValuesByUIds:function(e){if(this.callParent(arguments),this.mixins.parametrizedProcessSchemaElement.loadParametersLocalizableValuesByUIds.call(this,e),this.useNotificationCaption){var t=this.notificationCaption;t.loadLocalizableValuesByUIds.call(t,e)}},getLocalizableValues:function(e){if(this.callParent(arguments),this.mixins.parametrizedProcessSchemaElement.getParametersLocalizableValues.call(this,e),this.useNotificationCaption){var t=this.notificationCaption;t.getLocalizableValues.call(t,e)}},getTitleImage:Terrasoft.abstractFn,collectItemsValidationResults:Terrasoft.abstractFn,initMappings:function(){var e=this.mappings||[],t=this.mappings=Ext.create("Terrasoft.Collection");Terrasoft.each(e,(function(e){if(e.createdInSchemaUId===this.uId){var r=e.targetUId;if(t.find(r)){var n=Ext.String.format('Process mapping for parameter with UId "{0}" already exists',r);this.log(n,Terrasoft.LogMessageType.ERROR)}else t.add(r,e)}else{var i=e.name;if(this.inheritedElements.contains(i))return;this.inheritedElements.add(i,e)}}),this)},findMappingByTargetUId:function(e){return this.mappings.find(e)},removeMapping:function(e){e.parameters&&e.parameters.each((function(e){this.mappings.removeByKey(e.uId)}),this)},findLinksToFlowElement:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],r=[];return this.flowElements.each((function(n){if(!t.includes(n.name)){var i=n.parameters;if(i){var a=this.findLinksToParameters(e,i);r=r.concat(a)}}}),this),r},findItemByName:Terrasoft.abstractFn,findItemByUId:Terrasoft.abstractFn,remove:Terrasoft.abstractFn,contains:Terrasoft.abstractFn,validate:function(e){var t=e||Terrasoft.ValidationType.ERROR,r={uId:this.uId,displayValue:this.getDisplayValue(),itemsValidationInfo:[]};this.addValidationResult(r,this,this.validationResults);var n=this.internalValidate();return this.addValidationResult(r,this,n),this.collectItemsValidationResults(r),this.validationInfo=r,this.getIsSchemaValid(r,t)},getValidationResults:function(e){this.validationInfo||this.validate();var t=this.validationInfo,r=e||Terrasoft.ValidationType.ERROR,n=[];return t.itemsValidationInfo.forEach((function(e){var t=[];e.validationResults.forEach((function(e){this.isResultValid(e.validationType,r)||t.push(Terrasoft.deepClone(e))}),this),Ext.isEmpty(t)||n.push({uId:e.uId,displayValue:e.displayValue,validationResults:t})}),this),n},synchronizeParameters:function(e){e.parameters&&e.synchronizeParameters(e.schema)},synchronizeDynamicParameters:function(){this.flowElements.each((function(e){e.isUserTask&&e.synchronizeDynamicParameters()}),this)},getIsProcessSchemaParameter:function(e){return e.processFlowElementSchema.uId===this.uId},changeMapping:function(e){var t=this.findMappingByTargetUId(e.uId);t&&(t.source=e.cloneSourceValue(),t.modifiedInSchemaUId=this.uId,this.fireEvent("changed",{item:t}))},canRemoveElements:function(e){var t=this.findLinksToElements(e),r={canRemove:!0};return t.length>0&&(r.canRemove=!1,r.validationInfo=this.getInvalidRemoveElementMessage(t)),r},canRemoveParameter:function(e){var t=this.findLinksToSchemaParameter(e),r={canRemove:!0};return t.length>0&&(r.canRemove=!1,r.validationInfo=this.getInvalidRemoveElementMessage(t)),r},getLazyProperties:function(e){var t=[];return this.flowElements.each((function(r){Ext.isEmpty(r.parameters)||(e?r.getLoadedLazyParameters():r.getLazyParameters()).each((function(e){t.push(Ext.String.format("{0}.{1}",r.uId,e.uId))}))})),t},getAllLazyPropertiesAreLoaded:function(){var e=this.getAllLazyParametersAreLoaded();e&&(e=0===this.flowElements.filterByFn((function(e){return!!e.hasLazyParameters&&!e.getAllLazyParametersAreLoaded()}),this).getCount());return e},getLoadedLazyProperties:function(){return this.getLazyProperties(!0)},clearLazyParametersValues:function(){this.flowElements.each((function(e){e.hasLazyParameters&&e.clearLazyParameterValues()}))},loadAllLazyProperties:function(e,t){this.loadLazyParameters((function(){Terrasoft.eachAsync(this.flowElements.getItems(),(function(e,r){e.hasLazyParameters?e.loadLazyParameters(r,t):r()}),e,t)}),this)},getValidateFormulaServerMethodName:Terrasoft.abstractFn,getIsActualVersion:function(){return null===this._isActualVersion?this.isActiveVersion:this._isActualVersion},setIsActualVersion:function(e){this._isActualVersion=e}}),Ext.define("Terrasoft.manager.UserTaskSchema",{extend:"Terrasoft.BaseSchema",alternateClassName:"Terrasoft.UserTaskSchema",mixins:{parametrizedProcessSchemaElement:"Terrasoft.ParametrizedProcessSchemaElement"},typeName:"Terrasoft.Core.Process.ProcessSchemaUserTask",metaData:null,executeBody:null,dcmParametersEditPageSchemaV2UId:null,parametersEditPageSchemaV2UId:null,editPageSchemaUIdPropertyName:"parametersEditPageSchemaV2UId",isUserTask:!0,isInteractive:!0,enableCustomEventHandlers:null,managerName:null,methods:null,usings:null,createdInVersion:null,createdInSchemaUId:null,modifiedInSchemaUId:null,createdInPackageId:null,parentSchemaUId:null,group:null,entitySchemaUId:null,serializeToDB:!1,usageType:Terrasoft.ProcessSchemaUsageType.ADVANCED,parametersEditPageSchemaUId:null,localizableStrings:null,editPageSchemaName:"",color:null,isPartial:!1,clientUnitSchemaManager:Terrasoft.ClientUnitSchemaManager,hasUserDefinedCode:!1,constructor:function(){this.callParent(arguments),this.mixins.parametrizedProcessSchemaElement.constructor.call(this)},getEditPageSchemaName:function(e,t){var r=this[this.editPageSchemaUIdPropertyName];!this.editPageSchemaName&&r?this.clientUnitSchemaManager.getItemByUId(r,(function(r){r.getInstance((function(r){this.editPageSchemaName=r.name,e.call(t,this.editPageSchemaName)}),this)}),this):(this.editPageSchemaName=this.editPageSchemaName||Terrasoft.process.constants.DEFAULT_EDIT_PAGE_SCHEMA_NAME,e.call(t,this.editPageSchemaName))},loadLocalizableValues:function(e){e&&(this.caption=Ext.create("Terrasoft.LocalizableString",{cultureValues:e.Caption}),this.description=Ext.create("Terrasoft.LocalizableString",{cultureValues:e.Description}),this.mixins.parametrizedProcessSchemaElement.loadParametersLocalizableValues.call(this,e))},loadLocalizableValuesByUIds:function(e){if(e){var t=this.uId;this.caption=Ext.create("Terrasoft.LocalizableString",{cultureValues:e[t+".caption"]}),this.description=Ext.create("Terrasoft.LocalizableString",{cultureValues:e[t+".description"]}),this.mixins.parametrizedProcessSchemaElement.loadParametersLocalizableValuesByUIds.call(this,e)}},getLocalizableValues:function(e){var t=this.uId;e[t+".caption"]=this.getSerializableProperty(this.caption),e[t+".description"]=this.getSerializableProperty(this.description),this.mixins.parametrizedProcessSchemaElement.getParametersLocalizableValues.call(this,e)},internalValidate:function(){return this.mixins.parametrizedProcessSchemaElement.validateParameters.apply(this,arguments)}}),Ext.define("Terrasoft.manager.BaseProcessFlowElementSchemaManager",{extend:"Terrasoft.manager.BaseSchemaManager",alternateClassName:"Terrasoft.BaseProcessFlowElementSchemaManager",itemClassName:"Terrasoft.ProcessFlowElementSchemaManagerItem",coreElementClassNames:[],serviceTaskElementNames:[],obsoleteElementNames:[],notImplementedElementNames:[],itemsInitialConfigs:{},notImplementedElementsFeatureCode:null,obsoleteElementsFeatureCode:null,userTaskSchemaManagerName:null,getIsElementNotImplemented:function(e){return!Terrasoft.Features.getIsEnabled(this.notImplementedElementsFeatureCode)&&(!!e&&this.notImplementedElementNames.indexOf(e.name||e)>-1)},getIsElementObsolete:function(e){return!Terrasoft.Features.getIsEnabled(this.obsoleteElementsFeatureCode)&&(!!e&&(this.obsoleteElementNames.indexOf(e.name||e)>-1||e.usageType===Terrasoft.ProcessSchemaUsageType.NONE||e.isDeprecated))},addCoreElements:function(){Terrasoft.each(this.coreElementClassNames,(function(e){var t=e.itemType,r=Ext.create("Terrasoft.ProcessFlowElementSchemaManagerItem",{instanceClassName:t}),n=e.initialConfig||{},i=r.createInstance(n);r.setInstance(i),this.getIsElementNotImplemented(i)||(i&&(i.isDeprecated=this.getIsElementObsolete(i)),this.itemsInitialConfigs[r.uId]=n,this.addItem(r))}),this)},getItemByType:function(e){if(!e)throw new Terrasoft.ArgumentNullOrEmptyException({argumentName:"typeName"});var t=this.items.filterByFn((function(t){return t.instance.typeName===e}),this);if(0===(t=t.getItems()).length)throw new Terrasoft.ItemNotFoundException({message:Terrasoft.Resources.Collection.ItemWithKey+' "'+e+'" '+Terrasoft.Resources.Collection.DoesNotExists});return t[0]},onUserTaskManagerInitialized:function(e){this.initialized=!0,this.initializing=!1,e(),this.fireEvent("initialized")},getUserTaskManager:function(){return Terrasoft[this.userTaskSchemaManagerName]},initializeUserTaskManagerItem:function(e){var t=(Terrasoft.configuration||{}).validUserTasksByDefault||[],r=this.itemsInitialConfigs,n=e.name,i=e.instance;if(!this.getIsElementNotImplemented(n)){i&&(i.isDeprecated=this.getIsElementObsolete(i)),this.serviceTaskElementNames.indexOf(e.name)>-1&&(i.group=Terrasoft.FlowElementGroup.ServiceTask);var a={isValid:Ext.Array.contains(t,e.uId)};r[e.uId]=a,this.addItem(e)}},initializeUserTaskManagerItems:function(){this.getUserTaskManager().items.each((function(e){this.initializeUserTaskManagerItem(e)}),this)},initializeUserTaskManager:function(e){var t=this.getUserTaskManager();t?t.initialize((function(){this.initializeUserTaskManagerItems(t),Ext.callback(e,this)}),this):Ext.callback(e,this)},initialize:function(e,t){var r=this.getSafeCallback(e,t);this.initialized?r():this.initializing?this.on("initialized",(function(){r()}),this,{single:!0}):(this.initializing=!0,this.addCoreElements(),this.initializeUserTaskManager((function(){this.onUserTaskManagerInitialized(r)})))},getInstanceConfig:function(e,t){return t||(this.itemsInitialConfigs[e]||{})},createInstance:function(e,t){var r=this.findItem(e),n=this.getInstanceConfig(e,t);r||(r=this.getItemByType(n.typeName));var i=r.createInstance(n);return i.managerItemUId=e,i.editPageSchemaName=r.instance.editPageSchemaName,this.applyClientProperties(i),i},applyClientProperties:function(e){e instanceof Terrasoft.ProcessUserTaskSchema&&this.getIsEmailTemplateUserTask(e.managerItemUId)&&e.parameters.each((function(e){switch(e.name){case"BodyConfig":e.forceRemove=!0,e.skipValidation=!0;break;case"Body":e.skipValidation=!0}}),this)},getIsEmailTemplateUserTask:function(e){return"EmailTemplateUserTask"===this.items.filter((function(t){return t.uId===e})).first().name},clear:function(){var e=Terrasoft[this.userTaskSchemaManagerName],t=e.getItems();t.each((function(e){this.items.remove(e)}),this),e.clear(),this.callParent(arguments)}}),Ext.define("Terrasoft.manager.ProcessUnsupportedElementSchema",{extend:"Terrasoft.ProcessFlowElementSchema",alternateClassName:"Terrasoft.ProcessUnsupportedElementSchema",managerItemUId:"b49a4cc3-e725-4ef2-9263-73c5a6c15059",name:"UnsupportedElement",typeName:"Terrasoft.Core.Process.ProcessSchemaUnsupportedElement",nodeType:Terrasoft.diagram.UserHandlesConstraint.Event,width:31,height:31,emptyDiagramCaption:!1,captionWidth:80,color:"#92A4AF",caption:Terrasoft.Resources.ProcessSchemaDesigner.Elements.UnsupportedElement,editPageSchemaName:"ProcessUnsupportedElementPropertiesPage",titleImageName:"unsupportedElement_title.svg",isValid:!0,unsupportedType:"",getSerializableProperties:function(){var e=this.callParent(arguments);return Ext.Array.push(e,["unsupportedType"])}}),Ext.define("Terrasoft.manager.ProcessBoundaryEventSchema",{extend:"Terrasoft.ProcessUnsupportedElementSchema",alternateClassName:"Terrasoft.ProcessBoundaryEventSchema",managerItemUId:"bae0686d-ebe6-4f1c-bf7b-fa1aee7afccd",name:"BoundaryEventElement",typeName:"Terrasoft.Core.Process.ProcessSchemaBoundaryEvent",caption:Terrasoft.Resources.ProcessSchemaDesigner.Elements.BondaryEventCaption,editPageSchemaName:"ProcessBoundaryEventPropertiesPage",isValid:!0,attachedToElementUId:null,constructor:function(){this.callParent(arguments)},initializeProperties:function(){this.attachedToElementUId=this.containerUId},getSerializableProperties:function(){var e=this.callParent(arguments);return this.initializeProperties(),Ext.Array.push(e,["attachedToElementUId"])}}),Ext.define("Terrasoft.manager.ProcessUnsupportedTerminateEventSchema",{extend:"Terrasoft.ProcessUnsupportedElementSchema",alternateClassName:"Terrasoft.ProcessUnsupportedTerminateEventSchema",managerItemUId:"25fba723-099f-4b91-a491-641fd0741f08",name:"UnsupportedTerminateEvent",typeName:"Terrasoft.Core.Process.ProcessSchemaUnsupportedTerminateEvent"}),Ext.define("Terrasoft.core.ProcessFlowElementSchemaResponse",{alternateClassName:"Terrasoft.ProcessFlowElementSchemaResponse",extend:"Terrasoft.BaseSchemaResponse",schemaClassName:"Terrasoft.ProcessFlowElementSchema"}),Ext.define("Terrasoft.manager.ProcessSchemaMultiInstanceOptions",{extend:"Terrasoft.manager.MetaItem",alternateClassName:"Terrasoft.ProcessSchemaMultiInstanceOptions",executionMode:Terrasoft.process.enums.MultiInstanceExecutionMode.SEQUENTIAL,inputCollectionParameterUId:null,outputCollectionParameterUId:null,ignoreErrors:!1,completedIterationsCountParameterUId:null,terminatedIterationsCountParameterUId:null,totalIterationsCountParameterUId:null,getSerializableProperties:function(){var e=this.callParent(arguments);return Ext.Array.push(e,["executionMode","ignoreErrors","inputCollectionParameterUId","outputCollectionParameterUId","completedIterationsCountParameterUId","terminatedIterationsCountParameterUId","totalIterationsCountParameterUId"])}}),Ext.define("Terrasoft.manager.ProcessSchemaPerformerAssignmentOptions",{extend:"Terrasoft.manager.MetaItem",alternateClassName:"Terrasoft.ProcessSchemaPerformerAssignmentOptions",assignmentType:Terrasoft.process.enums.AssignmentType.USER,performerParameterUId:null,roleParameterUId:null,getSerializableProperties:function(){var e=this.callParent(arguments);return Ext.Array.push(e,["assignmentType","performerParameterUId","roleParameterUId"])}}),Ext.define("Terrasoft.manager.ProcessActivitySchema",{extend:"Terrasoft.manager.ProcessFlowElementSchema",alternateClassName:"Terrasoft.ProcessActivitySchema",mixins:{parametrizedProcessSchemaElement:"Terrasoft.ParametrizedProcessSchemaElement"},_parameterCaptionResources:{InputRecordCollection:"InputRecordCollection",OutputRecordCollection:"OutputRecordCollection",CompletedIterationsCount:"CompletedIterationsCountParameter",TerminatedIterationsCount:"TerminatedIterationsCountParameter",TotalIterationsCount:"TotalIterationsCountParameter",OwnerId:"OwnerId",RoleId:"RoleId"},contractName:"ContractProcessUserTaskSchema",isForCompensation:!1,isUserTask:!0,schemaFilter:null,schemaManagerName:null,silverlightOffsetX:0,silverlightOffsetY:0,width:69,height:55,entitySchemaUId:null,multiInstanceOptions:null,performerAssignmentOptions:null,constructor:function(e){this.callParent(arguments),this.mixins.parametrizedProcessSchemaElement.constructor.call(this),e&&e.multiInstanceOptions&&(this.multiInstanceOptions=Ext.create("Terrasoft.ProcessSchemaMultiInstanceOptions",e.multiInstanceOptions)),e&&e.performerAssignmentOptions&&(this.performerAssignmentOptions=Ext.create("Terrasoft.ProcessSchemaPerformerAssignmentOptions",e.performerAssignmentOptions)),this.schemaFilter={ManagerName:this.schemaManagerName,UseExtendParent:!1}},_createMultiInstanceParameter:function(e){var t=this.createParameter(e);return this._actualizeParameterCaption(t),t},_createInputRecordCollectionParameter:function(){return this._createMultiInstanceParameter({name:"InputRecordCollection",dataValueType:Terrasoft.DataValueType.COMPOSITE_OBJECT_LIST,direction:Terrasoft.ProcessSchemaParameterDirection.IN})},_createOutputRecordCollectionParameter:function(){return this._createMultiInstanceParameter({name:"OutputRecordCollection",dataValueType:Terrasoft.DataValueType.COMPOSITE_OBJECT_LIST,direction:Terrasoft.ProcessSchemaParameterDirection.OUT})},_createCompletedIterationsCountParameter:function(){return this._createMultiInstanceParameter({name:"CompletedIterationsCount",dataValueType:Terrasoft.DataValueType.INTEGER,direction:Terrasoft.ProcessSchemaParameterDirection.OUT})},_createTerminatedIterationsCountParameter:function(){return this._createMultiInstanceParameter({name:"TerminatedIterationsCount",dataValueType:Terrasoft.DataValueType.INTEGER,direction:Terrasoft.ProcessSchemaParameterDirection.OUT})},_createTotalIterationsCountParameter:function(){return this._createMultiInstanceParameter({name:"TotalIterationsCount",dataValueType:Terrasoft.DataValueType.INTEGER,direction:Terrasoft.ProcessSchemaParameterDirection.OUT})},_createRoleParameter:function(){var e=this.createParameter({name:"RoleId",dataValueType:Terrasoft.DataValueType.LOOKUP,referenceSchemaName:"SysAdminUnit",direction:Terrasoft.ProcessSchemaParameterDirection.VARIABLE});return this._actualizeParameterCaption(e),e},_createPerformerParameter:function(){var e=this.createParameter({name:"OwnerId",dataValueType:Terrasoft.DataValueType.LOOKUP,referenceSchemaName:"Contact",direction:Terrasoft.ProcessSchemaParameterDirection.VARIABLE,isPerformer:!0});return this._actualizeParameterCaption(e),e},_forceGetPerformerParameter:function(){if(this.performerAssignmentOptions.performerParameterUId)return this._getPerformerParameter();var e=this.findPerformerParameter();return e||(e=this._createPerformerParameter(),this.parameters.add(e.uId,e)),this.performerAssignmentOptions.performerParameterUId=e.uId,e},_forceGetRoleParameter:function(){if(this.performerAssignmentOptions.roleParameterUId)return this._getRoleParameter();var e=this.parameters,t=this._createRoleParameter();return e.add(t.uId,t),this.performerAssignmentOptions.roleParameterUId=t.uId,t},_getPerformerParameter:function(){var e=this.performerAssignmentOptions.performerParameterUId;return this.parameters.get(e)},_getRoleParameter:function(){var e=this.performerAssignmentOptions.roleParameterUId;return this.parameters.get(e)},_getInputCollectionParameter:function(){var e=this.multiInstanceOptions.inputCollectionParameterUId;return this.parameters.get(e)},_getOutputCollectionParameter:function(){var e=this.multiInstanceOptions.outputCollectionParameterUId;return this.parameters.get(e)},_getCompletedIterationsCountParameter:function(){var e=this.multiInstanceOptions.completedIterationsCountParameterUId;return this.parameters.get(e)},_getTerminatedIterationsCountParameter:function(){var e=this.multiInstanceOptions.terminatedIterationsCountParameterUId;return this.parameters.get(e)},_getTotalIterationsCountParameter:function(){var e=this.multiInstanceOptions.totalIterationsCountParameterUId;return this.parameters.get(e)},_fillCollectionParameters:function(e,t){var r=this.getRootParameters(),n=e.itemProperties,i=t.itemProperties,a=t.uId;r.each((function(e){if(e.direction===Terrasoft.process.enums.ProcessSchemaParameterDirection.VARIABLE){n.add(e.uId,e);var t=e.clone();t.uId=Terrasoft.xorToGUID(e.uId,a),t.clearSourceValue(),i.add(t.uId,t)}else e.direction===Terrasoft.process.enums.ProcessSchemaParameterDirection.OUT?i.add(e.uId,e):n.add(e.uId,e)})),r.clear(),r.add(e.uId,e),r.add(t.uId,t)},_fillIterationsCountParameters:function(e,t,r){var n=this.parameters;n.add(e.uId,e),n.add(t.uId,t),n.add(r.uId,r)},_convertToSingleInstanceElementParameters:function(){var e=this._getInputCollectionParameter(),t=this._getOutputCollectionParameter(),r=Ext.create("Terrasoft.ProcessSchemaParameterCollection");t.itemProperties.each((function(e){e.direction===Terrasoft.process.enums.ProcessSchemaParameterDirection.OUT&&r.add(e.uId,e)})),r.loadAll(e.itemProperties),this.parameters=r,e.itemProperties.clear(),t.itemProperties.clear()},_actualizeMultiInstanceParameters:function(){if(this.getIsMultiInstanceModeEnabled()){var e=[this._getInputCollectionParameter(),this._getOutputCollectionParameter(),this._getCompletedIterationsCountParameter(),this._getTerminatedIterationsCountParameter(),this._getTotalIterationsCountParameter()];Terrasoft.each(e,this._actualizeParameterCaption,this)}},_actualizePerformerAssignmentParameterCaptions:function(){if(this.performerAssignmentOptions){var e=[this._getPerformerParameter(),this._getRoleParameter()];Terrasoft.each(e,this._actualizeParameterCaption,this)}},_actualizeParameterCaption:function(e){if(e){var t=this._parameterCaptionResources[e.name],r=Terrasoft.Resources.ProcessSchemaDesigner,n=Terrasoft.findValueByPath(r,"".concat(t,".Caption"));e.caption.setValue(n)}},getSerializableObject:function(){this.callParent(arguments),this.mixins.parametrizedProcessSchemaElement.getSerializableObject.apply(this,arguments)},getSerializableProperties:function(){var e=this.callParent(arguments);return Ext.Array.push(e,["isUserTask","isForCompensation","entitySchemaUId","multiInstanceOptions","performerAssignmentOptions"])},createParameter:function(e){var t=_objectSpread(_objectSpread({},e),{},{uId:Terrasoft.generateGUID(),sourceValue:{source:Terrasoft.ProcessSchemaParameterValueSource.None,isValid:!0},createdInSchemaUId:this.parentSchema.uId,modifiedInSchemaUId:this.parentSchema.uId}),r=Ext.create("Terrasoft.ProcessSchemaParameter",t);return r.processFlowElementSchema=this,r},loadLocalizableValues:function(e){this.callParent(arguments),this.loadParametersLocalizableValues(e),this._actualizeMultiInstanceParameters(),this._actualizePerformerAssignmentParameterCaptions()},loadLocalizableValuesByUIds:function(e){this.callParent(arguments),this.loadParametersLocalizableValuesByUIds(e),this._actualizeMultiInstanceParameters(),this._actualizePerformerAssignmentParameterCaptions()},getLocalizableValues:function(e){this.callParent(arguments),this.getParametersLocalizableValues(e)},internalValidate:function(){var e=this.callParent(arguments),t=this.validateParameters.apply(this,arguments);return Ext.Array.push(e,t),e},getIsMultiInstanceModeEnabled:function(){return Boolean(this.multiInstanceOptions)},findParameterByNameOrByUId:function(e,t){return this.findParameterByName(e)||this.findParameterByUId(t)},convertToMultiInstance:function(){if(!this.getIsMultiInstanceModeEnabled()){var e=this._createInputRecordCollectionParameter(),t=this._createOutputRecordCollectionParameter(),r=this._createCompletedIterationsCountParameter(),n=this._createTerminatedIterationsCountParameter(),i=this._createTotalIterationsCountParameter();this._fillCollectionParameters(e,t),this._fillIterationsCountParameters(r,n,i),this.multiInstanceOptions=Ext.create("Terrasoft.ProcessSchemaMultiInstanceOptions",{inputCollectionParameterUId:e.uId,outputCollectionParameterUId:t.uId,completedIterationsCountParameterUId:r.uId,terminatedIterationsCountParameterUId:n.uId,totalIterationsCountParameterUId:i.uId});var a=this.getMarkersConfig();this.fireEvent("changed",{markers:a},this)}},changeMultiInstanceExecutionMode:function(e){var t=this.multiInstanceOptions;if(Boolean(t)&&t.executionMode!==e){t.executionMode=e;var r=this.getMarkersConfig();this.fireEvent("changed",{markers:r},this)}},getMarkersConfig:function(){return this.multiInstanceOptions?this.multiInstanceOptions.executionMode===Terrasoft.process.MultiInstanceExecutionMode.PARALLEL?{Loops:"ParallelMultiInstance"}:{Loops:"SequenceMultiInstance"}:{}},resetParameters:function(e,t){if(this.getIsMultiInstanceModeEnabled()){var r=this._getInputCollectionParameter(),n=this._getOutputCollectionParameter(),i=this._getCompletedIterationsCountParameter(),a=this._getTerminatedIterationsCountParameter(),s=this._getTotalIterationsCountParameter();this._convertToSingleInstanceElementParameters(),e.call(t),this._fillCollectionParameters(r,n),this._fillIterationsCountParameters(i,a,s)}else e.call(t)},convertToSingleInstance:function(){if(this.getIsMultiInstanceModeEnabled()){this._convertToSingleInstanceElementParameters(),this.multiInstanceOptions=null;this.fireEvent("changed",{markers:{}},this)}},getResultParameters:function(){if(!this.getIsMultiInstanceModeEnabled())return this.mixins.parametrizedProcessSchemaElement.getResultParameters.call(this);var e=this._getOutputCollectionParameter(),t=[this._getCompletedIterationsCountParameter(),this._getTerminatedIterationsCountParameter(),this._getTotalIterationsCountParameter()];return 0!==e.itemProperties.getCount()&&t.push(e),t},getEditableParameters:function(e){var t=this.mixins.parametrizedProcessSchemaElement.getEditableParameters.call(this);if(!this.getIsMultiInstanceModeEnabled())return t;var r=this._getInputCollectionParameter().uId;if(!e||!e.isExtendedMode)return t.filter((function(e){return e.uId===r}));var n=this._getOutputCollectionParameter();return 0===n.itemProperties.getCount()?t.filter((function(e){return e.uId!==n.uId})):t},setPerformerAssigmentOptions:function(e){this.performerAssignmentOptions||(this.performerAssignmentOptions=Ext.create("Terrasoft.ProcessSchemaPerformerAssignmentOptions")),this.performerAssignmentOptions.assignmentType=e.assignmentType;var t=this._forceGetPerformerParameter(),r=this._forceGetRoleParameter();if(e.assignmentType===Terrasoft.process.enums.AssignmentType.ROLE)return r.setMappingValue(e.assigneeValue),r.referenceSchemaName="SysAdminUnit",void t.clearSourceValue();t.setMappingValue(e.assigneeValue),t.referenceSchemaName="Contact",r.clearSourceValue()},findPerformerParameter:function(){return this.parameters.findByFn((function(e){return!0===e.isPerformer}),this)},getIsAssignmentOptionsParameter:function(e){var t=this.performerAssignmentOptions;return!!t&&(e===t.performerParameterUId||e===t.roleParameterUId)},clearDynamicParameter:function(e){this.getIsAssignmentOptionsParameter(e)||this.mixins.parametrizedProcessSchemaElement.clearDynamicParameter.apply(this,arguments)}}),Ext.define("Terrasoft.manager.ProcessUserTaskSchema",{extend:"Terrasoft.manager.ProcessActivitySchema",alternateClassName:"Terrasoft.ProcessUserTaskSchema",contractName:"ContractProcessUserTaskSchema",typeName:"Terrasoft.Core.Process.ProcessSchemaUserTask",portsSet:Terrasoft.diagram.enums.PortsSet.All,isUserTask:!0,metaData:null,fillColor:null,schemaUId:null,schema:null,afterActivitySaveScript:"",isCompilationRequired:!1,taskSchemaManagerName:"ProcessUserTaskSchemaManager",group:Terrasoft.FlowElementGroup.UserTask,smallImageName:"SmallSvgImage.svg",largeImageName:"LargeSvgImage.svg",titleImageName:"TitleSvgImage.svg",editPageSchemaName:"",elementManagerName:"ProcessFlowElementSchemaManager",constructor:function(){this.schemaManagerName=this.taskSchemaManagerName,this.callParent(arguments)},getImageConfig:function(e){return{source:Terrasoft.ImageSources.PROCESS_USERTASK_SCHEMA,params:{schemaName:this.findSchemaName(),resourceItemName:e}}},initEvents:function(){this.on("changed",this.onChanged,this)},onChanged:function(e){if(e.hasOwnProperty("afterActivitySaveScript")||e.hasOwnProperty("realName")&&!Ext.isEmpty(this.afterActivitySaveScript)){var t=this.parentSchema,r=Terrasoft.process.constants.ITEM_CHANGE_ACTION;this.isCompilationRequired=!0,t.addSchemaChangedItem(this.uId,this.getDisplayValue(),r.MODIFY)}},findSchemaName:function(){var e=this.managerItemUId||this.uId;return Terrasoft[this.elementManagerName].findItem(e).name},getEditPageSchemaName:function(e,t){!this.editPageSchemaName&&this.schema?this.schema.getEditPageSchemaName((function(r){this.editPageSchemaName=r,e.call(t,this.editPageSchemaName)}),this):(this.editPageSchemaName=this.editPageSchemaName||Terrasoft.process.constants.DEFAULT_EDIT_PAGE_SCHEMA_NAME,e.call(t,this.editPageSchemaName))},getSerializableProperties:function(){var e=this.callParent(arguments);return Ext.Array.push(e,["schemaUId","taskSchemaManagerName","afterActivitySaveScript"])},requireCompilation:function(){return!0===this.isCompilationRequired},setSchema:function(e){this.schema=e,this.name=this.name||e.name,this.managerItemUId=this.schemaUId=e.uId,this.uId=this.uId||this.managerItemUId,this.caption.merge(e.caption),this.typeCaption=this.getTypeCaption(),this.description.merge(e.description),this.serializeToDB=this.serializeToDB||e.serializeToDB,this.isUserTask=e.isUserTask,this.editPageSchemaName=e.editPageSchemaName,this.color=e.color,this.usageType=e.usageType}}),Ext.define("Terrasoft.manager.ProcessUserTaskSchemaManagerItem",{extend:"Terrasoft.ProcessFlowElementSchemaManagerItem",alternateClassName:"Terrasoft.ProcessUserTaskSchemaManagerItem",instanceClassName:"Terrasoft.ProcessUserTaskSchema",requestClassName:"Terrasoft.ProcessUserTaskSchemaRequest",createInstance:function(){var e=this.callParent(arguments);return this.instance&&this.instance.schema&&e.setSchema(this.instance.schema),e},forceGetInstance:function(e,t,r){this.getInstanceRequest(r).execute((function(r){var n=r&&r.success&&r.schemas[0];e.call(t,n)}),t)}}),Ext.define("Terrasoft.manager.BaseUserTaskSchemaManager",{extend:"Terrasoft.BaseSchemaManager",alternateClassName:"Terrasoft.BaseUserTaskSchemaManager",itemClassName:"Terrasoft.ProcessUserTaskSchemaManagerItem",managerName:"ProcessUserTaskSchemaManager",requestClassName:"Terrasoft.ProcessUserTaskSchemaRequest",resetRequestClassName:"Terrasoft.ProcessUserTaskSchemaResetRequest",resetAllRequestClassName:"Terrasoft.ProcessUserTaskSchemaResetAllRequest",schemaClassName:null,getSchemasQuery:function(e){return Ext.create(this.requestClassName,{itemsData:e})},getResetQueryItemsData:function(){var e=[];return this.isInitialized&&this.items.each((function(t){e.push({uId:t.uId})}),this),e},getResetQuery:function(){if(!this.isInitialized)return Ext.create(this.resetAllRequestClassName);var e=this.getResetQueryItemsData();return Ext.create(this.resetRequestClassName,{itemsData:e})},initializeItems:function(e,t){var r=[],n=this.items;n.each((function(e){r.push({uId:e.uId})}),this),this.getSchemasQuery(r).execute((function(r){r.schemas.forEach((function(e){var t=n.get(e.uId);this.createInstance(t,e)}),this),e.call(t)}),this)},initialize:function(e,t){var r=this.isInitialized;this.callParent([function(){r?e.call(t):this.initializeItems((function(){e.call(t)}),this)},this])},forceGetInstanceByUId:function(e,t,r){var n=this.items.find(e);n||(n=this.createManagerItem({uId:e}),this.addItem(n)),n.forceGetInstance((function(e){var i=e&&this.createInstance(n,e);t.call(r,i&&i.schema)}),this,{itemsData:[{uId:e}]})},createInstance:function(e,t){var r=Terrasoft.SchemaDesignerUtilities.createInstanceByMetaData({metaData:t.metaData,schemaClassName:this.schemaClassName,resources:t.resources}),n=e.createInstance();return n.setSchema(r),e.setInstance(n),n},clear:function(){this.callParent(arguments),this.isInitialized=!1},reset:function(e,t){var r=this.isInitialized,n=this.getResetQuery(),i=this.getSafeCallback(e,t);n.execute((function(e){if(!e||!e.success)throw new Terrasoft.InvalidOperationException({message:e.errorInfo.toString()});r?(this.clear(),this.initialize(i)):i()}),this)}}),Ext.define("Terrasoft.manager.ProcessUserTaskSchemaManager",{extend:"Terrasoft.BaseUserTaskSchemaManager",alternateClassName:"Terrasoft.ProcessUserTaskSchemaManager",singleton:!0,schemaClassName:"Terrasoft.UserTaskSchema",getSelectQuery:function(){var e=this.callParent(arguments),t=Terrasoft.createExistsFilter("[SysProcessUserTask:SysUserTaskSchemaUId:UId].Id");return e.filters.addItem(t),e}}),Ext.define("Terrasoft.core.ProcessUserTaskSchemaResponse",{alternateClassName:"Terrasoft.ProcessUserTaskSchemaResponse",extend:"Terrasoft.BaseSchemaResponse",schemaClassName:"Terrasoft.UserTaskSchema",schemas:null}),Ext.define("Terrasoft.manager.ProcessSubprocessSchema",{extend:"Terrasoft.manager.ProcessActivitySchema",alternateClassName:"Terrasoft.ProcessSubprocessSchema",managerItemUId:"49eafdbb-a89e-4bdf-a29d-7f17b1670a45",width:69,height:55,silverlightOffsetX:0,silverlightOffsetY:0,caption:Terrasoft.Resources.ProcessSchemaDesigner.Elements.SubprocessCaption,group:Terrasoft.FlowElementGroup.Subprocess,name:"SubProcess",typeName:"Terrasoft.Core.Process.ProcessSchemaSubProcess",smallImageName:"CallActivitySmall.svg",largeImageName:"CallActivityLarge.svg",titleImageName:"subprocess_title.svg",color:"#E6C600",editPageSchemaName:"SubProcessPropertiesPage",portsSet:Terrasoft.diagram.enums.PortsSet.All,schemaUId:Terrasoft.GUID_EMPTY,schemaManagerName:"ProcessSchemaManager",flowElements:null,artifacts:null,useLastSchemaVersion:!1,isContainer:!0,nodeType:Terrasoft.diagram.UserHandlesConstraint.Subprocess,triggeredByEvent:!1,constructor:function(){this.callParent(arguments),this.initFlowElements()},initFlowElements:function(){var e=this.flowElements||[],t=this.parentSchema;t&&e.forEach((function(e){(e=Terrasoft.deepClone(e)).parentSchema=t;var r=t.createItemInstance(e);r.containerUId=this.uId,r.parent=this.name,r.visible=this.isExpanded,t.flowElements.add(r.name,r)}),this)},getSerializableProperties:function(){var e=this.callParent(arguments);return Ext.Array.push(e,["triggeredByEvent","schemaUId","useLastSchemaVersion","artifacts"])},getDiagramConfig:function(){var e=this.callParent(arguments);return e.isExpanded=this.isExpanded,e.isContainer=this.isContainer,e},getIsMultiInstanceSupported:function(){return Terrasoft.Features.getIsEnabled("UseMultiInstanceSubProcess")&&!this.parentSchema.useForceCompile},createElementParameter:function(e){var t=this.callParent(arguments);return t.clearSourceValue(),t}}),Ext.define("Terrasoft.manager.ProcessEventSubprocessSchema",{extend:"Terrasoft.manager.ProcessSubprocessSchema",alternateClassName:"Terrasoft.ProcessEventSubprocessSchema",managerItemUId:"0824af03-1340-47a3-8787-ef542f566992",typeName:"Terrasoft.Core.Process.ProcessSchemaEventSubProcess",editPageSchemaName:"EventSubProcessPropertiesPage",triggeredByEvent:!1,name:"EventSubProcess",smallImageName:"EventSubProcessExpandedSmall.svg",largeImageName:"event_subprocess_large.svg",titleImageName:"event_subprocess_title.svg",caption:Terrasoft.Resources.ProcessSchemaDesigner.Elements.EventSubprocessCaption,incomingConnectionsLimit:0,outgoingConnectionsLimit:0,defaultExpandedWidth:300,defaultExpandedHeight:300,toolsConstraint:Terrasoft.diagram.ToolsConstraint.NodeRemoveTool,isExpanded:!0,borderWidth:1,borderColor:"#E6C600",fillColor:"rgba(255, 255, 255, 0.5)",borderDashArray:"4 4",hint:Terrasoft.Resources.ProcessSchemaDesigner.Elements.EventSubprocessHint,supportEmbeddedProcess:!0,hasEmbeddedLabel:!0,constructor:function(){this.callParent(arguments),this.isExpanded=!0;var e=this.size;this.width=e.width,this.height=e.height},_setSerializableFlowElements:function(e){var t=this.parentSchema.flowElements;t&&!t.isEmpty()&&(e.flowElements=[],t.each((function(t){if(t.containerUId===this.uId){var r=this.getSerializableProperty(t);e.flowElements.push(r)}}),this))},getSerializableObject:function(e){this.callParent(arguments),this._setSerializableFlowElements(e)},initSize:function(){var e=this.callParent(arguments);return this.isExpanded=!0,e.width=this.defaultExpandedWidth,e.height=this.defaultExpandedHeight,e},getLargeImage:function(){return null},getDragImage:function(){return this.getImageConfig(this.largeImageName)},getShape:function(){var e=this.callParent(arguments);return Ext.apply(e,{cornerRadius:10}),e},getDiagramConfig:function(){var e=this.callParent(arguments),t={borderWidth:this.borderWidth,borderColor:this.borderColor,borderDashArray:this.borderDashArray,fillColor:this.fillColor,constraints:ej.Diagram.NodeConstraints.Select|ej.Diagram.NodeConstraints.Drag|ej.Diagram.NodeConstraints.Delete|ej.Diagram.NodeConstraints.Resize|ej.Diagram.NodeConstraints.ResizeNorthEast|ej.Diagram.NodeConstraints.ResizeEast|ej.Diagram.NodeConstraints.ResizeSouthEast|ej.Diagram.NodeConstraints.ResizeSouth|ej.Diagram.NodeConstraints.ResizeSouthWest|ej.Diagram.NodeConstraints.ResizeWest|ej.Diagram.NodeConstraints.ResizeNorthWest|ej.Diagram.NodeConstraints.ResizeNorth};return Ext.apply(e,t),e},getSerializableProperties:function(){var e=this.callParent(arguments);return Ext.Array.push(e,["isExpanded"])},getUIJsonData:function(){var e={};this.getSerializableObject(e);var t=this.callParent(arguments);return Ext.apply(t,{Size:e.size,IsExpanded:e.isExpanded})}}),Ext.define("Terrasoft.manager.ProcessWebServiceSchema",{extend:"Terrasoft.manager.ProcessActivitySchema",alternateClassName:"Terrasoft.ProcessWebServiceSchema",_resultParametersMetaData:null,managerItemUId:"652b598d-cdd5-49d5-a86d-aafac88213f3",caption:Terrasoft.Resources.ProcessSchemaDesigner.Elements.WebServiceCaption,group:Terrasoft.FlowElementGroup.ServiceTask,name:"WebService",isUserTask:!1,typeName:"Terrasoft.Core.Process.ProcessSchemaWebService",smallImageName:"WebServiceSmall.svg",largeImageName:"WebServiceLarge.svg",titleImageName:"webService_title.svg",color:"#839DC3",editPageSchemaName:"WebServiceUserTaskPropertiesPage",portsSet:Terrasoft.diagram.enums.PortsSet.All,serviceSchemaUId:Terrasoft.GUID_EMPTY,methodName:null,serializeToDB:!0,isLogging:!0,timeout:0,constructor:function(){this._initResultParametersMetaData(),this.parameters=this._resultParametersMetaData,this.callParent(arguments)},_initResultParametersMetaData:function(){var e=Terrasoft.Resources.ProcessSchemaDesigner.Parameters,t=Terrasoft.process.enums.ProcessSchemaParameterDirection;this._resultParametersMetaData=[{uId:Terrasoft.generateGUID(),name:"Success",caption:new Terrasoft.LocalizableString(e.Success),dataValueType:Terrasoft.DataValueType.BOOLEAN,direction:t.OUT},{uId:Terrasoft.generateGUID(),name:"Response",caption:new Terrasoft.LocalizableString(e.Response),dataValueType:Terrasoft.DataValueType.TEXT,direction:t.OUT},{uId:Terrasoft.generateGUID(),name:"StatusCode",caption:new Terrasoft.LocalizableString(e.StatusCode),dataValueType:Terrasoft.DataValueType.INTEGER,direction:t.OUT},{uId:Terrasoft.generateGUID(),name:"RequestBody",caption:new Terrasoft.LocalizableString(e.RequestBody),dataValueType:Terrasoft.DataValueType.TEXT,direction:t.IN}]},_getParameterName:function(e,t){return e.name+(t===Terrasoft.ProcessSchemaParameterDirection.IN?"_In":"_Out")},_filterMethodParametersByCaption:function(e,t){var r=new Terrasoft.Collection;return r.loadAll(e.request.parameters),r.loadAll(e.response.parameters),r.filterByFn((function(e){return e.caption.toString()===t}))},_getParameterCaption:function(e,t,r){var n=e.caption.clone(),i=Terrasoft.Resources.ProcessSchemaDesigner.Parameters,a=this._filterMethodParametersByCaption(r,n.toString()),s=t===Terrasoft.ProcessSchemaParameterDirection.IN?" - "+i.Input:" - "+i.Output;return a.getCount()>1&&Terrasoft.each(n.cultureValues,(function(e,t){n.setCultureValue(t,e+s)})),n},_getParameterDataValueType:function(e){var t=Terrasoft.ServerDataValueTypeName[e.dataValueTypeName];return(Ext.isEmpty(t)||t===Terrasoft.DataValueType.TEXT)&&(t=Terrasoft.DataValueType.MAXSIZE_TEXT),e.isArray&&(t=e.dataValueTypeName!==Terrasoft.services.enums.DataValueTypeName.Object?Terrasoft.DataValueType.OBJECT_LIST:Terrasoft.DataValueType.COMPOSITE_OBJECT_LIST),t},_isParameterRequired:function(e,t){return(!e.isArray||"Object"===e.dataValueTypeName)&&(e.isRequired&&t===Terrasoft.ProcessSchemaParameterDirection.IN)},_getItemProperties:function(e,t,r,n){var i=[];if(Terrasoft.Features.getIsEnabled("ProcessParameterCollections")||Terrasoft.isDebug)if(e.isArray&&e.dataValueTypeName!==Terrasoft.services.enums.DataValueTypeName.Object){var a=Ext.merge({},e,{isArray:!1,name:e.name+"ItemValue",caption:new Terrasoft.LocalizableString(Terrasoft.Resources.ProcessSchemaDesigner.Parameters.DefaultNestedParameterCaption)});i.push(this._getParameterConfig(t,a,r,n))}else e.itemProperties&&e.itemProperties.each((function(e){i.push(this._getParameterConfig(t,e,r,n))}),this);return i},_getParameterConfig:function(e,t,r,n){return{uId:Terrasoft.generateGUID(),createdInSchemaUId:this.createdInSchemaUId,modifiedInSchemaUId:this.createdInSchemaUId,containerUId:this.uId,tag:t.name,itemProperties:this._getItemProperties(t,e,r,n),dataValueType:this._getParameterDataValueType(t),sourceValue:{source:Terrasoft.ProcessSchemaParameterValueSource.None},processFlowElementSchema:this,isRequired:this._isParameterRequired(t,r),name:this._getParameterName(t,r),direction:r,caption:this._getParameterCaption(t,r,n)}},_findNestedParameterByName:function(e,t){return e.findByFn((function(e){return e.name===t}),this)},_synchronizeNestedParameters:function(e,t,r){var n=[];t.each((function(t){var i=this._findNestedParameterByName(e,t.name);i?this._updateOldParameter(i,t,n,r):(e.add(t.uId,t),n.push(t.uId))}),this),this._removeNotActualParameters(e,n)},_updateOldParameter:function(e,t,r,n){this._synchronizeNestedParameters(e.itemProperties,t.itemProperties,n),r.push(e.uId),e.dataValueType=t.dataValueType,e.isRequired=t.isRequired,e.caption=t.caption},_synchronizeParameters:function(e,t,r,n,i){t.each((function(t){var a=this.findParameterByName(this._getParameterName(t,r)),s=this._getParameterConfig(e,t,r,n),o=new Terrasoft.ProcessSchemaParameter(s);a?this._updateOldParameter(a,o,i,r):(this.parameters.add(o.uId,o),i.push(o.uId))}),this)},_synchronizeResultParameters:function(){_.each(this._resultParametersMetaData,(function(e){var t=new Terrasoft.DynamicProcessSchemaParameter(e);this.synchronizeDynamicParameter(t)}),this)},_removeNotActualParameters:function(e,t){(Terrasoft.isInstanceOfClass(e,"Terrasoft.ProcessSchemaParameterCollection")?e.getRoots():e).each((function(r){Boolean(r.tag)&&!Ext.Array.contains(t,r.uId)&&e.remove(r)}),this)},getSerializableProperties:function(){var e=this.callParent(arguments);return Ext.Array.push(e,["serviceSchemaUId","methodName","timeout"])},synchronizeParameters:function(e){if(this.getCanSynchronizeParameters(e)){var t=this.methodName&&e.findMethodByName(this.methodName);if(Ext.isEmpty(t))this.clearParameters();else{var r=[];this._synchronizeParameters(e.uId,t.request.parameters,Terrasoft.ProcessSchemaParameterDirection.IN,t,r),this._synchronizeParameters(e.uId,t.response.parameters,Terrasoft.ProcessSchemaParameterDirection.OUT,t,r),this._removeNotActualParameters(this.parameters,r),this._synchronizeResultParameters()}}},getEditableParameters:function(e){var t=this.callParent(arguments);return e&&!e.isExtendedMode?t.filter((function(e){return"RequestBody"!==e.name})):t}}),Terrasoft.each(["methodName","serviceSchemaUId"],(function(e){var t=Ext.String.capitalize(e);Object.defineProperty(Terrasoft.ProcessWebServiceSchema.prototype,t,{get:function(){return this.getPropertyValue(e)},set:function(t){this.setPropertyValue(e,t)}})}),null),Ext.define("Terrasoft.manager.ProcessSchemaUserTask",{extend:"Terrasoft.ProcessActivitySchema",alternateClassName:"Terrasoft.ProcessSchemaUserTask",managerItemUId:"1418e61a-82c3-403e-8221-01088f52c125",group:Terrasoft.FlowElementGroup.ServiceTask,editPageSchemaName:"UserTaskPropertiesPage",typeName:"Terrasoft.Core.Process.ProcessSchemaUserTask",caption:Terrasoft.Resources.ProcessSchemaDesigner.Elements.UserTaskCaption,fillColor:null,schemaUId:Terrasoft.GUID_EMPTY,name:"UserTask",taskSchemaManagerName:"ProcessUserTaskSchemaManager",afterActivitySaveScript:"",isCompilationRequired:!1,supportEmbeddedProcess:!0,constructor:function(){this.schemaManagerName=this.taskSchemaManagerName,this.callParent(arguments)},initEvents:function(){this.on("changed",this.onChanged,this)},onChanged:function(e){if(e.hasOwnProperty("afterActivitySaveScript")||e.hasOwnProperty("realName")&&!Ext.isEmpty(this.afterActivitySaveScript)){var t=this.parentSchema,r=Terrasoft.process.constants.ITEM_CHANGE_ACTION;this.isCompilationRequired=!0,t.addSchemaChangedItem(this.uId,this.getDisplayValue(),r.MODIFY)}},requireCompilation:function(){return!0===this.isCompilationRequired},getSerializableProperties:function(){var e=this.callParent(arguments);return Ext.Array.push(e,["fillColor","schemaUId","taskSchemaManagerName","afterActivitySaveScript"])}}),Ext.define("Terrasoft.manager.ProcessScriptTaskSchema",{extend:"Terrasoft.ProcessActivitySchema",alternateClassName:"Terrasoft.ProcessScriptTaskSchema",managerItemUId:"0e490dda-e140-4441-b600-6f5c64d024df",typeName:"Terrasoft.Core.Process.ProcessSchemaScriptTask",caption:Terrasoft.Resources.ProcessSchemaDesigner.Elements.ScriptTaskCaption,name:"ScriptTask",isUserTask:!1,group:Terrasoft.FlowElementGroup.ServiceTask,smallImageName:"ScriptTaskSmall.svg",largeImageName:"ScriptTaskLarge.svg",titleImageName:"scriptTask_title.svg",portsSet:Terrasoft.diagram.enums.PortsSet.All,fillColor:null,body:"return true;",preventShowPropertiesWindowOnAdding:!0,useFlowEngineScriptVersion:!1,editPageSchemaName:"ScriptTaskPropertiesPage",supportEmbeddedProcess:!0,initEvents:function(){this.on("changed",this.onScriptTaskChanged,this)},onScriptTaskChanged:function(e){var t=this.parentSchema,r=Terrasoft.process.constants.ITEM_CHANGE_ACTION;(e.hasOwnProperty("body")||e.hasOwnProperty("realName"))&&t.addSchemaChangedItem(this.uId,this.getDisplayValue(),r.MODIFY)},getSerializableProperties:function(){var e=this.callParent(arguments);return Ext.Array.push(e,["body","fillColor","useFlowEngineScriptVersion"])},requireCompilation:function(){return!0}}),Ext.define("Terrasoft.manager.ProcessFormulaTaskSchema",{extend:"Terrasoft.ProcessScriptTaskSchema",alternateClassName:"Terrasoft.ProcessFormulaTaskSchema",managerItemUId:"d334d28f-b11a-477e-9ff0-0a95fa73d53b",typeName:"Terrasoft.Core.Process.ProcessSchemaFormulaTask",caption:Terrasoft.Resources.ProcessSchemaDesigner.Elements.FormulaTaskCaption,name:"FormulaTask",smallImageName:"FormulaTaskSmall.svg",largeImageName:"FormulaTaskLarge.svg",titleImageName:"formulaTask_title.svg",editPageSchemaName:"FormulaTaskPropertiesPage",body:"",resultParameterMetaPath:"",preventShowPropertiesWindowOnAdding:!1,onScriptTaskChanged:Terrasoft.emptyFn,getSerializableProperties:function(){var e=this.callParent(arguments);return Ext.Array.push(e,["resultParameterMetaPath"])},requireCompilation:function(){return!1},getValue:function(){return this.body}}),Ext.define("Terrasoft.manager.ProcessBaseEventSchema",{extend:"Terrasoft.ProcessFlowElementSchema",alternateClassName:"Terrasoft.ProcessBaseEventSchema",mixins:{parametrizedProcessSchemaElement:"Terrasoft.ParametrizedProcessSchemaElement"},nodeType:Terrasoft.diagram.UserHandlesConstraint.Event,width:31,height:31,silverlightOffsetX:0,silverlightOffsetY:0,emptyDiagramCaption:!0,captionWidth:80,color:"#F79552",editPageSchemaName:"ProcessBaseEventPropertiesPage",entitySchemaUId:null,constructor:function(){this.callParent(arguments),this.mixins.parametrizedProcessSchemaElement.constructor.call(this)},getShape:function(){return{type:ej.Diagram.Shapes.Ellipse}},getConnectionUserHandles:function(){return["SequenceFlow"]},getSerializableObject:function(){this.callParent(arguments),this.mixins.parametrizedProcessSchemaElement.getSerializableObject.apply(this,arguments)},getSerializableProperties:function(){var e=this.callParent(arguments);return Ext.Array.push(e,["entitySchemaUId"])},loadLocalizableValues:function(e){this.callParent(arguments),this.mixins.parametrizedProcessSchemaElement.loadParametersLocalizableValues.call(this,e)},loadLocalizableValuesByUIds:function(e){this.callParent(arguments),this.mixins.parametrizedProcessSchemaElement.loadParametersLocalizableValuesByUIds.call(this,e)},getLocalizableValues:function(e){this.callParent(arguments),this.mixins.parametrizedProcessSchemaElement.getParametersLocalizableValues.call(this,e)},internalValidate:function(){var e=this.callParent(arguments),t=this.mixins.parametrizedProcessSchemaElement.validateParameters.apply(this,arguments);return Ext.Array.push(e,t),e}}),Ext.define("Terrasoft.manager.ProcessTerminateEventSchema",{extend:"Terrasoft.ProcessBaseEventSchema",alternateClassName:"Terrasoft.ProcessTerminateEventSchema",managerItemUId:"1bd93619-0574-454e-bb4e-cf53b9eb9470",typeName:"Terrasoft.Core.Process.ProcessSchemaTerminateEvent",caption:Terrasoft.Resources.ProcessSchemaDesigner.Elements.TerminateEventCaption,group:Terrasoft.FlowElementGroup.EndEvent,name:"TerminateEvent",smallImageName:"EndEventTerminateSmall.svg",largeImageName:"EndEventTerminateLarge.svg",titleImageName:"terminateEvent_title.svg",color:"#FF9685",editPageSchemaName:"ProcessTerminateEventPropertiesPage",outgoingConnectionsLimit:0,hint:Terrasoft.Resources.ProcessSchemaDesigner.Elements.TerminateEventHint,supportEmbeddedProcess:!0,getConnectionUserHandles:function(){return[]}}),Ext.define("Terrasoft.manager.ProcessEndEventSchema",{extend:"Terrasoft.ProcessTerminateEventSchema",alternateClassName:"Terrasoft.ProcessEndEventSchema",managerItemUId:"45ceaae2-4e1f-4c0c-86aa-cd4aeb4da913",typeName:"Terrasoft.Core.Process.ProcessSchemaEndEvent",isDeprecated:!0}),Ext.define("Terrasoft.manager.ProcessStartEventSchema",{extend:"Terrasoft.ProcessBaseEventSchema",alternateClassName:"Terrasoft.ProcessStartEventSchema",managerItemUId:"53818048-7868-48f6-ada0-0ebaa65af628",typeName:"Terrasoft.Core.Process.ProcessSchemaStartEvent",isInterrupting:!0,caption:Terrasoft.Resources.ProcessSchemaDesigner.Elements.StartEventCaption,group:Terrasoft.FlowElementGroup.StartEvent,name:"StartEvent",smallImageName:"StartEventSmall.svg",largeImageName:"StartEventLarge.svg",titleImageName:"startEvent_large.svg",color:"#8ECB60",incomingConnectionsLimit:0,editPageSchemaName:"ProcessStartEventPropertiesPage",hint:Terrasoft.Resources.ProcessSchemaDesigner.Elements.StartEventHint,getSerializableProperties:function(){var e=this.callParent(arguments);return Ext.Array.push(e,["isInterrupting"])}}),Ext.define("Terrasoft.manager.ProcessStartMessageSchema",{extend:"Terrasoft.ProcessBaseEventSchema",alternateClassName:"Terrasoft.ProcessStartMessageSchema",managerItemUId:"02340c80-8e75-4f7a-917b-04125bc07192",typeName:"Terrasoft.Core.Process.ProcessSchemaStartMessageEvent",caption:Terrasoft.Resources.ProcessSchemaDesigner.Elements.StartMessageCaption,group:Terrasoft.FlowElementGroup.StartEvent,name:"StartMessage",smallImageName:"StartEventMessageSmall.svg",largeImageName:"StartEventMessageLarge.svg",titleImageName:"startMessage_large.svg",color:"#8ECB60",isInterrupting:!0,message:null,emptyDiagramCaption:!1,editPageSchemaName:"StartMessageEventPropertiesPage",supportEmbeddedProcess:!0,getSerializableProperties:function(){var e=this.callParent(arguments);return Ext.Array.push(e,["message"])}}),Ext.define("Terrasoft.manager.ProcessStartMessageNonInterruptingSchema",{extend:"Terrasoft.ProcessStartMessageSchema",alternateClassName:"Terrasoft.ProcessStartMessageNonInterruptingSchema",managerItemUId:"429178f5-d44a-40d6-8b74-e72cad04ee73",smallImageName:"StartEventMessageNonInterruptingSmall.svg",largeImageName:"StartEventMessageNonInterruptingLarge.svg"}),Ext.define("Terrasoft.manager.ProcessStartSignalSchema",{extend:"Terrasoft.ProcessBaseEventSchema",alternateClassName:"Terrasoft.ProcessStartSignalSchema",managerItemUId:"1129e72f-0e8c-445a-b2ea-463517e86395",caption:Terrasoft.Resources.ProcessSchemaDesigner.Elements.StartSignalCaption,typeName:"Terrasoft.Core.Process.ProcessSchemaStartSignalEvent",group:Terrasoft.FlowElementGroup.StartEvent,name:"StartSignal",smallImageName:"StartEventSignalSmall.svg",largeImageName:"StartEventSignalLarge.svg",titleImageName:"startSignal_large.svg",color:"#8ECB60",isInterrupting:!0,signal:null,waitingRandomSignal:!0,waitingEntitySignal:!1,entitySignal:Terrasoft.EntityChangeType.None,entity:null,hasEntityColumnChange:!1,newEntityChangedColumns:null,hasEntityFilters:!1,entityFilters:null,editPageSchemaName:"StartSignalPropertiesPage",emptyDiagramCaption:!1,constructor:function(){var e=Terrasoft.Resources.ProcessSchemaDesigner.Parameters;this.parameters=[{uId:Terrasoft.generateGUID(),name:"RecordId",caption:new Terrasoft.LocalizableString(e.RecordIdCaption),dataValueType:Terrasoft.DataValueType.GUID,sourceValue:{value:"",source:Terrasoft.ProcessSchemaParameterValueSource.ConstValue,displayValue:new Terrasoft.LocalizableString("")}}],this.callParent(arguments),this.newEntityChangedColumns=this.decodeNewEntityChangedColumns(this.newEntityChangedColumns)},decodeNewEntityChangedColumns:function(e){var t=[];if(Ext.isEmpty(e))return t;var r=Terrasoft.decode(e);return Ext.isArray(r)?r:(Terrasoft.each(r,(function(e,r){if("$values"===r&&Ext.isArray(e))return t=e,!0})),t)},stringifyNewEntityChangedColumns:function(e){e.newEntityChangedColumns=JSON.stringify(this.newEntityChangedColumns)},getSerializableObject:function(e){this.callParent(arguments),this.stringifyNewEntityChangedColumns(e)},getSerializableProperties:function(){var e=this.callParent(arguments);return Ext.Array.push(e,["signal","entity","entitySignal","waitingRandomSignal","waitingEntitySignal","hasEntityColumnChange","hasEntityFilters","entityFilters"])}}),Ext.define("Terrasoft.manager.ProcessStartSignalNonInterruptingSchema",{extend:"Terrasoft.ProcessStartSignalSchema",alternateClassName:"Terrasoft.ProcessStartSignalNonInterruptingSchema",managerItemUId:"61064127-a9ee-455a-adfd-665093be2e23",smallImageName:"StartEventSignalNonInterruptingSmall.svg",largeImageName:"StartEventSignalNonInterruptingLarge.svg"}),Ext.define("Terrasoft.manager.ProcessIntermediateCatchMessageSchema",{extend:"Terrasoft.ProcessBaseEventSchema",alternateClassName:"Terrasoft.ProcessIntermediateCatchMessageSchema",managerItemUId:"3cb9d737-779e-4085-ab4b-db590853e266",caption:Terrasoft.Resources.ProcessSchemaDesigner.Elements.IntermediateCatchMessageCaption,typeName:"Terrasoft.Core.Process.ProcessSchemaIntermediateCatchMessageEvent",group:Terrasoft.FlowElementGroup.IntermediateEvent,name:"IntermediateCatchMessage",smallImageName:"IntermediateEventCatchingMessageSmall.svg",largeImageName:"IntermediateEventCatchingMessageLarge.svg",titleImageName:"intermediateCatchMessage_title.svg",cancelActivity:!1,boundaryItemAlignment:null,message:null,editPageSchemaName:"IntermediateCatchMessagePropertiesPage",emptyDiagramCaption:!1,supportEmbeddedProcess:!0,getSerializableProperties:function(){var e=this.callParent(arguments);return Ext.Array.push(e,["message"])}}),Ext.define("Terrasoft.manager.ProcessIntermediateCatchSignalSchema",{extend:"Terrasoft.ProcessBaseEventSchema",alternateClassName:"Terrasoft.ProcessIntermediateCatchSignalSchema",managerItemUId:"5ccad23d-fc4b-4ec7-8051-e3a825b698fc",caption:Terrasoft.Resources.ProcessSchemaDesigner.Elements.IntermediateCatchSignalCaption,group:Terrasoft.FlowElementGroup.IntermediateEvent,name:"IntermediateCatchSignal",typeName:"Terrasoft.Core.Process.ProcessSchemaIntermediateCatchSignalEvent",smallImageName:"IntermediateEventCatchingSignalSmall.svg",largeImageName:"IntermediateEventCatchingSignalLarge.svg",titleImageName:"intermediateCatchSignal_title.svg",cancelActivity:!0,boundaryItemAlignment:null,signal:null,waitingRandomSignal:!0,waitingEntitySignal:!1,hasEntityFilters:!1,entitySignal:Terrasoft.EntityChangeType.None,entity:null,hasEntityColumnChange:!1,newEntityChangedColumns:null,entityFilters:null,editPageSchemaName:"IntermediateCatchSignalPropertiesPage",emptyDiagramCaption:!1,supportEmbeddedProcess:!0,constructor:function(){this.parameters=[{uId:Terrasoft.generateGUID(),name:"RecordId",dataValueType:Terrasoft.DataValueType.GUID,sourceValue:{value:"",source:Terrasoft.ProcessSchemaParameterValueSource.ConstValue,displayValue:Ext.create("Terrasoft.LocalizableString",{cultureValues:""})}}],this.callParent(arguments),this.newEntityChangedColumns=this.decodeNewEntityChangedColumns(this.newEntityChangedColumns)},decodeNewEntityChangedColumns:function(e){var t=[];if(Ext.isEmpty(e))return t;var r=Terrasoft.decode(e);return Ext.isArray(r)?r:(Terrasoft.each(r,(function(e,r){if("$values"===r&&Ext.isArray(e))return t=e,!0})),t)},stringifyNewEntityChangedColumns:function(e){e.newEntityChangedColumns=JSON.stringify(this.newEntityChangedColumns)},getSerializableObject:function(e){this.callParent(arguments),this.stringifyNewEntityChangedColumns(e)},getSerializableProperties:function(){var e=this.callParent(arguments);return Ext.Array.push(e,["signal","entity","entitySignal","entitySchemaUId","waitingRandomSignal","waitingEntitySignal","hasEntityColumnChange","hasEntityFilters","entityFilters"])}}),Ext.define("Terrasoft.manager.ProcessIntermediateCatchTimerSchema",{extend:"Terrasoft.ProcessBaseEventSchema",alternateClassName:"Terrasoft.ProcessIntermediateCatchTimerSchema",managerItemUId:"97d1af3d-ef13-465c-b6d8-5425f78bf000",emptyDiagramCaption:!1,caption:Terrasoft.Resources.ProcessSchemaDesigner.Elements.IntermediateCatchTimerCaption,group:Terrasoft.FlowElementGroup.IntermediateEvent,name:"IntermediateCatchTimer",typeName:"Terrasoft.Core.Process.ProcessSchemaIntermediateCatchTimerEvent",smallImageName:"IntermediateEventCatchingTimerSmall.svg",largeImageName:"IntermediateEventCatchingTimerLarge.svg",titleImageName:"intermediateCatchTimer_title.svg",useBackgroundMode:!0,editPageSchemaName:"IntermediateCatchTimerPropertiesPage",cancelActivity:!1,boundaryItemAlignment:null,constructor:function(){this.parameters=[{uId:Terrasoft.generateGUID(),name:"StartOffset",caption:Ext.create("Terrasoft.LocalizableString",{cultureValues:Terrasoft.Resources.ProcessSchemaDesigner.Parameters.StartOffSetCaption}),dataValueType:Terrasoft.DataValueType.INTEGER,sourceValue:{value:"0",source:Terrasoft.ProcessSchemaParameterValueSource.ConstValue,displayValue:Ext.create("Terrasoft.LocalizableString",{cultureValues:"0"})}}],this.callParent(arguments)}}),Ext.define("Terrasoft.manager.ProcessStartTimerEventSchema",{extend:"Terrasoft.ProcessBaseEventSchema",alternateClassName:"Terrasoft.ProcessStartTimerEventSchema",managerItemUId:"c735ed92-e545-4699-b3c6-f8f57dd8c529",emptyDiagramCaption:!1,caption:Terrasoft.Resources.ProcessSchemaDesigner.Elements.StartTimerEventCaption,group:Terrasoft.FlowElementGroup.StartEvent,name:"StartTimerEvent",typeName:"Terrasoft.Core.Process.ProcessSchemaStartTimerEvent",smallImageName:"StartEventTimerSmall.svg",largeImageName:"StartEventTimerLarge.svg",titleImageName:"startTimerEvent_title.svg",editPageSchemaName:"ProcessTimerStartEventPropertiesPage",incomingConnectionsLimit:0,color:"#8ECB60",cronExpression:null,expressionType:Terrasoft.TimerExpressionTypes.Empty,misfireInstruction:Terrasoft.TimerMisfireInstructionTypes.IgnoreMisfires,isInterrupting:!0,startDateTime:null,endDateTime:null,timeZoneOffset:null,getSerializableProperties:function(){var e=this.callParent(arguments);return Ext.Array.push(e,["cronExpression","expressionType","misfireInstruction","startDateTime","endDateTime","timeZoneOffset"])}}),Ext.define("Terrasoft.manager.ProcessStartTimerEventNonInterruptingSchema",{extend:"Terrasoft.ProcessStartTimerEventSchema",alternateClassName:"Terrasoft.ProcessStartTimerEventNonInterruptingSchema",managerItemUId:"2d463c70-e508-4261-88db-73bc5e8ba917",smallImageName:"StartEventTimerNonInterruptingSmall.svg",largeImageName:"StartEventTimerNonInterruptingLarge.svg"}),Ext.define("Terrasoft.manager.ProcessIntermediateThrowMessageSchema",{extend:"Terrasoft.ProcessBaseEventSchema",alternateClassName:"Terrasoft.ProcessIntermediateThrowMessageSchema",managerItemUId:"7b8b16fb-d4c6-4e8b-a519-988250ac636f",caption:Terrasoft.Resources.ProcessSchemaDesigner.Elements.IntermediateThrowMessageCaption,group:Terrasoft.FlowElementGroup.IntermediateEvent,name:"IntermediateThrowMessage",emptyDiagramCaption:!1,typeName:"Terrasoft.Core.Process.ProcessSchemaIntermediateThrowMessageEvent",smallImageName:"IntermediateEventThrowingMessageSmall.svg",largeImageName:"IntermediateEventThrowingMessageLarge.svg",titleImageName:"intermediateThrowMessage_title.svg",message:null,throwToBase:!1,editPageSchemaName:"IntermediateThrowMessagePropertiesPage",supportEmbeddedProcess:!0,getSerializableProperties:function(){var e=this.callParent(arguments);return Ext.Array.push(e,["throwToBase","message"])}}),Ext.define("Terrasoft.manager.ProcessIntermediateThrowSignalSchema",{extend:"Terrasoft.ProcessBaseEventSchema",alternateClassName:"Terrasoft.ProcessIntermediateThrowSignalSchema",managerItemUId:"1793bff9-c5fa-49e7-a32d-ca73d270e137",caption:Terrasoft.Resources.ProcessSchemaDesigner.Elements.IntermediateThrowSignalCaption,group:Terrasoft.FlowElementGroup.IntermediateEvent,name:"IntermediateThrowSignal",typeName:"Terrasoft.Core.Process.ProcessSchemaIntermediateThrowSignalEvent",smallImageName:"IntermediateEventThrowingSignalSmall.svg",largeImageName:"IntermediateEventThrowingSignalLarge.svg",titleImageName:"intermediateThrowSignal_title.svg",message:null,emptyDiagramCaption:!1,editPageSchemaName:"IntermediateThrowSignalPropertiesPage",supportEmbeddedProcess:!0,getSerializableProperties:function(){var e=this.callParent(arguments);return Ext.Array.push(e,["message"])}}),Ext.define("Terrasoft.manager.ProcessBaseGatewaySchema",{extend:"Terrasoft.ProcessFlowElementSchema",alternateClassName:"Terrasoft.ProcessBaseGatewaySchema",nodeType:Terrasoft.diagram.UserHandlesConstraint.Gateway,width:55,height:55,silverlightOffsetX:0,silverlightOffsetY:0,group:Terrasoft.FlowElementGroup.Gateway,emptyDiagramCaption:!0,color:"#FECD66",editPageSchemaName:"ProcessBaseGatewayPropertiesPage"}),Ext.define("Terrasoft.manager.ProcessExclusiveGatewaySchema",{extend:"Terrasoft.ProcessBaseGatewaySchema",alternateClassName:"Terrasoft.ProcessExclusiveGatewaySchema",managerItemUId:"bd9f7570-6c97-4f16-90e5-663a190c6c7c",name:"ExclusiveGateway",typeName:"Terrasoft.Core.Process.ProcessSchemaExclusiveGateway",caption:Terrasoft.Resources.ProcessSchemaDesigner.Elements.ExclusiveGatewayCaption,smallImageName:"GatewaySmall.svg",largeImageName:"GatewayLarge.svg",titleImageName:"exclusiveGateway_title.svg",branchingDecisions:null,branchingMode:null,decisionMode:null,isDecisionRequired:null,hint:Terrasoft.Resources.ProcessSchemaDesigner.Elements.ExclusiveGatewayHint,supportEmbeddedProcess:!0,getConnectionUserHandles:function(){return["ConditionalSequenceFlow","DefaultSequenceFlow"]}}),Ext.define("Terrasoft.manager.ProcessExclusiveEventBasedGatewaySchema",{extend:"Terrasoft.ProcessBaseGatewaySchema",alternateClassName:"Terrasoft.ProcessExclusiveEventBasedGatewaySchema",managerItemUId:"7a3d548c-e994-4d07-b1c0-f471e2ce5687",name:"ExclusiveEventBasedGateway",typeName:"Terrasoft.Core.Process.ProcessExclusiveEventBasedGateway",caption:Terrasoft.Resources.ProcessSchemaDesigner.Elements.ExclusiveEventBasedGatewayCaption,smallImageName:"EventBasedGatewaySmall.svg",largeImageName:"EventBasedGatewayLarge.svg",titleImageName:"exclusiveEventBasedGateway_title.svg",getConnectionUserHandles:function(){return["SequenceFlow"]},isDeprecated:!0}),Ext.define("Terrasoft.manager.ProcessInclusiveGatewaySchema",{extend:"Terrasoft.ProcessBaseGatewaySchema",alternateClassName:"Terrasoft.ProcessInclusiveGatewaySchema",managerItemUId:"ffa4a06a-5747-49d4-96c2-c32a727a3b14",name:"InclusiveGateway",typeName:"Terrasoft.Core.Process.ProcessSchemaInclusiveGateway",caption:Terrasoft.Resources.ProcessSchemaDesigner.Elements.InclusiveGatewayCaption,smallImageName:"InclusiveGatewaySmall.svg",largeImageName:"InclusiveGatewayLarge.svg",titleImageName:"inclusiveGateway_title.svg",branchingDecisions:null,hint:Terrasoft.Resources.ProcessSchemaDesigner.Elements.InclusiveGatewayHint,supportEmbeddedProcess:!0,getConnectionUserHandles:function(){return["ConditionalSequenceFlow","DefaultSequenceFlow"]}}),Ext.define("Terrasoft.manager.ProcessParallelGatewaySchema",{extend:"Terrasoft.ProcessBaseGatewaySchema",alternateClassName:"Terrasoft.ProcessParallelGatewaySchema",managerItemUId:"e9e1e6de-7066-4eb1-bbb4-5b75b13d4f56",name:"ParallelGateway",incomingBranchNames:null,typeName:"Terrasoft.Core.Process.ProcessSchemaParallelGateway",caption:Terrasoft.Resources.ProcessSchemaDesigner.Elements.ParallelGatewayCaption,smallImageName:"ParallelGatewaySmall.svg",largeImageName:"ParallelGatewayLarge.svg",titleImageName:"parallelGateway_title.svg",hint:Terrasoft.Resources.ProcessSchemaDesigner.Elements.ParallelGatewayHint,supportEmbeddedProcess:!0,getConnectionUserHandles:function(){return["SequenceFlow"]}}),Ext.define("Terrasoft.manager.ProcessEventBasedGatewaySchema",{extend:"Terrasoft.ProcessBaseGatewaySchema",alternateClassName:"Terrasoft.ProcessEventBasedGatewaySchema",managerItemUId:"0ddbda75-9cac-4e42-b94c-5cf1edb45846",typeName:"Terrasoft.Core.Process.ProcessSchemaEventBasedGateway",name:"EventBasedGateway",caption:Terrasoft.Resources.ProcessSchemaDesigner.Elements.EventBasedGatewayCaption,smallImageName:"EventBasedGatewaySmall.svg",largeImageName:"EventBasedGatewayLarge.svg",titleImageName:"eventBasedGateway_title.svg",instantiate:!1,eventGatewayType:null,hint:Terrasoft.Resources.ProcessSchemaDesigner.Elements.EventBasedGatewayHint,getConnectionUserHandles:function(){return["SequenceFlow"]}}),Ext.define("Terrasoft.manager.ProcessSequenceFlowSchema",{extend:"Terrasoft.manager.ProcessBaseElementSchema",alternateClassName:"Terrasoft.ProcessSequenceFlowSchema",visualType:1,toolsConstraint:Terrasoft.diagram.ToolsConstraint.ConnectorRemoveTool,curveCenterPosition:null,nodeType:Terrasoft.diagram.UserHandlesConstraint.Connector,managerItemUId:"0d8351f6-c2f4-4737-bdd9-6fbfe0837fec",typeName:"Terrasoft.Core.Process.ProcessSchemaSequenceFlow",caption:Terrasoft.Resources.ProcessSchemaDesigner.Elements.FlowCaption,conditionExpression:null,strokeColor:"FF939598",captionBackcolor:"rgba(255, 255, 255, 0.6)",connectorBridgeSpace:8,connectorLineColor:"#A4A4A4",arrowWidth:8,arrowHeight:5,sourceRefUId:null,sourceNode:null,targetRefUId:null,targetNode:null,sequenceFlowEndPointPosition:null,sequenceFlowStartPointPosition:null,targetPoint:null,sourceSequenceFlowPointLocalPosition:null,targetSequenceFlowPointLocalPosition:null,polylinePointPositions:null,startPoint:null,endPoint:null,connectionUserHandleName:"SequenceFlow",flowType:Terrasoft.ProcessSchemaEditSequenceFlowType.SEQUENCE,editPageSchemaName:"SequenceFlowPropertiesPage",titleImageName:"sequenceFlow_title.svg",smallImageName:"SequenceFlowNew.svg",emptyDiagramCaption:!0,hint:Terrasoft.Resources.ProcessSchemaDesigner.Elements.FlowHint,supportEmbeddedProcess:!0,constructor:function(){this.callParent(arguments),this.name=this.name||this.connectionUserHandleName;var e=this.sequenceFlowStartPointPosition,t=this.sequenceFlowEndPointPosition;this.sourceSequenceFlowPointLocalPosition=this.getPortName(this.sourceSequenceFlowPointLocalPosition),this.targetSequenceFlowPointLocalPosition=this.getPortName(this.targetSequenceFlowPointLocalPosition),this.endPoint=t&&this._normalizePoint(this.parsePoint(t)),this.startPoint=e&&this._normalizePoint(this.parsePoint(e)),this.initPolylinePointPositions()},_normalizePoint:function(e){return{x:e.X,y:e.Y}},initPolylinePointPositions:function(){var e=this.polylinePointPositions;if(e){var t=this.polylinePointPositions=[];Terrasoft.each(e,(function(e){var r=this.parsePoint(e);r.x=r.X,r.y=r.Y,delete r.X,delete r.Y,t.push(r)}),this)}},getDefSequenceFlowPortName:function(e,t){if(e&&t)switch(this.createOrthogonalSegment(e,t).direction){case"left":return Terrasoft.diagram.PortPosition.Left.name;case"right":return Terrasoft.diagram.PortPosition.Right.name;case"top":return Terrasoft.diagram.PortPosition.Top.name;case"bottom":return Terrasoft.diagram.PortPosition.Bottom.name;default:return this.warning("Sequence flow segment direction not found"),Terrasoft.diagram.PortPosition.Auto.name}},createOrthogonalSegment:function(e,t){var r=e.x-t.x,n=e.y-t.y,i=Math.abs(r),a=Math.abs(n);return i>a?r>0?{type:"orthogonal",direction:"left",length:i,point:t}:{type:"orthogonal",direction:"right",length:i,point:t}:n>0?{type:"orthogonal",direction:"top",length:a,point:t}:{type:"orthogonal",direction:"bottom",length:a,point:t}},getPortOffsetByName:function(e){var t={x:.5,y:.5};return Terrasoft.each(Terrasoft.diagram.PortPosition,(function(r){r.name===e&&(t=r.offset)})),t},getConnectorPoint:function(e,t){var r=this.parentSchema.getItemPosition(e),n=this.getPortOffsetByName(t);return{x:r.x+n.x*e.width,y:r.y+n.y*e.height}},getPort:function(e,t,r){var n=e;return n&&n!==Terrasoft.diagram.PortPosition.Auto.name||(n=this.getDefSequenceFlowPortName(t,r)),n},getDiagramFlowLabelConfig:function(e){return{labelType:Terrasoft.LabelType.CAPTION,name:this.name,text:e.caption,fontSize:this.fontSize,fontFamily:this.fontFamily,fontColor:this.fontColor,wrapText:!0,verticalAlignment:"top",offset:{x:.5,y:0},fillColor:this.captionBackcolor,width:this.captionWidth}},getDiagramConfig:function(){var e=this.callParent(arguments),t=Ext.apply(this.getFlowConfig(),e),r=this.findItemByName(t.sourceNode),n=this.findItemByName(t.targetNode);r&&n&&!1===r.visible&&!1===n.visible?t.visible=!1:(r&&!1===r.visible&&(r=this.findItemByUId(r.containerUId),t.sourceNode=r.name),n&&!1===n.visible&&(n=this.findItemByUId(n.containerUId),t.targetNode=n.name));var i=this.parentSchema,a=r&&i.getItemPosition(r),s=n?i.getItemPosition(n):this.targetPoint,o=t.sourcePort=this.getPort(this.sourceSequenceFlowPointLocalPosition,a,s),l=t.targetPort=this.getPort(this.targetSequenceFlowPointLocalPosition,s,a),c=r&&this.getConnectorPoint(r,o),u=n?this.getConnectorPoint(n,l):s,h=_.toArray(this.polylinePointPositions);if(t.sourcePoint=c,t.targetPoint=u,h&&(h=this.trimDuplicatePoints(h)).length>0){t.segments=[];for(var f=0;f<h.length;f++){var d=h[f],p=0===f?c:h[f-1],m=this.createOrthogonalSegment(p,d);m&&t.segments.push(m)}}var g=this.getDiagramFlowLabelConfig(t);return t.labels=[g],t},trimDuplicatePoints:function(e){for(var t=[],r=0;r<e.length;r++){var n=e[r],i=r+1;i<e.length&&e[i].x===n.x&&e[i].y===n.y||t.push(n)}return t},getFlowConfig:function(){var e,t,r=this.caption||"";if("function"==typeof r.getValue&&(r=r.getValue()||""),e=this.sourceNode?this.sourceNode:this.sourceRefUId?this.findItemByUId(this.sourceRefUId).name:"",this.targetNode)t=this.targetNode;else{var n=this.targetRefUId;t=n&&!Terrasoft.isEmptyGUID(n)?this.findItemByUId(n).name:""}return{name:e+"_"+t+"_"+Terrasoft.generateGUID(),caption:r,bridgeSpace:this.connectorBridgeSpace,segments:[{type:"orthogonal"}],lineColor:this.connectorLineColor,lineWidth:1,sourceNode:e,targetNode:t,targetDecorator:{shape:"arrow",width:this.arrowWidth,height:this.arrowHeight,borderColor:this.connectorLineColor,fillColor:this.connectorLineColor},toolsConstraint:this.toolsConstraint}},findItemByName:function(e){return this.parentSchema.findItemByName(e)},findItemByUId:function(e){return this.parentSchema.findItemByUId(e)},findSourceElement:function(){if(null==this.parentSchema)throw new Terrasoft.NullOrEmptyException;return this.findItemByUId(this.sourceRefUId)},findTargetElement:function(){if(null==this.parentSchema)throw new Terrasoft.NullOrEmptyException;return this.findItemByUId(this.targetRefUId)},getSerializableObject:function(e){this.callParent(arguments),this.setSerializablePolylinePointPositions(e),this.setSerializablePointPosition(e,"sourceSequenceFlowPointLocalPosition"),this.setSerializablePointPosition(e,"targetSequenceFlowPointLocalPosition"),this._setSerializablePoint(e,"sequenceFlowStartPointPosition","startPoint"),this._setSerializablePoint(e,"sequenceFlowEndPointPosition","endPoint")},getSerializableProperties:function(){var e=this.callParent(arguments);return Ext.Array.push(e,["sourceRefUId","targetRefUId","conditionExpression","strokeColor","flowType","curveCenterPosition"])},setSerializablePointPosition:function(e,t){var r=this[t];r&&(e[t]=this.getSerializablePortName(r))},_setSerializablePoint:function(e,t,r){var n=this[r];n?e[t]=Ext.String.format("{0};{1}",Math.round(n.x),Math.round(n.y)):delete e[t]},setSerializablePolylinePointPositions:function(e){if(this.polylinePointPositions){var t=0,r={};this.polylinePointPositions.forEach((function(e){var n=parseInt(e.x,10)||0,i=parseInt(e.y,10)||0,a=Ext.String.format("{0};{1}",n,i);r["Item"+t]=a,t++})),e.polylinePointPositions=r}},getPortName:function(e){if(e){var t=/(-?\d);(-?\d)/.exec(e);return Ext.String.format("{X={0},Y={1}}",t[1],t[2])}return null},getSerializablePortName:function(e){var t=/X=(-?\d),Y=(-?\d)/.exec(e);return Ext.String.format("{0};{1}",t[1],t[2])},_setSourceRef:function(e){this.sourceRefUId!==e&&(this.sourceRefUId=e,this.fireEvent("onSourceChanged",this))},getUIJsonData:function(){var e={};this.getSerializableObject(e);var t=this.callParent(arguments);return Ext.apply(t,{SourceRefUId:e.sourceRefUId,TargetRefUId:e.targetRefUId,SourceSequenceFlowPointLocalPosition:e.sourceSequenceFlowPointLocalPosition,TargetSequenceFlowPointLocalPosition:e.targetSequenceFlowPointLocalPosition,SequenceFlowCurveCenterPosition:e.curveCenterPosition,SequenceFlowPolylinePointPositions:e.polylinePointPositions})},insertFlowElement:function(e){var t=this.parentSchema,r=this.findItemByUId(this.targetRefUId),n=t.getItemPosition(e),i=t.getItemPosition(r),a=this.getDefSequenceFlowPortName(n,i),s=new Terrasoft.ProcessSequenceFlowSchema({uId:Terrasoft.generateGUID(),sourceRefUId:e.uId,targetRefUId:r.uId,showPropertiesWindowOnAdding:!1});s.sourceSequenceFlowPointLocalPosition=a,s.targetSequenceFlowPointLocalPosition=this.targetSequenceFlowPointLocalPosition;var o=this.findItemByUId(this.sourceRefUId),l=t.getItemPosition(o),c=this.getDefSequenceFlowPortName(n,l);return this.targetRefUId=e.uId,this.targetSequenceFlowPointLocalPosition=c,s},setSource:function(e){this.sourceSequenceFlowPointLocalPosition=e.sourcePort,this._setSourceRef(e.sourceRefUId)},setSourceRef:function(e){this._setSourceRef(e)},setTarget:function(e){this.targetSequenceFlowPointLocalPosition=e.targetPort,this.targetRefUId=e.targetRefUId},setTargetRef:function(e){this.targetRefUId=e},setSourcePortPositionByPoints:function(e){var t=this.getDefSequenceFlowPortName(e.position,e.side);t!==this.sourceSequenceFlowPointLocalPosition&&(this.sourceSequenceFlowPointLocalPosition=t)},setTargetPortPositionByPoints:function(e){var t=this.getDefSequenceFlowPortName(e.position,e.side);t!==this.targetSequenceFlowPointLocalPosition&&(this.targetSequenceFlowPointLocalPosition=t)}}),Ext.define("Terrasoft.manager.ProcessDefaultSequenceFlowSchema",{extend:"Terrasoft.ProcessSequenceFlowSchema",alternateClassName:"Terrasoft.ProcessDefaultSequenceFlowSchema",managerItemUId:"573ed909-e069-4161-b193-ae8dd9437c68",connectionUserHandleName:"DefaultSequenceFlow",caption:Terrasoft.Resources.ProcessSchemaDesigner.Elements.DefaultFlowCaption,titleImageName:"defaultSequenceFlow_title.svg",smallImageName:"DefaultSequenceFlowNew.svg",flowType:Terrasoft.ProcessSchemaEditSequenceFlowType.DEFAULT,hint:Terrasoft.Resources.ProcessSchemaDesigner.Elements.DefaultFlowHint,getFlowConfig:function(){var e=this.callParent(arguments);return e.sourceDecorator={shape:"path",width:this.diamondWidth,height:this.diamondHeight,borderColor:this.connectorLineColor,pathData:"M0 4L12 4M3 0 L12 8"},e}}),Ext.define("Terrasoft.manager.ProcessConditionalSequenceFlowSchema",{extend:"Terrasoft.manager.ProcessSequenceFlowSchema",alternateClassName:"Terrasoft.ProcessConditionalSequenceFlowSchema",managerItemUId:"dac675d4-ea84-4e44-9056-38bf918618e9",typeName:"Terrasoft.Core.Process.ProcessSchemaConditionalFlow",caption:Terrasoft.Resources.ProcessSchemaDesigner.Elements.ConditionalFlowCaption,diamondWidth:14,diamondHeight:8,diamondFillColor:"#ffffff",processActivitiesSelectedResults:null,matchBranchingDecisions:null,connectionUserHandleName:"ConditionalSequenceFlow",editPageSchemaName:"ConditionalSequenceFlowPropertiesPage",smallImageName:"ConditionalSequenceFlowNew.svg",largeImageName:"conditionalSequenceFlow_large.svg",titleImageName:"conditionalSequenceFlow_title.svg",emptyDiagramCaption:!1,flowType:Terrasoft.ProcessSchemaEditSequenceFlowType.CONDITIONAL,hint:Terrasoft.Resources.ProcessSchemaDesigner.Elements.ConditionalFlowHint,constructor:function(){this.callParent(arguments),this.processActivitiesSelectedResults=this.decodeProcessActivitiesSelectedResults(this.processActivitiesSelectedResults)},initEvents:function(){this.on("onSourceChanged",this.onSourceChanged,this)},decodeProcessActivitiesSelectedResults:function(e){var t={};if(Ext.isEmpty(e))return t;var r=Terrasoft.decode(e);return r.hasOwnProperty("$type")?Terrasoft.each(r,(function(e,r){"$type"!==r&&(t[r]=e.$values)})):Terrasoft.each(r,(function(e,r){t[r]=e})),t},getFlowConfig:function(){var e=this.callParent(arguments);return e.sourceDecorator={shape:"diamond",width:this.diamondWidth,height:this.diamondHeight,borderColor:this.connectorLineColor,fillColor:this.diamondFillColor},e},getSerializableObject:function(e){this.callParent(arguments),e.processActivitiesSelectedResults=JSON.stringify(this.processActivitiesSelectedResults)},onSourceChanged:function(){this.isValidateExecuted=!1,this.isValid=!1,this.validationResults=[]},getValue:function(){return this.conditionExpression},onDestroy:function(){this.un("onSourceChanged",this.onSourceChanged,this),this.callParent(arguments)}}),Ext.define("Terrasoft.manager.ProcessFlowElementSchemaManager",{extend:"Terrasoft.manager.BaseProcessFlowElementSchemaManager",alternateClassName:"Terrasoft.ProcessFlowElementSchemaManager",singleton:!0,managerName:"ProcessFlowElementSchemaManager",coreElementClassNames:[{itemType:"Terrasoft.ProcessStartEventSchema"},{itemType:"Terrasoft.ProcessStartMessageNonInterruptingSchema"},{itemType:"Terrasoft.ProcessStartMessageSchema",initialConfig:{isValid:!1}},{itemType:"Terrasoft.ProcessStartSignalSchema",initialConfig:{waitingRandomSignal:!1,waitingEntitySignal:!0,isValid:!1,useBackgroundMode:!0}},{itemType:"Terrasoft.ProcessStartSignalNonInterruptingSchema",initialConfig:{waitingRandomSignal:!1,waitingEntitySignal:!0,isValid:!1,useBackgroundMode:!0}},{itemType:"Terrasoft.ProcessIntermediateCatchMessageSchema",initialConfig:{isValid:!1}},{itemType:"Terrasoft.ProcessIntermediateCatchSignalSchema",initialConfig:{waitingRandomSignal:!1,waitingEntitySignal:!0,isValid:!1,useBackgroundMode:!0}},{itemType:"Terrasoft.ProcessIntermediateCatchTimerSchema",initialConfig:{isValid:!1,useBackgroundMode:!0}},{itemType:"Terrasoft.ProcessStartTimerEventSchema",initialConfig:{isValid:!1}},{itemType:"Terrasoft.ProcessStartTimerEventNonInterruptingSchema",initialConfig:{isValid:!1}},{itemType:"Terrasoft.ProcessBoundaryEventSchema"},{itemType:"Terrasoft.ProcessUnsupportedElementSchema"},{itemType:"Terrasoft.ProcessUnsupportedTerminateEventSchema"},{itemType:"Terrasoft.ProcessIntermediateThrowMessageSchema",initialConfig:{isValid:!1}},{itemType:"Terrasoft.ProcessIntermediateThrowSignalSchema",initialConfig:{isValid:!1}},{itemType:"Terrasoft.ProcessTerminateEventSchema"},{itemType:"Terrasoft.ProcessEndEventSchema"},{itemType:"Terrasoft.ProcessExclusiveGatewaySchema"},{itemType:"Terrasoft.ProcessExclusiveEventBasedGatewaySchema"},{itemType:"Terrasoft.ProcessInclusiveGatewaySchema"},{itemType:"Terrasoft.ProcessParallelGatewaySchema"},{itemType:"Terrasoft.ProcessSubprocessSchema",initialConfig:{isValid:!1}},{itemType:"Terrasoft.ProcessScriptTaskSchema",initialConfig:{useFlowEngineScriptVersion:!0}},{itemType:"Terrasoft.ProcessFormulaTaskSchema",initialConfig:{isValid:!1}},{itemType:"Terrasoft.ProcessSequenceFlowSchema"},{itemType:"Terrasoft.ProcessConditionalSequenceFlowSchema",initialConfig:{isValid:!1}},{itemType:"Terrasoft.ProcessDefaultSequenceFlowSchema"},{itemType:"Terrasoft.ProcessLaneSchema"},{itemType:"Terrasoft.ProcessLaneSetSchema"},{itemType:"Terrasoft.ProcessEventSubprocessSchema"},{itemType:"Terrasoft.ProcessEventBasedGatewaySchema"},{itemType:"Terrasoft.ProcessSchemaUserTask",initialConfig:{isValid:!1}},{itemType:"Terrasoft.ProcessWebServiceSchema",initialConfig:{isValid:!1}}],notImplementedElementNames:[],serviceTaskElementNames:["SendEmailUserTask","FormulaTask","ScriptTask","ChangeAdminRightsUserTask","ObjectFileProcessingUserTask","LinkEntityToProcessUserTask","ReadDataUserTask","ChangeDataUserTask","AddDataUserTask","DeleteDataUserTask","WebService","MLDataPredictionUserTask","ReportFileProcessingUserTask","ProcessFileProcessingUserTask","SearchDuplicatesUserTask"],obsoleteElementNames:["SendEmailUserTask","EmailUserTask"],emailElementNames:["EmailUserTask","SendEmailUserTask"],notImplementedElementsFeatureCode:"ProcessNotImplementedElements",obsoleteElementsFeatureCode:"ProcessObsoletedElements",userTaskSchemaManagerName:"ProcessUserTaskSchemaManager",getIsEmailElement:function(e){var t=e.managerItemUId;if(!t)return!1;var r=this.findItem(t);return!!r&&this.emailElementNames.indexOf(r.name)>-1},allowElementCopy:function(e){if(!e)return!1;if(!e.managerItemUId)return!1;var t=[Terrasoft.diagram.UserHandlesConstraint.Node,Terrasoft.diagram.UserHandlesConstraint.Gateway,Terrasoft.diagram.UserHandlesConstraint.Event,Terrasoft.diagram.UserHandlesConstraint.Subprocess];return Ext.Array.contains(t,e.nodeType)}}),Ext.define("Terrasoft.controls.ProcessSchemaDesignerLeftToolbar",{extend:"Terrasoft.Container",alternateClassName:"Terrasoft.ProcessSchemaDesignerLeftToolbar",classes:{wrapClassName:["manager-items","ts-box-sizing","scroll"]},designer:null,elementSchemaManager:Terrasoft.ProcessFlowElementSchemaManager,init:function(){this.callParent(arguments),this.addEvents("itemDrop"),this.on("afterRender",this.onToolbarAfterRender,this)},onToolbarAfterRender:function(){this.wrapEl.on("scroll",this.showScrollShadow,this)},getToolbarGroups:function(){return Terrasoft.FlowElementGroup},initToolbarGroups:function(){var e=this.getToolbarGroups();Terrasoft.each(e,(function(e){var t=Ext.create("Terrasoft.ControlGroup",{id:this.getGroupId(e),caption:Terrasoft.Resources.ProcessSchemaDesigner.ElementsToolbarGroup[e],collapsed:!1,toggleCollapsed:Terrasoft.emptyFn});this.add(t)}),this)},getToolbarItemVisible:function(e){return!e.isDeprecated&&e.group&&e.usageType!==Terrasoft.ProcessSchemaUsageType.NONE},initToolbarItems:function(){var e=this.elementSchemaManager;e.initialize((function(){var t=this;this.initToolbarGroups();var r=e.items.mapArray((function(e){return e.instance}),this).filter((function(e){return t.getToolbarItemVisible(e)}));this.sortToolbarItems(r),r.forEach((function(e){var t=this.createDraggableItem(e),r=this.getGroupId(e.group);this.items.getByKey(r).items.add(t)}),this)}),this)},sortToolbarItems:function(e){e.sort(function(e,t){return this.getToolbarItemOrderIndex(e.name)-this.getToolbarItemOrderIndex(t.name)}.bind(this))},getToolbarItemOrderIndex:function(e){var t=Terrasoft.process.constants.DESIGNER_LEFT_TOOLBAR_ITEMS_ORDER,r=t.length,n=t.indexOf(e);return n<0&&(n=r+1),n},getGroupId:function(e){return"ts-group-"+e},createDiagramDragableContainer:function(e,t,r,n){var i=this.getToolbarItemHtml(t,n);return Ext.create("Terrasoft.DiagramDraggableContainer",{tag:e,markerValue:r,classes:{wrapClassName:["toolbar-item","ts-box-sizing"]},items:[{className:"Terrasoft.Component",selectors:{wrapEl:"#"+t},html:i}],tips:[{tip:{className:"Terrasoft.Tip",displayMode:Terrasoft.TipDisplayMode.NARROW,style:Terrasoft.controls.TipEnums.style.BLUE,content:n.caption,isContentEmpty:this.isToolbarItemTipContentEmpty.bind(this)},settings:{displayEvent:Terrasoft.TipDisplayEvent.HOVER}}]})},createDraggableItem:function(e){var t={element:e};t=Ext.apply(t,e.initialConfig);var r=Terrasoft.Component.generateId(),n=e.getToolbarHtml(),i=this.createDiagramDragableContainer(t,r,e.name,n);return this.getIsToggled(e)&&i.classes.wrapClassName.push("togled"),i.on("onDragDrop",(function(e){return this.fireEvent("itemDrop",e)}),this),i},getIsToggled:function(e){var t=this.elementSchemaManager;return[].concat(t.obsoleteElementNames).concat(t.notImplementedElementNames).indexOf(e.name)>-1},isToolbarItemTipContentEmpty:function(){return!this.designer.leftPanelCollapsed},getToolbarItemHtml:function(e,t){var r=Ext.String.format('<image width="{0}" height="{1}" opacity="1" xlink:href="{2}" />',32,32,Terrasoft.ImageUrlBuilder.getUrl(t.image));return Ext.String.format('<svg id="'+e+'" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" xml:space="preserve" preserveAspectRatio="none" width="{0}px" height="{1}px" viewBox="0 0 {0} {1}"><g>{2}</g></svg><label class="t-label">{3}</label>',32,32,r,t.caption)},showScrollShadow:function(){var e=this.wrapEl;e.dom.scrollTop>0?e.addCls("top-scroll-shadow"):e.removeCls("top-scroll-shadow")}}),Ext.define("Terrasoft.manager.ProcessSchema",{extend:"Terrasoft.manager.BaseProcessSchema",alternateClassName:"Terrasoft.ProcessSchema",elementSchemaManagerName:"ProcessFlowElementSchemaManager",contractName:"ContractProcessSchema",managerName:"ProcessSchemaManager",methods:null,sequenceFlowStrokeDefColor:"FFBBBBBB",taskFillDefColor:"FFFFFFFF",usings:null,associations:null,quickModelData:null,createdInSchemaUId:null,modifiedInSchemaUId:null,createdInPackageId:null,group:null,entitySchemaUId:null,isExpanded:!1,isCreatedInSvg:!1,typeName:"Terrasoft.Core.Process.ProcessSchema",usageType:Terrasoft.ProcessSchemaUsageType.ADVANCED,parametersEditPageSchemaUId:null,tag:null,localizableStrings:null,laneSets:null,lanes:null,artifacts:null,executionContexts:null,polylinePointPositions:null,flowElementsParameters:null,isQuickModel:!1,isEmbedded:!1,cultureName:null,isInterpretable:!1,inheritedElements:null,useForceCompile:!1,methodsBody:"",compiledMethodsBody:"",validatorInfo:null,validatorMessage:"",resourceManagerName:"Terrasoft.Nui",titleImageName:"process_title.svg",typeCaption:Terrasoft.Resources.ProcessSchemaDesigner.TypeCaption,color:"#00AEEF",changedItems:null,labels:null,constructor:function(){this.callParent(arguments),this.changedItems={},this.inheritedElements=Ext.create("Terrasoft.Collection"),this.initMappings(),this.initLaneSets(),this.initFlowElements(),this._initLabels(),this.initUsings(),this.synchronizeDynamicParameters()},initLaneSets:function(){var e=this.laneSets||[],t=this.laneSets=Ext.create("Terrasoft.Collection"),r=this.lanes=Ext.create("Terrasoft.Collection");e.forEach((function(e){if(e.createdInSchemaUId===this.uId){var n=this.createItemInstance(e);t.add(n.name,n),n.lanes.each((function(e){e.parentSchema=this,r.add(e.name,e)}),this)}else this.inheritedElements.add(e.name,e)}),this)},initFlowElements:function(){var e=this.flowElements||[],t=this.flowElements=Ext.create("Terrasoft.Collection");e.forEach((function(r){if(r.createdInSchemaUId===this.uId){(r=Terrasoft.deepClone(r)).parentSchema=this;var n=this.createItemInstance(r),i=this._findParent(n,e);n.parent=i?i.name:null,t.add(n.name,n)}else this.addInheritedElements(r)}),this)},_findParent:function(e,t){return this.findItemLane(e)||(this._isBoundaryElementInRoot(e)?this.findItemByUId(e.attachedToElementUId)||this._findItemInMetaItems(e.attachedToElementUId,t):null)},_findItemInMetaItems:function(e,t){return t.filter((function(t){return t.uId===e}))[0]},_initLabels:function(){var e=this,t=this.labels?this.labels:[],r=this.labels=Ext.create("Terrasoft.Collection");t.forEach((function(t){if(t.createdInSchemaUId===e.uId){t=Terrasoft.deepClone(t);var n=e.createLabel(t);r.add(n.name,n)}else e.addInheritedElements(t,"labels")}))},createLabel:function(e){return new Terrasoft.ProcessLabelSchema(e)},initUsings:function(){var e=this.usings||[],t=this.usings=Ext.create("Terrasoft.Collection");e.forEach((function(e){if(e.createdInSchemaUId===this.uId){var r=Ext.create("Terrasoft.SchemaUsing",e);t.add(r.uId,r)}}),this)},addInheritedElements:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"flowElements",r=e.name,n=this.inheritedElements;if(!n.contains(r)){n.add(r,e);var i=e[t];i&&i.forEach((function(e){this.addInheritedElements(e,t)}),this)}},fixPositionInContainer:function(e){var t=this.flowElements.filterByFn((function(t){return t.containerUId===e.uId}));if(0!==t.getCount()){t.each((function(e){e.isContainer&&e.isExpanded&&this.fixPositionInContainer(e)}),this),t.sortByFn((function(e,t){return e.position.X-t.position.X}));var r=t.getByIndex(t.getCount()-1),n=r.position.X+r.width;t.sortByFn((function(e,t){return e.position.Y-t.position.Y}));var i=t.getByIndex(t.getCount()-1),a=i.position.Y+i.height+18;e.width=e.width||0,e.height=e.height||0,e.width<n&&(e.width=n),e.height<a&&(e.height=a),e.nodeType===Terrasoft.diagram.UserHandlesConstraint.Lane&&t.each((function(t){t.position.Y+=e.position.Y}),this)}},findItemLane:function(e){if(e.nodeType===Terrasoft.diagram.UserHandlesConstraint.Lane)return null;var t=this.lanes.filterByFn((function(t){return t.uId===e.containerUId}));return 0===t.getCount()?null:t.getByIndex(0)},onSchemaChanged:function(e){var t=Terrasoft.generateGUID(),r=Terrasoft.process.constants.ITEM_CHANGE_ACTION.MODIFY,n=Terrasoft.Resources.ProcessSchemaDesigner.Messages;e.hasOwnProperty("methodsBody")&&this.addSchemaChangedItem(t,n.ProcessSchemaMethodsBodyCaption||"methodsBody",r),e.hasOwnProperty("compiledMethodsBody")&&this.addSchemaChangedItem(t,n.CompiledProcessSchemaMethodsBodyCaption||"compiledMethodsBody",r)},findLinkToFormulaTasks:function(e,t){return t instanceof Terrasoft.ProcessFormulaTaskSchema&&this._getIsDependentFormulaTaskFromParameter(t,e)?{sourceParameter:e,dependentElement:t}:null},_getIsDependentFormulaTaskFromParameter:function(e,t){var r=e.body,n=!1;if(r){var i=e.resultParameterMetaPath,a=t.uId;if(this.getIsProcessSchemaParameter(t))!(n=Terrasoft.includes(r,a))&&i&&(n=Terrasoft.includes(i,a));else{var s=t.processFlowElementSchema.uId,o=Terrasoft.process.constants.PARAMETER_METAPATH_TEMPLATE,l=Ext.String.format(o,s,a);if(!(n=Terrasoft.includes(r,l))&&i){var c=Ext.String.format("{0}.{1}",s,a);n=Terrasoft.includes(i,c)}}}return n},findLinkToConditionalFlow:function(e,t,r){if(!(t instanceof Terrasoft.ProcessConditionalSequenceFlowSchema))return null;var n=t.findSourceElement(),i=t.findTargetElement();if(!r||!(r.indexOf(n.name)>-1||r.indexOf(i.name)>-1)){var a=t.conditionExpression;return a&&a.indexOf(e.uId)>-1?{sourceParameter:e,dependentElement:t}:null}},_isVersionSupported:function(e){if(Ext.isEmpty(e))return!0;if("0.0.0.0"===e)return!0;for(var t=e.split("."),r="7.7.0.0".split("."),n=0;n<t.length;n++){var i=Number(t[n]),a=Number(r[n]);if(i<a)return!1;if(i>a)break}return!0},_getSerializableLabels:function(){var e=this,t=[];return this.labels.each((function(r){if(!Terrasoft.isNull(r.x)||!Terrasoft.isNull(r.y)){var n=e.getSerializableProperty(r);t.push(n)}})),t},_isBoundaryElementInRoot:function(e){return Terrasoft.ProcessBoundaryEventTypes.includes(e.unsupportedType)},_getMultiInstanceElements:function(){return this.flowElements.filterByFn((function(e){return e.getIsMultiInstanceSupported&&e.getIsMultiInstanceModeEnabled()}),this)},initEvents:function(){this.on("changed",this.onSchemaChanged,this)},getCanAssignParameterSourceValue:function(e){return!0},isItemChangesRegistered:function(e,t){var r=this.changedItems[e];return!!r&&r.action===t},deleteItemChanges:function(e){delete this.changedItems[e]},deleteSchemaChanges:function(){this.changedItems={}},addSchemaChangedItem:function(e,t,r){var n=this.changedItems,i=n[e];i||((i=n[e]={}).action=r,i.caption=t)},getEditPageSchemaName:function(e,t){e.call(t,"ProcessSchemaPropertiesPage")},getSerializableObject:function(e){this.callParent(arguments),e.isCreatedInSvg=this.getSerializableProperty(!0),this.setSerializableCollectionProperty(e,"usings"),this.setSerializableCollectionProperty(e,"mappings"),e.laneSets=this.getSerializableLaneSets(),e.flowElements=this.getSerializableFlowElements(),e.labels=this._getSerializableLabels(),this.mixins.parametrizedProcessSchemaElement.getSerializableObject.apply(this,arguments)},getSerializableProperties:function(){var e=this.callParent(arguments),t=Ext.Array.push(e,["createdInSchemaUId","modifiedInSchemaUId","createdInPackageId","methods","localizableStrings","createdInVersion","taskFillDefColor","sequenceFlowStrokeDefColor","artifacts","associations","isExpanded","usageType","parametersEditPageSchemaUId","tag","entitySchemaUId","cultureName","executionContexts","isEmbedded","isInterpretable","useForceCompile","methodsBody","compiledMethodsBody"]);return t},getSerializableLaneSets:function(){var e=this;return this.laneSets.mapArray((function(t){return e.getSerializableProperty(t)}),this)},getSerializableFlowElements:function(){var e=[],t=[];return this.flowElements.each((function(r){var n=this.findItemByUId(r.containerUId)||{};if(!this.flowElements.contains(n.name)){var i=this.getSerializableProperty(r);r.nodeType===Terrasoft.diagram.UserHandlesConstraint.Connector?t.push(i):e.push(i)}this._isBoundaryElementInRoot(r)&&e.push(this.getSerializableProperty(r))}),this),e.concat(t)},loadLocalizableValues:function(e){if(e){e.EventsProcessSchema&&(e=e.EventsProcessSchema),this.callParent(arguments);var t=e.LaneSets||{};this.laneSets.each((function(e){var r=t[e.name];e.loadLocalizableValues(r)}),this);var r=e.BaseElements||{};this.flowElements.each((function(e){var t=r[e.name];e.loadLocalizableValues(t)}),this)}},loadLocalizableValuesByUIds:function(e){this.callParent(arguments),e&&(this.laneSets.each((function(t){t.loadLocalizableValuesByUIds(e)}),this),this.flowElements.each((function(t){t.loadLocalizableValuesByUIds(e)}),this))},getLocalizableValues:function(e){this.callParent(arguments),this.laneSets.each((function(t){t.getLocalizableValues(e)}),this),this.flowElements.each((function(t){t.getLocalizableValues(e)}),this)},getTitleImage:function(){return{source:Terrasoft.ImageSources.RESOURCE_MANAGER,params:{resourceManagerName:this.resourceManagerName,resourceItemName:"ProcessSchemaDesigner."+this.titleImageName}}},collectItemsValidationResults:function(e){this.collectValidationResults(this.laneSets,e),this.collectValidationResults(this.lanes,e),this.collectValidationResults(this.flowElements,e)},getFlowElements:function(){return this.flowElements},findLinksToFlowElement:function(e,t){var r=this.callParent(arguments);return this.flowElements.each((function(n){if(!(t&&t.indexOf(n.name)>-1)){var i=this.findLinkToFormulaTasks(e,n);if(i)r.push(i);else{var a=this.findLinkToConditionalFlow(e,n,t);a&&r.push(a)}}}),this),r},createItemInstance:function(e){var t=e.managerItemUId?e.managerItemUId:e.uId;return Terrasoft[this.elementSchemaManagerName].createInstance(t,e)},add:function(e){var t=e.name;if(this.contains(t))throw new Terrasoft.ItemAlreadyExistsException;switch(!0){case e instanceof Terrasoft.ProcessLaneSetSchema:this.laneSets.add(e.name,e);break;case e instanceof Terrasoft.ProcessLaneSchema:var r=this.findItemByUId(e.containerUId);e.laneSetUId=e.containerUId,e.parent=r,r.lanes.add(e.name,e),this.lanes.add(e.name,e);break;case e instanceof Terrasoft.ProcessSequenceFlowSchema:this.flowElements.add(e.name,e);break;case e.nodeType===Terrasoft.diagram.UserHandlesConstraint.Label:return e.createdInSchemaUId=this.uId,this.labels.add(e.name,e),void this.fireEvent("changed",{item:e});default:var n=this.findItemLane(e),i=n?n.name:null;if(null==n){var a=this.findItemByUId(e.containerUId);i=a&&a.name}e.parent=i,this.flowElements.add(e.name,e)}if(e.createdInOwnerSchemaUId=this.uId,e.createdInSchemaUId=this.uId,e.modifiedInSchemaUId=this.uId,e.parentSchema=this,e.createdInPackageId=this.packageUId,this.synchronizeParameters(e),!0===e.requireCompilation()){var s=Terrasoft.process.constants.ITEM_CHANGE_ACTION;this.addSchemaChangedItem(e.uId,e.getDisplayValue(),s.ADD)}this.fireEvent("changed",{item:e})},remove:function(e){if(!this.contains(e))throw new Terrasoft.ItemNotFoundException;var t=this.findItemByName(e),r=this.lanes,n=this.flowElements,i=this.labels;switch(!0){case r.contains(e):r.removeByKey(e);break;case n.contains(e):this.removeMapping(t),n.removeByKey(e);break;case i.contains(e):return i.removeByKey(e),void this.fireEvent("changed",{itemName:e})}if(!0===t.requireCompilation()){var a=Terrasoft.process.constants.ITEM_CHANGE_ACTION;this.isItemChangesRegistered(t.uId,a.ADD)?this.deleteItemChanges(t.uId):this.addSchemaChangedItem(t.uId,t.getDisplayValue(),a.DELETE)}this.fireEvent("changed",{itemName:e})},contains:function(e){return this.flowElements.contains(e)||this.lanes.contains(e)||this.laneSets.contains(e)||this.labels.contains(e)},clearSchemaMappings:function(){this.parameters.each((function(e){e.clearSourceValue()}))},findItemByName:function(e){var t=[this.flowElements,this.lanes,this.laneSets,this.labels].find((function(t){return t.contains(e)}));if(t)return t.get(e)},findItemByUId:function(e){var t=function(t){return t.uId===e},r=this.flowElements.filterByFn(t);return 0===r.getCount()&&(r=this.lanes.filterByFn(t)),0===r.getCount()&&(r=this.laneSets.filterByFn(t)),r.first()},findItemByCaption:function(e){var t=function(t){return Terrasoft.ProcessSchemaDesignerUtilities.getElementCaption(t)===e},r=this.flowElements.filterByFn(t);return 0===r.getCount()&&(r=this.lanes.filterByFn(t)),0===r.getCount()&&(r=this.laneSets.filterByFn(t)),r.first()},getItemPosition:function(e){var t=this.findItemByName(e.parent),r={x:0,y:0};t&&t instanceof Terrasoft.ProcessEventSubprocessSchema&&(r=this.getItemPosition(t));var n=e.position;return{x:n.X+r.x,y:n.Y+r.y}},_setItemPosition:function(e,t){t.hasOwnProperty("x")&&(e.position.X=t.x),t.hasOwnProperty("y")&&(e.position.Y=t.y)},changeItemPosition:function(e,t){var r=this.findItemByName(e);r.nodeType===Terrasoft.diagram.UserHandlesConstraint.Label?(t.hasOwnProperty("x")&&(r.x=t.x),t.hasOwnProperty("y")&&(r.y=t.y)):this._setItemPosition(r,t),this.fireEvent("changed",{item:r})},changeItemSize:function(e,t){var r=this.findItemByName(e);r.size.width=t.width,r.size.height=t.height,this.fireEvent("changed",{item:r})},changeLinePosition:function(e,t){var r=this.findItemByName(e);r.position.Y=t.y,this.fireEvent("changed",{item:r})},changeItemContainer:function(e,t){var r=this.findItemByName(e),n=this.findItemByName(t);r.containerUId=n.uId,r.parent=n.name,this.fireEvent("changed",{item:r})},changeSequenceFlowPolylinePointPositions:function(e,t){if(!this.contains(e))throw new Terrasoft.ItemNotFoundException;var r=this.findItemByName(e);delete r.startPoint,delete r.endPoint,r.polylinePointPositions=t,this.fireEvent("changed",{item:r})},loadStatisticInfo:function(e){e&&Terrasoft.each(e,(function(e,t){var r=this.flowElements.filter("uId",t).getByIndex(0);r&&(r.executedCount=e)}),this)},loadMultiInstanceStatisticInfo:function(e){Terrasoft.each(this._getMultiInstanceElements(),(function(t){var r=Boolean(e)?e[t.uId]:null;r&&(t.completedCount=r.completedCount,t.failedCount=r.failedCount);var n=Terrasoft.Resources.ProcessSchemaDesigner.Elements;t.completedCountTooltipText=n.MICompletedCountTooltipText,t.failedCountTooltipText=n.MIFailedCountTooltipText}),this)},generateItemUniqueName:function(e,t){for(var r=e+"1",n=1,i=function(e){return t(e,r)};;){if(0===this.flowElements.filterByFn(i).getCount())return r;n++,r=e+n}},addUsing:function(e){Ext.apply(e,{createdInSchemaUId:this.uId,modifiedInSchemaUId:this.uId,createdInPackageId:this.createdInPackageId});var t=Ext.create("Terrasoft.SchemaUsing",e);this.usings.add(t.uId,t)},getValidateFormulaServerMethodName:function(){return"ValidateProcessFormula"},shouldBeCompiled:function(){return this.isInterpretable=!0,this.flowElements.filter((function(e){return"ProcessScriptTaskSchema"===e.getTypeInfo().typeName})).each((function(e){e.useFlowEngineScriptVersion||(this.isInterpretable=!1)}),this),!this._isVersionSupported(this.createdInVersion)||this.useForceCompile||!this.isInterpretable},getContainsMultiInstanceElements:function(){var e=!1;return this.flowElements.each((function(t){if(t.getIsMultiInstanceSupported&&t.getIsMultiInstanceModeEnabled())return e=!0,!1}),this),e}}),Ext.define("Terrasoft.manager.ProcessSchemaManagerItem",{extend:"Terrasoft.BaseSchemaManagerItem",alternateClassName:"Terrasoft.ProcessSchemaManagerItem",instanceClassName:"Terrasoft.ProcessSchema",requestClassName:"Terrasoft.ProcessSchemaRequest",removeRequestClassName:"Terrasoft.ProcessSchemaRemoveRequest",updateRequestClassName:"Terrasoft.ProcessSchemaUpdateRequest",onAfterSave:function(e){this.setPropertyValue("isInterpretable",e.isInterpretable),this.instance.validatorInfo=e.validatorInfo,this.instance.validatorMessage=e.validatorMessage,e.schemaName&&(this.instance.name=e.schemaName),this.callParent(arguments)},getInstance:function(e,t){this.getInstanceWithResponse(e,t)}}),Ext.define("Terrasoft.manager.ProcessSchemaManager",{extend:"Terrasoft.manager.BaseProcessSchemaManager",alternateClassName:"Terrasoft.ProcessSchemaManager",singleton:!0,itemClassName:"Terrasoft.ProcessSchemaManagerItem",managerName:"ProcessSchemaManager",schemaManagerServiceName:"ServiceModel/ProcessSchemaManagerService.svc",serviceName:"ProcessSchemaManagerService",outdatedEventName:"ProcessSchema_Outdated",useNotification:!0,defSchemaUId:"bb4d6607-026b-4b27-b640-8f5c77c1e89d",addDefSchemaElements:function(e){var t=e.uId,r=this.createLaneSet(t),n=this.createLane(t,r.uId),i=this.createStartEvent(t,n.uId),a=this.createTerminateEvent(t,n.uId),s=this.createSequenceFlow(t);s.sourceRefUId=i.uId,s.targetRefUId=a.uId,e.add(r),e.add(n),e.add(i),e.add(a),e.add(s)},createLaneSet:function(e){var t=Ext.create("Terrasoft.ProcessLaneSetSchema",{uId:Terrasoft.generateGUID(),name:"LaneSet1",createdInSchemaUId:e,modifiedInSchemaUId:e});return t.setLocalizableStringPropertyValue("caption","LaneSet 1"),t},createLane:function(e,t){var r=Ext.create("Terrasoft.ProcessLaneSchema",{uId:Terrasoft.generateGUID(),name:"Lane1",containerUId:t,createdInSchemaUId:e,modifiedInSchemaUId:e});return r.setLocalizableStringPropertyValue("caption","Lane 1"),r},createStartEvent:function(e,t){return Ext.create("Terrasoft.ProcessStartEventSchema",{uId:Terrasoft.generateGUID(),name:"StartEvent1",position:"50;184",containerUId:t,createdInSchemaUId:e,modifiedInSchemaUId:e})},createTerminateEvent:function(e,t){return Ext.create("Terrasoft.ProcessTerminateEventSchema",{uId:Terrasoft.generateGUID(),name:"TerminateEvent1",position:"600;184",containerUId:t,createdInSchemaUId:e,modifiedInSchemaUId:e})},createSequenceFlow:function(e){return Ext.create("Terrasoft.ProcessSequenceFlowSchema",{uId:Terrasoft.generateGUID(),name:"SequenceFlow1",createdInSchemaUId:e,modifiedInSchemaUId:e})},createSchema:function(){var e=this.callParent(arguments);return e.name="",e.parentSchemaUId=this.defSchemaUId,e.isCreatedInSvg=!0,e.isInterpretable=!0,e.serializeToDB=!0,e.tag="Business Process",this.addDefSchemaElements(e),e},forceGetInstanceByUId:function(e,t,r){this.createManagerItem({uId:e}).forceGetInstance((function(e){t.call(r,e)}),this)},getSubProcessSchemaInstanceByUId:function(e,t,r){if(Terrasoft.isEmpty(e))Ext.callback(t,r,[null]);else{var n={uId:e};this.createManagerItem(n).forceGetInstanceByConfig({convertLocalizableStringToParameter:!1},t,r)}},getCanUseProcessVersions:function(){return!0}}),Ext.define("Terrasoft.Designers.ProcessSchemaDesignerViewModel5X",{extend:"Terrasoft.BaseViewModel",alternateClassName:"Terrasoft.ProcessSchemaDesignerViewModel5X",columns:{Items:{type:Terrasoft.ViewModelColumnType.VIRTUAL_COLUMN,dataValueType:Terrasoft.DataValueType.COLLECTION},SchemaUId:{type:Terrasoft.ViewModelColumnType.VIRTUAL_COLUMN,dataValueType:Terrasoft.DataValueType.GUID},Schema:{type:Terrasoft.ViewModelColumnType.VIRTUAL_COLUMN,dataValueType:Terrasoft.DataValueType.CUSTOM_OBJECT},SchemaManager:{type:Terrasoft.ViewModelColumnType.VIRTUAL_COLUMN,dataValueType:Terrasoft.DataValueType.CUSTOM_OBJECT}},id:null,sandbox:null,propertiesContainerId:null,appendMode:!1,newElement:null,newElementManagerItemUId:null,constructor:function(){this.callParent(arguments);var e=Ext.create("Terrasoft.Collection");this.set("Items",e),this.addEvents("initialized","itemschanged","itemChanged","itemSelected")},init:function(){Ext.EventManager.addListener(window,"message",this.onMessageReceived,this),this.sendMessage({message:"GetMetaData"})},onMessageReceived:function(e){var t=e.browserEvent;if(t.origin===this.getLocationOrigin()){var r=Terrasoft.decode(t.data);switch(r.message){case"ReadMetaData":this.loadProcessSchema(r);break;case"SetProperties":this.setItemProperties(r);break;case"RemoveItems":this.removeItems(r);break;case"SetExpectingAddElementState":this.setExpectingAddElementState(r);break;case"SetFocusedElementByName":this.setFocusedElementByName(r);break;case"SetSelectionMode":this.setSelectionMode(r)}}},loadProcessSchema:function(e){var t=e.metaData,r=Terrasoft.SchemaDesignerUtilities.createInstanceByMetaData({metaData:t,schemaClassName:"Terrasoft.EmbeddedProcessSchema5x",resources:e.resources});this.onSchemaLoaded(r)},setItemProperties:function(e){var t=this.get("Schema"),r=e.itemUId,n=r===t.uId?t:t.findItemByUId(r);if(n){var i=Terrasoft.decode(e.propertiesData);Terrasoft.each(i,(function(e,t){t=Terrasoft.toLowerCamelCase(t),n[t]instanceof Terrasoft.LocalizableString?e.values.forEach((function(e){!0===e.hasValue&&n.setLocalizableStringPropertyValue(t,e.value,e.name)}),this):(n.setPropertyValue(t,e),"position"===t&&"string"==typeof e&&(n.position=n.parsePoint(n.position)))}),this)}},removeItems:function(e){var t=this.get("Schema"),r=this.get("Items"),n=Terrasoft.decode(e.itemsUId);Terrasoft.each(n,(function(e){var n=t.findItemByUId(e.Id);null!=n&&(r.indexOf(n)>=0?(n.removeByDesignerEvent=!0,r.remove(n)):t.remove(n.name))}),this)},setExpectingAddElementState:function(e){this.removeNewElement(),this.appendMode=!0,this.newElementManagerItemUId=e.newElementManagerItemUId},setSelectionMode:function(){this.removeNewElement()},removeNewElement:function(){if(this.appendMode=!1,this.newElement){var e=this.get("Items");this.newElement.removeByDesignerEvent=!0,e.remove(this.newElement),this.postDiagramRemoveItem(this.newElement,!0),this.newElement=null}},setFocusedElementByName:function(e){var t=e.itemName;this.fireEvent("itemSelected",t)},addContainer:function(e,t,r){if(!t.find(r.name)){var n=r.parent;if(n){var i=e.flowElements.find(n);i&&this.addContainer(e,t,i)}var a=this.findIndexOfContainerOverItem(r,t);a?t.insert(a,r.name,r):(t.add(r.name,r),r.on("changed",this.onItemChanged,this))}},findIndexOfContainerOverItem:function(e,t){var r;return t.each((function(t,n){if(t.isContainer&&e.uId!==t.uId&&e.parent===t.parent&&e.position.X+e.width/2>t.position.X&&e.position.Y+e.height/2>t.position.Y&&e.position.X+e.width/2<t.position.X+t.width&&e.position.Y+e.height/2<t.position.Y+t.height)return r=n,!1}),this),r},onSchemaLoaded:function(e){var t=this.get("Items"),r=Ext.create("Terrasoft.Collection");e.lanes.each((function(e){r.add(e.name,e)}),this),e.flowElements.each((function(t){!0===t.isContainer&&this.addContainer(e,r,t)}),this),e.flowElements.each((function(t){if(!0!==t.isContainer){if(e.flowElementsParameters){var n=e.flowElementsParameters[t.uId];if(n){var i=t.parameters={};Terrasoft.each(n,(function(e){i[e.name]=e}),this),t.parameters=i}}if(t.nodeType!==Terrasoft.diagram.UserHandlesConstraint.Connector){var a=this.findIndexOfContainerOverItem(t,r);(a?r.insert(a,t.name,t):r.add(t.name,t)).on("changed",this.onItemChanged,this)}}}),this),e.flowElements.each((function(e){e.nodeType===Terrasoft.diagram.UserHandlesConstraint.Connector&&r.add(e.name,e).on("changed",this.onItemChanged,this)}),this),this.set("Schema",e),t.loadAll(r),t.on("remove",this.onItemRemove,this),t.on("add",this.onItemAdd,this,{priority:900}),this.fireEvent("initialized",this),this.sendMessage({message:"Initialized"})},onItemAdd:function(e){this.get("Schema").add(e),this.fireEvent("itemschanged",{action:"add",item:e}),this.postElementAdded(e),e.on("changed",this.onItemChanged,this)},onItemRemove:function(e){var t=this.get("Schema");!0!==e.removeByDesignerEvent&&this.postDiagramRemoveItem(e,!0),t.remove(e.name),this.fireEvent("itemschanged",{action:"remove",item:e}),e.un("changed",this.onItemChanged,this)},onConnectorsNodesChange:function(e){Terrasoft.each(e,(function(e){var t=this.getItemByName(e.name),r=this.getItemByName(e.targetNode),n=this.getItemByName(e.sourceNode);t.targetRefUId=r.uId,t.targetSequenceFlowPointLocalPosition=e.targetPort,t.sourceRefUId=n.uId,t.sourceSequenceFlowPointLocalPosition=e.sourcePort,this.postSequenceChanges([t]),this.postSelectingChanged(t.uId)}),this)},postSequenceChanges:function(e){var t=[],r=[];Terrasoft.each(e,(function(e){var n={targetRefUId:e.targetRefUId,sourceRefUId:e.sourceRefUId};e.sourceSequenceFlowPointLocalPosition&&(n.sourceSequenceFlowPointLocalPosition=e.getSerializablePortName(e.sourceSequenceFlowPointLocalPosition)),e.targetSequenceFlowPointLocalPosition&&(n.targetSequenceFlowPointLocalPosition=e.getSerializablePortName(e.targetSequenceFlowPointLocalPosition)),t.push(e.uId),r.push(n)})),this.postDiagramItemsPropertiesChanged(t,r)},onItemsPositionChanged:function(e){var t=this.get("Schema"),r=[],n=[];e.forEach((function(e){var i=e.itemName;t.changeItemPosition(i,e.position);var a=Math.floor(e.position.x)+";"+Math.floor(e.position.y),s=this.getItemByName(i);r.push(s.uId),n.push({Position:a})}),this),this.postDiagramItemsPropertiesChanged(r,n)},onItemsContainerChanged:function(e){var t=this.get("Schema"),r=[],n=[];e.forEach((function(e){var i=e.itemName,a=e.containerName;t.changeItemContainer(i,a);var s=this.getItemByName(i),o=this.getItemByName(a);r.push(s.uId),n.push({ContainerUId:o.uId})}),this),this.postDiagramItemsPropertiesChanged(r,n),1===r.length&&this.postSelectingChanged(r[0])},onPolylinePointPositionsChanged:function(e){var t=this.get("Schema"),r=[],n=[];e.forEach((function(e){var i=e.name,a=e.polylinePointPositions,s=this.getItemByName(i);t.changeSequenceFlowPolylinePointPositions(i,a);var o={};a.forEach((function(e,t){o["Item"+t]=Math.floor(e.x)+";"+Math.floor(e.y)})),r.push(s.uId),n.push({polylinePointPositions:o})}),this),this.postDiagramItemsPropertiesChanged(r,n)},onElementSizeChanged:function(e){var t=this.get("Schema"),r=e.itemName;t.changeItemSize(r,e.size);var n=this.getItemByName(r),i=Math.floor(e.size.width)+";"+Math.floor(e.size.height);this.postDiagramItemsPropertiesChanged([n.uId],[{Size:i}])},postDiagramItemsPropertiesChanged:function(e,t){this.sendMessage({message:"DiagramItemsPropertiesChanged",itemUIds:e,propertiesData:t})},onLinePositionChanged:function(e){this.get("Schema").changeLinePosition(e.itemName,e.position)},onGenerateItemNameAndCaption:function(e){for(var t=this.get("Schema"),r=this.get("Items"),n=1,i=e.name,a=i+n,s=this.get("Schema").inheritedElements,o=t.isEmbedded;this.containsCaseInsensitive(r,a,o)||this.containsCaseInsensitive(s,a,o);)a=i+ ++n;e.name=a,o&&(e.name+="_"+Terrasoft.formatGUID(e.uId,"N"));var l=e.caption.cultureValues;return Terrasoft.each(l,(function(e,t){e&&(l[t]=e+" "+n)})),!1},containsCaseInsensitive:function(e,t,r){var n=t.toLowerCase();return e.getKeys().some((function(e){return r?e.toLowerCase().indexOf(n)>-1:e.toLowerCase()===t.toLowerCase()}))},getItemByName:function(e){var t=this.get("Schema");return t.name===e?t:this.get("Items").get(e)},onDiagramClick:function(e){var t=e.element;if(t&&"pseudoGroup"!==t.type){var r=t.name;if(r){var n=this.getItemByName(r);n&&this.postSelectingChanged(n.uId)}}},postSelectingChanged:function(e){this.sendMessage({message:"SelectingChanged",itemUId:e})},onDiagramDoubleClick:function(e){if("doubletap"===e.evt.type){var t=e.element;t&&this.postElementDoubleClick(t)}},onItemChanged:function(e,t){this.fireEvent("itemChanged",t,e)},postElementAdded:function(e){var t=e.getUIJsonData(),r=Terrasoft.encode(t);this.sendMessage({message:"ElementAdded",managerItemUId:e.managerItemUId,jsonStringData:r})},postElementDoubleClick:function(e){var t=e.name,r=this.getItemByName(t);this.sendMessage({message:"ElementDoubleClick",itemUId:r.uId})},postDiagramRemoveItem:function(e,t){var r=Ext.create("Terrasoft.Collection");r.add(e.name,e),this.postDiagramRemoveItems(r,t)},postDiagramRemoveItems:function(e,t){var r=[];e.each((function(e){r.push(e.uId)})),this.sendMessage({message:"DiagramRemoveItems",itemUIds:r,silentRemoveMode:t})},onItemsRemoving:function(e){var t=e.itemNameList[0],r=this.getItemByName(t);return this.postDiagramRemoveItem(r),!1},onDestroy:function(){var e=this.get("Items");e.destroy();var t=this.get("Schema");t&&t.destroy(),this.callParent(arguments)},onInsertNodeInConnector:function(e,t){var r=this.get("Items"),n=r.get(e),i=r.get(t.name),a=i.insertFlowElement(n);return t.targetPort=i.targetSequenceFlowPointLocalPosition,this.onGenerateItemNameAndCaption(a),r.add(a.name,a),this.postSequenceChanges([a,i]),this.postElementDoubleClick(a),this.postSelectingChanged(n.uId),!1},getLocationOrigin:function(){var e=window.location.origin;return e||(e=window.location.protocol+"//"+window.location.hostname+(window.location.port?":"+window.location.port:"")),e},sendMessage:function(e){var t=this.get("SchemaUId");e.schemaUId=t;var r=Terrasoft.encode(e),n=this.getLocationOrigin();window.parent.postMessage(r,n)}}),Ext.define("Terrasoft.manager.EmbeddedProcessSchema5x",{extend:"Terrasoft.ProcessSchema",alternateClassName:"Terrasoft.EmbeddedProcessSchema5x",convertedMethodsSchemaUIdList:null,userDefinedCode:null}),Ext.define("Terrasoft.Designers.ProcessSchemaDesigner5X",{extend:"Terrasoft.BaseSchemaDesigner",alternateClassName:"Terrasoft.ProcessSchemaDesigner5X",diagram:null,designerViewModel:null,init:function(){Terrasoft.ClientUnitSchemaManager.initialize=function(e,t){e.call(t)},this.callParent(arguments)},getImageConfig:function(e){return{source:Terrasoft.ImageSources.RESOURCE_MANAGER,params:{resourceManagerName:"Terrasoft.Nui",resourceItemName:e}}},renderDesignContainer:function(){var e=this.designContainer=this.createDesignContainer(),t=this.designerViewModel=this.createDesignerViewModel();e.render(this.renderTo),e.bind(t),t.on("initialized",(function(){this.fireEvent("loadcomplete",this)}),this),t.on("itemschanged",this.onProcessSchemaItemAdd,this),t.on("itemChanged",this.onItemChanged,this),t.on("itemSelected",this.onProcessSchemaItemSelected,this),t.init()},createDesignerViewModel:function(){return Ext.create("Terrasoft.ProcessSchemaDesignerViewModel5X",{sandbox:this.sandbox,id:this.id,values:{SchemaUId:this.schemaUId}})},render:function(e){this.renderTo=e.renderTo,Terrasoft.ProcessFlowElementSchemaManager.initialize(this.renderDesignContainer,this),Ext.getBody().set({maskState:"none"})},createDesignContainer:function(){var e=this.callParent(arguments),t=this.diagram=Ext.create("Terrasoft.ProcessSchemaDiagram5X",{id:this.id,classes:{wrapClassName:["ej-diagram","ts-box-sizing"]},items:{bindTo:"Items"},click:{bindTo:"onDiagramClick"},doubleClick:{bindTo:"onDiagramDoubleClick"},connectorsNodesChange:{bindTo:"onConnectorsNodesChange"},itemsContainerChanged:{bindTo:"onItemsContainerChanged"},itemsPositionChanged:{bindTo:"onItemsPositionChanged"},textChange:{bindTo:"onTextChange"},itemsRemoving:{bindTo:"onItemsRemoving"},sizeChanged:{bindTo:"onElementSizeChanged"},generateItemNameAndCaption:{bindTo:"onGenerateItemNameAndCaption"},polylinePointPositionsChanged:{bindTo:"onPolylinePointPositionsChanged"},insertNodeInConnector:{bindTo:"onInsertNodeInConnector"}});t.on("doubleClick",this.onElementDoubleClick,this),t.on("mouseMove",this.onDiagramMouseMove,this),t.on("mouseUp",this.onDiagramMouseUp,this);var r=Ext.create("Terrasoft.Container",{id:this.id+"-diagram-ct",classes:{wrapClassName:["diagram","ts-box-sizing"]},items:[t]}),n=Ext.create("Terrasoft.Container",{id:this.id+"-content",classes:{wrapClassName:["content","ts-box-sizing"]},items:[r]});return e.add(n),e},onProcessSchemaItemAdd:function(){Ext.get("diagram-"+this.id).focus()},onGetElementData:function(e){return this.designerViewModel.getItemByName(e)},onElementClick:function(){},onElementDoubleClick:function(){this.diagram.updatePageSize()},onItemChanged:function(e,t){var r=this.diagram,n=r.getInstance(),i=r.getElementById(e.name);if(i){if(t.hasOwnProperty("caption")){var a=e.caption,s=null==a?"":a.getValue();r.setNodeCaption(e.name,s)}if(t.hasOwnProperty("targetRefUId")){var o=this.designerViewModel.get("Schema").findItemByUId(e.targetRefUId);if(o)i.targetNode=o.name,ej.Diagram.Util.dock(i,n.nameTable),n.updateConnector(i.name,{}),r.getElementById(o.name).inEdges.push(i.name),n.updateNode(o.name,{})}}},onProcessSchemaItemSelected:function(e){var t=this.diagram,r=t.getElementById(e);if(r){var n=t.getSelectedItem();if(n&&("pseudoGroup"===n.type||n.name===r.name))return;t.setSelection(r)}},onDiagramMouseMove:function(e){var t=this.designerViewModel;t.appendMode&&(t.newElement||(t.newElement=this.addNewElement(e)),this.moveNewElement(e))},onDiagramMouseUp:function(e){var t=this.designerViewModel;t.appendMode&&(t.appendMode=!1,t.newElement?t.newElement=null:this.addNewElement(e));var r=this.diagram.getSelectedItem();if(r&&"pseudoGroup"!==r.type){var n=t.get("Items").find(r.name);n&&n.showPropertiesWindowOnAdding&&(n.showPropertiesWindowOnAdding=!1,t.postElementDoubleClick(n))}},addNewElement:function(e){var t=this.designerViewModel,r=this.diagram,n=t.get("Schema"),i=n.createItemInstance({managerItemUId:t.newElementManagerItemUId});i.uId=Terrasoft.generateGUID(),t.onGenerateItemNameAndCaption(i);var a=r.getOffsetMousePosition(e);i.position={X:a.x,Y:a.y};var s=r.findTargetLane(a),o=n.findItemByName(s.name);i.containerUId=o.uId,i.parent=o.name,i.preventShowPropertiesWindowOnAdding||(i.showPropertiesWindowOnAdding=!0),t.get("Items").add(i.name,i);var l=r.getInstance();l._clearSelection(),l.activateTool("move"),l.activeTool.inAction=!0;var c=r.getElementById(i.name);return l.activeTool.newObject=c,i},moveNewElement:function(e){var t=this.designerViewModel,r=this.diagram,n=r.getElementById(t.newElement.name),i=r.getOffsetMousePosition(e);n.offsetX=i.x,n.offsetY=i.y;var a=r.getInstance();ej.Diagram.DiagramContext.update(n,a);var s=a.activeTool;s&&"move"===s.name&&!s.inAction&&(a._clearSelection(),s.inAction=!0,s.newObject=n)},onDestroy:function(){this.designerViewModel&&this.designerViewModel.destroy(),this.callParent(arguments)}}),Ext.define("Terrasoft.core.ProcessSchemaResponse",{extend:"Terrasoft.BaseSchemaResponse",alternateClassName:"Terrasoft.ProcessSchemaResponse",schemaClassName:"Terrasoft.ProcessSchema",contractName:"ProcessSchemaResponse",createSchemaInstance:function(e){return Terrasoft.SchemaDesignerUtilities.createInstanceByMetaData({metaData:e.metaData,lazyProperties:e.lazyProperties,schemaClassName:this.schemaClassName,resources:e.resources})}}),Ext.define("Terrasoft.mixins.ObservableItem",{alternateClassName:"Terrasoft.ObservableItem",itemEventHandlers:null,items:null,_attributeChangeHandlers:null,useItemInitialValues:!1,useViewModelToItemBinding:!1,_getItemPropertyValue:function(e,t){var r=e.getPropertyValue(t);return Terrasoft.isInstanceOfClass(r,"Terrasoft.LocalizableString")&&(r=r.getValue()),r},_setItemPropertyValue:function(e,t,r){var n=e.getPropertyValue(t);Terrasoft.isInstanceOfClass(n,"Terrasoft.LocalizableString")?e.setLocalizableStringPropertyValue(t,r):e.setPropertyValue(t,r)},_applyItemInitialValues:function(e){this.useItemInitialValues&&Terrasoft.each(this.getAttributeMap(),(function(t,r){this.set(t,this._getItemPropertyValue(e,r),{skipValidation:!0})}),this)},_initAttributeChangeHandlers:function(){this._attributeChangeHandlers||(this._attributeChangeHandlers={})},_subscribeItemOnViewModelChange:function(e){this.useViewModelToItemBinding&&(this._initAttributeChangeHandlers(),Terrasoft.each(this.getAttributeMap(),(function(t,r){var n=Ext.String.format("change:{0}",t);this._attributeChangeHandlers[n]=function(t,n){this._setItemPropertyValue(e,r,n)},this.on(n,this._attributeChangeHandlers[n],this)}),this))},_unsubscribeItemOnViewModelChange:function(){this.useViewModelToItemBinding&&Terrasoft.each(this.getAttributeMap(),(function(e){var t=Ext.String.format("change:{0}",e);this.un(t,this._attributeChangeHandlers[t],this)}),this)},getAttributeMap:function(){return{}},getAttributeName:function(e){return this.getAttributeMap()[e]},subscribeOnItemChanged:function(e){this.items=this.items||[],this.itemEventHandlers=this.itemEventHandlers||{},this.itemEventHandlers[e.instanceId]=function(){this.onItemEventFired(e,arguments)}.bind(this),this.items.push(e),e.on("changed",this.itemEventHandlers[e.instanceId],this),this._applyItemInitialValues(e),this._subscribeItemOnViewModelChange(e)},unsubscribeAllItems:function(){this.itemEventHandlers&&Terrasoft.each(this.items,(function(e){e.un("changed",this.itemEventHandlers[e.instanceId],this)}),this),this._attributeChangeHandlers&&this._unsubscribeItemOnViewModelChange()},getItemAttributeValue:function(e,t){return this._getItemPropertyValue(e,t)},onItemEventFired:function(e,t){var r=Object.keys(t[0]);Terrasoft.each(r,(function(t){var r=this.getAttributeName(t);this.set(r,this.getItemAttributeValue(e,t))}),this)}}),Ext.define("Terrasoft.manager.FormulaMacros",{alternateClassName:"Terrasoft.FormulaMacros",statics:{prepareEntityColumnParameterValue:function(e,t,r){var n=Terrasoft.process.constants,i=Ext.create("Terrasoft.FormulaMacros");return i.addParameter(n.PARAMETER_IS_OWNER_SCHEMA),i.addParameter(n.PARAMETER_IS_SCHEMA),i.addParameter(Ext.String.format(n.PARAMETER_ELEMENT_TEMPLATE,e)),i.addParameter(Ext.String.format(n.PARAMETER_PARAMETER_TEMPLATE,t)),i.addParameter(Ext.String.format(n.PARAMETER_ENTITY_COLUMN_TEMPLATE,r)),i},prepareEntityColumnParameterDisplayValue:function(e,t,r){var n=Ext.create("Terrasoft.FormulaMacros");return n.addParameter(e),n.addParameter(t),n.addParameter(r),n},prepareProcessParameterValue:function(e){var t=Terrasoft.process.constants,r=Ext.create("Terrasoft.FormulaMacros");return r.addParameter(t.PARAMETER_IS_OWNER_SCHEMA),r.addParameter(t.PARAMETER_IS_SCHEMA),r.addParameter(Ext.String.format(t.PARAMETER_PARAMETER_TEMPLATE,e)),r},preparePropertyValue:function(){var e=Terrasoft.process.constants,t=Ext.create("Terrasoft.FormulaMacros");return t.addParameter(e.CAPTION_PROPERTY_VALUE_MACROS),t},preparePropertyDisplayValue:function(e){var t=Ext.create("Terrasoft.FormulaMacros");return t.addParameter(e),t},prepareProcessElementParameterValue:function(e,t){var r=Terrasoft.process.constants,n=Ext.create("Terrasoft.FormulaMacros");return n.addParameter(r.PARAMETER_IS_OWNER_SCHEMA),n.addParameter(r.PARAMETER_IS_SCHEMA),n.addParameter(Ext.String.format(r.PARAMETER_ELEMENT_TEMPLATE,e)),n.addParameter(Ext.String.format(r.PARAMETER_PARAMETER_TEMPLATE,t)),n},prepareProcessElementParameterDisplayValue:function(e,t){var r=Ext.create("Terrasoft.FormulaMacros");return r.addParameter(e),r.addParameter(t),r},prepareSysSettingValue:function(e,t){var r=Terrasoft.process.constants,n=Ext.create("Terrasoft.FormulaMacros");return n.addParameter(r.SYS_SETTINGS_PREFIX),n.addParameter(Ext.String.format(r.SYS_SETTING_VALUE_TEMPLATE,e,t)),n},prepareSysSettingDisplayValue:function(e){var t=Ext.create("Terrasoft.FormulaMacros");return t.addParameter(Terrasoft.Resources.ProcessSchemaDesigner.Functions.SysSettingsDisplayPrefix),t.addParameter(e),t},prepareLookupValue:function(e,t){var r=Ext.create("Terrasoft.FormulaMacros");return r.addParameter(Terrasoft.process.constants.LOOKUP_VALUE_PREFIX),r.addParameter(e),r.addParameter(t),r},prepareLookupDisplayValue:function(e,t){var r=Ext.create("Terrasoft.FormulaMacros");return r.addParameter(Terrasoft.Resources.ProcessSchemaDesigner.Functions.LookupValueDisplayPrefix),r.addParameter(e),r.addParameter(t),r},prepareMainRecordValue:function(e){var t=Ext.create("Terrasoft.FormulaMacros");return t.addParameter(Terrasoft.process.constants.COLUMN_VALUE_PREFIX),t.addParameter(e),t},prepareMainRecordValueFromUIdArray:function(e){return(e=e.map((function(e){return Ext.String.format("{{0}}",e)}),this)).unshift(Terrasoft.process.constants.COLUMN_VALUE_PREFIX),Ext.create("Terrasoft.FormulaMacros",{parameters:e})},prepareMainRecordDisplayValue:function(e){var t=Ext.create("Terrasoft.FormulaMacros");return t.addParameter(Terrasoft.Resources.ProcessSchemaDesigner.Functions.MainRecordDisplayPrefix),t.addParameter(e),t},prepareBooleanValue:function(e){var t=Ext.create("Terrasoft.FormulaMacros");return t.addParameter(Terrasoft.process.constants.BOOLEAN_MACROS_PREFIX),t.addParameter(e),t},prepareBooleanDisplayValue:function(e){var t=Ext.create("Terrasoft.FormulaMacros");return t.addParameter(Terrasoft.Resources.ProcessSchemaDesigner.Functions.BooleanDisplayPrefix),t.addParameter(e),t},prepareSysVariableValue:function(e){var t=Ext.create("Terrasoft.FormulaMacros");return t.addParameter(Terrasoft.process.constants.SYS_VARIABLE_PREFIX),t.addParameter(e),t},prepareSysVariableDisplayValue:function(e){var t=Ext.create("Terrasoft.FormulaMacros");return t.addParameter(Terrasoft.Resources.ProcessSchemaDesigner.Functions.SysVariableDisplayPrefix),t.addParameter(e),t},from:function(e){var t=[];(e instanceof Terrasoft.FormulaMacros&&(e=e.toString()),Ext.isString(e))&&(t=Terrasoft.ProcessSchemaDesignerUtilities.removeParameterMask(e).split(Terrasoft.process.constants.MACROS_SEPARATOR));return Ext.create("Terrasoft.FormulaMacros",{parameters:t})},createFromString:function(e){return Terrasoft.FormulaMacros.from(e)}},parameters:null,constructor:function(e){this.callParent(arguments),this.parameters=e&&e.parameters?e.parameters:[]},getMetaPath:function(){return this.getChain(2)},getHasOneParameter:function(){return 1===this.parameters.length},getParameterAfterPrefix:function(){return this.parameters[1]},getSysSettingsCode:function(){return Terrasoft.first(this.getParameterAfterPrefix().split("<"))},isMainRecordColumn:function(){return!Ext.isEmpty(this.parameters)&&this.getPrefix()===Terrasoft.process.constants.COLUMN_VALUE_PREFIX},isEmpty:function(){return Ext.isEmpty(this.parameters)},isValid:function(){var e=!this.isEmpty();return e&&(e=Ext.Array.every(this.getParametersWithoutPrefix(),(function(e){return!Ext.isEmpty(e)&&this._parameterNotFoundValidator(e)}),this)),e},_parameterNotFoundValidator:function(e){return e!==Terrasoft.Resources.ProcessSchemaDesigner.Messages.EntityNotFoundMessage},getChainWithoutPrefix:function(){return this.getChain(1)},getChain:function(e,t){return t=t||this.parameters.length,e=e||0,this.parameters.slice(e,t).join(Terrasoft.process.constants.MACROS_SEPARATOR)},getParametersWithoutPrefix:function(){return this.parameters.slice(1)},getParameters:function(){return this.parameters},addParameter:function(e){this.parameters.push(e)},getPrefix:function(){return Terrasoft.first(this.parameters)},getBody:function(){return this.getChain()},containsPrefix:function(e){return this.getPrefix()===e},toString:function(){return Terrasoft.ProcessSchemaDesignerUtilities.addParameterMask(this.getBody())}}),Ext.define("Terrasoft.manager.FormulaParser",{extend:"Terrasoft.BaseObject",alternateClassName:"Terrasoft.FormulaParser",resources:Terrasoft.Resources.ProcessSchemaDesigner,functions:Terrasoft.Resources.ProcessSchemaDesigner.Functions,exceptions:Terrasoft.Resources.ProcessSchemaDesigner.Exceptions,constants:Terrasoft.process.constants,schema:null,formula:null,formulaParameters:null,unrecognizedMacroses:null,currentMacros:null,nextIteration:null,getMacrosHandlers:Terrasoft.emptyFn,defaultMacrosHandler:Terrasoft.emptyFn,constructor:function(e){this.callParent(arguments),this.formula=e.formula,this.schema=e.schema,this.formulaParameters=Ext.create("Terrasoft.Collection"),this.unrecognizedMacroses=[]},parse:function(e,t){Terrasoft.eachAsync(this.getMacrosesArray(),(function(e,t){var r=e[0],n=this.formulaParameters.find(r);2!==e.length||n?t():(this.currentMacros=Terrasoft.FormulaMacros.from(r),this.nextIteration=t,this.startHandler())}),(function(){e.call(t,this.formulaParameters,this.unrecognizedMacroses)}),this)},getMacrosesArray:function(){var e,t=[];do{(e=Terrasoft.process.constants.PARAMETER_REGEX.exec(this.formula))&&t.push(e)}while(e);return t},startHandler:function(){var e=this.getMacrosHandlers().find(this.currentMacros.getPrefix());e||(e=this.defaultMacrosHandler),e.call(this,this.currentMacros)},endHandler:function(e){var t=e.getBody();if(!Ext.isEmpty(t)){var r=this.currentMacros.toString();this.formulaParameters.find(r)||this.formulaParameters.add(r,e.toString())}this.nextIteration.call(this)},endHandlerWithError:function(){var e=Ext.String.format.apply(this,arguments),t=this.currentMacros.getBody();this.logFormulaError(t,e),this.unrecognizedMacroses.push({unrecognizedMacros:t,message:e}),this.nextIteration.call(this)},logFormulaError:function(e,t){var r=Terrasoft.Resources.ProcessSchemaDesigner.Messages.InvalidFormulaMessage,n=Ext.String.format(r,e,t);this.log(n,Terrasoft.LogMessageType.WARNING)}}),Ext.define("Terrasoft.manager.FormulaValueParser",{extend:"Terrasoft.FormulaParser",alternateClassName:"Terrasoft.FormulaValueParser",getMacrosHandlers:function(){var e=Ext.create("Terrasoft.Collection");return e.add(this.constants.SYS_SETTINGS_PREFIX,this.sysSettingsMacrosHandler),e.add(this.constants.LOOKUP_VALUE_PREFIX,this.lookupMacrosHandler),e.add(this.constants.COLUMN_VALUE_PREFIX,this.mainRecordMacrosHandler),e.add(this.constants.BOOLEAN_MACROS_PREFIX,this.booleanMacrosHandler),e.add(this.constants.CAPTION_PROPERTY_VALUE_MACROS,this.propertyValueMacrosHandler),e.add(this.constants.SYS_VARIABLE_PREFIX,this.sysVariableMacrosHandler),e.add(this.constants.DATE_VALUE_PREFIX,this.dateMacrosHandler),e.add(this.constants.TIME_VALUE_PREFIX,this.timeMacrosHandler),e.add(this.constants.DATE_TIME_VALUE_PREFIX,this.dateTimeMacrosHandler),e},defaultMacrosHandler:function(e){var t=Terrasoft.FormulaParserUtils.getParameterMappingInfo(e.getBody());Terrasoft.FormulaParserUtils.getParameterDisplayValue(t,this.schema,(function(t){var r=Ext.create("Terrasoft.FormulaMacros");t?(r.addParameter(t),this.endHandler(r)):this.endHandlerWithError(this.exceptions.InvalidParameterMessage,e.getPrefix())}),this)},sysSettingsMacrosHandler:function(e){var t=Terrasoft.ServiceProvider,r=e.getSysSettingsCode(),n={sysSettingsNameCollection:[r]};t.executeRequest(Terrasoft.SysSettings.querySettingsMethodName,n,(function(e){var t=e.values[r];if(!t){var n=this.resources.Messages.SysSettingValueNotFoundMessage,i=Ext.String.format(n,r);this.log(i,Terrasoft.LogMessageType.WARNING)}var a=t?t.name:"",s=Terrasoft.FormulaMacros.prepareSysSettingDisplayValue(a);this.endHandler(s)}),this)},lookupMacrosHandler:function(e){var t=this.schema.getPackageUId();Terrasoft.FormulaParserUtils.getLookupDisplayValue(e.getBody(),t,(function(e){var t;e.errorMessage?(t=Ext.create("Terrasoft.FormulaMacros")).addParameter(e.errorMessage):t=Terrasoft.FormulaMacros.prepareLookupDisplayValue(e.schemaDisplayValue,e.value),this.endHandler(t)}),this)},mainRecordMacrosHandler:function(e){this.schema.entitySchema.getColumnCaptionPathByMetaPath(e.getChainWithoutPrefix(),(function(e){var t=Terrasoft.FormulaMacros.prepareMainRecordDisplayValue(e);this.endHandler(t)}),this)},booleanMacrosHandler:function(e){var t;switch(e.getParameterAfterPrefix()){case this.constants.BOOLEAN_MACROS_TRUE_VALUE:t=this.functions.BooleanDisplayTrueValue;break;case this.constants.BOOLEAN_MACROS_FALSE_VALUE:t=this.functions.BooleanDisplayFalseValue;break;default:return void this.endHandlerWithError(Terrasoft.Resources.Exception.NotImplementedException)}var r=Terrasoft.FormulaMacros.prepareBooleanDisplayValue(t);this.endHandler(r)},propertyValueMacrosHandler:function(e){var t;switch(e.getPrefix()){case this.constants.CAPTION_PROPERTY_VALUE_MACROS:t=this.functions.CaptionPropertyValueDisplayPrefix;break;default:return void this.endHandlerWithError(Terrasoft.Resources.Exception.NotImplementedException)}var r=Terrasoft.FormulaMacros.preparePropertyDisplayValue(t);this.endHandler(r)},sysVariableMacrosHandler:function(e){var t=e.getParameterAfterPrefix(),r="";this.constants.SYS_VARIABLES.some((function(e){if(e.value===t)return r=e.displayValue,!0}));var n=Terrasoft.FormulaMacros.prepareSysVariableDisplayValue(r);this.endHandler(n)},dateMacrosHandler:function(e){this.baseDateTimeMacrosHandler(Terrasoft.DataValueType.DATE,e)},timeMacrosHandler:function(e){this.baseDateTimeMacrosHandler(Terrasoft.DataValueType.TIME,e)},dateTimeMacrosHandler:function(e){this.baseDateTimeMacrosHandler(Terrasoft.DataValueType.DATE_TIME,e)},baseDateTimeMacrosHandler:function(e,t){var r=t.getChainWithoutPrefix(),n=Terrasoft.FormulaParserUtils.getDateTimeValueFormatConfig(e),i=Ext.Date.parse(r,n.valueFormat)||Ext.Date.parse(r,n.displayFormat),a=Ext.Date.format(i,n.displayFormat),s=n.displayPrefix.slice(0,-1),o=Ext.create("Terrasoft.FormulaMacros");o.addParameter(s),o.addParameter(a),this.endHandler(o)}}),Ext.define("Terrasoft.manager.FormulaDisplayValueParser",{extend:"Terrasoft.FormulaParser",alternateClassName:"Terrasoft.FormulaDisplayValueParser",_findEntitySchemaInstance:function(e,t,r){Terrasoft.Features.getIsEnabled("AutoAddPackageDependenciesInProcesses")?Terrasoft.EntitySchemaManager.findAggregatedSchemaInstance(e,t,r):Terrasoft.EntitySchemaManager.findBundleSchemaInstance(e,t,r)},getMacrosHandlers:function(){var e=Ext.create("Terrasoft.Collection");return e.add(this.functions.SysSettingsDisplayPrefix,this.sysSettingsMacrosHandler),e.add(this.functions.LookupValueDisplayPrefix,this.lookupMacrosHandler),e.add(this.functions.MainRecordDisplayPrefix,this.mainRecordMacrosHandler),e.add(this.functions.BooleanDisplayPrefix,this.booleanMacrosHandler),e.add(this.functions.SysVariableDisplayPrefix,this.sysVariableMacrosHandler),e.add(this.functions.CaptionPropertyValueDisplayPrefix,this.propertyValueMacrosHandler),e.add(this.functions.DateValueDisplayPrefix,this.dateMacrosHandler),e.add(this.functions.TimeValueDisplayPrefix,this.timeMacrosHandler),e.add(this.functions.DateTimeValueDisplayPrefix,this.dateTimeMacrosHandler),e},defaultMacrosHandler:function(e){this.processParameterMacrosChainHandler(e)},sysSettingsMacrosHandler:function(e){var t=Terrasoft.ServiceProvider,r=e.getChainWithoutPrefix(),n={sysSettingsNameCollection:[r],columnName:"Name"};t.executeRequest(Terrasoft.SysSettings.querySettingsMethodName,n,(function(e){if(e.success&&e.values.hasOwnProperty(r)){var t=e.values[r],n=t.code,i=Terrasoft.FormulaMacros.prepareSysSettingValue(n,t.typeName);this.endHandler(i)}else this.endHandlerWithError(this.exceptions.InvalidSysSettingMessage,r)}),this)},_findTopExtendedPackageItemCaption:function(e,t){var r;return(null===(r=e.filter((function(e){return e.getName()===t.getName()})).last())||void 0===r?void 0:r.getCaption())||t.getCaption()},_findSchemaItemByCaption:function(e,t){var r=this;return e.findByFn((function(n){return n.getCaption()===t&&r._findTopExtendedPackageItemCaption(e,n)===t}))},lookupMacrosHandler:function(e){var t=e.getParameterAfterPrefix(),r=Terrasoft.getEnumerator(e.getParametersWithoutPrefix()),n=null,i=null;Terrasoft.chain((function(e){Terrasoft.EntitySchemaManager.initialize(e,this)}),(function(e){Terrasoft.EntitySchemaManager.findSortedByTopologyItems({includeExtensionItems:!0,callback:e,scope:this})}),(function(e,n){var i=this,a=this.findElementWithDotsInCaption(r,(function(e){return i._findSchemaItemByCaption(n,e)}),this).element;if(a){var s=Terrasoft.EntitySchemaManager.findRootSchemaItemByName(a.name),o={schemaUId:s.uId,packageUId:s.packageUId};this._findEntitySchemaInstance(o,e,this)}else this.endHandlerWithError(this.exceptions.InvalidEntitySchemaMessage,t)}),(function(e,a){a?(i=a.uId,(n=this.getParametersChainFromIterator(r))?this.prepareLookupEntitySchemaQuery(a,n).getEntityCollection(e,this):this.endHandlerWithError(this.exceptions.InvalidLookupEmptyValueMessage)):this.endHandlerWithError(this.exceptions.InvalidEntitySchemaMessage,t)}),(function(e,t){var r=this.getLookupItemFromResponce(t);if(!r)return t.errorInfo&&this.log(t.errorInfo.message),void this.endHandlerWithError(this.exceptions.InvalidLookupValueMessage,n);var a=r.get("Id"),s=Terrasoft.FormulaMacros.prepareLookupValue(i,a);this.endHandler(s)}),this)},mainRecordMacrosHandler:function(e){var t=this.schema.entitySchema;if(t){var r=e.getChainWithoutPrefix();t.getColumnMetaPathByCaptionPath(r,(function(e){if(e){var t=Terrasoft.FormulaMacros.prepareMainRecordValue(e);this.endHandler(t)}else this.endHandlerWithError(this.exceptions.InvalidMainRecordPathMessage)}),this)}else this.endHandlerWithError(this.exceptions.InvalidMainRecordUsageMessage)},booleanMacrosHandler:function(e){var t,r=e.getParameterAfterPrefix();switch(r){case this.functions.BooleanDisplayTrueValue:t=this.constants.BOOLEAN_MACROS_TRUE_VALUE;break;case this.functions.BooleanDisplayFalseValue:t=this.constants.BOOLEAN_MACROS_FALSE_VALUE;break;default:return void this.endHandlerWithError(this.exceptions.InvalidBooleanValueMessage,r)}var n=Terrasoft.FormulaMacros.prepareBooleanValue(t);this.endHandler(n)},propertyValueMacrosHandler:function(){var e=this.constants.PROPERTY_VALUE_MACROS_CAPTION,t=Terrasoft.FormulaMacros.preparePropertyValue(e);this.endHandler(t)},sysVariableMacrosHandler:function(e){var t=e.getChainWithoutPrefix(),r="";if(this.constants.SYS_VARIABLES.some((function(e){if(e.displayValue===t)return r=e.value,!0})),r){var n=Terrasoft.FormulaMacros.prepareSysVariableValue(r);this.endHandler(n)}else this.endHandlerWithError(this.exceptions.InvalidSysVariableMessage,t)},dateMacrosHandler:function(e){this.baseDateTimeMacrosHandler(Terrasoft.DataValueType.DATE,e)},timeMacrosHandler:function(e){this.baseDateTimeMacrosHandler(Terrasoft.DataValueType.TIME,e)},dateTimeMacrosHandler:function(e){this.baseDateTimeMacrosHandler(Terrasoft.DataValueType.DATE_TIME,e)},baseDateTimeMacrosHandler:function(e,t){var r=Terrasoft.FormulaParserUtils.getDateTimeValueFormatConfig(e),n=t.getBody().substr(r.displayPrefix.length),i=Ext.Date.parse(n,r.displayFormat);if(i){var a=Ext.Date.format(i,r.valueFormat),s=r.valuePrefix.slice(0,-1),o=Ext.create("Terrasoft.FormulaMacros");o.addParameter(s),o.addParameter(a),this.endHandler(o)}else this.endHandlerWithError(r.invalidMessageTemplate,n)},processParameterMacrosChainHandler:function(e){var t=this.schema.findParameterByCaption(e.getBody());if(t){var r=Terrasoft.FormulaMacros.prepareProcessParameterValue(t.uId);this.endHandler(r)}else e.getHasOneParameter()?this.endHandlerWithError(this.exceptions.InvalidParameterMessage,e.getPrefix()):this.processElementParameterMacrosChainHandler(e)},processElementParameterMacrosChainHandler:function(e){var t=this.prepareElementParameterConfig(e);if(t.flowElement)if(t.parameter){var r=t.flowElement;if(this.getIsElementParameter(t))if(this.getIsFunctionParameter(t))this.functionResultMacrosChainHandler(r);else{var n=Terrasoft.FormulaMacros.prepareProcessElementParameterValue(r.uId,t.parameter.uId);this.endHandler(n)}else this.entityColumnElementParameterMacrosChainHandler(e,t)}else this.endHandlerWithError(this.exceptions.InvalidParameterMessage,t.parameterCaption);else this.endHandlerWithError(this.exceptions.InvalidFlowElementMessage,e.getPrefix())},entityColumnElementParameterMacrosChainHandler:function(e,t){var r=t.entitySchemaCaption,n=t.flowElement,i=t.parameter,a=i.referenceSchemaUId;if(a){var s={schemaUId:a,packageUId:this.schema.getPackageUId()};this._findEntitySchemaInstance(s,(function(t){var a;if(t){var s=this.findEntityColumnByCaption(t,r);if(!s)return void this.endHandlerWithError(this.exceptions.InvalidColumnMessage,r);a=Terrasoft.FormulaMacros.prepareEntityColumnParameterValue(n.uId,i.uId,s.uId)}else a=e;this.endHandler(a)}),this)}else this.endHandlerWithError(this.exceptions.InvalidSchemaUIdMessage)},prepareElementParameterConfig:function(e){var t={},r=Terrasoft.getEnumerator(e.getParameters()),n=this.findElementWithDotsInCaption(r,(function(e){return this.schema.findItemByCaption(e)}),this);if(t.flowElement=n.element,t.flowElementCaption=n.caption,t.flowElement){var i=this.findElementWithDotsInCaption(r,(function(e){return t.flowElement.findParameterByCaption(e)}),this);t.parameter=i.element,t.parameterCaption=i.caption,t.entitySchemaCaption=this.getParametersChainFromIterator(r)}return t},getIsElementParameter:function(e){return Ext.isEmpty(e.entitySchemaCaption)},getIsFunctionParameter:function(e){var t=this.constants.READ_DATA_USER_TASK_SCHEMA_UID,r=this.functions.FunctionResultCaption,n=e.flowElement.managerItemUId===t,i=e.parameterCaption===r;return n&&i},findElementWithDotsInCaption:function(e,t,r){var n,i,a=Ext.create("Terrasoft.FormulaMacros");do{a.addParameter(e.next()),n=a.getBody(),i=t.call(r,n)}while(!i&&e.hasNext());return{element:i,caption:i?n:a.getPrefix()}},findEntityColumnByCaption:function(e,t){return e.columns.firstOrDefault((function(e){var r=e.caption;return r&&r.getValue()===t}))},functionResultMacrosChainHandler:function(e){var t=this.functions.FunctionResultCaption,r=e.caption,n=e.findParameterByName("AggregationColumnName").getValue(),i={schemaUId:e.findParameterByName("ResultEntity").referenceSchemaUId,packageUId:e.getPackageUId()};this._findEntitySchemaInstance(i,(function(i){var a=this.findColumnDataValueType(i,n),s=this.getFunctionResultParameter(e,a);if(s){var o=Terrasoft.FormulaMacros.prepareProcessElementParameterValue(e.uId,s.uId);this.endHandler(o)}else this.endHandlerWithError(this.exceptions.InvalidParameterOfFlowElementMessage,t,r)}),this)},findColumnDataValueType:function(e,t){var r=null;e&&(r=e.columns.firstOrDefault((function(e){return e.name===t}),this).dataValueType);return r},getFunctionResultParameter:function(e,t){return t===Terrasoft.DataValueType.INTEGER?e.findParameterByName("ResultIntegerFunction"):Terrasoft.isNumberDataValueType(t)?e.findParameterByName("ResultFloatFunction"):Terrasoft.isDateDataValueType(t)?e.findParameterByName("ResultDateTimeFunction"):null},prepareLookupEntitySchemaQuery:function(e,t){var r=Ext.create("Terrasoft.EntitySchemaQuery",{rootSchema:e});r.addMacrosColumn(Terrasoft.QueryMacrosType.PRIMARY_COLUMN,"Id"),r.addMacrosColumn(Terrasoft.QueryMacrosType.PRIMARY_DISPLAY_COLUMN,"displayValue");var n=t.split(".").pop(),i=r.createColumnFilterWithParameter(Terrasoft.ComparisonType.EQUAL,e.primaryColumn.name,n);return r.filters.addItem(i),r},getLookupItemFromResponce:function(e){var t=null,r=e.collection;return e.success&&r&&!r.isEmpty()&&(t=r.first()),t},getParametersChainFromIterator:function(e){var t=Ext.create("Terrasoft.FormulaMacros");do{t.addParameter(e.next())}while(e.hasNext());return t.getBody()}}),Ext.define("Terrasoft.utils.FormulaParserUtils",{extend:"Terrasoft.BaseObject",alternateClassName:"Terrasoft.FormulaParserUtils",singleton:!0,constructor:function(){this.callParent(arguments),this.validatePrefixResources()},replaceFunctionsValueToDisplayValue:function(e){var t=e;return Terrasoft.each(Terrasoft.process.constants.FUNCTIONS,(function(e){var r=e.value+"(",n=e.displayValue,i=n.indexOf("{0}");n=n.substring(0,i),t=t.split(r).join(n)})),t},replaceFunctionsDisplayValueToValue:function(e){var t=e;return Terrasoft.each(Terrasoft.process.constants.FUNCTIONS,(function(e){var r=e.value+"(",n=e.displayValue,i=n.indexOf("(");n=n.substring(0,i+1),t=t.split(n).join(r)})),t},getDateTimeValueFormatConfig:function(e){var t=Terrasoft.Resources.ProcessSchemaDesigner.Functions,r=Terrasoft.process.constants,n=Terrasoft.Resources.ProcessSchemaDesigner.Exceptions;switch(e){case Terrasoft.DataValueType.DATE:return{valuePrefix:r.DATE_VALUE_PREFIX+r.MACROS_SEPARATOR,valueFormat:r.DATE_VALUE_FORMAT,displayPrefix:this.prepareDisplayPrefix(t.DateValueDisplayPrefix),displayFormat:Terrasoft.Resources.CultureSettings.dateFormat,invalidMessageTemplate:n.InvalidDateMessage,dateValueTypeInCamelCase:r.DATE_TIME_VALUE_TYPE_NAME_IN_CAMEL_CASE.DATE};case Terrasoft.DataValueType.TIME:return{valuePrefix:r.TIME_VALUE_PREFIX+r.MACROS_SEPARATOR,valueFormat:r.TIME_VALUE_FORMAT,displayPrefix:this.prepareDisplayPrefix(t.TimeValueDisplayPrefix),displayFormat:Terrasoft.Resources.CultureSettings.timeFormat,invalidMessageTemplate:n.InvalidTimeMessage,dateValueTypeInCamelCase:r.DATE_TIME_VALUE_TYPE_NAME_IN_CAMEL_CASE.TIME};case Terrasoft.DataValueType.DATE_TIME:return{valuePrefix:r.DATE_TIME_VALUE_PREFIX+r.MACROS_SEPARATOR,valueFormat:r.DATE_TIME_VALUE_FORMAT,displayPrefix:this.prepareDisplayPrefix(t.DateTimeValueDisplayPrefix),displayFormat:this.getDateTimeDisplayFormat(),invalidMessageTemplate:n.InvalidDateTimeMessage,dateValueTypeInCamelCase:r.DATE_TIME_VALUE_TYPE_NAME_IN_CAMEL_CASE.DATE_TIME};default:throw new Terrasoft.exceptions.NotImplementedException({message:Ext.String.format('DataValueType "{0}" is not implemented',e)})}},getDateTimeDisplayFormat:function(){return Ext.String.format("{0} {1}",Terrasoft.Resources.CultureSettings.dateFormat,Terrasoft.Resources.CultureSettings.timeFormat)},loadLookupDisplayValue:function(e,t,r){var n,i=Ext.create("Terrasoft.EntitySchemaQuery",{rootSchema:e});i.addMacrosColumn(Terrasoft.QueryMacrosType.PRIMARY_COLUMN,"Id"),i.addMacrosColumn(Terrasoft.QueryMacrosType.PRIMARY_DISPLAY_COLUMN,"displayValue"),i.filters.addItem(i.createColumnFilterWithParameter(Terrasoft.ComparisonType.EQUAL,"Id",t)),i.getEntityCollection((function(e){var i=e.collection;if(e.success&&i&&!i.isEmpty()){var a=i.getByIndex(0);n=a.get("displayValue")+".".concat(t)}else{if(e.errorInfo){var s=e.errorInfo.message;this.log(s)}var o=Terrasoft.Resources.ProcessSchemaDesigner.Messages;n=o.RecordNotFoundMessage}r(n)}),this)},getParameterDisplayValuePrefix:function(e,t,r){var n=Terrasoft.ProcessSchemaDesignerUtilities,i=e.schemaElementUId,a=i?r.findItemByUId(i):null,s=Terrasoft.Features.getIsEnabled("ProcessParameterCollections")||Terrasoft.isDebug?t.getFullCaption():n.getElementCaption(t);return a?Ext.String.format("{0}{1}{2}",n.getElementCaption(a),Terrasoft.process.constants.MACROS_SEPARATOR,s):s},getMacrosDisplayValue:function(e,t,r,n){var i=Terrasoft.ProcessSchemaDesignerUtilities.addParameterMask(e);Ext.create("Terrasoft.FormulaValueParser",{formula:i,schema:t}).parse((function(e,t){var a=Ext.isEmpty(t),s=i;if(a){var o=e.get(i);s=Terrasoft.ProcessSchemaDesignerUtilities.removeParameterMask(o)}Ext.callback(r,n,[s,t])}))},getFormulaValueByCollection:function(e,t){var r=e;return t.eachKey((function(e,t){r=r.split(e).join(t)}),this),r},getFormulaDisplayValueByCollection:function(e,t){var r=e;return t.eachKey((function(e,t){r=r.split(e).join(t)})),r},validateServerFormulaValue:function(e,t,r){var n=e.resultDataValueType;if(Ext.isEmpty(n))t.call(r,{isValid:!0});else{var i=e.schema,a={};i.getLocalizableValues(a);var s=Terrasoft.convertToServerDataValueType(e.resultDataValueType),o={formulaValue:e.formulaValue,resultDataValueTypeUId:s,parameterName:e.parameterName,elementName:e.elementName,metaData:i.serialize(),resources:a,uId:i.uId,changedItems:i.changedItems},l=i.getValidateFormulaServerMethodName();Terrasoft.ServiceProvider.execute({serverMethod:l,data:o},t,r)}},handleServerValidationResponse:function(e,t,r,n){e.isValid||(t.isValid=!1,t.errorMessage=e.errorMessage),r.call(n,t)},getFormulaDisplayValue:function(e,t,r,n){Ext.isEmpty(e)?r.call(n,e):(e=e.split(Terrasoft.process.constants.TERRASOFT_COMMON_NAMESPACE).join(""),e=this.replaceFunctionsValueToDisplayValue(e),Ext.create("Terrasoft.FormulaValueParser",{formula:e,schema:t}).parse((function(t,i){e=this.getFormulaDisplayValueByCollection(e,t),r.call(n,e,t,i)}),this))},getMetaPathDisplayValue:function(e,t,r,n){var i=this.getMetaPathMappingInfo(e);this.getParameterDisplayValue(i,t,r,n)},getIsLookupMappingValue:function(e){var t=Terrasoft.process.constants;return Ext.String.startsWith(e,t.LOOKUP_VALUE_PREFIX+t.MACROS_SEPARATOR)},getIsLookupMappingMacros:function(e){var t=Terrasoft.process.constants;return Ext.String.startsWith(e,t.LEFT_MACROS_BRACKET+t.LOOKUP_VALUE_PREFIX+t.MACROS_SEPARATOR)},getLookupValue:function(e){var t=Terrasoft.process.constants;return e.slice(e.lastIndexOf(".")+1,e.indexOf(t.RIGHT_MACROS_BRACKET))},getParameterMappingInfo:function(e){for(var t=Terrasoft.process.constants.PARAMETER_MAPPING_REGEX,r={},n=t.exec(e);null!==n;){var i=n[1],a=n[2];switch(i){case"Element":r.schemaElementUId=a;break;case"Parameter":r.parameterUId=a;break;case"EntityColumn":r.entityColumnUId=a}n=t.exec(e)}return r},getFormulaParameters:function(e,t,r,n){Ext.isEmpty(e)?r.call(n,e):Ext.create("Terrasoft.FormulaValueParser",{formula:e,schema:t}).parse((function(e){r.call(n,e.getKeys())}),this)},getMetaPathMappingInfo:function(e){var t={};if(!Ext.isEmpty(e)){var r=e.split(Terrasoft.process.constants.MACROS_SEPARATOR);1===r.length?t.parameterUId=r[0]:(t.schemaElementUId=r[0],t.parameterUId=r[1])}return t},getFormulaValue:function(e,t,r,n,i){this.validateValue({displayValue:e,schema:t},(function(e){n.call(i,e.value)}),i)},getMappingParameter:function(e,t){return this.findMappingParameter(e,t)},findMappingParameter:function(e,t){var r=e.parameterUId;if(r){var n=e.schemaElementUId,i=n?t.findItemByUId(n):t;if(i)return i.parameters.find(r)}return null},getParameterDisplayValue:function(e,t,r,n){var i=this.getMappingParameter(e,t);if(i){var a=this.getParameterDisplayValuePrefix(e,i,t),s=e.entityColumnUId,o=i.referenceSchemaUId;if(s&&o){var l={schemaUId:i.referenceSchemaUId,packageUId:t.getPackageUId()};Terrasoft.EntitySchemaManager.findBundleSchemaInstance(l,(function(e){if(a+=Terrasoft.process.constants.MACROS_SEPARATOR,e){var t=e.findColumnByUId(s);if(t)return a+=Terrasoft.ProcessSchemaDesignerUtilities.getElementCaption(t),void r.call(n,a)}a+=Terrasoft.Resources.ProcessSchemaDesigner.Messages.EntityNotFoundMessage,r.call(n,a)}),this)}else r.call(n,a)}else r.call(n,"")},parseFormulaValue:function(e,t,r){var n=e.displayValue;if(Ext.isEmpty(n))this.emptyResult(t,r);else{var i=n;i=i.split(Terrasoft.process.constants.TERRASOFT_COMMON_NAMESPACE).join(""),i=this.replaceFunctionsDisplayValueToValue(i),Ext.create("Terrasoft.FormulaDisplayValueParser",{formula:i,schema:e.schema}).parse((function(e,a){i=this.getFormulaValueByCollection(i,e);var s=0===a.length,o={displayValue:n,value:i,isValid:s,unrecognized:a};t.call(r,o)}),this)}},validateValue:function(e,t,r){Ext.isEmpty(e.displayValue)?this.emptyResult(t,r):this.parseFormulaValue(e,(function(n){if(n.isValid)if(Terrasoft.Features.getIsEnabled("UseProcessFormulaServerValidation")){var i=this.getServerValidationConfig(n.value,e);this.validateServerFormulaValue(i,(function(e){this.handleServerValidationResponse(e,n,(function(e){t.call(r,e)}),this)}),this)}else t.call(r,n);else t.call(r,n)}),this)},emptyResult:function(e,t){e.call(t,{displayValue:"",isValid:!0,value:"",unrecognized:[]})},getServerValidationConfig:function(e,t){return{formulaValue:e,resultDataValueType:t.dataValueType,schema:t.schema,parameterName:t.parameterName,elementName:t.elementName}},getLookupDisplayValue:function(e,t,r,n){var i=e.split(Terrasoft.process.constants.MACROS_SEPARATOR),a={schemaUId:i[1],packageUId:t};Terrasoft.EntitySchemaManager.findBundleSchemaInstance(a,(function(e){var t=Terrasoft.Resources.ProcessSchemaDesigner,a=this.prepareDisplayPrefix(t.Functions.LookupValueDisplayPrefix);if(e){var s=e.caption&&e.caption.getValue()||e.name,o=i[2];this.loadLookupDisplayValue(e,o,(function(e){r.call(n,{prefix:a,schemaDisplayValue:s,value:e})}))}else r.call(n,{errorMessage:Ext.String.format("{0}{1}",a,t.Messages.EntityNotFoundMessage)})}),this)},prepareDisplayPrefix:function(e){return Ext.String.format("{0}{1}",e,Terrasoft.process.constants.MACROS_SEPARATOR)},validatePrefixResources:function(){var e=Terrasoft.Resources.ProcessSchemaDesigner.Functions;Terrasoft.each(e,(function(t,r){if(r.indexOf("Prefix")>-1&&t.indexOf(".")===t.length-1){e[r]=t.slice(0,-1);var n="Resource value by Terrasoft.Resources.ProcessSchemaDesigner.Functions."+r+' - is not valid please remove "." at the end';this.log(n)}}),this)}}),Ext.define("Terrasoft.manager.SchemaLocalizableString",{extend:"Terrasoft.BaseObject",alternateClassName:"Terrasoft.SchemaLocalizableString",mixins:{serializable:"Terrasoft.Serializable"},typeName:"Terrasoft.Core.SchemaLocalizableString",uId:null,name:null,createdInSchemaUId:null,createdInPackageId:null,modifiedInSchemaUId:null,caption:null,value:null,serializableProperties:["uId","name","createdInSchemaUId","modifiedInSchemaUId","createdInPackageId","typeName"],getSerializableObject:function(e){this.serializableProperties.forEach((function(t){this.setSerializableProperty(e,t)}),this)},getLocalizableValues:function(e){var t=this.uId;e[t+".Value"]=this.value.cultureValues,e[t+".Caption"]=this.caption.cultureValues},setValue:function(e){this.caption=e.caption,this.value=e.value,this.modifiedInSchemaUId=e.modifiedInSchemaUId,this.fireEvent("changed",e,this)}}),Ext.define("Terrasoft.core.PackageMarketViewModel",{extend:"Terrasoft.BaseViewModel",alternateClassName:"Terrasoft.PackageMarketViewModel",packageData:null,maskId:null,columns:{UrlField:{dataValueType:Terrasoft.DataValueType.TEXT}},validateUrl:function(e){var t=Terrasoft.utils.uri;return e&&(t.isAValidUrlIgnoreProtocol(e)||t.isAValidNetworkPath(e))},callInstallPkgService:function(e){this.maskId=Terrasoft.Mask.show();var t={url:Terrasoft.workspaceBaseUrl+"/rest/"+e.serviceName+"/"+e.methodName,headers:{Accept:"application/json","Content-Type":"application/json"},method:"POST",jsonData:Ext.encode(e.data),callback:function(t,r,n){var i=r?Terrasoft.decode(n.responseText):n;Ext.callback(e.callback,this,[i,r])},scope:e.scope};e&&e.timeout&&(t.timeout=e.timeout),Terrasoft.AjaxProvider.request(t)},installPackage:function(){var e={};arguments.length>3&&(e=this.packageData[arguments[3]]);var t=e.url?e.url:this.get("UrlField");if(this.validateUrl(t)){var r={serviceName:"InstallPackageService",methodName:"InstallFromStorage",data:{source:t},timeout:19e5,callback:function(e){Terrasoft.Mask.hide(this.maskId),Terrasoft.showInformation(e.InstallResult)},scope:this};this.callInstallPkgService(r)}},onDestroy:function(){this.callParent(arguments)}}),Ext.define("Terrasoft.core.PackageMarket",{extend:"Terrasoft.BaseObject",alternateClassName:"Terrasoft.PackageMarket",alias:["Terrassoft.PackageMarket","Terrasoft.core.PackageMarket"],renderTo:null,sandbox:null,packageMarketView:null,packageMarketViewModel:null,packageData:null,constructor:function(){this.callParent(arguments),this.init(),this.packageData=this.getPackagesConfig()},getPackagesConfig:function(){return{AutoTest:{name:"AutoTest",url:"\\\\tsbuild-app\\share\\Packages\\AutoTests\\",caption:"AutoTest packages"}}},init:function(){this.id||(this.id="package-market"),this.setMaskState()},setMaskState:function(){Ext.getBody().set({maskState:"none"})},createMarketViewModel:function(){return Ext.create("Terrasoft.PackageMarketViewModel",{packageData:this.packageData})},render:function(e){Ext.isEmpty(e.id)&&(this.id=e.id),Ext.isString(e.renderTo)&&(e.renderTo=Ext.get(e.renderTo)),this.renderTo=e.renderTo;var t=this.packageMarketView=this.createPackageMarketView(),r=this.packageMarketViewModel=this.createMarketViewModel();t.bind(r),t.render(this.renderTo)},getPackageMarketViewConfig:function(){var e=[];return Terrasoft.each(this.packageData,(function(t){var r={className:"Terrasoft.Button",id:t.name+"-btn",caption:t.caption,style:Terrasoft.controls.ButtonEnums.style.GREEN,click:{bindTo:"installPackage"},tag:t.name};e.push(r)})),e},createPackageMarketView:function(){var e=Ext.create("Terrasoft.core.PackageMarketView").getView(),t=this.getPackageMarketViewConfig(),r=e.concat(t);return Ext.create("Terrasoft.Container",{id:this.id+"-content-container",classes:{wrapClassName:["ts-box-sizing","content-container-wrap"]},items:r})},onDestroy:function(){var e=this.packageMarketViewModel;e&&e.destroy(),this.callParent(arguments)}}),Ext.define("Terrasoft.core.PackageMarketView",{extend:"Terrasoft.BaseObject",getView:function(){return[{className:"Terrasoft.Container",id:"downloadbyurlpackagecontainer",selectors:{wrapEl:"#downloadbyurlpackagecontainer"},items:[{className:"Terrasoft.Label",id:"PackageUrlLabel",caption:"Package path:",classes:{labelClass:["package-url-label"]}},{className:"Terrasoft.TextEdit",id:"PackageUrl-txt",placeholder:"Package path",classes:{wrapClass:"package-url-text-edit"},value:{bindTo:"UrlField"}},{className:"Terrasoft.Button",id:"InstallPackage-btn",caption:"Install",style:Terrasoft.controls.ButtonEnums.style.GREEN,click:{bindTo:"installPackage"},tag:"InstallPackage"}]}]}}),Ext.define("Terrasoft.core.SysUserPropertyHelper",{alternateClassName:"Terrasoft.SysUserPropertyHelper",singleton:!0,createUserPropertyRequest:function(e){if(Ext.isEmpty(e))throw new Terrasoft.ArgumentNullOrEmptyException({message:"config"});return Ext.create("Terrasoft.ParametrizedRequest",e)},execute:function(e,t,r){e.execute((function(e){Ext.callback(t,r,[e])}),this)},getProperty:function(e,t,r){var n=this.createUserPropertyRequest({config:{schemaId:e.schemaId,propertyName:e.propertyName,managerName:e.managerName},contractName:"GetUserPropertyRequest"});this.execute(n,t,r)},getProperties:function(e,t,r){var n=this.createUserPropertyRequest({config:{schemaId:e.schemaId,managerName:e.managerName},contractName:"GetUserPropertiesRequest"});this.execute(n,t,r)},setProperty:function(e,t,r){var n=this.createUserPropertyRequest({config:{schemaId:e.schemaId,propertyName:e.propertyName,propertyValue:e.propertyValue,managerName:e.managerName},contractName:"SetUserPropertyRequest"});this.execute(n,t,r)},setProperties:function(e,t,r){var n=this.createUserPropertyRequest({config:{schemaId:e.schemaId,propertyCollection:e.propertyCollection,managerName:e.managerName},contractName:"SetUserPropertiesRequest"});this.execute(n,t,r)}}),Ext.define("BusinessRuleElementHelper",{extend:"Terrasoft.BaseObject",alternateClassName:"Terrasoft.BusinessRuleElementHelper",singleton:!0,getStorage:function(){return Terrasoft.BusinessRules.ObjectTypes},getBusinessRuleElementByPredicate:function(e){var t=null;if(Terrasoft.each(this.getStorage(),(function(r){if(null!==t)return!1;Terrasoft.each(r,(function(r){if(e(r))return t=r,!1}),this)}),this),null===t)throw new Terrasoft.ItemNotFoundException;return t},constructor:function(){this.callParent(),Terrasoft.Resources.BusinessRules=Terrasoft.Resources.BusinessRules||{},Terrasoft.BusinessRules=Terrasoft.BusinessRules||{},Terrasoft.BusinessRules.ObjectTypes={BusinessRules:[{type:"BusinessRule",className:"Terrasoft.manager.BusinessRuleSchema"},{type:"InvalidBusinessRule",className:"Terrasoft.manager.InvalidBusinessRuleSchema"}],BusinessRuleSwitches:[{type:"BusinessRuleSwitch",className:"Terrasoft.manager.BusinessRuleSwitch"}],BusinessRuleCases:[{type:"BusinessRuleCase",className:"Terrasoft.manager.BusinessRuleCase"}],BusinessRuleConditionGroups:[{type:"BusinessRuleConditionGroup",className:"Terrasoft.manager.BusinessRuleConditionGroup"}],BusinessRuleConditions:[{type:"ComparisonBusinessRuleCondition",className:"Terrasoft.manager.ComparisonBusinessRuleCondition"}],BusinessRuleActionGroups:[{type:"BusinessRuleActionGroup",className:"Terrasoft.manager.BusinessRuleActionGroup"}],BusinessRuleActions:[{type:"VisibilityBusinessRuleAction",className:"Terrasoft.manager.VisibilityBusinessRuleAction",designConfig:{controlClassName:"Terrasoft.BusinessRuleBindParameterActionDesignerContainer",viewModelClassName:"Terrasoft.BusinessRuleBindParameterActionDesignerViewModel",listCaption:Terrasoft.Resources.BusinessRules.VisibilityBusinessRuleActionCaption,hint:Terrasoft.Resources.BusinessRules.VisibilityBusinessRuleActionHint,captionTpl:Terrasoft.Resources.BusinessRules.VisibilityBusinessRuleActionCaptionTpl}},{type:"RequiredBusinessRuleAction",className:"Terrasoft.manager.RequiredBusinessRuleAction",designConfig:{controlClassName:"Terrasoft.BusinessRuleBindParameterActionDesignerContainer",viewModelClassName:"Terrasoft.BusinessRuleBindParameterActionDesignerViewModel",listCaption:Terrasoft.Resources.BusinessRules.RequiredBusinessRuleActionCaption,hint:Terrasoft.Resources.BusinessRules.RequiredBusinessRuleActionHint,captionTpl:Terrasoft.Resources.BusinessRules.RequiredBusinessRuleActionCaptionTpl}},{type:"EnabledBusinessRuleAction",className:"Terrasoft.manager.EnabledBusinessRuleAction",designConfig:{controlClassName:"Terrasoft.BusinessRuleBindParameterActionDesignerContainer",viewModelClassName:"Terrasoft.BusinessRuleBindParameterActionDesignerViewModel",listCaption:Terrasoft.Resources.BusinessRules.EnabledBusinessRuleActionCaption,hint:Terrasoft.Resources.BusinessRules.EnabledBusinessRuleActionHint,captionTpl:Terrasoft.Resources.BusinessRules.EnabledBusinessRuleActionCaptionTpl}},{type:"ReadOnlyBusinessRuleAction",className:"Terrasoft.manager.ReadOnlyBusinessRuleAction",designConfig:{canDesign:!1,controlClassName:"Terrasoft.BusinessRuleBindParameterActionDesignerContainer",viewModelClassName:"Terrasoft.BusinessRuleBindParameterActionDesignerViewModel",listCaption:Terrasoft.Resources.BusinessRules.ReadOnlyBusinessRuleActionCaption,hint:Terrasoft.Resources.BusinessRules.ReadOnlyBusinessRuleActionHint,captionTpl:Terrasoft.Resources.BusinessRules.ReadOnlyBusinessRuleActionCaptionTpl}},{type:"FiltrationBusinessRuleAction",className:"Terrasoft.manager.FiltrationBusinessRuleAction",designConfig:{controlClassName:"Terrasoft.BusinessRuleFilterActionDesignerContainer",viewModelClassName:"Terrasoft.BusinessRuleFilterActionDesignerViewModel",listCaption:Terrasoft.Resources.BusinessRules.FiltrationBusinessRuleActionCaption,captionTpl:Terrasoft.Resources.BusinessRules.FiltrationBusinessRuleActionCaptionTpl}}],BusinessRuleExpressions:[{type:"ConstantBusinessRuleExpression",className:"Terrasoft.manager.ConstantBusinessRuleExpression",designConfig:{listCaption:Terrasoft.Resources.BusinessRules.Expression.Constant}},{type:"ColumnBusinessRuleExpression",className:"Terrasoft.manager.ColumnBusinessRuleExpression",designConfig:{placeholder:Terrasoft.Resources.BusinessRules.ExpressionPlaceholder.Column,listCaption:Terrasoft.Resources.BusinessRules.Expression.Column}},{type:"AttributeBusinessRuleExpression",className:"Terrasoft.manager.AttributeBusinessRuleExpression",designConfig:{placeholder:Terrasoft.Resources.BusinessRules.ExpressionPlaceholder.Attribute,listCaption:Terrasoft.Resources.BusinessRules.Expression.Attribute}},{type:"ParameterBusinessRuleExpression",className:"Terrasoft.manager.ParameterBusinessRuleExpression",designConfig:{placeholder:Terrasoft.Resources.BusinessRules.ExpressionPlaceholder.Parameter,listCaption:Terrasoft.Resources.BusinessRules.Expression.Parameter}},{type:"SysSettingBusinessRuleExpression",className:"Terrasoft.manager.SysSettingBusinessRuleExpression",designConfig:{placeholder:Terrasoft.Resources.BusinessRules.ExpressionPlaceholder.SysSetting,listCaption:Terrasoft.Resources.BusinessRules.Expression.SysSetting}},{type:"SysValueBusinessRuleExpression",className:"Terrasoft.manager.SysValueBusinessRuleExpression",designConfig:{placeholder:Terrasoft.Resources.BusinessRules.ExpressionPlaceholder.SysValue,listCaption:Terrasoft.Resources.BusinessRules.Expression.SysValue}},{type:"DataSourceBusinessRuleExpression",className:"Terrasoft.manager.ColumnBusinessRuleExpression",designConfig:{placeholder:Terrasoft.Resources.BusinessRules.ExpressionPlaceholder.DataSources,listCaption:Terrasoft.Resources.BusinessRules.Expression.DataSources}},{type:"DetailBusinessRuleExpression",className:"Terrasoft.manager.DetailBusinessRuleExpression",designConfig:{placeholder:Terrasoft.Resources.BusinessRules.ExpressionPlaceholder.Detail,listCaption:Terrasoft.Resources.BusinessRules.Expression.Detail}},{type:"ModuleBusinessRuleExpression",className:"Terrasoft.manager.ModuleBusinessRuleExpression",designConfig:{placeholder:Terrasoft.Resources.BusinessRules.ExpressionPlaceholder.Module,listCaption:Terrasoft.Resources.BusinessRules.Expression.Module}},{type:"GroupBusinessRuleExpression",className:"Terrasoft.manager.GroupBusinessRuleExpression",designConfig:{placeholder:Terrasoft.Resources.BusinessRules.ExpressionPlaceholder.Group,listCaption:Terrasoft.Resources.BusinessRules.Expression.Group}},{type:"TabBusinessRuleExpression",className:"Terrasoft.manager.TabBusinessRuleExpression",designConfig:{placeholder:Terrasoft.Resources.BusinessRules.ExpressionPlaceholder.Tab,listCaption:Terrasoft.Resources.BusinessRules.Expression.Tab}},{type:"FormulaBusinessRuleExpression",className:"Terrasoft.manager.FormulaBusinessRuleExpression",designConfig:{placeholder:Terrasoft.Resources.BusinessRules.ExpressionPlaceholder.Formula,listCaption:Terrasoft.Resources.BusinessRules.Expression.Formula}}]},Terrasoft.Features.getIsEnabled("PopulateBusinessRuleAction")&&Terrasoft.BusinessRules.ObjectTypes.BusinessRuleActions.push({type:"PopulateBusinessRuleAction",className:"Terrasoft.manager.PopulateBusinessRuleAction",designConfig:{controlClassName:"Terrasoft.BusinessRulePopulateItemActionDesignerContainer",viewModelClassName:"Terrasoft.BusinessRulePopulateItemActionDesignerViewModel",listCaption:Terrasoft.Resources.BusinessRules.PopulateBusinessRuleActionCaption,captionTpl:Terrasoft.Resources.BusinessRules.PopulateBusinessRuleActionCaptionTpl}})},getElementsByGroupType:function(e){var t=this.getStorage();if(!Ext.isDefined(t[e]))throw new Terrasoft.ItemNotFoundException;return t[e]},getElementByType:function(e){return this.getBusinessRuleElementByPredicate((function(t){return t.type===e}))},getClassNameByType:function(e){return this.getElementByType(e).className},getElementByClassName:function(e){return this.getBusinessRuleElementByPredicate((function(t){return t.className===e}))},getTypeByClassName:function(e){return this.getElementByClassName(e).type}}),Ext.define("Terrasoft.manager.BusinessRuleElementUtils",{alternateClassName:"Terrasoft.BusinessRuleElementUtils",createItem:function(e){var t=Terrasoft.BusinessRuleElementHelper.getClassNameByType(e.type);return delete e.type,Ext.create(t,e)},createItemGroup:function(e){var t,r=[];return Terrasoft.each(e,(function(e){t=this.createItem(e),r.push(t)}),this),r}}),Ext.define("Terrasoft.manager.BaseBusinessRuleElement",{extend:"Terrasoft.manager.MetaItem",alternateClassName:"Terrasoft.BaseBusinessRuleElement",mixins:["Terrasoft.BusinessRuleElementUtils"]}),Ext.define("Terrasoft.manager.BaseBusinessRuleExecutable",{extend:"Terrasoft.manager.BaseBusinessRuleElement",alternateClassName:"Terrasoft.BaseBusinessRuleExecutable"}),Ext.define("Terrasoft.manager.BaseBusinessRuleExpression",{extend:"Terrasoft.BaseBusinessRuleElement",alternateClassName:"Terrasoft.BaseBusinessRuleExpression",dataValueType:null,autoClean:!1,autocomplete:!1,getExpressionValue:Terrasoft.abstractFn,setExpressionValue:Terrasoft.abstractFn}),Ext.define("Terrasoft.manager.AttributeBusinessRuleExpression",{extend:"Terrasoft.BaseBusinessRuleExpression",alternateClassName:"Terrasoft.AttributeBusinessRuleExpression",attributeName:null,getExpressionValue:function(){return this.attributeName},setExpressionValue:function(e){this.attributeName=e}}),Ext.define("Terrasoft.manager.ParameterBusinessRuleExpression",{extend:"Terrasoft.AttributeBusinessRuleExpression",alternateClassName:"Terrasoft.ParameterBusinessRuleExpression",columnMetaPath:null,setExpressionValue:function(e){this.attributeName=e.name,this.columnMetaPath=e.value},getExpressionValue:function(){return{attributeName:this.attributeName,columnMetaPath:this.columnMetaPath}}}),Ext.define("Terrasoft.manager.ColumnBusinessRuleExpression",{extend:"Terrasoft.BaseBusinessRuleExpression",alternateClassName:"Terrasoft.ColumnBusinessRuleExpression",columnMetaPath:null,dataModelName:null,getExpressionValue:function(){return this.columnMetaPath},setExpressionValue:function(e){this.columnMetaPath=e}}),Ext.define("Terrasoft.manager.ConstantBusinessRuleExpression",{extend:"Terrasoft.BaseBusinessRuleExpression",alternateClassName:"Terrasoft.ConstantBusinessRuleExpression",value:null,referenceSchemaName:null,getExpressionValue:function(){return this.value},setExpressionValue:function(e){this.value=e},constructor:function(e){this.callParent(arguments),e&&e.value&&Terrasoft.isDateDataValueType(e.dataValueType)&&(this.value=new Date(e.value))}}),Ext.define("Terrasoft.manager.SysSettingBusinessRuleExpression",{extend:"Terrasoft.BaseBusinessRuleExpression",alternateClassName:"Terrasoft.SysSettingBusinessRuleExpression",sysSettingCode:null,getExpressionValue:function(){return this.sysSettingCode},setExpressionValue:function(e){this.sysSettingCode=e}}),Ext.define("Terrasoft.manager.SysValueBusinessRuleExpression",{extend:"Terrasoft.BaseBusinessRuleExpression",alternateClassName:"Terrasoft.SysValueBusinessRuleExpression",sysValueType:null,getExpressionValue:function(){return this.sysValueType},setExpressionValue:function(e){this.sysValueType=e}}),Ext.define("Terrasoft.manager.FormulaBusinessRuleExpression",{extend:"Terrasoft.BaseBusinessRuleExpression",alternateClassName:"Terrasoft.FormulaBusinessRuleExpression",formula:null,getExpressionValue:function(){return this.formula},setExpressionValue:function(e){this.formula=e}}),Ext.define("Terrasoft.manager.BaseBusinessRuleAction",{extend:"Terrasoft.manager.BaseBusinessRuleExecutable",alternateClassName:"Terrasoft.BaseBusinessRuleAction",enabled:!0,description:null,constructor:function(e){this.callParent(arguments),e&&e.description&&this.initLocalizableStringValue("description",e.description)}}),Ext.define("Terrasoft.manager.BusinessRuleActionGroup",{extend:"Terrasoft.BaseBusinessRuleAction",alternateClassName:"Terrasoft.BusinessRuleActionGroup",items:[],constructor:function(e){this.callParent(arguments),e&&e.items&&(this.items=this.createItemGroup(e.items))}}),Ext.define("Terrasoft.manager.ColumnBusinessRuleAction",{extend:"Terrasoft.BaseBusinessRuleAction",alternateClassName:"Terrasoft.ColumnBusinessRuleAction",columnUId:null}),Ext.define("Terrasoft.manager.ReadOnlyBusinessRuleAction",{extend:"Terrasoft.ColumnBusinessRuleAction",alternateClassName:"Terrasoft.ReadOnlyBusinessRuleAction"}),Ext.define("Terrasoft.manager.DefaultValueBusinessRuleAction",{extend:"Terrasoft.ColumnBusinessRuleAction",alternateClassName:"Terrasoft.DefaultValueBusinessRuleAction",value:null}),Ext.define("Terrasoft.manager.AttributeBusinessRuleAction",{extend:"Terrasoft.manager.BaseBusinessRuleAction",alternateClassName:"Terrasoft.AttributeBusinessRuleAction",attributeName:null,sourceType:null,dataModelName:null}),Ext.define("Terrasoft.manager.VisibilityBusinessRuleAction",{extend:"Terrasoft.AttributeBusinessRuleAction",alternateClassName:"Terrasoft.VisibilityBusinessRuleAction"}),Ext.define("Terrasoft.manager.EnabledBusinessRuleAction",{extend:"Terrasoft.AttributeBusinessRuleAction",alternateClassName:"Terrasoft.EnabledBusinessRuleAction"}),Ext.define("Terrasoft.manager.RequiredBusinessRuleAction",{extend:"Terrasoft.AttributeBusinessRuleAction",alternateClassName:"Terrasoft.RequiredBusinessRuleAction"}),Ext.define("Terrasoft.manager.PopulateBusinessRuleAction",{extend:"Terrasoft.BaseBusinessRuleAction",alternateClassName:"Terrasoft.PopulateBusinessRuleAction",leftExpression:null,rightExpression:null,constructor:function(e){this.callParent(arguments),e=e||{},Ext.isEmpty(e.leftExpression)||(this.leftExpression=this.createItem(e.leftExpression)),Ext.isEmpty(e.rightExpression)||(this.rightExpression=this.createItem(e.rightExpression))}}),Ext.define("Terrasoft.manager.BaseBusinessRuleCondition",{extend:"Terrasoft.BaseBusinessRuleElement",alternateClassName:"Terrasoft.BaseBusinessRuleCondition"}),Ext.define("Terrasoft.manager.BusinessRuleCase",{extend:"Terrasoft.BaseBusinessRuleElement",alternateClassName:"Terrasoft.BusinessRuleCase",condition:null,action:null,constructor:function(e){this.callParent(arguments),Ext.isDefined(e&&e.condition)&&(this.condition=this.createItem(e.condition)),Ext.isDefined(e&&e.action)&&(this.action=this.createItem(e.action))}}),Ext.define("Terrasoft.manager.ComparisonBusinessRuleCondition",{extend:"Terrasoft.BaseBusinessRuleCondition",alternateClassName:"Terrasoft.ComparisonBusinessRuleCondition",leftExpression:null,comparisonType:null,rightExpression:null,constructor:function(e){this.callParent(arguments),e=e||{},Ext.isEmpty(e.leftExpression)||(this.leftExpression=this.createItem(e.leftExpression)),Ext.isEmpty(e.rightExpression)||(this.rightExpression=this.createItem(e.rightExpression))}}),Ext.define("Terrasoft.manager.FiltrationBusinessRuleAction",{extend:"Terrasoft.AttributeBusinessRuleAction",alternateClassName:"Terrasoft.FiltrationBusinessRuleAction",condition:null,constructor:function(e){this.callParent(arguments);var t=e&&e.condition;if(!Ext.isEmpty(t)){var r=["ColumnBusinessRuleExpression","ParameterBusinessRuleExpression"];if(!_.contains(r,t.leftExpression.type))throw new Terrasoft.UnsupportedTypeException({message:"leftExpression should be Terrasoft.ColumnBusinessRuleExpression"});this.condition=this.createItem(t)}}}),Ext.define("Terrasoft.manager.BusinessRuleConditionGroup",{extend:"Terrasoft.BaseBusinessRuleCondition",alternateClassName:"Terrasoft.BusinessRuleConditionGroup",items:[],operationType:Terrasoft.LogicalOperatorType.AND,constructor:function(e){this.callParent(arguments),e&&e.items&&(this.items=this.createItemGroup(e.items))}}),Ext.define("Terrasoft.manager.BusinessRuleSwitch",{extend:"Terrasoft.manager.BaseBusinessRuleExecutable",alternateClassName:"Terrasoft.BusinessRuleSwitch",cases:null,defaultCase:null,constructor:function(e){this.callParent(arguments),e=e||{},Ext.isEmpty(e.cases)||(this.cases=this.createItemGroup(e.cases)),Ext.isEmpty(e.defaultCase)||(this.defaultCase=this.createItem(e.defaultCase))}}),Ext.define("Terrasoft.manager.BusinessRuleSchema",{extend:"Terrasoft.manager.BaseSchema",alternateClassName:"Terrasoft.BusinessRuleSchema",mixins:["Terrasoft.BusinessRuleElementUtils"],entitySchemaUId:null,enabled:!0,removed:!1,trigger:null,ruleSwitch:null,invalid:!1,entitySchema:null,pageSchemaUId:null,constructor:function(e){this.callParent(arguments),Ext.isDefined(e&&e.trigger)&&(this.trigger=this.createItem(e.trigger)),Ext.isDefined(e&&e.ruleSwitch)&&(this.ruleSwitch=this.createItem(e.ruleSwitch))},hasDependsOnColumn:function(e,t){if(!this.ruleSwitch)return!1;for(var r=0;r<this.ruleSwitch.cases.length;r++){for(var n=this.ruleSwitch.cases[r],i=n.action.items,a=0;a<i.length;a++)if(i[a].attributeName===e)return!0;for(var s=n.condition.items,o=0;o<s.length;o++)for(var l=[s[o].leftExpression,s[o].rightExpression],c=0;c<l.length;c++){var u=l[c];if((u&&u.attributeName)===e)return!0;if(t&&(u&&u.dataModelName)===t)return!0}}return!1}}),Ext.define("Terrasoft.manager.InvalidBusinessRuleSchema",{extend:"Terrasoft.BusinessRuleSchema",alternateClassName:"Terrasoft.InvalidBusinessRuleSchema",actionColumnName:null,invalid:!0}),Ext.define("Terrasoft.process.BaseProcessResponse",{alternateClassName:"Terrasoft.BaseProcessResponse",extend:"Terrasoft.BaseResponse",executionData:null,setRequestConfig:function(e){e.publishExecutionData&&this.publishExecutionData({batchStart:e.batchStart})},publishExecutionData:function(e){this.executionData&&Terrasoft.ProcessExecutionDataCollector.add(this.executionData,e)}}),Ext.define("Terrasoft.process.RunProcessResponse",{alternateClassName:"Terrasoft.RunProcessResponse",extend:"Terrasoft.BaseProcessResponse",resultParameterValues:null}),Ext.define("Terrasoft.process.BaseProcessRequest",{extend:"Terrasoft.BaseRequest",alternateClassName:"Terrasoft.BaseProcessRequest",baseUri:"../ServiceModel/ProcessEngineService.svc",responseClassName:"Terrasoft.BaseProcessResponse",constructor:function(){this.collectExecutionData=Terrasoft.Features.getIsEnabled("GetProcessStepsViaResponse"),this.callParent(arguments)},publishExecutionData:!0,collectExecutionData:!0,getRequestConfig:function(){var e=this.callParent(arguments);return e.url=this.baseUri+"/"+this.contractName,e.publishExecutionData=this.publishExecutionData,e.parseResponseErrorInfo=!0,e},getSerializableObject:function(e){this.callParent(arguments),e.collectExecutionData=this.collectExecutionData}}),Ext.define("Terrasoft.process.BaseProcessLogRequest",{extend:"Terrasoft.BaseRequest",alternateClassName:"Terrasoft.BaseProcessLogRequest",baseUri:"../ServiceModel/ProcessLogService.svc",getRequestConfig:function(){var e=this.callParent(arguments);return e.url=this.baseUri+"/"+this.contractName,e}}),Ext.define("Terrasoft.process.ProcessMultiInstanceTraceDataRequest",{extend:"Terrasoft.BaseProcessLogRequest",alternateClassName:"Terrasoft.ProcessMultiInstanceTraceDataRequest",contractName:"GetProcessMultiInstanceTraceData",iteratorElementId:null,getSerializableObject:function(e){this.callParent(arguments),e.iteratorElementId=this.iteratorElementId}}),Ext.define("Terrasoft.process.ParameterizedProcessRequest",{extend:"Terrasoft.BaseProcessRequest",alternateClassName:"Terrasoft.ParameterizedProcessRequest",parameterValues:null,_parameterValues:null,_getSerializableObjectOld:function(e){var t=this.getSerializableProperty(this.parameterValues),r=e.parameterValues=[];return Terrasoft.each(t.items,(function(e,t){r.push({name:t,value:e})}),this),Ext.isEmpty(this._parameterValues)||Terrasoft.each(this._parameterValues,(function(e){Terrasoft.findItem(r,{name:e.name})||r.push({name:e.name,value:e.value})}),this),e},constructor:function(e){this.callParent(arguments),this.parameterValues=Ext.create("Terrasoft.ObjectCollection"),this._parameterValues=[],e&&e.parameterValues&&Terrasoft.each(e.parameterValues,(function(e,t){this.addParameterValue(t,e)}),this)},getSerializableObject:function(e){return this.callParent(arguments),this.parameterValues.isEmpty()?(Ext.isEmpty(this._parameterValues)||(e.parameterValues=this._parameterValues),e):this._getSerializableObjectOld(e)},addParameterValue:function(e,t){this._parameterValues.push({name:e,value:Ext.isArray(t)?Terrasoft.encode(t):t})}}),Ext.define("Terrasoft.process.GetRunningProcessCountResponse",{extend:"Terrasoft.BaseResponse",alternateClassName:"Terrasoft.GetRunningProcessCountResponse",count:0}),Ext.define("Terrasoft.process.BaseRunningProcessCountRequest",{extend:"Terrasoft.BaseRequest",alternateClassName:"Terrasoft.BaseRunningProcessCountRequest",baseUri:"../ServiceModel/ProcessEngineService.svc",responseClassName:"Terrasoft.GetRunningProcessCountResponse",contractName:"GetRunningProcessesCount",countSpecifiedVersion:!1,managerName:"ProcessSchemaManager",getRequestConfig:function(){var e=this.callParent(arguments);return e.url=this.baseUri+"/"+this.contractName,e},getSerializableObject:function(e){this.callParent(arguments),e.countSpecifiedVersion=this.countSpecifiedVersion,e.managerName=this.managerName},validateSchemaIdentifier:function(e,t){if(Ext.isEmpty(e)||Terrasoft.isEmptyGUID(e))throw new Terrasoft.NullOrEmptyException({argumentName:t})}}),Ext.define("Terrasoft.process.GetRunningProcessCountByIdRequest",{extend:"Terrasoft.BaseRunningProcessCountRequest",alternateClassName:"Terrasoft.GetRunningProcessCountByIdRequest",constructor:function(){this.callParent(arguments)},schemaId:null,getSerializableObject:function(e){this.callParent(arguments),e.schemaId=this.schemaId},validate:function(){return this.callParent(arguments),this.validateSchemaIdentifier(this.schemaId,"schemaId"),!0}}),Ext.define("Terrasoft.process.GetRunningProcessCountByUIdRequest",{extend:"Terrasoft.BaseRunningProcessCountRequest",alternateClassName:"Terrasoft.GetRunningProcessCountByUIdRequest",constructor:function(){this.callParent(arguments)},schemaUId:null,getSerializableObject:function(e){this.callParent(arguments),e.schemaUId=this.schemaUId},validate:function(){return this.callParent(arguments),this.validateSchemaIdentifier(this.schemaUId,"schemaUId"),!0}}),Ext.define("Terrasoft.process.BaseRunProcessRequest",{extend:"Terrasoft.ParameterizedProcessRequest",alternateClassName:"Terrasoft.BaseRunProcessRequest",contractName:"RunProcess"}),Ext.define("Terrasoft.process.RunProcessRequest",{extend:"Terrasoft.BaseRunProcessRequest",alternateClassName:"Terrasoft.RunProcessRequest",schemaUId:null,schemaName:null,resultParameterNames:null,responseClassName:"Terrasoft.RunProcessResponse",constructor:function(e){this.callParent(arguments),this.resultParameterNames=[],e&&e.resultParameterNames&&Terrasoft.each(e.resultParameterNames,(function(e){this.addResultParameter(e)}),this)},getSerializableObject:function(){var e=this.callParent(arguments);return e.schemaUId=this.schemaUId,e.schemaName=this.schemaName,e.resultParameterNames=this.resultParameterNames,e},addResultParameter:function(e){this.resultParameterNames.push(e)},validate:function(){if(this.callParent(arguments),Ext.isEmpty(this.schemaUId)&&Ext.isEmpty(this.schemaName))throw new Terrasoft.NullOrEmptyException({argumentName:"schemaName and schemaUId"});if(Terrasoft.isEmptyGUID(this.schemaUId))throw new Terrasoft.NullOrEmptyException({argumentName:"schemaUId"});return!0}}),Ext.define("Terrasoft.process.ChangeToAppropriateDcmInstanceRequest",{extend:"Terrasoft.BaseProcessRequest",alternateClassName:"Terrasoft.ChangeToAppropriateDcmInstanceRequest",contractName:"ChangeToAppropriateDcmInstance",entitySchemaName:null,recordId:null,currentStageId:null,getSerializableObject:function(e){this.callParent(arguments),e.entitySchemaName=this.entitySchemaName,e.recordId=this.recordId,e.currentStageId=this.currentStageId}}),Ext.define("Terrasoft.process.ChangeProcessElementStateRequest",{extend:"Terrasoft.BaseProcessRequest",alternateClassName:"Terrasoft.ChangeProcessElementStateRequest",statics:{assignPerformer:function(e,t,r,n){Ext.create("Terrasoft.ChangeProcessElementStateRequest",{elementUId:e,performer:{contactId:t},technicalActivityValues:{Owner:t}}).execute(r,n)}},contractName:"ChangeProcessElementState",elementUId:null,performer:null,technicalActivityValues:null,getSerializableObject:function(e){if(this.callParent(arguments),e.elementUId=this.elementUId,e.performer=this.performer,!Terrasoft.isEmptyObject(this.technicalActivityValues)){var t=[];Terrasoft.each(this.technicalActivityValues,(function(e,r){t.push({name:r,value:e})}),this),e.technicalActivityValues=t}}}),Ext.define("Terrasoft.process.CompleteExecutingRequest",{extend:"Terrasoft.ParameterizedProcessRequest",alternateClassName:"Terrasoft.CompleteExecutingRequest",baseUri:"../ServiceModel/ProcessEngineService.svc",contractName:"CompleteExecuting",responseClassName:"Terrasoft.CompleteExecutingResponse",processElementUId:null,getSerializableObject:function(e){var t=this.callParent(arguments);return t.processElementUId=this.processElementUId,t.collectExecutionData=this.collectExecutionData,t},validate:function(){if(this.callParent(arguments),!this.processElementUId||Terrasoft.isEmptyGUID(this.processElementUId))throw new Terrasoft.NullOrEmptyException({argumentName:"processElementUId"});return!0}}),Ext.define("Terrasoft.process.CompleteExecutingResponse",{alternateClassName:"Terrasoft.CompleteExecutingResponse",extend:"Terrasoft.BaseProcessResponse",waitingUserTaskCount:0}),Ext.define("Terrasoft.process.RunSpecifiedProcessVersionRequest",{extend:"Terrasoft.RunProcessRequest",alternateClassName:"Terrasoft.RunSpecifiedProcessVersionRequest",contractName:"RunSpecifiedProcessVersion"}),Ext.define("Terrasoft.process.BaseRunProcessForEachValueRequest",{extend:"Terrasoft.RunProcessRequest",alternateClassName:"Terrasoft.BaseRunProcessForEachValueRequest",inputParameterName:null,inputParameterUId:null,getSerializableObject:function(){var e=this.callParent(arguments);return e.inputParameterName=this.inputParameterName,e.inputParameterUId=this.inputParameterUId,e},getRequestConfig:function(){var e=this.callParent(arguments);return e.batchStart=!0,e}}),Ext.define("Terrasoft.process.OpenProcessPageRequest",{extend:"Terrasoft.BaseProcessRequest",alternateClassName:"Terrasoft.OpenProcessPageRequest",processId:null,contractName:"OpenProcessPage",constructor:function(){this.callParent(arguments),this.collectExecutionData=!1,this.publishExecutionData=!1},getSerializableObject:function(e){return this.callParent(arguments),e.processId=this.processId,e},validate:function(){if(this.callParent(arguments),!this.processId||Terrasoft.isEmptyGUID(this.processId))throw new Terrasoft.NullOrEmptyException({argumentName:"processId"});return!0}}),Ext.define("Terrasoft.process.ExecuteProcessElementRequest",{extend:"Terrasoft.BaseProcessRequest",alternateClassName:"Terrasoft.ExecuteProcessElementRequest",processElementUId:null,contractName:"ExecProcessElementByUId",constructor:function(){this.callParent(arguments),this.collectExecutionData=!0,this.publishExecutionData=!0},getSerializableObject:function(e){return this.callParent(arguments),e.processElementUId=this.processElementUId,e},validate:function(){if(this.callParent(arguments),!this.processElementUId||Terrasoft.isEmptyGUID(this.processElementUId))throw new Terrasoft.NullOrEmptyException({argumentName:"processElementUId"});return!0}}),Ext.define("Terrasoft.process.RunProcessForEachValueRequest",{extend:"Terrasoft.BaseRunProcessForEachValueRequest",alternateClassName:"Terrasoft.RunProcessForEachValueRequest",contractName:"RunProcessForEachValue",values:null,getSerializableObject:function(){var e=this.callParent(arguments);return e.values=this.values,e}}),Ext.define("Terrasoft.process.RunProcessForMatchingRecordsRequest",{extend:"Terrasoft.BaseRunProcessForEachValueRequest",alternateClassName:"Terrasoft.RunProcessForMatchingRecordsRequest",contractName:"RunProcessForMatchingRecords",entitySchemaName:null,filterConfig:null,sortingColumns:null,primaryColumnValuesToExclude:null,getSerializableObject:function(){var e=this.callParent(arguments);return e.entitySchemaName=this.entitySchemaName,e.filterConfig=this.filterConfig,e.primaryColumnValuesToExclude=this.primaryColumnValuesToExclude,e.sortingColumns=this.sortingColumns,e}}),Ext.ns("Terrasoft.process"),Ext.define("Terrasoft.process.ProcessEngineUtilities",{alternateClassName:"Terrasoft.ProcessEngineUtilities",extend:"Terrasoft.BaseObject",singleton:!0,_initCollectExecutionDataValue:function(e,t){Ext.isDefined(t.collectExecutionData)&&(e.collectExecutionData=t.collectExecutionData),Ext.isDefined(t.publishExecutionData)&&(e.publishExecutionData=t.publishExecutionData)},_initProcessRequestParameters:function(e,t){Terrasoft.isEmptyObject(t)||Terrasoft.each(t,(function(t,r){e.addParameterValue(r,t)}),this)},_initProcessResultParameters:function(e,t){Terrasoft.isEmptyObject(t)||Terrasoft.each(t,(function(t){e.addResultParameter(t)}),this)},runSpecifiedProcessVersion:function(e,t,r){this.log(Ext.String.format(Terrasoft.Resources.ObsoleteMessages.ObsoleteMethodMessage,"Terrasoft.ProcessEngineUtilities.runSpecifiedProcessVersion","Terrasoft.ProcessEngineUtilities.runProcess")),this.runProcess({schemaUId:e,collectExecutionData:!1,runSpecifiedVersion:!0},t,r)},runProcess:function(e,t,r){var n={schemaUId:e.schemaUId,schemaName:e.schemaName};this._initCollectExecutionDataValue(n,e);var i=this._createRunProcessRequest(e,n);this._initProcessRequestParameters(i,e.parameterValues),this._initProcessResultParameters(i,e.resultParameterNames),i.execute(t,r)},_createRunProcessRequest:function(e,t){return Boolean(e.runSpecifiedVersion)?Ext.create("Terrasoft.RunSpecifiedProcessVersionRequest",t):Ext.create("Terrasoft.RunProcessRequest",t)},completeExecuting:function(e,t,r){var n={processElementUId:e.processElementUId};this._initCollectExecutionDataValue(n,e);var i=Ext.create("Terrasoft.CompleteExecutingRequest",n);this._initProcessRequestParameters(i,e.parameterValues),i.execute(t,r)}}),Ext.define("Terrasoft.Designers.ProcessSchemaDesignerViewModel",{extend:"Terrasoft.Designers.BaseProcessSchemaDesignerViewModel",alternateClassName:"Terrasoft.ProcessSchemaDesignerViewModel",mixins:{ProcessSchemaDesignerCopyMixin:"Terrasoft.ProcessSchemaDesignerCopyMixin",ProcessSchemaDesignerSearchMixin:"Terrasoft.ProcessSchemaDesignerSearchMixin",CustomEvent:"Terrasoft.mixins.CustomEventDomMixin"},contextHelpCode:"ProcessSchemaDesigner",storageLocationHref:"ProcessSchemaLocationHref",storageSchemaMetadata:"ProcessSchemaMetaData",storageSchemaResources:"ProcessSchemaResources",storageLoadedPropertiesItemName:"ProcessSchemaLoadedPropertiesItemName",schemaManager:Terrasoft.ProcessSchemaManager,urlHashPrefix:"processOld",elementSchemaManager:Terrasoft.ProcessFlowElementSchemaManager,activeBodyMaskId:null,_cachedItemInitializers:null,defaultInitializerName:"BaseProcessFlowElementSchemaItemInitializer",handleKeyDown:function(e,t,r){if(!r||!r.ctrlKey||e.ctrlKey)return e.preventDefault(),t.call(this),!1},_canInsertNodeInConnector:function(e){return 0!==e.incomingConnectionsLimit&&0!==e.outgoingConnectionsLimit},_onChangeElementType:function(e){var t=e.id,r={type:e.type,userTaskType:e.userTaskType};this.mixins.CustomEvent.publish("elementUpdateType",{id:t,config:r})},showBodyMask:function(){var e=Terrasoft.Mask.show({showHidden:!0,clearMasks:!0});return this.activeBodyMaskId=e,e},hideBodyMask:function(){var e=this.activeBodyMaskId;Ext.isEmpty(e)||(this.activeBodyMaskId=null,Terrasoft.Mask.hide(e))},onSandboxInitialized:function(){this.callParent(arguments),this.sandbox.registerMessages({ChangeElementType:{direction:Terrasoft.MessageDirectionType.SUBSCRIBE,mode:Terrasoft.MessageMode.BROADCAST}}),this.sandbox.subscribe("ChangeElementType",this._onChangeElementType,this)},constructor:function(){this.callParent(arguments);var e=Ext.create("Terrasoft.Collection");this.set("Items",e),this._cachedItemInitializers=new Map},onSchemaLoaded:function(e){this.callParent(arguments),this.on("change:SearchTextEditValue",this.onSearchTextEditValueChange,this),this.on("change:FoundItems",this.onFoundItemsChange,this);var t=this.get("Items");t.on("remove",this.onItemRemove,this),t.on("add",this.onItemAdd,this,{priority:900})},loadPropertiesPageMask:function(e){var t;if(Terrasoft.ProcessFlowElementSchemaManager.getIsEmailElement(e)){var r="#"+this.propertiesContainerId;Terrasoft.Mask.clearMasks(r),t=this.showBodyMask()}else t=this.callParent(arguments);return t},onHidePropertyPage:function(){this.saveElementProperties();var e=this.get("LoadedPropertiesItemName"),t=this.getPropertiesModuleId(e);this.set("LoadedPropertiesItemName",null),this.setVisiblePropertyPage(!1),this.sandbox.unloadModule(t)},loadItems:function(e){this.callParent(arguments);var t=Ext.create("Terrasoft.core.collections.Collection");this.loadLanes(e,t),this.loadContainers(e,t),this.loadElements(e,t),this.loadSequenceFlows(e,t),this._loadLabels(e,t),this._addDefaultLabels(e,t);var r=this.get("Items");r.loadAll(t)},_loadLabels:function(e,t){var r=this;e.labels.each((function(e){t.add(e.name,e).subscribeOnChangedEvent(r.onItemChanged,r)}))},_needAddLabel:function(e){return!e.hasEmbeddedLabel&&!Terrasoft.isEmpty(e.caption.getValue())},_addDefaultLabels:function(e,t){var r=this,n=e.labels.mapArrayByPath("name");e.flowElements.each((function(i){if(!e.labels.findByPath("parentUId",i.uId)&&r._needAddLabel(i)){var a=Terrasoft.generateGUID(),s=i.name+"_label",o=Terrasoft.getUniqueValue(n,s),l=new Terrasoft.ProcessLabelSchema({uId:a,parentUId:i.uId,name:o});e.labels.add(o,l),t.add(l.name,l).subscribeOnChangedEvent(r.onItemChanged,r)}}))},loadLanes:function(e,t){e.lanes.each((function(e){t.add(e.name,e)}),this)},loadContainers:function(e,t){e.flowElements.each((function(r){!0===r.isContainer&&this.addContainer(e,t,r)}),this)},addContainer:function(e,t,r){if(!t.find(r.name)){var n=r.parent;if(n){var i=e.flowElements.find(n);i&&this.addContainer(e,t,i)}t.add(r.name,r),r.subscribeOnChangedEvent(this.onItemChanged,this)}},loadElements:function(e,t){e.flowElements.each((function(e){!0!==e.isContainer&&(e.nodeType!==Terrasoft.diagram.UserHandlesConstraint.Connector&&t.add(e.name,e).subscribeOnChangedEvent(this.onItemChanged,this))}),this)},loadSequenceFlows:function(e,t){e.flowElements.filter((function(e){return e.nodeType===Terrasoft.diagram.UserHandlesConstraint.Connector})).each((function(e){e.sourceRefUId&&e.targetRefUId&&(t.add(e.name,e),e.subscribeOnChangedEvent(this.onItemChanged,this))}),this)},_getIsUserTask:function(e){return e instanceof Terrasoft.ProcessUserTaskSchema||e instanceof Terrasoft.ProcessSchemaUserTask},_initItem:function(e,t,r){if(this._getIsUserTask(e)){var n=e.schema&&e.schema.name||e.getTypeInfo().typeName;if(n){var i=this._cachedItemInitializers.get(n)||n+"ItemInitializer",a=this.defaultInitializerName;a===i||Terrasoft.ClientUnitSchemaManager.findRootSchemaItemByName(i)||(this._cachedItemInitializers.set(n,a),i=a),require([i],function(){this._cachedItemInitializers.set(n,i),this._initItemWithInitializer(e,i,t,r)}.bind(this),function(){this.log("Scheme ".concat(i," was not found, it's ok so previous 2 console errors about ")+"".concat(i,".js should not be taken into account")),require([a],function(){this._cachedItemInitializers.set(n,a),this._initItemWithInitializer(e,a,t,r)}.bind(this),function(){Ext.callback(t,r)}.bind(this))}.bind(this))}else Ext.callback(t,r)}else Ext.callback(t,r)},_initItemWithInitializer:function(e,t,r,n){new Terrasoft[t](e,this.sandbox).initElement(r,n)},onItemAdd:function(e){this.get("Schema").add(e),Terrasoft.Features.getIsEnabled("DisableProcessElementInitializers")?this._onItemInitialized(e):this._initItem(e,(function(){this._onItemInitialized(e)}),this)},_onItemInitialized:function(e){this.fireEvent("itemschanged",{action:"add",item:e}),e.subscribeOnChangedEvent(this.onItemChanged,this),this.clearSearchResult(),this.updateSuggestionsForSuggestedItem(e)},updateSuggestionsForSuggestedItem:function(e){},clearDependedConditionalFlows:function(e){this.get("Schema").flowElements.filterByFn((function(e){return e instanceof Terrasoft.ProcessConditionalSequenceFlowSchema}),this).filterByFn((function(t){var r=t.processActivitiesSelectedResults;return r&&r[e.uId]}),this).each((function(e){e.processActivitiesSelectedResults=null,e.isValidateExecuted=!1,e.isValid=!1,e.validationResults=[],this.fireEvent("itemIsValidChanged",e)}),this)},onItemRemove:function(e){this.get("Schema").remove(e.name);var t=this.get("RemovedItems")||[];t.push(e.name),this.set("RemovedItems",t),this.fireEvent("itemschanged",{action:"remove",item:e}),this.clearDependedConditionalFlows(e),e.unsubscribeOnChangedEvent(this.onItemChanged,this),this.clearElementPropertyPage(e),this.clearSearchResult()},onConnectorsNodesChange:function(e){Terrasoft.each(e,(function(e){var t=this.getItemByName(e.name),r=this.getItemByName(e.targetNode),n=this.getItemByName(e.sourceNode),i=Terrasoft.isEmptyGUID(t.targetRefUId);t.setSource({sourcePort:e.sourcePort,sourceRefUId:n.uId}),t.setTarget({targetPort:e.targetPort,targetRefUId:r.uId}),i&&this.loadPropertiesPage(e.name)}),this),this.clearSearchResult()},clearElementPropertyPage:function(){this.loadSchemaPropertiesPage()},onPolylinePointPositionsChanged:function(e){var t=this.get("Schema");e.forEach((function(e){var r=e.name,n=e.polylinePointPositions;t.changeSequenceFlowPolylinePointPositions(r,n)}),this),this.clearSearchResult()},onElementSizeChanged:function(e){this.get("Schema").changeItemSize(e.itemName,e.size),this.clearSearchResult()},onLinePositionChanged:function(e){this.get("Schema").changeLinePosition(e.itemName,e.position),this.clearSearchResult()},onItemDrop:function(e){var t=e.element.tag.element,r=this.get("Schema"),n=this.elementSchemaManager.createInstance(t.managerItemUId);if(!n.emptyDiagramCaption){var i=n.caption.getValue()||t.caption.getValue();n.caption=new Terrasoft.LocalizableString(i)}n.uId=Terrasoft.generateGUID();var a=r.findItemByName(e.containerName);return n.containerUId=a.uId,n.parent=a.name,n.position=n.getCenterPosition(e.localX,e.localY),n.isValidateExecuted=!1,this.onGenerateItemNameAndCaption(n),this.get("Items").add(n.name,n),this.loadPropertiesPage(n.name),!1},onNodesCollectionChange:function(e){"paste"===e.changeType&&this.onPasteElement(e)},onPasteElement:function(e){var t=e.element;this.get("LoadedPropertiesItemName")&&this.saveElementProperties(),this.pasteElement(t),this.clearSearchResult()},onDiagramClick:function(e){var t=e.element;t&&"pseudoGroup"!==t.type&&t.name?this.loadPropertiesPage(t.name):this.loadSchemaPropertiesPage()},onDiagramDoubleClick:function(e){if("doubletap"===e.evt.type){this.setVisiblePropertyPage(!0);var t=e.element;t&&t.name?this.loadPropertiesPage(t.name):this.loadSchemaPropertiesPage()}},onSearchShowButtonClick:function(){this.get("IsSearchVisible")?this.model.trigger("change:IsSearchVisible",this,!0):this.set("IsSearchVisible",!0)},onActualize:function(){this.set("IsActiveVersionMenuItemEnabled",!0);var e=this.get("Schema");this.setIsActualVersionByUId(e.uId,Ext.emptyFn,this)},onSearchHideButtonClick:function(){this.set("IsSearchVisible",!1),this.clearSearchResult(),this.set("LastSelectedItemName","")},onShowProcessLog:function(){window.open(Terrasoft.workspaceBaseUrl+"/Nui/ViewModule.aspx#SectionModuleV2/SysProcessLogSectionV2/")},openSourceCode:function(e){Terrasoft.BaseSchemaDesignerUtilities.openSourceCode(e)},onOpenSourceCodeClick:function(){var e=Terrasoft.Resources.ProcessSchemaDesigner.Messages.SaveSourceCodeConfirmationMessage;this.showSaveConfirmationDialog(e,(function(){var e=this.get("Schema");this.openSourceCode(e)}),this)},showProcessConfirmationDialog:function(e,t,r,n){Terrasoft.ProcessSchemaDesignerUtilities.showProcessMessageBox({caption:e,message:t,handler:r,scope:this,buttons:n})},showPublishConfirmationDialog:function(e,t,r){r=r||this;var n=Terrasoft.Resources.SchemaDesigner.SchemaSavedMessage+". "+Terrasoft.Resources.SchemaDesigner.MustBePublishedMessage,i=Terrasoft.Resources.SchemaDesigner.PublishButtonCaption,a=Terrasoft.getButtonConfig("publish",i,"publish");this.showProcessConfirmationDialog(n,e,(function(e){if("publish"===e)r.publish(t,r);else{Ext.callback(t,r,[!0])}}),[a,"cancel"])},_showErrorsConfirmationDialog:function(e){var t=Terrasoft.Resources.SchemaDesigner.SchemaSavedErrorsMessage;this.showProcessConfirmationDialog(t,e,null,["close"])},saveProcessSchemaResponse:function(e,t){e.hasErrors&&!e.validationErrorsInfo?this._showErrorsConfirmationDialog(e.message):e.message&&t?this.showPublishConfirmationDialog(e.message):this.callParent(arguments)},onRunProcessClick:function(){this.hideMessagePanel(),this.saveElementProperties();var e=Terrasoft.Resources.ProcessSchemaDesigner.Messages.RunProcessConfirmationMessage;this.showSaveConfirmationDialog(e,(function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];t||e.hasErrors||(e.message?this.showPublishConfirmationDialog(e.message,(function(e){e||this.run()}),this):this.run())}),this)},onCopyProcessClick:function(){var e=Terrasoft.Resources.ProcessSchemaDesigner.Messages.CopyProcessConfirmationMessage;this.showSaveConfirmationDialog(e,(function(){this.getProcessModuleUtilities((function(t){var r=this.get("Schema"),n={sourceUId:r.uId,sourceName:r.name,sourceCaption:r.caption.getValue()};t.getCopyProcessConfig(n,(function(r){t.copyProcess(r,(function(r){e=Terrasoft.Resources.SchemaDesigner.SchemaCopiedMessage,this.showMessagePanel(e),t.showProcessSchemaDesigner(r)}),this)}),this)}),this)}),this)},onRunProcessSuccess:function(){var e=Terrasoft.Resources.ProcessSchemaDesigner.Messages.SuccessfullyRunProcessInformationMessage;this.showMessagePanel(e)},run:function(e,t){this.clearSchemaStorageInfo();var r=this.get("Schema");this.showBodyMask();var n={schemaUId:r.uId,runSpecifiedVersion:!0,collectExecutionData:!1};Terrasoft.ProcessEngineUtilities.runProcess(n,(function(r){if(this.hideBodyMask(),r)if(r.isSuccess())this.onRunProcessSuccess();else{var n=Ext.String.trim(r.errorInfo.message)||Ext.String.format(Terrasoft.Resources.ProcessSchemaDesigner.Messages.ErrorStartBusinessProcessMessage,r.errorInfo.errorCode);Terrasoft.showErrorMessage(n)}Ext.callback(e,t)}),this)},publish:function(e,t){this.getProcessModuleUtilities((function(r){Terrasoft.BaseSchemaDesignerUtilities.publish(r,(function(){this.get("Schema").deleteSchemaChanges(),Ext.callback(e,t||this)}),this)}),this)},onTextChange:function(e){this.getItemByName(e.element.name).setLocalizableStringPropertyValue("caption",e.value)},onInsertNodeInConnector:function(e,t){var r=this.get("Items"),n=r.get(e);if(this._canInsertNodeInConnector(n)){var i=r.get(t.name),a=i.insertFlowElement(n);return t.targetPort=i.targetSequenceFlowPointLocalPosition,this.onGenerateItemNameAndCaption(a),r.add(a.name,a),this.clearSearchResult(),!1}},onKeyDown:function(e){switch(this.callParent(arguments),e.keyCode){case Ext.EventObject.K:return this.handleKeyDown(e,this.onOpenSourceCodeClick,{ctrlKey:!0});case Ext.EventObject.ENTER:return this.handleKeyDown(e,this.onRunProcessClick,{ctrlKey:!0});case Ext.EventObject.L:return this.handleKeyDown(e,this.onShowProcessLog,{ctrlKey:!0});case Ext.EventObject.ESC:if("diagram-schema-designer"===e.target.id)return this.handleKeyDown(e,this.onHidePropertyPage);break;case Ext.EventObject.F:return this.handleKeyDown(e,this.onSearchShowButtonClick,{ctrlKey:!0})}},onItemsRemoving:function(e){var t=Terrasoft.ProcessSchemaDesignerUtilities,r=this.get("Schema");t.validateAllLazyPropertiesAreLoaded(r,(function(n){n&&t.validateElementRemoval(r,e.itemNameList,(function(t){t&&e.diagram.getInstance()._delete()}),this)}),this)},onGenerateItemNameAndCaption:function(e){var t,r=0,n=e.name,i=this.get("Items"),a=this.get("RemovedItems"),s=!0;do{t=n+ ++r,s=this.containsCaseInsensitive(i,t)||_.contains(a,t)}while(s);e.name=t;var o=e.caption;if(o){var l=o.cultureValues;Terrasoft.each(l,(function(e,t){e&&(l[t]=e+" "+r)}))}return!1},containsCaseInsensitive:function(e,t){return e.getKeys().some((function(e){return e.toUpperCase()===t.toUpperCase()}))},findItemByName:function(e){var t=this.get("Schema");return t.name===e?t:this.get("Items").find(e)},findItemByKey:function(e){return this.findItemByName(e)},onDestroy:function(){var e=this.get("Items");e.destroy(),this.callParent(arguments)},clearSchemaItems:function(){this.get("Items").clear()},selectItem:function(e){this.fireEvent("itemSelected",e)},clearSelection:function(){this.fireEvent("clearSelection",this)},tryEditSchema:function(e){this.getSchemaInstance(e,this.onSchemaLoaded,this)},getItemKey:function(e){return e.name},onItemsPositionChanged:function(e){var t=this.get("Schema");e.forEach((function(e){var r=e.itemName;t.changeItemPosition(r,e.position)}),this),this.clearSearchResult()},onItemsContainerChanged:function(e){var t=this.get("Schema");e.forEach((function(e){var r=e.itemName,n=e.containerName;t.changeItemContainer(r,n)}),this),this.clearSearchResult()},getItemByName:function(e){var t=this.findItemByKey(e);if(!t){var r=Terrasoft.Resources.ProcessSchemaDesigner.Messages.ElementNotFoundMessage;throw new Terrasoft.ItemNotFoundException({message:Ext.String.format(r,e)})}return t}}),Ext.define("Terrasoft.Designers.ProcessSchemaDesignerLogViewModel",{extend:"Terrasoft.ProcessSchemaDesignerViewModel",alternateClassName:"Terrasoft.ProcessSchemaDesignerLogViewModel",mixins:{processSchemaDesignerLogMixin:"Terrasoft.ProcessSchemaDesignerLogMixin"},constructor:function(){this.callParent(arguments),this.mixins.processSchemaDesignerLogMixin.initColumns.apply(this,arguments)},init:function(){this.mixins.processSchemaDesignerLogMixin.init.apply(this,arguments)}}),Ext.define("Terrasoft.Designers.PackageDependenciesDiagramViewModel",{extend:"Terrasoft.Designers.ProcessSchemaDesignerViewModel",alternateClassName:"Terrasoft.PackageDependenciesDiagramViewModel",mixins:{packageDependenciesDiagramMixin:"Terrasoft.PackageDependenciesDiagramMixin"},init:function(){this.mixins.packageDependenciesDiagramMixin.init.apply(this,arguments)}}),Ext.define("Terrasoft.Designers.ProcessSchemaDesigner",{extend:"Terrasoft.Designers.BaseProcessSchemaDesigner",alternateClassName:"Terrasoft.ProcessSchemaDesigner",diagram:null,designerViewModelClassName:"Terrasoft.ProcessSchemaDesignerViewModel",leftPanelCollapsed:!1,leftPanelCollapseClass:"schema-designer-left-panel-collapsed",storageLeftPanelCollapsed:"ProcessDesigner_LeftPanelCollapsed",leftToolbarClassName:"Terrasoft.ProcessSchemaDesignerLeftToolbar",schemaDiagramClassName:"Terrasoft.ProcessSchemaDiagram",leftToolbarHeaderButtonCaption:Terrasoft.Resources.SchemaDesigner.LeftPanelHeaderButtonCaption,hasLeftToolbar:!0,diagramConfig:{classes:{wrapClassName:["ej-diagram","ts-box-sizing"]},items:{bindTo:"Items"},click:{bindTo:"onDiagramClick"},doubleClick:{bindTo:"onDiagramDoubleClick"},connectorsNodesChange:{bindTo:"onConnectorsNodesChange"},itemsContainerChanged:{bindTo:"onItemsContainerChanged"},itemsPositionChanged:{bindTo:"onItemsPositionChanged"},textChange:{bindTo:"onTextChange"},linePositionChanged:{bindTo:"onLinePositionChanged"},sizeChanged:{bindTo:"onElementSizeChanged"},generateItemNameAndCaption:{bindTo:"onGenerateItemNameAndCaption"},polylinePointPositionsChanged:{bindTo:"onPolylinePointPositionsChanged"},insertNodeInConnector:{bindTo:"onInsertNodeInConnector"},nodesCollectionChange:{bindTo:"onNodesCollectionChange"},itemsRemoving:{bindTo:"onItemsRemoving"}},getDiagramConfig:function(){return Ext.apply({},this.diagramConfig,{id:this.id})},addElementCopyMenuItem:function(e,t){e.push(Ext.create("Terrasoft.MenuItem",{id:this.id+"-process-copy-element-mi",caption:t.CopyElementMenuItemCaption,onItemClick:this.onCopyElementClick.bind(this)}))},addElementPasteMenuItem:function(e,t){e.push(Ext.create("Terrasoft.MenuItem",{id:this.id+"-process-paste-element-mi",caption:t.PasteElementMenuItemCaption,onItemClick:this.onPasteElementClick.bind(this)}))},addActualizeActiveVersionMenuItem:function(e,t){e.push(Ext.create("Terrasoft.MenuItem",{id:this.id+"-actualize-schema-mi",caption:t.ActualizeSchemaMessage,click:{bindTo:"onActualize"},enabled:{bindTo:"IsActiveVersionMenuItemEnabled",bindConfig:{converter:function(e){return!e}}}}))},addProcessSourceCodeMenuItem:function(e,t){e.push(Ext.create("Terrasoft.MenuItem",{id:this.id+"-process-source-code-mi",caption:t.SourceCodeMenuItemCaption,click:{bindTo:"onOpenSourceCodeClick"}}))},addProcessMetaDataMenuItem:function(e,t){e.push(Ext.create("Terrasoft.MenuItem",{id:this.id+"-process-meta-data-mi",caption:t.MetaDataMenuItemCaption,click:{bindTo:"onOpenMetaDataClick"}}))},addProcessCopyMenuItem:function(e,t){e.push(Ext.create("Terrasoft.MenuItem",{id:this.id+"-process-copy-mi",caption:t.CopyMenuItemCaption,click:{bindTo:"onCopyProcessClick"}}))},addSchemaExportMenuItem:function(e,t){e.push(Ext.create("Terrasoft.MenuItem",{id:this.id+"-process-export-to-png-mi",caption:t.ExportMetaDataItemCaption,click:{bindTo:"onExportSchemaClick"}}))},addProcessLogMenuItem:function(e,t){e.push(Ext.create("Terrasoft.MenuItem",{id:this.id+"-process-log-mi",caption:t.ProcessLogMenuItemCaption,click:{bindTo:"onShowProcessLog"}}))},addSeparatorMenuItem:function(e){e.push({className:"Terrasoft.MenuSeparator"})},getSaveButton:function(){return{className:"Terrasoft.Button",id:this.id+"-save-btn",caption:Terrasoft.Resources.SchemaDesigner.SaveButtonCaption,style:{bindTo:"getSaveButtonStyle"},click:{bindTo:"save"},hint:{bindTo:"getSaveButtonHint"},markerValue:"save",menu:{items:{bindTo:"SaveButtonMenuItems"}}}},getRunButton:function(){return{className:"Terrasoft.Button",id:this.id+"-run-btn",caption:Terrasoft.Resources.SchemaDesigner.RunButtonCaption,style:Terrasoft.controls.ButtonEnums.style.BLUE,click:{bindTo:"onRunProcessClick"},hint:Terrasoft.Resources.SchemaDesigner.RunButtonHint,markerValue:"run"}},getCloseButton:function(){return{className:"Terrasoft.Button",id:this.id+"-close-btn",caption:Terrasoft.Resources.SchemaDesigner.CloseButtonCaption,style:Terrasoft.controls.ButtonEnums.style.GREY,click:{bindTo:"close"},markerValue:"close"}},getActionsButton:function(e){return{className:"Terrasoft.Button",id:this.id+"-actions-btn",caption:Terrasoft.Resources.SchemaDesigner.ActionsButtonCaption,classes:{wrapperClass:["t-btn-actions"]},menu:{items:e},markerValue:"actions"}},createToolBarLefContainerItems:function(e){return[this.getSaveButton(),this.getRunButton(),this.getCloseButton(),this.getActionsButton(e)]},getCreateToolbarLeftContainerConfig:function(e){return{className:"Terrasoft.Container",id:this.id+"-toolbar-left",classes:{wrapClassName:["toolbar-left"]},items:this.createToolBarLefContainerItems(e)}},createToolbarLeftContainer:function(){var e=Terrasoft.Resources.SchemaDesigner,t=[];return this.addProcessSourceCodeMenuItem(t,e),this.addProcessMetaDataMenuItem(t,e),this.addProcessCopyMenuItem(t,e),this.addSchemaExportMenuItem(t,e),this.addProcessLogMenuItem(t,e),this.addActualizeActiveVersionMenuItem(t,e),this.addSeparatorMenuItem(t),this.addElementCopyMenuItem(t,e),this.addElementPasteMenuItem(t,e),this.getCreateToolbarLeftContainerConfig(t)},getSearchShowButtonConfig:function(){return{id:this.id+"-search-show-btn",classes:{wrapperClass:"t-btn-image margin-right-0px t-btn-image-left search-show-button"},click:{bindTo:"onSearchShowButtonClick"},visible:{bindTo:"IsSearchVisible",bindConfig:{converter:function(e){return!e}}},hint:Terrasoft.Resources.SchemaDesigner.SearchShowButtonHint,markerValue:"SearchShowButton"}},createToolbarRightContainer:function(){var e=[this.createSearchContainer(),Ext.create("Terrasoft.Button",this.getSearchShowButtonConfig()),Ext.create("Terrasoft.Button",this.getSchemaPropertiesButtonConfig()),Ext.create("Terrasoft.Button",this.getHelpButtonConfig())];if(Terrasoft.Features.getIsEnabled("ProcessESN")){var t=Ext.create("Terrasoft.Button",this.getESNFeedButtonConfig());e.splice(2,0,t)}return{className:"Terrasoft.Container",id:this.id+"-toolbar-right",classes:{wrapClassName:["toolbar-right"]},items:e}},createSearchContainer:function(){var e=Terrasoft.Resources.SchemaDesigner,t="t-btn-image t-btn-image-left ",r=this.searchTextEdit=Ext.create("Terrasoft.TextEdit",{id:this.id+"-search-edit",classes:{wrapClass:["ts-box-sizing","search-edit"]},value:{bindTo:"SearchTextEditValue"},listeners:{enterkeypressed:this.onSearchTextEditEnterKeyPressed.bind(this),keydown:this.onSearchTextEditKeyDown.bind(this),keyup:this.onSearchTextEditKeyUp.bind(this)},placeholder:e.SearchTextEditPlaceholder,markerValue:"SearchTextEdit"}),n=Ext.create("Terrasoft.Label",{id:this.id+"-search-info-label",caption:{bindTo:"SearchInfo"},classes:{labelClass:["search-info-label"]},visible:{bindTo:"IsItemsFound"},markerValue:"SearchInfoLabel"}),i=Ext.create("Terrasoft.Label",{id:this.id+"-search-error-info-label",caption:{bindTo:"SearchErrorInfo"},classes:{labelClass:["search-info-label","search-error-info-label"]},visible:{bindTo:"FoundItems",bindConfig:{converter:function(e){return e&&e.isEmpty()}}},markerValue:"SearchErrorInfoLabel"}),a=Ext.create("Terrasoft.Button",{id:this.id+"-search-previous-btn",classes:{wrapperClass:t+"search-previous-button"},click:{bindTo:"onSearchPreviousButtonClick"},visible:{bindTo:"IsItemsFound"},hint:Terrasoft.Resources.SchemaDesigner.SearchPreviousButtonHint,markerValue:"SearchPreviousButton"}),s=Ext.create("Terrasoft.Button",{id:this.id+"-search-next-btn",classes:{wrapperClass:t+"search-next-button"},click:{bindTo:"onSearchNextButtonClick"},visible:{bindTo:"IsItemsFound"},hint:Terrasoft.Resources.SchemaDesigner.SearchNextButtonHint,markerValue:"SearchNextButton"}),o=Ext.create("Terrasoft.Button",{id:this.id+"-search-btn",classes:{wrapperClass:t+"search-button"},click:{bindTo:"onSearchButtonClick"},hint:Terrasoft.Resources.SchemaDesigner.SearchButtonHint,markerValue:"SearchButton"}),l=Ext.create("Terrasoft.Button",{id:this.id+"-search-hide-btn",classes:{wrapperClass:t+"search-hide-button"},click:{bindTo:"onSearchHideButtonClick"},hint:Terrasoft.Resources.SchemaDesigner.SearchHideButtonHint,markerValue:"SearchHideButton"}),c=Ext.create("Terrasoft.Container",{id:this.id+"-search-tools-container",classes:{wrapClassName:["search-tools-container"]},items:[n,i,a,s,o,l]});return Ext.create("Terrasoft.Container",{id:this.id+"-search-container",classes:{wrapClassName:["search-container"]},visible:{bindTo:"IsSearchVisible"},items:[r,c]})},createToolbarContainer:function(){var e=this.callParent(arguments),t=this.createToolbarLeftContainer(),r=this.createToolbarRightContainer();return e.add(t),e.add(r),e},renderDesignContainer:function(){this.callParent(arguments);var e=this.designerViewModel;e.on("itemschanged",this.onProcessSchemaItemAdd,this),e.on("itemCaptionChanged",this.onItemCaptionChanged,this),e.on("itemIsValidChanged",this.onItemIsValidChanged,this),e.on("clearSelection",this.onClearSelection,this),e.on("itemSelected",this.onItemSelected,this),e.on("updateItemsHighlighter",this.onUpdateItemsHighlighter,this),e.on("change:IsSearchVisible",this.onIsSearchVisibleChange,this)},initDesignerManagers:function(e,t){this.callParent([_asyncToGenerator(regeneratorRuntime.mark((function r(){return regeneratorRuntime.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,Terrasoft.ProcessFlowElementSchemaManager.initializeAsync();case 2:e.call(t);case 3:case"end":return r.stop()}}),r)}))),this])},onAfterDesignerRender:function(){this.callParent(arguments),this.preloadDragImages()},preloadDragImages:function(){var e=Terrasoft.ProcessFlowElementSchemaManager.getItems();if(!e.isEmpty()){var t=e.getItems();Terrasoft.chain.apply(this,t.map((function(e){return function(t){e.getInstance((function(e){this.preloadDragImage(e,t)}),this)}}),this))}},preloadDragImage:function(e,t){var r=this;if(e.getDragImage){var n=new Image;n.onload=t,n.onerror=function(){if(Terrasoft.isDebug){var i=Ext.String.format("Drag image not found for schema '{0}'. Source url: {1}",e.$className,n.src);r.error(i)}t()};var i=e.getDragImage();n.src=Terrasoft.ImageUrlBuilder.getUrl(i)}else t()},toggleLeftPanel:function(e){var t=this.leftPanelCollapseClass,r=this.leftPanel.wrapEl;void 0!==e?e?r.addCls(t):r.removeCls(t):r.toggleCls(t),this.leftPanelCollapsed=r.hasCls(t),window.localStorage.setItem(this.storageLeftPanelCollapsed,this.leftPanelCollapsed);setTimeout(function(){this.onDesignContentSizeChanged()}.bind(this),1e3)},onLeftPanelHeaderButtonClick:function(){this.toggleLeftPanel()},getLeftPanelClasses:function(){var e=["schema-designer-left-panel"];return("true"===window.localStorage.getItem(this.storageLeftPanelCollapsed)||!1)&&e.push(this.leftPanelCollapseClass),{wrapClassName:e}},getModelColumns:function(){return _.clone(this.columns)||{}},createDiagram:function(){var e=this.getDiagramConfig(),t=this.diagram=Ext.create(this.schemaDiagramClassName,e);return t.on("click",this.onElementClick,this),t.on("doubleClick",this.onElementDoubleClick,this),t},addLeftToolbar:function(){var e=this.leftPanel=Ext.create("Terrasoft.Container",{id:this.id+"-left-panel",classes:this.getLeftPanelClasses()}),t=Ext.create("Terrasoft.Button",{id:this.id+"-left-panel-header-button",style:Terrasoft.controls.ButtonEnums.style.TRANSPARENT,classes:"schema-designer-left-panel-header-button",caption:this.leftToolbarHeaderButtonCaption,markerValue:"CollapseToolbar",onClick:this.onLeftPanelHeaderButtonClick.bind(this)}),r=this.leftToolBar=Ext.create(this.leftToolbarClassName,{id:this.id+"-left-toolbar",designer:this,itemDrop:{bindTo:"onItemDrop"}});e.add(t),e.add(r),r.initToolbarItems(),this.contentContainer.insert(e,0)},createDesignContainer:function(){var e=this.callParent(arguments);this.hasLeftToolbar&&this.addLeftToolbar();var t=this.createDiagram();return this.diagramContainer.add(t),e},onProcessSchemaItemAdd:function(){Ext.get("diagram-"+this.id).focus()},onElementClick:function(){this.focusDesigner()},onElementDoubleClick:function(){this.diagram.updatePageSize()},onItemCaptionChanged:function(e){var t=e.name,r=e.caption&&e.caption.getValue()||"",n=e.notValidCaptionPrefix;this.diagram.setNodeCaption(t,r,n)},onItemIsValidChanged:function(e){var t=e.name,r=e.caption?e.caption.getValue():"",n=e.getLabelText(r,e.isValid),i=e.getLabelFontColor(e.isValid);this.diagram.setNodeCaptionWithColor(t,n,i)},onCopyElementClick:function(e){this.diagram.copyElement(),e.parentMenu.hide()},onPasteElementClick:function(e){this.diagram.pasteElement(),e.parentMenu.hide()},onClearSelection:function(){this.diagram.clearSelection()},onItemSelected:function(e){this.diagram.selectItem(e)},onIsSearchVisibleChange:function(e,t){if(t){var r=this.searchTextEdit.getEl();r.focus(),r&&r.dom&&r.dom.select()}},onSearchTextEditEnterKeyPressed:function(){this.designerViewModel.onSearchButtonClick()},onSearchTextEditKeyDown:function(e,t){var r=this.designerViewModel;return t.keyCode===t.ESC?(t.preventDefault(),void r.onSearchHideButtonClick()):!t.shiftKey||t.keyCode!==t.ENTER&&t.keyCode!==t.F3?void(t.shiftKey||t.keyCode!==t.F3||(t.preventDefault(),r.onSearchButtonClick())):(t.preventDefault(),void r.searchPreviousItem())},onSearchTextEditKeyUp:function(e){var t=e.getTypedValue();e.changeValue(t)},onUpdateItemsHighlighter:function(e,t){this.diagram.updateItemsHighlighter(e,t)}}),Ext.define("Terrasoft.Designers.ProcessSchemaDesignerViewModelNew",{extend:"Terrasoft.Designers.ProcessSchemaDesignerViewModel",alternateClassName:"Terrasoft.ProcessSchemaDesignerViewModelNew",mixins:{customEvent:"Terrasoft.mixins.CustomEventDomMixin",diagramTypeResolver:"Terrasoft.diagram.ProcessDiagramTypeResolver"},_cachedSuggestionsMap:null,_defaultSuggestionsLoadingTimeout:2e3,_suggestionsPopupShowDelay:100,urlHashPrefix:"process",serviceTaskGroups:[Terrasoft.FlowElementGroup.ServiceTask,Terrasoft.FlowElementGroup.Subprocess],userTaskGroups:[Terrasoft.FlowElementGroup.UserTask],_getImageUrl:function(e){if(!e)return null;var t={source:Terrasoft.ImageSources.RESOURCE_MANAGER,params:{resourceManagerName:"Terrasoft.Nui",resourceItemName:"ProcessSchemaDesigner."+e}};return Terrasoft.ImageUrlBuilder.getUrl(t)},_addUnsupportedElements:function(e){for(var t=Terrasoft.ProcessDiagramUnsupportedTypes.length;t--;){var r=this.getUnsupportedElementConfig(Terrasoft.ProcessDiagramUnsupportedTypes[t]),n=r.type;e[n]={caption:n,isUnsupported:!0,showInReplaceMenu:!1,userTaskType:r.transformToType||n,width:r.width,height:r.height,largeImage:this._getImageUrl(r.largeImage),smallImage:"",menuOrder:null,replaceGroupId:null,type:n}}return e},_setEventSubProcessStartEvent:function(e){var t=this.getEventSubProcessStartSignalElementSchema(),r=this.toDiagramType(t),n=e[this.toDiagramType(Terrasoft.ProcessEventSubprocessSchema)];n&&(n.startEvent=r)},getElementSchemaManagerItems:function(){return this.elementSchemaManager.getItems().getItems()},getCustomDiagramElements:function(){var e=this,t=this.getElementSchemaManagerItems(),r=this.getExcludedMenuItems(),n=t.reduce((function(t,n){var i=n.instance,a=e.toDiagramType(i);if(!a)return t;var s=e.toDiagramTypeName(i),o=i.getImageConfig(i.largeImageName),l=i.getImageConfig(i.smallImageName),c=i.getImageConfig(i.titleImageName),u=i.caption&&i.caption.toString()||i.defaultCaption||"";t[s]&&console.warn('Duplicates element "'.concat(s,'" found'));var h=Terrasoft.process.constants.PROCESS_DIAGRAM_REPLACE_MENU_ORDER,f=!i.isDeprecated&&!Terrasoft.contains(r,i.name);return t[s]={caption:u,type:a,width:i.width,height:i.height,showInReplaceMenu:f,menuOrder:h.findIndex((function(e){return e===i.name})),largeImage:o&&Terrasoft.ImageUrlBuilder.getUrl(o),smallImage:l&&Terrasoft.ImageUrlBuilder.getUrl(l),propertiesImage:c&&Terrasoft.ImageUrlBuilder.getUrl(c),userTaskType:s,replaceGroupId:e.getElementReplaceGroupId(i)},t}),{});return this._setEventSubProcessStartEvent(n),this._addUnsupportedElements(n),n},getEventSubProcessStartSignalElementSchema:function(){return Terrasoft.ProcessStartSignalNonInterruptingSchema},getElementReplaceGroupId:function(e){switch(!0){case this.serviceTaskGroups.includes(e.group):return Terrasoft.FlowElementGroup.ServiceTask;case this.userTaskGroups.includes(e.group):return Terrasoft.FlowElementGroup.UserTask;default:return null}},getCustomDiagramReplaceMenuGroups:function(){var e,t=Terrasoft.FlowElementGroup;return _defineProperty(e={},t.ServiceTask,{id:t.ServiceTask,imageUrl:this._getImageUrl("ElementReplaceGroup.ServiceActionsImage.svg"),label:Terrasoft.Resources.ProcessSchemaDesigner.ElementsToolbarGroup.ServiceTask}),_defineProperty(e,t.UserTask,{id:t.UserTask,imageUrl:this._getImageUrl("ElementReplaceGroup.UserTask.svg"),label:Terrasoft.Resources.ProcessSchemaDesigner.ElementsToolbarGroup.UserTask}),e},getPaletteUserTask:function(){var e=this,t=Terrasoft.FlowElementGroup.UserTask,r=Terrasoft.flatten(this.userTaskGroups.map((function(t){return e.getMenuItemsByGroup(t)}))),n={type:"userTask",title:Terrasoft.Resources.ProcessSchemaDesigner.ElementsToolbarGroup[t],imageUrl:"TaskPalette.svg",menu:r};return this.addUserTaskType(n,"ActivityUserTask"),n},getPaletteServiceTask:function(){var e=this,t=Terrasoft.flatten(this.serviceTaskGroups.map((function(t){return e.getMenuItemsByGroup(t)}))),r={type:"serviceTask",title:Terrasoft.Resources.ProcessSchemaDesigner.ElementsToolbarGroup[Terrasoft.FlowElementGroup.ServiceTask],imageUrl:"SmartTaskPalette.svg",menu:t};return this.addUserTaskType(r,"ReadDataUserTask"),r},getElementToolsUserTask:function(){var e={type:"userTask",title:Terrasoft.Resources.ProcessSchemaDesigner.ElementsToolbarGroup[Terrasoft.FlowElementGroup.UserTask],image:"icon_tools_task.svg"};return this.addUserTaskType(e,"ActivityUserTask"),e},getElementToolsServiceTask:function(){var e={type:"serviceTask",title:Terrasoft.Resources.ProcessSchemaDesigner.ElementsToolbarGroup[Terrasoft.FlowElementGroup.ServiceTask],image:"SmartTaskTool.svg"};return this.addUserTaskType(e,"ReadDataUserTask"),e},addUserTaskType:function(e,t){var r=this.elementSchemaManager.getItems().getItems().find((function(e){return e.instance.name===t}));r&&(e.userTaskType=this.toDiagramTypeName(r.instance))},getExcludedMenuItems:function(){return["ReportFileProcessingUserTask","ProcessFileProcessingUserTask"]},getMenuItemsByGroup:function(e){var t=this,r=this.elementSchemaManager.getItems().getItems(),n=this.getExcludedMenuItems();return r.map((function(e){return e.instance})).filter((function(t){return t.group===e})).filter((function(e){return!e.isDeprecated})).filter((function(e){return!Terrasoft.contains(n,e.name)})).map((function(e){return t.toDiagramTypeName(e)})).sort((function(e,r){return t.getMenuItemOrder(e)-t.getMenuItemOrder(r)}))},getMenuItemOrder:function(e){var t=this.paletteItemMenuOrder(),r=t.length,n=t.indexOf(e);return n<0&&(n=r+1),n},paletteItemMenuOrder:function(){return["activityUserTask","userQuestionUserTask","openEditPageUserTask","autoGeneratedPageUserTask","preconfiguredPageUserTask","emailUserTask","readDataUserTask","addDataUserTask","changeDataUserTask","deleteDataUserTask","formulaTask","changeAdminRightsUserTask","objectFileProcessingUserTask","webService","mLDataPredictionUserTask","sendEmailUserTask","scriptTask","linkEntityToProcessUserTask","userTask","emailTemplateUserTask","searchDuplicatesUserTask"]},getCustomPaletteElements:function(){var e=this,t=this.getPaletteUserTask(),r=this.getPaletteServiceTask(),n=_objectSpread(_objectSpread(_objectSpread({},t?{userTask:t}:{}),r?{serviceTask:r}:{}),{},{startEvent:{type:"startEvent",imageUrl:"StartEventPalette.svg",title:Terrasoft.Resources.ProcessSchemaDesigner.Elements.StartEventCaption},intermediateThrowEventSignal:{type:"intermediateThrowEventSignal",imageUrl:"IntermediateEventPalette.svg",title:Terrasoft.Resources.ProcessSchemaDesigner.Elements.IntermediateThrowSignalCaption},endEvent:{type:"endEvent",imageUrl:"EndEventPalette.svg",title:Terrasoft.Resources.ProcessSchemaDesigner.Elements.TerminateEventCaption},exclusiveGateway:{type:"exclusiveGateway",imageUrl:"GatewayPalette.svg",title:Terrasoft.Resources.ProcessSchemaDesigner.Elements.ExclusiveGatewayCaption}});return Object.values(n).forEach((function(t){t.imageUrl=e._getImageUrl(t.imageUrl)})),n},getCustomElementToolsConfig:function(){var e=this,t=this.getElementToolsUserTask(),r=this.getElementToolsServiceTask(),n=[t].concat([r],[{image:"icon_tools_gateway.svg",type:"exclusiveGateway",title:Terrasoft.Resources.ProcessSchemaDesigner.Elements.ExclusiveGatewayCaption},{image:"icon_tools_intermediate_event.svg",type:"intermediateThrowEventSignal",title:Terrasoft.Resources.ProcessSchemaDesigner.Elements.IntermediateThrowSignalCaption},{image:"icon_tools_end_event.svg",type:"endEvent",title:Terrasoft.Resources.ProcessSchemaDesigner.Elements.TerminateEventCaption}]).filter((function(e){return e}));return n.forEach((function(t){t.image=e._getImageUrl(t.image)})),{addItems:n,tools:{connect:{imageUrl:this._getImageUrl("ElementTools.ArrowToolsImage.svg"),title:Terrasoft.Resources.ProcessSchemaDesigner.ElementTools.ConnectHint},setup:{imageUrl:this._getImageUrl("ElementTools.SetupToolsImage.svg"),title:Terrasoft.Resources.ProcessSchemaDesigner.ElementTools.ChangeTypeHint},delete:{imageUrl:this._getImageUrl("ElementTools.DeleteToolsImage.svg"),title:Terrasoft.Resources.ProcessSchemaDesigner.ElementTools.RemoveHint},suggestions:{enabled:Boolean(this.get("SuggestionsEnabled")),enabledAutoOpenPopup:Boolean(this.get("AutoOpenSuggestionsPopup")),imageUrl:this._getImageUrl("ElementTools.AISuggestionToolsImage.svg"),title:Terrasoft.Resources.ProcessSchemaDesigner.ElementTools.AISuggestionHint,loadingTimeout:this.get("SuggestionsLoadingTimeout")+this._suggestionsPopupShowDelay}}}},getCustomLocalizableStrings:function(){return{elementTools:{copySuffixCaption:Terrasoft.Resources.SchemaDesigner.CopySuffixCaption},fitToView:Terrasoft.Resources.ProcessSchemaDesigner.FitToView,resetView:Terrasoft.Resources.ProcessSchemaDesigner.ResetView,zoomIn:Terrasoft.Resources.ProcessSchemaDesigner.ZoomIn,zoomOut:Terrasoft.Resources.ProcessSchemaDesigner.ZoomOut,miniMapOpen:Terrasoft.Resources.ProcessSchemaDesigner.MiniMapOpen,miniMapClose:Terrasoft.Resources.ProcessSchemaDesigner.MiniMapClose,arrow:Terrasoft.Resources.ProcessSchemaDesigner.ArrowHint,lasso:Terrasoft.Resources.ProcessSchemaDesigner.LassoHint,space:Terrasoft.Resources.ProcessSchemaDesigner.SpaceToolHint,suggestions:{popupTitle:Terrasoft.Resources.ProcessSchemaDesigner.Suggestions.PopupTitle,popupSubtitle:Terrasoft.Resources.ProcessSchemaDesigner.Suggestions.PopupSubtitle}}},getCustomImages:function(){return{spinnerImage:this._getImageUrl("SuggestionsSpinner.svg")}},getDiagramConfig:function(){var e={customDiagramElements:this.getCustomDiagramElements(),customDiagramReplaceMenuGroups:this.getCustomDiagramReplaceMenuGroups(),customPaletteElements:this.getCustomPaletteElements(),customElementToolsConfig:this.getCustomElementToolsConfig(),customLocalizableStrings:this.getCustomLocalizableStrings(),customMarkers:this.getCustomMarkers()};return this.getIsSuggestionsEnabled()&&(e.customImages=this.getCustomImages()),e},getCustomMarkers:function(){return{Collapsed:{smallImage:this._getImageUrl("CollapsedSmall.svg")},SequenceMultiInstance:{smallImage:this._getImageUrl("SequenceMultiInstanceSmall.svg")},ParallelMultiInstance:{smallImage:this._getImageUrl("ParallelMultiInstanceSmall.svg")}}},onItemChanged:function(e,t){this.callParent(arguments),e.hasOwnProperty("markers")&&this.fireEvent("itemMarkersChanged",{uId:t.uId,markers:e.markers})},_getDefaultLane:function(e){var t=e.filterByPath("typeName","Terrasoft.Core.Process.ProcessSchemaLane");return 1===t.getCount()?t.getByIndex(0):null},_getContainerName:function(e){var t=this.get("Items"),r=this._getDefaultLane(t),n="root1"===e?r:t.findByPath("uId",e)||r;return n&&n.name},_validateRemove:function(e){var t=this;return new Promise((function(r){var n=t.get("Schema");Terrasoft.chain((function(e){return Terrasoft.ProcessSchemaDesignerUtilities.validateAllLazyPropertiesAreLoaded(n,e,t)}),(function(e,t){return t?e():r(!1)}),(function(r){return Terrasoft.ProcessSchemaDesignerUtilities.validateElementRemoval(n,e,r,t)}),(function(e,t){return r(t)}),t)}))},_setItemParent:function(e,t){var r=this._getContainerName(e),n=this.get("Schema").findItemByName(r);n&&(t.containerUId=n.uId,t.parent=n.name)},_isUnsupportedElement:function(e){return Terrasoft.ProcessDiagramUnsupportedTypes.indexOf(e)>-1},_createElement:function(e){var t=this.getFlowElementSchemaManagerItemByTypeName(e.type).uId,r=this.elementSchemaManager.createInstance(t);return r.uId=e.id,r.caption=new Terrasoft.LocalizableString(""),this._isUnsupportedElement(e.type)&&(r.unsupportedType=e.type),this._setItemParent(e.parent,r),e.size&&(r.size=e.size),r.position={X:e.position.rx||e.position.X,Y:e.position.ry||e.position.Y},r.isValidateExecuted=!1,r.defaultParamValues=e.defaultParamValues,r.source=e.source,this.onGenerateItemNameAndCaption(r),e.caption&&(r.caption=new Terrasoft.LocalizableString(e.caption)),r},_createLabel:function(e){var t=this.get("Schema"),r=e.parentUId,n=t.findItemByUId(r).name+"_label",i=new Terrasoft.ProcessLabelSchema({uId:e.id,parentUId:r,name:n});return this.onGenerateItemNameAndCaption(i),i},_findChildElements:function(e){var t=this,r=this.get("Items"),n=[],i=r.filterByPath("containerUId",e.uId).getItems();return n.push.apply(n,_toConsumableArray(i)),i.forEach((function(e){n.push.apply(n,_toConsumableArray(t._findChildElements(e)))})),n},_getElementNameList:function(e){var t=this,r=this.get("Items"),n=[];return e.forEach((function(e){var i=r.findByPath("uId",e);i&&n.push.apply(n,[i].concat(_toConsumableArray(t._findChildElements(i))))})),n.map((function(e){return e.name}))},_findItemByUId:function(e){return this.get("Items").findByPath("uId",e)},_internalCreateFlow:function(e){if(e){var t=this.get("Items"),r=e.source,n=this._findItemByUId(r),i=e.target,a=this._findItemByUId(i),s=Ext.create(this.getClassName(e),{uId:e.id,name:e.type,sourceNode:n.name,sourceRefUId:r,sourceSequenceFlowPointLocalPosition:"0;0",targetNode:a.name,targetRefUId:i,targetSequenceFlowPointLocalPosition:"0;0",showPropertiesWindowOnAdding:!0,isValidateExecuted:!1});if(e.sourceSequenceFlowPointLocalPosition&&(s.sourceSequenceFlowPointLocalPosition=e.sourceSequenceFlowPointLocalPosition),e.sourceSequenceFlowPointLocalPosition&&(s.targetSequenceFlowPointLocalPosition=e.targetSequenceFlowPointLocalPosition),s.flowType===Terrasoft.ProcessSchemaEditSequenceFlowType.CONDITIONAL&&(s.isValid=!1),e.polylinePointPositions&&(s.polylinePointPositions=e.polylinePointPositions),s.name=s.connectionUserHandleName,e.portPositions&&this.setPortPosition(e,s),!1!==this.onGenerateItemNameAndCaption(s)){for(var o=1,l=s.name,c=l+o;t.contains(c);)c=l+ ++o;s.name=c}return e.caption&&(s.caption=new Terrasoft.LocalizableString(e.caption)),s}},_loadButtonPropertiesPageByName:function(e){e?this.loadPropertiesPage(e):this.loadSchemaPropertiesPage()},_clearImportData:function(){this.set("ImportData",null)},_getCoreProcessSchemaName:function(e){switch(!0){case Terrasoft.ProcessDiagramUnsupportedTerminateEventTypes.includes(e):return"Terrasoft.Core.Process.ProcessSchemaUnsupportedTerminateEvent";case Terrasoft.ProcessBoundaryEventTypes.includes(e):return"Terrasoft.Core.Process.ProcessSchemaBoundaryEvent";default:return"Terrasoft.Core.Process.ProcessSchemaUnsupportedElement"}},_setMLSequenceElementsCountForPredictionSettings:function(){var e=Terrasoft.SysSettings.getCachedSysSetting("MLSequenceElementsCountForPrediction");this.set("SequenceElementsCountForPrediction",e)},_getSequence:function(e){var t=this.get("Schema").getFlowElements(),r=t.findByFn((function(t){return t.uId===e})),n=[];this._addSequenceElement(r,n,t);var i=this.get("SequenceElementsCountForPrediction");return i&&i>0&&(n=n.slice(0,i)),n.reverse()},_serializeParametersForSuggestionsRequest:function(e){var t=[];return e.parameters?(Terrasoft.each(e.parameters,(function(e){t.push({sourceValue:{value:Ext.isObject(e.sourceValue.value)?JSON.stringify(e.sourceValue.value):e.sourceValue.value,source:e.sourceValue.source},name:e.name,referenceSchemaUId:e.referenceSchemaUId||void 0})})),e.entity&&t.push({sourceValue:{value:e.entity},name:"EntitySchemaUId"}),t):t},_serializeSequenceForSuggestionsRequest:function(e){var t=this;return e.map((function(e){return{elementId:e.uId,typeName:e.typeName,schemaName:e.schema&&e.schema.name,serializedParameters:JSON.stringify(t._getParametersForSuggestionsRequest(e))}}))},_addSequenceElement:function(e,t,r){if(!t.some((function(t){return t.elementId===e.uId}))&&(t.push(e),"StartEvent"!==e.group)){var n=r.findByFn((function(t){return t.targetRefUId===e.uId}));if(n){var i=r.findByFn((function(e){return e.uId===n.sourceRefUId}));this._addSequenceElement(i,t,r)}}},_setSuggestionsRequestState:function(e,t){this._cachedSuggestionsMap.set(e,{state:t})},_setSuggestionsRequestResultToCache:function(e,t){this._cachedSuggestionsMap.set(e,{suggestions:t,state:Terrasoft.ProcessSuggestionsRequestStatus.Success})},_getIsSuggestionsRequestInState:function(e,t){return this._cachedSuggestionsMap.get(e).state===t},_isActiveSuggestionsRequest:function(e){return this._getIsSuggestionsRequestInState(e,Terrasoft.ProcessSuggestionsRequestStatus.Active)},_isTimedOutSuggestionsRequest:function(e){return this._getIsSuggestionsRequestInState(e,Terrasoft.ProcessSuggestionsRequestStatus.Timeout)},_getSuggestionsFromCacheOrDefaultStorage:function(e,t,r){var n=this._cachedSuggestionsMap.get(t),i=n.state===Terrasoft.ProcessSuggestionsRequestStatus.Success?n.suggestions:this.get("DefaultSuggestions");r.call(this,e,i)},_getSuggestionsCacheKey:function(e,t){var r=this._convertDiagramItemsToSuggestionValues(e);return t&&r.length>0&&(r[r.length-1].parameters=t),JSON.stringify(r)},_onUpdateSuggestions:function(e){if(e){var t=this._getItemUIdForGenerateSuggestions(e.elementName);this.set("Suggestions",{elementId:t,suggestions:[]}),this.set("SuggestionsTriggered",{elementId:t,uniquestamp:Date.now()}),this._processSuggestions(e.elementName,e.predictionParams)}},updateSuggestionsForSuggestedItem:function(e){this.callParent(arguments);var t=e.defaultParamValues;"suggestions"===e.source&&t&&t.referenceSchemaUId&&this._onUpdateSuggestions({elementName:e.name,predictionParams:{entitySchemaUId:t.referenceSchemaUId}})},_getSuggestionsRequestConfig:function(e,t){return{url:Terrasoft.workspaceBaseUrl+"/rest/MLProcessPredictionService/PredictNextElement",headers:{Accept:"application/json","Content-Type":"application/json"},method:"POST",jsonData:JSON.stringify({elements:e,predictionParams:t})}},_onSuggestionsItemsRequestEnd:function(e,t,r,n,i,a){var s;try{if((s=JSON.parse(a.responseText)).resultType===Terrasoft.ProcessSuggestionsResultTypes.ServiceNotConfigured&&(this.warning("ML service is not configured to predict next process elements. Read https://academy.creatio.com/docs/user/setup_and_administration/on-site_deployment/machine_learning_service"),this.set("SuggestionsEnabled",!1)),!i||s.errorMessage||s.resultType!==Terrasoft.ProcessSuggestionsResultTypes.Success)throw Error(s.errorMessage||"Unknown error")}catch(n){return this._setSuggestionsRequestState(t,Terrasoft.ProcessSuggestionsRequestStatus.Error),void r.call(this,e,this.get("DefaultSuggestions"))}var o=s.predictions;this._setSuggestionsRequestResultToCache(t,o),r.call(this,e,o)},_onSuggestionsRetrieveTimeoutPassed:function(e,t,r){this._isActiveSuggestionsRequest(e)&&(this._setSuggestionsRequestState(e,Terrasoft.ProcessSuggestionsRequestStatus.Timeout),r.call(this,t,this.get("DefaultSuggestions")))},_generateSuggestionsForItem:function(e,t,r){var n=this._getSequence(e);if(!(n.length<1)){var i=this._getSuggestionsCacheKey(n,t);if(this._needSendRequestForGenerateSuggestions(i)){this._setSuggestionsRequestState(i,Terrasoft.ProcessSuggestionsRequestStatus.Active);var a=this._serializeSequenceForSuggestionsRequest(n);Terrasoft.AjaxProvider.request(_objectSpread(_objectSpread({},this._getSuggestionsRequestConfig(a,t)),{},{callback:this._onSuggestionsItemsRequestEnd.bind(this,e,i,r),scope:this})),setTimeout(this._onSuggestionsRetrieveTimeoutPassed.bind(this,i,e,r),this.get("SuggestionsLoadingTimeout"))}else{if(this._isActiveSuggestionsRequest(i))return;this._getSuggestionsFromCacheOrDefaultStorage(e,i,r)}}},_needSendRequestForGenerateSuggestions:function(e){var t=this._cachedSuggestionsMap.get(e);return!t||t.state===Terrasoft.ProcessSuggestionsRequestStatus.Error},_getItemUIdForGenerateSuggestions:function(e){var t=this.get("Items").findByFn((function(t){return t.name===e}));if(t&&"Terrasoft.Core.Process.ProcessSchemaSequenceFlow"!==t.typeName&&"Terrasoft.Core.Process.ProcessSchemaTerminateEvent"!==t.typeName)return t.uId},_processSuggestions:function(e,t){if(e&&this.getIsSuggestionsEnabled()){var r=this._getItemUIdForGenerateSuggestions(e);r&&(this.get("SuggestionsEnabled")?this._generateSuggestionsForItem(r,t,this._onItemSuggestionsGenerated):this._onItemSuggestionsGenerated(r,this.get("DefaultSuggestions")))}},_convertDiagramItemsToSuggestionValues:function(e){if(e){var t,r=[],n=_createForOfIteratorHelper(e);try{for(n.s();!(t=n.n()).done;){var i=t.value,a=void 0;try{var s,o=null!==(s=i.schemaName)&&void 0!==s?s:i.schema&&i.schema.name;if(o)a=Terrasoft.toLowerCamelCase(o);else{var l=Terrasoft.ProcessFlowElementSchemaManager.getItemByType(i.typeName).instance;a=this.toDiagramTypeName(l)}}catch(e){var c=e.message||e.toString();console.warn("Element type conversion failed: "+c);continue}var u={type:a,parameters:{}};i.entitySchemaUId?(u.parameters.entitySchemaUId=i.entitySchemaUId,u.parameters.entitySchemaCaption=i.entitySchemaCaption):i.parameters&&(u.parameters=this._getParametersForSuggestionsRequest(i)),r.push(u)}}catch(e){n.e(e)}finally{n.f()}return r}},_getParametersForSuggestionsRequest:function(e){var t=this._serializeParametersForSuggestionsRequest(e);return this._filterParametersForSuggestionsRequest(t)},_filterParametersForSuggestionsRequest:function(e){return e.filter((function(e){return!e.name.includes("Filter")}))},_onItemSuggestionsGenerated:function(e,t){var r={elementId:e,suggestions:this._convertDiagramItemsToSuggestionValues(t)};this.set("Suggestions",r)},_setDefaultSuggestionsSettings:function(){var e=Terrasoft.SysSettings.getCachedSysSetting("MLProcessDefaultSuggestions");if(e){var t=e.split(";").map((function(e){var t=e.split(":"),r=_slicedToArray(t,2);return{typeName:r[0],schemaName:r[1]}}));this.set("DefaultSuggestions",t)}var r=1e3*Terrasoft.SysSettings.cachedSettings.MLSuggestionsLoadingTimeout||this._defaultSuggestionsLoadingTimeout;this.set("SuggestionsLoadingTimeout",r)},_getIsAutoOpenSuggestionsPopupEnabled:function(){return Terrasoft.SysSettings.getCachedSysSetting("MLProcessAutoOpenSuggestionsPopup")},onSandboxInitialized:function(){this.callParent(arguments),this.getIsSuggestionsEnabled()&&(this.sandbox.registerMessages({UpdateSuggestions:{direction:Terrasoft.MessageDirectionType.SUBSCRIBE,mode:Terrasoft.MessageMode.PTP},GetElementEntityConfigForSuggestions:{direction:Terrasoft.MessageDirectionType.PUBLISH,mode:Terrasoft.MessageMode.PTP}}),this.sandbox.subscribe("UpdateSuggestions",this._onUpdateSuggestions,this))},onPolylinePointPositionsChanged:function(e){this.callParent(arguments),Terrasoft.each(e,(function(e){if(e.portPositions){var t=this.getItemByName(e.name);this.setPortPosition(e,t)}}),this)},onConnectorsNodesChange:function(e){Terrasoft.each(e,(function(e){var t=this.getItemByName(e.name);e.source&&t.setSourceRef(e.source),e.target&&t.setTargetRef(e.target)}),this),this.clearSearchResult()},getFlowElementSchemaManagerItemByTypeName:function(e){var t=this.elementSchemaManager.getItems().getItems().find((function(t){var r=t.instance,n=this.toDiagramType(r);if(!n)return!1;var i="userTask"===n?r.name:n;return Terrasoft.toLowerCamelCase(i)===e}),this);return t||(t=this.elementSchemaManager.getItemByType(this._getCoreProcessSchemaName(e))),t},getClassName:function(e){return _.invert(Terrasoft.ProcessDiagramTypesEnum)[e.type]},createFlow:function(e){return this._internalCreateFlow(e)},setPortPosition:function(e,t){var r=e.portPositions.source,n=e.portPositions.target;t.setSourcePortPositionByPoints(r),t.setTargetPortPositionByPoints(n),t.endPoint=n.position,t.startPoint=r.position},getIsSuggestionsEnabled:function(){return!Terrasoft.Features.getIsEnabled("DisableProcessAISuggestions")},constructor:function(){this._cachedSuggestionsMap=new Map,this.callParent(arguments),this.addEvents("click","itemCenterViewBox","itemMarkersChanged")},init:function(){this.callParent(arguments);var e=this.getIsSuggestionsEnabled();if(this.set("SuggestionsEnabled",e),e){this._setDefaultSuggestionsSettings(),this._setMLSequenceElementsCountForPredictionSettings();var t=this._getIsAutoOpenSuggestionsPopupEnabled();this.set("AutoOpenSuggestionsPopup",t)}this.set("DiagramConfig",this.getDiagramConfig())},getModelColumns:function(){var e=this.callParent(arguments);return e.DiagramConfig={type:Terrasoft.ViewModelColumnType.VIRTUAL_COLUMN,dataValueType:Terrasoft.DataValueType.CUSTOM_OBJECT},e.ImportData={type:Terrasoft.ViewModelColumnType.VIRTUAL_COLUMN,dataValueType:Terrasoft.DataValueType.CUSTOM_OBJECT},e},onBpmnFileSelected:function(e){var t=e[0],r=new FileReader;r.readAsText(t),r.onload=function(){this.onDiagramImportStart(),this.set("ImportData",r.result),this._clearImportData()}.bind(this)},onConnectorCreate:function(e){if(e){var t=this.createFlow(e);this.get("Items").add(t.name,t),this.fireEvent("itemCaptionChanged",t),this.loadPropertiesPage(t.name),this.clearSearchResult()}},onConnectorChangingType:function(e){var t=this,r=e.connections,n=e.next,i=this.get("Schema");Terrasoft.each(r,(function(e){var r=i.findItemByName(e.name);if(!t._validateRemove([r.name]))return!1;var a=t.get("Items"),s={id:r.uId,type:e.type,source:r.sourceRefUId,target:r.targetRefUId,polylinePointPositions:r.polylinePointPositions,sourceSequenceFlowPointLocalPosition:r.sourceSequenceFlowPointLocalPosition,targetSequenceFlowPointLocalPosition:r.targetSequenceFlowPointLocalPosition},o=t.createFlow(s),l=r.caption;o.caption=l,a.replace(r,o,o.name),n({id:r.uId,name:o.name,caption:l.getValue()});var c=t.$SelectedItemName===r.name?o.name:t.$SelectedItemName;t.onItemSelected(c)}))},onItemCreate:function(e){var t;if(e&&(t=e.nodeType===Terrasoft.diagram.UserHandlesConstraint.Label?this._createLabel(e):this._createElement(e),this.$Items.add(t.name,t),t.parent)){var r=this.$Items.findByPath("name",t.parent);"Terrasoft.Core.Process.ProcessSchemaEventSubProcess"===r.typeName&&"Terrasoft.Core.Process.ProcessSchemaStartSignalEvent"===t.typeName&&this.onDiagramClick({element:{name:r.name}})}},onItemsRemoved:function(e){var t=e.ids;if(0!==t.length){var r=this._getElementNameList(t),n=this.get("Schema"),i=this.get("Items");r.forEach((function(e){var t=n.findItemByName(e);i.remove(t)}))}},onItemsRemoving:function(){var e=_asyncToGenerator(regeneratorRuntime.mark((function e(t){var r,n,i,a;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=t.ids,n=t.next,i=t.cancel,0!==r.length){e.next=3;break}return e.abrupt("return");case 3:return a=this._getElementNameList(r),e.next=6,this._validateRemove(a);case 6:if(e.sent){e.next=10;break}return i(),e.abrupt("return");case 10:n();case 11:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),onItemValidateUpdatingType:function(){var e=_asyncToGenerator(regeneratorRuntime.mark((function e(t,r){var n,i;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=this.get("Schema"),i=n.findItemByUId(t),e.next=4,this._validateRemove([i.name]);case 4:if(e.sent){e.next=7;break}return e.abrupt("return");case 7:r();case 8:case"end":return e.stop()}}),e,this)})));return function(t,r){return e.apply(this,arguments)}}(),onItemTypeUpdated:function(e,t){var r=this.get("Schema").findItemByUId(e.id),n=this.get("Items"),i=this._createElement({id:e.id,position:r.position,type:e.userTaskType,size:{width:e.width,height:e.height},parent:r.containerUId});i.caption=r.caption;var a=i.name;n.replace(r,i,a),this.onItemSelected(a),t(a)},onItemSelected:function(e){this.$SelectedItemName=e,this._loadButtonPropertiesPageByName(e)},onItemSuggestionsClick:function(e){var t=this.sandbox.publish("GetElementEntityConfigForSuggestions");t&&t.elementName===e&&t.predictionParams?this._processSuggestions(e,t.predictionParams):this._processSuggestions(e)},onOpenPropertyPage:function(e){this.get("IsShowPropertyPage")||(this.set("IsShowPropertyPage",!0),this._loadButtonPropertiesPageByName(e))},onItemsContainerChanged:function(e){var t=e.itemName,r=this._getContainerName(e.parent);this.get("Schema").changeItemContainer(t,r),this.clearSearchResult()},createItemCopy:function(e,t){var r=this.mixins.ProcessSchemaDesignerCopyMixin.createItemCopy.call(this,e);return r.uId=t.id,this._setItemParent(t.parentId,r),r.caption=new Terrasoft.LocalizableString(t.caption),r.position={X:t.position.x,Y:t.position.y},r},pasteElement:function(e){var t=this.$Items.findByFn((function(t){return t.uId===e.sourceId})),r=this.createItemCopy(t,e);this.$Items.add(r.name,r),this.cloneParameters(r,t)},clearElementPropertyPage:function(e){this.$SelectedItemName===e.name&&this.callParent(arguments)},onUpdateStudioFreeDiagramUrl:function(e){this.get("Schema").setPropertyValue("studioFreeProcessUrl",e)},onCanCopy:function(e){var t=this.get("Schema");return e.every((function(e){var r=t.findItemByUId(e.id),n=r&&r.hasLazyParameters,i=n&&r.getAllLazyParametersAreLoaded();return!n||i}))},onImportError:function(){this.showInformationDialog(Terrasoft.Resources.ProcessSchemaDesigner.Messages.ProcessImportError)},onDiagramImportStart:function(){this.onHidePropertyPage(),this.$Schema.clearSchemaMappings(),this.setVisiblePropertyPage(!0)}}),Ext.define("Terrasoft.Designers.ProcessSchemaDesignerLogViewModelNew",{extend:"Terrasoft.ProcessSchemaDesignerViewModelNew",alternateClassName:"Terrasoft.ProcessSchemaDesignerLogViewModelNew",mixins:{processSchemaDesignerLogMixin:"Terrasoft.ProcessSchemaDesignerLogMixin"},constructor:function(){this.callParent(arguments),this.mixins.processSchemaDesignerLogMixin.initColumns.apply(this,arguments)},init:function(){this.set("DiagramConfig",this.getDiagramConfig()),this.mixins.processSchemaDesignerLogMixin.init.apply(this,arguments)}}),Ext.define("Terrasoft.Designers.ProcessSchemaDesignerNew",{extend:"Terrasoft.Designers.ProcessSchemaDesigner",alternateClassName:"Terrasoft.ProcessSchemaDesignerNew",schemaDiagramClassName:"Terrasoft.ProcessDiagramComponent",designerViewModelClassName:"Terrasoft.ProcessSchemaDesignerViewModelNew",hasLeftToolbar:!1,showImportButton:!0,_getImageConfig:function(e){return e?{source:Terrasoft.ImageSources.RESOURCE_MANAGER,params:{resourceManagerName:"Terrasoft.Nui",resourceItemName:"ProcessSchemaDesigner."+e}}:null},_addImportProcessMenuItem:function(e){e.push(Ext.create("Terrasoft.MenuItem",{id:this.id+"-import-process-mi",caption:Terrasoft.Resources.SchemaDesigner.ImportFromBpmnCaption,markerValue:Terrasoft.Resources.SchemaDesigner.ImportFromBpmnCaption,fileUpload:!0,fileTypeFilter:[".bpmn"],filesSelected:{bindTo:"onBpmnFileSelected"},imageConfig:this._getImageConfig("ImportIconButton.svg")}))},getDiagramConfig:function(){var e=this.callParent(arguments),t=_objectSpread(_objectSpread({},e),{},{diagramItemCreated:{bindTo:"onItemCreate"},connectorCreate:{bindTo:"onConnectorCreate"},connectorUpdatingType:{bindTo:"onConnectorChangingType"},diagramConfig:{bindTo:"DiagramConfig"},itemValidateUpdatingType:{bindTo:"onItemValidateUpdatingType"},itemTypeUpdated:{bindTo:"onItemTypeUpdated"},itemSelected:{bindTo:"onItemSelected"},openPropertyPage:{bindTo:"onOpenPropertyPage"},pasteElement:{bindTo:"onPasteElement"},canCopy:{bindTo:"onCanCopy"},itemsRemoved:{bindTo:"onItemsRemoved"},importData:{bindTo:"ImportData"},importError:{bindTo:"onImportError"},diagramImportStart:{bindTo:"onDiagramImportStart"},updateStudioFreeDiagramUrl:{bindTo:"onUpdateStudioFreeDiagramUrl"},suggestions:{bindTo:"Suggestions"},suggestionsTriggered:{bindTo:"SuggestionsTriggered"},itemSuggestionsClick:{bindTo:"onItemSuggestionsClick"}});return t},renderDesignContainer:function(){this.callParent(arguments);var e=this.designerViewModel;e.on("itemCenterViewBox",this.onItemCenterViewBox,this),e.on("itemMarkersChanged",this._onItemMarkersChanged,this)},onAfterDesignerRender:function(){this.callParent(arguments),this.diagram.initDiagram()},onItemIsValidChanged:function(e){this.diagram.setIsElementValid(e.uId,e.isValid)},onUpdateItemsHighlighter:function(e,t){},getActionsButton:function(e){return Terrasoft.Features.getIsEnabled("AllowBpmnImportInProcessLibrary")&&this.showImportButton&&this._addImportProcessMenuItem(e),this.callParent([e])},focusDesigner:function(){this.callParent(arguments),this.focusEl.blur()},addElementCopyMenuItem:Terrasoft.emptyFn,addElementPasteMenuItem:Terrasoft.emptyFn,onItemCenterViewBox:function(e){this.diagram.itemCenterViewBox(e)},_onItemMarkersChanged:function(e){var t=e.uId,r=e.markers;this.diagram.updateElementMarkers(t,r)}}),Ext.define("Terrasoft.Designers.PackageDependenciesDiagramViewModelNew",{extend:"Terrasoft.Designers.ProcessSchemaDesignerViewModelNew",alternateClassName:"Terrasoft.PackageDependenciesDiagramViewModelNew",mixins:{packageDependenciesDiagramMixin:"Terrasoft.PackageDependenciesDiagramMixin"},init:function(){this.mixins.customEvent.init(),this.set("DiagramConfig",this.getDiagramConfig()),this.mixins.packageDependenciesDiagramMixin.init.apply(this,arguments)}}),Ext.ns("Terrasoft.Core.Process"),Terrasoft.Core.Process.ProcessExecutionDataItemType={ElementExecutionData:0,CompletionData:1},Ext.define("Terrasoft.Core.Process.ExecutionDataUtils",{alternateClassName:"Terrasoft.ProcessExecutionDataUtils",singleton:!0,_sessionStoragePrefix:"CompletedProcessElement.",_completedProcessElementsStorage:null,_isDisableRingBufferForCompletedProcessElements:!1,constructor:function(){if(this._isDisableRingBufferForCompletedProcessElements=Terrasoft.Features.getIsEnabled("DisableRingBufferForCompletedProcessElements"),!this._isDisableRingBufferForCompletedProcessElements){var e=Terrasoft.SysSettings.getCachedSysSetting("RingBufferLengthForCompletedProcessElements")||5e4;this._completedProcessElementsStorage=Ext.create("Terrasoft.RingBuffer",{maxLength:e,isOnlyUniqueItems:!0})}},_markElementAsCompleted:function(e){this._isDisableRingBufferForCompletedProcessElements?window.sessionStorage.setItem("".concat(this._sessionStoragePrefix).concat(e),"1"):this._completedProcessElementsStorage.pushItem(e)},getIsElementCompleted:function(e){return this._isDisableRingBufferForCompletedProcessElements?Boolean(window.sessionStorage.getItem("".concat(this._sessionStoragePrefix).concat(e))):this._completedProcessElementsStorage.getIsItemExists(e)},_getProcessStepsInfo:function(e,t){var r=null,n=null,i=Object.keys(e).filter((function(t){return e[t].procElUId===t})).map((function(t){return e[t]}));return Terrasoft.each(i,(function(i){var a={processId:e.processId,elementCaption:e.elementCaption,processCaption:e.processCaption,batchStartSessionId:e.batchStartSessionId};a[i.procElUId]=i,i.processId===t?n=a:r=a}),this),{nextProcessItem:r,currentProcessItem:n}},tryHandleCompletionData:function(e){return e.type===Terrasoft.Core.Process.ProcessExecutionDataItemType.CompletionData&&(this._markElementAsCompleted(e.data.uId),!0)},getNextElementData:function(e,t,r){var n=!1,i=null,a=null;return Terrasoft.each(e,(function(e){if(e.type===Terrasoft.Core.Process.ProcessExecutionDataItemType.CompletionData&&(e.data.uId===r&&(n=!0),this._markElementAsCompleted(e.data.uId)),!Ext.isDefined(e.type)){var s=this._getProcessStepsInfo(e,t);i=s.currentProcessItem||i,a=s.nextProcessItem||a}}),this),{nextPage:a=a||i,isCurrentElementCompleted:n,currentProcessPage:a===i?null:i}},_markExecutionDataItemsWithBatchId:function(e){var t=Terrasoft.generateGUID();Terrasoft.each(e,(function(e){e.batchStartSessionId=t}),this)},prepareBatchExecutionDataItems:function(e){this._markExecutionDataItemsWithBatchId(e);var t={readyItems:e,itemsToEnqueue:[]};return e&&e.length>1&&(Terrasoft.Features.getIsEnabled("DisplayAllProcessPagesStartedByRecords")?(t.itemsToEnqueue=e.slice(1).reverse(),t.readyItems=e.slice(0,1)):e.reverse()),t},getIsExecutionDataItemsHaveSameBatchId:function(e,t){return(e&&e.batchStartSessionId)===(t&&t.batchStartSessionId)}}),Ext.ns("Terrasoft.services.enums"),Terrasoft.services.enums.ServiceContentType={UNDEFINED:0,JSON:1,XML:2},Terrasoft.services.enums.HttpMethodType={UNDEFINED:0,GET:1,POST:2,PUT:3,PATCH:4,DELETE:5},Terrasoft.services.enums.ServiceParameterValueSource={UNDEFINED:0,CONST:1,SYS_SETTING:2},Terrasoft.services.enums.ServiceParameterType={UNDEFINED:0,BODY:1,URL_SEGMENT:2,QUERY_STRING:3,HTTP_HEADER:4,COOKIE:5},Terrasoft.services.enums.ServiceType={UNDEFINED:0,REST:1,SOAP11:2,SOAP12:3},Terrasoft.services.enums.DataValueTypeName={Text:"Text",Integer:"Integer",Float:"Float",Boolean:"Boolean",DateTime:"DateTime",Guid:"Guid",Date:"Date",Time:"Time",Object:"Object"},Terrasoft.services.enums.AuthType={None:0,Basic:1,Digest:2,OAuth20:3},Terrasoft.services.enums.CredentialsLocation={REQUEST_BODY:1,BASIC_HEADER:2,QUERY_STRING:3},Terrasoft.services.enums.AccessType={OFFLINE:1,ONLINE:2,NOT_USE:3},Ext.define("Terrasoft.ServiceMetaItem",{extend:"Terrasoft.MetaItem",_serviceSchema:null,_onChanged:function(e){var t={};Terrasoft.each(e,(function(e,r){var n=Ext.isEmpty(this.getPropertyPath())?r:this.getPropertyPath()+"."+r;t[n]=e}),this),this._serviceSchema&&this._serviceSchema.fireEvent("changed",t,this)},getPropertyPath:function(){return Ext.String.empty},getServiceSchema:function(){return this._serviceSchema},constructor:function(){this.callParent(arguments),this.on("changed",this._onChanged,this)}}),Ext.define("Terrasoft.services.ServiceParameterValue",{extend:"Terrasoft.ServiceMetaItem",alternateClassName:"Terrasoft.ServiceParameterValue",mixins:{serializable:"Terrasoft.Serializable"},value:null,source:Terrasoft.services.enums.ServiceParameterValueSource.UNDEFINED,getSerializableObject:function(e){e.value=this.value,e.source=this.source}}),Ext.define("Terrasoft.services.ServiceParameter",{extend:"Terrasoft.ServiceMetaItem",alternateClassName:"Terrasoft.ServiceParameter",caption:null,description:null,path:null,defValue:null,dataValueTypeName:Terrasoft.services.enums.DataValueTypeName.Text,isArray:!1,sequenceElementName:"item",isRequired:!1,itemProperties:null,type:Terrasoft.services.enums.ServiceParameterType.UNDEFINED,_getItemPropertiesConfigItems:function(e){return e&&e.itemProperties&&(e.itemProperties.items||e.itemProperties.Items)},_initItemProperties:function(e){this.itemProperties=this.itemProperties||new Terrasoft.ObjectCollection;var t=this._getItemPropertiesConfigItems(e);t&&!Terrasoft.isInstanceOfClass(e.itemProperties,"Terrasoft.ObjectCollection")&&(this.itemProperties=new Terrasoft.ObjectCollection,Terrasoft.each(t,(function(e,t){e._serviceSchema=this.getServiceSchema(),this.itemProperties.add(t,Ext.create("Terrasoft.ServiceParameter",e))}),this))},_initDefValue:function(e){this.defValue=e&&e.defValue||this.defValue,this.defValue&&!Terrasoft.isInstanceOfClass(this.defValue,"Terrasoft.ServiceParameterValue")&&(this.defValue._serviceSchema=this.getServiceSchema(),this.defValue=Ext.create("Terrasoft.ServiceParameterValue",this.defValue)),this.defValue||(this.defValue=Ext.create("Terrasoft.ServiceParameterValue"))},_initCaption:function(){this.caption=this.caption?Ext.create("Terrasoft.LocalizableString",{cultureValues:this.caption}):Ext.create("Terrasoft.LocalizableString")},getRestoreOrder:function(e){return e.sort()},getPropertyPath:function(){return"parameter"},getSerializableProperties:function(){return["uId","name","caption","description","path","defValueSource","defValue","dataValueTypeName","isArray","sequenceElementName","isRequired","type","itemProperties"]},getSerializableObject:function(e){this.callParent(arguments),e.parameters=this.getSerializableProperty(this.itemProperties)},restorePropertyValue:function(e,t){"itemProperties"===e?(this.itemProperties.clear(),Terrasoft.each(t.items,(function(e,t){e._serviceSchema=this.getServiceSchema(),this.itemProperties.add(t,Ext.create("Terrasoft.ServiceParameter",e))}),this)):this.callParent(arguments)},constructor:function(e){e&&e.parameters&&delete e.parameters,this.callParent(arguments),this._initCaption(),this._initDefValue(e),this._initItemProperties(e)},setLocalizableStringPropertyValue:function(e,t,r){Terrasoft.validateObjectClass(this[e],"Terrasoft.LocalizableString"),r?this[e].setCultureValue(r,t):this[e].setValue(t);var n={};n[e]=this[e],this.fireEvent("changed",n,this)},copy:function(e){var t=Ext.create("Terrasoft.ServiceParameter",Ext.merge(JSON.parse(this.serialize()),{_serviceSchema:this._serviceSchema}));return t.uId=Terrasoft.generateGUID(),t.name+="Copy",0!==t.name.indexOf(Terrasoft.ServiceSchemaManager.schemaNamePrefix)&&(t.name=Terrasoft.ServiceSchemaManager.schemaNamePrefix+t.name),t.setLocalizableStringPropertyValue("caption",t.caption.getValue()+e.copyCaptionSufix),t.itemProperties&&t.itemProperties.each((function(r){var n=r.copy(e);t.itemProperties.replace(r,n,n.getPropertyValue("uId"))}),this),t},hasDefaultValue:function(){return this.defValue&&this.defValue.value}}),Ext.define("Terrasoft.services.ServiceMethodResponse",{extend:"Terrasoft.ServiceMetaItem",alternateClassName:"Terrasoft.ServiceMethodResponse",contentType:Terrasoft.services.enums.ServiceContentType.JSON,parameters:null,_getParametersConfigItems:function(e){return e&&e.parameters&&(e.parameters.items||e.parameters.Items)},_addParameters:function(e){var t=new Terrasoft.ObjectCollection;Terrasoft.each(e,(function(e,r){e._serviceSchema=this.getServiceSchema(),t.add(r,Ext.create("Terrasoft.ServiceParameter",e))}),this),this.parameters.reloadAll(t)},_onParametersChange:function(){this.fireEvent("changed",{parameters:this.parameters},this)},_initParameters:function(e){this.parameters=this.parameters||new Terrasoft.ObjectCollection;var t=this._getParametersConfigItems(e);t&&!Terrasoft.isInstanceOfClass(e.parameters,"Terrasoft.ObjectCollection")&&(this.parameters=new Terrasoft.ObjectCollection,this._addParameters(t)),this.parameters.on("changed",this._onParametersChange,this)},getSerializableProperties:function(){return["parameters","contentType"]},getSerializableObject:function(e){this.callParent(arguments),e.parameters=this.getSerializableProperty(this.parameters)},restorePropertyValue:function(e,t){"parameters"===e?(this.parameters.clear(),this._addParameters(t.items)):this.callParent(arguments)},constructor:function(e){this.callParent(arguments),this._initParameters(e)},onDestroy:function(){this.parameters.un("changed",this._onParametersChange,this),this.callParent(arguments)}}),Ext.define("Terrasoft.services.ServiceMethodRequest",{extend:"Terrasoft.ServiceMethodResponse",alternateClassName:"Terrasoft.ServiceMethodRequest",uri:null,contentType:Terrasoft.services.enums.ServiceContentType.JSON,httpMethodType:Terrasoft.services.enums.HttpMethodType.GET,bodyBuilderId:null,getSerializableProperties:function(){return["uri","contentType","httpMethodType","parameters","bodyBuilderId"]},findHttpMethodTypeName:function(){var e=null;return Terrasoft.each(Terrasoft.services.enums.HttpMethodType,(function(t,r){this.httpMethodType===t&&(e=r)}),this),e}}),Ext.define("Terrasoft.services.ServiceMethod",{extend:"Terrasoft.ServiceMetaItem",alternateClassName:"Terrasoft.ServiceMethod",_maxRetryTimeout:64e3,request:null,response:null,caption:null,requestTimeout:5e3,soapAction:null,useAuthInfo:!1,_initRequest:function(e){this.request=e&&e.request||this.request||{},this.request&&!Terrasoft.isInstanceOfClass(this.request,"Terrasoft.ServiceMethodRequest")&&(this.request._serviceSchema=this.getServiceSchema(),this.request=Ext.create("Terrasoft.ServiceMethodRequest",this.request))},_initResponse:function(e){this.response=e&&e.response||this.response||{},this.response&&!Terrasoft.isInstanceOfClass(this.response,"Terrasoft.ServiceMethodResponse")&&(this.response._serviceSchema=this.getServiceSchema(),this.response=Ext.create("Terrasoft.ServiceMethodResponse",this.response))},_initCaption:function(e){this.caption=e&&e.caption||this.caption,Terrasoft.isInstanceOfClass(this.caption,"Terrasoft.LocalizableString")||(this.caption=this.caption?Ext.create("Terrasoft.LocalizableString",{cultureValues:this.caption}):Ext.create("Terrasoft.LocalizableString"))},_getRetryTimeoutAttempt:function(e){return e>6?this._maxRetryTimeout:1e3*Math.pow(2,e)},_mergeAuthInfo:function(e){if(this.setPropertyValue("useAuthInfo",e.useAuthInfo),this._serviceSchema.authInfo.authType===Terrasoft.services.enums.AuthType.None){var t=e.getServiceSchema();this._serviceSchema.authInfo.setPropertyValue("authType",t.authInfo.authType),this._serviceSchema.authInfo.values.clear()}},_mergeParameters:function(e,t,r){t.suspendEvents(),this._mergeParametersCollection(e,t,r),t.resumeEvents(),t.fireEvent("dataLoaded")},_mergeParametersCollection:function(e,t,r){Terrasoft.each(e,(function(e){var n=r({method:this,path:e.path,type:e.type});n?n.dataValueTypeName===Terrasoft.services.enums.DataValueTypeName.Object&&this._mergeParametersCollection(e.itemProperties,n.itemProperties,r):t.add(e.uId,this._createParameterInstance(e))}),this)},_createParameterInstance:function(e){var t=new Terrasoft.ServiceParameter(Ext.merge({_serviceSchema:this._serviceSchema},{defValue:{source:e.defValue.source,value:e.defValue.value},description:e.description,isArray:e.isArray,isRequired:e.isRequired,path:e.path,name:e.name,uId:e.uId,type:e.type,dataValueTypeName:e.dataValueTypeName}));return t.setLocalizableStringPropertyValue("caption",e.caption.getValue()),e.itemProperties.each((function(e,r){t.itemProperties.add(r,this._createParameterInstance(e))}),this),t},_needMergeUri:function(e){return Ext.isEmpty(this.request.uri)||e&&e.options&&!e.options.skipUri},_needMergeHttpMethodType:function(e){var t=e&&e.options&&!e.options.skipHttpMethodType,r=this.request.parameters.filterByPath("type",Terrasoft.services.enums.ServiceParameterType.BODY).isEmpty(),n=e.method.request.httpMethodType!==Terrasoft.services.enums.HttpMethodType.GET;return t&&(n||r)},getSerializableProperties:function(){return["uId","name","caption","requestTimeout","request","response","useAuthInfo","soapAction"]},constructor:function(e){this.callParent(arguments),this._initRequest(e),this._initResponse(e),this._initCaption(e)},setLocalizableStringPropertyValue:function(e,t,r){Terrasoft.validateObjectClass(this[e],"Terrasoft.LocalizableString"),r?this[e].setCultureValue(r,t):this[e].setValue(t);var n={};n[e]=this[e],this.fireEvent("changed",n,this)},getRetryRequestTimeout:function(e){for(var t=this.requestTimeout,r=0;r<e;r++)t+=this.requestTimeout+this._getRetryTimeoutAttempt(r);return t},merge:function(e){e&&(e.method.request&&(e.method.request.parameters&&this._mergeParameters(e.method.request.parameters,this.request.parameters,Terrasoft.ServiceSchemaManager.findRequestParameterByPath.bind(Terrasoft.ServiceSchemaManager)),this._needMergeHttpMethodType(e)&&this.request.setPropertyValue("httpMethodType",e.method.request.httpMethodType),this._needMergeUri(e)&&this.request.setPropertyValue("uri",e.method.request.uri)),e.options&&e.options.useAuth&&this._mergeAuthInfo(e.method),e.method.response&&e.method.response.parameters&&this._mergeParameters(e.method.response.parameters,this.response.parameters,Terrasoft.ServiceSchemaManager.findResponseParameterByPath.bind(Terrasoft.ServiceSchemaManager)))}}),Ext.define("Terrasoft.services.ServiceNamespace",{extend:"Terrasoft.ServiceMetaItem",alternateClassName:"Terrasoft.ServiceNamespace",prefix:null,isDefault:!1,getSerializableProperties:function(){return["uId","name","prefix","isDefault"]},constructor:function(e){this.callParent(arguments)}}),Ext.define("Terrasoft.services.AuthInfo",{extend:"Terrasoft.ServiceMetaItem",alternateClassName:"Terrasoft.AuthInfo",authType:Terrasoft.services.enums.AuthType.None,values:null,_getValuesConfigItems:function(e){return e&&e.values&&(e.values.items||e.values.Items)},_initValues:function(e){this.values=this.values||new Terrasoft.ObjectCollection;var t=this._getValuesConfigItems(e);t&&!Terrasoft.isInstanceOfClass(e.values,"Terrasoft.ObjectCollection")&&(this.values=new Terrasoft.ObjectCollection,Terrasoft.each(t,(function(e,t){e._serviceSchema=this.getServiceSchema(),this.values.add(t,Ext.create("Terrasoft.ServiceParameterValue",e))}),this)),this.values.on("changed",this._onValuesChange,this)},_onValuesChange:function(){this.fireEvent("changed",{authInfoValues:this.values},this)},getSerializableProperties:function(){return["authType","values"]},getSerializableObject:function(e){this.callParent(arguments),e.values=this.getSerializableProperty(this.values)},restorePropertyValue:function(e,t){"values"===e?(this.values.clear(),Terrasoft.each(t.items,(function(e,t){e._serviceSchema=this.getServiceSchema(),this.values.add(t,Ext.create("Terrasoft.ServiceParameterValue",e))}),this)):this.callParent(arguments)},onDestroy:function(){this.values.un("changed",this._onValuesChange,this)},constructor:function(e){this.callParent(arguments),this._initValues(e)}}),Ext.define("Terrasoft.services.ServiceSchema",(_Ext$define={extend:"Terrasoft.manager.BaseSchema",alternateClassName:"Terrasoft.ServiceSchema",contractName:"ServiceSchema",serializableProperties:["baseUri","namespace","caption","description","methods","name","packageUId","realUId","retryCount","type","uId","authInfo"],baseUri:null,namespaces:null,methods:null,type:Terrasoft.services.enums.ServiceType.REST,retryCount:0,authInfo:null,_getMetaItemConfigItems:function(e,t){return e&&e[t]&&(e[t].items||e[t].Items)},_getMethodsSysSettings:function(){var e=[];return this.methods.each((function(t){if(t.request.parameters){var r=this._getParameterSysSettings(t.request.parameters);[].push.apply(e,r)}if(t.response.parameters){var n=this._getParameterSysSettings(t.response.parameters);[].push.apply(e,n)}}),this),e},_getParameterSysSettings:function(e){var t=[];return e.each((function(e){if(e.itemProperties.isEmpty()){(e.defValue&&e.defValue.source)===Terrasoft.services.enums.ServiceParameterValueSource.SYS_SETTING&&t.push(e.defValue.value)}else{var r=this._getParameterSysSettings(e.itemProperties);[].push.apply(t,r)}}),this),t},_onMethodsChange:function(){this.fireEvent("changed",{methods:this.methods},this)},_addMethods:function(e){Terrasoft.each(e,(function(e,t){e._serviceSchema=this,this.methods.add(t,Ext.create("Terrasoft.ServiceMethod",e))}),this)},_initMethods:function(e){this.methods||(this.methods=this._createServiceMetaItemCollection());var t=this._getMetaItemConfigItems(e,"methods");t&&(this.methods=this._createServiceMetaItemCollection(),this._addMethods(t)),this.methods.on("changed",this._onMethodsChange,this)}},_defineProperty(_Ext$define,"_onMethodsChange",(function(){this.fireEvent("changed",{methods:this.methods},this)})),_defineProperty(_Ext$define,"_addMethods",(function(e){Terrasoft.each(e,(function(e,t){e._serviceSchema=this,this.methods.add(t,Ext.create("Terrasoft.ServiceMethod",e))}),this)})),_defineProperty(_Ext$define,"_createServiceMetaItemCollection",(function(){return new Terrasoft.ObjectCollection({getKey:function(e){return e&&e.getPropertyValue("uId")}})})),_defineProperty(_Ext$define,"_addNamespaces",(function(e){Terrasoft.each(e,(function(e,t){e._serviceSchema=this,this.namespaces.add(t,Ext.create("Terrasoft.ServiceNamespace",e))}),this)})),_defineProperty(_Ext$define,"_onNamespaceChange",(function(){this.fireEvent("changed",{namespaces:this.namespaces},this)})),_defineProperty(_Ext$define,"_initNamespaces",(function(e){this.namespaces||(this.namespaces=this._createServiceMetaItemCollection());var t=this._getMetaItemConfigItems(e,"namespaces");t&&(this.namespaces=this._createServiceMetaItemCollection(),this._addNamespaces(t)),this.namespaces.on("changed",this._onNamespaceChange,this)})),_defineProperty(_Ext$define,"getSerializableObject",(function(e){this.callParent(arguments),e.namespaces=this.getSerializableProperty(this.namespaces),e.methods=this.getSerializableProperty(this.methods)})),_defineProperty(_Ext$define,"restorePropertyValue",(function(e,t){"methods"===e?(this.methods.clear(),this._addMethods(t.items)):"namespaces"===e?(this.namespaces.clear(),this._addNamespaces(t.items)):this.callParent(arguments)})),_defineProperty(_Ext$define,"constructor",(function(e){this.callParent(arguments),this._initMethods(e),this._initNamespaces(e);var t=e&&e.authInfo||{};this.authInfo=new Terrasoft.AuthInfo(Ext.merge(t,{_serviceSchema:this}))})),_defineProperty(_Ext$define,"createMethod",(function(e){return Ext.create("Terrasoft.ServiceMethod",e)})),_defineProperty(_Ext$define,"findMethodByName",(function(e){return this.methods&&this.methods.findByPath("name",e)})),_defineProperty(_Ext$define,"getServiceSysSettingsCollection",(function(){var e=[];if(this.methods&&(e=this._getMethodsSysSettings()),this.authInfo.authType!==Terrasoft.services.enums.AuthType.None){var t=Terrasoft.services.enums.ServiceParameterValueSource.SYS_SETTING,r=this.authInfo.values.filterByPath("source",t);[].push.apply(e,r.getItems().map((function(e){return e.value})))}return e})),_defineProperty(_Ext$define,"isRest",(function(){return this.type===Terrasoft.services.enums.ServiceType.REST})),_defineProperty(_Ext$define,"isSoap",(function(){return this.type===Terrasoft.services.enums.ServiceType.SOAP11||this.type===Terrasoft.services.enums.ServiceType.SOAP12})),_Ext$define)),Ext.define("Terrasoft.services.ServiceSchemaResponse",{alternateClassName:"Terrasoft.ServiceSchemaResponse",extend:"Terrasoft.BaseSchemaResponse",schemaClassName:"Terrasoft.ServiceSchema"}),Ext.define("Terrasoft.services.ServiceSchemaRequest",{extend:"Terrasoft.BaseSchemaRequest",alternateClassName:"Terrasoft.ServiceSchemaRequest",contractName:"ServiceSchemaRequest",responseClassName:"Terrasoft.ServiceSchemaResponse"}),Ext.define("Terrasoft.services.ServiceSchemaUpdateRequest",{extend:"Terrasoft.BaseSchemaUpdateRequest",alternateClassName:"Terrasoft.ServiceSchemaUpdateRequest",contractName:"ServiceDataContract"}),Ext.define("Terrasoft.services.ServiceSchemaRemoveRequest",{extend:"Terrasoft.ProcessSchemaRequest",alternateClassName:"Terrasoft.ServiceSchemaRemoveRequest",contractName:"ServiceSchemaRemoveRequest"}),Ext.define("Terrasoft.services.ServiceSchemaManagerItem",{extend:"Terrasoft.manager.BaseSchemaManagerItem",alternateClassName:"Terrasoft.ServiceSchemaManagerItem",instanceClassName:"Terrasoft.ServiceSchema",requestClassName:"Terrasoft.ServiceSchemaRequest",removeRequestClassName:"Terrasoft.ServiceSchemaRemoveRequest",updateRequestClassName:"Terrasoft.ServiceSchemaUpdateRequest"}),Ext.define("Terrasoft.services.ServiceSchemaManager",{extend:"Terrasoft.BaseSchemaManager",alternateClassName:"Terrasoft.ServiceSchemaManager",singleton:!0,itemClassName:"Terrasoft.ServiceSchemaManagerItem",managerName:"ServiceSchemaManager",itemInstanceClassName:"ServiceSchema",outdatedEventName:"ServiceSchema_Outdated",useNotification:!0,entitySchemaName:"VwWebServiceV2",_getNamePrefix:function(e){var t=this.schemaNamePrefix;return Ext.String.startsWith(e.name,t)?e.name:t+e.name},_applyParameterNamePrefix:function(e){e.name=this._getNamePrefix(e),this._applyParametersNamePrefix(e.itemProperties.items)},_applyParametersNamePrefix:function(e){Terrasoft.each(e,(function(e){this._applyParameterNamePrefix(e)}),this)},_applySchemaNamePrefix:function(e){Terrasoft.each(e.methods.items,(function(e){e.name=this._getNamePrefix(e),this._applyParametersNamePrefix(e.request.parameters.items),this._applyParametersNamePrefix(e.response.parameters.items)}),this)},_findParameterByProperty:function(e,t,r){var n;return r.each((function(r){if(n=r.getPropertyValue(e)===t?r:this._findParameterByProperty(e,t,r.itemProperties))return!1}),this),n},_findParameterByPath:function(e,t){if(t&&t.startParameterUId){var r=this._findParameterByProperty("uId",t.startParameterUId,e);r&&(e=r.itemProperties)}return t&&t.type&&(e=e.filterByPath("type",t.type)),t&&t.method?this._findParameterByProperty("path",t.path,e):null},getDesignSchemaRequestParameters:function(){return{contractName:"DesignServiceSchemaRequest",responseClassName:"Terrasoft.ServiceSchemaResponse"}},copySchema:function(e){var t=Terrasoft.generateGUID(),r=JSON.parse(e.serialize());(r=this.replaceObjectProperty(r,["createdInSchemaUId","modifiedInSchemaUId"],e.uId,t)).uId=t,r.realUId=t;var n=this._getNamePrefix(r);r.name=this.generateItemUniqueName(n),r.caption=e.caption+" - Copy",this._applySchemaNamePrefix(r);var i=Ext.create(this.itemInstanceClassName,r);return this.addSchema(i)},findMethodByUId:function(e,t,r){Terrasoft.chain((function(e){this.initialize(e,this)}),(function(t){this.findInstanceByUId(e.serviceUId,t,this)}),(function(n,i){var a;i&&(a=i.methods.findByPath("uId",e.methodUId)),Ext.callback(t,r,[a])}),this)},findRequestParameterByUId:function(e,t,r){Terrasoft.chain((function(e){this.initialize(e,this)}),(function(t){this.findMethodByUId(e,t,this)}),(function(n,i){var a;i&&(a=this._findParameterByProperty("uId",e.parameterUId,i.request.parameters)),Ext.callback(t,r,[a])}),this)},findResponseParameterByUId:function(e,t,r){Terrasoft.chain((function(e){this.initialize(e,this)}),(function(t){this.findMethodByUId(e,t,this)}),(function(n,i){var a;i&&(a=this._findParameterByProperty("uId",e.parameterUId,i.response.parameters)),Ext.callback(t,r,[a])}),this)},findRequestParameterByType:function(e,t,r){Terrasoft.chain((function(e){this.initialize(e,this)}),(function(t){this.findMethodByUId(e,t,this)}),(function(n,i){var a;i&&(a=this._findParameterByProperty("type",e.type,i.request.parameters)),Ext.callback(t,r,[a])}),this)},findResponseParameterByType:function(e,t,r){Terrasoft.chain((function(e){this.initialize(e,this)}),(function(t){this.findMethodByUId(e,t,this)}),(function(n,i){var a;i&&(a=this._findParameterByProperty("type",e.type,i.response.parameters)),Ext.callback(t,r,[a])}),this)},findRequestParameterByPath:function(e){var t=e.method.request.parameters;return this._findParameterByPath(t,e)},findResponseParameterByPath:function(e){var t=e.method.response.parameters;return this._findParameterByPath(t,e)}}),Ext.define("Terrasoft.controls.EmbeddedProcessSchemaDesignerLeftToolbar",{extend:"Terrasoft.controls.ProcessSchemaDesignerLeftToolbar",alternateClassName:"Terrasoft.EmbeddedProcessSchemaDesignerLeftToolbar",getToolbarGroups:function(){var e=this.callParent(arguments);return _.omit(e,"UserTask")},getToolbarItemVisible:function(e){return this.callParent(arguments)&&e.supportEmbeddedProcess}}),Ext.define("Terrasoft.EmbeddedProcessSchemaDesignerMixin",{alternateClassName:"Terrasoft.core.mixins.EmbeddedProcessSchemaDesignerMixin",_containsCaseInsensitive:function(e,t,r){var n=t.toLowerCase();return e.getKeys().some((function(e){return r?e.toLowerCase().indexOf(n)>-1:e.toLowerCase()===t.toLowerCase()}))},onSchemaLoaded:function(e){this.set("hasParentProcess",!(!e||!e.parentOwnerSchemaUId)),this.set("IsSchemaCaptionEnabled",!1)},onGenerateItemNameAndCaption:function(e){for(var t=this.get("Schema"),r=this.get("Items"),n=1,i=e.name,a=i+n,s=this.get("Schema").inheritedElements,o=t.isEmbedded;this._containsCaseInsensitive(r,a,o)||this._containsCaseInsensitive(s,a,o);)a=i+ ++n;e.name=a,o&&(e.name+="_"+Terrasoft.formatGUID(e.uId,"N"));var l=e.caption;if(l){var c=l.cultureValues;Terrasoft.each(c,(function(e,t){e&&(c[t]=e+" "+n)}),this)}return!1},createToolBarLefContainerItems:function(e){return[this.getSaveButton(),this.getCloseButton(),this.getActionsButton(e)]},createToolbarLeftContainer:function(){var e=Terrasoft.Resources.SchemaDesigner,t=[];return this.addOpenParentProcessMenuItem(t,e),this.addProcessSourceCodeMenuItem(t,e),this.addSeparatorMenuItem(t),this.addElementCopyMenuItem(t,e),this.addElementPasteMenuItem(t,e),this.getCreateToolbarLeftContainerConfig(t)},onOpenParentProcessClick:function(){if(this.get("hasParentProcess")){var e=this.get("Schema"),t=Terrasoft.workspaceBaseUrl+"/Nui/ViewModule.aspx?vm=SchemaDesigner#entityProcess/"+e.parentOwnerSchemaUId;window.open(t)}},addOpenParentProcessMenuItem:function(e,t){e.push(Ext.create("Terrasoft.MenuItem",{id:this.id+"-open-parent-process-mi",caption:t.OpenParentProcessMenuItemCaption,click:{bindTo:"onOpenParentProcessClick"},enabled:"$hasParentProcess"}))}}),Ext.define("Terrasoft.manager.GuidMetaItem",{extend:"Terrasoft.manager.MetaItem",alternateClassName:"Terrasoft.GuidMetaItem",parentSchema:null,typeName:"Terrasoft.Core.GuidMetaItem",getSerializableProperties:function(){var e=this.callParent(arguments),t=Ext.Array.push(e,["typeName"]);return t}}),Ext.define("Terrasoft.manager.EmbeddedProcessSchema",{extend:"Terrasoft.manager.ProcessSchema",alternateClassName:"Terrasoft.EmbeddedProcessSchema",convertedMethodsSchemaUIdList:null,_initialUserDefinedCode:null,contractName:"ContractEmbeddedProcessSchema",managerName:"EmbeddedProcessSchemaManager",isCreatedInSvg:!0,typeName:"Terrasoft.Core.Process.EmbeddedProcessSchema",isEmbedded:!0,useForceCompile:!0,useNotificationCaption:!1,userDefinedCode:null,parentOwnerSchemaUId:null,ownerSchemaName:"",constructor:function(){this.callParent(arguments),this.initCollection("convertedMethodsSchemaUIdList","Terrasoft.GuidMetaItem",this)},_getLocalizableValue:function(e,t){return e.LocalizableStrings[t.name]},_getLocalizableValueByUId:function(e,t){return{Caption:e[t.uId+".Caption"],Value:e[t.uId+".Value"]}},_loadLocalizableStrings:function(e,t){var r=this,n=new Terrasoft.Collection;Terrasoft.each(this.localizableStrings,(function(i){var a=t.call(r,e,i),s=r.createSchemaLocalizableString(i,a);n.add(s.uId,s)}),this),this.localizableStrings=n},createSchemaLocalizableString:function(e,t){var r=Ext.create("Terrasoft.SchemaLocalizableString",e);return r.setValue({caption:new Terrasoft.LocalizableString({cultureValues:t.Caption}),value:new Terrasoft.LocalizableString({cultureValues:t.Value})}),r},getEditPageSchemaName:function(e,t){e.call(t,"EmbeddedProcessSchemaPropertiesPage")},getSerializableObject:function(e){this.callParent(arguments),this.setSerializableCollectionProperty(e,"convertedMethodsSchemaUIdList"),this.setSerializableCollectionProperty(e,"localizableStrings")},getSerializableProperties:function(){var e=this.callParent(arguments),t=["notificationCaption","useSystemSecurityContext","serializeToDB","serializeToMemory","isLogging","enabled","isActiveVersion","version","isDelivered","isEmbedded","isInterpretable","useForceCompile","methodsBody","compiledMethodsBody","backgroundModePriority"];return t.forEach((function(t){return Ext.Array.remove(e,t)})),e},loadLocalizableValues:function(e){e&&(this.callParent(arguments),this._loadLocalizableStrings(e,this._getLocalizableValue))},loadLocalizableValuesByUIds:function(e){this.callParent(arguments),e&&this._loadLocalizableStrings(e,this._getLocalizableValueByUId)},getLocalizableValues:function(e){this.callParent(arguments),this.localizableStrings.each((function(t){t.getLocalizableValues(e)}),this)},addLocalizableString:function(e){Ext.apply(e,{createdInSchemaUId:this.uId,modifiedInSchemaUId:this.uId,createdInPackageId:this.createdInPackageId});var t=Ext.create("Terrasoft.SchemaLocalizableString",e);this.localizableStrings.add(t.uId,t)},getValidateFormulaServerMethodName:function(){return"ValidateEmbeddedProcessFormula"},shouldBeCompiled:function(){return!0},hasOwnLaneSet:function(){return 0!==this.laneSets.getCount()},getInitialUserDefinedCode:function(){return this._initialUserDefinedCode},setInitialUserDefinedCode:function(e){this._initialUserDefinedCode=e}}),Ext.define("Terrasoft.data.queries.EmbeddedProcessSchemaRequest",{extend:"Terrasoft.BaseSchemaRequest",alternateClassName:"Terrasoft.EmbeddedProcessSchemaRequest",contractName:"EmbeddedProcessSchemaRequest",responseClassName:"Terrasoft.EmbeddedProcessSchemaResponse",convertLocalizableStringToParameter:!0,getSerializableObject:function(e){this.callParent(arguments),e.convertLocalizableStringToParameter=this.convertLocalizableStringToParameter}}),Ext.define("Terrasoft.manager.EmbeddedProcessSchemaManagerItem",{extend:"Terrasoft.BaseSchemaManagerItem",alternateClassName:"Terrasoft.EmbeddedProcessSchemaManagerItem",instanceClassName:"Terrasoft.EmbeddedProcessSchema",requestClassName:"Terrasoft.EmbeddedProcessSchemaRequest",removeRequestClassName:"Terrasoft.EmbeddedProcessSchemaRemoveRequest",updateRequestClassName:"Terrasoft.EmbeddedProcessSchemaUpdateRequest",onAfterSave:function(e){this.setPropertyValue("isInterpretable",e.isInterpretable),this.instance.validatorInfo=e.validatorInfo,this.instance.validatorMessage=e.validatorMessage,e.schemaName&&(this.instance.name=e.schemaName),this.callParent(arguments)},getInstance:function(e,t){this.getInstanceWithResponse(e,t)}}),Ext.define("Terrasoft.manager.EmbeddedProcessSchemaManager",{extend:"Terrasoft.manager.BaseProcessSchemaManager",alternateClassName:"Terrasoft.EmbeddedProcessSchemaManager",singleton:!0,itemClassName:"Terrasoft.EmbeddedProcessSchemaManagerItem",managerName:"EmbeddedProcessSchemaManager",schemaManagerServiceName:"ServiceModel/ProcessSchemaManagerService.svc",serviceName:"EmbeddedProcessSchemaManagerService",outdatedEventName:"ProcessSchema_Outdated",useNotification:!0,defSchemaUId:"bb4d6607-026b-4b27-b640-8f5c77c1e89d",addDefSchemaElements:function(e){var t=e.uId,r=this.createLaneSet(t),n=this.createLane(t,r.uId);e.add(r),e.add(n)},createLaneSet:function(e){var t=Ext.create("Terrasoft.ProcessLaneSetSchema",{uId:Terrasoft.generateGUID(),name:"LaneSet_",createdInSchemaUId:e,modifiedInSchemaUId:e});return t.name+=Terrasoft.formatGUID(t.uId,"N"),t.setLocalizableStringPropertyValue("caption","LaneSet 1"),t},createLane:function(e,t){var r=Ext.create("Terrasoft.ProcessLaneSchema",{uId:Terrasoft.generateGUID(),name:"Lane_",containerUId:t,createdInSchemaUId:e,modifiedInSchemaUId:e});return r.name+=Terrasoft.formatGUID(r.uId,"N"),r.setLocalizableStringPropertyValue("caption","Lane 1"),r},initSchema:function(e){e.hasOwnLaneSet()||this.addDefSchemaElements(e)},createSchema:function(){var e=this.callParent(arguments);return e.name="",e.parentSchemaUId=this.defSchemaUId,e.isCreatedInSvg=!0,e.isInterpretable=!1,e.serializeToDB=!1,this.addDefSchemaElements(e),e},forceGetInstanceByUId:function(e,t,r){this.createManagerItem({uId:e}).forceGetInstance((function(e){t.call(r,e)}),this)}}),Ext.define("Terrasoft.Designers.EmbeddedProcessSchemaDesignerViewModel",{extend:"Terrasoft.Designers.ProcessSchemaDesignerViewModel",alternateClassName:"Terrasoft.EmbeddedProcessSchemaDesignerViewModel",mixins:{embeddedProcessSchemaDesignerMixin:"Terrasoft.EmbeddedProcessSchemaDesignerMixin"},contextHelpCode:"EmbeddedProcessSchemaDesigner",schemaManager:Terrasoft.EmbeddedProcessSchemaManager,urlHashPrefix:"entityProcess",hasParentProcess:!1,onSchemaLoaded:function(e){this.callParent(arguments),this.mixins.embeddedProcessSchemaDesignerMixin.onSchemaLoaded.apply(this,arguments)},openSourceCode:function(e){Terrasoft.BaseSchemaDesignerUtilities.openEntitySourceCode(e)},onGenerateItemNameAndCaption:function(e){return this.mixins.embeddedProcessSchemaDesignerMixin.onGenerateItemNameAndCaption.apply(this,arguments)},showProcessConfirmationDialog:function(e,t,r,n){this.callParent([e,null,r,n])},getSaveButtonMenuItems:function(){return[]}}),Ext.define("Terrasoft.Designers.EmbeddedProcessSchemaDesigner",{extend:"Terrasoft.Designers.ProcessSchemaDesigner",alternateClassName:"Terrasoft.EmbeddedProcessSchemaDesigner",mixins:{embeddedProcessSchemaDesignerMixin:"Terrasoft.EmbeddedProcessSchemaDesignerMixin"},designerViewModelClassName:"Terrasoft.EmbeddedProcessSchemaDesignerViewModel",leftToolbarClassName:"Terrasoft.EmbeddedProcessSchemaDesignerLeftToolbar",createToolBarLefContainerItems:function(e){return this.mixins.embeddedProcessSchemaDesignerMixin.createToolBarLefContainerItems.apply(this,arguments)},createToolbarLeftContainer:function(){return this.mixins.embeddedProcessSchemaDesignerMixin.createToolbarLeftContainer.apply(this,arguments)}}),Ext.define("Terrasoft.Designers.EmbeddedProcessSchemaDesignerViewModelNew",{extend:"Terrasoft.Designers.ProcessSchemaDesignerViewModelNew",alternateClassName:"Terrasoft.EmbeddedProcessSchemaDesignerViewModelNew",mixins:{embeddedProcessSchemaDesignerMixin:"Terrasoft.EmbeddedProcessSchemaDesignerMixin"},contextHelpCode:"EmbeddedProcessSchemaDesigner",schemaManager:Terrasoft.EmbeddedProcessSchemaManager,urlHashPrefix:"entityProcess",storageSchemaUserDefinedCode:"ProcessSchemaUserDefinedCode",hasParentProcess:!1,_saveUserDefinedCodeToStorage:function(){var e=this.get("Schema");this.localStore.setItem(this.storageSchemaUserDefinedCode,e.userDefinedCode)},onSchemaLoaded:function(e){this.callParent(arguments),this.mixins.embeddedProcessSchemaDesignerMixin.onSchemaLoaded.apply(this,arguments)},openSourceCode:function(e){Terrasoft.BaseSchemaDesignerUtilities.openEntitySourceCode(e)},onGenerateItemNameAndCaption:function(e){return this.mixins.embeddedProcessSchemaDesignerMixin.onGenerateItemNameAndCaption.apply(this,arguments)},showProcessConfirmationDialog:function(e,t,r,n){this.callParent([e,null,r,n])},getDiagramConfig:function(){var e=this.callParent();return e.isEmbeddedProcess=!0,e},getElementSchemaManagerItems:function(){var e=this.callParent(arguments);return e.filter((function(e){return e.instance.supportEmbeddedProcess}))},getPaletteUserTask:function(){return null},getPaletteServiceTask:function(){return _objectSpread(_objectSpread({},this.callParent(arguments)),{},{type:"scriptTask",userTaskType:null})},getElementToolsUserTask:function(){return null},getElementToolsServiceTask:function(){return _objectSpread(_objectSpread({},this.callParent(arguments)),{},{type:"scriptTask",userTaskType:null})},getCustomPaletteElements:function(){var e=this.callParent(arguments);return _objectSpread(_objectSpread({},e),{},{startEvent:_objectSpread(_objectSpread({},e.startEvent),{},{type:"startEventMessage",title:Terrasoft.Resources.ProcessSchemaDesigner.Elements.StartMessageCaption})})},getEventSubProcessStartSignalElementSchema:function(){return Terrasoft.ProcessStartMessageNonInterruptingSchema},saveSchemaToStorage:function(){var e=this.mixins.BaseSchemaDesignerStorageMixin.saveSchemaToStorage.call(this);return e&&this._saveUserDefinedCodeToStorage(),e},getSchemaFromStorage:function(){var e=this.mixins.BaseSchemaDesignerStorageMixin.getSchemaFromStorage.call(this);if(e){var t=this.localStore.getItem(this.storageSchemaUserDefinedCode);e.userDefinedCode=t}return e},clearSchemaStorageInfo:function(){this.callParent(arguments),this.localStore.removeItem(this.storageSchemaUserDefinedCode)},getSaveButtonMenuItems:function(){return[]},getIsSuggestionsEnabled:function(){return!1}}),Ext.define("Terrasoft.Designers.EmbeddedProcessSchemaDesignerNew",{extend:"Terrasoft.Designers.ProcessSchemaDesignerNew",alternateClassName:"Terrasoft.EmbeddedProcessSchemaDesignerNew",mixins:{embeddedProcessSchemaDesignerMixin:"Terrasoft.EmbeddedProcessSchemaDesignerMixin"},designerViewModelClassName:"Terrasoft.EmbeddedProcessSchemaDesignerViewModelNew",createToolBarLefContainerItems:function(e){return this.mixins.embeddedProcessSchemaDesignerMixin.createToolBarLefContainerItems.apply(this,arguments)},showImportButton:!1,createToolbarLeftContainer:function(){return this.mixins.embeddedProcessSchemaDesignerMixin.createToolbarLeftContainer.apply(this,arguments)},getDiagramConfig:function(){var e=this.callParent(arguments);return e.canImport=!1,e}}),Ext.define("Terrasoft.data.queries.EmbeddedProcessSchemaUpdateRequest",{extend:"Terrasoft.BaseSchemaUpdateRequest",alternateClassName:"Terrasoft.EmbeddedProcessSchemaUpdateRequest",contractName:"ContractEmbeddedProcessSchema",getData:function(){var e=this.schema,t={};e.getLocalizableValues(t);var r={metaData:e.serialize(),resources:t,uId:e.uId,realUId:e.realUId,name:e.name,packageUId:e.packageUId,requestTimeout:this.requestTimeout,changedItems:e.changedItems,loadedLazyProperties:e.getLoadedLazyProperties(),lazyProperties:e.getLazyProperties()};return e.userDefinedCode!==e.getInitialUserDefinedCode()&&(r.userDefinedCode=e.userDefinedCode),r}}),Ext.define("Terrasoft.core.EmbeddedProcessSchemaResponse",{extend:"Terrasoft.BaseSchemaResponse",alternateClassName:"Terrasoft.EmbeddedProcessSchemaResponse",schemaClassName:"Terrasoft.EmbeddedProcessSchema",contractName:"EmbeddedProcessSchemaResponse",createSchemaInstance:function(e){var t=Terrasoft.SchemaDesignerUtilities.createInstanceByMetaData({metaData:e.metaData,lazyProperties:e.lazyProperties,schemaClassName:this.schemaClassName,resources:e.resources});t.realUId=e.realUId,t.packageUId=e.packageUId,t.parentOwnerSchemaUId=e.parentOwnerSchemaUId,t.ownerSchemaName=e.ownerSchemaName;var r=e.hasOwnSchemaMethods?null:e.userDefinedCode;return t.setInitialUserDefinedCode(r),t.userDefinedCode||(t.userDefinedCode=e.userDefinedCode),Terrasoft.EmbeddedProcessSchemaManager.initSchema(t),t}}),Ext.define("Terrasoft.controls.ExternalWidget",{extend:"Terrasoft.Container",alternateClassName:"Terrasoft.ExternalWidget",iframe:null,iframeDefaultWrapClass:["widget-iframe"],defaultWrapClassName:"widget-module",iframeSrc:"",iframeWrapClass:null,updateDelay:1,sandboxAttributes:"",_tryShowIframeSourceContent:function(e){e&&Terrasoft.isUrl(e)&&Ext.defer((function(){this._sendRequestToIframeSource(e,this._onIframeSourceResponse,this)}),this.updateDelay,this)},_sendRequestToIframeSource:function(e,t,r){Terrasoft.AjaxProvider.request({url:e,scope:r,callback:function(n,i){t.call(r,e,i)}})},_onIframeSourceResponse:function(e,t){t&&(this.iframeSrc=e,this.setVisible(!0),this.iframe.setIframeSrc(this.iframeSrc))},_initIframe:function(){this.iframe=Ext.create("Terrasoft.IframeControl",{wrapClass:this.iframeWrapClass||this.iframeDefaultWrapClass}),this.iframe.setSandboxAttributes(this.sandboxAttributes),this.add(this.iframe),this.iframeSrc&&(this.setVisible(!1),this._tryShowIframeSourceContent(this.iframeSrc))},setIframeSrc:function(e){this.iframeSrc!==e&&(this.setVisible(!1),this._tryShowIframeSourceContent(e))},init:function(){this.callParent(arguments),this._initIframe()},onDestroy:function(){this.iframe.destroy(),this.callParent(arguments)},getBindConfig:function(){var e=this.callParent(arguments),t={iframeSrc:{changeMethod:"setIframeSrc"},sandboxAttributes:{changeMethod:"setSandboxAttributes"}};return Ext.apply(t,e)},setSandboxAttributes:function(e){this.sandboxAttributes=e,this.iframe.setSandboxAttributes(e)},getTplData:function(){var e=this.callParent(arguments),t=this.classes||{wrapClassName:[this.defaultWrapClassName]};return Ext.apply(e,t),e}}),Ext.define("Terrasoft.utils.UserAgent",{singleton:!0,_supportedBrowsers:{chrome:"84",firefox:"80",safari:"12","mobile safari":"12",edge:"84",yandex:"19",webkit:"604","chrome webview":"84"},isBrowserSupported:function(){var e,t,r=null;(null===(e=window)||void 0===e?void 0:e.UAParser)&&(r=new window.UAParser);var n=null===(t=r)||void 0===t?void 0:t.getBrowser();if(!n)return!1;var i=n.name.toLowerCase(),a=n.major,s=this._supportedBrowsers[i];return!!s&&parseFloat(a)>=parseFloat(s)}}),Ext.define("Terrasoft.core.SchemaManagerEventObserver",{alternateClassName:"Terrasoft.SchemaManagerEventObserver",singleton:!0,constructor:function(){Terrasoft.ServerChannel.on(Terrasoft.EventName.ON_MESSAGE,this._onMessageHandler,this)},_onMessageHandler:function(e,t){if(!Ext.isEmpty(t)){var r=t.Header;if(!(Ext.isEmpty(r)||"SchemaManagerItemEventNotifier"!==r.Sender||"ChangedSchema"!==r.BodyTypeName&&"RemovedSchema"!==r.BodyTypeName)){var n=JSON.parse(t.Body);"ClientUnitSchemaManager"===n.ManagerName&&this._setRequireJsConfig(n.Name)}}},_setRequireJsConfig:function(e){var t;require.undef(e),require.undef(e+"Structure");var r=e+"Resources";require.undef(r);var n=".js?hash="+Date.now();if(Terrasoft.useStaticFileContent){var i;this.resetBundleRequireConfig();var a=Terrasoft.workspaceBaseUrl+"/conf/content/",s=a+e+n,o="".concat(a,"resources/").concat(Terrasoft.currentUserCultureName,"/").concat(r)+n,l=Terrasoft.coreModulesPath+"Terrasoft/configuration/resources/empty-resources";_defineProperty(i={},e,s),_defineProperty(i,r,[o,l]),t=i}else{var c=Terrasoft.workspaceBaseUrl+"/configuration/hash/";t=_defineProperty({},e,c+e+n)}require.config({paths:t})},resetBundleRequireConfig:function(){var e,t,r,n,i=null===(e=require.s)||void 0===e||null===(t=e.contexts)||void 0===t||null===(r=t._)||void 0===r||null===(n=r.config)||void 0===n?void 0:n.bundles;if(i&&!Terrasoft.isEmptyObject(i)){var a=Object.fromEntries(Object.keys(i).map((function(e){return[e,[]]})));require.config({bundles:a})}}});